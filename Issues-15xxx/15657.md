# Issue 15657: Allow parsing of arguments for cached_function and cached_method

archive/issues_015420.json:
```json
{
    "assignees": [
        "https://github.com/tscrim"
    ],
    "body": "Because it will be handy to normalize and/or ignore arguments for these functions and method. See #1314 for an example.\n\nCC:  @simon-king-jena\n\nKeywords: **cached method function**\n\nBranch: **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Julian Rueth**\n\nComponent: **misc**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15657_\n\n",
    "closed_at": "2014-04-20T23:37:35Z",
    "created_at": "2014-01-09T16:43:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Allow parsing of arguments for cached_function and cached_method",
    "type": "issue",
    "updated_at": "2014-05-13T07:59:39Z",
    "url": "https://github.com/sagemath/sage/issues/15657",
    "user": "https://github.com/tscrim"
}
```
Because it will be handy to normalize and/or ignore arguments for these functions and method. See #1314 for an example.

CC:  @simon-king-jena

Keywords: **cached method function**

Branch: **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)**

Reviewer: **Travis Scrimshaw**

Author: **Julian Rueth**

Component: **misc**

_Issue created by migration from https://trac.sagemath.org/ticket/15657_





---

archive/issue_events_224356.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-01-09T16:43:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224356"
}
```



---

archive/issue_events_224357.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-01-09T16:43:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224357"
}
```



---

archive/issue_events_224358.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-01-09T16:43:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224358"
}
```



---

archive/issue_events_224359.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-01-09T16:43:23Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "subject": "https://github.com/tscrim",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224359"
}
```



---

archive/issue_comments_196812.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n(curious)",
    "created_at": "2014-01-09T17:46:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196812",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:1" align="right">comment:1</div>

(curious)



---

archive/issue_events_224360.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224360"
}
```



---

archive/issue_events_224361.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224361"
}
```



---

archive/issue_comments_196813.json:
```json
{
    "body": "Branch: **[u/saraedum/ticket/15657](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15657)**",
    "created_at": "2014-03-19T23:02:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196813",
    "user": "https://github.com/saraedum"
}
```

Branch: **[u/saraedum/ticket/15657](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15657)**



---

archive/issue_comments_196814.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI implemented this for `cached_function`. I am working on something similar for `cached_method`.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99be4c6389d1bb10c891a89446b1a8984ef98663\"><code>99be4c6</code></a></td><td><code>Added decorator_keywords decorator to simplify writing decorators with optional keyword arguments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b74edaacabb7f22682eb36bf3d405642049f9a3c\"><code>b74edaa</code></a></td><td><code>Added key_normalizer for cached_function</code></td></tr></table>\n",
    "created_at": "2014-03-19T23:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196814",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:4" align="right">comment:4</div>

I implemented this for `cached_function`. I am working on something similar for `cached_method`.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99be4c6389d1bb10c891a89446b1a8984ef98663"><code>99be4c6</code></a></td><td><code>Added decorator_keywords decorator to simplify writing decorators with optional keyword arguments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b74edaacabb7f22682eb36bf3d405642049f9a3c"><code>b74edaa</code></a></td><td><code>Added key_normalizer for cached_function</code></td></tr></table>




---

archive/issue_comments_196815.json:
```json
{
    "body": "Commit: **[`b74edaa`](https://github.com/sagemath/sagetrac-mirror/commit/b74edaacabb7f22682eb36bf3d405642049f9a3c)**",
    "created_at": "2014-03-19T23:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196815",
    "user": "https://github.com/saraedum"
}
```

Commit: **[`b74edaa`](https://github.com/sagemath/sagetrac-mirror/commit/b74edaacabb7f22682eb36bf3d405642049f9a3c)**



---

archive/issue_comments_196816.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/faf771be45c513ac91b24a35231a40545013a441\"><code>faf771b</code></a></td><td><code>Renamed key_normalizer to create_key for cached_function to be consistent with UniqueFactory</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe7a01a75ef3d52f1aa85ee48301377795520384\"><code>fe7a01a</code></a></td><td><code>Add create_key parameter for cached_method</code></td></tr></table>\n",
    "created_at": "2014-03-20T01:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196816",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/faf771be45c513ac91b24a35231a40545013a441"><code>faf771b</code></a></td><td><code>Renamed key_normalizer to create_key for cached_function to be consistent with UniqueFactory</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe7a01a75ef3d52f1aa85ee48301377795520384"><code>fe7a01a</code></a></td><td><code>Add create_key parameter for cached_method</code></td></tr></table>




---

archive/issue_comments_196817.json:
```json
{
    "body": "Changed commit from **[`b74edaa`](https://github.com/sagemath/sagetrac-mirror/commit/b74edaacabb7f22682eb36bf3d405642049f9a3c)** to **[`fe7a01a`](https://github.com/sagemath/sagetrac-mirror/commit/fe7a01a75ef3d52f1aa85ee48301377795520384)**",
    "created_at": "2014-03-20T01:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196817",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b74edaa`](https://github.com/sagemath/sagetrac-mirror/commit/b74edaacabb7f22682eb36bf3d405642049f9a3c)** to **[`fe7a01a`](https://github.com/sagemath/sagetrac-mirror/commit/fe7a01a75ef3d52f1aa85ee48301377795520384)**



---

archive/issue_events_224362.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2014-03-20T01:19:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224362"
}
```



---

archive/issue_comments_196818.json:
```json
{
    "body": "Changed commit from **[`fe7a01a`](https://github.com/sagemath/sagetrac-mirror/commit/fe7a01a75ef3d52f1aa85ee48301377795520384)** to **[`275f2e1`](https://github.com/sagemath/sagetrac-mirror/commit/275f2e1ef53456964cf49b81aab22ffdecb308c3)**",
    "created_at": "2014-03-26T02:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196818",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[`fe7a01a`](https://github.com/sagemath/sagetrac-mirror/commit/fe7a01a75ef3d52f1aa85ee48301377795520384)** to **[`275f2e1`](https://github.com/sagemath/sagetrac-mirror/commit/275f2e1ef53456964cf49b81aab22ffdecb308c3)**



---

archive/issue_comments_196819.json:
```json
{
    "body": "Changed branch from **[u/saraedum/ticket/15657](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15657)** to **[public/structure/cached_args-15657](https://github.com/sagemath/sagetrac-mirror/tree/public/structure/cached_args-15657)**",
    "created_at": "2014-03-26T02:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196819",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/saraedum/ticket/15657](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15657)** to **[public/structure/cached_args-15657](https://github.com/sagemath/sagetrac-mirror/tree/public/structure/cached_args-15657)**



---

archive/issue_comments_196820.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI've changed `create_key` into `key` to match with python's `sorted` (and it makes more sense to me). I've also moved a good part of the doc up to our current standards.\n\nHere are some timings:\n\nWith patch:\n\n```\nsage: @cached_function\n....: def foo():\n....:     return 5\n....: \nsage: %timeit foo()\n1000000 loops, best of 3: 343 ns per loop\n\nsage: class Foo:\n....:     @cached_method\n....:     def bar(self):\n....:         return 5\n....:     \nsage: F = Foo()\nsage: %timeit F.bar()\n1000000 loops, best of 3: 235 ns per loop\n\nsage: class FooArgs:\n....:     @cached_method\n....:     def bar(self, x):\n....:         return x\n....:     \nsage: FA = FooArgs()\nsage: %timeit FA.bar(5)\n1000000 loops, best of 3: 1.55 \u00b5s per loop\n```\nBefore:\n\n```\nsage: %timeit foo()\n1000000 loops, best of 3: 335 ns per loop\n\nsage: %timeit F.bar()\n1000000 loops, best of 3: 250 ns per loop\n\nsage: %timeit FA.bar(5)\n1000000 loops, best of 3: 1.47 \u00b5s per loop\n```\nSo there does not appear to be any (statistically) significant speed regression (I did multiple runs of each as well).\n\nIf you're happy with my changes, then positive review.\n\nPS - I also added the key option for the cache to file.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec8dbf14f0b9d888b5bd1179998a406b0151a8c4\"><code>ec8dbf1</code></a></td><td><code>Initial addition of a 'key' argument to cached functions.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5e837be63b05b4292ca10024d9c774b937a3a7c\"><code>c5e837b</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d78b1bcfe56043474663ca484ff48bdffc36c3d\"><code>8d78b1b</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5872e555b146e425ccfb1142ef835823b007d6bb\"><code>5872e55</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9374110c7059ed38d7bac74f7e4a0df1daa0e304\"><code>9374110</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03ac296c9e5af190db54c936ce6fffc4bf409236\"><code>03ac296</code></a></td><td><code>Merge branch 'u/saraedum/ticket/15657' of trac.sagemath.org:sage into public/structure/cached_args-15657</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/275f2e1ef53456964cf49b81aab22ffdecb308c3\"><code>275f2e1</code></a></td><td><code>Fixes due to my bad merging skills.</code></td></tr></table>\n",
    "created_at": "2014-03-26T02:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196820",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

I've changed `create_key` into `key` to match with python's `sorted` (and it makes more sense to me). I've also moved a good part of the doc up to our current standards.

Here are some timings:

With patch:

```
sage: @cached_function
....: def foo():
....:     return 5
....: 
sage: %timeit foo()
1000000 loops, best of 3: 343 ns per loop

sage: class Foo:
....:     @cached_method
....:     def bar(self):
....:         return 5
....:     
sage: F = Foo()
sage: %timeit F.bar()
1000000 loops, best of 3: 235 ns per loop

sage: class FooArgs:
....:     @cached_method
....:     def bar(self, x):
....:         return x
....:     
sage: FA = FooArgs()
sage: %timeit FA.bar(5)
1000000 loops, best of 3: 1.55 µs per loop
```
Before:

```
sage: %timeit foo()
1000000 loops, best of 3: 335 ns per loop

sage: %timeit F.bar()
1000000 loops, best of 3: 250 ns per loop

sage: %timeit FA.bar(5)
1000000 loops, best of 3: 1.47 µs per loop
```
So there does not appear to be any (statistically) significant speed regression (I did multiple runs of each as well).

If you're happy with my changes, then positive review.

PS - I also added the key option for the cache to file.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec8dbf14f0b9d888b5bd1179998a406b0151a8c4"><code>ec8dbf1</code></a></td><td><code>Initial addition of a 'key' argument to cached functions.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5e837be63b05b4292ca10024d9c774b937a3a7c"><code>c5e837b</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d78b1bcfe56043474663ca484ff48bdffc36c3d"><code>8d78b1b</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5872e555b146e425ccfb1142ef835823b007d6bb"><code>5872e55</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9374110c7059ed38d7bac74f7e4a0df1daa0e304"><code>9374110</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03ac296c9e5af190db54c936ce6fffc4bf409236"><code>03ac296</code></a></td><td><code>Merge branch 'u/saraedum/ticket/15657' of trac.sagemath.org:sage into public/structure/cached_args-15657</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/275f2e1ef53456964cf49b81aab22ffdecb308c3"><code>275f2e1</code></a></td><td><code>Fixes due to my bad merging skills.</code></td></tr></table>




---

archive/issue_comments_196821.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSage does not start anymore for me:\n\n```\nImportError: No module named terminal.interactiveshell\n```\n\nSomehow your merge has really gone wrong. Do you want me to fix this for you?",
    "created_at": "2014-04-02T11:40:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196821",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:8" align="right">comment:8</div>

Sage does not start anymore for me:

```
ImportError: No module named terminal.interactiveshell
```

Somehow your merge has really gone wrong. Do you want me to fix this for you?



---

archive/issue_comments_196822.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c2bed92e8855bd618472becaf553fa9b943b649\"><code>2c2bed9</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr></table>\n",
    "created_at": "2014-04-02T14:29:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196822",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c2bed92e8855bd618472becaf553fa9b943b649"><code>2c2bed9</code></a></td><td><code>Merge branch 'develop' into public/structure/cached_args-15657</code></td></tr></table>




---

archive/issue_comments_196823.json:
```json
{
    "body": "Changed commit from **[`275f2e1`](https://github.com/sagemath/sagetrac-mirror/commit/275f2e1ef53456964cf49b81aab22ffdecb308c3)** to **[`2c2bed9`](https://github.com/sagemath/sagetrac-mirror/commit/2c2bed92e8855bd618472becaf553fa9b943b649)**",
    "created_at": "2014-04-02T14:29:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196823",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`275f2e1`](https://github.com/sagemath/sagetrac-mirror/commit/275f2e1ef53456964cf49b81aab22ffdecb308c3)** to **[`2c2bed9`](https://github.com/sagemath/sagetrac-mirror/commit/2c2bed92e8855bd618472becaf553fa9b943b649)**



---

archive/issue_comments_196824.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nStarted just fine for me with 6.2.beta5, and here's my current 6.2.beta6 version (which also starts up without error).",
    "created_at": "2014-04-02T14:30:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196824",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

Started just fine for me with 6.2.beta5, and here's my current 6.2.beta6 version (which also starts up without error).



---

archive/issue_comments_196825.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOk. I had to `make`. Now it works again. I agree with your changes.",
    "created_at": "2014-04-10T15:21:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196825",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:11" align="right">comment:11</div>

Ok. I had to `make`. Now it works again. I agree with your changes.



---

archive/issue_events_224363.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2014-04-10T15:21:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224363"
}
```



---

archive/issue_events_224364.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2014-04-10T15:21:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224364"
}
```



---

archive/issue_comments_196826.json:
```json
{
    "body": "Author: **Julian Rueth**",
    "created_at": "2014-04-10T15:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196826",
    "user": "https://github.com/tscrim"
}
```

Author: **Julian Rueth**



---

archive/issue_comments_196827.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2014-04-10T15:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196827",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_196828.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks.",
    "created_at": "2014-04-10T15:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196828",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks.



---

archive/issue_comments_196829.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n\n```\nsage -t --long src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed\nsage -t --long src/sage/misc/dev_tools.py  # 1 doctest failed\n```",
    "created_at": "2014-04-14T16:54:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196829",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>


```
sage -t --long src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed
sage -t --long src/sage/misc/dev_tools.py  # 1 doctest failed
```



---

archive/issue_comments_196830.json:
```json
{
    "body": "Changed commit from **[`2c2bed9`](https://github.com/sagemath/sagetrac-mirror/commit/2c2bed92e8855bd618472becaf553fa9b943b649)** to **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)**",
    "created_at": "2014-04-18T15:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196830",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2c2bed9`](https://github.com/sagemath/sagetrac-mirror/commit/2c2bed92e8855bd618472becaf553fa9b943b649)** to **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)**



---

archive/issue_events_224365.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2014-04-18T15:55:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224365"
}
```



---

archive/issue_events_224366.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2014-04-18T15:55:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224366"
}
```



---

archive/issue_comments_196831.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37f17976542e7b0a6fd7e1c3e4d67df9731ab9fb\"><code>37f1797</code></a></td><td><code>Merge branch 'public/structure/cached_args-15657' of trac.sagemath.org:sage into public/structure/cached_args-15657</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607\"><code>2f19ea5</code></a></td><td><code>Fixed doctests.</code></td></tr></table>\n",
    "created_at": "2014-04-18T15:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196831",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37f17976542e7b0a6fd7e1c3e4d67df9731ab9fb"><code>37f1797</code></a></td><td><code>Merge branch 'public/structure/cached_args-15657' of trac.sagemath.org:sage into public/structure/cached_args-15657</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607"><code>2f19ea5</code></a></td><td><code>Fixed doctests.</code></td></tr></table>




---

archive/issue_events_224367.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-18T16:08:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224367"
}
```



---

archive/issue_events_224368.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-18T16:08:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224368"
}
```



---

archive/issue_comments_196832.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nFixed.",
    "created_at": "2014-04-18T16:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196832",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

Fixed.



---

archive/issue_events_224369.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-20T23:37:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224369"
}
```



---

archive/issue_events_224370.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d978cbb81c658b2330b11f0d651b22e7ddb6120e",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-04-20T23:37:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15657#event-224370"
}
```



---

archive/issue_comments_196833.json:
```json
{
    "body": "Changed branch from **[public/structure/cached_args-15657](https://github.com/sagemath/sagetrac-mirror/tree/public/structure/cached_args-15657)** to **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)**",
    "created_at": "2014-04-20T23:37:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196833",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/structure/cached_args-15657](https://github.com/sagemath/sagetrac-mirror/tree/public/structure/cached_args-15657)** to **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)**



---

archive/issue_comments_196834.json:
```json
{
    "body": "Changed commit from **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)** to none",
    "created_at": "2014-05-12T16:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196834",
    "user": "https://github.com/saraedum"
}
```

Changed commit from **[`2f19ea5`](https://github.com/sagemath/sagetrac-mirror/commit/2f19ea5c2cffb7417978f9b504a2b78e9c604607)** to none



---

archive/issue_comments_196835.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nActually using the `key` parameter I found a few small bugs, this is #16337.",
    "created_at": "2014-05-12T16:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196835",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:17" align="right">comment:17</div>

Actually using the `key` parameter I found a few small bugs, this is #16337.



---

archive/issue_comments_196836.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nHello guys !!\n\nWith designs I would like to have some new parameter for cached methods, but I wonder if it would be a good idea of slow something that we want to be fast...\n\nHere is the thing : I would like to only cache the return values corresponding to \"some\" inputs of the cached function. More precisely, if some parameter is set to True I want to cache the result, otherwise I don't want to.\n\nDo you know if it can be useful to you, or if it can be obtained by a trick with the current features of cached methods ?\n\nThaaaaaaanks !\n\nNathann",
    "created_at": "2014-05-13T07:59:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15657",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15657#issuecomment-196836",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:18" align="right">comment:18</div>

Hello guys !!

With designs I would like to have some new parameter for cached methods, but I wonder if it would be a good idea of slow something that we want to be fast...

Here is the thing : I would like to only cache the return values corresponding to "some" inputs of the cached function. More precisely, if some parameter is set to True I want to cache the result, otherwise I don't want to.

Do you know if it can be useful to you, or if it can be obtained by a trick with the current features of cached methods ?

Thaaaaaaanks !

Nathann
