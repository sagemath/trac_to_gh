# Issue 15404: Change coprime_integers(n) in Integer class to use sieving instead of naive gcd

archive/issues_015167.json:
```json
{
    "body": "As written currently, the coprime_integers(n) method in the Integer class uses gcd naively:\n\n```\n    def coprime_integers(self, m):\n        ...\n        v = []\n        for n in range(1,m):\n            if self.gcd(n) == 1:\n                v.append(Integer(n))\n        return v\n```\n\nThis method should be rewritten to use sieving to speed things up.\n\n**Assignee:** Simon Spicer\n\n**CC:**  @williamstein\n\n**Keywords:** coprime, integer\n\n**Branch/Commit:** [482909f3df4ce42865420b4693135c16483195ad](https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Yann Laigle-Chapuy\n\n**Author:** Simon Spicer, David Roe\n\nIssue created by migration from https://trac.sagemath.org/ticket/15404\n\n",
    "closed_at": "2017-10-22T05:51:56Z",
    "created_at": "2013-11-12T17:00:23Z",
    "labels": [
        "component: basic arithmetic",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Change coprime_integers(n) in Integer class to use sieving instead of naive gcd",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15404",
    "user": "https://github.com/haikona"
}
```
As written currently, the coprime_integers(n) method in the Integer class uses gcd naively:

```
    def coprime_integers(self, m):
        ...
        v = []
        for n in range(1,m):
            if self.gcd(n) == 1:
                v.append(Integer(n))
        return v
```

This method should be rewritten to use sieving to speed things up.

**Assignee:** Simon Spicer

**CC:**  @williamstein

**Keywords:** coprime, integer

**Branch/Commit:** [482909f3df4ce42865420b4693135c16483195ad](https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad)

**Reviewer:** Frédéric Chapoton, Yann Laigle-Chapuy

**Author:** Simon Spicer, David Roe

Issue created by migration from https://trac.sagemath.org/ticket/15404





---

archive/issue_comments_235873.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-11-12T17:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235873",
    "user": "https://github.com/haikona"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_235874.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt can't work because this makes no sense:\n\n```\nfor p in self.prime_divisors: \n```",
    "created_at": "2013-11-12T18:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235874",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'></a>
It can't work because this makes no sense:

```
for p in self.prime_divisors: 
```



---

archive/issue_comments_235875.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-11-12T18:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235875",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from needs_review to needs_work.



---

archive/attachments_020435.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_15404.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket15404/trac_15404.patch",
    "created_at": "2013-11-12T19:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/haikona"
}
```



---

archive/issue_comments_235876.json:
```json
{
    "body": "Included missing parentheses. Doctests now properly pass.",
    "created_at": "2013-11-12T19:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235876",
    "user": "https://github.com/haikona"
}
```

Included missing parentheses. Doctests now properly pass.



---

archive/issue_comments_235877.json:
```json
{
    "body": "<a id='comment:3'></a>\nParentheses have been added.",
    "created_at": "2013-11-12T19:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235877",
    "user": "https://github.com/haikona"
}
```

<a id='comment:3'></a>
Parentheses have been added.



---

archive/issue_comments_235878.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2013-11-12T19:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235878",
    "user": "https://github.com/haikona"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_235879.json:
```json
{
    "body": "**Reviewer:** William Stein, Hao Chen",
    "created_at": "2013-11-12T20:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235879",
    "user": "https://github.com/williamstein"
}
```

**Reviewer:** William Stein, Hao Chen



---

archive/issue_comments_235880.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2013-11-12T20:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235880",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_235881.json:
```json
{
    "body": "<a id='comment:4'></a>\nHey, it's not 2011 anymore, as much as I like that number\n\n```\n    - Simon Spicer (2011-11-12): Rewritten to use sieving methods  \n```",
    "created_at": "2013-11-12T20:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235881",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:4'></a>
Hey, it's not 2011 anymore, as much as I like that number

```
    - Simon Spicer (2011-11-12): Rewritten to use sieving methods  
```



---

archive/attachments_020436.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_15404.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket15404/trac_15404.2.patch",
    "created_at": "2013-11-13T16:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/haikona"
}
```



---

archive/issue_comments_235882.json:
```json
{
    "body": "Fixes date typo, now uses naive method for small inputs.",
    "created_at": "2013-11-13T16:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235882",
    "user": "https://github.com/haikona"
}
```

Fixes date typo, now uses naive method for small inputs.



---

archive/issue_comments_235883.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew patch replaces previous patch. The method now uses naive gcd if both self and m are < 1000, since this seems to be faster.\n\nSome timings. Old code:\n\n```\nsage: %timeit 100.coprime_integers(100)\n10000 loops, best of 3: 44.5 us per loop\nsage: %timeit 101.coprime_integers(101)\n10000 loops, best of 3: 52.6 us per loop\nsage: %timeit 1000.coprime_integers(1000)\n1000 loops, best of 3: 529 us per loop\nsage: %timeit (10^6+12).coprime_integers(10^6+12)\n1 loops, best of 3: 603 ms per loop\nsage: %timeit (next_prime(10^6)).coprime_integers(10^6)\n1 loops, best of 3: 795 ms per loop\nsage: %timeit (10^8+512).coprime_integers(10^5)\n10 loops, best of 3: 55.9 ms per loop\nsage: %timeit (10^8+512).coprime_integers(10^7)\n1 loops, best of 3: 5.61 s per loop\n```\n\nNew code (without naive method for small inputs):\n\n```\nsage: %timeit 100.coprime_integers(100)\n10000 loops, best of 3: 145 us per loop\nsage: %timeit 101.coprime_integers(101)\n10000 loops, best of 3: 139 us per loop\nsage: %timeit 1000.coprime_integers(1000)\n1000 loops, best of 3: 510 us per loop\nsage: %timeit (10^6+12).coprime_integers(10^6+12)\n1 loops, best of 3: 373 ms per loop\nsage: %timeit (next_prime(10^6)).coprime_integers(10^6)\n1 loops, best of 3: 383 ms per loop\nsage: %timeit (10^8+512).coprime_integers(10^5)\n10 loops, best of 3: 39.8 ms per loop\nsage: %timeit (10^8+512).coprime_integers(10^7)\n1 loops, best of 3: 3.98 s per loop\n#MemoryError for m=10^8\n```\n\nThe new code should be faster when self has few prime factors, but both old and new code scale with m, the bound to which integers coprime to self are returned, since we need to fit that many sage integers in memory.",
    "created_at": "2013-11-13T17:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235883",
    "user": "https://github.com/haikona"
}
```

<a id='comment:5'></a>
New patch replaces previous patch. The method now uses naive gcd if both self and m are < 1000, since this seems to be faster.

Some timings. Old code:

```
sage: %timeit 100.coprime_integers(100)
10000 loops, best of 3: 44.5 us per loop
sage: %timeit 101.coprime_integers(101)
10000 loops, best of 3: 52.6 us per loop
sage: %timeit 1000.coprime_integers(1000)
1000 loops, best of 3: 529 us per loop
sage: %timeit (10^6+12).coprime_integers(10^6+12)
1 loops, best of 3: 603 ms per loop
sage: %timeit (next_prime(10^6)).coprime_integers(10^6)
1 loops, best of 3: 795 ms per loop
sage: %timeit (10^8+512).coprime_integers(10^5)
10 loops, best of 3: 55.9 ms per loop
sage: %timeit (10^8+512).coprime_integers(10^7)
1 loops, best of 3: 5.61 s per loop
```

New code (without naive method for small inputs):

```
sage: %timeit 100.coprime_integers(100)
10000 loops, best of 3: 145 us per loop
sage: %timeit 101.coprime_integers(101)
10000 loops, best of 3: 139 us per loop
sage: %timeit 1000.coprime_integers(1000)
1000 loops, best of 3: 510 us per loop
sage: %timeit (10^6+12).coprime_integers(10^6+12)
1 loops, best of 3: 373 ms per loop
sage: %timeit (next_prime(10^6)).coprime_integers(10^6)
1 loops, best of 3: 383 ms per loop
sage: %timeit (10^8+512).coprime_integers(10^5)
10 loops, best of 3: 39.8 ms per loop
sage: %timeit (10^8+512).coprime_integers(10^7)
1 loops, best of 3: 3.98 s per loop
#MemoryError for m=10^8
```

The new code should be faster when self has few prime factors, but both old and new code scale with m, the bound to which integers coprime to self are returned, since we need to fit that many sage integers in memory.



---

archive/issue_events_050834.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50834"
}
```



---

archive/issue_events_050835.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50835"
}
```



---

archive/issue_events_050836.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50836"
}
```



---

archive/issue_events_050837.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50837"
}
```



---

archive/issue_events_050838.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50838"
}
```



---

archive/issue_comments_235884.json:
```json
{
    "body": "**Branch:** [public/15404](https://github.com/sagemath/sagetrac-mirror/tree/public/15404)",
    "created_at": "2017-09-14T17:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235884",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [public/15404](https://github.com/sagemath/sagetrac-mirror/tree/public/15404)



---

archive/issue_comments_235885.json:
```json
{
    "body": "**Commit:** [f52e29cc41ca5fcba60c7a6409f684d280bfd56e](https://github.com/sagemath/sagetrac-mirror/commit/f52e29cc41ca5fcba60c7a6409f684d280bfd56e)",
    "created_at": "2017-09-14T17:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235885",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [f52e29cc41ca5fcba60c7a6409f684d280bfd56e](https://github.com/sagemath/sagetrac-mirror/commit/f52e29cc41ca5fcba60c7a6409f684d280bfd56e)



---

archive/issue_comments_235886.json:
```json
{
    "body": "<a id='comment:9'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f52e29cc41ca5fcba60c7a6409f684d280bfd56e\">f52e29c</a></td><td><code>trac 15404 sieve for coprime_integers</code></td></tr></table>\n",
    "created_at": "2017-09-14T17:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235886",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f52e29cc41ca5fcba60c7a6409f684d280bfd56e">f52e29c</a></td><td><code>trac 15404 sieve for coprime_integers</code></td></tr></table>




---

archive/issue_comments_235887.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-09-14T17:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235887",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_events_050839.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-09-14T17:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50839"
}
```



---

archive/issue_events_050840.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-09-14T17:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50840"
}
```



---

archive/issue_comments_235888.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-09-14T18:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235888",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_235889.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21081f288e38a3eacfeff00370a5c78b60493d7f\">21081f2</a></td><td><code>trac 15404 typo</code></td></tr></table>\n",
    "created_at": "2017-09-14T18:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21081f288e38a3eacfeff00370a5c78b60493d7f">21081f2</a></td><td><code>trac 15404 typo</code></td></tr></table>




---

archive/issue_comments_235890.json:
```json
{
    "body": "**Changing commit** from \"[f52e29cc41ca5fcba60c7a6409f684d280bfd56e](https://github.com/sagemath/sagetrac-mirror/commit/f52e29cc41ca5fcba60c7a6409f684d280bfd56e)\" to \"[21081f288e38a3eacfeff00370a5c78b60493d7f](https://github.com/sagemath/sagetrac-mirror/commit/21081f288e38a3eacfeff00370a5c78b60493d7f)\".",
    "created_at": "2017-09-14T18:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f52e29cc41ca5fcba60c7a6409f684d280bfd56e](https://github.com/sagemath/sagetrac-mirror/commit/f52e29cc41ca5fcba60c7a6409f684d280bfd56e)" to "[21081f288e38a3eacfeff00370a5c78b60493d7f](https://github.com/sagemath/sagetrac-mirror/commit/21081f288e38a3eacfeff00370a5c78b60493d7f)".



---

archive/issue_comments_235891.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-09-14T18:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235891",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_235892.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b01cb8d749419f463e91d65618961663464021a\">6b01cb8</a></td><td><code>New implementation for coprime_integers</code></td></tr></table>\n",
    "created_at": "2017-09-25T20:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235892",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b01cb8d749419f463e91d65618961663464021a">6b01cb8</a></td><td><code>New implementation for coprime_integers</code></td></tr></table>




---

archive/issue_comments_235893.json:
```json
{
    "body": "**Changing commit** from \"[21081f288e38a3eacfeff00370a5c78b60493d7f](https://github.com/sagemath/sagetrac-mirror/commit/21081f288e38a3eacfeff00370a5c78b60493d7f)\" to \"[6b01cb8d749419f463e91d65618961663464021a](https://github.com/sagemath/sagetrac-mirror/commit/6b01cb8d749419f463e91d65618961663464021a)\".",
    "created_at": "2017-09-25T20:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235893",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[21081f288e38a3eacfeff00370a5c78b60493d7f](https://github.com/sagemath/sagetrac-mirror/commit/21081f288e38a3eacfeff00370a5c78b60493d7f)" to "[6b01cb8d749419f463e91d65618961663464021a](https://github.com/sagemath/sagetrac-mirror/commit/6b01cb8d749419f463e91d65618961663464021a)".



---

archive/issue_comments_235894.json:
```json
{
    "body": "**Changing author** from \"Simon Spicer\" to \"Simon Spicer, David Roe\".",
    "created_at": "2017-09-25T20:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235894",
    "user": "https://github.com/roed314"
}
```

**Changing author** from "Simon Spicer" to "Simon Spicer, David Roe".



---

archive/issue_comments_235895.json:
```json
{
    "body": "<a id='comment:15'></a>\nI've written a new implementation that fixes some problems with the old and speeds it up:\n\n* It now handles the case that `self = 0` or negative and that `m` is too large or negative gracefully\n* It uses `trial_division()` rather than `prime_divisors()`, which will be faster and deals with the case that `self` has prime factors larger than `m` better.\n* It uses bit fiddling rather than a list of booleans.",
    "created_at": "2017-09-25T20:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235895",
    "user": "https://github.com/roed314"
}
```

<a id='comment:15'></a>
I've written a new implementation that fixes some problems with the old and speeds it up:

* It now handles the case that `self = 0` or negative and that `m` is too large or negative gracefully
* It uses `trial_division()` rather than `prime_divisors()`, which will be faster and deals with the case that `self` has prime factors larger than `m` better.
* It uses bit fiddling rather than a list of booleans.



---

archive/issue_comments_235896.json:
```json
{
    "body": "**Changing commit** from \"[6b01cb8d749419f463e91d65618961663464021a](https://github.com/sagemath/sagetrac-mirror/commit/6b01cb8d749419f463e91d65618961663464021a)\" to \"[d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2](https://github.com/sagemath/sagetrac-mirror/commit/d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2)\".",
    "created_at": "2017-09-26T01:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235896",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6b01cb8d749419f463e91d65618961663464021a](https://github.com/sagemath/sagetrac-mirror/commit/6b01cb8d749419f463e91d65618961663464021a)" to "[d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2](https://github.com/sagemath/sagetrac-mirror/commit/d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2)".



---

archive/issue_comments_235897.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2\">d0b1014</a></td><td><code>Fix bugs in coprime_integers</code></td></tr></table>\n",
    "created_at": "2017-09-26T01:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235897",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2">d0b1014</a></td><td><code>Fix bugs in coprime_integers</code></td></tr></table>




---

archive/issue_comments_235898.json:
```json
{
    "body": "**Changing reviewer** from \"William Stein, Hao Chen\" to \"Fr\u00e9d\u00e9ric Chapoton\".",
    "created_at": "2017-10-02T18:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235898",
    "user": "https://github.com/fchapoton"
}
```

**Changing reviewer** from "William Stein, Hao Chen" to "Frédéric Chapoton".



---

archive/issue_comments_235899.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-10-02T18:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235899",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_235900.json:
```json
{
    "body": "<a id='comment:17'></a>\nok",
    "created_at": "2017-10-02T18:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235900",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
ok



---

archive/issue_comments_235901.json:
```json
{
    "body": "<a id='comment:18'></a>\nJust my 2 cents: `mpz_divexact_ui` is expected to be faster than `mpz_fdiv_q`, and `mpz_sgn` instead of comparing to zero.\nAlso as you have `plong` available (why not unsigned?), it's probably better to use `mpz_cmp_si` and `mpz_divisible_ui_p`.\n\nAll this is nitpicking though.",
    "created_at": "2017-10-02T20:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235901",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:18'></a>
Just my 2 cents: `mpz_divexact_ui` is expected to be faster than `mpz_fdiv_q`, and `mpz_sgn` instead of comparing to zero.
Also as you have `plong` available (why not unsigned?), it's probably better to use `mpz_cmp_si` and `mpz_divisible_ui_p`.

All this is nitpicking though.



---

archive/issue_comments_235902.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [ylchapuy](#comment%3A18):\n>  and `mpz_sgn` instead of comparing to zero.\n\n\nOups, forget this was, I misread :)",
    "created_at": "2017-10-02T20:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235902",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:19'></a>
Replying to [ylchapuy](#comment%3A18):
>  and `mpz_sgn` instead of comparing to zero.


Oups, forget this was, I misread :)



---

archive/issue_comments_235903.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c9fa776a79efc782ed4fe2d4bbced68fbfb582e\">5c9fa77</a></td><td><code>Changing some gmp functions in coprime_integers and adjusting description of algorithm</code></td></tr></table>\n",
    "created_at": "2017-10-02T20:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c9fa776a79efc782ed4fe2d4bbced68fbfb582e">5c9fa77</a></td><td><code>Changing some gmp functions in coprime_integers and adjusting description of algorithm</code></td></tr></table>




---

archive/issue_comments_235904.json:
```json
{
    "body": "**Changing commit** from \"[d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2](https://github.com/sagemath/sagetrac-mirror/commit/d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2)\" to \"[5c9fa776a79efc782ed4fe2d4bbced68fbfb582e](https://github.com/sagemath/sagetrac-mirror/commit/5c9fa776a79efc782ed4fe2d4bbced68fbfb582e)\".",
    "created_at": "2017-10-02T20:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2](https://github.com/sagemath/sagetrac-mirror/commit/d0b1014e22a964ac8b2dc06989a0e7fdd64f3ad2)" to "[5c9fa776a79efc782ed4fe2d4bbced68fbfb582e](https://github.com/sagemath/sagetrac-mirror/commit/5c9fa776a79efc782ed4fe2d4bbced68fbfb582e)".



---

archive/issue_comments_235905.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2017-10-02T20:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_235906.json:
```json
{
    "body": "<a id='comment:21'></a>\nThanks.  I've adjusted `plong` and `ilong` to unsigned longs, adjusted the functions and described the algorithm correctly.",
    "created_at": "2017-10-02T20:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235906",
    "user": "https://github.com/roed314"
}
```

<a id='comment:21'></a>
Thanks.  I've adjusted `plong` and `ilong` to unsigned longs, adjusted the functions and described the algorithm correctly.



---

archive/issue_comments_235907.json:
```json
{
    "body": "<a id='comment:22'></a>\nAm I missing something (it's late here) or is this never happening: `mpz_tstbit(sieve.value, plong)` ?\nIf `p == m` it can't be composite because it's smallest factor would have been removed before.",
    "created_at": "2017-10-02T22:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235907",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:22'></a>
Am I missing something (it's late here) or is this never happening: `mpz_tstbit(sieve.value, plong)` ?
If `p == m` it can't be composite because it's smallest factor would have been removed before.



---

archive/issue_comments_235908.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbeb57c7a0128b1910f55018c9ce2da52df135a2\">bbeb57c</a></td><td><code>Remove extraneous tests in coprime_integers implementation</code></td></tr></table>\n",
    "created_at": "2017-10-04T16:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235908",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbeb57c7a0128b1910f55018c9ce2da52df135a2">bbeb57c</a></td><td><code>Remove extraneous tests in coprime_integers implementation</code></td></tr></table>




---

archive/issue_comments_235909.json:
```json
{
    "body": "**Changing commit** from \"[5c9fa776a79efc782ed4fe2d4bbced68fbfb582e](https://github.com/sagemath/sagetrac-mirror/commit/5c9fa776a79efc782ed4fe2d4bbced68fbfb582e)\" to \"[bbeb57c7a0128b1910f55018c9ce2da52df135a2](https://github.com/sagemath/sagetrac-mirror/commit/bbeb57c7a0128b1910f55018c9ce2da52df135a2)\".",
    "created_at": "2017-10-04T16:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5c9fa776a79efc782ed4fe2d4bbced68fbfb582e](https://github.com/sagemath/sagetrac-mirror/commit/5c9fa776a79efc782ed4fe2d4bbced68fbfb582e)" to "[bbeb57c7a0128b1910f55018c9ce2da52df135a2](https://github.com/sagemath/sagetrac-mirror/commit/bbeb57c7a0128b1910f55018c9ce2da52df135a2)".



---

archive/issue_comments_235910.json:
```json
{
    "body": "<a id='comment:24'></a>\nThanks.  I removed that and another test, which were left over from before I added the last break statement.",
    "created_at": "2017-10-04T16:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235910",
    "user": "https://github.com/roed314"
}
```

<a id='comment:24'></a>
Thanks.  I removed that and another test, which were left over from before I added the last break statement.



---

archive/issue_comments_235911.json:
```json
{
    "body": "**Changing reviewer** from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Yann Laigle-Chapuy\".",
    "created_at": "2017-10-06T08:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235911",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

**Changing reviewer** from "Frédéric Chapoton" to "Frédéric Chapoton, Yann Laigle-Chapuy".



---

archive/issue_comments_235912.json:
```json
{
    "body": "<a id='comment:25'></a>\nJust curious: what's the rationale for the added argument  `algorithm = None`? Are you planning to add another implementation?\n\nOtherwise LGTM.",
    "created_at": "2017-10-06T08:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235912",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:25'></a>
Just curious: what's the rationale for the added argument  `algorithm = None`? Are you planning to add another implementation?

Otherwise LGTM.



---

archive/issue_comments_235913.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-10-06T08:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235913",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_235914.json:
```json
{
    "body": "**Changing commit** from \"[bbeb57c7a0128b1910f55018c9ce2da52df135a2](https://github.com/sagemath/sagetrac-mirror/commit/bbeb57c7a0128b1910f55018c9ce2da52df135a2)\" to \"[224db94a29347649fba38805f8b9f40794d8a99a](https://github.com/sagemath/sagetrac-mirror/commit/224db94a29347649fba38805f8b9f40794d8a99a)\".",
    "created_at": "2017-10-06T09:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235914",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bbeb57c7a0128b1910f55018c9ce2da52df135a2](https://github.com/sagemath/sagetrac-mirror/commit/bbeb57c7a0128b1910f55018c9ce2da52df135a2)" to "[224db94a29347649fba38805f8b9f40794d8a99a](https://github.com/sagemath/sagetrac-mirror/commit/224db94a29347649fba38805f8b9f40794d8a99a)".



---

archive/issue_comments_235915.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/224db94a29347649fba38805f8b9f40794d8a99a\">224db94</a></td><td><code>Remove algorithm keyword</code></td></tr></table>\n",
    "created_at": "2017-10-06T09:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235915",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/224db94a29347649fba38805f8b9f40794d8a99a">224db94</a></td><td><code>Remove algorithm keyword</code></td></tr></table>




---

archive/issue_comments_235916.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2017-10-06T09:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_235917.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [ylchapuy](#comment%3A25):\n> Just curious: what's the rationale for the added argument  `algorithm = None`? Are you planning to add another implementation?\n\n\nThat was left over from when I was still experimenting with other implementations.\n\n> Otherwise LGTM.\n\n\nI've deleted it and set the ticket back to positive review.  Thanks!",
    "created_at": "2017-10-06T09:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235917",
    "user": "https://github.com/roed314"
}
```

<a id='comment:27'></a>
Replying to [ylchapuy](#comment%3A25):
> Just curious: what's the rationale for the added argument  `algorithm = None`? Are you planning to add another implementation?


That was left over from when I was still experimenting with other implementations.

> Otherwise LGTM.


I've deleted it and set the ticket back to positive review.  Thanks!



---

archive/issue_comments_235918.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-10-06T09:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235918",
    "user": "https://github.com/roed314"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_235919.json:
```json
{
    "body": "<a id='comment:28'></a>\nHum, gives me time out in `sage/groups/additive_abelian/qmodnz.py` the backtrace points to stuff here\n\n```\nStack backtrace\n---------------\nNo symbol table info available.\n#1  0x00007f83b5e85b53 in print_enhanced_backtrace () from /usr/lib64/python2.7/site-packages/cysignals/signals.so\nNo symbol table info available.\n#2  0x00007f83b5e85c4a in sigdie () from /usr/lib64/python2.7/site-packages/cysignals/signals.so\nNo symbol table info available.\n#3  0x00007f83b5e88247 in cysigs_signal_handler () from /usr/lib64/python2.7/site-packages/cysignals/signals.so\nNo symbol table info available.\n#4  <signal handler called>\nNo symbol table info available.\n#5  0x00007f83b52f0b6a in __gmpz_divexact_ui () from /usr/lib64/libgmp.so.10\nNo symbol table info available.\n#6  0x00007f83aa3ef26e in __pyx_pw_4sage_5rings_7integer_7Integer_131coprime_integers () from /usr/lib64/python2.7/site-packages/sage/rings/integer.so\nNo symbol table info available.\n```",
    "created_at": "2017-10-08T07:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235919",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:28'></a>
Hum, gives me time out in `sage/groups/additive_abelian/qmodnz.py` the backtrace points to stuff here

```
Stack backtrace
---------------
No symbol table info available.
#1  0x00007f83b5e85b53 in print_enhanced_backtrace () from /usr/lib64/python2.7/site-packages/cysignals/signals.so
No symbol table info available.
#2  0x00007f83b5e85c4a in sigdie () from /usr/lib64/python2.7/site-packages/cysignals/signals.so
No symbol table info available.
#3  0x00007f83b5e88247 in cysigs_signal_handler () from /usr/lib64/python2.7/site-packages/cysignals/signals.so
No symbol table info available.
#4  <signal handler called>
No symbol table info available.
#5  0x00007f83b52f0b6a in __gmpz_divexact_ui () from /usr/lib64/libgmp.so.10
No symbol table info available.
#6  0x00007f83aa3ef26e in __pyx_pw_4sage_5rings_7integer_7Integer_131coprime_integers () from /usr/lib64/python2.7/site-packages/sage/rings/integer.so
No symbol table info available.
```



---

archive/issue_comments_235920.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2017-10-08T07:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235920",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_235921.json:
```json
{
    "body": "<a id='comment:30'></a>\nHum, \n\n```sage\np = slf.trial_division(mlong, mpz_get_si(p.value)+1)\nilong = plong = mpz_get_ui(p.value)\n```\nthis might be problematic if `p` is set to `slf` and doesn't fit in a long.\n\nIf moreover `plong` end up being `1`, the `while mpz_divisible_ui_p(slf.value, plong):` loop will be infinite.",
    "created_at": "2017-10-08T16:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235921",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:30'></a>
Hum, 

```sage
p = slf.trial_division(mlong, mpz_get_si(p.value)+1)
ilong = plong = mpz_get_ui(p.value)
```
this might be problematic if `p` is set to `slf` and doesn't fit in a long.

If moreover `plong` end up being `1`, the `while mpz_divisible_ui_p(slf.value, plong):` loop will be infinite.



---

archive/issue_comments_235922.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [ylchapuy](#comment%3A30):\n> Hum, \n> \n> ```sage\n> p = slf.trial_division(mlong, mpz_get_si(p.value)+1)\n> ilong = plong = mpz_get_ui(p.value)\n> ```\n> this might be problematic if `p` is set to `slf` and doesn't fit in a long.\n\n\nThat can't happen since `trial_division` only goes up to the bound `mlong`.\n \n> If moreover `plong` end up being `1`, the `while mpz_divisible_ui_p(slf.value, plong):` loop will be infinite.\n\n\nThat can't happen since `trial_division` starts at `p+1`, which is at least 2.",
    "created_at": "2017-10-09T00:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235922",
    "user": "https://github.com/roed314"
}
```

<a id='comment:31'></a>
Replying to [ylchapuy](#comment%3A30):
> Hum, 
> 
> ```sage
> p = slf.trial_division(mlong, mpz_get_si(p.value)+1)
> ilong = plong = mpz_get_ui(p.value)
> ```
> this might be problematic if `p` is set to `slf` and doesn't fit in a long.


That can't happen since `trial_division` only goes up to the bound `mlong`.
 
> If moreover `plong` end up being `1`, the `while mpz_divisible_ui_p(slf.value, plong):` loop will be infinite.


That can't happen since `trial_division` starts at `p+1`, which is at least 2.



---

archive/issue_comments_235923.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [roed](#comment%3A31):\n> Replying to [ylchapuy](#comment%3A30):\n> > Hum, \n> > \n> > ```sage\n> > p = slf.trial_division(mlong, mpz_get_si(p.value)+1)\n> > ilong = plong = mpz_get_ui(p.value)\n> > ```\n> > this might be problematic if `p` is set to `slf` and doesn't fit in a long.\n\n> \n> That can't happen since `trial_division` only goes up to the bound `mlong`.\n\n\nOh, I was wrong: in this case `p` will equal `slf`.  I'll fix it.",
    "created_at": "2017-10-09T00:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235923",
    "user": "https://github.com/roed314"
}
```

<a id='comment:32'></a>
Replying to [roed](#comment%3A31):
> Replying to [ylchapuy](#comment%3A30):
> > Hum, 
> > 
> > ```sage
> > p = slf.trial_division(mlong, mpz_get_si(p.value)+1)
> > ilong = plong = mpz_get_ui(p.value)
> > ```
> > this might be problematic if `p` is set to `slf` and doesn't fit in a long.

> 
> That can't happen since `trial_division` only goes up to the bound `mlong`.


Oh, I was wrong: in this case `p` will equal `slf`.  I'll fix it.



---

archive/issue_comments_235924.json:
```json
{
    "body": "<a id='comment:33'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9fc7b4dba99945e66986775fc1325dd9512d612d\">9fc7b4d</a></td><td><code>Add sig_on/off in coprime_integers and fix broken comparison if p doesn't fit in long</code></td></tr></table>\n",
    "created_at": "2017-10-17T08:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235924",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9fc7b4dba99945e66986775fc1325dd9512d612d">9fc7b4d</a></td><td><code>Add sig_on/off in coprime_integers and fix broken comparison if p doesn't fit in long</code></td></tr></table>




---

archive/issue_comments_235925.json:
```json
{
    "body": "**Changing commit** from \"[224db94a29347649fba38805f8b9f40794d8a99a](https://github.com/sagemath/sagetrac-mirror/commit/224db94a29347649fba38805f8b9f40794d8a99a)\" to \"[9fc7b4dba99945e66986775fc1325dd9512d612d](https://github.com/sagemath/sagetrac-mirror/commit/9fc7b4dba99945e66986775fc1325dd9512d612d)\".",
    "created_at": "2017-10-17T08:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235925",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[224db94a29347649fba38805f8b9f40794d8a99a](https://github.com/sagemath/sagetrac-mirror/commit/224db94a29347649fba38805f8b9f40794d8a99a)" to "[9fc7b4dba99945e66986775fc1325dd9512d612d](https://github.com/sagemath/sagetrac-mirror/commit/9fc7b4dba99945e66986775fc1325dd9512d612d)".



---

archive/issue_comments_235926.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-10-17T08:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235926",
    "user": "https://github.com/roed314"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_235927.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-10-19T11:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235927",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_235928.json:
```json
{
    "body": "<a id='comment:35'></a>\nDo not compile.\n\n`mpz_cmp_si(p, mlong)` should be `mpz_cmp_si(p.value, mlong)`",
    "created_at": "2017-10-19T11:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235928",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:35'></a>
Do not compile.

`mpz_cmp_si(p, mlong)` should be `mpz_cmp_si(p.value, mlong)`



---

archive/issue_comments_235929.json:
```json
{
    "body": "<a id='comment:36'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd1c03ad334e526090305a0772d4e531672bf57d\">fd1c03a</a></td><td><code>Merge commit '9fc7b4dba9' into t/15404/public/15404</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f47b563bf6e18666ab78e89a940fa1ff3934d88\">4f47b56</a></td><td><code>Fix typo in coprime_integers</code></td></tr></table>\n",
    "created_at": "2017-10-19T14:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd1c03ad334e526090305a0772d4e531672bf57d">fd1c03a</a></td><td><code>Merge commit '9fc7b4dba9' into t/15404/public/15404</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f47b563bf6e18666ab78e89a940fa1ff3934d88">4f47b56</a></td><td><code>Fix typo in coprime_integers</code></td></tr></table>




---

archive/issue_comments_235930.json:
```json
{
    "body": "**Changing commit** from \"[9fc7b4dba99945e66986775fc1325dd9512d612d](https://github.com/sagemath/sagetrac-mirror/commit/9fc7b4dba99945e66986775fc1325dd9512d612d)\" to \"[4f47b563bf6e18666ab78e89a940fa1ff3934d88](https://github.com/sagemath/sagetrac-mirror/commit/4f47b563bf6e18666ab78e89a940fa1ff3934d88)\".",
    "created_at": "2017-10-19T14:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9fc7b4dba99945e66986775fc1325dd9512d612d](https://github.com/sagemath/sagetrac-mirror/commit/9fc7b4dba99945e66986775fc1325dd9512d612d)" to "[4f47b563bf6e18666ab78e89a940fa1ff3934d88](https://github.com/sagemath/sagetrac-mirror/commit/4f47b563bf6e18666ab78e89a940fa1ff3934d88)".



---

archive/issue_comments_235931.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-10-19T14:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235931",
    "user": "https://github.com/roed314"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_235932.json:
```json
{
    "body": "<a id='comment:37'></a>\nOops.  Fixed.",
    "created_at": "2017-10-19T14:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235932",
    "user": "https://github.com/roed314"
}
```

<a id='comment:37'></a>
Oops.  Fixed.



---

archive/issue_comments_235933.json:
```json
{
    "body": "<a id='comment:38'></a>\npatchbot failures",
    "created_at": "2017-10-19T16:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235933",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:38'></a>
patchbot failures



---

archive/issue_comments_235934.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-10-19T16:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235934",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_235935.json:
```json
{
    "body": "<a id='comment:39'></a>\nI think `self = 1` leads to an infinite loop.",
    "created_at": "2017-10-19T17:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235935",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:39'></a>
I think `self = 1` leads to an infinite loop.



---

archive/issue_comments_235936.json:
```json
{
    "body": "**Changing commit** from \"[4f47b563bf6e18666ab78e89a940fa1ff3934d88](https://github.com/sagemath/sagetrac-mirror/commit/4f47b563bf6e18666ab78e89a940fa1ff3934d88)\" to \"[482909f3df4ce42865420b4693135c16483195ad](https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad)\".",
    "created_at": "2017-10-19T19:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4f47b563bf6e18666ab78e89a940fa1ff3934d88](https://github.com/sagemath/sagetrac-mirror/commit/4f47b563bf6e18666ab78e89a940fa1ff3934d88)" to "[482909f3df4ce42865420b4693135c16483195ad](https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad)".



---

archive/issue_comments_235937.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad\">482909f</a></td><td><code>Fix two bugs in coprime_integers and add test</code></td></tr></table>\n",
    "created_at": "2017-10-19T19:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad">482909f</a></td><td><code>Fix two bugs in coprime_integers and add test</code></td></tr></table>




---

archive/issue_comments_235938.json:
```json
{
    "body": "<a id='comment:41'></a>\nYou're right. I've fixed that (plus a problem that would show up if `self` were negative) and added a test.",
    "created_at": "2017-10-19T19:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235938",
    "user": "https://github.com/roed314"
}
```

<a id='comment:41'></a>
You're right. I've fixed that (plus a problem that would show up if `self` were negative) and added a test.



---

archive/issue_comments_235939.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-10-19T19:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235939",
    "user": "https://github.com/roed314"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_235940.json:
```json
{
    "body": "<a id='comment:42'></a>\nTests pass....",
    "created_at": "2017-10-20T01:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235940",
    "user": "https://github.com/roed314"
}
```

<a id='comment:42'></a>
Tests pass....



---

archive/issue_comments_235941.json:
```json
{
    "body": "<a id='comment:43'></a>\nThe tests are a useful addition I think :)\nLGTM, bots problems seems unrelated",
    "created_at": "2017-10-21T16:20:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235941",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:43'></a>
The tests are a useful addition I think :)
LGTM, bots problems seems unrelated



---

archive/issue_comments_235942.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-10-21T16:20:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235942",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_050841.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-22T05:51:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15404#event-50841"
}
```



---

archive/issue_comments_235943.json:
```json
{
    "body": "**Changing branch** from \"[public/15404](https://github.com/sagemath/sagetrac-mirror/tree/public/15404)\" to \"[482909f3df4ce42865420b4693135c16483195ad](https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad)\".",
    "created_at": "2017-10-22T05:51:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15404#issuecomment-235943",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/15404](https://github.com/sagemath/sagetrac-mirror/tree/public/15404)" to "[482909f3df4ce42865420b4693135c16483195ad](https://github.com/sagemath/sagetrac-mirror/commit/482909f3df4ce42865420b4693135c16483195ad)".
