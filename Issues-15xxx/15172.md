# Issue 15172: update 4ti2 to version 1.6

archive/issues_014935.json:
```json
{
    "body": "version 1.6 is [released](http://4ti2.de).\n\nIntsall the updated [spkg](http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg) and apply [attachment:42.patch]\n\nCC:  @novoselt @miguelmarco dperkinson mhampton\n\nKeywords: 4ti2\n\nReviewer: Volker Braun\n\nAuthor: Dmitrii Pasechnik\n\nMerged: sage-5.13.beta1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15172\n\n",
    "closed_at": "2013-10-12T17:06:45Z",
    "created_at": "2013-09-07T13:25:11Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "update 4ti2 to version 1.6",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15172",
    "user": "https://github.com/dimpase"
}
```
version 1.6 is [released](http://4ti2.de).

Intsall the updated [spkg](http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg) and apply [attachment:42.patch]

CC:  @novoselt @miguelmarco dperkinson mhampton

Keywords: 4ti2

Reviewer: Volker Braun

Author: Dmitrii Pasechnik

Merged: sage-5.13.beta1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15172





---

archive/issue_comments_239532.json:
```json
{
    "body": "<a id='comment:1'></a>at the moment there is one test failure, which only occurs from `sage -t` run, but I can't reproduce it interactively:\n\n```\n$ ../../sage -t --optional='sage,4ti2' sage/interfaces/four_ti_2.py\nRunning doctests with ID 2013-09-07-09-09-54-b455bb50.\nDoctesting 1 file.\nsage -t sage/interfaces/four_ti_2.py\n**********************************************************************\nFile \"sage/interfaces/four_ti_2.py\", line 284, in sage.interfaces.four_ti_2.FourTi2.call\nFailed example:\n    four_ti_2.read_matrix(\"test_file.gro\") # optional - 4ti2\nExpected:\n    [-5  0  2]\n    [-5  3  0]\nGot:\n    []\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.interfaces.four_ti_2.FourTi2.call\n    [50 tests, 1 failure, 0.55 s]\n----------------------------------------------------------------------\nsage -t sage/interfaces/four_ti_2.py  # 1 doctest failed\n```",
    "created_at": "2013-09-07T13:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239532",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>at the moment there is one test failure, which only occurs from `sage -t` run, but I can't reproduce it interactively:

```
$ ../../sage -t --optional='sage,4ti2' sage/interfaces/four_ti_2.py
Running doctests with ID 2013-09-07-09-09-54-b455bb50.
Doctesting 1 file.
sage -t sage/interfaces/four_ti_2.py
**********************************************************************
File "sage/interfaces/four_ti_2.py", line 284, in sage.interfaces.four_ti_2.FourTi2.call
Failed example:
    four_ti_2.read_matrix("test_file.gro") # optional - 4ti2
Expected:
    [-5  0  2]
    [-5  3  0]
Got:
    []
**********************************************************************
1 item had failures:
   1 of   5 in sage.interfaces.four_ti_2.FourTi2.call
    [50 tests, 1 failure, 0.55 s]
----------------------------------------------------------------------
sage -t sage/interfaces/four_ti_2.py  # 1 doctest failed
```



---

archive/issue_comments_239533.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2013-09-07T13:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239533",
    "user": "https://github.com/dimpase"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_239534.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n version 1.6 is [released](http://4ti2.de).\n \n-The updated [spkg http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg]\n+Intsall the updated [spkg](http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg) and apply [attachment:42.patch]\n \n Work_Issues: tmp_dir related doctest issue\n \n``````\n",
    "created_at": "2013-09-07T13:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239534",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 version 1.6 is [released](http://4ti2.de).
 
-The updated [spkg http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg]
+Intsall the updated [spkg](http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg) and apply [attachment:42.patch]
 
 Work_Issues: tmp_dir related doctest issue
 
``````




---

archive/issue_comments_239535.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2013-09-07T13:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239535",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_239536.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2013-09-07T13:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239536",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_239537.json:
```json
{
    "body": "<a id='comment:4'></a>Why add `# optional - 4ti2` where it was not needed before?",
    "created_at": "2013-09-07T14:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239537",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Why add `# optional - 4ti2` where it was not needed before?



---

archive/issue_comments_239538.json:
```json
{
    "body": "<a id='comment:5'></a>The following\n\n```\n        cwd = os.getcwd() # Save working directory in order to restore it.\n        os.chdir(self.directory())\n\n        subprocess.call(cmd, shell=True)\n\n        os.chdir(cwd) # Restore previous working directory.\n```\nshould be replaced by\n\n```\n        subprocess.call(cmd, shell=True, cwd=self.directory())\n```",
    "created_at": "2013-09-07T14:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239538",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>The following

```
        cwd = os.getcwd() # Save working directory in order to restore it.
        os.chdir(self.directory())

        subprocess.call(cmd, shell=True)

        os.chdir(cwd) # Restore previous working directory.
```
should be replaced by

```
        subprocess.call(cmd, shell=True, cwd=self.directory())
```



---

archive/issue_comments_239539.json:
```json
{
    "body": "<a id='comment:6'></a>As I understand in the patch \"-q\" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?",
    "created_at": "2013-09-07T15:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239539",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:6'></a>As I understand in the patch "-q" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?



---

archive/issue_comments_239540.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 novoselt]:\n> As I understand in the patch \"-q\" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?\n\n\nthere is no '-q' switch for `ppi`, for some reason. So its stderr output needs to be silenced.",
    "created_at": "2013-09-07T17:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239540",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Replying to [comment:6 novoselt]:
> As I understand in the patch "-q" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?


there is no '-q' switch for `ppi`, for some reason. So its stderr output needs to be silenced.



---

archive/issue_comments_239541.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:5 jdemeyer]:\n\nDo you mean it's an equivalent way to do the same thing?\n\nOK, I'll change this. Meanwhile I just uploaded patch which fixes the issue that was stopping me here; it's actually due to filename semantics changed. Now `groebner bla.foo` appends the suffix `gro` to `bla.foo`, rather than replacing the suffix.",
    "created_at": "2013-09-07T17:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239541",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>Replying to [comment:5 jdemeyer]:

Do you mean it's an equivalent way to do the same thing?

OK, I'll change this. Meanwhile I just uploaded patch which fixes the issue that was stopping me here; it's actually due to filename semantics changed. Now `groebner bla.foo` appends the suffix `gro` to `bla.foo`, rather than replacing the suffix.



---

archive/issue_comments_239542.json:
```json
{
    "body": "Changing work_issues from \"tmp_dir related doctest issue\" to \"\"",
    "created_at": "2013-09-07T17:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239542",
    "user": "https://github.com/dimpase"
}
```

Changing work_issues from "tmp_dir related doctest issue" to ""



---

archive/issue_comments_239543.json:
```json
{
    "body": "Attachment [42.patch](tarball://root/attachments/some-uuid/ticket15172/42.patch) by @dimpase created at 2013-09-07 17:45:20\n\nupdated patch",
    "created_at": "2013-09-07T17:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239543",
    "user": "https://github.com/dimpase"
}
```

Attachment [42.patch](tarball://root/attachments/some-uuid/ticket15172/42.patch) by @dimpase created at 2013-09-07 17:45:20

updated patch



---

archive/issue_comments_239544.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-09-07T17:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239544",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239545.json:
```json
{
    "body": "<a id='comment:9'></a>OK, it looks as if I fixed everything.",
    "created_at": "2013-09-07T17:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239545",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>OK, it looks as if I fixed everything.



---

archive/issue_comments_239546.json:
```json
{
    "body": "<a id='comment:10'></a>There are quite a few changes in the `4ti2`-dependent part of `sandpile.py`, due to a change in output format of zslove, which prints matrix dimensions on one row now, and changed order in its output. Also, I needed to take care of deprecated `vertex_set` in `SimplicialComplex`.",
    "created_at": "2013-09-07T17:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239546",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>There are quite a few changes in the `4ti2`-dependent part of `sandpile.py`, due to a change in output format of zslove, which prints matrix dimensions on one row now, and changed order in its output. Also, I needed to take care of deprecated `vertex_set` in `SimplicialComplex`.



---

archive/issue_comments_239547.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:8 dimpase]:\n> Replying to [comment:5 jdemeyer]:\n> \n> Do you mean it's an equivalent way to do the same thing?\n\nEssentially yes. Instead of changing directory globally and then changing it back, we simply change directory for the executed command.",
    "created_at": "2013-09-07T22:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239547",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>Replying to [comment:8 dimpase]:
> Replying to [comment:5 jdemeyer]:
> 
> Do you mean it's an equivalent way to do the same thing?

Essentially yes. Instead of changing directory globally and then changing it back, we simply change directory for the executed command.



---

archive/issue_comments_239548.json:
```json
{
    "body": "<a id='comment:12'></a>I've made a small change in spkg-install. Now everything, not only executables, is installed, so  that one can link against 4ti2's libraries.",
    "created_at": "2013-09-09T02:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239548",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>I've made a small change in spkg-install. Now everything, not only executables, is installed, so  that one can link against 4ti2's libraries.



---

archive/issue_comments_239549.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-06T17:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239549",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_239550.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2013-10-06T17:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239550",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_239551.json:
```json
{
    "body": "<a id='comment:14'></a>Looks good to me.",
    "created_at": "2013-10-06T17:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239551",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>Looks good to me.



---

archive/issue_comments_239552.json:
```json
{
    "body": "Changing author from \"\" to \"Dmitrii Pasechnik\"",
    "created_at": "2013-10-06T17:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239552",
    "user": "https://github.com/vbraun"
}
```

Changing author from "" to "Dmitrii Pasechnik"



---

archive/issue_comments_239553.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-10-12T17:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239553",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_239554.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.13.beta1\"",
    "created_at": "2013-10-12T17:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15172#issuecomment-239554",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.13.beta1"



---

archive/issue_events_043756.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-12T17:06:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15172",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15172#event-43756"
}
```
