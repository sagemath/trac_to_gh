# Issue 15561: freetype 2.3.5 is too old for some fonts of current systems.

archive/issues_015324.json:
```json
{
    "assignees": [],
    "body": "The now-current freetype library has problems with newer fonts. This forbids its uses in some applications on machines having system fonts not supported by this version.\n\nThis was diagnosed on sage's R (see [this thread](https://groups.google.com/forum/#!topic/sage-support/FnTEcpfg6wE)) by Volker Braun.\n\nA stopgap measure is to upgrade freetype to a more forgiving version of freetype, hence this ticket.\n\nThe current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.  \n\nNew tarball: http://download.savannah.gnu.org/releases/freetype/freetype-2.5.2.tar.bz2\n\nDepends on #15539\n\nKeywords: **r-project graphics interfaces**\n\nBranch/Commit: **[u/charpent/ticket/15561](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/ticket/15561) @ [`c70498b`](https://github.com/sagemath/sagetrac-mirror/commit/c70498bb446188823dcb355b474938f3a8acfb8f)**\n\nReviewer: **Volker Braun**\n\nAuthor: **Emmanuel Charpentier, Volker Braun**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15561_\n\n",
    "closed_at": "2013-12-27T14:07:31Z",
    "created_at": "2013-12-21T07:49:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20graphics"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "freetype 2.3.5 is too old for some fonts of current systems.",
    "type": "issue",
    "updated_at": "2013-12-27T14:07:31Z",
    "url": "https://github.com/sagemath/sage/issues/15561",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
The now-current freetype library has problems with newer fonts. This forbids its uses in some applications on machines having system fonts not supported by this version.

This was diagnosed on sage's R (see [this thread](https://groups.google.com/forum/#!topic/sage-support/FnTEcpfg6wE)) by Volker Braun.

A stopgap measure is to upgrade freetype to a more forgiving version of freetype, hence this ticket.

The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.  

New tarball: http://download.savannah.gnu.org/releases/freetype/freetype-2.5.2.tar.bz2

Depends on #15539

Keywords: **r-project graphics interfaces**

Branch/Commit: **[u/charpent/ticket/15561](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/ticket/15561) @ [`c70498b`](https://github.com/sagemath/sagetrac-mirror/commit/c70498bb446188823dcb355b474938f3a8acfb8f)**

Reviewer: **Volker Braun**

Author: **Emmanuel Charpentier, Volker Braun**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/15561_





---

archive/issue_events_219719.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-21T07:49:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219719"
}
```



---

archive/issue_events_219720.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-21T07:49:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219720"
}
```



---

archive/issue_events_219721.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-21T07:49:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219721"
}
```



---

archive/issue_events_219722.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-21T07:49:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219722"
}
```



---

archive/issue_events_219723.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-21T07:49:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219723"
}
```



---

archive/issue_comments_194523.json:
```json
{
    "body": "Branch: **[u/charpent/ticket/15561](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/ticket/15561)**",
    "created_at": "2013-12-21T14:02:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194523",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Branch: **[u/charpent/ticket/15561](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/ticket/15561)**



---

archive/issue_comments_194524.json:
```json
{
    "body": "Commit: **[`f570a62`](https://github.com/sagemath/sagetrac-mirror/commit/f570a62601eea75502fa2bab4431643fa1cbc2c7)**",
    "created_at": "2013-12-21T15:31:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194524",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Commit: **[`f570a62`](https://github.com/sagemath/sagetrac-mirror/commit/f570a62601eea75502fa2bab4431643fa1cbc2c7)**



---

archive/issue_events_219724.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-21T15:31:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219724"
}
```



---

archive/issue_comments_194525.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nfreetype 2.5.2 installs flawlessly IFF libpng12 is patched to avoid a test for setting up error catching via setjmp in libpng12 (which freetype 2.5.2 does anyway).\n\nThe resulting sage passes make ptestlong and is able to draw a curve (from sage -R in console). So I think that this ticket is ready for review.\n\nSince it installs a newer version of a standard package and paches another onte, I think that it should be reviewed on various system (at least Mac OS X and/or Cygwin, which seem to be the most difficult cases) before clearing it.",
    "created_at": "2013-12-21T15:31:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194525",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:2" align="right">comment:2</div>

freetype 2.5.2 installs flawlessly IFF libpng12 is patched to avoid a test for setting up error catching via setjmp in libpng12 (which freetype 2.5.2 does anyway).

The resulting sage passes make ptestlong and is able to draw a curve (from sage -R in console). So I think that this ticket is ready for review.

Since it installs a newer version of a standard package and paches another onte, I think that it should be reviewed on various system (at least Mac OS X and/or Cygwin, which seem to be the most difficult cases) before clearing it.



---

archive/issue_events_219725.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-22T08:43:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219725"
}
```



---

archive/issue_events_219726.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-22T08:43:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219726"
}
```



---

archive/issue_comments_194526.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI have two problems with this branch :\n\n1) I seem to be unable to get this code back on an sage tree on another machine :\n\n```\nsage -dev checkout --ticket 15561\nsage -dev diff\n```\ngives me an empty diff...\n\n2) I added a new freetype tarball in upstream and deleted the previous one. None of this appears in the branch, at least as displayed on the trac page.\n\nI'll have to beg some help on sage-support...",
    "created_at": "2013-12-22T08:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194526",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:3" align="right">comment:3</div>

I have two problems with this branch :

1) I seem to be unable to get this code back on an sage tree on another machine :

```
sage -dev checkout --ticket 15561
sage -dev diff
```
gives me an empty diff...

2) I added a new freetype tarball in upstream and deleted the previous one. None of this appears in the branch, at least as displayed on the trac page.

I'll have to beg some help on sage-support...



---

archive/issue_comments_194527.json:
```json
{
    "body": "Attachment: **[freetype-2.5.2.tar.bz2.gz](https://github.com/sagemath/sage/files/ticket15561/freetype-2.5.2.tar.bz2.gz)**\n\nsource tarball of the new versioj of freetype",
    "created_at": "2013-12-22T13:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194527",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Attachment: **[freetype-2.5.2.tar.bz2.gz](https://github.com/sagemath/sage/files/ticket15561/freetype-2.5.2.tar.bz2.gz)**

source tarball of the new versioj of freetype



---

archive/issue_comments_194528.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis branch requires the [tarball](http://download.savannah.gnu.org/releases/freetype/freetype-2.5.2.tar.bz2)\u00a0of the new version of freetype, which is also attached to this ticket.",
    "created_at": "2013-12-22T13:18:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194528",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:4" align="right">comment:4</div>

This branch requires the [tarball](http://download.savannah.gnu.org/releases/freetype/freetype-2.5.2.tar.bz2) of the new version of freetype, which is also attached to this ticket.



---

archive/issue_comments_194529.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n This was diagnosed on sage's R (see [this thread](https://groups.google.com/forum/#!topic/sage-support/FnTEcpfg6wE)) by Volker Braun.\n \n-A stopgap measure would be to upgrade freetype to a more forgiving version of freetype, hence this ticket.\n+A stopgap measure is to upgrade freetype to a more forgiving version of freetype, hence this ticket.\n+\n+The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.\n``````\n",
    "created_at": "2013-12-22T15:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194529",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 This was diagnosed on sage's R (see [this thread](https://groups.google.com/forum/#!topic/sage-support/FnTEcpfg6wE)) by Volker Braun.
 
-A stopgap measure would be to upgrade freetype to a more forgiving version of freetype, hence this ticket.
+A stopgap measure is to upgrade freetype to a more forgiving version of freetype, hence this ticket.
+
+The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.
``````




---

archive/issue_comments_194530.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOkay, I am satisfied that my push ***was*** successful, and that the ansence of the new upstream tarball was intended. So I'm putting it up for review again.",
    "created_at": "2013-12-22T15:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194530",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:5" align="right">comment:5</div>

Okay, I am satisfied that my push ***was*** successful, and that the ansence of the new upstream tarball was intended. So I'm putting it up for review again.



---

archive/issue_events_219727.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-22T15:33:08Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "title_is": "freetype 2.3.5 is too old for some fonts of current systems.",
    "title_was": "freetype 2.3.5 is too old for some fonts",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219727"
}
```



---

archive/issue_events_219728.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-22T15:33:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219728"
}
```



---

archive/issue_events_219729.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-22T15:33:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219729"
}
```



---

archive/issue_comments_194531.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOkay, I am satisfied that my push ***was*** successful, and that the ansence of the new upstream tarball was intended. So I'm putting it up for review again.",
    "created_at": "2013-12-22T15:34:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194531",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:6" align="right">comment:6</div>

Okay, I am satisfied that my push ***was*** successful, and that the ansence of the new upstream tarball was intended. So I'm putting it up for review again.



---

archive/issue_comments_194532.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,6 @@\n \n A stopgap measure is to upgrade freetype to a more forgiving version of freetype, hence this ticket.\n \n-The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.\n+The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.  \n+\n+New tarball: http://download.savannah.gnu.org/releases/freetype/freetype-2.5.2.tar.bz2\n``````\n",
    "created_at": "2013-12-22T17:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194532",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,6 @@
 
 A stopgap measure is to upgrade freetype to a more forgiving version of freetype, hence this ticket.
 
-The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.
+The current freetype tarball hits a snag in libpng, because it uses setjmp for exception handling, which triggers a compiler error due to this settinng up been made twice. So a small patch to the current libpng is part of this branch.  
+
+New tarball: http://download.savannah.gnu.org/releases/freetype/freetype-2.5.2.tar.bz2
``````




---

archive/issue_comments_194533.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2013-12-23T12:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194533",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_events_219730.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-23T12:16:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219730"
}
```



---

archive/issue_events_219731.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-23T12:16:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219731"
}
```



---

archive/issue_comments_194534.json:
```json
{
    "body": "Dependencies: **#15539**",
    "created_at": "2013-12-23T15:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194534",
    "user": "https://github.com/vbraun"
}
```

Dependencies: **#15539**



---

archive/issue_comments_194535.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nBreaks PIL, so I'm setting #15539 as dep",
    "created_at": "2013-12-23T15:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194535",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Breaks PIL, so I'm setting #15539 as dep



---

archive/issue_comments_194536.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nBuild errors:\n* http://build.sagemath.org/sage/builders/%20%20fast%20UW%20redhawk%20%28Ubuntu%2010.04%20x86_64%29%20incremental/builds/27/steps/compile/logs/freetype\n* http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26/steps/compile/logs/freetype",
    "created_at": "2013-12-23T15:36:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194536",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

Build errors:
* http://build.sagemath.org/sage/builders/%20%20fast%20UW%20redhawk%20%28Ubuntu%2010.04%20x86_64%29%20incremental/builds/27/steps/compile/logs/freetype
* http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26/steps/compile/logs/freetype



---

archive/issue_events_219732.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-23T15:36:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219732"
}
```



---

archive/issue_events_219733.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-23T15:36:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219733"
}
```



---

archive/issue_comments_194537.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@vbraun](#comment%3A10):\n\n> Build errors: * http://build.sagemath.org/sage/builders/%20%20fast%20UW%20redhawk%20%28Ubuntu%2010.04%20x86_64%29%20incremental/builds/27/steps/compile/logs/freetype * http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26/steps/compile/logs/freetype\n\nAhiii ! That's the snag in libpng that triggered me to patch pngconf.h. How can i check that this patch has been applied ? This error (horror ?) originates in a code section that I #defined around...\n\nEdit, Dec 25 : I see *another* build problem with PIL and freetype. but I could diagnose it only by creating a new sage tree and git'ing !#15661 directly : adding #15561 to an already compiled tree does not force recompilation of PIL.\n\nThe problem :\u00a0\n\n```\n[ ... ]\n\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/home/charpent/sagebis/sage/local/include/freetype2 -IlibImaging -I/home/charpent/sagebis/sage/local/include -I/usr/include -I/home/charpent/sagebis/sage/local/include/python2.7 -c _imagingft.c -o build/temp.linux-x86_64-2.7/_imagingft.o\n_imagingft.c:68:31: fatal error: freetype/fterrors.h: Aucun fichier ou dossier de ce type\n\u00a0#include <freetype/fterrors.h>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ^\ncompilation terminated.\nerror: command 'gcc' failed with exit status 1\n\n[ ... ]\n```\nThis happens twice (PIL attemps compilation with and without Tkinter support). This is caused by the fact that the directory containing freetype headers is no longer local/include/freetype but local/include/freetype2.\n\nSince Pillow is now accepted in the next sage, my plan is :\n\n* start a new tree\n* fetch the Pillow branch (for rebase ?)\n* fetch !#15561 and adjust it.\n\nYour thoughts ?",
    "created_at": "2013-12-23T18:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194537",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@vbraun](#comment%3A10):

> Build errors: * http://build.sagemath.org/sage/builders/%20%20fast%20UW%20redhawk%20%28Ubuntu%2010.04%20x86_64%29%20incremental/builds/27/steps/compile/logs/freetype * http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26/steps/compile/logs/freetype

Ahiii ! That's the snag in libpng that triggered me to patch pngconf.h. How can i check that this patch has been applied ? This error (horror ?) originates in a code section that I #defined around...

Edit, Dec 25 : I see *another* build problem with PIL and freetype. but I could diagnose it only by creating a new sage tree and git'ing !#15661 directly : adding #15561 to an already compiled tree does not force recompilation of PIL.

The problem : 

```
[ ... ]

gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/home/charpent/sagebis/sage/local/include/freetype2 -IlibImaging -I/home/charpent/sagebis/sage/local/include -I/usr/include -I/home/charpent/sagebis/sage/local/include/python2.7 -c _imagingft.c -o build/temp.linux-x86_64-2.7/_imagingft.o
_imagingft.c:68:31: fatal error: freetype/fterrors.h: Aucun fichier ou dossier de ce type
 #include <freetype/fterrors.h>
                               ^
compilation terminated.
error: command 'gcc' failed with exit status 1

[ ... ]
```
This happens twice (PIL attemps compilation with and without Tkinter support). This is caused by the fact that the directory containing freetype headers is no longer local/include/freetype but local/include/freetype2.

Since Pillow is now accepted in the next sage, my plan is :

* start a new tree
* fetch the Pillow branch (for rebase ?)
* fetch !#15561 and adjust it.

Your thoughts ?



---

archive/issue_comments_194538.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAnother question : should I merge #15539 and #15561 (and test with Pillow instead of PIL) ?",
    "created_at": "2013-12-23T18:34:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194538",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:12" align="right">comment:12</div>

Another question : should I merge #15539 and #15561 (and test with Pillow instead of PIL) ?



---

archive/issue_comments_194539.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYou should merge in the Pillow ticket, but its not ready yet (i.e. doesn't build).",
    "created_at": "2013-12-23T20:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194539",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

You should merge in the Pillow ticket, but its not ready yet (i.e. doesn't build).



---

archive/issue_comments_194540.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYou need to bump the libpng patchlevel to force a rebuild (libpng/package-version.txt). Otherwise it won't be built.",
    "created_at": "2013-12-23T22:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194540",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:14" align="right">comment:14</div>

You need to bump the libpng patchlevel to force a rebuild (libpng/package-version.txt). Otherwise it won't be built.



---

archive/issue_comments_194541.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@vbraun](#comment%3A14):\n\n> You need to bump the libpng patchlevel to force a rebuild (libpng/package-version.txt). Otherwise it won't be built.\n\nThis I do not understand : #15561 ***does*** bump libpng (from 1.2.35.p5 to 1.2.25p6) and freetype (from 2.3.5.p4 to 2.5.2.p0) ; #15539 does ***not*** touch libpng nor freetype (it *uses* them ***as is***). Is there another proposed branch that bumps libpng ? If so, how can I find it ?",
    "created_at": "2013-12-25T09:15:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194541",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@vbraun](#comment%3A14):

> You need to bump the libpng patchlevel to force a rebuild (libpng/package-version.txt). Otherwise it won't be built.

This I do not understand : #15561 ***does*** bump libpng (from 1.2.35.p5 to 1.2.25p6) and freetype (from 2.3.5.p4 to 2.5.2.p0) ; #15539 does ***not*** touch libpng nor freetype (it *uses* them ***as is***). Is there another proposed branch that bumps libpng ? If so, how can I find it ?



---

archive/issue_comments_194542.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@vbraun](#comment%3A13):\n\n> You should merge in the Pillow ticket, but its not ready yet (i.e. doesn't build).\n\nWould that be a merge (i. e. creating a branch incorporating changes both from #15539 an #15561) or a rebase (i. e. creating a patch that *assumes* that #15539 has been incorporated) ?\n\nNow that 15539 is closed as \"fixed\", rebasing sounds logical. What do you advise ?",
    "created_at": "2013-12-25T09:19:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194542",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@vbraun](#comment%3A13):

> You should merge in the Pillow ticket, but its not ready yet (i.e. doesn't build).

Would that be a merge (i. e. creating a branch incorporating changes both from #15539 an #15561) or a rebase (i. e. creating a patch that *assumes* that #15539 has been incorporated) ?

Now that 15539 is closed as "fixed", rebasing sounds logical. What do you advise ?



---

archive/issue_comments_194543.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nYou should always merge (and never rebase) branches that are already published on trac, since somebody else might have used that already as a base for their own branch.\n\nHere is the full buildbot log: http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26\n\nIt did compile libpng-1.2.35.p6, so thats your ticket.",
    "created_at": "2013-12-25T13:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194543",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:17" align="right">comment:17</div>

You should always merge (and never rebase) branches that are already published on trac, since somebody else might have used that already as a base for their own branch.

Here is the full buildbot log: http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26

It did compile libpng-1.2.35.p6, so thats your ticket.



---

archive/issue_comments_194544.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@vbraun](#comment%3A17):\n\n> You should always merge (and never rebase) branches that are already published on trac, since somebody else might have used that already as a base for their own branch. \n\nOkay. Can't say I fully understand it yet, but I did that.\n\n> Here is the full buildbot log: http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26 It did compile libpng-1.2.35.p6, so thats your ticket.\n\nIndeed ! Don't understand it either. I just restarted a clean tree, used git (not sage's scripts) to fetch Pillow and #15561 in separate local branches, merged Pillow in 15561 and compiled (successfully).\n\nIn the full buildbot log, the error points at pngconf.h line 328. That's the place where the error takes places while using the *unpatched* pngconf.h ; with the patched pngconf.h, the error should take place on line 334.\n\nIs it possible that buildbot's freetype compilation might pickup an unpatched (possibly system's) pngconf.h ? If so, how to prevent this from happening ?",
    "created_at": "2013-12-25T19:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194544",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@vbraun](#comment%3A17):

> You should always merge (and never rebase) branches that are already published on trac, since somebody else might have used that already as a base for their own branch. 

Okay. Can't say I fully understand it yet, but I did that.

> Here is the full buildbot log: http://build.sagemath.org/sage/builders/%20%20fast%20UW%20mod%20%28Ubuntu%208.04%20x86_64%29%20incremental/builds/26 It did compile libpng-1.2.35.p6, so thats your ticket.

Indeed ! Don't understand it either. I just restarted a clean tree, used git (not sage's scripts) to fetch Pillow and #15561 in separate local branches, merged Pillow in 15561 and compiled (successfully).

In the full buildbot log, the error points at pngconf.h line 328. That's the place where the error takes places while using the *unpatched* pngconf.h ; with the patched pngconf.h, the error should take place on line 334.

Is it possible that buildbot's freetype compilation might pickup an unpatched (possibly system's) pngconf.h ? If so, how to prevent this from happening ?



---

archive/issue_comments_194545.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nLooking at build/deps, the freetype package does not depend on libpng so will potentially build at the same time. Might be a race condition.",
    "created_at": "2013-12-25T19:59:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194545",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

Looking at build/deps, the freetype package does not depend on libpng so will potentially build at the same time. Might be a race condition.



---

archive/issue_comments_194546.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@vbraun](#comment%3A19):\n\n> Looking at build/deps, the freetype package does not depend on libpng so will potentially build at the same time. Might be a race condition.\n\nOuch ! Freetype depends on libpng, but libpng needs to be patched *first*, which means it can't be patched by freetype's branch, if I understand that correctly. The only way out I see is :\n\n1. create a new branch patching libpng in a ticket #xx\n2. wait for #xx to get reviewed and getting to state \"fixed\", and\n3. modify #15561 to depend on #xx.\n\nI don't see how this can be made in one ticket. Do you have different thoughts ?",
    "created_at": "2013-12-25T20:18:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194546",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@vbraun](#comment%3A19):

> Looking at build/deps, the freetype package does not depend on libpng so will potentially build at the same time. Might be a race condition.

Ouch ! Freetype depends on libpng, but libpng needs to be patched *first*, which means it can't be patched by freetype's branch, if I understand that correctly. The only way out I see is :

1. create a new branch patching libpng in a ticket #xx
2. wait for #xx to get reviewed and getting to state "fixed", and
3. modify #15561 to depend on #xx.

I don't see how this can be made in one ticket. Do you have different thoughts ?



---

archive/issue_comments_194547.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nNo, you can do everything in your current branch.",
    "created_at": "2013-12-25T20:20:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194547",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:21" align="right">comment:21</div>

No, you can do everything in your current branch.



---

archive/issue_comments_194548.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@vbraun](#comment%3A21):\n\n> No, you can do everything in your current branch.\n\nI don't see how to. Care to enlighten the dummy of the day ?",
    "created_at": "2013-12-25T20:26:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194548",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@vbraun](#comment%3A21):

> No, you can do everything in your current branch.

I don't see how to. Care to enlighten the dummy of the day ?



---

archive/issue_comments_194549.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIf that race is actually the problem then you only have to add the dependency to `build/deps`. Then libpng will be built first (and patched as part of its build process), and then freetype will be built afterward. I think I'm missing the problem here, but in any case that should work (TM).",
    "created_at": "2013-12-25T20:45:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194549",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">comment:23</div>

If that race is actually the problem then you only have to add the dependency to `build/deps`. Then libpng will be built first (and patched as part of its build process), and then freetype will be built afterward. I think I'm missing the problem here, but in any case that should work (TM).



---

archive/issue_comments_194550.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c70498b\"><code>c70498b</code></a></td><td><code>buid/deps : added a dependency of freetype on libpng in order to work around a build-time race condition.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bedf0d8\"><code>bedf0d8</code></a></td><td><code>Merge branch 'pillow' into ticket/15561</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f005905\"><code>f005905</code></a></td><td><code>pillow: depends on setuptools</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adc90ce\"><code>adc90ce</code></a></td><td><code>Pillow -> pillow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8987381\"><code>8987381</code></a></td><td><code>remove PIL (it has been replaced by Pillow)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c055bd\"><code>2c055bd</code></a></td><td><code>Pillow: fix patch to work against 2.2.2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6690d97\"><code>6690d97</code></a></td><td><code>doc: remove now unused environment variables</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3778f42\"><code>3778f42</code></a></td><td><code>Pillow: re-resolve #9864</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6df0adb\"><code>6df0adb</code></a></td><td><code>replace PIL with Pillow</code></td></tr></table>\n",
    "created_at": "2013-12-25T21:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194550",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c70498b"><code>c70498b</code></a></td><td><code>buid/deps : added a dependency of freetype on libpng in order to work around a build-time race condition.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bedf0d8"><code>bedf0d8</code></a></td><td><code>Merge branch 'pillow' into ticket/15561</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f005905"><code>f005905</code></a></td><td><code>pillow: depends on setuptools</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adc90ce"><code>adc90ce</code></a></td><td><code>Pillow -> pillow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8987381"><code>8987381</code></a></td><td><code>remove PIL (it has been replaced by Pillow)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c055bd"><code>2c055bd</code></a></td><td><code>Pillow: fix patch to work against 2.2.2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6690d97"><code>6690d97</code></a></td><td><code>doc: remove now unused environment variables</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3778f42"><code>3778f42</code></a></td><td><code>Pillow: re-resolve #9864</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6df0adb"><code>6df0adb</code></a></td><td><code>replace PIL with Pillow</code></td></tr></table>




---

archive/issue_comments_194551.json:
```json
{
    "body": "Changed commit from **[`f570a62`](https://github.com/sagemath/sagetrac-mirror/commit/f570a62601eea75502fa2bab4431643fa1cbc2c7)** to **[`c70498b`](https://github.com/sagemath/sagetrac-mirror/commit/c70498bb446188823dcb355b474938f3a8acfb8f)**",
    "created_at": "2013-12-25T21:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194551",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f570a62`](https://github.com/sagemath/sagetrac-mirror/commit/f570a62601eea75502fa2bab4431643fa1cbc2c7)** to **[`c70498b`](https://github.com/sagemath/sagetrac-mirror/commit/c70498bb446188823dcb355b474938f3a8acfb8f)**



---

archive/issue_events_219734.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-25T21:31:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219734"
}
```



---

archive/issue_events_219735.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2013-12-25T21:31:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219735"
}
```



---

archive/issue_comments_194552.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@vbraun](#comment%3A23):\n\n> If that race is actually the problem then you only have to add the dependency to `build/deps` . Then libpng will be built first (and patched as part of its build process), and then freetype will be built afterward. I think I'm missing the problem here, but in any case that should work (TM).\n\nOkay. I did that, pushed the commit and updated status to \"needs review\". I'm curious about the buildbot's behaviour...\n\nEdit, a bit later : the resulting tree passes the '(make distclean ; make )' test in an enviroment where MAKE is \"make -j8\". So it *can* be built in a parallel setting.",
    "created_at": "2013-12-25T21:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15561#issuecomment-194552",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@vbraun](#comment%3A23):

> If that race is actually the problem then you only have to add the dependency to `build/deps` . Then libpng will be built first (and patched as part of its build process), and then freetype will be built afterward. I think I'm missing the problem here, but in any case that should work (TM).

Okay. I did that, pushed the commit and updated status to "needs review". I'm curious about the buildbot's behaviour...

Edit, a bit later : the resulting tree passes the '(make distclean ; make )' test in an enviroment where MAKE is "make -j8". So it *can* be built in a parallel setting.



---

archive/issue_events_219736.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-27T14:07:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219736"
}
```



---

archive/issue_events_219737.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3e449b21d5cb9a46f6c07a14db9838ead59a7128",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2013-12-27T14:07:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15561",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15561#event-219737"
}
```
