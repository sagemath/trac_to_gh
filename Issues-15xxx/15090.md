# Issue 15090: Make random matrices respect Sage's seed for random number generators

archive/issues_014853.json:
```json
{
    "body": "GSL distributions are used in the creation of random matrices, so they need to be seeded with an integer from Sage's random number generators in order to make the results predictably random.  Then the random matrices will be reproducible for doctests (#10122) and for WeBWorK homework exercises provided by AskSage with a random seed from the WeBWorK system.  Symptomatic of the current state is:\n\n```\nsage: from sage.matrix.constructor import random_rref_matrix\nsage: MS = MatrixSpace(QQ, 5, 8)\n\nsage: set_random_seed(666)\nsage: first = [random_rref_matrix(MS, 4) for _ in range(10)]\n\nsage: set_random_seed(666)\nsage: second = [random_rref_matrix(MS, 4) for _ in range(10)]\n\nsage: first == second\nFalse\n```\n\nDo not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks this ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)\n\n**Apply:**\n\n1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds-v2.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds-v2.patch-macro)\n\nCC:  @dimpase\n\nAuthor: Rob Beezer\n\nDependencies: #11772\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15090\n\n",
    "closed_at": "2014-10-27T16:26:27Z",
    "created_at": "2013-08-23T20:37:37Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Make random matrices respect Sage's seed for random number generators",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15090",
    "user": "https://github.com/rbeezer"
}
```
GSL distributions are used in the creation of random matrices, so they need to be seeded with an integer from Sage's random number generators in order to make the results predictably random.  Then the random matrices will be reproducible for doctests (#10122) and for WeBWorK homework exercises provided by AskSage with a random seed from the WeBWorK system.  Symptomatic of the current state is:

```
sage: from sage.matrix.constructor import random_rref_matrix
sage: MS = MatrixSpace(QQ, 5, 8)

sage: set_random_seed(666)
sage: first = [random_rref_matrix(MS, 4) for _ in range(10)]

sage: set_random_seed(666)
sage: second = [random_rref_matrix(MS, 4) for _ in range(10)]

sage: first == second
False
```

Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks this ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)

**Apply:**

1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds-v2.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds-v2.patch-macro)

CC:  @dimpase

Author: Rob Beezer

Dependencies: #11772

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15090





---

archive/issue_comments_234522.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#11772\"",
    "created_at": "2013-08-23T21:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234522",
    "user": "https://github.com/rbeezer"
}
```

Changing dependencies from "" to "#11772"



---

archive/issue_events_057556.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "rename": {
        "from": "Make random matrices respect Sage's seed for random number gnerators",
        "to": "Make random matrices respect Sage's seed for random number generators"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57556"
}
```



---

archive/issue_comments_234523.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,6 @@\n False\n ```\n \n+**Apply:**\n+\n+1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds.patch-macro)\n``````\n",
    "created_at": "2013-08-23T21:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234523",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,6 @@
 False
 ```
 
+**Apply:**
+
+1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds.patch-macro)
``````




---

archive/issue_comments_234524.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [trac_15090-random-matrix-seeds.patch](tarball://root/attachments/some-uuid/ticket15090/trac_15090-random-matrix-seeds.patch) by @rbeezer created at 2013-08-23 21:57:21",
    "created_at": "2013-08-23T21:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234524",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:1'></a>
Attachment [trac_15090-random-matrix-seeds.patch](tarball://root/attachments/some-uuid/ticket15090/trac_15090-random-matrix-seeds.patch) by @rbeezer created at 2013-08-23 21:57:21



---

archive/issue_comments_234525.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-08-23T21:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234525",
    "user": "https://github.com/rbeezer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_234526.json:
```json
{
    "body": "Changing author from \"\" to \"Rob Beezer\"",
    "created_at": "2013-08-23T21:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234526",
    "user": "https://github.com/rbeezer"
}
```

Changing author from "" to "Rob Beezer"



---

archive/issue_comments_234527.json:
```json
{
    "body": "Update, standalone",
    "created_at": "2013-08-26T18:14:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234527",
    "user": "https://github.com/rbeezer"
}
```

Update, standalone



---

archive/issue_comments_234528.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,4 @@\n \n **Apply:**\n \n-1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds.patch-macro)\n+1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds-v2.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds-v2.patch-macro)\n``````\n",
    "created_at": "2013-08-26T18:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234528",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,4 @@
 
 **Apply:**
 
-1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds.patch-macro)
+1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds-v2.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds-v2.patch-macro)
``````




---

archive/issue_comments_234529.json:
```json
{
    "body": "<a id='comment:2'></a>\nAttachment [trac_15090-random-matrix-seeds-v2.patch](tarball://root/attachments/some-uuid/ticket15090/trac_15090-random-matrix-seeds-v2.patch) by @rbeezer created at 2013-08-26 18:17:28\n\n\"v2\" patch is self-contained.  Minor parameter changes in new doctests which will better exercise fixes, and a few new comments with guidance about possible future code adjustments.  No new code.",
    "created_at": "2013-08-26T18:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234529",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:2'></a>
Attachment [trac_15090-random-matrix-seeds-v2.patch](tarball://root/attachments/some-uuid/ticket15090/trac_15090-random-matrix-seeds-v2.patch) by @rbeezer created at 2013-08-26 18:17:28

"v2" patch is self-contained.  Minor parameter changes in new doctests which will better exercise fixes, and a few new comments with guidance about possible future code adjustments.  No new code.



---

archive/issue_comments_234530.json:
```json
{
    "body": "<a id='comment:3'></a>\nI get some random_matrix doctests failing:\n\n```\n**********************************************************************\nFile \"constructor.py\", line 1175, in sage.matrix.constructor.random_matrix\nFailed example:\n    random_matrix(RR, 3, 4, density=0.66)\nExpected:\n    [ 0.000000000000000 -0.806696574554030 -0.693915509972359  0.000000000000000]\n    [ 0.629781664418083  0.000000000000000 -0.833709843116637  0.000000000000000]\n    [ 0.922346867410064  0.000000000000000  0.000000000000000 -0.940316454178921]\nGot:\n    [  0.000000000000000 -0.0929719759949936   0.676820913302280   0.000000000000000]\n    [ -0.741052529138296   0.000000000000000  -0.806696574554030   0.000000000000000]\n    [ -0.940316454178921   0.000000000000000   0.000000000000000  -0.614664118017468]\n**********************************************************************\nFile \"constructor.py\", line 1180, in sage.matrix.constructor.random_matrix\nFailed example:\n    A = random_matrix(ComplexField(32), 3, density=0.8, sparse=True); A\nExpected:\n    [                 0.000000000  0.399739209 + 0.909948633*I                  0.000000000]\n    [-0.361911424 - 0.455087671*I -0.687810605 + 0.460619713*I  0.625520058 - 0.360952012*I]\n    [                 0.000000000                  0.000000000 -0.162196416 - 0.193242896*I]\nGot:\n    [                 0.000000000  0.877097711 - 0.662290146*I                  0.000000000]\n    [0.700430447 + 0.0870635174*I  0.332155072 - 0.728572036*I -0.361911424 - 0.455087671*I]\n    [                 0.000000000                  0.000000000  0.577682751 - 0.276405104*I]\n```",
    "created_at": "2013-08-27T18:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234530",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
I get some random_matrix doctests failing:

```
**********************************************************************
File "constructor.py", line 1175, in sage.matrix.constructor.random_matrix
Failed example:
    random_matrix(RR, 3, 4, density=0.66)
Expected:
    [ 0.000000000000000 -0.806696574554030 -0.693915509972359  0.000000000000000]
    [ 0.629781664418083  0.000000000000000 -0.833709843116637  0.000000000000000]
    [ 0.922346867410064  0.000000000000000  0.000000000000000 -0.940316454178921]
Got:
    [  0.000000000000000 -0.0929719759949936   0.676820913302280   0.000000000000000]
    [ -0.741052529138296   0.000000000000000  -0.806696574554030   0.000000000000000]
    [ -0.940316454178921   0.000000000000000   0.000000000000000  -0.614664118017468]
**********************************************************************
File "constructor.py", line 1180, in sage.matrix.constructor.random_matrix
Failed example:
    A = random_matrix(ComplexField(32), 3, density=0.8, sparse=True); A
Expected:
    [                 0.000000000  0.399739209 + 0.909948633*I                  0.000000000]
    [-0.361911424 - 0.455087671*I -0.687810605 + 0.460619713*I  0.625520058 - 0.360952012*I]
    [                 0.000000000                  0.000000000 -0.162196416 - 0.193242896*I]
Got:
    [                 0.000000000  0.877097711 - 0.662290146*I                  0.000000000]
    [0.700430447 + 0.0870635174*I  0.332155072 - 0.728572036*I -0.361911424 - 0.455087671*I]
    [                 0.000000000                  0.000000000  0.577682751 - 0.276405104*I]
```



---

archive/issue_comments_234531.json:
```json
{
    "body": "<a id='comment:4'></a>\nOn 5.11, I grabbed the dependency and this patch, built and tested with no problems whatever in any of it.  In particular `matrix/constructor.py` passes tests.\n\nI'd be willing to believe that new calls to the `randint` function would upset the sequence of random numbers **if** these tests came **after** some of the tests for echelonizable matrices, etc.  But that does not appear to be the case, so I can't see the problem.",
    "created_at": "2013-08-27T19:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234531",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:4'></a>
On 5.11, I grabbed the dependency and this patch, built and tested with no problems whatever in any of it.  In particular `matrix/constructor.py` passes tests.

I'd be willing to believe that new calls to the `randint` function would upset the sequence of random numbers **if** these tests came **after** some of the tests for echelonizable matrices, etc.  But that does not appear to be the case, so I can't see the problem.



---

archive/issue_events_057557.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57557"
}
```



---

archive/issue_comments_234532.json:
```json
{
    "body": "<a id='comment:6'></a>\n#15887 fixes this issue.  Do not apply this patch (unless you want to just push the doctests into the library).",
    "created_at": "2014-03-05T02:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234532",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>
#15887 fixes this issue.  Do not apply this patch (unless you want to just push the doctests into the library).



---

archive/issue_comments_234533.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,6 +14,8 @@\n False\n ```\n \n+Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks the ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)\n+\n **Apply:**\n \n 1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds-v2.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds-v2.patch-macro)\n``````\n",
    "created_at": "2014-03-05T02:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234533",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,6 +14,8 @@
 False
 ```
 
+Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks the ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)
+
 **Apply:**
 
 1. [This is the Trac macro *attachment:trac_15090-random-matrix-seeds-v2.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_15090-random-matrix-seeds-v2.patch-macro)
``````




---

archive/issue_comments_234534.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-03-05T02:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234534",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234535.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,7 +14,7 @@\n False\n ```\n \n-Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks the ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)\n+Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks this ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)\n \n **Apply:**\n \n``````\n",
    "created_at": "2014-03-05T02:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234535",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,7 +14,7 @@
 False
 ```
 
-Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks the ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)
+Do not merge this ticket as-is.  #15887 fixes the underlying issue with GSL. (Jason thinks this ticket should either be closed, or just the doctests should be put into the library, but not the code changes.)
 
 **Apply:**
 
``````




---

archive/issue_events_057558.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57558"
}
```



---

archive/issue_events_057559.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57559"
}
```



---

archive/issue_events_057560.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57560"
}
```



---

archive/issue_events_057561.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57561"
}
```



---

archive/issue_comments_234536.json:
```json
{
    "body": "<a id='comment:11'></a>\nAgreed with Jason - fixed by #15887.",
    "created_at": "2014-10-21T22:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234536",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:11'></a>
Agreed with Jason - fixed by #15887.



---

archive/issue_comments_234537.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-10-21T22:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234537",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_057562.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2014-10-21T22:10:05Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57562"
}
```



---

archive/issue_events_057563.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2014-10-21T22:10:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57563"
}
```



---

archive/issue_comments_234538.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-27T16:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15090#issuecomment-234538",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_057564.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-27T16:26:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15090",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15090#event-57564"
}
```
