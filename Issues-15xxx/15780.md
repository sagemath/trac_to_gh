# Issue 15780: Increase Performance in Projective Morphism

archive/issues_015543.json:
```json
{
    "body": "Increase Performance in Projective Morphism by replacing all evaluation of polynomials with fast_callable from sage.ext.fast_callable\n\nAssignee: @dillonmrose\n\nCC:  @bhutz\n\nKeywords: Projective, Morphism\n\nBranch/Commit: 81fba1bf7dcba1262da95ed4af0b9bf5566adf43\n\nReviewer: Ben Hutz\n\nAuthor: Dillon Rose\n\nDependencies: #16051, #16168\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15780\n\n",
    "closed_at": "2014-05-12T09:48:11Z",
    "created_at": "2014-02-03T14:59:50Z",
    "labels": [
        "component: algebraic geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Increase Performance in Projective Morphism",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15780",
    "user": "https://github.com/dillonmrose"
}
```
Increase Performance in Projective Morphism by replacing all evaluation of polynomials with fast_callable from sage.ext.fast_callable

Assignee: @dillonmrose

CC:  @bhutz

Keywords: Projective, Morphism

Branch/Commit: 81fba1bf7dcba1262da95ed4af0b9bf5566adf43

Reviewer: Ben Hutz

Author: Dillon Rose

Dependencies: #16051, #16168

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15780





---

archive/issue_comments_250894.json:
```json
{
    "body": "Changing branch from \"\" to \"15780\"",
    "created_at": "2014-02-03T15:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250894",
    "user": "https://github.com/dillonmrose"
}
```

Changing branch from "" to "15780"



---

archive/issue_events_060692.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-02-04T23:53:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15780#event-60692"
}
```



---

archive/issue_comments_250895.json:
```json
{
    "body": "Set assignee to @dillonmrose.",
    "created_at": "2014-02-05T17:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250895",
    "user": "https://github.com/dillonmrose"
}
```

Set assignee to @dillonmrose.



---

archive/issue_comments_250896.json:
```json
{
    "body": "Changing branch from \"15780\" to \"u/drose/15780\"",
    "created_at": "2014-02-05T17:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250896",
    "user": "https://github.com/dillonmrose"
}
```

Changing branch from "15780" to "u/drose/15780"



---

archive/issue_comments_250897.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[5bafb1b](https://github.com/sagemath/sagetrac-mirror/commit/5bafb1b5a5001794afd3c75a2d21797772813d47)|`# Tue Oct 22 20:59:00 2013 -0400`|",
    "created_at": "2014-02-05T17:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250897",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[5bafb1b](https://github.com/sagemath/sagetrac-mirror/commit/5bafb1b5a5001794afd3c75a2d21797772813d47)|`# Tue Oct 22 20:59:00 2013 -0400`|



---

archive/issue_comments_250898.json:
```json
{
    "body": "Changing commit from \"\" to \"5bafb1b5a5001794afd3c75a2d21797772813d47\"",
    "created_at": "2014-02-05T17:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "5bafb1b5a5001794afd3c75a2d21797772813d47"



---

archive/issue_comments_250899.json:
```json
{
    "body": "<a id='comment:5'></a>\nI haven't looked closely at functionality yet, but there are a few things that need to be fixed first.\n\n1) There are several doctests that fail with this:\n\n```\nsage -t --long sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsage -t --long sage/schemes/plane_conics/con_field.py  # 3 doctests failed\nsage -t --long sage/schemes/generic/morphism.py  # 3 doctests failed\n```\n\nIt looks like most of these are because the `__call__` in generic\\morphism first coerces the input point into the domain and the `__call__` in projective\\morphism does not. Although the elliptic curve failure seems to be a precision issue.\n\n2) The new functions must have appropriate documentation. See the developers guide for the appropriate format.\n\nSCORE projective_morphism.py: 91.9% (34 of 37)\n\nMissing documentation:\n* line 182: def __call__(self, x, check=True)\n* line 187: def _fast_eval(self, x, check=True)\n* line 2625: def _fast_eval(self, x, check=True)\n\n3) There are a number of Tab characters in projective_morphism.py\n\n`sage -t --long sage/schemes/projective/projective_morphism.py  # Tab character found`",
    "created_at": "2014-02-09T23:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250899",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:5'></a>
I haven't looked closely at functionality yet, but there are a few things that need to be fixed first.

1) There are several doctests that fail with this:

```
sage -t --long sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
sage -t --long sage/schemes/plane_conics/con_field.py  # 3 doctests failed
sage -t --long sage/schemes/generic/morphism.py  # 3 doctests failed
```

It looks like most of these are because the `__call__` in generic\morphism first coerces the input point into the domain and the `__call__` in projective\morphism does not. Although the elliptic curve failure seems to be a precision issue.

2) The new functions must have appropriate documentation. See the developers guide for the appropriate format.

SCORE projective_morphism.py: 91.9% (34 of 37)

Missing documentation:
* line 182: def __call__(self, x, check=True)
* line 187: def _fast_eval(self, x, check=True)
* line 2625: def _fast_eval(self, x, check=True)

3) There are a number of Tab characters in projective_morphism.py

`sage -t --long sage/schemes/projective/projective_morphism.py  # Tab character found`



---

archive/issue_comments_250900.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ben Hutz\"",
    "created_at": "2014-02-09T23:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250900",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "" to "Ben Hutz"



---

archive/issue_comments_250901.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-02-09T23:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250901",
    "user": "https://github.com/bhutz"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_250902.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-02-09T23:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250902",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_250903.json:
```json
{
    "body": "Changing commit from \"5bafb1b5a5001794afd3c75a2d21797772813d47\" to \"52ec0b39daba695f9c11a3727304f0b4b9e0deff\"",
    "created_at": "2014-02-10T15:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5bafb1b5a5001794afd3c75a2d21797772813d47" to "52ec0b39daba695f9c11a3727304f0b4b9e0deff"



---

archive/issue_comments_250904.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[52ec0b3](https://github.com/sagemath/sagetrac-mirror/commit/52ec0b39daba695f9c11a3727304f0b4b9e0deff)|`trac 15780. Change to projective morphism _call_ function.`|",
    "created_at": "2014-02-10T15:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[52ec0b3](https://github.com/sagemath/sagetrac-mirror/commit/52ec0b39daba695f9c11a3727304f0b4b9e0deff)|`trac 15780. Change to projective morphism _call_ function.`|



---

archive/issue_comments_250905.json:
```json
{
    "body": "<a id='comment:8'></a>\nTesting functionality. Everywhere where the evaluation works it gives the right answer. However, there are several places where you can no longer do the evaluation which give a variety of errors. These all previously worked.\n\n```\nT.<z>=PowerSeriesRing(ZZ)\nP.<x,y>=ProjectiveSpace(T,1)\nH=End(P)\nf=H([x^2+x*y,y^2])\nQ=P(z,1)\nf(Q)\n```\n\n```\nT.<z>=LaurentSeriesRing(ZZ)\nP.<x,y>=ProjectiveSpace(T,1)\nH=End(P)\nf=H([x^2+x*y,y^2])\nQ=P(z,1)\nf(Q)\n```\n\n```\nT.<z>=PolynomialRing(Qp(7))\nI=T.ideal(z^3)\nP.<x,y>=ProjectiveSpace(T.quotient_ring(I),1)\nH=End(P)\nf=H([x^2+x*y,y^2])\nQ=P(z^2,1)\nf(Q)\n```\n\n```\nT.<z>=PolynomialRing(CC)\nI=T.ideal(z^3)\nP.<x,y>=ProjectiveSpace(T.quotient_ring(I),1)\nH=End(P)\nf=H([x^2+x*y,y^2])\nQ=P(z^2,1)\nf(Q)\n```\n\n```\nT.<z>=LaurentSeriesRing(CC)\nR.<t>=PolynomialRing(T)\nP.<x,y>=ProjectiveSpace(R,1)\nH=End(P)\nf=H([x^2+x*y,y^2])\nF=f.dehomogenize(1)\nQ=P(t^2,z)\nf(Q)\n```",
    "created_at": "2014-02-10T17:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250905",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>
Testing functionality. Everywhere where the evaluation works it gives the right answer. However, there are several places where you can no longer do the evaluation which give a variety of errors. These all previously worked.

```
T.<z>=PowerSeriesRing(ZZ)
P.<x,y>=ProjectiveSpace(T,1)
H=End(P)
f=H([x^2+x*y,y^2])
Q=P(z,1)
f(Q)
```

```
T.<z>=LaurentSeriesRing(ZZ)
P.<x,y>=ProjectiveSpace(T,1)
H=End(P)
f=H([x^2+x*y,y^2])
Q=P(z,1)
f(Q)
```

```
T.<z>=PolynomialRing(Qp(7))
I=T.ideal(z^3)
P.<x,y>=ProjectiveSpace(T.quotient_ring(I),1)
H=End(P)
f=H([x^2+x*y,y^2])
Q=P(z^2,1)
f(Q)
```

```
T.<z>=PolynomialRing(CC)
I=T.ideal(z^3)
P.<x,y>=ProjectiveSpace(T.quotient_ring(I),1)
H=End(P)
f=H([x^2+x*y,y^2])
Q=P(z^2,1)
f(Q)
```

```
T.<z>=LaurentSeriesRing(CC)
R.<t>=PolynomialRing(T)
P.<x,y>=ProjectiveSpace(R,1)
H=End(P)
f=H([x^2+x*y,y^2])
F=f.dehomogenize(1)
Q=P(t^2,z)
f(Q)
```



---

archive/issue_comments_250906.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[5ca376b](https://github.com/sagemath/sagetrac-mirror/commit/5ca376bcfb8e5c4e5c82a7bc36a04cc592994ea9)|`trac 15780.  Added documentation.`|",
    "created_at": "2014-02-11T00:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[5ca376b](https://github.com/sagemath/sagetrac-mirror/commit/5ca376bcfb8e5c4e5c82a7bc36a04cc592994ea9)|`trac 15780.  Added documentation.`|



---

archive/issue_comments_250907.json:
```json
{
    "body": "Changing commit from \"52ec0b39daba695f9c11a3727304f0b4b9e0deff\" to \"5ca376bcfb8e5c4e5c82a7bc36a04cc592994ea9\"",
    "created_at": "2014-02-11T00:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250907",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "52ec0b39daba695f9c11a3727304f0b4b9e0deff" to "5ca376bcfb8e5c4e5c82a7bc36a04cc592994ea9"



---

archive/issue_comments_250908.json:
```json
{
    "body": "Changing commit from \"5ca376bcfb8e5c4e5c82a7bc36a04cc592994ea9\" to \"888a2abf3c6bdc514168da81171a19d3dad73d08\"",
    "created_at": "2014-02-11T00:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250908",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5ca376bcfb8e5c4e5c82a7bc36a04cc592994ea9" to "888a2abf3c6bdc514168da81171a19d3dad73d08"



---

archive/issue_comments_250909.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[888a2ab](https://github.com/sagemath/sagetrac-mirror/commit/888a2abf3c6bdc514168da81171a19d3dad73d08)|`trac 15780.  Added documentation to projective morphism.`|",
    "created_at": "2014-02-11T00:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[888a2ab](https://github.com/sagemath/sagetrac-mirror/commit/888a2abf3c6bdc514168da81171a19d3dad73d08)|`trac 15780.  Added documentation to projective morphism.`|



---

archive/issue_comments_250910.json:
```json
{
    "body": "Changing commit from \"888a2abf3c6bdc514168da81171a19d3dad73d08\" to \"87572ab743acf23a63e213f1272192328fde7d49\"",
    "created_at": "2014-02-11T00:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "888a2abf3c6bdc514168da81171a19d3dad73d08" to "87572ab743acf23a63e213f1272192328fde7d49"



---

archive/issue_comments_250911.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[87572ab](https://github.com/sagemath/sagetrac-mirror/commit/87572ab743acf23a63e213f1272192328fde7d49)|`trac 15780.  Added documentation.`|",
    "created_at": "2014-02-11T00:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250911",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[87572ab](https://github.com/sagemath/sagetrac-mirror/commit/87572ab743acf23a63e213f1272192328fde7d49)|`trac 15780.  Added documentation.`|



---

archive/issue_comments_250912.json:
```json
{
    "body": "<a id='comment:12'></a>\nTicket #16051 fixes the functionality issues. So what remains to be done is the list of issues back in comment 5.",
    "created_at": "2014-04-03T11:52:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250912",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:12'></a>
Ticket #16051 fixes the functionality issues. So what remains to be done is the list of issues back in comment 5.



---

archive/issue_comments_250913.json:
```json
{
    "body": "Changing dependencies from \"\" to \"16051\"",
    "created_at": "2014-04-03T11:52:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250913",
    "user": "https://github.com/bhutz"
}
```

Changing dependencies from "" to "16051"



---

archive/issue_comments_250914.json:
```json
{
    "body": "<a id='comment:13'></a>\ninitialization of the fast_polys should probably be done lazily, unless you can show it is always quick. There are many reasons to create morphisms/rational maps that do not involve evaluating them at points. For instance, you might want to take direct or inverse images of subvarieties. For doing that one does not evaluate the defining polynomials, but one does computations with the polynomials. It would be a shame to waste time on computing fast_polys in those cases.\n\nYou'd also have to experiment to see if doing this really is an improvement: what you're basically doing is representing the polynomials by predetermined straight-line programs, and using those programs regardless of the ring over which the evaluation point is defined. Different rings may benefit from different evaluation strategies. So there's something to be said for deferring the choice of evaluation algorithm until the ring in which this needs to happen is known. Of course, in many common cases the ring for the point is the same as the base ring of the polynomials. Then fast_eval probably does pretty well (also because no intermediate coercions are required).",
    "created_at": "2014-04-03T16:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250914",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:13'></a>
initialization of the fast_polys should probably be done lazily, unless you can show it is always quick. There are many reasons to create morphisms/rational maps that do not involve evaluating them at points. For instance, you might want to take direct or inverse images of subvarieties. For doing that one does not evaluate the defining polynomials, but one does computations with the polynomials. It would be a shame to waste time on computing fast_polys in those cases.

You'd also have to experiment to see if doing this really is an improvement: what you're basically doing is representing the polynomials by predetermined straight-line programs, and using those programs regardless of the ring over which the evaluation point is defined. Different rings may benefit from different evaluation strategies. So there's something to be said for deferring the choice of evaluation algorithm until the ring in which this needs to happen is known. Of course, in many common cases the ring for the point is the same as the base ring of the polynomials. Then fast_eval probably does pretty well (also because no intermediate coercions are required).



---

archive/issue_comments_250915.json:
```json
{
    "body": "Changing branch from \"u/drose/15780\" to \"u/drose/ticket/15780\"",
    "created_at": "2014-04-07T12:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250915",
    "user": "https://github.com/dillonmrose"
}
```

Changing branch from "u/drose/15780" to "u/drose/ticket/15780"



---

archive/issue_comments_250916.json:
```json
{
    "body": "Changing commit from \"87572ab743acf23a63e213f1272192328fde7d49\" to \"2993f7593de1e7cc2ea51068b959c14fc7866adf\"",
    "created_at": "2014-04-07T13:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "87572ab743acf23a63e213f1272192328fde7d49" to "2993f7593de1e7cc2ea51068b959c14fc7866adf"



---

archive/issue_comments_250917.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[2993f75](https://github.com/sagemath/sagetrac-mirror/commit/2993f7593de1e7cc2ea51068b959c14fc7866adf)|`Removed more camelCase variables.`|",
    "created_at": "2014-04-07T13:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250917",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[2993f75](https://github.com/sagemath/sagetrac-mirror/commit/2993f7593de1e7cc2ea51068b959c14fc7866adf)|`Removed more camelCase variables.`|



---

archive/issue_comments_250918.json:
```json
{
    "body": "Changing dependencies from \"16051\" to \"\"",
    "created_at": "2014-04-07T13:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250918",
    "user": "https://github.com/dillonmrose"
}
```

Changing dependencies from "16051" to ""



---

archive/issue_comments_250919.json:
```json
{
    "body": "Changing commit from \"2993f7593de1e7cc2ea51068b959c14fc7866adf\" to \"1aaeab2e9eac98286db0f2ab34190e500f4db792\"",
    "created_at": "2014-04-07T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250919",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2993f7593de1e7cc2ea51068b959c14fc7866adf" to "1aaeab2e9eac98286db0f2ab34190e500f4db792"



---

archive/issue_comments_250920.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|\n|[27663fe](https://github.com/sagemath/sagetrac-mirror/commit/27663feffb8cf5325b6ea4c8c2f2dd793775ce23)|`Trac 16051: comparing fast_callable constants by value and type`|\n|[9eb0789](https://github.com/sagemath/sagetrac-mirror/commit/9eb0789bf99a2d976cb57f8104f33bc6e7c5deea)|`Trac #16051: changed type to parent for constant comparison`|\n|[1aaeab2](https://github.com/sagemath/sagetrac-mirror/commit/1aaeab2e9eac98286db0f2ab34190e500f4db792)|`Merge branch 'u/bhutz/ticket/16051' of git://trac.sagemath.org/sage into ticket/15780`|",
    "created_at": "2014-04-07T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250920",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
|[27663fe](https://github.com/sagemath/sagetrac-mirror/commit/27663feffb8cf5325b6ea4c8c2f2dd793775ce23)|`Trac 16051: comparing fast_callable constants by value and type`|
|[9eb0789](https://github.com/sagemath/sagetrac-mirror/commit/9eb0789bf99a2d976cb57f8104f33bc6e7c5deea)|`Trac #16051: changed type to parent for constant comparison`|
|[1aaeab2](https://github.com/sagemath/sagetrac-mirror/commit/1aaeab2e9eac98286db0f2ab34190e500f4db792)|`Merge branch 'u/bhutz/ticket/16051' of git://trac.sagemath.org/sage into ticket/15780`|



---

archive/issue_comments_250921.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#16051\"",
    "created_at": "2014-04-07T13:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250921",
    "user": "https://github.com/dillonmrose"
}
```

Changing dependencies from "" to "#16051"



---

archive/issue_comments_250922.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|\n|[83f8b79](https://github.com/sagemath/sagetrac-mirror/commit/83f8b79aa0c508375c8b99acccbb4925722ddef7)|`Fixed doctests.`|",
    "created_at": "2014-04-07T13:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
|[83f8b79](https://github.com/sagemath/sagetrac-mirror/commit/83f8b79aa0c508375c8b99acccbb4925722ddef7)|`Fixed doctests.`|



---

archive/issue_comments_250923.json:
```json
{
    "body": "Changing commit from \"1aaeab2e9eac98286db0f2ab34190e500f4db792\" to \"83f8b79aa0c508375c8b99acccbb4925722ddef7\"",
    "created_at": "2014-04-07T13:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1aaeab2e9eac98286db0f2ab34190e500f4db792" to "83f8b79aa0c508375c8b99acccbb4925722ddef7"



---

archive/issue_comments_250924.json:
```json
{
    "body": "<a id='comment:20'></a>\nI used timeit on a random degree 3 map on P^3 and it took 717 microseconds per loop.  This is very fast and doesn't really warrant lazy initialization.",
    "created_at": "2014-04-07T14:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250924",
    "user": "https://github.com/dillonmrose"
}
```

<a id='comment:20'></a>
I used timeit on a random degree 3 map on P^3 and it took 717 microseconds per loop.  This is very fast and doesn't really warrant lazy initialization.



---

archive/issue_comments_250925.json:
```json
{
    "body": "Changing branch from \"u/drose/ticket/15780\" to \"u/bhutz/ticket/15780\"",
    "created_at": "2014-04-09T23:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250925",
    "user": "https://github.com/bhutz"
}
```

Changing branch from "u/drose/ticket/15780" to "u/bhutz/ticket/15780"



---

archive/issue_comments_250926.json:
```json
{
    "body": "Changing commit from \"83f8b79aa0c508375c8b99acccbb4925722ddef7\" to \"6be7361b9186ede2ff230139c7972c9f38fc8f94\"",
    "created_at": "2014-04-09T23:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250926",
    "user": "https://github.com/bhutz"
}
```

Changing commit from "83f8b79aa0c508375c8b99acccbb4925722ddef7" to "6be7361b9186ede2ff230139c7972c9f38fc8f94"



---

archive/issue_comments_250927.json:
```json
{
    "body": "<a id='comment:21'></a>\nHad some trouble with the rebase, so had to force the push on the branch. I think everything is still correct.\n\nAlthough there are a couple doctest failures that are still present\n\ngeneric/morphism.py\nprojective/projective_morphism.py (from the parallel code #15920)\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[1ef4bf6](https://github.com/sagemath/sagetrac-mirror/commit/1ef4bf629b8913d88d359663ddd3471c6654df0d)|`trac 15780. Change to projective morphism _call_ function.`|\n|[b707ba2](https://github.com/sagemath/sagetrac-mirror/commit/b707ba209f92526f31753c63f3c6460e8b81441c)|`trac 15780.  Added documentation.`|\n|[aaade14](https://github.com/sagemath/sagetrac-mirror/commit/aaade14f758a6c8bbe90dd3e6f75f788fa26ed1e)|`trac 15780.  Added documentation to projective morphism.`|\n|[309f4ed](https://github.com/sagemath/sagetrac-mirror/commit/309f4edeb9a9fcba80c4ff3d2ef98d2f0091dc67)|`trac 15780.  Added documentation.`|\n|[e351fcc](https://github.com/sagemath/sagetrac-mirror/commit/e351fcc6f04279b98c86ba30dcf59f7c1d69b5b0)|`Trac 16051: comparing fast_callable constants by value and type`|\n|[79cbdf3](https://github.com/sagemath/sagetrac-mirror/commit/79cbdf3b97d2627e29b8db8e5145c159c50f7595)|`Trac #16051: changed type to parent for constant comparison`|\n|[c9cf64e](https://github.com/sagemath/sagetrac-mirror/commit/c9cf64e3feaa6fff896de1a5822552b97de9867b)|`Removed camelCase variables.`|\n|[4ffd64c](https://github.com/sagemath/sagetrac-mirror/commit/4ffd64cdccc66c5ebd82f15a531bdc898d1891f9)|`Removed more camelCase variables.`|\n|[f7c887e](https://github.com/sagemath/sagetrac-mirror/commit/f7c887e32335641ed4be30636a3ce1e7957306f2)|`Fixed doctests.`|\n|[6be7361](https://github.com/sagemath/sagetrac-mirror/commit/6be7361b9186ede2ff230139c7972c9f38fc8f94)|`rebase to 6.2.beta7 and remove whitespace`|",
    "created_at": "2014-04-09T23:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250927",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:21'></a>
Had some trouble with the rebase, so had to force the push on the branch. I think everything is still correct.

Although there are a couple doctest failures that are still present

generic/morphism.py
projective/projective_morphism.py (from the parallel code #15920)

---
Last 10 new commits:
|                                                                                                                                          |                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[1ef4bf6](https://github.com/sagemath/sagetrac-mirror/commit/1ef4bf629b8913d88d359663ddd3471c6654df0d)|`trac 15780. Change to projective morphism _call_ function.`|
|[b707ba2](https://github.com/sagemath/sagetrac-mirror/commit/b707ba209f92526f31753c63f3c6460e8b81441c)|`trac 15780.  Added documentation.`|
|[aaade14](https://github.com/sagemath/sagetrac-mirror/commit/aaade14f758a6c8bbe90dd3e6f75f788fa26ed1e)|`trac 15780.  Added documentation to projective morphism.`|
|[309f4ed](https://github.com/sagemath/sagetrac-mirror/commit/309f4edeb9a9fcba80c4ff3d2ef98d2f0091dc67)|`trac 15780.  Added documentation.`|
|[e351fcc](https://github.com/sagemath/sagetrac-mirror/commit/e351fcc6f04279b98c86ba30dcf59f7c1d69b5b0)|`Trac 16051: comparing fast_callable constants by value and type`|
|[79cbdf3](https://github.com/sagemath/sagetrac-mirror/commit/79cbdf3b97d2627e29b8db8e5145c159c50f7595)|`Trac #16051: changed type to parent for constant comparison`|
|[c9cf64e](https://github.com/sagemath/sagetrac-mirror/commit/c9cf64e3feaa6fff896de1a5822552b97de9867b)|`Removed camelCase variables.`|
|[4ffd64c](https://github.com/sagemath/sagetrac-mirror/commit/4ffd64cdccc66c5ebd82f15a531bdc898d1891f9)|`Removed more camelCase variables.`|
|[f7c887e](https://github.com/sagemath/sagetrac-mirror/commit/f7c887e32335641ed4be30636a3ce1e7957306f2)|`Fixed doctests.`|
|[6be7361](https://github.com/sagemath/sagetrac-mirror/commit/6be7361b9186ede2ff230139c7972c9f38fc8f94)|`rebase to 6.2.beta7 and remove whitespace`|



---

archive/issue_comments_250928.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [drose](#comment%3A20):\n> I used timeit on a random degree 3 map on P<sup>3</sup> and it took 717 microseconds per loop.  This is very fast and doesn't really warrant lazy initialization.\n\n\nWhether 717 ms is a lot depends on what you compare it to. I'm finding (on 6.0):\n\n```\nsage: P5=ProjectiveSpace(Rationals(),5)\nsage: R=P2.coordinate_ring()\nsage: mon=[R({tuple(a):1}) for a in WeightedIntegerVectors(4,[1,1,1,1,1,1])]\nsage: L=[sum(random_sublist(mon,0.1)) for j in [0..5]]\nsage: %timeit P2.hom(L,P2)\n10000 loops, best of 3: 63.3 us per loop\nsage: %timeit [fast_callable(l) for l in L]\n100 loops, best of 3: 1.94 ms per loop\n```\nas you see, creating the fast callables is *much* slower than creating the map. If you increase the polynomials in L (by increasing the degree of the monomials, for instance), the difference gets worse. I'd say that's enough time penalty to hold off on it unless you actually need the fast_callables.",
    "created_at": "2014-04-10T03:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250928",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:22'></a>
Replying to [drose](#comment%3A20):
> I used timeit on a random degree 3 map on P<sup>3</sup> and it took 717 microseconds per loop.  This is very fast and doesn't really warrant lazy initialization.


Whether 717 ms is a lot depends on what you compare it to. I'm finding (on 6.0):

```
sage: P5=ProjectiveSpace(Rationals(),5)
sage: R=P2.coordinate_ring()
sage: mon=[R({tuple(a):1}) for a in WeightedIntegerVectors(4,[1,1,1,1,1,1])]
sage: L=[sum(random_sublist(mon,0.1)) for j in [0..5]]
sage: %timeit P2.hom(L,P2)
10000 loops, best of 3: 63.3 us per loop
sage: %timeit [fast_callable(l) for l in L]
100 loops, best of 3: 1.94 ms per loop
```
as you see, creating the fast callables is *much* slower than creating the map. If you increase the polynomials in L (by increasing the degree of the monomials, for instance), the difference gets worse. I'd say that's enough time penalty to hold off on it unless you actually need the fast_callables.



---

archive/issue_comments_250929.json:
```json
{
    "body": "<a id='comment:23'></a>\nYes, it is definitely slower than creating the map, but < 1ms didn't seem to be worth bothering over. Note that you wrote 717ms not the actual 717us.\n\nWe could put a try/except in call and init them in the except. Any idea how much overhead a try block adds? As far as I can tell in a couple tests it doesn't actually add an execution time. If that's the case, then there is no reason not to do it lazily.",
    "created_at": "2014-04-10T13:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250929",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:23'></a>
Yes, it is definitely slower than creating the map, but < 1ms didn't seem to be worth bothering over. Note that you wrote 717ms not the actual 717us.

We could put a try/except in call and init them in the except. Any idea how much overhead a try block adds? As far as I can tell in a couple tests it doesn't actually add an execution time. If that's the case, then there is no reason not to do it lazily.



---

archive/issue_comments_250930.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [bhutz](#comment%3A23):\n> We could put a try/except in call and init them in the except. Any idea how much overhead a try block adds? As far as I can tell in a couple tests it doesn't actually add an execution time. If that's the case, then there is no reason not to do it lazily.\n\n\nPython is designed to let \"try\" be very fast. If an exception occurs there is a bit larger penalty but in this case it wouldn't be measurable compared to the `fast callable`.\n\nThe recommended way to store the fast_callable would be by accessing them through a `cached_method` or a `lazy_attribute`. See their docstrings for examples. Just don't go sticking `cached_method` decorators on methods arbitrarily. That's how we get memory leaks :-).",
    "created_at": "2014-04-10T14:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250930",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:24'></a>
Replying to [bhutz](#comment%3A23):
> We could put a try/except in call and init them in the except. Any idea how much overhead a try block adds? As far as I can tell in a couple tests it doesn't actually add an execution time. If that's the case, then there is no reason not to do it lazily.


Python is designed to let "try" be very fast. If an exception occurs there is a bit larger penalty but in this case it wouldn't be measurable compared to the `fast callable`.

The recommended way to store the fast_callable would be by accessing them through a `cached_method` or a `lazy_attribute`. See their docstrings for examples. Just don't go sticking `cached_method` decorators on methods arbitrarily. That's how we get memory leaks :-).



---

archive/issue_comments_250931.json:
```json
{
    "body": "Changing branch from \"u/bhutz/ticket/15780\" to \"u/drose/ticket/15780\"",
    "created_at": "2014-04-22T00:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250931",
    "user": "https://github.com/dillonmrose"
}
```

Changing branch from "u/bhutz/ticket/15780" to "u/drose/ticket/15780"



---

archive/issue_comments_250932.json:
```json
{
    "body": "Changing dependencies from \"#16051\" to \"#16051, #16168\"",
    "created_at": "2014-04-22T00:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250932",
    "user": "https://github.com/dillonmrose"
}
```

Changing dependencies from "#16051" to "#16051, #16168"



---

archive/issue_comments_250933.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-22T01:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250933",
    "user": "https://github.com/dillonmrose"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_250934.json:
```json
{
    "body": "Changing commit from \"6be7361b9186ede2ff230139c7972c9f38fc8f94\" to \"2a4342e2ec2d4d5d3524ab9a7a0aa6510bd66447\"",
    "created_at": "2014-04-22T01:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250934",
    "user": "https://github.com/dillonmrose"
}
```

Changing commit from "6be7361b9186ede2ff230139c7972c9f38fc8f94" to "2a4342e2ec2d4d5d3524ab9a7a0aa6510bd66447"



---

archive/issue_comments_250935.json:
```json
{
    "body": "<a id='comment:27'></a>\nNew commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[d4c86a3](https://github.com/sagemath/sagetrac-mirror/commit/d4c86a39d276e82ab05778fbf6d1c4cc734fe4dc)|`Fixed error message in __call__.`|\n|[a82afa0](https://github.com/sagemath/sagetrac-mirror/commit/a82afa08665d34f98c7833d293b1af3de6a2ea0b)|`Added lazy_attribute to fastpolys.`|\n|[6c0149c](https://github.com/sagemath/sagetrac-mirror/commit/6c0149c8a44b59c86d0b0199ef8fa804855037e8)|`Merge branch 'develop' into ticket/15780`|\n|[8215514](https://github.com/sagemath/sagetrac-mirror/commit/821551463fa674a7756f9f085410728f814a23a0)|`Fixed parallelizaion using p_iter_fork.`|\n|[9d93ea5](https://github.com/sagemath/sagetrac-mirror/commit/9d93ea5a5a65b6b45eb0bfe88094ecd217508943)|`Minor changes to fix initial bugs in fix.`|\n|[3fd6fbd](https://github.com/sagemath/sagetrac-mirror/commit/3fd6fbd4cfbd54dbb153ef71596dfced670dd6e5)|`Merge branch 'u/drose/ticket/16168' of git://trac.sagemath.org/sage into ticket/15780`|\n|[bf3c19f](https://github.com/sagemath/sagetrac-mirror/commit/bf3c19f56747cc4c01f6ce85d3aa66e93f8d2067)|`Changed code to comply with style.`|\n|[d0489ec](https://github.com/sagemath/sagetrac-mirror/commit/d0489ecb0fcef10a2be2c0c784d37f58eff2a458)|`Merge branch 'u/drose/ticket/16168' of git://trac.sagemath.org/sage into ticket/15780`|\n|[2a4342e](https://github.com/sagemath/sagetrac-mirror/commit/2a4342e2ec2d4d5d3524ab9a7a0aa6510bd66447)|`Fixed lazy attribute and merged 16168.`|",
    "created_at": "2014-04-22T01:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250935",
    "user": "https://github.com/dillonmrose"
}
```

<a id='comment:27'></a>
New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[d4c86a3](https://github.com/sagemath/sagetrac-mirror/commit/d4c86a39d276e82ab05778fbf6d1c4cc734fe4dc)|`Fixed error message in __call__.`|
|[a82afa0](https://github.com/sagemath/sagetrac-mirror/commit/a82afa08665d34f98c7833d293b1af3de6a2ea0b)|`Added lazy_attribute to fastpolys.`|
|[6c0149c](https://github.com/sagemath/sagetrac-mirror/commit/6c0149c8a44b59c86d0b0199ef8fa804855037e8)|`Merge branch 'develop' into ticket/15780`|
|[8215514](https://github.com/sagemath/sagetrac-mirror/commit/821551463fa674a7756f9f085410728f814a23a0)|`Fixed parallelizaion using p_iter_fork.`|
|[9d93ea5](https://github.com/sagemath/sagetrac-mirror/commit/9d93ea5a5a65b6b45eb0bfe88094ecd217508943)|`Minor changes to fix initial bugs in fix.`|
|[3fd6fbd](https://github.com/sagemath/sagetrac-mirror/commit/3fd6fbd4cfbd54dbb153ef71596dfced670dd6e5)|`Merge branch 'u/drose/ticket/16168' of git://trac.sagemath.org/sage into ticket/15780`|
|[bf3c19f](https://github.com/sagemath/sagetrac-mirror/commit/bf3c19f56747cc4c01f6ce85d3aa66e93f8d2067)|`Changed code to comply with style.`|
|[d0489ec](https://github.com/sagemath/sagetrac-mirror/commit/d0489ecb0fcef10a2be2c0c784d37f58eff2a458)|`Merge branch 'u/drose/ticket/16168' of git://trac.sagemath.org/sage into ticket/15780`|
|[2a4342e](https://github.com/sagemath/sagetrac-mirror/commit/2a4342e2ec2d4d5d3524ab9a7a0aa6510bd66447)|`Fixed lazy attribute and merged 16168.`|



---

archive/issue_comments_250936.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-23T15:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250936",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_250937.json:
```json
{
    "body": "<a id='comment:28'></a>\nFunctionality all tests out fine. A couple minor issues that need to be addressed\n\n1) _fast_eval does not use the parameter 'check'. Simply remove (from both _fast_eval functions)\n\n2) `@`lazy_attribute function needs the documentation string + an example\n\n2b) in the `@`lazy_attribute. Put the 'prime' and 'degree' inside the 'if' block so they are only computed if they are needed.\n\n3) There is an extra blank line in _fast_eval for finite fields that can be removed\n\n4) I'd like to see a few more doctests in _fast_eval. Maybe\n  a) Powerseries ring\n\n  b) quotient ring\n\nYou can pull them from comment 8 above.",
    "created_at": "2014-04-23T15:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250937",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:28'></a>
Functionality all tests out fine. A couple minor issues that need to be addressed

1) _fast_eval does not use the parameter 'check'. Simply remove (from both _fast_eval functions)

2) `@`lazy_attribute function needs the documentation string + an example

2b) in the `@`lazy_attribute. Put the 'prime' and 'degree' inside the 'if' block so they are only computed if they are needed.

3) There is an extra blank line in _fast_eval for finite fields that can be removed

4) I'd like to see a few more doctests in _fast_eval. Maybe
  a) Powerseries ring

  b) quotient ring

You can pull them from comment 8 above.



---

archive/issue_comments_250938.json:
```json
{
    "body": "<a id='comment:29'></a>\n* justify constant `2**27` as bound on \"no overflow in float\" (you should use doubles).\n* for the sake of defensive programming, would you use\n\n```\nmax(abs(c.lift()) for c in coefficients)\n```\ninstead? `max(GF(17)).lift()` happens to work at present, but it doesn't really make mathematical sense.\n\nAlso, if you really want to scrape the bottom on this, you should use balanced representatives, also on the coordinates when you fill them in. That would give you a larger range where you can use float.\n\nWhat you'd really need is a `cdef ulong` domain. Then you could just evaluate with 64-bit integers, which would give you a much better bound than `2^27`.",
    "created_at": "2014-04-23T16:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250938",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:29'></a>
* justify constant `2**27` as bound on "no overflow in float" (you should use doubles).
* for the sake of defensive programming, would you use

```
max(abs(c.lift()) for c in coefficients)
```
instead? `max(GF(17)).lift()` happens to work at present, but it doesn't really make mathematical sense.

Also, if you really want to scrape the bottom on this, you should use balanced representatives, also on the coordinates when you fill them in. That would give you a larger range where you can use float.

What you'd really need is a `cdef ulong` domain. Then you could just evaluate with 64-bit integers, which would give you a much better bound than `2^27`.



---

archive/issue_comments_250939.json:
```json
{
    "body": "<a id='comment:30'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[7484355](https://github.com/sagemath/sagetrac-mirror/commit/7484355186426d352ae82582722987b7b934e864)|`Fixed issues reported on trac server comment 28 and 29.`|",
    "created_at": "2014-04-25T17:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250939",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[7484355](https://github.com/sagemath/sagetrac-mirror/commit/7484355186426d352ae82582722987b7b934e864)|`Fixed issues reported on trac server comment 28 and 29.`|



---

archive/issue_comments_250940.json:
```json
{
    "body": "Changing commit from \"2a4342e2ec2d4d5d3524ab9a7a0aa6510bd66447\" to \"7484355186426d352ae82582722987b7b934e864\"",
    "created_at": "2014-04-25T17:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2a4342e2ec2d4d5d3524ab9a7a0aa6510bd66447" to "7484355186426d352ae82582722987b7b934e864"



---

archive/issue_comments_250941.json:
```json
{
    "body": "Changing commit from \"7484355186426d352ae82582722987b7b934e864\" to \"9be3bba9c7a154309feb9d6e3951f12ed6622a62\"",
    "created_at": "2014-04-25T17:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7484355186426d352ae82582722987b7b934e864" to "9be3bba9c7a154309feb9d6e3951f12ed6622a62"



---

archive/issue_comments_250942.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[9be3bba](https://github.com/sagemath/sagetrac-mirror/commit/9be3bba9c7a154309feb9d6e3951f12ed6622a62)|`Changed doctest for fast_eval.`|",
    "created_at": "2014-04-25T17:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[9be3bba](https://github.com/sagemath/sagetrac-mirror/commit/9be3bba9c7a154309feb9d6e3951f12ed6622a62)|`Changed doctest for fast_eval.`|



---

archive/issue_comments_250943.json:
```json
{
    "body": "<a id='comment:32'></a>\nThe previous issues all now test out and my concerns were all addressed. In response to Nils, the 27 is now replaced with the system float precision which is 53 on my 64-bit machine. I'm not overly concerned about aggressively optimizing the float usage for speed increase since if the prime is large enough to overrun the height bound for 'reasonable' maps, then the algorithms would never finish anyway (which is what the speed increase is supposed to help). Maps that overrun the bound due to large degree/moderate prime are theoretically fine in the algorithm, but won't get this speed increase and will do the fast_eval over ZZ (or whatever the base ring is).\n\nIf you have any other comments on these changes let me know before I mark this as positive.",
    "created_at": "2014-04-26T21:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250943",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:32'></a>
The previous issues all now test out and my concerns were all addressed. In response to Nils, the 27 is now replaced with the system float precision which is 53 on my 64-bit machine. I'm not overly concerned about aggressively optimizing the float usage for speed increase since if the prime is large enough to overrun the height bound for 'reasonable' maps, then the algorithms would never finish anyway (which is what the speed increase is supposed to help). Maps that overrun the bound due to large degree/moderate prime are theoretically fine in the algorithm, but won't get this speed increase and will do the fast_eval over ZZ (or whatever the base ring is).

If you have any other comments on these changes let me know before I mark this as positive.



---

archive/issue_comments_250944.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-05-01T14:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250944",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_250945.json:
```json
{
    "body": "<a id='comment:34'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[c858d54](https://github.com/sagemath/sagetrac-mirror/commit/c858d5467daed909d63961fe5b997b51bc524965)|`Switched parallelization to p_iter_fork.`|\n|[0a1cf6d](https://github.com/sagemath/sagetrac-mirror/commit/0a1cf6d74facf3cb8dc25611a158b77021799691)|`Added documentation on new keyword ncpus.`|\n|[be46079](https://github.com/sagemath/sagetrac-mirror/commit/be46079a2b064ce01aa7a7921a2086938e6d9022)|`moved import to header`|\n|[857d08c](https://github.com/sagemath/sagetrac-mirror/commit/857d08c1d774c80701a4034fb0d296985a857195)|`Merge branch 'u/bhutz/ticket/16168' of git://trac.sagemath.org/sage into ticket/15780`|",
    "created_at": "2014-05-01T16:09:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[c858d54](https://github.com/sagemath/sagetrac-mirror/commit/c858d5467daed909d63961fe5b997b51bc524965)|`Switched parallelization to p_iter_fork.`|
|[0a1cf6d](https://github.com/sagemath/sagetrac-mirror/commit/0a1cf6d74facf3cb8dc25611a158b77021799691)|`Added documentation on new keyword ncpus.`|
|[be46079](https://github.com/sagemath/sagetrac-mirror/commit/be46079a2b064ce01aa7a7921a2086938e6d9022)|`moved import to header`|
|[857d08c](https://github.com/sagemath/sagetrac-mirror/commit/857d08c1d774c80701a4034fb0d296985a857195)|`Merge branch 'u/bhutz/ticket/16168' of git://trac.sagemath.org/sage into ticket/15780`|



---

archive/issue_comments_250946.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-05-01T16:09:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250946",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_250947.json:
```json
{
    "body": "Changing commit from \"9be3bba9c7a154309feb9d6e3951f12ed6622a62\" to \"857d08c1d774c80701a4034fb0d296985a857195\"",
    "created_at": "2014-05-01T16:09:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250947",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9be3bba9c7a154309feb9d6e3951f12ed6622a62" to "857d08c1d774c80701a4034fb0d296985a857195"



---

archive/issue_comments_250948.json:
```json
{
    "body": "<a id='comment:35'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[81fba1b](https://github.com/sagemath/sagetrac-mirror/commit/81fba1bf7dcba1262da95ed4af0b9bf5566adf43)|`Fixed import statements.`|",
    "created_at": "2014-05-01T16:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250948",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[81fba1b](https://github.com/sagemath/sagetrac-mirror/commit/81fba1bf7dcba1262da95ed4af0b9bf5566adf43)|`Fixed import statements.`|



---

archive/issue_comments_250949.json:
```json
{
    "body": "Changing commit from \"857d08c1d774c80701a4034fb0d296985a857195\" to \"81fba1bf7dcba1262da95ed4af0b9bf5566adf43\"",
    "created_at": "2014-05-01T16:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250949",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "857d08c1d774c80701a4034fb0d296985a857195" to "81fba1bf7dcba1262da95ed4af0b9bf5566adf43"



---

archive/issue_comments_250950.json:
```json
{
    "body": "<a id='comment:36'></a>\nThe 16168 changes had not been merged in. Now they are.",
    "created_at": "2014-05-01T16:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250950",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:36'></a>
The 16168 changes had not been merged in. Now they are.



---

archive/issue_events_060693.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15780#event-60693"
}
```



---

archive/issue_events_060694.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15780#event-60694"
}
```



---

archive/issue_comments_250951.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-08T22:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250951",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_250952.json:
```json
{
    "body": "<a id='comment:38'></a>\nThis passes all tests and the changes look fine.",
    "created_at": "2014-05-08T22:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250952",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:38'></a>
This passes all tests and the changes look fine.



---

archive/issue_comments_250953.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-05-09T13:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250953",
    "user": "https://github.com/bhutz"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_250954.json:
```json
{
    "body": "<a id='comment:39'></a>\nneed to clean-up the history",
    "created_at": "2014-05-09T13:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250954",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:39'></a>
need to clean-up the history



---

archive/issue_comments_250955.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-05-09T15:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250955",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_250956.json:
```json
{
    "body": "<a id='comment:40'></a>\nnever mind. I think this is ok. I was concerned about commit `6c0149c`, but it's where it is updated to 6.2.beta8",
    "created_at": "2014-05-09T15:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250956",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:40'></a>
never mind. I think this is ok. I was concerned about commit `6c0149c`, but it's where it is updated to 6.2.beta8



---

archive/issue_events_060695.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-12T09:48:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15780#event-60695"
}
```



---

archive/issue_comments_250957.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-12T09:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250957",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_250958.json:
```json
{
    "body": "Changing branch from \"u/drose/ticket/15780\" to \"81fba1bf7dcba1262da95ed4af0b9bf5566adf43\"",
    "created_at": "2014-05-12T09:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15780#issuecomment-250958",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/drose/ticket/15780" to "81fba1bf7dcba1262da95ed4af0b9bf5566adf43"
