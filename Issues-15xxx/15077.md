# Issue 15077: Inconsistency in polynomial .reverse(n)

archive/issues_014840.json:
```json
{
    "body": "The optional argument of the `.reverse()` method of univariate polynomials is interpreted inconsistently through different classes.\n\nRationals interpret is as \"length\":\n\n```python\nsage: _.<x> = QQ[]\nsage: (x+1).reverse(1)\n1\nsage: (x).reverse(1)\n0\n```\n\n\nThe docstring for generic polynomials (inherited by `CC`, number fields, `Polynomial_GF2X`,  `Polynomial_ZZ_pEX`, ...) says:\n\n> If an optional degree argument is given the coefficient list will\n> be truncated or zero padded as necessary and the reverse polynomial\n> will have the specified degree.\n\n\nbut the behaviour is inconsistent with it\n\n```python\nsage: _.<x> = GF(2)[]\nsage: (x+1).reverse(1)\nx + 1\nsage: (x).reverse(1)\n1\nsage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]\n[False, False, True, False, False, False, False, False, False, False]\nsage: inspect.getmro(x.__class__)[2]\n<type 'sage.rings.polynomial.polynomial_element.Polynomial'>\n```\n\n`Polynomial_zmod_flint` and `Polynomial_integer_dense_flint` have the exact same docstring and behaviour, though they do not inherit `.reverse()` from the generic class:\n\n```python\nsage: _.<x> = ZZ[]\nsage: (x+1).reverse(1)\nx + 1\nsage: (x).reverse(1)\n1\nsage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]\n[True, True, False, False, False, False, False, False, False]\n<type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>\n```\n\n\nReals take no optional argument. The docstring says\n\n> Returns x!^d f(1/x) where d is the degree of f.\n\n\nand the behaviour is consistent with it\n\n```python\nsage: (x+1).reverse()\nx + 1.00000000000000\nsage: x.reverse()\n1.00000000000000\n```\n\nIn my opinion the best behaviour is the one of the generic class, but the docstring should be amended to something similar to the last one, which is the proper mathematical definition. The behaviour of rationals should be corrected to conform to the other classes.\n\nCC:  @mezzarobba @jhpalmieri\n\nKeywords: polynomial univariate reverse\n\nBranch/Commit: bd32a8489a8e2b13312a08ae021f4b9d328c2226\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Bruno Grenet\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15077\n\n",
    "closed_at": "2019-11-16T20:15:30Z",
    "created_at": "2013-08-22T11:29:39Z",
    "labels": [
        "component: commutative algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Inconsistency in polynomial .reverse(n)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15077",
    "user": "https://github.com/defeo"
}
```
The optional argument of the `.reverse()` method of univariate polynomials is interpreted inconsistently through different classes.

Rationals interpret is as "length":

```python
sage: _.<x> = QQ[]
sage: (x+1).reverse(1)
1
sage: (x).reverse(1)
0
```


The docstring for generic polynomials (inherited by `CC`, number fields, `Polynomial_GF2X`,  `Polynomial_ZZ_pEX`, ...) says:

> If an optional degree argument is given the coefficient list will
> be truncated or zero padded as necessary and the reverse polynomial
> will have the specified degree.


but the behaviour is inconsistent with it

```python
sage: _.<x> = GF(2)[]
sage: (x+1).reverse(1)
x + 1
sage: (x).reverse(1)
1
sage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]
[False, False, True, False, False, False, False, False, False, False]
sage: inspect.getmro(x.__class__)[2]
<type 'sage.rings.polynomial.polynomial_element.Polynomial'>
```

`Polynomial_zmod_flint` and `Polynomial_integer_dense_flint` have the exact same docstring and behaviour, though they do not inherit `.reverse()` from the generic class:

```python
sage: _.<x> = ZZ[]
sage: (x+1).reverse(1)
x + 1
sage: (x).reverse(1)
1
sage: ['reverse' in cl.__dict__ for cl in  inspect.getmro(x.__class__)]
[True, True, False, False, False, False, False, False, False]
<type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>
```


Reals take no optional argument. The docstring says

> Returns x!^d f(1/x) where d is the degree of f.


and the behaviour is consistent with it

```python
sage: (x+1).reverse()
x + 1.00000000000000
sage: x.reverse()
1.00000000000000
```

In my opinion the best behaviour is the one of the generic class, but the docstring should be amended to something similar to the last one, which is the proper mathematical definition. The behaviour of rationals should be corrected to conform to the other classes.

CC:  @mezzarobba @jhpalmieri

Keywords: polynomial univariate reverse

Branch/Commit: bd32a8489a8e2b13312a08ae021f4b9d328c2226

Reviewer: Frédéric Chapoton

Author: Bruno Grenet

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15077





---

archive/issue_events_049776.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49776"
}
```



---

archive/issue_events_049777.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49777"
}
```



---

archive/issue_events_049778.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49778"
}
```



---

archive/issue_events_049779.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49779"
}
```



---

archive/issue_events_049780.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49780"
}
```



---

archive/issue_comments_242443.json:
```json
{
    "body": "Changing stopgaps from \"\" to \"inconsistentAnswer\"",
    "created_at": "2016-07-09T17:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242443",
    "user": "https://trac.sagemath.org/admin/accounts/users/jakobkroeker"
}
```

Changing stopgaps from "" to "inconsistentAnswer"



---

archive/issue_events_049781.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-17T17:37:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49781"
}
```



---

archive/issue_events_049782.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-17T17:37:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49782"
}
```



---

archive/issue_comments_242444.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis is obsolete. `QQ['x']` now works as the other cases.",
    "created_at": "2019-05-17T17:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242444",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
This is obsolete. `QQ['x']` now works as the other cases.



---

archive/issue_comments_242445.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-05-17T17:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242445",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_242446.json:
```json
{
    "body": "<a id='comment:7'></a>\nThere remain two issues: unifying the documentation, and also the version for `RR` does not allow for an optional argument. Low priority, but I say we keep this open.",
    "created_at": "2019-05-17T17:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242446",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
There remain two issues: unifying the documentation, and also the version for `RR` does not allow for an optional argument. Low priority, but I say we keep this open.



---

archive/issue_comments_242447.json:
```json
{
    "body": "Changing stopgaps from \"inconsistentAnswer\" to \"\"",
    "created_at": "2019-05-17T17:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242447",
    "user": "https://github.com/jhpalmieri"
}
```

Changing stopgaps from "inconsistentAnswer" to ""



---

archive/issue_comments_242448.json:
```json
{
    "body": "<a id='comment:8'></a>\nThere remained actually more issues. The issue for `QQ['x']` was indeed fixed by ticket #21194 but that ticket only fixed some of the inconsistencies. Those that I have noticed and fix are:\n\n- No `degree` parameter for polynomials over `RR` (as already mentioned);\n- No `degree` parameter for polynomials over `Zmod(...)` using NTL;\n- Several inconsistencies in the documentation (polynomials over `ZZ` and `Zmod(...)` using Flint, polynomials over p-adics).\n\nI hope I didn't forgot anything!",
    "created_at": "2019-08-22T14:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242448",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:8'></a>
There remained actually more issues. The issue for `QQ['x']` was indeed fixed by ticket #21194 but that ticket only fixed some of the inconsistencies. Those that I have noticed and fix are:

- No `degree` parameter for polynomials over `RR` (as already mentioned);
- No `degree` parameter for polynomials over `Zmod(...)` using NTL;
- Several inconsistencies in the documentation (polynomials over `ZZ` and `Zmod(...)` using Flint, polynomials over p-adics).

I hope I didn't forgot anything!



---

archive/issue_events_049783.json:
```json
{
    "actor": "https://github.com/bgrenet",
    "created_at": "2019-08-22T14:09:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49783"
}
```



---

archive/issue_events_049784.json:
```json
{
    "actor": "https://github.com/bgrenet",
    "created_at": "2019-08-22T14:09:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49784"
}
```



---

archive/issue_comments_242449.json:
```json
{
    "body": "Changing author from \"\" to \"Bruno Grenet\"",
    "created_at": "2019-08-22T14:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242449",
    "user": "https://github.com/bgrenet"
}
```

Changing author from "" to "Bruno Grenet"



---

archive/issue_comments_242450.json:
```json
{
    "body": "Changing branch from \"\" to \"u/bruno/15077_reverse_consistency\"",
    "created_at": "2019-08-22T14:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242450",
    "user": "https://github.com/bgrenet"
}
```

Changing branch from "" to "u/bruno/15077_reverse_consistency"



---

archive/issue_comments_242451.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[64c41ef](https://github.com/sagemath/sagetrac-mirror/commit/64c41eff54be8f00a69e85dffe318c39a5ccb089)|`15077: reverse for real polynomial with optional parameter`|\n|[1fc2a6e](https://github.com/sagemath/sagetrac-mirror/commit/1fc2a6eb7242bc0fc4f573d9e6c59076186dd5a4)|`15077: Update docstring+tests for Flint (integer & zmod)`|\n|[7fec024](https://github.com/sagemath/sagetrac-mirror/commit/7fec024b6c664331339328836f03a3d0effe23a7)|`15077: Make reverse consistent for NTL rings`|\n|[bd32a84](https://github.com/sagemath/sagetrac-mirror/commit/bd32a8489a8e2b13312a08ae021f4b9d328c2226)|`15077: Make reverse for poly over padics consistent with other implementations`|",
    "created_at": "2019-08-22T14:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[64c41ef](https://github.com/sagemath/sagetrac-mirror/commit/64c41eff54be8f00a69e85dffe318c39a5ccb089)|`15077: reverse for real polynomial with optional parameter`|
|[1fc2a6e](https://github.com/sagemath/sagetrac-mirror/commit/1fc2a6eb7242bc0fc4f573d9e6c59076186dd5a4)|`15077: Update docstring+tests for Flint (integer & zmod)`|
|[7fec024](https://github.com/sagemath/sagetrac-mirror/commit/7fec024b6c664331339328836f03a3d0effe23a7)|`15077: Make reverse consistent for NTL rings`|
|[bd32a84](https://github.com/sagemath/sagetrac-mirror/commit/bd32a8489a8e2b13312a08ae021f4b9d328c2226)|`15077: Make reverse for poly over padics consistent with other implementations`|



---

archive/issue_comments_242452.json:
```json
{
    "body": "Changing commit from \"\" to \"bd32a8489a8e2b13312a08ae021f4b9d328c2226\"",
    "created_at": "2019-08-22T14:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "bd32a8489a8e2b13312a08ae021f4b9d328c2226"



---

archive/issue_comments_242453.json:
```json
{
    "body": "<a id='comment:10'></a>\nok, let it be",
    "created_at": "2019-11-13T16:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242453",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
ok, let it be



---

archive/issue_comments_242454.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2019-11-13T16:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242454",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton"



---

archive/issue_comments_242455.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-11-13T16:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242455",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049785.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-11-13T20:10:31Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49785"
}
```



---

archive/issue_events_049786.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-11-13T20:10:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49786"
}
```



---

archive/issue_comments_242456.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-11-16T20:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242456",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_242457.json:
```json
{
    "body": "Changing branch from \"u/bruno/15077_reverse_consistency\" to \"bd32a8489a8e2b13312a08ae021f4b9d328c2226\"",
    "created_at": "2019-11-16T20:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15077#issuecomment-242457",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/bruno/15077_reverse_consistency" to "bd32a8489a8e2b13312a08ae021f4b9d328c2226"



---

archive/issue_events_049787.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-11-16T20:15:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15077",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15077#event-49787"
}
```
