# Issue 15692: Value of cached methods should not always be pickled

archive/issues_015455.json:
```json
{
    "body": "In #15278, the hash of graphs was turned into a `@cached_method`. If a cached method is pickled, then the cached value is pickled as well. In the case of a hash value, this is not always what we want, since the hash value might depend on the memory address of an object, or worse: The hash function might change in future implementations.\n\nThat's to say: If you save object O now, together with hash value 123, and later load it, then hash(O) will still be 123, even if a newly constructed object P with O==P might have hash(P)==456, because of a change in the hash function.\n\nThis obviously is a problem. There is something called `sage.misc.cachefunc.ClearCacheOnPickle`, but I don't know if this would really help in this case. Also, this would clear *all* cache values at once. Also, I don't know if it works for cached methods that do not take arguments (beside `self`).\n\nI suggest that we should instead have an optional parameter for `sage.misc.cachefunc.CachedMethodCallerNoArgs` that determines whether or not the cached value is preserved, and use it on graphs (and future applications of cached method on `__hash__`).\n\n**CC:**  @nathanncohen @vbraun @nbruin @novoselt jkeitel @nthiery\n\n**Keywords:** pickling, hash, cache, days71\n\n**Branch:** [a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)\n\n**Reviewer:** Vincent Delecroix, David Roe\n\n**Author:** Julian R\u00fcth\n\n**Dependencies:** #16337\n\nIssue created by migration from https://trac.sagemath.org/ticket/15692\n\n",
    "closed_at": "2016-07-09T16:29:27Z",
    "created_at": "2014-01-18T09:30:18Z",
    "labels": [
        "component: pickling",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Value of cached methods should not always be pickled",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15692",
    "user": "https://github.com/simon-king-jena"
}
```
In #15278, the hash of graphs was turned into a `@cached_method`. If a cached method is pickled, then the cached value is pickled as well. In the case of a hash value, this is not always what we want, since the hash value might depend on the memory address of an object, or worse: The hash function might change in future implementations.

That's to say: If you save object O now, together with hash value 123, and later load it, then hash(O) will still be 123, even if a newly constructed object P with O==P might have hash(P)==456, because of a change in the hash function.

This obviously is a problem. There is something called `sage.misc.cachefunc.ClearCacheOnPickle`, but I don't know if this would really help in this case. Also, this would clear *all* cache values at once. Also, I don't know if it works for cached methods that do not take arguments (beside `self`).

I suggest that we should instead have an optional parameter for `sage.misc.cachefunc.CachedMethodCallerNoArgs` that determines whether or not the cached value is preserved, and use it on graphs (and future applications of cached method on `__hash__`).

**CC:**  @nathanncohen @vbraun @nbruin @novoselt jkeitel @nthiery

**Keywords:** pickling, hash, cache, days71

**Branch:** [a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)

**Reviewer:** Vincent Delecroix, David Roe

**Author:** Julian RÃ¼th

**Dependencies:** #16337

Issue created by migration from https://trac.sagemath.org/ticket/15692





---

archive/issue_events_142162.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142162"
}
```



---

archive/issue_events_142163.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142163"
}
```



---

archive/issue_events_142164.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142164"
}
```



---

archive/issue_events_142165.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142165"
}
```



---

archive/issue_comments_201509.json:
```json
{
    "body": "<a id='comment:3'></a>\nIn #15149 it was proposed that caches should be 'opt-in and not opt-out' (comment:6:ticket:15149). Imho most caches are not used for things that are horribly expensive to compute, they are just too expensive to be computed again all the time.\n\nWould somebody mind if I implemented it that way, i.e., the default for a cache would be that it is not pickled?",
    "created_at": "2014-05-12T10:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201509",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:3'></a>
In #15149 it was proposed that caches should be 'opt-in and not opt-out' (comment:6:ticket:15149). Imho most caches are not used for things that are horribly expensive to compute, they are just too expensive to be computed again all the time.

Would somebody mind if I implemented it that way, i.e., the default for a cache would be that it is not pickled?



---

archive/issue_comments_201510.json:
```json
{
    "body": "**Branch:** [u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)",
    "created_at": "2014-05-12T17:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201510",
    "user": "https://github.com/saraedum"
}
```

**Branch:** [u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)



---

archive/issue_comments_201511.json:
```json
{
    "body": "**Dependencies:** #16337",
    "created_at": "2014-05-12T17:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201511",
    "user": "https://github.com/saraedum"
}
```

**Dependencies:** #16337



---

archive/issue_comments_201512.json:
```json
{
    "body": "**Author:** Julian Rueth",
    "created_at": "2014-05-12T17:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201512",
    "user": "https://github.com/saraedum"
}
```

**Author:** Julian Rueth



---

archive/issue_events_142166.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2014-05-12T17:44:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142166"
}
```



---

archive/issue_comments_201513.json:
```json
{
    "body": "<a id='comment:7'></a>\nI'm in support of this although I am not the right person to review the changes.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce27b841f38e12f650aedd68826571141a68f695\">ce27b84</a></td><td><code>Removed sage.misc.cachefunc.ClearCacheOnPickle</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e27e3167dde69107bb4f4c296c33b5827e70d4da\">e27e316</a></td><td><code>Propagate key of a @cached_method correctly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94fcddbe05b38dd914b5afbcfc5fbfa14105a100\">94fcddb</a></td><td><code>Merge branch 'u/saraedum/ticket/16337' of git://trac.sagemath.org/sage into ticket/15692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72fce8b2eea7a4e943fcf25cd705631ed62dcb92\">72fce8b</a></td><td><code>Added a pickle parameter for @cached_method</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07178496787dfa2e02b7bab8e32ca8e2971edaba\">0717849</a></td><td><code>Enable pickling of the cache for groebner_basis()</code></td></tr></table>\n",
    "created_at": "2014-05-12T22:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201513",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:7'></a>
I'm in support of this although I am not the right person to review the changes.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce27b841f38e12f650aedd68826571141a68f695">ce27b84</a></td><td><code>Removed sage.misc.cachefunc.ClearCacheOnPickle</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e27e3167dde69107bb4f4c296c33b5827e70d4da">e27e316</a></td><td><code>Propagate key of a @cached_method correctly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94fcddbe05b38dd914b5afbcfc5fbfa14105a100">94fcddb</a></td><td><code>Merge branch 'u/saraedum/ticket/16337' of git://trac.sagemath.org/sage into ticket/15692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72fce8b2eea7a4e943fcf25cd705631ed62dcb92">72fce8b</a></td><td><code>Added a pickle parameter for @cached_method</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07178496787dfa2e02b7bab8e32ca8e2971edaba">0717849</a></td><td><code>Enable pickling of the cache for groebner_basis()</code></td></tr></table>




---

archive/issue_comments_201514.json:
```json
{
    "body": "**Commit:** [07178496787dfa2e02b7bab8e32ca8e2971edaba](https://github.com/sagemath/sagetrac-mirror/commit/07178496787dfa2e02b7bab8e32ca8e2971edaba)",
    "created_at": "2014-05-12T22:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201514",
    "user": "https://github.com/novoselt"
}
```

**Commit:** [07178496787dfa2e02b7bab8e32ca8e2971edaba](https://github.com/sagemath/sagetrac-mirror/commit/07178496787dfa2e02b7bab8e32ca8e2971edaba)



---

archive/issue_comments_201515.json:
```json
{
    "body": "**Changing commit** from \"[07178496787dfa2e02b7bab8e32ca8e2971edaba](https://github.com/sagemath/sagetrac-mirror/commit/07178496787dfa2e02b7bab8e32ca8e2971edaba)\" to \"[9eab84b8c4f377576d067a9b7ca0eba43244f317](https://github.com/sagemath/sagetrac-mirror/commit/9eab84b8c4f377576d067a9b7ca0eba43244f317)\".",
    "created_at": "2014-07-23T16:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[07178496787dfa2e02b7bab8e32ca8e2971edaba](https://github.com/sagemath/sagetrac-mirror/commit/07178496787dfa2e02b7bab8e32ca8e2971edaba)" to "[9eab84b8c4f377576d067a9b7ca0eba43244f317](https://github.com/sagemath/sagetrac-mirror/commit/9eab84b8c4f377576d067a9b7ca0eba43244f317)".



---

archive/issue_comments_201516.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9eab84b8c4f377576d067a9b7ca0eba43244f317\">9eab84b</a></td><td><code>Merge branch 'develop' into ticket/15692</code></td></tr></table>\n",
    "created_at": "2014-07-23T16:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9eab84b8c4f377576d067a9b7ca0eba43244f317">9eab84b</a></td><td><code>Merge branch 'develop' into ticket/15692</code></td></tr></table>




---

archive/issue_events_142167.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142167"
}
```



---

archive/issue_events_142168.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142168"
}
```



---

archive/issue_comments_201517.json:
```json
{
    "body": "<a id='comment:10'></a>\ndoes not apply, needs rebase",
    "created_at": "2015-08-04T12:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201517",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
does not apply, needs rebase



---

archive/issue_events_142169.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-04T12:56:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142169"
}
```



---

archive/issue_events_142170.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-04T12:56:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142170"
}
```



---

archive/issue_comments_201518.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6\">13b4e4c</a></td><td><code>Merge branch 'develop' into t/15692/ticket/15692</code></td></tr></table>\n",
    "created_at": "2015-08-08T18:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201518",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6">13b4e4c</a></td><td><code>Merge branch 'develop' into t/15692/ticket/15692</code></td></tr></table>




---

archive/issue_comments_201519.json:
```json
{
    "body": "**Changing commit** from \"[9eab84b8c4f377576d067a9b7ca0eba43244f317](https://github.com/sagemath/sagetrac-mirror/commit/9eab84b8c4f377576d067a9b7ca0eba43244f317)\" to \"[13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6](https://github.com/sagemath/sagetrac-mirror/commit/13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6)\".",
    "created_at": "2015-08-08T18:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201519",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9eab84b8c4f377576d067a9b7ca0eba43244f317](https://github.com/sagemath/sagetrac-mirror/commit/9eab84b8c4f377576d067a9b7ca0eba43244f317)" to "[13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6](https://github.com/sagemath/sagetrac-mirror/commit/13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6)".



---

archive/issue_events_142171.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-08-08T18:59:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142171"
}
```



---

archive/issue_events_142172.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-08-08T18:59:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142172"
}
```



---

archive/issue_events_142173.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-09T08:31:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142173"
}
```



---

archive/issue_events_142174.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-09T08:31:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142174"
}
```



---

archive/issue_events_142175.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-09T08:31:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142175"
}
```



---

archive/issue_events_142176.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-09T08:31:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142176"
}
```



---

archive/issue_comments_201520.json:
```json
{
    "body": "<a id='comment:13'></a>\none failing doctest, see patchbot report",
    "created_at": "2015-08-09T08:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201520",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
one failing doctest, see patchbot report



---

archive/issue_comments_201521.json:
```json
{
    "body": "**Changing commit** from \"[13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6](https://github.com/sagemath/sagetrac-mirror/commit/13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6)\" to \"[616e86189f0d3a30c4885e38e01a619005446855](https://github.com/sagemath/sagetrac-mirror/commit/616e86189f0d3a30c4885e38e01a619005446855)\".",
    "created_at": "2015-08-12T18:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201521",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6](https://github.com/sagemath/sagetrac-mirror/commit/13b4e4cd7dc1ebd4f524dbe9cb33fb2a8775c3d6)" to "[616e86189f0d3a30c4885e38e01a619005446855](https://github.com/sagemath/sagetrac-mirror/commit/616e86189f0d3a30c4885e38e01a619005446855)".



---

archive/issue_comments_201522.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/616e86189f0d3a30c4885e38e01a619005446855\">616e861</a></td><td><code>Fix doctest in sage/misc/cachefunc.pyx</code></td></tr></table>\n",
    "created_at": "2015-08-12T18:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201522",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/616e86189f0d3a30c4885e38e01a619005446855">616e861</a></td><td><code>Fix doctest in sage/misc/cachefunc.pyx</code></td></tr></table>




---

archive/issue_events_142177.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-08-12T18:50:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142177"
}
```



---

archive/issue_events_142178.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-08-12T18:50:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142178"
}
```



---

archive/issue_events_142179.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-08-15T11:09:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142179"
}
```



---

archive/issue_events_142180.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-08-15T11:09:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142180"
}
```



---

archive/issue_comments_201523.json:
```json
{
    "body": "<a id='comment:16'></a>\nHello,\n\n\nIn `_cached_function_unpickle` instead of \n\n```\nfor k,v in cache:\n    ret.cache[k] = v\n```\nyou can simply do `ret.cache.update(cache)`. Moreover, in that function you should document the argument `cache`.\n\nI think that disabling the cache by default on pickle is a good improvement. However, the class `ClearCacheOnPickle` that you remove in your branch had several purposes: clear the cache on pickle but also on copy. Your version keep the cache on copy and that might not be appropriate for classes that used `ClearCacheOnPickle`.\n\nVincent",
    "created_at": "2015-08-15T11:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201523",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>
Hello,


In `_cached_function_unpickle` instead of 

```
for k,v in cache:
    ret.cache[k] = v
```
you can simply do `ret.cache.update(cache)`. Moreover, in that function you should document the argument `cache`.

I think that disabling the cache by default on pickle is a good improvement. However, the class `ClearCacheOnPickle` that you remove in your branch had several purposes: clear the cache on pickle but also on copy. Your version keep the cache on copy and that might not be appropriate for classes that used `ClearCacheOnPickle`.

Vincent



---

archive/issue_comments_201524.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2015-08-15T11:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201524",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_201525.json:
```json
{
    "body": "**Changing commit** from \"[616e86189f0d3a30c4885e38e01a619005446855](https://github.com/sagemath/sagetrac-mirror/commit/616e86189f0d3a30c4885e38e01a619005446855)\" to \"[b2aa4073a6724e0c92c719f8d3eb232ef0bc2102](https://github.com/sagemath/sagetrac-mirror/commit/b2aa4073a6724e0c92c719f8d3eb232ef0bc2102)\".",
    "created_at": "2015-08-18T18:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201525",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[616e86189f0d3a30c4885e38e01a619005446855](https://github.com/sagemath/sagetrac-mirror/commit/616e86189f0d3a30c4885e38e01a619005446855)" to "[b2aa4073a6724e0c92c719f8d3eb232ef0bc2102](https://github.com/sagemath/sagetrac-mirror/commit/b2aa4073a6724e0c92c719f8d3eb232ef0bc2102)".



---

archive/issue_comments_201526.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2aa4073a6724e0c92c719f8d3eb232ef0bc2102\">b2aa407</a></td><td><code>Improve docstring of sage.misc.cachefunc._cached_function_unpickle</code></td></tr></table>\n",
    "created_at": "2015-08-18T18:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201526",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2aa4073a6724e0c92c719f8d3eb232ef0bc2102">b2aa407</a></td><td><code>Improve docstring of sage.misc.cachefunc._cached_function_unpickle</code></td></tr></table>




---

archive/issue_comments_201527.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [vdelecroix](#comment%3A16):\n> I think that disabling the cache by default on pickle is a good improvement. However, the class `ClearCacheOnPickle` that you remove in your branch had several purposes: clear the cache on pickle but also on copy. Your version keep the cache on copy and that might not be appropriate for classes that used `ClearCacheOnPickle`.\n\nThanks for pointing this out. What should we do about this? Should caches ever be copied actually?",
    "created_at": "2015-08-18T18:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201527",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:19'></a>
Replying to [vdelecroix](#comment%3A16):
> I think that disabling the cache by default on pickle is a good improvement. However, the class `ClearCacheOnPickle` that you remove in your branch had several purposes: clear the cache on pickle but also on copy. Your version keep the cache on copy and that might not be appropriate for classes that used `ClearCacheOnPickle`.

Thanks for pointing this out. What should we do about this? Should caches ever be copied actually?



---

archive/issue_events_142181.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-08-18T18:46:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142181"
}
```



---

archive/issue_events_142182.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-08-18T18:46:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142182"
}
```



---

archive/issue_comments_201528.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [saraedum](#comment%3A19):\n> Replying to [vdelecroix](#comment%3A16):\n> > I think that disabling the cache by default on pickle is a good improvement. However, the class `ClearCacheOnPickle` that you remove in your branch had several purposes: clear the cache on pickle but also on copy. Your version keep the cache on copy and that might not be appropriate for classes that used `ClearCacheOnPickle`.\n\n> Thanks for pointing this out. What should we do about this? Should caches ever be copied actually?\n\nI guess not. And if you really want to, it is always possible to fill the cache manually.",
    "created_at": "2015-08-18T21:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201528",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
Replying to [saraedum](#comment%3A19):
> Replying to [vdelecroix](#comment%3A16):
> > I think that disabling the cache by default on pickle is a good improvement. However, the class `ClearCacheOnPickle` that you remove in your branch had several purposes: clear the cache on pickle but also on copy. Your version keep the cache on copy and that might not be appropriate for classes that used `ClearCacheOnPickle`.

> Thanks for pointing this out. What should we do about this? Should caches ever be copied actually?

I guess not. And if you really want to, it is always possible to fill the cache manually.



---

archive/issue_comments_201529.json:
```json
{
    "body": "<a id='comment:22'></a>\nDo you have any idea how I could implement that? I could for example implement `__getstate__` for sage parents and elements, but then whenever it is overwritten I would have to rely on the super implementation being called. I could also implement `__copy__` there which is muss less likely to be overwritten but still the problem is the same.\nThe problem is that unlike with pickling, `__getstate__` is not called on the cached methods when a shallow copy is made (only for a deep copy.)\nOne thing I could think of is putting the `id` of the original object into each of its caches. Any call to the cache could check that id (which could be a small but significant performance loss) and complain if it does not match the element the cache is associated to.\n\nI think that implementing `__copy__` is probably the best path to take.",
    "created_at": "2015-08-24T02:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201529",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:22'></a>
Do you have any idea how I could implement that? I could for example implement `__getstate__` for sage parents and elements, but then whenever it is overwritten I would have to rely on the super implementation being called. I could also implement `__copy__` there which is muss less likely to be overwritten but still the problem is the same.
The problem is that unlike with pickling, `__getstate__` is not called on the cached methods when a shallow copy is made (only for a deep copy.)
One thing I could think of is putting the `id` of the original object into each of its caches. Any call to the cache could check that id (which could be a small but significant performance loss) and complain if it does not match the element the cache is associated to.

I think that implementing `__copy__` is probably the best path to take.



---

archive/issue_comments_201530.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [saraedum](#comment%3A22):\n> Do you have any idea how I could implement that? I could for example implement `__getstate__` for sage parents and elements, but then whenever it is overwritten I would have to rely on the super implementation being called.\n\n\n(I'm pretty sure that `__getstate__` should call its super unless one really knows what one is doing. A bigger problem is that `__getstate__` is only a convention that the standard `__reduce__` uses. I'm sure there are classes that implement their own `__reduce__` far below the point where you'd be thinking of injecting your `__getstate__`)\n\nOn #15207 there is some discussion of some possible infrastructure for managing these things. Perhaps it's relevant for your case?\n\n>I could also implement `__copy__` there which is muss less likely to be overwritten but still the problem is the same.\n\n\nI would recommend leaving `__copy__` out of it. That has nothing to do with the pickling/serialization protocol. It provides a \"cheap\" way of replicating a mutable structure (note that for immutable structures, `__copy__` routinely returns `self`, because immutability implies) so that mutations of one do not affect the other.\n\nMutable structures need to take care that they invalidate caches already (when mutated). I would say that a default behaviour where `copy` creates a new object with the same caches would be appropriate. The default behaviour of \"copy\" is to copy the instance dict, which largely establishes this.\n\nIf this is not appropriate behaviour, it seems to me that the class has rather special needs and hence should provide its own `__copy__`.\n\n**EDIT:** I see that `ClearCacheOnPickle` gets its `copy` behaviour because under certain circumstances, `copy(...)` will revert to calling `__getstate__`. So I would expect that this would continue to be the case.  Since the \"clear cache on copy\" is a bit of a side-effect of the implementation of `ClearCacheOnPickle` I would try and see if just changing the copy behaviour gives acceptable results. If not then providing a custom `__copy__` on just the class that originally inherited from `ClearCacheOnPickle` would do the trick. Going forward, I think having caches replicated (or probably even shared!) between shallow copies by default doesn't seem like an unreasonable default.",
    "created_at": "2015-08-24T18:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201530",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:23'></a>
Replying to [saraedum](#comment%3A22):
> Do you have any idea how I could implement that? I could for example implement `__getstate__` for sage parents and elements, but then whenever it is overwritten I would have to rely on the super implementation being called.


(I'm pretty sure that `__getstate__` should call its super unless one really knows what one is doing. A bigger problem is that `__getstate__` is only a convention that the standard `__reduce__` uses. I'm sure there are classes that implement their own `__reduce__` far below the point where you'd be thinking of injecting your `__getstate__`)

On #15207 there is some discussion of some possible infrastructure for managing these things. Perhaps it's relevant for your case?

>I could also implement `__copy__` there which is muss less likely to be overwritten but still the problem is the same.


I would recommend leaving `__copy__` out of it. That has nothing to do with the pickling/serialization protocol. It provides a "cheap" way of replicating a mutable structure (note that for immutable structures, `__copy__` routinely returns `self`, because immutability implies) so that mutations of one do not affect the other.

Mutable structures need to take care that they invalidate caches already (when mutated). I would say that a default behaviour where `copy` creates a new object with the same caches would be appropriate. The default behaviour of "copy" is to copy the instance dict, which largely establishes this.

If this is not appropriate behaviour, it seems to me that the class has rather special needs and hence should provide its own `__copy__`.

**EDIT:** I see that `ClearCacheOnPickle` gets its `copy` behaviour because under certain circumstances, `copy(...)` will revert to calling `__getstate__`. So I would expect that this would continue to be the case.  Since the "clear cache on copy" is a bit of a side-effect of the implementation of `ClearCacheOnPickle` I would try and see if just changing the copy behaviour gives acceptable results. If not then providing a custom `__copy__` on just the class that originally inherited from `ClearCacheOnPickle` would do the trick. Going forward, I think having caches replicated (or probably even shared!) between shallow copies by default doesn't seem like an unreasonable default.



---

archive/issue_comments_201531.json:
```json
{
    "body": "<a id='comment:24'></a>\nOk. Thanks for the input. I will implement it like that. Explicitly implement `__copy__` where it is necessary to keep the old behaviour and leave everything else like it is in my branch.",
    "created_at": "2015-08-27T00:04:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201531",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:24'></a>
Ok. Thanks for the input. I will implement it like that. Explicitly implement `__copy__` where it is necessary to keep the old behaviour and leave everything else like it is in my branch.



---

archive/issue_comments_201532.json:
```json
{
    "body": "<a id='comment:25'></a>\nTrying to implement this, I realized that the point of the `ClearCacheOnPickle` on these classes was certainly not to clear *all* caches on copy.\nAlso, `ClearCacheOnPickle` is broken, since it replaces any cache dictionary with an actual `dict` , i.e., it would  replace a weak dictionary with a regular one.)\n\nI guess there was in each case some cached method which should not be pickled (or probably copied.)\nSo it is probably better to look at the actual occurences and fix the copying there instead of just hacking a \"drop some caches\" `__copy__` method which probably does too much and might even break if we change the cached methods next time around.\n\nThe classes which carry `ClearCacheOnPickle` are:\n* `ToricVariety_field` where it was added in `0be2c23d` with the comment \"Do not pickle caches of toric varieties\". So it could be alright if we still copied them.\n* `WeilGroup_gens` where it was added when the class did not provide the functionality to clear caches on copy. So it might be alright to copy them.\n* `AmbientSpace` and `RootSpace` where it is not clear why it was added exactly. Maybe Nicolas could clarify this (author of the commit which added it.)\n\nBtw. the lengthy discussion in #11115 (this is where the clear caches on copy was introduced) does not make any mention of \"copy\".",
    "created_at": "2015-09-03T21:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201532",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:25'></a>
Trying to implement this, I realized that the point of the `ClearCacheOnPickle` on these classes was certainly not to clear *all* caches on copy.
Also, `ClearCacheOnPickle` is broken, since it replaces any cache dictionary with an actual `dict` , i.e., it would  replace a weak dictionary with a regular one.)

I guess there was in each case some cached method which should not be pickled (or probably copied.)
So it is probably better to look at the actual occurences and fix the copying there instead of just hacking a "drop some caches" `__copy__` method which probably does too much and might even break if we change the cached methods next time around.

The classes which carry `ClearCacheOnPickle` are:
* `ToricVariety_field` where it was added in `0be2c23d` with the comment "Do not pickle caches of toric varieties". So it could be alright if we still copied them.
* `WeilGroup_gens` where it was added when the class did not provide the functionality to clear caches on copy. So it might be alright to copy them.
* `AmbientSpace` and `RootSpace` where it is not clear why it was added exactly. Maybe Nicolas could clarify this (author of the commit which added it.)

Btw. the lengthy discussion in #11115 (this is where the clear caches on copy was introduced) does not make any mention of "copy".



---

archive/issue_comments_201533.json:
```json
{
    "body": "<a id='comment:26'></a>\nSince there has been no reaction for quite a while, I'm setting this back to needs review. I think my current implementation does the right thing.",
    "created_at": "2015-09-29T19:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201533",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:26'></a>
Since there has been no reaction for quite a while, I'm setting this back to needs review. I think my current implementation does the right thing.



---

archive/issue_events_142183.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-09-29T19:39:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142183"
}
```



---

archive/issue_events_142184.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-09-29T19:39:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142184"
}
```



---

archive/issue_events_142185.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-10-02T01:41:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142185"
}
```



---

archive/issue_events_142186.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-10-02T01:41:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142186"
}
```



---

archive/issue_comments_201534.json:
```json
{
    "body": "<a id='comment:27'></a>\nFrom the patchbot\n\n```\nsage -t --long src/sage/misc/cachefunc.pyx\n**********************************************************************\nFile \"src/sage/misc/cachefunc.pyx\", line 3185, in sage.misc.cachefunc.cached_method\nFailed example:\n    id(d) == hash(d)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   1 of  30 in sage.misc.cachefunc.cached_method\n    [830 tests, 1 failure, 15.75 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/misc/cachefunc.pyx  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2015-10-02T01:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201534",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>
From the patchbot

```
sage -t --long src/sage/misc/cachefunc.pyx
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 3185, in sage.misc.cachefunc.cached_method
Failed example:
    id(d) == hash(d)
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   1 of  30 in sage.misc.cachefunc.cached_method
    [830 tests, 1 failure, 15.75 s]
----------------------------------------------------------------------
sage -t --long src/sage/misc/cachefunc.pyx  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_201535.json:
```json
{
    "body": "<a id='comment:28'></a>\nThat test does not fail for me. It is reported to be fine by another patchbot. Maybe the patchbot that ran it is broken somehow? I can not really imagine that something \"random\" is happening here.",
    "created_at": "2015-10-04T21:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201535",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:28'></a>
That test does not fail for me. It is reported to be fine by another patchbot. Maybe the patchbot that ran it is broken somehow? I can not really imagine that something "random" is happening here.



---

archive/issue_events_142187.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-10-04T21:49:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142187"
}
```



---

archive/issue_events_142188.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2015-10-04T21:49:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142188"
}
```



---

archive/issue_comments_201536.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67c7782df66179ebc0e7dd09b2518f76b6ecf198\">67c7782</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into t/15692/ticket/15692</code></td></tr></table>\n",
    "created_at": "2015-12-23T18:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67c7782df66179ebc0e7dd09b2518f76b6ecf198">67c7782</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into t/15692/ticket/15692</code></td></tr></table>




---

archive/issue_comments_201537.json:
```json
{
    "body": "**Changing commit** from \"[b2aa4073a6724e0c92c719f8d3eb232ef0bc2102](https://github.com/sagemath/sagetrac-mirror/commit/b2aa4073a6724e0c92c719f8d3eb232ef0bc2102)\" to \"[67c7782df66179ebc0e7dd09b2518f76b6ecf198](https://github.com/sagemath/sagetrac-mirror/commit/67c7782df66179ebc0e7dd09b2518f76b6ecf198)\".",
    "created_at": "2015-12-23T18:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b2aa4073a6724e0c92c719f8d3eb232ef0bc2102](https://github.com/sagemath/sagetrac-mirror/commit/b2aa4073a6724e0c92c719f8d3eb232ef0bc2102)" to "[67c7782df66179ebc0e7dd09b2518f76b6ecf198](https://github.com/sagemath/sagetrac-mirror/commit/67c7782df66179ebc0e7dd09b2518f76b6ecf198)".



---

archive/issue_comments_201538.json:
```json
{
    "body": "<a id='comment:30'></a>\nWhat's the use case for `pickle=True`? I would say that a cache should *never* be pickled.",
    "created_at": "2015-12-23T19:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201538",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
What's the use case for `pickle=True`? I would say that a cache should *never* be pickled.



---

archive/issue_comments_201539.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [jdemeyer](#comment%3A30):\n> What's the use case for `pickle=True`? I would say that a cache should *never* be pickled.\n\n\nIf something in cache is expensive to compute and you want to dump your object so that later you can load it with cache full. I use it regularly for my personal classes and some time ago it was also used for lists of reflexive polytopes (to store points and faces that were taking many seconds to recompute). One may argue whether it is the best way philosophically or not, but it is easy and it works, so it is nice to have this possibility available.",
    "created_at": "2015-12-25T04:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201539",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:31'></a>
Replying to [jdemeyer](#comment%3A30):
> What's the use case for `pickle=True`? I would say that a cache should *never* be pickled.


If something in cache is expensive to compute and you want to dump your object so that later you can load it with cache full. I use it regularly for my personal classes and some time ago it was also used for lists of reflexive polytopes (to store points and faces that were taking many seconds to recompute). One may argue whether it is the best way philosophically or not, but it is easy and it works, so it is nice to have this possibility available.



---

archive/issue_comments_201540.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [novoselt](#comment%3A31):\n> If something in cache is expensive to compute and you want to dump your object so that later you can load it with cache full. I use it regularly for my personal classes and some time ago it was also used for lists of reflexive polytopes (to store points and faces that were taking many seconds to recompute). One may argue whether it is the best way philosophically or not, but it is easy and it works, so it is nice to have this possibility available.\n\n\nThat seems like an argument for making `pickle=True` the default.\n\nSomething else: couldn't this be implemented more easily by a new class instead of adding `pickle` arguments everywhere?",
    "created_at": "2015-12-25T12:51:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201540",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>
Replying to [novoselt](#comment%3A31):
> If something in cache is expensive to compute and you want to dump your object so that later you can load it with cache full. I use it regularly for my personal classes and some time ago it was also used for lists of reflexive polytopes (to store points and faces that were taking many seconds to recompute). One may argue whether it is the best way philosophically or not, but it is easy and it works, so it is nice to have this possibility available.


That seems like an argument for making `pickle=True` the default.

Something else: couldn't this be implemented more easily by a new class instead of adding `pickle` arguments everywhere?



---

archive/issue_events_142189.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-12-25T12:55:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142189"
}
```



---

archive/issue_events_142190.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-12-25T12:55:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142190"
}
```



---

archive/issue_events_142191.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-12-25T12:55:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142191"
}
```



---

archive/issue_events_142192.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-12-25T12:55:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "milestone": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142192"
}
```



---

archive/issue_comments_201541.json:
```json
{
    "body": "<a id='comment:33'></a>\nOne easy simplification: make `CacheDict` never pickle its contents and just choose the type `dict` or `CacheDict`.",
    "created_at": "2015-12-25T12:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201541",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
One easy simplification: make `CacheDict` never pickle its contents and just choose the type `dict` or `CacheDict`.



---

archive/issue_comments_201542.json:
```json
{
    "body": "<a id='comment:34'></a>\nOne easy simplification: make `CacheDict` never pickle its contents and just choose the type `dict` or `CacheDict`.",
    "created_at": "2015-12-25T12:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201542",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
One easy simplification: make `CacheDict` never pickle its contents and just choose the type `dict` or `CacheDict`.



---

archive/issue_comments_201543.json:
```json
{
    "body": "<a id='comment:35'></a>\nThis is not grammatically correct:\n\n```\nPer default, the contents of the cache are not pickle::\n```",
    "created_at": "2015-12-25T12:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201543",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>
This is not grammatically correct:

```
Per default, the contents of the cache are not pickle::
```



---

archive/issue_comments_201544.json:
```json
{
    "body": "<a id='comment:36'></a>\nCan you replace the `pickle` keyword and attribute to `do_pickle` since that more accurately describes the intention.\n\nAlso, please explain the reason for changing both the pickling/unpickling of the cached function themselves as well as the `CacheDict`. It seems that they both solve your problem and I don't see why this problem needs to be solved twice.",
    "created_at": "2015-12-25T13:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201544",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>
Can you replace the `pickle` keyword and attribute to `do_pickle` since that more accurately describes the intention.

Also, please explain the reason for changing both the pickling/unpickling of the cached function themselves as well as the `CacheDict`. It seems that they both solve your problem and I don't see why this problem needs to be solved twice.



---

archive/issue_comments_201545.json:
```json
{
    "body": "**Changing commit** from \"[67c7782df66179ebc0e7dd09b2518f76b6ecf198](https://github.com/sagemath/sagetrac-mirror/commit/67c7782df66179ebc0e7dd09b2518f76b6ecf198)\" to \"[54539bcd5bddd7038fb5b0fd46a992c6ff96d238](https://github.com/sagemath/sagetrac-mirror/commit/54539bcd5bddd7038fb5b0fd46a992c6ff96d238)\".",
    "created_at": "2016-03-20T21:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201545",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[67c7782df66179ebc0e7dd09b2518f76b6ecf198](https://github.com/sagemath/sagetrac-mirror/commit/67c7782df66179ebc0e7dd09b2518f76b6ecf198)" to "[54539bcd5bddd7038fb5b0fd46a992c6ff96d238](https://github.com/sagemath/sagetrac-mirror/commit/54539bcd5bddd7038fb5b0fd46a992c6ff96d238)".



---

archive/issue_comments_201546.json:
```json
{
    "body": "<a id='comment:37'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54539bcd5bddd7038fb5b0fd46a992c6ff96d238\">54539bc</a></td><td><code>Merge branch 'develop' into t/15692/ticket/15692</code></td></tr></table>\n",
    "created_at": "2016-03-20T21:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201546",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54539bcd5bddd7038fb5b0fd46a992c6ff96d238">54539bc</a></td><td><code>Merge branch 'develop' into t/15692/ticket/15692</code></td></tr></table>




---

archive/issue_comments_201547.json:
```json
{
    "body": "<a id='comment:38'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c182f4070e35ae5d603f8c6d8c86c9d9885d7b98\">c182f40</a></td><td><code>Remove ClearCacheOnPickle meta class</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/505c7af667df54ee28441a74da0896fe358ddb31\">505c7af</a></td><td><code>Do not pickle cache methods</code></td></tr></table>\n",
    "created_at": "2016-03-20T22:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201547",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c182f4070e35ae5d603f8c6d8c86c9d9885d7b98">c182f40</a></td><td><code>Remove ClearCacheOnPickle meta class</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/505c7af667df54ee28441a74da0896fe358ddb31">505c7af</a></td><td><code>Do not pickle cache methods</code></td></tr></table>




---

archive/issue_comments_201548.json:
```json
{
    "body": "**Changing commit** from \"[54539bcd5bddd7038fb5b0fd46a992c6ff96d238](https://github.com/sagemath/sagetrac-mirror/commit/54539bcd5bddd7038fb5b0fd46a992c6ff96d238)\" to \"[505c7af667df54ee28441a74da0896fe358ddb31](https://github.com/sagemath/sagetrac-mirror/commit/505c7af667df54ee28441a74da0896fe358ddb31)\".",
    "created_at": "2016-03-20T22:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201548",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[54539bcd5bddd7038fb5b0fd46a992c6ff96d238](https://github.com/sagemath/sagetrac-mirror/commit/54539bcd5bddd7038fb5b0fd46a992c6ff96d238)" to "[505c7af667df54ee28441a74da0896fe358ddb31](https://github.com/sagemath/sagetrac-mirror/commit/505c7af667df54ee28441a74da0896fe358ddb31)".



---

archive/issue_comments_201549.json:
```json
{
    "body": "**Changing commit** from \"[505c7af667df54ee28441a74da0896fe358ddb31](https://github.com/sagemath/sagetrac-mirror/commit/505c7af667df54ee28441a74da0896fe358ddb31)\" to \"[e3a7eb4e7ec0852fb058e5455d270067846ea2b6](https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6)\".",
    "created_at": "2016-03-20T22:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201549",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[505c7af667df54ee28441a74da0896fe358ddb31](https://github.com/sagemath/sagetrac-mirror/commit/505c7af667df54ee28441a74da0896fe358ddb31)" to "[e3a7eb4e7ec0852fb058e5455d270067846ea2b6](https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6)".



---

archive/issue_comments_201550.json:
```json
{
    "body": "<a id='comment:39'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6\">e3a7eb4</a></td><td><code>Do not pickle cached methods</code></td></tr></table>\n",
    "created_at": "2016-03-20T22:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201550",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6">e3a7eb4</a></td><td><code>Do not pickle cached methods</code></td></tr></table>




---

archive/issue_comments_201551.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [jdemeyer](#comment%3A36):\n> Can you replace the `pickle` keyword and attribute to `do_pickle` since that more accurately describes the intention.\n\nFixed.\n> Also, please explain the reason for changing both the pickling/unpickling of the cached function themselves as well as the `CacheDict`. It seems that they both solve your problem and I don't see why this problem needs to be solved twice.\n\nYou are right. I did look at the (do_)pickle parameter in too many places.",
    "created_at": "2016-03-20T22:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201551",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:40'></a>
Replying to [jdemeyer](#comment%3A36):
> Can you replace the `pickle` keyword and attribute to `do_pickle` since that more accurately describes the intention.

Fixed.
> Also, please explain the reason for changing both the pickling/unpickling of the cached function themselves as well as the `CacheDict`. It seems that they both solve your problem and I don't see why this problem needs to be solved twice.

You are right. I did look at the (do_)pickle parameter in too many places.



---

archive/issue_events_142193.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-03-21T11:40:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142193"
}
```



---

archive/issue_events_142194.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-03-21T11:40:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142194"
}
```



---

archive/issue_comments_201552.json:
```json
{
    "body": "**Changing keywords** from \"pickling hash cache\" to \"pickling, hash, cache, days71\".",
    "created_at": "2016-03-24T02:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201552",
    "user": "https://github.com/saraedum"
}
```

**Changing keywords** from "pickling hash cache" to "pickling, hash, cache, days71".



---

archive/issue_comments_201553.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1\">746dc53</a></td><td><code>fix grammar in doctest</code></td></tr></table>\n",
    "created_at": "2016-03-24T02:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201553",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1">746dc53</a></td><td><code>fix grammar in doctest</code></td></tr></table>




---

archive/issue_comments_201554.json:
```json
{
    "body": "**Changing commit** from \"[e3a7eb4e7ec0852fb058e5455d270067846ea2b6](https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6)\" to \"[746dc53e1d767870430a3770eef1159c6534b9b1](https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1)\".",
    "created_at": "2016-03-24T02:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201554",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e3a7eb4e7ec0852fb058e5455d270067846ea2b6](https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6)" to "[746dc53e1d767870430a3770eef1159c6534b9b1](https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1)".



---

archive/issue_comments_201555.json:
```json
{
    "body": "**Changing reviewer** from \"Vincent Delecroix\" to \"Vincent Delecroix, David Roe\".",
    "created_at": "2016-03-24T03:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201555",
    "user": "https://github.com/roed314"
}
```

**Changing reviewer** from "Vincent Delecroix" to "Vincent Delecroix, David Roe".



---

archive/issue_comments_201556.json:
```json
{
    "body": "<a id='comment:44'></a>\nLooks good to me.",
    "created_at": "2016-03-24T03:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201556",
    "user": "https://github.com/roed314"
}
```

<a id='comment:44'></a>
Looks good to me.



---

archive/issue_events_142195.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2016-03-24T03:10:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142195"
}
```



---

archive/issue_events_142196.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2016-03-24T03:10:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142196"
}
```



---

archive/issue_comments_201557.json:
```json
{
    "body": "<a id='comment:45'></a>\nI'm not going to change this from positive review, but I found the tiniest doctest typo:\n\n```\n+        Per default, the contents of the cache are not pickle::\n```\npickle should be pickled here.",
    "created_at": "2016-03-24T09:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201557",
    "user": "https://github.com/adeines"
}
```

<a id='comment:45'></a>
I'm not going to change this from positive review, but I found the tiniest doctest typo:

```
+        Per default, the contents of the cache are not pickle::
```
pickle should be pickled here.



---

archive/issue_comments_201558.json:
```json
{
    "body": "<a id='comment:46'></a>\nI think you're looking at an old version; that typo was what was fixed in 746dc53.",
    "created_at": "2016-03-24T19:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201558",
    "user": "https://github.com/roed314"
}
```

<a id='comment:46'></a>
I think you're looking at an old version; that typo was what was fixed in 746dc53.



---

archive/issue_comments_201559.json:
```json
{
    "body": "<a id='comment:47'></a>\nAwesome!",
    "created_at": "2016-03-25T00:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201559",
    "user": "https://github.com/adeines"
}
```

<a id='comment:47'></a>
Awesome!



---

archive/issue_comments_201560.json:
```json
{
    "body": "<a id='comment:48'></a>\nFails on 32-bit:\n\n```\nsage -t --long src/sage/misc/cachefunc.pyx\n**********************************************************************\nFile \"src/sage/misc/cachefunc.pyx\", line 3161, in sage.misc.cachefunc.cached_method\nFailed example:\n    id(d) == hash(d)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   1 of  30 in sage.misc.cachefunc.cached_method\n    [843 tests, 1 failure, 8.96 s]\n```",
    "created_at": "2016-03-26T09:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201560",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:48'></a>
Fails on 32-bit:

```
sage -t --long src/sage/misc/cachefunc.pyx
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 3161, in sage.misc.cachefunc.cached_method
Failed example:
    id(d) == hash(d)
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   1 of  30 in sage.misc.cachefunc.cached_method
    [843 tests, 1 failure, 8.96 s]
```



---

archive/issue_events_142197.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-26T09:10:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142197"
}
```



---

archive/issue_events_142198.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-26T09:10:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142198"
}
```



---

archive/issue_comments_201561.json:
```json
{
    "body": "**Changing commit** from \"[746dc53e1d767870430a3770eef1159c6534b9b1](https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1)\" to \"[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)\".",
    "created_at": "2016-06-20T17:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201561",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[746dc53e1d767870430a3770eef1159c6534b9b1](https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1)" to "[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)".



---

archive/issue_comments_201562.json:
```json
{
    "body": "<a id='comment:49'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a6067a6261416c86bc3d77129ff3e7cf64a005b\">3a6067a</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4\">7ef7a41</a></td><td><code>Remove id check from cached method doctest</code></td></tr></table>\n",
    "created_at": "2016-06-20T17:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a6067a6261416c86bc3d77129ff3e7cf64a005b">3a6067a</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4">7ef7a41</a></td><td><code>Remove id check from cached method doctest</code></td></tr></table>




---

archive/issue_events_142199.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-06-20T17:11:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142199"
}
```



---

archive/issue_events_142200.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-06-20T17:11:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142200"
}
```



---

archive/issue_comments_201563.json:
```json
{
    "body": "<a id='comment:51'></a>\nSince this is such a minor change, I set this back to positive review.",
    "created_at": "2016-06-20T17:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201563",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:51'></a>
Since this is such a minor change, I set this back to positive review.



---

archive/issue_comments_201564.json:
```json
{
    "body": "<a id='comment:52'></a>\nI suspect I am getting this in sage-on-gentoo pulling volker's current develop branch because of this:\n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py\", line 473, in sage.modular.overconvergent.weightspace.AlgebraicWeight\nFailed example:\n    w == loads(dumps(w))\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 501, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 864, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.modular.overconvergent.weightspace.AlgebraicWeight[3]>\", line 1, in <module>\n        w == loads(dumps(w))\n      File \"sage/structure/element.pyx\", line 913, in sage.structure.element.Element.__richcmp__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/element.c:9542)\n        return (<Element>self)._richcmp_(<Element>other, op)\n      File \"sage/structure/element.pyx\", line 948, in sage.structure.element.Element._richcmp_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/element.c:9722)\n        c = left._cmp_(right)\n      File \"sage/structure/element.pyx\", line 964, in sage.structure.element.Element._cmp_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/element.c:10101)\n        return left_cmp(right)\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py\", line 417, in __cmp__\n        return cmp(self.values_on_gens(), other.values_on_gens())\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py\", line 380, in values_on_gens\n        return ( self(self.parent()._param), self.teichmuller_type())\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py\", line 539, in __call__\n        if self._p**(x.precision_absolute()) < self._chi.conductor():\n      File \"sage/misc/cachefunc.pyx\", line 1717, in sage.misc.cachefunc.CachedMethodPickle.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:8703)\n        return CM(*args,**kwds)\n      File \"sage/misc/cachefunc.pyx\", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)\n        self.cache = f(self._instance)\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py\", line 755, in conductor\n        if self.modulus() == 1 or self.is_trivial():\n      File \"sage/misc/cachefunc.pyx\", line 1717, in sage.misc.cachefunc.CachedMethodPickle.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:8703)\n        return CM(*args,**kwds)\n      File \"sage/misc/cachefunc.pyx\", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)\n        self.cache = f(self._instance)\n```\nand ending after many lines with\n\n```\n      File \"sage/misc/cachefunc.pyx\", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)\n        self.cache = f(self._instance)\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py\", line 1738, in element\n        v = M([dlog[x] for x in self.values_on_gens()])\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py\", line 1705, in values_on_gens\n        v = tuple([pows[i] for i in self.element()])\n      File \"sage/misc/cachefunc.pyx\", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)\n        self.cache = f(self._instance)\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py\", line 1730, in element\n        M = P._module\n      File \"/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py\", line 2137, in _module\n        len(self.unit_gens()))\n      File \"sage/structure/factory.pyx\", line 361, in sage.structure.factory.UniqueFactory.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/factory.c:1585)\n        key, kwds = self.create_key_and_extra_args(*args, **kwds)\n      File \"sage/structure/factory.pyx\", line 459, in sage.structure.factory.UniqueFactory.create_key_and_extra_args (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/factory.c:2722)\n        return self.create_key(*args, **kwds), {}\n      File \"/usr/lib64/python2.7/site-packages/sage/modules/free_module.py\", line 336, in create_key\n        rank = int(sage.rings.integer.Integer(rank))\n    RuntimeError: maximum recursion depth exceeded while calling a Python object\n**********************************************************************\n1 item had failures:\n   2 of   6 in sage.modular.overconvergent.weightspace.AlgebraicWeight\n    [108 tests, 2 failures, 0.32 s]\n----------------------------------------------------------------------\nsage -t --long /usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\nThere are two of those. There is always the possibility that I missed a patch in `python` or some other place that deals with this but I don't think so.",
    "created_at": "2016-06-21T04:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201564",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:52'></a>
I suspect I am getting this in sage-on-gentoo pulling volker's current develop branch because of this:

```
File "/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py", line 473, in sage.modular.overconvergent.weightspace.AlgebraicWeight
Failed example:
    w == loads(dumps(w))
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 501, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 864, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.modular.overconvergent.weightspace.AlgebraicWeight[3]>", line 1, in <module>
        w == loads(dumps(w))
      File "sage/structure/element.pyx", line 913, in sage.structure.element.Element.__richcmp__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/element.c:9542)
        return (<Element>self)._richcmp_(<Element>other, op)
      File "sage/structure/element.pyx", line 948, in sage.structure.element.Element._richcmp_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/element.c:9722)
        c = left._cmp_(right)
      File "sage/structure/element.pyx", line 964, in sage.structure.element.Element._cmp_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/element.c:10101)
        return left_cmp(right)
      File "/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py", line 417, in __cmp__
        return cmp(self.values_on_gens(), other.values_on_gens())
      File "/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py", line 380, in values_on_gens
        return ( self(self.parent()._param), self.teichmuller_type())
      File "/usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py", line 539, in __call__
        if self._p**(x.precision_absolute()) < self._chi.conductor():
      File "sage/misc/cachefunc.pyx", line 1717, in sage.misc.cachefunc.CachedMethodPickle.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:8703)
        return CM(*args,**kwds)
      File "sage/misc/cachefunc.pyx", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)
        self.cache = f(self._instance)
      File "/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py", line 755, in conductor
        if self.modulus() == 1 or self.is_trivial():
      File "sage/misc/cachefunc.pyx", line 1717, in sage.misc.cachefunc.CachedMethodPickle.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:8703)
        return CM(*args,**kwds)
      File "sage/misc/cachefunc.pyx", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)
        self.cache = f(self._instance)
```
and ending after many lines with

```
      File "sage/misc/cachefunc.pyx", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)
        self.cache = f(self._instance)
      File "/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py", line 1738, in element
        v = M([dlog[x] for x in self.values_on_gens()])
      File "/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py", line 1705, in values_on_gens
        v = tuple([pows[i] for i in self.element()])
      File "sage/misc/cachefunc.pyx", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:12708)
        self.cache = f(self._instance)
      File "/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py", line 1730, in element
        M = P._module
      File "/usr/lib64/python2.7/site-packages/sage/modular/dirichlet.py", line 2137, in _module
        len(self.unit_gens()))
      File "sage/structure/factory.pyx", line 361, in sage.structure.factory.UniqueFactory.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/factory.c:1585)
        key, kwds = self.create_key_and_extra_args(*args, **kwds)
      File "sage/structure/factory.pyx", line 459, in sage.structure.factory.UniqueFactory.create_key_and_extra_args (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/factory.c:2722)
        return self.create_key(*args, **kwds), {}
      File "/usr/lib64/python2.7/site-packages/sage/modules/free_module.py", line 336, in create_key
        rank = int(sage.rings.integer.Integer(rank))
    RuntimeError: maximum recursion depth exceeded while calling a Python object
**********************************************************************
1 item had failures:
   2 of   6 in sage.modular.overconvergent.weightspace.AlgebraicWeight
    [108 tests, 2 failures, 0.32 s]
----------------------------------------------------------------------
sage -t --long /usr/lib64/python2.7/site-packages/sage/modular/overconvergent/weightspace.py  # 2 doctests failed
----------------------------------------------------------------------
```
There are two of those. There is always the possibility that I missed a patch in `python` or some other place that deals with this but I don't think so.



---

archive/issue_comments_201565.json:
```json
{
    "body": "**Changing branch** from \"[u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)\" to \"[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)\".",
    "created_at": "2016-06-21T20:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201565",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)" to "[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)".



---

archive/issue_events_142201.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-21T20:45:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142201"
}
```



---

archive/issue_events_142202.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-21T20:45:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142202"
}
```



---

archive/issue_comments_201566.json:
```json
{
    "body": "**Changing commit** from \"[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)\" to \"\".",
    "created_at": "2016-06-21T21:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201566",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)" to "".



---

archive/issue_comments_201567.json:
```json
{
    "body": "<a id='comment:55'></a>\nIndeed the two doctest failures",
    "created_at": "2016-06-21T21:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201567",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:55'></a>
Indeed the two doctest failures



---

archive/issue_comments_201568.json:
```json
{
    "body": "<a id='comment:56'></a>\nActually the main failure is in `sage/modular/dirichlet.py`, the other `sage/modular/overconvergent/weightspace.py` fails because it is calling dirichlet. So one only needs to fix dirichlet.py.",
    "created_at": "2016-06-26T21:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201568",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:56'></a>
Actually the main failure is in `sage/modular/dirichlet.py`, the other `sage/modular/overconvergent/weightspace.py` fails because it is calling dirichlet. So one only needs to fix dirichlet.py.



---

archive/issue_comments_201569.json:
```json
{
    "body": "**Commit:** [7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)",
    "created_at": "2016-06-30T03:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201569",
    "user": "https://github.com/saraedum"
}
```

**Commit:** [7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)



---

archive/issue_comments_201570.json:
```json
{
    "body": "<a id='comment:57'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c182f4070e35ae5d603f8c6d8c86c9d9885d7b98\">c182f40</a></td><td><code>Remove ClearCacheOnPickle meta class</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6\">e3a7eb4</a></td><td><code>Do not pickle cached methods</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1\">746dc53</a></td><td><code>fix grammar in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a6067a6261416c86bc3d77129ff3e7cf64a005b\">3a6067a</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4\">7ef7a41</a></td><td><code>Remove id check from cached method doctest</code></td></tr></table>\n",
    "created_at": "2016-06-30T03:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201570",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:57'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c182f4070e35ae5d603f8c6d8c86c9d9885d7b98">c182f40</a></td><td><code>Remove ClearCacheOnPickle meta class</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3a7eb4e7ec0852fb058e5455d270067846ea2b6">e3a7eb4</a></td><td><code>Do not pickle cached methods</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/746dc53e1d767870430a3770eef1159c6534b9b1">746dc53</a></td><td><code>fix grammar in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a6067a6261416c86bc3d77129ff3e7cf64a005b">3a6067a</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4">7ef7a41</a></td><td><code>Remove id check from cached method doctest</code></td></tr></table>




---

archive/issue_comments_201571.json:
```json
{
    "body": "**Changing branch** from \"[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)\" to \"[u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)\".",
    "created_at": "2016-06-30T03:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201571",
    "user": "https://github.com/saraedum"
}
```

**Changing branch** from "[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)" to "[u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)".



---

archive/issue_comments_201572.json:
```json
{
    "body": "**Changing commit** from \"[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)\" to \"[a152dc4a2d7f07841152421bde45c003b6d2b6f1](https://github.com/sagemath/sagetrac-mirror/commit/a152dc4a2d7f07841152421bde45c003b6d2b6f1)\".",
    "created_at": "2016-06-30T19:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201572",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7ef7a4120395d2645c4246bb23ffb9d3f7183dd4](https://github.com/sagemath/sagetrac-mirror/commit/7ef7a4120395d2645c4246bb23ffb9d3f7183dd4)" to "[a152dc4a2d7f07841152421bde45c003b6d2b6f1](https://github.com/sagemath/sagetrac-mirror/commit/a152dc4a2d7f07841152421bde45c003b6d2b6f1)".



---

archive/issue_comments_201573.json:
```json
{
    "body": "<a id='comment:58'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2da8dc1480aca626540459ec05381e8e96f7105\">d2da8dc</a></td><td><code>remove unused do_pickle field from CachedMethod</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c36386a8b215f00bced83d8bf80560d3349d0b1\">6c36386</a></td><td><code>Merge branch 'u/saraedum/ticket/15692' of git://trac.sagemath.org/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/125ec7f8bd21bbf289fc7b55669da83e86585d9d\">125ec7f</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aaebb0196d5630fc05943ee213c4a1dff10d6b22\">aaebb01</a></td><td><code>Merge branch 'develop' into t/15692/ticket/15692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a152dc4a2d7f07841152421bde45c003b6d2b6f1\">a152dc4</a></td><td><code>Pickle caches of dirichlet characters</code></td></tr></table>\n",
    "created_at": "2016-06-30T19:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2da8dc1480aca626540459ec05381e8e96f7105">d2da8dc</a></td><td><code>remove unused do_pickle field from CachedMethod</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c36386a8b215f00bced83d8bf80560d3349d0b1">6c36386</a></td><td><code>Merge branch 'u/saraedum/ticket/15692' of git://trac.sagemath.org/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/125ec7f8bd21bbf289fc7b55669da83e86585d9d">125ec7f</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/15692/ticket/15692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aaebb0196d5630fc05943ee213c4a1dff10d6b22">aaebb01</a></td><td><code>Merge branch 'develop' into t/15692/ticket/15692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a152dc4a2d7f07841152421bde45c003b6d2b6f1">a152dc4</a></td><td><code>Pickle caches of dirichlet characters</code></td></tr></table>




---

archive/issue_comments_201574.json:
```json
{
    "body": "<a id='comment:59'></a>\nThe `dirichlet.py` doctests pass now. Let's see what the patchbot thinks about  the rest.",
    "created_at": "2016-06-30T20:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201574",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:59'></a>
The `dirichlet.py` doctests pass now. Let's see what the patchbot thinks about  the rest.



---

archive/issue_events_142203.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-06-30T20:00:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142203"
}
```



---

archive/issue_comments_201575.json:
```json
{
    "body": "**Work_Issues:** pickle jar",
    "created_at": "2016-07-01T09:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201575",
    "user": "https://github.com/saraedum"
}
```

**Work_Issues:** pickle jar



---

archive/issue_events_142204.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-07-01T09:27:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142204"
}
```



---

archive/issue_events_142205.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-07-01T09:27:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142205"
}
```



---

archive/issue_comments_201576.json:
```json
{
    "body": "**Changing commit** from \"[a152dc4a2d7f07841152421bde45c003b6d2b6f1](https://github.com/sagemath/sagetrac-mirror/commit/a152dc4a2d7f07841152421bde45c003b6d2b6f1)\" to \"[141af2efcb44d8048fed779d2b719d20a243c31c](https://github.com/sagemath/sagetrac-mirror/commit/141af2efcb44d8048fed779d2b719d20a243c31c)\".",
    "created_at": "2016-07-07T01:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a152dc4a2d7f07841152421bde45c003b6d2b6f1](https://github.com/sagemath/sagetrac-mirror/commit/a152dc4a2d7f07841152421bde45c003b6d2b6f1)" to "[141af2efcb44d8048fed779d2b719d20a243c31c](https://github.com/sagemath/sagetrac-mirror/commit/141af2efcb44d8048fed779d2b719d20a243c31c)".



---

archive/issue_comments_201577.json:
```json
{
    "body": "<a id='comment:61'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/141af2efcb44d8048fed779d2b719d20a243c31c\">141af2e</a></td><td><code>Unpickle legacy dirichlet characters</code></td></tr></table>\n",
    "created_at": "2016-07-07T01:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:61'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/141af2efcb44d8048fed779d2b719d20a243c31c">141af2e</a></td><td><code>Unpickle legacy dirichlet characters</code></td></tr></table>




---

archive/issue_comments_201578.json:
```json
{
    "body": "**Changing work_issues** from \"pickle jar\" to \"\".",
    "created_at": "2016-07-07T01:27:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201578",
    "user": "https://github.com/saraedum"
}
```

**Changing work_issues** from "pickle jar" to "".



---

archive/issue_events_142206.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-07-07T01:27:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142206"
}
```



---

archive/issue_events_142207.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-07-07T01:27:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142207"
}
```



---

archive/issue_comments_201579.json:
```json
{
    "body": "<a id='comment:63'></a>\nLooks like your last commit needs a tiny little bit more work\n\n```\nsage -t --long src/sage/modular/dirichlet.py\n**********************************************************************\nFile \"src/sage/modular/dirichlet.py\", line 1760, in sage.modular.dirichlet.DirichletCharacter.__setstate__\nFailed example:\n    loads(dumps(e)) == e\nExpected nothing\nGot:\n    True\n```\nFrom the bot.",
    "created_at": "2016-07-07T21:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201579",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:63'></a>
Looks like your last commit needs a tiny little bit more work

```
sage -t --long src/sage/modular/dirichlet.py
**********************************************************************
File "src/sage/modular/dirichlet.py", line 1760, in sage.modular.dirichlet.DirichletCharacter.__setstate__
Failed example:
    loads(dumps(e)) == e
Expected nothing
Got:
    True
```
From the bot.



---

archive/issue_events_142208.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-07-07T21:47:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142208"
}
```



---

archive/issue_events_142209.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-07-07T21:47:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142209"
}
```



---

archive/issue_comments_201580.json:
```json
{
    "body": "**Changing commit** from \"[141af2efcb44d8048fed779d2b719d20a243c31c](https://github.com/sagemath/sagetrac-mirror/commit/141af2efcb44d8048fed779d2b719d20a243c31c)\" to \"[a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)\".",
    "created_at": "2016-07-08T04:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[141af2efcb44d8048fed779d2b719d20a243c31c](https://github.com/sagemath/sagetrac-mirror/commit/141af2efcb44d8048fed779d2b719d20a243c31c)" to "[a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)".



---

archive/issue_comments_201581.json:
```json
{
    "body": "<a id='comment:64'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215\">a18cbf5</a></td><td><code>Fixed doctest for element of DirichletGroup</code></td></tr></table>\n",
    "created_at": "2016-07-08T04:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201581",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:64'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215">a18cbf5</a></td><td><code>Fixed doctest for element of DirichletGroup</code></td></tr></table>




---

archive/issue_comments_201582.json:
```json
{
    "body": "<a id='comment:65'></a>\nSorry, that was dumb. I hope it's better now :)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215\">a18cbf5</a></td><td><code>Fixed doctest for element of DirichletGroup</code></td></tr></table>\n",
    "created_at": "2016-07-08T04:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201582",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:65'></a>
Sorry, that was dumb. I hope it's better now :)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215">a18cbf5</a></td><td><code>Fixed doctest for element of DirichletGroup</code></td></tr></table>




---

archive/issue_events_142210.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-07-08T04:54:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142210"
}
```



---

archive/issue_events_142211.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2016-07-08T04:54:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142211"
}
```



---

archive/issue_comments_201583.json:
```json
{
    "body": "<a id='comment:67'></a>\nBot happy, I am putting this back to positive.",
    "created_at": "2016-07-09T05:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201583",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:67'></a>
Bot happy, I am putting this back to positive.



---

archive/issue_events_142212.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-07-09T05:16:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142212"
}
```



---

archive/issue_events_142213.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-07-09T05:16:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142213"
}
```



---

archive/issue_comments_201584.json:
```json
{
    "body": "**Changing branch** from \"[u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)\" to \"[a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)\".",
    "created_at": "2016-07-09T16:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201584",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/saraedum/ticket/15692](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/ticket/15692)" to "[a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)".



---

archive/issue_events_142214.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-09T16:29:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142214"
}
```



---

archive/issue_events_142215.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-09T16:29:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15692#event-142215"
}
```



---

archive/issue_comments_201585.json:
```json
{
    "body": "**Changing commit** from \"[a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)\" to \"\".",
    "created_at": "2016-08-16T11:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201585",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[a18cbf54adcc6684fdd9206fa837fe07a2942215](https://github.com/sagemath/sagetrac-mirror/commit/a18cbf54adcc6684fdd9206fa837fe07a2942215)" to "".



---

archive/issue_comments_201586.json:
```json
{
    "body": "**Changing author** from \"Julian Rueth\" to \"Julian R\u00fcth\".",
    "created_at": "2016-08-16T11:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15692#issuecomment-201586",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Julian Rueth" to "Julian RÃ¼th".
