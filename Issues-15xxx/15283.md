# Issue 15283: Rowmotion and Panyushev orbits: iterators for orbits and better doc

archive/issues_015046.json:
```json
{
    "assignees": [],
    "body": "This patch adds documentation to some rowmotion-related methods in `sage/categories/posets.py` and `sage/categories/finite_posets.py` and introduces new methods which return iterators over single rowmotion / Panyushev complementation / toggle orbits instead of computing *all* orbits at once and returning them as lists. This allows experimenting with big posets (at least if one can find a way to more or less randomly sample order ideals or antichains).\n\nApply:\n* [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)\n\n\nCC:  @jessicapalencia @sagetrac-sage-combinat @tscrim @anneschilling\n\nKeywords: **posets, rowmotion, sage-combinat, panyushev, order-ideals**\n\nReviewer: **Nathann Cohen**\n\nAuthor: **Darij Grinberg**\n\nMerged: **sage-5.13.beta2**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15283_\n\n",
    "closed_at": "2013-10-31T19:17:56Z",
    "created_at": "2013-10-16T05:35:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/c%3A%20categories"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Rowmotion and Panyushev orbits: iterators for orbits and better doc",
    "type": "issue",
    "updated_at": "2013-10-31T19:17:56Z",
    "url": "https://github.com/sagemath/sage/issues/15283",
    "user": "https://github.com/darijgr"
}
```
This patch adds documentation to some rowmotion-related methods in `sage/categories/posets.py` and `sage/categories/finite_posets.py` and introduces new methods which return iterators over single rowmotion / Panyushev complementation / toggle orbits instead of computing *all* orbits at once and returning them as lists. This allows experimenting with big posets (at least if one can find a way to more or less randomly sample order ideals or antichains).

Apply:
* [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)


CC:  @jessicapalencia @sagetrac-sage-combinat @tscrim @anneschilling

Keywords: **posets, rowmotion, sage-combinat, panyushev, order-ideals**

Reviewer: **Nathann Cohen**

Author: **Darij Grinberg**

Merged: **sage-5.13.beta2**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/15283_





---

archive/issue_events_215275.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-16T05:35:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215275"
}
```



---

archive/issue_events_215276.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-16T05:35:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215276"
}
```



---

archive/issue_events_215277.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-16T05:35:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215277"
}
```



---

archive/issue_events_215278.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-16T05:35:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215278"
}
```



---

archive/issue_events_215279.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-16T05:35:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20categories",
    "label_color": "0000ff",
    "label_name": "c: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215279"
}
```



---

archive/issue_events_215280.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-16T05:38:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215280"
}
```



---

archive/issue_comments_188695.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHelloooooooooooooooooooooo !!\n\nI read this patch and even though I am not from the field I feel that it could get in. I  only have some small remarks to make :\n\n* Could the Poset class need a `.is_antichain(vertices=[...])` method to check if this set of vertices induces an antichain ? You have a `.is_chain()` method, but it does not take any argument.\n* <code>\\`\\`panyushev_complement\\`\\`</code> should be <code>:meth:\\`panyushev_complement\\`</code>\n* isn't \"generated by the antichain `antichain`, represented by its generating antichain\" slightly redundant ? `:-P`\n* With my first reading, I understood ``toggling_orbit_iter`` would take a set and a list of points, and return the toggle of the set with the first point, then this new set toggled with the second point, then this new set with the third point, ... I does not make much sense it is true, especially with ``stop=True``, but if you think somebody from the field could make the same mistake perhaps it could be made clearer `:-)`\n\nNathann",
    "created_at": "2013-10-21T13:02:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188695",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:2" align="right">comment:2</div>

Helloooooooooooooooooooooo !!

I read this patch and even though I am not from the field I feel that it could get in. I  only have some small remarks to make :

* Could the Poset class need a `.is_antichain(vertices=[...])` method to check if this set of vertices induces an antichain ? You have a `.is_chain()` method, but it does not take any argument.
* <code>\`\`panyushev_complement\`\`</code> should be <code>:meth:\`panyushev_complement\`</code>
* isn't "generated by the antichain `antichain`, represented by its generating antichain" slightly redundant ? `:-P`
* With my first reading, I understood ``toggling_orbit_iter`` would take a set and a list of points, and return the toggle of the set with the first point, then this new set toggled with the second point, then this new set with the third point, ... I does not make much sense it is true, especially with ``stop=True``, but if you think somebody from the field could make the same mistake perhaps it could be made clearer `:-)`

Nathann



---

archive/issue_events_215281.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-21T13:02:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215281"
}
```



---

archive/issue_events_215282.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-21T13:02:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215282"
}
```



---

archive/issue_comments_188696.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHi Nathannnnn and thanks for the comments!\n\nReplying to [@nathanncohen](#comment:2):\n> * Could the Poset class need a `.is_antichain(vertices=[...])` method to check if this set of vertices induces an antichain ? You have a `.is_chain()` method, but it does not take any argument.\n\nProbably, but I am not sure about adding such methods. `.is_chain` would have to then be given two meanings, which people might not be happy about.\n\n> * <code>\\`\\`panyushev_complement\\`\\`</code> should be <code>:meth:\\`panyushev_complement\\`</code>\n\nDone.\n\n> * isn't \"generated by the antichain `antichain`, represented by its generating antichain\" slightly redundant ? `:-P`\n\nI think I've improved this sentence now.\n\n> * With my first reading, I understood ``toggling_orbit_iter`` would take a set and a list of points, and return the toggle of the set with the first point, then this new set toggled with the second point, then this new set with the third point, ... I does not make much sense it is true, especially with ``stop=True``, but if you think somebody from the field could make the same mistake perhaps it could be made clearer `:-)`\n\nGood point -- added a warning!\n\nSince I forgot to qnew, I've made the changes in my old patch rather than adding a new patch. I hope this is fine, and I'll just update the old patch and upload the new changes as a txt file.",
    "created_at": "2013-10-21T16:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188696",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:3" align="right">comment:3</div>

Hi Nathannnnn and thanks for the comments!

Replying to [@nathanncohen](#comment:2):
> * Could the Poset class need a `.is_antichain(vertices=[...])` method to check if this set of vertices induces an antichain ? You have a `.is_chain()` method, but it does not take any argument.

Probably, but I am not sure about adding such methods. `.is_chain` would have to then be given two meanings, which people might not be happy about.

> * <code>\`\`panyushev_complement\`\`</code> should be <code>:meth:\`panyushev_complement\`</code>

Done.

> * isn't "generated by the antichain `antichain`, represented by its generating antichain" slightly redundant ? `:-P`

I think I've improved this sentence now.

> * With my first reading, I understood ``toggling_orbit_iter`` would take a set and a list of points, and return the toggle of the set with the first point, then this new set toggled with the second point, then this new set with the third point, ... I does not make much sense it is true, especially with ``stop=True``, but if you think somebody from the field could make the same mistake perhaps it could be made clearer `:-)`

Good point -- added a warning!

Since I forgot to qnew, I've made the changes in my old patch rather than adding a new patch. I hope this is fine, and I'll just update the old patch and upload the new changes as a txt file.



---

archive/issue_comments_188697.json:
```json
{
    "body": "Attachment: **[trac_15283-rowmotion-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)**\n\nrevised version",
    "created_at": "2013-10-21T16:10:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188697",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_15283-rowmotion-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)**

revised version



---

archive/issue_comments_188698.json:
```json
{
    "body": "differences to the old file. don't apply, just read",
    "created_at": "2013-10-21T16:11:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188698",
    "user": "https://github.com/darijgr"
}
```

differences to the old file. don't apply, just read



---

archive/issue_events_215283.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-21T16:13:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215283"
}
```



---

archive/issue_events_215284.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-21T16:13:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215284"
}
```



---

archive/issue_comments_188699.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAttachment: **[newdiff.txt](https://github.com/sagemath/sage/files/ticket15283/newdiff.txt)**",
    "created_at": "2013-10-21T16:13:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188699",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:4" align="right">comment:4</div>

Attachment: **[newdiff.txt](https://github.com/sagemath/sage/files/ticket15283/newdiff.txt)**



---

archive/issue_comments_188700.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYoooooooooo !\n\n> Probably, but I am not sure about adding such methods. `.is_chain` would have to then be given two meanings, which people might not be happy about.\n\nWell, the meaning of `is_chain` stays the same when used without argument, and a feature is added. Better than creating a `is_chain_subset` method to do the very same, and if people often check whether a set is a chain or an antichain, it can be useful.\n\n> Since I forgot to qnew, I've made the changes in my old patch rather than adding a new patch. I hope this is fine, and I'll just update the old patch and upload the new changes as a txt file.\n\nNo prob ! Good to go `;-)`\n\nNathann",
    "created_at": "2013-10-21T16:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188700",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:5" align="right">comment:5</div>

Yoooooooooo !

> Probably, but I am not sure about adding such methods. `.is_chain` would have to then be given two meanings, which people might not be happy about.

Well, the meaning of `is_chain` stays the same when used without argument, and a feature is added. Better than creating a `is_chain_subset` method to do the very same, and if people often check whether a set is a chain or an antichain, it can be useful.

> Since I forgot to qnew, I've made the changes in my old patch rather than adding a new patch. I hope this is fine, and I'll just update the old patch and upload the new changes as a txt file.

No prob ! Good to go `;-)`

Nathann



---

archive/issue_events_215285.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-21T16:49:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215285"
}
```



---

archive/issue_events_215286.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-21T16:49:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215286"
}
```



---

archive/issue_comments_188701.json:
```json
{
    "body": "Reviewer: **Nathann Cohen**",
    "created_at": "2013-10-21T16:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188701",
    "user": "https://github.com/nathanncohen"
}
```

Reviewer: **Nathann Cohen**



---

archive/issue_comments_188702.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe other problem is that it's not clear whether `[6, 3]` should be a chain of the poset `divisors(6)` with divisibility order. Sometimes chains defined as comparable subsets (hence yes), sometimes as actual ordered lists (then no). I fear this method will be harder to use than to rewrite for most users...",
    "created_at": "2013-10-21T16:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188702",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:6" align="right">comment:6</div>

The other problem is that it's not clear whether `[6, 3]` should be a chain of the poset `divisors(6)` with divisibility order. Sometimes chains defined as comparable subsets (hence yes), sometimes as actual ordered lists (then no). I fear this method will be harder to use than to rewrite for most users...



---

archive/issue_comments_188703.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nRight. Now that I think of it, though, it can be implemented better :\n* Check that an ordered list is indeed a chain : only `n-1` comparisons\n* Check that a set is indeed a chain : quicksort using `n log(n)` comparisons, then check if the (ordered) result makes sense with `n-1` comparisons.\n\nAnyway, if this function is useful at some point it can still be implemented in a `.is_chain` method with a `vertices=[...]` argument (possibly equal to `None` to mean \"self\") and a `ordered=True` parameter for this second problem `:-D`\n\nNathann",
    "created_at": "2013-10-22T08:21:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188703",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:7" align="right">comment:7</div>

Right. Now that I think of it, though, it can be implemented better :
* Check that an ordered list is indeed a chain : only `n-1` comparisons
* Check that a set is indeed a chain : quicksort using `n log(n)` comparisons, then check if the (ordered) result makes sense with `n-1` comparisons.

Anyway, if this function is useful at some point it can still be implemented in a `.is_chain` method with a `vertices=[...]` argument (possibly equal to `None` to mean "self") and a `ordered=True` parameter for this second problem `:-D`

Nathann



---

archive/issue_comments_188704.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[trac_15283-additions-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15283/trac_15283-additions-dg.patch.gz)**\n\nHi Nathann,\n\nI've uploaded an additional patch for this. It disappointingly required some `__cmp__` hackery, so please check it and tell me if that could have been done in a nicer way.\n\nBest regards,\\\\\nDarij",
    "created_at": "2013-10-23T14:17:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188704",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[trac_15283-additions-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15283/trac_15283-additions-dg.patch.gz)**

Hi Nathann,

I've uploaded an additional patch for this. It disappointingly required some `__cmp__` hackery, so please check it and tell me if that could have been done in a nicer way.

Best regards,\\
Darij



---

archive/issue_comments_188705.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHellooooo again !\n\nHmmmm... I don't get why you needed this hack, actually. What's wrong with the following ?\n\n`sorted_o = sorted(o, cmp=self.lt)`\n\nIf the set is a chain then it behaves exactly as a quicksort, and otherwise `.lt` will answer \"no\" from time to time -- but who cares, you will find this out in the terminal check :\n\n`all(self.lt(x[i],x[i+1]) for i in range(len(o))-1)`\n\nAnd I still believe that this would be better in side of `Poset.is_chain()` `:-P`\n\nAaaaaaand Nicolas did not think that it would be a problem but well... That's up to you `:-P`\n\nHave fuuuuuuuuuuuuuuuuuuuuuun !\n\nNathann",
    "created_at": "2013-10-23T14:34:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188705",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:9" align="right">comment:9</div>

Hellooooo again !

Hmmmm... I don't get why you needed this hack, actually. What's wrong with the following ?

`sorted_o = sorted(o, cmp=self.lt)`

If the set is a chain then it behaves exactly as a quicksort, and otherwise `.lt` will answer "no" from time to time -- but who cares, you will find this out in the terminal check :

`all(self.lt(x[i],x[i+1]) for i in range(len(o))-1)`

And I still believe that this would be better in side of `Poset.is_chain()` `:-P`

Aaaaaaand Nicolas did not think that it would be a problem but well... That's up to you `:-P`

Have fuuuuuuuuuuuuuuuuuuuuuun !

Nathann



---

archive/issue_comments_188706.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI don't think `self.lt` returns the right format for `sorted`. It seems that the `cmp` keyword of `sorted` wants a total -1,0,1-valued function, not a boolean one. See how this prints the same list twice:\n\n```\nP = Poset({i: divisors(i) for i in divisors(24)})\nprint sorted(list(P), cmp=P.lt)\nprint sorted(list(P), cmp=P.gt)\n```\n\nAnd either way, I don't know how `sorted` would react if `cmp` fails to be antisymmetric, i. e., if there are two distinct elements which compare as equal or each smaller than the other. I'd hope the result would still be sorted, but who knows? Why is there no good doc for `sorted`??\n\nI originally wanted to implement these functions as semantics for `is_chain` and `is_antichain`, but found that this would make the docstring rather confusing.",
    "created_at": "2013-10-23T14:49:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188706",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:10" align="right">comment:10</div>

I don't think `self.lt` returns the right format for `sorted`. It seems that the `cmp` keyword of `sorted` wants a total -1,0,1-valued function, not a boolean one. See how this prints the same list twice:

```
P = Poset({i: divisors(i) for i in divisors(24)})
print sorted(list(P), cmp=P.lt)
print sorted(list(P), cmp=P.gt)
```

And either way, I don't know how `sorted` would react if `cmp` fails to be antisymmetric, i. e., if there are two distinct elements which compare as equal or each smaller than the other. I'd hope the result would still be sorted, but who knows? Why is there no good doc for `sorted`??

I originally wanted to implement these functions as semantics for `is_chain` and `is_antichain`, but found that this would make the docstring rather confusing.



---

archive/issue_comments_188707.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nWhich patch(es) should be applied? Please check that the patches apply to sage-5.13.beta1.",
    "created_at": "2013-10-23T16:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188707",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Which patch(es) should be applied? Please check that the patches apply to sage-5.13.beta1.



---

archive/issue_events_215287.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-23T16:03:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215287"
}
```



---

archive/issue_events_215288.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-23T16:03:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215288"
}
```



---

archive/issue_comments_188708.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n> I don't think `self.lt` returns the right format for `sorted`. It seems that the `cmp` keyword of `sorted` wants a total -1,0,1-valued function, not a boolean one. \n\nWell. If you insist on that, I can make it `lambda x,y :  2*self.lt(x,y)-1` `:-P`\n\n> I originally wanted to implement these functions as semantics for `is_chain` and `is_antichain`, but found that this would make the docstring rather confusing.\n\nReally ? What do you think of this ?\n\n```\ndef is_chain(verts=None):\n    Checks whether the Poset (or a specific subset of it) is a chain\n\n    INPUT:\n\n    - ``verts`` (list of vertices) -- If ``verts`` is ``None`` (default),\n      the function returns ``True`` if and only if the poset is a chain.\n      If ``verts`` is a list of points, the function returns ``True`` if \n      and only if ``verts`` is a chain of the poset.\n\n    - ``ordered`` (boolean) -- Whether to consider ``verts`` as a list, \n      or as a set. If ``ordered`` is set to ``True`` (default), only \n      checks whether the vertices of ``verts`` are totally ordered in \n      the poset. If ``ordered`` is set to ``False`` (default), checks \n      whether these vertices are totally ordered with the ordering \n      given by the list ``verts``\n```\n\nNathann",
    "created_at": "2013-10-23T16:16:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188708",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:12" align="right">comment:12</div>

> I don't think `self.lt` returns the right format for `sorted`. It seems that the `cmp` keyword of `sorted` wants a total -1,0,1-valued function, not a boolean one. 

Well. If you insist on that, I can make it `lambda x,y :  2*self.lt(x,y)-1` `:-P`

> I originally wanted to implement these functions as semantics for `is_chain` and `is_antichain`, but found that this would make the docstring rather confusing.

Really ? What do you think of this ?

```
def is_chain(verts=None):
    Checks whether the Poset (or a specific subset of it) is a chain

    INPUT:

    - ``verts`` (list of vertices) -- If ``verts`` is ``None`` (default),
      the function returns ``True`` if and only if the poset is a chain.
      If ``verts`` is a list of points, the function returns ``True`` if 
      and only if ``verts`` is a chain of the poset.

    - ``ordered`` (boolean) -- Whether to consider ``verts`` as a list, 
      or as a set. If ``ordered`` is set to ``True`` (default), only 
      checks whether the vertices of ``verts`` are totally ordered in 
      the poset. If ``ordered`` is set to ``False`` (default), checks 
      whether these vertices are totally ordered with the ordering 
      given by the list ``verts``
```

Nathann



---

archive/issue_comments_188709.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nJeroen : the only patch that should be applied is [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz). The other one is about additional modifications that could be made on another ticket.\n\nNathann",
    "created_at": "2013-10-23T16:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188709",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:13" align="right">comment:13</div>

Jeroen : the only patch that should be applied is [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz). The other one is about additional modifications that could be made on another ticket.

Nathann



---

archive/issue_comments_188710.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n This patch adds documentation to some rowmotion-related methods in `sage/categories/posets.py` and `sage/categories/finite_posets.py` and introduces new methods which return iterators over single rowmotion / Panyushev complementation / toggle orbits instead of computing *all* orbits at once and returning them as lists. This allows experimenting with big posets (at least if one can find a way to more or less randomly sample order ideals or antichains).\n+\n+Apply:\n+* [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)\n+* [attachment: trac_15283-additions-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15283/abd910caa6edc0eb8af78ca9b847e30d.gz)\n``````\n",
    "created_at": "2013-10-23T16:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188710",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 This patch adds documentation to some rowmotion-related methods in `sage/categories/posets.py` and `sage/categories/finite_posets.py` and introduces new methods which return iterators over single rowmotion / Panyushev complementation / toggle orbits instead of computing *all* orbits at once and returning them as lists. This allows experimenting with big posets (at least if one can find a way to more or less randomly sample order ideals or antichains).
+
+Apply:
+* [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)
+* [attachment: trac_15283-additions-dg.patch​](https://github.com/sagemath/sage/files/ticket15283/abd910caa6edc0eb8af78ca9b847e30d.gz)
``````




---

archive/issue_events_215289.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-23T16:17:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215289"
}
```



---

archive/issue_events_215290.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-23T16:17:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215290"
}
```



---

archive/issue_comments_188711.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOops, I didn't notice that this was positive_review. Thanks, Nathann!\nIn view of the changes, needs_review is probably more appropriate now.\n\n@jdemeyer: sorry, I can't tell about beta1, but they do apply on 5.13beta0.\n\nfor the **patchbots**:\n\napply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch\u200b\n\nfor the **patchbot**:\n\napply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch\u200b\n\nfor the **patchbots**\n\napply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch\u200b\n\nfor the **patchbot**\n\napply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch\u200b\n\n(because I can't remember which syntax is correct).",
    "created_at": "2013-10-23T16:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188711",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:14" align="right">comment:14</div>

Oops, I didn't notice that this was positive_review. Thanks, Nathann!
In view of the changes, needs_review is probably more appropriate now.

@jdemeyer: sorry, I can't tell about beta1, but they do apply on 5.13beta0.

for the **patchbots**:

apply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch​

for the **patchbot**:

apply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch​

for the **patchbots**

apply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch​

for the **patchbot**

apply trac_15283-rowmotion-dg.patch trac_15283-additions-dg.patch​

(because I can't remember which syntax is correct).



---

archive/issue_comments_188712.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Apply:\n * [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)\n-* [attachment: trac_15283-additions-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15283/abd910caa6edc0eb8af78ca9b847e30d.gz)\n+\n``````\n",
    "created_at": "2013-10-23T16:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188712",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Apply:
 * [attachment: trac_15283-rowmotion-dg.patch](https://github.com/sagemath/sage/files/ticket15283/trac_15283-rowmotion-dg.patch.gz)
-* [attachment: trac_15283-additions-dg.patch​](https://github.com/sagemath/sage/files/ticket15283/abd910caa6edc0eb8af78ca9b847e30d.gz)
+
``````




---

archive/issue_comments_188713.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOK, Nathann is right, this ticket should be split:\n\nfor the **patchbots**:\n\napply trac_15283-rowmotion-dg.patch\n\nfor the **patchbot**:\n\napply trac_15283-rowmotion-dg.patch\n\nfor the **patchbots**\n\napply trac_15283-rowmotion-dg.patch\n\nfor the **patchbot**\n\napply trac_15283-rowmotion-dg.patch\n\nThis can then be set to positive_review since Nathann did review the rowmotion patch.",
    "created_at": "2013-10-23T16:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188713",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:15" align="right">comment:15</div>

OK, Nathann is right, this ticket should be split:

for the **patchbots**:

apply trac_15283-rowmotion-dg.patch

for the **patchbot**:

apply trac_15283-rowmotion-dg.patch

for the **patchbots**

apply trac_15283-rowmotion-dg.patch

for the **patchbot**

apply trac_15283-rowmotion-dg.patch

This can then be set to positive_review since Nathann did review the rowmotion patch.



---

archive/issue_events_215291.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-23T16:20:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215291"
}
```



---

archive/issue_events_215292.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-23T16:20:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215292"
}
```



---

archive/issue_comments_188714.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@darijgr](#comment:10):\n> I don't think `self.lt` returns the right format for `sorted`. It seems that the `cmp` keyword of `sorted` wants a total -1,0,1-valued function, not a boolean one. See how this prints the same list twice:\n> \n> ```\n> P = Poset({i: divisors(i) for i in divisors(24)})\n> print sorted(list(P), cmp=P.lt)\n> print sorted(list(P), cmp=P.gt)\n> ```\n\nThe recommended way is to use `sorted(...,key=...)` where `key` should map the sequence elements into a totally ordered set (for instance, the integers). This provides a concise way of the decorate-sort-undecorate pattern, or *Schwartzian transform*, which is generally more efficient than sorting with a likely expensive custom sort function.\n\nThe `cmp` keyword is actually removed in Python 3. See `functools.cmp_to_key` to convert a legitimate `cmp` function into a value suitable for `key`.",
    "created_at": "2013-10-25T00:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188714",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@darijgr](#comment:10):
> I don't think `self.lt` returns the right format for `sorted`. It seems that the `cmp` keyword of `sorted` wants a total -1,0,1-valued function, not a boolean one. See how this prints the same list twice:
> 
> ```
> P = Poset({i: divisors(i) for i in divisors(24)})
> print sorted(list(P), cmp=P.lt)
> print sorted(list(P), cmp=P.gt)
> ```

The recommended way is to use `sorted(...,key=...)` where `key` should map the sequence elements into a totally ordered set (for instance, the integers). This provides a concise way of the decorate-sort-undecorate pattern, or *Schwartzian transform*, which is generally more efficient than sorting with a likely expensive custom sort function.

The `cmp` keyword is actually removed in Python 3. See `functools.cmp_to_key` to convert a legitimate `cmp` function into a value suitable for `key`.



---

archive/issue_comments_188715.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThanks, Nathann and Nils, for your comments. I've decided to provide two implementations for `is_chain`, one using sorting when the poset is finite (in which case, as Nils suggests, I'll use a `key` attribute), one by checking all pairs of possible relations when the poset is not assumed finite.\n\nI'm still reluctant to make this part of the existing `is_chain` method. One reason is that the existing `is_chain` exists only for finite posets, so I'd have to move it from `sage/combinat/posets.py` to `sage/categories/posets.py` and give it some stupid error behavior when the poset is not finite.\n\nI'm carrying this over into a new ticket: #15322. Please disregard the additions-dg.patch I posted here, as it is buggy.",
    "created_at": "2013-10-25T01:31:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188715",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:17" align="right">comment:17</div>

Thanks, Nathann and Nils, for your comments. I've decided to provide two implementations for `is_chain`, one using sorting when the poset is finite (in which case, as Nils suggests, I'll use a `key` attribute), one by checking all pairs of possible relations when the poset is not assumed finite.

I'm still reluctant to make this part of the existing `is_chain` method. One reason is that the existing `is_chain` exists only for finite posets, so I'd have to move it from `sage/combinat/posets.py` to `sage/categories/posets.py` and give it some stupid error behavior when the poset is not finite.

I'm carrying this over into a new ticket: #15322. Please disregard the additions-dg.patch I posted here, as it is buggy.



---

archive/issue_comments_188716.json:
```json
{
    "body": "Merged: **sage-5.13.beta2**",
    "created_at": "2013-10-31T19:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15283#issuecomment-188716",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta2**



---

archive/issue_events_215293.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:17:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215293"
}
```



---

archive/issue_events_215294.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:17:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15283",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15283#event-215294"
}
```
