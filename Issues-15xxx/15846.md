# Issue 15846: Incorrect series expansion of zeta(s) at 1

archive/issues_015609.json:
```json
{
    "body": "The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within Sage, we have\n\n```\nsage: zeta(x).series(x==1,2)\n(Infinity) + (zetaderiv(1, 1))*(x - 1) + Order((x - 1)^2)\n```\n\nwhen in fact, we should have\n\n```\nsage: zeta(x).series(x==1, 1)\n1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + Order(x - 1)\n```\n\n(see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)\n\nCC:  @behackl\n\nBranch/Commit: eccce0202c0a7773f5238af3e5b23f7706e6ff21\n\nUpstream: Completely fixed; Fix reported upstream\n\nReviewer: Ralf Stephan\n\nAuthor: Benjamin Hackl\n\nDependencies: #18237\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15846\n\n",
    "closed_at": "2015-04-19T01:51:59Z",
    "created_at": "2014-02-22T17:48:59Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Incorrect series expansion of zeta(s) at 1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15846",
    "user": "https://github.com/mezzarobba"
}
```
The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within Sage, we have

```
sage: zeta(x).series(x==1,2)
(Infinity) + (zetaderiv(1, 1))*(x - 1) + Order((x - 1)^2)
```

when in fact, we should have

```
sage: zeta(x).series(x==1, 1)
1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + Order(x - 1)
```

(see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)

CC:  @behackl

Branch/Commit: eccce0202c0a7773f5238af3e5b23f7706e6ff21

Upstream: Completely fixed; Fix reported upstream

Reviewer: Ralf Stephan

Author: Benjamin Hackl

Dependencies: #18237

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15846





---

archive/issue_events_053165.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15846#event-53165"
}
```



---

archive/issue_events_053166.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15846#event-53166"
}
```



---

archive/issue_events_053167.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15846#event-53167"
}
```



---

archive/issue_comments_260854.json:
```json
{
    "body": "<a id='comment:3'></a>\nI *think* I may have tracked down the reason for this back to SymPy. There, we have\n\n```\n>>> from sympy import zeta, gamma\n>>> from sympy.abc import x\n>>> gamma(x).series(x, x0=0, n=1)\n1/x - EulerGamma + O(x)\n```\n\nthat is, expanding the gamma function at a pole works. However, for the zeta function:\n\n```\n>>> zeta(x).series(x, x0=1, n=1)\nTraceback (most recent call last):\n...\nsympy.core.function.PoleError: Cannot expand zeta(_x + 1) around 0\n```\n\nThis could be fixed by implementing `_eval_nseries` directly for `zeta` (which can be found at `local/lib/python/site-packages/sympy/functions/sepecial/zeta_functions.py`) intelligently enough such that the pole at s=1 is handled. Unfortunately, I think there has to be a discussion first how to handle the coefficients in this expansion (cf. http://dlmf.nist.gov/25.2#E4). (AFAIK, the generalized Euler-Mascheroni constants are currently **not** implemented symbolically...)",
    "created_at": "2015-04-07T15:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260854",
    "user": "https://github.com/behackl"
}
```

<a id='comment:3'></a>
I *think* I may have tracked down the reason for this back to SymPy. There, we have

```
>>> from sympy import zeta, gamma
>>> from sympy.abc import x
>>> gamma(x).series(x, x0=0, n=1)
1/x - EulerGamma + O(x)
```

that is, expanding the gamma function at a pole works. However, for the zeta function:

```
>>> zeta(x).series(x, x0=1, n=1)
Traceback (most recent call last):
...
sympy.core.function.PoleError: Cannot expand zeta(_x + 1) around 0
```

This could be fixed by implementing `_eval_nseries` directly for `zeta` (which can be found at `local/lib/python/site-packages/sympy/functions/sepecial/zeta_functions.py`) intelligently enough such that the pole at s=1 is handled. Unfortunately, I think there has to be a discussion first how to handle the coefficients in this expansion (cf. http://dlmf.nist.gov/25.2#E4). (AFAIK, the generalized Euler-Mascheroni constants are currently **not** implemented symbolically...)



---

archive/issue_comments_260855.json:
```json
{
    "body": "<a id='comment:4'></a>\nWell, although there definitely is that problem in SymPy, the erronous expansion in sage seems to originate from Ginac:\n\n```\nbehackl@Jethro ~ $ ginsh\nginsh - GiNaC Interactive Shell (GiNaC V1.6.3)\n  __,  _______  Copyright (C) 1999-2014 Johannes Gutenberg University Mainz,\n (__) *       | Germany.  This is free software with ABSOLUTELY NO WARRANTY.\n  ._) i N a C | You are welcome to redistribute it under certain conditions.\n<-------------' For details type `warranty;'.\n\nType ?? for a list of help topics.\n> series(zeta(x+1), x, 2);\n(zeta(1))+(zetaderiv(1,1))*x+Order(x^2)\n```\n\nThis is exactly the output as in sage itself.\n\nThe zeta function does not seem to be very popular in that matter. ;-)",
    "created_at": "2015-04-07T17:49:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260855",
    "user": "https://github.com/behackl"
}
```

<a id='comment:4'></a>
Well, although there definitely is that problem in SymPy, the erronous expansion in sage seems to originate from Ginac:

```
behackl@Jethro ~ $ ginsh
ginsh - GiNaC Interactive Shell (GiNaC V1.6.3)
  __,  _______  Copyright (C) 1999-2014 Johannes Gutenberg University Mainz,
 (__) *       | Germany.  This is free software with ABSOLUTELY NO WARRANTY.
  ._) i N a C | You are welcome to redistribute it under certain conditions.
<-------------' For details type `warranty;'.

Type ?? for a list of help topics.
> series(zeta(x+1), x, 2);
(zeta(1))+(zetaderiv(1,1))*x+Order(x^2)
```

This is exactly the output as in sage itself.

The zeta function does not seem to be very popular in that matter. ;-)



---

archive/issue_comments_260856.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [behackl](#comment%3A4):\n> The zeta function does not seem to be very popular in that matter. ;-)\n\nNeither with Maxima, which is invoked via `taylor`:\n\n```\nsage: taylor(zeta(x),x,1,1)\n...\nTypeError: ECL says: Error executing code in Maxima: taylor: encountered an unfamiliar singularity in:\n```\nCould you please add the exact output you expect from `series` to the ticket description?",
    "created_at": "2015-04-08T06:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260856",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>
Replying to [behackl](#comment%3A4):
> The zeta function does not seem to be very popular in that matter. ;-)

Neither with Maxima, which is invoked via `taylor`:

```
sage: taylor(zeta(x),x,1,1)
...
TypeError: ECL says: Error executing code in Maxima: taylor: encountered an unfamiliar singularity in:
```
Could you please add the exact output you expect from `series` to the ticket description?



---

archive/issue_comments_260857.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,15 @@\n+The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within sage, we have\n \n ```\n sage: zeta(x).series(x==1,2)\n (Infinity) + (zetaderiv(1, 1))*(x - 1) + Order((x - 1)^2)\n ```\n+\n+when in fact, we should have\n+\n+```\n+sage: zeta(x).series(x==1, 1)\n+1*(-1+x)^(-1)+(log(Pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)\n+```\n+\n+(see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)\n``````\n",
    "created_at": "2015-04-08T07:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260857",
    "user": "https://github.com/behackl"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,15 @@
+The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within sage, we have
 
 ```
 sage: zeta(x).series(x==1,2)
 (Infinity) + (zetaderiv(1, 1))*(x - 1) + Order((x - 1)^2)
 ```
+
+when in fact, we should have
+
+```
+sage: zeta(x).series(x==1, 1)
+1*(-1+x)^(-1)+(log(Pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)
+```
+
+(see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)
``````




---

archive/issue_comments_260858.json:
```json
{
    "body": "<a id='comment:7'></a>\nI managed to find a fix for the problem in GiNaC, which should -- more or less -- directly translate into a fix for Pynac, which Sage uses as a substitute for GiNaC.\n\nWhen using zeta's functional equation http://dlmf.nist.gov/25.4.E2 for the series expansion around `s=1`, then within GiNaC, I obtain the expression now stated in the description.\n\nFor a follow-up ticket, it would probably be nice to tell sage that `zetaderiv(0,1)` is equal to `-log(sqrt(2*pi))`, as it simplifies the expansion to the more likeable form \n\n```\nsage: zeta(x).series(x==1, 1)\n1*(-1+x)^(-1)+(euler_gamma)+Order(-1+x)\n```\n\nMaxima probably has a similar problem like SymPy, GiNaC et al.; I guess we should report the issue there as well?",
    "created_at": "2015-04-08T07:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260858",
    "user": "https://github.com/behackl"
}
```

<a id='comment:7'></a>
I managed to find a fix for the problem in GiNaC, which should -- more or less -- directly translate into a fix for Pynac, which Sage uses as a substitute for GiNaC.

When using zeta's functional equation http://dlmf.nist.gov/25.4.E2 for the series expansion around `s=1`, then within GiNaC, I obtain the expression now stated in the description.

For a follow-up ticket, it would probably be nice to tell sage that `zetaderiv(0,1)` is equal to `-log(sqrt(2*pi))`, as it simplifies the expansion to the more likeable form 

```
sage: zeta(x).series(x==1, 1)
1*(-1+x)^(-1)+(euler_gamma)+Order(-1+x)
```

Maxima probably has a similar problem like SymPy, GiNaC et al.; I guess we should report the issue there as well?



---

archive/issue_comments_260859.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within sage, we have\n+The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within Sage, we have\n \n ```\n sage: zeta(x).series(x==1,2)\n@@ -9,7 +9,7 @@\n \n ```\n sage: zeta(x).series(x==1, 1)\n-1*(-1+x)^(-1)+(log(Pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)\n+1*(-1+x)^(-1)+(log(pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)\n ```\n \n (see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)\n``````\n",
    "created_at": "2015-04-08T07:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260859",
    "user": "https://github.com/behackl"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within sage, we have
+The series expansion of the zeta function around its singularity at `s=1` is incorrect. Within Sage, we have
 
 ```
 sage: zeta(x).series(x==1,2)
@@ -9,7 +9,7 @@
 
 ```
 sage: zeta(x).series(x==1, 1)
-1*(-1+x)^(-1)+(log(Pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)
+1*(-1+x)^(-1)+(log(pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)
 ```
 
 (see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)
``````




---

archive/issue_comments_260860.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [behackl](#comment%3A7):\n> I managed to find a fix for the problem in GiNaC, which should -- more or less -- directly translate into a fix for Pynac, which Sage uses as a substitute for GiNaC.\n\nWhat do you mean? If it's a patch on top of recent GiNaC it might not be applicable to Pynac.\n\n> For a follow-up ticket, it would probably be nice to tell sage that `zetaderiv(0,1)` is equal to `-log(sqrt(2*pi))`, as it simplifies the expansion to the more likeable form \n\nYes, see #18141",
    "created_at": "2015-04-08T08:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260860",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>
Replying to [behackl](#comment%3A7):
> I managed to find a fix for the problem in GiNaC, which should -- more or less -- directly translate into a fix for Pynac, which Sage uses as a substitute for GiNaC.

What do you mean? If it's a patch on top of recent GiNaC it might not be applicable to Pynac.

> For a follow-up ticket, it would probably be nice to tell sage that `zetaderiv(0,1)` is equal to `-log(sqrt(2*pi))`, as it simplifies the expansion to the more likeable form 

Yes, see #18141



---

archive/issue_comments_260861.json:
```json
{
    "body": "<a id='comment:9'></a>\nAttachment [zeta_expansion.patch](tarball://root/attachments/some-uuid/ticket15846/zeta_expansion.patch) by @behackl created at 2015-04-08 08:51:34\n\nReplying to [rws](#comment%3A8):\n\n\n> Replying to [behackl](#comment%3A7):\n> \n> > I managed to find a fix for the problem in GiNaC, which should -- more or less -- directly translate into a fix for Pynac, which Sage uses as a substitute for GiNaC.\n> > \n\n> What do you mean? If it's a patch on top of recent GiNaC it might not be applicable to Pynac.\n\nWell, I just implemented `zeta1_series` in `ginac/inifcns_nstdsums.cpp` -- I don't really know, do you think that would fix the problem in Pynac too? (See attachment.)",
    "created_at": "2015-04-08T08:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260861",
    "user": "https://github.com/behackl"
}
```

<a id='comment:9'></a>
Attachment [zeta_expansion.patch](tarball://root/attachments/some-uuid/ticket15846/zeta_expansion.patch) by @behackl created at 2015-04-08 08:51:34

Replying to [rws](#comment%3A8):


> Replying to [behackl](#comment%3A7):
> 
> > I managed to find a fix for the problem in GiNaC, which should -- more or less -- directly translate into a fix for Pynac, which Sage uses as a substitute for GiNaC.
> > 

> What do you mean? If it's a patch on top of recent GiNaC it might not be applicable to Pynac.

Well, I just implemented `zeta1_series` in `ginac/inifcns_nstdsums.cpp` -- I don't really know, do you think that would fix the problem in Pynac too? (See attachment.)



---

archive/issue_comments_260862.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [behackl](#comment%3A9):\n> Well, I just implemented `zeta1_series` in `ginac/inifcns_nstdsums.cpp` -- I don't really know, do you think that would fix the problem in Pynac too? (See attachment.)\n\nI do not have the impression that Pynac has ever upgraded its GiNaC part since the point in time the fork was made. BTW, if you intend to do changes to Pynac, I have a github mirror/copy which you can use, and I'll actively support you, might even be tempted to do changes myself: https://github.com/rwst/pynac",
    "created_at": "2015-04-08T09:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260862",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>
Replying to [behackl](#comment%3A9):
> Well, I just implemented `zeta1_series` in `ginac/inifcns_nstdsums.cpp` -- I don't really know, do you think that would fix the problem in Pynac too? (See attachment.)

I do not have the impression that Pynac has ever upgraded its GiNaC part since the point in time the fork was made. BTW, if you intend to do changes to Pynac, I have a github mirror/copy which you can use, and I'll actively support you, might even be tempted to do changes myself: https://github.com/rwst/pynac



---

archive/issue_comments_260863.json:
```json
{
    "body": "<a id='comment:11'></a>\n> I do not have the impression that Pynac has ever upgraded its GiNaC part since the point in time the fork was made.\n\nAh okay, I thought you made a patch on top of The Official GiNaC, i.e., http://www.ginac.de/ginac.git/",
    "created_at": "2015-04-08T09:22:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260863",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'></a>
> I do not have the impression that Pynac has ever upgraded its GiNaC part since the point in time the fork was made.

Ah okay, I thought you made a patch on top of The Official GiNaC, i.e., http://www.ginac.de/ginac.git/



---

archive/issue_comments_260864.json:
```json
{
    "body": "<a id='comment:12'></a>\nI just compiled sage with the patch added to pynac, and now I get\n\n```\nsage: zeta(x).series(x==1, 1)\n1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + Order(x - 1)\n```\n\nSeems to work. :-)\n\nSo, in order to get this ticket resolved and have the fix in Sage, what is the best way to proceed from here? I'd certainly like to commit the changes to your github mirror -- but what happens then?\n\nReplying to [rws](#comment%3A11):\n> > I do not have the impression that Pynac has ever upgraded its GiNaC part since the point in time the fork was made.\n\n> Ah okay, I thought you made a patch on top of The Official GiNaC, i.e., http://www.ginac.de/ginac.git/\n\nWell, as of yet I have done nothing, really (except for fixing this thing locally). ;-)\nBut I guess I could also submit my changes there, the official GiNaC version also has the same problem w.r.t. the expansion of zeta. (However, the version on git wouldn't compile for me yesterday, so for fixing this I initially used the tarball on their website...)",
    "created_at": "2015-04-08T09:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260864",
    "user": "https://github.com/behackl"
}
```

<a id='comment:12'></a>
I just compiled sage with the patch added to pynac, and now I get

```
sage: zeta(x).series(x==1, 1)
1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + Order(x - 1)
```

Seems to work. :-)

So, in order to get this ticket resolved and have the fix in Sage, what is the best way to proceed from here? I'd certainly like to commit the changes to your github mirror -- but what happens then?

Replying to [rws](#comment%3A11):
> > I do not have the impression that Pynac has ever upgraded its GiNaC part since the point in time the fork was made.

> Ah okay, I thought you made a patch on top of The Official GiNaC, i.e., http://www.ginac.de/ginac.git/

Well, as of yet I have done nothing, really (except for fixing this thing locally). ;-)
But I guess I could also submit my changes there, the official GiNaC version also has the same problem w.r.t. the expansion of zeta. (However, the version on git wouldn't compile for me yesterday, so for fixing this I initially used the tarball on their website...)



---

archive/issue_comments_260865.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n \n ```\n sage: zeta(x).series(x==1, 1)\n-1*(-1+x)^(-1)+(log(pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)\n+1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + Order(x - 1)\n ```\n \n (see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)\n``````\n",
    "created_at": "2015-04-08T09:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260865",
    "user": "https://github.com/behackl"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 
 ```
 sage: zeta(x).series(x==1, 1)
-1*(-1+x)^(-1)+(log(pi)+log(2)+euler_gamma+2*zetaderiv(1,0))+Order(-1+x)
+1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + Order(x - 1)
 ```
 
 (see http://dlmf.nist.gov/25.2.E4 for the expansion like it is supposed to be.)
``````




---

archive/issue_comments_260866.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [behackl](#comment%3A12):\n> So, in order to get this ticket resolved and have the fix in Sage, what is the best way to proceed from here? I'd certainly like to commit the changes to your github mirror -- but what happens then?\n\nGood question. I would (with perhaps other changes) publish a new Pynac version, refer to it from this ticket, and see what happens: if there is an existing Pynac maintainer s/he should act. 2. You could clone the repo on github and do a new release yourself; or 3. you could propose your patch in an issue at the Pynac bitbucket site.",
    "created_at": "2015-04-08T09:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260866",
    "user": "https://github.com/rwst"
}
```

<a id='comment:13'></a>
Replying to [behackl](#comment%3A12):
> So, in order to get this ticket resolved and have the fix in Sage, what is the best way to proceed from here? I'd certainly like to commit the changes to your github mirror -- but what happens then?

Good question. I would (with perhaps other changes) publish a new Pynac version, refer to it from this ticket, and see what happens: if there is an existing Pynac maintainer s/he should act. 2. You could clone the repo on github and do a new release yourself; or 3. you could propose your patch in an issue at the Pynac bitbucket site.



---

archive/issue_comments_260867.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [rws](#comment%3A13):\n> Replying to [behackl](#comment%3A12):\n> > So, in order to get this ticket resolved and have the fix in Sage, what is the best way to proceed from here? I'd certainly like to commit the changes to your github mirror -- but what happens then?\n\n> Good question. I would (with perhaps other changes) publish a new Pynac version, refer to it from this ticket, and see what happens: if there is an existing Pynac maintainer s/he should act. 2. You could clone the repo on github and do a new release yourself; or 3. you could propose your patch in an issue at the Pynac bitbucket site.\n\nI've send you a pull request on your GitHub clone.\n\nIf you try to push a new Pynac version, I suppose that would be fine. I could also report the issue (altogether with my patch) to the bitbucket site and wait for a response from there -- but what I currently don't want to try is releasing the package myself. Maybe we should also ask those involved with Pynac for their opinion?",
    "created_at": "2015-04-08T10:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260867",
    "user": "https://github.com/behackl"
}
```

<a id='comment:14'></a>
Replying to [rws](#comment%3A13):
> Replying to [behackl](#comment%3A12):
> > So, in order to get this ticket resolved and have the fix in Sage, what is the best way to proceed from here? I'd certainly like to commit the changes to your github mirror -- but what happens then?

> Good question. I would (with perhaps other changes) publish a new Pynac version, refer to it from this ticket, and see what happens: if there is an existing Pynac maintainer s/he should act. 2. You could clone the repo on github and do a new release yourself; or 3. you could propose your patch in an issue at the Pynac bitbucket site.

I've send you a pull request on your GitHub clone.

If you try to push a new Pynac version, I suppose that would be fine. I could also report the issue (altogether with my patch) to the bitbucket site and wait for a response from there -- but what I currently don't want to try is releasing the package myself. Maybe we should also ask those involved with Pynac for their opinion?



---

archive/issue_comments_260868.json:
```json
{
    "body": "<a id='comment:15'></a>\nI have posted at https://groups.google.com/forum/?hl=en#!topic/sage-devel/hwQXxFmutcU",
    "created_at": "2015-04-08T12:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260868",
    "user": "https://github.com/rwst"
}
```

<a id='comment:15'></a>
I have posted at https://groups.google.com/forum/?hl=en#!topic/sage-devel/hwQXxFmutcU



---

archive/issue_comments_260869.json:
```json
{
    "body": "<a id='comment:16'></a>\nThanks! Let me know if there is anything I can do to help.",
    "created_at": "2015-04-08T14:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260869",
    "user": "https://github.com/behackl"
}
```

<a id='comment:16'></a>
Thanks! Let me know if there is anything I can do to help.



---

archive/issue_comments_260870.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [behackl](#comment%3A16):\n> Thanks! Let me know if there is anything I can do to help.\n\nPlease write two doctests around l.70-80 in `functions/transcendental.py` (one checking symbolic output, the other demonstrating numerics) so that we see whenever there is a regression. They will of course, only pass when Sage is upgraded to pynac-0.3.3, so this ticket depends on the upgrade ticket.",
    "created_at": "2015-04-10T07:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260870",
    "user": "https://github.com/rwst"
}
```

<a id='comment:17'></a>
Replying to [behackl](#comment%3A16):
> Thanks! Let me know if there is anything I can do to help.

Please write two doctests around l.70-80 in `functions/transcendental.py` (one checking symbolic output, the other demonstrating numerics) so that we see whenever there is a regression. They will of course, only pass when Sage is upgraded to pynac-0.3.3, so this ticket depends on the upgrade ticket.



---

archive/issue_comments_260871.json:
```json
{
    "body": "<a id='comment:18'></a>\nDone. For the sake of completeness: the upstream fix can be found at https://github.com/pynac/pynac/pull/1\n\nI'll leave this ticket's status as `new` until I can set the Pynac-update ticket as a dependency.",
    "created_at": "2015-04-10T13:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260871",
    "user": "https://github.com/behackl"
}
```

<a id='comment:18'></a>
Done. For the sake of completeness: the upstream fix can be found at https://github.com/pynac/pynac/pull/1

I'll leave this ticket's status as `new` until I can set the Pynac-update ticket as a dependency.



---

archive/issue_comments_260872.json:
```json
{
    "body": "Changing branch from \"\" to \"u/behackl/functions/zeta_series\"",
    "created_at": "2015-04-10T13:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260872",
    "user": "https://github.com/behackl"
}
```

Changing branch from "" to "u/behackl/functions/zeta_series"



---

archive/issue_comments_260873.json:
```json
{
    "body": "Changing commit from \"\" to \"eccce0202c0a7773f5238af3e5b23f7706e6ff21\"",
    "created_at": "2015-04-10T13:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260873",
    "user": "https://github.com/behackl"
}
```

Changing commit from "" to "eccce0202c0a7773f5238af3e5b23f7706e6ff21"



---

archive/issue_comments_260874.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Completely fixed; Fix reported upstream\"",
    "created_at": "2015-04-10T13:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260874",
    "user": "https://github.com/behackl"
}
```

Changing upstream from "N/A" to "Completely fixed; Fix reported upstream"



---

archive/issue_comments_260875.json:
```json
{
    "body": "<a id='comment:19'></a>\nOh, sorry -- I did not read the part with the doctest that should demonstrate numerics. \n\nDo you mean something like\n\n```\nsage: zeta(x).series(x==1, 1).coefficient(x, 0).n()\n0.577215664901533\n```",
    "created_at": "2015-04-10T13:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260875",
    "user": "https://github.com/behackl"
}
```

<a id='comment:19'></a>
Oh, sorry -- I did not read the part with the doctest that should demonstrate numerics. 

Do you mean something like

```
sage: zeta(x).series(x==1, 1).coefficient(x, 0).n()
0.577215664901533
```



---

archive/issue_comments_260876.json:
```json
{
    "body": "<a id='comment:20'></a>\nNot sure if it's necessary, or even correct, to compare `zeta(x).series(x=1,3).subs(x=.999).n()` with `zeta(.999)`.",
    "created_at": "2015-04-10T13:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260876",
    "user": "https://github.com/rwst"
}
```

<a id='comment:20'></a>
Not sure if it's necessary, or even correct, to compare `zeta(x).series(x=1,3).subs(x=.999).n()` with `zeta(.999)`.



---

archive/issue_comments_260877.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [rws](#comment%3A20):\n> Not sure if it's necessary, or even correct, to compare `zeta(x).series(x=1,3).subs(x=.999).n()` with `zeta(.999)`.\n\n\nWell, there would be some sort of approximation error -- but something like checking the numerical value of the absolute term is certainly possible (like in the modified comment above).",
    "created_at": "2015-04-10T13:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260877",
    "user": "https://github.com/behackl"
}
```

<a id='comment:21'></a>
Replying to [rws](#comment%3A20):
> Not sure if it's necessary, or even correct, to compare `zeta(x).series(x=1,3).subs(x=.999).n()` with `zeta(.999)`.


Well, there would be some sort of approximation error -- but something like checking the numerical value of the absolute term is certainly possible (like in the modified comment above).



---

archive/issue_comments_260878.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#18155\"",
    "created_at": "2015-04-10T14:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260878",
    "user": "https://github.com/rwst"
}
```

Changing dependencies from "" to "#18155"



---

archive/issue_events_053168.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-04-10T14:46:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15846#event-53168"
}
```



---

archive/issue_events_053169.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-04-10T14:46:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15846#event-53169"
}
```



---

archive/issue_comments_260879.json:
```json
{
    "body": "Changing author from \"\" to \"Benjamin Hackl\"",
    "created_at": "2015-04-11T14:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260879",
    "user": "https://github.com/behackl"
}
```

Changing author from "" to "Benjamin Hackl"



---

archive/issue_comments_260880.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-11T14:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260880",
    "user": "https://github.com/behackl"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_260881.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ralf Stephan\"",
    "created_at": "2015-04-11T14:51:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260881",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "" to "Ralf Stephan"



---

archive/issue_comments_260882.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-11T14:51:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260882",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_260883.json:
```json
{
    "body": "<a id='comment:24'></a>\nIs fine, thanks.",
    "created_at": "2015-04-11T14:51:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260883",
    "user": "https://github.com/rwst"
}
```

<a id='comment:24'></a>
Is fine, thanks.



---

archive/issue_comments_260884.json:
```json
{
    "body": "Changing dependencies from \"#18155\" to \"#18237\"",
    "created_at": "2015-04-17T13:16:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260884",
    "user": "https://github.com/behackl"
}
```

Changing dependencies from "#18155" to "#18237"



---

archive/issue_comments_260885.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-19T01:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260885",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_260886.json:
```json
{
    "body": "Changing branch from \"u/behackl/functions/zeta_series\" to \"eccce0202c0a7773f5238af3e5b23f7706e6ff21\"",
    "created_at": "2015-04-19T01:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15846#issuecomment-260886",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/behackl/functions/zeta_series" to "eccce0202c0a7773f5238af3e5b23f7706e6ff21"



---

archive/issue_events_053170.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-19T01:51:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15846",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15846#event-53170"
}
```
