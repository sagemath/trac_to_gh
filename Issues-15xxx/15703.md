# Issue 15703: Refactor Coxeter groups as matrix groups and non crystallographic root systems

archive/issues_015466.json:
```json
{
    "body": "CC:  sage-combinat @tscrim @jplab vripoll @mathzeta\n\nKeywords: coxeter groups, days57\n\nThis is a follow up to #9290.\n\n* Experiment with the infrastructure scales and benchmark \n\n* CoxeterGraph, see #16126\n  - Create a class similar to DynkinDiagram\n    Starter: an edge-labeled graph.\n  - Edge labels: m_{i,j}, possibly with number <-1 for oo\n  - method dynkin_diagram() which builds the cartan matrix for the geometric representation\n    Starter: just make this a function\n\n* Update DynkinDiagram to support non crystallographic case:\n  - Add an argument base_ring to the constructor\n  - Add a method base_ring\n  - Make add_edge honor this method when automatically adding edges\n  - Update cartan_matrix() to use the base_ring\n  - Add a method _test_base_ring that checks that all edge labels are\n    indeed in this base ring\n  - Implement is_crystallographic testing if the base ring is ZZ\n  - Add an argument symmetric=False to the constructor, and make\n    add_edge and symmetrizer use it.\n  - Add a method _test_dynkin_diagram that tests that the Dynkin\n    diagram indeed defines a proper root system. See in particular\n    cartan_matrix.is_generalized_cartan_matrix.\n  - adapt column() and row() method to give the labels in the base ring\n\n  * Update CartanMatrix, see #17798\n  - Add a base ring argument to the constructor\n  - Update is_crystallographic\n  - Update is_affine\n  - Update is_finite\n  - Update is_generalized_cartan_matrix\n\n* CartanType\n  - Possibly update to accept appropriate data to build a CoxeterGraph (e.g. a matrix)\n  - Add a base_ring method?\n  - Decide on the semantic of is_crystallographic (symmetrizable or\n    not?), and if possibly add an is_... method to decide whether the\n    entries are integral or not.\n  - Provide a dynkin_diagram method that builds the Dynkin diagram\n    from the Coxeter diagram when available\n  - Test: H_3 and friends should have a working dynkin_diagram method\n\n* RootSystem\n  - Decide on the meaning of root_lattice: either disable it in the\n    non integral case, or have it be the span of the roots over the\n    smallest available ring.\n\n* RootLatticeRealizations:\n  - Feed this to RootSystem, and check that the root space and weight\n    space are built properly.\n  - Rename the weyl_group method to reflection_group, with an alias\n    from weyl_group; update the setting of the category.\n  - Define a new projection \"transversal\" to visualise root systems (and find a right name for it)\n  - Long run: stuff specific to the crystallographic case, starting\n    with this weyl_group method, should go in\n    RootLatticeRealizations.Crystallographic. That's for a follow up\n    ticket on using axioms for root systems; but let's not depend on\n    #10963 right now.\n\n* RootSpace (for this ticket or some follow up):\n  - Define the inner product\n  - adapt the is_positive_root to make it work for any base ring\n  - Signature of the bilinear form\n\n* CoxeterMatrixGroup and WeylGroup:\n  - Refactor WeylGroup to make it a subclass of CoxeterMatrixGroup,\n    and lift as many features as possible from WeylGroup to\n    CoxeterMatrixGroup.\n  - Check that, with a proper Dynkin diagram, the conversion to GAP\n    issue does not appear\n  - Now or later: we probably want the Weyl group elements to be\n    represented by Sage matrices, but keep a handle to the\n    corresponding Gap group. Currently one has to make a choice\n    between MatrixGroup_generic and MatrixGroup_gap.\n\n* Plotting:\n  - add a family_of_points method in the projections to be used by the \"transversal projection\"\n\n* Update WeylGroups:\n  - inversions: use the \"root_lattice\" by default?\n\n\nTests:\n\n```\n  sage: C = CoxeterDiagram(...)           # good name? or CartanDatum(coxeter_matrix=...) [1] ? or?\n  sage: L = RootSystem(C).root_space()\n  sage: W = L.reflection_group()\n  sage: W = CoxeterGroup(['H',3])\n  sage: W.domain()\n```\nSage Days 57 in Cernay will be a good occasion to work on this.\n\nFollow ups: #16087\n\n[1]: Generally speaking, it's planned to rename CartanType to CartanDatum.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15703\n\n",
    "created_at": "2014-01-21T10:08:53Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Refactor Coxeter groups as matrix groups and non crystallographic root systems",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15703",
    "user": "https://github.com/nthiery"
}
```
CC:  sage-combinat @tscrim @jplab vripoll @mathzeta

Keywords: coxeter groups, days57

This is a follow up to #9290.

* Experiment with the infrastructure scales and benchmark 

* CoxeterGraph, see #16126
  - Create a class similar to DynkinDiagram
    Starter: an edge-labeled graph.
  - Edge labels: m_{i,j}, possibly with number <-1 for oo
  - method dynkin_diagram() which builds the cartan matrix for the geometric representation
    Starter: just make this a function

* Update DynkinDiagram to support non crystallographic case:
  - Add an argument base_ring to the constructor
  - Add a method base_ring
  - Make add_edge honor this method when automatically adding edges
  - Update cartan_matrix() to use the base_ring
  - Add a method _test_base_ring that checks that all edge labels are
    indeed in this base ring
  - Implement is_crystallographic testing if the base ring is ZZ
  - Add an argument symmetric=False to the constructor, and make
    add_edge and symmetrizer use it.
  - Add a method _test_dynkin_diagram that tests that the Dynkin
    diagram indeed defines a proper root system. See in particular
    cartan_matrix.is_generalized_cartan_matrix.
  - adapt column() and row() method to give the labels in the base ring

  * Update CartanMatrix, see #17798
  - Add a base ring argument to the constructor
  - Update is_crystallographic
  - Update is_affine
  - Update is_finite
  - Update is_generalized_cartan_matrix

* CartanType
  - Possibly update to accept appropriate data to build a CoxeterGraph (e.g. a matrix)
  - Add a base_ring method?
  - Decide on the semantic of is_crystallographic (symmetrizable or
    not?), and if possibly add an is_... method to decide whether the
    entries are integral or not.
  - Provide a dynkin_diagram method that builds the Dynkin diagram
    from the Coxeter diagram when available
  - Test: H_3 and friends should have a working dynkin_diagram method

* RootSystem
  - Decide on the meaning of root_lattice: either disable it in the
    non integral case, or have it be the span of the roots over the
    smallest available ring.

* RootLatticeRealizations:
  - Feed this to RootSystem, and check that the root space and weight
    space are built properly.
  - Rename the weyl_group method to reflection_group, with an alias
    from weyl_group; update the setting of the category.
  - Define a new projection "transversal" to visualise root systems (and find a right name for it)
  - Long run: stuff specific to the crystallographic case, starting
    with this weyl_group method, should go in
    RootLatticeRealizations.Crystallographic. That's for a follow up
    ticket on using axioms for root systems; but let's not depend on
    #10963 right now.

* RootSpace (for this ticket or some follow up):
  - Define the inner product
  - adapt the is_positive_root to make it work for any base ring
  - Signature of the bilinear form

* CoxeterMatrixGroup and WeylGroup:
  - Refactor WeylGroup to make it a subclass of CoxeterMatrixGroup,
    and lift as many features as possible from WeylGroup to
    CoxeterMatrixGroup.
  - Check that, with a proper Dynkin diagram, the conversion to GAP
    issue does not appear
  - Now or later: we probably want the Weyl group elements to be
    represented by Sage matrices, but keep a handle to the
    corresponding Gap group. Currently one has to make a choice
    between MatrixGroup_generic and MatrixGroup_gap.

* Plotting:
  - add a family_of_points method in the projections to be used by the "transversal projection"

* Update WeylGroups:
  - inversions: use the "root_lattice" by default?


Tests:

```
  sage: C = CoxeterDiagram(...)           # good name? or CartanDatum(coxeter_matrix=...) [1] ? or?
  sage: L = RootSystem(C).root_space()
  sage: W = L.reflection_group()
  sage: W = CoxeterGroup(['H',3])
  sage: W.domain()
```
Sage Days 57 in Cernay will be a good occasion to work on this.

Follow ups: #16087

[1]: Generally speaking, it's planned to rename CartanType to CartanDatum.


Issue created by migration from https://trac.sagemath.org/ticket/15703





---

archive/issue_events_046085.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15703#event-46085"
}
```



---

archive/issue_comments_199542.json:
```json
{
    "body": "Changing keywords from \"\" to \"coxeter\".",
    "created_at": "2014-02-17T10:53:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199542",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "coxeter".



---

archive/issue_comments_199543.json:
```json
{
    "body": "Changing keywords from \"coxeter\" to \"coxeter groups, days57\".",
    "created_at": "2014-04-08T06:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199543",
    "user": "https://github.com/nthiery"
}
```

Changing keywords from "coxeter" to "coxeter groups, days57".



---

archive/issue_comments_199544.json:
```json
{
    "body": "I believe I'm taking care of the inner product on the root space in #15384 (which I  called `symmetric_form()`). Also for a followup ticket, we should implement/refactor things for symmetrizable and the non-symmetrizable types (for when we get the hyperbolic types done).",
    "created_at": "2014-04-09T14:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199544",
    "user": "https://github.com/tscrim"
}
```

I believe I'm taking care of the inner product on the root space in #15384 (which I  called `symmetric_form()`). Also for a followup ticket, we should implement/refactor things for symmetrizable and the non-symmetrizable types (for when we get the hyperbolic types done).



---

archive/issue_comments_199545.json:
```json
{
    "body": "Very good!\n\nJust a small suggestion: I would call the function \"bilinear_form\". Although it is true that we deal with symmetric forms so far...",
    "created_at": "2014-04-09T14:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199545",
    "user": "https://github.com/jplab"
}
```

Very good!

Just a small suggestion: I would call the function "bilinear_form". Although it is true that we deal with symmetric forms so far...



---

archive/issue_comments_199546.json:
```json
{
    "body": "Attachment [benchmark.png](tarball://root/attachments/some-uuid/ticket15703/benchmark.png) by @jplab created at 2014-04-10 12:27:41",
    "created_at": "2014-04-10T12:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199546",
    "user": "https://github.com/jplab"
}
```

Attachment [benchmark.png](tarball://root/attachments/some-uuid/ticket15703/benchmark.png) by @jplab created at 2014-04-10 12:27:41



---

archive/issue_comments_199547.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-04-10T17:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199547",
    "user": "https://github.com/jplab"
}
```

New commits:



---

archive/issue_comments_199548.json:
```json
{
    "body": "Attachment [benchmark2.png](tarball://root/attachments/some-uuid/ticket15703/benchmark2.png) by @jplab created at 2014-04-13 15:39:16",
    "created_at": "2014-04-13T15:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199548",
    "user": "https://github.com/jplab"
}
```

Attachment [benchmark2.png](tarball://root/attachments/some-uuid/ticket15703/benchmark2.png) by @jplab created at 2014-04-13 15:39:16



---

archive/issue_comments_199549.json:
```json
{
    "body": "I adapted the TODO list in relation with the latest changes I just pushed. The script joined allows you to create the pictures and do some tests...\n\nNow we have to work!!\n\n---\nNew commits:",
    "created_at": "2014-04-13T15:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199549",
    "user": "https://github.com/jplab"
}
```

I adapted the TODO list in relation with the latest changes I just pushed. The script joined allows you to create the pictures and do some tests...

Now we have to work!!

---
New commits:



---

archive/issue_comments_199550.json:
```json
{
    "body": "Attachment [test_rootsystems.sage](tarball://root/attachments/some-uuid/ticket15703/test_rootsystems.sage) by vbraun_spam created at 2014-05-06 15:20:58",
    "created_at": "2014-05-06T15:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15703#issuecomment-199550",
    "user": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam"
}
```

Attachment [test_rootsystems.sage](tarball://root/attachments/some-uuid/ticket15703/test_rootsystems.sage) by vbraun_spam created at 2014-05-06 15:20:58



---

archive/issue_events_046086.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15703#event-46086"
}
```



---

archive/issue_events_046087.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15703#event-46087"
}
```



---

archive/issue_events_046088.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15703#event-46088"
}
```



---

archive/issue_events_046089.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15703",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15703#event-46089"
}
```
