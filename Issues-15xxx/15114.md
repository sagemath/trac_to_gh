# Issue 15114: disallow dangerous coercions to RIF

archive/issues_014877.json:
```json
{
    "assignees": [],
    "body": "Remove the following coercions because they make interval arithmetic much less trustworthy.\n* `RealField` --> `RealIntervalField`\n* `float` --> `ComplexIntervalField`\n* `SR` --> `ComplexIntervalField`\n\nFor example, one could easily do the following by accident.\n\n```\n    sage: iv = 1 + 2^(-55) + 0. + RIF(1)\n    sage: iv.lower(), iv.upper()\n    (2.00000000000000, 2.00000000000000)\n```\n\nSee also [this topic on sage-devel](https://groups.google.com/forum/#!topic/sage-devel/zfg0PhFR_qA)\n\nAlready removed in other tickets:\n* `ComplexField` --> `ComplexIntervalField`\n\nCC:  @videlec @mezzarobba @dkrenn @cheuberg @bhutz @JohnCremona @pjbruin\n\nKeywords: **RIF RR interval coercion**\n\nBranch/Commit: **[3c7644f](https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Marc Mezzarobba**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15114_\n\n",
    "closed_at": "2021-02-20T10:46:39Z",
    "created_at": "2013-08-28T09:59:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20coercion",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "disallow dangerous coercions to RIF",
    "type": "issue",
    "updated_at": "2021-02-20T10:46:39Z",
    "url": "https://github.com/sagemath/sage/issues/15114",
    "user": "https://github.com/mstreng"
}
```
Remove the following coercions because they make interval arithmetic much less trustworthy.
* `RealField` --> `RealIntervalField`
* `float` --> `ComplexIntervalField`
* `SR` --> `ComplexIntervalField`

For example, one could easily do the following by accident.

```
    sage: iv = 1 + 2^(-55) + 0. + RIF(1)
    sage: iv.lower(), iv.upper()
    (2.00000000000000, 2.00000000000000)
```

See also [this topic on sage-devel](https://groups.google.com/forum/#!topic/sage-devel/zfg0PhFR_qA)

Already removed in other tickets:
* `ComplexField` --> `ComplexIntervalField`

CC:  @videlec @mezzarobba @dkrenn @cheuberg @bhutz @JohnCremona @pjbruin

Keywords: **RIF RR interval coercion**

Branch/Commit: **[3c7644f](https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50)**

Reviewer: **Vincent Delecroix**

Author: **Marc Mezzarobba**

_Issue created by migration from https://trac.sagemath.org/ticket/15114_





---

archive/issue_events_197275.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2013-08-28T09:59:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197275"
}
```



---

archive/issue_events_197276.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2013-08-28T09:59:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20coercion",
    "label_color": "0000ff",
    "label_name": "component: coercion",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197276"
}
```



---

archive/issue_events_197277.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2013-08-28T09:59:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197277"
}
```



---

archive/issue_events_197278.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2013-08-28T09:59:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197278"
}
```



---

archive/issue_comments_188243.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n Remove the following coercions because they make interval arithmetic much less trustworthy.\n-* RR --> RIF\n-* CC --> CIF\n-* RealField --> RealIntervalField\n-* ComplexField --> ComplexIntervalField\n+* `RR` --> `RIF`\n+* `CC` --> `CIF`\n+* `RealField` --> `RealIntervalField`\n+* `ComplexField` --> `ComplexIntervalField`\n \n For example, one could easily do the following by accident.\n \n``````\n",
    "created_at": "2013-08-28T17:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188243",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 Remove the following coercions because they make interval arithmetic much less trustworthy.
-* RR --> RIF
-* CC --> CIF
-* RealField --> RealIntervalField
-* ComplexField --> ComplexIntervalField
+* `RR` --> `RIF`
+* `CC` --> `CIF`
+* `RealField` --> `RealIntervalField`
+* `ComplexField` --> `ComplexIntervalField`
 
 For example, one could easily do the following by accident.
 
``````




---

archive/issue_events_197279.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197279"
}
```



---

archive/issue_events_197280.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197280"
}
```



---

archive/issue_comments_188244.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nI think this change will cause many more problems than it solves.\n\nIn practice: I expect this will break a lot of existing code. I often use the RR --> RIF coercion intentionally, because it makes it more convenient to do exactly what I want. For instance:\n\n* In an interval branch-and-bound code, cell widths in a geometric decomposition are expressed as reciprocal powers of two, which can be efficiently stored and used as EXACT floating-point numbers. Combining these in arithmetic operations with intervals gives the same results as explicitly converting them to RIF, without having to do the explicit conversion.\n\n* Interval arithmetic is a fast way to obtain approximate bounds on floating-point calculations over ranges of parameters, by simply replacing the parameter of interest with an interval. To do this without RR --> RIF, one would have to add explicit conversions of *all* other parameters appearing in combination with this parameter *everywhere* it occurs.\n\nIn theory: I think the motivation is flawed. The change was proposed to avoid accidental coercion of exact ring values to RIF via potentially inexact RR. But the problem in this case is the first step, not the second, and reflects the need for a direct coercion from the exact ring to RIF. In such a case, the lack of such a coercion is the bug. Whereas each value in RR *does* have a valid coercion to RIF, and the lack of this coercion would also be a bug.\n\nRealistically, I think anyone who is actually \n\n1. using RIF to do reliable computing *and* \n2. coercing values from other exact rings that *don't* have direct coercions to RIF *and* are not expressible exactly in RR,\n\nis going to be sufficiently aware of the potential problem that they will handle/check the conversion explicitly. Better to expect this than to inconvenience many users who use this coercion in far less arcane circumstances.",
    "created_at": "2014-03-14T19:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188244",
    "user": "https://github.com/sagetrac-tcoffee"
}
```

<div id="comment:4" align="right">Comment 4</div>

I think this change will cause many more problems than it solves.

In practice: I expect this will break a lot of existing code. I often use the RR --> RIF coercion intentionally, because it makes it more convenient to do exactly what I want. For instance:

* In an interval branch-and-bound code, cell widths in a geometric decomposition are expressed as reciprocal powers of two, which can be efficiently stored and used as EXACT floating-point numbers. Combining these in arithmetic operations with intervals gives the same results as explicitly converting them to RIF, without having to do the explicit conversion.

* Interval arithmetic is a fast way to obtain approximate bounds on floating-point calculations over ranges of parameters, by simply replacing the parameter of interest with an interval. To do this without RR --> RIF, one would have to add explicit conversions of *all* other parameters appearing in combination with this parameter *everywhere* it occurs.

In theory: I think the motivation is flawed. The change was proposed to avoid accidental coercion of exact ring values to RIF via potentially inexact RR. But the problem in this case is the first step, not the second, and reflects the need for a direct coercion from the exact ring to RIF. In such a case, the lack of such a coercion is the bug. Whereas each value in RR *does* have a valid coercion to RIF, and the lack of this coercion would also be a bug.

Realistically, I think anyone who is actually 

1. using RIF to do reliable computing *and* 
2. coercing values from other exact rings that *don't* have direct coercions to RIF *and* are not expressible exactly in RR,

is going to be sufficiently aware of the potential problem that they will handle/check the conversion explicitly. Better to expect this than to inconvenience many users who use this coercion in far less arcane circumstances.



---

archive/issue_comments_188245.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@sagetrac-tcoffee](#comment%3A4):\n> I think this change will cause many more problems than it solves.\n\nThanks for the comments. I mentioned them in the sage-devel thread where the original discussion took place. Let's move the discussion there.",
    "created_at": "2014-03-18T15:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188245",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@sagetrac-tcoffee](#comment%3A4):
> I think this change will cause many more problems than it solves.

Thanks for the comments. I mentioned them in the sage-devel thread where the original discussion took place. Let's move the discussion there.



---

archive/issue_events_197281.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197281"
}
```



---

archive/issue_events_197282.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197282"
}
```



---

archive/issue_events_197283.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197283"
}
```



---

archive/issue_events_197284.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197284"
}
```



---

archive/issue_comments_188246.json:
```json
{
    "body": "Branch: **[u/dkrenn/remove-coerce-RR-RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/remove-coerce-RR-RIF)**",
    "created_at": "2017-02-04T12:47:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188246",
    "user": "https://github.com/dkrenn"
}
```

Branch: **[u/dkrenn/remove-coerce-RR-RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/remove-coerce-RR-RIF)**



---

archive/issue_comments_188247.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nDoes your branch pass the tests? I tried doing something similar a while ago (see `u/mmezzarobba/wip/coerce_RR_RIF`), but I had to make additional changes, and, more importantly, I concluded that this should wait for #22029 if we don't want comparisons between floating-point numbers and intervals to give very misleading results.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b30ebc322cd9f6ef887a0e2b123b65b98e9fd1c0\">b30ebc3</a></td><td><code>disallow coercions from RR to RIF</code></td></tr></table>\n",
    "created_at": "2017-02-04T13:13:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188247",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:10" align="right">Comment 10</div>

Does your branch pass the tests? I tried doing something similar a while ago (see `u/mmezzarobba/wip/coerce_RR_RIF`), but I had to make additional changes, and, more importantly, I concluded that this should wait for #22029 if we don't want comparisons between floating-point numbers and intervals to give very misleading results.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b30ebc322cd9f6ef887a0e2b123b65b98e9fd1c0">b30ebc3</a></td><td><code>disallow coercions from RR to RIF</code></td></tr></table>




---

archive/issue_comments_188248.json:
```json
{
    "body": "Commit: **[b30ebc3](https://github.com/sagemath/sagetrac-mirror/commit/b30ebc322cd9f6ef887a0e2b123b65b98e9fd1c0)**",
    "created_at": "2017-02-04T13:13:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188248",
    "user": "https://github.com/mezzarobba"
}
```

Commit: **[b30ebc3](https://github.com/sagemath/sagetrac-mirror/commit/b30ebc322cd9f6ef887a0e2b123b65b98e9fd1c0)**



---

archive/issue_comments_188249.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@mezzarobba](#comment%3A10):\n> Does your branch pass the tests? I tried doing something similar a while ago (see `u/mmezzarobba/wip/coerce_RR_RIF`), but I had to make additional changes, and, more importantly, I concluded that this should wait for #22029 if we don't want comparisons between floating-point numbers and intervals to give very misleading results.\n\nI am cleaning up my SageMath-versions and found this partial work. As no branch was attached to this ticket, I've uploaded it. So it will, for sure, need some work.",
    "created_at": "2017-02-04T13:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188249",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@mezzarobba](#comment%3A10):
> Does your branch pass the tests? I tried doing something similar a while ago (see `u/mmezzarobba/wip/coerce_RR_RIF`), but I had to make additional changes, and, more importantly, I concluded that this should wait for #22029 if we don't want comparisons between floating-point numbers and intervals to give very misleading results.

I am cleaning up my SageMath-versions and found this partial work. As no branch was attached to this ticket, I've uploaded it. So it will, for sure, need some work.



---

archive/issue_comments_188250.json:
```json
{
    "body": "Replying to [ticket:15114 mstreng]:\n> For example, one could easily do the following by accident.\n> \n> ```\n>     sage: iv = 1 + 2^(-55) + 0. + RIF(1)\n>     sage: iv.lower(), iv.upper()\n>     (2.00000000000000, 2.00000000000000)\n> ```\n\nWhat's wrong with this? I honestly don't really see a problem with coercion `RR` -> `RIF`.",
    "created_at": "2017-12-16T12:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188250",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:15114 mstreng]:
> For example, one could easily do the following by accident.
> 
> ```
>     sage: iv = 1 + 2^(-55) + 0. + RIF(1)
>     sage: iv.lower(), iv.upper()
>     (2.00000000000000, 2.00000000000000)
> ```

What's wrong with this? I honestly don't really see a problem with coercion `RR` -> `RIF`.



---

archive/issue_comments_188251.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@jdemeyer](#comment%3A12):\n> Replying to [ticket:15114 mstreng]:\n> > For example, one could easily do the following by accident.\n> > \n> > ```\n> >     sage: iv = 1 + 2^(-55) + 0. + RIF(1)\n> >     sage: iv.lower(), iv.upper()\n> >     (2.00000000000000, 2.00000000000000)\n> > ```\n\n> \n> What's wrong with this? I honestly don't really see a problem with coercion `RR` -> `RIF`.\n\nWith `RIF` you always have guaranteed results, with `RR` you do not. `RIF` should be as safe as possible to ensure that you actually have proven results. Just compare\n\n```\nsage: r1 = RIF(1/3) + (2.0).cos()\nsage: r2 = RIF(1/3) + RIF(2).cos()\nsage: r1.endpoints()\n(-0.0828135032138091, -0.0828135032138090)\nsage: r2.endpoints()\n(-0.0828135032138091, -0.0828135032138089)\n```\n\nFor me it is similar to the way coercions are implemented between `RealField`. It goes from more precision to less precision so that you have no artificial big precision in your result.\n\nIn conclusion: if any coercion, it should be the other way around (by taking the center).",
    "created_at": "2017-12-16T13:28:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188251",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@jdemeyer](#comment%3A12):
> Replying to [ticket:15114 mstreng]:
> > For example, one could easily do the following by accident.
> > 
> > ```
> >     sage: iv = 1 + 2^(-55) + 0. + RIF(1)
> >     sage: iv.lower(), iv.upper()
> >     (2.00000000000000, 2.00000000000000)
> > ```

> 
> What's wrong with this? I honestly don't really see a problem with coercion `RR` -> `RIF`.

With `RIF` you always have guaranteed results, with `RR` you do not. `RIF` should be as safe as possible to ensure that you actually have proven results. Just compare

```
sage: r1 = RIF(1/3) + (2.0).cos()
sage: r2 = RIF(1/3) + RIF(2).cos()
sage: r1.endpoints()
(-0.0828135032138091, -0.0828135032138090)
sage: r2.endpoints()
(-0.0828135032138091, -0.0828135032138089)
```

For me it is similar to the way coercions are implemented between `RealField`. It goes from more precision to less precision so that you have no artificial big precision in your result.

In conclusion: if any coercion, it should be the other way around (by taking the center).



---

archive/issue_comments_188252.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nI think a lot depends on how you model mathematically elements of interval fields. There are two ways to interpret them: either as real numbers with some uncertainty or actually as intervals of real numbers.\n\nIn the \"interval\" model, the coercion RR -> RIF makes sense: you identify a real number with a singleton, which is a special case of an interval. On the other hand, the \"choose the middle point map\" RIF -> RR is neither natural (the middle point is an arbitrary choice) nor a morphism, which are two requirements for a coercion.\n\nIn the \"real number with uncertainty\" model, you could see RIF -> RR as the forgetful map which keeps the real number but forgets about the uncertainty. In that case, this map is more natural than the opposite.\n\nFor me, it is pretty clear that MPFI is really meant to model intervals while arb models real numbers with uncertainty.",
    "created_at": "2017-12-16T22:08:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188252",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">Comment 14</div>

I think a lot depends on how you model mathematically elements of interval fields. There are two ways to interpret them: either as real numbers with some uncertainty or actually as intervals of real numbers.

In the "interval" model, the coercion RR -> RIF makes sense: you identify a real number with a singleton, which is a special case of an interval. On the other hand, the "choose the middle point map" RIF -> RR is neither natural (the middle point is an arbitrary choice) nor a morphism, which are two requirements for a coercion.

In the "real number with uncertainty" model, you could see RIF -> RR as the forgetful map which keeps the real number but forgets about the uncertainty. In that case, this map is more natural than the opposite.

For me, it is pretty clear that MPFI is really meant to model intervals while arb models real numbers with uncertainty.



---

archive/issue_comments_188253.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@jdemeyer](#comment%3A14):\n> For me, it is pretty clear that MPFI is really meant to model intervals\n\nI sort of agree, but still, the key property is that operations on MPFI intervals return over-approximations of the set of possible results (in particular, they round the endpoints of the results in the correct direction), and having a coercion from plain floating-point numbers would effectively break that.\n\nWhat would make sense to me if you want \u201dintervals of real numbers\u201d with a coercion from the corresponding real numbers themselves would be a separate parent `Intervals(R)` explicitly parametrized by the parent `R` = `RR`, `QQ`, `SR`... where the endpoints live.",
    "created_at": "2017-12-17T09:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188253",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@jdemeyer](#comment%3A14):
> For me, it is pretty clear that MPFI is really meant to model intervals

I sort of agree, but still, the key property is that operations on MPFI intervals return over-approximations of the set of possible results (in particular, they round the endpoints of the results in the correct direction), and having a coercion from plain floating-point numbers would effectively break that.

What would make sense to me if you want ”intervals of real numbers” with a coercion from the corresponding real numbers themselves would be a separate parent `Intervals(R)` explicitly parametrized by the parent `R` = `RR`, `QQ`, `SR`... where the endpoints live.



---

archive/issue_comments_188254.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@mezzarobba](#comment%3A15):\n> What would make sense to me if you want \u201dintervals of real numbers\u201d\n\n`RealIntervalField` is exactly that for `RR`\n\n> with a coercion from the corresponding real numbers themselves\n\nSo, is this an argument in favor of the coercion `RR` -> `RIF`?",
    "created_at": "2017-12-17T18:04:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188254",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@mezzarobba](#comment%3A15):
> What would make sense to me if you want ”intervals of real numbers”

`RealIntervalField` is exactly that for `RR`

> with a coercion from the corresponding real numbers themselves

So, is this an argument in favor of the coercion `RR` -> `RIF`?



---

archive/issue_comments_188255.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@jdemeyer](#comment%3A16):\n> Replying to [@mezzarobba](#comment%3A15):\n> > What would make sense to me if you want \u201dintervals of real numbers\u201d\n\n> \n> `RealIntervalField` is exactly that for `RR`\n\nNo: operations in `RIF` round the upper bound of their result up and the lower bound down. They don't just defer to operations in `RR`.\n\n> > with a coercion from the corresponding real numbers themselves\n\n> \n> So, is this an argument in favor of the coercion `RR` -> `RIF`?\n\nCertainly not.",
    "created_at": "2017-12-17T19:54:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188255",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@jdemeyer](#comment%3A16):
> Replying to [@mezzarobba](#comment%3A15):
> > What would make sense to me if you want ”intervals of real numbers”

> 
> `RealIntervalField` is exactly that for `RR`

No: operations in `RIF` round the upper bound of their result up and the lower bound down. They don't just defer to operations in `RR`.

> > with a coercion from the corresponding real numbers themselves

> 
> So, is this an argument in favor of the coercion `RR` -> `RIF`?

Certainly not.



---

archive/issue_comments_188256.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@mezzarobba](#comment%3A17):\n> Replying to [@jdemeyer](#comment%3A16):\n> > Replying to [@mezzarobba](#comment%3A15):\n> > > What would make sense to me if you want \u201dintervals of real numbers\u201d\n\n> > \n> > `RealIntervalField` is exactly that for `RR`\n\n> \n> No: operations in `RIF` round the upper bound of their result up and the lower bound down.\n\nYes, obviously because that's the right thing to do.\n\n> They don't just defer to operations in `RR`.\n\nTechnically not, but that is just an implementation detail. `RIF` is the set of intervals over `RR`. Whether it's implemented by operations in `RR` or by a separate library (MPFI in this case) doesn't really matter.",
    "created_at": "2017-12-17T19:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188256",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@mezzarobba](#comment%3A17):
> Replying to [@jdemeyer](#comment%3A16):
> > Replying to [@mezzarobba](#comment%3A15):
> > > What would make sense to me if you want ”intervals of real numbers”

> > 
> > `RealIntervalField` is exactly that for `RR`

> 
> No: operations in `RIF` round the upper bound of their result up and the lower bound down.

Yes, obviously because that's the right thing to do.

> They don't just defer to operations in `RR`.

Technically not, but that is just an implementation detail. `RIF` is the set of intervals over `RR`. Whether it's implemented by operations in `RR` or by a separate library (MPFI in this case) doesn't really matter.



---

archive/issue_comments_188257.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@videlec](#comment%3A13):\n> > What's wrong with this? I honestly don't really see a problem with coercion `RR` -> `RIF`.\n\n> \n> With `RIF` you always have guaranteed results, with `RR` you do not. `RIF` should be as safe as possible to ensure that you actually have proven results. [...]\n> For me it is similar to the way coercions are implemented between `RealField`. It goes from more precision to less precision so that you have no artificial big precision in your result.\n> \n> In conclusion: if any coercion, it should be the other way around (by taking the center).\n\nHuge +1. (Having **reliable** numerical computations is a (the) major application of interval arithmetic.)",
    "created_at": "2017-12-18T15:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188257",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@videlec](#comment%3A13):
> > What's wrong with this? I honestly don't really see a problem with coercion `RR` -> `RIF`.

> 
> With `RIF` you always have guaranteed results, with `RR` you do not. `RIF` should be as safe as possible to ensure that you actually have proven results. [...]
> For me it is similar to the way coercions are implemented between `RealField`. It goes from more precision to less precision so that you have no artificial big precision in your result.
> 
> In conclusion: if any coercion, it should be the other way around (by taking the center).

Huge +1. (Having **reliable** numerical computations is a (the) major application of interval arithmetic.)



---

archive/issue_comments_188258.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@jdemeyer](#comment%3A14):\n> For me, it is pretty clear that MPFI is really meant to model intervals\n\nIt is not to me. I found [various](https://members.loria.fr/PZimmermann/IEEE1788-MPFI.pdf)  [texts](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.78.9885&rep=rep1&type=pdf) (by MPFI developers) that motivate why MPFI exists and they all start by saying things about \"guaranteeing results\" and \"certified enclosures\" for floating point real arithmetic. And if an automatic silent coercion mixes a guaranteed result with a non-guaranteed result, this is bad.\n\nPeople prove theorems using `RealIntervalField` as \"real numbers that are guaranteed to be in a certain interval\", and I would personally trust such theorems much less if they use software that allows automatic accidental coercions from RR to RIF. The reason: a mistake or bug could introduce a (non-guaranteed-correct) element of RR and the coercion will silently add it to your RIF element, which now could have an incorrect error bound.\n\nI did not know that people also use the outward-rounding RIF for \"arithmetic with intervals\" without caring about guaranteed inclusion. I understand that for them it is convenient that the following works:\n\n```\nsage: I = RIF(pi, 2*pi)\nsage: p = RR(pi)\nsage: I + p\n1.?e1\n```\nto get the interval [5, 8]. However, it is hardly any extra work to do the direct thing that the coercion model currently does for you, which is:\n\n```\nsage: I + RIF(p)\n1.?e1\n```\nAnd we can also implement additional functions, e.g.\n\n```\nsage: I.translate(p)\nsage: I.add(p)\n```\n\nSo I am very much in favour of removing automatic coercions between RR and RIF. Perhaps with a `DeprecationWarning` if possible.",
    "created_at": "2017-12-18T15:27:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188258",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@jdemeyer](#comment%3A14):
> For me, it is pretty clear that MPFI is really meant to model intervals

It is not to me. I found [various](https://members.loria.fr/PZimmermann/IEEE1788-MPFI.pdf)  [texts](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.78.9885&rep=rep1&type=pdf) (by MPFI developers) that motivate why MPFI exists and they all start by saying things about "guaranteeing results" and "certified enclosures" for floating point real arithmetic. And if an automatic silent coercion mixes a guaranteed result with a non-guaranteed result, this is bad.

People prove theorems using `RealIntervalField` as "real numbers that are guaranteed to be in a certain interval", and I would personally trust such theorems much less if they use software that allows automatic accidental coercions from RR to RIF. The reason: a mistake or bug could introduce a (non-guaranteed-correct) element of RR and the coercion will silently add it to your RIF element, which now could have an incorrect error bound.

I did not know that people also use the outward-rounding RIF for "arithmetic with intervals" without caring about guaranteed inclusion. I understand that for them it is convenient that the following works:

```
sage: I = RIF(pi, 2*pi)
sage: p = RR(pi)
sage: I + p
1.?e1
```
to get the interval [5, 8]. However, it is hardly any extra work to do the direct thing that the coercion model currently does for you, which is:

```
sage: I + RIF(p)
1.?e1
```
And we can also implement additional functions, e.g.

```
sage: I.translate(p)
sage: I.add(p)
```

So I am very much in favour of removing automatic coercions between RR and RIF. Perhaps with a `DeprecationWarning` if possible.



---

archive/issue_comments_188259.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@mstreng](#comment%3A21):\n> So I am very much in favour of removing automatic coercions between RR and RIF. Perhaps with a `DeprecationWarning` if possible.\n\nIf it is considered a bug, then no deprecation is needed...",
    "created_at": "2017-12-18T15:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188259",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@mstreng](#comment%3A21):
> So I am very much in favour of removing automatic coercions between RR and RIF. Perhaps with a `DeprecationWarning` if possible.

If it is considered a bug, then no deprecation is needed...



---

archive/issue_comments_188260.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nThe problem with this ticket is that various places in Sage use this coercion. In particular `QQbar`:\n\n```\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field.py\", line 1513, in sage.rings.number_field.number_field.NumberField_generic.construction\nFailed example:\n    K.<a> = NumberField(x^3-5,embedding=0)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 517, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 920, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.number_field.number_field.NumberField_generic.construction[14]>\", line 1, in <module>\n        K = NumberField(x**Integer(3)-Integer(5),embedding=Integer(0), names=('a',)); (a,) = K._first_ngens(1)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py\", line 529, in NumberField\n        return NumberField_version2(polynomial=polynomial, name=name, check=check, embedding=embedding, latex_name=latex_name, assume_disc_small=assume_disc_small, maximize_at_primes=maximize_at_primes, structure=structure)\n      File \"sage/structure/factory.pyx\", line 364, in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:1964)\n        return self.get_object(version, key, kwds)\n      File \"sage/structure/factory.pyx\", line 403, in sage.structure.factory.UniqueFactory.get_object (build/cythonized/sage/structure/factory.c:2197)\n        cache_key = _cache_key(cache_key)\n      File \"sage/misc/cachefunc.pyx\", line 642, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3189)\n        o = cache_key_unhashable(o)\n      File \"sage/misc/cachefunc.pyx\", line 651, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3503)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 651, in genexpr (build/cythonized/sage/misc/cachefunc.c:3398)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 642, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3189)\n        o = cache_key_unhashable(o)\n      File \"sage/misc/cachefunc.pyx\", line 651, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3503)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 651, in genexpr (build/cythonized/sage/misc/cachefunc.c:3398)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 642, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3189)\n        o = cache_key_unhashable(o)\n      File \"sage/misc/cachefunc.pyx\", line 653, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3558)\n        k = o._cache_key()\n      File \"sage/structure/element.pyx\", line 1059, in sage.structure.element.Element._cache_key (build/cythonized/sage/structure/element.c:9948)\n        return(self.parent(),str(self))\n      File \"sage/structure/sage_object.pyx\", line 237, in sage.structure.sage_object.SageObject.__repr__ (build/cythonized/sage/structure/sage_object.c:2778)\n        result = repr_func()\n      File \"sage/rings/real_lazy.pyx\", line 748, in sage.rings.real_lazy.LazyFieldElement._repr_ (build/cythonized/sage/rings/real_lazy.c:9768)\n        return str(self.approx())\n      File \"sage/rings/real_lazy.pyx\", line 772, in sage.rings.real_lazy.LazyFieldElement.approx (build/cythonized/sage/rings/real_lazy.c:9863)\n        return self.eval(self._parent.interval_field())\n      File \"sage/rings/real_lazy.pyx\", line 1640, in sage.rings.real_lazy.LazyAlgebraic.eval (build/cythonized/sage/rings/real_lazy.c:18796)\n        roots = self._poly.roots(ring = AA if isinstance(self._parent, RealLazyField_class) else QQbar)\n      File \"sage/rings/polynomial/polynomial_element.pyx\", line 7540, in sage.rings.polynomial.polynomial_element.Polynomial.roots (build/cythonized/sage/rings/polynomial/polynomial_element.c:68834)\n        rts = real_roots(self, retval='algebraic_real')\n      File \"sage/rings/polynomial/real_roots.pyx\", line 4155, in sage.rings.polynomial.real_roots.real_roots (build/cythonized/sage/rings/polynomial/real_roots.c:49563)\n        return [(AA.polynomial_root(r[1], r[0]), r[2]) for r in intv_roots]\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 997, in polynomial_root\n        return AlgebraicReal(ANRoot(poly, interval, multiplicity))\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 5830, in __init__\n        self._interval = self.refine_interval(interval, 64)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 5992, in refine_interval\n        return self._real_refine_interval(interval, prec)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 6096, in _real_refine_interval\n        new_range = uinfo['endpoint'] - uinfo['value'] / slope\n      File \"sage/structure/element.pyx\", line 1369, in sage.structure.element.Element.__sub__ (build/cythonized/sage/structure/element.c:11538)\n        return coercion_model.bin_op(left, right, sub)\n      File \"sage/structure/coerce.pyx\", line 1133, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:10655)\n        raise bin_op_exception(op, x, y)\n    TypeError: unsupported operand parent(s) for -: 'Real Field with 64 bits of precision and rounding RNDU' and 'Real Interval Field with 64 bits of precision'\n```",
    "created_at": "2017-12-19T12:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188260",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">Comment 24</div>

The problem with this ticket is that various places in Sage use this coercion. In particular `QQbar`:

```
**********************************************************************
File "src/sage/rings/number_field/number_field.py", line 1513, in sage.rings.number_field.number_field.NumberField_generic.construction
Failed example:
    K.<a> = NumberField(x^3-5,embedding=0)
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 517, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 920, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.number_field.number_field.NumberField_generic.construction[14]>", line 1, in <module>
        K = NumberField(x**Integer(3)-Integer(5),embedding=Integer(0), names=('a',)); (a,) = K._first_ngens(1)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py", line 529, in NumberField
        return NumberField_version2(polynomial=polynomial, name=name, check=check, embedding=embedding, latex_name=latex_name, assume_disc_small=assume_disc_small, maximize_at_primes=maximize_at_primes, structure=structure)
      File "sage/structure/factory.pyx", line 364, in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:1964)
        return self.get_object(version, key, kwds)
      File "sage/structure/factory.pyx", line 403, in sage.structure.factory.UniqueFactory.get_object (build/cythonized/sage/structure/factory.c:2197)
        cache_key = _cache_key(cache_key)
      File "sage/misc/cachefunc.pyx", line 642, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3189)
        o = cache_key_unhashable(o)
      File "sage/misc/cachefunc.pyx", line 651, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3503)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 651, in genexpr (build/cythonized/sage/misc/cachefunc.c:3398)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 642, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3189)
        o = cache_key_unhashable(o)
      File "sage/misc/cachefunc.pyx", line 651, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3503)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 651, in genexpr (build/cythonized/sage/misc/cachefunc.c:3398)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 642, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3189)
        o = cache_key_unhashable(o)
      File "sage/misc/cachefunc.pyx", line 653, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3558)
        k = o._cache_key()
      File "sage/structure/element.pyx", line 1059, in sage.structure.element.Element._cache_key (build/cythonized/sage/structure/element.c:9948)
        return(self.parent(),str(self))
      File "sage/structure/sage_object.pyx", line 237, in sage.structure.sage_object.SageObject.__repr__ (build/cythonized/sage/structure/sage_object.c:2778)
        result = repr_func()
      File "sage/rings/real_lazy.pyx", line 748, in sage.rings.real_lazy.LazyFieldElement._repr_ (build/cythonized/sage/rings/real_lazy.c:9768)
        return str(self.approx())
      File "sage/rings/real_lazy.pyx", line 772, in sage.rings.real_lazy.LazyFieldElement.approx (build/cythonized/sage/rings/real_lazy.c:9863)
        return self.eval(self._parent.interval_field())
      File "sage/rings/real_lazy.pyx", line 1640, in sage.rings.real_lazy.LazyAlgebraic.eval (build/cythonized/sage/rings/real_lazy.c:18796)
        roots = self._poly.roots(ring = AA if isinstance(self._parent, RealLazyField_class) else QQbar)
      File "sage/rings/polynomial/polynomial_element.pyx", line 7540, in sage.rings.polynomial.polynomial_element.Polynomial.roots (build/cythonized/sage/rings/polynomial/polynomial_element.c:68834)
        rts = real_roots(self, retval='algebraic_real')
      File "sage/rings/polynomial/real_roots.pyx", line 4155, in sage.rings.polynomial.real_roots.real_roots (build/cythonized/sage/rings/polynomial/real_roots.c:49563)
        return [(AA.polynomial_root(r[1], r[0]), r[2]) for r in intv_roots]
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 997, in polynomial_root
        return AlgebraicReal(ANRoot(poly, interval, multiplicity))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 5830, in __init__
        self._interval = self.refine_interval(interval, 64)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 5992, in refine_interval
        return self._real_refine_interval(interval, prec)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 6096, in _real_refine_interval
        new_range = uinfo['endpoint'] - uinfo['value'] / slope
      File "sage/structure/element.pyx", line 1369, in sage.structure.element.Element.__sub__ (build/cythonized/sage/structure/element.c:11538)
        return coercion_model.bin_op(left, right, sub)
      File "sage/structure/coerce.pyx", line 1133, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:10655)
        raise bin_op_exception(op, x, y)
    TypeError: unsupported operand parent(s) for -: 'Real Field with 64 bits of precision and rounding RNDU' and 'Real Interval Field with 64 bits of precision'
```



---

archive/issue_comments_188261.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nReplying to [@dkrenn](#comment%3A22):\n> If it is considered a bug, then no deprecation is needed...\n\nIt's documented behaviour so it's maybe a [misfeature](http://catb.org/jargon/html/M/misfeature.html) but not a bug.\n\nAnyway, it seems that most people think that the coercion `RR` -> `RIF` is a misfeature, so I'm willing to remove it in #24371. However, I don't want to deal with the fall-out so if somebody wants to fix [comment:24], please go ahead. It's hard to tell if that's the only issue because that one issue in `QQbar` causes so many doctest failures.",
    "created_at": "2017-12-19T12:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188261",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">Comment 25</div>

Replying to [@dkrenn](#comment%3A22):
> If it is considered a bug, then no deprecation is needed...

It's documented behaviour so it's maybe a [misfeature](http://catb.org/jargon/html/M/misfeature.html) but not a bug.

Anyway, it seems that most people think that the coercion `RR` -> `RIF` is a misfeature, so I'm willing to remove it in #24371. However, I don't want to deal with the fall-out so if somebody wants to fix [comment:24], please go ahead. It's hard to tell if that's the only issue because that one issue in `QQbar` causes so many doctest failures.



---

archive/issue_comments_188262.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nTo everybody who is supporting this ticket: please be aware that fixing it will lead to issues like #24410 for `RIF` too.",
    "created_at": "2017-12-21T10:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188262",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">Comment 26</div>

To everybody who is supporting this ticket: please be aware that fixing it will lead to issues like #24410 for `RIF` too.



---

archive/issue_comments_188263.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@jdemeyer](#comment%3A26):\n> To everybody who is supporting this ticket: please be aware that fixing it will lead to issues like #24410 for `RIF` too.\n\nObtaining a `TypeError` for comparison between `RR` and `RIF` is perfectly acceptable to me (but somehow annoying).",
    "created_at": "2017-12-21T10:58:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188263",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@jdemeyer](#comment%3A26):
> To everybody who is supporting this ticket: please be aware that fixing it will lead to issues like #24410 for `RIF` too.

Obtaining a `TypeError` for comparison between `RR` and `RIF` is perfectly acceptable to me (but somehow annoying).



---

archive/issue_comments_188264.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nReplying to [@jdemeyer](#comment%3A26):\n> To everybody who is supporting this ticket: please be aware that fixing it will lead to issues like #24410 for `RIF` too.\n\nThat what [comment #10](#comment%3A10) above is about.",
    "created_at": "2017-12-21T12:45:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188264",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:28" align="right">Comment 28</div>

Replying to [@jdemeyer](#comment%3A26):
> To everybody who is supporting this ticket: please be aware that fixing it will lead to issues like #24410 for `RIF` too.

That what [comment #10](#comment%3A10) above is about.



---

archive/issue_comments_188265.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nJeroen: This is the ticket I was talking about at breakfast. I agree that there is an argument for keeping the coercion in place, but I think the cons outweigh the pros, and most people seem to agree. Also, I seem to remember that #21991 and perhaps a couple of other tickets were going to depend on this one, but I don't remember the details.",
    "created_at": "2019-02-13T09:02:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188265",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:29" align="right">Comment 29</div>

Jeroen: This is the ticket I was talking about at breakfast. I agree that there is an argument for keeping the coercion in place, but I think the cons outweigh the pros, and most people seem to agree. Also, I seem to remember that #21991 and perhaps a couple of other tickets were going to depend on this one, but I don't remember the details.



---

archive/issue_comments_188266.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nI don't immediately see how this is related to #22029.",
    "created_at": "2019-02-13T09:03:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188266",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">Comment 30</div>

I don't immediately see how this is related to #22029.



---

archive/issue_comments_188267.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nThe link is not immediate. What happens is that\n* before #22029, \u201cinterval < float\u201d comparisons gave reasonable (though possibly non-rigorous) results thanks to the coercion that this ticket wants to remove,\n* with the coercion removed but without #22029, they would silently return nonsense (compare by id),\n* they can now (correctly, I'd argue) throw an error if we remove the coercion.",
    "created_at": "2019-02-13T10:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188267",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:31" align="right">Comment 31</div>

The link is not immediate. What happens is that
* before #22029, “interval < float” comparisons gave reasonable (though possibly non-rigorous) results thanks to the coercion that this ticket wants to remove,
* with the coercion removed but without #22029, they would silently return nonsense (compare by id),
* they can now (correctly, I'd argue) throw an error if we remove the coercion.



---

archive/issue_comments_188268.json:
```json
{
    "body": "Changed commit from **[b30ebc3](https://github.com/sagemath/sagetrac-mirror/commit/b30ebc322cd9f6ef887a0e2b123b65b98e9fd1c0)** to **[d2e93d7](https://github.com/sagemath/sagetrac-mirror/commit/d2e93d76e816c22f85684bca4b161610f37db4f3)**",
    "created_at": "2020-11-26T09:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188268",
    "user": "https://github.com/mezzarobba"
}
```

Changed commit from **[b30ebc3](https://github.com/sagemath/sagetrac-mirror/commit/b30ebc322cd9f6ef887a0e2b123b65b98e9fd1c0)** to **[d2e93d7](https://github.com/sagemath/sagetrac-mirror/commit/d2e93d76e816c22f85684bca4b161610f37db4f3)**



---

archive/issue_events_197285.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-26T09:52:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197285"
}
```



---

archive/issue_events_197286.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-26T09:52:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197286"
}
```



---

archive/issue_comments_188269.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n Remove the following coercions because they make interval arithmetic much less trustworthy.\n-* `RR` --> `RIF`\n-* `CC` --> `CIF`\n * `RealField` --> `RealIntervalField`\n-* `ComplexField` --> `ComplexIntervalField`\n+* `float` --> `ComplexIntervalField`\n+* `SR` --> `ComplexIntervalField`\n \n For example, one could easily do the following by accident.\n \n@@ -13,3 +12,6 @@\n ```\n \n See also [this topic on sage-devel](https://groups.google.com/forum/#!topic/sage-devel/zfg0PhFR_qA)\n+\n+Already removed in other tickets:\n+* `ComplexField` --> `ComplexIntervalField`\n``````\n",
    "created_at": "2020-11-26T09:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188269",
    "user": "https://github.com/mezzarobba"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
 Remove the following coercions because they make interval arithmetic much less trustworthy.
-* `RR` --> `RIF`
-* `CC` --> `CIF`
 * `RealField` --> `RealIntervalField`
-* `ComplexField` --> `ComplexIntervalField`
+* `float` --> `ComplexIntervalField`
+* `SR` --> `ComplexIntervalField`
 
 For example, one could easily do the following by accident.
 
@@ -13,3 +12,6 @@
 ```
 
 See also [this topic on sage-devel](https://groups.google.com/forum/#!topic/sage-devel/zfg0PhFR_qA)
+
+Already removed in other tickets:
+* `ComplexField` --> `ComplexIntervalField`
``````




---

archive/issue_events_197287.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-26T09:52:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "title_is": "disallow dangerous coercions to RIF",
    "title_was": "disallow coercions from RR to RIF",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197287"
}
```



---

archive/issue_comments_188270.json:
```json
{
    "body": "Changed branch from **[u/dkrenn/remove-coerce-RR-RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/remove-coerce-RR-RIF)** to **[u/mmezzarobba/15114_RR_to_RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/15114_RR_to_RIF)**",
    "created_at": "2020-11-26T09:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188270",
    "user": "https://github.com/mezzarobba"
}
```

Changed branch from **[u/dkrenn/remove-coerce-RR-RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/remove-coerce-RR-RIF)** to **[u/mmezzarobba/15114_RR_to_RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/15114_RR_to_RIF)**



---

archive/issue_comments_188271.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e587b14bb1ea7c7be3ec2f55b2706e02b2274776\">e587b14</a></td><td><code>#15114 remove coercions from RealField(n), RDF to RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a91e43c958a159a036a61d8c5157836d468829a4\">a91e43c</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb9663be474151afeaa181275fb3631f8b8f3375\">bb9663b</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb7e794f31d2e6dc99b7532733cc7b6c0b1d580a\">cb7e794</a></td><td><code>#15114 binary_form_reduce(): avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df6373acd786617e4ab79996d410669234b7c266\">df6373a</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR \u2192 RIF coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5488ace06ddc49f0dce3926f27e61f1891aaeb3\">a5488ac</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e93d76e816c22f85684bca4b161610f37db4f3\">d2e93d7</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>\n",
    "created_at": "2020-11-26T09:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188271",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:32" align="right">Comment 32</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e587b14bb1ea7c7be3ec2f55b2706e02b2274776">e587b14</a></td><td><code>#15114 remove coercions from RealField(n), RDF to RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a91e43c958a159a036a61d8c5157836d468829a4">a91e43c</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb9663be474151afeaa181275fb3631f8b8f3375">bb9663b</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb7e794f31d2e6dc99b7532733cc7b6c0b1d580a">cb7e794</a></td><td><code>#15114 binary_form_reduce(): avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df6373acd786617e4ab79996d410669234b7c266">df6373a</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR → RIF coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5488ace06ddc49f0dce3926f27e61f1891aaeb3">a5488ac</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e93d76e816c22f85684bca4b161610f37db4f3">d2e93d7</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>




---

archive/issue_comments_188272.json:
```json
{
    "body": "Changed commit from **[d2e93d7](https://github.com/sagemath/sagetrac-mirror/commit/d2e93d76e816c22f85684bca4b161610f37db4f3)** to **[0aab184](https://github.com/sagemath/sagetrac-mirror/commit/0aab184224fae9bf51e3f9a5cd6597712d4e977f)**",
    "created_at": "2020-11-26T10:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188272",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d2e93d7](https://github.com/sagemath/sagetrac-mirror/commit/d2e93d76e816c22f85684bca4b161610f37db4f3)** to **[0aab184](https://github.com/sagemath/sagetrac-mirror/commit/0aab184224fae9bf51e3f9a5cd6597712d4e977f)**



---

archive/issue_comments_188273.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b8232c47870adb36e4ee7343430125e8efc4d4b\">6b8232c</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c11b6a25566ed55d7c496a797fb210f744532288\">c11b6a2</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d7107e18c82c419348dd670c53224f8e21fa466\">6d7107e</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f7e3b38ed8f5e39b0fbe1024b35756b13c8a185\">7f7e3b3</a></td><td><code>#15114 binary_form_reduce(): avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d30857baf8274a561d094bd84003027ae6256b9\">9d30857</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR \u2192 RIF coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cdc8d6c336ed4b76a0691044f07f93063f05733\">6cdc8d6</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0aab184224fae9bf51e3f9a5cd6597712d4e977f\">0aab184</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>\n",
    "created_at": "2020-11-26T10:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188273",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33" align="right">Comment 33</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b8232c47870adb36e4ee7343430125e8efc4d4b">6b8232c</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c11b6a25566ed55d7c496a797fb210f744532288">c11b6a2</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d7107e18c82c419348dd670c53224f8e21fa466">6d7107e</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f7e3b38ed8f5e39b0fbe1024b35756b13c8a185">7f7e3b3</a></td><td><code>#15114 binary_form_reduce(): avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d30857baf8274a561d094bd84003027ae6256b9">9d30857</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR → RIF coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cdc8d6c336ed4b76a0691044f07f93063f05733">6cdc8d6</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0aab184224fae9bf51e3f9a5cd6597712d4e977f">0aab184</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>




---

archive/issue_comments_188274.json:
```json
{
    "body": "Changed commit from **[0aab184](https://github.com/sagemath/sagetrac-mirror/commit/0aab184224fae9bf51e3f9a5cd6597712d4e977f)** to **[88e0764](https://github.com/sagemath/sagetrac-mirror/commit/88e07641ede4a45b6983790d3e36cad5fb0d4885)**",
    "created_at": "2020-11-26T10:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188274",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0aab184](https://github.com/sagemath/sagetrac-mirror/commit/0aab184224fae9bf51e3f9a5cd6597712d4e977f)** to **[88e0764](https://github.com/sagemath/sagetrac-mirror/commit/88e07641ede4a45b6983790d3e36cad5fb0d4885)**



---

archive/issue_comments_188275.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b225ec4c81ac48de4c9d73d8bdbb2d3e2719c61f\">b225ec4</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd8ac6cd0c97ce73cacff0a55af467d5d8a27449\">bd8ac6c</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR \u2192 RIF coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab8ebca17ec1094008f99b0fd5c6a8ec41c56681\">ab8ebca</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88e07641ede4a45b6983790d3e36cad5fb0d4885\">88e0764</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>\n",
    "created_at": "2020-11-26T10:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188275",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34" align="right">Comment 34</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b225ec4c81ac48de4c9d73d8bdbb2d3e2719c61f">b225ec4</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd8ac6cd0c97ce73cacff0a55af467d5d8a27449">bd8ac6c</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR → RIF coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab8ebca17ec1094008f99b0fd5c6a8ec41c56681">ab8ebca</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88e07641ede4a45b6983790d3e36cad5fb0d4885">88e0764</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>




---

archive/issue_events_197288.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2020-11-26T10:35:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197288"
}
```



---

archive/issue_comments_188276.json:
```json
{
    "body": "Author: **Marc Mezzarobba**",
    "created_at": "2020-11-26T10:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188276",
    "user": "https://github.com/mezzarobba"
}
```

Author: **Marc Mezzarobba**



---

archive/issue_comments_188277.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nI could not test everything locally due to version issues with pari and giac, so the patchbot may still uncover problems, but this is starting to take shape, and comments are already welcome.\n\n@bhutz: You may want to check the commit touching `binary_form_reduce`. I don't think I broke anything, but the way intervals are used in the parts I had to modify looks a bit strange to me.\n\n@JohnCremona, @pjbruin: Same remark regarding the changes to `elliptic_curves.height`.",
    "created_at": "2020-11-26T10:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188277",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:35" align="right">Comment 35</div>

I could not test everything locally due to version issues with pari and giac, so the patchbot may still uncover problems, but this is starting to take shape, and comments are already welcome.

@bhutz: You may want to check the commit touching `binary_form_reduce`. I don't think I broke anything, but the way intervals are used in the parts I had to modify looks a bit strange to me.

@JohnCremona, @pjbruin: Same remark regarding the changes to `elliptic_curves.height`.



---

archive/issue_comments_188278.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nI see no problems with the minor code changes to elliptic curve heights, though I don't think that any of the affected functions was written by me.",
    "created_at": "2020-11-26T12:08:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188278",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:36" align="right">Comment 36</div>

I see no problems with the minor code changes to elliptic curve heights, though I don't think that any of the affected functions was written by me.



---

archive/issue_comments_188279.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nI don't think I contributed much to this precise code either, but the changes certainly look fine to me.",
    "created_at": "2020-11-26T12:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188279",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:37" align="right">Comment 37</div>

I don't think I contributed much to this precise code either, but the changes certainly look fine to me.



---

archive/issue_comments_188280.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nThank you both for your comments. John: indeed, `git blame` did not tell the whole story. If I understand correctly, you committed the code but it was originally written by Robert Bradshaw.",
    "created_at": "2020-11-26T13:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188280",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:38" align="right">Comment 38</div>

Thank you both for your comments. John: indeed, `git blame` did not tell the whole story. If I understand correctly, you committed the code but it was originally written by Robert Bradshaw.



---

archive/issue_comments_188281.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nReplying to [@mezzarobba](#comment%3A38):\n> Thank you both for your comments. John: indeed, `git blame` did not tell the whole story. If I understand correctly, you committed the code but it was originally written by Robert Bradshaw.\n\nThat agrees with my memory.  heegner.py was from his thesis, I think, and he rewrote the unpleasant complex interval stuff from a script I had in (I think) gp.",
    "created_at": "2020-11-26T14:12:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188281",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:39" align="right">Comment 39</div>

Replying to [@mezzarobba](#comment%3A38):
> Thank you both for your comments. John: indeed, `git blame` did not tell the whole story. If I understand correctly, you committed the code but it was originally written by Robert Bradshaw.

That agrees with my memory.  heegner.py was from his thesis, I think, and he rewrote the unpleasant complex interval stuff from a script I had in (I think) gp.



---

archive/issue_comments_188282.json:
```json
{
    "body": "Changed commit from **[88e0764](https://github.com/sagemath/sagetrac-mirror/commit/88e07641ede4a45b6983790d3e36cad5fb0d4885)** to **[5dcf52c](https://github.com/sagemath/sagetrac-mirror/commit/5dcf52cdfc108339d57a326d1c17a7957e34b170)**",
    "created_at": "2020-11-26T14:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188282",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[88e0764](https://github.com/sagemath/sagetrac-mirror/commit/88e07641ede4a45b6983790d3e36cad5fb0d4885)** to **[5dcf52c](https://github.com/sagemath/sagetrac-mirror/commit/5dcf52cdfc108339d57a326d1c17a7957e34b170)**



---

archive/issue_comments_188283.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c463c84b4dadbc5aff221c3d8a6fe84dc0e2afd\">5c463c8</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccf7e2e8733efeadbbdfec39959385e9b1083c34\">ccf7e2e</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c30773670b054ee81eae9e0890bfd8c4d9905fe6\">c307736</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97a48a237f3db114412ae0272e9a9f3d32b5244d\">97a48a2</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02308be7a8068a0b02c9e64afef48a61bbd9faac\">02308be</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR \u2192 RIF coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e0d6d9647107a9880fe8eae452de7c49f35894d\">7e0d6d9</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dcf52cdfc108339d57a326d1c17a7957e34b170\">5dcf52c</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>\n",
    "created_at": "2020-11-26T14:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188283",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40" align="right">Comment 40</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c463c84b4dadbc5aff221c3d8a6fe84dc0e2afd">5c463c8</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccf7e2e8733efeadbbdfec39959385e9b1083c34">ccf7e2e</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c30773670b054ee81eae9e0890bfd8c4d9905fe6">c307736</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97a48a237f3db114412ae0272e9a9f3d32b5244d">97a48a2</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02308be7a8068a0b02c9e64afef48a61bbd9faac">02308be</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR → RIF coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e0d6d9647107a9880fe8eae452de7c49f35894d">7e0d6d9</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dcf52cdfc108339d57a326d1c17a7957e34b170">5dcf52c</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr></table>




---

archive/issue_comments_188284.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nThe changes in binary_form_reduce.py look fine to me. The use of .lower() and .upper() I expect should have been there in the first place and we've just never come across an example where being that careful with the errors mattered.",
    "created_at": "2020-11-26T20:36:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188284",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:41" align="right">Comment 41</div>

The changes in binary_form_reduce.py look fine to me. The use of .lower() and .upper() I expect should have been there in the first place and we've just never come across an example where being that careful with the errors mattered.



---

archive/issue_comments_188285.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@bhutz](#comment%3A41):\n> The changes in binary_form_reduce.py look fine to me. The use of .lower() and .upper() I expect should have been there in the first place and we've just never come across an example where being that careful with the errors mattered.\n\nThank you.\n\nAll tests pass now, reviewers welcome!",
    "created_at": "2020-11-27T10:21:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188285",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@bhutz](#comment%3A41):
> The changes in binary_form_reduce.py look fine to me. The use of .lower() and .upper() I expect should have been there in the first place and we've just never come across an example where being that careful with the errors mattered.

Thank you.

All tests pass now, reviewers welcome!



---

archive/issue_comments_188286.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nThis is great. I am positively surprised for seeing only few changes for making this happen!\n\nThe only trouble I see is that it might break user code without deprecation notice.",
    "created_at": "2020-11-27T19:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188286",
    "user": "https://github.com/videlec"
}
```

<div id="comment:43" align="right">Comment 43</div>

This is great. I am positively surprised for seeing only few changes for making this happen!

The only trouble I see is that it might break user code without deprecation notice.



---

archive/issue_comments_188287.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nReplying to [@videlec](#comment%3A43):\n> This is great. I am positively surprised for seeing only few changes for making this happen!\n\nThe switch to Python\u00a03 (and, I think, also the change to make `i` an element of \u211a[i] that you recently reviewed) went a long way toward solving the worst issues I found the first time I tried. But it is good news in any case!\n\n> The only trouble I see is that it might break user code without deprecation notice.\n\nI agree. But I don't know what to to to ease the transition. Do you see a way to display a deprecation warning when a coercion map is used while keeping the corresponding conversion map working?\n\nThat being said, between the issues it indirectly causes and the inconsistency with other interval fields, I would almost call the existence of this coercion a bug.",
    "created_at": "2020-11-28T09:08:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188287",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:44" align="right">Comment 44</div>

Replying to [@videlec](#comment%3A43):
> This is great. I am positively surprised for seeing only few changes for making this happen!

The switch to Python 3 (and, I think, also the change to make `i` an element of ℚ[i] that you recently reviewed) went a long way toward solving the worst issues I found the first time I tried. But it is good news in any case!

> The only trouble I see is that it might break user code without deprecation notice.

I agree. But I don't know what to to to ease the transition. Do you see a way to display a deprecation warning when a coercion map is used while keeping the corresponding conversion map working?

That being said, between the issues it indirectly causes and the inconsistency with other interval fields, I would almost call the existence of this coercion a bug.



---

archive/issue_comments_188288.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nReplying to [@mezzarobba](#comment%3A44):\n> Replying to [@videlec](#comment%3A43):\n> > This is great. I am positively surprised for seeing only few changes for making this happen!\n\n> \n> The switch to Python\u00a03 (and, I think, also the change to make `i` an element of \u211a[i] that you recently reviewed) went a long way toward solving the worst issues I found the first time I tried. But it is good news in any case!\n> \n> > The only trouble I see is that it might break user code without deprecation notice.\n\n> \n> I agree. But I don't know what to to to ease the transition. Do you see a way to display a deprecation warning when a coercion map is used while keeping the corresponding conversion map working?\n\nOne possibility would be to support the operations (with a warning) without having the coercions. One cumbersome way to do this is to implement custom `__add__`, `__mul__`, etc\n\n```\nclass Interval:\n    def __add__(self, other):\n        if self is an interval and other a floating point:\n            warn(\"don't do that\")\n            return old_behavior(self, other)\n        else:\n            return Element.__add__(self, other)\n```\nBut I don't see a simple way to do it in order to also handle functorial constructions such as vectors or polynomials. Though, given the changes you had to do in the doctests, I think it makes sense to only consider scalars.\n \n> That being said, between the issues it indirectly causes and the inconsistency with other interval fields, I would almost call the existence of this coercion a bug.\n\nAgreed, but https://xkcd.com/1172/",
    "created_at": "2020-11-28T09:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188288",
    "user": "https://github.com/videlec"
}
```

<div id="comment:45" align="right">Comment 45</div>

Replying to [@mezzarobba](#comment%3A44):
> Replying to [@videlec](#comment%3A43):
> > This is great. I am positively surprised for seeing only few changes for making this happen!

> 
> The switch to Python 3 (and, I think, also the change to make `i` an element of ℚ[i] that you recently reviewed) went a long way toward solving the worst issues I found the first time I tried. But it is good news in any case!
> 
> > The only trouble I see is that it might break user code without deprecation notice.

> 
> I agree. But I don't know what to to to ease the transition. Do you see a way to display a deprecation warning when a coercion map is used while keeping the corresponding conversion map working?

One possibility would be to support the operations (with a warning) without having the coercions. One cumbersome way to do this is to implement custom `__add__`, `__mul__`, etc

```
class Interval:
    def __add__(self, other):
        if self is an interval and other a floating point:
            warn("don't do that")
            return old_behavior(self, other)
        else:
            return Element.__add__(self, other)
```
But I don't see a simple way to do it in order to also handle functorial constructions such as vectors or polynomials. Though, given the changes you had to do in the doctests, I think it makes sense to only consider scalars.
 
> That being said, between the issues it indirectly causes and the inconsistency with other interval fields, I would almost call the existence of this coercion a bug.

Agreed, but https://xkcd.com/1172/



---

archive/issue_comments_188289.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nReplying to [@videlec](#comment%3A45):\n> One possibility would be to support the operations (with a warning) without having the coercions. One cumbersome way to do this is to implement custom `__add__`\n\nUnless we do it for floating-point types too (which would be a bit invasive), it will work for `interval + float` but `float + interval` will still fail.",
    "created_at": "2020-11-28T12:33:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188289",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:46" align="right">Comment 46</div>

Replying to [@videlec](#comment%3A45):
> One possibility would be to support the operations (with a warning) without having the coercions. One cumbersome way to do this is to implement custom `__add__`

Unless we do it for floating-point types too (which would be a bit invasive), it will work for `interval + float` but `float + interval` will still fail.



---

archive/issue_comments_188290.json:
```json
{
    "body": "Changed commit from **[5dcf52c](https://github.com/sagemath/sagetrac-mirror/commit/5dcf52cdfc108339d57a326d1c17a7957e34b170)** to **[ddab847](https://github.com/sagemath/sagetrac-mirror/commit/ddab8474d3a942a18188515eae80175d07ee1c5a)**",
    "created_at": "2020-12-19T18:31:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188290",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5dcf52c](https://github.com/sagemath/sagetrac-mirror/commit/5dcf52cdfc108339d57a326d1c17a7957e34b170)** to **[ddab847](https://github.com/sagemath/sagetrac-mirror/commit/ddab8474d3a942a18188515eae80175d07ee1c5a)**



---

archive/issue_comments_188291.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/315ddc2abef7b9ffb47909d14b29f874058caabd\">315ddc2</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cc998ab5a5079706d9c5494db4701b798f52761\">3cc998a</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a51cfe0eede4e85440245faa2c7cf08335120b72\">a51cfe0</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccd98a70fa027a10cf5d6d700e4a9e9d13fb17d4\">ccd98a7</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca84412938fec11823455a9e71fd3f5b170b5b2d\">ca84412</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR \u2192 RIF coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/584d6e45c873168fffe9db032790e5af62d39106\">584d6e4</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1aabd61e63d1fa7b0694c20f7973a7998ed3322\">e1aabd6</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ddab8474d3a942a18188515eae80175d07ee1c5a\">ddab847</a></td><td><code>#15114 restore basic functionality, with deprecation warnings</code></td></tr></table>\n",
    "created_at": "2020-12-19T18:31:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188291",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47" align="right">Comment 47</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/315ddc2abef7b9ffb47909d14b29f874058caabd">315ddc2</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cc998ab5a5079706d9c5494db4701b798f52761">3cc998a</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a51cfe0eede4e85440245faa2c7cf08335120b72">a51cfe0</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccd98a70fa027a10cf5d6d700e4a9e9d13fb17d4">ccd98a7</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca84412938fec11823455a9e71fd3f5b170b5b2d">ca84412</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR → RIF coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/584d6e45c873168fffe9db032790e5af62d39106">584d6e4</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1aabd61e63d1fa7b0694c20f7973a7998ed3322">e1aabd6</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ddab8474d3a942a18188515eae80175d07ee1c5a">ddab847</a></td><td><code>#15114 restore basic functionality, with deprecation warnings</code></td></tr></table>




---

archive/issue_comments_188292.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nReplying to [@mezzarobba](#comment%3A46):\n> Replying to [@videlec](#comment%3A45):\n> > One possibility would be to support the operations (with a warning) without having the coercions. One cumbersome way to do this is to implement custom `__add__`\n\n> \n> Unless we do it for floating-point types too (which would be a bit invasive), it will work for `interval + float` but `float + interval` will still fail.\n\nOk, for lack of a better option, I have done that\u2014for `RealNumber`s only. It was... painful.",
    "created_at": "2020-12-19T18:32:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188292",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:48" align="right">Comment 48</div>

Replying to [@mezzarobba](#comment%3A46):
> Replying to [@videlec](#comment%3A45):
> > One possibility would be to support the operations (with a warning) without having the coercions. One cumbersome way to do this is to implement custom `__add__`

> 
> Unless we do it for floating-point types too (which would be a bit invasive), it will work for `interval + float` but `float + interval` will still fail.

Ok, for lack of a better option, I have done that—for `RealNumber`s only. It was... painful.



---

archive/issue_comments_188293.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/674b4f7a80780084e45027aeedf3164a96f91902\">674b4f7</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9abccbbe9ab570884c948537d45196787cb37a06\">9abccbb</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3be1c0fe86732b5f136851c4e28e3c918535ad4e\">3be1c0f</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5fce3b68e5ff37f7991f3713b5284b9a327b06e3\">5fce3b6</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee5fd27d80e837c7b25374698d49d8e9d9d745c9\">ee5fd27</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR \u2192 RIF coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba66ce3e023ed6a1507177f218eec033886b6b72\">ba66ce3</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f47f4cedcd4b215764990897a132467f0f8f395\">9f47f4c</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50\">3c7644f</a></td><td><code>#15114 restore basic functionality, with deprecation warnings</code></td></tr></table>\n",
    "created_at": "2021-01-21T16:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188293",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49" align="right">Comment 49</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/674b4f7a80780084e45027aeedf3164a96f91902">674b4f7</a></td><td><code>#15114 remove coercions from RR, RDF, float to RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9abccbbe9ab570884c948537d45196787cb37a06">9abccbb</a></td><td><code>#15114 remove coercions from SR, float to CIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3be1c0fe86732b5f136851c4e28e3c918535ad4e">3be1c0f</a></td><td><code>#15114 force choice of coercion maps from UCF to CC, CIF, ...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5fce3b68e5ff37f7991f3713b5284b9a327b06e3">5fce3b6</a></td><td><code>#15114 binary_form_reduce: avoid mixing intervals and FP numbers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee5fd27d80e837c7b25374698d49d8e9d9d745c9">ee5fd27</a></td><td><code>#15114 fix doctest tolerance parsing after removal of RR → RIF coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba66ce3e023ed6a1507177f218eec033886b6b72">ba66ce3</a></td><td><code>#15114 minor fixes to elliptic_curves code and tests mixing RR with RIF</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f47f4cedcd4b215764990897a132467f0f8f395">9f47f4c</a></td><td><code>#15114 misc small fixes after removal of dangerous coercions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50">3c7644f</a></td><td><code>#15114 restore basic functionality, with deprecation warnings</code></td></tr></table>




---

archive/issue_comments_188294.json:
```json
{
    "body": "Changed commit from **[ddab847](https://github.com/sagemath/sagetrac-mirror/commit/ddab8474d3a942a18188515eae80175d07ee1c5a)** to **[3c7644f](https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50)**",
    "created_at": "2021-01-21T16:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188294",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ddab847](https://github.com/sagemath/sagetrac-mirror/commit/ddab8474d3a942a18188515eae80175d07ee1c5a)** to **[3c7644f](https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50)**



---

archive/issue_comments_188295.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nRebased to fix a merge conflict due to whitespace changes...",
    "created_at": "2021-01-21T16:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188295",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:50" align="right">Comment 50</div>

Rebased to fix a merge conflict due to whitespace changes...



---

archive/issue_comments_188296.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nVincent, do you think you will finish the review, or should I look for someone willing to take over?",
    "created_at": "2021-01-23T17:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188296",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:51" align="right">Comment 51</div>

Vincent, do you think you will finish the review, or should I look for someone willing to take over?



---

archive/issue_comments_188297.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2021-01-28T11:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188297",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_197289.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-01-28T11:41:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197289"
}
```



---

archive/issue_events_197290.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-01-28T11:41:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197290"
}
```



---

archive/issue_comments_188298.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nGreat, thank you!",
    "created_at": "2021-01-28T13:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188298",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:53" align="right">Comment 53</div>

Great, thank you!



---

archive/issue_events_197291.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-02-20T10:46:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197291"
}
```



---

archive/issue_events_197292.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d2cf1d07708f3e62f9053c5d09747bdd676e0eb8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-02-20T10:46:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15114#event-197292"
}
```



---

archive/issue_comments_188299.json:
```json
{
    "body": "Changed branch from **[u/mmezzarobba/15114_RR_to_RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/15114_RR_to_RIF)** to **[3c7644f](https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50)**",
    "created_at": "2021-02-20T10:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15114#issuecomment-188299",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mmezzarobba/15114_RR_to_RIF](https://github.com/sagemath/sagetrac-mirror/tree/u/mmezzarobba/15114_RR_to_RIF)** to **[3c7644f](https://github.com/sagemath/sagetrac-mirror/commit/3c7644f483a64f33159a1632e3b2426436a9cf50)**
