# Issue 15470: reduce() on QQ(x,y) doesn't know how to factor out integers

archive/issues_015233.json:
```json
{
    "body": "\n```\nsage: Qx = PolynomialRing(QQ, 'x,y').fraction_field()\nsage: Qx\nFraction Field of Multivariate Polynomial Ring in x, y over Rational Field\nsage: x,y = Qx.gens()\nsage: s = (2*(x+1)) / (2*(y+2))\ns\nsage: s\n(2*x + 2)/(2*y + 4)\n```\n\nNote, however, that it reduces the integers if the fraction is a constant:\n\n```\nsage: s = (2*(y+2)) / (2*(y+2))\nsage: s\n1\n```\n\nI don't know if it's a bug strictly speaking (the result returned isn't false, and it compares equal with the cancelled version), but it's a major annoyance to me because seeing this behaviour I'm no longer sure if I can trust Sage to cancel out nonconstant polynomials reliably.\n\nThis has been fixed for univariate rational functions as of version 9.5.beta9.\n\nCC:  @williamstein @burcin spancratz jakobkroeker\n\nKeywords: fraction field, rational functions, reduce\n\nStatus: needs_work\n\nIssue created by migration from https://trac.sagemath.org/ticket/15470\n\n",
    "created_at": "2013-11-29T20:31:26Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "reduce() on QQ(x,y) doesn't know how to factor out integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15470",
    "user": "https://github.com/darijgr"
}
```

```
sage: Qx = PolynomialRing(QQ, 'x,y').fraction_field()
sage: Qx
Fraction Field of Multivariate Polynomial Ring in x, y over Rational Field
sage: x,y = Qx.gens()
sage: s = (2*(x+1)) / (2*(y+2))
s
sage: s
(2*x + 2)/(2*y + 4)
```

Note, however, that it reduces the integers if the fraction is a constant:

```
sage: s = (2*(y+2)) / (2*(y+2))
sage: s
1
```

I don't know if it's a bug strictly speaking (the result returned isn't false, and it compares equal with the cancelled version), but it's a major annoyance to me because seeing this behaviour I'm no longer sure if I can trust Sage to cancel out nonconstant polynomials reliably.

This has been fixed for univariate rational functions as of version 9.5.beta9.

CC:  @williamstein @burcin spancratz jakobkroeker

Keywords: fraction field, rational functions, reduce

Status: needs_work

Issue created by migration from https://trac.sagemath.org/ticket/15470





---

archive/issue_comments_251593.json:
```json
{
    "body": "<a id='comment:1'></a>\nI remember somebody once suggesting a `_reduce_projective()` method (or whatever you want to call it) on a ring which would take any tuple `(a_1, ..., a_n)` and return a \"simplified\" tuple `(u a_1, ..., u a_n)` for a suitable invertible element `u`. I think that's how this should be implemented.",
    "created_at": "2013-12-10T08:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15470#issuecomment-251593",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
I remember somebody once suggesting a `_reduce_projective()` method (or whatever you want to call it) on a ring which would take any tuple `(a_1, ..., a_n)` and return a "simplified" tuple `(u a_1, ..., u a_n)` for a suitable invertible element `u`. I think that's how this should be implemented.



---

archive/issue_events_051584.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15470#event-51584"
}
```



---

archive/issue_events_051585.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15470#event-51585"
}
```



---

archive/issue_events_051586.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15470#event-51586"
}
```



---

archive/issue_events_051587.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15470#event-51587"
}
```



---

archive/issue_events_051588.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15470#event-51588"
}
```



---

archive/issue_comments_251594.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis problem does not exist in the version as it stands in the developement branch. \n\nas per my command line: \n\n\n`sage: Qx = PolynomialRing(QQ, 'x').fraction_field()`\n\n`sage: x = Qx.gen()`\n\n`sage: s = (2*x + 2) / (2*x + 4)`\n\n`sage: s`\n\n`(x + 1)/(x + 2)`\n\n\n\nI suppose this ticket can be closed.",
    "created_at": "2022-01-11T17:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15470#issuecomment-251594",
    "user": "https://github.com/shashwat1002"
}
```

<a id='comment:6'></a>
This problem does not exist in the version as it stands in the developement branch. 

as per my command line: 


`sage: Qx = PolynomialRing(QQ, 'x').fraction_field()`

`sage: x = Qx.gen()`

`sage: s = (2*x + 2) / (2*x + 4)`

`sage: s`

`(x + 1)/(x + 2)`



I suppose this ticket can be closed.



---

archive/issue_comments_251595.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-11T17:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15470#issuecomment-251595",
    "user": "https://github.com/shashwat1002"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_251596.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-01-11T17:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15470#issuecomment-251596",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_251597.json:
```json
{
    "body": "<a id='comment:8'></a>\nStill happening in multiple variables...",
    "created_at": "2022-01-11T17:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15470#issuecomment-251597",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:8'></a>
Still happening in multiple variables...



---

archive/issue_comments_251598.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,22 +1,23 @@\n \n ```\n-sage: Qx = PolynomialRing(QQ, 'x').fraction_field()\n-sage: x = Qx.gen()\n-sage: s = (2*(x+1)) / (2*(x+2))\n+sage: Qx = PolynomialRing(QQ, 'x,y').fraction_field()\n+sage: Qx\n+Fraction Field of Multivariate Polynomial Ring in x, y over Rational Field\n+sage: x,y = Qx.gens()\n+sage: s = (2*(x+1)) / (2*(y+2))\n+s\n sage: s\n-(2*x + 2)/(2*x + 4)\n-sage: s.reduce()\n-sage: s\n-(2*x + 2)/(2*x + 4)\n-sage: \n+(2*x + 2)/(2*y + 4)\n ```\n \n-Same behavior for multivariate rational functions. Note, however, that it reduces the integers if the fraction is a constant:\n+Note, however, that it reduces the integers if the fraction is a constant:\n \n ```\n-sage: s = (2*(x+1)) / (2*(x+1))\n+sage: s = (2*(y+2)) / (2*(y+2))\n sage: s\n 1\n ```\n \n I don't know if it's a bug strictly speaking (the result returned isn't false, and it compares equal with the cancelled version), but it's a major annoyance to me because seeing this behaviour I'm no longer sure if I can trust Sage to cancel out nonconstant polynomials reliably.\n+\n+This has been fixed for univariate rational functions as of version 9.5.beta9.\n``````\n",
    "created_at": "2022-01-11T18:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15470#issuecomment-251598",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,22 +1,23 @@
 
 ```
-sage: Qx = PolynomialRing(QQ, 'x').fraction_field()
-sage: x = Qx.gen()
-sage: s = (2*(x+1)) / (2*(x+2))
+sage: Qx = PolynomialRing(QQ, 'x,y').fraction_field()
+sage: Qx
+Fraction Field of Multivariate Polynomial Ring in x, y over Rational Field
+sage: x,y = Qx.gens()
+sage: s = (2*(x+1)) / (2*(y+2))
+s
 sage: s
-(2*x + 2)/(2*x + 4)
-sage: s.reduce()
-sage: s
-(2*x + 2)/(2*x + 4)
-sage: 
+(2*x + 2)/(2*y + 4)
 ```
 
-Same behavior for multivariate rational functions. Note, however, that it reduces the integers if the fraction is a constant:
+Note, however, that it reduces the integers if the fraction is a constant:
 
 ```
-sage: s = (2*(x+1)) / (2*(x+1))
+sage: s = (2*(y+2)) / (2*(y+2))
 sage: s
 1
 ```
 
 I don't know if it's a bug strictly speaking (the result returned isn't false, and it compares equal with the cancelled version), but it's a major annoyance to me because seeing this behaviour I'm no longer sure if I can trust Sage to cancel out nonconstant polynomials reliably.
+
+This has been fixed for univariate rational functions as of version 9.5.beta9.
``````




---

archive/issue_events_051589.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/15470",
    "rename": {
        "from": "reduce() on QQ(x) doesn't know how to factor out integers",
        "to": "reduce() on QQ(x,y) doesn't know how to factor out integers"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15470#event-51589"
}
```
