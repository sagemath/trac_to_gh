# Issue 15174: Permutations and symmetric group algebra: Stopgap for #14885 and noninversions

archive/issues_014937.json:
```json
{
    "assignees": [],
    "body": "This patch does the following:\n\n* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutations is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras depended on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).\n\n* Improve documentation at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor fixes, but constitute most of the size of the patch.\n\n* Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.\n\nApply:\n\n* [attachment: trac_15174-full-qfold.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/1214109b59035ea382521609fb14b577.gz)\n\nDepends on #15170\nDepends on #15309\n\nCC:  @tscrim @sagetrac-sage-combinat @nthiery @hivert @zabrocki @nathanncohen @saliola\n\nKeywords: **permutation, permutation group, symmetric group, sage-combinat**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Darij Grinberg**\n\nMerged: **sage-5.13.beta5**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15174_\n\n",
    "closed_at": "2013-12-05T08:01:38Z",
    "created_at": "2013-09-08T05:04:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20group%20theory"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Permutations and symmetric group algebra: Stopgap for #14885 and noninversions",
    "type": "issue",
    "updated_at": "2013-12-05T08:01:38Z",
    "url": "https://github.com/sagemath/sage/issues/15174",
    "user": "https://github.com/darijgr"
}
```
This patch does the following:

* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutations is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras depended on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).

* Improve documentation at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor fixes, but constitute most of the size of the patch.

* Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.

Apply:

* [attachment: trac_15174-full-qfold.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/1214109b59035ea382521609fb14b577.gz)

Depends on #15170
Depends on #15309

CC:  @tscrim @sagetrac-sage-combinat @nthiery @hivert @zabrocki @nathanncohen @saliola

Keywords: **permutation, permutation group, symmetric group, sage-combinat**

Reviewer: **Travis Scrimshaw**

Author: **Darij Grinberg**

Merged: **sage-5.13.beta5**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/15174_





---

archive/issue_events_216520.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-08T05:04:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216520"
}
```



---

archive/issue_events_216521.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-08T05:04:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216521"
}
```



---

archive/issue_events_216522.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-08T05:04:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216522"
}
```



---

archive/issue_events_216523.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-08T05:04:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216523"
}
```



---

archive/issue_events_216524.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-08T05:04:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
    "label_color": "eeeeee",
    "label_name": "c: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216524"
}
```



---

archive/issue_events_216525.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-08T05:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216525"
}
```



---

archive/issue_comments_186740.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n This patch does the following:\n \n-* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutation is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras dependent on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).\n+* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutations is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras depended on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).\n \n-* Improve doc at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor, but constitude most of the size of the patch.\n+* Improve documentation at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor fixes, but constitute most of the size of the patch.\n \n * Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.\n``````\n",
    "created_at": "2013-09-08T05:07:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186740",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 This patch does the following:
 
-* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutation is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras dependent on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).
+* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutations is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras depended on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).
 
-* Improve doc at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor, but constitude most of the size of the patch.
+* Improve documentation at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor fixes, but constitute most of the size of the patch.
 
 * Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.
``````




---

archive/issue_events_216526.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-09T00:02:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216526"
}
```



---

archive/issue_events_216527.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-09T00:02:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216527"
}
```



---

archive/issue_events_216528.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-09T00:32:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216528"
}
```



---

archive/issue_events_216529.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-09-09T00:32:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216529"
}
```



---

archive/issue_comments_186741.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nNew version up (sorry!). Not planning any further edits until this is reviewed.",
    "created_at": "2013-09-09T00:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186741",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:3" align="right">comment:3</div>

New version up (sorry!). Not planning any further edits until this is reviewed.



---

archive/issue_comments_186742.json:
```json
{
    "body": "Changed dependencies from **#15170** to **#15170, #15309**",
    "created_at": "2013-10-27T15:55:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186742",
    "user": "https://github.com/darijgr"
}
```

Changed dependencies from **#15170** to **#15170, #15309**



---

archive/issue_comments_186743.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nRebased over #15309; added docstring to the (ancient) `pi_ik` function.",
    "created_at": "2013-10-27T15:55:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186743",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:4" align="right">comment:4</div>

Rebased over #15309; added docstring to the (ancient) `pi_ik` function.



---

archive/issue_comments_186744.json:
```json
{
    "body": "Attachment: **[trac_15174-symmetric_group_algebra_again-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-symmetric_group_algebra_again-dg.patch.gz)**\n\nrebased again",
    "created_at": "2013-10-27T15:57:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186744",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_15174-symmetric_group_algebra_again-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-symmetric_group_algebra_again-dg.patch.gz)**

rebased again



---

archive/issue_comments_186745.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,8 @@\n * Improve documentation at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor fixes, but constitute most of the size of the patch.\n \n * Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.\n+\n+Apply:\n+\n+* [attachment: trac_15174-symmetric_group_algebra_again-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)\n+* [attachment: trac_15174-bruhat-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)\n``````\n",
    "created_at": "2013-11-15T06:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186745",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,8 @@
 * Improve documentation at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor fixes, but constitute most of the size of the patch.
 
 * Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.
+
+Apply:
+
+* [attachment: trac_15174-symmetric_group_algebra_again-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)
+* [attachment: trac_15174-bruhat-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)
``````




---

archive/issue_comments_186746.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNew attachment improves the docstrings around the strong Bruhat order (fixing an error and preventing its confusion with the weak Bruhat order) and slightly optimizes the test for Bruhat less-or-equal.\n\nfor the **patchbot**:\n\napply trac_15174-symmetric_group_algebra_again-dg.patch\u200b trac_15174-bruhat-dg.patch\u200b",
    "created_at": "2013-11-15T06:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186746",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:5" align="right">comment:5</div>

New attachment improves the docstrings around the strong Bruhat order (fixing an error and preventing its confusion with the weak Bruhat order) and slightly optimizes the test for Bruhat less-or-equal.

for the **patchbot**:

apply trac_15174-symmetric_group_algebra_again-dg.patchâ€‹ trac_15174-bruhat-dg.patchâ€‹



---

archive/issue_comments_186747.json:
```json
{
    "body": "Attachment: **[trac_15174-bruhat-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-bruhat-dg.patch.gz)**\n\nadditional (mostly doc) improvements",
    "created_at": "2013-11-16T01:11:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186747",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_15174-bruhat-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-bruhat-dg.patch.gz)**

additional (mostly doc) improvements



---

archive/issue_comments_186748.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nMore work done, mostly on the permutohedron order docstrings. I was surprised to learn that \"permutohedron order\" is the French name for the weak order; this answers my question why the weak order isn't in Sage (it is, under this name...).\n\nThe patch is ready for review.",
    "created_at": "2013-11-16T01:13:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186748",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:6" align="right">comment:6</div>

More work done, mostly on the permutohedron order docstrings. I was surprised to learn that "permutohedron order" is the French name for the weak order; this answers my question why the weak order isn't in Sage (it is, under this name...).

The patch is ready for review.



---

archive/issue_comments_186749.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,5 @@\n \n * [attachment: trac_15174-symmetric_group_algebra_again-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)\n * [attachment: trac_15174-bruhat-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)\n+* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)\n+\n``````\n",
    "created_at": "2013-11-19T19:01:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186749",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,5 @@
 
 * [attachment: trac_15174-symmetric_group_algebra_again-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)
 * [attachment: trac_15174-bruhat-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)
+* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)
+
``````




---

archive/issue_comments_186750.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHey Darij,\n\nHere's a review patch which does a few changes and docstring touchups. More specifically:\n\n* I reworked the documentation for `left/right_action_product`,\n* added a `noninversions()` methods, and\n* changed `noninv()` to `number_of_noninversions()` since it is ambiguous (to me).\n\nIf you agree with my changes, you can go ahead and set this to a positive review.\n\nBest,\n\nTravis",
    "created_at": "2013-11-19T19:01:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186750",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

Hey Darij,

Here's a review patch which does a few changes and docstring touchups. More specifically:

* I reworked the documentation for `left/right_action_product`,
* added a `noninversions()` methods, and
* changed `noninv()` to `number_of_noninversions()` since it is ambiguous (to me).

If you agree with my changes, you can go ahead and set this to a positive review.

Best,

Travis



---

archive/issue_comments_186751.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHi Travis,\n\nthanks a lot for reviewing this!\n\nI'm unsure about this:\n\n```\n         This is usually denoted by either ``self * lp`` or ``lp * self``\n         depending on the conventions used by the author. If permutations\n         are to act on numbers from the left in an associative way, the\n-        correct notation for this is ``self * lp``. If permutations are\n-        to act on numbers from the right in an associatve way, the\n-        correct notation for this is ``lp * self``.\n+        correct notation for this is ``self * lp``. If permutations are to\n+        act on positions from the left in an associative way, the correct\n+        notation for this is ``lp * self``.\n```\nWhat do you mean by \"act on positions\"? Something like \"pi sends psi to pi \\circ psi^(-1)\"? But then we would have to add an ^{-1}... IMHO my original docstring was clearer. I don't understand the \"More specifically\" explanation either...\n\nAlso, the docstring of `noninversions` might use an `r\"\"\"`. I'm not near a functioning hg installation right now, or I'd do that myself.\n\n  Best regards,\\\\\n  Darij",
    "created_at": "2013-11-19T19:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186751",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:8" align="right">comment:8</div>

Hi Travis,

thanks a lot for reviewing this!

I'm unsure about this:

```
         This is usually denoted by either ``self * lp`` or ``lp * self``
         depending on the conventions used by the author. If permutations
         are to act on numbers from the left in an associative way, the
-        correct notation for this is ``self * lp``. If permutations are
-        to act on numbers from the right in an associatve way, the
-        correct notation for this is ``lp * self``.
+        correct notation for this is ``self * lp``. If permutations are to
+        act on positions from the left in an associative way, the correct
+        notation for this is ``lp * self``.
```
What do you mean by "act on positions"? Something like "pi sends psi to pi \circ psi^(-1)"? But then we would have to add an ^{-1}... IMHO my original docstring was clearer. I don't understand the "More specifically" explanation either...

Also, the docstring of `noninversions` might use an `r"""`. I'm not near a functioning hg installation right now, or I'd do that myself.

  Best regards,\\
  Darij



---

archive/issue_comments_186752.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nPS. The reason why I killed the \"invalid state\" ValueErrors is that `state` is not a user-defined variable but an output of `_icondition`, and the existing code already handles all possible values it can have. The ValueError would appear only if cosmic radiation corrupted the internal state of the sage process. IMHO that's not something we should actively be testing for at runtime...",
    "created_at": "2013-11-19T19:55:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186752",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:9" align="right">comment:9</div>

PS. The reason why I killed the "invalid state" ValueErrors is that `state` is not a user-defined variable but an output of `_icondition`, and the existing code already handles all possible values it can have. The ValueError would appear only if cosmic radiation corrupted the internal state of the sage process. IMHO that's not something we should actively be testing for at runtime...



---

archive/issue_comments_186753.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nHey Darij,\n\nThere are two ways one permutation can act on another, by position  (or by index) and by value (or by number as you put it). Acting on the right by one is equal to acting on the left by the other and can be seen from the permutation matrix multiplication (see Section 1.4 in Artin's *Algebra* for example). My \"More specifically\" block was trying to explain these two different approaches and could likely use improvement. (I'm used to my permutations acting by position.)\n\nYour docstring ended up confusing me since the name of the method is (for example) `left_action_multiply` and it's talking about left and right actions by number. I think we should do the mantra: \"Here is how we define the left action\". Additionally what I was trying to change was to give justification as to why the other notation would be used and get the same result.\n\nI'll change the docstring of `noninversions` once we settle on the above.\n\nAlso since the \"invalid state\" errors are in an `else:` block, they never get called unless there is an internal error. In other terms, it's not actively testing for anything. I'd be fine changing them to `assert` statements, but that would be a cosmetic change.\n\nBest,\n\nTravis",
    "created_at": "2013-11-19T20:38:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186753",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

Hey Darij,

There are two ways one permutation can act on another, by position  (or by index) and by value (or by number as you put it). Acting on the right by one is equal to acting on the left by the other and can be seen from the permutation matrix multiplication (see Section 1.4 in Artin's *Algebra* for example). My "More specifically" block was trying to explain these two different approaches and could likely use improvement. (I'm used to my permutations acting by position.)

Your docstring ended up confusing me since the name of the method is (for example) `left_action_multiply` and it's talking about left and right actions by number. I think we should do the mantra: "Here is how we define the left action". Additionally what I was trying to change was to give justification as to why the other notation would be used and get the same result.

I'll change the docstring of `noninversions` once we settle on the above.

Also since the "invalid state" errors are in an `else:` block, they never get called unless there is an internal error. In other terms, it's not actively testing for anything. I'd be fine changing them to `assert` statements, but that would be a cosmetic change.

Best,

Travis



---

archive/issue_comments_186754.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI was talking about the action of `S_n` on `[n]`, not about an action-by-multiplication of `S_n` on itself. I'll rewrite the docstring to make this maximally explicit, since I see that what I wrote didn't clear up the confusion particularly well.",
    "created_at": "2013-11-19T23:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186754",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:11" align="right">comment:11</div>

I was talking about the action of `S_n` on `[n]`, not about an action-by-multiplication of `S_n` on itself. I'll rewrite the docstring to make this maximally explicit, since I see that what I wrote didn't clear up the confusion particularly well.



---

archive/issue_comments_186755.json:
```json
{
    "body": "Attachment: **[trac_15174-response-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-response-dg.patch.gz)**\n\nresponse to Travis' review + more edits",
    "created_at": "2013-11-20T03:42:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186755",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_15174-response-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-response-dg.patch.gz)**

response to Travis' review + more edits



---

archive/issue_comments_186756.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2013-11-20T03:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186756",
    "user": "https://github.com/darijgr"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_186757.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHi Travis,\n\nwhat do you think about this? Note that I have removed the \"More specifically\" paragraphs because I couldn't really understand them, but I think I'm as specific as possible now.\n\nI couldn't resist adding a docstring to the Hecke algebra class after noticing that it, too, would break if a nonstandard order of multiplication was chosen (this, too, is fixed now). Sorry for the feature creep! In other news, this patch probably kills all but 2-3 spots in the source where the `mult` global option on `Permutations` is inappropriately used. I'll open further tickets for the rest.\n\nThe change of \"integral\" to \"integers\" is due to the fact that \"integral\" means \"integral over ZZ\" for some people. I was probably over-careful here.\n\nfor the **patchbot**:\n\napply trac_15174-symmetric_group_algebra_again-dg.patch\u200b trac_15174-bruhat-dg.patch\u200b trac_15174-review-ts.patch trac_15174-response-dg.patch\u200b",
    "created_at": "2013-11-20T03:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186757",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:12" align="right">comment:12</div>

Hi Travis,

what do you think about this? Note that I have removed the "More specifically" paragraphs because I couldn't really understand them, but I think I'm as specific as possible now.

I couldn't resist adding a docstring to the Hecke algebra class after noticing that it, too, would break if a nonstandard order of multiplication was chosen (this, too, is fixed now). Sorry for the feature creep! In other news, this patch probably kills all but 2-3 spots in the source where the `mult` global option on `Permutations` is inappropriately used. I'll open further tickets for the rest.

The change of "integral" to "integers" is due to the fact that "integral" means "integral over ZZ" for some people. I was probably over-careful here.

for the **patchbot**:

apply trac_15174-symmetric_group_algebra_again-dg.patchâ€‹ trac_15174-bruhat-dg.patchâ€‹ trac_15174-review-ts.patch trac_15174-response-dg.patchâ€‹



---

archive/issue_comments_186758.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,4 +11,4 @@\n * [attachment: trac_15174-symmetric_group_algebra_again-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)\n * [attachment: trac_15174-bruhat-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)\n * [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)\n-\n+* [attachment: trac_15174-response-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/94b39225d9e68256be6663d6d1a96105.gz)\n``````\n",
    "created_at": "2013-11-20T03:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186758",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,4 +11,4 @@
 * [attachment: trac_15174-symmetric_group_algebra_again-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)
 * [attachment: trac_15174-bruhat-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)
 * [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)
-
+* [attachment: trac_15174-response-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/94b39225d9e68256be6663d6d1a96105.gz)
``````




---

archive/issue_comments_186759.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHey Darij,\n\nAh, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?\n\nAdditionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).\n\nBest,\n\nTravis",
    "created_at": "2013-11-21T15:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186759",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Hey Darij,

Ah, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?

Additionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).

Best,

Travis



---

archive/issue_comments_186760.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nHi Travis,\n\nReplying to [@tscrim](#comment:13):\n> Ah, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?\n\nI didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?\n\n> Additionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).\n\nGood point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)\n\nBest regards,\\\\\nDarij",
    "created_at": "2013-11-21T17:17:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186760",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:14" align="right">comment:14</div>

Hi Travis,

Replying to [@tscrim](#comment:13):
> Ah, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?

I didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?

> Additionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).

Good point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)

Best regards,\\
Darij



---

archive/issue_comments_186761.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nHey Darij,\n\nReplying to [@darijgr](#comment:14):\n> I didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?\n\nSure.\n\n> Good point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)\n\nYes, everything looked good in it. Please fold it all together.\n\nBest,\n\nTravis",
    "created_at": "2013-11-22T02:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186761",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

Hey Darij,

Replying to [@darijgr](#comment:14):
> I didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?

Sure.

> Good point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)

Yes, everything looked good in it. Please fold it all together.

Best,

Travis



---

archive/issue_comments_186762.json:
```json
{
    "body": "Attachment: **[trac_15174-qfold1.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-qfold1.patch.gz)**\n\nqfold of the patches so far; more to come!",
    "created_at": "2013-11-22T03:01:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186762",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_15174-qfold1.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-qfold1.patch.gz)**

qfold of the patches so far; more to come!



---

archive/issue_comments_186763.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,5 @@\n \n Apply:\n \n-* [attachment: trac_15174-symmetric_group_algebra_again-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)\n-* [attachment: trac_15174-bruhat-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)\n-* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)\n-* [attachment: trac_15174-response-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/94b39225d9e68256be6663d6d1a96105.gz)\n+* [attachment: trac_15174-qfold1.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)\n+* [attachment: trac_15174-final-touches-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)\n``````\n",
    "created_at": "2013-11-22T04:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186763",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,5 @@
 
 Apply:
 
-* [attachment: trac_15174-symmetric_group_algebra_again-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/271ebd592304840374d774b404dba0ae.gz)
-* [attachment: trac_15174-bruhat-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/c49179416915f27efe4b29c3f6f7dee4.gz)
-* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)
-* [attachment: trac_15174-response-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/94b39225d9e68256be6663d6d1a96105.gz)
+* [attachment: trac_15174-qfold1.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)
+* [attachment: trac_15174-final-touches-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)
``````




---

archive/issue_comments_186764.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[trac_15174-final-touches-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-final-touches-dg.patch.gz)**\n\nI've tried fixing some of the other places where the global is used, but the work is going overboard: there's way too much to fix in `sage/groups/braid.py`; I don't understand much of `sage/groups/semimonomial_transformations/*`; I don't know the seminormal form well enough for what remains to be done in `sage/combinat/symmetric_group_algebra.py` (this will probably change soon); I have left `sage/combinat/matrices/latin.py` to Nathann in #15439; I had no time left for `sage/graphs/comparability.pyx`, `sage/graphs/generators/intersection.py` and `sage/categories/magmas.py`. This is, I think, a complete list of places where dependence on `mult` should be removed. I'll open up separate tickets for them. Sorry...\n\nTravis, could you perhaps have a look at the last patch I uploaded here and give green (or whatever) light? It's mainly docstrings now. Many thanks again for reviewing this mess.\n\nfor the **patchbot**:\napply trac_15174-qfold1.patch\u200b trac_15174-final-touches-dg.patch\u200b",
    "created_at": "2013-11-22T04:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186764",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[trac_15174-final-touches-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-final-touches-dg.patch.gz)**

I've tried fixing some of the other places where the global is used, but the work is going overboard: there's way too much to fix in `sage/groups/braid.py`; I don't understand much of `sage/groups/semimonomial_transformations/*`; I don't know the seminormal form well enough for what remains to be done in `sage/combinat/symmetric_group_algebra.py` (this will probably change soon); I have left `sage/combinat/matrices/latin.py` to Nathann in #15439; I had no time left for `sage/graphs/comparability.pyx`, `sage/graphs/generators/intersection.py` and `sage/categories/magmas.py`. This is, I think, a complete list of places where dependence on `mult` should be removed. I'll open up separate tickets for them. Sorry...

Travis, could you perhaps have a look at the last patch I uploaded here and give green (or whatever) light? It's mainly docstrings now. Many thanks again for reviewing this mess.

for the **patchbot**:
apply trac_15174-qfold1.patchâ€‹ trac_15174-final-touches-dg.patchâ€‹



---

archive/issue_comments_186765.json:
```json
{
    "body": "Attachment: **[trac_15174-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)**",
    "created_at": "2013-11-23T06:50:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186765",
    "user": "https://github.com/tscrim"
}
```

Attachment: **[trac_15174-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)**



---

archive/issue_comments_186766.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,4 @@\n \n * [attachment: trac_15174-qfold1.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)\n * [attachment: trac_15174-final-touches-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)\n+* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)\n``````\n",
    "created_at": "2013-11-23T06:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186766",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,4 @@
 
 * [attachment: trac_15174-qfold1.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)
 * [attachment: trac_15174-final-touches-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)
+* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)
``````




---

archive/issue_comments_186767.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHey Darij,\n\nHere's the latest little review patch. I'm happy with the patch right now, so if you're happy with my note, then you can set it to positive review.\n\nThanks,\n\nTravis\n\nFor patchbot:\n\nApply: trac_15174-qfold1.patch\u200b, trac_15174-final-touches-dg.patch\u200b, trac_15174-review-ts.patch",
    "created_at": "2013-11-23T06:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186767",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

Hey Darij,

Here's the latest little review patch. I'm happy with the patch right now, so if you're happy with my note, then you can set it to positive review.

Thanks,

Travis

For patchbot:

Apply: trac_15174-qfold1.patchâ€‹, trac_15174-final-touches-dg.patchâ€‹, trac_15174-review-ts.patch



---

archive/issue_comments_186768.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI still don't get your note about products of permutations. Particularly the second paragraph:\n\n```\n \t382\t        In more detail using one-line notation, if we have two permutations \n \t383\t        `p \\cdot q` and multiplying on the right by numbers, then the \n \t384\t        resulting permutation is determined for any fixed `j` by sending \n \t385\t        `p_j = q_i \\mapsto q_{i+1}` for some (unique) `i` where we take the \n \t386\t        indices cyclicly (i.e. `n + 1 \\equiv 1`). If we consider this as \n \t387\t        multiplying on the left by position, we determine the resulting \n \t388\t        permutation by `q_{p_i} \\mapsto q_{p_{i+1}}` over all `i` (again \n \t389\t        taking the indices cyclically).\n```\n\nSorry, but I don't have much of a clue what you mean here :/ What is the `q_i \\mapsto q_{i+1}` thing about? Are your permutations supposed to be cycles written in cycle form?\n\nAlso, \"surpressed\" should be \"suppressed\". The rest of the edits is definitely good.",
    "created_at": "2013-11-23T07:02:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186768",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:18" align="right">comment:18</div>

I still don't get your note about products of permutations. Particularly the second paragraph:

```
 	382	        In more detail using one-line notation, if we have two permutations 
 	383	        `p \cdot q` and multiplying on the right by numbers, then the 
 	384	        resulting permutation is determined for any fixed `j` by sending 
 	385	        `p_j = q_i \mapsto q_{i+1}` for some (unique) `i` where we take the 
 	386	        indices cyclicly (i.e. `n + 1 \equiv 1`). If we consider this as 
 	387	        multiplying on the left by position, we determine the resulting 
 	388	        permutation by `q_{p_i} \mapsto q_{p_{i+1}}` over all `i` (again 
 	389	        taking the indices cyclically).
```

Sorry, but I don't have much of a clue what you mean here :/ What is the `q_i \mapsto q_{i+1}` thing about? Are your permutations supposed to be cycles written in cycle form?

Also, "surpressed" should be "suppressed". The rest of the edits is definitely good.



---

archive/issue_comments_186769.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nMy permutations are \"using one-line notation\". And the by-value is sending the value `p_j` which equals `q_i` for some `i` to the value `q_{i+1}` as we range over `j`. The by-position is sending the value `q_{p_i}` to the resulting value `q_{p_{i+1}}`. Would it be better if I put primes on the image or called it `r`? Or the notation `r_j = q_{i+1}` where `p_j = q_i` (for by-value) and `r_{p_{i+1}} = q_{p_i}` (for by-position)?\n\nI'll fix the typo when we clarify the above.",
    "created_at": "2013-11-23T07:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186769",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">comment:19</div>

My permutations are "using one-line notation". And the by-value is sending the value `p_j` which equals `q_i` for some `i` to the value `q_{i+1}` as we range over `j`. The by-position is sending the value `q_{p_i}` to the resulting value `q_{p_{i+1}}`. Would it be better if I put primes on the image or called it `r`? Or the notation `r_j = q_{i+1}` where `p_j = q_i` (for by-value) and `r_{p_{i+1}} = q_{p_i}` (for by-position)?

I'll fix the typo when we clarify the above.



---

archive/issue_comments_186770.json:
```json
{
    "body": "additional patch for another piece of code that uses the product of permutations (for no reason)",
    "created_at": "2013-11-23T23:39:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186770",
    "user": "https://github.com/darijgr"
}
```

additional patch for another piece of code that uses the product of permutations (for no reason)



---

archive/issue_comments_186771.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAttachment: **[trac_15174-fix-intersection-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-fix-intersection-dg.patch.gz)**\n\nI still don't see why (by-value) `p_j = q_i` gets sent to `q_{i+1}`. Shouldn't rather `p_j = i` get sent to `q_i`? Either way, I'm not convinced that viewing multiplication as action is really helpful to get rid of ambiguity. There are only two reasonable ways to multiply permutations, but there are at least six reasonable ways to act on permutations (counting left and right actions), so I fear the whole note does more harm than help.\n\nIn other news, here's one more little patch to get rid of the dependency in `sage/graphs/comparability.pyx` and `sage/graphs/generators/intersection.py`. It turns out that `sage/categories/magmas.py` is a non-issue (the dependency exists only in the doctest). This leaves only braids, semimonomial transformations, Latin square isotopisms and the seminormal form to deal with.\n\nfor the **patchbot**:\n\napply trac_15174-qfold1.patch\u200b, trac_15174-final-touches-dg.patch\u200b, trac_15174-review-ts.patch trac_15174-fix-intersection-dg.patch",
    "created_at": "2013-11-23T23:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186771",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:20" align="right">comment:20</div>

Attachment: **[trac_15174-fix-intersection-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-fix-intersection-dg.patch.gz)**

I still don't see why (by-value) `p_j = q_i` gets sent to `q_{i+1}`. Shouldn't rather `p_j = i` get sent to `q_i`? Either way, I'm not convinced that viewing multiplication as action is really helpful to get rid of ambiguity. There are only two reasonable ways to multiply permutations, but there are at least six reasonable ways to act on permutations (counting left and right actions), so I fear the whole note does more harm than help.

In other news, here's one more little patch to get rid of the dependency in `sage/graphs/comparability.pyx` and `sage/graphs/generators/intersection.py`. It turns out that `sage/categories/magmas.py` is a non-issue (the dependency exists only in the doctest). This leaves only braids, semimonomial transformations, Latin square isotopisms and the seminormal form to deal with.

for the **patchbot**:

apply trac_15174-qfold1.patchâ€‹, trac_15174-final-touches-dg.patchâ€‹, trac_15174-review-ts.patch trac_15174-fix-intersection-dg.patch



---

archive/issue_comments_186772.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,3 +11,4 @@\n * [attachment: trac_15174-qfold1.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)\n * [attachment: trac_15174-final-touches-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)\n * [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)\n+* [attachment: trac_15174-fix-intersection-dg.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-fix-intersection-dg.patch.gz)\n``````\n",
    "created_at": "2013-11-23T23:45:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186772",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,3 +11,4 @@
 * [attachment: trac_15174-qfold1.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)
 * [attachment: trac_15174-final-touches-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)
 * [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)
+* [attachment: trac_15174-fix-intersection-dg.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-fix-intersection-dg.patch.gz)
``````




---

archive/issue_events_216530.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-11-29T20:49:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216530"
}
```



---

archive/issue_events_216531.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-11-29T20:49:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216531"
}
```



---

archive/issue_comments_186773.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nTravis?",
    "created_at": "2013-11-29T20:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186773",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:22" align="right">comment:22</div>

Travis?



---

archive/issue_comments_186774.json:
```json
{
    "body": "Attachment: **[trac_15174-classlvl-doc-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-classlvl-doc-dg.patch.gz)**",
    "created_at": "2013-11-29T22:56:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186774",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_15174-classlvl-doc-dg.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-classlvl-doc-dg.patch.gz)**



---

archive/issue_comments_186775.json:
```json
{
    "body": "all qfolded",
    "created_at": "2013-11-29T23:07:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186775",
    "user": "https://github.com/darijgr"
}
```

all qfolded



---

archive/issue_comments_186776.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nAttachment: **[trac_15174-full-qfold.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-full-qfold.patch.gz)**\n\nLooks good to me. Thanks Darij.\n\nFor patchbot:\n\nApply: trac_15174-full-qfold.patch\u200b",
    "created_at": "2013-11-29T23:08:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186776",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:23" align="right">comment:23</div>

Attachment: **[trac_15174-full-qfold.patch.gz](https://github.com/sagemath/sage/files/ticket15174/trac_15174-full-qfold.patch.gz)**

Looks good to me. Thanks Darij.

For patchbot:

Apply: trac_15174-full-qfold.patchâ€‹



---

archive/issue_comments_186777.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,4 @@\n \n Apply:\n \n-* [attachment: trac_15174-qfold1.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)\n-* [attachment: trac_15174-final-touches-dg.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)\n-* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)\n-* [attachment: trac_15174-fix-intersection-dg.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-fix-intersection-dg.patch.gz)\n+* [attachment: trac_15174-full-qfold.patch\u200b](https://github.com/sagemath/sage/files/ticket15174/1214109b59035ea382521609fb14b577.gz)\n``````\n",
    "created_at": "2013-11-29T23:08:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186777",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,4 @@
 
 Apply:
 
-* [attachment: trac_15174-qfold1.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/0ba250b23c22ff3656e3e6057f4bd296.gz)
-* [attachment: trac_15174-final-touches-dg.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/17582237fac1f45eaa2d265176521303.gz)
-* [attachment: trac_15174-review-ts.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-review-ts.patch.gz)
-* [attachment: trac_15174-fix-intersection-dg.patch](https://github.com/sagemath/sage/files/ticket15174/trac_15174-fix-intersection-dg.patch.gz)
+* [attachment: trac_15174-full-qfold.patchâ€‹](https://github.com/sagemath/sage/files/ticket15174/1214109b59035ea382521609fb14b577.gz)
``````




---

archive/issue_events_216532.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-11-29T23:08:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216532"
}
```



---

archive/issue_events_216533.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-11-29T23:08:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216533"
}
```



---

archive/issue_comments_186778.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n\n```\n\\     /\n \\   /\n  \\o/\n```\n\nThank you, Travis!",
    "created_at": "2013-11-29T23:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186778",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:24" align="right">comment:24</div>


```
\     /
 \   /
  \o/
```

Thank you, Travis!



---

archive/issue_comments_186779.json:
```json
{
    "body": "Merged: **sage-5.13.beta5**",
    "created_at": "2013-12-05T08:01:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15174#issuecomment-186779",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta5**



---

archive/issue_events_216534.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T08:01:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216534"
}
```



---

archive/issue_events_216535.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T08:01:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15174",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15174#event-216535"
}
```
