# Issue 15272: Bruhat posets and Bruhat graphs for parabolic subgroups of finite Weyl groups

archive/issues_015035.json:
```json
{
    "assignees": [],
    "body": "This patch adds method minimal_representatives and extends the functionality of bruhat_poset and bruhat_graphs.\n\nLet W be a finite Weyl group and let W_S be the subgroup of W generated by reflections associated with a subset S of simple roots. Then the cosets W / W_S have unique representatives of minimal length which are ordered by the Bruhat order of W. Similarly for W_S \\ W. These poset structures appear in many places, e.g. intersection cohomology of generalized flag varieties or nilpotent Lie algebra cohomology.\n\nThis patch adds a parameters index_set (= S), crossed_nodes and side (left / right).\n\nCC:  @nthiery @dwbump @tscrim @anneschilling\n\nBranch/Commit: **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272) @ [`64ea7c8`](https://github.com/sagemath/sagetrac-mirror/commit/64ea7c8216c4d0eb5cc39a648a629d4dd79ad5b7)**\n\nAuthor: **V\u00edt Tu\u010dek**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15272_\n\n",
    "created_at": "2013-10-12T21:52:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Bruhat posets and Bruhat graphs for parabolic subgroups of finite Weyl groups",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/15272",
    "user": "https://github.com/vit-tucek"
}
```
This patch adds method minimal_representatives and extends the functionality of bruhat_poset and bruhat_graphs.

Let W be a finite Weyl group and let W_S be the subgroup of W generated by reflections associated with a subset S of simple roots. Then the cosets W / W_S have unique representatives of minimal length which are ordered by the Bruhat order of W. Similarly for W_S \ W. These poset structures appear in many places, e.g. intersection cohomology of generalized flag varieties or nilpotent Lie algebra cohomology.

This patch adds a parameters index_set (= S), crossed_nodes and side (left / right).

CC:  @nthiery @dwbump @tscrim @anneschilling

Branch/Commit: **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272) @ [`64ea7c8`](https://github.com/sagemath/sagetrac-mirror/commit/64ea7c8216c4d0eb5cc39a648a629d4dd79ad5b7)**

Author: **Vít Tuček**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/15272_





---

archive/issue_events_215102.json:
```json
{
    "actor": "https://github.com/vit-tucek",
    "created_at": "2013-10-12T21:52:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215102"
}
```



---

archive/issue_events_215103.json:
```json
{
    "actor": "https://github.com/vit-tucek",
    "created_at": "2013-10-12T21:52:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215103"
}
```



---

archive/issue_events_215104.json:
```json
{
    "actor": "https://github.com/vit-tucek",
    "created_at": "2013-10-12T21:52:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215104"
}
```



---

archive/issue_events_215105.json:
```json
{
    "actor": "https://github.com/vit-tucek",
    "created_at": "2013-10-12T21:52:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215105"
}
```



---

archive/issue_events_215106.json:
```json
{
    "actor": "https://github.com/vit-tucek",
    "created_at": "2013-12-03T11:12:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215106"
}
```



---

archive/issue_comments_188460.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_15272_parabolic_bruhat_posets.patch.gz](https://github.com/sagemath/sage/files/ticket15272/trac_15272_parabolic_bruhat_posets.patch.gz)**",
    "created_at": "2013-12-03T11:12:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188460",
    "user": "https://github.com/vit-tucek"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_15272_parabolic_bruhat_posets.patch.gz](https://github.com/sagemath/sage/files/ticket15272/trac_15272_parabolic_bruhat_posets.patch.gz)**



---

archive/issue_comments_188461.json:
```json
{
    "body": "Author: **V\u00edt Tu\u010dek**",
    "created_at": "2013-12-03T11:12:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188461",
    "user": "https://github.com/vit-tucek"
}
```

Author: **Vít Tuček**



---

archive/issue_events_215107.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215107"
}
```



---

archive/issue_events_215108.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215108"
}
```



---

archive/issue_comments_188462.json:
```json
{
    "body": "Branch: **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272)**",
    "created_at": "2014-03-18T17:44:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188462",
    "user": "https://github.com/vit-tucek"
}
```

Branch: **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272)**



---

archive/issue_events_215109.json:
```json
{
    "actor": "https://github.com/vit-tucek",
    "created_at": "2014-03-18T17:51:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "title_is": "Bruhat posets and Bruhat graphs for parabolic subgroups of finite Weyl groups",
    "title_was": "Bruhat posets and Bruhat graphs for parabolic subgroups",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215109"
}
```



---

archive/issue_comments_188463.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,5 @@\n-This patch extends the functionality of bruhat_poset and introduces new parabolic_bruhat_graph for finite Weyl groups. \n+This patch adds method minimal_representatives and extends the functionality of bruhat_poset and bruhat_graphs.\n \n Let W be a finite Weyl group and let W_S be the subgroup of W generated by reflections associated with a subset S of simple roots. Then the cosets W / W_S have unique representatives of minimal length which are ordered by the Bruhat order of W. Similarly for W_S \\ W. These poset structures appear in many places, e.g. intersection cohomology of generalized flag varieties or nilpotent Lie algebra cohomology.\n \n-This patch adds a parameters index_set (= S) and side (left / right).\n-\n-\n----\n-\n-\n-Introducing parabolic_bruhat_graph is ugly. Ideally, one would just extend the existing bruhat_graph. However, this method is based upon bruhat_interval which belongs to categories/coxeter_groups.py \n-\n-I was unsure where to put the code, which I haven't written yet nor which I need  in the foreseeable future anyway. Since it seems that the best course of action would be to implement class (or category?) for parabolic subroot systems / groups I think that one more method for Weyl group is not much of an issue.\n+This patch adds a parameters index_set (= S), crossed_nodes and side (left / right).\n``````\n",
    "created_at": "2014-03-18T17:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188463",
    "user": "https://github.com/vit-tucek"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,5 @@
-This patch extends the functionality of bruhat_poset and introduces new parabolic_bruhat_graph for finite Weyl groups. 
+This patch adds method minimal_representatives and extends the functionality of bruhat_poset and bruhat_graphs.
 
 Let W be a finite Weyl group and let W_S be the subgroup of W generated by reflections associated with a subset S of simple roots. Then the cosets W / W_S have unique representatives of minimal length which are ordered by the Bruhat order of W. Similarly for W_S \ W. These poset structures appear in many places, e.g. intersection cohomology of generalized flag varieties or nilpotent Lie algebra cohomology.
 
-This patch adds a parameters index_set (= S) and side (left / right).
-
-
----
-
-
-Introducing parabolic_bruhat_graph is ugly. Ideally, one would just extend the existing bruhat_graph. However, this method is based upon bruhat_interval which belongs to categories/coxeter_groups.py 
-
-I was unsure where to put the code, which I haven't written yet nor which I need  in the foreseeable future anyway. Since it seems that the best course of action would be to implement class (or category?) for parabolic subroot systems / groups I think that one more method for Weyl group is not much of an issue.
+This patch adds a parameters index_set (= S), crossed_nodes and side (left / right).
``````




---

archive/issue_comments_188464.json:
```json
{
    "body": "Commit: **[`472c090`](https://github.com/sagemath/sagetrac-mirror/commit/472c0908fba197fe9bb73742caab1ebfcde27b53)**",
    "created_at": "2014-03-18T17:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188464",
    "user": "https://github.com/vit-tucek"
}
```

Commit: **[`472c090`](https://github.com/sagemath/sagetrac-mirror/commit/472c0908fba197fe9bb73742caab1ebfcde27b53)**



---

archive/issue_comments_188465.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bb7c3b3c9864b6a82b9bc87464d9076ad05ebb1\"><code>7bb7c3b</code></a></td><td><code>Decorate ClassicalWeylSubgroup.simple_reflections() with @cached_method.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6db7b6d186ef715f647c848820b22d4cc7c23110\"><code>6db7b6d</code></a></td><td><code>First version of minimal coset representatives.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/472c0908fba197fe9bb73742caab1ebfcde27b53\"><code>472c090</code></a></td><td><code>Add parabolic minimal_coset_representatives, bruhat_graph and bruhat_poset</code></td></tr></table>\n",
    "created_at": "2014-03-18T17:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188465",
    "user": "https://github.com/vit-tucek"
}
```

<div id="comment:4"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bb7c3b3c9864b6a82b9bc87464d9076ad05ebb1"><code>7bb7c3b</code></a></td><td><code>Decorate ClassicalWeylSubgroup.simple_reflections() with @cached_method.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6db7b6d186ef715f647c848820b22d4cc7c23110"><code>6db7b6d</code></a></td><td><code>First version of minimal coset representatives.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/472c0908fba197fe9bb73742caab1ebfcde27b53"><code>472c090</code></a></td><td><code>Add parabolic minimal_coset_representatives, bruhat_graph and bruhat_poset</code></td></tr></table>




---

archive/issue_comments_188466.json:
```json
{
    "body": "Changed commit from **[`472c090`](https://github.com/sagemath/sagetrac-mirror/commit/472c0908fba197fe9bb73742caab1ebfcde27b53)** to **[`92888b3`](https://github.com/sagemath/sagetrac-mirror/commit/92888b345acb3f6726c1d38ab16d4f1366fbb757)**",
    "created_at": "2014-03-19T12:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188466",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`472c090`](https://github.com/sagemath/sagetrac-mirror/commit/472c0908fba197fe9bb73742caab1ebfcde27b53)** to **[`92888b3`](https://github.com/sagemath/sagetrac-mirror/commit/92888b345acb3f6726c1d38ab16d4f1366fbb757)**



---

archive/issue_comments_188467.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/860f635db87e1dc8290e956f8c28ec3ef2099456\"><code>860f635</code></a></td><td><code>Edge labels and other improvements in bruhat_graph</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92888b345acb3f6726c1d38ab16d4f1366fbb757\"><code>92888b3</code></a></td><td><code>Raise NotImplementedError in minimal_representatives for infinite W</code></td></tr></table>\n",
    "created_at": "2014-03-19T12:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188467",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/860f635db87e1dc8290e956f8c28ec3ef2099456"><code>860f635</code></a></td><td><code>Edge labels and other improvements in bruhat_graph</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92888b345acb3f6726c1d38ab16d4f1366fbb757"><code>92888b3</code></a></td><td><code>Raise NotImplementedError in minimal_representatives for infinite W</code></td></tr></table>




---

archive/issue_comments_188468.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThere is a merge conflict with develop:\n\n```\n        x = x.coset_representative(index_set,side)\n        y = y.coset_representative(index_set,side)\n        g = self.bruhat_poset(index_set, crossed_nodes, side, facade=True).interval(x,y)\n        ref = self.reflections()\n        d = {}\n        for x in g:\n<<<<<<< HEAD\n            d[x] = [y for y in g if x.length() < y.length() and x*y.inverse() in ref]\n=======\n            d[x] = {}\n            for y in g:\n                if side == \"right\":\n                    r = y*x.inverse()\n                else:\n                    r = x.inverse()*y\n                if x.length() < y.length() and ref.has_key(r):\n                    d[x][y] = r\n>>>>>>> 92888b345acb3f6726c1d38ab16d4f1366fbb757\n        return DiGraph(d)\n```\nI'm pushing a branch (warning: branch change!) in which I resolve this in favor of your patch's version (the longer one, with the \"for y in g\" loop and the dictionary rather than the list). If this is wrong, please let me know.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b1220d530e96cbfaf0927c539475327891e027d\"><code>1b1220d</code></a></td><td><code>manual merge commit due to conflict with develop</code></td></tr></table>\n",
    "created_at": "2014-03-25T23:43:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188468",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:7" align="right">comment:7</div>

There is a merge conflict with develop:

```
        x = x.coset_representative(index_set,side)
        y = y.coset_representative(index_set,side)
        g = self.bruhat_poset(index_set, crossed_nodes, side, facade=True).interval(x,y)
        ref = self.reflections()
        d = {}
        for x in g:
<<<<<<< HEAD
            d[x] = [y for y in g if x.length() < y.length() and x*y.inverse() in ref]
=======
            d[x] = {}
            for y in g:
                if side == "right":
                    r = y*x.inverse()
                else:
                    r = x.inverse()*y
                if x.length() < y.length() and ref.has_key(r):
                    d[x][y] = r
>>>>>>> 92888b345acb3f6726c1d38ab16d4f1366fbb757
        return DiGraph(d)
```
I'm pushing a branch (warning: branch change!) in which I resolve this in favor of your patch's version (the longer one, with the "for y in g" loop and the dictionary rather than the list). If this is wrong, please let me know.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b1220d530e96cbfaf0927c539475327891e027d"><code>1b1220d</code></a></td><td><code>manual merge commit due to conflict with develop</code></td></tr></table>




---

archive/issue_comments_188469.json:
```json
{
    "body": "Changed commit from **[`92888b3`](https://github.com/sagemath/sagetrac-mirror/commit/92888b345acb3f6726c1d38ab16d4f1366fbb757)** to **[`1b1220d`](https://github.com/sagemath/sagetrac-mirror/commit/1b1220d530e96cbfaf0927c539475327891e027d)**",
    "created_at": "2014-03-25T23:43:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188469",
    "user": "https://github.com/darijgr"
}
```

Changed commit from **[`92888b3`](https://github.com/sagemath/sagetrac-mirror/commit/92888b345acb3f6726c1d38ab16d4f1366fbb757)** to **[`1b1220d`](https://github.com/sagemath/sagetrac-mirror/commit/1b1220d530e96cbfaf0927c539475327891e027d)**



---

archive/issue_comments_188470.json:
```json
{
    "body": "Changed branch from **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272)** to **[public/combinat/15272](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/15272)**",
    "created_at": "2014-03-25T23:43:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188470",
    "user": "https://github.com/darijgr"
}
```

Changed branch from **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272)** to **[public/combinat/15272](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/15272)**



---

archive/issue_comments_188471.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThat said, what do you think about pulling the `if side == \"right\"` check outside of the loop, so as to not repeat it over and over?",
    "created_at": "2014-03-25T23:45:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188471",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:8" align="right">comment:8</div>

That said, what do you think about pulling the `if side == "right"` check outside of the loop, so as to not repeat it over and over?



---

archive/issue_comments_188472.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOh, and also the conflict was because some other patch replaced `ref.has_key(...)` by `... in ref`. Maybe do the same in your code? (I don't know what the difference is; it just sounds like a logical thing to do.)",
    "created_at": "2014-03-25T23:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188472",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:9" align="right">comment:9</div>

Oh, and also the conflict was because some other patch replaced `ref.has_key(...)` by `... in ref`. Maybe do the same in your code? (I don't know what the difference is; it just sounds like a logical thing to do.)



---

archive/issue_comments_188473.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThe `has_key` is being deprecated (removed?) in python3 in favor of the `in` syntax (which I believe is faster...?). Also I agree with Darij since this loop is so small, I'd pull the `side == \"right\"` statement outside as:\n\n```\nif side == \"right\":\n    for y in g:\n        r = y*x.inverse()\n    if x.length() < y.length() and r in ref:\n        d[x][y] = r\nelse:\n    for y in g:\n        r = x.inverse()*y\n    if x.length() < y.length() and r in ref:\n        d[x][y] = r\n```",
    "created_at": "2014-03-26T02:36:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188473",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

The `has_key` is being deprecated (removed?) in python3 in favor of the `in` syntax (which I believe is faster...?). Also I agree with Darij since this loop is so small, I'd pull the `side == "right"` statement outside as:

```
if side == "right":
    for y in g:
        r = y*x.inverse()
    if x.length() < y.length() and r in ref:
        d[x][y] = r
else:
    for y in g:
        r = x.inverse()*y
    if x.length() < y.length() and r in ref:
        d[x][y] = r
```



---

archive/issue_comments_188474.json:
```json
{
    "body": "Changed branch from **[public/combinat/15272](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/15272)** to **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272)**",
    "created_at": "2014-03-26T14:24:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188474",
    "user": "https://github.com/vit-tucek"
}
```

Changed branch from **[public/combinat/15272](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/15272)** to **[u/vittucek/ticket/15272](https://github.com/sagemath/sagetrac-mirror/tree/u/vittucek/ticket/15272)**



---

archive/issue_comments_188475.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@darijgr](#comment%3A7):\n> There is a merge conflict with develop:\n> \n> ```\n>         x = x.coset_representative(index_set,side)\n>         y = y.coset_representative(index_set,side)\n>         g = self.bruhat_poset(index_set, crossed_nodes, side, facade=True).interval(x,y)\n>         ref = self.reflections()\n>         d = {}\n>         for x in g:\n> <<<<<<< HEAD\n>             d[x] = [y for y in g if x.length() < y.length() and x*y.inverse() in ref]\n> =======\n>             d[x] = {}\n>             for y in g:\n>                 if side == \"right\":\n>                     r = y*x.inverse()\n>                 else:\n>                     r = x.inverse()*y\n>                 if x.length() < y.length() and ref.has_key(r):\n>                     d[x][y] = r\n> >>>>>>> 92888b345acb3f6726c1d38ab16d4f1366fbb757\n>         return DiGraph(d)\n> ```\n> I'm pushing a branch (warning: branch change!) in which I resolve this in favor of your patch's version (the longer one, with the \"for y in g\" loop and the dictionary rather than the list). If this is wrong, please let me know.\n> \n> ---\n\nThanks!  I've made the change you've requested (and moreover I've switched the order of tests to benefit from short-circuiting. I didn't know how to add the patch on top of your branch (insufficient permissions?) so I just went with what `sage -dev push` suggested. I hope that's fine.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1e25e678525b169df881ef8312ecf30e64d3adf\"><code>b1e25e6</code></a></td><td><code>Performance enhancement in bruhat_graph</code></td></tr></table>\n",
    "created_at": "2014-03-26T14:27:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188475",
    "user": "https://github.com/vit-tucek"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@darijgr](#comment%3A7):
> There is a merge conflict with develop:
> 
> ```
>         x = x.coset_representative(index_set,side)
>         y = y.coset_representative(index_set,side)
>         g = self.bruhat_poset(index_set, crossed_nodes, side, facade=True).interval(x,y)
>         ref = self.reflections()
>         d = {}
>         for x in g:
> <<<<<<< HEAD
>             d[x] = [y for y in g if x.length() < y.length() and x*y.inverse() in ref]
> =======
>             d[x] = {}
>             for y in g:
>                 if side == "right":
>                     r = y*x.inverse()
>                 else:
>                     r = x.inverse()*y
>                 if x.length() < y.length() and ref.has_key(r):
>                     d[x][y] = r
> >>>>>>> 92888b345acb3f6726c1d38ab16d4f1366fbb757
>         return DiGraph(d)
> ```
> I'm pushing a branch (warning: branch change!) in which I resolve this in favor of your patch's version (the longer one, with the "for y in g" loop and the dictionary rather than the list). If this is wrong, please let me know.
> 
> ---

Thanks!  I've made the change you've requested (and moreover I've switched the order of tests to benefit from short-circuiting. I didn't know how to add the patch on top of your branch (insufficient permissions?) so I just went with what `sage -dev push` suggested. I hope that's fine.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1e25e678525b169df881ef8312ecf30e64d3adf"><code>b1e25e6</code></a></td><td><code>Performance enhancement in bruhat_graph</code></td></tr></table>




---

archive/issue_comments_188476.json:
```json
{
    "body": "Changed commit from **[`1b1220d`](https://github.com/sagemath/sagetrac-mirror/commit/1b1220d530e96cbfaf0927c539475327891e027d)** to **[`b1e25e6`](https://github.com/sagemath/sagetrac-mirror/commit/b1e25e678525b169df881ef8312ecf30e64d3adf)**",
    "created_at": "2014-03-26T14:27:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188476",
    "user": "https://github.com/vit-tucek"
}
```

Changed commit from **[`1b1220d`](https://github.com/sagemath/sagetrac-mirror/commit/1b1220d530e96cbfaf0927c539475327891e027d)** to **[`b1e25e6`](https://github.com/sagemath/sagetrac-mirror/commit/b1e25e678525b169df881ef8312ecf30e64d3adf)**



---

archive/issue_comments_188477.json:
```json
{
    "body": "Changed commit from **[`b1e25e6`](https://github.com/sagemath/sagetrac-mirror/commit/b1e25e678525b169df881ef8312ecf30e64d3adf)** to **[`64ea7c8`](https://github.com/sagemath/sagetrac-mirror/commit/64ea7c8216c4d0eb5cc39a648a629d4dd79ad5b7)**",
    "created_at": "2014-03-26T20:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188477",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b1e25e6`](https://github.com/sagemath/sagetrac-mirror/commit/b1e25e678525b169df881ef8312ecf30e64d3adf)** to **[`64ea7c8`](https://github.com/sagemath/sagetrac-mirror/commit/64ea7c8216c4d0eb5cc39a648a629d4dd79ad5b7)**



---

archive/issue_comments_188478.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64ea7c8216c4d0eb5cc39a648a629d4dd79ad5b7\"><code>64ea7c8</code></a></td><td><code>Bugfix: FiniteFamily is not a dictionary!</code></td></tr></table>\n",
    "created_at": "2014-03-26T20:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188478",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64ea7c8216c4d0eb5cc39a648a629d4dd79ad5b7"><code>64ea7c8</code></a></td><td><code>Bugfix: FiniteFamily is not a dictionary!</code></td></tr></table>




---

archive/issue_comments_188479.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@darijgr](#comment%3A9):\n> Oh, and also the conflict was because some other patch replaced `ref.has_key(...)` by `... in ref`. Maybe do the same in your code? (I don't know what the difference is; it just sounds like a logical thing to do.)\n\nEhm. I have done this change too hastily. As it turns out `ref` is not a dictionary but a `FiniteFamily` which means that its `__contains__` method looks at the values. It's `__contains__` method was changed #15784 to use `in` in favor of `has_key`.",
    "created_at": "2014-03-26T20:54:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188479",
    "user": "https://github.com/vit-tucek"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@darijgr](#comment%3A9):
> Oh, and also the conflict was because some other patch replaced `ref.has_key(...)` by `... in ref`. Maybe do the same in your code? (I don't know what the difference is; it just sounds like a logical thing to do.)

Ehm. I have done this change too hastily. As it turns out `ref` is not a dictionary but a `FiniteFamily` which means that its `__contains__` method looks at the values. It's `__contains__` method was changed #15784 to use `in` in favor of `has_key`.



---

archive/issue_events_215110.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215110"
}
```



---

archive/issue_events_215111.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215111"
}
```



---

archive/issue_events_215112.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215112"
}
```



---

archive/issue_events_215113.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215113"
}
```



---

archive/issue_comments_188480.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\ndoes not apply",
    "created_at": "2015-04-21T16:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15272#issuecomment-188480",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

does not apply



---

archive/issue_events_215114.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-21T16:17:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215114"
}
```



---

archive/issue_events_215115.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-21T16:17:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215115"
}
```



---

archive/issue_events_215116.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15272",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15272#event-215116"
}
```
