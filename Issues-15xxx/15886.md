# Issue 15886: sage.libs.pari.gen.PariError: ZZ_12…1[y]/(y^2 + …) is not a field in FpX_ffintersect

archive/issues_015649.json:
```json
{
    "body": "The code below will cause a pari error like this:\n\n```\nTraceback (most recent call last):\n  File \"\u2026.py\", line 73, in <module>\n    a.minpoly()\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 3593, in minpoly\n    self.exactify()\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 3462, in exactify\n    self._set_descr(self._descr.exactify())\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 6477, in exactify\n    red_elt, red_back, red_pol = do_polred(my_factor)\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 1556, in do_polred\n    new_poly, elt_back = poly._pari_().polredbest(flag=1)\n  File \"gen.pyx\", line 7889, in sage.libs.pari.gen.gen.polredbest (sage/libs/pari/gen.c:39295)\n  File \"handle_error.pyx\", line 90, in sage.libs.pari.handle_error._pari_handle_exception (sage/libs/pari/handle_error.c:1134)\nsage.libs.pari.gen.PariError: ZZ_123633238138850861[y]/(y^2 + 114948053005503479*y + 71680486823734693) is not a field in FpX_ffintersect\n```\n\nAs Jeroen Demeyer [pointed out](https://groups.google.com/d/msg/sage-support/rJkN3ifh6IM/rVH4dpM-CKgJ), this is most likely due to the fact that 123633238138850861 is not a prime number (it is 5332567*23184563483), but that does not explain where this number came from. Personally I don't see what reformulation of polynomials has to do with finite fields, but I haven't looked at these pyx files yet.\n\nHere comes the reproducing example. Sorry for the large numbers, but they seem to be part of the problem here.\n\n```\nZZy.<y> = ZZ[]\npoly8 = ZZy([\n106346275030920586004276738159284223160745160329414802674148696415560316409061498114049459644001698876690153812161622530710214150820561031037785280344393299646600156897949037810194870162400984124666960310214525780110648622089311363935212895781758830692752289761380743270340278626938299598583183832574931221725553565254820532939785346746231356273732577381690752781714567846773023346958287913797090269420198245156242586972934757809596130740923433261746417755524427662333604332151073009621028952867341874474226358516188234334856136546786036008823240823139642247244408516688519232364150088668864406302978147634902827970593978579746892046832066760554149496750495855890983444017853685989839294337798592903735922065448332446935785156074894307761739174238107368878131577200234300680138251796669301289858254996149281097308015925742230852069954244156352963488435590260218531054759395011235869401688302297074533082100095584405764604354096420974538390817121633490421461930709741274376939358773837412991489285454175589219720348007951400,\n21595873767273098831715407663577014047612178342013989156104290844099052007843836432847667901176337161202628964215075785914621920629985934921246108812445296629577460278824852712526743556769516530964518214713381656159049808334626331659342801931340107179710323312442163063006740180149555035674205081356652537559014121902836707522368424560039571561544244732464548333075681518403554586371269235312690674519890666506396738820149739366949045634722190449823858160939916477024476640771831041610040530162824963348690560359804017459306399755756429348029569901239141761718059694387787411731781948882247690566271179742719263580025591907418753793505946662664215190136399059484912639161088677691409848019268342569051164385444698750604146646171769502655397869039265456466896264473600,\n-21595873767273098831715407663577014047612178342013989156104290844099052007843836432847667901176337161202628964215075785914621920629985934921246108812445296629577460278824852712526743556769516530964518214713381656159049808334626331659342801931340107179710342840932815724762756703206291989559590448970192436210378026601090903218189588812227847012610665455817691722989036849605377289513027623525970334355916763657692967671480904644496444738599861795838493733558867349216688224238699025150137865708135568810118296899122376751706750168047103364146819182582846619860288402376055403038463763425968747394750116427335314635224968191203490832518861801718565885229220211055830316504539067868598834912210812262795276799425521272732942022020478348640156203774846863079479220679820,\n39056981305323512033046113473907770770735227079797302727809396508391391642328504376550902132841446706286779826710662403645406283516776426559319672052194302592457702662330555094798207755342692029271145237901744384423166933735967080194671090621210922855473076542559650519180931506115786787197756014442850575694550472977190959357760004435809540545505603518541981053027385045550452838531837634132151782604367437572151403210526968642601837610563821264785194721882166941284459512337610476500803013342670374109948897460,\n-19528490652661756016523056736953885385367613539898651363904698254195695821164252188275451066420723353143389913355331201822703141758388213279659836026097151296228851331165277547399103877671346014635572618950872192211583466867983540097335545310605461427736533035882489555790733064977279775346861324804261015940111477591616344664207294702144479241833387475370667162200736212966163451019817630642979883707344458128067492379630019982871048119342995073793514261533890179876499293468601505710735362120978059415065661279,\n-6282476802844559679225696736341902420018900597126288596510676374962017607249018912349237103297140680388037175547571770875561895321423707715209113807112789609851070760157206115844823126698670318899719288631948918876555240244479047599373460428553167890544944,\n+2094158934281519893075232245447300806672966865708762865503558791654005869083006304116412367765713560129345725182523923625187298440474569238403037935704263203283690253385735371948274375566223439633239762877316306292185080081493015866457820142851055963514986,\n-4,\n1])\na = poly8.roots(QQbar, False)[0]\na.minpoly()\n```\n\nReviewer: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15886\n\n",
    "closed_at": "2014-09-09T14:53:25Z",
    "created_at": "2014-03-03T17:20:38Z",
    "labels": [
        "component: number fields",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "sage.libs.pari.gen.PariError: ZZ_12\u20261[y]/(y^2 + \u2026) is not a field in FpX_ffintersect",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15886",
    "user": "https://github.com/gagern"
}
```
The code below will cause a pari error like this:

```
Traceback (most recent call last):
  File "….py", line 73, in <module>
    a.minpoly()
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 3593, in minpoly
    self.exactify()
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 3462, in exactify
    self._set_descr(self._descr.exactify())
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 6477, in exactify
    red_elt, red_back, red_pol = do_polred(my_factor)
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 1556, in do_polred
    new_poly, elt_back = poly._pari_().polredbest(flag=1)
  File "gen.pyx", line 7889, in sage.libs.pari.gen.gen.polredbest (sage/libs/pari/gen.c:39295)
  File "handle_error.pyx", line 90, in sage.libs.pari.handle_error._pari_handle_exception (sage/libs/pari/handle_error.c:1134)
sage.libs.pari.gen.PariError: ZZ_123633238138850861[y]/(y^2 + 114948053005503479*y + 71680486823734693) is not a field in FpX_ffintersect
```

As Jeroen Demeyer [pointed out](https://groups.google.com/d/msg/sage-support/rJkN3ifh6IM/rVH4dpM-CKgJ), this is most likely due to the fact that 123633238138850861 is not a prime number (it is 5332567*23184563483), but that does not explain where this number came from. Personally I don't see what reformulation of polynomials has to do with finite fields, but I haven't looked at these pyx files yet.

Here comes the reproducing example. Sorry for the large numbers, but they seem to be part of the problem here.

```
ZZy.<y> = ZZ[]
poly8 = ZZy([
106346275030920586004276738159284223160745160329414802674148696415560316409061498114049459644001698876690153812161622530710214150820561031037785280344393299646600156897949037810194870162400984124666960310214525780110648622089311363935212895781758830692752289761380743270340278626938299598583183832574931221725553565254820532939785346746231356273732577381690752781714567846773023346958287913797090269420198245156242586972934757809596130740923433261746417755524427662333604332151073009621028952867341874474226358516188234334856136546786036008823240823139642247244408516688519232364150088668864406302978147634902827970593978579746892046832066760554149496750495855890983444017853685989839294337798592903735922065448332446935785156074894307761739174238107368878131577200234300680138251796669301289858254996149281097308015925742230852069954244156352963488435590260218531054759395011235869401688302297074533082100095584405764604354096420974538390817121633490421461930709741274376939358773837412991489285454175589219720348007951400,
21595873767273098831715407663577014047612178342013989156104290844099052007843836432847667901176337161202628964215075785914621920629985934921246108812445296629577460278824852712526743556769516530964518214713381656159049808334626331659342801931340107179710323312442163063006740180149555035674205081356652537559014121902836707522368424560039571561544244732464548333075681518403554586371269235312690674519890666506396738820149739366949045634722190449823858160939916477024476640771831041610040530162824963348690560359804017459306399755756429348029569901239141761718059694387787411731781948882247690566271179742719263580025591907418753793505946662664215190136399059484912639161088677691409848019268342569051164385444698750604146646171769502655397869039265456466896264473600,
-21595873767273098831715407663577014047612178342013989156104290844099052007843836432847667901176337161202628964215075785914621920629985934921246108812445296629577460278824852712526743556769516530964518214713381656159049808334626331659342801931340107179710342840932815724762756703206291989559590448970192436210378026601090903218189588812227847012610665455817691722989036849605377289513027623525970334355916763657692967671480904644496444738599861795838493733558867349216688224238699025150137865708135568810118296899122376751706750168047103364146819182582846619860288402376055403038463763425968747394750116427335314635224968191203490832518861801718565885229220211055830316504539067868598834912210812262795276799425521272732942022020478348640156203774846863079479220679820,
39056981305323512033046113473907770770735227079797302727809396508391391642328504376550902132841446706286779826710662403645406283516776426559319672052194302592457702662330555094798207755342692029271145237901744384423166933735967080194671090621210922855473076542559650519180931506115786787197756014442850575694550472977190959357760004435809540545505603518541981053027385045550452838531837634132151782604367437572151403210526968642601837610563821264785194721882166941284459512337610476500803013342670374109948897460,
-19528490652661756016523056736953885385367613539898651363904698254195695821164252188275451066420723353143389913355331201822703141758388213279659836026097151296228851331165277547399103877671346014635572618950872192211583466867983540097335545310605461427736533035882489555790733064977279775346861324804261015940111477591616344664207294702144479241833387475370667162200736212966163451019817630642979883707344458128067492379630019982871048119342995073793514261533890179876499293468601505710735362120978059415065661279,
-6282476802844559679225696736341902420018900597126288596510676374962017607249018912349237103297140680388037175547571770875561895321423707715209113807112789609851070760157206115844823126698670318899719288631948918876555240244479047599373460428553167890544944,
+2094158934281519893075232245447300806672966865708762865503558791654005869083006304116412367765713560129345725182523923625187298440474569238403037935704263203283690253385735371948274375566223439633239762877316306292185080081493015866457820142851055963514986,
-4,
1])
a = poly8.roots(QQbar, False)[0]
a.minpoly()
```

Reviewer: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15886





---

archive/issue_comments_202351.json:
```json
{
    "body": "<a id='comment:2'></a>Fixed by #15767.",
    "created_at": "2014-03-03T17:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15886#issuecomment-202351",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>Fixed by #15767.



---

archive/issue_events_046737.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15886#event-46737"
}
```



---

archive/issue_events_046738.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15886#event-46738"
}
```



---

archive/issue_events_046739.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15886#event-46739"
}
```



---

archive/issue_comments_202352.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-03T07:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15886#issuecomment-202352",
    "user": "https://github.com/gagern"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_202353.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:2 jdemeyer]:\n> Fixed by #15767.\n\n\nSince that has been merged now, this one here is fixed as well.",
    "created_at": "2014-09-03T07:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15886#issuecomment-202353",
    "user": "https://github.com/gagern"
}
```

<a id='comment:5'></a>Replying to [comment:2 jdemeyer]:
> Fixed by #15767.


Since that has been merged now, this one here is fixed as well.



---

archive/issue_comments_202354.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-03T07:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15886#issuecomment-202354",
    "user": "https://github.com/gagern"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_046740.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-03T13:50:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15886#event-46740"
}
```



---

archive/issue_events_046741.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-03T13:50:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15886#event-46741"
}
```



---

archive/issue_comments_202355.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-09T14:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15886#issuecomment-202355",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_046742.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-09T14:53:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15886",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15886#event-46742"
}
```
