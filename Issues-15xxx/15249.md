# Issue 15249: In lazy power series rings, 0 + a and 0 - a return 0

archive/issues_015012.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: L = LazyPowerSeriesRing(QQ)\nsage: x = L.gen()\nsage: L.zero().coefficients(4)\n[0, 0, 0, 0]\nsage: x.coefficients(4)\n[0, 1, 0, 0]\n```\nCorrect so far...\n\n```\nsage: (L.zero() + x).coefficients(4)\n[0, 0, 0, 0]\nsage: (L.zero() - x).coefficients(4)\n[0, 0, 0, 0]\n```\n\nBut `x - L.zero()` and `x + L.zero()` return correct results.\n\nSee also #15248 for another lazy power series bug.\n\nCC:  @mwhansen @mantepse @tscrim\n\nKeywords: **LazyPowerSeries, species**\n\nStopgaps: **incorrectAnswerMarker**\n\nReviewer: **Travis Scrimshaw**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15249_\n\n",
    "closed_at": "2022-10-17T09:33:06Z",
    "created_at": "2013-10-01T23:41:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "In lazy power series rings, 0 + a and 0 - a return 0",
    "type": "issue",
    "updated_at": "2022-10-17T09:33:06Z",
    "url": "https://github.com/sagemath/sage/issues/15249",
    "user": "https://github.com/darijgr"
}
```

```
sage: L = LazyPowerSeriesRing(QQ)
sage: x = L.gen()
sage: L.zero().coefficients(4)
[0, 0, 0, 0]
sage: x.coefficients(4)
[0, 1, 0, 0]
```
Correct so far...

```
sage: (L.zero() + x).coefficients(4)
[0, 0, 0, 0]
sage: (L.zero() - x).coefficients(4)
[0, 0, 0, 0]
```

But `x - L.zero()` and `x + L.zero()` return correct results.

See also #15248 for another lazy power series bug.

CC:  @mwhansen @mantepse @tscrim

Keywords: **LazyPowerSeries, species**

Stopgaps: **incorrectAnswerMarker**

Reviewer: **Travis Scrimshaw**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/15249_





---

archive/issue_events_216839.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-01T23:41:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216839"
}
```



---

archive/issue_events_216840.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-01T23:41:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216840"
}
```



---

archive/issue_events_216841.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-01T23:41:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216841"
}
```



---

archive/issue_events_216842.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-10-01T23:41:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216842"
}
```



---

archive/issue_comments_188224.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nOne problem is in series_order.py.  There, a very simple lattice (in fact, a total order) should be implemented: NonNegativeIntegers together with the two special values unknown and infinity.  unknown is the minimal element, infinity the maximal element.\n\nComparing unknown with another element works, comparing infinity with another element works, but comparing an integer with unknown does not work, because the comparison invoked is from Integer.\n\nHow should I create such a lattice really?",
    "created_at": "2014-01-09T23:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188224",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:1" align="right">comment:1</div>

One problem is in series_order.py.  There, a very simple lattice (in fact, a total order) should be implemented: NonNegativeIntegers together with the two special values unknown and infinity.  unknown is the minimal element, infinity the maximal element.

Comparing unknown with another element works, comparing infinity with another element works, but comparing an integer with unknown does not work, because the comparison invoked is from Integer.

How should I create such a lattice really?



---

archive/issue_comments_188225.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI've done some work on species recently which fixes this as a side effect.  This is related to #10084.  I'll post the branch asap.",
    "created_at": "2014-01-10T20:30:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188225",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:3" align="right">comment:3</div>

I've done some work on species recently which fixes this as a side effect.  This is related to #10084.  I'll post the branch asap.



---

archive/issue_comments_188226.json:
```json
{
    "body": "Changed keywords from **lazy-power-series, species** to **LazyPowerSeries, species**",
    "created_at": "2014-01-10T20:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188226",
    "user": "https://github.com/mantepse"
}
```

Changed keywords from **lazy-power-series, species** to **LazyPowerSeries, species**



---

archive/issue_comments_188227.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@mwhansen](#comment:3):\n> I've done some work on species recently which fixes this as a side effect.  This is related to #10084.  I'll post the branch asap.\n\nGreat! I'm all set to dig into the species code too.  For a start, I looked through the tickets that are related to the lazy power series code and changed the keyword to LazyPowerSeries...\n\nDid you see #10931?  I guess the patch won't apply anymore, but the philosophy should :-)\n\nBest, Martin",
    "created_at": "2014-01-10T21:46:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188227",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@mwhansen](#comment:3):
> I've done some work on species recently which fixes this as a side effect.  This is related to #10084.  I'll post the branch asap.

Great! I'm all set to dig into the species code too.  For a start, I looked through the tickets that are related to the lazy power series code and changed the keyword to LazyPowerSeries...

Did you see #10931?  I guess the patch won't apply anymore, but the philosophy should :-)

Best, Martin



---

archive/issue_comments_188228.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nA fix is in #15673",
    "created_at": "2014-01-14T17:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188228",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:6" align="right">comment:6</div>

A fix is in #15673



---

archive/issue_events_216843.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216843"
}
```



---

archive/issue_events_216844.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216844"
}
```



---

archive/issue_events_216845.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216845"
}
```



---

archive/issue_events_216846.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216846"
}
```



---

archive/issue_events_216847.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216847"
}
```



---

archive/issue_events_216848.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216848"
}
```



---

archive/issue_comments_188229.json:
```json
{
    "body": "Stopgaps: **incorrectAnswerMarker**",
    "created_at": "2016-07-09T17:37:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188229",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

Stopgaps: **incorrectAnswerMarker**



---

archive/issue_events_216849.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-09-21T13:44:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216849"
}
```



---

archive/issue_events_216850.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-09-21T13:44:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216850"
}
```



---

archive/issue_events_216851.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-09-21T13:44:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216851"
}
```



---

archive/issue_events_216852.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2022-09-21T13:44:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216852"
}
```



---

archive/issue_comments_188230.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThis is fixed in #32367 and it should be tested by the testsuite.",
    "created_at": "2022-09-21T13:44:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188230",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:11" align="right">comment:11</div>

This is fixed in #32367 and it should be tested by the testsuite.



---

archive/issue_comments_188231.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks a lot, Tejasvi, Travis and Martin!",
    "created_at": "2022-09-21T13:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188231",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks a lot, Tejasvi, Travis and Martin!



---

archive/issue_comments_188232.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHi Darij!  I am glad you like it!  After #34552, you will like it even more :-)",
    "created_at": "2022-09-21T14:03:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188232",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:13" align="right">comment:13</div>

Hi Darij!  I am glad you like it!  After #34552, you will like it even more :-)



---

archive/issue_comments_188233.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-09-22T00:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15249#issuecomment-188233",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_events_216853.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-09-22T00:58:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216853"
}
```



---

archive/issue_events_216854.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-09-22T00:58:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216854"
}
```



---

archive/issue_events_216855.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-17T09:33:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216855"
}
```



---

archive/issue_events_216856.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-17T09:33:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216856"
}
```



---

archive/issue_events_216857.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-10-17T09:33:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15249",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15249#event-216857"
}
```
