# Issue 15346: Symbolic sums should evaluate

archive/issues_015109.json:
```json
{
    "body": "[This ask.sagemath question](http://ask.sagemath.org/question/3152) points out that \n\n```\nsage: k,n = var('k,n')\nsage: f(x,k) = sum((2/n)*(sin(n*x)*(-1)^(n+1)), n, 1, k)\nsage: f(x,2)\n-2*sum((-1)^n*sin(n*x)/n, n, 1, 2)\n```\nwhile\n\n```\nsage: f(x)=(2/n)*(sin(n*x)*(-1)^(n+1))\nsage: sum(f, n, 1, 2) #using summation function\n-sin(2*x) + 2*sin(x)\n```\nUser twch found this workaround\n\n```\nsage: var('n')\nsage: def g(x,k):\nsage:    return sum((2/n)*(sin(n*x)*(-1)^(n+1)), n, 1, k)\nsage: print g(x,2)\n-sin(2*x) + 2*sin(x)\n```\nbut I agree with him/her that we should look into how to fix this.\n\nThe essential problem is that when Maxima does not simplify a sum, we don't have any mechanism (currently) to get it to \"just print out all the numbers\".  Which of course may not be very nice when `k` is big, but presumably should be allowed to be done by users.\n\n---\n\nBy the way, the way to do this in Maxima is as follows:\n\n```\n\n(%i1) f: -2*'sum((-1)^n*sin(n*x)/n,n,1,2);\n                                2\n                               ====       n\n                               \\     (- 1)  sin(n x)\n(%o1)                      - 2  >    ---------------\n                               /            n\n                               ====\n                               n = 1\n\n(%i8) f, nouns;\n                                 sin(2 x)\n(%o8)                       - 2 (-------- - sin(x))\n                                    2\n```\nso setting `nouns:true` just for this would work, but I can never figure out how to do this from within Sage - see #10955.\n\nPossibly related: #9424\n\nSee also\n- \u200bhttp://ask.sagemath.org/question/9937/how-do-i-evaluate-sum-containing-factorial/\n- \u200bhttp://ask.sagemath.org/question/24911/exponentiation-makes-a-formula-go-crazy/ \n\nCC:  @orlitzky\n\nBranch/Commit: 3ee8c6d29ce916b70e5c0f32a0ae961796344afd\n\nReviewer: Karl-Dieter Crisman\n\nAuthor: Ralf Stephan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15346\n\n",
    "closed_at": "2015-02-17T19:28:13Z",
    "created_at": "2013-11-01T15:52:05Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "Symbolic sums should evaluate",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15346",
    "user": "https://github.com/kcrisman"
}
```
[This ask.sagemath question](http://ask.sagemath.org/question/3152) points out that 

```
sage: k,n = var('k,n')
sage: f(x,k) = sum((2/n)*(sin(n*x)*(-1)^(n+1)), n, 1, k)
sage: f(x,2)
-2*sum((-1)^n*sin(n*x)/n, n, 1, 2)
```
while

```
sage: f(x)=(2/n)*(sin(n*x)*(-1)^(n+1))
sage: sum(f, n, 1, 2) #using summation function
-sin(2*x) + 2*sin(x)
```
User twch found this workaround

```
sage: var('n')
sage: def g(x,k):
sage:    return sum((2/n)*(sin(n*x)*(-1)^(n+1)), n, 1, k)
sage: print g(x,2)
-sin(2*x) + 2*sin(x)
```
but I agree with him/her that we should look into how to fix this.

The essential problem is that when Maxima does not simplify a sum, we don't have any mechanism (currently) to get it to "just print out all the numbers".  Which of course may not be very nice when `k` is big, but presumably should be allowed to be done by users.

---

By the way, the way to do this in Maxima is as follows:

```

(%i1) f: -2*'sum((-1)^n*sin(n*x)/n,n,1,2);
                                2
                               ====       n
                               \     (- 1)  sin(n x)
(%o1)                      - 2  >    ---------------
                               /            n
                               ====
                               n = 1

(%i8) f, nouns;
                                 sin(2 x)
(%o8)                       - 2 (-------- - sin(x))
                                    2
```
so setting `nouns:true` just for this would work, but I can never figure out how to do this from within Sage - see #10955.

Possibly related: #9424

See also
- ​http://ask.sagemath.org/question/9937/how-do-i-evaluate-sum-containing-factorial/
- ​http://ask.sagemath.org/question/24911/exponentiation-makes-a-formula-go-crazy/ 

CC:  @orlitzky

Branch/Commit: 3ee8c6d29ce916b70e5c0f32a0ae961796344afd

Reviewer: Karl-Dieter Crisman

Author: Ralf Stephan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15346





---

archive/issue_events_044544.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44544"
}
```



---

archive/issue_events_044545.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44545"
}
```



---

archive/issue_events_044546.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44546"
}
```



---

archive/issue_events_044547.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44547"
}
```



---

archive/issue_events_044548.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44548"
}
```



---

archive/issue_comments_206488.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -48,6 +48,12 @@\n ```\n so setting `nouns:true` just for this would work, but I can never figure out how to do this from within Sage - see #10955.\n \n+Possibly related: #9424\n+\n+See also\n+- \u200bhttp://ask.sagemath.org/question/9937/how-do-i-evaluate-sum-containing-factorial/\n+- \u200bhttp://ask.sagemath.org/question/24911/exponentiation-makes-a-formula-go-crazy/ \n+\n Comment: 1\n \n Summary: symbolic sums that don't simplify don't simplify\n```\n",
    "created_at": "2014-12-02T08:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206488",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -48,6 +48,12 @@
 ```
 so setting `nouns:true` just for this would work, but I can never figure out how to do this from within Sage - see #10955.
 
+Possibly related: #9424
+
+See also
+- ​http://ask.sagemath.org/question/9937/how-do-i-evaluate-sum-containing-factorial/
+- ​http://ask.sagemath.org/question/24911/exponentiation-makes-a-formula-go-crazy/ 
+
 Comment: 1
 
 Summary: symbolic sums that don't simplify don't simplify
```




---

archive/issue_comments_206489.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-12-02T09:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206489",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_206490.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2014-12-02T09:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206490",
    "user": "https://github.com/rwst"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_comments_206491.json:
```json
{
    "body": "<a id='comment:7'></a>The issue however begs the question if it should not be possible to give hold parameter to sums.",
    "created_at": "2014-12-02T10:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206491",
    "user": "https://github.com/rwst"
}
```

<a id='comment:7'></a>The issue however begs the question if it should not be possible to give hold parameter to sums.



---

archive/issue_comments_206492.json:
```json
{
    "body": "<a id='comment:8'></a>Don't have time to review this immediately (though I think the `hold` would be a separate ticket, though an important one) but am wondering whether a couple of the more complex sums mentioned here and in the ask.sagemath questions should be included as tests.",
    "created_at": "2014-12-02T13:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206492",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>Don't have time to review this immediately (though I think the `hold` would be a separate ticket, though an important one) but am wondering whether a couple of the more complex sums mentioned here and in the ask.sagemath questions should be included as tests.



---

archive/issue_comments_206493.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-04T07:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_206494.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-01T16:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206494",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_206495.json:
```json
{
    "body": "<a id='comment:11'></a>You're going to get annoyed by this question, but I do feel it's a UI issue.  Is `simplify_sum` the right name for this?  I'm just wondering; it isn't exactly a \"simplification\".   Though `evaluate_sum` doesn't exactly get me excited either.  What do you think?  Also, I'm not 100% sure it should be in `simplify_full` - a very long one of these might feel more complicated than \"just the sum\".",
    "created_at": "2015-02-03T02:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206495",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>You're going to get annoyed by this question, but I do feel it's a UI issue.  Is `simplify_sum` the right name for this?  I'm just wondering; it isn't exactly a "simplification".   Though `evaluate_sum` doesn't exactly get me excited either.  What do you think?  Also, I'm not 100% sure it should be in `simplify_full` - a very long one of these might feel more complicated than "just the sum".



---

archive/issue_comments_206496.json:
```json
{
    "body": "<a id='comment:12'></a>I'm not so sure about UI issues here and elsewhere, either. I'm much in favor of those tickets proposing functions with keywords handling this, like `rewrite` or `expand(rules=\"sum\")`. Please see [symbolics](symbolics)#simplifyexpandsubstituteandrelationequalitytickets for these.\n\nIf we stick to `expand` and `rewrite`, what about `expand_sum`?",
    "created_at": "2015-02-03T09:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206496",
    "user": "https://github.com/rwst"
}
```

<a id='comment:12'></a>I'm not so sure about UI issues here and elsewhere, either. I'm much in favor of those tickets proposing functions with keywords handling this, like `rewrite` or `expand(rules="sum")`. Please see [symbolics](symbolics)#simplifyexpandsubstituteandrelationequalitytickets for these.

If we stick to `expand` and `rewrite`, what about `expand_sum`?



---

archive/issue_comments_206497.json:
```json
{
    "body": "<a id='comment:13'></a>I like `expand_sum`, and it would presumably work with `hold=True` later as well.\n\n> I'm much in favor of those tickets proposing functions with keywords handling this, \n\n\nIn retrospect that would have been a good design discussion to have had.  Though I should say that with tab-completion, I like the current system better.  Maxima has all these flags and such, and you have to *know* about them.  Your time is better spent adding the functionality you are - and I know it isn't getting reviewed very quickly, but experience says that they **will** get reviewed!  A number of the people who were pretty involved in symbolics have different jobs or school now, so they haven't been able to be as involved.  (I would have liked Burcin's input on this naming scheme, for instance, so it's not just two people.)  Pros and cons of open source development...",
    "created_at": "2015-02-03T14:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206497",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>I like `expand_sum`, and it would presumably work with `hold=True` later as well.

> I'm much in favor of those tickets proposing functions with keywords handling this, 


In retrospect that would have been a good design discussion to have had.  Though I should say that with tab-completion, I like the current system better.  Maxima has all these flags and such, and you have to *know* about them.  Your time is better spent adding the functionality you are - and I know it isn't getting reviewed very quickly, but experience says that they **will** get reviewed!  A number of the people who were pretty involved in symbolics have different jobs or school now, so they haven't been able to be as involved.  (I would have liked Burcin's input on this naming scheme, for instance, so it's not just two people.)  Pros and cons of open source development...



---

archive/issue_comments_206498.json:
```json
{
    "body": "<a id='comment:15'></a>Please review.\n\n---\nNew commits:",
    "created_at": "2015-02-03T17:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206498",
    "user": "https://github.com/rwst"
}
```

<a id='comment:15'></a>Please review.

---
New commits:



---

archive/issue_comments_206499.json:
```json
{
    "body": "<a id='comment:16'></a>\n```\n        Apply ``simplify_factorial``, ``simplify_trig``,\n        ``simplify_rational``, ``simplify_log``, again\n        ``simplify_rational``, and then ``expand_sum``\n        to self (in that order).\n```\nbut\n\n```\n        x = self\n        x = x.simplify_factorial()\n        x = x.simplify_rectform()\n        x = x.simplify_trig()\n        x = x.simplify_rational()\n        x = x.simplify_log('one')\n        x = x.simplify_rational()\n        x = x.expand_sum()\n        return x\n```",
    "created_at": "2015-02-03T18:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206499",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:16'></a>
```
        Apply ``simplify_factorial``, ``simplify_trig``,
        ``simplify_rational``, ``simplify_log``, again
        ``simplify_rational``, and then ``expand_sum``
        to self (in that order).
```
but

```
        x = self
        x = x.simplify_factorial()
        x = x.simplify_rectform()
        x = x.simplify_trig()
        x = x.simplify_rational()
        x = x.simplify_log('one')
        x = x.simplify_rational()
        x = x.expand_sum()
        return x
```



---

archive/issue_comments_206500.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-04T09:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_206501.json:
```json
{
    "body": "<a id='comment:18'></a>As I suspected, the addition of the log thing led to some issues.  Is this 'simplification' always valid for complex numbers?  I know mjo has been very good at thinking about this kind of thing, cc:ing him.\n\n```\n\nFile \"src/sage/symbolic/expression.pyx\", line 8249, in sage.symbolic.expression.Expression.simplify_full\nFailed example:\n    f.simplify_full()\nExpected:\n    log(x*y) - log(x) - log(y)\nGot:\n    0\n**********************************************************************\nFile \"src/sage/modules/vector_symbolic_dense.py\", line 19, in sage.modules.vector_symbolic_dense\nFailed example:\n    u.simplify_full()\nExpected:\n    (1, log(3*y) + log(2*y))\nGot:\n    (1, log(6*y^2))\n**********************************************************************\n```\nNaturally, this is orthogonal to the main issue, but I think it should be in a different ticket unless it's very obvious it's okay.\n\nAs to the main question, I think my only question is whether this should definitely be incorporated in `simplify_full`.  Can anyone think of a reason *not* to do so?  I'm straining my brain to be creative here - for instance, if it should make a really really really long expression which isn't \"simpler\"?  I can't find it but there was some Maxima comment about the massive length of some such expressions.  My druthers would be to keep this separate from `simplify_full` for now, though I understand the reasons *for* doing it!",
    "created_at": "2015-02-04T21:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206501",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>As I suspected, the addition of the log thing led to some issues.  Is this 'simplification' always valid for complex numbers?  I know mjo has been very good at thinking about this kind of thing, cc:ing him.

```

File "src/sage/symbolic/expression.pyx", line 8249, in sage.symbolic.expression.Expression.simplify_full
Failed example:
    f.simplify_full()
Expected:
    log(x*y) - log(x) - log(y)
Got:
    0
**********************************************************************
File "src/sage/modules/vector_symbolic_dense.py", line 19, in sage.modules.vector_symbolic_dense
Failed example:
    u.simplify_full()
Expected:
    (1, log(3*y) + log(2*y))
Got:
    (1, log(6*y^2))
**********************************************************************
```
Naturally, this is orthogonal to the main issue, but I think it should be in a different ticket unless it's very obvious it's okay.

As to the main question, I think my only question is whether this should definitely be incorporated in `simplify_full`.  Can anyone think of a reason *not* to do so?  I'm straining my brain to be creative here - for instance, if it should make a really really really long expression which isn't "simpler"?  I can't find it but there was some Maxima comment about the massive length of some such expressions.  My druthers would be to keep this separate from `simplify_full` for now, though I understand the reasons *for* doing it!



---

archive/issue_comments_206502.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 kcrisman]:\n> As I suspected, the addition of the log thing led to some issues.\n\n\nThis is just a conflict from having two branches modify `simplify_full` at the same time. You can rebase this one on top of \"develop\" now and I think it'll be fine. To avoid conflicts, I would,\n\n* Copy/paste the `expand_sum` method somewhere\n* reset --hard your branch to match \"develop\"\n* Add back the `expand_sum` method\n* Update `simplify_full` and its docstring\n* Recommit\n\nI'm sure there's a smarter way to do the copy/paste step, but it works.\n\n\n> Is this 'simplification' always valid for complex numbers?  I know mjo has been very good at thinking about this kind of thing, cc:ing him.\n\n\nIn the examples, `n` and `k` are complex, and it doesn't make any sense to sum from, say, zero a complex number. But if anything, the bug there is that `sum()` allows you to give it non-integer limits.\n\nThe Maxima docs aren't too clear about what `simplify_sum` does, so it's hard to say whether or not it's safe when the summand contains complex variables. We can try it and see what happens. Since it's hidden beneath `simplify_full` we could always go back and remove it if it causes problems.",
    "created_at": "2015-02-04T22:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206502",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:19'></a>Replying to [comment:18 kcrisman]:
> As I suspected, the addition of the log thing led to some issues.


This is just a conflict from having two branches modify `simplify_full` at the same time. You can rebase this one on top of "develop" now and I think it'll be fine. To avoid conflicts, I would,

* Copy/paste the `expand_sum` method somewhere
* reset --hard your branch to match "develop"
* Add back the `expand_sum` method
* Update `simplify_full` and its docstring
* Recommit

I'm sure there's a smarter way to do the copy/paste step, but it works.


> Is this 'simplification' always valid for complex numbers?  I know mjo has been very good at thinking about this kind of thing, cc:ing him.


In the examples, `n` and `k` are complex, and it doesn't make any sense to sum from, say, zero a complex number. But if anything, the bug there is that `sum()` allows you to give it non-integer limits.

The Maxima docs aren't too clear about what `simplify_sum` does, so it's hard to say whether or not it's safe when the summand contains complex variables. We can try it and see what happens. Since it's hidden beneath `simplify_full` we could always go back and remove it if it causes problems.



---

archive/issue_comments_206503.json:
```json
{
    "body": "<a id='comment:20'></a>> > Is this 'simplification' always valid for complex numbers? I know mjo has been very good at thinking about this kind of thing, cc:ing him.\n\n\nSorry, I meant the log bit.  Wait, was that already in develop?  I merged develop into this branch locally, should have been up-to-date.\n\nI'm not worried about the summation with complex variables, for the record, just trying to brainstorm.",
    "created_at": "2015-02-05T02:15:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206503",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>> > Is this 'simplification' always valid for complex numbers? I know mjo has been very good at thinking about this kind of thing, cc:ing him.


Sorry, I meant the log bit.  Wait, was that already in develop?  I merged develop into this branch locally, should have been up-to-date.

I'm not worried about the summation with complex variables, for the record, just trying to brainstorm.



---

archive/issue_comments_206504.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:20 kcrisman]:\n> \n> Sorry, I meant the log bit.  Wait, was that already in develop?  I merged develop into this branch locally, should have been up-to-date.\n> \n\n\n\nYikes, I guess not. I opened ticket #17731.",
    "created_at": "2015-02-05T02:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206504",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:21'></a>Replying to [comment:20 kcrisman]:
> 
> Sorry, I meant the log bit.  Wait, was that already in develop?  I merged develop into this branch locally, should have been up-to-date.
> 



Yikes, I guess not. I opened ticket #17731.



---

archive/issue_comments_206505.json:
```json
{
    "body": "<a id='comment:22'></a>Okay, so let's make that a dependency for this so that rws can rebase to that.  Sorry, Ralf, that's not your fault - good thing I ran all the tests!  And I *thought* I had recalled removing that simplification from `simplify_full`.",
    "created_at": "2015-02-05T02:37:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206505",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'></a>Okay, so let's make that a dependency for this so that rws can rebase to that.  Sorry, Ralf, that's not your fault - good thing I ran all the tests!  And I *thought* I had recalled removing that simplification from `simplify_full`.



---

archive/issue_comments_206506.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 kcrisman]:\n> Okay, so let's make that a dependency for this so that rws can rebase to that.  Sorry, Ralf, that's not your fault - good thing I ran all the tests!  And I *thought* I had recalled removing that simplification from `simplify_full`.\n\n\nI get more confused the more I look at this. Ralf's branch in ticket #17556 had mine as a parent, so my commits should have gone in along with his. After switching my branches around a few times, I see them now in develop.\n\nIf you `git checkout develop` and then `git pull`, do you see them there? (You can do `git log` then hit forward-slash to search.) If they were there to begin with, there should have been a merge conflict with this branch. But those two simplify doctests shouldn't be failing unless you wound up with a chimera.",
    "created_at": "2015-02-05T02:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206506",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:23'></a>Replying to [comment:22 kcrisman]:
> Okay, so let's make that a dependency for this so that rws can rebase to that.  Sorry, Ralf, that's not your fault - good thing I ran all the tests!  And I *thought* I had recalled removing that simplification from `simplify_full`.


I get more confused the more I look at this. Ralf's branch in ticket #17556 had mine as a parent, so my commits should have gone in along with his. After switching my branches around a few times, I see them now in develop.

If you `git checkout develop` and then `git pull`, do you see them there? (You can do `git log` then hit forward-slash to search.) If they were there to begin with, there should have been a merge conflict with this branch. But those two simplify doctests shouldn't be failing unless you wound up with a chimera.



---

archive/issue_comments_206507.json:
```json
{
    "body": "<a id='comment:24'></a>> If you git checkout develop and then git pull, do you see them there?\n\n\nYes.  Though I usually pull from trac not origin.  But in any case the branch I was working with for this ticket also has that already in it.  Yet on that branch I get\n\n```\nsage: z = log(3*x)+log(2*x)\nsage: z.simplify_full()\nlog(6*x^2)\n```\nI don't understand either. And\n\n```\n$ git merge develop\nAlready up-to-date.\n```\nas expected.",
    "created_at": "2015-02-05T03:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206507",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>> If you git checkout develop and then git pull, do you see them there?


Yes.  Though I usually pull from trac not origin.  But in any case the branch I was working with for this ticket also has that already in it.  Yet on that branch I get

```
sage: z = log(3*x)+log(2*x)
sage: z.simplify_full()
log(6*x^2)
```
I don't understand either. And

```
$ git merge develop
Already up-to-date.
```
as expected.



---

archive/issue_comments_206508.json:
```json
{
    "body": "<a id='comment:25'></a>Ok, I think I see what happened. False alarm. Looking at Ralf's original commit in comment 6, he added `simplify_sum` to `simplify_full`, but that was before I removed `simplify_log` and the redundant `simplify_rational`.\n\nIn comment 10, the git bot merges with develop, pulling in the patch that removed `simplify_log` and the redundant `simplify_rational`. But then in the commit from comment 16, the `simplify_log` and `simplify_rational` are back and git thinks they're being re-added.\n\nI'm not sure exactly where things went awry. At this point I usually throw my hands up, `git reset --hard`, and then copy/paste paste the code back where it's supposed to go. You can force-push the branch and check the link above to make sure it's not re-adding `simplify_log`.",
    "created_at": "2015-02-05T03:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206508",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:25'></a>Ok, I think I see what happened. False alarm. Looking at Ralf's original commit in comment 6, he added `simplify_sum` to `simplify_full`, but that was before I removed `simplify_log` and the redundant `simplify_rational`.

In comment 10, the git bot merges with develop, pulling in the patch that removed `simplify_log` and the redundant `simplify_rational`. But then in the commit from comment 16, the `simplify_log` and `simplify_rational` are back and git thinks they're being re-added.

I'm not sure exactly where things went awry. At this point I usually throw my hands up, `git reset --hard`, and then copy/paste paste the code back where it's supposed to go. You can force-push the branch and check the link above to make sure it's not re-adding `simplify_log`.



---

archive/issue_comments_206509.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:22 kcrisman]:\n>Sorry, Ralf, that's not your fault\nDisagree. I remember too that at some time I removed it before doing a local commit. But in \u200b17dda26 I seem to have added the log involuntarily nevertheless. That's why it's in this ticket branch and I'll remove it now. Then Michael seemed to assume that a different cause happened and based #17731 on that. So it's really me that has to apologize.",
    "created_at": "2015-02-05T07:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206509",
    "user": "https://github.com/rwst"
}
```

<a id='comment:26'></a>Replying to [comment:22 kcrisman]:
>Sorry, Ralf, that's not your fault
Disagree. I remember too that at some time I removed it before doing a local commit. But in ​17dda26 I seem to have added the log involuntarily nevertheless. That's why it's in this ticket branch and I'll remove it now. Then Michael seemed to assume that a different cause happened and based #17731 on that. So it's really me that has to apologize.



---

archive/issue_comments_206510.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-05T08:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_206511.json:
```json
{
    "body": "<a id='comment:28'></a>Okay, I got you on that.  I'll rerun tests this morning and add my stashed example I was going to add as a reviewer patch by the end of the day.",
    "created_at": "2015-02-05T13:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206511",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:28'></a>Okay, I got you on that.  I'll rerun tests this morning and add my stashed example I was going to add as a reviewer patch by the end of the day.



---

archive/issue_comments_206512.json:
```json
{
    "body": "<a id='comment:30'></a>Okay.  So I am happy with this, modulo the question about whether this really belongs in `simplify_full` - again, just because it could make something VERY long and not at all \"simple\".  I assume Ralf and I differ on this.  Michael, would you like to be the tiebreak?  I don't want to hold up this wrapping of Maxima's functionality.\n  \n---\nNew commits:",
    "created_at": "2015-02-05T16:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206512",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:30'></a>Okay.  So I am happy with this, modulo the question about whether this really belongs in `simplify_full` - again, just because it could make something VERY long and not at all "simple".  I assume Ralf and I differ on this.  Michael, would you like to be the tiebreak?  I don't want to hold up this wrapping of Maxima's functionality.
  
---
New commits:



---

archive/issue_comments_206513.json:
```json
{
    "body": "<a id='comment:31'></a>I think it's OK to have it in `simplify_full`. It's really annoying to have a sum of integers like,\n\n```\nsage: f(n=8)\nsum(abs(-k^2 + 8), k, 1, 8)\n```\n\nwith no way to get it down to a single number. (You can copy/paste the sum back in, but that may not be an option.) It's also a lot to ask of our users to know every method on the Expression class, but everyone knows `simplify_full`.\n\nIf it causes problems, we can remove it. Or if it makes some expressions a lot uglier, there's the hack I used in `simplify_rectform`:\n\n```\nif complexity_measure(simplified_expr) < complexity_measure(self):\n    return simplified_expr\nelse:\n    return self\n```\n\nI think it will be fine though.",
    "created_at": "2015-02-05T16:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206513",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:31'></a>I think it's OK to have it in `simplify_full`. It's really annoying to have a sum of integers like,

```
sage: f(n=8)
sum(abs(-k^2 + 8), k, 1, 8)
```

with no way to get it down to a single number. (You can copy/paste the sum back in, but that may not be an option.) It's also a lot to ask of our users to know every method on the Expression class, but everyone knows `simplify_full`.

If it causes problems, we can remove it. Or if it makes some expressions a lot uglier, there's the hack I used in `simplify_rectform`:

```
if complexity_measure(simplified_expr) < complexity_measure(self):
    return simplified_expr
else:
    return self
```

I think it will be fine though.



---

archive/issue_comments_206514.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-05T17:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206514",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_206515.json:
```json
{
    "body": "<a id='comment:32'></a>> If it causes problems, we can remove it. \n\nSomewhat of an API change, of course.  My guess is it won't come up often enough, but anyway thanks for the input!",
    "created_at": "2015-02-05T17:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206515",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:32'></a>> If it causes problems, we can remove it. 

Somewhat of an API change, of course.  My guess is it won't come up often enough, but anyway thanks for the input!



---

archive/issue_events_044549.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-06T16:18:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44549"
}
```



---

archive/issue_events_044550.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-06T16:18:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44550"
}
```



---

archive/issue_events_044551.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-17T19:28:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15346#event-44551"
}
```



---

archive/issue_comments_206516.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-17T19:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15346#issuecomment-206516",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
