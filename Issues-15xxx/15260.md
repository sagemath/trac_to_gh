# Issue 15260: Floor (integer) division of reals and rationals

archive/issues_015023.json:
```json
{
    "assignees": [],
    "body": "As reported in [1] and [2]\n\n```\nsage: x = 1/2 \nsage: x//2 \n1/4\nsage: RDF(5) // 2\n2.5\nsage: RIF(5) // 2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\nsage: QQ(7) // QQ(3)\n7/3\n```\n\n[1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ\n\nDepends on #2034\n\nCC:  @williamstein @sagetrac-tmonteil @zimmermann6\n\nBranch/Commit: **[u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260) @ [`616f88c`](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)**\n\nReviewer: **Jeroen Demeyer, Thierry Monteil**\n\nAuthor: **Jan Keitel, Jeroen Demeyer**\n\nComponent: **basic arithmetic**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15260_\n\n",
    "created_at": "2013-10-07T11:59:20Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20info"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Floor (integer) division of reals and rationals",
    "type": "issue",
    "updated_at": "2022-12-29T01:35:15Z",
    "url": "https://github.com/sagemath/sage/issues/15260",
    "user": "https://github.com/nathanncohen"
}
```
As reported in [1] and [2]

```
sage: x = 1/2 
sage: x//2 
1/4
sage: RDF(5) // 2
2.5
sage: RIF(5) // 2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
sage: QQ(7) // QQ(3)
7/3
```

[1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion
[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ

Depends on #2034

CC:  @williamstein @sagetrac-tmonteil @zimmermann6

Branch/Commit: **[u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260) @ [`616f88c`](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)**

Reviewer: **Jeroen Demeyer, Thierry Monteil**

Author: **Jan Keitel, Jeroen Demeyer**

Component: **basic arithmetic**

_Issue created by migration from https://trac.sagemath.org/ticket/15260_





---

archive/issue_events_214917.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-07T11:59:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214917"
}
```



---

archive/issue_events_214918.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-07T11:59:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20numerical",
    "label_color": "0000ff",
    "label_name": "c: numerical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214918"
}
```



---

archive/issue_events_214919.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-07T11:59:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214919"
}
```



---

archive/issue_events_214920.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-10-07T11:59:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214920"
}
```



---

archive/issue_comments_188264.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe reason is that for rationals (and apparently more generally for `FieldElement`), we have\n\n```\n    def __floordiv__(self, other):\n        return self / other\n```\n\nwhere it should be\n\n```\n    def __floordiv__(self, other):\n        return floor(self / other)\n```\n\nI will do a patch once i have compiled a more recent version of Sage\n\nWhat is fun is that\n\n```\nsage: RDF(0.5)//2\n0.25\n\nsage: RR(0.5)//2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfr.RealLiteral' and 'sage.rings.real_mpfr.RealNumber'\n```",
    "created_at": "2013-10-07T12:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188264",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:1" align="right">comment:1</div>

The reason is that for rationals (and apparently more generally for `FieldElement`), we have

```
    def __floordiv__(self, other):
        return self / other
```

where it should be

```
    def __floordiv__(self, other):
        return floor(self / other)
```

I will do a patch once i have compiled a more recent version of Sage

What is fun is that

```
sage: RDF(0.5)//2
0.25

sage: RR(0.5)//2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfr.RealLiteral' and 'sage.rings.real_mpfr.RealNumber'
```



---

archive/issue_events_214921.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214921"
}
```



---

archive/issue_events_214922.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214922"
}
```



---

archive/issue_events_214923.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214923"
}
```



---

archive/issue_events_214924.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214924"
}
```



---

archive/issue_comments_188265.json:
```json
{
    "body": "Author: **Jan Keitel**",
    "created_at": "2014-08-03T06:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188265",
    "user": "https://github.com/sagetrac-jkeitel"
}
```

Author: **Jan Keitel**



---

archive/issue_comments_188266.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHere's a branch that does this and implements a simple `floordiv` method for RR.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9146befe284a4fafd4f9df44d95607bc97f1c8a\"><code>c9146be</code></a></td><td><code>Fix floordiv of FieldElements.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab\"><code>fd78ca5</code></a></td><td><code>Floordiv for real_mpfr.</code></td></tr></table>\n",
    "created_at": "2014-08-03T06:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188266",
    "user": "https://github.com/sagetrac-jkeitel"
}
```

<div id="comment:4" align="right">comment:4</div>

Here's a branch that does this and implements a simple `floordiv` method for RR.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9146befe284a4fafd4f9df44d95607bc97f1c8a"><code>c9146be</code></a></td><td><code>Fix floordiv of FieldElements.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab"><code>fd78ca5</code></a></td><td><code>Floordiv for real_mpfr.</code></td></tr></table>




---

archive/issue_comments_188267.json:
```json
{
    "body": "Branch: **[u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)**",
    "created_at": "2014-08-03T06:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188267",
    "user": "https://github.com/sagetrac-jkeitel"
}
```

Branch: **[u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)**



---

archive/issue_comments_188268.json:
```json
{
    "body": "Commit: **[`fd78ca5`](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)**",
    "created_at": "2014-08-03T06:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188268",
    "user": "https://github.com/sagetrac-jkeitel"
}
```

Commit: **[`fd78ca5`](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)**



---

archive/issue_events_214925.json:
```json
{
    "actor": "https://github.com/sagetrac-jkeitel",
    "created_at": "2014-08-03T06:53:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214925"
}
```



---

archive/issue_comments_188269.json:
```json
{
    "body": "Changed branch from **[u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)** to **[u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260)**",
    "created_at": "2014-08-05T12:28:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188269",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)** to **[u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260)**



---

archive/issue_comments_188270.json:
```json
{
    "body": "Changed commit from **[`fd78ca5`](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)** to **[`fc5bca9`](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)**",
    "created_at": "2014-08-05T12:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188270",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`fd78ca5`](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)** to **[`fc5bca9`](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)**



---

archive/issue_events_214926.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-05T12:28:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "title_is": "Integer division of reals and rationals",
    "title_was": "Integer division of rationals",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214926"
}
```



---

archive/issue_comments_188271.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776\"><code>fc5bca9</code></a></td><td><code>RR floordiv: fix rounding</code></td></tr></table>\n",
    "created_at": "2014-08-05T12:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188271",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776"><code>fc5bca9</code></a></td><td><code>RR floordiv: fix rounding</code></td></tr></table>




---

archive/issue_comments_188272.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2014-08-05T12:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188272",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_188273.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nUsing the `floor()` function for every field is a bad idea, for many fields taking `floor()` does not make sense.",
    "created_at": "2014-08-05T12:44:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188273",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Using the `floor()` function for every field is a bad idea, for many fields taking `floor()` does not make sense.



---

archive/issue_comments_188274.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951\"><code>b49487a</code></a></td><td><code>Revert generic `__floordiv__`, add `__floordiv__` for rationals</code></td></tr></table>\n",
    "created_at": "2014-08-05T13:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188274",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951"><code>b49487a</code></a></td><td><code>Revert generic `__floordiv__`, add `__floordiv__` for rationals</code></td></tr></table>




---

archive/issue_comments_188275.json:
```json
{
    "body": "Changed commit from **[`fc5bca9`](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)** to **[`b49487a`](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)**",
    "created_at": "2014-08-05T13:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188275",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fc5bca9`](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)** to **[`b49487a`](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)**



---

archive/issue_comments_188276.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI suggest just making the fixes for reals and rationals and deferring the discussion about a generic `__floordiv__` to #2034.",
    "created_at": "2014-08-05T13:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188276",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

I suggest just making the fixes for reals and rationals and deferring the discussion about a generic `__floordiv__` to #2034.



---

archive/issue_comments_188277.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nRunning doctests now...",
    "created_at": "2014-08-05T13:12:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188277",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Running doctests now...



---

archive/issue_comments_188278.json:
```json
{
    "body": "Changed author from **Jan Keitel** to **Jan Keitel, Jeroen Demeyer**",
    "created_at": "2014-08-05T13:12:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188278",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Jan Keitel** to **Jan Keitel, Jeroen Demeyer**



---

archive/issue_comments_188279.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTests passed, needs review.",
    "created_at": "2014-08-05T14:43:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188279",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Tests passed, needs review.



---

archive/issue_events_214927.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214927"
}
```



---

archive/issue_events_214928.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214928"
}
```



---

archive/issue_comments_188280.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nCould the fix work at least for RDF and RIF ? The current situation is:\n\n\n```\nsage: RDF(5) // 2\n2.5\n\nsage: RIF(5) // 2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n```",
    "created_at": "2014-08-12T21:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188280",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:14" align="right">comment:14</div>

Could the fix work at least for RDF and RIF ? The current situation is:


```
sage: RDF(5) // 2
2.5

sage: RIF(5) // 2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
```



---

archive/issue_events_214929.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-08-12T21:34:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214929"
}
```



---

archive/issue_events_214930.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-08-12T21:34:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214930"
}
```



---

archive/issue_events_214931.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20numerical",
    "label_color": "0000ff",
    "label_name": "c: numerical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214931"
}
```



---

archive/issue_events_214932.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214932"
}
```



---

archive/issue_comments_188281.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,14 +2,14 @@\n \n ```\n sage: x = 1/2 \n-sage: x \n-1/2 \n sage: x//2 \n 1/4\n-``` \n+sage: RDF(5) // 2\n+2.5\n+sage: RIF(5) // 2\n+TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n+```\n \n-Though I have no idea how this kind of things is to be fixed `^^;`\n-\n-Nathann\n+This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.\n \n [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n``````\n",
    "created_at": "2014-08-13T07:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188281",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,14 +2,14 @@
 
 ```
 sage: x = 1/2 
-sage: x 
-1/2 
 sage: x//2 
 1/4
-``` 
+sage: RDF(5) // 2
+2.5
+sage: RIF(5) // 2
+TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
+```
 
-Though I have no idea how this kind of things is to be fixed `^^;`
-
-Nathann
+This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.
 
 [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion
``````




---

archive/issue_events_214933.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214933"
}
```



---

archive/issue_events_214934.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214934"
}
```



---

archive/issue_comments_188282.json:
```json
{
    "body": "Changed commit from **[`b49487a`](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)** to **[`a7dde8b`](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)**",
    "created_at": "2014-08-13T07:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188282",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b49487a`](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)** to **[`a7dde8b`](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)**



---

archive/issue_comments_188283.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b\"><code>a7dde8b</code></a></td><td><code>Add `__floordiv__` for RDF and RIF</code></td></tr></table>\n",
    "created_at": "2014-08-13T07:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188283",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b"><code>a7dde8b</code></a></td><td><code>Add `__floordiv__` for RDF and RIF</code></td></tr></table>




---

archive/issue_events_214935.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T09:52:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214935"
}
```



---

archive/issue_events_214936.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T09:52:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214936"
}
```



---

archive/issue_events_214937.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-08-24T21:32:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214937"
}
```



---

archive/issue_events_214938.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-08-24T21:32:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214938"
}
```



---

archive/issue_comments_188284.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?\n\nI do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.\n\nConcerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:\n\n```\nsage: RLF(5) // 2\n2.5000000000000000?\nsage: AA(5) // 2\n5/2\n```\n\nWhat about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?",
    "created_at": "2014-08-24T21:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188284",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:18" align="right">comment:18</div>

The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?

I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.

Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:

```
sage: RLF(5) // 2
2.5000000000000000?
sage: AA(5) // 2
5/2
```

What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?



---

archive/issue_comments_188285.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Thierry Monteil**",
    "created_at": "2014-08-24T21:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188285",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Thierry Monteil**



---

archive/issue_comments_188286.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A18):\n> The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?\n\nBecause I wanted something which behaves like `contains_zero()` but still works for any kind of element (unfortunately, `__floordiv__` doesn't use the coercion system).\n\n> Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:\n> \n> What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?\n\nThat's outside the scope of this ticket, but something like that could be done in a new ticket or as part of #2034.",
    "created_at": "2014-08-25T10:00:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188286",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@sagetrac-tmonteil](#comment%3A18):
> The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?

Because I wanted something which behaves like `contains_zero()` but still works for any kind of element (unfortunately, `__floordiv__` doesn't use the coercion system).

> Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:
> 
> What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?

That's outside the scope of this ticket, but something like that could be done in a new ticket or as part of #2034.



---

archive/issue_events_214939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T10:00:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214939"
}
```



---

archive/issue_events_214940.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T10:00:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214940"
}
```



---

archive/issue_comments_188287.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A18):\n> I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.\n\nYes, that was problematic, that is fixed now.",
    "created_at": "2014-08-25T13:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188287",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@sagetrac-tmonteil](#comment%3A18):
> I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.

Yes, that was problematic, that is fixed now.



---

archive/issue_events_214941.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T13:43:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214941"
}
```



---

archive/issue_events_214942.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T13:43:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214942"
}
```



---

archive/issue_comments_188288.json:
```json
{
    "body": "Changed commit from **[`a7dde8b`](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)** to **[`43eee88`](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)**",
    "created_at": "2014-08-25T13:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188288",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a7dde8b`](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)** to **[`43eee88`](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)**



---

archive/issue_comments_188289.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f\"><code>43eee88</code></a></td><td><code>RR __floordiv__: only coerce when needed</code></td></tr></table>\n",
    "created_at": "2014-08-25T13:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188289",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f"><code>43eee88</code></a></td><td><code>RR __floordiv__: only coerce when needed</code></td></tr></table>




---

archive/issue_events_214943.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-27T09:08:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "title_is": "Floor (integer) division of reals and rationals",
    "title_was": "Integer division of reals and rationals",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214943"
}
```



---

archive/issue_comments_188290.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIs there a reason for why we don't fix #2034 first? It seems its a really simple fix in `src/sage/structure/element.pyx`, just following what is done for `__div__`. Otherwise whoever wants to tackle that also has to undo the handcrafted type promotion from this ticket.",
    "created_at": "2014-10-04T11:58:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188290",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">comment:23</div>

Is there a reason for why we don't fix #2034 first? It seems its a really simple fix in `src/sage/structure/element.pyx`, just following what is done for `__div__`. Otherwise whoever wants to tackle that also has to undo the handcrafted type promotion from this ticket.



---

archive/issue_comments_188291.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@vbraun](#comment%3A23):\n> Is there a reason for why we don't fix #2034 first?\n\nNot really. Mostly, I don't know how to do it.",
    "created_at": "2014-10-04T21:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188291",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@vbraun](#comment%3A23):
> Is there a reason for why we don't fix #2034 first?

Not really. Mostly, I don't know how to do it.



---

archive/issue_comments_188292.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI do not agree with your semantic of `__floordiv__`. Within Sage `//` is meant for *internal division* (i.e. quotient of the euclidean division):\n\n```\nsage: x = polygen(ZZ)\nsage: p1 = (x+1)*(x+2)\nsage: p1 // (x+1)\nx + 2\nsage: _.parent()\nUnivariate Polynomial Ring in x over Integer Ring\nsage: sage: p1 / (x+1)\nx + 2\nsage: sage: _.parent()\nFraction Field of Univariate Polynomial Ring in x over Integer Ring\n```\n\nInside `RR` or `RDF` I am not sure what would be the point of `//`. This is a prefectly valid euclidean division `5 = 2 x 2.5 + 0`.",
    "created_at": "2015-04-30T10:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188292",
    "user": "https://github.com/videlec"
}
```

<div id="comment:25" align="right">comment:25</div>

I do not agree with your semantic of `__floordiv__`. Within Sage `//` is meant for *internal division* (i.e. quotient of the euclidean division):

```
sage: x = polygen(ZZ)
sage: p1 = (x+1)*(x+2)
sage: p1 // (x+1)
x + 2
sage: _.parent()
Univariate Polynomial Ring in x over Integer Ring
sage: sage: p1 / (x+1)
x + 2
sage: sage: _.parent()
Fraction Field of Univariate Polynomial Ring in x over Integer Ring
```

Inside `RR` or `RDF` I am not sure what would be the point of `//`. This is a prefectly valid euclidean division `5 = 2 x 2.5 + 0`.



---

archive/issue_events_214944.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-30T10:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214944"
}
```



---

archive/issue_events_214945.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-30T10:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214945"
}
```



---

archive/issue_events_214946.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214946"
}
```



---

archive/issue_events_214947.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214947"
}
```



---

archive/issue_events_214948.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214948"
}
```



---

archive/issue_events_214949.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214949"
}
```



---

archive/issue_comments_188293.json:
```json
{
    "body": "Dependencies: **#2034**",
    "created_at": "2016-01-19T17:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188293",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#2034**



---

archive/issue_comments_188294.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e8a5e386a7b9d0dc44b570136f2f1c1e9779834\"><code>5e8a5e3</code></a></td><td><code>Implement `__floordiv__` in the coercion model</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/835059f776bc5c281ceddb25a567b626ccb08251\"><code>835059f</code></a></td><td><code>Remove redundant `__floordiv__` from number field elements</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e0e5b803b339a0086ab491bec113ab7b9cd10c1\"><code>3e0e5b8</code></a></td><td><code>Add more doctests for floor division</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a2fbd136e686156f7b9f918ff59181cf899ec2f\"><code>3a2fbd1</code></a></td><td><code>Merge commit '43eee88a87eb44848b10fac661df963ac829fe3f' into ticket/15260</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1\"><code>616f88c</code></a></td><td><code>Use `_floordiv_` from the coercion model</code></td></tr></table>\n",
    "created_at": "2016-01-20T13:57:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188294",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e8a5e386a7b9d0dc44b570136f2f1c1e9779834"><code>5e8a5e3</code></a></td><td><code>Implement `__floordiv__` in the coercion model</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/835059f776bc5c281ceddb25a567b626ccb08251"><code>835059f</code></a></td><td><code>Remove redundant `__floordiv__` from number field elements</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e0e5b803b339a0086ab491bec113ab7b9cd10c1"><code>3e0e5b8</code></a></td><td><code>Add more doctests for floor division</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a2fbd136e686156f7b9f918ff59181cf899ec2f"><code>3a2fbd1</code></a></td><td><code>Merge commit '43eee88a87eb44848b10fac661df963ac829fe3f' into ticket/15260</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1"><code>616f88c</code></a></td><td><code>Use `_floordiv_` from the coercion model</code></td></tr></table>




---

archive/issue_comments_188295.json:
```json
{
    "body": "Changed commit from **[`43eee88`](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)** to **[`616f88c`](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)**",
    "created_at": "2016-01-20T13:57:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188295",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`43eee88`](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)** to **[`616f88c`](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)**



---

archive/issue_comments_188296.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-As reported there [1]\n+As reported in [1] and [2]\n \n ```\n sage: x = 1/2 \n@@ -8,8 +8,9 @@\n 2.5\n sage: RIF(5) // 2\n TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n+sage: QQ(7) // QQ(3)\n+7/3\n ```\n \n-This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.\n-\n [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n+[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ\n``````\n",
    "created_at": "2016-01-20T14:03:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188296",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-As reported there [1]
+As reported in [1] and [2]
 
 ```
 sage: x = 1/2 
@@ -8,8 +8,9 @@
 2.5
 sage: RIF(5) // 2
 TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
+sage: QQ(7) // QQ(3)
+7/3
 ```
 
-This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.
-
 [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion
+[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ
``````




---

archive/issue_events_214950.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-20T14:03:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214950"
}
```



---

archive/issue_events_214951.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-20T14:03:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214951"
}
```



---

archive/issue_comments_188297.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@videlec](#comment%3A25):\n> I do not agree with your semantic of `__floordiv__`.\n\nIt's consistent with Python's `__floordiv__` for `float`, so this what we should do according to the \"principle of least surprise\".",
    "created_at": "2016-01-20T14:03:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188297",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@videlec](#comment%3A25):
> I do not agree with your semantic of `__floordiv__`.

It's consistent with Python's `__floordiv__` for `float`, so this what we should do according to the "principle of least surprise".



---

archive/issue_events_214952.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-20T15:52:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214952"
}
```



---

archive/issue_events_214953.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-20T15:52:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214953"
}
```



---

archive/issue_comments_188298.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nIs that what we want\n\n```\nsage: QQ(7) // QQ(3)\n2\nsage: parent(_)\nInteger Ring\nsage: RR(7) // RR(3)\n2\nsage: parent(_)\nInteger Ring\n```\nFloordiv of two Python floats is a float (in both Python 2 and 3).",
    "created_at": "2016-01-20T15:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188298",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">comment:30</div>

Is that what we want

```
sage: QQ(7) // QQ(3)
2
sage: parent(_)
Integer Ring
sage: RR(7) // RR(3)
2
sage: parent(_)
Integer Ring
```
Floordiv of two Python floats is a float (in both Python 2 and 3).



---

archive/issue_comments_188299.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe sage-devel thread is in favor of throwing an exception. Really code shouldn't rely on `QQ.__floordiv__` as it is ambiguous and likely to cause difficult-to-see errors.",
    "created_at": "2016-01-20T20:57:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188299",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">comment:31</div>

The sage-devel thread is in favor of throwing an exception. Really code shouldn't rely on `QQ.__floordiv__` as it is ambiguous and likely to cause difficult-to-see errors.



---

archive/issue_comments_188300.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nBy the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python. Another reason for `__floordiv__` to be internal is that it gives a generic \"exact division\" method (division while you know in advance that the result is exact), which has several use cases. For instance if you want to take the primitive part of a polynomial: You can write a generic method which works over fields as well as over rings, as soon as you have a method `content` which returns 1 for fields and a more interesting content for rings.\u00b9 In a situation where `__floordiv__` raises an Exception, you must use a `__truediv__` and then convert to the original ring to obtain an exact division.\n\n\u00b9 This example may seem anecdotal though I constantly encounter the need for an exact division. Of course, this is only useful for generic implementation, which could be used with rings or fields.",
    "created_at": "2016-03-16T17:31:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188300",
    "user": "https://github.com/bgrenet"
}
```

<div id="comment:32" align="right">comment:32</div>

By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python. Another reason for `__floordiv__` to be internal is that it gives a generic "exact division" method (division while you know in advance that the result is exact), which has several use cases. For instance if you want to take the primitive part of a polynomial: You can write a generic method which works over fields as well as over rings, as soon as you have a method `content` which returns 1 for fields and a more interesting content for rings.¹ In a situation where `__floordiv__` raises an Exception, you must use a `__truediv__` and then convert to the original ring to obtain an exact division.

¹ This example may seem anecdotal though I constantly encounter the need for an exact division. Of course, this is only useful for generic implementation, which could be used with rings or fields.



---

archive/issue_comments_188301.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@bgrenet](#comment%3A32):\n> By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python.\n\nIn my opinion, `QQ` and `float` are very different things so I see no reason why their `__floordiv__` methods should be similar.",
    "created_at": "2016-03-16T21:07:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188301",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@bgrenet](#comment%3A32):
> By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python.

In my opinion, `QQ` and `float` are very different things so I see no reason why their `__floordiv__` methods should be similar.



---

archive/issue_comments_188302.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThat being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:\n\n```\nsage: QQ(7)//QQ(3)\n2\nsage: parent(QQ(7)//QQ(3))\nRational Field\n```\nwhich looks useful indeed. But I don't know if there is enough consensus for this.",
    "created_at": "2016-03-16T21:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188302",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:

```
sage: QQ(7)//QQ(3)
2
sage: parent(QQ(7)//QQ(3))
Rational Field
```
which looks useful indeed. But I don't know if there is enough consensus for this.



---

archive/issue_comments_188303.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI used `QQ` as an example, but the same holds for other fields. In the current branch, `__floordiv__` always returns an integer, while it should to my mind always be internal. Note that I am strongly against raising an exception since it would be a useless regression. (By this I mean that it would break some existing code, and bring nothing interesting.) I guess that my viewpoint is the same as (close to?) the one expressed by Vincent in [comment:28](#comment%3A28) and [comment:30](#comment%3A30).\n\nReplying to [@vbraun](#comment%3A31):\n> The sage-devel thread is in favor of throwing an exception. \n\nI do not see any such consensus in the sage-devel thread! You are the only one proposing to raise an exception... William says that it is a reasonable option, as is Jeroen's proposal.",
    "created_at": "2016-03-17T09:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188303",
    "user": "https://github.com/bgrenet"
}
```

<div id="comment:35" align="right">comment:35</div>

I used `QQ` as an example, but the same holds for other fields. In the current branch, `__floordiv__` always returns an integer, while it should to my mind always be internal. Note that I am strongly against raising an exception since it would be a useless regression. (By this I mean that it would break some existing code, and bring nothing interesting.) I guess that my viewpoint is the same as (close to?) the one expressed by Vincent in [comment:28](#comment%3A28) and [comment:30](#comment%3A30).

Replying to [@vbraun](#comment%3A31):
> The sage-devel thread is in favor of throwing an exception. 

I do not see any such consensus in the sage-devel thread! You are the only one proposing to raise an exception... William says that it is a reasonable option, as is Jeroen's proposal.



---

archive/issue_comments_188304.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nSee #21745 for modifying only QQ.\n\nActually I think that a good (partial) specification would be:\n- `//` and `%` should always be consistent when implemented\n- in non-trivial euclidean rings `a // b` and `a % b` should stand for the remainder and quotient of euclidean division (eg `ZZ`, `QQ[x]`). In these cases, it would just be aliases of `a.quo_rem(b)[0]` and `a.quo_rem(b)[1]`.\n- for subset of the reals it should be the natural extension of integer euclidean division as proposed in [this thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) (see also #21745 and #21747 for a concrete proposal)",
    "created_at": "2016-10-23T13:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188304",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

See #21745 for modifying only QQ.

Actually I think that a good (partial) specification would be:
- `//` and `%` should always be consistent when implemented
- in non-trivial euclidean rings `a // b` and `a % b` should stand for the remainder and quotient of euclidean division (eg `ZZ`, `QQ[x]`). In these cases, it would just be aliases of `a.quo_rem(b)[0]` and `a.quo_rem(b)[1]`.
- for subset of the reals it should be the natural extension of integer euclidean division as proposed in [this thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) (see also #21745 and #21747 for a concrete proposal)



---

archive/issue_comments_188305.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@jdemeyer](#comment%3A34):\n> That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:\n> \n> ```\n> sage: QQ(7)//QQ(3)\n> 2\n> sage: parent(QQ(7)//QQ(3))\n> Rational Field\n> ```\n> which looks useful indeed. But I don't know if there is enough consensus for this.\n\nWould make sense to me and would also be better from the coercion point of view. However in Sage we use to convert exact integer results to integer as in\n\n```\nsage: type((2.5).floor())\n<type 'sage.rings.integer.Integer'>\n```\n\nNote that Python is sloppy about the output type\n\n```\n>>> type(2.0 // 1.0)\nfloat\n>>> type(fractions.Fraction(2,1) // fractions.Fraction(1,1))\nint\n```\n(but `fractions` is not so much a standard)",
    "created_at": "2016-10-23T15:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-188305",
    "user": "https://github.com/videlec"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@jdemeyer](#comment%3A34):
> That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:
> 
> ```
> sage: QQ(7)//QQ(3)
> 2
> sage: parent(QQ(7)//QQ(3))
> Rational Field
> ```
> which looks useful indeed. But I don't know if there is enough consensus for this.

Would make sense to me and would also be better from the coercion point of view. However in Sage we use to convert exact integer results to integer as in

```
sage: type((2.5).floor())
<type 'sage.rings.integer.Integer'>
```

Note that Python is sloppy about the output type

```
>>> type(2.0 // 1.0)
float
>>> type(fractions.Fraction(2,1) // fractions.Fraction(1,1))
int
```
(but `fractions` is not so much a standard)



---

archive/issue_events_214954.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:35:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-214954"
}
```
