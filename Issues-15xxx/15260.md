# Issue 15260: Floor (integer) division of reals and rationals

archive/issues_015023.json:
```json
{
    "body": "As reported in [1] and [2]\n\n```\nsage: x = 1/2 \nsage: x//2 \n1/4\nsage: RDF(5) // 2\n2.5\nsage: RIF(5) // 2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\nsage: QQ(7) // QQ(3)\n7/3\n```\n\n[1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ\n\nDepends on #2034\n\n**CC:**  @williamstein tmonteil @zimmermann6\n\n**Branch:** [u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260)\n\n**Commit:** [616f88c009990bd9d778970ac2bb3496e500b1a1](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)\n\n**Reviewer:** Jeroen Demeyer, Thierry Monteil\n\n**Author:** Jan Keitel, Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/15260\n\n",
    "created_at": "2013-10-07T11:59:20Z",
    "labels": [
        "component: basic arithmetic",
        "bug",
        "needs info"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.1",
    "title": "Floor (integer) division of reals and rationals",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/15260",
    "user": "https://github.com/nathanncohen"
}
```
As reported in [1] and [2]

```
sage: x = 1/2 
sage: x//2 
1/4
sage: RDF(5) // 2
2.5
sage: RIF(5) // 2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
sage: QQ(7) // QQ(3)
7/3
```

[1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion
[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ

Depends on #2034

**CC:**  @williamstein tmonteil @zimmermann6

**Branch:** [u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260)

**Commit:** [616f88c009990bd9d778970ac2bb3496e500b1a1](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)

**Reviewer:** Jeroen Demeyer, Thierry Monteil

**Author:** Jan Keitel, Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/15260





---

archive/issue_comments_190709.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe reason is that for rationals (and apparently more generally for `FieldElement`), we have\n\n```\n    def __floordiv__(self, other):\n        return self / other\n```\n\nwhere it should be\n\n```\n    def __floordiv__(self, other):\n        return floor(self / other)\n```\n\nI will do a patch once i have compiled a more recent version of Sage\n\nWhat is fun is that\n\n```\nsage: RDF(0.5)//2\n0.25\n\nsage: RR(0.5)//2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfr.RealLiteral' and 'sage.rings.real_mpfr.RealNumber'\n```",
    "created_at": "2013-10-07T12:24:41Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190709",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:1'></a>
The reason is that for rationals (and apparently more generally for `FieldElement`), we have

```
    def __floordiv__(self, other):
        return self / other
```

where it should be

```
    def __floordiv__(self, other):
        return floor(self / other)
```

I will do a patch once i have compiled a more recent version of Sage

What is fun is that

```
sage: RDF(0.5)//2
0.25

sage: RR(0.5)//2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfr.RealLiteral' and 'sage.rings.real_mpfr.RealNumber'
```



---

archive/issue_events_134222.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134222"
}
```



---

archive/issue_events_134223.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134223"
}
```



---

archive/issue_events_134224.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134224"
}
```



---

archive/issue_events_134225.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134225"
}
```



---

archive/issue_comments_190710.json:
```json
{
    "body": "**Commit:** [fd78ca5e31972737b03f29f2703d356e8ea501ab](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)",
    "created_at": "2014-08-03T06:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190710",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

**Commit:** [fd78ca5e31972737b03f29f2703d356e8ea501ab](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)



---

archive/issue_comments_190711.json:
```json
{
    "body": "**Branch:** [u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)",
    "created_at": "2014-08-03T06:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190711",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

**Branch:** [u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)



---

archive/issue_comments_190712.json:
```json
{
    "body": "**Author:** Jan Keitel",
    "created_at": "2014-08-03T06:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190712",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

**Author:** Jan Keitel



---

archive/issue_comments_190713.json:
```json
{
    "body": "<a id='comment:4'></a>\nHere's a branch that does this and implements a simple `floordiv` method for RR.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9146befe284a4fafd4f9df44d95607bc97f1c8a\">c9146be</a></td><td><code>Fix floordiv of FieldElements.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab\">fd78ca5</a></td><td><code>Floordiv for real_mpfr.</code></td></tr></table>\n",
    "created_at": "2014-08-03T06:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190713",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

<a id='comment:4'></a>
Here's a branch that does this and implements a simple `floordiv` method for RR.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9146befe284a4fafd4f9df44d95607bc97f1c8a">c9146be</a></td><td><code>Fix floordiv of FieldElements.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab">fd78ca5</a></td><td><code>Floordiv for real_mpfr.</code></td></tr></table>




---

archive/issue_events_134226.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jkeitel",
    "created_at": "2014-08-03T06:53:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134226"
}
```



---

archive/issue_comments_190714.json:
```json
{
    "body": "**Changing branch** from \"[u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)\" to \"[u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260)\".",
    "created_at": "2014-08-05T12:28:00Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190714",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/jkeitel/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jkeitel/15260)" to "[u/jdemeyer/ticket/15260](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/15260)".



---

archive/issue_events_134227.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-05T12:28:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "rename": {
        "from": "Integer division of rationals",
        "to": "Integer division of reals and rationals"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134227"
}
```



---

archive/issue_comments_190715.json:
```json
{
    "body": "**Changing commit** from \"[fd78ca5e31972737b03f29f2703d356e8ea501ab](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)\" to \"[fc5bca925fd378a71eff488a1b3236bfced6d776](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)\".",
    "created_at": "2014-08-05T12:28:22Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190715",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[fd78ca5e31972737b03f29f2703d356e8ea501ab](https://github.com/sagemath/sagetrac-mirror/commit/fd78ca5e31972737b03f29f2703d356e8ea501ab)" to "[fc5bca925fd378a71eff488a1b3236bfced6d776](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)".



---

archive/issue_comments_190716.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2014-08-05T12:28:22Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190716",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_190717.json:
```json
{
    "body": "<a id='comment:7'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776\">fc5bca9</a></td><td><code>RR floordiv: fix rounding</code></td></tr></table>\n",
    "created_at": "2014-08-05T12:28:22Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190717",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776">fc5bca9</a></td><td><code>RR floordiv: fix rounding</code></td></tr></table>




---

archive/issue_comments_190718.json:
```json
{
    "body": "<a id='comment:8'></a>\nUsing the `floor()` function for every field is a bad idea, for many fields taking `floor()` does not make sense.",
    "created_at": "2014-08-05T12:44:48Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190718",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Using the `floor()` function for every field is a bad idea, for many fields taking `floor()` does not make sense.



---

archive/issue_comments_190719.json:
```json
{
    "body": "**Changing commit** from \"[fc5bca925fd378a71eff488a1b3236bfced6d776](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)\" to \"[b49487a1e046a1185d30d2a5694549c60493f951](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)\".",
    "created_at": "2014-08-05T13:10:40Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fc5bca925fd378a71eff488a1b3236bfced6d776](https://github.com/sagemath/sagetrac-mirror/commit/fc5bca925fd378a71eff488a1b3236bfced6d776)" to "[b49487a1e046a1185d30d2a5694549c60493f951](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)".



---

archive/issue_comments_190720.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951\">b49487a</a></td><td><code>Revert generic `__floordiv__`, add `__floordiv__` for rationals</code></td></tr></table>\n",
    "created_at": "2014-08-05T13:10:40Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951">b49487a</a></td><td><code>Revert generic `__floordiv__`, add `__floordiv__` for rationals</code></td></tr></table>




---

archive/issue_comments_190721.json:
```json
{
    "body": "<a id='comment:10'></a>\nI suggest just making the fixes for reals and rationals and deferring the discussion about a generic `__floordiv__` to #2034.",
    "created_at": "2014-08-05T13:11:22Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190721",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
I suggest just making the fixes for reals and rationals and deferring the discussion about a generic `__floordiv__` to #2034.



---

archive/issue_comments_190722.json:
```json
{
    "body": "**Changing author** from \"Jan Keitel\" to \"Jan Keitel, Jeroen Demeyer\".",
    "created_at": "2014-08-05T13:12:54Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190722",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Jan Keitel" to "Jan Keitel, Jeroen Demeyer".



---

archive/issue_comments_190723.json:
```json
{
    "body": "<a id='comment:11'></a>\nRunning doctests now...",
    "created_at": "2014-08-05T13:12:54Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190723",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Running doctests now...



---

archive/issue_comments_190724.json:
```json
{
    "body": "<a id='comment:12'></a>\nTests passed, needs review.",
    "created_at": "2014-08-05T14:43:16Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190724",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Tests passed, needs review.



---

archive/issue_events_134228.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134228"
}
```



---

archive/issue_events_134229.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134229"
}
```



---

archive/issue_comments_190725.json:
```json
{
    "body": "<a id='comment:14'></a>\nCould the fix work at least for RDF and RIF ? The current situation is:\n\n\n```\nsage: RDF(5) // 2\n2.5\n\nsage: RIF(5) // 2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n```",
    "created_at": "2014-08-12T21:34:32Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190725",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:14'></a>
Could the fix work at least for RDF and RIF ? The current situation is:


```
sage: RDF(5) // 2
2.5

sage: RIF(5) // 2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
```



---

archive/issue_events_134230.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2014-08-12T21:34:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134230"
}
```



---

archive/issue_events_134231.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2014-08-12T21:34:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134231"
}
```



---

archive/issue_events_134232.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "component: numerical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134232"
}
```



---

archive/issue_events_134233.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "component: basic arithmetic",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134233"
}
```



---

archive/issue_comments_190726.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,14 +2,14 @@\n \n ```\n sage: x = 1/2 \n-sage: x \n-1/2 \n sage: x//2 \n 1/4\n-``` \n+sage: RDF(5) // 2\n+2.5\n+sage: RIF(5) // 2\n+TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n+```\n \n-Though I have no idea how this kind of things is to be fixed `^^;`\n-\n-Nathann\n+This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.\n \n [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n``````\n",
    "created_at": "2014-08-13T07:10:24Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190726",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,14 +2,14 @@
 
 ```
 sage: x = 1/2 
-sage: x 
-1/2 
 sage: x//2 
 1/4
-``` 
+sage: RDF(5) // 2
+2.5
+sage: RIF(5) // 2
+TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
+```
 
-Though I have no idea how this kind of things is to be fixed `^^;`
-
-Nathann
+This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.
 
 [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion
``````




---

archive/issue_events_134234.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134234"
}
```



---

archive/issue_events_134235.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T07:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134235"
}
```



---

archive/issue_comments_190727.json:
```json
{
    "body": "**Changing commit** from \"[b49487a1e046a1185d30d2a5694549c60493f951](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)\" to \"[a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)\".",
    "created_at": "2014-08-13T07:48:09Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190727",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b49487a1e046a1185d30d2a5694549c60493f951](https://github.com/sagemath/sagetrac-mirror/commit/b49487a1e046a1185d30d2a5694549c60493f951)" to "[a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)".



---

archive/issue_comments_190728.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b\">a7dde8b</a></td><td><code>Add `__floordiv__` for RDF and RIF</code></td></tr></table>\n",
    "created_at": "2014-08-13T07:48:09Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190728",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b">a7dde8b</a></td><td><code>Add `__floordiv__` for RDF and RIF</code></td></tr></table>




---

archive/issue_events_134236.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T09:52:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134236"
}
```



---

archive/issue_events_134237.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-13T09:52:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134237"
}
```



---

archive/issue_events_134238.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2014-08-24T21:32:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134238"
}
```



---

archive/issue_events_134239.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2014-08-24T21:32:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134239"
}
```



---

archive/issue_comments_190729.json:
```json
{
    "body": "<a id='comment:18'></a>\nThe condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?\n\nI do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.\n\nConcerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:\n\n```\nsage: RLF(5) // 2\n2.5000000000000000?\nsage: AA(5) // 2\n5/2\n```\n\nWhat about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?",
    "created_at": "2014-08-24T21:32:56Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190729",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:18'></a>
The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?

I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.

Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:

```
sage: RLF(5) // 2
2.5000000000000000?
sage: AA(5) // 2
5/2
```

What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?



---

archive/issue_comments_190730.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Thierry Monteil\".",
    "created_at": "2014-08-24T21:32:56Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190730",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing reviewer** from "Jeroen Demeyer" to "Jeroen Demeyer, Thierry Monteil".



---

archive/issue_comments_190731.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [tmonteil](#comment%3A18):\n> The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?\n\nBecause I wanted something which behaves like `contains_zero()` but still works for any kind of element (unfortunately, `__floordiv__` doesn't use the coercion system).\n\n> Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:\n> \n> What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?\n\nThat's outside the scope of this ticket, but something like that could be done in a new ticket or as part of #2034.",
    "created_at": "2014-08-25T10:00:46Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190731",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Replying to [tmonteil](#comment%3A18):
> The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?

Because I wanted something which behaves like `contains_zero()` but still works for any kind of element (unfortunately, `__floordiv__` doesn't use the coercion system).

> Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:
> 
> What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?

That's outside the scope of this ticket, but something like that could be done in a new ticket or as part of #2034.



---

archive/issue_events_134240.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T10:00:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134240"
}
```



---

archive/issue_events_134241.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T10:00:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134241"
}
```



---

archive/issue_comments_190732.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [tmonteil](#comment%3A18):\n> I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.\n\nYes, that was problematic, that is fixed now.",
    "created_at": "2014-08-25T13:43:12Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190732",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Replying to [tmonteil](#comment%3A18):
> I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.

Yes, that was problematic, that is fixed now.



---

archive/issue_events_134242.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T13:43:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134242"
}
```



---

archive/issue_events_134243.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-25T13:43:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134243"
}
```



---

archive/issue_comments_190733.json:
```json
{
    "body": "**Changing commit** from \"[a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)\" to \"[43eee88a87eb44848b10fac661df963ac829fe3f](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)\".",
    "created_at": "2014-08-25T13:43:19Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190733",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b](https://github.com/sagemath/sagetrac-mirror/commit/a7dde8bebc558d4f3a7cff9f6c26dab40e2ec55b)" to "[43eee88a87eb44848b10fac661df963ac829fe3f](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)".



---

archive/issue_comments_190734.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f\">43eee88</a></td><td><code>RR __floordiv__: only coerce when needed</code></td></tr></table>\n",
    "created_at": "2014-08-25T13:43:19Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f">43eee88</a></td><td><code>RR __floordiv__: only coerce when needed</code></td></tr></table>




---

archive/issue_events_134244.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-08-27T09:08:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "rename": {
        "from": "Integer division of reals and rationals",
        "to": "Floor (integer) division of reals and rationals"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134244"
}
```



---

archive/issue_comments_190735.json:
```json
{
    "body": "<a id='comment:23'></a>\nIs there a reason for why we don't fix #2034 first? It seems its a really simple fix in `src/sage/structure/element.pyx`, just following what is done for `__div__`. Otherwise whoever wants to tackle that also has to undo the handcrafted type promotion from this ticket.",
    "created_at": "2014-10-04T11:58:19Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190735",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
Is there a reason for why we don't fix #2034 first? It seems its a really simple fix in `src/sage/structure/element.pyx`, just following what is done for `__div__`. Otherwise whoever wants to tackle that also has to undo the handcrafted type promotion from this ticket.



---

archive/issue_comments_190736.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [vbraun](#comment%3A23):\n> Is there a reason for why we don't fix #2034 first?\n\nNot really. Mostly, I don't know how to do it.",
    "created_at": "2014-10-04T21:22:07Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190736",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [vbraun](#comment%3A23):
> Is there a reason for why we don't fix #2034 first?

Not really. Mostly, I don't know how to do it.



---

archive/issue_comments_190737.json:
```json
{
    "body": "<a id='comment:25'></a>\nI do not agree with your semantic of `__floordiv__`. Within Sage `//` is meant for *internal division* (i.e. quotient of the euclidean division):\n\n```\nsage: x = polygen(ZZ)\nsage: p1 = (x+1)*(x+2)\nsage: p1 // (x+1)\nx + 2\nsage: _.parent()\nUnivariate Polynomial Ring in x over Integer Ring\nsage: sage: p1 / (x+1)\nx + 2\nsage: sage: _.parent()\nFraction Field of Univariate Polynomial Ring in x over Integer Ring\n```\n\nInside `RR` or `RDF` I am not sure what would be the point of `//`. This is a prefectly valid euclidean division `5 = 2 x 2.5 + 0`.",
    "created_at": "2015-04-30T10:19:56Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190737",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
I do not agree with your semantic of `__floordiv__`. Within Sage `//` is meant for *internal division* (i.e. quotient of the euclidean division):

```
sage: x = polygen(ZZ)
sage: p1 = (x+1)*(x+2)
sage: p1 // (x+1)
x + 2
sage: _.parent()
Univariate Polynomial Ring in x over Integer Ring
sage: sage: p1 / (x+1)
x + 2
sage: sage: _.parent()
Fraction Field of Univariate Polynomial Ring in x over Integer Ring
```

Inside `RR` or `RDF` I am not sure what would be the point of `//`. This is a prefectly valid euclidean division `5 = 2 x 2.5 + 0`.



---

archive/issue_events_134245.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-30T10:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134245"
}
```



---

archive/issue_events_134246.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-30T10:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134246"
}
```



---

archive/issue_events_134247.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134247"
}
```



---

archive/issue_events_134248.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134248"
}
```



---

archive/issue_comments_190738.json:
```json
{
    "body": "**Dependencies:** #2034",
    "created_at": "2016-01-19T17:41:51Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190738",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #2034



---

archive/issue_events_134249.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134249"
}
```



---

archive/issue_events_134250.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T17:41:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134250"
}
```



---

archive/issue_comments_190739.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e8a5e386a7b9d0dc44b570136f2f1c1e9779834\">5e8a5e3</a></td><td><code>Implement `__floordiv__` in the coercion model</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/835059f776bc5c281ceddb25a567b626ccb08251\">835059f</a></td><td><code>Remove redundant `__floordiv__` from number field elements</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e0e5b803b339a0086ab491bec113ab7b9cd10c1\">3e0e5b8</a></td><td><code>Add more doctests for floor division</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a2fbd136e686156f7b9f918ff59181cf899ec2f\">3a2fbd1</a></td><td><code>Merge commit '43eee88a87eb44848b10fac661df963ac829fe3f' into ticket/15260</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1\">616f88c</a></td><td><code>Use `_floordiv_` from the coercion model</code></td></tr></table>\n",
    "created_at": "2016-01-20T13:57:02Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190739",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e8a5e386a7b9d0dc44b570136f2f1c1e9779834">5e8a5e3</a></td><td><code>Implement `__floordiv__` in the coercion model</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/835059f776bc5c281ceddb25a567b626ccb08251">835059f</a></td><td><code>Remove redundant `__floordiv__` from number field elements</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e0e5b803b339a0086ab491bec113ab7b9cd10c1">3e0e5b8</a></td><td><code>Add more doctests for floor division</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a2fbd136e686156f7b9f918ff59181cf899ec2f">3a2fbd1</a></td><td><code>Merge commit '43eee88a87eb44848b10fac661df963ac829fe3f' into ticket/15260</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1">616f88c</a></td><td><code>Use `_floordiv_` from the coercion model</code></td></tr></table>




---

archive/issue_comments_190740.json:
```json
{
    "body": "**Changing commit** from \"[43eee88a87eb44848b10fac661df963ac829fe3f](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)\" to \"[616f88c009990bd9d778970ac2bb3496e500b1a1](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)\".",
    "created_at": "2016-01-20T13:57:02Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190740",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[43eee88a87eb44848b10fac661df963ac829fe3f](https://github.com/sagemath/sagetrac-mirror/commit/43eee88a87eb44848b10fac661df963ac829fe3f)" to "[616f88c009990bd9d778970ac2bb3496e500b1a1](https://github.com/sagemath/sagetrac-mirror/commit/616f88c009990bd9d778970ac2bb3496e500b1a1)".



---

archive/issue_comments_190741.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [vdelecroix](#comment%3A25):\n> I do not agree with your semantic of `__floordiv__`.\n\nIt's consistent with Python's `__floordiv__` for `float`, so this what we should do according to the \"principle of least surprise\".",
    "created_at": "2016-01-20T14:03:25Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190741",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
Replying to [vdelecroix](#comment%3A25):
> I do not agree with your semantic of `__floordiv__`.

It's consistent with Python's `__floordiv__` for `float`, so this what we should do according to the "principle of least surprise".



---

archive/issue_comments_190742.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-As reported there [1]\n+As reported in [1] and [2]\n \n ```\n sage: x = 1/2 \n@@ -8,8 +8,9 @@\n 2.5\n sage: RIF(5) // 2\n TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n+sage: QQ(7) // QQ(3)\n+7/3\n ```\n \n-This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.\n-\n [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n+[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ\n``````\n",
    "created_at": "2016-01-20T14:03:25Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190742",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-As reported there [1]
+As reported in [1] and [2]
 
 ```
 sage: x = 1/2 
@@ -8,8 +8,9 @@
 2.5
 sage: RIF(5) // 2
 TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
+sage: QQ(7) // QQ(3)
+7/3
 ```
 
-This ticket will fix floor division for these types, see also #2034 for implementing a generic `__floordiv__`.
-
 [1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion
+[2] https://groups.google.com/d/msg/sage-devel/nQDAMtqnEsY/HfpIdvc9AwAJ
``````




---

archive/issue_events_134251.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-20T14:03:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134251"
}
```



---

archive/issue_events_134252.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-20T14:03:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134252"
}
```



---

archive/issue_comments_190743.json:
```json
{
    "body": "<a id='comment:30'></a>\nIs that what we want\n\n```\nsage: QQ(7) // QQ(3)\n2\nsage: parent(_)\nInteger Ring\nsage: RR(7) // RR(3)\n2\nsage: parent(_)\nInteger Ring\n```\nFloordiv of two Python floats is a float (in both Python 2 and 3).",
    "created_at": "2016-01-20T15:52:10Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190743",
    "user": "https://github.com/videlec"
}
```

<a id='comment:30'></a>
Is that what we want

```
sage: QQ(7) // QQ(3)
2
sage: parent(_)
Integer Ring
sage: RR(7) // RR(3)
2
sage: parent(_)
Integer Ring
```
Floordiv of two Python floats is a float (in both Python 2 and 3).



---

archive/issue_events_134253.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-20T15:52:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134253"
}
```



---

archive/issue_events_134254.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-20T15:52:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15260#event-134254"
}
```



---

archive/issue_comments_190744.json:
```json
{
    "body": "<a id='comment:31'></a>\nThe sage-devel thread is in favor of throwing an exception. Really code shouldn't rely on `QQ.__floordiv__` as it is ambiguous and likely to cause difficult-to-see errors.",
    "created_at": "2016-01-20T20:57:45Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190744",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'></a>
The sage-devel thread is in favor of throwing an exception. Really code shouldn't rely on `QQ.__floordiv__` as it is ambiguous and likely to cause difficult-to-see errors.



---

archive/issue_comments_190745.json:
```json
{
    "body": "<a id='comment:32'></a>\nBy the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python. Another reason for `__floordiv__` to be internal is that it gives a generic \"exact division\" method (division while you know in advance that the result is exact), which has several use cases. For instance if you want to take the primitive part of a polynomial: You can write a generic method which works over fields as well as over rings, as soon as you have a method `content` which returns 1 for fields and a more interesting content for rings.\u00b9 In a situation where `__floordiv__` raises an Exception, you must use a `__truediv__` and then convert to the original ring to obtain an exact division.\n\n\u00b9 This example may seem anecdotal though I constantly encounter the need for an exact division. Of course, this is only useful for generic implementation, which could be used with rings or fields.",
    "created_at": "2016-03-16T17:31:33Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190745",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:32'></a>
By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python. Another reason for `__floordiv__` to be internal is that it gives a generic "exact division" method (division while you know in advance that the result is exact), which has several use cases. For instance if you want to take the primitive part of a polynomial: You can write a generic method which works over fields as well as over rings, as soon as you have a method `content` which returns 1 for fields and a more interesting content for rings.¹ In a situation where `__floordiv__` raises an Exception, you must use a `__truediv__` and then convert to the original ring to obtain an exact division.

¹ This example may seem anecdotal though I constantly encounter the need for an exact division. Of course, this is only useful for generic implementation, which could be used with rings or fields.



---

archive/issue_comments_190746.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [bruno](#comment%3A32):\n> By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python.\n\nIn my opinion, `QQ` and `float` are very different things so I see no reason why their `__floordiv__` methods should be similar.",
    "created_at": "2016-03-16T21:07:30Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190746",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
Replying to [bruno](#comment%3A32):
> By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python.

In my opinion, `QQ` and `float` are very different things so I see no reason why their `__floordiv__` methods should be similar.



---

archive/issue_comments_190747.json:
```json
{
    "body": "<a id='comment:34'></a>\nThat being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:\n\n```\nsage: QQ(7)//QQ(3)\n2\nsage: parent(QQ(7)//QQ(3))\nRational Field\n```\nwhich looks useful indeed. But I don't know if there is enough consensus for this.",
    "created_at": "2016-03-16T21:11:31Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190747",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:

```
sage: QQ(7)//QQ(3)
2
sage: parent(QQ(7)//QQ(3))
Rational Field
```
which looks useful indeed. But I don't know if there is enough consensus for this.



---

archive/issue_comments_190748.json:
```json
{
    "body": "<a id='comment:35'></a>\nI used `QQ` as an example, but the same holds for other fields. In the current branch, `__floordiv__` always returns an integer, while it should to my mind always be internal. Note that I am strongly against raising an exception since it would be a useless regression. (By this I mean that it would break some existing code, and bring nothing interesting.) I guess that my viewpoint is the same as (close to?) the one expressed by Vincent in [comment:28](#comment%3A28) and [comment:30](#comment%3A30).\n\nReplying to [vbraun](#comment%3A31):\n> The sage-devel thread is in favor of throwing an exception. \n\nI do not see any such consensus in the sage-devel thread! You are the only one proposing to raise an exception... William says that it is a reasonable option, as is Jeroen's proposal.",
    "created_at": "2016-03-17T09:04:22Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190748",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:35'></a>
I used `QQ` as an example, but the same holds for other fields. In the current branch, `__floordiv__` always returns an integer, while it should to my mind always be internal. Note that I am strongly against raising an exception since it would be a useless regression. (By this I mean that it would break some existing code, and bring nothing interesting.) I guess that my viewpoint is the same as (close to?) the one expressed by Vincent in [comment:28](#comment%3A28) and [comment:30](#comment%3A30).

Replying to [vbraun](#comment%3A31):
> The sage-devel thread is in favor of throwing an exception. 

I do not see any such consensus in the sage-devel thread! You are the only one proposing to raise an exception... William says that it is a reasonable option, as is Jeroen's proposal.



---

archive/issue_comments_190749.json:
```json
{
    "body": "<a id='comment:36'></a>\nSee #21745 for modifying only QQ.\n\nActually I think that a good (partial) specification would be:\n- `//` and `%` should always be consistent when implemented\n- in non-trivial euclidean rings `a // b` and `a % b` should stand for the remainder and quotient of euclidean division (eg `ZZ`, `QQ[x]`). In these cases, it would just be aliases of `a.quo_rem(b)[0]` and `a.quo_rem(b)[1]`.\n- for subset of the reals it should be the natural extension of integer euclidean division as proposed in [this thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) (see also #21745 and #21747 for a concrete proposal)",
    "created_at": "2016-10-23T13:52:02Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190749",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>
See #21745 for modifying only QQ.

Actually I think that a good (partial) specification would be:
- `//` and `%` should always be consistent when implemented
- in non-trivial euclidean rings `a // b` and `a % b` should stand for the remainder and quotient of euclidean division (eg `ZZ`, `QQ[x]`). In these cases, it would just be aliases of `a.quo_rem(b)[0]` and `a.quo_rem(b)[1]`.
- for subset of the reals it should be the natural extension of integer euclidean division as proposed in [this thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) (see also #21745 and #21747 for a concrete proposal)



---

archive/issue_comments_190750.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [jdemeyer](#comment%3A34):\n> That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:\n> \n> ```\n> sage: QQ(7)//QQ(3)\n> 2\n> sage: parent(QQ(7)//QQ(3))\n> Rational Field\n> ```\n> which looks useful indeed. But I don't know if there is enough consensus for this.\n\nWould make sense to me and would also be better from the coercion point of view. However in Sage we use to convert exact integer results to integer as in\n\n```\nsage: type((2.5).floor())\n<type 'sage.rings.integer.Integer'>\n```\n\nNote that Python is sloppy about the output type\n\n```\n>>> type(2.0 // 1.0)\nfloat\n>>> type(fractions.Fraction(2,1) // fractions.Fraction(1,1))\nint\n```\n(but `fractions` is not so much a standard)",
    "created_at": "2016-10-23T15:30:42Z",
    "issue": "https://github.com/sagemath/sage/issues/15260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15260#issuecomment-190750",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>
Replying to [jdemeyer](#comment%3A34):
> That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:
> 
> ```
> sage: QQ(7)//QQ(3)
> 2
> sage: parent(QQ(7)//QQ(3))
> Rational Field
> ```
> which looks useful indeed. But I don't know if there is enough consensus for this.

Would make sense to me and would also be better from the coercion point of view. However in Sage we use to convert exact integer results to integer as in

```
sage: type((2.5).floor())
<type 'sage.rings.integer.Integer'>
```

Note that Python is sloppy about the output type

```
>>> type(2.0 // 1.0)
float
>>> type(fractions.Fraction(2,1) // fractions.Fraction(1,1))
int
```
(but `fractions` is not so much a standard)
