# Issue 15428: Partitions to posets

archive/issues_015191.json:
```json
{
    "body": "This adds methods to `partition.py` and `skew_partition.py` that take a partition to its corresponding poset. The user can choose the orientation of the poset from currently 4 geographical ones (if anyone knows some more -- let me know).\n\nCC:  sage-combinat @tscrim @anneschilling @nathanncohen\n\nKeywords: sage-combinat, partition, poset\n\nReviewer: Travis Scrimshaw\n\nAuthor: Darij Grinberg\n\nBranch: public/combinat/partitions_posets\n\nDependencies: #15350\n\nCommit: b36286fef9ed6cc9f0b01dce6208add4b3acac0d\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15428\n\n",
    "closed_at": "2014-02-02T22:07:13Z",
    "created_at": "2013-11-16T21:40:07Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Partitions to posets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15428",
    "user": "https://github.com/darijgr"
}
```
This adds methods to `partition.py` and `skew_partition.py` that take a partition to its corresponding poset. The user can choose the orientation of the poset from currently 4 geographical ones (if anyone knows some more -- let me know).

CC:  sage-combinat @tscrim @anneschilling @nathanncohen

Keywords: sage-combinat, partition, poset

Reviewer: Travis Scrimshaw

Author: Darij Grinberg

Branch: public/combinat/partitions_posets

Dependencies: #15350

Commit: b36286fef9ed6cc9f0b01dce6208add4b3acac0d

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15428





---

archive/issue_comments_207981.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-11-16T22:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207981",
    "user": "https://github.com/darijgr"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207982.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n-Add methods to `partition.py` and `skew_partition.py` that take a partition to its corresponding poset. The user chooses the orientation of the poset.\n-\n-I've done the `partition.py` method; the other is to come soon.\n+This adds methods to `partition.py` and `skew_partition.py` that take a partition to its corresponding poset. The user can choose the orientation of the poset from currently 4 geographical ones (if anyone knows some more -- let me know).\n \n Dependencies: #15350\n \n```\n",
    "created_at": "2013-11-16T22:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207982",
    "user": "https://github.com/darijgr"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,4 @@
-Add methods to `partition.py` and `skew_partition.py` that take a partition to its corresponding poset. The user chooses the orientation of the poset.
-
-I've done the `partition.py` method; the other is to come soon.
+This adds methods to `partition.py` and `skew_partition.py` that take a partition to its corresponding poset. The user can choose the orientation of the poset from currently 4 geographical ones (if anyone knows some more -- let me know).
 
 Dependencies: #15350
 
```




---

archive/issue_comments_207983.json:
```json
{
    "body": "<a id='comment:2'></a>Wrong formatting in docstrings fixed; thanks Nathan!",
    "created_at": "2013-11-17T22:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207983",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:2'></a>Wrong formatting in docstrings fixed; thanks Nathan!



---

archive/issue_comments_207984.json:
```json
{
    "body": "<a id='comment:3'></a>Looks good to me. Thanks.",
    "created_at": "2013-11-30T00:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207984",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Looks good to me. Thanks.



---

archive/issue_comments_207985.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-11-30T00:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207985",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207986.json:
```json
{
    "body": "<a id='comment:4'></a>The documentation doesn't build properly:\n\n```\ndochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/partition.py:docstring of sage.combinat.partition.Partition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.\ndochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/partition.py:docstring of sage.combinat.partition.Partition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.\ndochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/skew_partition.py:docstring of sage.combinat.skew_partition.SkewPartition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.\ndochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/skew_partition.py:docstring of sage.combinat.skew_partition.SkewPartition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.\n```",
    "created_at": "2013-11-30T14:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207986",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>The documentation doesn't build properly:

```
dochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/partition.py:docstring of sage.combinat.partition.Partition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.
dochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/partition.py:docstring of sage.combinat.partition.Partition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.
dochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/skew_partition.py:docstring of sage.combinat.skew_partition.SkewPartition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.
dochtml.log:[combinat ] /scratch/release/merger/sage-5.13.rc0/local/lib/python2.7/site-packages/sage/combinat/skew_partition.py:docstring of sage.combinat.skew_partition.SkewPartition.poset:21: WARNING: Inline interpreted text or phrase reference start-string without end-string.
```



---

archive/issue_comments_207987.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-11-30T14:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207987",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_207988.json:
```json
{
    "body": "<a id='comment:5'></a>Thanks for spotting this one! It's weird: apparently sphinx doesn't like\n`the `5`th element`\n(but\n`the `5`-th element`\nworks fine).",
    "created_at": "2013-11-30T17:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207988",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:5'></a>Thanks for spotting this one! It's weird: apparently sphinx doesn't like
`the `5`th element`
(but
`the `5`-th element`
works fine).



---

archive/issue_comments_207989.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-11-30T17:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207989",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_207990.json:
```json
{
    "body": "<a id='comment:6'></a>I agree that there is a natural correspondance between a tableau (or more generally filling) and a poset. So having a poset method in tableaux definitely makes sense.\n\nHere the process is more about getting from a partition to a tableaux (or filling) using some filling scheme, and then asking for the poset. It would be natural for the invokation to reflect that:\n\n```\n    sage: P = Partition(...)\n    sage: P.tableau(orientation).poset()          # or P.filling(orientation)\n```\n\nIf you believe a shorthand for the above really brings something to the user, please find something more explicit than just `poset`.\n\nIn general: I am super glad of all the work you are both puting into Sage, and all the progress that comes from the pair of you crossreviewing. But please keep in mind that we will have to maintain the code in the long run; so think *really, really* hard about good user interface and conciseness.\n\nThanks guys! Keep it up!\n                                                 Nicolas",
    "created_at": "2013-12-01T09:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207990",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:6'></a>I agree that there is a natural correspondance between a tableau (or more generally filling) and a poset. So having a poset method in tableaux definitely makes sense.

Here the process is more about getting from a partition to a tableaux (or filling) using some filling scheme, and then asking for the poset. It would be natural for the invokation to reflect that:

```
    sage: P = Partition(...)
    sage: P.tableau(orientation).poset()          # or P.filling(orientation)
```

If you believe a shorthand for the above really brings something to the user, please find something more explicit than just `poset`.

In general: I am super glad of all the work you are both puting into Sage, and all the progress that comes from the pair of you crossreviewing. But please keep in mind that we will have to maintain the code in the long run; so think *really, really* hard about good user interface and conciseness.

Thanks guys! Keep it up!
                                                 Nicolas



---

archive/issue_comments_207991.json:
```json
{
    "body": "<a id='comment:7'></a>Hi Nicholas,\n\nwhat exactly should the `poset()` method on tableaux do? The way I understand the situation, the poset really comes from the *diagram*. I could imagine relabelling it according to the entries in a permutation tableau, but that's not the way I was thinking about it. If I correctly understand your proposal, my `P.poset(orientation=\"SE\")` would be something like `P.superstandard_tableau().poset()` in your syntax, which is quite roundabout in my opinion since the superstandard tableau (the tableau in which you put 1, 2, ..., |P| just row by row) is a red herring to my construction (it could just as well be the co-superstandard one, where you proceed column by column; it is certainly not canonical). But TBH the main reason why I don't want to change things right now is that I want `tableaux.py` to be redone by myself or someone else (IIRC we have discussed this long ago, and I'd be happy to discuss this again, though I probably can't meet your demands on speed and MuPAD-combinat code reuse -- my goals are more about getting `skew_tableau` closer to `tableaux`'s feature completeness, and about implementing plane partitions and some variations of my own) and I'm not very keen on using the current implementation where it isn't absolutely necessary.\n\nBest regards,\\\\\nDarij",
    "created_at": "2013-12-01T17:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207991",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:7'></a>Hi Nicholas,

what exactly should the `poset()` method on tableaux do? The way I understand the situation, the poset really comes from the *diagram*. I could imagine relabelling it according to the entries in a permutation tableau, but that's not the way I was thinking about it. If I correctly understand your proposal, my `P.poset(orientation="SE")` would be something like `P.superstandard_tableau().poset()` in your syntax, which is quite roundabout in my opinion since the superstandard tableau (the tableau in which you put 1, 2, ..., |P| just row by row) is a red herring to my construction (it could just as well be the co-superstandard one, where you proceed column by column; it is certainly not canonical). But TBH the main reason why I don't want to change things right now is that I want `tableaux.py` to be redone by myself or someone else (IIRC we have discussed this long ago, and I'd be happy to discuss this again, though I probably can't meet your demands on speed and MuPAD-combinat code reuse -- my goals are more about getting `skew_tableau` closer to `tableaux`'s feature completeness, and about implementing plane partitions and some variations of my own) and I'm not very keen on using the current implementation where it isn't absolutely necessary.

Best regards,\\
Darij



---

archive/issue_comments_207992.json:
```json
{
    "body": "<a id='comment:8'></a>OOPS, I was stupid: With your convention, `P.poset()` would not be `P.superstandard_tableau().poset()` but rather something like `P.tautological_tableau().poset()`, where `tautological_tableau()` puts the pair of the coordinates of each cell into that cell (another function that probably needs to be made). For this method to generalize to arbitrary tableaux, though, one would have to check that all entries are pairwise distinct, which is a waste of time (OK, so a `check` variable?). But to be honest, I'd very much prefer to have this method defined on partitions first and later maybe add it to tableaux as well. If I were to search for it, I would definitely not have started by constructing a tableau out of `p`...",
    "created_at": "2013-12-01T18:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207992",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:8'></a>OOPS, I was stupid: With your convention, `P.poset()` would not be `P.superstandard_tableau().poset()` but rather something like `P.tautological_tableau().poset()`, where `tautological_tableau()` puts the pair of the coordinates of each cell into that cell (another function that probably needs to be made). For this method to generalize to arbitrary tableaux, though, one would have to check that all entries are pairwise distinct, which is a waste of time (OK, so a `check` variable?). But to be honest, I'd very much prefer to have this method defined on partitions first and later maybe add it to tableaux as well. If I were to search for it, I would definitely not have started by constructing a tableau out of `p`...



---

archive/issue_comments_207993.json:
```json
{
    "body": "<a id='comment:9'></a>Hi Darij,\n\nI think Nicolas' point is that it is more natural to define posets associated to tableaux than partitions. The partition poset that you implemented could then be easily obtained from that. You could use\n\n```\nsage: t = Tableau([[1,2,3],[4,5,6],[7]])\nsage: t.cells_containing(1)\n[(0, 0)]\n```\nto label the cells by their coordinates. In Sage we should have general purpose methods rather than very specific methods. If I understand correctly, this is his point!\n\nAnne\n\nPS: I do not understand your comment that all entries are pairwise distinct. Cells inside a tableau/partition are always all distinct.",
    "created_at": "2013-12-01T21:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207993",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:9'></a>Hi Darij,

I think Nicolas' point is that it is more natural to define posets associated to tableaux than partitions. The partition poset that you implemented could then be easily obtained from that. You could use

```
sage: t = Tableau([[1,2,3],[4,5,6],[7]])
sage: t.cells_containing(1)
[(0, 0)]
```
to label the cells by their coordinates. In Sage we should have general purpose methods rather than very specific methods. If I understand correctly, this is his point!

Anne

PS: I do not understand your comment that all entries are pairwise distinct. Cells inside a tableau/partition are always all distinct.



---

archive/issue_comments_207994.json:
```json
{
    "body": "<a id='comment:10'></a>Hi Anne,\n\nThe way I understand Nicolas, the poset would be labelled by the *entries* of the tableau, not by the *cells* of the tableau. So the entries would have to be distinct (and hashable). I still think that refactoring the method through a `poset` method in `Tableaux` would be unnatural. On the other hand, I'm not against *adding* an (independent) `poset` method in `Tableaux`, once the latter class has been revamped.\n\nGreets,\\\nDarij",
    "created_at": "2013-12-01T21:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207994",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:10'></a>Hi Anne,

The way I understand Nicolas, the poset would be labelled by the *entries* of the tableau, not by the *cells* of the tableau. So the entries would have to be distinct (and hashable). I still think that refactoring the method through a `poset` method in `Tableaux` would be unnatural. On the other hand, I'm not against *adding* an (independent) `poset` method in `Tableaux`, once the latter class has been revamped.

Greets,\
Darij



---

archive/issue_comments_207995.json:
```json
{
    "body": "<a id='comment:11'></a>Ok, I had missed the fact that the poset you created was indexed by the cells (i,j). That's a reasonable reason to put at least a shorthand in partition. \n\nI let you chose the final design and timeline (for this ticket or later) for the best, knowing that:\n\n- Having a method on standard fillings that build the poset would be generally useful\n\n- Having a method on partitions building a standard filling containing the coordinates of the cells could be useful elsewhere.\n\n- The cost of checking that all entries of a filling are distinct and hashable is really negligible compared to that of building a poset.\n\n- I for myself would not have looked for such a method in Partition in the first place :-)\n\n- The name \"poset\", for a partition, is not explicit enough. I would need to read the documentation to know which poset this is about.\n\nCheers,",
    "created_at": "2013-12-02T07:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207995",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:11'></a>Ok, I had missed the fact that the poset you created was indexed by the cells (i,j). That's a reasonable reason to put at least a shorthand in partition. 

I let you chose the final design and timeline (for this ticket or later) for the best, knowing that:

- Having a method on standard fillings that build the poset would be generally useful

- Having a method on partitions building a standard filling containing the coordinates of the cells could be useful elsewhere.

- The cost of checking that all entries of a filling are distinct and hashable is really negligible compared to that of building a poset.

- I for myself would not have looked for such a method in Partition in the first place :-)

- The name "poset", for a partition, is not explicit enough. I would need to read the documentation to know which poset this is about.

Cheers,



---

archive/issue_comments_207996.json:
```json
{
    "body": "<a id='comment:12'></a>I guess my takeaway is then to add similar methods to `Tableaux` once the class is in less of a disarray.\n\nAbout the name: What do you think about `cell_poset`? I fear there is no standard name in literature...",
    "created_at": "2013-12-02T07:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207996",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:12'></a>I guess my takeaway is then to add similar methods to `Tableaux` once the class is in less of a disarray.

About the name: What do you think about `cell_poset`? I fear there is no standard name in literature...



---

archive/issue_comments_207997.json:
```json
{
    "body": "<a id='comment:13'></a>The same name just came out independently in my head. So it's probably not too bad :-)",
    "created_at": "2013-12-02T07:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207997",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:13'></a>The same name just came out independently in my head. So it's probably not too bad :-)



---

archive/issue_comments_207998.json:
```json
{
    "body": "<a id='comment:14'></a>Btw:\n\n- The code to build the covers in the poset is not DRY. The duplication could be removed by having two little helper functions to index the rows and columns\n\n- Instead one option with four values for the input, there could possibly be two options, one for the vertical orientation, one for the horizontal orientation. I have no great idea for the name of those options though.\n\n- Please put as first example the default value which shows that this is using the usual indexing of the rows and columns of a tableau.\n\nThanks!",
    "created_at": "2013-12-02T07:53:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207998",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'></a>Btw:

- The code to build the covers in the poset is not DRY. The duplication could be removed by having two little helper functions to index the rows and columns

- Instead one option with four values for the input, there could possibly be two options, one for the vertical orientation, one for the horizontal orientation. I have no great idea for the name of those options though.

- Please put as first example the default value which shows that this is using the usual indexing of the rows and columns of a tableau.

Thanks!



---

archive/issue_comments_207999.json:
```json
{
    "body": "<a id='comment:15'></a>OK, tomorrow. Setting to needs_work for now. Thanks for the careful look at the code!",
    "created_at": "2013-12-02T07:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-207999",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:15'></a>OK, tomorrow. Setting to needs_work for now. Thanks for the careful look at the code!



---

archive/issue_comments_208000.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-12-02T07:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208000",
    "user": "https://github.com/darijgr"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_208001.json:
```json
{
    "body": "<a id='comment:16'></a>I've renamed the methods and made the standard orientation the first example.\n\nAbout the DRYness, what exactly would you factor out? What do you mean by \"indexing\" rows and columns?\n\nAbout the `orientation` keyword, I can replace it by two booleans `left_is_bigger` and `top_is_bigger`. What do you think about it? (Haven't done this change so far.)",
    "created_at": "2013-12-02T20:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208001",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:16'></a>I've renamed the methods and made the standard orientation the first example.

About the DRYness, what exactly would you factor out? What do you mean by "indexing" rows and columns?

About the `orientation` keyword, I can replace it by two booleans `left_is_bigger` and `top_is_bigger`. What do you think about it? (Haven't done this change so far.)



---

archive/issue_comments_208002.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 darij]:\n> I've renamed the methods and made the standard orientation the first example.\n\n\nThanks. Maybe you could use SE rather than NW as well in the documentation when you explain what the poset is about.\n\n> About the DRYness, what exactly would you factor out? What do you mean by \"indexing\" rows and columns?\n\n\nOh, now I see the misunderstanding; I thought the option was about the\nindexing of the cells, ... Which indeed was stupid (same poset). Never\nmind.\n\nTo make your code DRY, you could build two lists horizontal_covers and\nvertical_covers, then, depending on the options, map a reverse on them:\n\n```\nif ...:\n    horizontal_covers = [ (j,i) for (i,j) in horizontal_covers ]\nif ...:\n    vertical_covers = [ (j,i) for (i,j) in vertical_covers ]\n```\n\n\n> About the `orientation` keyword, I can replace it by two booleans\n> `left_is_bigger` and `top_is_bigger`. What do you think about it?\n> (Haven't done this change so far.)\n\n\nFor consistency, I would tend to favor non boolean options like\nhoriz=\"left\" / \"right\" (we have a bunch of them e.g. in the Coxeter\ncode). But I don't have great suggestions for the option names\nthemselves.\n\nCheers,\n                      Nicolas",
    "created_at": "2013-12-03T09:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208002",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:17'></a>Replying to [comment:16 darij]:
> I've renamed the methods and made the standard orientation the first example.


Thanks. Maybe you could use SE rather than NW as well in the documentation when you explain what the poset is about.

> About the DRYness, what exactly would you factor out? What do you mean by "indexing" rows and columns?


Oh, now I see the misunderstanding; I thought the option was about the
indexing of the cells, ... Which indeed was stupid (same poset). Never
mind.

To make your code DRY, you could build two lists horizontal_covers and
vertical_covers, then, depending on the options, map a reverse on them:

```
if ...:
    horizontal_covers = [ (j,i) for (i,j) in horizontal_covers ]
if ...:
    vertical_covers = [ (j,i) for (i,j) in vertical_covers ]
```


> About the `orientation` keyword, I can replace it by two booleans
> `left_is_bigger` and `top_is_bigger`. What do you think about it?
> (Haven't done this change so far.)


For consistency, I would tend to favor non boolean options like
horiz="left" / "right" (we have a bunch of them e.g. in the Coxeter
code). But I don't have great suggestions for the option names
themselves.

Cheers,
                      Nicolas



---

archive/issue_comments_208003.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 nthiery]:\n> Thanks. Maybe you could use SE rather than NW as well in the documentation when you explain what the poset is about.\n\n\nWill do next time I'm editing the file; good point!\n\n> To make your code DRY, you could build two lists horizontal_covers and\n> vertical_covers, then, depending on the options, map a reverse on them:\n> \n> ```\n> if ...:\n>     horizontal_covers = [ (j,i) for (i,j) in horizontal_covers ]\n> if ...:\n>     vertical_covers = [ (j,i) for (i,j) in vertical_covers ]\n> ```\n\n\nHmm. TBH I still don't understand you. How do you get anything from reversal? I'm building up a dictionary, not a list of cover relations. The (arguably toy) timing I have done shows the dictionary to be faster:\n\n```\nsage: %timeit Poset({1: [2,3], 2: [4,5], 5: [6,7,8]})\n1000 loops, best of 3: 1.31 ms per loop\nsage: %timeit Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]])\n100 loops, best of 3: 1.9 ms per loop\n```\n\n> For consistency, I would tend to favor non boolean options like\n> horiz=\"left\" / \"right\" (we have a bunch of them e.g. in the Coxeter\n> code). But I don't have great suggestions for the option names\n> themselves.\n\n\nHmm. I thought you wanted to get rid of strings as arguments. I'm not really convinced of replacing a 2-letter string by 2 multiletter strings :/",
    "created_at": "2013-12-03T23:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208003",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:18'></a>Replying to [comment:17 nthiery]:
> Thanks. Maybe you could use SE rather than NW as well in the documentation when you explain what the poset is about.


Will do next time I'm editing the file; good point!

> To make your code DRY, you could build two lists horizontal_covers and
> vertical_covers, then, depending on the options, map a reverse on them:
> 
> ```
> if ...:
>     horizontal_covers = [ (j,i) for (i,j) in horizontal_covers ]
> if ...:
>     vertical_covers = [ (j,i) for (i,j) in vertical_covers ]
> ```


Hmm. TBH I still don't understand you. How do you get anything from reversal? I'm building up a dictionary, not a list of cover relations. The (arguably toy) timing I have done shows the dictionary to be faster:

```
sage: %timeit Poset({1: [2,3], 2: [4,5], 5: [6,7,8]})
1000 loops, best of 3: 1.31 ms per loop
sage: %timeit Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]])
100 loops, best of 3: 1.9 ms per loop
```

> For consistency, I would tend to favor non boolean options like
> horiz="left" / "right" (we have a bunch of them e.g. in the Coxeter
> code). But I don't have great suggestions for the option names
> themselves.


Hmm. I thought you wanted to get rid of strings as arguments. I'm not really convinced of replacing a 2-letter string by 2 multiletter strings :/



---

archive/issue_comments_208004.json:
```json
{
    "body": "<a id='comment:19'></a>Hi Darij,\n\nReplying to [comment:18 darij]:\n> Hmm. TBH I still don't understand you. How do you get anything from\n> reversal? I'm building up a dictionary, not a list of cover\n> relations.  The (arguably toy) timing I have done shows the\n> dictionary to be faster:\n> \n> \n> ```\n> sage: %timeit Poset({1: [2,3], 2: [4,5], 5: [6,7,8]})\n> 1000 loops, best of 3: 1.31 ms per loop\n> sage: %timeit Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]])\n> 100 loops, best of 3: 1.9 ms per loop\n> ```\n\n\nI'd say: too early of an optimization. Especially since the above\ntiming is actually pretty ridiculous: wtf, 1 ms to build a trivial\nposet? I very much hope this will be improved a lot in the future; but\nthat's a different story. Btw: %timeit is does not measure things well\nfor objects with unique representation, or in general whenever there\nis a cache involved.\n\nAt this point, just focus on expressive and duplication free code. Use\ncovers if it's easier. I know you can find a solution :-)\n\n> > For consistency, I would tend to favor non boolean options like\n> > horiz=\"left\" / \"right\" (we have a bunch of them e.g. in the Coxeter\n> > code). But I don't have great suggestions for the option names\n> > themselves.\n\n> \n> Hmm. I thought you wanted to get rid of strings as arguments. I'm not really convinced of replacing a 2-letter string by 2 multiletter strings :/\n\n\nI agree. My point was more about separation of concerns (up/down,\nleft/right). In any cases, there is no clear cut solution and I just\nmeant to hint at possible directions. I let you take the final\njudgment call!\n\nCheers,\n                       Nicolas",
    "created_at": "2013-12-04T09:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208004",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:19'></a>Hi Darij,

Replying to [comment:18 darij]:
> Hmm. TBH I still don't understand you. How do you get anything from
> reversal? I'm building up a dictionary, not a list of cover
> relations.  The (arguably toy) timing I have done shows the
> dictionary to be faster:
> 
> 
> ```
> sage: %timeit Poset({1: [2,3], 2: [4,5], 5: [6,7,8]})
> 1000 loops, best of 3: 1.31 ms per loop
> sage: %timeit Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]])
> 100 loops, best of 3: 1.9 ms per loop
> ```


I'd say: too early of an optimization. Especially since the above
timing is actually pretty ridiculous: wtf, 1 ms to build a trivial
poset? I very much hope this will be improved a lot in the future; but
that's a different story. Btw: %timeit is does not measure things well
for objects with unique representation, or in general whenever there
is a cache involved.

At this point, just focus on expressive and duplication free code. Use
covers if it's easier. I know you can find a solution :-)

> > For consistency, I would tend to favor non boolean options like
> > horiz="left" / "right" (we have a bunch of them e.g. in the Coxeter
> > code). But I don't have great suggestions for the option names
> > themselves.

> 
> Hmm. I thought you wanted to get rid of strings as arguments. I'm not really convinced of replacing a 2-letter string by 2 multiletter strings :/


I agree. My point was more about separation of concerns (up/down,
left/right). In any cases, there is no clear cut solution and I just
meant to hint at possible directions. I let you take the final
judgment call!

Cheers,
                       Nicolas



---

archive/issue_comments_208005.json:
```json
{
    "body": "updated version",
    "created_at": "2013-12-06T14:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208005",
    "user": "https://github.com/darijgr"
}
```

updated version



---

archive/issue_comments_208006.json:
```json
{
    "body": "<a id='comment:20'></a>Attachment [trac_15428-partition-posets-dg.patch](tarball://root/attachments/some-uuid/ticket15428/trac_15428-partition-posets-dg.patch) by @darijgr created at 2013-12-06 14:56:46\n\nI've replaced NW by SE in the doc.\n\nAbout %timeit not seeing the advantages of UniqueRepresentation: I kind of expected it, but I don't really know how to measure the timing right (I asked something similar on sage-devel a week ago). Maybe this:\n\n```\nsage: %timeit [Poset({1: [2,3], 2: [4,5], 5: [6,7,8]}) for i in range(12)]\n1 loops, best of 3: 15.5 ms per loop\nsage: %timeit [Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]]) for i in range(12)]\n10 loops, best of 3: 21.2 ms per loop\n```\nI think that even when we speed up `Poset.__init__` -- *particularly* when we speed it up -- the difference between a dictionary and a list input will become more noticeable. I'm pretty sure that the dictionary is the form that makes it easier to compute the poset because lookup is faster. Or not?\n\nI don't think that separating the `orientation` variable is really separation of concerns -- there is much more similarities between SE and NW than between SE and NE (for example).",
    "created_at": "2013-12-06T14:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208006",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:20'></a>Attachment [trac_15428-partition-posets-dg.patch](tarball://root/attachments/some-uuid/ticket15428/trac_15428-partition-posets-dg.patch) by @darijgr created at 2013-12-06 14:56:46

I've replaced NW by SE in the doc.

About %timeit not seeing the advantages of UniqueRepresentation: I kind of expected it, but I don't really know how to measure the timing right (I asked something similar on sage-devel a week ago). Maybe this:

```
sage: %timeit [Poset({1: [2,3], 2: [4,5], 5: [6,7,8]}) for i in range(12)]
1 loops, best of 3: 15.5 ms per loop
sage: %timeit [Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]]) for i in range(12)]
10 loops, best of 3: 21.2 ms per loop
```
I think that even when we speed up `Poset.__init__` -- *particularly* when we speed it up -- the difference between a dictionary and a list input will become more noticeable. I'm pretty sure that the dictionary is the form that makes it easier to compute the poset because lookup is faster. Or not?

I don't think that separating the `orientation` variable is really separation of concerns -- there is much more similarities between SE and NW than between SE and NE (for example).



---

archive/issue_comments_208007.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:20 darij]:\n> I've replaced NW by SE in the doc.\n\n\nThanks!\n\n> About %timeit not seeing the advantages of UniqueRepresentation: I\n> kind of expected it, but I don't really know how to measure the\n> timing right (I asked something similar on sage-devel a week\n> ago). Maybe this:\n> \n> ```\n> sage: %timeit [Poset({1: [2,3], 2: [4,5], 5: [6,7,8]}) for i in range(12)]\n> 1 loops, best of 3: 15.5 ms per loop\n> sage: %timeit [Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]]) for i in range(12)]\n> 10 loops, best of 3: 21.2 ms per loop\n> ```\n> I think that even when we speed up `Poset.__init__` --\n> *particularly* when we speed it up -- the difference between a\n> dictionary and a list input will become more noticeable. I'm pretty\n> sure that the dictionary is the form that makes it easier to compute\n> the poset because lookup is faster. Or not?q\n\n\nThe conversion from a list to a dictionary is orders of magnitude\nfaster than the creation of a poset:\n\n```\nsage: l = [[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]]\nsage: %timeit dict(l)\n100000 loops, best of 3: 3.76 us per loop\n```\n\nSo, don't worry about this at this point.\n\n> I don't think that separating the `orientation` variable is really\n> separation of concerns -- there is much more similarities between SE\n> and NW than between SE and NE (for example).\n\n\nFair enough :-)\n\nCheers,\n                          Nicolas",
    "created_at": "2013-12-06T15:47:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208007",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:21'></a>Replying to [comment:20 darij]:
> I've replaced NW by SE in the doc.


Thanks!

> About %timeit not seeing the advantages of UniqueRepresentation: I
> kind of expected it, but I don't really know how to measure the
> timing right (I asked something similar on sage-devel a week
> ago). Maybe this:
> 
> ```
> sage: %timeit [Poset({1: [2,3], 2: [4,5], 5: [6,7,8]}) for i in range(12)]
> 1 loops, best of 3: 15.5 ms per loop
> sage: %timeit [Poset([[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]]) for i in range(12)]
> 10 loops, best of 3: 21.2 ms per loop
> ```
> I think that even when we speed up `Poset.__init__` --
> *particularly* when we speed it up -- the difference between a
> dictionary and a list input will become more noticeable. I'm pretty
> sure that the dictionary is the form that makes it easier to compute
> the poset because lookup is faster. Or not?q


The conversion from a list to a dictionary is orders of magnitude
faster than the creation of a poset:

```
sage: l = [[1,2],[1,3],[2,4],[2,5],[5,6],[5,7],[5,8]]
sage: %timeit dict(l)
100000 loops, best of 3: 3.76 us per loop
```

So, don't worry about this at this point.

> I don't think that separating the `orientation` variable is really
> separation of concerns -- there is much more similarities between SE
> and NW than between SE and NE (for example).


Fair enough :-)

Cheers,
                          Nicolas



---

archive/issue_comments_208008.json:
```json
{
    "body": "<a id='comment:22'></a>Can anyone remind me what needs to be done here after all the discussion? Sorry, time flies...",
    "created_at": "2013-12-27T15:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208008",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:22'></a>Can anyone remind me what needs to be done here after all the discussion? Sorry, time flies...



---

archive/issue_comments_208009.json:
```json
{
    "body": "<a id='comment:23'></a>I think all that's left is to convert this to a branch and do a final review...",
    "created_at": "2013-12-27T16:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208009",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'></a>I think all that's left is to convert this to a branch and do a final review...



---

archive/issue_comments_208010.json:
```json
{
    "body": "<a id='comment:24'></a>OK -- since this needs review, I've thrown in one more minor commit. (The old one is unchanged apart from the commit message.) Nicolas' tableaux suggestion is now #15598. I haven't simplifies the implementation of the `cell_poset` method since I still feel that `Poset.__call__` is going to be optimized one day and the situation will noticeably change then, but I'm open to argument on this.",
    "created_at": "2013-12-27T16:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208010",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:24'></a>OK -- since this needs review, I've thrown in one more minor commit. (The old one is unchanged apart from the commit message.) Nicolas' tableaux suggestion is now #15598. I haven't simplifies the implementation of the `cell_poset` method since I still feel that `Poset.__call__` is going to be optimized one day and the situation will noticeably change then, but I'm open to argument on this.



---

archive/issue_comments_208011.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-12-27T16:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208011",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_208012.json:
```json
{
    "body": "<a id='comment:25'></a>New commits:",
    "created_at": "2013-12-27T16:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208012",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:25'></a>New commits:



---

archive/issue_comments_208013.json:
```json
{
    "body": "<a id='comment:26'></a>Looks good to me.",
    "created_at": "2013-12-30T18:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208013",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>Looks good to me.



---

archive/issue_comments_208014.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-12-30T18:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208014",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_208015.json:
```json
{
    "body": "<a id='comment:27'></a>Thank you once again!\n\n(And sorry for my reviewing inactivity lately...)",
    "created_at": "2013-12-30T18:51:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208015",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:27'></a>Thank you once again!

(And sorry for my reviewing inactivity lately...)



---

archive/issue_events_044955.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15428#event-44955"
}
```



---

archive/issue_comments_208016.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-02-02T22:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15428#issuecomment-208016",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_044956.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-02T22:07:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15428",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15428#event-44956"
}
```
