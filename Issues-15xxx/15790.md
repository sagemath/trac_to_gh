# Issue 15790: GCD of univariate polynomials: generic implementation for UFD, and sparse case

archive/issues_015553.json:
```json
{
    "body": "**[Update]** Due to #13442, the purpose of this ticket changed slightly. It provides two functionalities:\n\n1. A generic implementation for the GCD of two polynomials over a UFD;\n2. A `gcd` method for sparse polynomials which allows to choose between the `generic` implementation, or using the implementation for `dense` polynomials. Default is generally `generic`, but for polynomial over `ZZ` it is `dense`. This is due to the very fast implementations available in Flint and NTL.\n\nThese implementations solve the problem mentioned in the first version of this ticket, that remains below for information.\n\n---\n**[Old description, not relevant anymore]**\n\nThe GCD of two sparse polynomials over `ZZ` is not computed. If the polynomials are in dense representation or if they are in sparse representation but defined over `QQ`, there is no problem.\n\n```\nsage: R1.<x>=PolynomialRing(ZZ,'x',sparse=true)\nsage: R2.<x>=PolynomialRing(ZZ,'x',sparse=false)\nsage: R3.<x>=PolynomialRing(QQ,'x',sparse=true)\nsage: p=x^2-3*x+2\nsage: q=x^2-1\nsage: gcd(R2(p),R2(q))\nx - 1\nsage: gcd(R3(p),R3(q))\nx - 1\nsage: gcd(R1(p),R1(q))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-6-0d7380207fef> in <module>()\n----> 1 gcd(R1(p),R1(q))\n\n/home/bgrenet/bin/sage-6.0-x86_64-Linux/local/lib/python2.7/site-packages/sage/rings/arith.pyc in gcd(a, b, **kwargs)\n   1605                 return ZZ(a).gcd(ZZ(b))\n   1606             except TypeError:\n-> 1607                 raise TypeError(\"unable to find gcd\")\n   1608         return GCD(b, **kwargs)\n   1609 \n\nTypeError: unable to find gcd\n```\n\nCC:  @videlec\n\nKeywords: polynomial, gcd\n\nBranch/Commit: d77ee902e808082dcc44daf71bb0ea2756c621bb\n\nReviewer: Julian Rueth\n\nAuthor: Bruno Grenet\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15790\n\n",
    "closed_at": "2015-10-14T21:03:48Z",
    "created_at": "2014-02-06T12:23:40Z",
    "labels": [
        "component: basic arithmetic",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "GCD of univariate polynomials: generic implementation for UFD, and sparse case",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15790",
    "user": "https://github.com/bgrenet"
}
```
**[Update]** Due to #13442, the purpose of this ticket changed slightly. It provides two functionalities:

1. A generic implementation for the GCD of two polynomials over a UFD;
2. A `gcd` method for sparse polynomials which allows to choose between the `generic` implementation, or using the implementation for `dense` polynomials. Default is generally `generic`, but for polynomial over `ZZ` it is `dense`. This is due to the very fast implementations available in Flint and NTL.

These implementations solve the problem mentioned in the first version of this ticket, that remains below for information.

---
**[Old description, not relevant anymore]**

The GCD of two sparse polynomials over `ZZ` is not computed. If the polynomials are in dense representation or if they are in sparse representation but defined over `QQ`, there is no problem.

```
sage: R1.<x>=PolynomialRing(ZZ,'x',sparse=true)
sage: R2.<x>=PolynomialRing(ZZ,'x',sparse=false)
sage: R3.<x>=PolynomialRing(QQ,'x',sparse=true)
sage: p=x^2-3*x+2
sage: q=x^2-1
sage: gcd(R2(p),R2(q))
x - 1
sage: gcd(R3(p),R3(q))
x - 1
sage: gcd(R1(p),R1(q))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-6-0d7380207fef> in <module>()
----> 1 gcd(R1(p),R1(q))

/home/bgrenet/bin/sage-6.0-x86_64-Linux/local/lib/python2.7/site-packages/sage/rings/arith.pyc in gcd(a, b, **kwargs)
   1605                 return ZZ(a).gcd(ZZ(b))
   1606             except TypeError:
-> 1607                 raise TypeError("unable to find gcd")
   1608         return GCD(b, **kwargs)
   1609 

TypeError: unable to find gcd
```

CC:  @videlec

Keywords: polynomial, gcd

Branch/Commit: d77ee902e808082dcc44daf71bb0ea2756c621bb

Reviewer: Julian Rueth

Author: Bruno Grenet

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15790





---

archive/issue_comments_214200.json:
```json
{
    "body": "<a id='comment:1'></a>For `PolynomialRing(ZZ,'x',sparse=false)`, one of FLINT or NTL is used (FLINT by default). \n\nFor `PolynomialRing(QQ,'x',sparse=true)`, the `gcd` computation is based on `quo_rem`. This is not possible over the integer since `quo_rem` works for polynomials over a field. \n\nThere are several possible solutions: \n1. Coerce the polynomials to `PolynomialRing(QQ,'x',sparse=true)`; compute their GCD `g`, the LCM `l` of the denominators of the coefficients of `g`, and return `l*g`.\n2. Coerce the polynomials to `PolynomialRing(ZZ,'x',sparse=false)`; compute their GCD and return the result in sparse representation with a second coercion.\n3. Implement a //pseudo-division// algorithm (//cf.// Cohen GTM 138 Algorithm 3.1.2) and a GCD algorithm based on the sub-resultant (//cf.// Cohen GTM 138 Algorithm 3.3.1).\n\nSolution 3 seems cleaner but does not give especially efficient results since the algorithms described in Cohen GTM 138 have complexity polynomial in the degree of the input polynomial. Actually, computing the GCD of two sparse polynomial is NP-hard ![1] so no better solution than converting to the dense representation is likely to exist. To my mind, Solution 2 is then the best one. \n\nYet, I am new to Sage so comments are welcome!\n\n![1] D. Plaisted, Sparse complex polynomials and polynomial reducibility. J. Comput. Syst. Sci. 14 (2), 210\u2013221, 1977.",
    "created_at": "2014-02-06T15:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214200",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:1'></a>For `PolynomialRing(ZZ,'x',sparse=false)`, one of FLINT or NTL is used (FLINT by default). 

For `PolynomialRing(QQ,'x',sparse=true)`, the `gcd` computation is based on `quo_rem`. This is not possible over the integer since `quo_rem` works for polynomials over a field. 

There are several possible solutions: 
1. Coerce the polynomials to `PolynomialRing(QQ,'x',sparse=true)`; compute their GCD `g`, the LCM `l` of the denominators of the coefficients of `g`, and return `l*g`.
2. Coerce the polynomials to `PolynomialRing(ZZ,'x',sparse=false)`; compute their GCD and return the result in sparse representation with a second coercion.
3. Implement a //pseudo-division// algorithm (//cf.// Cohen GTM 138 Algorithm 3.1.2) and a GCD algorithm based on the sub-resultant (//cf.// Cohen GTM 138 Algorithm 3.3.1).

Solution 3 seems cleaner but does not give especially efficient results since the algorithms described in Cohen GTM 138 have complexity polynomial in the degree of the input polynomial. Actually, computing the GCD of two sparse polynomial is NP-hard ![1] so no better solution than converting to the dense representation is likely to exist. To my mind, Solution 2 is then the best one. 

Yet, I am new to Sage so comments are welcome!

![1] D. Plaisted, Sparse complex polynomials and polynomial reducibility. J. Comput. Syst. Sci. 14 (2), 210–221, 1977.



---

archive/issue_comments_214201.json:
```json
{
    "body": "<a id='comment:2'></a>I'd implement all 3 with an optional `algorithm` argument since each has different strengths/weaknesses. For example, 2 is good as long as the polynomials are relatively dense, but for something like `x^100000 - 2`, I wouldn't want to convert that to a dense polynomial because of the memory usage (and take the time to construct it). From that, I think 3 should be the default. Possible names:\n\n1. `\"fraction_field\"`\n2. `\"dense\"`\n3. `\"pseudo-division\"`\n\nNevertheless, I think we should have some `gcd` since this would be a surprise for the more casual user.",
    "created_at": "2014-02-07T15:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214201",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>I'd implement all 3 with an optional `algorithm` argument since each has different strengths/weaknesses. For example, 2 is good as long as the polynomials are relatively dense, but for something like `x^100000 - 2`, I wouldn't want to convert that to a dense polynomial because of the memory usage (and take the time to construct it). From that, I think 3 should be the default. Possible names:

1. `"fraction_field"`
2. `"dense"`
3. `"pseudo-division"`

Nevertheless, I think we should have some `gcd` since this would be a surprise for the more casual user.



---

archive/issue_events_046446.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15790#event-46446"
}
```



---

archive/issue_comments_214202.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-25T22:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214202",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214203.json:
```json
{
    "body": "<a id='comment:7'></a>I've implemented the `gcd` method in the class `Polynomial` using the pseudo-division algorithm, as well as a method `gcd` in `Polynomial_generic_sparse` which allows to choose the algorithm between `\"pseudo-division\"`, `\"dense\"` or `\"fraction_field\"`. \n\nNeeds review!\n\nOne remaining limitation is the absence of `quo_rem` method in `Polynomial_generic_sparse`. I created a specific ticket #16544 for this.",
    "created_at": "2014-06-25T22:54:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214203",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:7'></a>I've implemented the `gcd` method in the class `Polynomial` using the pseudo-division algorithm, as well as a method `gcd` in `Polynomial_generic_sparse` which allows to choose the algorithm between `"pseudo-division"`, `"dense"` or `"fraction_field"`. 

Needs review!

One remaining limitation is the absence of `quo_rem` method in `Polynomial_generic_sparse`. I created a specific ticket #16544 for this.



---

archive/issue_comments_214204.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-06-25T22:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214204",
    "user": "https://github.com/bgrenet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_214205.json:
```json
{
    "body": "Changing keywords from \"GCD sparse\" to \"sparse polynomial, gcd\".",
    "created_at": "2014-06-25T22:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214205",
    "user": "https://github.com/bgrenet"
}
```

Changing keywords from "GCD sparse" to "sparse polynomial, gcd".



---

archive/issue_comments_214206.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-11T17:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214207.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-11T17:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214207",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_046447.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15790#event-46447"
}
```



---

archive/issue_events_046448.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15790#event-46448"
}
```



---

archive/issue_comments_214208.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-13T14:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214209.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-12-13T14:36:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214209",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214210.json:
```json
{
    "body": "<a id='comment:14'></a>The ticket is ready for review. Note that as default, I have the \"dense\" algorithm for polynomials over ZZ and \"pseudo-division\" for the other ones. The idea is that arithmetic on ZZ[X] is very efficient. \n\nOf course, `gcd(x<sup>100000-1,x</sup>1000-1)` is much faster (by a factor approx. 400) with \"pseudo-division\" algorithm because of memory allocation for the \"dense\" algorithm, and thanks to a very good behavior of the \"pseudo-division\" algorithm on this example. Yet, if you consider `gcd(x<sup>100000-1,x</sup>2-1)` (which should be easy btw), the \"dense\" algorithm is faster and I even stopped the \"pseudo-division\" algorithm after a quite long time. \n\n*Note:* It may be possible to reduce the huge allocation time since with NTL implementation, this is much faster: https://groups.google.com/forum/#!topic/sage-devel/6qhW90dgd1k.",
    "created_at": "2014-12-13T14:36:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214210",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:14'></a>The ticket is ready for review. Note that as default, I have the "dense" algorithm for polynomials over ZZ and "pseudo-division" for the other ones. The idea is that arithmetic on ZZ[X] is very efficient. 

Of course, `gcd(x<sup>100000-1,x</sup>1000-1)` is much faster (by a factor approx. 400) with "pseudo-division" algorithm because of memory allocation for the "dense" algorithm, and thanks to a very good behavior of the "pseudo-division" algorithm on this example. Yet, if you consider `gcd(x<sup>100000-1,x</sup>2-1)` (which should be easy btw), the "dense" algorithm is faster and I even stopped the "pseudo-division" algorithm after a quite long time. 

*Note:* It may be possible to reduce the huge allocation time since with NTL implementation, this is much faster: https://groups.google.com/forum/#!topic/sage-devel/6qhW90dgd1k.



---

archive/issue_comments_214211.json:
```json
{
    "body": "<a id='comment:15'></a>Do you have a heuristic for determining when one algorithm is faster than another (when the base ring is `ZZ`)? It doesn't have to be a particularly good one, but considering the time differences you're getting, it seems like we should have some automatic choice of algorithm.",
    "created_at": "2014-12-13T17:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214211",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>Do you have a heuristic for determining when one algorithm is faster than another (when the base ring is `ZZ`)? It doesn't have to be a particularly good one, but considering the time differences you're getting, it seems like we should have some automatic choice of algorithm.



---

archive/issue_comments_214212.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-15T17:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214213.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 tscrim]:\n> Do you have a heuristic for determining when one algorithm is faster than another (when the base ring is `ZZ`)? It doesn't have to be a particularly good one, but considering the time differences you're getting, it seems like we should have some automatic choice of algorithm.\n\n\nI don't have one. Based on the comments on https://groups.google.com/forum/#!topic/sage-devel/6qhW90dgd1k, I add the possibility\u00b9 for the \"dense\" algorithm to use NTL instead of FLINT. After some tests, I chose a heuristic for using NTL rather than FLINT (basically, FLINT is faster for low-degree polynomials and *not-too-sparse* ones). Then the \"dense\" algorithm is almost always faster than \"pseudo-division\" but for some very specific examples (I haven't been able to build other ones): `gcd(x<sup>N-1,x</sup>M-1)` with both `N` and `M` pretty large. An the ratio is not hundreds anymore, but approx. 10. \n\n\u00b9 Actually, no choice for the user but only an automatic switch.",
    "created_at": "2014-12-15T17:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214213",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:17'></a>Replying to [comment:15 tscrim]:
> Do you have a heuristic for determining when one algorithm is faster than another (when the base ring is `ZZ`)? It doesn't have to be a particularly good one, but considering the time differences you're getting, it seems like we should have some automatic choice of algorithm.


I don't have one. Based on the comments on https://groups.google.com/forum/#!topic/sage-devel/6qhW90dgd1k, I add the possibility¹ for the "dense" algorithm to use NTL instead of FLINT. After some tests, I chose a heuristic for using NTL rather than FLINT (basically, FLINT is faster for low-degree polynomials and *not-too-sparse* ones). Then the "dense" algorithm is almost always faster than "pseudo-division" but for some very specific examples (I haven't been able to build other ones): `gcd(x<sup>N-1,x</sup>M-1)` with both `N` and `M` pretty large. An the ratio is not hundreds anymore, but approx. 10. 

¹ Actually, no choice for the user but only an automatic switch.



---

archive/issue_comments_214214.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-07T06:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214214",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214215.json:
```json
{
    "body": "<a id='comment:18'></a>needs work, does not build, see patchbot report:\n\n```\nFile \"sage/structure/element.pyx\", line 3433, in sage.structure.element.NamedBinopMethod.__init__ (build/cythonized/sage/structure/element.c:26905)\nAttributeError: 'sage.structure.element.NamedBinopMethod' object has no attribute '__name__'\n```",
    "created_at": "2015-08-07T06:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214215",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>needs work, does not build, see patchbot report:

```
File "sage/structure/element.pyx", line 3433, in sage.structure.element.NamedBinopMethod.__init__ (build/cythonized/sage/structure/element.c:26905)
AttributeError: 'sage.structure.element.NamedBinopMethod' object has no attribute '__name__'
```



---

archive/issue_comments_214216.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-07T14:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_214217.json:
```json
{
    "body": "<a id='comment:20'></a>This is rebased, and now works (as far as I can tell).",
    "created_at": "2015-08-07T15:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214217",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:20'></a>This is rebased, and now works (as far as I can tell).



---

archive/issue_comments_214218.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+**[Update]** Due to #13442, the implementation of this ticket can be viewed as a fallback GCD implementation for rings which do not have a method `_gcd_univariate_polynomial`.\n+\n The GCD of two sparse polynomials over `ZZ` is not computed. If the polynomials are in dense representation or if they are in sparse representation but defined over `QQ`, there is no problem. \n \n ```\n@@ -26,8 +28,6 @@\n TypeError: unable to find gcd\n ```\n \n-Keywords: GCD sparse\n-\n Comment: 1\n \n Summary: GCD of sparse univariate polynomials over ZZ\n```\n",
    "created_at": "2015-08-07T15:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214218",
    "user": "https://github.com/bgrenet"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,5 @@
+**[Update]** Due to #13442, the implementation of this ticket can be viewed as a fallback GCD implementation for rings which do not have a method `_gcd_univariate_polynomial`.
+
 The GCD of two sparse polynomials over `ZZ` is not computed. If the polynomials are in dense representation or if they are in sparse representation but defined over `QQ`, there is no problem. 
 
 ```
@@ -26,8 +28,6 @@
 TypeError: unable to find gcd
 ```
 
-Keywords: GCD sparse
-
 Comment: 1
 
 Summary: GCD of sparse univariate polynomials over ZZ
```




---

archive/issue_comments_214219.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-07T15:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214219",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_046449.json:
```json
{
    "actor": "https://github.com/bgrenet",
    "created_at": "2015-08-07T15:08:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15790#event-46449"
}
```



---

archive/issue_events_046450.json:
```json
{
    "actor": "https://github.com/bgrenet",
    "created_at": "2015-08-07T15:08:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15790#event-46450"
}
```



---

archive/issue_comments_214220.json:
```json
{
    "body": "<a id='comment:21'></a>Doc does not build\n\n```\nOSError: [polynomia] docstring of sage.rings.polynomial.polynomial_element.Polynomial.pseudo_quo_rem:38: WARNING: Duplicate explicit target name: \"gtm138\".\n```",
    "created_at": "2015-08-07T17:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214220",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>Doc does not build

```
OSError: [polynomia] docstring of sage.rings.polynomial.polynomial_element.Polynomial.pseudo_quo_rem:38: WARNING: Duplicate explicit target name: "gtm138".
```



---

archive/issue_comments_214221.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-07T17:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214221",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214222.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-25T14:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214223.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-25T14:51:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214223",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214224.json:
```json
{
    "body": "<a id='comment:24'></a>In the two latest commits, I propose the following changes:\n\n1. Instead of having a fallback algorithm in the method `Polynomial.gcd` which tests whether the base ring in a unique factorization domain, this algorithm is moved to the category `UniqueFactorizationDomains`.\n2. I simplified the method `Polynomial_generic_sparse.gcd`: There remain only two possibilities (out of three), namely the one previously called `pseudo-division` (renamed `generic`, since it uses the generic code) and the `dense` version, which may in some cases be faster, for instance over `ZZ`. I removed the `fraction_field` option which does not make much sense I think.\n\nAt the same time, I also take [comment:21 Fr\u00e9d\u00e9ric's comment] into account.",
    "created_at": "2015-08-25T15:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214224",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:24'></a>In the two latest commits, I propose the following changes:

1. Instead of having a fallback algorithm in the method `Polynomial.gcd` which tests whether the base ring in a unique factorization domain, this algorithm is moved to the category `UniqueFactorizationDomains`.
2. I simplified the method `Polynomial_generic_sparse.gcd`: There remain only two possibilities (out of three), namely the one previously called `pseudo-division` (renamed `generic`, since it uses the generic code) and the `dense` version, which may in some cases be faster, for instance over `ZZ`. I removed the `fraction_field` option which does not make much sense I think.

At the same time, I also take [comment:21 Frédéric's comment] into account.



---

archive/issue_comments_214225.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,40 @@\n+**[Update]** Due to #13442, the purpose of this ticket changed slightly. It provides two functionalities:\n \n+1. A generic implementation for the GCD of two polynomials over a UFD;\n+2. A `gcd` method for sparse polynomials which allows to choose between the `generic` implementation, or using the implementation for `dense` polynomials. Default is generally `generic`, but for polynomial over `ZZ` it is `dense`. This is due to the very fast implementations available in Flint and NTL.\n+\n+These implementations solve the problem mentioned in the first version of this ticket, that remains below for information.\n+\n+---\n+**[Old description, not relevant anymore]**\n+\n+The GCD of two sparse polynomials over `ZZ` is not computed. If the polynomials are in dense representation or if they are in sparse representation but defined over `QQ`, there is no problem.\n+\n+```\n+sage: R1.<x>=PolynomialRing(ZZ,'x',sparse=true)\n+sage: R2.<x>=PolynomialRing(ZZ,'x',sparse=false)\n+sage: R3.<x>=PolynomialRing(QQ,'x',sparse=true)\n+sage: p=x^2-3*x+2\n+sage: q=x^2-1\n+sage: gcd(R2(p),R2(q))\n+x - 1\n+sage: gcd(R3(p),R3(q))\n+x - 1\n+sage: gcd(R1(p),R1(q))\n+---------------------------------------------------------------------------\n+TypeError                                 Traceback (most recent call last)\n+<ipython-input-6-0d7380207fef> in <module>()\n+----> 1 gcd(R1(p),R1(q))\n+\n+/home/bgrenet/bin/sage-6.0-x86_64-Linux/local/lib/python2.7/site-packages/sage/rings/arith.pyc in gcd(a, b, **kwargs)\n+   1605                 return ZZ(a).gcd(ZZ(b))\n+   1606             except TypeError:\n+-> 1607                 raise TypeError(\"unable to find gcd\")\n+   1608         return GCD(b, **kwargs)\n+   1609 \n+\n+TypeError: unable to find gcd\n+```\n \n Comment: 1\n \n```\n",
    "created_at": "2015-08-25T15:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214225",
    "user": "https://github.com/bgrenet"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,40 @@
+**[Update]** Due to #13442, the purpose of this ticket changed slightly. It provides two functionalities:
 
+1. A generic implementation for the GCD of two polynomials over a UFD;
+2. A `gcd` method for sparse polynomials which allows to choose between the `generic` implementation, or using the implementation for `dense` polynomials. Default is generally `generic`, but for polynomial over `ZZ` it is `dense`. This is due to the very fast implementations available in Flint and NTL.
+
+These implementations solve the problem mentioned in the first version of this ticket, that remains below for information.
+
+---
+**[Old description, not relevant anymore]**
+
+The GCD of two sparse polynomials over `ZZ` is not computed. If the polynomials are in dense representation or if they are in sparse representation but defined over `QQ`, there is no problem.
+
+```
+sage: R1.<x>=PolynomialRing(ZZ,'x',sparse=true)
+sage: R2.<x>=PolynomialRing(ZZ,'x',sparse=false)
+sage: R3.<x>=PolynomialRing(QQ,'x',sparse=true)
+sage: p=x^2-3*x+2
+sage: q=x^2-1
+sage: gcd(R2(p),R2(q))
+x - 1
+sage: gcd(R3(p),R3(q))
+x - 1
+sage: gcd(R1(p),R1(q))
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
+<ipython-input-6-0d7380207fef> in <module>()
+----> 1 gcd(R1(p),R1(q))
+
+/home/bgrenet/bin/sage-6.0-x86_64-Linux/local/lib/python2.7/site-packages/sage/rings/arith.pyc in gcd(a, b, **kwargs)
+   1605                 return ZZ(a).gcd(ZZ(b))
+   1606             except TypeError:
+-> 1607                 raise TypeError("unable to find gcd")
+   1608         return GCD(b, **kwargs)
+   1609 
+
+TypeError: unable to find gcd
+```
 
 Comment: 1
 
```




---

archive/issue_comments_214226.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-25T15:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214226",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214227.json:
```json
{
    "body": "Changing keywords from \"sparse polynomial, gcd\" to \"polynomial, gcd\".",
    "created_at": "2015-08-25T15:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214227",
    "user": "https://github.com/bgrenet"
}
```

Changing keywords from "sparse polynomial, gcd" to "polynomial, gcd".



---

archive/issue_comments_214228.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-04T03:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214228",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214229.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-04T03:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214229",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_214230.json:
```json
{
    "body": "<a id='comment:27'></a>Made some minor docstring changes. Everything else looks fine.",
    "created_at": "2015-10-04T03:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214230",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:27'></a>Made some minor docstring changes. Everything else looks fine.



---

archive/issue_comments_214231.json:
```json
{
    "body": "<a id='comment:28'></a>Thanks for improving the docstring, and for the review! I add your name as a reviewer.",
    "created_at": "2015-10-05T06:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214231",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:28'></a>Thanks for improving the docstring, and for the review! I add your name as a reviewer.



---

archive/issue_events_046451.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-14T21:03:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15790#event-46451"
}
```



---

archive/issue_comments_214232.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-14T21:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15790",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15790#issuecomment-214232",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
