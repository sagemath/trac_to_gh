# Issue 15378: composition of scheme morphism defined by polynomials

archive/issues_015141.json:
```json
{
    "body": "Currently the following fails\n\n```\nsage: P.<x,y>=ProjectiveSpace(QQ,1)\nsage: H=Hom(P,P)\nsage: f=H([x^2 -29/16*y^2, y^2])\nsage: f*f\nTraceback (most recent call last):\n...\nTypeError: unsupported operand type(s) for *: 'SchemeMorphism_polynomial_projective_space_field' and 'SchemeMorphism_polynomial_projective_space_field'\n```\n\nWe just propose a generic implementation.\n\nKeywords: sage-days55\n\nBranch/Commit: c6c853fa06cf3ff5a08b64cc58e71d39e72f271e\n\nReviewer: Vincent Delecroix\n\nAuthor: Vincent Delecroix, Ben Hutz\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15378\n\n",
    "closed_at": "2016-08-07T20:01:42Z",
    "created_at": "2013-11-07T23:05:41Z",
    "labels": [
        "component: algebraic geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "composition of scheme morphism defined by polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15378",
    "user": "https://github.com/videlec"
}
```
Currently the following fails

```
sage: P.<x,y>=ProjectiveSpace(QQ,1)
sage: H=Hom(P,P)
sage: f=H([x^2 -29/16*y^2, y^2])
sage: f*f
Traceback (most recent call last):
...
TypeError: unsupported operand type(s) for *: 'SchemeMorphism_polynomial_projective_space_field' and 'SchemeMorphism_polynomial_projective_space_field'
```

We just propose a generic implementation.

Keywords: sage-days55

Branch/Commit: c6c853fa06cf3ff5a08b64cc58e71d39e72f271e

Reviewer: Vincent Delecroix

Author: Vincent Delecroix, Ben Hutz

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15378





---

archive/issue_comments_207145.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2013-11-07T23:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207145",
    "user": "https://github.com/videlec"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_207146.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to algebraic geometry.",
    "created_at": "2013-11-07T23:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207146",
    "user": "https://github.com/videlec"
}
```

Changing component from PLEASE CHANGE to algebraic geometry.



---

archive/issue_comments_207147.json:
```json
{
    "body": "Changing keywords from \"\" to \"sage-days55\".",
    "created_at": "2013-11-07T23:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207147",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "" to "sage-days55".



---

archive/issue_comments_207148.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2013-11-08T03:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207148",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_207149.json:
```json
{
    "body": "<a id='comment:3'></a>see the discussion at\nhttps://groups.google.com/forum/#!topic/sage-devel/qW20-IW0aks",
    "created_at": "2013-11-08T03:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207149",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>see the discussion at
https://groups.google.com/forum/#!topic/sage-devel/qW20-IW0aks



---

archive/issue_events_044679.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44679"
}
```



---

archive/issue_events_044680.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44680"
}
```



---

archive/issue_events_044681.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44681"
}
```



---

archive/issue_events_044682.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44682"
}
```



---

archive/issue_events_044683.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44683"
}
```



---

archive/issue_comments_207150.json:
```json
{
    "body": "<a id='comment:8'></a>I added the ref to the inheritance issue in #14711. It would be nice if we could have composition working independent of the inheritance structure correction. Accordingly, I put the inheritance back how it was and the composition seems to work fine with this implementation. I added one example to test failure, but that is all.\n\nComments?\n\n---\nNew commits:",
    "created_at": "2016-08-02T22:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207150",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>I added the ref to the inheritance issue in #14711. It would be nice if we could have composition working independent of the inheritance structure correction. Accordingly, I put the inheritance back how it was and the composition seems to work fine with this implementation. I added one example to test failure, but that is all.

Comments?

---
New commits:



---

archive/issue_comments_207151.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-02T22:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207151",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207152.json:
```json
{
    "body": "<a id='comment:10'></a>You wrote\n\n```\n+        as soon as this bug is fixed. See trac #14711.\n```\nfirst of all the right syntax is `:trac:`14711`` and secondly #14711 refers to a **closed** ticket.\n\n(EDIT: it might not be you, but it appears in the total diff.)",
    "created_at": "2016-08-02T22:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207152",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>You wrote

```
+        as soon as this bug is fixed. See trac #14711.
```
first of all the right syntax is `:trac:`14711`` and secondly #14711 refers to a **closed** ticket.

(EDIT: it might not be you, but it appears in the total diff.)



---

archive/issue_comments_207153.json:
```json
{
    "body": "<a id='comment:11'></a>I put in needs review in order to make a sign to the patchbots...",
    "created_at": "2016-08-02T22:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207153",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>I put in needs review in order to make a sign to the patchbots...



---

archive/issue_comments_207154.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-02T22:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207154",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207155.json:
```json
{
    "body": "<a id='comment:12'></a>Yes, I can fixed the syntax mistake.\n\nAs for it being a closed ticket. In trying to investigate this issue, the comment in the code was not very helpful. The closed ticket #14711 has a much longer description of the issue and is part of what is needed. If I'm not mistaken the other part is a python bug not tracked on trac.",
    "created_at": "2016-08-02T22:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207155",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:12'></a>Yes, I can fixed the syntax mistake.

As for it being a closed ticket. In trying to investigate this issue, the comment in the code was not very helpful. The closed ticket #14711 has a much longer description of the issue and is part of what is needed. If I'm not mistaken the other part is a python bug not tracked on trac.



---

archive/issue_comments_207156.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-02T22:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207156",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207157.json:
```json
{
    "body": "<a id='comment:14'></a>And this can also be removed I guess\n\n```\n+from sage.categories.morphism import Morphism\n+from sage.rings.all           import Integer\n+from sage.rings.commutative_ring import is_CommutativeRing\n```",
    "created_at": "2016-08-02T23:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207157",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>And this can also be removed I guess

```
+from sage.categories.morphism import Morphism
+from sage.rings.all           import Integer
+from sage.rings.commutative_ring import is_CommutativeRing
```



---

archive/issue_comments_207158.json:
```json
{
    "body": "<a id='comment:15'></a>The correct syntax is `:trac:`14711``, no braces (these are just use for formatting the trac wiki ;-)!",
    "created_at": "2016-08-02T23:03:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207158",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>The correct syntax is `:trac:`14711``, no braces (these are just use for formatting the trac wiki ;-)!



---

archive/issue_comments_207159.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-02T23:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207159",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207160.json:
```json
{
    "body": "<a id='comment:17'></a>I was wondering about that trac formatting. I didn't think the docs linked to trac like that, but I figured if you said so... ;)",
    "created_at": "2016-08-02T23:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207160",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:17'></a>I was wondering about that trac formatting. I didn't think the docs linked to trac like that, but I figured if you said so... ;)



---

archive/issue_comments_207161.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-02T23:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207162.json:
```json
{
    "body": "<a id='comment:19'></a>Note that even without your branch it (sort of) works!\n\n```\nsage: P.<x,y> = ProjectiveSpace(QQ,1)\nsage: H = Hom(P,P)\nsage: f = H([x^2 -29/16*y^2, y^2])\nsage: g = H([y,x+y])\nsage: h = f*g\nsage: h\nComposite map:\n  From: Projective Space of dimension 1 over Rational Field\n  To:   Projective Space of dimension 1 over Rational Field\n  Defn:   Generic endomorphism of Projective Space of dimension 1 over Rational Field\n        then\n          Generic endomorphism of Projective Space of dimension 1 over Rational Field\nsage: p = P((1,3))\nsage: p\n(1/3 : 1)\nsage: h(p) == f(g(p))\nTrue\n```\nBut I guess it is better to have the result of `f*g` with explicit polynomial coordinates.\n\n```\nsage: f[0]\nx^2 - 29/16*y^2\nsage: h[0]\nGeneric endomorphism of Projective Space of dimension 1 over Rational Field\n```",
    "created_at": "2016-08-03T14:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207162",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>Note that even without your branch it (sort of) works!

```
sage: P.<x,y> = ProjectiveSpace(QQ,1)
sage: H = Hom(P,P)
sage: f = H([x^2 -29/16*y^2, y^2])
sage: g = H([y,x+y])
sage: h = f*g
sage: h
Composite map:
  From: Projective Space of dimension 1 over Rational Field
  To:   Projective Space of dimension 1 over Rational Field
  Defn:   Generic endomorphism of Projective Space of dimension 1 over Rational Field
        then
          Generic endomorphism of Projective Space of dimension 1 over Rational Field
sage: p = P((1,3))
sage: p
(1/3 : 1)
sage: h(p) == f(g(p))
True
```
But I guess it is better to have the result of `f*g` with explicit polynomial coordinates.

```
sage: f[0]
x^2 - 29/16*y^2
sage: h[0]
Generic endomorphism of Projective Space of dimension 1 over Rational Field
```



---

archive/issue_comments_207163.json:
```json
{
    "body": "<a id='comment:20'></a>I guess that the lines\n\n```\nexcept AttributeError:\n    raise NotImplementedError\n```\nwould better be replaced with\n\n```\nexcept AttributeError:\n    return super(SchemeMorphism_polynomial, self)._composition_(self, other, homset)\n```\nas there might be some morphism other than polynomial that you may want to compose with polynomial ones. I was not able to build example though.",
    "created_at": "2016-08-03T14:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207163",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>I guess that the lines

```
except AttributeError:
    raise NotImplementedError
```
would better be replaced with

```
except AttributeError:
    return super(SchemeMorphism_polynomial, self)._composition_(self, other, homset)
```
as there might be some morphism other than polynomial that you may want to compose with polynomial ones. I was not able to build example though.



---

archive/issue_comments_207164.json:
```json
{
    "body": "<a id='comment:21'></a>This composition is specifically for SchemeMorphism_polynomial, so I'm fine with the NotImplementedError if there are not any polynomials. If it is a different kind of morphism, it shouldn't be calling this one.\n\nYes, getting the defining polynomials of the composition really the point. We needed this to speed up the computations for things like #21118.",
    "created_at": "2016-08-03T14:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207164",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:21'></a>This composition is specifically for SchemeMorphism_polynomial, so I'm fine with the NotImplementedError if there are not any polynomials. If it is a different kind of morphism, it shouldn't be calling this one.

Yes, getting the defining polynomials of the composition really the point. We needed this to speed up the computations for things like #21118.



---

archive/issue_comments_207165.json:
```json
{
    "body": "<a id='comment:22'></a>More precisely: `f` can be polynomial and `g` something else and `f * g` should work.",
    "created_at": "2016-08-03T14:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207165",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>More precisely: `f` can be polynomial and `g` something else and `f * g` should work.



---

archive/issue_comments_207166.json:
```json
{
    "body": "<a id='comment:23'></a>This gets the NotImplementedError\n\n```\nA2.<x,y> = AffineSpace(QQ,2)\nH=End(A2)\nf=H([x^2+y^2,y^2/x])\np=A2([1,2])\nf*p\n```",
    "created_at": "2016-08-03T14:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207166",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:23'></a>This gets the NotImplementedError

```
A2.<x,y> = AffineSpace(QQ,2)
H=End(A2)
f=H([x^2+y^2,y^2/x])
p=A2([1,2])
f*p
```



---

archive/issue_comments_207167.json:
```json
{
    "body": "<a id='comment:24'></a>I also built another example with Galois conjugation\n\n```\nx = polygen(QQ)\nK.<a> = NumberField(x^2 - 2)\np1 ,p2 = K.Hom(K)\n\nR.<x,y> = K[]\nq1 = R.Hom(R)(p1)\nq2 = R.Hom(R)(p2)\n\nA = AffineSpace(R)\nf1 = A.Hom(A)(q1)\nf2 = A.Hom(A)(q2)\ng = A.Hom(A)([x^2-y, y+1])\nf1*g  # fine\ng*f1  # NotImplementedError\n```",
    "created_at": "2016-08-03T14:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207167",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>I also built another example with Galois conjugation

```
x = polygen(QQ)
K.<a> = NumberField(x^2 - 2)
p1 ,p2 = K.Hom(K)

R.<x,y> = K[]
q1 = R.Hom(R)(p1)
q2 = R.Hom(R)(p2)

A = AffineSpace(R)
f1 = A.Hom(A)(q1)
f2 = A.Hom(A)(q2)
g = A.Hom(A)([x^2-y, y+1])
f1*g  # fine
g*f1  # NotImplementedError
```



---

archive/issue_comments_207168.json:
```json
{
    "body": "<a id='comment:25'></a>If I make your code\n\n```\n  return super(SchemeMorphism_polynomial, self)._composition_(other, homset)\n```\n\nThen I get\n\n```\nsage: A2.<x,y> = AffineSpace(QQ,2)\nsage: H=End(A2)\nsage: f=H([x^2+y^2,y^2/x])\nsage: p= A2([1,2])\nsage: f*p         \t\nComposite map:\n  From: Spectrum of Rational Field\n  To:   Affine Space of dimension 2 over Rational Field\n  Defn:   Generic morphism:\n          From: Spectrum of Rational Field\n          To:   Affine Space of dimension 2 over Rational Field\n        then\n          Generic endomorphism of Affine Space of dimension 2 over\nRational Field\n```\n\nHowever, I can't seem to actually apply the map\n\n```\nsage: p(Spec(QQ).an_element())\nTypeError: Point on Spectrum of Rational Field defined by the Principal ideal (0) of Rational Field fails to convert into the map's domain Spectrum of Rational Field, but a `pushforward` method is not properly implemented\n```\n\nWith your new example, I now get:\n\n```\nComposite map:\n  From: Affine Space of dimension 2 over Number Field in a with defining\npolynomial x^2 - 2\n  To:   Affine Space of dimension 2 over Number Field in a with defining\npolynomial x^2 - 2\n  Defn:   Generic endomorphism of Affine Space of dimension 2 over\nNumber Field in a with defining polynomial x^2 - 2\n        then\n          Generic endomorphism of Affine Space of dimension 2 over\nNumber Field in a with defining polynomial x^2 - 2\n```\n\nI haven't been able to evaluate yours at a pt yet...",
    "created_at": "2016-08-03T14:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207168",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:25'></a>If I make your code

```
  return super(SchemeMorphism_polynomial, self)._composition_(other, homset)
```

Then I get

```
sage: A2.<x,y> = AffineSpace(QQ,2)
sage: H=End(A2)
sage: f=H([x^2+y^2,y^2/x])
sage: p= A2([1,2])
sage: f*p         	
Composite map:
  From: Spectrum of Rational Field
  To:   Affine Space of dimension 2 over Rational Field
  Defn:   Generic morphism:
          From: Spectrum of Rational Field
          To:   Affine Space of dimension 2 over Rational Field
        then
          Generic endomorphism of Affine Space of dimension 2 over
Rational Field
```

However, I can't seem to actually apply the map

```
sage: p(Spec(QQ).an_element())
TypeError: Point on Spectrum of Rational Field defined by the Principal ideal (0) of Rational Field fails to convert into the map's domain Spectrum of Rational Field, but a `pushforward` method is not properly implemented
```

With your new example, I now get:

```
Composite map:
  From: Affine Space of dimension 2 over Number Field in a with defining
polynomial x^2 - 2
  To:   Affine Space of dimension 2 over Number Field in a with defining
polynomial x^2 - 2
  Defn:   Generic endomorphism of Affine Space of dimension 2 over
Number Field in a with defining polynomial x^2 - 2
        then
          Generic endomorphism of Affine Space of dimension 2 over
Number Field in a with defining polynomial x^2 - 2
```

I haven't been able to evaluate yours at a pt yet...



---

archive/issue_comments_207169.json:
```json
{
    "body": "<a id='comment:26'></a>For Galois conjugation the point is that the ring homomorphism `f1` lacks a `inverse_image` for ideals.\n\nThere is something weird with the composition telling that it is the composition of two `Generic endomorphisms`.\n\nAnd an other error\n\n```\nsage: Ai = A.Hom(A).identity()\nsage: f = A.Hom(A)([x,y])\nsage: Ai * f  # TypeError\nsage: f * Ai  # TypeError\n```\nI opened #21160 for the above since it is distinct from what we are trying to do here...",
    "created_at": "2016-08-03T15:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207169",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>For Galois conjugation the point is that the ring homomorphism `f1` lacks a `inverse_image` for ideals.

There is something weird with the composition telling that it is the composition of two `Generic endomorphisms`.

And an other error

```
sage: Ai = A.Hom(A).identity()
sage: f = A.Hom(A)([x,y])
sage: Ai * f  # TypeError
sage: f * Ai  # TypeError
```
I opened #21160 for the above since it is distinct from what we are trying to do here...



---

archive/issue_comments_207170.json:
```json
{
    "body": "<a id='comment:27'></a>I do think allowing this general morphism composition is better, so I'll push that change shortly",
    "created_at": "2016-08-03T15:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207170",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:27'></a>I do think allowing this general morphism composition is better, so I'll push that change shortly



---

archive/issue_comments_207171.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-03T16:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_044684.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-03T16:45:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44684"
}
```



---

archive/issue_events_044685.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-03T16:45:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44685"
}
```



---

archive/issue_comments_207172.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-03T16:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207172",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_044686.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-07T20:01:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15378#event-44686"
}
```



---

archive/issue_comments_207173.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-07T20:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-207173",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
