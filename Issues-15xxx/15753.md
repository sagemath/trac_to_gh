# Issue 15753: Add BasisExchangeMatroid.isomorphism()

archive/issues_015516.json:
```json
{
    "assignees": [],
    "body": "Currently the abstract class BasisExchangeMatroid provides a method .isomorphic() to test if two matroids are isomorphic, but that method does not return an isomorphism, if one exist.\n\nI want to add a function that does. \n\nCC:  @sagetrac-Stefan @sagetrac-yomcat\n\nBranch/Commit: **[c6edefd](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)**\n\nReviewer: **Stefan van Zwam**\n\nAuthor: **Rudi Pendavingh**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/15753_\n\n",
    "closed_at": "2015-05-13T11:33:41Z",
    "created_at": "2014-01-28T19:57:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20matroid%20theory",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add BasisExchangeMatroid.isomorphism()",
    "type": "issue",
    "updated_at": "2015-05-13T11:33:41Z",
    "url": "https://github.com/sagemath/sage/issues/15753",
    "user": "https://github.com/sagetrac-Rudi"
}
```
Currently the abstract class BasisExchangeMatroid provides a method .isomorphic() to test if two matroids are isomorphic, but that method does not return an isomorphism, if one exist.

I want to add a function that does. 

CC:  @sagetrac-Stefan @sagetrac-yomcat

Branch/Commit: **[c6edefd](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)**

Reviewer: **Stefan van Zwam**

Author: **Rudi Pendavingh**

_Issue created by migration from https://trac.sagemath.org/ticket/15753_





---

archive/issue_events_207416.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2014-01-28T19:57:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207416"
}
```



---

archive/issue_events_207417.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2014-01-28T19:57:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20matroid%20theory",
    "label_color": "0000ff",
    "label_name": "component: matroid theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207417"
}
```



---

archive/issue_events_207418.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2014-01-28T19:57:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207418"
}
```



---

archive/issue_events_207419.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2014-01-28T19:57:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207419"
}
```



---

archive/issue_comments_200976.json:
```json
{
    "body": "Branch: **[u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)**",
    "created_at": "2014-01-28T20:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200976",
    "user": "https://github.com/sagetrac-Rudi"
}
```

Branch: **[u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)**



---

archive/issue_comments_200977.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nMade a first implementation by modifying the existing _is_isomorphic. It compiles and the doctests work. I will run a few tests before I put it up for review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c\">ddfd7bd</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr></table>\n",
    "created_at": "2014-01-28T20:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200977",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:2" align="right">Comment 2</div>

Made a first implementation by modifying the existing _is_isomorphic. It compiles and the doctests work. I will run a few tests before I put it up for review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c">ddfd7bd</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr></table>




---

archive/issue_comments_200978.json:
```json
{
    "body": "Commit: **[ddfd7bd](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)**",
    "created_at": "2014-01-28T20:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200978",
    "user": "https://github.com/sagetrac-Rudi"
}
```

Commit: **[ddfd7bd](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)**



---

archive/issue_comments_200979.json:
```json
{
    "body": "Changed commit from **[ddfd7bd](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)** to **[077a754](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)**",
    "created_at": "2014-01-29T13:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200979",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ddfd7bd](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)** to **[077a754](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)**



---

archive/issue_comments_200980.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9\">077a754</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr></table>\n",
    "created_at": "2014-01-29T13:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200980",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3" align="right">Comment 3</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9">077a754</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr></table>




---

archive/issue_events_207420.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207420"
}
```



---

archive/issue_events_207421.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207421"
}
```



---

archive/issue_comments_200981.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI'm happy with this implementation, so have a look.",
    "created_at": "2014-01-31T07:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200981",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:5" align="right">Comment 5</div>

I'm happy with this implementation, so have a look.



---

archive/issue_events_207422.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2014-01-31T07:58:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207422"
}
```



---

archive/issue_comments_200982.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nHi, I noticed the following about the special cases for rank or corank 0 or 1 in basis_exchange_matroid.pyx and for rank 0 in basis_matroid.pyx. They return the identity map on the ground set of self rather than a map to the ground set of other. For example\n\n```\nsage: M = Matroid(matrix=Matrix(GF(2), [[1,1,0],[0,1,0],[0,0,0]]))\nsage: N = Matroid(matrix=Matrix(GF(2), [[0,1,1],[0,1,0],[0,0,0]]))\nsage: M.is_isomorphic(N)\nTrue\nsage: M.is_isomorphism(N, M.isomorphism(N))\nFalse\n```\n\n```\nsage: M = Matroid(groundset='abcde', bases=[[]])\nsage: N = Matroid(groundset=range(5), bases=[[]])\nsage: M.is_isomorphic(N)\nTrue\nsage: M.is_isomorphism(N, M.isomorphism(N))\n\nValueError: range of morphism does not contain groundset of other matroid.\n```\nFor the rank/corank 0 case maybe the line\n\n```\nreturn {e:e for e in self.groundset()}\n```\nshould be something like\n\n```\nreturn {list(self.groundset())[i]:list(other.groundset())[i] for i in range(len(self.groundset()))}\n```\nand for the rank 1 case\n\n```\nmorphism = {list(M.groundset()-M.loops())[i]:list(N.groundset()-N.loops())[i] for i in range(len(M.groundset()-M.loops()))}\nmorphism2 = {list(M.loops())[i]:list(N.loops())[i] for i in range(len(M.loops()))}\nmorphism.update(morphism2)\nreturn morphism\n```",
    "created_at": "2014-04-04T01:53:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200982",
    "user": "https://github.com/sagetrac-rohan"
}
```

<div id="comment:6" align="right">Comment 6</div>

Hi, I noticed the following about the special cases for rank or corank 0 or 1 in basis_exchange_matroid.pyx and for rank 0 in basis_matroid.pyx. They return the identity map on the ground set of self rather than a map to the ground set of other. For example

```
sage: M = Matroid(matrix=Matrix(GF(2), [[1,1,0],[0,1,0],[0,0,0]]))
sage: N = Matroid(matrix=Matrix(GF(2), [[0,1,1],[0,1,0],[0,0,0]]))
sage: M.is_isomorphic(N)
True
sage: M.is_isomorphism(N, M.isomorphism(N))
False
```

```
sage: M = Matroid(groundset='abcde', bases=[[]])
sage: N = Matroid(groundset=range(5), bases=[[]])
sage: M.is_isomorphic(N)
True
sage: M.is_isomorphism(N, M.isomorphism(N))

ValueError: range of morphism does not contain groundset of other matroid.
```
For the rank/corank 0 case maybe the line

```
return {e:e for e in self.groundset()}
```
should be something like

```
return {list(self.groundset())[i]:list(other.groundset())[i] for i in range(len(self.groundset()))}
```
and for the rank 1 case

```
morphism = {list(M.groundset()-M.loops())[i]:list(N.groundset()-N.loops())[i] for i in range(len(M.groundset()-M.loops()))}
morphism2 = {list(M.loops())[i]:list(N.loops())[i] for i in range(len(M.loops()))}
morphism.update(morphism2)
return morphism
```



---

archive/issue_comments_200983.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e\">d2088e2</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr></table>\n",
    "created_at": "2014-04-04T06:56:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200983",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7" align="right">Comment 7</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e">d2088e2</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr></table>




---

archive/issue_comments_200984.json:
```json
{
    "body": "Changed commit from **[077a754](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)** to **[d2088e2](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)**",
    "created_at": "2014-04-04T06:56:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200984",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[077a754](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)** to **[d2088e2](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)**



---

archive/issue_comments_200985.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThanks for catching that, Rohan. I changed the rank=0 case as you suggested and removed the separate handling of rank=1.",
    "created_at": "2014-04-04T06:58:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200985",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:8" align="right">Comment 8</div>

Thanks for catching that, Rohan. I changed the rank=0 case as you suggested and removed the separate handling of rank=1.



---

archive/issue_comments_200986.json:
```json
{
    "body": "Author: **Rudi Pendavingh**",
    "created_at": "2014-04-13T20:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200986",
    "user": "https://github.com/sagetrac-Rudi"
}
```

Author: **Rudi Pendavingh**



---

archive/issue_events_207423.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207423"
}
```



---

archive/issue_events_207424.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207424"
}
```



---

archive/issue_events_207425.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207425"
}
```



---

archive/issue_events_207426.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207426"
}
```



---

archive/issue_comments_200987.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nGiven that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.\n\nAlso, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?",
    "created_at": "2014-10-17T14:03:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200987",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">Comment 12</div>

Given that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.

Also, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?



---

archive/issue_events_207427.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-17T14:38:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207427"
}
```



---

archive/issue_events_207428.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-17T14:38:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207428"
}
```



---

archive/issue_comments_200988.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@jdemeyer](#comment%3A12):\n> Given that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.\n> \n\nOK, I'll remove these then.\n\n> Also, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?\n\nWe did not really think about this. But is there a disadvantage? Cpdef just allows cdef child classes to override the function. While I don't see why anyone would want that,  why make it impossible? These are slow, high-level functions, so a little pointer testing at the start of the function won't affect overall efficiency. \n\nI wanted to upload a patch but today sage -b exits with: \n\"src/convert.c:1:0: error: unknown value '10.10' of -mmacosx-version-min \nscons: * * * [src/convert.os] Error 1\"\n\nI guess my OSX version is too new. \n\nSo feel free to make these changes, or wait until I find another way to test + upload a patch.",
    "created_at": "2014-10-22T21:40:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200988",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@jdemeyer](#comment%3A12):
> Given that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.
> 

OK, I'll remove these then.

> Also, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?

We did not really think about this. But is there a disadvantage? Cpdef just allows cdef child classes to override the function. While I don't see why anyone would want that,  why make it impossible? These are slow, high-level functions, so a little pointer testing at the start of the function won't affect overall efficiency. 

I wanted to upload a patch but today sage -b exits with: 
"src/convert.c:1:0: error: unknown value '10.10' of -mmacosx-version-min 
scons: * * * [src/convert.os] Error 1"

I guess my OSX version is too new. 

So feel free to make these changes, or wait until I find another way to test + upload a patch.



---

archive/issue_comments_200989.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nI wanted to finish this up now that my OSX version is not too new anymore, but I get a new type of error when compiling the patch. \n\nRudiPeninghsMBP:sage rudi$ ./sage -b\nInstall file: \"include/interrupt.h\" as \"/Users/rudi/Documents/Development/sage/local/include/csage/interrupt.h\"\nInstall file: \"include/ntl_wrap.h\" as \"/Users/rudi/Documents/Development/sage/local/include/csage/ntl_wrap.h\"\ngcc -o src/interrupt.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/interrupt.c\ng++ -o src/ZZ_pylong.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/ZZ_pylong.cpp\nIn file included from src/ZZ_pylong.cpp:13:0:\ninclude/ntl_wrap.h:255:35: error: using typedef-name 'NTL::mat_ZZ' after 'struct'\n EXTERN void mat_ZZ_SetDims(struct mat_ZZ* mZZ, long nrows, long ncols);\n                                   ^\nIn file included from include/ntl_wrap.h:13:0,\n                 from src/ZZ_pylong.cpp:13:\n/Users/rudi/Documents/Development/sage/local/include/NTL/mat_ZZ.h:12:17: note: 'NTL::mat_ZZ' has a previous declaration here\n typedef Mat<ZZ> mat_ZZ;\n\nEtcetera.\n\nThis happens only if I work on the branch related to this ticket, not the master. Can anyone try to compile this patch to confirm that this is related to the patch and not something else?",
    "created_at": "2015-05-04T10:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200989",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:15" align="right">Comment 15</div>

I wanted to finish this up now that my OSX version is not too new anymore, but I get a new type of error when compiling the patch. 

RudiPeninghsMBP:sage rudi$ ./sage -b
Install file: "include/interrupt.h" as "/Users/rudi/Documents/Development/sage/local/include/csage/interrupt.h"
Install file: "include/ntl_wrap.h" as "/Users/rudi/Documents/Development/sage/local/include/csage/ntl_wrap.h"
gcc -o src/interrupt.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/interrupt.c
g++ -o src/ZZ_pylong.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/ZZ_pylong.cpp
In file included from src/ZZ_pylong.cpp:13:0:
include/ntl_wrap.h:255:35: error: using typedef-name 'NTL::mat_ZZ' after 'struct'
 EXTERN void mat_ZZ_SetDims(struct mat_ZZ* mZZ, long nrows, long ncols);
                                   ^
In file included from include/ntl_wrap.h:13:0,
                 from src/ZZ_pylong.cpp:13:
/Users/rudi/Documents/Development/sage/local/include/NTL/mat_ZZ.h:12:17: note: 'NTL::mat_ZZ' has a previous declaration here
 typedef Mat<ZZ> mat_ZZ;

Etcetera.

This happens only if I work on the branch related to this ticket, not the master. Can anyone try to compile this patch to confirm that this is related to the patch and not something else?



---

archive/issue_comments_200990.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nThis is an old ticket. It'll probably build on the branch after you do a \"make distclean\" or something. Alternatively, you can merge the ticket with the current develop branch. The easiest way (as a reviewer) is to do\n\ngit trac try 15753\n\n(assuming you have the git-trac command installed correctly). For working on the ticket, I'd probably stay on this branch, or look into rebasing (I'm still not sure what the policy is, read up on it in the developer manual).",
    "created_at": "2015-05-05T15:43:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200990",
    "user": "https://github.com/sagetrac-Stefan"
}
```

<div id="comment:16" align="right">Comment 16</div>

This is an old ticket. It'll probably build on the branch after you do a "make distclean" or something. Alternatively, you can merge the ticket with the current develop branch. The easiest way (as a reviewer) is to do

git trac try 15753

(assuming you have the git-trac command installed correctly). For working on the ticket, I'd probably stay on this branch, or look into rebasing (I'm still not sure what the policy is, read up on it in the developer manual).



---

archive/issue_comments_200991.json:
```json
{
    "body": "Changed commit from **[d2088e2](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)** to **[3173b33](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)**",
    "created_at": "2015-05-06T19:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200991",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d2088e2](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)** to **[3173b33](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)**



---

archive/issue_comments_200992.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db8762aa7290eb4589ce2a430f2ede74e3c3a6a5\">db8762a</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f700c479151b8531249f737e9564fa888c7d5a8\">6f700c4</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ffbb3aec07266256213e32223a80a63f6c093da9\">ffbb3ae</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8637560417c8a6a0985198ec4c8da0e05eb5b06\">c863756</a></td><td><code>removed cpdef _isomorphism(self,other) from basis_exchange_matroid.pyx and basis_matroid.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded\">3173b33</a></td><td><code>Merge branch 'u/Rudi/ticket/15753' of git://trac.sagemath.org/sage into t/15753/ticket/15753</code></td></tr></table>\n",
    "created_at": "2015-05-06T19:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200992",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17" align="right">Comment 17</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db8762aa7290eb4589ce2a430f2ede74e3c3a6a5">db8762a</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f700c479151b8531249f737e9564fa888c7d5a8">6f700c4</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ffbb3aec07266256213e32223a80a63f6c093da9">ffbb3ae</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8637560417c8a6a0985198ec4c8da0e05eb5b06">c863756</a></td><td><code>removed cpdef _isomorphism(self,other) from basis_exchange_matroid.pyx and basis_matroid.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded">3173b33</a></td><td><code>Merge branch 'u/Rudi/ticket/15753' of git://trac.sagemath.org/sage into t/15753/ticket/15753</code></td></tr></table>




---

archive/issue_comments_200993.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nThanks, Stefan, for pointing out that I should rebase. Very happy that this problem is out of the way.\n\nI rebased, then made my final edits, and tried to push. Another merge was necessary before I could finally push. Hope it all worked out correctly.",
    "created_at": "2015-05-06T19:40:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200993",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:18" align="right">Comment 18</div>

Thanks, Stefan, for pointing out that I should rebase. Very happy that this problem is out of the way.

I rebased, then made my final edits, and tried to push. Another merge was necessary before I could finally push. Hope it all worked out correctly.



---

archive/issue_events_207429.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2015-05-06T19:40:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207429"
}
```



---

archive/issue_events_207430.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2015-05-06T19:40:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207430"
}
```



---

archive/issue_comments_200994.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nTwo minor comments and a question:\n\n* In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.\n\n* In Matroid._isomorphism you didn't indent the EXAMPLES block.\n\nFix those two things and the code gets a positive review from me.\n\nOne remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.",
    "created_at": "2015-05-07T22:32:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200994",
    "user": "https://github.com/sagetrac-Stefan"
}
```

<div id="comment:19" align="right">Comment 19</div>

Two minor comments and a question:

* In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.

* In Matroid._isomorphism you didn't indent the EXAMPLES block.

Fix those two things and the code gets a positive review from me.

One remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.



---

archive/issue_comments_200995.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42\">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>\n",
    "created_at": "2015-05-08T19:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200995",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20" align="right">Comment 20</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>




---

archive/issue_comments_200996.json:
```json
{
    "body": "Changed commit from **[3173b33](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)** to **[c6edefd](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)**",
    "created_at": "2015-05-08T19:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200996",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3173b33](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)** to **[c6edefd](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)**



---

archive/issue_comments_200997.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@sagetrac-Stefan](#comment%3A19):\n> Two minor comments and a question:\n> \n> * In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.\n> \n\nTo make sure that this file's version of the isomorphism test eventually gets used (and in particular, not BasisMatroid._is_isomorphic), I put back the BasisMatroid conversions for just one of each pair of matroids. \n \n\n> * In Matroid._isomorphism you didn't indent the EXAMPLES block.\n\nI did so now.\n\n\n> One remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.\n\nI'll keep it in mind.  \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42\">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42\">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>\n",
    "created_at": "2015-05-08T19:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200997",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@sagetrac-Stefan](#comment%3A19):
> Two minor comments and a question:
> 
> * In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.
> 

To make sure that this file's version of the isomorphism test eventually gets used (and in particular, not BasisMatroid._is_isomorphic), I put back the BasisMatroid conversions for just one of each pair of matroids. 
 

> * In Matroid._isomorphism you didn't indent the EXAMPLES block.

I did so now.


> One remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.

I'll keep it in mind.  

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>




---

archive/issue_comments_200998.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nThis one's good to go!",
    "created_at": "2015-05-11T15:53:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200998",
    "user": "https://github.com/sagetrac-Stefan"
}
```

<div id="comment:22" align="right">Comment 22</div>

This one's good to go!



---

archive/issue_events_207431.json:
```json
{
    "actor": "https://github.com/sagetrac-Stefan",
    "created_at": "2015-05-11T15:53:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207431"
}
```



---

archive/issue_events_207432.json:
```json
{
    "actor": "https://github.com/sagetrac-Stefan",
    "created_at": "2015-05-11T15:53:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207432"
}
```



---

archive/issue_comments_200999.json:
```json
{
    "body": "Reviewer: **Stefan van Zwam**",
    "created_at": "2015-05-11T15:53:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200999",
    "user": "https://github.com/sagetrac-Stefan"
}
```

Reviewer: **Stefan van Zwam**



---

archive/issue_events_207433.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-13T11:33:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207433"
}
```



---

archive/issue_events_207434.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a5c8af890967de3a3745fd2073d1e41f947beddc",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-05-13T11:33:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-207434"
}
```



---

archive/issue_comments_201000.json:
```json
{
    "body": "Changed branch from **[u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)** to **[c6edefd](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)**",
    "created_at": "2015-05-13T11:33:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-201000",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)** to **[c6edefd](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)**
