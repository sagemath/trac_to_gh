# Issue 15753: Add BasisExchangeMatroid.isomorphism()

archive/issues_015516.json:
```json
{
    "body": "Currently the abstract class BasisExchangeMatroid provides a method .isomorphic() to test if two matroids are isomorphic, but that method does not return an isomorphism, if one exist.\n\nI want to add a function that does. \n\n**CC:**  Stefan yomcat\n\n**Branch/Commit:** [c6edefd889cf9331b43e0ac30a6cad45d41ebf42](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)\n\n**Reviewer:** Stefan van Zwam\n\n**Author:** Rudi Pendavingh\n\nIssue created by migration from https://trac.sagemath.org/ticket/15753\n\n",
    "closed_at": "2015-05-13T11:33:41Z",
    "created_at": "2014-01-28T19:57:06Z",
    "labels": [
        "component: matroid theory",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "Add BasisExchangeMatroid.isomorphism()",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/15753",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```
Currently the abstract class BasisExchangeMatroid provides a method .isomorphic() to test if two matroids are isomorphic, but that method does not return an isomorphism, if one exist.

I want to add a function that does. 

**CC:**  Stefan yomcat

**Branch/Commit:** [c6edefd889cf9331b43e0ac30a6cad45d41ebf42](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)

**Reviewer:** Stefan van Zwam

**Author:** Rudi Pendavingh

Issue created by migration from https://trac.sagemath.org/ticket/15753





---

archive/issue_comments_200925.json:
```json
{
    "body": "**Branch:** [u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)",
    "created_at": "2014-01-28T20:51:44Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200925",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

**Branch:** [u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)



---

archive/issue_comments_200926.json:
```json
{
    "body": "<a id='comment:2'></a>\nMade a first implementation by modifying the existing _is_isomorphic. It compiles and the doctests work. I will run a few tests before I put it up for review.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c\">ddfd7bd</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr></table>\n",
    "created_at": "2014-01-28T20:54:54Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200926",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:2'></a>
Made a first implementation by modifying the existing _is_isomorphic. It compiles and the doctests work. I will run a few tests before I put it up for review.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c">ddfd7bd</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr></table>




---

archive/issue_comments_200927.json:
```json
{
    "body": "**Commit:** [ddfd7bdfcf587c8d3736fa68887fe7f15721b21c](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)",
    "created_at": "2014-01-28T20:54:54Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200927",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

**Commit:** [ddfd7bdfcf587c8d3736fa68887fe7f15721b21c](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)



---

archive/issue_comments_200928.json:
```json
{
    "body": "**Changing commit** from \"[ddfd7bdfcf587c8d3736fa68887fe7f15721b21c](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)\" to \"[077a75419879432860ad22ac87bbf9e14b81cdb9](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)\".",
    "created_at": "2014-01-29T13:10:13Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200928",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ddfd7bdfcf587c8d3736fa68887fe7f15721b21c](https://github.com/sagemath/sagetrac-mirror/commit/ddfd7bdfcf587c8d3736fa68887fe7f15721b21c)" to "[077a75419879432860ad22ac87bbf9e14b81cdb9](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)".



---

archive/issue_comments_200929.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9\">077a754</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr></table>\n",
    "created_at": "2014-01-29T13:10:13Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9">077a754</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr></table>




---

archive/issue_events_139968.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139968"
}
```



---

archive/issue_events_139969.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139969"
}
```



---

archive/issue_comments_200930.json:
```json
{
    "body": "<a id='comment:5'></a>\nI'm happy with this implementation, so have a look.",
    "created_at": "2014-01-31T07:58:40Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200930",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:5'></a>
I'm happy with this implementation, so have a look.



---

archive/issue_events_139970.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Rudi",
    "created_at": "2014-01-31T07:58:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139970"
}
```



---

archive/issue_comments_200931.json:
```json
{
    "body": "<a id='comment:6'></a>\nHi, I noticed the following about the special cases for rank or corank 0 or 1 in basis_exchange_matroid.pyx and for rank 0 in basis_matroid.pyx. They return the identity map on the ground set of self rather than a map to the ground set of other. For example\n\n```\nsage: M = Matroid(matrix=Matrix(GF(2), [[1,1,0],[0,1,0],[0,0,0]]))\nsage: N = Matroid(matrix=Matrix(GF(2), [[0,1,1],[0,1,0],[0,0,0]]))\nsage: M.is_isomorphic(N)\nTrue\nsage: M.is_isomorphism(N, M.isomorphism(N))\nFalse\n```\n\n```\nsage: M = Matroid(groundset='abcde', bases=[[]])\nsage: N = Matroid(groundset=range(5), bases=[[]])\nsage: M.is_isomorphic(N)\nTrue\nsage: M.is_isomorphism(N, M.isomorphism(N))\n\nValueError: range of morphism does not contain groundset of other matroid.\n```\nFor the rank/corank 0 case maybe the line\n\n```\nreturn {e:e for e in self.groundset()}\n```\nshould be something like\n\n```\nreturn {list(self.groundset())[i]:list(other.groundset())[i] for i in range(len(self.groundset()))}\n```\nand for the rank 1 case\n\n```\nmorphism = {list(M.groundset()-M.loops())[i]:list(N.groundset()-N.loops())[i] for i in range(len(M.groundset()-M.loops()))}\nmorphism2 = {list(M.loops())[i]:list(N.loops())[i] for i in range(len(M.loops()))}\nmorphism.update(morphism2)\nreturn morphism\n```",
    "created_at": "2014-04-04T01:53:58Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200931",
    "user": "https://trac.sagemath.org/admin/accounts/users/rohan"
}
```

<a id='comment:6'></a>
Hi, I noticed the following about the special cases for rank or corank 0 or 1 in basis_exchange_matroid.pyx and for rank 0 in basis_matroid.pyx. They return the identity map on the ground set of self rather than a map to the ground set of other. For example

```
sage: M = Matroid(matrix=Matrix(GF(2), [[1,1,0],[0,1,0],[0,0,0]]))
sage: N = Matroid(matrix=Matrix(GF(2), [[0,1,1],[0,1,0],[0,0,0]]))
sage: M.is_isomorphic(N)
True
sage: M.is_isomorphism(N, M.isomorphism(N))
False
```

```
sage: M = Matroid(groundset='abcde', bases=[[]])
sage: N = Matroid(groundset=range(5), bases=[[]])
sage: M.is_isomorphic(N)
True
sage: M.is_isomorphism(N, M.isomorphism(N))

ValueError: range of morphism does not contain groundset of other matroid.
```
For the rank/corank 0 case maybe the line

```
return {e:e for e in self.groundset()}
```
should be something like

```
return {list(self.groundset())[i]:list(other.groundset())[i] for i in range(len(self.groundset()))}
```
and for the rank 1 case

```
morphism = {list(M.groundset()-M.loops())[i]:list(N.groundset()-N.loops())[i] for i in range(len(M.groundset()-M.loops()))}
morphism2 = {list(M.loops())[i]:list(N.loops())[i] for i in range(len(M.loops()))}
morphism.update(morphism2)
return morphism
```



---

archive/issue_comments_200932.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e\">d2088e2</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr></table>\n",
    "created_at": "2014-04-04T06:56:03Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e">d2088e2</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr></table>




---

archive/issue_comments_200933.json:
```json
{
    "body": "**Changing commit** from \"[077a75419879432860ad22ac87bbf9e14b81cdb9](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)\" to \"[d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)\".",
    "created_at": "2014-04-04T06:56:03Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200933",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[077a75419879432860ad22ac87bbf9e14b81cdb9](https://github.com/sagemath/sagetrac-mirror/commit/077a75419879432860ad22ac87bbf9e14b81cdb9)" to "[d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)".



---

archive/issue_comments_200934.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks for catching that, Rohan. I changed the rank=0 case as you suggested and removed the separate handling of rank=1.",
    "created_at": "2014-04-04T06:58:05Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200934",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:8'></a>
Thanks for catching that, Rohan. I changed the rank=0 case as you suggested and removed the separate handling of rank=1.



---

archive/issue_comments_200935.json:
```json
{
    "body": "**Author:** Rudi Pendavingh",
    "created_at": "2014-04-13T20:15:12Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200935",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

**Author:** Rudi Pendavingh



---

archive/issue_events_139971.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139971"
}
```



---

archive/issue_events_139972.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139972"
}
```



---

archive/issue_events_139973.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139973"
}
```



---

archive/issue_events_139974.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139974"
}
```



---

archive/issue_comments_200936.json:
```json
{
    "body": "<a id='comment:12'></a>\nGiven that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.\n\nAlso, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?",
    "created_at": "2014-10-17T14:03:26Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200936",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Given that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.

Also, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?



---

archive/issue_events_139975.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-17T14:38:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139975"
}
```



---

archive/issue_events_139976.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-17T14:38:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139976"
}
```



---

archive/issue_comments_200937.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A12):\n> Given that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.\n> \n\nOK, I'll remove these then.\n\n> Also, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?\n\n\nWe did not really think about this. But is there a disadvantage? Cpdef just allows cdef child classes to override the function. While I don't see why anyone would want that,  why make it impossible? These are slow, high-level functions, so a little pointer testing at the start of the function won't affect overall efficiency. \n\nI wanted to upload a patch but today sage -b exits with: \n\"src/convert.c:1:0: error: unknown value '10.10' of -mmacosx-version-min \nscons: * * * [src/convert.os] Error 1\"\n\nI guess my OSX version is too new. \n\nSo feel free to make these changes, or wait until I find another way to test + upload a patch.",
    "created_at": "2014-10-22T21:40:13Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200937",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A12):
> Given that `BasisExchangeMatroid` and `BasisMatroid` both inherit from `Matroid`, there is no point in adding `cpdef _isomorphism(self, other)` in the `.pxd` files for those.
> 

OK, I'll remove these then.

> Also, what's the advantage of making `isomorphism()` (without underscore) a `cpdef` method as opposed to just `def`?


We did not really think about this. But is there a disadvantage? Cpdef just allows cdef child classes to override the function. While I don't see why anyone would want that,  why make it impossible? These are slow, high-level functions, so a little pointer testing at the start of the function won't affect overall efficiency. 

I wanted to upload a patch but today sage -b exits with: 
"src/convert.c:1:0: error: unknown value '10.10' of -mmacosx-version-min 
scons: * * * [src/convert.os] Error 1"

I guess my OSX version is too new. 

So feel free to make these changes, or wait until I find another way to test + upload a patch.



---

archive/issue_comments_200938.json:
```json
{
    "body": "<a id='comment:15'></a>\nI wanted to finish this up now that my OSX version is not too new anymore, but I get a new type of error when compiling the patch. \n\nRudiPeninghsMBP:sage rudi$ ./sage -b\nInstall file: \"include/interrupt.h\" as \"/Users/rudi/Documents/Development/sage/local/include/csage/interrupt.h\"\nInstall file: \"include/ntl_wrap.h\" as \"/Users/rudi/Documents/Development/sage/local/include/csage/ntl_wrap.h\"\ngcc -o src/interrupt.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/interrupt.c\ng++ -o src/ZZ_pylong.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/ZZ_pylong.cpp\nIn file included from src/ZZ_pylong.cpp:13:0:\ninclude/ntl_wrap.h:255:35: error: using typedef-name 'NTL::mat_ZZ' after 'struct'\n EXTERN void mat_ZZ_SetDims(struct mat_ZZ* mZZ, long nrows, long ncols);\n                                   ^\nIn file included from include/ntl_wrap.h:13:0,\n                 from src/ZZ_pylong.cpp:13:\n/Users/rudi/Documents/Development/sage/local/include/NTL/mat_ZZ.h:12:17: note: 'NTL::mat_ZZ' has a previous declaration here\n typedef Mat<ZZ> mat_ZZ;\n\nEtcetera.\n\nThis happens only if I work on the branch related to this ticket, not the master. Can anyone try to compile this patch to confirm that this is related to the patch and not something else?",
    "created_at": "2015-05-04T10:53:03Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200938",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:15'></a>
I wanted to finish this up now that my OSX version is not too new anymore, but I get a new type of error when compiling the patch. 

RudiPeninghsMBP:sage rudi$ ./sage -b
Install file: "include/interrupt.h" as "/Users/rudi/Documents/Development/sage/local/include/csage/interrupt.h"
Install file: "include/ntl_wrap.h" as "/Users/rudi/Documents/Development/sage/local/include/csage/ntl_wrap.h"
gcc -o src/interrupt.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/interrupt.c
g++ -o src/ZZ_pylong.os -c -fPIC -I/Users/rudi/Documents/Development/sage/local/include -I/Users/rudi/Documents/Development/sage/local/include/python2.7 -I/Users/rudi/Documents/Development/sage/local/include/NTL -Iinclude src/ZZ_pylong.cpp
In file included from src/ZZ_pylong.cpp:13:0:
include/ntl_wrap.h:255:35: error: using typedef-name 'NTL::mat_ZZ' after 'struct'
 EXTERN void mat_ZZ_SetDims(struct mat_ZZ* mZZ, long nrows, long ncols);
                                   ^
In file included from include/ntl_wrap.h:13:0,
                 from src/ZZ_pylong.cpp:13:
/Users/rudi/Documents/Development/sage/local/include/NTL/mat_ZZ.h:12:17: note: 'NTL::mat_ZZ' has a previous declaration here
 typedef Mat<ZZ> mat_ZZ;

Etcetera.

This happens only if I work on the branch related to this ticket, not the master. Can anyone try to compile this patch to confirm that this is related to the patch and not something else?



---

archive/issue_comments_200939.json:
```json
{
    "body": "<a id='comment:16'></a>\nThis is an old ticket. It'll probably build on the branch after you do a \"make distclean\" or something. Alternatively, you can merge the ticket with the current develop branch. The easiest way (as a reviewer) is to do\n\ngit trac try 15753\n\n(assuming you have the git-trac command installed correctly). For working on the ticket, I'd probably stay on this branch, or look into rebasing (I'm still not sure what the policy is, read up on it in the developer manual).",
    "created_at": "2015-05-05T15:43:31Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200939",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

<a id='comment:16'></a>
This is an old ticket. It'll probably build on the branch after you do a "make distclean" or something. Alternatively, you can merge the ticket with the current develop branch. The easiest way (as a reviewer) is to do

git trac try 15753

(assuming you have the git-trac command installed correctly). For working on the ticket, I'd probably stay on this branch, or look into rebasing (I'm still not sure what the policy is, read up on it in the developer manual).



---

archive/issue_comments_200940.json:
```json
{
    "body": "**Changing commit** from \"[d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)\" to \"[3173b33f49757e8e4d247e0aebe618fa744a0ded](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)\".",
    "created_at": "2015-05-06T19:34:02Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e](https://github.com/sagemath/sagetrac-mirror/commit/d2088e2ecfd8115fa36ed16af684d1ebdc66fe8e)" to "[3173b33f49757e8e4d247e0aebe618fa744a0ded](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)".



---

archive/issue_comments_200941.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db8762aa7290eb4589ce2a430f2ede74e3c3a6a5\">db8762a</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f700c479151b8531249f737e9564fa888c7d5a8\">6f700c4</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ffbb3aec07266256213e32223a80a63f6c093da9\">ffbb3ae</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8637560417c8a6a0985198ec4c8da0e05eb5b06\">c863756</a></td><td><code>removed cpdef _isomorphism(self,other) from basis_exchange_matroid.pyx and basis_matroid.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded\">3173b33</a></td><td><code>Merge branch 'u/Rudi/ticket/15753' of git://trac.sagemath.org/sage into t/15753/ticket/15753</code></td></tr></table>\n",
    "created_at": "2015-05-06T19:34:02Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db8762aa7290eb4589ce2a430f2ede74e3c3a6a5">db8762a</a></td><td><code>Added ._isomorphism to both BasisExchangeMatroid and BasisMatroid.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f700c479151b8531249f737e9564fa888c7d5a8">6f700c4</a></td><td><code>Added Matroid.isomorphism() and Matroid._isomorphism()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ffbb3aec07266256213e32223a80a63f6c093da9">ffbb3ae</a></td><td><code>BasisExchangeMatroid._isomorphism() and BasisMatroid._isomorphism() now properly handle rank<2.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8637560417c8a6a0985198ec4c8da0e05eb5b06">c863756</a></td><td><code>removed cpdef _isomorphism(self,other) from basis_exchange_matroid.pyx and basis_matroid.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded">3173b33</a></td><td><code>Merge branch 'u/Rudi/ticket/15753' of git://trac.sagemath.org/sage into t/15753/ticket/15753</code></td></tr></table>




---

archive/issue_comments_200942.json:
```json
{
    "body": "<a id='comment:18'></a>\nThanks, Stefan, for pointing out that I should rebase. Very happy that this problem is out of the way.\n\nI rebased, then made my final edits, and tried to push. Another merge was necessary before I could finally push. Hope it all worked out correctly.",
    "created_at": "2015-05-06T19:40:24Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200942",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:18'></a>
Thanks, Stefan, for pointing out that I should rebase. Very happy that this problem is out of the way.

I rebased, then made my final edits, and tried to push. Another merge was necessary before I could finally push. Hope it all worked out correctly.



---

archive/issue_events_139977.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Rudi",
    "created_at": "2015-05-06T19:40:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139977"
}
```



---

archive/issue_events_139978.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Rudi",
    "created_at": "2015-05-06T19:40:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139978"
}
```



---

archive/issue_comments_200943.json:
```json
{
    "body": "<a id='comment:19'></a>\nTwo minor comments and a question:\n\n* In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.\n\n* In Matroid._isomorphism you didn't indent the EXAMPLES block.\n\nFix those two things and the code gets a positive review from me.\n\nOne remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.",
    "created_at": "2015-05-07T22:32:30Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200943",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

<a id='comment:19'></a>
Two minor comments and a question:

* In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.

* In Matroid._isomorphism you didn't indent the EXAMPLES block.

Fix those two things and the code gets a positive review from me.

One remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.



---

archive/issue_comments_200944.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42\">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>\n",
    "created_at": "2015-05-08T19:52:42Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200944",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>




---

archive/issue_comments_200945.json:
```json
{
    "body": "**Changing commit** from \"[3173b33f49757e8e4d247e0aebe618fa744a0ded](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)\" to \"[c6edefd889cf9331b43e0ac30a6cad45d41ebf42](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)\".",
    "created_at": "2015-05-08T19:52:42Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3173b33f49757e8e4d247e0aebe618fa744a0ded](https://github.com/sagemath/sagetrac-mirror/commit/3173b33f49757e8e4d247e0aebe618fa744a0ded)" to "[c6edefd889cf9331b43e0ac30a6cad45d41ebf42](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)".



---

archive/issue_comments_200946.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [Stefan](#comment%3A19):\n> Two minor comments and a question:\n> \n> * In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.\n> \n \nTo make sure that this file's version of the isomorphism test eventually gets used (and in particular, not BasisMatroid._is_isomorphic), I put back the BasisMatroid conversions for just one of each pair of matroids. \n \n\n> * In Matroid._isomorphism you didn't indent the EXAMPLES block.\n\n\nI did so now.\n\n\n> One remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.\n\n\nI'll keep it in mind.  \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42\">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42\">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>\n",
    "created_at": "2015-05-08T19:53:52Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200946",
    "user": "https://trac.sagemath.org/admin/accounts/users/Rudi"
}
```

<a id='comment:21'></a>
Replying to [Stefan](#comment%3A19):
> Two minor comments and a question:
> 
> * In BasisExchangeMatroid._is_isomorphic you changed four lines in the EXAMPLES section to remove BasisMatroid conversions. While today that doesn't matter, I would prefer to keep those to ensure that this file's version of the isomorphism test gets used, instead of some subclass's file.
> 
 
To make sure that this file's version of the isomorphism test eventually gets used (and in particular, not BasisMatroid._is_isomorphic), I put back the BasisMatroid conversions for just one of each pair of matroids. 
 

> * In Matroid._isomorphism you didn't indent the EXAMPLES block.


I did so now.


> One remark though: in Sage's graph class, there is a fairly common idiom to have an option in the test methods of the form `certificate=True/False`. When set to True, the function returns `(True, f)` if an isomorphism f is found, and `(False, )` otherwise. I'm not saying we should follow this here (isomorphism is important enough to be its own function), but we may want to consider it for other test methods.


I'll keep it in mind.  

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42">c6edefd</a></td><td><code>Doctest fixes</code></td></tr></table>




---

archive/issue_comments_200947.json:
```json
{
    "body": "<a id='comment:22'></a>\nThis one's good to go!",
    "created_at": "2015-05-11T15:53:37Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200947",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

<a id='comment:22'></a>
This one's good to go!



---

archive/issue_events_139979.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Stefan",
    "created_at": "2015-05-11T15:53:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139979"
}
```



---

archive/issue_events_139980.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/Stefan",
    "created_at": "2015-05-11T15:53:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139980"
}
```



---

archive/issue_comments_200948.json:
```json
{
    "body": "**Reviewer:** Stefan van Zwam",
    "created_at": "2015-05-11T15:53:53Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200948",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

**Reviewer:** Stefan van Zwam



---

archive/issue_events_139981.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-13T11:33:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139981"
}
```



---

archive/issue_events_139982.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a5c8af890967de3a3745fd2073d1e41f947beddc",
    "created_at": "2015-05-13T11:33:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/15753#event-139982"
}
```



---

archive/issue_comments_200949.json:
```json
{
    "body": "**Changing branch** from \"[u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)\" to \"[c6edefd889cf9331b43e0ac30a6cad45d41ebf42](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)\".",
    "created_at": "2015-05-13T11:33:41Z",
    "issue": "https://github.com/sagemath/sage/issues/15753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/15753#issuecomment-200949",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/Rudi/ticket/15753](https://github.com/sagemath/sagetrac-mirror/tree/u/Rudi/ticket/15753)" to "[c6edefd889cf9331b43e0ac30a6cad45d41ebf42](https://github.com/sagemath/sagetrac-mirror/commit/c6edefd889cf9331b43e0ac30a6cad45d41ebf42)".
