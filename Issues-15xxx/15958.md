# Issue 15958: Bug in Partition Algebras

archive/issues_015721.json:
```json
{
    "body": "There is a bug in the implementation of the product in partition algebras.\n\n```\nsage: A = PartitionAlgebra(1,17)\nsage: g = SetPartitionsAk(1).list()\nsage: a = A[g[1]]\nsage: a\nP[{{-1}, {1}}]\nsage: a*a\nP[{{-1}, {1}}]\n```\n\nThis should return\n\n```\n17*P[{{-1}, {1}}]\n```\n\nAssignee: @BruceWestbury\n\nCC:  @tscrim sage-combinat\n\nBranch/Commit: 92d3350ed305fe53fcf4eda491138b32b2bd4278\n\nReviewer: Darij Grinberg, Chwas Ahmed\n\nAuthor: Bruce Westbury\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15958\n\n",
    "closed_at": "2014-04-29T12:03:16Z",
    "created_at": "2014-03-17T10:42:04Z",
    "labels": [
        "component: combinatorics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Bug in Partition Algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15958",
    "user": "https://github.com/BruceWestbury"
}
```
There is a bug in the implementation of the product in partition algebras.

```
sage: A = PartitionAlgebra(1,17)
sage: g = SetPartitionsAk(1).list()
sage: a = A[g[1]]
sage: a
P[{{-1}, {1}}]
sage: a*a
P[{{-1}, {1}}]
```

This should return

```
17*P[{{-1}, {1}}]
```

Assignee: @BruceWestbury

CC:  @tscrim sage-combinat

Branch/Commit: 92d3350ed305fe53fcf4eda491138b32b2bd4278

Reviewer: Darij Grinberg, Chwas Ahmed

Author: Bruce Westbury

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15958





---

archive/issue_comments_258391.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2014-03-17T11:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258391",
    "user": "https://github.com/BruceWestbury"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_258392.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2014-03-17T11:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258392",
    "user": "https://github.com/BruceWestbury"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_258393.json:
```json
{
    "body": "Changing branch from \"\" to \"u/Bruce/ticket/15958\"",
    "created_at": "2014-03-17T21:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258393",
    "user": "https://github.com/BruceWestbury"
}
```

Changing branch from "" to "u/Bruce/ticket/15958"



---

archive/issue_comments_258394.json:
```json
{
    "body": "Changing commit from \"\" to \"70747fb6fa10db18414a9e49e06f3769c7e17eb0\"",
    "created_at": "2014-03-19T15:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258394",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "70747fb6fa10db18414a9e49e06f3769c7e17eb0"



---

archive/issue_comments_258395.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------|\n|[70747fb](http://git.sagemath.org/sage.git/commit/?id=70747fb6fa10db18414a9e49e06f3769c7e17eb0)|`Fixed an error`|",
    "created_at": "2014-03-19T15:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------|
|[70747fb](http://git.sagemath.org/sage.git/commit/?id=70747fb6fa10db18414a9e49e06f3769c7e17eb0)|`Fixed an error`|



---

archive/issue_comments_258396.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-19T15:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258396",
    "user": "https://github.com/BruceWestbury"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_258397.json:
```json
{
    "body": "Changing branch from \"u/Bruce/ticket/15958\" to \"public/ticket/15958\"",
    "created_at": "2014-03-19T19:16:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258397",
    "user": "https://github.com/darijgr"
}
```

Changing branch from "u/Bruce/ticket/15958" to "public/ticket/15958"



---

archive/issue_comments_258398.json:
```json
{
    "body": "Changing commit from \"70747fb6fa10db18414a9e49e06f3769c7e17eb0\" to \"92d3350ed305fe53fcf4eda491138b32b2bd4278\"",
    "created_at": "2014-03-19T19:16:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258398",
    "user": "https://github.com/darijgr"
}
```

Changing commit from "70747fb6fa10db18414a9e49e06f3769c7e17eb0" to "92d3350ed305fe53fcf4eda491138b32b2bd4278"



---

archive/issue_comments_258399.json:
```json
{
    "body": "<a id='comment:6'></a>\n---\nNew commits:\n|                                                                                                                                          |                                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|\n|[7866a3a](http://git.sagemath.org/sage.git/commit/?id=7866a3a0eba3f2e57a9ae59fff49a8b30ccb4c86)|`Merge branch 'u/Bruce/ticket/15958' of trac.sagemath.org:sage into 15958`|\n|[92d3350](http://git.sagemath.org/sage.git/commit/?id=92d3350ed305fe53fcf4eda491138b32b2bd4278)|`add doctests, improve documentation, duplicate the fix in partition_algebra.py`|",
    "created_at": "2014-03-19T19:16:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258399",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:6'></a>
---
New commits:
|                                                                                                                                          |                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
|[7866a3a](http://git.sagemath.org/sage.git/commit/?id=7866a3a0eba3f2e57a9ae59fff49a8b30ccb4c86)|`Merge branch 'u/Bruce/ticket/15958' of trac.sagemath.org:sage into 15958`|
|[92d3350](http://git.sagemath.org/sage.git/commit/?id=92d3350ed305fe53fcf4eda491138b32b2bd4278)|`add doctests, improve documentation, duplicate the fix in partition_algebra.py`|



---

archive/issue_comments_258400.json:
```json
{
    "body": "<a id='comment:7'></a>\nGood catch! I've improved it a bit. First of all, bugs fixed should be doctested to ensure that they don't reappear when someone later copies bad code (or for other reasons). Second, there is no good reason to check for `len(part_list) > 0` after a call to `part_list[0]`; that test should have been removed rather than corrected. (By the way, this was already inside an `if len(part_list) > 0` clause...) Finally, the code is (for some reason) duplicated in `partition_algebra.py`; I don't have the time to track down the reasons of this duplication, but I've fixed the bug over there as well.\n\nBad news is that someone else will have to review this ticket now. :)",
    "created_at": "2014-03-19T19:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258400",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:7'></a>
Good catch! I've improved it a bit. First of all, bugs fixed should be doctested to ensure that they don't reappear when someone later copies bad code (or for other reasons). Second, there is no good reason to check for `len(part_list) > 0` after a call to `part_list[0]`; that test should have been removed rather than corrected. (By the way, this was already inside an `if len(part_list) > 0` clause...) Finally, the code is (for some reason) duplicated in `partition_algebra.py`; I don't have the time to track down the reasons of this duplication, but I've fixed the bug over there as well.

Bad news is that someone else will have to review this ticket now. :)



---

archive/issue_comments_258401.json:
```json
{
    "body": "Set assignee to Chwas.",
    "created_at": "2014-03-28T22:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258401",
    "user": "https://trac.sagemath.org/admin/accounts/users/Chwas"
}
```

Set assignee to Chwas.



---

archive/issue_comments_258402.json:
```json
{
    "body": "I think you are right about the bug, and I will try to review it.",
    "created_at": "2014-03-28T22:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258402",
    "user": "https://trac.sagemath.org/admin/accounts/users/Chwas"
}
```

I think you are right about the bug, and I will try to review it.



---

archive/issue_comments_258403.json:
```json
{
    "body": "<a id='comment:10'></a>\nAny progress? Hello?",
    "created_at": "2014-04-23T01:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258403",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:10'></a>
Any progress? Hello?



---

archive/issue_comments_258404.json:
```json
{
    "body": "Remove assignee Chwas.",
    "created_at": "2014-04-28T11:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258404",
    "user": "https://trac.sagemath.org/admin/accounts/users/Chwas"
}
```

Remove assignee Chwas.



---

archive/issue_comments_258405.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-28T11:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258405",
    "user": "https://trac.sagemath.org/admin/accounts/users/Chwas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_258406.json:
```json
{
    "body": "Set assignee to @BruceWestbury.",
    "created_at": "2014-04-28T14:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258406",
    "user": "https://github.com/tscrim"
}
```

Set assignee to @BruceWestbury.



---

archive/issue_comments_258407.json:
```json
{
    "body": "<a id='comment:13'></a>\nChwas, please add your real name to the reviewers.",
    "created_at": "2014-04-28T14:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258407",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
Chwas, please add your real name to the reviewers.



---

archive/issue_comments_258408.json:
```json
{
    "body": "Changing author from \"\" to \"Bruce Westbury\"",
    "created_at": "2014-04-28T14:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258408",
    "user": "https://github.com/tscrim"
}
```

Changing author from "" to "Bruce Westbury"



---

archive/issue_comments_258409.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Darij Grinberg,\"",
    "created_at": "2014-04-28T14:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258409",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Darij Grinberg,"



---

archive/issue_comments_258410.json:
```json
{
    "body": "Changing reviewer from \"Darij Grinberg,\" to \"Darij Grinberg, Chwas\"",
    "created_at": "2014-04-28T15:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258410",
    "user": "https://trac.sagemath.org/admin/accounts/users/Chwas"
}
```

Changing reviewer from "Darij Grinberg," to "Darij Grinberg, Chwas"



---

archive/issue_comments_258411.json:
```json
{
    "body": "Changing reviewer from \"Darij Grinberg, Chwas\" to \"Darij Grinberg, Chwas Ahmed\"",
    "created_at": "2014-04-28T15:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258411",
    "user": "https://trac.sagemath.org/admin/accounts/users/Chwas"
}
```

Changing reviewer from "Darij Grinberg, Chwas" to "Darij Grinberg, Chwas Ahmed"



---

archive/issue_comments_258412.json:
```json
{
    "body": "Changing branch from \"public/ticket/15958\" to \"92d3350ed305fe53fcf4eda491138b32b2bd4278\"",
    "created_at": "2014-04-29T12:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258412",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/ticket/15958" to "92d3350ed305fe53fcf4eda491138b32b2bd4278"



---

archive/issue_comments_258413.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-29T12:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15958#issuecomment-258413",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_046935.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-29T12:03:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15958",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15958#event-46935"
}
```
