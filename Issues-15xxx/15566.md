# Issue 15566: The -sync-build option is broken

archive/issues_015329.json:
```json
{
    "body": "\n\nCC:  @ohanar\n\nReviewer: Nathann Cohen\n\nAuthor: Volker Braun\n\nBranch: u/vbraun/sync_build\n\nCommit: 958a2633be8659ceeacff651cb509b0d6ab759e1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15566\n\n",
    "closed_at": "2013-12-24T20:24:16Z",
    "created_at": "2013-12-22T11:49:45Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "The -sync-build option is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15566",
    "user": "https://github.com/vbraun"
}
```


CC:  @ohanar

Reviewer: Nathann Cohen

Author: Volker Braun

Branch: u/vbraun/sync_build

Commit: 958a2633be8659ceeacff651cb509b0d6ab759e1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15566





---

archive/issue_comments_245683.json:
```json
{
    "body": "<a id='comment:1'></a>\n\n```\n$ sage -sync-build\nTraceback (most recent call last):\n  File \"/home/vbraun/Code/sage.git/src/bin/sage-sync-build.py\", line 110, in <module>\n    clean_tree(prune_directories=prune_directories, dry_run=dry_run)\n  File \"/home/vbraun/Code/sage.git/src/bin/sage-sync-build.py\", line 86, in clean_tree\n    os.rmdir(dir_path)\nOSError: [Errno 39] Directory not empty: '/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/server/trac'\n```",
    "created_at": "2013-12-22T11:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245683",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:1'></a>

```
$ sage -sync-build
Traceback (most recent call last):
  File "/home/vbraun/Code/sage.git/src/bin/sage-sync-build.py", line 110, in <module>
    clean_tree(prune_directories=prune_directories, dry_run=dry_run)
  File "/home/vbraun/Code/sage.git/src/bin/sage-sync-build.py", line 86, in clean_tree
    os.rmdir(dir_path)
OSError: [Errno 39] Directory not empty: '/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/sage/server/trac'
```



---

archive/issue_comments_245684.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/sync_build\"",
    "created_at": "2013-12-22T12:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245684",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/sync_build"



---

archive/issue_comments_245685.json:
```json
{
    "body": "Changing commit from \"\" to \"958a2633be8659ceeacff651cb509b0d6ab759e1\"",
    "created_at": "2013-12-22T12:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245685",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "" to "958a2633be8659ceeacff651cb509b0d6ab759e1"



---

archive/issue_comments_245686.json:
```json
{
    "body": "<a id='comment:3'></a>\nNew commits:\n|                                                                                                         |                          |\n|---------------------------------------------------------------------------------------------------------|--------------------------|\n|[958a263](https://github.com/sagemath/sagetrac-mirror/commit/958a263)|`actually delete the file`|",
    "created_at": "2013-12-22T12:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245686",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>
New commits:
|                                                                                                         |                          |
|---------------------------------------------------------------------------------------------------------|--------------------------|
|[958a263](https://github.com/sagemath/sagetrac-mirror/commit/958a263)|`actually delete the file`|



---

archive/issue_comments_245687.json:
```json
{
    "body": "Changing author from \"\" to \"Volker Braun\"",
    "created_at": "2013-12-22T12:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245687",
    "user": "https://github.com/vbraun"
}
```

Changing author from "" to "Volker Braun"



---

archive/issue_comments_245688.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-12-22T12:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245688",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_245689.json:
```json
{
    "body": "<a id='comment:4'></a>\nHmmmmmmm `O_o`\n\nNot to mention that the meaning of the `dir_path` variable at this location in the code isn't exactly clear `O_O`\n\nNathann",
    "created_at": "2013-12-22T15:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245689",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
Hmmmmmmm `O_o`

Not to mention that the meaning of the `dir_path` variable at this location in the code isn't exactly clear `O_O`

Nathann



---

archive/issue_comments_245690.json:
```json
{
    "body": "<a id='comment:5'></a>\nOkay, what this commit does makes sense, and once this is done `sage -sync-build` raises no exception, but the `sage.schemes.toric.library.ToricVarietyFactory.torus` object from #15564 still seems to exist !?...\n\nNathann",
    "created_at": "2013-12-22T15:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245690",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>
Okay, what this commit does makes sense, and once this is done `sage -sync-build` raises no exception, but the `sage.schemes.toric.library.ToricVarietyFactory.torus` object from #15564 still seems to exist !?...

Nathann



---

archive/issue_comments_245691.json:
```json
{
    "body": "<a id='comment:6'></a>\nOh, by the way, I did not just checkout your branch but merged it with 6.0.rc1.\n\nNathann",
    "created_at": "2013-12-22T15:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245691",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>
Oh, by the way, I did not just checkout your branch but merged it with 6.0.rc1.

Nathann



---

archive/issue_comments_245692.json:
```json
{
    "body": "<a id='comment:7'></a>\nOk, the `torus()` was merged in f00af8f6 and is a normal method in src/sage/schemes/toric/library.py",
    "created_at": "2013-12-22T15:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245692",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
Ok, the `torus()` was merged in f00af8f6 and is a normal method in src/sage/schemes/toric/library.py



---

archive/issue_comments_245693.json:
```json
{
    "body": "<a id='comment:8'></a>\nAhahahah. You wrote that yourself `:-P`\n\nOkay, so this patch can go and I can try to fix #15564. With other things from the doc. I now use this --warn-links option that Florent exposed, and I would like it to become Sage's default for the doc. But in the meantime we have plenty of links to fix `:-P`\n\nNathann",
    "created_at": "2013-12-22T15:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245693",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
Ahahahah. You wrote that yourself `:-P`

Okay, so this patch can go and I can try to fix #15564. With other things from the doc. I now use this --warn-links option that Florent exposed, and I would like it to become Sage's default for the doc. But in the meantime we have plenty of links to fix `:-P`

Nathann



---

archive/issue_comments_245694.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-12-22T16:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245694",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_245695.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathann Cohen\"",
    "created_at": "2013-12-22T16:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245695",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Nathann Cohen"



---

archive/issue_comments_245696.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-12-24T20:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15566#issuecomment-245696",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059724.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-24T20:24:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15566",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15566#event-59724"
}
```
