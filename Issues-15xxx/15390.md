# Issue 15390: roots of polynomials and eigenvalues of matrices over finite fields

archive/issues_015153.json:
```json
{
    "body": "Based on #14990 we implement root computations in the algebraic closure of finite fields.\n\nIt should be nice to also adapt eigenvectors... (but we need before algebraic conjugates)\n\nCurrently finite subfields of an algebraic closure can not talk to each other (see in particular #16509). But hopefully, it is possible to compute roots without it!\n\nCC:  @pjbruin @defeo\n\nKeywords: sage-days55\n\nWork_Issues: wait for dependency\n\nReviewer: Miguel Marco\n\nAuthor: Vincent Delecroix\n\nBranch: 1eee50b9282d2b007b7435af9a866d996369dd54\n\nDependencies: #14990, #16509\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/15390\n\n",
    "closed_at": "2014-06-24T14:09:04Z",
    "created_at": "2013-11-09T22:22:05Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "roots of polynomials and eigenvalues of matrices over finite fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15390",
    "user": "https://github.com/videlec"
}
```
Based on #14990 we implement root computations in the algebraic closure of finite fields.

It should be nice to also adapt eigenvectors... (but we need before algebraic conjugates)

Currently finite subfields of an algebraic closure can not talk to each other (see in particular #16509). But hopefully, it is possible to compute roots without it!

CC:  @pjbruin @defeo

Keywords: sage-days55

Work_Issues: wait for dependency

Reviewer: Miguel Marco

Author: Vincent Delecroix

Branch: 1eee50b9282d2b007b7435af9a866d996369dd54

Dependencies: #14990, #16509

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/15390





---

archive/issue_comments_194250.json:
```json
{
    "body": "<a id='comment:1'></a>Last 10 new commits:",
    "created_at": "2013-11-09T22:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194250",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>Last 10 new commits:



---

archive/issue_comments_194251.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-11-09T23:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194252.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-11-09T23:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194253.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-11-09T23:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194253",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_events_044728.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15390#event-44728"
}
```



---

archive/issue_events_044729.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15390#event-44729"
}
```



---

archive/issue_events_044730.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15390#event-44730"
}
```



---

archive/issue_comments_194254.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-11T07:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194254",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_194255.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-09T00:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194256.json:
```json
{
    "body": "<a id='comment:12'></a>Hello,\n\nNeeds review!\n\nI will not do eigenspaces since it needs the implementation of algebraic conjugates... for another ticket.\n\nVincent",
    "created_at": "2014-06-09T00:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194256",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>Hello,

Needs review!

I will not do eigenspaces since it needs the implementation of algebraic conjugates... for another ticket.

Vincent



---

archive/issue_comments_194257.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-09T00:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194257",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_194258.json:
```json
{
    "body": "<a id='comment:13'></a>Is there some reason why it shouldn't work for any finite field with a fixed embedding on the algebraic closure? (or the algebraic closure itself)",
    "created_at": "2014-06-21T06:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194258",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:13'></a>Is there some reason why it shouldn't work for any finite field with a fixed embedding on the algebraic closure? (or the algebraic closure itself)



---

archive/issue_comments_194259.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 mmarco]:\n> Is there some reason why it shouldn't work for any finite field with a fixed embedding on the algebraic closure? (or the algebraic closure itself)\n\n\nIt is rather independent of that ticket. As soon as you make work the embeddings of finite fields into algebraic closures, then there will be nothing to change in my code to make the roots and eigenvalues work.\n\nEDIT: For the algebraic closure itself... I will have a look.\n\nVincent",
    "created_at": "2014-06-21T07:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194259",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>Replying to [comment:13 mmarco]:
> Is there some reason why it shouldn't work for any finite field with a fixed embedding on the algebraic closure? (or the algebraic closure itself)


It is rather independent of that ticket. As soon as you make work the embeddings of finite fields into algebraic closures, then there will be nothing to change in my code to make the roots and eigenvalues work.

EDIT: For the algebraic closure itself... I will have a look.

Vincent



---

archive/issue_comments_194260.json:
```json
{
    "body": "<a id='comment:15'></a>Ok. I had a look and the reason is because the inclusions are only implemented between the subfields:\n\n```\nsage: K = GF(5).algebraic_closure()\nsage: K2, phi2 = K.subfield(2)\nsage: K4, phi4 = K.subfield(4)\nsage: z2 = K2.gen()\nsage: K4(z2)\nTraceback (most recent call last):\n...\nTypeError: unable to coerce from a finite field other than the prime subfield\n```\nBut the following works\n\n```\nsage: f24 = K.inclusion(2,4)\nsage: f24(K2.gen())\nz4^3 + z4^2 + z4 + 3\n```\n\nI will at least fix the `_roots_univariate_polynomial` using the inclusion morphism.\n\nVincent",
    "created_at": "2014-06-21T08:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194260",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>Ok. I had a look and the reason is because the inclusions are only implemented between the subfields:

```
sage: K = GF(5).algebraic_closure()
sage: K2, phi2 = K.subfield(2)
sage: K4, phi4 = K.subfield(4)
sage: z2 = K2.gen()
sage: K4(z2)
Traceback (most recent call last):
...
TypeError: unable to coerce from a finite field other than the prime subfield
```
But the following works

```
sage: f24 = K.inclusion(2,4)
sage: f24(K2.gen())
z4^3 + z4^2 + z4 + 3
```

I will at least fix the `_roots_univariate_polynomial` using the inclusion morphism.

Vincent



---

archive/issue_comments_194261.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-06-21T08:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194261",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_194262.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-21T10:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194263.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-21T10:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194263",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_194264.json:
```json
{
    "body": "<a id='comment:18'></a>Ok. Now it works.",
    "created_at": "2014-06-21T10:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194264",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>Ok. Now it works.



---

archive/issue_comments_194265.json:
```json
{
    "body": "<a id='comment:19'></a>Looks good, but... shouldn't it make more sense to implement the factorization of polynomials? (it is basically what your code does).\n\nWe should get the roots for free from the factorization.",
    "created_at": "2014-06-21T19:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194265",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:19'></a>Looks good, but... shouldn't it make more sense to implement the factorization of polynomials? (it is basically what your code does).

We should get the roots for free from the factorization.



---

archive/issue_comments_194266.json:
```json
{
    "body": "<a id='comment:20'></a>You are right, I will have a look where to implement the factor stuff.\n\nI also set #16509 as a dependency since it makes more sense to use the smallest field possible for all the coefficients...\n\nVincent",
    "created_at": "2014-06-22T10:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194266",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>You are right, I will have a look where to implement the factor stuff.

I also set #16509 as a dependency since it makes more sense to use the smallest field possible for all the coefficients...

Vincent



---

archive/issue_comments_194267.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-22T14:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194267",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194268.json:
```json
{
    "body": "<a id='comment:22'></a>Since you are computing a factorization to get the roots, wouldn't it make more sense to go the other way around?. That is, write a complicated method that computes the factorization, and then just call it to get the roots.\n\nIt seems that what you ar doing is computing the factorization to get the roots, and then use the roots to compute the factorization.",
    "created_at": "2014-06-22T16:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194268",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:22'></a>Since you are computing a factorization to get the roots, wouldn't it make more sense to go the other way around?. That is, write a complicated method that computes the factorization, and then just call it to get the roots.

It seems that what you ar doing is computing the factorization to get the roots, and then use the roots to compute the factorization.



---

archive/issue_comments_194269.json:
```json
{
    "body": "<a id='comment:23'></a>Hey\n\nThe two things are equivalent in an algebraically closed field, right? And from the coding point of view, it is more natural the other way around. If you look at the part of the code which actually does the computation, I do not see where it looks more like a factorisation rather than a computation of roots\n\n```\nroots = [] # a list of pair (root,multiplicity)\nfor g,m in P(new_coeffs).factor():\n    if g.degree() == 1:\n        r = phi(-g.constant_coefficient())\n        roots.append((r,m))\n    else:\n        ll = l * g.degree()\n        psi = self.inclusion(l, ll)\n        FF, pphi = self.subfield(ll)\n        gg = PolynomialRing(FF, 'x')(map(psi, g))\n        for r,_ in gg.roots(): # note: we know that multiplicity is 1\n                roots.append((pphi(r),m))\n```\n\nIf you have an alternative proposition, propose it, but I really do not see what you mean. The only `factor` which appears above is over the field where are defined the coefficients.\n\nVincent",
    "created_at": "2014-06-22T16:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194269",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>Hey

The two things are equivalent in an algebraically closed field, right? And from the coding point of view, it is more natural the other way around. If you look at the part of the code which actually does the computation, I do not see where it looks more like a factorisation rather than a computation of roots

```
roots = [] # a list of pair (root,multiplicity)
for g,m in P(new_coeffs).factor():
    if g.degree() == 1:
        r = phi(-g.constant_coefficient())
        roots.append((r,m))
    else:
        ll = l * g.degree()
        psi = self.inclusion(l, ll)
        FF, pphi = self.subfield(ll)
        gg = PolynomialRing(FF, 'x')(map(psi, g))
        for r,_ in gg.roots(): # note: we know that multiplicity is 1
                roots.append((pphi(r),m))
```

If you have an alternative proposition, propose it, but I really do not see what you mean. The only `factor` which appears above is over the field where are defined the coefficients.

Vincent



---

archive/issue_comments_194270.json:
```json
{
    "body": "<a id='comment:24'></a>Ok, if you really prefear it this way, you can leave it. Just check the commas (some of them don't have a space after, but they should).",
    "created_at": "2014-06-22T16:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194270",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:24'></a>Ok, if you really prefear it this way, you can leave it. Just check the commas (some of them don't have a space after, but they should).



---

archive/issue_comments_194271.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-22T17:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194271",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194272.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:24 mmarco]:\n> Ok, if you really prefear it this way, you can leave it.\n\n\nI do not prefer it this way, I just do not see how to do the other way around. If you know and think it is better, please provide a branch.\n\n> Just check the commas (some of them don't have a space after, but they should).\n\n\nWhy do they should?! These are just coding conventions and I do prefer\n`for i,j,k in my_list` rather than `for i, j, k in my_list`. But as you saw I did it.",
    "created_at": "2014-06-22T17:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194272",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>Replying to [comment:24 mmarco]:
> Ok, if you really prefear it this way, you can leave it.


I do not prefer it this way, I just do not see how to do the other way around. If you know and think it is better, please provide a branch.

> Just check the commas (some of them don't have a space after, but they should).


Why do they should?! These are just coding conventions and I do prefer
`for i,j,k in my_list` rather than `for i, j, k in my_list`. But as you saw I did it.



---

archive/issue_comments_194273.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-23T07:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194273",
    "user": "https://github.com/miguelmarco"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_194274.json:
```json
{
    "body": "<a id='comment:28'></a>Thanks for the review!",
    "created_at": "2014-06-23T10:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194274",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>Thanks for the review!



---

archive/issue_comments_194275.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-06-23T21:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194275",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_194276.json:
```json
{
    "body": "<a id='comment:29'></a>reviewer name",
    "created_at": "2014-06-23T21:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194276",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:29'></a>reviewer name



---

archive/issue_comments_194277.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-06-23T21:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194277",
    "user": "https://github.com/miguelmarco"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_194278.json:
```json
{
    "body": "<a id='comment:31'></a>Miguel, you are supposed to sign with your real name not the trac account name",
    "created_at": "2014-06-23T21:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194278",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'></a>Miguel, you are supposed to sign with your real name not the trac account name



---

archive/issue_events_044731.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-24T14:09:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15390#event-44731"
}
```



---

archive/issue_comments_194279.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-24T14:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194279",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_194280.json:
```json
{
    "body": "<a id='comment:33'></a>See #16681 for a followup",
    "created_at": "2014-07-19T04:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15390#issuecomment-194280",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'></a>See #16681 for a followup
