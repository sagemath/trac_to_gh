# Issue 31758: Submodules of a MatrixSpace

archive/issues_031758.json:
```json
{
    "body": "CC:  @tscrim @roed314\n\n`MatrixSpace` does not implement the category `ModulesWithBasis` correctly.\n\n```\nsage: M = MatrixSpace(QQ, 2)\nsage: M.submodule([M.matrix([[1, 2], [3, 4]])])\nAttributeError: 'tuple' object has no attribute 'support'\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31995\n\n",
    "created_at": "2021-06-17T05:14:43Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Submodules of a MatrixSpace",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31758",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @tscrim @roed314

`MatrixSpace` does not implement the category `ModulesWithBasis` correctly.

```
sage: M = MatrixSpace(QQ, 2)
sage: M.submodule([M.matrix([[1, 2], [3, 4]])])
AttributeError: 'tuple' object has no attribute 'support'
```



Issue created by migration from https://trac.sagemath.org/ticket/31995





---

archive/issue_comments_453198.json:
```json
{
    "body": "Here's a first fix (follow-up from #19448, I think)\n\n----\nNew commits:",
    "created_at": "2021-06-17T05:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453198",
    "user": "https://github.com/mkoeppe"
}
```

Here's a first fix (follow-up from #19448, I think)

----
New commits:



---

archive/issue_comments_453199.json:
```json
{
    "body": "This gets a bit farther and now leads to:\n\n```\nTypeError: <class 'sage.sets.family.TrivialFamily_with_category'> is not hashable and does not implement _cache_key()\n```\n",
    "created_at": "2021-06-17T05:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453199",
    "user": "https://github.com/mkoeppe"
}
```

This gets a bit farther and now leads to:

```
TypeError: <class 'sage.sets.family.TrivialFamily_with_category'> is not hashable and does not implement _cache_key()
```




---

archive/issue_comments_453200.json:
```json
{
    "body": "`TrivialFamily` is hashable and even has a doctest:\n\n```\nsage: from sage.sets.family import TrivialFamily\nsage: f = TrivialFamily((3,4,7))\nsage: hash(f) == hash(f)\n```\n\nThe problem comes from the fact that matrices by default are mutable and not hashable. If you look a little higher up in the error, you get:\n\n```\nTypeError: mutable matrices are unhashable\n```\n\nThis comes from the fact that `echelon_form` creates mutable matrices:\n\n```\nsage: mat = M.matrix([[1, 2], [3, 4]])\nsage: mat.set_immutable()\nsage: M.echelon_form([mat])[0]\n[1 2]\n[3 4]\nsage: _.is_mutable()\nTrue\n```\n\nIf we skip this step, then it creates the submodule:\n\n```\nsage: M.submodule([mat], already_echelonized=True)\nFree module generated by {0} over Rational Field\n```\n",
    "created_at": "2021-06-17T06:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453200",
    "user": "https://github.com/tscrim"
}
```

`TrivialFamily` is hashable and even has a doctest:

```
sage: from sage.sets.family import TrivialFamily
sage: f = TrivialFamily((3,4,7))
sage: hash(f) == hash(f)
```

The problem comes from the fact that matrices by default are mutable and not hashable. If you look a little higher up in the error, you get:

```
TypeError: mutable matrices are unhashable
```

This comes from the fact that `echelon_form` creates mutable matrices:

```
sage: mat = M.matrix([[1, 2], [3, 4]])
sage: mat.set_immutable()
sage: M.echelon_form([mat])[0]
[1 2]
[3 4]
sage: _.is_mutable()
True
```

If we skip this step, then it creates the submodule:

```
sage: M.submodule([mat], already_echelonized=True)
Free module generated by {0} over Rational Field
```




---

archive/issue_comments_453201.json:
```json
{
    "body": "The best way around this IMO is a special case of `submodule` in `MatrixSpace` that just makes the result of `echelon_form` into a set of immutable matrices. This now works for me.\n----\nNew commits:",
    "created_at": "2021-06-17T06:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453201",
    "user": "https://github.com/tscrim"
}
```

The best way around this IMO is a special case of `submodule` in `MatrixSpace` that just makes the result of `echelon_form` into a set of immutable matrices. This now works for me.
----
New commits:



---

archive/issue_comments_453202.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-17T06:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453202",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_453203.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-17T18:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453203",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_453204.json:
```json
{
    "body": "This seems to work well, thanks very much!\n\n(The way that the submodule prints itself, using the indices, is a bit strange, but that can be improved on another ticket.)",
    "created_at": "2021-06-17T18:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453204",
    "user": "https://github.com/mkoeppe"
}
```

This seems to work well, thanks very much!

(The way that the submodule prints itself, using the indices, is a bit strange, but that can be improved on another ticket.)



---

archive/issue_comments_453205.json:
```json
{
    "body": "The example from #30334 (duplicate of this ticket) still fails, with a new error:\n\n```\nsage: M = MatrixSpace(QQ, 3, 3)\nsage: M in ModulesWithBasis(QQ)\nTrue\nsage: A = M([[0, 0, 1], [0, 0, 0], [0, 0, 0]])\nsage: A\n[0 0 1]\n[0 0 0]\n[0 0 0]\nsage: M.submodule([A])\nTypeError: entries must be a list of length 9\n```\n",
    "created_at": "2021-06-18T20:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453205",
    "user": "https://github.com/mkoeppe"
}
```

The example from #30334 (duplicate of this ticket) still fails, with a new error:

```
sage: M = MatrixSpace(QQ, 3, 3)
sage: M in ModulesWithBasis(QQ)
True
sage: A = M([[0, 0, 1], [0, 0, 0], [0, 0, 0]])
sage: A
[0 0 1]
[0 0 0]
[0 0 0]
sage: M.submodule([A])
TypeError: entries must be a list of length 9
```




---

archive/issue_comments_453206.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-06-18T20:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453206",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_453207.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-20T23:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_453208.json:
```json
{
    "body": "This fixes that issue, which came from the category `FiniteDimensionalModulesWithBasis` expecting `order` to have full support. However, I think we don't want this because we want to support more sparse matrices (or, more general, any ordering passed from the user) for taking submodules, and having a `get_order()` would force a conversion to a dense implementation.",
    "created_at": "2021-06-20T23:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453208",
    "user": "https://github.com/tscrim"
}
```

This fixes that issue, which came from the category `FiniteDimensionalModulesWithBasis` expecting `order` to have full support. However, I think we don't want this because we want to support more sparse matrices (or, more general, any ordering passed from the user) for taking submodules, and having a `get_order()` would force a conversion to a dense implementation.



---

archive/issue_comments_453209.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-20T23:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453209",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_453210.json:
```json
{
    "body": "Yes, I agree with this solution.\nThanks!",
    "created_at": "2021-06-21T00:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453210",
    "user": "https://github.com/mkoeppe"
}
```

Yes, I agree with this solution.
Thanks!



---

archive/issue_comments_453211.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-21T00:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453211",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_453212.json:
```json
{
    "body": "Thank you.",
    "created_at": "2021-06-21T01:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453212",
    "user": "https://github.com/tscrim"
}
```

Thank you.



---

archive/issue_comments_453213.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-07-05T23:23:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453213",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_453214.json:
```json
{
    "body": "\n```\nsage -t --long --warn-long 42.0 --random-seed=0 src/sage/matrix/matrix_space.py\n**********************************************************************\nFile \"src/sage/matrix/matrix_space.py\", line 1622, in sage.matrix.matrix_space.MatrixSpace.?\nFailed example:\n    Xp = M.submodule([A, B], order=[(0,1), (1,1), (0,0)])\nException raised:\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 996, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:5974)\n        return self.cache[k]\n      File \"sage/misc/weak_dict.pyx\", line 702, in sage.misc.weak_dict.WeakValueDictionary.__getitem__ (build/cythonized/sage/misc/weak_dict.c:3712)\n        cdef PyObject* wr = PyDict_GetItemWithError(self, k)\n    TypeError: unhashable type: 'list'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 543, in sage.misc.cachefunc.dict_key (build/cythonized/sage/misc/cachefunc.c:3091)\n        hash(o)\n    TypeError: unhashable type: 'list'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 583, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3295)\n        hash(o)\n    TypeError: unhashable type: 'list'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 583, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3295)\n        hash(o)\n    TypeError: unhashable type: 'list'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 583, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3295)\n        hash(o)\n    TypeError: unhashable type: 'list'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"sage/misc/cachefunc.pyx\", line 596, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3699)\n        k = o._cache_key()\n    AttributeError: 'list' object has no attribute '_cache_key'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 718, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 1137, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.matrix.matrix_space.MatrixSpace.?[9]>\", line 1, in <module>\n        Xp = M.submodule([A, B], order=[(Integer(0),Integer(1)), (Integer(1),Integer(1)), (Integer(0),Integer(0))])\n      File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage/matrix/matrix_space.py\", line 1647, in submodule\n        return SubmoduleWithBasis(gens, ambient=self,\n      File \"sage/misc/classcall_metaclass.pyx\", line 322, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (build/cythonized/sage/misc/classcall_metaclass.c:1761)\n        return cls.classcall(cls, *args, **kwds)\n      File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage/modules/with_basis/subquotient.py\", line 218, in __classcall_private__\n        return super(SubmoduleWithBasis, cls).__classcall__(cls,\n      File \"sage/misc/cachefunc.pyx\", line 998, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:6013)\n        k = dict_key(k)\n      File \"sage/misc/cachefunc.pyx\", line 545, in sage.misc.cachefunc.dict_key (build/cythonized/sage/misc/cachefunc.c:3129)\n        o = (unhashable_key, cache_key_unhashable(o))\n      File \"sage/misc/cachefunc.pyx\", line 594, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3660)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 594, in genexpr (build/cythonized/sage/misc/cachefunc.c:3551)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 585, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3333)\n        o = cache_key_unhashable(o)\n      File \"sage/misc/cachefunc.pyx\", line 594, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3660)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 594, in genexpr (build/cythonized/sage/misc/cachefunc.c:3551)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 585, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3333)\n        o = cache_key_unhashable(o)\n      File \"sage/misc/cachefunc.pyx\", line 594, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3660)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 594, in genexpr (build/cythonized/sage/misc/cachefunc.c:3551)\n        return tuple(cache_key(item) for item in o)\n      File \"sage/misc/cachefunc.pyx\", line 585, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3333)\n        o = cache_key_unhashable(o)\n      File \"sage/misc/cachefunc.pyx\", line 598, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3783)\n        raise TypeError(\"unhashable type: {!r}\".format(type(o).__name__))\n    TypeError: unhashable type: 'list'\n**********************************************************************\n```\n",
    "created_at": "2021-07-05T23:23:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453214",
    "user": "https://github.com/vbraun"
}
```


```
sage -t --long --warn-long 42.0 --random-seed=0 src/sage/matrix/matrix_space.py
**********************************************************************
File "src/sage/matrix/matrix_space.py", line 1622, in sage.matrix.matrix_space.MatrixSpace.?
Failed example:
    Xp = M.submodule([A, B], order=[(0,1), (1,1), (0,0)])
Exception raised:
    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 996, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:5974)
        return self.cache[k]
      File "sage/misc/weak_dict.pyx", line 702, in sage.misc.weak_dict.WeakValueDictionary.__getitem__ (build/cythonized/sage/misc/weak_dict.c:3712)
        cdef PyObject* wr = PyDict_GetItemWithError(self, k)
    TypeError: unhashable type: 'list'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 543, in sage.misc.cachefunc.dict_key (build/cythonized/sage/misc/cachefunc.c:3091)
        hash(o)
    TypeError: unhashable type: 'list'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 583, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3295)
        hash(o)
    TypeError: unhashable type: 'list'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 583, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3295)
        hash(o)
    TypeError: unhashable type: 'list'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 583, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3295)
        hash(o)
    TypeError: unhashable type: 'list'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "sage/misc/cachefunc.pyx", line 596, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3699)
        k = o._cache_key()
    AttributeError: 'list' object has no attribute '_cache_key'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.matrix.matrix_space.MatrixSpace.?[9]>", line 1, in <module>
        Xp = M.submodule([A, B], order=[(Integer(0),Integer(1)), (Integer(1),Integer(1)), (Integer(0),Integer(0))])
      File "/home/release/Sage/local/lib64/python3.9/site-packages/sage/matrix/matrix_space.py", line 1647, in submodule
        return SubmoduleWithBasis(gens, ambient=self,
      File "sage/misc/classcall_metaclass.pyx", line 322, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (build/cythonized/sage/misc/classcall_metaclass.c:1761)
        return cls.classcall(cls, *args, **kwds)
      File "/home/release/Sage/local/lib64/python3.9/site-packages/sage/modules/with_basis/subquotient.py", line 218, in __classcall_private__
        return super(SubmoduleWithBasis, cls).__classcall__(cls,
      File "sage/misc/cachefunc.pyx", line 998, in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:6013)
        k = dict_key(k)
      File "sage/misc/cachefunc.pyx", line 545, in sage.misc.cachefunc.dict_key (build/cythonized/sage/misc/cachefunc.c:3129)
        o = (unhashable_key, cache_key_unhashable(o))
      File "sage/misc/cachefunc.pyx", line 594, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3660)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 594, in genexpr (build/cythonized/sage/misc/cachefunc.c:3551)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 585, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3333)
        o = cache_key_unhashable(o)
      File "sage/misc/cachefunc.pyx", line 594, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3660)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 594, in genexpr (build/cythonized/sage/misc/cachefunc.c:3551)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 585, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3333)
        o = cache_key_unhashable(o)
      File "sage/misc/cachefunc.pyx", line 594, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3660)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 594, in genexpr (build/cythonized/sage/misc/cachefunc.c:3551)
        return tuple(cache_key(item) for item in o)
      File "sage/misc/cachefunc.pyx", line 585, in sage.misc.cachefunc.cache_key (build/cythonized/sage/misc/cachefunc.c:3333)
        o = cache_key_unhashable(o)
      File "sage/misc/cachefunc.pyx", line 598, in sage.misc.cachefunc.cache_key_unhashable (build/cythonized/sage/misc/cachefunc.c:3783)
        raise TypeError("unhashable type: {!r}".format(type(o).__name__))
    TypeError: unhashable type: 'list'
**********************************************************************
```




---

archive/issue_comments_453215.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-06T00:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_453216.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-06T00:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453216",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_453217.json:
```json
{
    "body": "I could have sworn I tested this...sorry about that. Fixed the bad doctests.",
    "created_at": "2021-07-06T00:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453217",
    "user": "https://github.com/tscrim"
}
```

I could have sworn I tested this...sorry about that. Fixed the bad doctests.



---

archive/issue_comments_453218.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-06T03:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453218",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_453219.json:
```json
{
    "body": "Thank you.",
    "created_at": "2021-07-07T05:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453219",
    "user": "https://github.com/tscrim"
}
```

Thank you.



---

archive/issue_events_028923.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-09T20:23:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31758#event-28923"
}
```



---

archive/issue_comments_453220.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-09T20:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31758#issuecomment-453220",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
