# Issue 25234: sage -t --optional=sage,internet src/sage/databases/oeis.py has 34 doctests failed

Issue created by migration from https://trac.sagemath.org/ticket/25471

Original creator: slabbe

Original creation time: 2018-05-30 20:41:49

This is great:


```
sage -t src/sage/databases/oeis.py 
```



```
Running doctests with ID 2018-05-30-22-32-01-a785b24b.
Git branch: 25305
Using --optional=bliss,ccache,mpir,python2,sage
Doctesting 1 file.
sage -t --warn-long 82.7 src/sage/databases/oeis.py
    [118 tests, 0.99 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 1.0 seconds
    cpu time: 1.3 seconds
    cumulative wall time: 1.0 seconds
```


but as reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ), many doctests depending on internet are failing 



```
sage -t --optional=sage,internet src/sage/databases/oeis.py 
```


gives:


```
Running doctests with ID 2018-05-30-22-32-15-89fb8007.
Git branch: 25305
Using --optional=internet,sage
Doctesting 1 file.
sage -t --warn-long 82.7 src/sage/databases/oeis.py
**********************************************************************
File "src/sage/databases/oeis.py", line 29, in sage.databases.oeis
Failed example:
    search = oeis([3, 7, 15, 1], max_results=4) ; search  # optional -- internet
Expected:
    0: A001203: Continued fraction expansion of Pi.
    1: A082495: a(n) = (2^n - 1) mod n.
    2: A165416: Irregular array read by rows: The n-th row contains those distinct positive integers that each, when written in binary, occurs as a substring in binary n.
    3: A246674: Run Length Transform of A000225.
Got:
    0: A001203: Simple continued fraction expansion of Pi.
    1: A082495: a(n) = (2^n - 1) mod n.
    2: A165416: Irregular array read by rows: The n-th row contains those distinct positive integers that each, when written in binary, occurs as a substring in binary n.
    3: A240698: Partial sums of divisors of n, cf. A027750.
**********************************************************************

...

**********************************************************************
17 items had failures:
   5 of  26 in sage.databases.oeis
   4 of  21 in sage.databases.oeis.OEIS
   1 of   5 in sage.databases.oeis.OEIS.find_by_description
   1 of   3 in sage.databases.oeis.OEIS.find_by_subsequence
   5 of   8 in sage.databases.oeis.OEISSequence
   3 of  13 in sage.databases.oeis.OEISSequence.__call__
   2 of   8 in sage.databases.oeis.OEISSequence.__getitem__
   1 of   4 in sage.databases.oeis.OEISSequence.__init__
   1 of   5 in sage.databases.oeis.OEISSequence.author
   2 of   7 in sage.databases.oeis.OEISSequence.cross_references
   1 of   5 in sage.databases.oeis.OEISSequence.examples
   2 of   5 in sage.databases.oeis.OEISSequence.extensions_or_errors
   1 of  14 in sage.databases.oeis.OEISSequence.first_terms
   1 of   5 in sage.databases.oeis.OEISSequence.formulas
   2 of   9 in sage.databases.oeis.OEISSequence.links
   1 of  22 in sage.databases.oeis.OEISSequence.natural_object
   1 of   5 in sage.databases.oeis.OEISSequence.show
    [266 tests, 34 failures, 83.18 s]
----------------------------------------------------------------------
sage -t --warn-long 82.7 src/sage/databases/oeis.py  # 34 doctests failed
----------------------------------------------------------------------
Total time for all tests: 83.3 seconds
    cpu time: 1.8 seconds
    cumulative wall time: 83.2 seconds
```


Full log is available on [framabin](https://framabin.org/?fd3d1939f986751b#rFxmYLviVoApcqKcKTqkbIeRZnxf6h7I9jKQ2zggVU8=).

Note that, as Sloane writes this week on the [arxiv](https://arxiv.org/abs/1805.10343), the oeis is a now a Wiki which means that Sage doctests should depend as few as possible on the many modifications done on the OEIS database...


---

Comment by slabbe created at 2018-05-30 21:02:03

shorter title


---

Comment by tmonteil created at 2018-06-03 12:29:10

Hi,

i will be on this (some might be tricky, e.g. related to dead sequences).

You write:

> Note that, as Sloane writes this week on the â€‹arxiv, the oeis is a now a Wiki which means that Sage doctests should depend as few as possible on the many modifications done on the OEIS database... 

Are you suggesting to parse the wiki ???

Note that the issue of the database changing was discussed in previous tickets. Still, we should show part of the answers for having meaningful examples (not only for testing purpose, but also for the user).


---

Comment by jhpalmieri created at 2018-06-03 15:44:18

By the way, several of us predicted this sort of situation (lots of broken doctests related to OEIS) in #16252.


---

Comment by tmonteil created at 2018-06-15 10:43:43

Changing keywords from "" to "days94".


---

Comment by git created at 2018-07-01 17:57:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tmonteil created at 2018-07-01 22:15:10

New commits:


---

Comment by tmonteil created at 2018-07-01 22:15:10

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-07-02 18:17:18

ok (but this will need to be done again and again...)


---

Comment by chapoton created at 2018-07-02 18:17:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-07-08 13:05:25

Resolution: fixed
