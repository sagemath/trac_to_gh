# Issue 18756: sage-list-packages should ignore files in build/pkgs/

Issue created by migration from https://trac.sagemath.org/ticket/18993

Original creator: jkeitel

Original creation time: 2015-08-05 12:06:03

CC:  vbraun

At the moment, `sage-list-packages` does not ignore files in `build/pkgs`, which can lead to errors if, say, your browser has automatically created a file after viewing this folder:


```
jkeitel@pcl337b:~/sage/sage_optional> ./sage -optional
Traceback (most recent call last):
  File "/home/pcl337b/jkeitel/sage/sage_optional/src/bin/sage-list-packages", line 57, in <module>
    with open(os.path.join(SAGE_PKGS, p, "package-version.txt")) as f:
IOError: [Errno 20] Not a directory: '/home/pcl337b/jkeitel/sage/sage_optional/build/pkgs/.directory/package-version.txt'
```


I am attaching a simple patch that ignores files and only checks folders.


---

Comment by jkeitel created at 2015-08-05 12:06:52

Changing status from new to needs_review.


---

Comment by vbraun created at 2015-08-05 16:58:38

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2015-08-05 21:32:53

Replying to [ticket:18993 jkeitel]:
> At the moment, `sage-list-packages` does not ignore files in `build/pkgs`, which can lead to errors if, say, your browser has automatically created a file after viewing this folder

I think a better solution would be to ignore _hidden_ files/directories. An ordinary file in `build/pkgs` usually does indicate a problem for which an error is appropriate.


---

Comment by vbraun created at 2015-08-05 22:14:59

Resolution: fixed


---

Comment by vbraun created at 2015-08-05 22:20:54

A file there isn't really indicative of an error, the packages are the subdirectories. We probably shouldn't put any files in build/pkgs but enforcing that because otherwise scripts break in an obscure way isn't good either.


---

Comment by jdemeyer created at 2015-08-06 20:07:59

Between the following 2 options:

(a) ignore all non-directories.

(b) ignore all hidden files and directories.

I'm sure that (b) is the better option, but at this point I don't care enough to create a follow-up ticket.


---

Comment by vbraun created at 2015-08-06 21:32:35

I'm also fine with b) but don't care so much about it that I would patch it ;-)

PS: The perfect is the enemy of the good
