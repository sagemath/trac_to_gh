# Issue 18756: sage-list-packages should ignore files in build/pkgs/

archive/issues_018756.json:
```json
{
    "body": "CC:  @vbraun\n\nAt the moment, `sage-list-packages` does not ignore files in `build/pkgs`, which can lead to errors if, say, your browser has automatically created a file after viewing this folder:\n\n\n```\njkeitel@pcl337b:~/sage/sage_optional> ./sage -optional\nTraceback (most recent call last):\n  File \"/home/pcl337b/jkeitel/sage/sage_optional/src/bin/sage-list-packages\", line 57, in <module>\n    with open(os.path.join(SAGE_PKGS, p, \"package-version.txt\")) as f:\nIOError: [Errno 20] Not a directory: '/home/pcl337b/jkeitel/sage/sage_optional/build/pkgs/.directory/package-version.txt'\n```\n\n\nI am attaching a simple patch that ignores files and only checks folders.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18993\n\n",
    "created_at": "2015-08-05T12:06:03Z",
    "labels": [
        "spkg-check",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "sage-list-packages should ignore files in build/pkgs/",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18756",
    "user": "jkeitel"
}
```
CC:  @vbraun

At the moment, `sage-list-packages` does not ignore files in `build/pkgs`, which can lead to errors if, say, your browser has automatically created a file after viewing this folder:


```
jkeitel@pcl337b:~/sage/sage_optional> ./sage -optional
Traceback (most recent call last):
  File "/home/pcl337b/jkeitel/sage/sage_optional/src/bin/sage-list-packages", line 57, in <module>
    with open(os.path.join(SAGE_PKGS, p, "package-version.txt")) as f:
IOError: [Errno 20] Not a directory: '/home/pcl337b/jkeitel/sage/sage_optional/build/pkgs/.directory/package-version.txt'
```


I am attaching a simple patch that ignores files and only checks folders.

Issue created by migration from https://trac.sagemath.org/ticket/18993





---

archive/issue_comments_256113.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-08-05T12:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256113",
    "user": "jkeitel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_256114.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-08-05T16:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256114",
    "user": "@vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_256115.json:
```json
{
    "body": "Replying to [ticket:18993 jkeitel]:\n> At the moment, `sage-list-packages` does not ignore files in `build/pkgs`, which can lead to errors if, say, your browser has automatically created a file after viewing this folder\n\nI think a better solution would be to ignore *hidden* files/directories. An ordinary file in `build/pkgs` usually does indicate a problem for which an error is appropriate.",
    "created_at": "2015-08-05T21:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256115",
    "user": "@jdemeyer"
}
```

Replying to [ticket:18993 jkeitel]:
> At the moment, `sage-list-packages` does not ignore files in `build/pkgs`, which can lead to errors if, say, your browser has automatically created a file after viewing this folder

I think a better solution would be to ignore *hidden* files/directories. An ordinary file in `build/pkgs` usually does indicate a problem for which an error is appropriate.



---

archive/issue_comments_256116.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-08-05T22:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256116",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_256117.json:
```json
{
    "body": "A file there isn't really indicative of an error, the packages are the subdirectories. We probably shouldn't put any files in build/pkgs but enforcing that because otherwise scripts break in an obscure way isn't good either.",
    "created_at": "2015-08-05T22:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256117",
    "user": "@vbraun"
}
```

A file there isn't really indicative of an error, the packages are the subdirectories. We probably shouldn't put any files in build/pkgs but enforcing that because otherwise scripts break in an obscure way isn't good either.



---

archive/issue_comments_256118.json:
```json
{
    "body": "Between the following 2 options:\n\n(a) ignore all non-directories.\n\n(b) ignore all hidden files and directories.\n\nI'm sure that (b) is the better option, but at this point I don't care enough to create a follow-up ticket.",
    "created_at": "2015-08-06T20:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256118",
    "user": "@jdemeyer"
}
```

Between the following 2 options:

(a) ignore all non-directories.

(b) ignore all hidden files and directories.

I'm sure that (b) is the better option, but at this point I don't care enough to create a follow-up ticket.



---

archive/issue_comments_256119.json:
```json
{
    "body": "I'm also fine with b) but don't care so much about it that I would patch it ;-)\n\nPS: The perfect is the enemy of the good",
    "created_at": "2015-08-06T21:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18756#issuecomment-256119",
    "user": "@vbraun"
}
```

I'm also fine with b) but don't care so much about it that I would patch it ;-)

PS: The perfect is the enemy of the good
