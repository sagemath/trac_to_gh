# Issue 12995: Clarify some comments concerning the matplotlib Delaunay code in list_plot3d.py

Issue created by migration from https://trac.sagemath.org/ticket/13167

Original creator: jdemeyer

Original creation time: 2012-06-26 13:34:41

Assignee: mvngu




---

Attachment


---

Comment by jdemeyer created at 2012-06-26 13:41:34

Changing status from new to needs_review.


---

Comment by kcrisman created at 2012-06-26 13:47:34

Looks fine on the face of it.    Applies fine, tests fine, code is the same after all.

Is it really the mpl code, then, not scipy?  Hang on, I just haven't looked at the whole file yet...


---

Comment by kcrisman created at 2012-06-26 13:47:34

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2012-06-26 13:49:56

Ok, that's right.  Good catch.


---

Comment by ppurka created at 2012-06-26 14:30:45

Replying to [comment:2 kcrisman]:
> Looks fine on the face of it.    Applies fine, tests fine, code is the same after all.
> 
> Is it really the mpl code, then, not scipy?  Hang on, I just haven't looked at the whole file yet...
Yes. It is mpl code that is the problem here. Quoting from [mpl docs](http://matplotlib.sourceforge.net/api/mlab_api.html#matplotlib.mlab.griddata),

''
If interp keyword is set to ‘nn‘ (default), uses natural neighbor interpolation based on Delaunay triangulation. By default, this algorithm is provided by the matplotlib.delaunay package, written by Robert Kern. The triangulation algorithm in this package is known to fail on some nearly pathological cases. For this reason, a separate toolkit (mpl_tookits.natgrid) has been created that provides a more robust algorithm fof triangulation and interpolation. This toolkit is based on the NCAR natgrid library, which contains code that is not redistributable under a BSD-compatible license. When installed, this function will use the mpl_toolkits.natgrid algorithm, otherwise it will use the built-in matplotlib.delaunay package.
''

So, essentially the delaunay code is not considered very robust.

Now, I had a look at the `natgrid` code and there is one file's license which is the main problem I think, and due to which I believe it won't be possible to distribute/include it in Sage.


---

Comment by kcrisman created at 2012-06-26 14:35:15

That would be a different ticket anyway.


---

Comment by jdemeyer created at 2012-07-02 15:25:00

Resolution: fixed


---

Comment by kcrisman created at 2013-01-05 01:41:51

Apparently [this has been fixed upstream](https://github.com/matplotlib/matplotlib/pull/936).  ppurka, what do you think - would that take care of it, or are there other potential issues?


---

Comment by ppurka created at 2013-01-05 03:26:53

Replying to [comment:7 kcrisman]:
> Apparently [this has been fixed upstream](https://github.com/matplotlib/matplotlib/pull/936).  ppurka, what do you think - would that take care of it, or are there other potential issues?

I can't remember the context for this trac ticket. Are you suggesting that we remove the code in Sage which checks for duplicate points?


---

Comment by kcrisman created at 2013-01-05 03:41:47

> > Apparently [this has been fixed upstream](https://github.com/matplotlib/matplotlib/pull/936).  ppurka, what do you think - would that take care of it, or are there other potential issues?
> 
> I can't remember the context for this trac ticket. Are you suggesting that we remove the code in Sage which checks for duplicate points?
I was saying that maybe we don't need to add noise any more.  But upon further review, the commit in question was about duplicate points, not points in the same subspace, so we probably still need the randomization for now.  I don't know if we have code checking for duplicates.


---

Comment by ppurka created at 2013-01-05 04:07:42

Right. I think adding random noise is still needed. As I see it now, there are no changes necessary to the existing code.
