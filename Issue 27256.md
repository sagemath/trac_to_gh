# Issue 27256: Cygwin: OpenBLAS doesn't read environment variables properly

Issue created by migration from https://trac.sagemath.org/ticket/27493

Original creator: embray

Original creation time: 2019-03-15 14:37:03

In Sage we currently, by default, disable multithreading in OpenBLAS by setting `OPENBLAS_NUM_THREADS=1` in `sage-env`.

While this is not ideal, it does reduce the likelihood of multithreading issues coming up in contexts where it wasn't explicitly requested.

While investigating #27434, I found that there is a subtle and apparently rare bug in OpenBLAS's multithreading on Windows, which was causing the docbuild to hang, particularly while building the plot3d docs (which happen to exercise this area of the code more than anything else in Sage).

It occurred to me, however, that the docbuild should not be exhibiting the bug since we set `OPENBLAS_NUM_THREADS=1`.  It turns out this is due to a bug in OpenBLAS on Cygwin, fixed by the attached patch.

I'm setting this to "critical" since it would be very good to have this fixed for the buildbot.  I think this bug has been affecting Cygwin for a long time, but I could never nail down why.  Nevertheless since we have lived with this bug thus far I won't consider it a blocker.

**Upstream PR:** https://github.com/xianyi/OpenBLAS/pull/2060



---

Comment by embray created at 2019-03-15 14:39:08

New commits:


---

Comment by embray created at 2019-03-15 14:39:08

Changing status from new to needs_review.


---

Comment by embray created at 2019-03-25 10:41:19

Moving all blocker/critical issues from 8.7 to 8.8.


---

Comment by vbraun created at 2019-04-04 17:14:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-04-05 20:51:31

Resolution: fixed
