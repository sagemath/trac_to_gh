# Issue 17879: ipython notebook: show LaTeX tikz-graphics inplace

Issue created by migration from Trac.

Original creator: dkrenn

Original creation time: 2015-04-03 07:48:25

CC:  paulmasson jepperlein

Keywords: ipython, latex, tikz


```
view(latex(transducers.GrayCode()))
```

shows the transducer inplace in sagenb but it is a pitty that this does not work in the ipython notebook.

`latex(transducers.GrayCode())` writes tikz-code.


---

Comment by dkrenn created at 2015-04-03 07:48:36

Changing keywords from "ipython, latex, tikz" to "ipython, latex, tikz, sd66".


---

Comment by vbraun created at 2015-04-07 22:48:23

Basic implementation works...
----
New commits:


---

Comment by git created at 2015-04-07 22:49:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-08 11:57:26

`show(T)` stopped working (here I mean that it worked in sagenb showing the transducer inline and before this patch in ipython-notebook by showing it externally as pdf). It would be great if this gives the same as `latex(T).compile()`, since its docstring says "Show a graphics object x.".

Best wishes

Daniel


---

Comment by vbraun created at 2015-04-08 15:15:12

Launching an external viewer from the notebook server process equals NOT working in my book. So `show(T)` never worked in the ipython notebook, and this ticket doesn't change that.

The correct way to get graphical output is `T.plot()`. The fact that this cannot produce the graphics that you want is a bug in the finite state machine code.

The show docstring is correct, it'll show a Graphics object if you provide one. If you don't give it a graphics object then you won't get a picture.


---

Comment by dkrenn created at 2015-04-08 15:23:11

Replying to [comment:7 vbraun]:
> Launching an external viewer from the notebook server process equals NOT working in my book. So `show(T)` never worked in the ipython notebook, and this ticket doesn't change that.

On my installations the command

```
T = transducers.GrayCode()
show(T)
```

does the following:

- 6.6.rc1 ipython-notebook: open and show the LaTeX-formatted output in external viewer (as pdf).

- 6.6.rc1 sagenb: show LaTeX-formatted output inline.

- 6.6.rc2+#18116 ipython-notebook: does nothing.


---

Comment by vbraun created at 2015-04-08 16:06:39

Thats because #17821 will first have to fix show


---

Comment by slabbe created at 2015-04-12 14:19:40

Hi Daniel,

Replying to [ticket:18116 dkrenn]:
> I also want to discourage the `view()` command, right now it is just spaghetti code that does different things depending on the time of the day. 
> So I propose to use `latex(...).compile()` as an idiom to typeset LaTeX code.

First, to me the following facts are all completely independent:
 A. discourage the use of `view()`
 B. `view()` is spaghetti code
 C. propose `latex(...).compile()` 
So one can't use A or B to suggest C.

Second, I have never liked in Sage the fact that there plenty of ways of drawing things. For an outside person, it is tough to understand the difference `plot`, `show` and `view` ? To me there should be one fonction to do them all. For that reason, I do not like the idea of proposing a fourth one being `latex(...).compile()` or anything else.

That being said, I really like the idea of being able to show tikz pictures in the ipython notebook.


---

Comment by dkrenn created at 2015-04-13 15:10:11

Replying to [comment:4 vbraun]:
> I also want to discourage the `view()` command, right now it is just spaghetti code that does different things depending on the time of the day.

Ok, then the code should change.

> So I propose to use `latex(...).compile()` as an idiom to typeset LaTeX code.

To me it is not clear from the command that this will show a picture.


---

Comment by dkrenn created at 2015-04-13 15:10:54

Replying to [comment:10 slabbe]:
> Second, I have never liked in Sage the fact that there plenty of ways of drawing things. For an outside person, it is tough to understand the difference `plot`, `show` and `view` ? To me there should be one fonction to do them all. For that reason, I do not like the idea of proposing a fourth one being `latex(...).compile()` or anything else.

I agree.


---

Comment by vbraun created at 2015-04-13 15:13:36

`latex(...).compile()` does not show a picture, it generates a PDF document. The document wrapper object pretty-prints graphically. You can also assign it to a variable, save as a pdf file, etc. In the latter case no picture is shown. Just like graphics objects (the return values of `plot`, for example)

You can't solve the "its impossible to guess the difference between view/show/pretty_print" conundrum without getting rid of 2 of them (or making them aliases, at least).


---

Comment by vbraun created at 2015-04-13 15:16:44

Also, show acts immediately, like print. Plot does not act immediately, it returns a graphics object that you can use elsewhere and need not result in graphical output.

In other words: its the difference between

```
def f():
    print 'hello'
```

and

```
def f():
   return 'hello'
```



---

Comment by dkrenn created at 2015-04-13 15:26:10

Replying to [comment:14 vbraun]:
> Also, show acts immediately, like print. Plot does not act immediately, it returns a graphics object that you can use elsewhere and need not result in graphical output.

I see; thanks for this clearification.


---

Comment by dkrenn created at 2015-04-13 15:30:27

Replying to [comment:13 vbraun]:
> `latex(...).compile()` does not show a picture, it generates a PDF document. The document wrapper object pretty-prints graphically. You can also assign it to a variable, save as a pdf file, etc. In the latter case no picture is shown. Just like graphics objects (the return values of `plot`, for example)
> 
> You can't solve the "its impossible to guess the difference between view/show/pretty_print" conundrum without getting rid of 2 of them (or making them aliases, at least).

So `view(A)` does (or should do) the same as `show(latex(A).compile())`. Or am I wrong? If yes, can we just replace the code of `view` by this command?


---

Comment by dkrenn created at 2015-04-13 15:34:43

Would it be possible to have an arguemtn to `show` which says to look for latex-output? ...like `show(A, what='latex')` (with a better name)


---

Comment by dkrenn created at 2015-04-13 15:36:49

Anyhow, should the discussion about `view` be on another ticket (and/or on sage-devel)? My motivation for opening this ticket was to have inline-plots for tikz, which works with `.compile()`.


---

Comment by vbraun created at 2015-04-13 15:41:17

Making `view` an alias for `show(latex(..).compile())` doesn't make it one bit more self-explanatory.

The only real alternative is make latex objects display graphically by default, i.e.

```
sage: latex(1/2)
```

would use the displayhook to show mathjax or pdf. Thats possible, but I think many people use latex to generate latex code to paste into their articles and not to get cute pictures in the notebook.


---

Comment by dkrenn created at 2015-04-13 15:45:32

Replying to [comment:19 vbraun]:
> Making `view` an alias for `show(latex(..).compile())` doesn't make it one bit more self-explanatory.

True. (But having something (a function?) similar is/will be very handy.)


---

Comment by slabbe created at 2015-04-14 08:59:08

Replying to [comment:19 vbraun]:
> The only real alternative is make latex objects display graphically by default, i.e.
> {{{
> sage: latex(1/2)
> }}}
> would use the displayhook to show mathjax or pdf. 

+1, there should be a method of `LatexExpr` that shows it pretty like `LatexExpr.__pprint__` that is used by the displayhook thing.

> Thats possible, but I think many people use latex to generate latex code to paste into their articles and not to get cute pictures in the notebook.

Well, they could still do:


```
sage: latex(1/2) # shows graphically
sage: print latex(1/2) # prints the source
```



---

Comment by vbraun created at 2015-04-14 09:04:13

Replying to [comment:21 slabbe]:
> +1, there should be a method of `LatexExpr` that shows it pretty like `LatexExpr.__pprint__` that is used by the displayhook thing.

You say that because the objects that you are interested in have a broken `plot()` method, so you prefer graphical output generated by compiling latex. What if plot would actually work in the first place (i.e. have a proper tikz backend for Graphics objects)


---

Comment by slabbe created at 2015-04-14 10:15:08

Replying to [comment:22 vbraun]:
> You say that because the objects that you are interested in have a broken `plot()` method, so you prefer graphical output generated by compiling latex. What if plot would actually work in the first place (i.e. have a proper tikz backend for Graphics objects)

1. Through the years, I have been used in Sage for the `plot()` method to return a `Graphics()` object (and not anything else). If it can be made more general, why not?

2. I have used cases where I use both : `plot()` method for returning a Graphics or a Graphics3D sage object *and* `_latex_()` method for returning the tikz code. This is the case for instance for polyhedron in Sage where you can first use jmol to choose a nice projection and then create the tikz code using a chosen projection. Therefore, if `plot()` can now return output generated by latex, I still want it to draw my other Graphics sage object output maybe using some other arguments.

3. I think we don't have to hide the object `LatexExpr` to the user. I mean `view` or `plot` or `show` could just return the compiled default latex expression. But sometimes (graph for instance), there are many latex output (depending on which graphviz program I use). So, to me it is not the object that I draw, it is a latex expression. Therefore, there should be still a way to obtain the latex expression of an object and then draw it.


---

Comment by vbraun created at 2015-04-14 10:28:52

Plot should still return a graphics object. I'm saying that graphics objects should support tikz (next to matplotlib) to draw graph-type graphics objects. Just like 3-d graphcs objects can be rendered in different ways.


---

Comment by git created at 2015-04-18 03:32:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-22 15:23:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2015-04-22 15:27:11

This is now ready for review. I'll leave SVG support for later (#18280)


---

Comment by vbraun created at 2015-04-22 15:27:11

Changing status from new to needs_review.


---

Comment by slabbe created at 2015-11-04 08:53:35

Changing status from needs_review to needs_work.


---

Comment by slabbe created at 2015-11-04 08:53:35

The branch does not apply since sage-6.8.beta3.


---

Comment by dkrenn created at 2016-05-22 09:30:56

There is some kind of solution to the original problem of this ticket at #19515. The original problem was:

```
view(latex(transducers.GrayCode())) 
}}} 
shows the transducer inplace in sagenb but it is a pitty that this does not work in the ipython notebook.
{{{
latex(transducers.GrayCode())
}}}
writes tikz-code.


---

Comment by git created at 2016-05-22 13:50:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-05-22 13:57:54

Updated...


---

Comment by vbraun created at 2016-05-22 13:57:54

Changing status from needs_work to needs_review.


---

Comment by paulmasson created at 2016-09-18 20:35:33

Changing status from needs_review to needs_work.


---

Comment by paulmasson created at 2016-09-18 20:35:33

Merge conflict with 7.4.beta5
