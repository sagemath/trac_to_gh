# Issue 11852: 90% doctest coverage thrust metaticket

archive/issues_011852.json:
```json
{
    "body": "Assignee: mvngu\n\nCC:  @kcrisman\n\nAfter deleting the server directory we need to add doctests to about\n588 more functions to get coverage to 90%, which is a major goal for\nsage-5.0, which we've been working on getting to for over a year now.\nI did an audit and came up with about 350 functions in 18 files for\nwhich adding coverage will not be too hard.  Some are disturbing,\ne.g., where a *huge* patch was *recently* added to Sage with over 100\nuntested functions, due to sloppy refereeing and release management.\n\nJust edit the ticket description and add your name after the * that\nyou will get coverage to 100% on that file.  You an also create a\nticket with your tests (put #number) in.  Then it will be easy to\nreferee all these doctest patches.  Try to make different tickets\nif/when you find bugs, and restrict your ticket to just doctests so it\nis easy to referee.    You can also add another file to the list. \n\nProbably Easy:\n\n* algebras/free_algebra_quotient_element.py: 0% (0 of 12)\n\n* databases/stein_watkins.py: 0% (0 of 15) -- easy, since there are tons of examples at the top already\n\n* gsl/interpolation.pyx: 0% (0 of 9) -- easy, examples at top and easy math\n\n* interfaces/psage.py: 0% (0 of 13) -- easy, since lots of examples at top\n\n* matrix/benchmark.py: 0% (0 of 29) -- easy; just run each function and paste into an EXAMPLES:: section.   This would also provide some useful additional testing.  Maybe use non-default arguments so not too slow.\n\n* misc/log.py: 0% (0 of 42) -- just make object and call methods; easy\n\n* monoids/monoid.py: 0% (0 of 3) -- easy\n\n* algebras/free_algebra_quotient.py: 6% (1 of 16) -- there is a big example in there -- just use it to construct similar examples everywhere else int he file. \n\n\nProbably Medium:\n\n* libs/mpmath/ext_main.pyx: 7% (8 of 111) -- How the *hell* did this get into Sage with a coverage score of 7%?!!??  This was added several years after we started a 100% doctest policy.  This appeared in http://trac.sagemath.org/sage_trac/ticket/8159 where the positive review is from Harald Schilly: \"That was easy, all tests pass ... green light from me! I'm setting this to needs_review, and start with a positiv review from me.\"    Yes, it's easy for all tests to pass when there are only 7% tests.  Oops.   It will be a lot of work to properly doctest this file, but much of it is straightforward (e.g., examples for the mpnumber) class. \n\n* rings/polynomial/polynomial_compiled.pyx: 0% (0 of 20) -- just a bunch of little classes for working with \"optimized\" polynomials, which is actually used somewhere, evidently.  Not a single example.  Either doctest it completely, by following how it is used by polynomial_element.pyx, or delete it because maybe fast_callable is better?  But watch out for large degree, since fast_callable segfaults if the degree is large, so this polynomial_compiled.pyx might have some real value.\n\n* media/wav.py: 0% (0 of 25) -- mostly just a bunch of functions to get basic info about a wave file; what makes this harder is you have to get a .wav file and put it somewhere in Sage to be used for testing.  You can probably generate an empty wave file by using the kwds constructor of the class, save it to a temp file, and use it, but that is boring. \n\n* matrix/matrix_window.pyx: 0% (0 of 26) -- look at some code elsewhere that uses this, and just go through examples; probably not so hard\n* matrix/matrix_window_modn_dense.pyx: 0% (0 of 11) \n\n\nProbably Harder:\n\n* categories/action.pyx: 0% (0 of 31)\n\n\nDelete from SAGE?!:\n\n* databases/bz2Pickle.py  -- looks stupid and not used anywhere!\n\n* databases/db.py: 0% (0 of 21) -- also maybe not used anywhere; I think we shoudl remove ZODB anyways.\n\n* databases/gamma0wt2.py: 0% (0 of 7) -- delete\n\nIssue created by migration from https://trac.sagemath.org/ticket/12024\n\n",
    "created_at": "2011-11-13T20:40:05Z",
    "labels": [
        "component: doctest coverage"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "90% doctest coverage thrust metaticket",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11852",
    "user": "https://github.com/williamstein"
}
```
Assignee: mvngu

CC:  @kcrisman

After deleting the server directory we need to add doctests to about
588 more functions to get coverage to 90%, which is a major goal for
sage-5.0, which we've been working on getting to for over a year now.
I did an audit and came up with about 350 functions in 18 files for
which adding coverage will not be too hard.  Some are disturbing,
e.g., where a *huge* patch was *recently* added to Sage with over 100
untested functions, due to sloppy refereeing and release management.

Just edit the ticket description and add your name after the * that
you will get coverage to 100% on that file.  You an also create a
ticket with your tests (put #number) in.  Then it will be easy to
referee all these doctest patches.  Try to make different tickets
if/when you find bugs, and restrict your ticket to just doctests so it
is easy to referee.    You can also add another file to the list. 

Probably Easy:

* algebras/free_algebra_quotient_element.py: 0% (0 of 12)

* databases/stein_watkins.py: 0% (0 of 15) -- easy, since there are tons of examples at the top already

* gsl/interpolation.pyx: 0% (0 of 9) -- easy, examples at top and easy math

* interfaces/psage.py: 0% (0 of 13) -- easy, since lots of examples at top

* matrix/benchmark.py: 0% (0 of 29) -- easy; just run each function and paste into an EXAMPLES:: section.   This would also provide some useful additional testing.  Maybe use non-default arguments so not too slow.

* misc/log.py: 0% (0 of 42) -- just make object and call methods; easy

* monoids/monoid.py: 0% (0 of 3) -- easy

* algebras/free_algebra_quotient.py: 6% (1 of 16) -- there is a big example in there -- just use it to construct similar examples everywhere else int he file. 


Probably Medium:

* libs/mpmath/ext_main.pyx: 7% (8 of 111) -- How the *hell* did this get into Sage with a coverage score of 7%?!!??  This was added several years after we started a 100% doctest policy.  This appeared in http://trac.sagemath.org/sage_trac/ticket/8159 where the positive review is from Harald Schilly: "That was easy, all tests pass ... green light from me! I'm setting this to needs_review, and start with a positiv review from me."    Yes, it's easy for all tests to pass when there are only 7% tests.  Oops.   It will be a lot of work to properly doctest this file, but much of it is straightforward (e.g., examples for the mpnumber) class. 

* rings/polynomial/polynomial_compiled.pyx: 0% (0 of 20) -- just a bunch of little classes for working with "optimized" polynomials, which is actually used somewhere, evidently.  Not a single example.  Either doctest it completely, by following how it is used by polynomial_element.pyx, or delete it because maybe fast_callable is better?  But watch out for large degree, since fast_callable segfaults if the degree is large, so this polynomial_compiled.pyx might have some real value.

* media/wav.py: 0% (0 of 25) -- mostly just a bunch of functions to get basic info about a wave file; what makes this harder is you have to get a .wav file and put it somewhere in Sage to be used for testing.  You can probably generate an empty wave file by using the kwds constructor of the class, save it to a temp file, and use it, but that is boring. 

* matrix/matrix_window.pyx: 0% (0 of 26) -- look at some code elsewhere that uses this, and just go through examples; probably not so hard
* matrix/matrix_window_modn_dense.pyx: 0% (0 of 11) 


Probably Harder:

* categories/action.pyx: 0% (0 of 31)


Delete from SAGE?!:

* databases/bz2Pickle.py  -- looks stupid and not used anywhere!

* databases/db.py: 0% (0 of 21) -- also maybe not used anywhere; I think we shoudl remove ZODB anyways.

* databases/gamma0wt2.py: 0% (0 of 7) -- delete

Issue created by migration from https://trac.sagemath.org/ticket/12024





---

archive/issue_comments_135469.json:
```json
{
    "body": "The file from hell is #8791",
    "created_at": "2011-11-14T20:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135469",
    "user": "https://github.com/fredrik-johansson"
}
```

The file from hell is #8791



---

archive/issue_comments_135470.json:
```json
{
    "body": "Replying to [comment:3 fredrik.johansson]:\n> The file from hell is #8791\n\nI've put a link above, added your patch to 8791 directly to avoid confusion, and set it to \"needs review\".  Thanks!    And we will consider reviewing this a very high priority.",
    "created_at": "2011-11-14T20:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135470",
    "user": "https://github.com/williamstein"
}
```

Replying to [comment:3 fredrik.johansson]:
> The file from hell is #8791

I've put a link above, added your patch to 8791 directly to avoid confusion, and set it to "needs review".  Thanks!    And we will consider reviewing this a very high priority.



---

archive/issue_comments_135471.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2012-01-19T01:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135471",
    "user": "https://github.com/kcrisman"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_135472.json:
```json
{
    "body": "Just as an interim update, from a sage-devel thread.\n\n```\n\n> This is also a good occasion to paste \"sage -coverageall\" output from \n> 5.0.prealpha0: \n> Overall weighted coverage score:  86.3% \n> Total number of functions:  28917 \n> We need 1056 more function to get to 90% coverage. \n> We need 2502 more function to get to 95% coverage. \n> We need 3658 more function to get to 99% coverage. \n\n\nDeleting sage/server (the old old notebook that can go away in 5.0, \nIIRC) gives us this: \nOverall weighted coverage score:  88.1% \nTotal number of functions:  27936 \nWe need  516 more function to get to 90% coverage. \nWe need 1913 more function to get to 95% coverage. \nWe need 3031 more function to get to 99% coverage. \n```\n\nI've also moved the milestone and made this a blocker for 5.0, since it has been one of the goals for several years.  TBDFL or release manager can change this if that's not appropriate.",
    "created_at": "2012-01-19T01:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135472",
    "user": "https://github.com/kcrisman"
}
```

Just as an interim update, from a sage-devel thread.

```

> This is also a good occasion to paste "sage -coverageall" output from 
> 5.0.prealpha0: 
> Overall weighted coverage score:  86.3% 
> Total number of functions:  28917 
> We need 1056 more function to get to 90% coverage. 
> We need 2502 more function to get to 95% coverage. 
> We need 3658 more function to get to 99% coverage. 


Deleting sage/server (the old old notebook that can go away in 5.0, 
IIRC) gives us this: 
Overall weighted coverage score:  88.1% 
Total number of functions:  27936 
We need  516 more function to get to 90% coverage. 
We need 1913 more function to get to 95% coverage. 
We need 3031 more function to get to 99% coverage. 
```

I've also moved the milestone and made this a blocker for 5.0, since it has been one of the goals for several years.  TBDFL or release manager can change this if that's not appropriate.



---

archive/issue_comments_135473.json:
```json
{
    "body": "> TBDFL or release manager can change this if that's not appropriate.\n\n+1 to making this a blocker.  We only have 1.9% to go!",
    "created_at": "2012-01-19T02:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135473",
    "user": "https://github.com/williamstein"
}
```

> TBDFL or release manager can change this if that's not appropriate.

+1 to making this a blocker.  We only have 1.9% to go!



---

archive/issue_comments_135474.json:
```json
{
    "body": "Changing the number left to doctest in each category in the description is annoying.  If someone else wants to do that, please do!",
    "created_at": "2012-02-16T04:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135474",
    "user": "https://github.com/kcrisman"
}
```

Changing the number left to doctest in each category in the description is annoying.  If someone else wants to do that, please do!



---

archive/issue_comments_135475.json:
```json
{
    "body": "I tried to claim algebras/free_algebra_quotient.py just to find out that it already has 100% doctest coverage in sage 5.0 beta 2.\nTicket #12593 can be closed as invalid.",
    "created_at": "2012-02-26T14:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135475",
    "user": "https://trac.sagemath.org/admin/accounts/users/jlopez"
}
```

I tried to claim algebras/free_algebra_quotient.py just to find out that it already has 100% doctest coverage in sage 5.0 beta 2.
Ticket #12593 can be closed as invalid.



---

archive/issue_comments_135476.json:
```json
{
    "body": "The two remaining functions which are not directly or indirectly doctested probably don't need doctesting.",
    "created_at": "2012-03-01T11:40:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135476",
    "user": "https://github.com/ppurka"
}
```

The two remaining functions which are not directly or indirectly doctested probably don't need doctesting.



---

archive/issue_comments_135477.json:
```json
{
    "body": "Current status in the hopefully soon-to-be-released sage-5.0.beta12:\n\n```\nOverall weighted coverage score:  88.1%\nTotal number of functions:  29436\nWe need  551 more function to get to 90% coverage.\n```\n",
    "created_at": "2012-04-02T09:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135477",
    "user": "https://github.com/jdemeyer"
}
```

Current status in the hopefully soon-to-be-released sage-5.0.beta12:

```
Overall weighted coverage score:  88.1%
Total number of functions:  29436
We need  551 more function to get to 90% coverage.
```




---

archive/issue_comments_135478.json:
```json
{
    "body": "What will that be once #11409 is deleted?",
    "created_at": "2012-04-02T15:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135478",
    "user": "https://github.com/kcrisman"
}
```

What will that be once #11409 is deleted?



---

archive/issue_comments_135479.json:
```json
{
    "body": "Taking a vanilla beta11 and installing #11409 plus a few patches which will be in beta12 (#7926, #12747 and #12749) we get:\n\n```\nOverall weighted coverage score:  89.9%\nTotal number of functions:  28475\nWe need   25 more function to get to 90% coverage.\n```\n\n\nSo close! Sadly #11409 seems to be in \"needs work\" limbo at the moment (the Sage library patch there doesn't even install cleanly any more -- there is a reject in all.py).",
    "created_at": "2012-04-04T09:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135479",
    "user": "https://github.com/loefflerd"
}
```

Taking a vanilla beta11 and installing #11409 plus a few patches which will be in beta12 (#7926, #12747 and #12749) we get:

```
Overall weighted coverage score:  89.9%
Total number of functions:  28475
We need   25 more function to get to 90% coverage.
```


So close! Sadly #11409 seems to be in "needs work" limbo at the moment (the Sage library patch there doesn't even install cleanly any more -- there is a reject in all.py).



---

archive/issue_comments_135480.json:
```json
{
    "body": "Going for 90% is a nice goal, but I don't think it should block the sage-5.0 release.\n\nIn sage-5.0.beta13:\n\n```\nOverall weighted coverage score:  88.3%\nTotal number of functions:  29374\nWe need  494 more function to get to 90% coverage.\nWe need 1963 more function to get to 95% coverage.\nWe need 3138 more function to get to 99% coverage.\n```\n",
    "created_at": "2012-04-09T20:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135480",
    "user": "https://github.com/jdemeyer"
}
```

Going for 90% is a nice goal, but I don't think it should block the sage-5.0 release.

In sage-5.0.beta13:

```
Overall weighted coverage score:  88.3%
Total number of functions:  29374
We need  494 more function to get to 90% coverage.
We need 1963 more function to get to 95% coverage.
We need 3138 more function to get to 99% coverage.
```




---

archive/issue_comments_135481.json:
```json
{
    "body": "Replying to [comment:63 jdemeyer]:\n> Going for 90% is a nice goal, but I don't think it should block the sage-5.0 release.\n\nAgreed. We are close, and we will get there, but not for sage-5.0.\n\n> \n> In sage-5.0.beta13:\n> {{{{\n> Overall weighted coverage score:  88.3%\n> Total number of functions:  29374\n> We need  494 more function to get to 90% coverage.\n> We need 1963 more function to get to 95% coverage.\n> We need 3138 more function to get to 99% coverage.\n> }}}",
    "created_at": "2012-04-09T20:14:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135481",
    "user": "https://github.com/williamstein"
}
```

Replying to [comment:63 jdemeyer]:
> Going for 90% is a nice goal, but I don't think it should block the sage-5.0 release.

Agreed. We are close, and we will get there, but not for sage-5.0.

> 
> In sage-5.0.beta13:
> {{{{
> Overall weighted coverage score:  88.3%
> Total number of functions:  29374
> We need  494 more function to get to 90% coverage.
> We need 1963 more function to get to 95% coverage.
> We need 3138 more function to get to 99% coverage.
> }}}



---

archive/issue_comments_135482.json:
```json
{
    "body": "We'd be there already if #11409 went in, wouldn't we?",
    "created_at": "2012-04-10T14:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135482",
    "user": "https://github.com/loefflerd"
}
```

We'd be there already if #11409 went in, wouldn't we?



---

archive/issue_comments_135483.json:
```json
{
    "body": "Claiming a file.",
    "created_at": "2012-05-04T22:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135483",
    "user": "https://github.com/itaibn"
}
```

Claiming a file.



---

archive/issue_comments_135484.json:
```json
{
    "body": "Claiming files and moving closed tickets.",
    "created_at": "2012-10-19T00:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135484",
    "user": "https://github.com/tscrim"
}
```

Claiming files and moving closed tickets.



---

archive/issue_comments_135485.json:
```json
{
    "body": "This is perhaps cheating, but I wonder if we should revise the coverage script to ignore all files in any directory containing a file \"nodoctest.py\". This would eliminate all files in the server directory from the coverage count.",
    "created_at": "2012-10-19T05:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135485",
    "user": "https://github.com/jhpalmieri"
}
```

This is perhaps cheating, but I wonder if we should revise the coverage script to ignore all files in any directory containing a file "nodoctest.py". This would eliminate all files in the server directory from the coverage count.



---

archive/issue_comments_135486.json:
```json
{
    "body": "Moving #13618 to need review block. Re-tallied function count.",
    "created_at": "2012-10-22T02:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135486",
    "user": "https://github.com/tscrim"
}
```

Moving #13618 to need review block. Re-tallied function count.



---

archive/issue_comments_135487.json:
```json
{
    "body": "I also did `rings/real*` in #13618.",
    "created_at": "2012-11-03T22:08:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135487",
    "user": "https://github.com/tscrim"
}
```

I also did `rings/real*` in #13618.



---

archive/issue_comments_135488.json:
```json
{
    "body": "Ticket #12092 is ready for review and should be easy enough.",
    "created_at": "2012-11-15T19:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135488",
    "user": "https://github.com/fchapoton"
}
```

Ticket #12092 is ready for review and should be easy enough.



---

archive/issue_comments_135489.json:
```json
{
    "body": "You might also be interested in #14061, which fixes the `sage-coverage` script and brings the results for sage-5.7.beta3 to\n\n```\nOverall weighted coverage score:  89.8%\nTotal number of functions:  31279\nWe need   48 more functions to get to 90% coverage.\nWe need 1612 more functions to get to 95% coverage.\nWe need 2863 more functions to get to 99% coverage.\n```\n",
    "created_at": "2013-02-05T17:10:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135489",
    "user": "https://github.com/jdemeyer"
}
```

You might also be interested in #14061, which fixes the `sage-coverage` script and brings the results for sage-5.7.beta3 to

```
Overall weighted coverage score:  89.8%
Total number of functions:  31279
We need   48 more functions to get to 90% coverage.
We need 1612 more functions to get to 95% coverage.
We need 2863 more functions to get to 99% coverage.
```




---

archive/issue_events_011909.json:
```json
{
    "actor": "@jdemeyer",
    "created_at": "2013-02-22T19:11:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11852#event-11909"
}
```



---

archive/issue_comments_135490.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-02-22T19:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11852#issuecomment-135490",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
