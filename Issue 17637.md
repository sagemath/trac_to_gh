# Issue 17637: babel Error: You haven't specified a language option

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2015-02-28 12:56:28




---

Comment by vbraun created at 2015-02-28 13:06:09

Changing component from PLEASE CHANGE to packages: optional.


---

Comment by vbraun created at 2015-02-28 13:06:09

Hmm forgot to install babel-hungarian, but only got `babel Error: You haven't specified a language option`. Would be nice to have a way to automatically install all required tex(live) packages...


---

Comment by vbraun created at 2015-02-28 13:06:09

Changing type from PLEASE CHANGE to enhancement.


---

Comment by vbraun created at 2015-02-28 15:01:38

Changing component from packages: optional to misc.


---

Comment by vbraun created at 2015-02-28 15:03:30

New commits:


---

Comment by vbraun created at 2015-02-28 15:03:30

Changing status from new to needs_review.


---

Comment by aapitzsch created at 2015-03-01 22:05:47

In `SPKG.txt`, typo `Hoem page` and unnecessary line `Put a bulleted list of dependencies here:`.


---

Comment by git created at 2015-03-02 20:01:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by strogdon created at 2015-03-03 23:55:14

To get things to work here I had to

```
--- a/src/ext/texlive/texlive-install
+++ b/src/ext/texlive/texlive-install
`@``@` -83,7 +83,7 `@``@` def install_texlive():
     original_dir = os.getcwd()
     os.chdir(tmp_dir)
     check_call(['tar', '-x', '-z', '-f', tarball])
-    install_dir = glob.glob('install-tl-*')[0]
+    install_dir = glob.glob('install-tl-*')[1]
     os.chdir(install_dir)
 
     check_call([
```

or else install_dir is set to 'install-tl-unx.tar.gz'


---

Comment by git created at 2015-03-09 08:35:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by strogdon created at 2015-03-12 18:50:56

The latest branch works here. One question(s). How is a user, in need of using the install script, to be made aware of the script? Or is that knowledge not important?


---

Comment by git created at 2015-03-15 19:06:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-15 19:22:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2015-03-15 19:22:51

I've added a note to the installation manual


---

Comment by strogdon created at 2015-03-20 04:20:17

`ipynb`, I would have never guessed that. It will be a couple of days before I can adequate check that - provided I'm able to really check it. I did upgrade to the latest branch and I saw nothing related to latex `extension` - nothing in `/local/share/texlive/texmf-var/web2c/tlmgr.log` either. It didn't complain, but is that one needed for the ipynb -> latex -> pdf conversion?


---

Comment by strogdon created at 2015-03-27 21:08:00

Changing status from needs_review to needs_info.


---

Comment by strogdon created at 2015-03-27 21:08:00

Unless I've missed something (and I could very well have), it seems that before the latex requirements of IPython nbconvert can be nailed down one needs to install mistune. From the ipython notebook (or from a Sage shell) -- File -> Download as -> {Python,HTML,reST,PDF} from the notebook menu gives similar results:


```
%%bash
ls plots.ipynb
ipython nbconvert  --to=latex 'plots.ipynb'
```


returns

```
plots.ipynb
Traceback (most recent call last):
  File "/64bitdev/storage/sage-git_develop/sage/local/bin/ipython", line 5, in <module>
    start_ipython()
  File "/64bitdev/storage/sage-git_develop/sage/local/lib/python2.7/site-packages/IPython/__init__.py", line 120, in start_ipython
    return launch_new_instance(argv=argv, **kwargs)

<SNIP>

  File "/64bitdev/storage/sage-git_develop/sage/local/lib/python2.7/site-packages/IPython/nbconvert/filters/markdown.py", line 17, in <module>
    import mistune
ImportError: No module named mistune
```

This was hinted at [here](http://trac.sagemath.org/ticket/17897#comment:9). On my gentoo box

```
ipython nbconvert  --to=latex 'plots.ipynb'
```

generates `plots.tex` and

```
ipython nbconvert  --to=pdf 'plots.ipynb'
```

generates `plots.pdf`, but I have mistune installed.


---

Comment by vbraun created at 2015-03-29 08:25:58

Agree, I created #18080 to add mistune


---

Comment by vbraun created at 2015-03-29 08:25:58

Changing status from needs_info to needs_review.


---

Comment by strogdon created at 2015-03-30 06:11:48

Changing status from needs_review to needs_work.


---

Comment by strogdon created at 2015-03-30 06:11:48

After installing mistune and looking at what's dumped in a terminal during the install of latex packages I see

```
Logfile: /64bitdev/storage/sage-git_develop/sage/local/share/texlive/install-tl.log
package extension not present in package repository.
tlmgr: package repository http://ftp.math.purdue.edu/mirrors/ctan.org/systems/texlive/tlnet
```

So extension is not a latex package. From a Sage shell

```
sage-ipython nbconvert  --to=latex 'plots.ipynb'
```

does generate `plots.tex`. But

```
sage-ipython nbconvert  --to=pdf 'plots.ipynb'
```

fails initially with

```
! LaTeX Error: File `xkeyval.sty' not found.
```

The usepackage(s) needed to pdflatex `plots.tex` are

```
    \usepackage{graphicx} % Used to insert images
    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{color} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
```

see (local/lib/python2.7/site-packages/IPython/nbconvert/templates/latex/base.tplx).

I'm not sure if `xkeyval` is sufficient. I'll investigate. It may take me a bit, unless you have a quicker resolution.


---

Comment by strogdon created at 2015-03-31 00:49:35

Through trial and error the following

```
--- a/src/ext/texlive/package-list.txt
+++ b/src/ext/texlive/package-list.txt
`@``@` -25,7 +25,8 `@``@` etoolbox
 
 # Used by IPython nbconvert (ipynb -> latex -> pdf conversion)
 adjustbox
-extension
+xkeyval
+booktabs
 collectbox
 ucs
```

allowed conversion of my `plots.ipynb`, i.e. from within a Sage shell

```
sage-ipython nbconvert  --to=xxx 'plots.ipynb'
```

works, where `xxx` is any of `{python, pdf, rst, html, latex}`. Conversion using the notebook menu also works. I may have missed a corner case. I don't know about the grffile package. I don't have it installed on my gentoo box.


---

Comment by git created at 2015-03-31 09:48:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2015-03-31 09:49:49

Thanks for figuring this out!


---

Comment by vbraun created at 2015-03-31 09:49:49

Changing status from needs_work to needs_review.


---

Comment by strogdon created at 2015-03-31 14:34:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-04-14 19:43:54

Resolution: fixed
