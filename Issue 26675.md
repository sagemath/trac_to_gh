# Issue 26675: cysignals related test failure in test.py

archive/issues_026675.json:
```json
{
    "body": "CC:  jdmeyer\n\nKeywords: cysignals\n\nAs discussed [on sage-packaging](https://groups.google.com/forum/#!topic/sage-packaging/CtiTkXDxWF0), one of the test cases in src/sage/doctest/test.py sometimes fails when the system is under load. This was reproduced bei Jeoren with sage 8.5.rc0. Here's the log:\n\n\n```\nFile \"/nix/store/s1x3samyxif0mdg4l9v6abjzccc88b08-sage-src-8.4/src/sage/doctest/test.py\", line 220, in sage.doctest.test\nFailed example:\n    subprocess.call([\"sage\", \"-tp\", \"1000000\", \"--timeout=120\",  # long time\n         \"--warn-long\", \"0\", \"99seconds.rst\", \"interrupt_diehard.rst\"], **kwds2)\nExpected:\n    Running doctests...\n    Doctesting 2 files using 1000000 threads.\n    Killing test 99seconds.rst\n    Killing test interrupt_diehard.rst\n    ----------------------------------------------------------------------\n    Doctests interrupted: 0/2 files tested\n    ----------------------------------------------------------------------\n    ...\n    128\nGot:\n    Running doctests with ID 2018-12-17-16-27-41-26396051.\n    Using --optional=dochtml,gmp,memlimit,nose,sage\n    Doctesting 2 files using 1000000 threads.\n    ------------------------------------------------------------------------\n    Killing test 99seconds.rst\n    Killing test interrupt_diehard.rst\n    /nix/store/chdzkj17b8x0q42jnygpsjj9ccw2rasz-python-2.7.15-env/lib/python2.7/site-packages/cysignals/signals.so(+0x7bfb)[0x7ffff1a2bbfb]\n    /nix/store/chdzkj17b8x0q42jnygpsjj9ccw2rasz-python-2.7.15-env/lib/python2.7/site-packages/cysignals/signals.so(+0x7cbf)[0x7ffff1a2bcbf]\n    /nix/store/chdzkj17b8x0q42jnygpsjj9ccw2rasz-python-2.7.15-env/lib/python2.7/site-packages/cysignals/signals.so(+0xa7bb)[0x7ffff1a2e7bb]\n    /nix/store/1mnsmslnx5anjfksac6417xfzzglrwhr-glibc-2.27/lib/libpthread.so.0(+0x11f10)[0x7ffff7592f10]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyFrame_New+0xb5)[0x7ffff78294e5]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x947a)[0x7ffff78b658a]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x8a109)[0x7ffff782a109]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x6865c)[0x7ffff780865c]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0xcb3ba)[0x7ffff786b3ba]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x2d32)[0x7ffff78afe42]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x94cb)[0x7ffff78b65db]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x8a109)[0x7ffff782a109]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x6865c)[0x7ffff780865c]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0xcb6f2)[0x7ffff786b6f2]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0xc7bba)[0x7ffff7867bba]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x2d32)[0x7ffff78afe42]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x94cb)[0x7ffff78b65db]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7ffff78b6fe9]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x8a)[0x7ffff78d9c8a]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xe3)[0x7ffff78dbbc3]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(Py_Main+0xb4a)[0x7ffff78f4ada]\n    /nix/store/1mnsmslnx5anjfksac6417xfzzglrwhr-glibc-2.27/lib/libc.so.6(__libc_start_main+0xee)[0x7ffff6a52b8e]\n    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/bin/python(_start+0x2a)[0x4007fa]\n    ------------------------------------------------------------------------\n    ----------------------------------------------------------------------\n    Doctests interrupted: 0/2 files tested\n    ----------------------------------------------------------------------\n    Total time for all tests: 0.1 seconds\n        cpu time: 0.0 seconds\n        cumulative wall time: 0.0 seconds\n    Attaching gdb to process id 6834.\n    Cannot find gdb installed\n    GDB is not installed.\n    Install gdb for enhanced tracebacks.\n    ------------------------------------------------------------------------\n    128\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26912\n\n",
    "created_at": "2018-12-18T13:36:28Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "cysignals related test failure in test.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26675",
    "user": "https://github.com/timokau"
}
```
CC:  jdmeyer

Keywords: cysignals

As discussed [on sage-packaging](https://groups.google.com/forum/#!topic/sage-packaging/CtiTkXDxWF0), one of the test cases in src/sage/doctest/test.py sometimes fails when the system is under load. This was reproduced bei Jeoren with sage 8.5.rc0. Here's the log:


```
File "/nix/store/s1x3samyxif0mdg4l9v6abjzccc88b08-sage-src-8.4/src/sage/doctest/test.py", line 220, in sage.doctest.test
Failed example:
    subprocess.call(["sage", "-tp", "1000000", "--timeout=120",  # long time
         "--warn-long", "0", "99seconds.rst", "interrupt_diehard.rst"], **kwds2)
Expected:
    Running doctests...
    Doctesting 2 files using 1000000 threads.
    Killing test 99seconds.rst
    Killing test interrupt_diehard.rst
    ----------------------------------------------------------------------
    Doctests interrupted: 0/2 files tested
    ----------------------------------------------------------------------
    ...
    128
Got:
    Running doctests with ID 2018-12-17-16-27-41-26396051.
    Using --optional=dochtml,gmp,memlimit,nose,sage
    Doctesting 2 files using 1000000 threads.
    ------------------------------------------------------------------------
    Killing test 99seconds.rst
    Killing test interrupt_diehard.rst
    /nix/store/chdzkj17b8x0q42jnygpsjj9ccw2rasz-python-2.7.15-env/lib/python2.7/site-packages/cysignals/signals.so(+0x7bfb)[0x7ffff1a2bbfb]
    /nix/store/chdzkj17b8x0q42jnygpsjj9ccw2rasz-python-2.7.15-env/lib/python2.7/site-packages/cysignals/signals.so(+0x7cbf)[0x7ffff1a2bcbf]
    /nix/store/chdzkj17b8x0q42jnygpsjj9ccw2rasz-python-2.7.15-env/lib/python2.7/site-packages/cysignals/signals.so(+0xa7bb)[0x7ffff1a2e7bb]
    /nix/store/1mnsmslnx5anjfksac6417xfzzglrwhr-glibc-2.27/lib/libpthread.so.0(+0x11f10)[0x7ffff7592f10]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyFrame_New+0xb5)[0x7ffff78294e5]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x947a)[0x7ffff78b658a]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x8a109)[0x7ffff782a109]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x6865c)[0x7ffff780865c]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0xcb3ba)[0x7ffff786b3ba]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x2d32)[0x7ffff78afe42]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x94cb)[0x7ffff78b65db]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x8a109)[0x7ffff782a109]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0x6865c)[0x7ffff780865c]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0xcb6f2)[0x7ffff786b6f2]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(+0xc7bba)[0x7ffff7867bba]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7ffff77f9043]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x2d32)[0x7ffff78afe42]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x94cb)[0x7ffff78b65db]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6713)[0x7ffff78b3823]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x7b8)[0x7ffff78b6dd8]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7ffff78b6fe9]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x8a)[0x7ffff78d9c8a]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xe3)[0x7ffff78dbbc3]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/lib/libpython2.7.so.1.0(Py_Main+0xb4a)[0x7ffff78f4ada]
    /nix/store/1mnsmslnx5anjfksac6417xfzzglrwhr-glibc-2.27/lib/libc.so.6(__libc_start_main+0xee)[0x7ffff6a52b8e]
    /nix/store/vb3jdf8f9xq8aq77dq93csifdx3xkcwa-python-2.7.15/bin/python(_start+0x2a)[0x4007fa]
    ------------------------------------------------------------------------
    ----------------------------------------------------------------------
    Doctests interrupted: 0/2 files tested
    ----------------------------------------------------------------------
    Total time for all tests: 0.1 seconds
        cpu time: 0.0 seconds
        cumulative wall time: 0.0 seconds
    Attaching gdb to process id 6834.
    Cannot find gdb installed
    GDB is not installed.
    Install gdb for enhanced tracebacks.
    ------------------------------------------------------------------------
    128
```


Issue created by migration from https://trac.sagemath.org/ticket/26912





---

archive/issue_comments_374586.json:
```json
{
    "body": "`@`Jeroen\n> Unfortunately, I don't manage to reproduce it reliably enough to be able \n> to fix it.\n\nThats unfortunate. Do you think it may have something to do with the \"ridiculous\nnumber of threads\"?",
    "created_at": "2018-12-18T13:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374586",
    "user": "https://github.com/timokau"
}
```

`@`Jeroen
> Unfortunately, I don't manage to reproduce it reliably enough to be able 
> to fix it.

Thats unfortunate. Do you think it may have something to do with the "ridiculous
number of threads"?



---

archive/issue_comments_374587.json:
```json
{
    "body": "Changing component from packages: standard to doctest framework.",
    "created_at": "2018-12-18T13:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374587",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from packages: standard to doctest framework.



---

archive/issue_comments_374588.json:
```json
{
    "body": "As I mentioned before, I don't think that this is related to cysignals in any way.",
    "created_at": "2018-12-18T13:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374588",
    "user": "https://github.com/jdemeyer"
}
```

As I mentioned before, I don't think that this is related to cysignals in any way.



---

archive/issue_comments_374589.json:
```json
{
    "body": "Changing keywords from \"cysignals\" to \"\".",
    "created_at": "2018-12-18T13:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374589",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "cysignals" to "".



---

archive/issue_comments_374590.json:
```json
{
    "body": "Oh, I misunderstood. I thought you only meant that the update to 1.8.0 wasn't responsible.",
    "created_at": "2018-12-19T09:36:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374590",
    "user": "https://github.com/timokau"
}
```

Oh, I misunderstood. I thought you only meant that the update to 1.8.0 wasn't responsible.



---

archive/issue_comments_374591.json:
```json
{
    "body": "Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374591",
    "user": "https://github.com/embray"
}
```

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_374592.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374592",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_374593.json:
```json
{
    "body": "As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374593",
    "user": "https://github.com/embray"
}
```

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_374594.json:
```json
{
    "body": "I'm seeing something like this quite frequently since trying to test the fix to #30945:\n\n\n```\n$ SAGE_TIMEOUT=3 sage -t --warn-long 0 --random-seed=0 src/sage/doctest/tests/99seconds.rst \nRunning doctests with ID 2021-03-08-14-48-11-b862a4f7.\nGit branch: u/embray/gappy-without-wrappers\nUsing --optional=build,debian,dochtml,memlimit,pip,rubiks,sage,sage_spkg\nDoctesting 1 file.\nsage -t --warn-long 0.0 --random-seed=0 src/sage/doctest/tests/99seconds.rst\n    Timed out (and interrupt failed)\n**********************************************************************\nTests run before process (pid=7821) timed out:\nsage: import time ## line 3 ##\nsage: time.sleep(99) ## line 4 ##\n------------------------------------------------------------------------\n/home/embray/src/sagemath/sage/local/lib/python3.6/site-packages/cysignals/signals.cpython-36m-x86_64-linux-gnu.so(+0x6a6b)[0x7f4ccad87a6b]\n/home/embray/src/sagemath/sage/local/lib/python3.6/site-packages/cysignals/signals.cpython-36m-x86_64-linux-gnu.so(+0x6c48)[0x7f4ccad87c48]\n/home/embray/src/sagemath/sage/local/lib/python3.6/site-packages/cysignals/signals.cpython-36m-x86_64-linux-gnu.so(+0x90fa)[0x7f4ccad8a0fa]\n<long stacktrace>\n------------------------------------------------------------------------\nAttaching gdb to process id 7821.\n\n**********************************************************************\n----------------------------------------------------------------------\nsage -t --warn-long 0.0 --random-seed=0 src/sage/doctest/tests/99seconds.rst  # Timed out (and interrupt failed)\n----------------------------------------------------------------------\nTotal time for all tests: 63.0 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n```\n",
    "created_at": "2021-03-08T13:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374594",
    "user": "https://github.com/embray"
}
```

I'm seeing something like this quite frequently since trying to test the fix to #30945:


```
$ SAGE_TIMEOUT=3 sage -t --warn-long 0 --random-seed=0 src/sage/doctest/tests/99seconds.rst 
Running doctests with ID 2021-03-08-14-48-11-b862a4f7.
Git branch: u/embray/gappy-without-wrappers
Using --optional=build,debian,dochtml,memlimit,pip,rubiks,sage,sage_spkg
Doctesting 1 file.
sage -t --warn-long 0.0 --random-seed=0 src/sage/doctest/tests/99seconds.rst
    Timed out (and interrupt failed)
**********************************************************************
Tests run before process (pid=7821) timed out:
sage: import time ## line 3 ##
sage: time.sleep(99) ## line 4 ##
------------------------------------------------------------------------
/home/embray/src/sagemath/sage/local/lib/python3.6/site-packages/cysignals/signals.cpython-36m-x86_64-linux-gnu.so(+0x6a6b)[0x7f4ccad87a6b]
/home/embray/src/sagemath/sage/local/lib/python3.6/site-packages/cysignals/signals.cpython-36m-x86_64-linux-gnu.so(+0x6c48)[0x7f4ccad87c48]
/home/embray/src/sagemath/sage/local/lib/python3.6/site-packages/cysignals/signals.cpython-36m-x86_64-linux-gnu.so(+0x90fa)[0x7f4ccad8a0fa]
<long stacktrace>
------------------------------------------------------------------------
Attaching gdb to process id 7821.

**********************************************************************
----------------------------------------------------------------------
sage -t --warn-long 0.0 --random-seed=0 src/sage/doctest/tests/99seconds.rst  # Timed out (and interrupt failed)
----------------------------------------------------------------------
Total time for all tests: 63.0 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```




---

archive/issue_comments_374595.json:
```json
{
    "body": "I think I might know the reason in my case.  The doctest runner gives test processes `timeout * 0.05` to die after they are sent a `SIGQUIT` due to timeout.  After this \"die timeout\" they are killed with `SIGKILL`.  This is the case in which the doctest reporter reports \"Timed out (and interrupt failed)\" as opposed to just \"Timed out\" (the message is a bit deceptive since the \"interrupt\" in question is a `SIGQUIT`).\n\nThe `sigdie()` in cysignals, in response to the `SIGQUT` is calling `print_enhanced_backtrace()` which fires up the cysignals-CSI machinery and starts up gdb.  Normally this is happening within the \"die timeout\" limit, but since I was working on #30945 I have some plugins loaded for gdb which are making it take longer to start up, resulting in the process not dying fast enough.\n\nI'm going to try running this test with `CYSIGNALS_CRASH_NDEBUG=1` and see if that makes a difference.",
    "created_at": "2021-03-08T14:21:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374595",
    "user": "https://github.com/embray"
}
```

I think I might know the reason in my case.  The doctest runner gives test processes `timeout * 0.05` to die after they are sent a `SIGQUIT` due to timeout.  After this "die timeout" they are killed with `SIGKILL`.  This is the case in which the doctest reporter reports "Timed out (and interrupt failed)" as opposed to just "Timed out" (the message is a bit deceptive since the "interrupt" in question is a `SIGQUIT`).

The `sigdie()` in cysignals, in response to the `SIGQUT` is calling `print_enhanced_backtrace()` which fires up the cysignals-CSI machinery and starts up gdb.  Normally this is happening within the "die timeout" limit, but since I was working on #30945 I have some plugins loaded for gdb which are making it take longer to start up, resulting in the process not dying fast enough.

I'm going to try running this test with `CYSIGNALS_CRASH_NDEBUG=1` and see if that makes a difference.



---

archive/issue_comments_374596.json:
```json
{
    "body": "I'll note that in the original ticket report it shows that gdb is not installed at all in that case.  But it's still conceivable that, especially on a system under load, just trying to start the cysignals-CSI script creates enough overhead that the process doesn't quit quickly enough.",
    "created_at": "2021-03-08T14:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374596",
    "user": "https://github.com/embray"
}
```

I'll note that in the original ticket report it shows that gdb is not installed at all in that case.  But it's still conceivable that, especially on a system under load, just trying to start the cysignals-CSI script creates enough overhead that the process doesn't quit quickly enough.



---

archive/issue_comments_374597.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-08T16:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374597",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_374598.json:
```json
{
    "body": "This should fix it in most cases.  It's not a silver bullet, but it should greatly reduce the likelihood of this (already rare) test failure.\n----\nNew commits:",
    "created_at": "2021-03-08T16:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374598",
    "user": "https://github.com/embray"
}
```

This should fix it in most cases.  It's not a silver bullet, but it should greatly reduce the likelihood of this (already rare) test failure.
----
New commits:



---

archive/issue_comments_374599.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-03-15T13:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374599",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_374600.json:
```json
{
    "body": "ok, let's do that",
    "created_at": "2021-03-15T13:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374600",
    "user": "https://github.com/fchapoton"
}
```

ok, let's do that



---

archive/issue_events_024777.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-18T22:32:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26675#event-24777"
}
```



---

archive/issue_comments_374601.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-03-18T22:32:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26675#issuecomment-374601",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
