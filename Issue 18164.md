# Issue 18164: maple command broken (on some computer)

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2015-05-11 21:25:38

The command used to launch maple through a ssh tunnel by pexpect is

```
$ sage-native-execute ssh -t REMOTE \
 maple -t -c "interface(screenwidth=infinity,errorcursor=false)"
```

But on some (all?) computers this simply does not work

```
bash: -c: line 0: syntax error near unexpected token `('
bash: -c: line 0: `maple -t -c
interface(screenwidth=infinity,errorcursor=false)'
Connection to calcul1 closed.
```


Using instead

```
$ sage-native-execute ssh -t REMOTE \
 'maple -t -c "interface(screenwidth=infinity,errorcursor=false)"'
```

works as a charm


---

Comment by vdelecroix created at 2015-05-11 22:18:40

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-05-11 22:18:40

New commits:


---

Comment by leif created at 2015-05-12 01:44:26

Yep, `expect.py` is to fix, not `maple.py`.  (Otherwise a local `maple` would no longer work.)

The problem when using ssh (or likewise, `sh -c ...`) is that the parameters get interpreted twice; once by the local shell, and a second time by the remote (or sub-) shell.

The local one removes the double quotes, passing literally `maple -t -c  interface(screenwidth=infinity,errorcursor=false)` to the remote shell, which gives a syntax error since the parentheses are no longer quoted nor escaped to avoid interpretation.


```sh
sh -c 'maple -t -c interface(screenwidth=infinity,errorcursor=false)'
```

would give exactly the same error, while

```sh
sh -c 'maple -t -c interface\(screenwidth=infinity,errorcursor=false\)'
```

would work.

(So it does _not_ depend on the computer, unless the remote shell were some strange non-standard one not treating the parentheses as special characters...)


---

Comment by leif created at 2015-05-12 01:51:34

I'd still use _either_ single quotes _or_ double quotes in both cases, the difference being where environment variables would be evaluated.


---

Comment by git created at 2015-05-12 07:26:34

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-05-12 07:31:20

Hi Leif,

Thanks for your clarification!

I added simple quotes to both cases when ssh is involved (with or without `ulimit`). I also added the option `ulimit` to our maple interface. Both works for me (even with a gate in between).

Vincent


---

Comment by leif created at 2015-05-12 10:22:08

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2015-05-12 10:31:55

Thanks!


---

Comment by vbraun created at 2015-05-13 11:33:46

Resolution: fixed
