# Issue 22711: avoid "absolute_import" in tab completion

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2017-05-04 14:36:09

CC:  dcoudert

As reported in [this thread on sage-devel](https://groups.google.com/forum/#!topic/sage-devel/XksZ-oCVrOo)

```
sage: designs.<TAB>
absolute_import ...
```



---

Comment by vdelecroix created at 2017-05-04 14:59:26

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2017-05-04 14:59:26

New commits:


---

Comment by tscrim created at 2017-05-04 15:08:09

Big -1 on the (current) doctests as it is one more thing to update each time we add something to the respective catalog. I'm essentially in favor of removing them altogether. If you really want a doctest, then you're better checking if, e.g., `'absolute_import' in dir(crystals)`. I feel such a doctest, which is not there for all catalogs, is just going to create extra headaches.


---

Comment by dcoudert created at 2017-05-04 15:11:35

I also agree that `absolute_import in dir(designs)` would be safer.

I tried the current version and it solves the issue for `designs.<TAB>`and passes all tests on `src/sage/coding`, `src/sage/combinat/crystals/`, `src/sage/combinat/designs/`, `src/sage/game_theory/`, and `src/sage/groups/`.


---

Comment by vdelecroix created at 2017-05-04 15:18:17

All right. Will change it.


---

Comment by git created at 2017-05-04 15:28:02

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2017-05-04 15:28:31

done


---

Comment by dcoudert created at 2017-05-04 15:37:39

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2017-05-04 15:37:39

For me this is good to go (passes all tests).
Thank you.


---

Comment by embray created at 2017-05-04 16:58:51

Rather than putting `del` everywhere (and likely forgetting in other modules) wouldn't it make more sense to update the `__dir__` implementation to exclude it (and anything else from `__futures__`)?


---

Comment by embray created at 2017-05-04 16:59:45

Ah, of course, but this is a module.  That said, surely there's somewhere to control what gets included in tab-completion (it doesn't include other globals like standard module imports does it?)


---

Comment by vdelecroix created at 2017-05-04 17:02:57

Replying to [comment:8 embray]:
> Rather than putting `del` everywhere (and likely forgetting in other modules) wouldn't it make more sense to update the `__dir__` implementation to exclude it (and anything else from `__futures__`)?

It would! But I have no idea how to implement it.


---

Comment by embray created at 2017-05-04 17:20:38

Maybe it's not so simple after all.  It seems there's nothing like that currently in Sage, and scant documentation on how to customize tab-completion in IPython (though it does appear to be possible).  Maybe something worth working on (another possibility is that if we provide our own SageModule class, as I've been meaning to do anyways, we can customize `__dir__` for modules in Sage).

In the meantime, this is just limited to some "catalog" modules where it matters most so that's fine.


---

Comment by vbraun created at 2017-05-08 21:18:36

Resolution: fixed
