# Issue 21202: Inaccurate Bernoulli numbers from Flint

Issue created by migration from https://trac.sagemath.org/ticket/21439

Original creator: rws

Original creation time: 2016-09-06 15:04:01

CC:  leif

Fredrik Johansson advises to switch to Arb for computing Bernoulli numbers because of https://github.com/wbhart/flint2/issues/288


---

Comment by rws created at 2016-09-07 07:30:20

Changing component from number theory to numerical.


---

Comment by leif created at 2016-09-07 11:51:44

We may temporarily just do what the reporter on sage-devel did, i.e., change the "algorithm" used (perhaps depending on the argument):

```
Since Sage uses flint as the default algorithm for n<=300000 the error
affects Sage and can be observed, e.g., by comparing
bernoulli(250408,'flint') and bernoulli(250408,'bernmm').
```

(Just noticed `algorithm="arb"` is also already supported; there are various backends.)

Or apply the upstream fix...


---

Comment by wbhart created at 2016-09-07 20:01:01

Note the flint fix does not guarantee anything. It should fix the problem for all practical sizes, but there are no proven bounds. Arb guarantees the correct result up to bugs.


---

Comment by vdelecroix created at 2019-04-08 16:48:55

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2019-04-08 16:48:55

New commits:


---

Comment by vdelecroix created at 2019-04-08 16:50:49

Replying to [comment:4 wbhart]:
> Note the flint fix does not guarantee anything. It should fix the problem for all practical sizes, but there are no proven bounds. Arb guarantees the correct result up to bugs.

All values n <= 20000 currently used in the thresholds have been tested one by one. So that there is a guarantee (until we upgrade flint :-).


---

Comment by tscrim created at 2019-04-12 08:40:57

LGTM.


---

Comment by tscrim created at 2019-04-12 08:40:57

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2019-04-12 08:41:28

thanks


---

Comment by vbraun created at 2019-04-15 17:48:06

Resolution: fixed
