# Issue 21202: Inaccurate Bernoulli numbers from Flint

archive/issues_021202.json:
```json
{
    "body": "CC:  @nexttime\n\nFredrik Johansson advises to switch to Arb for computing Bernoulli numbers because of https://github.com/wbhart/flint2/issues/288\n\nIssue created by migration from https://trac.sagemath.org/ticket/21439\n\n",
    "created_at": "2016-09-06T15:04:01Z",
    "labels": [
        "component: number theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Inaccurate Bernoulli numbers from Flint",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21202",
    "user": "https://github.com/rwst"
}
```
CC:  @nexttime

Fredrik Johansson advises to switch to Arb for computing Bernoulli numbers because of https://github.com/wbhart/flint2/issues/288

Issue created by migration from https://trac.sagemath.org/ticket/21439





---

archive/issue_comments_293660.json:
```json
{
    "body": "Changing component from number theory to numerical.",
    "created_at": "2016-09-07T07:30:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293660",
    "user": "https://github.com/rwst"
}
```

Changing component from number theory to numerical.



---

archive/issue_comments_293661.json:
```json
{
    "body": "We may temporarily just do what the reporter on sage-devel did, i.e., change the \"algorithm\" used (perhaps depending on the argument):\n\n```\nSince Sage uses flint as the default algorithm for n<=300000 the error\naffects Sage and can be observed, e.g., by comparing\nbernoulli(250408,'flint') and bernoulli(250408,'bernmm').\n```\n\n(Just noticed `algorithm=\"arb\"` is also already supported; there are various backends.)\n\nOr apply the upstream fix...",
    "created_at": "2016-09-07T11:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293661",
    "user": "https://github.com/nexttime"
}
```

We may temporarily just do what the reporter on sage-devel did, i.e., change the "algorithm" used (perhaps depending on the argument):

```
Since Sage uses flint as the default algorithm for n<=300000 the error
affects Sage and can be observed, e.g., by comparing
bernoulli(250408,'flint') and bernoulli(250408,'bernmm').
```

(Just noticed `algorithm="arb"` is also already supported; there are various backends.)

Or apply the upstream fix...



---

archive/issue_comments_293662.json:
```json
{
    "body": "Note the flint fix does not guarantee anything. It should fix the problem for all practical sizes, but there are no proven bounds. Arb guarantees the correct result up to bugs.",
    "created_at": "2016-09-07T20:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293662",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

Note the flint fix does not guarantee anything. It should fix the problem for all practical sizes, but there are no proven bounds. Arb guarantees the correct result up to bugs.



---

archive/issue_comments_293663.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-08T16:48:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293663",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_293664.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-04-08T16:48:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293664",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_293665.json:
```json
{
    "body": "Replying to [comment:4 wbhart]:\n> Note the flint fix does not guarantee anything. It should fix the problem for all practical sizes, but there are no proven bounds. Arb guarantees the correct result up to bugs.\n\nAll values n <= 20000 currently used in the thresholds have been tested one by one. So that there is a guarantee (until we upgrade flint :-).",
    "created_at": "2019-04-08T16:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293665",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:4 wbhart]:
> Note the flint fix does not guarantee anything. It should fix the problem for all practical sizes, but there are no proven bounds. Arb guarantees the correct result up to bugs.

All values n <= 20000 currently used in the thresholds have been tested one by one. So that there is a guarantee (until we upgrade flint :-).



---

archive/issue_comments_293666.json:
```json
{
    "body": "LGTM.",
    "created_at": "2019-04-12T08:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293666",
    "user": "https://github.com/tscrim"
}
```

LGTM.



---

archive/issue_comments_293667.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-12T08:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293667",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_293668.json:
```json
{
    "body": "thanks",
    "created_at": "2019-04-12T08:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293668",
    "user": "https://github.com/videlec"
}
```

thanks



---

archive/issue_comments_293669.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-15T17:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21202#issuecomment-293669",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_020075.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-04-15T17:48:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21202",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21202#event-20075"
}
```
