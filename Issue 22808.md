# Issue 22808: gsl does not pass self-tests on 32bit systems

Issue created by migration from https://trac.sagemath.org/ticket/23045

Original creator: tmonteil

Original creation time: 2017-05-21 20:59:34

CC:  chapoton tscrim

See the attached build log `gsl-2.1.p1.log` and the corresponding failing test suite `test-suite.log`.


---

Attachment


---

Attachment

Note that self-tests pass on x86_64.


---

Comment by vbraun created at 2017-05-24 19:15:12

Not all self-tests work on all systems (sometimes for mondane reasons like network access). Not a blocker imho.


---

Comment by tmonteil created at 2017-05-25 08:40:33

Replying to [comment:2 vbraun]:
> Not all self-tests work on all systems (sometimes for mondane reasons like network access). Not a blocker imho.

In such cases, i guess we should at least know (and collect somewhere), which errors are "recurrent" or "unfixable". We should run the self-tests more frequently, as finding broken self-tests also leads to  bugfixes that benefit to all of us, see e.g. #23056, #23057 which will be fixed soon. Apart from `python` which is known not to pass self-tests, i hope that all other will pass on 32bit system (which is still a supported arch).

I agree that since i am doing a systematic check of all standard packages for the first time on 32bits (and will go to all optional when this will be done), there are many blockeres appearing in a short delay, and it might be unreasonable to wait for all of them. However, once they will be all fixed, we could become more strict when a new issue appears, and for this to happen smoothly, we should be sure that those tests are run on a more regular basis to avoid such an accumulation, e.g. by letting the patchbots to run them.


---

Comment by vbraun created at 2017-06-11 09:46:12

Agree but not a blocker...


---

Comment by vbraun created at 2017-06-11 09:46:12

Changing priority from blocker to major.


---

Comment by fbissey created at 2017-06-12 04:08:22

I just want to make a comment on that one. My understanding is that upstream gsl has stopped doing testing on 32bits architectures. Tolerance for tests have therefore been only tested on 64bits. Some distros (fedora at least) have tried to do some patching for the tolerance problem. But they only go so far as their testing environment. For example the fedora patch for this problem did not help me on Gentoo when doing a multilib build (both 64 and 32bit on a 64bit host). I am not the "real" gsl maintainer for Gentoo but I brought a number of improvements to it recently and that was a major headache.


---

Comment by tmonteil created at 2017-06-12 14:55:37

Replying to [comment:5 fbissey]:
> I just want to make a comment on that one. My understanding is that upstream gsl has stopped doing testing on 32bits architectures. Tolerance for tests have therefore been only tested on 64bits. Some distros (fedora at least) have tried to do some patching for the tolerance problem. But they only go so far as their testing environment. For example the fedora patch for this problem did not help me on Gentoo when doing a multilib build (both 64 and 32bit on a 64bit host). I am not the "real" gsl maintainer for Gentoo but I brought a number of improvements to it recently and that was a major headache.

They seem to be reactive to such issues, see the recent thread https://lists.gnu.org/archive/html/bug-gsl/2017-05/msg00010.html So, perhaps could we contribute to bug reports directly upstream each time we find such a problem, so that every distro benefit from the changes (with some delay), not only the ones that can afford writing their own patches ?

I need to test the problem on the latest version first, in case it is fixed already.


---

Comment by tmonteil created at 2017-06-14 10:37:01

2.3 fixes the issue. Tested on Debian GNU/Linux, 32 and 64 bits.


---

Comment by tmonteil created at 2017-06-14 10:37:01

Changing status from new to needs_review.


---

Comment by tmonteil created at 2017-06-15 11:43:12

New commits:


---

Comment by tscrim created at 2017-06-16 12:11:59

LGTM.


---

Comment by tscrim created at 2017-06-16 12:18:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-17 10:29:01

Resolution: fixed


---

Comment by tmonteil created at 2019-08-26 12:30:37

Changing keywords from "" to "sdl".
