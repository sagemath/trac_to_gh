# Issue 21001: Random failure in tutorial_free_modules.py

archive/issues_021001.json:
```json
{
    "body": "CC:  @nthiery @tscrim @kevindilks\n\nKeywords: random_fail\n\nComparison between integers and strings is by memory position, hence random order here:\n\n```\nsage -t --long src/sage/modules/tutorial_free_modules.py\n**********************************************************************\nFile \"src/sage/modules/tutorial_free_modules.py\", line 45, in sage.modules.tutorial_free_modules\nFailed example:\n    F = CombinatorialFreeModule(ZZ, ['spam', 'eggs', 42]); F.an_element()\nExpected:\n    3*B[42] + 2*B['eggs'] + 2*B['spam']\nGot:\n    2*B['eggs'] + 2*B['spam'] + 3*B[42]\n**********************************************************************\n1 item had failures:\n   1 of  43 in sage.modules.tutorial_free_modules\n    [42 tests, 1 failure, 0.43 s]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/21238\n\n",
    "created_at": "2016-08-13T12:26:57Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Random failure in tutorial_free_modules.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21001",
    "user": "https://github.com/vbraun"
}
```
CC:  @nthiery @tscrim @kevindilks

Keywords: random_fail

Comparison between integers and strings is by memory position, hence random order here:

```
sage -t --long src/sage/modules/tutorial_free_modules.py
**********************************************************************
File "src/sage/modules/tutorial_free_modules.py", line 45, in sage.modules.tutorial_free_modules
Failed example:
    F = CombinatorialFreeModule(ZZ, ['spam', 'eggs', 42]); F.an_element()
Expected:
    3*B[42] + 2*B['eggs'] + 2*B['spam']
Got:
    2*B['eggs'] + 2*B['spam'] + 3*B[42]
**********************************************************************
1 item had failures:
   1 of  43 in sage.modules.tutorial_free_modules
    [42 tests, 1 failure, 0.43 s]
```


Issue created by migration from https://trac.sagemath.org/ticket/21238





---

archive/issue_comments_290563.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290563",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_290564.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290564",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_290565.json:
```json
{
    "body": "please review this simple fix",
    "created_at": "2016-08-18T16:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290565",
    "user": "https://github.com/fchapoton"
}
```

please review this simple fix



---

archive/issue_comments_290566.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-18T16:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290566",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_290567.json:
```json
{
    "body": "The wording suggests that elements must be consistently comparable, but this is not a (strict) requirement of CFM. IMO, a better test would be of the form:\n\n```\nsage: F.an_element() == F.sum_of_terms([(42, 3), ('eggs', 2), ('spam', 2)])\nTrue\n```\n",
    "created_at": "2016-08-18T22:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290567",
    "user": "https://github.com/tscrim"
}
```

The wording suggests that elements must be consistently comparable, but this is not a (strict) requirement of CFM. IMO, a better test would be of the form:

```
sage: F.an_element() == F.sum_of_terms([(42, 3), ('eggs', 2), ('spam', 2)])
True
```




---

archive/issue_comments_290568.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-18T22:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290568",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_290569.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-19T07:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290569",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290570.json:
```json
{
    "body": "`@`tscrim : I have tried to enhance the wording of my explanations.",
    "created_at": "2016-08-19T07:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290570",
    "user": "https://github.com/fchapoton"
}
```

`@`tscrim : I have tried to enhance the wording of my explanations.



---

archive/issue_comments_290571.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-19T07:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290571",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_290572.json:
```json
{
    "body": "I am willing to give this a positive review as-is, but I feel changing the example, which tests the stated functionality, is a better way to avoid random output. Do you have a reason why adding an explanation is better?",
    "created_at": "2016-08-19T08:30:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290572",
    "user": "https://github.com/tscrim"
}
```

I am willing to give this a positive review as-is, but I feel changing the example, which tests the stated functionality, is a better way to avoid random output. Do you have a reason why adding an explanation is better?



---

archive/issue_comments_290573.json:
```json
{
    "body": "Well, I would say that a tutorial is a good place for more explanations, rather than a good place for subtle non-explicit doctests.\n\nSo I would prefer to keep my explanations.",
    "created_at": "2016-08-19T09:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290573",
    "user": "https://github.com/fchapoton"
}
```

Well, I would say that a tutorial is a good place for more explanations, rather than a good place for subtle non-explicit doctests.

So I would prefer to keep my explanations.



---

archive/issue_comments_290574.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-19T23:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290574",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_290575.json:
```json
{
    "body": "While I disagree slightly with the level of explicitness and still have slight reservations about not showing we can do arbitrary sets (for purely technical and political reasons), we should fix this.",
    "created_at": "2016-08-19T23:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290575",
    "user": "https://github.com/tscrim"
}
```

While I disagree slightly with the level of explicitness and still have slight reservations about not showing we can do arbitrary sets (for purely technical and political reasons), we should fix this.



---

archive/issue_events_019911.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-21T23:39:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21001#event-19911"
}
```



---

archive/issue_comments_290576.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-21T23:39:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21001#issuecomment-290576",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
