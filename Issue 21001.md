# Issue 21001: Random failure in tutorial_free_modules.py

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2016-08-13 12:26:57

CC:  â€‹nthiery tscrim kdilks

Keywords: random_fail

Comparison between integers and strings is by memory position, hence random order here:

```
sage -t --long src/sage/modules/tutorial_free_modules.py
**********************************************************************
File "src/sage/modules/tutorial_free_modules.py", line 45, in sage.modules.tutorial_free_modules
Failed example:
    F = CombinatorialFreeModule(ZZ, ['spam', 'eggs', 42]); F.an_element()
Expected:
    3*B[42] + 2*B['eggs'] + 2*B['spam']
Got:
    2*B['eggs'] + 2*B['spam'] + 3*B[42]
**********************************************************************
1 item had failures:
   1 of  43 in sage.modules.tutorial_free_modules
    [42 tests, 1 failure, 0.43 s]
```



---

Comment by chapoton created at 2016-08-18 16:44:03

New commits:


---

Comment by chapoton created at 2016-08-18 16:44:03

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-08-18 16:44:26

please review this simple fix


---

Comment by vbraun created at 2016-08-18 16:49:40

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-08-18 22:44:02

The wording suggests that elements must be consistently comparable, but this is not a (strict) requirement of CFM. IMO, a better test would be of the form:

```
sage: F.an_element() == F.sum_of_terms([(42, 3), ('eggs', 2), ('spam', 2)])
True
```



---

Comment by tscrim created at 2016-08-18 22:44:02

Changing status from positive_review to needs_work.


---

Comment by git created at 2016-08-19 07:40:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-08-19 07:42:06

`@`tscrim : I have tried to enhance the wording of my explanations.


---

Comment by chapoton created at 2016-08-19 07:42:14

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2016-08-19 08:30:51

I am willing to give this a positive review as-is, but I feel changing the example, which tests the stated functionality, is a better way to avoid random output. Do you have a reason why adding an explanation is better?


---

Comment by chapoton created at 2016-08-19 09:09:04

Well, I would say that a tutorial is a good place for more explanations, rather than a good place for subtle non-explicit doctests.

So I would prefer to keep my explanations.


---

Comment by tscrim created at 2016-08-19 23:08:05

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-08-19 23:08:05

While I disagree slightly with the level of explicitness and still have slight reservations about not showing we can do arbitrary sets (for purely technical and political reasons), we should fix this.


---

Comment by vbraun created at 2016-08-21 23:39:34

Resolution: fixed
