# Issue 28548: Make spkg-configure.m4 more verbose

Issue created by migration from https://trac.sagemath.org/ticket/28785

Original creator: saraedum

Original creation time: 2019-11-21 22:53:39

CC:  embray

Keywords: spkg-configure.m4

Some spkg-configure.m4 implement a message at the end that says something like `will use the package X from the system`. It's confusing to me at least that not all packages report this immediately. (They do in the final listing of packages.)

More importantly, it would be nice if all packages that do implement such a check would be explicit about not having passed that test. For example, in the final listing of packages, it would be nice if we had something similar to:

```
alib (using package from system)
blib (not using package from system)
clib # no additional comment, does not have a spkg-configure.m4 yet.
```



---

Comment by jhpalmieri created at 2019-11-22 00:01:45

I find the summary toward the end of the main `config.log` to be somewhat helpful, where it says things like

```
bzip2-1.0.6-20150304.p0 will not be installed (configure check)
```

It would be more helpful if this were not buried inside the log file, and it would be even more helpful if it would say (as you are suggesting)

```
cliquer-1.21.p4 will be installed (no suitable system package)
```

but also something like

```
cmake-3.11.0 will not be installed (optional package)
```

I don't know the best wording to handle all of the various cases: system package found (and do you distinguish in this case among standard, optional, or experimental?), standard package but no system package found, optional, experimental.


---

Comment by saraedum created at 2019-11-22 03:00:38

Trying to debug a problem, I got really confused by some of the things in the sage_spkg_configure.m4. So I added some comments that I would have found helpful (and fixed the comment on the top explaining CHECK.)

I also restructured the logic a bit. Now it seems more natural to me and this probably also fixed a bug. This might have introduced a few new problems, I haven't really checked carefully, but it works for me.

I changed the meaning of `force` when there is no check. It now actually tells Sage not to install that package.

[should have done this on GitLab so I can comment inside my changesetâ€¦]
----
New commits:


---

Comment by saraedum created at 2019-11-22 15:10:18

This is now https://gitlab.com/sagemath/sage/merge_requests/38 and #28788

[sorry, but there is no good way to migrate an existing trac ticket to a GitLab Merge Request.]


---

Comment by saraedum created at 2019-11-22 15:10:56

Changing status from new to needs_review.


---

Comment by embray created at 2019-12-13 13:34:45

Resolution: duplicate


---

Comment by embray created at 2019-12-13 13:35:27

Replying to [comment:5 saraedum]:
> [sorry, but there is no good way to migrate an existing trac ticket to a GitLab Merge Request.]

That might be a nice feature to add.  E.g. "resolves #XXXXX" or "fixes #XXXXX" in the merge request title or body could do this...
