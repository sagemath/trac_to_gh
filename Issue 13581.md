# Issue 13581: Export a graph to a dictionary

Issue created by migration from https://trac.sagemath.org/ticket/13785

Original creator: ncohen

Original creation time: 2012-12-01 12:36:42

Assignee: jason, ncohen, rlm

CC:  dcoudert

This can be useful, and it can even be used internally. dictionaries are faster than Sage graphs. We currently use networx to improve speed in some algorithms.


---

Comment by ncohen created at 2012-12-01 12:37:36

Changing status from new to needs_review.


---

Attachment

Hello,

This will certainly be useful when one wants to iterate many times over the neighbors and so.
But networkx graphs will remain useful when one wants to modify the graph during the algorithm (remove edge or vertex), unless patch #13730 is able to speed up iterations.

I'm waiting for patch #13784 before starting reviewing this patch.


---

Comment by ncohen created at 2012-12-02 09:33:19

Well. I actually begin to write that after a few seconds over you Suurballe algorithm. I read how it worked on wikipedia, and it looks like you just need to change vertex weights and remove a few edges. This can easily be done with dictionaries too `:-)`

Of course, if you need to run Dijkstra on the graph afterwards... `:-P`

But didn't you have a triangle_count code at Python-level which could use this method already ?

Nathann


---

Comment by dcoudert created at 2012-12-02 10:20:28

In patch #13380, I need to modify a copy of the graph (including weights) and then to compute a shortest path on the modified copy. So turning the graph into a dictionary is not sufficient. Furthermore, since we not only modify the weights, but also the graph topology (addition of reverse arcs), a solution allowing to pass to the shortest path method a dictionary of weights is not sufficient. 


For triangle counts (#13503), we can replace 

```
ggnx = self.networkx_graph() 
for u in ggnx.nodes_iter(): 
    tr += sum(ggnx.has_edge(v,w) for v,w in combinations_iterator(ggnx.neighbors(u),2)) 
return tr/3 
```

with

```
gg = self.to_dictionary() 
for u in gg.iterkeys(): 
    tr += sum(w in gg[v] for v,w in combinations_iterator(gg[u],2)) 
return tr/3 
```

This will certainly be faster since we don't need edge labels or any other decoration to count.


---

Comment by dcoudert created at 2012-12-02 11:33:15

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2012-12-02 11:33:15

The patch is working properly and passes all tests (including docbuild).
Loops in digraphs are also properly taken into account.

We shall later use it to speed up some methods (e.g., triangle count)


---

Comment by ncohen created at 2012-12-02 11:34:02

Thaaaaaaaaaaaaaaaaaanks !!!

Nathann


---

Comment by jdemeyer created at 2012-12-21 09:33:28

Resolution: fixed
