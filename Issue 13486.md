# Issue 13486: legend marker 'o' is incorrectly printed

Issue created by migration from Trac.

Original creator: ppurka

Original creation time: 2012-11-07 07:01:29

Assignee: jason, was

Just look at the output of this command

```
list_plot(range(3), plotjoined=True, marker='o', legend_label='square here, circle there')
```

The marker in the legend should be a `o` but it is actually printed as a square. This seems to be a bug in Sage because I couldn't reproduce it in matplotlib. I tried the following two variants:

```
import matplotlib.pyplot as plt
plt.plot(range(3), range(3), '-o')
plt.legend('square here')
plt.savefig('a.png')
```


```
import matplotlib.lines as lines
from matplotlib.figure import Figure

options = {'marker': 'o'}
p = lines.Line2D(range(3), range(3), **options)
p.set_label('square here, circle there')
figure=Figure()
subplot = figure.add_subplot(111)
subplot.add_line(p)
subplot.legend()
from matplotlib.backends.backend_agg import FigureCanvasAgg
figure.set_canvas(FigureCanvasAgg(figure))
figure.savefig('a.png')
```



---

Comment by jason created at 2012-11-12 14:24:56

And it's not just list_plot.  Here is an example with line:


```
line(enumerate([1,2,1]), marker = 'o', legend_label='a')
```



---

Comment by jason created at 2012-11-12 14:32:03

I just tried this on my local computer with #13693 applied and the legend showed up correctly.  Can someone double-check that the upgrade to matplotlib 1.2.0 fixes this problem?


---

Comment by ppurka created at 2012-11-12 14:45:57

Replying to [comment:2 jason]:
> And it's not just list_plot.  Here is an example with line:
> 
> {{{
> line(enumerate([1,2,1]), marker = 'o', legend_label='a')
> }}}
My second matplotlib example essentially does whatever the `line` command does. Also `plotjoined=True` in `list_plot` calls `line` directly.


---

Comment by jason created at 2012-11-12 14:46:28

Right.  Thanks.


---

Comment by ppurka created at 2012-11-12 14:53:53

Replying to [comment:3 jason]:
> I just tried this on my local computer with #13693 applied and the legend showed up correctly.  Can someone double-check that the upgrade to matplotlib 1.2.0 fixes this problem?
Yes. Upgrade to mpl-1.2.0 fixes this. I am flummoxed.

Setting dependency to #13693 since fixing that will fix this automatically.


---

Comment by jason created at 2012-11-12 14:59:52

And I am relieved!  We won't have to track this down.


---

Comment by ppurka created at 2012-11-12 15:02:24

I am relieved too! This is a nasty bug; very unreproducible.


---

Comment by kcrisman created at 2012-11-13 16:01:21

I assume we should put something in a `TESTS` block somewhere then for this ticket?  In the sense that we could ask someone to visually confirm the output, not that we are actually comparing images.


---

Attachment

Apply to devel/sage


---

Comment by ppurka created at 2012-11-13 17:05:49

Replying to [comment:9 kcrisman]:
> I assume we should put something in a `TESTS` block somewhere then for this ticket?  In the sense that we could ask someone to visually confirm the output, not that we are actually comparing images.
You are right. I attached a patch.


---

Comment by ppurka created at 2013-05-02 05:36:35

#13693 is in. I just kicked the patchbot. Let's see if the patch still applies.


---

Comment by ppurka created at 2013-05-26 12:20:39

Changing status from new to needs_review.


---

Comment by ncohen created at 2013-05-27 13:36:59

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-05-27 13:36:59

Just a doctest, it cannot hurt `:-)`

Nathann


---

Comment by ppurka created at 2013-05-27 13:44:11

Thanks :)


---

Comment by jdemeyer created at 2013-05-29 07:10:03

Resolution: fixed
