# Issue 17057: Add gcd to number field elements

archive/issues_017057.json:
```json
{
    "body": "CC:  @kcrisman\n\nImplement `gcd()` for number fields analogous to `factor()`.\n\nThe `gcd()` of two number field elements doesn't always make sense, but if it exists (in particular, if the class number is 1), then `a.gcd(b)` should work.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17294\n\n",
    "created_at": "2014-11-05T13:55:59Z",
    "labels": [
        "number fields",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Add gcd to number field elements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17057",
    "user": "@jdemeyer"
}
```
CC:  @kcrisman

Implement `gcd()` for number fields analogous to `factor()`.

The `gcd()` of two number field elements doesn't always make sense, but if it exists (in particular, if the class number is 1), then `a.gcd(b)` should work.

Issue created by migration from https://trac.sagemath.org/ticket/17294





---

archive/issue_comments_226851.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-27T08:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226851",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_226852.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-11-27T08:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226852",
    "user": "@jdemeyer"
}
```

New commits:



---

archive/issue_comments_226853.json:
```json
{
    "body": "This is red for some reason.\n\nAlso, how does this play into the big discussion about xgcd earlier?  I assume it would not be affected, but just asking.",
    "created_at": "2015-02-19T19:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226853",
    "user": "@kcrisman"
}
```

This is red for some reason.

Also, how does this play into the big discussion about xgcd earlier?  I assume it would not be affected, but just asking.



---

archive/issue_comments_226854.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-19T20:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226854",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226855.json:
```json
{
    "body": "Replying to [comment:5 kcrisman]:\n> This is red for some reason.\nFixed.\n\n> Also, how does this play into the big discussion about xgcd earlier?  I assume it would not be affected, but just asking.\nI don't think it's related.",
    "created_at": "2015-02-19T20:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226855",
    "user": "@jdemeyer"
}
```

Replying to [comment:5 kcrisman]:
> This is red for some reason.
Fixed.

> Also, how does this play into the big discussion about xgcd earlier?  I assume it would not be affected, but just asking.
I don't think it's related.



---

archive/issue_comments_226856.json:
```json
{
    "body": "typo in the doc\n\n```diff\n- The following field has class number 3, but it the ideal\n+ The following field has class number 3, but if the ideal\n```\n",
    "created_at": "2015-02-22T10:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226856",
    "user": "@videlec"
}
```

typo in the doc

```diff
- The following field has class number 3, but it the ideal
+ The following field has class number 3, but if the ideal
```




---

archive/issue_comments_226857.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-22T10:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226857",
    "user": "@videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_226858.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-22T19:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226858",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226859.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-22T19:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226859",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_226860.json:
```json
{
    "body": "Hello,\n\nNote that the behavior of `gcd` for `QQ` is quite special\n\n```\nsage: gcd(1/3, 2/3)\n1/3\n```\n\nIt is the implementation provided by the category `QuotientFields`. It would be different from\n\n```\nsage: K = NumberField(x-1, 'a')\nsage: K(1/3).gcd(K(2/3))\n1\n```\n\nI do not care so much as it is specified in the documentation. But a number field is always the quotient field of its maximal order... Do you think we should care?\n\nVincent",
    "created_at": "2015-04-08T20:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226860",
    "user": "@videlec"
}
```

Hello,

Note that the behavior of `gcd` for `QQ` is quite special

```
sage: gcd(1/3, 2/3)
1/3
```

It is the implementation provided by the category `QuotientFields`. It would be different from

```
sage: K = NumberField(x-1, 'a')
sage: K(1/3).gcd(K(2/3))
1
```

I do not care so much as it is specified in the documentation. But a number field is always the quotient field of its maximal order... Do you think we should care?

Vincent



---

archive/issue_comments_226861.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2015-04-08T20:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226861",
    "user": "@videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_226862.json:
```json
{
    "body": "Replying to [comment:11 vdelecroix]:\n> I do not care so much as it is specified in the documentation. But a number field is always the quotient field of its maximal order... Do you think we should care?\nThe problem is that a `gcd()` is not always defined for maximal orders in number fields (if the class number is not 1). So we cannot simply use the fraction field implementation. And for consistency, I don't want to treat the class-number=1 case differently.",
    "created_at": "2015-04-08T20:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226862",
    "user": "@jdemeyer"
}
```

Replying to [comment:11 vdelecroix]:
> I do not care so much as it is specified in the documentation. But a number field is always the quotient field of its maximal order... Do you think we should care?
The problem is that a `gcd()` is not always defined for maximal orders in number fields (if the class number is not 1). So we cannot simply use the fraction field implementation. And for consistency, I don't want to treat the class-number=1 case differently.



---

archive/issue_comments_226863.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2015-04-08T20:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226863",
    "user": "@jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_226864.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-08T20:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226864",
    "user": "@videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_226865.json:
```json
{
    "body": "\n```\nsage -t --warn-long 47.1 src/sage/categories/quotient_fields.py\n**********************************************************************\nFile \"src/sage/categories/quotient_fields.py\", line 101, in sage.categories.quotient_fields.QuotientFields.ElementMethods.gcd\nFailed example:\n    gcd(t, i)\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: unable to find gcd\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.quotient_fields.QuotientFields.ElementMethods.gcd[13]>\", line 1, in <module>\n        gcd(t, i)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py\", line 1551, in gcd\n        return GCD(b, **kwargs)\n      File \"sage/structure/element.pyx\", line 3473, in sage.structure.element.NamedBinopMethod.__call__ (build/cythonized/sage/structure/element.c:28398)\n        return self._func(x,y, **kwds)\n      File \"sage/rings/polynomial/polynomial_element.pyx\", line 3713, in sage.rings.polynomial.polynomial_element.Polynomial.gcd (build/cythonized/sage/rings/polynomial/polynomial_element.c:34450)\n        raise NotImplementedError(\"%s does not provide a gcd implementation for univariate polynomials\"%self.base_ring())\n    NotImplementedError: Maximal Order in Number Field in i with defining polynomial x^2 + 1 does not provide a gcd implementation for univariate polynomials\n**********************************************************************\nFile \"src/sage/categories/quotient_fields.py\", line 177, in sage.categories.quotient_fields.QuotientFields.ElementMethods.lcm\nFailed example:\n    lcm(t, i)\nExpected:\n    Traceback (most recent call last):\n    ...\n    AttributeError: 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense' object has no attribute 'gcd'\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.quotient_fields.QuotientFields.ElementMethods.lcm[11]>\", line 1, in <module>\n        lcm(t, i)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py\", line 1698, in lcm\n        return LCM(b)\n      File \"sage/structure/element.pyx\", line 3473, in sage.structure.element.NamedBinopMethod.__call__ (build/cythonized/sage/structure/element.c:28398)\n        return self._func(x,y, **kwds)\n      File \"sage/rings/polynomial/polynomial_element.pyx\", line 3722, in sage.rings.polynomial.polynomial_element.Polynomial.lcm (build/cythonized/sage/rings/polynomial/polynomial_element.c:34544)\n        g = self.gcd(other)\n      File \"sage/structure/element.pyx\", line 3473, in sage.structure.element.NamedBinopMethod.__call__ (build/cythonized/sage/structure/element.c:28398)\n        return self._func(x,y, **kwds)\n      File \"sage/rings/polynomial/polynomial_element.pyx\", line 3713, in sage.rings.polynomial.polynomial_element.Polynomial.gcd (build/cythonized/sage/rings/polynomial/polynomial_element.c:34450)\n        raise NotImplementedError(\"%s does not provide a gcd implementation for univariate polynomials\"%self.base_ring())\n    NotImplementedError: Maximal Order in Number Field in i with defining polynomial x^2 + 1 does not provide a gcd implementation for univariate polynomials\n**********************************************************************\n2 items had failures:\n   1 of  19 in sage.categories.quotient_fields.QuotientFields.ElementMethods.gcd\n   1 of  17 in sage.categories.quotient_fields.QuotientFields.ElementMethods.lcm\n    [153 tests, 2 failures, 0.99 s]\n----------------------------------------------------------------------\nsage -t --warn-long 47.1 src/sage/categories/quotient_fields.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\n",
    "created_at": "2015-04-10T20:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226865",
    "user": "@vbraun"
}
```


```
sage -t --warn-long 47.1 src/sage/categories/quotient_fields.py
**********************************************************************
File "src/sage/categories/quotient_fields.py", line 101, in sage.categories.quotient_fields.QuotientFields.ElementMethods.gcd
Failed example:
    gcd(t, i)
Expected:
    Traceback (most recent call last):
    ...
    TypeError: unable to find gcd
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.quotient_fields.QuotientFields.ElementMethods.gcd[13]>", line 1, in <module>
        gcd(t, i)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py", line 1551, in gcd
        return GCD(b, **kwargs)
      File "sage/structure/element.pyx", line 3473, in sage.structure.element.NamedBinopMethod.__call__ (build/cythonized/sage/structure/element.c:28398)
        return self._func(x,y, **kwds)
      File "sage/rings/polynomial/polynomial_element.pyx", line 3713, in sage.rings.polynomial.polynomial_element.Polynomial.gcd (build/cythonized/sage/rings/polynomial/polynomial_element.c:34450)
        raise NotImplementedError("%s does not provide a gcd implementation for univariate polynomials"%self.base_ring())
    NotImplementedError: Maximal Order in Number Field in i with defining polynomial x^2 + 1 does not provide a gcd implementation for univariate polynomials
**********************************************************************
File "src/sage/categories/quotient_fields.py", line 177, in sage.categories.quotient_fields.QuotientFields.ElementMethods.lcm
Failed example:
    lcm(t, i)
Expected:
    Traceback (most recent call last):
    ...
    AttributeError: 'sage.rings.polynomial.polynomial_element.Polynomial_generic_dense' object has no attribute 'gcd'
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.quotient_fields.QuotientFields.ElementMethods.lcm[11]>", line 1, in <module>
        lcm(t, i)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/rings/arith.py", line 1698, in lcm
        return LCM(b)
      File "sage/structure/element.pyx", line 3473, in sage.structure.element.NamedBinopMethod.__call__ (build/cythonized/sage/structure/element.c:28398)
        return self._func(x,y, **kwds)
      File "sage/rings/polynomial/polynomial_element.pyx", line 3722, in sage.rings.polynomial.polynomial_element.Polynomial.lcm (build/cythonized/sage/rings/polynomial/polynomial_element.c:34544)
        g = self.gcd(other)
      File "sage/structure/element.pyx", line 3473, in sage.structure.element.NamedBinopMethod.__call__ (build/cythonized/sage/structure/element.c:28398)
        return self._func(x,y, **kwds)
      File "sage/rings/polynomial/polynomial_element.pyx", line 3713, in sage.rings.polynomial.polynomial_element.Polynomial.gcd (build/cythonized/sage/rings/polynomial/polynomial_element.c:34450)
        raise NotImplementedError("%s does not provide a gcd implementation for univariate polynomials"%self.base_ring())
    NotImplementedError: Maximal Order in Number Field in i with defining polynomial x^2 + 1 does not provide a gcd implementation for univariate polynomials
**********************************************************************
2 items had failures:
   1 of  19 in sage.categories.quotient_fields.QuotientFields.ElementMethods.gcd
   1 of  17 in sage.categories.quotient_fields.QuotientFields.ElementMethods.lcm
    [153 tests, 2 failures, 0.99 s]
----------------------------------------------------------------------
sage -t --warn-long 47.1 src/sage/categories/quotient_fields.py  # 2 doctests failed
----------------------------------------------------------------------
```




---

archive/issue_comments_226866.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-04-10T20:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226866",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_226867.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-11T11:10:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226867",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226868.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-11T11:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226868",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_226869.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-11T12:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226869",
    "user": "@videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_226870.json:
```json
{
    "body": "All test passed.",
    "created_at": "2015-04-11T12:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226870",
    "user": "@videlec"
}
```

All test passed.



---

archive/issue_comments_226871.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-14T19:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17057#issuecomment-226871",
    "user": "@vbraun"
}
```

Resolution: fixed
