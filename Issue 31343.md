# Issue 31343: Update matplotlib to 3.4

archive/issues_031343.json:
```json
{
    "body": "CC:  mkoeppe fbissey gh_timokau\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31580\n\n",
    "created_at": "2021-03-30T18:02:58Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Update matplotlib to 3.4",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31343",
    "user": "arojas"
}
```
CC:  mkoeppe fbissey gh_timokau



Issue created by migration from https://trac.sagemath.org/ticket/31580





---

archive/issue_comments_448382.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2021-03-30T18:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448382",
    "user": "arojas"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_448383.json:
```json
{
    "body": "----\nNew commits:",
    "created_at": "2021-03-30T18:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448383",
    "user": "arojas"
}
```

----
New commits:



---

archive/issue_comments_448384.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-30T18:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448384",
    "user": "arojas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_448385.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2021-03-30T18:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448385",
    "user": "arojas"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_448386.json:
```json
{
    "body": "At this stage, I don't think that will make it in 9.3 unless there was something critical about it. That being said, would matplotlib 3.3.x work just as well with that line removed?",
    "created_at": "2021-03-30T19:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448386",
    "user": "fbissey"
}
```

At this stage, I don't think that will make it in 9.3 unless there was something critical about it. That being said, would matplotlib 3.3.x work just as well with that line removed?



---

archive/issue_comments_448387.json:
```json
{
    "body": "Replying to [comment:3 fbissey]:\n> At this stage, I don't think that will make it in 9.3 unless there was something critical about it. That being said, would matplotlib 3.3.x work just as well with that line removed?\n\nSure, I didn't expect it to - just didn't change the default Milestone value. I haven't tested, but given that the line in question didn't have any effect (according to the upstream commit I linked) I don't expect there to be any issues with 3.3.x",
    "created_at": "2021-03-30T19:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448387",
    "user": "arojas"
}
```

Replying to [comment:3 fbissey]:
> At this stage, I don't think that will make it in 9.3 unless there was something critical about it. That being said, would matplotlib 3.3.x work just as well with that line removed?

Sure, I didn't expect it to - just didn't change the default Milestone value. I haven't tested, but given that the line in question didn't have any effect (according to the upstream commit I linked) I don't expect there to be any issues with 3.3.x



---

archive/issue_comments_448388.json:
```json
{
    "body": "I didn't really see your link earlier. Probably a bit too early in the morning for me to process information properly. In any case I was wondering if it would be OK to just squeeze that change in since it is a no-op anyway.",
    "created_at": "2021-03-30T19:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448388",
    "user": "fbissey"
}
```

I didn't really see your link earlier. Probably a bit too early in the morning for me to process information properly. In any case I was wondering if it would be OK to just squeeze that change in since it is a no-op anyway.



---

archive/issue_comments_448389.json:
```json
{
    "body": "Replying to [comment:5 fbissey]:\n> I didn't really see your link earlier. Probably a bit too early in the morning for me to process information properly. In any case I was wondering if it would be OK to just squeeze that change in since it is a no-op anyway.\n\nAs usual, I wrote in the comment box instead of the description. Yes, would be nice to remove that line for 9.3 - would save me some garbage output when doctesting.",
    "created_at": "2021-03-30T21:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448389",
    "user": "arojas"
}
```

Replying to [comment:5 fbissey]:
> I didn't really see your link earlier. Probably a bit too early in the morning for me to process information properly. In any case I was wondering if it would be OK to just squeeze that change in since it is a no-op anyway.

As usual, I wrote in the comment box instead of the description. Yes, would be nice to remove that line for 9.3 - would save me some garbage output when doctesting.



---

archive/issue_comments_448390.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-04-07T19:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448390",
    "user": "mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_448391.json:
```json
{
    "body": "3.4.2 is out",
    "created_at": "2021-05-12T01:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448391",
    "user": "mkoeppe"
}
```

3.4.2 is out



---

archive/issue_comments_448392.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-12T01:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448392",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_448393.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-12T06:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448393",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448394.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-12T06:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448394",
    "user": "arojas"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448395.json:
```json
{
    "body": "LGTM",
    "created_at": "2021-05-12T07:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448395",
    "user": "fbissey"
}
```

LGTM



---

archive/issue_comments_448396.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-12T07:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448396",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_448397.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-05-13T14:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448397",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_448398.json:
```json
{
    "body": "Build tries to download additional source files:\n\n```\n  copying lib/matplotlib/backends/web_backend/all_figures.html -> build/lib.linux-x86_64-3.9/matplotlib/backends/web_backend\n  copying lib/matplotlib/mpl-data/fonts/pdfcorefonts/ZapfDingbats.afm -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/fonts/pdfcorefonts\n  copying lib/matplotlib/mpl-data/fonts/afm/pagd8a.afm -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/fonts/afm\n  copying lib/matplotlib/mpl-data/images/qt4_editor_options.svg -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/images\n  copying lib/matplotlib/mpl-data/images/zoom_to_rect.png -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/images\n  UPDATING build/lib.linux-x86_64-3.9/matplotlib/_version.py\n  set build/lib.linux-x86_64-3.9/matplotlib/_version.py to '3.4.2'\n  running build_ext\n  error: Failed to download any of the following: ['http://www.qhull.org/download/qhull-2020-src-8.0.2.tgz'].  Please download one of these urls and extract it into 'build/' at the top-level of the source repository.\n  Building wheel for matplotlib (setup.py): finished with status 'error'\n  ERROR: Failed building wheel for matplotlib\n```\n",
    "created_at": "2021-05-13T14:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448398",
    "user": "vbraun"
}
```

Build tries to download additional source files:

```
  copying lib/matplotlib/backends/web_backend/all_figures.html -> build/lib.linux-x86_64-3.9/matplotlib/backends/web_backend
  copying lib/matplotlib/mpl-data/fonts/pdfcorefonts/ZapfDingbats.afm -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/fonts/pdfcorefonts
  copying lib/matplotlib/mpl-data/fonts/afm/pagd8a.afm -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/fonts/afm
  copying lib/matplotlib/mpl-data/images/qt4_editor_options.svg -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/images
  copying lib/matplotlib/mpl-data/images/zoom_to_rect.png -> build/lib.linux-x86_64-3.9/matplotlib/mpl-data/images
  UPDATING build/lib.linux-x86_64-3.9/matplotlib/_version.py
  set build/lib.linux-x86_64-3.9/matplotlib/_version.py to '3.4.2'
  running build_ext
  error: Failed to download any of the following: ['http://www.qhull.org/download/qhull-2020-src-8.0.2.tgz'].  Please download one of these urls and extract it into 'build/' at the top-level of the source repository.
  Building wheel for matplotlib (setup.py): finished with status 'error'
  ERROR: Failed building wheel for matplotlib
```




---

archive/issue_comments_448399.json:
```json
{
    "body": "heh, so it looks like it no longer bundles qhull [1] so it will finally have to be made standard. Since this may take a while, I'll split off the sagelib part.\n\n[1] https://github.com/matplotlib/matplotlib/commit/d81d15d368ec8b7fbdd3c0450d7d3ee96641ffe1",
    "created_at": "2021-05-13T18:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448399",
    "user": "arojas"
}
```

heh, so it looks like it no longer bundles qhull [1] so it will finally have to be made standard. Since this may take a while, I'll split off the sagelib part.

[1] https://github.com/matplotlib/matplotlib/commit/d81d15d368ec8b7fbdd3c0450d7d3ee96641ffe1



---

archive/issue_comments_448400.json:
```json
{
    "body": "Done in #31827",
    "created_at": "2021-05-14T19:17:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448400",
    "user": "arojas"
}
```

Done in #31827



---

archive/issue_comments_448401.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-17T10:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448401",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448402.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-07-17T10:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448402",
    "user": "dimpase"
}
```

New commits:



---

archive/issue_comments_448403.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-17T10:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448403",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448404.json:
```json
{
    "body": "tests are running on https://github.com/sagemath/sagetrac-mirror/actions/runs/1040329661",
    "created_at": "2021-07-17T13:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448404",
    "user": "dimpase"
}
```

tests are running on https://github.com/sagemath/sagetrac-mirror/actions/runs/1040329661



---

archive/issue_comments_448405.json:
```json
{
    "body": "I haven't looked at the details, but it looks like our `qhull` package is outdated - https://repology.org/project/qhull/versions",
    "created_at": "2021-07-17T17:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448405",
    "user": "mkoeppe"
}
```

I haven't looked at the details, but it looks like our `qhull` package is outdated - https://repology.org/project/qhull/versions



---

archive/issue_comments_448406.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-07-18T09:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448406",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_448407.json:
```json
{
    "body": "errors about inability to build wheels for mathplotlib.",
    "created_at": "2021-07-18T09:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448407",
    "user": "dimpase"
}
```

errors about inability to build wheels for mathplotlib.



---

archive/issue_comments_448408.json:
```json
{
    "body": "one  needs to unconditionally allow qhull from the system in the python script generat8ng .cfg file.",
    "created_at": "2021-07-18T18:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448408",
    "user": "dimpase"
}
```

one  needs to unconditionally allow qhull from the system in the python script generat8ng .cfg file.



---

archive/issue_comments_448409.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-07-19T11:43:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448409",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_448410.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-07-19T13:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448410",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_448411.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-19T13:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448411",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448412.json:
```json
{
    "body": "OK, this should fix the issue. TOX tests on\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/1045348934",
    "created_at": "2021-07-19T13:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448412",
    "user": "dimpase"
}
```

OK, this should fix the issue. TOX tests on
https://github.com/sagemath/sagetrac-mirror/actions/runs/1045348934



---

archive/issue_comments_448413.json:
```json
{
    "body": "There is a race condition in docbuild which leads to this GH Actions run erroring out on many systems, as follows:\n\n```\n  [dochtml]   [reference]     topology: 1937 js index entries\n  [dochtml]   [reference]     valuations: 973 js index entries\n  [dochtml]   [reference] ... done (64387 js index entries)\n  [dochtml]   [reference] copying static files... failed\n  [dochtml]   [reference] WARNING: cannot copy static file FileExistsError(17, 'File exists')\n  [dochtml]   [reference] dumping search index in English (code: en)... done\n  [dochtml]   [reference] The HTML pages are in .tox/local-homebrew-macos-standard/local/share/doc/sage/html/en/reference.\n  [dochtml]   Error building the documentation.\n  [dochtml]   Traceback (most recent call last):\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/homebrew/Cellar/python@3.9/3.9.6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 197, in _run_module_as_main\n  [dochtml]       return _run_code(code, main_globals, None,\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/homebrew/Cellar/python@3.9/3.9.6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 87, in _run_code\n  [dochtml]       exec(code, run_globals)\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/__main__.py\", line 2, in <module>\n  [dochtml]       main()\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/__init__.py\", line 1813, in main\n  [dochtml]       builder()\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/__init__.py\", line 133, in f\n  [dochtml]       runsphinx()\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py\", line 323, in runsphinx\n  [dochtml]       sys.stderr.raise_errors()\n  [dochtml]     File \"/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py\", line 258, in raise_errors\n  [dochtml]       raise OSError(self._error)\n  [dochtml]   OSError: WARNING: cannot copy static file FileExistsError(17, 'File exists')\n  [dochtml]   \n  [dochtml]       Note: incremental documentation builds sometimes cause spurious\n  [dochtml]       error messages. To be certain that these are real errors, run\n  [dochtml]       \"make doc-clean\" first and try again.\n  [dochtml]   make[3]: *** [doc-html--reference_top] Error 1\n  [dochtml]   make[2]: *** [doc-html-reference] Error 2\n  [dochtml]   make[2]: Target `doc-html' not remade because of errors.\n  [dochtml] Full log file: /Users/runner/work/sagetrac-mirror/sagetrac-mirror/logs/dochtml.log\nmake[1]: *** [doc-html] Error 2\n```\n\n\nthis was altready reported on https://groups.google.com/g/sage-devel/c/ts6u19KpapA/m/22BdxXZhBAAJ",
    "created_at": "2021-07-20T09:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448413",
    "user": "dimpase"
}
```

There is a race condition in docbuild which leads to this GH Actions run erroring out on many systems, as follows:

```
  [dochtml]   [reference]     topology: 1937 js index entries
  [dochtml]   [reference]     valuations: 973 js index entries
  [dochtml]   [reference] ... done (64387 js index entries)
  [dochtml]   [reference] copying static files... failed
  [dochtml]   [reference] WARNING: cannot copy static file FileExistsError(17, 'File exists')
  [dochtml]   [reference] dumping search index in English (code: en)... done
  [dochtml]   [reference] The HTML pages are in .tox/local-homebrew-macos-standard/local/share/doc/sage/html/en/reference.
  [dochtml]   Error building the documentation.
  [dochtml]   Traceback (most recent call last):
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/homebrew/Cellar/python@3.9/3.9.6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
  [dochtml]       return _run_code(code, main_globals, None,
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/homebrew/Cellar/python@3.9/3.9.6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
  [dochtml]       exec(code, run_globals)
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/__main__.py", line 2, in <module>
  [dochtml]       main()
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/__init__.py", line 1813, in main
  [dochtml]       builder()
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/__init__.py", line 133, in f
  [dochtml]       runsphinx()
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 323, in runsphinx
  [dochtml]       sys.stderr.raise_errors()
  [dochtml]     File "/Users/runner/work/sagetrac-mirror/sagetrac-mirror/.tox/local-homebrew-macos-standard/local/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 258, in raise_errors
  [dochtml]       raise OSError(self._error)
  [dochtml]   OSError: WARNING: cannot copy static file FileExistsError(17, 'File exists')
  [dochtml]   
  [dochtml]       Note: incremental documentation builds sometimes cause spurious
  [dochtml]       error messages. To be certain that these are real errors, run
  [dochtml]       "make doc-clean" first and try again.
  [dochtml]   make[3]: *** [doc-html--reference_top] Error 1
  [dochtml]   make[2]: *** [doc-html-reference] Error 2
  [dochtml]   make[2]: Target `doc-html' not remade because of errors.
  [dochtml] Full log file: /Users/runner/work/sagetrac-mirror/sagetrac-mirror/logs/dochtml.log
make[1]: *** [doc-html] Error 2
```


this was altready reported on https://groups.google.com/g/sage-devel/c/ts6u19KpapA/m/22BdxXZhBAAJ



---

archive/issue_comments_448414.json:
```json
{
    "body": "From #32262:\n\nReplying to [comment:8 dimpase]:\n> Replying to [comment:5 klee]:\n> > What is the command to reproduce the bug?\n> try building the branch of #31580 with `make -jX` (for X=8, say?) on macOS or Ubuntu.\n> \n\nBuilding fails with me:\n\n```\n[matplotlib-3.4.2] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/matplotlib/matplotlib-3.4.2.tar.gz'\n[matplotlib-3.4.2] ************************************************************************\n[matplotlib-3.4.2] Traceback (most recent call last):\n...\n[matplotlib-3.4.2]     raise FileNotMirroredError('tarball does not exist on mirror network')\n[matplotlib-3.4.2] FileNotMirroredError: tarball does not exist on mirror network\n```\n",
    "created_at": "2021-07-22T08:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448414",
    "user": "klee"
}
```

From #32262:

Replying to [comment:8 dimpase]:
> Replying to [comment:5 klee]:
> > What is the command to reproduce the bug?
> try building the branch of #31580 with `make -jX` (for X=8, say?) on macOS or Ubuntu.
> 

Building fails with me:

```
[matplotlib-3.4.2] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/matplotlib/matplotlib-3.4.2.tar.gz'
[matplotlib-3.4.2] ************************************************************************
[matplotlib-3.4.2] Traceback (most recent call last):
...
[matplotlib-3.4.2]     raise FileNotMirroredError('tarball does not exist on mirror network')
[matplotlib-3.4.2] FileNotMirroredError: tarball does not exist on mirror network
```




---

archive/issue_comments_448415.json:
```json
{
    "body": "Of course the tarballs are not on the mirrors yet, this only happens after the ticket is merged etc.\n You need to\n\n```\n./configure --enable-download-from-upstream-url\n```\n\nThen the URLs in checksum.ini files will be used if nothing is found on the mirrors.\nDue to this feature (crucial for CI), nobody lists explicit tarballs in ticket descriptions any more.\n \n(Or look at checksum.ini, find the URL, manually upload the tarfile to upstream/)",
    "created_at": "2021-07-22T08:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448415",
    "user": "dimpase"
}
```

Of course the tarballs are not on the mirrors yet, this only happens after the ticket is merged etc.
 You need to

```
./configure --enable-download-from-upstream-url
```

Then the URLs in checksum.ini files will be used if nothing is found on the mirrors.
Due to this feature (crucial for CI), nobody lists explicit tarballs in ticket descriptions any more.
 
(Or look at checksum.ini, find the URL, manually upload the tarfile to upstream/)



---

archive/issue_comments_448416.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-07-28T10:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448416",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_448417.json:
```json
{
    "body": "3.4.3 is out",
    "created_at": "2021-09-07T23:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448417",
    "user": "mkoeppe"
}
```

3.4.3 is out



---

archive/issue_comments_448418.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-09-08T12:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448418",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_448419.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-08T13:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448419",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448420.json:
```json
{
    "body": "updated to 3.4.3.",
    "created_at": "2021-09-08T13:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448420",
    "user": "dimpase"
}
```

updated to 3.4.3.



---

archive/issue_comments_448421.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-09-14T09:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448421",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_448422.json:
```json
{
    "body": "rebased over 9.5.beta1",
    "created_at": "2021-09-14T09:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448422",
    "user": "dimpase"
}
```

rebased over 9.5.beta1



---

archive/issue_comments_448423.json:
```json
{
    "body": "tests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1233039865",
    "created_at": "2021-09-14T09:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448423",
    "user": "dimpase"
}
```

tests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1233039865



---

archive/issue_comments_448424.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-09-14T10:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448424",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_448425.json:
```json
{
    "body": "Replying to [comment:40 dimpase]:\n> tests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1233039865\n\n> should be https://github.com/sagemath/sagetrac-mirror/actions/runs/1233224818\n\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/1235471874",
    "created_at": "2021-09-14T10:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448425",
    "user": "dimpase"
}
```

Replying to [comment:40 dimpase]:
> tests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1233039865

> should be https://github.com/sagemath/sagetrac-mirror/actions/runs/1233224818

https://github.com/sagemath/sagetrac-mirror/actions/runs/1235471874



---

archive/issue_comments_448426.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-09-14T22:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448426",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_448427.json:
```json
{
    "body": "tests are done, please have a look",
    "created_at": "2021-09-19T10:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448427",
    "user": "dimpase"
}
```

tests are done, please have a look



---

archive/issue_comments_448428.json:
```json
{
    "body": "Also the dependencies of matplotlib: `cycler`, `kiwisolver`, ... are outdated",
    "created_at": "2021-11-08T05:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448428",
    "user": "mkoeppe"
}
```

Also the dependencies of matplotlib: `cycler`, `kiwisolver`, ... are outdated



---

archive/issue_comments_448429.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-11-16T15:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448429",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_448430.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-16T15:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448430",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448431.json:
```json
{
    "body": "and more new deps are coming, such as cppy... hold tight",
    "created_at": "2021-11-16T16:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448431",
    "user": "dimpase"
}
```

and more new deps are coming, such as cppy... hold tight



---

archive/issue_comments_448432.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-11-16T16:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448432",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_448433.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-16T16:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448433",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448434.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-11-16T17:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448434",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_448435.json:
```json
{
    "body": "`cppy` is missing `SPKG.rst`.  Consider using `sage --package create --pypi cppy` to create packages...",
    "created_at": "2021-11-16T17:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448435",
    "user": "mkoeppe"
}
```

`cppy` is missing `SPKG.rst`.  Consider using `sage --package create --pypi cppy` to create packages...



---

archive/issue_comments_448436.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-16T17:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448436",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448437.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-16T17:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448437",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448438.json:
```json
{
    "body": "Let's get rid of these \"Dependencies\" sections in SPKG.rst please if they just duplicate what's in the `dependencies` file.",
    "created_at": "2021-11-16T17:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448438",
    "user": "mkoeppe"
}
```

Let's get rid of these "Dependencies" sections in SPKG.rst please if they just duplicate what's in the `dependencies` file.



---

archive/issue_comments_448439.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-11-16T17:53:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448439",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_448440.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2021-11-16T17:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448440",
    "user": "dimpase"
}
```

New commits:
----
New commits:



---

archive/issue_comments_448441.json:
```json
{
    "body": "\n```\ndiff --git a/build/pkgs/_prereq/distros/debian.txt b/build/pkgs/_prereq/distros/debian.txt\nindex 50be6ac..c348ee3 100644\n--- a/build/pkgs/_prereq/distros/debian.txt\n+++ b/build/pkgs/_prereq/distros/debian.txt\n@@ -26,5 +26,6 @@ gcc\n # configure: error: in `/sage':\n # configure: error: C++ preprocessor \"/lib/cpp\" fails sanity check\n g++\n+gfortran\n # Needed if we download some packages from a https upstream URL\n ca-certificates\n```\n\n\nPlease don't sneak these changes in.",
    "created_at": "2021-11-16T17:54:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448441",
    "user": "mkoeppe"
}
```


```
diff --git a/build/pkgs/_prereq/distros/debian.txt b/build/pkgs/_prereq/distros/debian.txt
index 50be6ac..c348ee3 100644
--- a/build/pkgs/_prereq/distros/debian.txt
+++ b/build/pkgs/_prereq/distros/debian.txt
@@ -26,5 +26,6 @@ gcc
 # configure: error: in `/sage':
 # configure: error: C++ preprocessor "/lib/cpp" fails sanity check
 g++
+gfortran
 # Needed if we download some packages from a https upstream URL
 ca-certificates
```


Please don't sneak these changes in.



---

archive/issue_comments_448442.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-11-16T17:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448442",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_448443.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-16T17:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448443",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448444.json:
```json
{
    "body": "oops, sorry, should be OK now.",
    "created_at": "2021-11-16T17:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448444",
    "user": "dimpase"
}
```

oops, sorry, should be OK now.



---

archive/issue_comments_448445.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-16T17:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448445",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448446.json:
```json
{
    "body": "\n```\n--- a/build/pkgs/cycler/checksums.ini\n+++ b/build/pkgs/cycler/checksums.ini\n@@ -1,4 +1,5 @@\n tarball=cycler-VERSION.tar.gz\n-sha1=1bcf4a985a5f414333603f3f70a7deebbaf30439\n-md5=4cb42917ac5007d1cdff6cccfe2d016b\n-cksum=4189438538\n+sha1=ea144185cf1d54d7415e3c66d705d9a232e57da5\n+md5=cf3b4846fded12fa4d2a7a291a5d6e13\n+cksum=3626319704\n+upstream_url=https://github.com/matplotlib/cycler/archive/refs/tags/vVERSION.tar.gz\n```\n\n\nPlease use PyPI URL, not a github archive",
    "created_at": "2021-11-16T18:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448446",
    "user": "mkoeppe"
}
```


```
--- a/build/pkgs/cycler/checksums.ini
+++ b/build/pkgs/cycler/checksums.ini
@@ -1,4 +1,5 @@
 tarball=cycler-VERSION.tar.gz
-sha1=1bcf4a985a5f414333603f3f70a7deebbaf30439
-md5=4cb42917ac5007d1cdff6cccfe2d016b
-cksum=4189438538
+sha1=ea144185cf1d54d7415e3c66d705d9a232e57da5
+md5=cf3b4846fded12fa4d2a7a291a5d6e13
+cksum=3626319704
+upstream_url=https://github.com/matplotlib/cycler/archive/refs/tags/vVERSION.tar.gz
```


Please use PyPI URL, not a github archive



---

archive/issue_comments_448447.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-16T18:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448447",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_448448.json:
```json
{
    "body": "In the meantime, 3.5 is released with new dependencies (fonttools) and new deprecations. I've opened #32909 to fix these.",
    "created_at": "2021-11-20T09:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448448",
    "user": "arojas"
}
```

In the meantime, 3.5 is released with new dependencies (fonttools) and new deprecations. I've opened #32909 to fix these.



---

archive/issue_comments_448449.json:
```json
{
    "body": "OK, so can this ticket get in, please?",
    "created_at": "2021-11-21T12:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448449",
    "user": "dimpase"
}
```

OK, so can this ticket get in, please?



---

archive/issue_comments_448450.json:
```json
{
    "body": "Note that matplotlib 3.5 is needed to avoid distutils deprecation warnings with python 3.10 (see #30766#comment:68).\n\nThe actual commit fixing the deprecation warning is https://github.com/matplotlib/matplotlib/commit/7d77bb96707f10032d8fedf2bd225491f9a28afe",
    "created_at": "2021-12-16T23:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448450",
    "user": "tornaria"
}
```

Note that matplotlib 3.5 is needed to avoid distutils deprecation warnings with python 3.10 (see #30766#comment:68).

The actual commit fixing the deprecation warning is https://github.com/matplotlib/matplotlib/commit/7d77bb96707f10032d8fedf2bd225491f9a28afe



---

archive/issue_comments_448451.json:
```json
{
    "body": "Are we aiming at a full support of Python 3.10 in 9.5? If so, I guess we should go straight to matplotlib 3.5.",
    "created_at": "2021-12-17T11:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448451",
    "user": "dimpase"
}
```

Are we aiming at a full support of Python 3.10 in 9.5? If so, I guess we should go straight to matplotlib 3.5.



---

archive/issue_comments_448452.json:
```json
{
    "body": "Replying to [comment:70 dimpase]:\n> Are we aiming at a full support of Python 3.10 in 9.5? \n\nNot sure if we can/should. I think it's better to have a release very soon because of the glibc 2.34 issue (#32576), which lots of people are already running into.",
    "created_at": "2021-12-17T16:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448452",
    "user": "mkoeppe"
}
```

Replying to [comment:70 dimpase]:
> Are we aiming at a full support of Python 3.10 in 9.5? 

Not sure if we can/should. I think it's better to have a release very soon because of the glibc 2.34 issue (#32576), which lots of people are already running into.



---

archive/issue_comments_448453.json:
```json
{
    "body": "Replying to [comment:69 tornaria]:\n> Note that matplotlib 3.5 is needed to avoid distutils deprecation warnings with python 3.10 \n\nOpened #33040 for this",
    "created_at": "2021-12-17T16:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448453",
    "user": "mkoeppe"
}
```

Replying to [comment:69 tornaria]:
> Note that matplotlib 3.5 is needed to avoid distutils deprecation warnings with python 3.10 

Opened #33040 for this



---

archive/issue_comments_448454.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-17T16:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448454",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_448455.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-12-17T16:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448455",
    "user": "mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_448456.json:
```json
{
    "body": "On OSX:\n\n```\n**********************************************************************\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 380, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples\nFailed example:\n    list_plot3d(m, color='yellow', interpolation_type='linear', num_points=5) # indirect doctest\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.plot3d.list_plot3d.list_plot3d_tuples[2]>\", line 1, in <module>\n        list_plot3d(m, color='yellow', interpolation_type='linear', num_points=Integer(5)) # indirect doctest\n      File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/plot/plot3d/list_plot3d.py\", line 188, in list_plot3d\n        return list_plot3d_tuples(data, interpolation_type, **kwds)\n      File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/plot/plot3d/list_plot3d.py\", line 453, in list_plot3d_tuples\n        T = tri.Triangulation(x, y)\n      File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/matplotlib/tri/triangulation.py\", line 39, in __init__\n        from matplotlib import _qhull\n    ImportError: dlopen(/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/matplotlib/_qhull.cpython-39-darwin.so, 2): Library not loaded: lib/libqhull_r.8.0.dylib\n      Referenced from: /Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/matplotlib/_qhull.cpython-39-darwin.so\n      Reason: image not found\n**********************************************************************\n1 item had failures:\n   1 of   7 in sage.plot.plot3d.list_plot3d.list_plot3d_tuples\n    [48 tests, 1 failure, 4.36 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=269285139450068045496865355624462748906 src/sage/plot/plot3d/list_plot3d.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n",
    "created_at": "2021-12-20T00:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448456",
    "user": "vbraun"
}
```

On OSX:

```
**********************************************************************
File "src/sage/plot/plot3d/list_plot3d.py", line 380, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples
Failed example:
    list_plot3d(m, color='yellow', interpolation_type='linear', num_points=5) # indirect doctest
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.plot3d.list_plot3d.list_plot3d_tuples[2]>", line 1, in <module>
        list_plot3d(m, color='yellow', interpolation_type='linear', num_points=Integer(5)) # indirect doctest
      File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/plot/plot3d/list_plot3d.py", line 188, in list_plot3d
        return list_plot3d_tuples(data, interpolation_type, **kwds)
      File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/plot/plot3d/list_plot3d.py", line 453, in list_plot3d_tuples
        T = tri.Triangulation(x, y)
      File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/matplotlib/tri/triangulation.py", line 39, in __init__
        from matplotlib import _qhull
    ImportError: dlopen(/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/matplotlib/_qhull.cpython-39-darwin.so, 2): Library not loaded: lib/libqhull_r.8.0.dylib
      Referenced from: /Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/matplotlib/_qhull.cpython-39-darwin.so
      Reason: image not found
**********************************************************************
1 item had failures:
   1 of   7 in sage.plot.plot3d.list_plot3d.list_plot3d_tuples
    [48 tests, 1 failure, 4.36 s]
----------------------------------------------------------------------
sage -t --long --random-seed=269285139450068045496865355624462748906 src/sage/plot/plot3d/list_plot3d.py  # 1 doctest failed
----------------------------------------------------------------------
```




---

archive/issue_comments_448457.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-12-20T00:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448457",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_448458.json:
```json
{
    "body": "Looks like some wrong `install_name` was used on that `qhull` install. Is `qhull` supposed to come from conda, brew or sage internals on OSX during those testruns?\n\nIt is a bit strange it wasn't seen before.",
    "created_at": "2021-12-20T00:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448458",
    "user": "fbissey"
}
```

Looks like some wrong `install_name` was used on that `qhull` install. Is `qhull` supposed to come from conda, brew or sage internals on OSX during those testruns?

It is a bit strange it wasn't seen before.



---

archive/issue_comments_448459.json:
```json
{
    "body": "OK, `qhull` used to be optional and has been switched to standard with this release. Unfortunately boiler plate `sdh_cmake` doesn't set `install_name` properly for qhull. I am not sure how it all install in the proper places but to get the right `rpath` and `install_name`, `-DLIB_INSTALL_DIR=...` has to be passed to camke when configuring.\n\nI'll fix that ASAP. This would affect the further upgrade to 3.5.1.",
    "created_at": "2021-12-20T01:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448459",
    "user": "fbissey"
}
```

OK, `qhull` used to be optional and has been switched to standard with this release. Unfortunately boiler plate `sdh_cmake` doesn't set `install_name` properly for qhull. I am not sure how it all install in the proper places but to get the right `rpath` and `install_name`, `-DLIB_INSTALL_DIR=...` has to be passed to camke when configuring.

I'll fix that ASAP. This would affect the further upgrade to 3.5.1.



---

archive/issue_comments_448460.json:
```json
{
    "body": "Should work now.\n----\nNew commits:",
    "created_at": "2021-12-20T01:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448460",
    "user": "fbissey"
}
```

Should work now.
----
New commits:



---

archive/issue_comments_448461.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-12-20T01:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448461",
    "user": "fbissey"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448462.json:
```json
{
    "body": "Also `cppy` is missing `install-requires.txt`.",
    "created_at": "2021-12-20T02:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448462",
    "user": "mkoeppe"
}
```

Also `cppy` is missing `install-requires.txt`.



---

archive/issue_comments_448463.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-12-20T02:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448463",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_448464.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-12-20T03:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448464",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_448465.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-12-20T03:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448465",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_448466.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-20T03:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448466",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_448467.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-28T21:15:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31343#issuecomment-448467",
    "user": "vbraun"
}
```

Resolution: fixed
