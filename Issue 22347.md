# Issue 22347: Debug build doctests fail with sig_block() with sig_on_count = 1, block_sigint = 1

archive/issues_022347.json:
```json
{
    "body": "CC:  jdemeyer\n\nKeywords: cysignals\n\nLots of doctests fail in a SAGE_DEBUG=yes build similar to:\n\n```\nFile \"src/sage/schemes/elliptic_curves/ell_number_field.py\", line 578, in sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix\nFailed example:\n    E.regulator_of_points([P,Q])\nExpected:\n    0.164101403936070\nGot:\n    <BLANKLINE>\n    *** WARNING *** sig_block() with sig_on_count = 1, block_sigint = 1\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals/signals.so(+0x4558)[0x7f0e6622f558]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x2357)[0x7f0e59e96357]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x2b0c)[0x7f0e59e96b0c]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x255b)[0x7f0e59e9655b]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x2923)[0x7f0e59e96923]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/handle_error.so(+0x63a3)[0x7f0e59a7f3a3]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(pari_err+0x15c)[0x7f0e65e19efd]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(+0x284239)[0x7f0e65c14239]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(checkell_Fq+0x5b)[0x7f0e65c14c90]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(ellorder+0x18a)[0x7f0e65c5415c]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/gen.so(+0x70ca3)[0x7f0e5a320ca3]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/gen.so(+0x708fa)[0x7f0e5a3208fa]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(PyCFunction_Call+0xbc)[0x7f0e731d5ba0]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(+0x162813)[0x7f0e73281813]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0xb8ce)[0x7f0e7327bdbe]\n    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x113f)[0x7f0e7327ed28]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22584\n\n",
    "created_at": "2017-03-11T17:26:23Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Debug build doctests fail with sig_block() with sig_on_count = 1, block_sigint = 1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22347",
    "user": "vbraun"
}
```
CC:  jdemeyer

Keywords: cysignals

Lots of doctests fail in a SAGE_DEBUG=yes build similar to:

```
File "src/sage/schemes/elliptic_curves/ell_number_field.py", line 578, in sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix
Failed example:
    E.regulator_of_points([P,Q])
Expected:
    0.164101403936070
Got:
    <BLANKLINE>
    *** WARNING *** sig_block() with sig_on_count = 1, block_sigint = 1
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals/signals.so(+0x4558)[0x7f0e6622f558]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x2357)[0x7f0e59e96357]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x2b0c)[0x7f0e59e96b0c]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x255b)[0x7f0e59e9655b]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/stack.so(+0x2923)[0x7f0e59e96923]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/handle_error.so(+0x63a3)[0x7f0e59a7f3a3]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(pari_err+0x15c)[0x7f0e65e19efd]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(+0x284239)[0x7f0e65c14239]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(checkell_Fq+0x5b)[0x7f0e65c14c90]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpari-gmp.so.5(ellorder+0x18a)[0x7f0e65c5415c]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/gen.so(+0x70ca3)[0x7f0e5a320ca3]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/libs/cypari2/gen.so(+0x708fa)[0x7f0e5a3208fa]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(PyCFunction_Call+0xbc)[0x7f0e731d5ba0]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(+0x162813)[0x7f0e73281813]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0xb8ce)[0x7f0e7327bdbe]
    /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x113f)[0x7f0e7327ed28]
```


Issue created by migration from https://trac.sagemath.org/ticket/22584





---

archive/issue_comments_310710.json:
```json
{
    "body": "Volker: please merge this in the next beta. The plan is to split off `src/sage/libs/cypari2` as a separate package and I would like to do this on top of 8.0.beta0\n----\nNew commits:",
    "created_at": "2017-03-28T13:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22347#issuecomment-310710",
    "user": "jdemeyer"
}
```

Volker: please merge this in the next beta. The plan is to split off `src/sage/libs/cypari2` as a separate package and I would like to do this on top of 8.0.beta0
----
New commits:



---

archive/issue_comments_310711.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-28T13:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22347#issuecomment-310711",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_310712.json:
```json
{
    "body": "This fixes *most* errors of this form, but not all. There is still an issue in `closure.pyx`. But that will require changes to cysignals itself, so the fix is not so simple.",
    "created_at": "2017-03-28T14:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22347#issuecomment-310712",
    "user": "jdemeyer"
}
```

This fixes *most* errors of this form, but not all. There is still an issue in `closure.pyx`. But that will require changes to cysignals itself, so the fix is not so simple.



---

archive/issue_comments_310713.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-28T15:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22347#issuecomment-310713",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_310714.json:
```json
{
    "body": "Is there an issue open in cysignals?",
    "created_at": "2017-03-28T15:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22347#issuecomment-310714",
    "user": "vdelecroix"
}
```

Is there an issue open in cysignals?



---

archive/issue_comments_310715.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-30T22:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22347#issuecomment-310715",
    "user": "vbraun"
}
```

Resolution: fixed
