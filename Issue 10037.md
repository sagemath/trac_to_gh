# Issue 10037: Wrap Maxima's  demoivre and exponentialize

archive/issues_010037.json:
```json
{
    "body": "Assignee: @burcin\n\nCC:  @kcrisman fmaltey @slel\n\nSage does not appear to have easily accesible analogues of Mathematica's `TrigToExp` and `ExpToTrig`.  From [AskSage](http://ask.sagemath.org/question/148/complex-exponentialtrigonometric#comment-587):\n\n```python\nsage: x = var('x')\nsage: t1 = cos(x)\nsage: t2 = e^(I * x) / 2 / I - e^(-I * x) / 2 / I\nsage: sageobj(t1._maxima_().exponentialize())\n1/2*e^(-I*x) + 1/2*e^(I*x)\nsage: sageobj(t2._maxima_().demoivre())\nsin(x)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10038\n\n",
    "created_at": "2010-09-30T03:09:23Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Wrap Maxima's  demoivre and exponentialize",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10037",
    "user": "https://github.com/qed777"
}
```
Assignee: @burcin

CC:  @kcrisman fmaltey @slel

Sage does not appear to have easily accesible analogues of Mathematica's `TrigToExp` and `ExpToTrig`.  From [AskSage](http://ask.sagemath.org/question/148/complex-exponentialtrigonometric#comment-587):

```python
sage: x = var('x')
sage: t1 = cos(x)
sage: t2 = e^(I * x) / 2 / I - e^(-I * x) / 2 / I
sage: sageobj(t1._maxima_().exponentialize())
1/2*e^(-I*x) + 1/2*e^(I*x)
sage: sageobj(t2._maxima_().demoivre())
sin(x)
```


Issue created by migration from https://trac.sagemath.org/ticket/10038





---

archive/issue_comments_100719.json:
```json
{
    "body": "You can use `maxima_methods()` to access the maxima functions easily.\n\n\n```\nsage: x = var('x')\nsage: t1 = cos(x)\nsage: t2 = e^(I * x) / 2 / I - e^(-I * x) / 2 / I\nsage: res = t1.maxima_methods().exponentialize(); res\n1/2*e^(-I*x) + 1/2*e^(I*x)\nsage: type(res)\n<type 'sage.symbolic.expression.Expression'>\nsage: t2.maxima_methods().demoivre()\nsin(x)\n```\n\n\nI am very much against wrapping each maxima function for manipulating symbolic expressions individually from Sage. Even though maxima provides a lot of functionality, their user interface is far from intuitive. \n\nIMHO, the user interface to these functions should be something like:\n\n\n```\nsage: t1.rewrite(exp)\n1/2*e^(-I*x) + 1/2*e^(I*x)\nsage: t2.rewrite(sin)\nsin(x)\n```\n\n\n\nBTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on maxima. It's possible that this requires wrapping more of pynac's features, for example\n\n* http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and\n* http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html\n\nbut it's well worth the effort.",
    "created_at": "2010-10-01T15:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100719",
    "user": "https://github.com/burcin"
}
```

You can use `maxima_methods()` to access the maxima functions easily.


```
sage: x = var('x')
sage: t1 = cos(x)
sage: t2 = e^(I * x) / 2 / I - e^(-I * x) / 2 / I
sage: res = t1.maxima_methods().exponentialize(); res
1/2*e^(-I*x) + 1/2*e^(I*x)
sage: type(res)
<type 'sage.symbolic.expression.Expression'>
sage: t2.maxima_methods().demoivre()
sin(x)
```


I am very much against wrapping each maxima function for manipulating symbolic expressions individually from Sage. Even though maxima provides a lot of functionality, their user interface is far from intuitive. 

IMHO, the user interface to these functions should be something like:


```
sage: t1.rewrite(exp)
1/2*e^(-I*x) + 1/2*e^(I*x)
sage: t2.rewrite(sin)
sin(x)
```



BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on maxima. It's possible that this requires wrapping more of pynac's features, for example

* http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and
* http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html

but it's well worth the effort.



---

archive/issue_comments_100720.json:
```json
{
    "body": "Replying to [comment:1 burcin]:\n> You can use `maxima_methods()` to access the maxima functions easily.\n> \nYes, thanks for that reminder!\n> I am very much against wrapping each maxima function for manipulating symbolic expressions individually from Sage. Even though maxima provides a lot of functionality, their user interface is far from intuitive. \n\nI don't see why we can't provide a more intuitive user interface for some of them, though.  Just because a ticket is opened doesn't mean it will ever be fulfilled, but at least it's here now if enough people want it.\n> IMHO, the user interface to these functions should be something like:\n> \n> {{{\n> sage: t1.rewrite(exp)\n> 1/2*e^(-I*x) + 1/2*e^(I*x)\n> sage: t2.rewrite(sin)\n> sin(x)\n> }}}\nThis seems awkward, esp. if you don't know ahead of time whether it's sin or cos. I think that `simplify_*` makes sense, the way we have it now.  For now it's not worth having the discussion - I doubt anyone has time to do this right now.  But if someone does, maybe it's time to revisit that.\n> BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on \nYes, of course.   If only we could have that Sage Days solely about symbolics...\n> \n>  * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and\n>  * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html\n> \n> but it's well worth the effort.",
    "created_at": "2010-10-01T15:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100720",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:1 burcin]:
> You can use `maxima_methods()` to access the maxima functions easily.
> 
Yes, thanks for that reminder!
> I am very much against wrapping each maxima function for manipulating symbolic expressions individually from Sage. Even though maxima provides a lot of functionality, their user interface is far from intuitive. 

I don't see why we can't provide a more intuitive user interface for some of them, though.  Just because a ticket is opened doesn't mean it will ever be fulfilled, but at least it's here now if enough people want it.
> IMHO, the user interface to these functions should be something like:
> 
> {{{
> sage: t1.rewrite(exp)
> 1/2*e^(-I*x) + 1/2*e^(I*x)
> sage: t2.rewrite(sin)
> sin(x)
> }}}
This seems awkward, esp. if you don't know ahead of time whether it's sin or cos. I think that `simplify_*` makes sense, the way we have it now.  For now it's not worth having the discussion - I doubt anyone has time to do this right now.  But if someone does, maybe it's time to revisit that.
> BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on 
Yes, of course.   If only we could have that Sage Days solely about symbolics...
> 
>  * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and
>  * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html
> 
> but it's well worth the effort.



---

archive/issue_comments_100721.json:
```json
{
    "body": "Changing keywords from \"\" to \"expression tree\".",
    "created_at": "2021-08-05T21:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100721",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "expression tree".



---

archive/issue_comments_100722.json:
```json
{
    "body": "Replying to [comment:1 burcin]:\n>\n> BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on maxima. It's possible that this requires wrapping more of pynac's features, for example\n> \n>  * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and\n>  * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html\n> \n> but it's well worth the effort.\n\nThe links seem to have slightly changed:\n\n- https://www.ginac.de/tutorial/#Applying-a-function-on-subexpressions\n- https://www.ginac.de/tutorial/#Visitors-and-tree-traversal",
    "created_at": "2021-08-05T21:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100722",
    "user": "https://github.com/slel"
}
```

Replying to [comment:1 burcin]:
>
> BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on maxima. It's possible that this requires wrapping more of pynac's features, for example
> 
>  * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and
>  * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html
> 
> but it's well worth the effort.

The links seem to have slightly changed:

- https://www.ginac.de/tutorial/#Applying-a-function-on-subexpressions
- https://www.ginac.de/tutorial/#Visitors-and-tree-traversal



---

archive/issue_comments_100723.json:
```json
{
    "body": "Replying to [comment:8 charpent]:\n\nEleven years later, it seems obvious that no one ever undertook to wrap Pynac's tree traversal utilities. However, the `expressionTreeWalker` class offers means to implement such utilities not too painfully.\n\nThis proposal passes `ptestlong` with no new failures.\n\n==>`needs_review`\n----\nNew commits:",
    "created_at": "2021-08-12T13:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100723",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:8 charpent]:

Eleven years later, it seems obvious that no one ever undertook to wrap Pynac's tree traversal utilities. However, the `expressionTreeWalker` class offers means to implement such utilities not too painfully.

This proposal passes `ptestlong` with no new failures.

==>`needs_review`
----
New commits:



---

archive/issue_comments_100724.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-12T13:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100724",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_100725.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-08-17T21:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100725",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_100726.json:
```json
{
    "body": "Wups. A nice typo : `_init__` for `__init__`...\n\n==> `needs_work`.",
    "created_at": "2021-08-17T21:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100726",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Wups. A nice typo : `_init__` for `__init__`...

==> `needs_work`.



---

archive/issue_comments_100727.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-17T21:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100727",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_100728.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-17T21:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100728",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_100729.json:
```json
{
    "body": "Typo fixed ==>`needs_review`.",
    "created_at": "2021-08-17T21:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100729",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Typo fixed ==>`needs_review`.



---

archive/issue_comments_100730.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-08-18T08:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100730",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_100731.json:
```json
{
    "body": "One doctest (src/sage/doctest/sources.py) fails.",
    "created_at": "2021-08-18T08:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100731",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

One doctest (src/sage/doctest/sources.py) fails.



---

archive/issue_comments_100732.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-18T09:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100732",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_100733.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-18T09:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100733",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_100734.json:
```json
{
    "body": "New patchbot attempt ==>`needs_review`",
    "created_at": "2021-08-18T09:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100734",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

New patchbot attempt ==>`needs_review`



---

archive/issue_comments_100735.json:
```json
{
    "body": "A few little things:\n\nIt would be good to use Sage's doc conventions:\n\n```diff\n-        \"\"\"Returns this sumbolic expression with all circular and hyperbolic\n+        \"\"\"\n+        Return this sumbolic expression with all circular and hyperbolic\n         functions replaced by their respective exponential\n         expressions.\n```\n\n\n`Exponentialize.__init__` is missing a doctest.\n\nThe import here\n\n```\n    def demoivre(self, force=False):\n        from sage.symbolic.expression_conversions import DeMoivre\n        \"\"\"\n```\n\nshould go after the docstring (which probably is not being picked up as a docstring but instead just a string being created within the function).\n\n\n```diff\n-return op(*[self(_) for _ in ex.operands()])\n+return op(*[self(oper) for oper in ex.operands()])\n```\n",
    "created_at": "2021-08-23T00:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100735",
    "user": "https://github.com/tscrim"
}
```

A few little things:

It would be good to use Sage's doc conventions:

```diff
-        """Returns this sumbolic expression with all circular and hyperbolic
+        """
+        Return this sumbolic expression with all circular and hyperbolic
         functions replaced by their respective exponential
         expressions.
```


`Exponentialize.__init__` is missing a doctest.

The import here

```
    def demoivre(self, force=False):
        from sage.symbolic.expression_conversions import DeMoivre
        """
```

should go after the docstring (which probably is not being picked up as a docstring but instead just a string being created within the function).


```diff
-return op(*[self(_) for _ in ex.operands()])
+return op(*[self(oper) for oper in ex.operands()])
```




---

archive/issue_comments_100736.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-08-23T00:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100736",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_100737.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-23T01:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_100738.json:
```json
{
    "body": "Replying to [comment:19 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[518361f](https://git.sagemath.org/sage.git/commit/?id=518361f2c30ccfef96f54740d0c0187e07dcb72d)||`de Moivre/exponentialize : documentation fixes, code streamlining.`||\n\nFixed doctests pass. setting `needs_review` to start the patchbots.",
    "created_at": "2021-08-23T01:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100738",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:19 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[518361f](https://git.sagemath.org/sage.git/commit/?id=518361f2c30ccfef96f54740d0c0187e07dcb72d)||`de Moivre/exponentialize : documentation fixes, code streamlining.`||

Fixed doctests pass. setting `needs_review` to start the patchbots.



---

archive/issue_comments_100739.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-23T01:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100739",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_100740.json:
```json
{
    "body": "I did a few more reviewer changes. If my changes are good, then positive review.\n----\nNew commits:",
    "created_at": "2021-08-25T04:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100740",
    "user": "https://github.com/tscrim"
}
```

I did a few more reviewer changes. If my changes are good, then positive review.
----
New commits:



---

archive/issue_comments_100741.json:
```json
{
    "body": "Thanks !\n\nOkay with your cosmetics (notwithstanding the fact that I do not grasp their rationale) ==> `positive_review`.",
    "created_at": "2021-08-25T06:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100741",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Thanks !

Okay with your cosmetics (notwithstanding the fact that I do not grasp their rationale) ==> `positive_review`.



---

archive/issue_comments_100742.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-25T06:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100742",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_100743.json:
```json
{
    "body": "Thank you.\n\nMost of them are formatting corrections, so after a `::` is needed to be indented (which becomes code) and the corresponding text needs to be at the base level. If something is followed by text, then it should be a single colon `:`. Convention says we should start docstrings with `Return` not `Returns`, and a few other small tweaks for that and PEP8.",
    "created_at": "2021-08-25T09:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100743",
    "user": "https://github.com/tscrim"
}
```

Thank you.

Most of them are formatting corrections, so after a `::` is needed to be indented (which becomes code) and the corresponding text needs to be at the base level. If something is followed by text, then it should be a single colon `:`. Convention says we should start docstrings with `Return` not `Returns`, and a few other small tweaks for that and PEP8.



---

archive/issue_events_010157.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2021-08-31T22:01:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10037#event-10157"
}
```



---

archive/issue_comments_100744.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-08-31T22:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10037#issuecomment-100744",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
