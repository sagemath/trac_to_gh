# Issue 10037: Wrap Maxima's  demoivre and exponentialize

Issue created by migration from https://trac.sagemath.org/ticket/10038

Original creator: mpatel

Original creation time: 2010-09-30 03:09:23

Assignee: burcin

CC:  kcrisman fmaltey slelievre

Sage does not appear to have easily accesible analogues of Mathematica's `TrigToExp` and `ExpToTrig`.  From [AskSage](http://ask.sagemath.org/question/148/complex-exponentialtrigonometric#comment-587):

```python
sage: x = var('x')
sage: t1 = cos(x)
sage: t2 = e^(I * x) / 2 / I - e^(-I * x) / 2 / I
sage: sageobj(t1._maxima_().exponentialize())
1/2*e^(-I*x) + 1/2*e^(I*x)
sage: sageobj(t2._maxima_().demoivre())
sin(x)
```



---

Comment by burcin created at 2010-10-01 15:11:07

You can use `maxima_methods()` to access the maxima functions easily.


```
sage: x = var('x')
sage: t1 = cos(x)
sage: t2 = e^(I * x) / 2 / I - e^(-I * x) / 2 / I
sage: res = t1.maxima_methods().exponentialize(); res
1/2*e^(-I*x) + 1/2*e^(I*x)
sage: type(res)
<type 'sage.symbolic.expression.Expression'>
sage: t2.maxima_methods().demoivre()
sin(x)
```


I am very much against wrapping each maxima function for manipulating symbolic expressions individually from Sage. Even though maxima provides a lot of functionality, their user interface is far from intuitive. 

IMHO, the user interface to these functions should be something like:


```
sage: t1.rewrite(exp)
1/2*e^(-I*x) + 1/2*e^(I*x)
sage: t2.rewrite(sin)
sin(x)
```



BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on maxima. It's possible that this requires wrapping more of pynac's features, for example

 * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and
 * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html

but it's well worth the effort.


---

Comment by kcrisman created at 2010-10-01 15:19:09

Replying to [comment:1 burcin]:
> You can use `maxima_methods()` to access the maxima functions easily.
> 
Yes, thanks for that reminder!
> I am very much against wrapping each maxima function for manipulating symbolic expressions individually from Sage. Even though maxima provides a lot of functionality, their user interface is far from intuitive. 

I don't see why we can't provide a more intuitive user interface for some of them, though.  Just because a ticket is opened doesn't mean it will ever be fulfilled, but at least it's here now if enough people want it.
> IMHO, the user interface to these functions should be something like:
> 
> {{{
> sage: t1.rewrite(exp)
> 1/2*e^(-I*x) + 1/2*e^(I*x)
> sage: t2.rewrite(sin)
> sin(x)
> }}}
This seems awkward, esp. if you don't know ahead of time whether it's sin or cos. I think that `simplify_*` makes sense, the way we have it now.  For now it's not worth having the discussion - I doubt anyone has time to do this right now.  But if someone does, maybe it's time to revisit that.
> BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on 
Yes, of course.   If only we could have that Sage Days solely about symbolics...
> 
>  * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and
>  * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html
> 
> but it's well worth the effort.


---

Comment by slelievre created at 2021-08-05 21:10:24

Changing keywords from "" to "expression tree".


---

Comment by slelievre created at 2021-08-05 21:10:24

Replying to [comment:1 burcin]:
>
> BTW, it would be great if we could think about how to provide basic functionality like this directly in Sage without relying on maxima. It's possible that this requires wrapping more of pynac's features, for example
> 
>  * http://www.ginac.de/tutorial/Applying-a-function-on-subexpressions.html and
>  * http://www.ginac.de/tutorial/Visitors-and-tree-traversal.html
> 
> but it's well worth the effort.

The links seem to have slightly changed:

- https://www.ginac.de/tutorial/#Applying-a-function-on-subexpressions
- https://www.ginac.de/tutorial/#Visitors-and-tree-traversal


---

Comment by charpent created at 2021-08-12 13:36:36

Replying to [comment:8 charpent]:

Eleven years later, it seems obvious that no one ever undertook to wrap Pynac's tree traversal utilities. However, the `expressionTreeWalker` class offers means to implement such utilities not too painfully.

This proposal passes `ptestlong` with no new failures.

==>`needs_review`
----
New commits:


---

Comment by charpent created at 2021-08-12 13:36:36

Changing status from new to needs_review.


---

Comment by charpent created at 2021-08-17 21:12:38

Changing status from needs_review to needs_work.


---

Comment by charpent created at 2021-08-17 21:12:38

Wups. A nice typo : `_init__` for `__init__`...

==> `needs_work`.


---

Comment by git created at 2021-08-17 21:14:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by charpent created at 2021-08-17 21:16:19

Changing status from needs_work to needs_review.


---

Comment by charpent created at 2021-08-17 21:16:19

Typo fixed ==>`needs_review`.


---

Comment by charpent created at 2021-08-18 08:41:06

Changing status from needs_review to needs_work.


---

Comment by charpent created at 2021-08-18 08:41:06

One doctest (src/sage/doctest/sources.py) fails.


---

Comment by git created at 2021-08-18 09:27:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by charpent created at 2021-08-18 09:31:51

Changing status from needs_work to needs_review.


---

Comment by charpent created at 2021-08-18 09:31:51

New patchbot attempt ==>`needs_review`


---

Comment by tscrim created at 2021-08-23 00:25:53

A few little things:

It would be good to use Sage's doc conventions:

```diff
-        """Returns this sumbolic expression with all circular and hyperbolic
+        """
+        Return this sumbolic expression with all circular and hyperbolic
         functions replaced by their respective exponential
         expressions.
```


`Exponentialize.__init__` is missing a doctest.

The import here

```
    def demoivre(self, force=False):
        from sage.symbolic.expression_conversions import DeMoivre
        """
```

should go after the docstring (which probably is not being picked up as a docstring but instead just a string being created within the function).


```diff
-return op(*[self(_) for _ in ex.operands()])
+return op(*[self(oper) for oper in ex.operands()])
```



---

Comment by charpent created at 2021-08-23 00:32:36

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-08-23 01:35:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by charpent created at 2021-08-23 01:38:00

Replying to [comment:19 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[518361f](https://git.sagemath.org/sage.git/commit/?id=518361f2c30ccfef96f54740d0c0187e07dcb72d)||`de Moivre/exponentialize : documentation fixes, code streamlining.`||

Fixed doctests pass. setting `needs_review` to start the patchbots.


---

Comment by charpent created at 2021-08-23 01:38:00

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2021-08-25 04:28:41

I did a few more reviewer changes. If my changes are good, then positive review.
----
New commits:


---

Comment by charpent created at 2021-08-25 06:48:04

Thanks !

Okay with your cosmetics (notwithstanding the fact that I do not grasp their rationale) ==> `positive_review`.


---

Comment by charpent created at 2021-08-25 06:48:04

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2021-08-25 09:56:05

Thank you.

Most of them are formatting corrections, so after a `::` is needed to be indented (which becomes code) and the corresponding text needs to be at the base level. If something is followed by text, then it should be a single colon `:`. Convention says we should start docstrings with `Return` not `Returns`, and a few other small tweaks for that and PEP8.


---

Comment by vbraun created at 2021-08-31 22:01:01

Resolution: fixed
