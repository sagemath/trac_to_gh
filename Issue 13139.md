# Issue 13139: alarm doesn't work with some elliptic curve functions

archive/issues_013139.json:
```json
{
    "body": "Assignee: @JohnCremona\n\nCC:  @pjbruin\n\nKeywords: alarm elliptic curve curves ellipticcurve\n\nThe following code does not work as intended (I imagine), i.e. it does not interrupt the computation after 3 seconds.\n\n\n```python\n\n#!/usr/bin/python -tt\n\nfrom sage.all import *\nimport time\n\ndef main():\n  alarm(3)\n  try:\n    EllipticCurve([123456, 789011]).rank()\n    #time.sleep(5) #code works as intended if the above command is replaced with this\n  except KeyboardInterrupt:\n    print 'Took too long'\n\n# This is the standard boilerplate that calls the main() function.\nif __name__ == '__main__':\n  main()\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/13311\n\n",
    "created_at": "2012-07-31T13:14:54Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "alarm doesn't work with some elliptic curve functions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13139",
    "user": "https://trac.sagemath.org/admin/accounts/users/alexc"
}
```
Assignee: @JohnCremona

CC:  @pjbruin

Keywords: alarm elliptic curve curves ellipticcurve

The following code does not work as intended (I imagine), i.e. it does not interrupt the computation after 3 seconds.


```python

#!/usr/bin/python -tt

from sage.all import *
import time

def main():
  alarm(3)
  try:
    EllipticCurve([123456, 789011]).rank()
    #time.sleep(5) #code works as intended if the above command is replaced with this
  except KeyboardInterrupt:
    print 'Took too long'

# This is the standard boilerplate that calls the main() function.
if __name__ == '__main__':
  main()
```


Issue created by migration from https://trac.sagemath.org/ticket/13311





---

archive/issue_comments_159753.json:
```json
{
    "body": "I don't know anything about alarm().  In this case mwrank is being used to compute the rank and it takes more then 3s.",
    "created_at": "2012-07-31T13:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159753",
    "user": "https://github.com/JohnCremona"
}
```

I don't know anything about alarm().  In this case mwrank is being used to compute the rank and it takes more then 3s.



---

archive/issue_comments_159754.json:
```json
{
    "body": "Replying to [comment:1 cremona]:\n> I don't know anything about alarm().  In this case mwrank is being used to compute the rank and it takes more then 3s.\nalarm(timelimit) is supposed to raise a KeyboardInterrupt exception after timelimit seconds. For some reason, despite mwrank running for more than 3 seconds, the computation isn't interrupted. Documentation for alarm can be found here: http://www.sagemath.org/doc/reference/sage/misc/misc.html#sage.misc.misc.alarm",
    "created_at": "2012-07-31T13:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159754",
    "user": "https://trac.sagemath.org/admin/accounts/users/alexc"
}
```

Replying to [comment:1 cremona]:
> I don't know anything about alarm().  In this case mwrank is being used to compute the rank and it takes more then 3s.
alarm(timelimit) is supposed to raise a KeyboardInterrupt exception after timelimit seconds. For some reason, despite mwrank running for more than 3 seconds, the computation isn't interrupted. Documentation for alarm can be found here: http://www.sagemath.org/doc/reference/sage/misc/misc.html#sage.misc.misc.alarm



---

archive/issue_comments_159755.json:
```json
{
    "body": "The following might help to locate the problem: http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off",
    "created_at": "2012-07-31T19:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159755",
    "user": "https://github.com/koffie"
}
```

The following might help to locate the problem: http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off



---

archive/issue_comments_159756.json:
```json
{
    "body": "The problem is that the `SIGALRM` handling is completely independent of the usual signal handling, hence it doesn't work.  It simply raises a Python-level `KeyboardInterrupt`, but that's it.  It doesn't interact with any of the sophisticated `sig_on()`/`sig_off()` stuff.\n\nAs an ugly work-around, try using `signal_after_delay()` from `sage.tests.interrupt`, which generates an *actual* interrupt.",
    "created_at": "2012-09-27T18:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159756",
    "user": "https://github.com/jdemeyer"
}
```

The problem is that the `SIGALRM` handling is completely independent of the usual signal handling, hence it doesn't work.  It simply raises a Python-level `KeyboardInterrupt`, but that's it.  It doesn't interact with any of the sophisticated `sig_on()`/`sig_off()` stuff.

As an ugly work-around, try using `signal_after_delay()` from `sage.tests.interrupt`, which generates an *actual* interrupt.



---

archive/issue_comments_159757.json:
```json
{
    "body": "Changing assignee from @JohnCremona to @jdemeyer.",
    "created_at": "2013-03-15T22:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159757",
    "user": "https://github.com/jdemeyer"
}
```

Changing assignee from @JohnCremona to @jdemeyer.



---

archive/issue_comments_159758.json:
```json
{
    "body": "Changing keywords from \"alarm elliptic curve curves ellipticcurve\" to \"alarm signal interrupt\".",
    "created_at": "2013-03-15T22:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159758",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "alarm elliptic curve curves ellipticcurve" to "alarm signal interrupt".



---

archive/issue_comments_159759.json:
```json
{
    "body": "This has absolutely nothing to do with elliptic curves...",
    "created_at": "2013-03-15T22:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159759",
    "user": "https://github.com/jdemeyer"
}
```

This has absolutely nothing to do with elliptic curves...



---

archive/issue_comments_159760.json:
```json
{
    "body": "Changing component from elliptic curves to c_lib.",
    "created_at": "2013-03-15T22:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159760",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from elliptic curves to c_lib.



---

archive/issue_comments_159761.json:
```json
{
    "body": "Replying to [comment:4 jdemeyer]:\n> The problem is that the `SIGALRM` handling is completely independent of the usual signal handling, hence it doesn't work. [...]\n> \n> As an ugly work-around, try using `signal_after_delay()` from `sage.tests.interrupt`, which generates an *actual* interrupt.\n\nA \"cleaner\" work-around is to use the ``@`fork` decorator, such that the computation (implemented in Cython or e.g. C/C++) runs in a subprocess, while `alarm()` is used in the main (Python) process; cf. [this solution on ask.sagemath](http://ask.sagemath.org/question/2567/kill-the-thread-in-a-long-computation).",
    "created_at": "2013-05-12T15:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159761",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:4 jdemeyer]:
> The problem is that the `SIGALRM` handling is completely independent of the usual signal handling, hence it doesn't work. [...]
> 
> As an ugly work-around, try using `signal_after_delay()` from `sage.tests.interrupt`, which generates an *actual* interrupt.

A "cleaner" work-around is to use the ``@`fork` decorator, such that the computation (implemented in Cython or e.g. C/C++) runs in a subprocess, while `alarm()` is used in the main (Python) process; cf. [this solution on ask.sagemath](http://ask.sagemath.org/question/2567/kill-the-thread-in-a-long-computation).



---

archive/issue_comments_159762.json:
```json
{
    "body": "Replying to [comment:6 leif]:\n> A \"cleaner\" work-around is to use the ``@`fork` decorator, such that the computation (implemented in Cython or e.g. C/C++) runs in a subprocess, while `alarm()` is used in the main (Python) process; cf. [this solution on ask.sagemath](http://ask.sagemath.org/question/2567/kill-the-thread-in-a-long-computation).\nI disagree with \"cleaner\" but that would work, yes.",
    "created_at": "2013-05-13T07:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159762",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:6 leif]:
> A "cleaner" work-around is to use the ``@`fork` decorator, such that the computation (implemented in Cython or e.g. C/C++) runs in a subprocess, while `alarm()` is used in the main (Python) process; cf. [this solution on ask.sagemath](http://ask.sagemath.org/question/2567/kill-the-thread-in-a-long-computation).
I disagree with "cleaner" but that would work, yes.



---

archive/issue_comments_159763.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-05-13T12:29:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159763",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_159764.json:
```json
{
    "body": "Minor things:\n\n*\"The latter signal also\u00a0redirect stdin from /dev/null, to cause interactive sessions to exit\u00a0**also**.\"*\n\n-> *\"The latter signal also\u00a0redirect**s** stdin from /dev/null, to cause interactive sessions to exit.\"*\n\n`s/`time out`/`time-out`/` (or timeout, which is also used later on) a couple of times, and in the doctest error message `s/`Time out`/`Timed out`/` (consistent with e.g. *Interrupt**ed***).\n\n\n\n\nIn `sig_raise_exception()`, shouldn't the message in `raise SystemError(\"unknown signal\")` contain the signal number?",
    "created_at": "2013-05-13T21:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159764",
    "user": "https://github.com/nexttime"
}
```

Minor things:

*"The latter signal also redirect stdin from /dev/null, to cause interactive sessions to exit **also**."*

-> *"The latter signal also redirect**s** stdin from /dev/null, to cause interactive sessions to exit."*

`s/`time out`/`time-out`/` (or timeout, which is also used later on) a couple of times, and in the doctest error message `s/`Time out`/`Timed out`/` (consistent with e.g. *Interrupt**ed***).




In `sig_raise_exception()`, shouldn't the message in `raise SystemError("unknown signal")` contain the signal number?



---

archive/issue_comments_159765.json:
```json
{
    "body": "Replying to [ticket:13311 jdemeyer]:\n> Another cool new feature is that `alarm()` now works with a floating-point number of seconds.\n\nMaybe on a real-time OS ... ;-)",
    "created_at": "2013-05-15T13:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159765",
    "user": "https://github.com/nexttime"
}
```

Replying to [ticket:13311 jdemeyer]:
> Another cool new feature is that `alarm()` now works with a floating-point number of seconds.

Maybe on a real-time OS ... ;-)



---

archive/issue_comments_159766.json:
```json
{
    "body": "P.S.:  Patch looks ok, but I haven't had the time to test this (and #14029) yet.",
    "created_at": "2013-05-15T13:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159766",
    "user": "https://github.com/nexttime"
}
```

P.S.:  Patch looks ok, but I haven't had the time to test this (and #14029) yet.



---

archive/issue_comments_159767.json:
```json
{
    "body": "Replying to [comment:10 leif]:\n> In `sig_raise_exception()`, shouldn't the message in `raise SystemError(\"unknown signal\")` contain the signal number?\n\nOk, fixed now.  Or more nit-picking:\n\nMaybe\n\n```python\n    raise SystemError(\"Received unknown signal number %s\"%sig)\n```\n\n?",
    "created_at": "2013-05-15T14:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159767",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:10 leif]:
> In `sig_raise_exception()`, shouldn't the message in `raise SystemError("unknown signal")` contain the signal number?

Ok, fixed now.  Or more nit-picking:

Maybe

```python
    raise SystemError("Received unknown signal number %s"%sig)
```

?



---

archive/issue_comments_159768.json:
```json
{
    "body": "This doesn't apply anymore to 5.12.rc1 + #14029; the patch fails on `sage/ext/c_lib.pyx` and `sage/structure/parent.pyx`.",
    "created_at": "2013-10-07T15:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159768",
    "user": "https://github.com/pjbruin"
}
```

This doesn't apply anymore to 5.12.rc1 + #14029; the patch fails on `sage/ext/c_lib.pyx` and `sage/structure/parent.pyx`.



---

archive/issue_comments_159769.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-10-07T15:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159769",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_159770.json:
```json
{
    "body": "Attachment [13311_sigalrm.patch](tarball://root/attachments/some-uuid/ticket13311/13311_sigalrm.patch) by @jdemeyer created at 2013-10-27 22:46:50",
    "created_at": "2013-10-27T22:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159770",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [13311_sigalrm.patch](tarball://root/attachments/some-uuid/ticket13311/13311_sigalrm.patch) by @jdemeyer created at 2013-10-27 22:46:50



---

archive/issue_comments_159771.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-10-27T22:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159771",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_159772.json:
```json
{
    "body": "Generating a `SIGALRM` outside `sig_on()...sig_off()` calls `PyErr_SetInterrupt()`, which causes Python to raise a `KeyboardInterrupt`:\n\n```\nsage: alarm(1) \nsage: # wait 1 second\nKeyboardInterrupt\n```\n\nThe same thing already happens without this patch.  Wouldn't it make sense to also raise an `AlarmInterrupt` outside `sig_on()...sig_off()`, too?",
    "created_at": "2013-10-29T19:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159772",
    "user": "https://github.com/pjbruin"
}
```

Generating a `SIGALRM` outside `sig_on()...sig_off()` calls `PyErr_SetInterrupt()`, which causes Python to raise a `KeyboardInterrupt`:

```
sage: alarm(1) 
sage: # wait 1 second
KeyboardInterrupt
```

The same thing already happens without this patch.  Wouldn't it make sense to also raise an `AlarmInterrupt` outside `sig_on()...sig_off()`, too?



---

archive/issue_comments_159773.json:
```json
{
    "body": "Replying to [comment:19 pbruin]:\n> Generating a `SIGALRM` outside `sig_on()...sig_off()` calls `PyErr_SetInterrupt()`, which causes Python to raise a `KeyboardInterrupt`\nNo, it doesn't. It causes IPython to print the string `\"KeyboardInterrupt\"`. See the difference with\n\n```\nsage: alarm(0.5); sleep(1)\n---------------------------------------------------------------------------\nAlarmInterrupt                            Traceback (most recent call last)\n<ipython-input-3-854e6c430970> in <module>()\n----> 1 alarm(RealNumber('0.5')); sleep(Integer(1))\n\n/scratch/release/merger/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:1634)()\n\n/scratch/release/merger/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sig_raise_exception (sage/ext/c_lib.c:894)()\n\nAlarmInterrupt: \n```\n",
    "created_at": "2013-10-29T21:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159773",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:19 pbruin]:
> Generating a `SIGALRM` outside `sig_on()...sig_off()` calls `PyErr_SetInterrupt()`, which causes Python to raise a `KeyboardInterrupt`
No, it doesn't. It causes IPython to print the string `"KeyboardInterrupt"`. See the difference with

```
sage: alarm(0.5); sleep(1)
---------------------------------------------------------------------------
AlarmInterrupt                            Traceback (most recent call last)
<ipython-input-3-854e6c430970> in <module>()
----> 1 alarm(RealNumber('0.5')); sleep(Integer(1))

/scratch/release/merger/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sage_python_check_interrupt (sage/ext/c_lib.c:1634)()

/scratch/release/merger/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/ext/c_lib.so in sage.ext.c_lib.sig_raise_exception (sage/ext/c_lib.c:894)()

AlarmInterrupt: 
```




---

archive/issue_comments_159774.json:
```json
{
    "body": "Replying to [comment:20 jdemeyer]:\n> Replying to [comment:19 pbruin]:\n> > Generating a `SIGALRM` outside `sig_on()...sig_off()` calls `PyErr_SetInterrupt()`, which causes Python to raise a `KeyboardInterrupt`\n> No, it doesn't. It causes IPython to print the string `\"KeyboardInterrupt\"`.\nI was mislead by the Python documentation, which says that `PyErr_SetInterrupt()` causes a `KeyboardInterrupt` to be raised the next time `PyErr_CheckSignals()` is called.  In fact this only describes what Python's default `SIGINT` handler does, which we don't use.\n\nOK, so IPython prints the string `\"KeyboardInterrupt\"` in an `except KeyboardInterrupt` block when it is reading input.  Do I understand correctly that the `KeyboardInterrupt` is in this case actually an `AlarmInterrupt` and triggers this `except` block because it inherits from `KeyboardInterrupt`?",
    "created_at": "2013-10-29T23:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159774",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:20 jdemeyer]:
> Replying to [comment:19 pbruin]:
> > Generating a `SIGALRM` outside `sig_on()...sig_off()` calls `PyErr_SetInterrupt()`, which causes Python to raise a `KeyboardInterrupt`
> No, it doesn't. It causes IPython to print the string `"KeyboardInterrupt"`.
I was mislead by the Python documentation, which says that `PyErr_SetInterrupt()` causes a `KeyboardInterrupt` to be raised the next time `PyErr_CheckSignals()` is called.  In fact this only describes what Python's default `SIGINT` handler does, which we don't use.

OK, so IPython prints the string `"KeyboardInterrupt"` in an `except KeyboardInterrupt` block when it is reading input.  Do I understand correctly that the `KeyboardInterrupt` is in this case actually an `AlarmInterrupt` and triggers this `except` block because it inherits from `KeyboardInterrupt`?



---

archive/issue_comments_159775.json:
```json
{
    "body": "Replying to [comment:21 pbruin]:\n> I was mislead by the Python documentation, which says that `PyErr_SetInterrupt()` causes a `KeyboardInterrupt` to be raised the next time `PyErr_CheckSignals()` is called.  In fact this only describes what Python's default `SIGINT` handler does, which we don't use.\nIndeed. The Python `SIGINT` handler is changed in `_init_csage()` from `devel/sage/sage/ext/c_lib.pyx`.\n\n> OK, so IPython prints the string `\"KeyboardInterrupt\"` in an `except KeyboardInterrupt` block when it is reading input.  Do I understand correctly that the `KeyboardInterrupt` is in this case actually an `AlarmInterrupt` and triggers this `except` block because it inherits from `KeyboardInterrupt`?\nExactly.",
    "created_at": "2013-10-30T08:05:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159775",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:21 pbruin]:
> I was mislead by the Python documentation, which says that `PyErr_SetInterrupt()` causes a `KeyboardInterrupt` to be raised the next time `PyErr_CheckSignals()` is called.  In fact this only describes what Python's default `SIGINT` handler does, which we don't use.
Indeed. The Python `SIGINT` handler is changed in `_init_csage()` from `devel/sage/sage/ext/c_lib.pyx`.

> OK, so IPython prints the string `"KeyboardInterrupt"` in an `except KeyboardInterrupt` block when it is reading input.  Do I understand correctly that the `KeyboardInterrupt` is in this case actually an `AlarmInterrupt` and triggers this `except` block because it inherits from `KeyboardInterrupt`?
Exactly.



---

archive/issue_comments_159776.json:
```json
{
    "body": "Replying to [comment:20 jdemeyer]:\n> No, it doesn't. It causes IPython to print the string `\"KeyboardInterrupt\"`.\nGiven that an interrupt is not necessarily generated from the keyboard, it would be more logical from the user's perspective if IPython would print either (1) a generic message like `\"Interrupt\"`, (2) a different string for `KeyboardInterrupt` and `AlarmInterrupt`, or even (3) nothing (Bash just prints a newline when you press `^C` and nothing when you press `^\\`.)\n\nI would be in favour of (2); to implement this, IPython could print `E.__class__.__name__` inside `except KeyboardInterrupt as E` instead of the constant string `\"KeyboardInterrupt\"`.\n\nIn principle it would also make more sense if `KeyboardInterrupt` and `AlarmInterrupt` would derive from a common `Interrupt` exception, but this is impossible since `KeyboardInterrupt` is a built-in Python exception.",
    "created_at": "2013-10-30T11:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159776",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:20 jdemeyer]:
> No, it doesn't. It causes IPython to print the string `"KeyboardInterrupt"`.
Given that an interrupt is not necessarily generated from the keyboard, it would be more logical from the user's perspective if IPython would print either (1) a generic message like `"Interrupt"`, (2) a different string for `KeyboardInterrupt` and `AlarmInterrupt`, or even (3) nothing (Bash just prints a newline when you press `^C` and nothing when you press `^\`.)

I would be in favour of (2); to implement this, IPython could print `E.__class__.__name__` inside `except KeyboardInterrupt as E` instead of the constant string `"KeyboardInterrupt"`.

In principle it would also make more sense if `KeyboardInterrupt` and `AlarmInterrupt` would derive from a common `Interrupt` exception, but this is impossible since `KeyboardInterrupt` is a built-in Python exception.



---

archive/issue_comments_159777.json:
```json
{
    "body": "Perhaps, but I don't believe it's worth the trouble to patch IPython for this.",
    "created_at": "2013-10-30T13:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159777",
    "user": "https://github.com/jdemeyer"
}
```

Perhaps, but I don't believe it's worth the trouble to patch IPython for this.



---

archive/issue_comments_159778.json:
```json
{
    "body": "Replying to [comment:24 jdemeyer]:\n> Perhaps, but I don't believe it's worth the trouble to patch IPython for this.\nMaybe, maybe not; in any case we can always do it later.\n\nThat issue aside, the patch looks good, behaves as expected and passes doctests.",
    "created_at": "2013-10-30T14:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159778",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:24 jdemeyer]:
> Perhaps, but I don't believe it's worth the trouble to patch IPython for this.
Maybe, maybe not; in any case we can always do it later.

That issue aside, the patch looks good, behaves as expected and passes doctests.



---

archive/issue_comments_159779.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-30T14:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159779",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_159780.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-11-06T12:49:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159780",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_159781.json:
```json
{
    "body": "I finally sent a patch to IPython about this: [https://github.com/ipython/ipython/pull/7069](https://github.com/ipython/ipython/pull/7069)",
    "created_at": "2014-12-01T08:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13139#issuecomment-159781",
    "user": "https://github.com/jdemeyer"
}
```

I finally sent a patch to IPython about this: [https://github.com/ipython/ipython/pull/7069](https://github.com/ipython/ipython/pull/7069)
