# Issue 24169: py3: get rid of some long(...) in quotient rings

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2017-12-20 09:03:38

CC:  embray jdemeyer tscrim




---

Comment by chapoton created at 2017-12-20 09:04:11

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-12-20 09:04:11

New commits:


---

Comment by chapoton created at 2017-12-20 09:06:11

In the same spirit, what to do with

```
src/sage/interfaces/interface.py: return long(randstate().seed()&0x1FFFFFFF)
```

?


---

Comment by chapoton created at 2017-12-20 10:43:12

green bot, please review


---

Comment by jdemeyer created at 2017-12-20 10:48:34

You should keep the doctests, i.e. move them somewhere else inside a `TESTS` block.


---

Comment by jdemeyer created at 2017-12-20 10:48:34

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2017-12-20 10:51:14

They no longer work:

```
sage: R.<x> = PolynomialRing(QQ)
sage: S.<a> = R.quotient(x^3-2)
sage: long(S(10))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-fb296fb2f341> in <module>()
----> 1 long(S(Integer(10)))

TypeError: long() argument must be a string or a number, not 'PolynomialQuotientRing_field_with_category.element_class'
sage: int(S(10))
10
sage: long(int(S(10)))
10L
```



---

Comment by chapoton created at 2017-12-20 10:53:36

Would it be ok to use the previous comment as a doctest ?


---

Comment by jdemeyer created at 2017-12-20 10:55:11

Replying to [comment:6 chapoton]:
> Would it be ok to use the previous comment as a doctest ?

Of course not. You are breaking a part of Sage that used to work!

Really, why do we need to get rid of this `__long__` anyway? It doesn't hurt to keep it on Python 3. The doctests won't work because there is no `long`, but the tests should work with `int` on Python 3.


---

Comment by jdemeyer created at 2017-12-20 10:57:46

It's a general thing that I have said on several other tickets: if you break an existing doctest for Python 3 porting, there should be an exceptional reason for it. Generally, you change the code such that the code works on Python 2 and Python 3 but you keep the doctests.

Of course, if the doctest itself is not compatible with Python 3 (in this cases, it uses `long()`), then it can't work on Python 3. But it should still work on Python 2.


---

Comment by chapoton created at 2017-12-20 10:58:37

Well, because keeping long(..) is not an option if we want doctests to pass, that's why.

But I more concerned with the call to long in

```
src/sage/interfaces/interface.py: return long(randstate().seed()&0x1FFFFFFF)
```

that prevents some combinat code to run.

By the way, did you try to build and use sage with python3 yourself ?


---

Comment by chapoton created at 2017-12-20 14:23:29

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2017-12-20 14:23:29

Because I am not going to fight for this one, let us close it as wontfix.


---

Comment by embray created at 2017-12-21 15:39:54

Resolution: wontfix


---

Comment by embray created at 2017-12-21 15:39:54

I agree `__long__` shouldn't be outright removed.  I've fixed a few of these in my branch already on a case-by-case basis.
