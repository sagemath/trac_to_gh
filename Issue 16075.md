# Issue 16075: Let the user override MACOSX_DEPLOYMENT_TARGET

Issue created by migration from Trac.

Original creator: leif

Original creation time: 2014-05-09 15:37:20

CC:  jhpalmieri

Keywords: Xcode GCC -mmacosx-version-min compiler cannot create executables Darwin Mavericks MacApp bdist binary distribution

In `sage-env`, we currently have:

```sh
# Mac OS X-specific setup
if [ `uname` = "Darwin" ]; then
    # set MACOSX_DEPLOYMENT_TARGET -- if set incorrectly, this can
    # cause lots of random "Abort trap" issues on OSX. see trac
    # #7095 for an example.
    MACOSX_VERSION=`uname -r | awk -F. '{print $1}'`
    MACOSX_DEPLOYMENT_TARGET=10.$[$MACOSX_VERSION-4]
    export MACOSX_DEPLOYMENT_TARGET
fi
```


With *binary* distributions of Sage, e.g. when trying to install an optional spkg, this can lead to errors like

```
configure:3166: checking whether the C compiler works
configure:3188: gcc    conftest.c  >&5
ld: library not found for -lcrt1.10.6.o
collect2: error: ld returned 1 exit status
configure:3192: $? = 1
configure:3230: result: no
```

hidden in `config.log`, the visible `configure` error message being

```
checking for gcc... gcc
checking whether the C compiler works... no
configure: error: in `/Applications/sage/local/var/tmp/sage/build/<package>/src':
configure: error: C compiler cannot create executables
See `config.log' for more details
```


At least as a work-around, the user should be able to set `MACOSX_DEPLOYMENT_TARGET` to some other value (e.g. `10.4`) to get past such errors.

Setting a different target may make sense for developers (using Sage built from source) as well.



---

Comment by leif created at 2014-05-09 16:40:19

I think #7095 (a huge ticket dealing with a couple of issues) is no longer (or not really) relevant here; there's some discussion of `MACOSX_DEPLOYMENT_TARGET` though, see http://trac.sagemath.org/ticket/7095#comment:36 ff.


---

Comment by leif created at 2014-05-09 16:43:52

P.S.:  Note that we meanwhile build most if not all parts of Sage with our own FSF GCC; Apple's GCC is only used to bootstrap our GCC (and to build some Objective C[++] files IIRC).


---

Comment by mkoeppe created at 2021-06-07 00:39:02

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-06-07 00:39:02

The code that was setting `MACOSX_DEPLOYMENT_TARGET` was removed in #18272, so we can close this ticket.


---

Comment by jhpalmieri created at 2021-06-07 18:20:24

Sounds good.


---

Comment by jhpalmieri created at 2021-06-07 18:20:24

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-06-24 20:15:37

Resolution: invalid
