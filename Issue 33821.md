# Issue 33821: sage 9.6 special function translation issue with fricas. elliptic_ec

archive/issues_033821.json:
```json
{
    "body": "Keywords: fricas intergate symbolic\n\nUsing sagemath 9.6 and fricas 1.3.8.\n\nFricas solve this integral and returns ellipticF and ellipticE in result, both which take two arguments.\n\nSagemath seems to translate these to its own elliptic_ec for some reason, which takes only 1 argument and hence gives an exception.\n\nWhy did it not translate these to sagemath elliptic_f and elliptic_e? Both which are available in sagemath and take 2 arguments?\n\nHere is an example\n\n\n\n```\n>sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.6, Release Date: 2022-05-15                     \u2502\n\u2502 Using Python 3.10.4. Type \"help()\" for help.                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nsage: var('x a b d c e f')\n(x, a, b, d, c, e, f)\nsage: integrate((f*x^3+e*x^2+d*x+c)*(b*x^4+a)^(1/2),x,algorithm=\"fricas\")\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-11-d0465c613c1a> in <module>\n----> 1 integrate((f*x**Integer(3)+e*x**Integer(2)+d*x+c)*(b*x**Integer(4)+a)**(Integer(1)/Integer(2)),x,algorithm=\"fricas\")\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/misc/functional.py in integral(x, *args, **kwds)\n    762     \"\"\"\n    763     if hasattr(x, 'integral'):\n--> 764         return x.integral(*args, **kwds)\n    765     else:\n    766         from sage.symbolic.ring import SR\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.integral (build/cythonized/sage/symbolic/expression.cpp:95445)()\n  13192                     R = SR\n  13193             return R(integral(f, v, a, b, **kwds))\n> 13194         return integral(self, *args, **kwds)\n  13195\n  13196     integrate = integral\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/integration/integral.py in integrate(expression, v, a, b, algorithm, hold)\n   1045         if not integrator:\n   1046             raise ValueError(\"Unknown algorithm: %s\" % algorithm)\n-> 1047         return integrator(expression, v, a, b)\n   1048     if a is None:\n   1049         return indefinite_integral(expression, v, hold=hold)\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/integration/external.py in fricas_integrator(expression, v, a, b, noPole)\n    205             result = e_fricas.integrate(seg)\n    206\n--> 207     result = result.sage()\n    208\n    209     if result == \"failed\":\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/interface.py in sage(self, *args, **kwds)\n   1104             [0 0]\n   1105         \"\"\"\n-> 1106         return self._sage_(*args, **kwds)\n   1107\n   1108     def __repr__(self):\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _sage_(self)\n   2048             # we treat Expression Integer and Expression Complex\n   2049             # Integer just the same\n-> 2050             return FriCASElement._sage_expression(P.get_InputForm(self._name))\n   2051\n   2052         if head == 'DistributedMultivariatePolynomial':\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _sage_expression(fricas_InputForm)\n   1730         register_symbol(convert_rootOf, {'fricas': 'rootOf'})\n   1731\n-> 1732         ex, _ = FriCASElement._parse_and_eval(fricas_InputForm)\n   1733         # postprocessing of rootOf\n   1734         from sage.rings.all import QQbar, PolynomialRing\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)\n   1319\n   1320         if s[a] == FriCASElement._LEFTBRACKET:\n-> 1321             return FriCASElement._parse_list(s, start=a)\n   1322         elif s[a] == FriCASElement._STRINGMARKER:\n   1323             return FriCASElement._parse_string(s, start=a)\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)\n   1361         args = []\n   1362         while s[a] != FriCASElement._RIGHTBRACKET:\n-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)\n   1364             args.append(e)\n   1365             a += 1\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)\n   1319\n   1320         if s[a] == FriCASElement._LEFTBRACKET:\n-> 1321             return FriCASElement._parse_list(s, start=a)\n   1322         elif s[a] == FriCASElement._STRINGMARKER:\n   1323             return FriCASElement._parse_string(s, start=a)\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)\n   1361         args = []\n   1362         while s[a] != FriCASElement._RIGHTBRACKET:\n-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)\n   1364             args.append(e)\n   1365             a += 1\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)\n   1319\n   1320         if s[a] == FriCASElement._LEFTBRACKET:\n-> 1321             return FriCASElement._parse_list(s, start=a)\n   1322         elif s[a] == FriCASElement._STRINGMARKER:\n   1323             return FriCASElement._parse_string(s, start=a)\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)\n   1361         args = []\n   1362         while s[a] != FriCASElement._RIGHTBRACKET:\n-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)\n   1364             args.append(e)\n   1365             a += 1\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)\n   1319\n   1320         if s[a] == FriCASElement._LEFTBRACKET:\n-> 1321             return FriCASElement._parse_list(s, start=a)\n   1322         elif s[a] == FriCASElement._STRINGMARKER:\n   1323             return FriCASElement._parse_string(s, start=a)\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)\n   1361         args = []\n   1362         while s[a] != FriCASElement._RIGHTBRACKET:\n-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)\n   1364             args.append(e)\n   1365             a += 1\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)\n   1319\n   1320         if s[a] == FriCASElement._LEFTBRACKET:\n-> 1321             return FriCASElement._parse_list(s, start=a)\n   1322         elif s[a] == FriCASElement._STRINGMARKER:\n   1323             return FriCASElement._parse_string(s, start=a)\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)\n   1364             args.append(e)\n   1365             a += 1\n-> 1366         return fun(*args), a\n   1367\n   1368     @staticmethod\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.c:10972)()\n   1031             res = self._evalf_try_(*args)\n   1032             if res is None:\n-> 1033                 res = super(BuiltinFunction, self).__call__(\n   1034                         *args, coerce=coerce, hold=hold)\n   1035\n\n~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.c:5588)()\n    513         \"\"\"\n    514         if self._nargs > 0 and len(args) != self._nargs:\n--> 515             raise TypeError(\"Symbolic function %s takes exactly %s arguments (%s given)\" % (self._name, self._nargs, len(args)))\n    516\n    517         # if the given input is a symbolic expression, we don't convert it back\n\nTypeError: Symbolic function elliptic_ec takes exactly 1 arguments (2 given)\n\n```\n\n\nHere is the result using fricas directly\n\n\n\n```\n>fricas\nFRICAS=\"/usr/local/lib/fricas/target/x86_64-linux-gnu\"\nspad-lib=\"/usr/local/lib/fricas/target/x86_64-linux-gnu/lib/libspad.so\"\n                       FriCAS Computer Algebra System\n                            Version: FriCAS 1.3.8\n                   Timestamp: Tue Jun 21 15:11:38 CDT 2022\n\n\n(22) -> setSimplifyDenomsFlag(true)\n(23) -> anti:=integrate((f*x^3+e*x^2+d*x+c)*(b*x^4+a)^(1/2),x);\n(24) -> unparse(anti::InputForm)\n\n  \"(((-12)*a*e+20*b*c)*x*2^(1/2)*(((-4)*a)/b)^(1/2)*b^(1/2)*((((-4)*a)/b)^(1/2)\n  )^(1/2)*ellipticF((((((-4)*a)/b)^(1/2))^(1/2))/(x*2^(1/2)),-1)+(12*a*e*x*2^(1\n  /2)*(((-4)*a)/b)^(1/2)*b^(1/2)*((((-4)*a)/b)^(1/2))^(1/2)*ellipticE((((((-4)*\n  a)/b)^(1/2))^(1/2))/(x*2^(1/2)),-1)+(15*a*d*x*b^(1/2)*log((-2)*b*x^2*(b*x^4+a\n  )^(1/2)+((-2)*b*x^4+(-1)*a)*b^(1/2))+(20*b*f*x^5+24*b*e*x^4+30*b*d*x^3+40*b*c\n  *x^2+20*a*f*x+48*a*e)*(b*x^4+a)^(1/2))))/(120*b*x)\"\n\n```\n\n\nYou can see Fricas result do not contain **elliptic_ec**\n\nIs this a translation problem?  Is there something I can do to fix this before running this integral? Right now many integrals are failing using fricas due to this when they should not be failing.\n\nHere is link to [sagemath documentation](https://doc.sagemath.org/html/en/reference/functions/sage/functions/special.html#sage.functions.special.EllipticEC) on special functions\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34058\n\n",
    "created_at": "2022-06-23T21:45:08Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "sage 9.6 special function translation issue with fricas. elliptic_ec",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33821",
    "user": "https://github.com/nasser1"
}
```
Keywords: fricas intergate symbolic

Using sagemath 9.6 and fricas 1.3.8.

Fricas solve this integral and returns ellipticF and ellipticE in result, both which take two arguments.

Sagemath seems to translate these to its own elliptic_ec for some reason, which takes only 1 argument and hence gives an exception.

Why did it not translate these to sagemath elliptic_f and elliptic_e? Both which are available in sagemath and take 2 arguments?

Here is an example



```
>sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.6, Release Date: 2022-05-15                     │
│ Using Python 3.10.4. Type "help()" for help.                       │
└────────────────────────────────────────────────────────────────────┘

sage: var('x a b d c e f')
(x, a, b, d, c, e, f)
sage: integrate((f*x^3+e*x^2+d*x+c)*(b*x^4+a)^(1/2),x,algorithm="fricas")
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-11-d0465c613c1a> in <module>
----> 1 integrate((f*x**Integer(3)+e*x**Integer(2)+d*x+c)*(b*x**Integer(4)+a)**(Integer(1)/Integer(2)),x,algorithm="fricas")

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/misc/functional.py in integral(x, *args, **kwds)
    762     """
    763     if hasattr(x, 'integral'):
--> 764         return x.integral(*args, **kwds)
    765     else:
    766         from sage.symbolic.ring import SR

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.integral (build/cythonized/sage/symbolic/expression.cpp:95445)()
  13192                     R = SR
  13193             return R(integral(f, v, a, b, **kwds))
> 13194         return integral(self, *args, **kwds)
  13195
  13196     integrate = integral

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/integration/integral.py in integrate(expression, v, a, b, algorithm, hold)
   1045         if not integrator:
   1046             raise ValueError("Unknown algorithm: %s" % algorithm)
-> 1047         return integrator(expression, v, a, b)
   1048     if a is None:
   1049         return indefinite_integral(expression, v, hold=hold)

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/integration/external.py in fricas_integrator(expression, v, a, b, noPole)
    205             result = e_fricas.integrate(seg)
    206
--> 207     result = result.sage()
    208
    209     if result == "failed":

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/interface.py in sage(self, *args, **kwds)
   1104             [0 0]
   1105         """
-> 1106         return self._sage_(*args, **kwds)
   1107
   1108     def __repr__(self):

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _sage_(self)
   2048             # we treat Expression Integer and Expression Complex
   2049             # Integer just the same
-> 2050             return FriCASElement._sage_expression(P.get_InputForm(self._name))
   2051
   2052         if head == 'DistributedMultivariatePolynomial':

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _sage_expression(fricas_InputForm)
   1730         register_symbol(convert_rootOf, {'fricas': 'rootOf'})
   1731
-> 1732         ex, _ = FriCASElement._parse_and_eval(fricas_InputForm)
   1733         # postprocessing of rootOf
   1734         from sage.rings.all import QQbar, PolynomialRing

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)
   1319
   1320         if s[a] == FriCASElement._LEFTBRACKET:
-> 1321             return FriCASElement._parse_list(s, start=a)
   1322         elif s[a] == FriCASElement._STRINGMARKER:
   1323             return FriCASElement._parse_string(s, start=a)

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)
   1361         args = []
   1362         while s[a] != FriCASElement._RIGHTBRACKET:
-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)
   1364             args.append(e)
   1365             a += 1

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)
   1319
   1320         if s[a] == FriCASElement._LEFTBRACKET:
-> 1321             return FriCASElement._parse_list(s, start=a)
   1322         elif s[a] == FriCASElement._STRINGMARKER:
   1323             return FriCASElement._parse_string(s, start=a)

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)
   1361         args = []
   1362         while s[a] != FriCASElement._RIGHTBRACKET:
-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)
   1364             args.append(e)
   1365             a += 1

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)
   1319
   1320         if s[a] == FriCASElement._LEFTBRACKET:
-> 1321             return FriCASElement._parse_list(s, start=a)
   1322         elif s[a] == FriCASElement._STRINGMARKER:
   1323             return FriCASElement._parse_string(s, start=a)

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)
   1361         args = []
   1362         while s[a] != FriCASElement._RIGHTBRACKET:
-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)
   1364             args.append(e)
   1365             a += 1

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)
   1319
   1320         if s[a] == FriCASElement._LEFTBRACKET:
-> 1321             return FriCASElement._parse_list(s, start=a)
   1322         elif s[a] == FriCASElement._STRINGMARKER:
   1323             return FriCASElement._parse_string(s, start=a)

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)
   1361         args = []
   1362         while s[a] != FriCASElement._RIGHTBRACKET:
-> 1363             e, a = FriCASElement._parse_and_eval(s, start=a)
   1364             args.append(e)
   1365             a += 1

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_and_eval(s, start)
   1319
   1320         if s[a] == FriCASElement._LEFTBRACKET:
-> 1321             return FriCASElement._parse_list(s, start=a)
   1322         elif s[a] == FriCASElement._STRINGMARKER:
   1323             return FriCASElement._parse_string(s, start=a)

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/interfaces/fricas.py in _parse_list(s, start)
   1364             args.append(e)
   1365             a += 1
-> 1366         return fun(*args), a
   1367
   1368     @staticmethod

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.c:10972)()
   1031             res = self._evalf_try_(*args)
   1032             if res is None:
-> 1033                 res = super(BuiltinFunction, self).__call__(
   1034                         *args, coerce=coerce, hold=hold)
   1035

~/DATA/sage-9.6/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.c:5588)()
    513         """
    514         if self._nargs > 0 and len(args) != self._nargs:
--> 515             raise TypeError("Symbolic function %s takes exactly %s arguments (%s given)" % (self._name, self._nargs, len(args)))
    516
    517         # if the given input is a symbolic expression, we don't convert it back

TypeError: Symbolic function elliptic_ec takes exactly 1 arguments (2 given)

```


Here is the result using fricas directly



```
>fricas
FRICAS="/usr/local/lib/fricas/target/x86_64-linux-gnu"
spad-lib="/usr/local/lib/fricas/target/x86_64-linux-gnu/lib/libspad.so"
                       FriCAS Computer Algebra System
                            Version: FriCAS 1.3.8
                   Timestamp: Tue Jun 21 15:11:38 CDT 2022


(22) -> setSimplifyDenomsFlag(true)
(23) -> anti:=integrate((f*x^3+e*x^2+d*x+c)*(b*x^4+a)^(1/2),x);
(24) -> unparse(anti::InputForm)

  "(((-12)*a*e+20*b*c)*x*2^(1/2)*(((-4)*a)/b)^(1/2)*b^(1/2)*((((-4)*a)/b)^(1/2)
  )^(1/2)*ellipticF((((((-4)*a)/b)^(1/2))^(1/2))/(x*2^(1/2)),-1)+(12*a*e*x*2^(1
  /2)*(((-4)*a)/b)^(1/2)*b^(1/2)*((((-4)*a)/b)^(1/2))^(1/2)*ellipticE((((((-4)*
  a)/b)^(1/2))^(1/2))/(x*2^(1/2)),-1)+(15*a*d*x*b^(1/2)*log((-2)*b*x^2*(b*x^4+a
  )^(1/2)+((-2)*b*x^4+(-1)*a)*b^(1/2))+(20*b*f*x^5+24*b*e*x^4+30*b*d*x^3+40*b*c
  *x^2+20*a*f*x+48*a*e)*(b*x^4+a)^(1/2))))/(120*b*x)"

```


You can see Fricas result do not contain **elliptic_ec**

Is this a translation problem?  Is there something I can do to fix this before running this integral? Right now many integrals are failing using fricas due to this when they should not be failing.

Here is link to [sagemath documentation](https://doc.sagemath.org/html/en/reference/functions/sage/functions/special.html#sage.functions.special.EllipticEC) on special functions



Issue created by migration from https://trac.sagemath.org/ticket/34058





---

archive/issue_comments_479926.json:
```json
{
    "body": "see #34062",
    "created_at": "2022-06-24T15:20:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479926",
    "user": "https://github.com/fchapoton"
}
```

see #34062



---

archive/issue_comments_479927.json:
```json
{
    "body": "It seems that FriCAS' ellipticE is different from sage's elliptic_e:\n\n```\nsage: var(\"y\")\ny\nsage: fricas.ellipticE(x, y).D(x)\n +---------+\n |   2\n\\|- x y + 1\n------------\n  +--------+\n  |   2\n \\|- x  + 1\n\nsage: fricas.ellipticE(x, y).D(y)\n- ellipticF(x,y) + ellipticE(x,y)\n---------------------------------\n               2 y\n\nsage: ascii_art(elliptic_e(x, y).diff(x))\n   _________________\n  /        2        \n\\/  - y*sin (x) + 1 \n\nsage: ascii_art(elliptic_e(x, y).diff(y))\nE(x|y) - F(x|y)\n---------------\n      2*y      \n\n```\n\nDo you know the precise relationship?",
    "created_at": "2022-06-25T09:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479927",
    "user": "https://github.com/mantepse"
}
```

It seems that FriCAS' ellipticE is different from sage's elliptic_e:

```
sage: var("y")
y
sage: fricas.ellipticE(x, y).D(x)
 +---------+
 |   2
\|- x y + 1
------------
  +--------+
  |   2
 \|- x  + 1

sage: fricas.ellipticE(x, y).D(y)
- ellipticF(x,y) + ellipticE(x,y)
---------------------------------
               2 y

sage: ascii_art(elliptic_e(x, y).diff(x))
   _________________
  /        2        
\/  - y*sin (x) + 1 

sage: ascii_art(elliptic_e(x, y).diff(y))
E(x|y) - F(x|y)
---------------
      2*y      

```

Do you know the precise relationship?



---

archive/issue_comments_479928.json:
```json
{
    "body": "a reference is 19.2.5 in\n\nhttps://dlmf.nist.gov/19.2",
    "created_at": "2022-06-25T11:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479928",
    "user": "https://github.com/fchapoton"
}
```

a reference is 19.2.5 in

https://dlmf.nist.gov/19.2



---

archive/issue_comments_479929.json:
```json
{
    "body": "see also the comment before (53) in\n\nhttps://mathworld.wolfram.com/EllipticIntegral.html\n\nwhich explains the different competing notations\n\nEDIT:\n\nsee rather https://mathworld.wolfram.com/EllipticIntegraloftheSecondKind.html",
    "created_at": "2022-06-25T11:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479929",
    "user": "https://github.com/fchapoton"
}
```

see also the comment before (53) in

https://mathworld.wolfram.com/EllipticIntegral.html

which explains the different competing notations

EDIT:

see rather https://mathworld.wolfram.com/EllipticIntegraloftheSecondKind.html



---

archive/issue_comments_479930.json:
```json
{
    "body": "Fricas : `E(z,m) = integrate(sqrt(1-m*t<sup>2)/sqrt(1-t</sup>2), t = 0..z)`\n\nSage : `E(phi,m) = integrate(sqrt(1-m*sin(t)^2), t = 0..phi)`\n\nSo Fricas definition is non-standard but with respect to z !\n\nUgly conversion : `z = sin(phi)`",
    "created_at": "2022-06-25T12:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479930",
    "user": "https://github.com/fchapoton"
}
```

Fricas : `E(z,m) = integrate(sqrt(1-m*t<sup>2)/sqrt(1-t</sup>2), t = 0..z)`

Sage : `E(phi,m) = integrate(sqrt(1-m*sin(t)^2), t = 0..phi)`

So Fricas definition is non-standard but with respect to z !

Ugly conversion : `z = sin(phi)`



---

archive/issue_comments_479931.json:
```json
{
    "body": "For the complete elliptic integral, we are fine?",
    "created_at": "2022-06-25T13:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479931",
    "user": "https://github.com/mantepse"
}
```

For the complete elliptic integral, we are fine?



---

archive/issue_comments_479932.json:
```json
{
    "body": "yes, and there is already a doctest for that in \n\nsrc/sage/functions/special.py",
    "created_at": "2022-06-25T16:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479932",
    "user": "https://github.com/fchapoton"
}
```

yes, and there is already a doctest for that in 

src/sage/functions/special.py



---

archive/issue_comments_479933.json:
```json
{
    "body": "doctest will be provided tomorrow or so\n----\nNew commits:",
    "created_at": "2022-06-25T17:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479933",
    "user": "https://github.com/mantepse"
}
```

doctest will be provided tomorrow or so
----
New commits:



---

archive/issue_comments_479934.json:
```json
{
    "body": "not sure that it's a good idea to build upon #34062, which may be in a very unstable state\n\nany idea why Fricas does not use the standard definitions ? already for dilog..",
    "created_at": "2022-06-25T18:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479934",
    "user": "https://github.com/fchapoton"
}
```

not sure that it's a good idea to build upon #34062, which may be in a very unstable state

any idea why Fricas does not use the standard definitions ? already for dilog..



---

archive/issue_comments_479935.json:
```json
{
    "body": "I'm not sure, but I think without #34062 it won't work, because `fricas.ellipticE` accepts one or two arguments.",
    "created_at": "2022-06-26T08:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479935",
    "user": "https://github.com/mantepse"
}
```

I'm not sure, but I think without #34062 it won't work, because `fricas.ellipticE` accepts one or two arguments.



---

archive/issue_comments_479936.json:
```json
{
    "body": "Fyi, list of Fricas special functions and their signatures at\n\nhttps://fricas.github.io/api/SpecialFunctionCategory.html\n\nFrom the above:\n\n\n\n```\nellipticE(m) is the complete elliptic integral of the second kind: ellipticE(m) = integrate(sqrt(1-m*t^2)/sqrt(1-t^2), t = 0..1).\n\nellipticE(z, m) is the incomplete elliptic integral of the second kind: ellipticE(z, m) = integrate(sqrt(1-m*t^2)/sqrt(1-t^2), t = 0..z).\n\n```\n",
    "created_at": "2022-06-26T08:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479936",
    "user": "https://github.com/nasser1"
}
```

Fyi, list of Fricas special functions and their signatures at

https://fricas.github.io/api/SpecialFunctionCategory.html

From the above:



```
ellipticE(m) is the complete elliptic integral of the second kind: ellipticE(m) = integrate(sqrt(1-m*t^2)/sqrt(1-t^2), t = 0..1).

ellipticE(z, m) is the incomplete elliptic integral of the second kind: ellipticE(z, m) = integrate(sqrt(1-m*t^2)/sqrt(1-t^2), t = 0..z).

```




---

archive/issue_comments_479937.json:
```json
{
    "body": "Should we somehow deal that the conversion is only valid for `phi` between -pi/2 and pi/2?",
    "created_at": "2022-06-26T21:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479937",
    "user": "https://github.com/mantepse"
}
```

Should we somehow deal that the conversion is only valid for `phi` between -pi/2 and pi/2?



---

archive/issue_comments_479938.json:
```json
{
    "body": "re comment:11: I don't think it's nonstandard, see https://en.wikipedia.org/wiki/Elliptic_integral",
    "created_at": "2022-06-26T21:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479938",
    "user": "https://github.com/mantepse"
}
```

re comment:11: I don't think it's nonstandard, see https://en.wikipedia.org/wiki/Elliptic_integral



---

archive/issue_comments_479939.json:
```json
{
    "body": "Changing keywords from \"fricas intergate symbolic\" to \"FriCAS\".",
    "created_at": "2022-06-26T21:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479939",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "fricas intergate symbolic" to "FriCAS".



---

archive/issue_comments_479940.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-27T06:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479941.json:
```json
{
    "body": "Replying to [comment:15 mantepse]:\n> re comment:11: I don't think it's nonstandard, see https://en.wikipedia.org/wiki/Elliptic_integral\n\nWikipedia is **not a valid reference** for scientific purposes. It uses a confusing notation with functions `E(*,*)` and `E(*;*)`.",
    "created_at": "2022-06-27T06:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479941",
    "user": "https://github.com/fchapoton"
}
```

Replying to [comment:15 mantepse]:
> re comment:11: I don't think it's nonstandard, see https://en.wikipedia.org/wiki/Elliptic_integral

Wikipedia is **not a valid reference** for scientific purposes. It uses a confusing notation with functions `E(*,*)` and `E(*;*)`.



---

archive/issue_comments_479942.json:
```json
{
    "body": "Ping? (especially comment:14)",
    "created_at": "2022-07-05T08:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479942",
    "user": "https://github.com/mantepse"
}
```

Ping? (especially comment:14)



---

archive/issue_comments_479943.json:
```json
{
    "body": "the doctest in `/src/sage/functions/special.py` is missing the `# optional - fricas` tag\n\nand the doctest there must now start with `r\"\"\"`",
    "created_at": "2022-07-05T09:40:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479943",
    "user": "https://github.com/fchapoton"
}
```

the doctest in `/src/sage/functions/special.py` is missing the `# optional - fricas` tag

and the doctest there must now start with `r"""`



---

archive/issue_comments_479944.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-05T11:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479944",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479945.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-06T12:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479945",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_479946.json:
```json
{
    "body": "ok, let's go\n\nnote that the correct `dilog` function exists in fricas under then name `li2`. We should fix the forward conversion in another ticket.",
    "created_at": "2022-07-06T12:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479946",
    "user": "https://github.com/fchapoton"
}
```

ok, let's go

note that the correct `dilog` function exists in fricas under then name `li2`. We should fix the forward conversion in another ticket.



---

archive/issue_comments_479947.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-06T18:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479947",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_479948.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-10T22:34:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479948",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_479949.json:
```json
{
    "body": "I tested this in sagemath 9.7 beta 5 on Linux. \n\nBut it is still not correct.\n\nEven though there is no exception now, which is good, but the result from Fricas 1.3.8 returns ellipticF but there is no ellipticF in sagemath. \n\nIt should have been translated to sagemath elliptic_f ?\n\n\n\n```\n>./sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.7.beta5, Release Date: 2022-07-10               \u2502\n\u2502 Using Python 3.10.5. Type \"help()\" for help.                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: var('a b c x d')\n(a, b, c, x, d)\nsage: integrate((b*x^2+a)^(1/2)*(d*x^2+c)^(1/2),x, algorithm=\"fricas\")\n1/3*((b*d^2*x^2 + b*c*d + a*d^2)*sqrt(b*x^2 + a)*sqrt(d*x^2 + c)*sqrt(b*d)*sqrt(-c/d) - (b^2*c^3 + a*b*c^2*d + 2*a*b*c*d^2)*x*ellipticF(sqrt(-c/d)/x, a*d/(b*c)) + (b^2*c^3 + a*b*c^2*d)*x*elliptic_e(arcsin(sqrt(-c/d)/x), a*d/(b*c)))/(sqrt(b*d)*b*d^2*x*sqrt(-c/d))\nsage: ?ellipticF\nObject `ellipticF` not found.\n\n\n```\n\n\n\n--Nasser",
    "created_at": "2022-07-15T02:27:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479949",
    "user": "https://github.com/nasser1"
}
```

I tested this in sagemath 9.7 beta 5 on Linux. 

But it is still not correct.

Even though there is no exception now, which is good, but the result from Fricas 1.3.8 returns ellipticF but there is no ellipticF in sagemath. 

It should have been translated to sagemath elliptic_f ?



```
>./sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.7.beta5, Release Date: 2022-07-10               │
│ Using Python 3.10.5. Type "help()" for help.                       │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: var('a b c x d')
(a, b, c, x, d)
sage: integrate((b*x^2+a)^(1/2)*(d*x^2+c)^(1/2),x, algorithm="fricas")
1/3*((b*d^2*x^2 + b*c*d + a*d^2)*sqrt(b*x^2 + a)*sqrt(d*x^2 + c)*sqrt(b*d)*sqrt(-c/d) - (b^2*c^3 + a*b*c^2*d + 2*a*b*c*d^2)*x*ellipticF(sqrt(-c/d)/x, a*d/(b*c)) + (b^2*c^3 + a*b*c^2*d)*x*elliptic_e(arcsin(sqrt(-c/d)/x), a*d/(b*c)))/(sqrt(b*d)*b*d^2*x*sqrt(-c/d))
sage: ?ellipticF
Object `ellipticF` not found.


```



--Nasser



---

archive/issue_comments_479950.json:
```json
{
    "body": "Should I open a new ticket on this new issues since this ticket is closed?",
    "created_at": "2022-07-15T05:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479950",
    "user": "https://github.com/nasser1"
}
```

Should I open a new ticket on this new issues since this ticket is closed?



---

archive/issue_comments_479951.json:
```json
{
    "body": "Yes, please!",
    "created_at": "2022-07-15T08:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479951",
    "user": "https://github.com/mantepse"
}
```

Yes, please!



---

archive/issue_comments_479952.json:
```json
{
    "body": "OK. Created new ticket. Here is the link to it\n\nhttps://trac.sagemath.org/ticket/34186 \n\nThanks",
    "created_at": "2022-07-15T08:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33821#issuecomment-479952",
    "user": "https://github.com/nasser1"
}
```

OK. Created new ticket. Here is the link to it

https://trac.sagemath.org/ticket/34186 

Thanks
