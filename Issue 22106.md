# Issue 22106: Elliptic curve isogenies over number fields I: speed up Larsen's algorithm for redicible primes

Issue created by migration from Trac.

Original creator: cremona

Original creation time: 2017-02-10 14:38:15

CC:  aly.deines jpflori

This ticket is part 1 of 2.  When running Larsen's algorithm over fields of degree 5 or more, E.reducible_primes() takes for ever for at least two reasons: (1) computation of the Galois closure; (2) arithmetic over that closure.  I have an improvement which avoids working in the closure at all, using instead some polynomial utilities based on resultants.

On this ticket I will add the polynomial utilities and the improved version of the function `_supersingular_reducible_primes`.

On a second ticket I will add an implementation of a different method, due to Bilieray, for finding the reducible primes.


---

Comment by cremona created at 2017-02-22 10:20:04

I have a branch now testing which should be ready for review soon.  It is much faster over degree 5 and 6 fields with large Galois closure (e.g. for an S5 quintic it goes from taking hours to just fast) but is possibly slower when the Galois group is small (e.g. when the base field is already Galois).  In addition, there is a step in the original implementation which I do not understand mathematically -- in the unusual case where anauxiliary imaginary quadratic field comes into play, I can see that it is a subfield of Kgal (the Galois closure) but not of K itself.  There is only one doctest for this case, when K=Kgal (=imagainary quadratic) anyway.  If there is ever an example where the quadratic is not a subfield of K, the code will break -- this is also true of the current code though.


---

Comment by cremona created at 2017-02-22 13:37:40

Changing status from new to needs_review.


---

Comment by cremona created at 2017-02-22 13:37:40

New commits:


---

Comment by cremona created at 2017-02-22 13:37:40

Changing priority from major to minor.


---

Comment by cremona created at 2017-02-22 13:41:22

The first two commits add some methods for univariate polynomials, not specific to elliptic curves.  The third rewrites the code in the _semistable_reducible_primes() function.  My intention is to leave the algorithm essentially unchanged while making it possible to run over fields where the Galois closure is large -- in the new version it is not necessary to compute the Galois closure at all.

If it would be helpful, I could provide a longer explanation of what I changed and why this is equivalent to the old version, but the fact that no doctests needed changing is a good sign!  I could add an example over a degree 5 field with Galois group S5, which is now possible (and quite fast).


---

Comment by git created at 2017-02-22 13:48:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cremona created at 2017-02-22 15:16:25

Replying to [comment:6 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[533dd93](https://git.sagemath.org/sage.git/commit/?id=533dd93f556d70b92118c1bc04aa2e48d7922805)||`#22343 new doctest added`||

The new doctest runs in <1s (using %timeit) while using Sage 7.5 it is still running after [90 minutes] 54 hours...


---

Comment by chapoton created at 2017-02-24 21:02:28


```
+[dochtml] [polynomia] docstring of sage.rings.polynomial.polynomial_element.Polynomial.adams_operator:1: WARNING: Inline interpreted text or phrase reference start-string without end-string.
+[dochtml] [polynomia] docstring of sage.rings.polynomial.polynomial_element.Polynomial.compose_power:14: WARNING: Inline interpreted text or phrase reference start-string without end-string.
+[dochtml] [polynomia] docstring of sage.rings.polynomial.polynomial_element.Polynomial.symmetric_power:1: WARNING: Inline interpreted text or phrase reference start-string without end-string.
+[dochtml] Error building the documentation.
```


There is a `+        TESTS:` missing a double colon.


---

Comment by git created at 2017-02-26 15:16:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cremona created at 2017-02-26 15:17:27

Thanks, I think that is fixed now.  I wish testing docstring syntax were easier.


---

Comment by chapoton created at 2017-04-09 07:51:50

I have made a cosmetic cleanup of your code and doc. In particular, note that

* one should rather avoid using $
* TESTS:: are not displayed in the doc

If you agree with my changes, you can set to positive review
----
New commits:


---

Comment by cremona created at 2017-04-09 11:50:46

I do agree -- thanks.


---

Comment by cremona created at 2017-04-09 11:50:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-04-11 22:22:48

Resolution: fixed
