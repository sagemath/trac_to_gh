# Issue 27984: minor improvement in bidirectional_dijkstra

Issue created by migration from https://trac.sagemath.org/ticket/28221

Original creator: @rajat1433

Original creation time: 2019-07-21 02:23:14

CC:  dcoudert

While reading some cython codes I came across this code and found a variable can be converted to cython. Its very minor but I thought it must be fixed.


---

Comment by git created at 2019-07-21 02:25:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @rajat1433 created at 2019-07-21 02:25:58

Changing status from new to needs_review.


---

Comment by @rajat1433 created at 2019-07-21 02:41:29

I think it can be improved further as the distance can be float so 



```

cdef int distance

cdef priority_queue[pair[pair[int, int], pair[int, int]]] pq

```


can be changed to 


```

cdef double distance

cdef priority_queue[pair[pair[double, int], pair[int, int]]] pq
```


waiting for your thoughts on it....


---

Comment by dcoudert created at 2019-07-21 05:02:50

Try to do the change and check if it passes all doctests.


---

Comment by git created at 2019-07-21 05:48:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-07-22 00:52:13

You should sometimes run `./sage -btp --long src/sage/graphs/`


```
sage -t src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 14446, in sage.graphs.generic_graph.GenericGraph.distance
Failed example:
    G.distance(0, 3, by_weight=True)
Expected:
    3
Got:
    3.0
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 16362, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    D.shortest_path_length(4, 9, algorithm='Dijkstra_Bid')
Expected:
    5
Got:
    5.0
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 16375, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    G.shortest_path_length(0, 3, by_weight=True)
Expected:
    3
Got:
    3.0
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 16397, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    G.shortest_path_length(0, 2, by_weight=True)
Expected:
    2
Got:
    2.0
**********************************************************************
2 items had failures:
   3 of 858 in sage.graphs.generic_graph.GenericGraph.?
   1 of  10 in sage.graphs.generic_graph.GenericGraph.distance
    [3470 tests, 4 failures, 50.62 s]
```


Can you check for instance in the boost backend for a method to turn the result to int when possible ? It would be a smarter solution than just changing the doctests.


---

Comment by dcoudert created at 2019-07-22 00:52:13

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-07-22 05:32:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @rajat1433 created at 2019-07-22 05:32:58

Changing status from needs_work to needs_review.


---

Comment by @rajat1433 created at 2019-07-22 15:02:06

Changing priority from minor to major.


---

Comment by dcoudert created at 2019-07-22 15:32:13

this might be better

```
sage: from sage.rings.integer_ring import ZZ
sage: 3.0 in ZZ
True
sage: 3.1 in ZZ
False
```

I don't know if we have a faster (cython level) method.


---

Comment by git created at 2019-07-23 00:42:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-07-23 04:34:44

LGTM


---

Comment by dcoudert created at 2019-07-23 04:34:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-07-28 22:54:34

Merge conflict


---

Comment by vbraun created at 2019-07-28 22:54:34

Changing status from positive_review to needs_work.


---

Comment by git created at 2019-07-29 01:25:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @rajat1433 created at 2019-07-29 01:29:31

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2019-07-29 07:16:49

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-07-29 07:16:49

LGTM.


---

Comment by vbraun created at 2019-07-30 22:18:24

Author name is missing


---

Comment by vbraun created at 2019-07-30 22:18:24

Changing status from positive_review to needs_work.


---

Comment by @rajat1433 created at 2019-07-31 01:39:14

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2019-07-31 06:42:32

OK


---

Comment by dcoudert created at 2019-07-31 06:42:32

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-07-31 06:44:05

Changing keywords from "" to "gsoc19".


---

Comment by vbraun created at 2019-08-03 23:51:40

Resolution: fixed
