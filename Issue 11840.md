# Issue 11840: 'make distclean' should clean up start.log, spkg/parallel_make.cfg

archive/issues_011840.json:
```json
{
    "body": "Assignee: GeorgSWeber\n\nCC:  @jdemeyer @nexttime @orlitzky\n\nThe patch (to the root repo) removes start.log and spkg/parallel_make.cfg when you run \"make distclean\".\n\nIssue created by migration from https://trac.sagemath.org/ticket/12012\n\n",
    "created_at": "2011-11-11T16:17:01Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "'make distclean' should clean up start.log, spkg/parallel_make.cfg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11840",
    "user": "https://github.com/jhpalmieri"
}
```
Assignee: GeorgSWeber

CC:  @jdemeyer @nexttime @orlitzky

The patch (to the root repo) removes start.log and spkg/parallel_make.cfg when you run "make distclean".

Issue created by migration from https://trac.sagemath.org/ticket/12012





---

archive/issue_comments_135264.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-11-11T18:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135264",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_135265.json:
```json
{
    "body": "root repo",
    "created_at": "2011-11-11T19:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135265",
    "user": "https://github.com/jhpalmieri"
}
```

root repo



---

archive/issue_comments_135266.json:
```json
{
    "body": "Attachment [trac_12012-distclean.patch](tarball://root/attachments/some-uuid/ticket12012/trac_12012-distclean.patch) by @jhpalmieri created at 2011-11-23 18:08:39\n\nI'm upgrading this to \"blocker\": running 'make distclean' shouldn't break your Sage distribution.  It does now because it deletes the ipython directory.  (The patch is also easy to review, I think.)",
    "created_at": "2011-11-23T18:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135266",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_12012-distclean.patch](tarball://root/attachments/some-uuid/ticket12012/trac_12012-distclean.patch) by @jhpalmieri created at 2011-11-23 18:08:39

I'm upgrading this to "blocker": running 'make distclean' shouldn't break your Sage distribution.  It does now because it deletes the ipython directory.  (The patch is also easy to review, I think.)



---

archive/issue_comments_135267.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2011-11-23T18:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135267",
    "user": "https://github.com/jhpalmieri"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_135268.json:
```json
{
    "body": "Replying to [comment:4 jhpalmieri]:\n> It does now because it deletes the ipython directory.  (The patch is also easy to review, I think.)\nWhat exactly is the `ipython` directory needed for?  I just deleted the `ipython` directory from a sage-4.8.alpha2 installation and everything still seems to work fine.",
    "created_at": "2011-11-24T11:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135268",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:4 jhpalmieri]:
> It does now because it deletes the ipython directory.  (The patch is also easy to review, I think.)
What exactly is the `ipython` directory needed for?  I just deleted the `ipython` directory from a sage-4.8.alpha2 installation and everything still seems to work fine.



---

archive/issue_comments_135269.json:
```json
{
    "body": "Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.",
    "created_at": "2011-11-24T16:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135269",
    "user": "https://github.com/jhpalmieri"
}
```

Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.



---

archive/issue_comments_135270.json:
```json
{
    "body": "Replying to [comment:6 jhpalmieri]:\n> Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.\n\nIf you've just run `make distclean`, how will $DOT_SAGE get created?",
    "created_at": "2011-11-30T18:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135270",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:6 jhpalmieri]:
> Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.

If you've just run `make distclean`, how will $DOT_SAGE get created?



---

archive/issue_comments_135271.json:
```json
{
    "body": "Replying to [comment:7 mjo]:\n> Replying to [comment:6 jhpalmieri]:\n> > Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.\n> \n> If you've just run `make distclean`, how will $DOT_SAGE get created?\n\nI don't think I understand your question.  The point of the patch here is that if you download a Sage source distribution and run `make distclean`, it breaks the distribution: the Sage root repository is no longer clean, and more importantly, if you have no `$DOT_SAGE` directory, then when you build and run Sage, it will fail when it tries to create `DOT_SAGE/ipython/`.",
    "created_at": "2011-11-30T19:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135271",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:7 mjo]:
> Replying to [comment:6 jhpalmieri]:
> > Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.
> 
> If you've just run `make distclean`, how will $DOT_SAGE get created?

I don't think I understand your question.  The point of the patch here is that if you download a Sage source distribution and run `make distclean`, it breaks the distribution: the Sage root repository is no longer clean, and more importantly, if you have no `$DOT_SAGE` directory, then when you build and run Sage, it will fail when it tries to create `DOT_SAGE/ipython/`.



---

archive/issue_comments_135272.json:
```json
{
    "body": "Replying to [comment:8 jhpalmieri]:\n> \n> I don't think I understand your question.  The point of the patch here is that if you download a Sage source distribution and run `make distclean`, it breaks the distribution: the Sage root repository is no longer clean, and more importantly, if you have no `$DOT_SAGE` directory, then when you build and run Sage, it will fail when it tries to create `DOT_SAGE/ipython/`.\n\nOh, sorry. I thought the ipython directory would be recreated after a build, and I had to `make distclean` and then sit through a full rebuild to see that's not the case.\n\nI have reviewed:\n\n1. Confirm that spkg/parallel_make.cfg gets created/used in the following:\n\n   * spkg/install\n   * spkg/standard/deps\n\n2. Confirm that start.log should be removed.\n\n3. `make distclean`. Remove my ~/.sage directory. Build and try to start sage. Crashes per the ticket.\n\n\nSo, looks good.",
    "created_at": "2011-11-30T19:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135272",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:8 jhpalmieri]:
> 
> I don't think I understand your question.  The point of the patch here is that if you download a Sage source distribution and run `make distclean`, it breaks the distribution: the Sage root repository is no longer clean, and more importantly, if you have no `$DOT_SAGE` directory, then when you build and run Sage, it will fail when it tries to create `DOT_SAGE/ipython/`.

Oh, sorry. I thought the ipython directory would be recreated after a build, and I had to `make distclean` and then sit through a full rebuild to see that's not the case.

I have reviewed:

1. Confirm that spkg/parallel_make.cfg gets created/used in the following:

   * spkg/install
   * spkg/standard/deps

2. Confirm that start.log should be removed.

3. `make distclean`. Remove my ~/.sage directory. Build and try to start sage. Crashes per the ticket.


So, looks good.



---

archive/issue_comments_135273.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-30T19:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135273",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_011898.json:
```json
{
    "actor": "@jdemeyer",
    "created_at": "2011-11-30T20:44:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11840#event-11898"
}
```



---

archive/issue_comments_135274.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-30T20:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11840",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11840#issuecomment-135274",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
