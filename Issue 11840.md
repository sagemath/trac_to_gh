# Issue 11840: 'make distclean' should clean up start.log, spkg/parallel_make.cfg

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2011-11-11 16:17:01

Assignee: GeorgSWeber

CC:  jdemeyer leif mjo

The patch (to the root repo) removes start.log and spkg/parallel_make.cfg when you run "make distclean".


---

Comment by jhpalmieri created at 2011-11-11 18:53:20

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2011-11-11 19:16:11

root repo


---

Attachment

I'm upgrading this to "blocker": running 'make distclean' shouldn't break your Sage distribution.  It does now because it deletes the ipython directory.  (The patch is also easy to review, I think.)


---

Comment by jhpalmieri created at 2011-11-23 18:08:39

Changing priority from major to blocker.


---

Comment by jdemeyer created at 2011-11-24 11:20:43

Replying to [comment:4 jhpalmieri]:
> It does now because it deletes the ipython directory.  (The patch is also easy to review, I think.)
What exactly is the `ipython` directory needed for?  I just deleted the `ipython` directory from a sage-4.8.alpha2 installation and everything still seems to work fine.


---

Comment by jhpalmieri created at 2011-11-24 16:21:07

Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.


---

Comment by mjo created at 2011-11-30 18:26:53

Replying to [comment:6 jhpalmieri]:
> Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.

If you've just run `make distclean`, how will $DOT_SAGE get created?


---

Comment by jhpalmieri created at 2011-11-30 19:34:55

Replying to [comment:7 mjo]:
> Replying to [comment:6 jhpalmieri]:
> > Well, if you don't have a DOT_SAGE directory, the contents from SAGE_ROOT/ipython/ are copied to DOT_SAGE/ipython when DOT_SAGE is created.
> 
> If you've just run `make distclean`, how will $DOT_SAGE get created?

I don't think I understand your question.  The point of the patch here is that if you download a Sage source distribution and run `make distclean`, it breaks the distribution: the Sage root repository is no longer clean, and more importantly, if you have no `$DOT_SAGE` directory, then when you build and run Sage, it will fail when it tries to create `DOT_SAGE/ipython/`.


---

Comment by mjo created at 2011-11-30 19:55:21

Replying to [comment:8 jhpalmieri]:
> 
> I don't think I understand your question.  The point of the patch here is that if you download a Sage source distribution and run `make distclean`, it breaks the distribution: the Sage root repository is no longer clean, and more importantly, if you have no `$DOT_SAGE` directory, then when you build and run Sage, it will fail when it tries to create `DOT_SAGE/ipython/`.

Oh, sorry. I thought the ipython directory would be recreated after a build, and I had to `make distclean` and then sit through a full rebuild to see that's not the case.

I have reviewed:

1. Confirm that spkg/parallel_make.cfg gets created/used in the following:

   * spkg/install
   * spkg/standard/deps

2. Confirm that start.log should be removed.

3. `make distclean`. Remove my ~/.sage directory. Build and try to start sage. Crashes per the ticket.


So, looks good.


---

Comment by mjo created at 2011-11-30 19:55:21

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-11-30 20:44:41

Resolution: fixed
