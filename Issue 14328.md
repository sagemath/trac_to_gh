# Issue 14328: Symplectic graphs

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2013-05-05 10:49:31

Assignee: jason, ncohen, rlm

CC:  azi

Brand new pretty graphs `:-P`

Nathann


---

Comment by ncohen created at 2013-05-05 10:50:03

Changing status from new to needs_review.


---

Comment by azi created at 2013-05-07 11:51:37

Hello!

Sry for comming back at you so late. I had some other stuff lately!

Anways, the code looks fine (read it, run it, and obviously run sage -t) I only have two remarks.

1. Maybe we should check if d is even and also nonzero (perhaps >= 2) since that is also a invalid parameter.

2. I would change the line  

```
 Graph([map(tuple,PV), lambda x,y:V(x)*(M*V(y)) == 0], loops = False) 
}}} to

{{{
{{{
 Graph((map(tuple,PV), lambda x,y:V(x)*(M*V(y)) == 0), loops = False) 
}}} 
}}}

which should be 2x faster.

Best,

Jernej


---

Comment by ncohen created at 2013-05-07 12:12:12

Helloooooooooooooo !!

> Sry for comming back at you so late. I had some other stuff lately!

Come on, I am already very thankful that you take the time to review these patches !!!

> 1. Maybe we should check if d is even and also nonzero (perhaps >= 2) since that is also a invalid parameter.

Done

> 2. I would change the line  
> {{{
>  Graph([map(tuple,PV), lambda x,y:V(x)*(M*V(y)) == 0], loops = False) 
> }}} to
> 
> {{{
> {{{
>  Graph((map(tuple,PV), lambda x,y:V(x)*(M*V(y)) == 0), loops = False) 
> }}} 
> }}}
> 
> which should be 2x faster.

`O_o`

Here is what I get when I change it : 

```
sage: graphs.SymplecticGraph(4,4)         
...
NetworkXError: Input is not a known data type for conversion.
```


But what do you think it should do, and why do you think that it should be 2x faster ? `O_o`

Nathann


---

Comment by azi created at 2013-05-07 12:35:58

I may be shooting random nonsense of course but in general it is much better to not create lists [] but iterators (). Since in the former case a list has to first be created (1 for loop) and then iterated over (2 for loop). Example


```
sage: %timeit max((i for i in xrange(100)))
100000 loops, best of 3: 14.5 us per loop
sage: %timeit max([i for i in xrange(100)])
10000 loops, best of 3: 30 us per loop
```


and even faster in this case would be


```
sage: %timeit 99
1000000 loops, best of 3: 429 ns per loo
```



---

Comment by ncohen created at 2013-05-07 12:38:45

Yepyep but no list is created in this case. A list of size 2 is given to the Graph constructor : the first element is a list of vertices, the second element is a function that gives adjacent pairs.

Nathann


---

Comment by azi created at 2013-05-07 12:42:03

Oh FML you see sometimes I do shoot random nonsense!

In this case the patch is ofc OK. If I were to do this I would make the additional test check (since we're already doing them) but its fine as is as well.


---

Comment by chapoton created at 2013-05-07 16:10:47

there is a typo in "simplectic" at least twice


---

Comment by ncohen created at 2013-05-07 16:25:58

> there is a typo in "simplectic" at least twice

Arggggggggg... Fixed `:-P`

Most probably because of that cursed sImplex `:-P`

Nathann


---

Attachment

hello,

if you are happy with my review patch (just removing unused imports), you can set a positive review on my behalf.


---

Attachment


---

Comment by chapoton created at 2013-05-09 16:13:52

Changing keywords from "" to "strongly regular graphs".


---

Comment by ncohen created at 2013-05-09 18:14:23

All tests pass ! Thank you very much for your help `:-)`

Nathann


---

Comment by ncohen created at 2013-05-09 18:14:23

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-05-13 18:46:49


```
sage -t devel/sage/sage/graphs/generators/families.py
**********************************************************************
File "devel/sage/sage/graphs/generators/families.py", line 1992, in sage.graphs.generators.families.SymplecticGraph
Failed example:
    g = graphs.SymplecticGraph(6,2)
Exception raised:
    Traceback (most recent call last):
      File "/mazur/release/merger/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 466, in _run
        self.execute(example, compiled, test.globs)
      File "/mazur/release/merger/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 825, in execute
        exec compiled in globs
      File "<doctest sage.graphs.generators.families.SymplecticGraph[0]>", line 1, in <module>
        g = graphs.SymplecticGraph(Integer(6),Integer(2))
      File "/mazur/release/merger/sage-5.10.beta3/local/lib/python2.7/site-packages/sage/graphs/generators/families.py", line 2000, in SymplecticGraph
        from sage.schemes.generic.projective_space import ProjectiveSpace
    ImportError: No module named projective_space
**********************************************************************
```



---

Comment by jdemeyer created at 2013-05-13 18:46:49

Changing status from positive_review to needs_work.


---

Attachment


---

Comment by ncohen created at 2013-05-14 09:44:48

Changing status from needs_work to positive_review.


---

Comment by ncohen created at 2013-05-14 09:44:48

Rebased !

Nathann


---

Comment by jdemeyer created at 2013-05-17 06:32:53

Resolution: fixed


---

Comment by dimpase created at 2013-05-21 00:22:04

maybe Sage should have "polar space" graphs in general, not, only symplectic ones?


---

Comment by ncohen created at 2013-05-21 07:43:34

Helloooooooo !

> maybe Sage should have "polar space" graphs in general, not, only symplectic ones?

Well, yes it would be nice indeed, but I do not know how to build them. I guess that it only takes 5~6 lines, like for the symplectic ones, but I don't know which ones. Actually, I have no idea on earth what these graphs are, except what I could read (and understand, which is even less) from Brouwer's website.

http://www.win.tue.nl/~aeb/graphs/srg/srgtab.html

I believe I created what he calls a `VO^-` graph (`graphs.BrouwerHaemersGraph`), and the same code worked for different parameters but I was not able to make it work in characteristic two, and so I did not write this more general patch.

If you know how to make it work, I would be glad to see it in Sage too `:-P`

Nathann


---

Comment by dimpase created at 2013-05-21 08:15:49

Replying to [comment:18 ncohen]:
> Helloooooooo !
> 
> > maybe Sage should have "polar space" graphs in general, not, only symplectic ones?
> 
> Well, yes it would be nice indeed, but I do not know how to build them. I guess that it only takes 5~6 lines, like for the symplectic ones, but I don't know which ones. Actually, I have no idea on earth what these graphs are, except what I could read (and understand, which is even less) from Brouwer's website.
> 
> http://www.win.tue.nl/~aeb/graphs/srg/srgtab.html
> 
> I believe I created what he calls a `VO^-` graph (`graphs.BrouwerHaemersGraph`), and the same code worked for different parameters but I was not able to make it work in characteristic two, and so I did not write this more general patch.

no, these are different species. I mean classical polar spaces as introduced by J.Tits (or even long before him). See e.g. Sect 6.5 of http://www.maths.qmul.ac.uk/~pjc/pps/pps6.pdf

To construct these, you need to be able to create the corresponding forms, which are well-studied by group theory, as they lead to finite classical groups. GAP has code to create these forms; it's not completely trivial in characteristic two. You can actually just call GAP!
E.g.

```
gap> Display(InvariantQuadraticForm(GO(1,6,2)).matrix);
 . 1 . . . .
 . . . . . .
 . . . 1 . .
 . . . . . .
 . . . . . 1
 . . . . . .
gap> Display(InvariantQuadraticForm(GO(-1,6,2)).matrix);
 . 1 . . . .
 . . . . . .
 . . 1 1 . .
 . . . 1 . .
 . . . . . 1
 . . . . . .
gap> Display(InvariantSesquilinearForm(GU(6,2)).matrix);
 . . . . . 1
 . . . . 1 .
 . . . 1 . .
 . . 1 . . .
 . 1 . . . .
 1 . . . . .
gap> Display(InvariantBilinearForm(Sp(6,3)).matrix);
 . . . . . 1
 . . . . 1 .
 . . . 1 . .
 . . 2 . . .
 . 2 . . . .
 2 . . . . .
gap> 
```

etc...


---

Comment by dimpase created at 2013-05-21 08:28:04

The more one goes down this road, the more the lack of a proper backend for graphs with big automorphism groups shows. Perhaps we can try implement something next month in Paris.


---

Comment by ncohen created at 2013-05-21 08:31:49

> The more one goes down this road, the more the lack of a proper backend for graphs with big automorphism groups shows. Perhaps we can try implement something next month in Paris.

Ahahah. Well, why not ? But I really know next to nothing about those, and what people use them for `:-)`

Nathann


---

Comment by dimpase created at 2013-05-21 08:54:24

Replying to [comment:21 ncohen]:
> > The more one goes down this road, the more the lack of a proper backend for graphs with big automorphism groups shows. Perhaps we can try implement something next month in Paris.
> 
> Ahahah. Well, why not ? But I really know next to nothing about those, and what people use them for `:-)`
> 
it's useful to 

* store the graphs more compactly
* compute their properties faster

Isn't it obvious? All these graphs you construct lately have huge automorphism groups, often arc-transitive and/or distance-transitive.


---

Comment by ncohen created at 2013-05-21 09:01:53

> Isn't it obvious? 

What do you use them for ? What do you want to compute ? Graphs have a lot of method, you know.. `:-P`

Nathann


---

Comment by ncohen created at 2013-05-21 09:08:46

By the way, and because these graphs are usually immutable (and dense), I wrote a couple of C functions (#14589) to store very compactly an adjacency matrix. Of course it cannot compare with an encoding by generators of the automorphism group, but a graph on 30 000 vertices can be stored on 128MB.

Nathann


---

Comment by dimpase created at 2013-05-21 09:53:02

Replying to [comment:23 ncohen]:
> > Isn't it obvious? 
> 
> What do you use them for ? What do you want to compute ? Graphs have a lot of method, you know.. `:-P`

Obviously, regularity properties - and this is very fast with such data. Then, e.g., 
e.g. maximum cliques, or an optimal colouring. It's downright hopeless to do without taking symmetries into account.
Or Lovasz theta number...


---

Comment by ncohen created at 2013-05-21 10:21:57

> Obviously, regularity properties - and this is very fast with such data. Then, e.g., 
> e.g. maximum cliques, or an optimal colouring. It's downright hopeless to do without taking symmetries into account.
> Or Lovasz theta number...

Hmmm... Looks like you will have an awful amount of code to write `:-P`

Nathann


---

Comment by dimpase created at 2013-05-21 10:24:08

Replying to [comment:26 ncohen]:
> > Obviously, regularity properties - and this is very fast with such data. Then, e.g., 
> > e.g. maximum cliques, or an optimal colouring. It's downright hopeless to do without taking symmetries into account.
> > Or Lovasz theta number...
> 
> Hmmm... Looks like you will have an awful amount of code to write `:-P`

I wouldn't classify calls to GAP as "awful amount of code" :)


---

Comment by ncohen created at 2013-05-21 10:25:41

Oh ! Well, if it's all in there already, then.... `:-)`

Nathann


---

Comment by ncohen created at 2013-05-23 08:45:21

> To construct these, you need to be able to create the corresponding forms, which are well-studied by group theory, as they lead to finite classical groups. GAP has code to create these forms; it's not completely trivial in characteristic two. You can actually just call GAP!

This is now #14631 ! 

Nathann
