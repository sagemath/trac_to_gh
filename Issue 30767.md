# Issue 30767: Add full codestyle as recommendation

archive/issues_030767.json:
```json
{
    "body": "CC:  mkoeppe jipilab chapoton\n\nThe current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling `pycodestyle` or `tox -e pycodestyle`. Moreover, the current minimal ruleset is tested via the new environment `tox -e pycodestyle_minimal`, which is also used in the new lint github action workflow.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31004\n\n",
    "created_at": "2020-12-04T12:19:51Z",
    "labels": [
        "build",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Add full codestyle as recommendation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30767",
    "user": "@tobiasdiez"
}
```
CC:  mkoeppe jipilab chapoton

The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling `pycodestyle` or `tox -e pycodestyle`. Moreover, the current minimal ruleset is tested via the new environment `tox -e pycodestyle_minimal`, which is also used in the new lint github action workflow.

Issue created by migration from https://trac.sagemath.org/ticket/31004





---

archive/issue_comments_439787.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-04T12:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439787",
    "user": "@tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_439788.json:
```json
{
    "body": "This is a good idea. Two points:\n\n1) I think using `pycodestyle-minimal` would be more tox-ic (tox factor conditions)\n\n\n2) I think `envlist` at the top should do `pycodestyle-minimal`, not `pycodestyle`. This affects the default when `-e` is not used.",
    "created_at": "2020-12-04T18:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439788",
    "user": "mkoeppe"
}
```

This is a good idea. Two points:

1) I think using `pycodestyle-minimal` would be more tox-ic (tox factor conditions)


2) I think `envlist` at the top should do `pycodestyle-minimal`, not `pycodestyle`. This affects the default when `-e` is not used.



---

archive/issue_comments_439789.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-12-04T18:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439789",
    "user": "mkoeppe"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_439790.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-05T11:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439790",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439791.json:
```json
{
    "body": "Thanks for the review! I've now implemented your suggestions.",
    "created_at": "2020-12-05T11:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439791",
    "user": "@tobiasdiez"
}
```

Thanks for the review! I've now implemented your suggestions.



---

archive/issue_comments_439792.json:
```json
{
    "body": "In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment",
    "created_at": "2020-12-05T17:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439792",
    "user": "mkoeppe"
}
```

In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment



---

archive/issue_comments_439793.json:
```json
{
    "body": "Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now",
    "created_at": "2020-12-05T17:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439793",
    "user": "mkoeppe"
}
```

Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now



---

archive/issue_comments_439794.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-06T00:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439794",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439795.json:
```json
{
    "body": "Replying to [comment:7 mkoeppe]:\n> In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment\n\nYou are probably right, but that's not really related to this ticket.",
    "created_at": "2020-12-07T21:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439795",
    "user": "@tobiasdiez"
}
```

Replying to [comment:7 mkoeppe]:
> In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment

You are probably right, but that's not really related to this ticket.



---

archive/issue_comments_439796.json:
```json
{
    "body": "Replying to [comment:8 mkoeppe]:\n> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now\n\nI'm not sure what you mean, but `sage -advanced` doesn't show any tox-related infos for me (but the indent for example ecl is off). Maybe it's because I also get the following error when running `sage`:\n\n```\n/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found\n/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''\n/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'\n```\n",
    "created_at": "2020-12-07T21:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439796",
    "user": "@tobiasdiez"
}
```

Replying to [comment:8 mkoeppe]:
> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now

I'm not sure what you mean, but `sage -advanced` doesn't show any tox-related infos for me (but the indent for example ecl is off). Maybe it's because I also get the following error when running `sage`:

```
/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found
/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''
/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'
```




---

archive/issue_comments_439797.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-07T21:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439797",
    "user": "@tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439798.json:
```json
{
    "body": "Replying to [comment:11 gh-tobiasdiez]:\n> I also get the following error when running `sage`:\n> {{{\n> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found\n> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''\n> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'\n> }}}\n\nThis is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?",
    "created_at": "2020-12-07T22:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439798",
    "user": "mkoeppe"
}
```

Replying to [comment:11 gh-tobiasdiez]:
> I also get the following error when running `sage`:
> {{{
> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found
> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''
> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'
> }}}

This is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?



---

archive/issue_comments_439799.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T23:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439799",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439800.json:
```json
{
    "body": "Replying to [comment:8 mkoeppe]:\n> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now\nDone",
    "created_at": "2020-12-07T23:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439800",
    "user": "mkoeppe"
}
```

Replying to [comment:8 mkoeppe]:
> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now
Done



---

archive/issue_comments_439801.json:
```json
{
    "body": "Replying to [comment:15 mkoeppe]:\n> Replying to [comment:8 mkoeppe]:\n> > Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now\n> Done\n\nThanks!",
    "created_at": "2020-12-07T23:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439801",
    "user": "@tobiasdiez"
}
```

Replying to [comment:15 mkoeppe]:
> Replying to [comment:8 mkoeppe]:
> > Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now
> Done

Thanks!



---

archive/issue_comments_439802.json:
```json
{
    "body": "Replying to [comment:13 mkoeppe]:\n> Replying to [comment:11 gh-tobiasdiez]:\n> > I also get the following error when running `sage`:\n> > {{{\n> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found\n> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''\n> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'\n> > }}}\n> \n> This is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?\n\nMaybe because I invoke `sage` from within `pipenv shell` (to activate the correct venv)?",
    "created_at": "2020-12-07T23:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439802",
    "user": "@tobiasdiez"
}
```

Replying to [comment:13 mkoeppe]:
> Replying to [comment:11 gh-tobiasdiez]:
> > I also get the following error when running `sage`:
> > {{{
> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found
> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''
> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'
> > }}}
> 
> This is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?

Maybe because I invoke `sage` from within `pipenv shell` (to activate the correct venv)?



---

archive/issue_comments_439803.json:
```json
{
    "body": "Let's investigate this in #31049. It's not related to this ticket.",
    "created_at": "2020-12-14T18:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439803",
    "user": "mkoeppe"
}
```

Let's investigate this in #31049. It's not related to this ticket.



---

archive/issue_comments_439804.json:
```json
{
    "body": "Ready for review...",
    "created_at": "2020-12-14T18:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439804",
    "user": "mkoeppe"
}
```

Ready for review...



---

archive/issue_comments_439805.json:
```json
{
    "body": "Is there a reviewer for my changes on this ticket?",
    "created_at": "2020-12-22T15:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439805",
    "user": "mkoeppe"
}
```

Is there a reviewer for my changes on this ticket?



---

archive/issue_comments_439806.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-06T12:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439806",
    "user": "@tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439807.json:
```json
{
    "body": "The other changes look good to me as well. Thanks!",
    "created_at": "2021-01-06T12:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439807",
    "user": "@tobiasdiez"
}
```

The other changes look good to me as well. Thanks!



---

archive/issue_comments_439808.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-17T13:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30767#issuecomment-439808",
    "user": "vbraun"
}
```

Resolution: fixed
