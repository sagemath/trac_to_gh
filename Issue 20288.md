# Issue 20288: failing optional doctests

archive/issues_020288.json:
```json
{
    "body": "CC:  vbraun dimpase\n\nSince #20182 there are some failing doctests related to optional packages\n\n- `coding/linear_code.py`: related to Guava (gap package)\n- `tests/gap_packages.py`: related to gap packages\n\nIssue created by migration from https://trac.sagemath.org/ticket/20525\n\n",
    "created_at": "2016-05-01T04:09:04Z",
    "labels": [
        "documentation",
        "major",
        "bug"
    ],
    "title": "failing optional doctests",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20288",
    "user": "vdelecroix"
}
```
CC:  vbraun dimpase

Since #20182 there are some failing doctests related to optional packages

- `coding/linear_code.py`: related to Guava (gap package)
- `tests/gap_packages.py`: related to gap packages

Issue created by migration from https://trac.sagemath.org/ticket/20525





---

archive/issue_comments_279600.json:
```json
{
    "body": "Attachment",
    "created_at": "2016-05-01T04:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279600",
    "user": "vdelecroix"
}
```

Attachment



---

archive/issue_comments_279601.json:
```json
{
    "body": "Are you sure that #20182 has anything to do with this? It seems to me that something broke `gap_packages`.",
    "created_at": "2016-05-02T08:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279601",
    "user": "jdemeyer"
}
```

Are you sure that #20182 has anything to do with this? It seems to me that something broke `gap_packages`.



---

archive/issue_comments_279602.json:
```json
{
    "body": "Reformulation: this was not *visible* before #20182.",
    "created_at": "2016-05-02T13:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279602",
    "user": "vdelecroix"
}
```

Reformulation: this was not *visible* before #20182.



---

archive/issue_comments_279603.json:
```json
{
    "body": "First of all, what is the *exact command* that you ran to get those doctest failures?\n\nReplying to [comment:3 vdelecroix]:\n> this was not *visible* before #20182.\n\nDid you actually check this or are you just guessing? I.e. by applying #20182 on top of 7.2.beta5 or reverting #20182 from 7.2.beta6?",
    "created_at": "2016-05-02T13:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279603",
    "user": "jdemeyer"
}
```

First of all, what is the *exact command* that you ran to get those doctest failures?

Replying to [comment:3 vdelecroix]:
> this was not *visible* before #20182.

Did you actually check this or are you just guessing? I.e. by applying #20182 on top of 7.2.beta5 or reverting #20182 from 7.2.beta6?



---

archive/issue_comments_279604.json:
```json
{
    "body": "Replying to [comment:4 jdemeyer]:\n> First of all, what is the *exact command* that you ran to get those doctest failures?\n\nAnd did you verify that the same exact command on Sage 7.2.beta5 did not give failures?",
    "created_at": "2016-05-02T13:24:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279604",
    "user": "jdemeyer"
}
```

Replying to [comment:4 jdemeyer]:
> First of all, what is the *exact command* that you ran to get those doctest failures?

And did you verify that the same exact command on Sage 7.2.beta5 did not give failures?



---

archive/issue_comments_279605.json:
```json
{
    "body": "The exact command I ran was\n\n```\nfor pkg in A_LOT_OF_THINGS\ndo\n    sage -p $pkg\ndone\n\nsage -patchbot\n```\n\n\nNote that the failing doctests are optional (precisely `# optional - gap_packages`). The patchbot did not ran those before #20182.",
    "created_at": "2016-05-02T13:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279605",
    "user": "vdelecroix"
}
```

The exact command I ran was

```
for pkg in A_LOT_OF_THINGS
do
    sage -p $pkg
done

sage -patchbot
```


Note that the failing doctests are optional (precisely `# optional - gap_packages`). The patchbot did not ran those before #20182.



---

archive/issue_comments_279606.json:
```json
{
    "body": "First of all, using `./sage -p $pkg` to install packages is not at all recommended (use `./sage -i $pkg` instead). Second, not running `make` before starting the patchbot is really wrong.",
    "created_at": "2016-05-02T13:46:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279606",
    "user": "jdemeyer"
}
```

First of all, using `./sage -p $pkg` to install packages is not at all recommended (use `./sage -i $pkg` instead). Second, not running `make` before starting the patchbot is really wrong.



---

archive/issue_comments_279607.json:
```json
{
    "body": "Do you know the answer to [comment:5]?",
    "created_at": "2016-05-02T13:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279607",
    "user": "jdemeyer"
}
```

Do you know the answer to [comment:5]?



---

archive/issue_comments_279608.json:
```json
{
    "body": "For the record, I can reproduce the problem. I'm just not convinced that #20182 is to blame.",
    "created_at": "2016-05-02T13:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279608",
    "user": "jdemeyer"
}
```

For the record, I can reproduce the problem. I'm just not convinced that #20182 is to blame.



---

archive/issue_comments_279609.json:
```json
{
    "body": "Changing component from documentation to packages: optional.",
    "created_at": "2016-05-02T13:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279609",
    "user": "jdemeyer"
}
```

Changing component from documentation to packages: optional.



---

archive/issue_comments_279610.json:
```json
{
    "body": "Automatic testing of all installed optional packages was introduced in #18558",
    "created_at": "2016-05-02T14:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279610",
    "user": "klee"
}
```

Automatic testing of all installed optional packages was introduced in #18558



---

archive/issue_comments_279611.json:
```json
{
    "body": "Changing component from packages: optional to documentation.",
    "created_at": "2016-05-02T14:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279611",
    "user": "klee"
}
```

Changing component from packages: optional to documentation.



---

archive/issue_comments_279612.json:
```json
{
    "body": "Changing component from documentation to packages: optional.",
    "created_at": "2016-05-02T14:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279612",
    "user": "jdemeyer"
}
```

Changing component from documentation to packages: optional.



---

archive/issue_comments_279613.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2016-05-02T14:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279613",
    "user": "jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_279614.json:
```json
{
    "body": "these tests work for me. Must be patchbot madness...",
    "created_at": "2016-05-02T14:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279614",
    "user": "dimpase"
}
```

these tests work for me. Must be patchbot madness...



---

archive/issue_comments_279615.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> these tests work for me.\n\nNot for me.\n\n> Must be patchbot madness...\n\nNo, this is unrelated to the patchbot.",
    "created_at": "2016-05-02T15:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279615",
    "user": "jdemeyer"
}
```

Replying to [comment:16 dimpase]:
> these tests work for me.

Not for me.

> Must be patchbot madness...

No, this is unrelated to the patchbot.



---

archive/issue_comments_279616.json:
```json
{
    "body": "Please don't revert the changes I make to the ticket :-)",
    "created_at": "2016-05-02T15:03:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279616",
    "user": "jdemeyer"
}
```

Please don't revert the changes I make to the ticket :-)



---

archive/issue_comments_279617.json:
```json
{
    "body": "ok: `./spkg-install: line 72: cd: /home/scratch/dimpase/sage/sage/local/gap/latest/pkg/guava-3*: No such file or directory`\n\nbut why?! This is expansion of `cd \"$PKG_DIR/guava-3*\"`. And it seems to work:\n\n```\n$ cd /home/scratch/dimpase/sage/sage/local/gap/latest/pkg/guava-3*\nclpc171[/home/scratch/dimpase/sage/sage/local/gap/latest/pkg/guava-3.13]$ \n```\n",
    "created_at": "2016-05-02T15:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279617",
    "user": "dimpase"
}
```

ok: `./spkg-install: line 72: cd: /home/scratch/dimpase/sage/sage/local/gap/latest/pkg/guava-3*: No such file or directory`

but why?! This is expansion of `cd "$PKG_DIR/guava-3*"`. And it seems to work:

```
$ cd /home/scratch/dimpase/sage/sage/local/gap/latest/pkg/guava-3*
clpc171[/home/scratch/dimpase/sage/sage/local/gap/latest/pkg/guava-3.13]$ 
```




---

archive/issue_comments_279618.json:
```json
{
    "body": "guava issue fix - see the commit\n----\nNew commits:",
    "created_at": "2016-05-02T15:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279618",
    "user": "dimpase"
}
```

guava issue fix - see the commit
----
New commits:



---

archive/issue_comments_279619.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-02T15:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279619",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_279620.json:
```json
{
    "body": "I cannot reproduce the HAPcryst thing though. I get \n\n```\n$ sage -t --long src/sage/tests/gap_packages.py\nRunning doctests with ID 2016-05-02-16-39-21-92780109.\nGit branch: gappacs\nUsing --optional=cbc,csdp,database_gap,gap_packages,mpir,python2,sage\nDoctesting 1 file.\nsage -t --long --warn-long 56.7 src/sage/tests/gap_packages.py\n    [10 tests, 3.75 s]\n----------------------------------------------------------------------\nAll tests passed!\n```\n\nAs I get 10 tests run as opposed to 9 above, I probably have more packages installed...\n\nand \n\n```\n$ sage --gap\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   GAP 4.8.3, 19-Mar-2016, build of 2016-04-06 10:34:11 (BST)\n \u2502  GAP  \u2502   http://www.gap-system.org\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   Architecture: x86_64-unknown-linux-gnu-gcc-default64\n Libs used:  gmp, readline\n Loading the library and packages ...\n Components: trans 1.0, prim 2.1, small* 1.0, id* 1.0\n Packages:   Alnuth 3.0.0, AtlasRep 1.5.0, AutPGrp 1.6, CTblLib 1.2.2, FactInt 1.5.3, GAPDoc 1.5.1, LAGUNA 3.7.0, \n             Polycyclic 2.11, TomLib 1.2.5\n Try '?help' for help. See also  '?copyright' and  '?authors'\ngap> LoadPackage(\"HAPcryst\");\n#I  polymake command not found. Please set POLYMAKE_COMMAND by hand\n----------------------------------------------------------------\nLoading  polymaking 0.8.1\n(A package for using polymake in GAP)\nby Marc Roeder\n----------------------------------------------------------------\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nLoading  Cryst 4.1.12 (Computing with crystallographic groups)\nby Bettina Eick (http://www.icm.tu-bs.de/~beick/),\n   Franz G\u00e4hler (http://www.math.uni-bielefeld.de/~gaehler/), and\n   Werner Nickel (http://www.mathematik.tu-darmstadt.de/~nickel/).\nHomepage: http://www.math.uni-bielefeld.de/~gaehler/gap45/packages.php\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nLoading  CrystCat 1.1.6 (The crystallographic groups catalog)\nby Volkmar Felsch (http://www.math.rwth-aachen.de/~Volkmar.Felsch/) and\n   Franz G\u00e4hler (http://www.math.uni-bielefeld.de/~gaehler/).\nHomepage: http://www.math.uni-bielefeld.de/~gaehler/gap45/packages.php\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nLoading  AClib 1.2 (Almost Crystallographic Groups - A Library and Algorithms)\nby Karel Dekimpe (http://www.kulak.ac.be/~dekimpe) and\n   Bettina Eick (http://www.icm.tu-bs.de/~beick).\nHomepage: http://www.icm.tu-bs.de/~beick/so.html\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n#I  HAP warning: Set POLYMAKE_PATH manually if needed. \n#I  MakeReadOnlyGlobal: GradedAlgebraPresentationType no value bound\nLoading HAP 1.11.13 ...\n----------------------------------------------------------------\nThis is HAPcryst version 0.1.11\nby Marc Roeder\n----------------------------------------------------------------\ntrue\ngap> \n```\n\nlooks OK to me.",
    "created_at": "2016-05-02T15:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279620",
    "user": "dimpase"
}
```

I cannot reproduce the HAPcryst thing though. I get 

```
$ sage -t --long src/sage/tests/gap_packages.py
Running doctests with ID 2016-05-02-16-39-21-92780109.
Git branch: gappacs
Using --optional=cbc,csdp,database_gap,gap_packages,mpir,python2,sage
Doctesting 1 file.
sage -t --long --warn-long 56.7 src/sage/tests/gap_packages.py
    [10 tests, 3.75 s]
----------------------------------------------------------------------
All tests passed!
```

As I get 10 tests run as opposed to 9 above, I probably have more packages installed...

and 

```
$ sage --gap
 ┌───────┐   GAP 4.8.3, 19-Mar-2016, build of 2016-04-06 10:34:11 (BST)
 │  GAP  │   http://www.gap-system.org
 └───────┘   Architecture: x86_64-unknown-linux-gnu-gcc-default64
 Libs used:  gmp, readline
 Loading the library and packages ...
 Components: trans 1.0, prim 2.1, small* 1.0, id* 1.0
 Packages:   Alnuth 3.0.0, AtlasRep 1.5.0, AutPGrp 1.6, CTblLib 1.2.2, FactInt 1.5.3, GAPDoc 1.5.1, LAGUNA 3.7.0, 
             Polycyclic 2.11, TomLib 1.2.5
 Try '?help' for help. See also  '?copyright' and  '?authors'
gap> LoadPackage("HAPcryst");
#I  polymake command not found. Please set POLYMAKE_COMMAND by hand
----------------------------------------------------------------
Loading  polymaking 0.8.1
(A package for using polymake in GAP)
by Marc Roeder
----------------------------------------------------------------
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Loading  Cryst 4.1.12 (Computing with crystallographic groups)
by Bettina Eick (http://www.icm.tu-bs.de/~beick/),
   Franz Gähler (http://www.math.uni-bielefeld.de/~gaehler/), and
   Werner Nickel (http://www.mathematik.tu-darmstadt.de/~nickel/).
Homepage: http://www.math.uni-bielefeld.de/~gaehler/gap45/packages.php
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Loading  CrystCat 1.1.6 (The crystallographic groups catalog)
by Volkmar Felsch (http://www.math.rwth-aachen.de/~Volkmar.Felsch/) and
   Franz Gähler (http://www.math.uni-bielefeld.de/~gaehler/).
Homepage: http://www.math.uni-bielefeld.de/~gaehler/gap45/packages.php
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Loading  AClib 1.2 (Almost Crystallographic Groups - A Library and Algorithms)
by Karel Dekimpe (http://www.kulak.ac.be/~dekimpe) and
   Bettina Eick (http://www.icm.tu-bs.de/~beick).
Homepage: http://www.icm.tu-bs.de/~beick/so.html
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
#I  HAP warning: Set POLYMAKE_PATH manually if needed. 
#I  MakeReadOnlyGlobal: GradedAlgebraPresentationType no value bound
Loading HAP 1.11.13 ...
----------------------------------------------------------------
This is HAPcryst version 0.1.11
by Marc Roeder
----------------------------------------------------------------
true
gap> 
```

looks OK to me.



---

archive/issue_comments_279621.json:
```json
{
    "body": "I guess you have polymake working on your computer?",
    "created_at": "2016-05-02T15:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279621",
    "user": "vdelecroix"
}
```

I guess you have polymake working on your computer?



---

archive/issue_comments_279622.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-02T15:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279622",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279623.json:
```json
{
    "body": "You need to bump the patchlevel of the `gap_packages` package to ensure the change has effect.",
    "created_at": "2016-05-02T15:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279623",
    "user": "jdemeyer"
}
```

You need to bump the patchlevel of the `gap_packages` package to ensure the change has effect.



---

archive/issue_comments_279624.json:
```json
{
    "body": "Also, you better check the result of that `cd` operation, for example\n\n```\ncd \"$PKG_DIR\"/guava-3* && ./configure \"$GAP_DIR\"\n```\n",
    "created_at": "2016-05-02T15:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279624",
    "user": "jdemeyer"
}
```

Also, you better check the result of that `cd` operation, for example

```
cd "$PKG_DIR"/guava-3* && ./configure "$GAP_DIR"
```




---

archive/issue_comments_279625.json:
```json
{
    "body": "...or use `set -e`.",
    "created_at": "2016-05-02T15:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279625",
    "user": "jdemeyer"
}
```

...or use `set -e`.



---

archive/issue_comments_279626.json:
```json
{
    "body": "Replying to [comment:30 vdelecroix]:\n> I guess you have polymake working on your computer?\nno, I don't have polymake at all.",
    "created_at": "2016-05-02T15:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279626",
    "user": "dimpase"
}
```

Replying to [comment:30 vdelecroix]:
> I guess you have polymake working on your computer?
no, I don't have polymake at all.



---

archive/issue_comments_279627.json:
```json
{
    "body": "Replying to [comment:31 jdemeyer]:\n> You need to bump the patchlevel of the `gap_packages` package to ensure the change has effect.\n\nwhy? the tarball is the same, no removed/added/changed patches. Since when a change to spkg-install does need a version change?!\n\n(this is an optional package, so it won't magically rebuild by bumping anything, no?)",
    "created_at": "2016-05-02T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279627",
    "user": "dimpase"
}
```

Replying to [comment:31 jdemeyer]:
> You need to bump the patchlevel of the `gap_packages` package to ensure the change has effect.

why? the tarball is the same, no removed/added/changed patches. Since when a change to spkg-install does need a version change?!

(this is an optional package, so it won't magically rebuild by bumping anything, no?)



---

archive/issue_comments_279628.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-02T16:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279628",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279629.json:
```json
{
    "body": "Replying to [comment:35 dimpase]:\n> Since when a change to spkg-install does need a version change?!\n\nSince you need to fix broken installations of `gap_packages`. People who install `gap_packages` today have a broken version of it. Just changing `spkg-install` doesn't fix that: you need to actually reinstall `gap_packages`.",
    "created_at": "2016-05-02T21:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279629",
    "user": "jdemeyer"
}
```

Replying to [comment:35 dimpase]:
> Since when a change to spkg-install does need a version change?!

Since you need to fix broken installations of `gap_packages`. People who install `gap_packages` today have a broken version of it. Just changing `spkg-install` doesn't fix that: you need to actually reinstall `gap_packages`.



---

archive/issue_comments_279630.json:
```json
{
    "body": "Replying to [comment:37 jdemeyer]:\n> Replying to [comment:35 dimpase]:\n> > Since when a change to spkg-install does need a version change?!\n> \n> Since you need to fix broken installations of `gap_packages`. People who install `gap_packages` today have a broken version of it. Just changing `spkg-install` doesn't fix that: you need to actually reinstall `gap_packages`.\n\nyes, but it won't happen without human interaction, would it?",
    "created_at": "2016-05-02T22:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279630",
    "user": "dimpase"
}
```

Replying to [comment:37 jdemeyer]:
> Replying to [comment:35 dimpase]:
> > Since when a change to spkg-install does need a version change?!
> 
> Since you need to fix broken installations of `gap_packages`. People who install `gap_packages` today have a broken version of it. Just changing `spkg-install` doesn't fix that: you need to actually reinstall `gap_packages`.

yes, but it won't happen without human interaction, would it?



---

archive/issue_comments_279631.json:
```json
{
    "body": "Replying to [comment:38 dimpase]:\n> yes, but it won't happen without human interaction, would it?\n\nInstalled optional packages are upgraded just like standard packages are. So, running `make` should be sufficient to rebuild `gap_packages` if it was built before.",
    "created_at": "2016-05-03T07:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279631",
    "user": "jdemeyer"
}
```

Replying to [comment:38 dimpase]:
> yes, but it won't happen without human interaction, would it?

Installed optional packages are upgraded just like standard packages are. So, running `make` should be sufficient to rebuild `gap_packages` if it was built before.



---

archive/issue_comments_279632.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-03T08:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279632",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279633.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-03T08:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279633",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279634.json:
```json
{
    "body": "OK, done.",
    "created_at": "2016-05-03T08:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279634",
    "user": "dimpase"
}
```

OK, done.



---

archive/issue_comments_279635.json:
```json
{
    "body": "This fixes the second issue, but not the first.",
    "created_at": "2016-05-03T08:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279635",
    "user": "jdemeyer"
}
```

This fixes the second issue, but not the first.



---

archive/issue_comments_279636.json:
```json
{
    "body": "the first issue is not trivial to reproduce. I managed to do so on OSX, and on UGent's sage4. (But all of that works on my laptop and on my desktop). This has to do with selective GAP packages loading, and is an upstream<sup>2</sup> bug, as far as I can see. (A bug in a GAP package, that is).",
    "created_at": "2016-05-03T09:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279636",
    "user": "dimpase"
}
```

the first issue is not trivial to reproduce. I managed to do so on OSX, and on UGent's sage4. (But all of that works on my laptop and on my desktop). This has to do with selective GAP packages loading, and is an upstream<sup>2</sup> bug, as far as I can see. (A bug in a GAP package, that is).



---

archive/issue_comments_279637.json:
```json
{
    "body": "OK, I see. If database_gap is installed then the error does not occur\n(it's because it needs `SmallGroup` functionality, specifically, the error comes from `IdGroup` being of wrong type, a function, not an attribute). Looks like a missing dependence in Hap.\nI will make database_gap a dependency of gap_packages.",
    "created_at": "2016-05-03T10:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279637",
    "user": "dimpase"
}
```

OK, I see. If database_gap is installed then the error does not occur
(it's because it needs `SmallGroup` functionality, specifically, the error comes from `IdGroup` being of wrong type, a function, not an attribute). Looks like a missing dependence in Hap.
I will make database_gap a dependency of gap_packages.



---

archive/issue_comments_279638.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-03T10:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279638",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279639.json:
```json
{
    "body": "All works now.\n----\nNew commits:",
    "created_at": "2016-05-03T10:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279639",
    "user": "dimpase"
}
```

All works now.
----
New commits:



---

archive/issue_comments_279640.json:
```json
{
    "body": "Shouldn't this be an order-only dependency `| database_gap`?",
    "created_at": "2016-05-03T11:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279640",
    "user": "jdemeyer"
}
```

Shouldn't this be an order-only dependency `| database_gap`?



---

archive/issue_comments_279641.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-03T11:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279641",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279642.json:
```json
{
    "body": "I don't understand what this is, an order-only dependency...",
    "created_at": "2016-05-03T11:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279642",
    "user": "dimpase"
}
```

I don't understand what this is, an order-only dependency...



---

archive/issue_comments_279643.json:
```json
{
    "body": "See http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies or https://www.gnu.org/software/make/manual/html_node/Prerequisite-Types.html",
    "created_at": "2016-05-03T11:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279643",
    "user": "jdemeyer"
}
```

See http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies or https://www.gnu.org/software/make/manual/html_node/Prerequisite-Types.html



---

archive/issue_comments_279644.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-03T13:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279644",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279645.json:
```json
{
    "body": "Replying to [comment:47 jdemeyer]:\n> Shouldn't this be an order-only dependency `| database_gap`?\nI don't think one wants a stale buggy  version of database_gap lying around, just because it is an order-only dependence.\nOn a practical side of things, database_gap is updated infrequently, so one would potentially pay very little in efficiency by having it as a normal dependency.",
    "created_at": "2016-05-03T13:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279645",
    "user": "dimpase"
}
```

Replying to [comment:47 jdemeyer]:
> Shouldn't this be an order-only dependency `| database_gap`?
I don't think one wants a stale buggy  version of database_gap lying around, just because it is an order-only dependence.
On a practical side of things, database_gap is updated infrequently, so one would potentially pay very little in efficiency by having it as a normal dependency.



---

archive/issue_comments_279646.json:
```json
{
    "body": "Replying to [comment:50 dimpase]:\n> database_gap is updated infrequently, so one would potentially pay very little in efficiency by having it as a normal dependency. \n\nOne would pay *even less* by having it an order-only dependency. You could add a dependency of `gap_packages` on `zn_poly` and argue that it doesn't hurt because `zn_poly` is not updated often. But that's besides the point: I just want the dependencies to correctly reflect reality.",
    "created_at": "2016-05-03T13:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279646",
    "user": "jdemeyer"
}
```

Replying to [comment:50 dimpase]:
> database_gap is updated infrequently, so one would potentially pay very little in efficiency by having it as a normal dependency. 

One would pay *even less* by having it an order-only dependency. You could add a dependency of `gap_packages` on `zn_poly` and argue that it doesn't hurt because `zn_poly` is not updated often. But that's besides the point: I just want the dependencies to correctly reflect reality.



---

archive/issue_comments_279647.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-03T13:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279647",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279648.json:
```json
{
    "body": "Speaking of dependencies: you should also consider whether `gap_packages` depends on `gap` (I don't know if it does?)",
    "created_at": "2016-05-03T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279648",
    "user": "jdemeyer"
}
```

Speaking of dependencies: you should also consider whether `gap_packages` depends on `gap` (I don't know if it does?)



---

archive/issue_comments_279649.json:
```json
{
    "body": "Replying to [comment:52 jdemeyer]:\n> Speaking of dependencies: you should also consider whether `gap_packages` depends on `gap` (I don't know if it does?)\n\nthat's right, gap (and libgap) are dependencies, too. I will add them.",
    "created_at": "2016-05-03T13:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279649",
    "user": "dimpase"
}
```

Replying to [comment:52 jdemeyer]:
> Speaking of dependencies: you should also consider whether `gap_packages` depends on `gap` (I don't know if it does?)

that's right, gap (and libgap) are dependencies, too. I will add them.



---

archive/issue_comments_279650.json:
```json
{
    "body": "Replying to [comment:51 jdemeyer]:\n> Replying to [comment:50 dimpase]:\n> > database_gap is updated infrequently, so one would potentially pay very little in efficiency by having it as a normal dependency. \n> \n> One would pay *even less* by having it an order-only dependency. You could add a dependency of `gap_packages` on `zn_poly` and argue that it doesn't hurt because `zn_poly` is not updated often. But that's besides the point: I just want the dependencies to correctly reflect reality.\n\nThe reality is that if database_gap has a bug, then an output of gap_packages might be wrong. A new release of gap_packages might silently need an newer database_gap, too. \n\nOrder-only dependencies are invented to deal with completely different scenarios, IMHO.",
    "created_at": "2016-05-03T13:18:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279650",
    "user": "dimpase"
}
```

Replying to [comment:51 jdemeyer]:
> Replying to [comment:50 dimpase]:
> > database_gap is updated infrequently, so one would potentially pay very little in efficiency by having it as a normal dependency. 
> 
> One would pay *even less* by having it an order-only dependency. You could add a dependency of `gap_packages` on `zn_poly` and argue that it doesn't hurt because `zn_poly` is not updated often. But that's besides the point: I just want the dependencies to correctly reflect reality.

The reality is that if database_gap has a bug, then an output of gap_packages might be wrong. A new release of gap_packages might silently need an newer database_gap, too. 

Order-only dependencies are invented to deal with completely different scenarios, IMHO.



---

archive/issue_comments_279651.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-03T13:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279651",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279652.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-03T13:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279652",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279653.json:
```json
{
    "body": "Replying to [comment:54 dimpase]:\n> A new release of gap_packages might silently need an newer database_gap, too.\n\nSage always installs the latest version of installed standard and optional packages, so `database_gap` will always be up-to-date. That's not something which affects the dependencies of `gap_packages`.",
    "created_at": "2016-05-03T13:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279653",
    "user": "jdemeyer"
}
```

Replying to [comment:54 dimpase]:
> A new release of gap_packages might silently need an newer database_gap, too.

Sage always installs the latest version of installed standard and optional packages, so `database_gap` will always be up-to-date. That's not something which affects the dependencies of `gap_packages`.



---

archive/issue_comments_279654.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-05-03T13:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279654",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_279655.json:
```json
{
    "body": "The question you need to answer is a different one: if `database_gap` is reinstalled (either because of an upgrade of `database_gap` of because somebody did `sage -f database_gap`), should this force a reinstallation of `gap_packages`?\n\nIf the answer is \"yes\": use a normal dependency\n\nIf the answer is \"no\": use an order-only dependency",
    "created_at": "2016-05-03T13:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279655",
    "user": "jdemeyer"
}
```

The question you need to answer is a different one: if `database_gap` is reinstalled (either because of an upgrade of `database_gap` of because somebody did `sage -f database_gap`), should this force a reinstallation of `gap_packages`?

If the answer is "yes": use a normal dependency

If the answer is "no": use an order-only dependency



---

archive/issue_comments_279656.json:
```json
{
    "body": "I read the doc you provided, and it said something else:\n\n*If package A has an order-only dependency on B, it simply means that B must be built before A can be built. The version of B does not matter, only the fact that B is installed matters. This should be used if the dependency is purely a build-time dependency (for example, a dependency on Python simply because the spkg-install file is written in Python).*\n\nAgainst this background, the answer is that B is a runtime dependency, not a build-time dependency, and thus it should not be order-only.",
    "created_at": "2016-05-03T13:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279656",
    "user": "dimpase"
}
```

I read the doc you provided, and it said something else:

*If package A has an order-only dependency on B, it simply means that B must be built before A can be built. The version of B does not matter, only the fact that B is installed matters. This should be used if the dependency is purely a build-time dependency (for example, a dependency on Python simply because the spkg-install file is written in Python).*

Against this background, the answer is that B is a runtime dependency, not a build-time dependency, and thus it should not be order-only.



---

archive/issue_comments_279657.json:
```json
{
    "body": "Replying to [comment:59 dimpase]:\n> This should be used **if** the dependency is purely a build-time dependency\n\nThat is an **if**, not **if and only if**.\n\nIt's not because it's not a build-time dependency, that it should not be an order-only dependency.",
    "created_at": "2016-05-03T14:01:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279657",
    "user": "jdemeyer"
}
```

Replying to [comment:59 dimpase]:
> This should be used **if** the dependency is purely a build-time dependency

That is an **if**, not **if and only if**.

It's not because it's not a build-time dependency, that it should not be an order-only dependency.



---

archive/issue_comments_279658.json:
```json
{
    "body": "I do not know all the details to be sure that an order-only dependency is OK. Probably yes, but not 100% certainly.\n\nAlso, regarding the upstream opinion on whether it is a bug, see https://github.com/gap-system/gap/issues/775\nThey think that non-GPL'd libs in database_gap are parts of \"GAP core system\", whatever they mean.",
    "created_at": "2016-05-03T14:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279658",
    "user": "dimpase"
}
```

I do not know all the details to be sure that an order-only dependency is OK. Probably yes, but not 100% certainly.

Also, regarding the upstream opinion on whether it is a bug, see https://github.com/gap-system/gap/issues/775
They think that non-GPL'd libs in database_gap are parts of "GAP core system", whatever they mean.



---

archive/issue_comments_279659.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-05-03T19:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279659",
    "user": "dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_279660.json:
```json
{
    "body": "I think it is time for me to crash the party. First I notice that you made `gap_packages` and `database_gap` depend on `libgap`. Only `gap` is needed.\n\nI think it is time for me to point out that `grape` includes an old version of `nauty` and can use either `nauty` (now a standard package) or `bliss` (now an optional package). Look at `GRAPE_DREADNAUT_EXE` in `grape/lib/grape.g` (and the variable `GRAPE_NAUTY` and `GRAPE_BLISS_EXE` in the same file if you are curious).\nI recommend removal of the `configure` and other makefiles in `spkg-src`. The only point of that bit in the `grape` package is to build the `dreadnaut` executable from `nauty`.\n\nI am OK if you want to spin that as a separate ticket.",
    "created_at": "2016-05-03T22:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279660",
    "user": "fbissey"
}
```

I think it is time for me to crash the party. First I notice that you made `gap_packages` and `database_gap` depend on `libgap`. Only `gap` is needed.

I think it is time for me to point out that `grape` includes an old version of `nauty` and can use either `nauty` (now a standard package) or `bliss` (now an optional package). Look at `GRAPE_DREADNAUT_EXE` in `grape/lib/grape.g` (and the variable `GRAPE_NAUTY` and `GRAPE_BLISS_EXE` in the same file if you are curious).
I recommend removal of the `configure` and other makefiles in `spkg-src`. The only point of that bit in the `grape` package is to build the `dreadnaut` executable from `nauty`.

I am OK if you want to spin that as a separate ticket.



---

archive/issue_comments_279661.json:
```json
{
    "body": "Replying to [comment:63 fbissey]:\n> I think it is time for me to crash the party. First I notice that you made `gap_packages` and `database_gap` depend on `libgap`. Only `gap` is needed.\n\nAs soon as we start supporting building GAP kernel extensions in libgap, things \nwill change, and libgap will be a real dependence. At the moment, as gap and libgap are updated in lockstep, it does not matter anyway.\n\n> \n> I think it is time for me to point out that `grape` includes an old version of `nauty` and can use either `nauty` (now a standard package) or `bliss` (now an optional package). Look at `GRAPE_DREADNAUT_EXE` in `grape/lib/grape.g` (and the variable `GRAPE_NAUTY` and `GRAPE_BLISS_EXE` in the same file if you are curious).\n> I recommend removal of the `configure` and other makefiles in `spkg-src`. The only point of that bit in the `grape` package is to build the `dreadnaut` executable from `nauty`.\n> \n> I am OK if you want to spin that as a separate ticket.\n\nI don't see why you want to override GRAPE's author on this. He told be that he keeps old nauty as he did not do a lot of tests with the new one, yet.",
    "created_at": "2016-05-04T08:14:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279661",
    "user": "dimpase"
}
```

Replying to [comment:63 fbissey]:
> I think it is time for me to crash the party. First I notice that you made `gap_packages` and `database_gap` depend on `libgap`. Only `gap` is needed.

As soon as we start supporting building GAP kernel extensions in libgap, things 
will change, and libgap will be a real dependence. At the moment, as gap and libgap are updated in lockstep, it does not matter anyway.

> 
> I think it is time for me to point out that `grape` includes an old version of `nauty` and can use either `nauty` (now a standard package) or `bliss` (now an optional package). Look at `GRAPE_DREADNAUT_EXE` in `grape/lib/grape.g` (and the variable `GRAPE_NAUTY` and `GRAPE_BLISS_EXE` in the same file if you are curious).
> I recommend removal of the `configure` and other makefiles in `spkg-src`. The only point of that bit in the `grape` package is to build the `dreadnaut` executable from `nauty`.
> 
> I am OK if you want to spin that as a separate ticket.

I don't see why you want to override GRAPE's author on this. He told be that he keeps old nauty as he did not do a lot of tests with the new one, yet.



---

archive/issue_comments_279662.json:
```json
{
    "body": "> I do not know all the details to be sure that an order-only dependency is OK. Probably yes, but not 100% certainly.\n\nIt has always been an order-only dependency (the default dependencies of optional packages is an order-only dependency on every standard package), so I guess it's safe.\n\n> As soon as we start supporting building GAP kernel extensions in libgap, things \n> will change\n\nThen the dependencies of `database_gap` and `gap_packages` should be changed in that ticket. I don't see the point of adding dependencies just in case they will be needed in the future. It reminds me of somebody adding `webassets` to `sagenb` because they planned to use it in the future... which of course never happened.",
    "created_at": "2016-05-04T09:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279662",
    "user": "jdemeyer"
}
```

> I do not know all the details to be sure that an order-only dependency is OK. Probably yes, but not 100% certainly.

It has always been an order-only dependency (the default dependencies of optional packages is an order-only dependency on every standard package), so I guess it's safe.

> As soon as we start supporting building GAP kernel extensions in libgap, things 
> will change

Then the dependencies of `database_gap` and `gap_packages` should be changed in that ticket. I don't see the point of adding dependencies just in case they will be needed in the future. It reminds me of somebody adding `webassets` to `sagenb` because they planned to use it in the future... which of course never happened.



---

archive/issue_comments_279663.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-04T09:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279663",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279664.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-05-04T09:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279664",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_279665.json:
```json
{
    "body": "Replying to [comment:65 jdemeyer]:\n> > I do not know all the details to be sure that an order-only dependency is OK. Probably yes, but not 100% certainly.\n> \n> It has always been an order-only dependency (the default dependencies of optional packages is an order-only dependency on every standard package), so I guess it's safe.\n\nwe talk about dependency of one optional package on another.\n\n----\nNew commits:",
    "created_at": "2016-05-04T09:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279665",
    "user": "dimpase"
}
```

Replying to [comment:65 jdemeyer]:
> > I do not know all the details to be sure that an order-only dependency is OK. Probably yes, but not 100% certainly.
> 
> It has always been an order-only dependency (the default dependencies of optional packages is an order-only dependency on every standard package), so I guess it's safe.

we talk about dependency of one optional package on another.

----
New commits:



---

archive/issue_comments_279666.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-04T09:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279666",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279667.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2016-05-04T09:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279667",
    "user": "dimpase"
}
```

New commits:
----
New commits:



---

archive/issue_comments_279668.json:
```json
{
    "body": "gap, libgap, gap_packages, and database_gap are tightly interconnected packages, usually updated all together, and I don't see much harm in declaring them to be a bit more interdependent than might be strictly necessary. Especially in absence of clear, and not open to grammatical (mis)interpretations, guidelines on dependencies in Sage.",
    "created_at": "2016-05-04T10:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279668",
    "user": "dimpase"
}
```

gap, libgap, gap_packages, and database_gap are tightly interconnected packages, usually updated all together, and I don't see much harm in declaring them to be a bit more interdependent than might be strictly necessary. Especially in absence of clear, and not open to grammatical (mis)interpretations, guidelines on dependencies in Sage.



---

archive/issue_comments_279669.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-05T07:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279669",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_279670.json:
```json
{
    "body": "I still think that the current branch is wrong, but let's stop the bikeshedding...",
    "created_at": "2016-05-05T07:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279670",
    "user": "jdemeyer"
}
```

I still think that the current branch is wrong, but let's stop the bikeshedding...



---

archive/issue_comments_279671.json:
```json
{
    "body": "I think there are files there that do not need that import from future at all. I don't know whether this import makes it python3-incompatible.",
    "created_at": "2016-05-05T07:59:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279671",
    "user": "dimpase"
}
```

I think there are files there that do not need that import from future at all. I don't know whether this import makes it python3-incompatible.



---

archive/issue_comments_279672.json:
```json
{
    "body": "Replying to [comment:71 dimpase]:\n> I think there are files there that do not need that import from future at all. I don't know whether this import makes it python3-incompatible.\n\nI suppose this comment was meant for a different ticket?",
    "created_at": "2016-05-05T08:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279672",
    "user": "jdemeyer"
}
```

Replying to [comment:71 dimpase]:
> I think there are files there that do not need that import from future at all. I don't know whether this import makes it python3-incompatible.

I suppose this comment was meant for a different ticket?



---

archive/issue_comments_279673.json:
```json
{
    "body": "Replying to [comment:72 jdemeyer]:\n> Replying to [comment:71 dimpase]:\n> > I think there are files there that do not need that import from future at all. I don't know whether this import makes it python3-incompatible.\n> \n> I suppose this comment was meant for a different ticket?\n\noops, indeed, sorry...",
    "created_at": "2016-05-05T08:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279673",
    "user": "dimpase"
}
```

Replying to [comment:72 jdemeyer]:
> Replying to [comment:71 dimpase]:
> > I think there are files there that do not need that import from future at all. I don't know whether this import makes it python3-incompatible.
> 
> I suppose this comment was meant for a different ticket?

oops, indeed, sorry...



---

archive/issue_comments_279674.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-06T22:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20288#issuecomment-279674",
    "user": "vbraun"
}
```

Resolution: fixed
