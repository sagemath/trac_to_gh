# Issue 16557: Circular dependencies: patch : bzip2 : pkgconf

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2014-08-10 22:34:54

This usually doesn't surface since pretty much everybody has patch installed already, but:
* patch requires bzip2
* bzip2 requires pkgconf
* pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)


---

Comment by vbraun created at 2014-08-10 22:36:25

The solution seems to be to distribute patch as gzipped tarball (not: bzip2) and remove this dependency, and add the dependency of pkgconf on patch instead.


---

Comment by vbraun created at 2014-08-10 22:49:41

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-08-10 22:49:41

New commits:


---

Comment by git created at 2014-08-11 11:00:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-08-11 11:06:15

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vbraun created at 2014-08-11 11:08:07

The pyparsing sources have DOS line endings, ughh..


---

Comment by vbraun created at 2014-08-11 14:27:11

Changing priority from major to blocker.


---

Comment by jhpalmieri created at 2014-08-11 15:30:28

Should bzip2 even be a package anymore? I always thought that we included it for compressing and decompressing `.spkg` files. Now with the new packaging system (although there are some old-style optional and experimental packages still), not to mention the fact that bzip2 is pretty standard, can we just get rid of it?


---

Comment by vbraun created at 2014-08-11 16:56:43

There are still bzip2-compressed tarballs. We can certainly discuss adding it as a host dependency on another ticket...


---

Comment by jdemeyer created at 2014-08-13 10:25:10

What's the reason for upgrading `patch`? Have you tested this well on the buildbots? I remember lots of portability trouble with `patch-2.6.x`, that's the reason why we never upgraded before.

The changes to `build/deps` look good to me.


---

Comment by vbraun created at 2014-08-13 10:45:39

I haven't tried, but I will anyway when merging the ticket. It seems a bit redundant to do it twice.

Since we don't have a solaris buildbot any more its probably fine. I upgraded patch since I think there will be problem with the build system if tarballs only differ by extension, haven't tried to find out exactly what might break though.


---

Comment by jdemeyer created at 2014-08-13 11:04:34

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2014-08-13 11:04:34

OK, I'm giving it the benefit of the doubt...


---

Comment by vbraun created at 2014-08-13 17:06:38

Resolution: fixed
