# Issue 14894: QSym: the Hazewinkel Lambda basis

archive/issues_014894.json:
```json
{
    "body": "CC:  @tscrim sage-combinat @nthiery @hivert @zabrocki @saliola\n\nKeywords: sage-combinat, qsym, quasi-symmetric functions, hazewinkel, witt vectors\n\nThis ticket implements the Hazewinkel Lambda basis of QSym -- one of the multiplicative (in an appropriate sense) bases of QSym defined over any ring.\n\nIt also fixes a misbehavior of the shuffle product class, in which the following would throw an error:\n\n```\nsage: from sage.combinat.words.shuffle_product import ShuffleProduct_w1w2\nsage: ShuffleProduct_w1w2(Compositions(2)([1,1]), Composition([1])).list()                 \n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: [1, 1, 1] not in Compositions of 2\n```\n\nThe fix might not be optimal but at least it does the trick.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15131\n\n",
    "created_at": "2013-08-30T18:28:59Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "QSym: the Hazewinkel Lambda basis",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14894",
    "user": "https://github.com/darijgr"
}
```
CC:  @tscrim sage-combinat @nthiery @hivert @zabrocki @saliola

Keywords: sage-combinat, qsym, quasi-symmetric functions, hazewinkel, witt vectors

This ticket implements the Hazewinkel Lambda basis of QSym -- one of the multiplicative (in an appropriate sense) bases of QSym defined over any ring.

It also fixes a misbehavior of the shuffle product class, in which the following would throw an error:

```
sage: from sage.combinat.words.shuffle_product import ShuffleProduct_w1w2
sage: ShuffleProduct_w1w2(Compositions(2)([1,1]), Composition([1])).list()                 
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: [1, 1, 1] not in Compositions of 2
```

The fix might not be optimal but at least it does the trick.

Issue created by migration from https://trac.sagemath.org/ticket/15131





---

archive/issue_comments_189862.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-08-30T19:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189862",
    "user": "https://github.com/darijgr"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_189863.json:
```json
{
    "body": "Hey Darij,\n\nThis needs a (very) trivial rebase over #13505. Here are also some things from glancing over the patch file:\n\n- Could you move the documentation for the basis from the `__init__()` into the class doc and just put a `TestSuite(HWL).run()` test for the `__init__()`?\n- `__init_extra__()` needs doctests.\n- The `EXAMPLES::` block on line 2280 has an extra colon.\n- In `shuffle_product.py` line 141, same thing with the `TESTS::` block.\n\nI'll do the full review once these are taken care of. Thanks for the continued work on (Q)Sym.\n\nThanks,\n\nTravis",
    "created_at": "2013-09-07T04:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189863",
    "user": "https://github.com/tscrim"
}
```

Hey Darij,

This needs a (very) trivial rebase over #13505. Here are also some things from glancing over the patch file:

- Could you move the documentation for the basis from the `__init__()` into the class doc and just put a `TestSuite(HWL).run()` test for the `__init__()`?
- `__init_extra__()` needs doctests.
- The `EXAMPLES::` block on line 2280 has an extra colon.
- In `shuffle_product.py` line 141, same thing with the `TESTS::` block.

I'll do the full review once these are taken care of. Thanks for the continued work on (Q)Sym.

Thanks,

Travis



---

archive/issue_comments_189864.json:
```json
{
    "body": "Thanks for your sharp eyes; but what rebase does it need? I have trac_13505_quasi_schur.5.patch\u200b applied before it in my queue... As for the rest: done!",
    "created_at": "2013-09-07T15:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189864",
    "user": "https://github.com/darijgr"
}
```

Thanks for your sharp eyes; but what rebase does it need? I have trac_13505_quasi_schur.5.patchâ€‹ applied before it in my queue... As for the rest: done!



---

archive/issue_comments_189865.json:
```json
{
    "body": "updated",
    "created_at": "2013-09-07T15:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189865",
    "user": "https://github.com/darijgr"
}
```

updated



---

archive/issue_comments_189866.json:
```json
{
    "body": "Attachment [trac_15131-hazewinkel-lambda-dg.patch](tarball://root/attachments/some-uuid/ticket15131/trac_15131-hazewinkel-lambda-dg.patch) by @darijgr created at 2013-09-08 05:26:09\n\nOops, for some reason I failed to doctest my changes properly (I think I doctested ncsf instead of qsym from muscle memory):\n\n```\nsage -t devel/sage-main/sage/combinat/ncsf_qsym/qsym.py\n**********************************************************************\nFile \"devel/sage-main/sage/combinat/ncsf_qsym/qsym.py\", line 2222, in sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.HazewinkelLambda.__init__\nFailed example:\n    TestSuite(HWL).run()\nExpected:\n    True\nGot:\n    <BLANKLINE>\n**********************************************************************\n```\n\nI need to get some sleep, so could you just fix this in the obvious way? Thanks a lot!",
    "created_at": "2013-09-08T05:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189866",
    "user": "https://github.com/darijgr"
}
```

Attachment [trac_15131-hazewinkel-lambda-dg.patch](tarball://root/attachments/some-uuid/ticket15131/trac_15131-hazewinkel-lambda-dg.patch) by @darijgr created at 2013-09-08 05:26:09

Oops, for some reason I failed to doctest my changes properly (I think I doctested ncsf instead of qsym from muscle memory):

```
sage -t devel/sage-main/sage/combinat/ncsf_qsym/qsym.py
**********************************************************************
File "devel/sage-main/sage/combinat/ncsf_qsym/qsym.py", line 2222, in sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.HazewinkelLambda.__init__
Failed example:
    TestSuite(HWL).run()
Expected:
    True
Got:
    <BLANKLINE>
**********************************************************************
```

I need to get some sleep, so could you just fix this in the obvious way? Thanks a lot!



---

archive/issue_comments_189867.json:
```json
{
    "body": "Oops, for some reason I failed to doctest my changes properly (I think I doctested ncsf instead of qsym from muscle memory):\n\n```\nsage -t devel/sage-main/sage/combinat/ncsf_qsym/qsym.py\n**********************************************************************\nFile \"devel/sage-main/sage/combinat/ncsf_qsym/qsym.py\", line 2222, in sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.HazewinkelLambda.__init__\nFailed example:\n    TestSuite(HWL).run()\nExpected:\n    True\nGot:\n    <BLANKLINE>\n**********************************************************************\n```\n\nI need to get some sleep, so could you just fix this in the obvious way? Thanks a lot!",
    "created_at": "2013-09-08T05:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189867",
    "user": "https://github.com/darijgr"
}
```

Oops, for some reason I failed to doctest my changes properly (I think I doctested ncsf instead of qsym from muscle memory):

```
sage -t devel/sage-main/sage/combinat/ncsf_qsym/qsym.py
**********************************************************************
File "devel/sage-main/sage/combinat/ncsf_qsym/qsym.py", line 2222, in sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.HazewinkelLambda.__init__
Failed example:
    TestSuite(HWL).run()
Expected:
    True
Got:
    <BLANKLINE>
**********************************************************************
```

I need to get some sleep, so could you just fix this in the obvious way? Thanks a lot!



---

archive/issue_comments_189868.json:
```json
{
    "body": "Attachment [trac_15131-review-ts.patch](tarball://root/attachments/some-uuid/ticket15131/trac_15131-review-ts.patch) by @tscrim created at 2013-09-08 16:35:48",
    "created_at": "2013-09-08T16:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189868",
    "user": "https://github.com/tscrim"
}
```

Attachment [trac_15131-review-ts.patch](tarball://root/attachments/some-uuid/ticket15131/trac_15131-review-ts.patch) by @tscrim created at 2013-09-08 16:35:48



---

archive/issue_comments_189869.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-09-08T16:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189869",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_189870.json:
```json
{
    "body": "Hey Darij,\n\nHere's a review patch which fixes the doctest output and adds doctests. There's currently one failing doctest with no output for `_to_Monomial_on_basis()` since it currently does the same as `_from_Monomial_on_basis()`. I also get some 2-fuzz with the review patch I posted for #15094.\n\nThanks for your continued work on this,\n\nTravis",
    "created_at": "2013-09-08T16:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189870",
    "user": "https://github.com/tscrim"
}
```

Hey Darij,

Here's a review patch which fixes the doctest output and adds doctests. There's currently one failing doctest with no output for `_to_Monomial_on_basis()` since it currently does the same as `_from_Monomial_on_basis()`. I also get some 2-fuzz with the review patch I posted for #15094.

Thanks for your continued work on this,

Travis



---

archive/issue_comments_189871.json:
```json
{
    "body": "Oh, I gave it the wrong parent. Sorry. Here is a qfolded version with the bug fixed, hopefully avoiding the fuzz as well.",
    "created_at": "2013-09-08T16:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189871",
    "user": "https://github.com/darijgr"
}
```

Oh, I gave it the wrong parent. Sorry. Here is a qfolded version with the bug fixed, hopefully avoiding the fuzz as well.



---

archive/issue_comments_189872.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-09-08T16:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189872",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_189873.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2013-09-08T16:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189873",
    "user": "https://github.com/darijgr"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_189874.json:
```json
{
    "body": "patchbot:\n\napply trac_15131-hazewinkel-basis-qfolded-dg.patch",
    "created_at": "2013-09-08T17:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189874",
    "user": "https://github.com/darijgr"
}
```

patchbot:

apply trac_15131-hazewinkel-basis-qfolded-dg.patch



---

archive/issue_comments_189875.json:
```json
{
    "body": "Looks good to me. Thanks Darij.",
    "created_at": "2013-09-09T15:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189875",
    "user": "https://github.com/tscrim"
}
```

Looks good to me. Thanks Darij.



---

archive/issue_comments_189876.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-09-09T15:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189876",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_189877.json:
```json
{
    "body": "Thanks for your time!",
    "created_at": "2013-09-09T16:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189877",
    "user": "https://github.com/darijgr"
}
```

Thanks for your time!



---

archive/issue_comments_189878.json:
```json
{
    "body": "Sorry to put you to work again.  If you look at line 685 in qsym.py there is a missing colon.  This patch removes it.  It shows up in my documentation in \n\n```\nF = QuasiSymmetricFunctions(QQ).F()\nF.from_polynomial?\n```\n",
    "created_at": "2013-09-09T16:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189878",
    "user": "https://github.com/zabrocki"
}
```

Sorry to put you to work again.  If you look at line 685 in qsym.py there is a missing colon.  This patch removes it.  It shows up in my documentation in 

```
F = QuasiSymmetricFunctions(QQ).F()
F.from_polynomial?
```




---

archive/issue_comments_189879.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-09-09T16:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189879",
    "user": "https://github.com/zabrocki"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_189880.json:
```json
{
    "body": "fixed",
    "created_at": "2013-09-09T16:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189880",
    "user": "https://github.com/darijgr"
}
```

fixed



---

archive/issue_comments_189881.json:
```json
{
    "body": "Attachment [trac_15131-hazewinkel-basis-qfolded-dg.patch](tarball://root/attachments/some-uuid/ticket15131/trac_15131-hazewinkel-basis-qfolded-dg.patch) by @darijgr created at 2013-09-09 16:32:31\n\nfixed",
    "created_at": "2013-09-09T16:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189881",
    "user": "https://github.com/darijgr"
}
```

Attachment [trac_15131-hazewinkel-basis-qfolded-dg.patch](tarball://root/attachments/some-uuid/ticket15131/trac_15131-hazewinkel-basis-qfolded-dg.patch) by @darijgr created at 2013-09-09 16:32:31

fixed



---

archive/issue_comments_189882.json:
```json
{
    "body": "Thanks for catching this one. I hope this fixes it? (The two files I just uploaded are the same. Fat finger.)\n\nNOTE TO SELF: file in the local queue obsolete\n\npatchbot:\n\napply trac_15131-hazewinkel-basis-qfolded-dg.patch",
    "created_at": "2013-09-09T16:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189882",
    "user": "https://github.com/darijgr"
}
```

Thanks for catching this one. I hope this fixes it? (The two files I just uploaded are the same. Fat finger.)

NOTE TO SELF: file in the local queue obsolete

patchbot:

apply trac_15131-hazewinkel-basis-qfolded-dg.patch



---

archive/issue_comments_189883.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-09-09T16:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189883",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_189884.json:
```json
{
    "body": "It was an obscure typo to locate because it doesn't (currently: see #9107) appear in the html documentation.  I noticed that it was there from reading the patch on the trac server.",
    "created_at": "2013-09-09T16:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189884",
    "user": "https://github.com/zabrocki"
}
```

It was an obscure typo to locate because it doesn't (currently: see #9107) appear in the html documentation.  I noticed that it was there from reading the patch on the trac server.



---

archive/issue_comments_189885.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-09-09T16:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189885",
    "user": "https://github.com/zabrocki"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_189886.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-10-12T09:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14894#issuecomment-189886",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
