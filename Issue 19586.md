# Issue 19586: Addcode for computation of the Schouten, Cotton, and Cotton-York tensors of a riemannian metric

Issue created by migration from Trac.

Original creator: pang

Original creation time: 2016-01-02 17:16:10

Assignee: pang

CC:  egourgoulhon mbejger mmancini

Keywords: differentiable manifold, Riemannian metric, Cotton tensor, Cotton-York tensor, Schouten tensor




---

Comment by pang created at 2016-01-02 17:17:07

First draft


---

Attachment


---

Comment by pang created at 2016-01-02 17:29:46

Last 10 new commits:


---

Comment by git created at 2016-01-11 14:40:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pang created at 2016-01-11 14:46:11

The tests take really long to run on my (rather old) laptop. I can't come up with examples that are meaningful and take less than 5 seconds to compute. How should I proceed?


---

Comment by pang created at 2016-01-12 16:31:42

Changing status from new to needs_review.


---

Comment by egourgoulhon created at 2016-01-12 16:50:31

Replying to [comment:6 pang]:
> The tests take really long to run on my (rather old) laptop. I can't come up with examples that are meaningful and take less than 5 seconds to compute. How should I proceed?

Since the minimal non-trivial examples have to be at least 3-dimensional, it seems quite difficult to shorten signifcantly your examples. Moreover, the time taken by them (around 10 to 20 s for each of the 3 tensors) is similar to that taken in other parts of SageManifolds, e.g. in affine connections (ticket #19147). So for the moment, I would leave it as it is...


---

Comment by git created at 2016-01-12 22:04:46

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by egourgoulhon created at 2016-01-12 22:08:06

In the above commit, I have simply merge the latest version of the dependency ticket #19209 (updated today) into the branch of this ticket. There is no change in your code.


---

Comment by egourgoulhon created at 2016-01-13 14:56:18

Changing status from needs_review to needs_work.


---

Comment by egourgoulhon created at 2016-01-13 14:56:18

The introduction of a class attribute for the derived objects is a good idea! However, I would suggest that its name is changed from `DERIVED_OBJECTS` to `_derived_objects`. Indeed, it seems that in Sage, capital letters are not used for attributes. Moreover, the heading underscore indicates a "private" attribute, not exposed to a tab search. Otherwise, a user searching for some derivative via `g.der` + TAB, might find this attribute.

Here are some remarks about each of the three tensors:

- *Schouten tensor:* 
  The LaTeX formula defining the Schouten tensor in the documentation should
  use the same notations than in the rest of the documentation of class `PseudoRiemannianMetric`:
  Ricci should be denoted by 'Ric' (cf. method `ricci`) and the Ricci scalar should be denoted by 
  'r', not by 's' (cf. method `ricci_scalar`)

- *Cotton tensor:*
  The LaTeX formula defining the Cotton tensor in the documentation is not
  correct: it should be
  {{{
   C_{ijk} = \nabla_k S_{ij} - \nabla_j S_{ik}
  }}}
  (the Cotton tensor is antisymmetric in its last two indices).
  Besides, in the code, the line
  {{{
  cot = nabla(s).antisymmetrize(0,2)
  }}}
  must be replaced by
  {{{
  cot = 2 * nabla(s).antisymmetrize(1,2)
  }}}
  Indeed, the convention for the index positions of a covariant derivative is
  `(nabla(s))_{ijk} = \nabla_k s_{ij}`, i.e. the derivation index is the last one, cf. the note
  at http://sagemanifolds.obspm.fr/doc/19209/reference/manifolds/sage/manifolds/differentiable/affine_connection.html . Note also the factor 2 to compensate for the 1/2 factor introduced by the
  antisymmetrization. 
  Besides, I have the impression that in the literature, the Cotton tensor
  is generaly defined by
  {{{
  C_{ijk} = (n-2) ( \nabla_k S_{ij} - \nabla_j S_{ik} )
  }}}
  i.e. it differs from your definition by a factor n-2, cf. for instance
  https://en.wikipedia.org/wiki/Cotton_tensor.
  Of course in dimension 3, both definitions coincide, but could you please
  check the literature for n > 3 ?

- *Cotton-York tensor:*
  Since in the rest of the documentation, $\epsilon$ stands for the Levi-Civita
  tensor (cf. the method `volume_form`), there should be no $\sqrt{\det g}$ in the LaTeX formula
  defining the Cotton-York tensor. Moreover, the indices seem ill-placed; the
  correct formula is (cf. Eq. (4) in York's paper, Phys. Rev. Lett. *26*, 1656 (1971)
  or https://en.wikipedia.org/wiki/Cotton_tensor)
  {{{
   CY_{ij} = \frac{1}{2} \epsilon^{kl}_{\quad i} C_{jlk} 
           = \epsilon^{kl}_{\quad i} \nabla_k S_{lj}
  }}}
  Accordingly, in the code, the ligne
  {{{
  cy = -cot.contract(0,2,eps,0,1)
  }}}
  must be replaced by
  {{{
  cy = (1/2) * eps.contract(0, 1, cot, 2, 1)
  }}}
  Besides, the test
  {{{
   if n < 3:
  }}}
  must be replaced by
  {{{   
   if n != 3:
  }}}


---

Comment by pang created at 2016-01-20 16:59:07

It's true, your suggestions are in agreement with the literature.


---

Comment by pang created at 2016-01-20 17:00:41

One minor thing. I realized it is not possible to change the name of the tensor after the first call. Is this relevant? Should I consider this with respect to the #19209?


---

Comment by egourgoulhon created at 2016-01-21 13:16:11

Replying to [comment:14 pang]:
> One minor thing. I realized it is not possible to change the name of the tensor after the first call. 

Can't you change the name by means of the method `set_name` ?


---

Comment by git created at 2016-01-29 10:24:22

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by pang created at 2016-01-29 10:25:46

Changing status from needs_work to needs_review.


---

Comment by git created at 2016-01-30 16:07:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2016-01-30 16:13:07

The above commit is merely to solve a merge conflict with Sage 7.1.beta1 (there is no change in your code). This conflict was due to the merge of the latest version of #18529 into Sage 7.1.beta1.


---

Comment by git created at 2016-02-02 15:38:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2016-02-02 15:44:09

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2016-02-02 15:44:09

Thanks for your work on this! Your code is very nice.
I am setting the ticket to 'positive review', but the merge in main Sage will have to wait for the merge of the dependency ticket #19209.


---

Comment by jdemeyer created at 2016-02-06 15:22:14

Author name please


---

Comment by jdemeyer created at 2016-02-06 15:22:14

Changing status from positive_review to needs_info.


---

Comment by jdemeyer created at 2016-02-06 15:22:14

Changing priority from trivial to major.


---

Comment by jdemeyer created at 2016-02-06 15:25:25

Replying to [comment:21 egourgoulhon]:
> the merge in main Sage will have to wait for the merge of the dependency ticket #19209. 
...and #18640 and #18725 and #18783 and #18843 and #19092 and #19147. Such a deep dependency tree is scary.


---

Comment by egourgoulhon created at 2016-02-06 15:52:49

Replying to [comment:23 jdemeyer]:
> Replying to [comment:21 egourgoulhon]:
> > the merge in main Sage will have to wait for the merge of the dependency ticket #19209. 
> ...and #18640 and #18725 and #18783 and #18843 and #19092 and #19147.

Yes, each ticket depends on the preceding one.  

> Such a deep dependency tree is scary.

This results from the split of SageManifolds into small tickets, to ease the review process.
Note that the dependency tree is linear: each ticket depends only on the preceding one, the top being now #18640. 
The full tree is sketched on the metaticket #18528.


---

Comment by egourgoulhon created at 2016-02-08 22:03:05

Can we set this back to "positive review" ?


---

Comment by jdemeyer created at 2016-02-08 22:06:05

I don't object.


---

Comment by jdemeyer created at 2016-02-08 22:06:23

Changing status from needs_info to positive_review.


---

Comment by jdemeyer created at 2016-04-26 13:38:34

Please fix the formatting of the references, see #20496.


---

Comment by jdemeyer created at 2016-04-26 13:38:34

Changing status from positive_review to needs_work.


---

Comment by git created at 2016-05-07 13:24:54

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by egourgoulhon created at 2016-05-07 13:31:25

Changing status from needs_work to positive_review.


---

Comment by egourgoulhon created at 2016-05-07 13:31:25

Replying to [comment:29 jdemeyer]:
> Please fix the formatting of the references, see #20496.
This is done in the latest commit, along with some updates to take into account changes in #18640. 
I am therefore setting the ticket back to positive review, with the understanding that it can be merged in Sage only after the dependency #19209 has been merged.


---

Comment by git created at 2016-05-10 14:44:44

Changing status from positive_review to needs_review.


---

Comment by git created at 2016-05-10 14:44:44

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:


---

Comment by egourgoulhon created at 2016-05-10 14:50:06

The above commit is just an update taking into account changes in the preceding tickets.


---

Comment by egourgoulhon created at 2016-05-10 14:50:06

Changing status from needs_review to positive_review.


---

Comment by git created at 2016-08-16 13:21:24

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:


---

Comment by git created at 2016-08-16 13:21:24

Changing status from positive_review to needs_review.


---

Comment by egourgoulhon created at 2016-08-16 13:24:47

Back to positive review since the update merely progates changes in the preceding tickets.


---

Comment by egourgoulhon created at 2016-08-16 13:24:47

Changing status from needs_review to positive_review.


---

Comment by git created at 2016-10-24 14:57:55

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:


---

Comment by git created at 2016-10-24 14:57:55

Changing status from positive_review to needs_review.


---

Comment by egourgoulhon created at 2016-10-24 15:00:46

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2016-10-24 15:00:46

Setting back to positive review, since the latest commit simply solves a merge conflict with #21454.


---

Comment by git created at 2016-11-18 14:51:38

Changing status from positive_review to needs_review.


---

Comment by git created at 2016-11-18 14:51:38

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by egourgoulhon created at 2016-11-18 14:53:57

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2016-11-18 14:53:57

Setting back to positive review, since the latest commit merely solves a trivial merge conflict with Sage 7.5.beta3.


---

Comment by git created at 2016-11-20 10:28:37

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2016-11-20 10:28:37

Changing status from positive_review to needs_review.


---

Comment by egourgoulhon created at 2016-11-20 10:31:23

Setting back to positive review since the latest commit is a trivial fix of some uncommon case in tangent space construction.


---

Comment by egourgoulhon created at 2016-11-20 10:31:23

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-11-21 21:56:27

Resolution: fixed
