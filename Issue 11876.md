# Issue 11876: FiniteEnumeratedSet creates elements that don't inherit from Element

Issue created by migration from https://trac.sagemath.org/ticket/12048

Original creator: roed

Original creation time: 2011-11-17 14:04:58

Assignee: sage-combinat

CC:  hivert kini vdelecroix


```
    sage: S = FiniteEnumeratedSet(['a','b','c'])
    sage: S('a')
    ...
    TypeError: Cannot convert str to sage.structure.element.Element
```



---

Comment by roed created at 2011-11-17 14:15:13

Changing status from new to needs_review.


---

Attachment


---

Comment by nthiery created at 2011-11-17 17:30:10

Hi David,

I agree that `S('a')` in the example above should not fail. On the other hand, I am not keen on having a facade parent touching its elements. Florent: we should discuss about that.


---

Comment by roed created at 2011-11-17 17:39:31

Yeah, I wasn't completely happy with this solution either.  But I think that even though the elements of a facade parent don't have to have the right parent, they really should be Elements.

I'd be happy to entertain other solutions.


---

Comment by roed created at 2011-11-19 01:08:26

I'm not going to debug this now since you guys may want to change the approach, but this patch produces doctest errors in sage.combinat.free_module that seem to be related to sorting.


---

Comment by davidloeffler created at 2012-03-11 11:28:15

Changing status from needs_review to needs_work.


---

Comment by davidloeffler created at 2012-03-12 19:52:11

Any movement here? This has ended up being a prerequisite for a couple of other patches (#12039, #12260) and hence a lot of good code is piling up behind this.

I had a look at the error this causes in combinat.free_module, but I have no idea what's going on there.


---

Comment by hivert created at 2012-03-17 10:53:53

Replying to [comment:6 davidloeffler]:
> Any movement here? This has ended up being a prerequisite for a couple of other patches (#12039, #12260) and hence a lot of good code is piling up behind this.
> 
> I had a look at the error this causes in combinat.free_module, but I have no idea what's going on there.

Sorry that we forgot this one. I'll try to discuss it with Nicolas shortly. 

Florent


---

Comment by nthiery created at 2012-06-27 15:49:14

Dear David,

Sorry for lagging so much behind on this ticket. I have finally been
discussing with Florent, and we agreed on the following:

- We definitely want to have facade parents in Sage whose elements
  are plain Python objects. In fact we already have some: you can
  e.g. define facade posets on strings or
  sage.structure.parent.Set_PythonType(int).

  Under many circumstances, wrapping objects sure has its advantages
  (the element can make use of the parent information for certain
  operations), but there are also many use cases where constantly
  wrapping/unwrapping is a pain. 

  The worst is when a user gives a list of objects as input to
  construct some parent A (e.g. a CombinatorialFreeModule), and then
  (s)he accesses those objects from A he gets something that looks
  and smell like the original objects but differ in behavior in a
  subtle way

- Coercion should work for those parents. It does not currently due
  to this test whether the end result of __call__ is an Element. This
  should be easy to fix. We already got hurt by that with Posets, and
  had to resort to a hand made __call__ (yuck).

- By default, we prefer FiniteEnumeratedSets to be facades by default
  to not break backward compatibility, and also because this seems to
  be what we need most of the time (because there are barely no
  operations on the elements).


. Now if there is a clear need for it, we could add a facade
  option to have non facade FiniteEnumeratedSets.

What do you think? Do you feel like fixing coercion as above?

Cheers,
                                   Nicolas


---

Comment by mmezzarobba created at 2018-03-23 08:54:21

Is this ticket still relevant? The example in the description now seems to work.


---

Comment by vdelecroix created at 2018-03-23 14:24:25

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2018-03-23 14:24:25

Indeed a custom `__call__` was introduced to support this #16280.


---

Comment by hivert created at 2018-03-24 08:24:36

I confirm that this is a dup of #16280.


---

Comment by hivert created at 2018-03-24 08:24:36

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2018-05-18 17:16:26

Resolution: wontfix


---

Comment by vdelecroix created at 2018-05-18 17:16:26

closing positively reviewed duplicates
