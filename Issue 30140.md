# Issue 30140: improve doctests coverage in graphs

Issue created by migration from https://trac.sagemath.org/ticket/30377

Original creator: dcoudert

Original creation time: 2020-08-16 14:35:21

CC:  chapoton

- `generic_graph.py`: from 99.1% (227 of 229) to 100%


---

Comment by dcoudert created at 2020-08-16 17:37:27

The added doctests allow to reach 100% coverage, but are not very useful by themself.
----
New commits:


---

Comment by dcoudert created at 2020-08-16 17:37:27

Changing status from new to needs_review.


---

Comment by git created at 2020-08-17 09:39:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-08-17 14:38:44

ok, feu vert


---

Comment by chapoton created at 2020-08-17 14:38:44

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2020-08-17 14:39:36

Thanks!


---

Comment by fbissey created at 2020-08-21 08:43:17

Changing status from positive_review to needs_work.


---

Comment by fbissey created at 2020-08-21 08:43:17

Sorry, I am a bit annoyed already today.

Whose great idea was is to introduce new calls to `installed_packages` or any other of those functions in `sage/misc/packages.py` that we are desperately trying to purge to make sage more packageable? 

It may be a lesser offence in a doctest than at runtime but it is still objectionable. If Volker keeps this ticket merged in the current state, be assured there will be a follow up ticket to remove those bits.


---

Comment by dcoudert created at 2020-08-21 08:59:39

Sorry for that.

Should I change the doctest to something like that ?

```
sage: igraph_feature().is_present()  # optional - python_igraph 
True
```

or do you have a better suggestion ?


---

Comment by fbissey created at 2020-08-21 09:05:57

I sincerely have no better suggestion. Playing with automagically discoverable dependency at runtime is always a bit fun. I notice some other python packages usually do a runtime detection at the beginning of the test run and then skip what is not available. sage is taking a very different approach.

And testing the runtime tester is always going to leave you in a funny position.


---

Comment by git created at 2020-08-21 11:08:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-08-21 11:09:24

Should be better this way. The alternative is to simply remove the test.


---

Comment by dcoudert created at 2020-08-21 14:37:46

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2020-08-23 21:21:36

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2020-08-23 21:21:36

OK, Volker finally did not include the old version of the ticket in 9.2.beta10. Thanks for the correction.


---

Comment by vbraun created at 2020-08-26 21:17:36

Resolution: fixed
