# Issue 32032: Isogenies prime degree fails on some CM curves

archive/issues_032032.json:
```json
{
    "body": "CC:  @alexjbest\n\nKeywords: elliptic curves, isogeny, CM\n\nThe code:\n\n```\nK.<a> = QuadraticField(-11)\nE = EllipticCurve(K, [0,1,0,-117,-541])\nE.isogenies_prime_degree(53)\n```\nreturns an empty list. But, since E has CM by the ring of integers of K, it has to have an isogeny of degree p for p splitting in K, so this doesn't make sense.\n\nIf you import isogenies_prime_degree_general from isogeny_small_degree.py then \n\n```\nisogenies_prime_degree_general(E,53) \n```\ncorrectly returns \n\n```\n[Isogeny of degree 53 from Elliptic Curve defined by y^2 = x^3 + x^2 + (-117)*x + (-541) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I to Elliptic Curve defined by y^2 = x^3 + x^2 + (98560*a+42123)*x + (-12561472*a-61946205) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I,\n Isogeny of degree 53 from Elliptic Curve defined by y^2 = x^3 + x^2 + (-117)*x + (-541) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I to Elliptic Curve defined by y^2 = x^3 + x^2 + (-98560*a+42123)*x + (12561472*a-61946205) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32269\n\n",
    "created_at": "2021-07-23T18:23:02Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Isogenies prime degree fails on some CM curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32032",
    "user": "https://github.com/sachihashimoto"
}
```
CC:  @alexjbest

Keywords: elliptic curves, isogeny, CM

The code:

```
K.<a> = QuadraticField(-11)
E = EllipticCurve(K, [0,1,0,-117,-541])
E.isogenies_prime_degree(53)
```
returns an empty list. But, since E has CM by the ring of integers of K, it has to have an isogeny of degree p for p splitting in K, so this doesn't make sense.

If you import isogenies_prime_degree_general from isogeny_small_degree.py then 

```
isogenies_prime_degree_general(E,53) 
```
correctly returns 

```
[Isogeny of degree 53 from Elliptic Curve defined by y^2 = x^3 + x^2 + (-117)*x + (-541) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I to Elliptic Curve defined by y^2 = x^3 + x^2 + (98560*a+42123)*x + (-12561472*a-61946205) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I,
 Isogeny of degree 53 from Elliptic Curve defined by y^2 = x^3 + x^2 + (-117)*x + (-541) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I to Elliptic Curve defined by y^2 = x^3 + x^2 + (-98560*a+42123)*x + (12561472*a-61946205) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I]
```


Issue created by migration from https://trac.sagemath.org/ticket/32269





---

archive/issue_comments_456915.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2021-07-23T18:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456915",
    "user": "https://github.com/alexjbest"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_456916.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-07-23T18:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456916",
    "user": "https://github.com/alexjbest"
}
```

New commits:



---

archive/issue_comments_456917.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2021-07-23T19:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456917",
    "user": "https://github.com/alexjbest"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_456918.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-23T19:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456918",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456919.json:
```json
{
    "body": "LGTM, but that test with `ell = 53` is not going to fly.\n\nWhy not `ell = 37`? it is equally broken and takes 1/6 of the time.",
    "created_at": "2021-07-23T21:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456919",
    "user": "https://github.com/edgarcosta"
}
```

LGTM, but that test with `ell = 53` is not going to fly.

Why not `ell = 37`? it is equally broken and takes 1/6 of the time.



---

archive/issue_comments_456920.json:
```json
{
    "body": "`@`edgarcosta, right the example in code uses l=37, it might still need marking as # long time though, I'm not sure.",
    "created_at": "2021-07-25T13:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456920",
    "user": "https://github.com/alexjbest"
}
```

`@`edgarcosta, right the example in code uses l=37, it might still need marking as # long time though, I'm not sure.



---

archive/issue_comments_456921.json:
```json
{
    "body": "Upsidaisy! Ignore my comment then. \n\nI was hoping that the patch bot would tell us what to do regarding the necessity of the marking as # long",
    "created_at": "2021-07-25T15:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456921",
    "user": "https://github.com/edgarcosta"
}
```

Upsidaisy! Ignore my comment then. 

I was hoping that the patch bot would tell us what to do regarding the necessity of the marking as # long



---

archive/issue_comments_456922.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-26T11:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456923.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-06T14:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456923",
    "user": "https://github.com/edgarcosta"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_085523.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32032#event-85523"
}
```



---

archive/issue_comments_456924.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-01T20:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32032#issuecomment-456924",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_085524.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-01T20:55:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32032",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32032#event-85524"
}
```
