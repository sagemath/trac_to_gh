# Issue 32032: Isogenies prime degree fails on some CM curves

Issue created by migration from https://trac.sagemath.org/ticket/32269

Original creator: @sachihashimoto

Original creation time: 2021-07-23 18:23:02

CC:  alexjbest

Keywords: elliptic curves, isogeny, CM

The code:

```
K.<a> = QuadraticField(-11)
E = EllipticCurve(K, [0,1,0,-117,-541])
E.isogenies_prime_degree(53)
```

returns an empty list. But, since E has CM by the ring of integers of K, it has to have an isogeny of degree p for p splitting in K, so this doesn't make sense.

If you import isogenies_prime_degree_general from isogeny_small_degree.py then 

```
isogenies_prime_degree_general(E,53) 
```

correctly returns 


```
[Isogeny of degree 53 from Elliptic Curve defined by y^2 = x^3 + x^2 + (-117)*x + (-541) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I to Elliptic Curve defined by y^2 = x^3 + x^2 + (98560*a+42123)*x + (-12561472*a-61946205) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I,
 Isogeny of degree 53 from Elliptic Curve defined by y^2 = x^3 + x^2 + (-117)*x + (-541) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I to Elliptic Curve defined by y^2 = x^3 + x^2 + (-98560*a+42123)*x + (12561472*a-61946205) over Number Field in a with defining polynomial x^2 + 11 with a = 3.316624790355400?*I]
```




---

Comment by alexjbest created at 2021-07-23 18:59:17

Changing status from new to needs_info.


---

Comment by alexjbest created at 2021-07-23 18:59:17

New commits:


---

Comment by alexjbest created at 2021-07-23 19:00:57

Changing status from needs_info to needs_review.


---

Comment by git created at 2021-07-23 19:02:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by edgarcosta created at 2021-07-23 21:39:59

LGTM, but that test with `ell = 53` is not going to fly.

Why not `ell = 37`? it is equally broken and takes 1/6 of the time.


---

Comment by alexjbest created at 2021-07-25 13:32:11

`@`edgarcosta, right the example in code uses l=37, it might still need marking as # long time though, I'm not sure.


---

Comment by edgarcosta created at 2021-07-25 15:57:32

Upsidaisy! Ignore my comment then. 

I was hoping that the patch bot would tell us what to do regarding the necessity of the marking as # long


---

Comment by git created at 2021-07-26 11:58:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by edgarcosta created at 2021-08-06 14:47:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-09-01 20:55:09

Resolution: fixed
