# Issue 29890: cygwin-minimal: pip-20.1.1 fails to install

archive/issues_029890.json:
```json
{
    "body": "CC:  @embray @slel @dimpase\n\nhttps://github.com/sagemath/sage/runs/862451271\n\n```\n  [pip-20.1.1]     File \"/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/__init__.py\", line 7, in <module>\n  [pip-20.1.1]       from .connectionpool import HTTPConnectionPool, HTTPSConnectionPool, connection_from_url\n  [pip-20.1.1]     File \"/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/connectionpool.py\", line 29, in <module>\n  [pip-20.1.1]       from .connection import (\n  [pip-20.1.1]     File \"/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/connection.py\", line 68, in <module>\n  [pip-20.1.1]       class HTTPConnection(_HTTPConnection, object):\n  [pip-20.1.1]     File \"/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/connection.py\", line 96, in HTTPConnection\n  [pip-20.1.1]       default_socket_options = [(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)]\n  [pip-20.1.1]   AttributeError: module 'socket' has no attribute 'TCP_NODELAY'\n```\n\n\nThe install on `cygwin-standard` works fine.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30127\n\n",
    "created_at": "2020-07-12T21:40:23Z",
    "labels": [
        "component: porting: cygwin",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "cygwin-minimal: pip-20.1.1 fails to install",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29890",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @embray @slel @dimpase

https://github.com/sagemath/sage/runs/862451271

```
  [pip-20.1.1]     File "/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/__init__.py", line 7, in <module>
  [pip-20.1.1]       from .connectionpool import HTTPConnectionPool, HTTPSConnectionPool, connection_from_url
  [pip-20.1.1]     File "/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/connectionpool.py", line 29, in <module>
  [pip-20.1.1]       from .connection import (
  [pip-20.1.1]     File "/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/connection.py", line 68, in <module>
  [pip-20.1.1]       class HTTPConnection(_HTTPConnection, object):
  [pip-20.1.1]     File "/cygdrive/d/a/sage/sage/local/var/tmp/sage/build/pip-20.1.1/src/src/pip/_vendor/urllib3/connection.py", line 96, in HTTPConnection
  [pip-20.1.1]       default_socket_options = [(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)]
  [pip-20.1.1]   AttributeError: module 'socket' has no attribute 'TCP_NODELAY'
```


The install on `cygwin-standard` works fine.


Issue created by migration from https://trac.sagemath.org/ticket/30127





---

archive/issue_comments_424125.json:
```json
{
    "body": "Note that pip 20.2 was released.",
    "created_at": "2020-08-01T03:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424125",
    "user": "https://github.com/slel"
}
```

Note that pip 20.2 was released.



---

archive/issue_comments_424126.json:
```json
{
    "body": "Let's try with the following updates:\n\n- https://pypi.org/project/pip/ 20.2.1 update (https://pip.pypa.io/en/stable/news/)\n\n- https://pypi.org/project/setuptools/ 49.2.1",
    "created_at": "2020-08-07T17:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424126",
    "user": "https://github.com/mkoeppe"
}
```

Let's try with the following updates:

- https://pypi.org/project/pip/ 20.2.1 update (https://pip.pypa.io/en/stable/news/)

- https://pypi.org/project/setuptools/ 49.2.1



---

archive/issue_comments_424127.json:
```json
{
    "body": "Tests at https://github.com/mkoeppe/sage/actions/runs/199487278",
    "created_at": "2020-08-07T17:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424127",
    "user": "https://github.com/mkoeppe"
}
```

Tests at https://github.com/mkoeppe/sage/actions/runs/199487278



---

archive/issue_comments_424128.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-08-07T17:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424128",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_424129.json:
```json
{
    "body": "Same with pip 20.2.1 - https://github.com/mkoeppe/sage/runs/959258905",
    "created_at": "2020-08-07T20:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424129",
    "user": "https://github.com/mkoeppe"
}
```

Same with pip 20.2.1 - https://github.com/mkoeppe/sage/runs/959258905



---

archive/issue_comments_424130.json:
```json
{
    "body": "Should probably look at the `python3` build log on this system.",
    "created_at": "2020-08-07T20:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424130",
    "user": "https://github.com/mkoeppe"
}
```

Should probably look at the `python3` build log on this system.



---

archive/issue_comments_424131.json:
```json
{
    "body": "The same error also with pip 20.1.1 and python3 3.8.5 from #27754.",
    "created_at": "2020-08-07T20:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424131",
    "user": "https://github.com/mkoeppe"
}
```

The same error also with pip 20.1.1 and python3 3.8.5 from #27754.



---

archive/issue_comments_424132.json:
```json
{
    "body": "Apparently caused by a recent change in the Cygwin headers: https://bugs.python.org/issue41374",
    "created_at": "2020-08-07T20:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424132",
    "user": "https://github.com/mkoeppe"
}
```

Apparently caused by a recent change in the Cygwin headers: https://bugs.python.org/issue41374



---

archive/issue_comments_424133.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-08-07T20:59:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424133",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_424134.json:
```json
{
    "body": "Tests at https://github.com/mkoeppe/sage/actions/runs/199703638",
    "created_at": "2020-08-07T21:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424134",
    "user": "https://github.com/mkoeppe"
}
```

Tests at https://github.com/mkoeppe/sage/actions/runs/199703638



---

archive/issue_comments_424135.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-07T21:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424135",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_424136.json:
```json
{
    "body": "This worked, as can be seen in https://github.com/mkoeppe/sage/runs/959927471\n\nNeeds review",
    "created_at": "2020-08-08T18:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424136",
    "user": "https://github.com/mkoeppe"
}
```

This worked, as can be seen in https://github.com/mkoeppe/sage/runs/959927471

Needs review



---

archive/issue_comments_424137.json:
```json
{
    "body": "Let's get this in please",
    "created_at": "2020-08-13T22:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424137",
    "user": "https://github.com/mkoeppe"
}
```

Let's get this in please



---

archive/issue_comments_424138.json:
```json
{
    "body": "lgtm",
    "created_at": "2020-08-14T11:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424138",
    "user": "https://github.com/dimpase"
}
```

lgtm



---

archive/issue_comments_424139.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-14T11:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424139",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_424140.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-08-14T11:38:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424140",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_comments_424141.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-15T09:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-424141",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
