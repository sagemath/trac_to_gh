# Issue 16056: Fix sage-cleaner's rm_rf function on OS X

Issue created by migration from https://trac.sagemath.org/ticket/16293

Original creator: jhpalmieri

Original creation time: 2014-05-05 20:18:27

On OS X, if you use `os.unlink` on a directory, you get an OSError, "[Errno 1] Operation not permitted". We need to catch this so that `sage-cleaner` works properly. (On linux machines, you seem to get OSError, "[Errno 21] Is a directory".)


---

Comment by jhpalmieri created at 2014-05-05 20:18:37

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2014-05-05 20:23:51

Note that without this patch, `sage-cleaner` keeps writing this to the log file:

```
Checking PIDs [36850]
Process 36850 is no longer running, so we clean up
Deleting /Users/palmieri/.sage/temp/jpalmieri/36850
```

without successfully deleting the directory. So after a while, the log file is quite large, the directory is still there, and `sage-cleaner` is still running.


---

Comment by leif created at 2014-05-05 21:50:41

Fix certainly looks correct, but I can't test whether it really fixes the problem on MacOS X right now...


---

Comment by leif created at 2014-05-05 22:07:34

Replying to [comment:3 leif]:
> I can't test whether it really fixes the problem on MacOS X right now...

WFM.


---

Comment by leif created at 2014-05-05 22:07:34

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-05-06 14:58:51

Resolution: fixed
