# Issue 28711: some preparation for ipython7

Issue created by migration from https://trac.sagemath.org/ticket/28948

Original creator: chapoton

Original creation time: 2020-01-03 09:35:25

CC:  arojas embray tscrim

to be merged before #28197

This is inspired by some pieces of the patch 

https://aur.archlinux.org/cgit/aur.git/tree/sagemath-ipython7.patch?h=sagemath-python3-git


---

Comment by chapoton created at 2020-01-03 09:36:03

New commits:


---

Comment by chapoton created at 2020-01-03 09:36:03

Changing type from PLEASE CHANGE to enhancement.


---

Comment by chapoton created at 2020-01-03 09:36:03

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-01-03 18:04:40

bot is morally green, please review


---

Comment by jhpalmieri created at 2020-01-04 00:20:08

Works with Python 3 and Python 2 builds.


---

Comment by jhpalmieri created at 2020-01-04 00:20:08

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-01-04 08:24:47

thx


---

Comment by vbraun created at 2020-01-09 23:44:08

Resolution: fixed


---

Comment by arojas created at 2020-01-10 21:10:23

Unfortunately this doesn't really work as intended. The reason why the imp import is an issue with ipython 7 is that, unlike ipython 5, it displays the python deprecation warnings, which makes many tests fail.

With this patch, `from imp import reload` still succeeds (imp hasn't been removed yet even in 3.8, it is just deprecated), so instead of using impotlib, it still shows the deprecation warnings and tests fail.


---

Comment by arojas created at 2020-01-10 21:14:40

I guess the solution is to try the importlib import first
