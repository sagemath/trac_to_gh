# Issue 33262: implement inverse_of_unit on multivariate polynomials

Issue created by migration from https://trac.sagemath.org/ticket/33499

Original creator: vdelecroix

Original creation time: 2022-03-14 08:55:14

CC:  @davidayotte

Even though `is_unit` and `is_nilpotent` are correctly implemented the various implementations of `inverse_of_unit` are either wrong or not doing their job

```
sage: R.<x,y> = Zmod(4)[]
sage: u = 1 + 2*x + 2*y**2
sage: u.is_unit()
True
sage: (u * u).is_one()
True
sage: u.inverse_of_unit()
Traceback (most recent call last):
...
ArithmeticError: Element is not a unit.
```



---

Comment by vdelecroix created at 2022-03-14 14:13:43

New commits:


---

Comment by vdelecroix created at 2022-03-14 14:13:43

Changing status from new to needs_review.


---

Comment by @DavidAyotte created at 2022-03-14 17:33:03

Hello Vincent, thank you for this fix. Minor comment: according to the reviewer's checklist (https://doc.sagemath.org/html/en/developer/reviewer_checklist.html) you should mention the number of this ticket in the doctests saying that you fixed the bug you found.

Anyhow, everything looks good. I will wait for the result of the doctest for the rest.


---

Comment by @DavidAyotte created at 2022-03-14 18:01:46

The three failed doctests are not related to this ticket.


---

Comment by git created at 2022-03-14 20:00:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @DavidAyotte created at 2022-03-14 20:04:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-03-26 21:49:16

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2022-03-26 21:49:16

This ticket causes timeouts in

```
sage -t --long --random-seed=114734410077030599852047573071790577692 src/sage/rings/valuation/augmented_valuation.py  # Timed out
```

