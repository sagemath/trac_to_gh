# Issue 30924: build/pkgs/qhull: Update, add spkg-configure.m4

Issue created by migration from https://trac.sagemath.org/ticket/31161

Original creator: mkoeppe

Original creation time: 2021-01-02 20:18:06

CC:  @zlscherr jhpalmieri dimpase arojas mjo mkoeppe

Library conflicts prompted #31148 (MR51: Allow Matplotlib to use system qhull >= 7.2.0).

We should also allow our optional package `qhull` to find system qhull; and upgrade it on the way.


---

Comment by slelievre created at 2021-03-22 21:25:18

Changing keywords from "" to "upgrade, qhull".


---

Comment by slelievre created at 2021-03-22 21:25:18

Changing status from new to needs_review.


---

Comment by slelievre created at 2021-03-22 21:25:18

New commits:


---

Comment by slelievre created at 2021-03-22 21:25:57

This is still missing an `spkg-configure.m4` file. Help welcome.


---

Comment by slelievre created at 2021-03-22 21:25:57

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-07-19 13:21:17

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2021-07-19 13:21:53

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2021-07-19 13:29:27

testing on GH actions (with matplotlib 3.4 update on #31580)


---

Comment by git created at 2021-09-08 09:08:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2021-09-08 09:10:03

rebased over latest beta


---

Comment by dimpase created at 2021-09-08 09:13:04

testing on https://github.com/sagemath/sagetrac-mirror/actions/runs/1212707884


---

Comment by git created at 2021-09-10 11:47:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-09-14 09:20:02

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2021-09-14 09:25:13

rebased over 9.5.beta1

tests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1233039865 as part of matplotlib update to 3.4


---

Comment by dimpase created at 2021-09-14 10:22:18

scratch the latest GH action link, it should be https://github.com/sagemath/sagetrac-mirror/actions/runs/1233224818


---

Comment by dimpase created at 2021-09-14 10:29:01

Changing component from packages: optional to packages: standard.


---

Comment by dimpase created at 2021-09-14 10:29:01

Changing keywords from "upgrade, qhull" to "upgrade, qhull, build-configure".


---

Comment by dimpase created at 2021-09-14 10:30:01

Changing keywords from "upgrade, qhull, build-configure" to "upgrade, qhull, spkg-configure".


---

Comment by jhpalmieri created at 2021-09-14 17:54:06

Why did we patch the makefile to apparently only install some of the pieces, and why is it now okay to remove that patch?


---

Comment by dimpase created at 2021-09-14 19:11:38

Replying to [comment:19 jhpalmieri]:
> Why did we patch the makefile to apparently only install some of the pieces, and why is it now okay to remove that patch?

That's the question for Samuel, I only added `spkg-configure.m4` here.


---

Comment by slelievre created at 2021-09-14 19:26:41

Sorry. Please restore the patch.

Dima, can you indent the spkg-configure.m4 file using spaces only?
And maybe set your text editor to not use tabs in .m4 files?
See #31528.


---

Comment by jhpalmieri created at 2021-09-14 19:58:40

It built without the patch for me, but that's only one machine. So maybe the patch isn't needed with the new version? (Mine was an honest question, not a request to restore the patch.)


---

Comment by dimpase created at 2021-09-14 21:00:39

I don't know whether restoring this patch won't break the new matplotlib (which now depends on qhull). I won't be bothered, honestly. This patch looks unnecessary to me. Why it was there in the 1st place, goes back more than 5 years (I think it was imported from an old-style spkg, in 2016).

And it won't apply, it seems that the qhull's build system has been  changed quite a bit.


---

Comment by dimpase created at 2021-09-14 22:18:34

one more minor thing: on Ubuntu the package name is `libqhull-dev` (and there is no libqhull or qhull package) - so this needs to be corrected.


---

Comment by git created at 2021-09-14 22:26:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2021-09-14 22:33:03

restarted GH Action here https://github.com/sagemath/sagetrac-mirror/actions/runs/1235471874


---

Comment by dimpase created at 2021-09-19 10:55:45

tests are done, please have a look


---

Comment by jhpalmieri created at 2021-09-21 20:22:25

Looks okay to me. A further test will be how it works with the upgraded `matplotlib`, but that's for #31580.


---

Comment by jhpalmieri created at 2021-09-21 20:22:25

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-09-21 22:15:16

Thanks. The GH Actions were run for #31580 (the branch here is a part of it).


---

Comment by vbraun created at 2021-10-09 11:10:28

Resolution: fixed
