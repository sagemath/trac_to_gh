# Issue 16393: Fix category for finite Coxeter groups

archive/issues_016393.json:
```json
{
    "body": "Assignee: @tscrim\n\nCC:  @nthiery @fchapoton @jplab vripoll\n\nKeywords: Coxeter, category\n\nCurrently finite Coxeter groups don't know that they are finite.\n\n```\nsage: CG = CoxeterGroup(['D',4])\nsage: CG.category()\nCategory of coxeter groups\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16630\n\n",
    "created_at": "2014-07-09T04:21:47Z",
    "labels": [
        "component: group theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Fix category for finite Coxeter groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16393",
    "user": "https://github.com/tscrim"
}
```
Assignee: @tscrim

CC:  @nthiery @fchapoton @jplab vripoll

Keywords: Coxeter, category

Currently finite Coxeter groups don't know that they are finite.

```
sage: CG = CoxeterGroup(['D',4])
sage: CG.category()
Category of coxeter groups
```


Issue created by migration from https://trac.sagemath.org/ticket/16630





---

archive/issue_comments_214993.json:
```json
{
    "body": "Okay, it's now up for review. It feels somewhat hacky to me (in particular, I had to catch an `OverflowError`), but it comes from Sage's somewhat lack of ability to compute positive definiteness of a matrix over a variety of fields. Although I do feel that checking for positive definiteness is better than doing the matrix comparisons, at least as a first try. meh *shrugs*\n----\nNew commits:",
    "created_at": "2014-07-09T07:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214993",
    "user": "https://github.com/tscrim"
}
```

Okay, it's now up for review. It feels somewhat hacky to me (in particular, I had to catch an `OverflowError`), but it comes from Sage's somewhat lack of ability to compute positive definiteness of a matrix over a variety of fields. Although I do feel that checking for positive definiteness is better than doing the matrix comparisons, at least as a first try. meh *shrugs*
----
New commits:



---

archive/issue_comments_214994.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-09T07:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214994",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_214995.json:
```json
{
    "body": "What does this have to do with real numbers?",
    "created_at": "2014-07-29T18:23:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214995",
    "user": "https://github.com/darijgr"
}
```

What does this have to do with real numbers?



---

archive/issue_comments_214996.json:
```json
{
    "body": "It has to do with `positive_definite` trying to work over `RR` but the default for the matrices (for the Coexter groups) is over the universal cyclotomic field.",
    "created_at": "2014-07-30T03:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214996",
    "user": "https://github.com/tscrim"
}
```

It has to do with `positive_definite` trying to work over `RR` but the default for the matrices (for the Coexter groups) is over the universal cyclotomic field.



---

archive/issue_comments_214997.json:
```json
{
    "body": "Ah, I see. Hmm, are these matrices bounded away from singularity well enough that we can trust this to work? Otherwise I'd rather take the irreducible decomposition of the matrix (Dijkstra's algorithm, should be fast) and check each of them for being a Coxeter-Dynkin diagram (now that can be annoying). I assume the two steps of this procedure (irreducible decomposition and Coxeter-Dynkin classification) are something we want to have anyway; or do we already?",
    "created_at": "2014-07-30T09:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214997",
    "user": "https://github.com/darijgr"
}
```

Ah, I see. Hmm, are these matrices bounded away from singularity well enough that we can trust this to work? Otherwise I'd rather take the irreducible decomposition of the matrix (Dijkstra's algorithm, should be fast) and check each of them for being a Coxeter-Dynkin diagram (now that can be annoying). I assume the two steps of this procedure (irreducible decomposition and Coxeter-Dynkin classification) are something we want to have anyway; or do we already?



---

archive/issue_comments_214998.json:
```json
{
    "body": "As far as I've tested. The fallback (in case an error is raised) is to check by comparing Coxeter matrices under the standard labeling, but does not break it up into irreducible components. It probably is better to do the process entirely using graph comparisons (it feels like it should be slower, but maybe it's not...). Although no such check has been implemented for Coxeter diagrams/matrices, which currently don't have dedicated classes (#16126). (BTW there's only limited support for Dynkin diagrams.)",
    "created_at": "2014-07-30T15:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214998",
    "user": "https://github.com/tscrim"
}
```

As far as I've tested. The fallback (in case an error is raised) is to check by comparing Coxeter matrices under the standard labeling, but does not break it up into irreducible components. It probably is better to do the process entirely using graph comparisons (it feels like it should be slower, but maybe it's not...). Although no such check has been implemented for Coxeter diagrams/matrices, which currently don't have dedicated classes (#16126). (BTW there's only limited support for Dynkin diagrams.)



---

archive/issue_events_048773.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16393#event-48773"
}
```



---

archive/issue_comments_214999.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-28T19:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-214999",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215000.json:
```json
{
    "body": "I thought this would be fun :/ Not really tested so far (I have added doctests checking that finite Coxeter groups are recognized as finite, but it is much harder to test that infinite Coxeter groups are not). But you can throw away the red #16634 dependency at least.\n\nCan you check that my retraction of your base_ring.one() -> base_ring(2) edit was correct? Also, I was a bit worried about the slash in `val(coxeter_matrix[i, j]) / base_ring(-2)` getting reinterpreted as division-with-rest when `base_ring` is ZZ, but apparently this does not cause issues.",
    "created_at": "2014-10-28T19:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215000",
    "user": "https://github.com/darijgr"
}
```

I thought this would be fun :/ Not really tested so far (I have added doctests checking that finite Coxeter groups are recognized as finite, but it is much harder to test that infinite Coxeter groups are not). But you can throw away the red #16634 dependency at least.

Can you check that my retraction of your base_ring.one() -> base_ring(2) edit was correct? Also, I was a bit worried about the slash in `val(coxeter_matrix[i, j]) / base_ring(-2)` getting reinterpreted as division-with-rest when `base_ring` is ZZ, but apparently this does not cause issues.



---

archive/issue_comments_215001.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-29T19:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215001",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215002.json:
```json
{
    "body": "A few thoughts:\n\n- If the finiteness testing algorithm is slow, we might want to add an option to provide the necessary info right away.\n\n- The algorithm does a lot more than finiteness checking: it breaks the group into irreducibles, and (with some modification) should be able to build an explicit isomorphism of a finite Coxeter group to a direct product of classical Cartan-type groups. Methinks we should make use of this. Should this isomorphism be cached?",
    "created_at": "2014-10-29T19:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215002",
    "user": "https://github.com/darijgr"
}
```

A few thoughts:

- If the finiteness testing algorithm is slow, we might want to add an option to provide the necessary info right away.

- The algorithm does a lot more than finiteness checking: it breaks the group into irreducibles, and (with some modification) should be able to build an explicit isomorphism of a finite Coxeter group to a direct product of classical Cartan-type groups. Methinks we should make use of this. Should this isomorphism be cached?



---

archive/issue_comments_215003.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-29T19:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215003",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215004.json:
```json
{
    "body": "Replying to [comment:10 darij]:\n> A few thoughts:\n> \n> - If the finiteness testing algorithm is slow, we might want to add an option to provide the necessary info right away.\n> \n> - The algorithm does a lot more than finiteness checking: it breaks the group into irreducibles, and (with some modification) should be able to build an explicit isomorphism of a finite Coxeter group to a direct product of classical Cartan-type groups. Methinks we should make use of this. Should this isomorphism be cached?\n\nA couple further thoughts:\n\nLooking at \u200bdd22351, this indeed looks like an automatic type\nrecognition starting from a Coxeter diagram or Dynkin diagram, as is\nimplemented in GAP 3. That's been in the TODO list for a while [1], so\nit would be rather cool. If we go this way, this should really be a\nmethod of CartanType and friends, and we should reuse the same\nalgorithm for this method as in GAP3, except that we have fast graph\nisomorphism tests, so we can simplify it a bit. For the name, maybe\nthis could be `isomorphic_named_cartan_type`. Although we probably\nwant to return a relabelled Cartan type that exactly matches the\noriginal Cartan type.\n\nThis could then, in the long run, be used for any Coxeter group, be it\ndefined by a Coxeter matrix or concretely by simple reflections and a\nproduct rule: first build the Coxeter diagram by computing the length\nof the braid relation between the simple reflections, and then get the\ncanonical type. Single caveat: if, for a given Coxeter group, all we\nhave available is the possibility to compute products of such simple\nreflections, then we can get stuck computing that order if there is an\ninfinite braid relation.\n\nFor the record real positivity test is implemented, with guaranteed\nresult, in UCF:\n\n```\nsage: x = UniversalCyclotomicField().an_element()\nsage: x.is_real_positive()\n```\n\nMaybe this is a simpler way to go.\n\nIf the user knows right away that the groupe is finite (or infinite),\nthen he should just pass that information on with a\n`category=CoxeterGroups().Finite()` argument.\n\nCheers,\n                                Nicolas\n\n[1] http://trac.sagemath.org/wiki/SageCombinatChevieStatusReport",
    "created_at": "2014-10-30T07:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215004",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:10 darij]:
> A few thoughts:
> 
> - If the finiteness testing algorithm is slow, we might want to add an option to provide the necessary info right away.
> 
> - The algorithm does a lot more than finiteness checking: it breaks the group into irreducibles, and (with some modification) should be able to build an explicit isomorphism of a finite Coxeter group to a direct product of classical Cartan-type groups. Methinks we should make use of this. Should this isomorphism be cached?

A couple further thoughts:

Looking at â€‹dd22351, this indeed looks like an automatic type
recognition starting from a Coxeter diagram or Dynkin diagram, as is
implemented in GAP 3. That's been in the TODO list for a while [1], so
it would be rather cool. If we go this way, this should really be a
method of CartanType and friends, and we should reuse the same
algorithm for this method as in GAP3, except that we have fast graph
isomorphism tests, so we can simplify it a bit. For the name, maybe
this could be `isomorphic_named_cartan_type`. Although we probably
want to return a relabelled Cartan type that exactly matches the
original Cartan type.

This could then, in the long run, be used for any Coxeter group, be it
defined by a Coxeter matrix or concretely by simple reflections and a
product rule: first build the Coxeter diagram by computing the length
of the braid relation between the simple reflections, and then get the
canonical type. Single caveat: if, for a given Coxeter group, all we
have available is the possibility to compute products of such simple
reflections, then we can get stuck computing that order if there is an
infinite braid relation.

For the record real positivity test is implemented, with guaranteed
result, in UCF:

```
sage: x = UniversalCyclotomicField().an_element()
sage: x.is_real_positive()
```

Maybe this is a simpler way to go.

If the user knows right away that the groupe is finite (or infinite),
then he should just pass that information on with a
`category=CoxeterGroups().Finite()` argument.

Cheers,
                                Nicolas

[1] http://trac.sagemath.org/wiki/SageCombinatChevieStatusReport



---

archive/issue_comments_215005.json:
```json
{
    "body": "The only unbounded edges for finite Coxeter diagrams are the dihedral groups, so we just special case rank 2 (which are almost always finite and we should be able to check the infinite case easily enough) and then build the graph by checking (xy)<sup>m</sup> up to m = 5 (the finite check) or some specified user input.",
    "created_at": "2014-10-30T15:56:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215005",
    "user": "https://github.com/tscrim"
}
```

The only unbounded edges for finite Coxeter diagrams are the dihedral groups, so we just special case rank 2 (which are almost always finite and we should be able to check the infinite case easily enough) and then build the graph by checking (xy)<sup>m</sup> up to m = 5 (the finite check) or some specified user input.



---

archive/issue_comments_215006.json:
```json
{
    "body": "True enough; for finiteness checking purposes, only rank 2 is an issue. In the case at hand,\nthat's easy to handle. Gor Coxeter groups implepented differently, we might not be able to decide, but that's a narrow enough case that we can leave the responsability to the group implementer.\n\nCheers,",
    "created_at": "2014-10-31T08:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215006",
    "user": "https://github.com/nthiery"
}
```

True enough; for finiteness checking purposes, only rank 2 is an issue. In the case at hand,
that's easy to handle. Gor Coxeter groups implepented differently, we might not be able to decide, but that's a narrow enough case that we can leave the responsability to the group implementer.

Cheers,



---

archive/issue_comments_215007.json:
```json
{
    "body": "Notes for Darij from our discussion:\n\n- Make the finiteness check a separate static function.\n- Make the testing for #16630 more systematic using something like\n\n```\nsage: all(CoxeterGroup(ct) in CoxeterGroups().Finite() for ct in some_list_of_types)\nTrue\n```\n",
    "created_at": "2014-11-17T06:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215007",
    "user": "https://github.com/tscrim"
}
```

Notes for Darij from our discussion:

- Make the finiteness check a separate static function.
- Make the testing for #16630 more systematic using something like

```
sage: all(CoxeterGroup(ct) in CoxeterGroups().Finite() for ct in some_list_of_types)
True
```




---

archive/issue_comments_215008.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-14T10:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_048774.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-02-14T10:56:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16393#event-48774"
}
```



---

archive/issue_events_048775.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-02-14T10:56:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16393#event-48775"
}
```



---

archive/issue_comments_215009.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-14T13:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215010.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-14T20:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215010",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215011.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-14T21:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215011",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215012.json:
```json
{
    "body": "Hmm, I am having some git problems.. Let me try with this branch\n\npublic/ticket/16630",
    "created_at": "2015-02-14T21:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215012",
    "user": "https://github.com/fchapoton"
}
```

Hmm, I am having some git problems.. Let me try with this branch

public/ticket/16630



---

archive/issue_comments_215013.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-02-14T21:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215013",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_215014.json:
```json
{
    "body": "Ok, I think this is good to go. Can somebody review my commits ?",
    "created_at": "2015-02-15T17:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215014",
    "user": "https://github.com/fchapoton"
}
```

Ok, I think this is good to go. Can somebody review my commits ?



---

archive/issue_comments_215015.json:
```json
{
    "body": "LGTM modulo one minor change: when constructing `self._bilinear`, could we divide by `base_field(-2)` instead of `base_ring(-2)` (since this coercion will happen anyways)? Once this change is made, then you can set a positive review on my behalf.",
    "created_at": "2015-02-17T23:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215015",
    "user": "https://github.com/tscrim"
}
```

LGTM modulo one minor change: when constructing `self._bilinear`, could we divide by `base_field(-2)` instead of `base_ring(-2)` (since this coercion will happen anyways)? Once this change is made, then you can set a positive review on my behalf.



---

archive/issue_comments_215016.json:
```json
{
    "body": "A git question: When this branch gets merged, will the branch in #16634 become invisible (i.e., appear to do nothing)? This is one of those corner cases where I'm worried about git doing the wrong thing, because I reverted the changes from #16634 in a followup commit here.",
    "created_at": "2015-02-18T03:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215016",
    "user": "https://github.com/darijgr"
}
```

A git question: When this branch gets merged, will the branch in #16634 become invisible (i.e., appear to do nothing)? This is one of those corner cases where I'm worried about git doing the wrong thing, because I reverted the changes from #16634 in a followup commit here.



---

archive/issue_comments_215017.json:
```json
{
    "body": "Also, I suggest we do allow the user to pass a boolean `is_finite` parameter to sidestep finiteness recognition. I reckon that lots of Coxeter groups constructed will be `A_n` and `B_n` for high `n`.",
    "created_at": "2015-02-18T03:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215017",
    "user": "https://github.com/darijgr"
}
```

Also, I suggest we do allow the user to pass a boolean `is_finite` parameter to sidestep finiteness recognition. I reckon that lots of Coxeter groups constructed will be `A_n` and `B_n` for high `n`.



---

archive/issue_comments_215018.json:
```json
{
    "body": "It should be okay. If it doesn't work, the commits from #16634 are still in the history which we can pull out.\n\nFor the flag thing, because of pickling and how `UniqueRepresentation` works, we are better off doing a partial version of #16126 by making a class for `CoxeterMatrix`, which is now #17798 and should be easy enough to do (and will be high on my todo list).",
    "created_at": "2015-02-18T03:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215018",
    "user": "https://github.com/tscrim"
}
```

It should be okay. If it doesn't work, the commits from #16634 are still in the history which we can pull out.

For the flag thing, because of pickling and how `UniqueRepresentation` works, we are better off doing a partial version of #16126 by making a class for `CoxeterMatrix`, which is now #17798 and should be easy enough to do (and will be high on my todo list).



---

archive/issue_comments_215019.json:
```json
{
    "body": "Oh wait, I see that I actually already rebased #16634. Forget about it then.\n\nWill #17798 mean that Coxeter groups given via their types will be tested for finiteness directly rather than using my matrix-analysis code? That would indeed be a solution.",
    "created_at": "2015-02-18T05:02:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215019",
    "user": "https://github.com/darijgr"
}
```

Oh wait, I see that I actually already rebased #16634. Forget about it then.

Will #17798 mean that Coxeter groups given via their types will be tested for finiteness directly rather than using my matrix-analysis code? That would indeed be a solution.



---

archive/issue_comments_215020.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-18T08:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215021.json:
```json
{
    "body": "So is this ok now ?",
    "created_at": "2015-02-18T08:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215021",
    "user": "https://github.com/fchapoton"
}
```

So is this ok now ?



---

archive/issue_comments_215022.json:
```json
{
    "body": "`@`darij Yes, that's correct, or at least what I'm planning to do on #17798. (I added your name to the authors list since you wrote the first version of the recognition algorithm.)\n\n`@`Frederic Yes. Thank you.",
    "created_at": "2015-02-18T15:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215022",
    "user": "https://github.com/tscrim"
}
```

`@`darij Yes, that's correct, or at least what I'm planning to do on #17798. (I added your name to the authors list since you wrote the first version of the recognition algorithm.)

`@`Frederic Yes. Thank you.



---

archive/issue_comments_215023.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-18T15:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215023",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_048776.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-02-18T15:41:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16393#event-48776"
}
```



---

archive/issue_events_048777.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-02-18T15:41:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16393#event-48777"
}
```



---

archive/issue_comments_215024.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-02-18T21:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215024",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_215025.json:
```json
{
    "body": "\n```\nsage -t --long --warn-long 39.8 src/sage/groups/matrix_gps/coxeter_group.py  # 2 doctests failed\n```\n",
    "created_at": "2015-02-18T21:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215025",
    "user": "https://github.com/vbraun"
}
```


```
sage -t --long --warn-long 39.8 src/sage/groups/matrix_gps/coxeter_group.py  # 2 doctests failed
```




---

archive/issue_comments_215026.json:
```json
{
    "body": "Damn.. Now that they are recognized to be finite, an iterator seems to be required.. or at least a cardinality method maybe..\n\n```\nsage: W = CoxeterGroup([[1,3,2],[3,1,4],[2,4,1]], base_ring=QQbar)\nsage: W.is_finite()\nTrue\nsage: W.cardinality()\nBOOM\n```\n",
    "created_at": "2015-02-19T08:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215026",
    "user": "https://github.com/fchapoton"
}
```

Damn.. Now that they are recognized to be finite, an iterator seems to be required.. or at least a cardinality method maybe..

```
sage: W = CoxeterGroup([[1,3,2],[3,1,4],[2,4,1]], base_ring=QQbar)
sage: W.is_finite()
True
sage: W.cardinality()
BOOM
```




---

archive/issue_comments_215027.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-19T09:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215027",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215028.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-19T09:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215028",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_215029.json:
```json
{
    "body": "Ok, adding a cardinality method seems to work.\n\nI have also added the word \"Finite\" to the repr when the Coxeter group is finite.",
    "created_at": "2015-02-19T09:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215029",
    "user": "https://github.com/fchapoton"
}
```

Ok, adding a cardinality method seems to work.

I have also added the word "Finite" to the repr when the Coxeter group is finite.



---

archive/issue_comments_215030.json:
```json
{
    "body": "I renamed this method `order`, which is the real cause of the issue why `cardinality` from `FiniteEnumeratedSets` isn't working properly (and `order` raises a `NotImplementedError` where it shouldn't either). I also refined the category to `Infinite` if the group is not finite.\n\nNote that I cherry-picked your commits into this branch (since I don't want to upgrade my copy of Sage today).\n----\nNew commits:",
    "created_at": "2015-02-19T17:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215030",
    "user": "https://github.com/tscrim"
}
```

I renamed this method `order`, which is the real cause of the issue why `cardinality` from `FiniteEnumeratedSets` isn't working properly (and `order` raises a `NotImplementedError` where it shouldn't either). I also refined the category to `Infinite` if the group is not finite.

Note that I cherry-picked your commits into this branch (since I don't want to upgrade my copy of Sage today).
----
New commits:



---

archive/issue_comments_215031.json:
```json
{
    "body": "Looks good to me. If you agree, you can set a positive review.",
    "created_at": "2015-02-19T20:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215031",
    "user": "https://github.com/fchapoton"
}
```

Looks good to me. If you agree, you can set a positive review.



---

archive/issue_comments_215032.json:
```json
{
    "body": "I'm good with things; Darij?",
    "created_at": "2015-02-19T21:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215032",
    "user": "https://github.com/tscrim"
}
```

I'm good with things; Darij?



---

archive/issue_comments_215033.json:
```json
{
    "body": "From a quick glance at it, yes. But I haven't been keeping track of this ticket too closely, so I hope someone has reviewed Francois's edits too?",
    "created_at": "2015-02-19T21:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215033",
    "user": "https://github.com/darijgr"
}
```

From a quick glance at it, yes. But I haven't been keeping track of this ticket too closely, so I hope someone has reviewed Francois's edits too?



---

archive/issue_comments_215034.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-19T21:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215034",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_215035.json:
```json
{
    "body": "I have been looking at Frederic's changes, so (back to) positive review.",
    "created_at": "2015-02-19T21:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215035",
    "user": "https://github.com/tscrim"
}
```

I have been looking at Frederic's changes, so (back to) positive review.



---

archive/issue_events_048778.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-21T12:40:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16393#event-48778"
}
```



---

archive/issue_comments_215036.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-21T12:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16393#issuecomment-215036",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
