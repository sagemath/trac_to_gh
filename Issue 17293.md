# Issue 17293: AssertionError in relativize()

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2014-12-19 16:05:40


```
sage: K.<I,sqrt2> = NumberField([x^2+1, x^2-2])
sage: L,phi = cyclotomic_polynomial(20).change_ring(K).splitting_field('z', map=True)
sage: L.relativize(phi,'z')
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-3-227d5d5d2b77> in <module>()
----> 1 L.relativize(phi,'z')

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in relativize(self, alpha, names, structure)
   7805         # the solution space is one dimensional and the last entry is non-zero
   7806         # because a satisfies no smaller linear relation
-> 7807         assert soln_space.dimension() == 1
   7808         (reln, ) = soln_space.basis()
   7809         assert reln[-1] != 0

AssertionError: 
```



---

Comment by fwclarke created at 2014-12-20 12:08:14

The problem is that in the code for `sage.rings.number_field.number_field.NumberField_absolute.relativize` the lines

```
            L = alpha.domain()
            alpha = alpha(L.gen()) # relativize over phi's domain
```

take no account of the possibility that `L` could be a _relative_ number field.  Expanding this to read

```
            L = alpha.domain()
            if L.is_relative():
                L = L.absolute_field('a')
                alpha = alpha.abs_hom()
            alpha = alpha(L.gen()) # relativize over phi's domain
```

seems to solve the problem.


---

Comment by jdemeyer created at 2014-12-20 12:12:14

Since you're interested in `relativize()`, could you review commit [http://git.sagemath.org/sage.git/commit/?id=90f9d7b986913b938e4da11b402d7bd5507a5439](http://git.sagemath.org/sage.git/commit/?id=90f9d7b986913b938e4da11b402d7bd5507a5439) from #12005?
