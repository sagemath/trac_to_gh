# Issue 11176: maxima test fails when install tree is moved

archive/issues_011176.json:
```json
{
    "body": "Assignee: tdb\n\nThe following test fails when the sage-4.7.rc2 install tress is moved.\n\n\n```\neno% ./sage\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nThe Sage install tree may have moved\n(from /home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc to /home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug)\nChanging various hardcoded paths\n(please wait at most a few minutes)...\nDo not interrupt this.\nDone resetting paths\nsage: quit;\nExiting Sage (CPU time 0m0.06s, Wall time 0m9.55s).\nExiting spawned Gap process.\neno% ./sage -t -long -force_lib \"devel/sage/sage/interfaces/maxima.py\"\nsage -t -long -force_lib \"devel/sage/sage/interfaces/maxima.py\"\n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py\", line 899:\n    sage: maxima._command_runner('describe', 'gcd')\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    Maxima encountered a Lisp error:\n    <BLANKLINE>\n     Filesystem error with pathname #P\"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp\".\n    Either\n     1) the file does not exist, or\n     2) we are not allow to access the file, or\n     3) the pathname points to a broken symbolic link.\n    <BLANKLINE>\n    Automatically continuing.\n    To enable the Lisp debugger set *debugger-hook* to nil.\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py\", line 927:\n    sage: maxima.help('gcd')\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    Maxima encountered a Lisp error:\n    <BLANKLINE>\n     Filesystem error with pathname #P\"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp\".\n    Either\n     1) the file does not exist, or\n     2) we are not allow to access the file, or\n     3) the pathname points to a broken symbolic link.\n    <BLANKLINE>\n    Automatically continuing.\n    To enable the Lisp debugger set *debugger-hook* to nil.\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py\", line 2419:\n    sage: m.gcd._sage_doc_()\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    Maxima encountered a Lisp error:\n    <BLANKLINE>\n     Filesystem error with pathname #P\"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp\".\n    Either\n     1) the file does not exist, or\n     2) we are not allow to access the file, or\n     3) the pathname points to a broken symbolic link.\n    <BLANKLINE>\n    Automatically continuing.\n    To enable the Lisp debugger set *debugger-hook* to nil.\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py\", line 2430:\n    sage: maxima.gcd._sage_doc_()\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    Maxima encountered a Lisp error:\n    <BLANKLINE>\n     Filesystem error with pathname #P\"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp\".\n    Either\n     1) the file does not exist, or\n     2) we are not allow to access the file, or\n     3) the pathname points to a broken symbolic link.\n    <BLANKLINE>\n    Automatically continuing.\n    To enable the Lisp debugger set *debugger-hook* to nil.\n    <BLANKLINE>\n**********************************************************************\n4 items had failures:\n   1 of   4 in __main__.example_13\n   1 of   4 in __main__.example_14\n   1 of   5 in __main__.example_75\n   1 of   4 in __main__.example_76\n***Test Failed*** 4 failures.\nFor whitespace errors, see the file /home/mariah/.sage//tmp/.doctest_maxima.py\n         [27.5 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n| Sage Version 4.7.rc2, Release Date: 2011-05-11                     |\n| Type notebook() for the GUI, and license() for information.        |\n\n        sage -t -long -force_lib \"devel/sage/sage/interfaces/maxima.py\"\nTotal time for all tests: 27.5 seconds\neno% \n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/11348\n\n",
    "created_at": "2011-05-18T15:23:42Z",
    "labels": [
        "relocation",
        "blocker",
        "PLEASE CHANGE"
    ],
    "title": "maxima test fails when install tree is moved",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11176",
    "user": "mariah"
}
```
Assignee: tdb

The following test fails when the sage-4.7.rc2 install tress is moved.


```
eno% ./sage
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
The Sage install tree may have moved
(from /home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc to /home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug)
Changing various hardcoded paths
(please wait at most a few minutes)...
Do not interrupt this.
Done resetting paths
sage: quit;
Exiting Sage (CPU time 0m0.06s, Wall time 0m9.55s).
Exiting spawned Gap process.
eno% ./sage -t -long -force_lib "devel/sage/sage/interfaces/maxima.py"
sage -t -long -force_lib "devel/sage/sage/interfaces/maxima.py"
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 899:
    sage: maxima._command_runner('describe', 'gcd')
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 927:
    sage: maxima.help('gcd')
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 2419:
    sage: m.gcd._sage_doc_()
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 2430:
    sage: maxima.gcd._sage_doc_()
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
4 items had failures:
   1 of   4 in __main__.example_13
   1 of   4 in __main__.example_14
   1 of   5 in __main__.example_75
   1 of   4 in __main__.example_76
***Test Failed*** 4 failures.
For whitespace errors, see the file /home/mariah/.sage//tmp/.doctest_maxima.py
         [27.5 s]
 
----------------------------------------------------------------------
The following tests failed:
| Sage Version 4.7.rc2, Release Date: 2011-05-11                     |
| Type notebook() for the GUI, and license() for information.        |

        sage -t -long -force_lib "devel/sage/sage/interfaces/maxima.py"
Total time for all tests: 27.5 seconds
eno% 
```


Issue created by migration from https://trac.sagemath.org/ticket/11348





---

archive/issue_comments_122794.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2011-05-18T15:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122794",
    "user": "mariah"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_122795.json:
```json
{
    "body": "The problem seems to be that maxima tries to read\n\n```\nSAGE_ROOT/local/info/maxima-index.lisp\n```\n\nwhen it **should** instead read\n\n```\nSAGE_ROOT/local/share/info/maxima-index.lisp\n```\n",
    "created_at": "2011-05-18T16:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122795",
    "user": "jdemeyer"
}
```

The problem seems to be that maxima tries to read

```
SAGE_ROOT/local/info/maxima-index.lisp
```

when it **should** instead read

```
SAGE_ROOT/local/share/info/maxima-index.lisp
```




---

archive/issue_comments_122796.json:
```json
{
    "body": "Changing keywords from \"\" to \"maxima spkg\".",
    "created_at": "2011-05-18T17:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122796",
    "user": "jdemeyer"
}
```

Changing keywords from "" to "maxima spkg".



---

archive/issue_comments_122797.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-18T17:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122797",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_122798.json:
```json
{
    "body": "Mail sent to the Maxima mailing list with the infodir.patch",
    "created_at": "2011-05-18T21:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122798",
    "user": "jdemeyer"
}
```

Mail sent to the Maxima mailing list with the infodir.patch



---

archive/issue_comments_122799.json:
```json
{
    "body": "Attachment\n\nDiff for the maxima spkg, for reviewing only",
    "created_at": "2011-05-18T21:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122799",
    "user": "jdemeyer"
}
```

Attachment

Diff for the maxima spkg, for reviewing only



---

archive/issue_comments_122800.json:
```json
{
    "body": "I build sage-4.7.rc2 with [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.23.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.23.2.p0.spkg) with 'make testlong'.  All tests passed.  I then moved the directory and again did 'make testlong'.  Again all tests passed.  Positive review.",
    "created_at": "2011-05-19T13:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122800",
    "user": "mariah"
}
```

I build sage-4.7.rc2 with [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.23.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.23.2.p0.spkg) with 'make testlong'.  All tests passed.  I then moved the directory and again did 'make testlong'.  Again all tests passed.  Positive review.



---

archive/issue_comments_122801.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-05-19T13:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122801",
    "user": "mariah"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_122802.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-05-19T14:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11176#issuecomment-122802",
    "user": "jdemeyer"
}
```

Resolution: fixed
