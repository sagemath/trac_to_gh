# Issue 11176: maxima test fails when install tree is moved

Issue created by migration from https://trac.sagemath.org/ticket/11348

Original creator: mariah

Original creation time: 2011-05-18 15:23:42

Assignee: tdb

The following test fails when the sage-4.7.rc2 install tress is moved.


```
eno% ./sage
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
The Sage install tree may have moved
(from /home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc to /home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug)
Changing various hardcoded paths
(please wait at most a few minutes)...
Do not interrupt this.
Done resetting paths
sage: quit;
Exiting Sage (CPU time 0m0.06s, Wall time 0m9.55s).
Exiting spawned Gap process.
eno% ./sage -t -long -force_lib "devel/sage/sage/interfaces/maxima.py"
sage -t -long -force_lib "devel/sage/sage/interfaces/maxima.py"
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 899:
    sage: maxima._command_runner('describe', 'gcd')
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 927:
    sage: maxima.help('gcd')
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 2419:
    sage: m.gcd._sage_doc_()
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
File "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/devel/sage/sage/interfaces/maxima.py", line 2430:
    sage: maxima.gcd._sage_doc_()
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    Maxima encountered a Lisp error:
    <BLANKLINE>
     Filesystem error with pathname #P"/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-work-maximabug/local/info/maxima-index.lisp".
    Either
     1) the file does not exist, or
     2) we are not allow to access the file, or
     3) the pathname points to a broken symbolic link.
    <BLANKLINE>
    Automatically continuing.
    To enable the Lisp debugger set *debugger-hook* to nil.
    <BLANKLINE>
**********************************************************************
4 items had failures:
   1 of   4 in __main__.example_13
   1 of   4 in __main__.example_14
   1 of   5 in __main__.example_75
   1 of   4 in __main__.example_76
***Test Failed*** 4 failures.
For whitespace errors, see the file /home/mariah/.sage//tmp/.doctest_maxima.py
         [27.5 s]
 
----------------------------------------------------------------------
The following tests failed:
| Sage Version 4.7.rc2, Release Date: 2011-05-11                     |
| Type notebook() for the GUI, and license() for information.        |

        sage -t -long -force_lib "devel/sage/sage/interfaces/maxima.py"
Total time for all tests: 27.5 seconds
eno% 
```



---

Comment by mariah created at 2011-05-18 15:24:07

Changing type from PLEASE CHANGE to defect.


---

Comment by jdemeyer created at 2011-05-18 16:31:50

The problem seems to be that maxima tries to read

```
SAGE_ROOT/local/info/maxima-index.lisp
```

when it *should* instead read

```
SAGE_ROOT/local/share/info/maxima-index.lisp
```



---

Comment by jdemeyer created at 2011-05-18 17:35:47

Changing keywords from "" to "maxima spkg".


---

Comment by jdemeyer created at 2011-05-18 17:35:47

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2011-05-18 21:34:13

Mail sent to the Maxima mailing list with the infodir.patch


---

Attachment

Diff for the maxima spkg, for reviewing only


---

Comment by mariah created at 2011-05-19 13:07:14

I build sage-4.7.rc2 with [http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.23.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/maxima-5.23.2.p0.spkg) with 'make testlong'.  All tests passed.  I then moved the directory and again did 'make testlong'.  Again all tests passed.  Positive review.


---

Comment by mariah created at 2011-05-19 13:07:14

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-05-19 14:38:49

Resolution: fixed
