# Issue 29777: freetype version comparison in spkg-configure.m4 is wrong

Issue created by migration from https://trac.sagemath.org/ticket/30014

Original creator: dimpase

Original creation time: 2020-06-29 08:17:25

CC:  mkoeppe mjo @thierry-freebsd fbissey embray

it appears that currently we might accept about any freetype2 coming our way, as our version check is wrong.


```
$ pkg-config --modversion freetype2
outputs not something sane, but e.g. for freetype version 2.9.1 it is
22.1.6, for 2.10.2 it is 23.2.17
(which is probably some insane value produced following libtool
versioning rules)
while we check for it to be at least 2.4, oops...
```



---

Comment by fbissey created at 2020-06-29 09:04:06

This is completely batty. The version number is supposed to be the libtool number. There is nothing shipped with that number so what's the use. But `docs/VERSIONS.TXT` has a handy table

```
    release     libtool     so
  -------------------------------
     2.10.1     23.1.17   6.17.1
     2.10.0     23.0.17   6.17.0
     2.9.1      22.1.16   6.16.1
     2.9.0      22.0.16   6.16.0
     2.8.1	21.0.15   6.15.0
     2.8.0      20.0.14   6.14.0
     2.7.1      19.0.13   6.13.0
     2.7.0	18.6.12   6.12.6
     2.6.5      18.5.12   6.12.5
     2.6.4	18.4.12   6.12.4
     2.6.3      18.3.12   6.12.3
     2.6.2      18.2.12   6.12.2
     2.6.1	18.1.12   6.12.1
     2.6.0      18.0.12   6.12.0
     2.5.5      17.4.11   6.11.4
     2.5.4	17.3.11   6.11.3
     2.5.3      17.2.11   6.11.2
     2.5.2      17.1.11   6.11.1
     2.5.1      17.0.11   6.11.0
     2.5.0      16.2.10   6.10.2
     2.4.12     16.1.10   6.10.1
     2.4.11     16.0.10   6.10.0
     2.4.10     15.0.9    6.9.0
     2.4.9	14.1.8    6.8.1
     2.4.8      14.0.8    6.8.0
     2.4.7      13.2.7    6.7.2
     2.4.6	13.1.7    6.7.1
     2.4.5      13.0.7    6.7.0
     2.4.4      12.2.6    6.6.2
     2.4.3      12.1.6    6.6.1
     2.4.2	12.0.6    6.6.0
     2.4.1      11.1.5    6.5.1
     2.4.0	11.0.5    6.5.0
```

As you can see the libtool number is derived from the so number. If the so number is `a.b.c`, the libtool number is `a+b.c.b`. It is somewhere in the libtool manual but I for one, never used that number. I used what they called the so numbers directly which is a bit more pleasant. I also don't see the point in using the libtool number in the .pc file instead of the version. As can be seen there is a one to one correspondence. And you shouldn't ever try to figure the so number from your .pc file, you are not supposed too.

I guess they are committed to the absurd scheme now.


---

Comment by dimpase created at 2020-06-29 10:46:44

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-06-29 10:46:44

New commits:


---

Comment by mkoeppe created at 2020-06-29 17:24:27

Changing priority from major to critical.


---

Comment by mkoeppe created at 2020-06-29 17:31:40

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-07-08 23:18:12

Resolution: fixed


---

Comment by mkoeppe created at 2020-07-08 23:18:12

These have been merged into 9.2.beta4
