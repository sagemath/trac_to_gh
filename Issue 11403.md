# Issue 11403: Preparing for PolyBoRi's upcoming release 0.8

archive/issues_011403.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  alexanderdreyer polybori @kiwifb @burcin @malb simonking @jdemeyer\n\nPolyBoRi 0.8 will come with some changes in the interface (in particular the infamous global settings will be removed)\n\nSo there is an extensive alpha phase this time:\nhttps://sourceforge.net/projects/polybori/files/polybori/0.8.alphas/\n\n\nNote, once the official spkg for PolyBoRi 0.7-1 is reviewed and merged (#11261) we will need to rebase on that.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11575\n\n",
    "created_at": "2011-07-05T12:47:09Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Preparing for PolyBoRi's upcoming release 0.8",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11403",
    "user": "https://github.com/alexanderdreyer"
}
```
Assignee: tbd

CC:  alexanderdreyer polybori @kiwifb @burcin @malb simonking @jdemeyer

PolyBoRi 0.8 will come with some changes in the interface (in particular the infamous global settings will be removed)

So there is an extensive alpha phase this time:
https://sourceforge.net/projects/polybori/files/polybori/0.8.alphas/


Note, once the official spkg for PolyBoRi 0.7-1 is reviewed and merged (#11261) we will need to rebase on that.

Issue created by migration from https://trac.sagemath.org/ticket/11575





---

archive/issue_comments_126487.json:
```json
{
    "body": "For the record I have a gentoo ebuild that pulls the trunk of hg on bitbucket. That's how I tested things in the issues I have filled for polybori recently.",
    "created_at": "2011-07-06T00:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126487",
    "user": "https://github.com/kiwifb"
}
```

For the record I have a gentoo ebuild that pulls the trunk of hg on bitbucket. That's how I tested things in the issues I have filled for polybori recently.



---

archive/issue_comments_126488.json:
```json
{
    "body": "I prepared a first at http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p0.spkg\n\nIt builds, but of course `sage -br` and tests will fail, since the Sage library needs to be adjusted.",
    "created_at": "2011-07-06T09:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126488",
    "user": "https://github.com/alexanderdreyer"
}
```

I prepared a first at http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p0.spkg

It builds, but of course `sage -br` and tests will fail, since the Sage library needs to be adjusted.



---

archive/issue_comments_126489.json:
```json
{
    "body": "Build using my ebuild (you didn't commit anything since you tagged 0.8-alpha so that's what I should have pulled). Used boost-1.42 and m4ri-20100817. Builds and install fine without warnings. Is there a working test suite that can be run? Also I didn't build any docs.",
    "created_at": "2011-07-09T04:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126489",
    "user": "https://github.com/kiwifb"
}
```

Build using my ebuild (you didn't commit anything since you tagged 0.8-alpha so that's what I should have pulled). Used boost-1.42 and m4ri-20100817. Builds and install fine without warnings. Is there a working test suite that can be run? Also I didn't build any docs.



---

archive/issue_comments_126490.json:
```json
{
    "body": "Hi Francois! I gave to access to polybori-testsuite. If you do use it via the cython interface from Sage's Library (*not* the original PyPolyBoRi,so). I need to update this, but it's not that easy, because I have to c++-ify some classes without defautl constructor.",
    "created_at": "2011-07-09T20:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126490",
    "user": "https://github.com/alexanderdreyer"
}
```

Hi Francois! I gave to access to polybori-testsuite. If you do use it via the cython interface from Sage's Library (*not* the original PyPolyBoRi,so). I need to update this, but it's not that easy, because I have to c++-ify some classes without defautl constructor.



---

archive/issue_comments_126491.json:
```json
{
    "body": "Hi Alexander, thanks for giving me access. I think it is best to test it separate from sage at first, especially when you consider that installing it will break sage. I hope that it can work that way.",
    "created_at": "2011-07-10T00:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126491",
    "user": "https://github.com/kiwifb"
}
```

Hi Alexander, thanks for giving me access. I think it is best to test it separate from sage at first, especially when you consider that installing it will break sage. I hope that it can work that way.



---

archive/issue_comments_126492.json:
```json
{
    "body": "I just had a thought. I should really try this against m4ri-20110715 (#11574). I suppose this version of polybori is ready for it.",
    "created_at": "2011-07-10T04:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126492",
    "user": "https://github.com/kiwifb"
}
```

I just had a thought. I should really try this against m4ri-20110715 (#11574). I suppose this version of polybori is ready for it.



---

archive/issue_comments_126493.json:
```json
{
    "body": "Replying to [comment:7 fbissey]:\n> I just had a thought. I should really try this against m4ri-20110715 (#11574). I suppose this version of polybori is ready for it.\n\nIt should, but I haven't had time for testing the most recent version yet.",
    "created_at": "2011-07-10T19:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126493",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:7 fbissey]:
> I just had a thought. I should really try this against m4ri-20110715 (#11574). I suppose this version of polybori is ready for it.

It should, but I haven't had time for testing the most recent version yet.



---

archive/issue_comments_126494.json:
```json
{
    "body": "Replying to [comment:8 AlexanderDreyer]:\n> Replying to [comment:7 fbissey]:\n> > I just had a thought. I should really try this against m4ri-20110715 (#11574). I suppose this version of polybori is ready for it.\n\n> It should, but I haven't had time for testing the most recent version yet.\n\nI'll have to wait until the sage server are fully back on, m4ri tarball seem to be stored there. That or I clone m4ri tip from bitbucket, which may be an idea since I already to that for polybori.",
    "created_at": "2011-07-10T19:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126494",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:8 AlexanderDreyer]:
> Replying to [comment:7 fbissey]:
> > I just had a thought. I should really try this against m4ri-20110715 (#11574). I suppose this version of polybori is ready for it.

> It should, but I haven't had time for testing the most recent version yet.

I'll have to wait until the sage server are fully back on, m4ri tarball seem to be stored there. That or I clone m4ri tip from bitbucket, which may be an idea since I already to that for polybori.



---

archive/issue_comments_126495.json:
```json
{
    "body": "Pulled m4ri tip. Polybori-0.7.1 compiles against it, no problem. I'll check 0.8.alpha a bit later and then I'll see about that test suite.",
    "created_at": "2011-07-11T04:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126495",
    "user": "https://github.com/kiwifb"
}
```

Pulled m4ri tip. Polybori-0.7.1 compiles against it, no problem. I'll check 0.8.alpha a bit later and then I'll see about that test suite.



---

archive/issue_comments_126496.json:
```json
{
    "body": "Attachment [polybori-0.8.0alpha.p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0alpha.p1.patch) by @alexanderdreyer created at 2011-07-15 22:03:26\n\nFirst working patch for supporting PolyBoRi 0.8 by the Sage-lib",
    "created_at": "2011-07-15T22:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126496",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8.0alpha.p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0alpha.p1.patch) by @alexanderdreyer created at 2011-07-15 22:03:26

First working patch for supporting PolyBoRi 0.8 by the Sage-lib



---

archive/issue_comments_126497.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-07-15T22:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126497",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_126498.json:
```json
{
    "body": "Here's now the first patch for making the Sage-lib supporting PolyBoRi 0.8:\nhttp://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8.0alpha.p1.patch\n\nI needs to workaround missing default generators of PolyBoRi-functions by reintroducing then (just for now: It should be using the cppclass construct) . Therefore, we do need another patched spkg: http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p1.spkg",
    "created_at": "2011-07-15T22:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126498",
    "user": "https://github.com/alexanderdreyer"
}
```

Here's now the first patch for making the Sage-lib supporting PolyBoRi 0.8:
http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8.0alpha.p1.patch

I needs to workaround missing default generators of PolyBoRi-functions by reintroducing then (just for now: It should be using the cppclass construct) . Therefore, we do need another patched spkg: http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p1.spkg



---

archive/issue_comments_126499.json:
```json
{
    "body": "I have done a build of your latest tip from a couple of days ago and it was fine. I still have to get organized to do the testing. Nice to have a patch for sage but I am afraid it will need to be rebased now that #11377 is in. Please do not use SAGE_ROOT in module_list.py. In your case SAGE_INC will be enough.",
    "created_at": "2011-07-15T22:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126499",
    "user": "https://github.com/kiwifb"
}
```

I have done a build of your latest tip from a couple of days ago and it was fine. I still have to get organized to do the testing. Nice to have a patch for sage but I am afraid it will need to be rebased now that #11377 is in. Please do not use SAGE_ROOT in module_list.py. In your case SAGE_INC will be enough.



---

archive/issue_comments_126500.json:
```json
{
    "body": "Replying to [comment:13 fbissey]:\n> I have done a build of your latest tip from a couple of days ago and it was fine. I still have to get organized to do the testing. Nice to have a patch for sage but I am afraid it will need to be rebased now that #11377 is in. Please do not use SAGE_ROOT in module_list.py. In your case SAGE_INC will be enough.\n\n\nNo problem, it's still work to do  anyway, since the c++-ification not really done yet. (I just mis-clicked, it should read \"NEEDS_WORKS\".)\n\nPS: So that crash-issue on gentoo-prefix got away with 0.8-alpha?",
    "created_at": "2011-07-15T22:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126500",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:13 fbissey]:
> I have done a build of your latest tip from a couple of days ago and it was fine. I still have to get organized to do the testing. Nice to have a patch for sage but I am afraid it will need to be rebased now that #11377 is in. Please do not use SAGE_ROOT in module_list.py. In your case SAGE_INC will be enough.


No problem, it's still work to do  anyway, since the c++-ification not really done yet. (I just mis-clicked, it should read "NEEDS_WORKS".)

PS: So that crash-issue on gentoo-prefix got away with 0.8-alpha?



---

archive/issue_comments_126501.json:
```json
{
    "body": "Replying to [comment:14 AlexanderDreyer]:\n> Replying to [comment:13 fbissey]:\n> > I have done a build of your latest tip from a couple of days ago and it was fine. I still have to get organized to do the testing. Nice to have a patch for sage but I am afraid it will need to be rebased now that #11377 is in. Please do not use SAGE_ROOT in module_list.py. In your case SAGE_INC will be enough.\n\n> \n> No problem, it's still work to do  anyway, since the c++-ification not really done yet. (I just mis-clicked, it should read \"NEEDS_WORKS\".)\n> \n> PS: So that crash-issue on gentoo-prefix got away with 0.8-alpha?\n\n\nDon't know yet. I have to build this on OS X and apply the patch. It may very well not happen until Monday local time (it's Saturday morning here) since this is one of my work machine.",
    "created_at": "2011-07-15T23:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126501",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:14 AlexanderDreyer]:
> Replying to [comment:13 fbissey]:
> > I have done a build of your latest tip from a couple of days ago and it was fine. I still have to get organized to do the testing. Nice to have a patch for sage but I am afraid it will need to be rebased now that #11377 is in. Please do not use SAGE_ROOT in module_list.py. In your case SAGE_INC will be enough.

> 
> No problem, it's still work to do  anyway, since the c++-ification not really done yet. (I just mis-clicked, it should read "NEEDS_WORKS".)
> 
> PS: So that crash-issue on gentoo-prefix got away with 0.8-alpha?


Don't know yet. I have to build this on OS X and apply the patch. It may very well not happen until Monday local time (it's Saturday morning here) since this is one of my work machine.



---

archive/issue_comments_126502.json:
```json
{
    "body": "> Don't know yet. I have to build this on OS X and apply the patch. It may very well not happen until Monday local time (it's Saturday morning here) since this is one of my work machine.\n\n\nHere, too (1:00). \n\nIn case this still fails: Can you give the plain PolyBoRi source from bitbucket a try? I had to patch the recent spkg to work around some cython vs. c++ issue.",
    "created_at": "2011-07-15T23:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126502",
    "user": "https://github.com/alexanderdreyer"
}
```

> Don't know yet. I have to build this on OS X and apply the patch. It may very well not happen until Monday local time (it's Saturday morning here) since this is one of my work machine.


Here, too (1:00). 

In case this still fails: Can you give the plain PolyBoRi source from bitbucket a try? I had to patch the recent spkg to work around some cython vs. c++ issue.



---

archive/issue_comments_126503.json:
```json
{
    "body": "Changing assignee from tbd to @alexanderdreyer.",
    "created_at": "2011-07-15T23:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126503",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing assignee from tbd to @alexanderdreyer.



---

archive/issue_comments_126504.json:
```json
{
    "body": "Replying to [comment:16 AlexanderDreyer]:\n> > Don't know yet. I have to build this on OS X and apply the patch. It may very well not happen until Monday local time (it's Saturday morning here) since this is one of my work machine.\n\n> \n> Here, too (1:00). \n> \n> In case this still fails: Can you give the plain PolyBoRi source from bitbucket a try? I had to patch the recent spkg to work around some cython vs. c++ issue.\n\n\n\nNot quite lunch time here. I'll make a note to try both. The nature of sage-on-gentoo is that the plain sources will be used over spkg unless the spkg is the only thing that exists or works. We still patch stuff if it is not too big (OK sometimes even when it is big).",
    "created_at": "2011-07-15T23:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126504",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:16 AlexanderDreyer]:
> > Don't know yet. I have to build this on OS X and apply the patch. It may very well not happen until Monday local time (it's Saturday morning here) since this is one of my work machine.

> 
> Here, too (1:00). 
> 
> In case this still fails: Can you give the plain PolyBoRi source from bitbucket a try? I had to patch the recent spkg to work around some cython vs. c++ issue.



Not quite lunch time here. I'll make a note to try both. The nature of sage-on-gentoo is that the plain sources will be used over spkg unless the spkg is the only thing that exists or works. We still patch stuff if it is not too big (OK sometimes even when it is big).



---

archive/issue_comments_126505.json:
```json
{
    "body": "Pulled the latest mercurial tip. Installed fine on linux. OS X (10.5.8 on x86) didn't like it one bit. I compiled with -ggdb which may have an impact.\n\n```\ni686-apple-darwin9-g++ -o groebner/libpolybori_groebner.dylib -Wl,-dead_strip_dylibs -dynamiclib groebner/src/groebner.os groebner/s\nrc/LiteralFactorization.os groebner/src/LiteralFactorizationIterator.os groebner/src/randomset.os groebner/src/pairs.os groebner/src\n/groebner_alg.os groebner/src/FGLMStrategy.os groebner/src/polynomial_properties.os groebner/src/LexBucket.os groebner/src/dlex4data\n.os groebner/src/dp_asc4data.os groebner/src/lp4data.os groebner/src/nf.os groebner/src/interpolate.os groebner/src/GroebnerStrategy\n.os groebner/src/PairManager.os groebner/src/PolyEntry.os groebner/src/ReductionStrategy.os groebner/src/MatrixMonomialOrderTables.o\ns -L/Users/frb15/Desktop/Gentoo/usr/lib -L/Users/frb15/Desktop/Gentoo/usr/lib/python2.7/config -Lpolybori -Lgroebner -LCudd -lm -lgd\n -lgd -lm4ri -lgd -lgd -lm4ri\nld: warning: directory 'polybori' following -L not found\n```\nThat's the critical bit where it fails. I'll compare with what happens on linux shortly.\n\nFrancois who is a bit snowed in today (some more falling).",
    "created_at": "2011-07-25T04:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126505",
    "user": "https://github.com/kiwifb"
}
```

Pulled the latest mercurial tip. Installed fine on linux. OS X (10.5.8 on x86) didn't like it one bit. I compiled with -ggdb which may have an impact.

```
i686-apple-darwin9-g++ -o groebner/libpolybori_groebner.dylib -Wl,-dead_strip_dylibs -dynamiclib groebner/src/groebner.os groebner/s
rc/LiteralFactorization.os groebner/src/LiteralFactorizationIterator.os groebner/src/randomset.os groebner/src/pairs.os groebner/src
/groebner_alg.os groebner/src/FGLMStrategy.os groebner/src/polynomial_properties.os groebner/src/LexBucket.os groebner/src/dlex4data
.os groebner/src/dp_asc4data.os groebner/src/lp4data.os groebner/src/nf.os groebner/src/interpolate.os groebner/src/GroebnerStrategy
.os groebner/src/PairManager.os groebner/src/PolyEntry.os groebner/src/ReductionStrategy.os groebner/src/MatrixMonomialOrderTables.o
s -L/Users/frb15/Desktop/Gentoo/usr/lib -L/Users/frb15/Desktop/Gentoo/usr/lib/python2.7/config -Lpolybori -Lgroebner -LCudd -lm -lgd
 -lgd -lm4ri -lgd -lgd -lm4ri
ld: warning: directory 'polybori' following -L not found
```
That's the critical bit where it fails. I'll compare with what happens on linux shortly.

Francois who is a bit snowed in today (some more falling).



---

archive/issue_comments_126506.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-25T21:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126506",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_126507.json:
```json
{
    "body": "`@`fbissey Please pull again. There was indeed an outdated directory name given, which was ignored on Linux.",
    "created_at": "2011-07-25T21:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126507",
    "user": "https://github.com/alexanderdreyer"
}
```

`@`fbissey Please pull again. There was indeed an outdated directory name given, which was ignored on Linux.



---

archive/issue_comments_126508.json:
```json
{
    "body": "Replying to [comment:20 AlexanderDreyer]:\n> `@`fbissey Please pull again. There was indeed an outdated directory name given, which was ignored on Linux. \n\n\nStill some problem making dylib (which in fact we are not using on OS X at the moment) if I read the message properly. I will attach a build log shortly. Will take a few minutes since it is on a remote machine.",
    "created_at": "2011-07-25T22:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126508",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:20 AlexanderDreyer]:
> `@`fbissey Please pull again. There was indeed an outdated directory name given, which was ignored on Linux. 


Still some problem making dylib (which in fact we are not using on OS X at the moment) if I read the message properly. I will attach a build log shortly. Will take a few minutes since it is on a remote machine.



---

archive/issue_comments_126509.json:
```json
{
    "body": "Attachment [polybori-9999-20110725.log.bz2](tarball://root/attachments/some-uuid/ticket11575/polybori-9999-20110725.log.bz2) by @kiwifb created at 2011-07-25 22:35:01\n\nbuild log from OS X linking fails when making shared libraries badly.",
    "created_at": "2011-07-25T22:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126509",
    "user": "https://github.com/kiwifb"
}
```

Attachment [polybori-9999-20110725.log.bz2](tarball://root/attachments/some-uuid/ticket11575/polybori-9999-20110725.log.bz2) by @kiwifb created at 2011-07-25 22:35:01

build log from OS X linking fails when making shared libraries badly.



---

archive/issue_comments_126510.json:
```json
{
    "body": "Build log attached. Linking of the dylib is what fails in a spectacular manner. gcc is 4.2.1, apple sources.",
    "created_at": "2011-07-25T22:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126510",
    "user": "https://github.com/kiwifb"
}
```

Build log attached. Linking of the dylib is what fails in a spectacular manner. gcc is 4.2.1, apple sources.



---

archive/issue_comments_126511.json:
```json
{
    "body": "The unresolved references are from libpolybori. If seems, that the dynlibs have to resolve all Symbols (unlike '.so's on Linux). I've put another patch to bitbucket, which should cure this issue.",
    "created_at": "2011-07-25T23:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126511",
    "user": "https://github.com/alexanderdreyer"
}
```

The unresolved references are from libpolybori. If seems, that the dynlibs have to resolve all Symbols (unlike '.so's on Linux). I've put another patch to bitbucket, which should cure this issue.



---

archive/issue_comments_126512.json:
```json
{
    "body": "Replying to [comment:23 AlexanderDreyer]:\n> The unresolved references are from libpolybori. If seems, that the dynlibs have to resolve all Symbols (unlike '.so's on Linux). I've put another patch to bitbucket, which should cure this issue.\n\n\nNo effect at all. I have the same output (except for the modification you made on the last linking line).",
    "created_at": "2011-07-25T23:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126512",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:23 AlexanderDreyer]:
> The unresolved references are from libpolybori. If seems, that the dynlibs have to resolve all Symbols (unlike '.so's on Linux). I've put another patch to bitbucket, which should cure this issue.


No effect at all. I have the same output (except for the modification you made on the last linking line).



---

archive/issue_comments_126513.json:
```json
{
    "body": "Changing assignee from @alexanderdreyer to @kiwifb.",
    "created_at": "2011-07-25T23:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126513",
    "user": "https://github.com/kiwifb"
}
```

Changing assignee from @alexanderdreyer to @kiwifb.



---

archive/issue_comments_126514.json:
```json
{
    "body": "we may have to consider the possibility that  libpolybori/libpolybori.dylib is broken. That would explain why trying to use shared object from polybori doesn't work in sage.",
    "created_at": "2011-07-25T23:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126514",
    "user": "https://github.com/kiwifb"
}
```

we may have to consider the possibility that  libpolybori/libpolybori.dylib is broken. That would explain why trying to use shared object from polybori doesn't work in sage.



---

archive/issue_comments_126515.json:
```json
{
    "body": "Could you add the following linker option for shared libraries on OS X:\n\n```\n-Wl,-undefined -Wl,dynamic_lookup\n```\nThat may help.",
    "created_at": "2011-07-25T23:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126515",
    "user": "https://github.com/kiwifb"
}
```

Could you add the following linker option for shared libraries on OS X:

```
-Wl,-undefined -Wl,dynamic_lookup
```
That may help.



---

archive/issue_comments_126516.json:
```json
{
    "body": "I should add that it seem to help linking that last library here.",
    "created_at": "2011-07-25T23:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126516",
    "user": "https://github.com/kiwifb"
}
```

I should add that it seem to help linking that last library here.



---

archive/issue_comments_126517.json:
```json
{
    "body": "I added this to the SConstruct, you may pull from bitbucket again. Unfortunately, I do not have access to any OSX machine, so I cannot try.\n\nIf there are more command line flags to add, you may temporarily  given them to scons by adding a file called `custom.py` in the main directory. For instance, for this case `custom.py` is as follows:\n\n```\nSHLINKFLAGS+=\"-Wl,-undefined -Wl,dynamic_lookup\"\n```\n\n(`scons -h` given you the names of the possible variables.)",
    "created_at": "2011-07-26T19:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126517",
    "user": "https://github.com/alexanderdreyer"
}
```

I added this to the SConstruct, you may pull from bitbucket again. Unfortunately, I do not have access to any OSX machine, so I cannot try.

If there are more command line flags to add, you may temporarily  given them to scons by adding a file called `custom.py` in the main directory. For instance, for this case `custom.py` is as follows:

```
SHLINKFLAGS+="-Wl,-undefined -Wl,dynamic_lookup"
```

(`scons -h` given you the names of the possible variables.)



---

archive/issue_comments_126518.json:
```json
{
    "body": "Your new SConstruct is there in what I pulled but it appeared not to have made it to the linking line. I am investigating this more closely in case there is something in the set up on my side. Hopefully I'll solve this and deliver a solution to you quickly (but may be not today in your time zone).",
    "created_at": "2011-07-26T20:03:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126518",
    "user": "https://github.com/kiwifb"
}
```

Your new SConstruct is there in what I pulled but it appeared not to have made it to the linking line. I am investigating this more closely in case there is something in the set up on my side. Hopefully I'll solve this and deliver a solution to you quickly (but may be not today in your time zone).



---

archive/issue_comments_126519.json:
```json
{
    "body": "Maybe, the loadable module is just wrong here. I removed it (temporarily?), see the newest push at bitbucket.",
    "created_at": "2011-07-26T20:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126519",
    "user": "https://github.com/alexanderdreyer"
}
```

Maybe, the loadable module is just wrong here. I removed it (temporarily?), see the newest push at bitbucket.



---

archive/issue_comments_126520.json:
```json
{
    "body": "Replying to [comment:30 AlexanderDreyer]:\n> Maybe, the loadable module is just wrong here. I removed it (temporarily?), see the newest push at bitbucket.\n\n\nNo effects from that change BUT I was passing\n\n```\nSHLINKFLAGS=\"${LDFLAGS} -dynamiclib\"\n```\nto scons which suppressed the flags you set. From the look of things I think it should be good now on OS X. If you had the flag appended instead of just set it may have worked earlier, not sure how you are supposed to do that in scons....",
    "created_at": "2011-07-26T22:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126520",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:30 AlexanderDreyer]:
> Maybe, the loadable module is just wrong here. I removed it (temporarily?), see the newest push at bitbucket.


No effects from that change BUT I was passing

```
SHLINKFLAGS="${LDFLAGS} -dynamiclib"
```
to scons which suppressed the flags you set. From the look of things I think it should be good now on OS X. If you had the flag appended instead of just set it may have worked earlier, not sure how you are supposed to do that in scons....



---

archive/issue_comments_126521.json:
```json
{
    "body": "> No effects from that change BUT I was passing\n> \n> ```\n> SHLINKFLAGS=\"${LDFLAGS} -dynamiclib\"\n> ```\n> to scons which suppressed the flags you set. From the look of things I think it should be good now on OS X. If you had the flag appended instead of just set it may have worked earlier, not sure how you are supposed to do that in scons....\n\nThank you very much or this hint! I changed the `SConstruct` file to append the respective stuff. I hope this will work now without manual settings.",
    "created_at": "2011-07-27T21:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126521",
    "user": "https://github.com/alexanderdreyer"
}
```

> No effects from that change BUT I was passing
> 
> ```
> SHLINKFLAGS="${LDFLAGS} -dynamiclib"
> ```
> to scons which suppressed the flags you set. From the look of things I think it should be good now on OS X. If you had the flag appended instead of just set it may have worked earlier, not sure how you are supposed to do that in scons....

Thank you very much or this hint! I changed the `SConstruct` file to append the respective stuff. I hope this will work now without manual settings.



---

archive/issue_comments_126522.json:
```json
{
    "body": "There a new alpha at https://sourceforge.net/projects/polybori/files/polybori/0.8.alphas/ and at bitbucket. Many thanks for all bug hunters! I hope I can provide a new spkg soon.",
    "created_at": "2011-08-02T22:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126522",
    "user": "https://github.com/alexanderdreyer"
}
```

There a new alpha at https://sourceforge.net/projects/polybori/files/polybori/0.8.alphas/ and at bitbucket. Many thanks for all bug hunters! I hope I can provide a new spkg soon.



---

archive/issue_comments_126523.json:
```json
{
    "body": "The latest spkg builds fine on Mac OS X 10.6.\nHowever I using the patch I get:\n\n```\nsage/rings/polynomial/pbori.cpp: In function \u2018PyObject* __pyx_pf_4sage_5rings_10polynomial_5pbori_21BooleanPolynomialRing_30set(PyObject*, PyObject*)\u2019:\nsage/rings/polynomial/pbori.cpp:12802: error: \u2018class polybori::BoolePolyRing\u2019 has no member named \u2018activate\u2019\n/Applications/sage/local/include/csage/ccobject.h: In function \u2018T* Construct_ppp(void*, const P&, const Q&, const R&) [with T = polybori::BoolePolyRing, P = long unsigned int, Q = int, R = bool]\u2019:\nsage/rings/polynomial/pbori.cpp:4976:   instantiated from here\n/Applications/sage/local/include/csage/ccobject.h:59: error: no matching function for call to \u2018polybori::BoolePolyRing::BoolePolyRing(const long unsigned int&, const int&, const bool&)\u2019\n/Applications/sage/local/include/polybori/BoolePolyRing.h:123: note: candidates are: polybori::BoolePolyRing::BoolePolyRing()\n/Applications/sage/local/include/polybori/BoolePolyRing.h:120: note:                 polybori::BoolePolyRing::BoolePolyRing(const polybori::BoolePolyRing&)\n/Applications/sage/local/include/polybori/BoolePolyRing.h:116: note:                 polybori::BoolePolyRing::BoolePolyRing(size_t, const boost::shared_ptr<polybori::COrderingBase>&)\n/Applications/sage/local/include/polybori/BoolePolyRing.h:113: note:                 polybori::BoolePolyRing::BoolePolyRing(size_t, int)\n/Applications/sage/local/include/polybori/BoolePolyRing.h:107: note:                 polybori::BoolePolyRing::BoolePolyRing(const polybori::CWeakPtr<polybori::CCuddCore>&)\n/Applications/sage/local/include/polybori/BoolePolyRing.h:104: note:                 polybori::BoolePolyRing::BoolePolyRing(const boost::intrusive_ptr<polybori::CCuddCore>&)\nerror: command 'gcc' failed with exit status 1\nsage: There was an error installing modified sage library code.\n```\nCheers,\nMichael",
    "created_at": "2011-08-04T10:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126523",
    "user": "https://trac.sagemath.org/admin/accounts/users/PolyBoRi"
}
```

The latest spkg builds fine on Mac OS X 10.6.
However I using the patch I get:

```
sage/rings/polynomial/pbori.cpp: In function ‘PyObject* __pyx_pf_4sage_5rings_10polynomial_5pbori_21BooleanPolynomialRing_30set(PyObject*, PyObject*)’:
sage/rings/polynomial/pbori.cpp:12802: error: ‘class polybori::BoolePolyRing’ has no member named ‘activate’
/Applications/sage/local/include/csage/ccobject.h: In function ‘T* Construct_ppp(void*, const P&, const Q&, const R&) [with T = polybori::BoolePolyRing, P = long unsigned int, Q = int, R = bool]’:
sage/rings/polynomial/pbori.cpp:4976:   instantiated from here
/Applications/sage/local/include/csage/ccobject.h:59: error: no matching function for call to ‘polybori::BoolePolyRing::BoolePolyRing(const long unsigned int&, const int&, const bool&)’
/Applications/sage/local/include/polybori/BoolePolyRing.h:123: note: candidates are: polybori::BoolePolyRing::BoolePolyRing()
/Applications/sage/local/include/polybori/BoolePolyRing.h:120: note:                 polybori::BoolePolyRing::BoolePolyRing(const polybori::BoolePolyRing&)
/Applications/sage/local/include/polybori/BoolePolyRing.h:116: note:                 polybori::BoolePolyRing::BoolePolyRing(size_t, const boost::shared_ptr<polybori::COrderingBase>&)
/Applications/sage/local/include/polybori/BoolePolyRing.h:113: note:                 polybori::BoolePolyRing::BoolePolyRing(size_t, int)
/Applications/sage/local/include/polybori/BoolePolyRing.h:107: note:                 polybori::BoolePolyRing::BoolePolyRing(const polybori::CWeakPtr<polybori::CCuddCore>&)
/Applications/sage/local/include/polybori/BoolePolyRing.h:104: note:                 polybori::BoolePolyRing::BoolePolyRing(const boost::intrusive_ptr<polybori::CCuddCore>&)
error: command 'gcc' failed with exit status 1
sage: There was an error installing modified sage library code.
```
Cheers,
Michael



---

archive/issue_comments_126524.json:
```json
{
    "body": "At least `pbori.cpp` is not updated. Did you qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8.0alpha.p1.patch to the Sage library and qpush?\n\nMaybe you alos have to touch `pbori.pyx` before `sage -b`.",
    "created_at": "2011-08-04T13:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126524",
    "user": "https://github.com/alexanderdreyer"
}
```

At least `pbori.cpp` is not updated. Did you qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8.0alpha.p1.patch to the Sage library and qpush?

Maybe you alos have to touch `pbori.pyx` before `sage -b`.



---

archive/issue_comments_126525.json:
```json
{
    "body": "Attachment [polybori-0.8.0alpha.p2-against-p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0alpha.p2-against-p1.patch) by @alexanderdreyer created at 2011-08-04 14:39:29\n\nFix to allowd to use PolyBoRI 0.8 alpha1",
    "created_at": "2011-08-04T14:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126525",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8.0alpha.p2-against-p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0alpha.p2-against-p1.patch) by @alexanderdreyer created at 2011-08-04 14:39:29

Fix to allowd to use PolyBoRI 0.8 alpha1



---

archive/issue_comments_126526.json:
```json
{
    "body": "Hi Michael,\nyou're right, I changed to many things in alpha1. Please import the second patch also. I also had to do a minor change in the spkg. Unfortunately, I cannot upload the updated spkg currently due to some server problems at boxen.\n\nRegards,\n  Alexander",
    "created_at": "2011-08-04T14:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126526",
    "user": "https://github.com/alexanderdreyer"
}
```

Hi Michael,
you're right, I changed to many things in alpha1. Please import the second patch also. I also had to do a minor change in the spkg. Unfortunately, I cannot upload the updated spkg currently due to some server problems at boxen.

Regards,
  Alexander



---

archive/issue_comments_126527.json:
```json
{
    "body": "The updates spkg is now at the same place as before:\nhttp://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p2.spkg",
    "created_at": "2011-08-04T23:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126527",
    "user": "https://github.com/alexanderdreyer"
}
```

The updates spkg is now at the same place as before:
http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p2.spkg



---

archive/issue_comments_126528.json:
```json
{
    "body": "Attachment [polybori-0.8.0alpha.p3.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0alpha.p3.patch) by @alexanderdreyer created at 2011-08-05 10:56:09\n\nPatch which uses a wrapper for c++ classes without default constructor",
    "created_at": "2011-08-05T10:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126528",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8.0alpha.p3.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0alpha.p3.patch) by @alexanderdreyer created at 2011-08-05 10:56:09

Patch which uses a wrapper for c++ classes without default constructor



---

archive/issue_comments_126529.json:
```json
{
    "body": "Changing assignee from @kiwifb to @alexanderdreyer.",
    "created_at": "2011-08-05T11:14:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126529",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing assignee from @kiwifb to @alexanderdreyer.



---

archive/issue_comments_126530.json:
```json
{
    "body": "I've added now a (cumulative) patch:\nhttp://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8.0alpha.p3.patch\nIt includes both previous ones as well as the treatment of c++ classes, that so not have a default constructor. (The latter should better to be handled by cython directly, so I'll report that issue there.)\n\nThe spkg was also updated (dummy default constructors dropped):\nhttp://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p3.spkg\n\nThe sources are in sync with the original repository now. If this version is fine for everybody, I'll bundle the first release candidate for polybori 0.8 soon.\n\nNote, that there are some todos due (see above).\n\nPS: I'm taking ownership of this ticket again.",
    "created_at": "2011-08-05T11:14:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126530",
    "user": "https://github.com/alexanderdreyer"
}
```

I've added now a (cumulative) patch:
http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8.0alpha.p3.patch
It includes both previous ones as well as the treatment of c++ classes, that so not have a default constructor. (The latter should better to be handled by cython directly, so I'll report that issue there.)

The spkg was also updated (dummy default constructors dropped):
http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-alpha.p3.spkg

The sources are in sync with the original repository now. If this version is fine for everybody, I'll bundle the first release candidate for polybori 0.8 soon.

Note, that there are some todos due (see above).

PS: I'm taking ownership of this ticket again.



---

archive/issue_comments_126531.json:
```json
{
    "body": "Attachment [polybori-0.8-rc.p0.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p0.patch) by @alexanderdreyer created at 2011-08-09 23:42:46\n\nCummulative patch for interfacing with PolyBoRi 0.8-rc1",
    "created_at": "2011-08-09T23:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126531",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8-rc.p0.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p0.patch) by @alexanderdreyer created at 2011-08-09 23:42:46

Cummulative patch for interfacing with PolyBoRi 0.8-rc1



---

archive/issue_comments_126532.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-08-09T23:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126532",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126533.json:
```json
{
    "body": "Meanwhile, we bundled PolyBoRi 0.8-rc1 upstream.\n\nHere is also the updated spkg:\nhttp://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-rc.p0.spkg\nand the Sage patch for interfacing with PolyBoRi 0.8-rc1:\nhttp://trac.sagemath.org/sage_trac/attachment/ticket/11575/polybori-0.8-rc.p0.patch\n\nI rebased on the most recent version of the spkg from #11261 (still not official).",
    "created_at": "2011-08-09T23:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126533",
    "user": "https://github.com/alexanderdreyer"
}
```

Meanwhile, we bundled PolyBoRi 0.8-rc1 upstream.

Here is also the updated spkg:
http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-rc.p0.spkg
and the Sage patch for interfacing with PolyBoRi 0.8-rc1:
http://trac.sagemath.org/sage_trac/attachment/ticket/11575/polybori-0.8-rc.p0.patch

I rebased on the most recent version of the spkg from #11261 (still not official).



---

archive/issue_comments_126534.json:
```json
{
    "body": "Remove assignee @alexanderdreyer.",
    "created_at": "2011-08-10T07:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126534",
    "user": "https://github.com/alexanderdreyer"
}
```

Remove assignee @alexanderdreyer.



---

archive/issue_comments_126535.json:
```json
{
    "body": "You'll find an updated spkg at http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-rc.p1.spkg which contains the sources of PolyBoRi 0.8 rc2. The Sage library patch stays the same.",
    "created_at": "2011-08-15T21:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126535",
    "user": "https://github.com/alexanderdreyer"
}
```

You'll find an updated spkg at http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-rc.p1.spkg which contains the sources of PolyBoRi 0.8 rc2. The Sage library patch stays the same.



---

archive/issue_comments_126536.json:
```json
{
    "body": "The most recent spkg builds, installs and tests sage/rings/polynomial successfully on OpenSuSE 11.1 and !MacOS 10.6. It is not affected by #11681 any more. Once Sage 4.7.1 is through the mirrors. I'll rebase the Sage-lib patch.",
    "created_at": "2011-08-16T16:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126536",
    "user": "https://github.com/alexanderdreyer"
}
```

The most recent spkg builds, installs and tests sage/rings/polynomial successfully on OpenSuSE 11.1 and !MacOS 10.6. It is not affected by #11681 any more. Once Sage 4.7.1 is through the mirrors. I'll rebase the Sage-lib patch.



---

archive/issue_comments_126537.json:
```json
{
    "body": "Attachment [polybori-0.8-rc.p1VSp0.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p1VSp0.patch) by @alexanderdreyer created at 2011-08-16 17:35:36\n\nPatch for using polybori-0.8-rc.p1.spkg (against polybori-0.8-rc.p0.patch)",
    "created_at": "2011-08-16T17:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126537",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8-rc.p1VSp0.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p1VSp0.patch) by @alexanderdreyer created at 2011-08-16 17:35:36

Patch for using polybori-0.8-rc.p1.spkg (against polybori-0.8-rc.p0.patch)



---

archive/issue_comments_126538.json:
```json
{
    "body": "Sorry, I forgot to upload the following patch:\nhttp://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8-rc.p1VSp0.patch\nPlease apply both in a row.",
    "created_at": "2011-08-16T17:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126538",
    "user": "https://github.com/alexanderdreyer"
}
```

Sorry, I forgot to upload the following patch:
http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8-rc.p1VSp0.patch
Please apply both in a row.



---

archive/issue_comments_126539.json:
```json
{
    "body": "Now that 4.7.1 is officially released [attachment:polybori-0.8-rc.p0.patch] really needs rebasing.",
    "created_at": "2011-08-16T20:09:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126539",
    "user": "https://github.com/kiwifb"
}
```

Now that 4.7.1 is officially released [attachment:polybori-0.8-rc.p0.patch] really needs rebasing.



---

archive/issue_comments_126540.json:
```json
{
    "body": "Attachment [polybori-0.8-rc.p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p1.patch) by @alexanderdreyer created at 2011-08-17 09:20:38\n\nCummulative patch, rebased to Sage 4.7.1",
    "created_at": "2011-08-17T09:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126540",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8-rc.p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p1.patch) by @alexanderdreyer created at 2011-08-17 09:20:38

Cummulative patch, rebased to Sage 4.7.1



---

archive/issue_comments_126541.json:
```json
{
    "body": "Replying to [comment:44 fbissey]:\n> Now that 4.7.1 is officially released [attachment:polybori-0.8-rc.p0.patch] really needs rebasing.\n\nYes, indeed. It's here now:\nhttp://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8-rc.p1.patch\nI obeyed the changes around SAGE_INC as you pointed out.\n\nSince #11261 is merged now, I'm going to rebase the spkg, too.",
    "created_at": "2011-08-17T09:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126541",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:44 fbissey]:
> Now that 4.7.1 is officially released [attachment:polybori-0.8-rc.p0.patch] really needs rebasing.

Yes, indeed. It's here now:
http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8-rc.p1.patch
I obeyed the changes around SAGE_INC as you pointed out.

Since #11261 is merged now, I'm going to rebase the spkg, too.



---

archive/issue_comments_126542.json:
```json
{
    "body": "Now the rebased spkg (on #11261) here:\nhttp://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8-rc.p2.patch\nIt also includes the updated sources of http://sourceforge.net/projects/polybori/files/polybori/0.8.alphas/polybori-0.8.0rc3.tar.gz (minor changes).\nIt's tested with Sage 4.7.1 on SLES 11.",
    "created_at": "2011-08-17T11:21:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126542",
    "user": "https://github.com/alexanderdreyer"
}
```

Now the rebased spkg (on #11261) here:
http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11575/polybori-0.8-rc.p2.patch
It also includes the updated sources of http://sourceforge.net/projects/polybori/files/polybori/0.8.alphas/polybori-0.8.0rc3.tar.gz (minor changes).
It's tested with Sage 4.7.1 on SLES 11.



---

archive/issue_comments_126543.json:
```json
{
    "body": "OK I pulled the trunk again with my ebuild and after a few changes to accommodate for your last commit (lib/lib64 issue not really essential for sage as far as I can see) it installed fine on linux-amd64.\n\nTrying on OS X (10.5.8) turned something interesting which may explain some of the difficulties with dynamic linking on OS X.\n\n```\n *   correcting install_name of libpolybori.dylib ...                                                                        [ ok ]\n *   correcting install_name of libpolybori_groebner.dylib ...                                                               [ ok ]\n>>> Completed installing polybori-9999 into /Users/frb15/Desktop/Gentoo/var/tmp/portage/sci-mathematics/polybori-9999/image/Users/frb15/Desktop/Gentoo/\n\necompressdir: bzip2 -9 /Users/frb15/Desktop/Gentoo/usr/share/man\n * QA Notice: invalid reference to libpolybori/libpolybori.dylib in /Users/frb15/Desktop/Gentoo/usr/lib/libpolybori_groebner.dylib\n * ERROR: sci-mathematics/polybori-9999 failed:\n *   invalid install_name found, your application or library will crash at runtime\n```\nI am guessing the culprit line is this one\n\n```\ni686-apple-darwin9-g++ -o groebner/libpolybori_groebner.dylib -Wl,-dead_strip_dylibs -dynamiclib groebner/src/groebner.os groebner/src/LiteralFactorization.os groebner/src/LiteralFactorizationIterator.os groebner/src/randomset.os groebner/src/pairs.os groebner/src/groebner_alg.os groebner/src/FGLMStrategy.os groebner/src/polynomial_properties.os groebner/src/LexBucket.os groebner/src/dlex4data.os groebner/src/dp_asc4data.os groebner/src/lp4data.os groebner/src/nf.os groebner/src/interpolate.os groebner/src/GroebnerStrategy.os groebner/src/PairManager.os groebner/src/PolyEntry.os groebner/src/ReductionStrategy.os groebner/src/MatrixMonomialOrderTables.os -Llibpolybori -Lgroebner -L/Users/frb15/Desktop/Gentoo/usr/lib -L/Users/frb15/Desktop/Gentoo/usr/lib/python2.7/config -LCudd -lm -lboost_unit_test_framework -lm4ri -lm4ri libpolybori/libpolybori.dylib -lgd\n```\nBecause you already have \"-Llibpolybori\" you shouldn't need \"libpolybori/libpolybori.dylib\" you should just plain link with \"-lpolybori\".",
    "created_at": "2011-08-18T01:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126543",
    "user": "https://github.com/kiwifb"
}
```

OK I pulled the trunk again with my ebuild and after a few changes to accommodate for your last commit (lib/lib64 issue not really essential for sage as far as I can see) it installed fine on linux-amd64.

Trying on OS X (10.5.8) turned something interesting which may explain some of the difficulties with dynamic linking on OS X.

```
 *   correcting install_name of libpolybori.dylib ...                                                                        [ ok ]
 *   correcting install_name of libpolybori_groebner.dylib ...                                                               [ ok ]
>>> Completed installing polybori-9999 into /Users/frb15/Desktop/Gentoo/var/tmp/portage/sci-mathematics/polybori-9999/image/Users/frb15/Desktop/Gentoo/

ecompressdir: bzip2 -9 /Users/frb15/Desktop/Gentoo/usr/share/man
 * QA Notice: invalid reference to libpolybori/libpolybori.dylib in /Users/frb15/Desktop/Gentoo/usr/lib/libpolybori_groebner.dylib
 * ERROR: sci-mathematics/polybori-9999 failed:
 *   invalid install_name found, your application or library will crash at runtime
```
I am guessing the culprit line is this one

```
i686-apple-darwin9-g++ -o groebner/libpolybori_groebner.dylib -Wl,-dead_strip_dylibs -dynamiclib groebner/src/groebner.os groebner/src/LiteralFactorization.os groebner/src/LiteralFactorizationIterator.os groebner/src/randomset.os groebner/src/pairs.os groebner/src/groebner_alg.os groebner/src/FGLMStrategy.os groebner/src/polynomial_properties.os groebner/src/LexBucket.os groebner/src/dlex4data.os groebner/src/dp_asc4data.os groebner/src/lp4data.os groebner/src/nf.os groebner/src/interpolate.os groebner/src/GroebnerStrategy.os groebner/src/PairManager.os groebner/src/PolyEntry.os groebner/src/ReductionStrategy.os groebner/src/MatrixMonomialOrderTables.os -Llibpolybori -Lgroebner -L/Users/frb15/Desktop/Gentoo/usr/lib -L/Users/frb15/Desktop/Gentoo/usr/lib/python2.7/config -LCudd -lm -lboost_unit_test_framework -lm4ri -lm4ri libpolybori/libpolybori.dylib -lgd
```
Because you already have "-Llibpolybori" you shouldn't need "libpolybori/libpolybori.dylib" you should just plain link with "-lpolybori".



---

archive/issue_comments_126544.json:
```json
{
    "body": "Replying to [comment:48 fbissey]:\n> Because you already have \"-Llibpolybori\" you shouldn't need \"libpolybori/libpolybori.dylib\" you should just plain link with \"-lpolybori\".\n\nThanks, I fixed that on bitbucket.",
    "created_at": "2011-08-18T07:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126544",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:48 fbissey]:
> Because you already have "-Llibpolybori" you shouldn't need "libpolybori/libpolybori.dylib" you should just plain link with "-lpolybori".

Thanks, I fixed that on bitbucket.



---

archive/issue_comments_126545.json:
```json
{
    "body": "Thanks for doing that but I unfortunately still get the same message. I am investigating what needs to be done. I am hoping there will be an easy fix.",
    "created_at": "2011-08-18T22:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126545",
    "user": "https://github.com/kiwifb"
}
```

Thanks for doing that but I unfortunately still get the same message. I am investigating what needs to be done. I am hoping there will be an easy fix.



---

archive/issue_comments_126546.json:
```json
{
    "body": "Replying to [comment:50 fbissey]:\n> Thanks for doing that but I unfortunately still get the same message. I am investigating what needs to be done. I am hoping there will be an easy fix.\n\nThat's weired. I had the chance to test it on an Intel-Mac with OS X 10.6 and an ppc running 10.5. In both cases, the build succeeded. (But not using prefix though.)",
    "created_at": "2011-08-18T22:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126546",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:50 fbissey]:
> Thanks for doing that but I unfortunately still get the same message. I am investigating what needs to be done. I am hoping there will be an easy fix.

That's weired. I had the chance to test it on an Intel-Mac with OS X 10.6 and an ppc running 10.5. In both cases, the build succeeded. (But not using prefix though.)



---

archive/issue_comments_126547.json:
```json
{
    "body": "PS: Does the linking sequence still include `libpolybori/libpolybori.dylib `?",
    "created_at": "2011-08-18T22:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126547",
    "user": "https://github.com/alexanderdreyer"
}
```

PS: Does the linking sequence still include `libpolybori/libpolybori.dylib `?



---

archive/issue_comments_126548.json:
```json
{
    "body": "Replying to [comment:52 AlexanderDreyer]:\n> PS: Does the linking sequence still include `libpolybori/libpolybori.dylib `?\n\n\nNo you fixed that exactly as I asked you. Portage does extra checks for consistency on libraries on OS X. There are a number of things that aren't exactly common knowledge to people who don't do a lot of development on OS X. Technically all libraries on OS X have an rpath which usually is relative. Look at this document:\n[http://blog.onesadcookie.com/2008/01/installname-magic.html](http://blog.onesadcookie.com/2008/01/installname-magic.html)\nThe solution adopted in portage in a OS X prefix is to make the install_name absolute which is why at the moment a sage-prefix on OS X is not relocatable. Now what the QA tool of portage is telling us is that libpolybori_groebner.dylib is linked to libpolybori/libpolybori.dylib as in the library contains the name and the path of the library. And we of course don't want that.\n\nTry the following command:\n\n```\notool -L libpolybori_groebner.dylib\n```\nThe result here is as follow:\n\n```\notool -L libpolybori_groebner.dylib \nlibpolybori_groebner.dylib:\n\t/Users/frb15/Desktop/Gentoo/usr/lib/libpolybori_groebner.dylib (compatibility version 0.0.0, current version 0.0.0)\n\tlibpolybori/libpolybori.dylib (compatibility version 0.0.0, current version 0.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.7)\n\t/Users/frb15/Desktop/Gentoo/usr/lib/libm4ri-0.0.20100817.dylib (compatibility version 0.0.0, current version 0.0.0)\n\t/Users/frb15/Desktop/Gentoo/usr/lib/libgd.2.dylib (compatibility version 3.0.0, current version 3.0.0)\n\t/Users/frb15/Desktop/Gentoo/usr/lib/gcc/i686-apple-darwin9/4.2.1/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.9.0)\n\t/Users/frb15/Desktop/Gentoo/usr/lib/gcc/i686-apple-darwin9/4.2.1/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n```\nyou can notice libpolybori/libpolybori.dylib on its lonesome.",
    "created_at": "2011-08-18T23:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126548",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:52 AlexanderDreyer]:
> PS: Does the linking sequence still include `libpolybori/libpolybori.dylib `?


No you fixed that exactly as I asked you. Portage does extra checks for consistency on libraries on OS X. There are a number of things that aren't exactly common knowledge to people who don't do a lot of development on OS X. Technically all libraries on OS X have an rpath which usually is relative. Look at this document:
[http://blog.onesadcookie.com/2008/01/installname-magic.html](http://blog.onesadcookie.com/2008/01/installname-magic.html)
The solution adopted in portage in a OS X prefix is to make the install_name absolute which is why at the moment a sage-prefix on OS X is not relocatable. Now what the QA tool of portage is telling us is that libpolybori_groebner.dylib is linked to libpolybori/libpolybori.dylib as in the library contains the name and the path of the library. And we of course don't want that.

Try the following command:

```
otool -L libpolybori_groebner.dylib
```
The result here is as follow:

```
otool -L libpolybori_groebner.dylib 
libpolybori_groebner.dylib:
	/Users/frb15/Desktop/Gentoo/usr/lib/libpolybori_groebner.dylib (compatibility version 0.0.0, current version 0.0.0)
	libpolybori/libpolybori.dylib (compatibility version 0.0.0, current version 0.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 111.1.7)
	/Users/frb15/Desktop/Gentoo/usr/lib/libm4ri-0.0.20100817.dylib (compatibility version 0.0.0, current version 0.0.0)
	/Users/frb15/Desktop/Gentoo/usr/lib/libgd.2.dylib (compatibility version 3.0.0, current version 3.0.0)
	/Users/frb15/Desktop/Gentoo/usr/lib/gcc/i686-apple-darwin9/4.2.1/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.9.0)
	/Users/frb15/Desktop/Gentoo/usr/lib/gcc/i686-apple-darwin9/4.2.1/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
```
you can notice libpolybori/libpolybori.dylib on its lonesome.



---

archive/issue_comments_126549.json:
```json
{
    "body": "I am guessing that the fundamental problem is that the install_name of libpolybori.dylib is set to libpolybori/libpolybori.dylib and I only change it after install. So when it is linked that's what is used. I can change it to something correct with install_name_tool -change but it would be better if we had something consistent in the first place. The man page for ld on OS X\n\n```\n     -install_name name\n                 Sets an internal \"install path\" (LC_ID_DYLIB) in a dynamic\n                 library. Any clients linked against the library will record\n                 that path as the way dyld should locate this library.  If\n                 this option is not specified, then the -o path will be used.\n                 This option is also called -dylib_install_name for compati\u2010\n                 bility.\n```\nWe could try to use -flat_namespace which basically gives you the same kind of situation as linux regarding the loading of libraries.",
    "created_at": "2011-08-18T23:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126549",
    "user": "https://github.com/kiwifb"
}
```

I am guessing that the fundamental problem is that the install_name of libpolybori.dylib is set to libpolybori/libpolybori.dylib and I only change it after install. So when it is linked that's what is used. I can change it to something correct with install_name_tool -change but it would be better if we had something consistent in the first place. The man page for ld on OS X

```
     -install_name name
                 Sets an internal "install path" (LC_ID_DYLIB) in a dynamic
                 library. Any clients linked against the library will record
                 that path as the way dyld should locate this library.  If
                 this option is not specified, then the -o path will be used.
                 This option is also called -dylib_install_name for compati‐
                 bility.
```
We could try to use -flat_namespace which basically gives you the same kind of situation as linux regarding the loading of libraries.



---

archive/issue_comments_126550.json:
```json
{
    "body": "make that -Wl,-flat_namespace, it is to be passed to ld.",
    "created_at": "2011-08-19T01:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126550",
    "user": "https://github.com/kiwifb"
}
```

make that -Wl,-flat_namespace, it is to be passed to ld.



---

archive/issue_comments_126551.json:
```json
{
    "body": "Replying to [comment:55 fbissey]:\n> make that -Wl,-flat_namespace, it is to be passed to ld.\n\nI added this to the bitbucket repo.",
    "created_at": "2011-08-19T12:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126551",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:55 fbissey]:
> make that -Wl,-flat_namespace, it is to be passed to ld.

I added this to the bitbucket repo.



---

archive/issue_comments_126552.json:
```json
{
    "body": "Replying to [comment:56 AlexanderDreyer]:\n> Replying to [comment:55 fbissey]:\n> > make that -Wl,-flat_namespace, it is to be passed to ld.\n\n> I added this to the bitbucket repo.\nI cannot test it until Monday unfortunately. Have you looked at what \"otool -L\" reports for you after adding that?",
    "created_at": "2011-08-19T13:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126552",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:56 AlexanderDreyer]:
> Replying to [comment:55 fbissey]:
> > make that -Wl,-flat_namespace, it is to be passed to ld.

> I added this to the bitbucket repo.
I cannot test it until Monday unfortunately. Have you looked at what "otool -L" reports for you after adding that?



---

archive/issue_comments_126553.json:
```json
{
    "body": "for some reason, it still owns paths:\n\n```\nsage subshell) p900sys02:sage dreyer$ otool -L local/lib/libpolybori_groebner.dylib \nlocal/lib/libpolybori_groebner.dylib:\n\tgroebner/libpolybori_groebner-0.8.0.dylib.0.0.0 (compatibility version 0.0.0, current version 0.0.0)\n\tlibpolybori/libpolybori-0.8.0.dylib.0.0.0 (compatibility version 0.0.0, current version 0.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.0)\n\t/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libm4ri-0.0.20100701.dylib (compatibility version 0.0.0, current version 0.0.0)\n\t/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libgd.2.dylib (compatibility version 3.0.0, current version 3.0.0)\n\t/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libpng12.0.dylib (compatibility version 36.0.0, current version 36.0.0)\n\t/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.5)\n\t/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.9.0)\n```\n\n\nThis is how it was build:\n\n```\ng++ -o groebner/libpolybori_groebner-0.8.0.dylib.0.0.0 -m64 -dynamiclib -Wl,-flat_namespace groebner/src/groebner.os groebner/src/LiteralFactorization.os groebner/src/LiteralFactorizationIterator.os groebner/src/randomset.os groebner/src/pairs.os groebner/src/groebner_alg.os groebner/src/FGLMStrategy.os groebner/src/polynomial_properties.os groebner/src/LexBucket.os groebner/src/dlex4data.os groebner/src/dp_asc4data.os groebner/src/lp4data.os groebner/src/nf.os groebner/src/interpolate.os groebner/src/GroebnerStrategy.os groebner/src/PairManager.os groebner/src/PolyEntry.os groebner/src/ReductionStrategy.os groebner/src/MatrixMonomialOrderTables.os -Llibpolybori -Lgroebner -L/Users/dreyer/sage/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/python2.6/config -LCudd -lpolybori -lm -lm4ri -lm4ri -lgd -lpng12 -lz\n```\nand\n\n```\ng++ -o libpolybori/libpolybori-0.8.0.dylib.0.0.0 -m64 -dynamiclib -Wl,-flat_namespace Cudd/cudd/cuddAPI.os Cudd/cudd/cuddCache.os Cudd/cudd/cuddInit.os Cudd/cudd/cuddLCache.os Cudd/cudd/cuddRef.os Cudd/cudd/cuddTable.os Cudd/cudd/cuddZddFuncs.os Cudd/cudd/cuddZddSetop.os libpolybori/src/BoolePolyRing.os libpolybori/src/BooleEnv.os libpolybori/src/BoolePolynomial.os libpolybori/src/BooleVariable.os libpolybori/src/CCheckedIdx.os libpolybori/src/CErrorInfo.os libpolybori/src/PBoRiError.os libpolybori/src/CCuddFirstIter.os libpolybori/src/BooleMonomial.os libpolybori/src/BooleSet.os libpolybori/src/LexOrder.os libpolybori/src/CCuddLastIter.os libpolybori/src/BooleExponent.os libpolybori/src/DegLexOrder.os libpolybori/src/DegRevLexAscOrder.os libpolybori/src/pbori_routines.os libpolybori/src/BlockDegLexOrder.os libpolybori/src/BlockDegRevLexAscOrder.os -Llibpolybori -Lgroebner -L/Users/dreyer/sage/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/python2.6/config -LCudd -lm -lm4ri -lm4ri\n```",
    "created_at": "2011-08-19T14:32:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126553",
    "user": "https://github.com/alexanderdreyer"
}
```

for some reason, it still owns paths:

```
sage subshell) p900sys02:sage dreyer$ otool -L local/lib/libpolybori_groebner.dylib 
local/lib/libpolybori_groebner.dylib:
	groebner/libpolybori_groebner-0.8.0.dylib.0.0.0 (compatibility version 0.0.0, current version 0.0.0)
	libpolybori/libpolybori-0.8.0.dylib.0.0.0 (compatibility version 0.0.0, current version 0.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.0)
	/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libm4ri-0.0.20100701.dylib (compatibility version 0.0.0, current version 0.0.0)
	/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libgd.2.dylib (compatibility version 3.0.0, current version 3.0.0)
	/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libpng12.0.dylib (compatibility version 36.0.0, current version 36.0.0)
	/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.5)
	/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.9.0)
```


This is how it was build:

```
g++ -o groebner/libpolybori_groebner-0.8.0.dylib.0.0.0 -m64 -dynamiclib -Wl,-flat_namespace groebner/src/groebner.os groebner/src/LiteralFactorization.os groebner/src/LiteralFactorizationIterator.os groebner/src/randomset.os groebner/src/pairs.os groebner/src/groebner_alg.os groebner/src/FGLMStrategy.os groebner/src/polynomial_properties.os groebner/src/LexBucket.os groebner/src/dlex4data.os groebner/src/dp_asc4data.os groebner/src/lp4data.os groebner/src/nf.os groebner/src/interpolate.os groebner/src/GroebnerStrategy.os groebner/src/PairManager.os groebner/src/PolyEntry.os groebner/src/ReductionStrategy.os groebner/src/MatrixMonomialOrderTables.os -Llibpolybori -Lgroebner -L/Users/dreyer/sage/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/python2.6/config -LCudd -lpolybori -lm -lm4ri -lm4ri -lgd -lpng12 -lz
```
and

```
g++ -o libpolybori/libpolybori-0.8.0.dylib.0.0.0 -m64 -dynamiclib -Wl,-flat_namespace Cudd/cudd/cuddAPI.os Cudd/cudd/cuddCache.os Cudd/cudd/cuddInit.os Cudd/cudd/cuddLCache.os Cudd/cudd/cuddRef.os Cudd/cudd/cuddTable.os Cudd/cudd/cuddZddFuncs.os Cudd/cudd/cuddZddSetop.os libpolybori/src/BoolePolyRing.os libpolybori/src/BooleEnv.os libpolybori/src/BoolePolynomial.os libpolybori/src/BooleVariable.os libpolybori/src/CCheckedIdx.os libpolybori/src/CErrorInfo.os libpolybori/src/PBoRiError.os libpolybori/src/CCuddFirstIter.os libpolybori/src/BooleMonomial.os libpolybori/src/BooleSet.os libpolybori/src/LexOrder.os libpolybori/src/CCuddLastIter.os libpolybori/src/BooleExponent.os libpolybori/src/DegLexOrder.os libpolybori/src/DegRevLexAscOrder.os libpolybori/src/pbori_routines.os libpolybori/src/BlockDegLexOrder.os libpolybori/src/BlockDegRevLexAscOrder.os -Llibpolybori -Lgroebner -L/Users/dreyer/sage/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib -L/Users/buildbot/build/sage/bsd-1/bsd_64_binary/build/sage-4.7/local/lib/python2.6/config -LCudd -lm -lm4ri -lm4ri
```



---

archive/issue_comments_126554.json:
```json
{
    "body": "I will have to look a bit more deeply into it. There may be some extra sauce needed. I'll look at what libtool does.",
    "created_at": "2011-08-19T14:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126554",
    "user": "https://github.com/kiwifb"
}
```

I will have to look a bit more deeply into it. There may be some extra sauce needed. I'll look at what libtool does.



---

archive/issue_comments_126555.json:
```json
{
    "body": "Ok, it seems, it has takes libpolybori/libpolybori-0.8.0.dylib.0.0.0 from the -o option, so I'll have to build stuff in one single directory.  (This will need some time)",
    "created_at": "2011-08-19T14:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126555",
    "user": "https://github.com/alexanderdreyer"
}
```

Ok, it seems, it has takes libpolybori/libpolybori-0.8.0.dylib.0.0.0 from the -o option, so I'll have to build stuff in one single directory.  (This will need some time)



---

archive/issue_comments_126556.json:
```json
{
    "body": "Replying to [comment:60 AlexanderDreyer]:\n> Ok, it seems, it has takes libpolybori/libpolybori-0.8.0.dylib.0.0.0 from the -o option, so I'll have to build stuff in one single directory.  (This will need some time)\n\n\nThat certainly something you could do, but I was hoping that it wouldn't be necessary.",
    "created_at": "2011-08-19T20:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126556",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:60 AlexanderDreyer]:
> Ok, it seems, it has takes libpolybori/libpolybori-0.8.0.dylib.0.0.0 from the -o option, so I'll have to build stuff in one single directory.  (This will need some time)


That certainly something you could do, but I was hoping that it wouldn't be necessary.



---

archive/issue_comments_126557.json:
```json
{
    "body": "Replying to [comment:61 fbissey]:\n> That certainly something you could do, but I was hoping that it wouldn't be necessary.\n\nOk, I changed this, let's see on Monday (I do not have access to a Mac either).",
    "created_at": "2011-08-19T22:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126557",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:61 fbissey]:
> That certainly something you could do, but I was hoping that it wouldn't be necessary.

Ok, I changed this, let's see on Monday (I do not have access to a Mac either).



---

archive/issue_comments_126558.json:
```json
{
    "body": "I manager to install gentoo-prefix on an old ppc to debug things further.\nThe most current polybori builds nicely on that prefix, but I can now reproduce issue mentioned here: https://bitbucket.org/brickenstein/polybori/issue/1/non-aligned-pointer-being-freed-on-os-x when using wither ipbori or  invoking ipython with the following manual commands:\nPython 2.7.2 (default, Aug 22 2011, 13:36:51)\nType \"copyright\", \"credits\" or \"license\" for more information.\n\n```\nIPython 0.10.2 -- An enhanced Interactive Python.\n?         -> Introduction and overview of IPython's features.\n%quickref -> Quick reference.\nhelp      -> Python's own help system.\nobject?   -> Details about 'object'. ?object also works, ?? prints more.\n\nIn [1]: import sys\n\nIn [2]: sys.path.insert(0,\"pyroot\")\n\nIn [3]: from polybori.frontend import *  \n[...]\npython2.7(77363) malloc: *** error for object 0x1d315a8: Non-aligned pointer being freed\n*** set a breakpoint in malloc_error_break to debug\npython2.7(77363) malloc: *** mmap(size=3221204992) failed (error code=12)\n*** error: can't allocate region\n*** set a breakpoint in malloc_error_break to debug\n[...]\n*** set a breakpoint in malloc_error_break to debug\npython2.7(77388) malloc: *** mmap(size=3221204992) failed (error code=12)\n*** error: can't allocate region\n*** set a breakpoint in malloc_error_break to debug\n\nIn [4]: x(1)*x(1)\npython2.7(77388) malloc: *** error for object 0x1d315a8: Non-aligned pointer being freed\n*** set a breakpoint in malloc_error_break to debug\nOut[4]: x(\n```\n\n\nInvoking plain python doesn't cause any trouble:\n\n```\nPython 2.7.2 (default, Aug 22 2011, 13:36:51)\n[GCC 4.2.1 (Gentoo 4.2.1_p5666, Apple Inc. build 5666) (dot 3)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import sys\n>>> sys.path.insert(0,\"pyroot\")\n>>> from polybori.frontend import *\n>>> x(1)*x(1)\nx(1)\n```\n\nSo maybe an ipython issue?",
    "created_at": "2011-08-23T13:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126558",
    "user": "https://github.com/alexanderdreyer"
}
```

I manager to install gentoo-prefix on an old ppc to debug things further.
The most current polybori builds nicely on that prefix, but I can now reproduce issue mentioned here: https://bitbucket.org/brickenstein/polybori/issue/1/non-aligned-pointer-being-freed-on-os-x when using wither ipbori or  invoking ipython with the following manual commands:
Python 2.7.2 (default, Aug 22 2011, 13:36:51)
Type "copyright", "credits" or "license" for more information.

```
IPython 0.10.2 -- An enhanced Interactive Python.
?         -> Introduction and overview of IPython's features.
%quickref -> Quick reference.
help      -> Python's own help system.
object?   -> Details about 'object'. ?object also works, ?? prints more.

In [1]: import sys

In [2]: sys.path.insert(0,"pyroot")

In [3]: from polybori.frontend import *  
[...]
python2.7(77363) malloc: *** error for object 0x1d315a8: Non-aligned pointer being freed
*** set a breakpoint in malloc_error_break to debug
python2.7(77363) malloc: *** mmap(size=3221204992) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
[...]
*** set a breakpoint in malloc_error_break to debug
python2.7(77388) malloc: *** mmap(size=3221204992) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug

In [4]: x(1)*x(1)
python2.7(77388) malloc: *** error for object 0x1d315a8: Non-aligned pointer being freed
*** set a breakpoint in malloc_error_break to debug
Out[4]: x(
```


Invoking plain python doesn't cause any trouble:

```
Python 2.7.2 (default, Aug 22 2011, 13:36:51)
[GCC 4.2.1 (Gentoo 4.2.1_p5666, Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.path.insert(0,"pyroot")
>>> from polybori.frontend import *
>>> x(1)*x(1)
x(1)
```

So maybe an ipython issue?



---

archive/issue_comments_126559.json:
```json
{
    "body": "I am checking but I think that may be a verbosity issue. python-2.7 is not very verbose and while the warnings look terrible it never prevented sage to start or even prevented me to run the tests.",
    "created_at": "2011-08-23T22:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126559",
    "user": "https://github.com/kiwifb"
}
```

I am checking but I think that may be a verbosity issue. python-2.7 is not very verbose and while the warnings look terrible it never prevented sage to start or even prevented me to run the tests.



---

archive/issue_comments_126560.json:
```json
{
    "body": "Ok, if I build everything but the initialization as shared lib and link the remaining small bundle to these libs it does work. I'll investigate that further.",
    "created_at": "2011-08-23T23:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126560",
    "user": "https://github.com/alexanderdreyer"
}
```

Ok, if I build everything but the initialization as shared lib and link the remaining small bundle to these libs it does work. I'll investigate that further.



---

archive/issue_comments_126561.json:
```json
{
    "body": "I am getting a bus error with ipython and the latest trunk (with some manual massaging to get what looks like correct libraries) and no error with pure python that's indeed very strange. The backtrace I put on bitbucket was pointing to polybori but there may be more to it.\n\nLooking back in this thread what happened to -Wl,-undefined -Wl,dynamic_lookup for OS X? I suspect that would do the trick we are after. I looked at what libtool does in the case of m4ri:\n\n```\ngcc -dynamiclib -Wl,-undefined -Wl,dynamic_lookup -o .libs/libm4ri-0.0.20100701.dylib  .libs/brilliantrussian.o .libs/misc.o .libs/packedmatrix.o .libs/grayflex.o .libs/strassen.o .libs/permutation.o .libs/trsm.o .libs/pls.o .libs/solve.o .libs/pls_mmpf.o .libs/echelonform.o    -mmmx -msse -msse2 -msse3   -install_name  /Users/frb15/Desktop/sage-4.7.1/local/lib/libm4ri-0.0.20100701.dylib  -Wl,-single_module\n```\nThis is from a vanilla (ie not gentoo based) build log. I detect relocation problems on OS X.",
    "created_at": "2011-08-23T23:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126561",
    "user": "https://github.com/kiwifb"
}
```

I am getting a bus error with ipython and the latest trunk (with some manual massaging to get what looks like correct libraries) and no error with pure python that's indeed very strange. The backtrace I put on bitbucket was pointing to polybori but there may be more to it.

Looking back in this thread what happened to -Wl,-undefined -Wl,dynamic_lookup for OS X? I suspect that would do the trick we are after. I looked at what libtool does in the case of m4ri:

```
gcc -dynamiclib -Wl,-undefined -Wl,dynamic_lookup -o .libs/libm4ri-0.0.20100701.dylib  .libs/brilliantrussian.o .libs/misc.o .libs/packedmatrix.o .libs/grayflex.o .libs/strassen.o .libs/permutation.o .libs/trsm.o .libs/pls.o .libs/solve.o .libs/pls_mmpf.o .libs/echelonform.o    -mmmx -msse -msse2 -msse3   -install_name  /Users/frb15/Desktop/sage-4.7.1/local/lib/libm4ri-0.0.20100701.dylib  -Wl,-single_module
```
This is from a vanilla (ie not gentoo based) build log. I detect relocation problems on OS X.



---

archive/issue_comments_126562.json:
```json
{
    "body": "BTW: how do you fix relative pathes to the libs to absolute ones (without setting DYLD_LIBRARY_PATH)?",
    "created_at": "2011-08-23T23:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126562",
    "user": "https://github.com/alexanderdreyer"
}
```

BTW: how do you fix relative pathes to the libs to absolute ones (without setting DYLD_LIBRARY_PATH)?



---

archive/issue_comments_126563.json:
```json
{
    "body": "In the case of m4ri libtool is doing the guessing. For polybori I do things manually:\n\n```\ninstall_name_tool -id ${absolutepath} ${library}\n```\nAnd for libpolybori_groebner\n\n```\ninstall_name_tool -change libpolybori.dylib ${absolutepathoflibpolybori.dylib} libpolybori_groebner.dylib\n```",
    "created_at": "2011-08-23T23:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126563",
    "user": "https://github.com/kiwifb"
}
```

In the case of m4ri libtool is doing the guessing. For polybori I do things manually:

```
install_name_tool -id ${absolutepath} ${library}
```
And for libpolybori_groebner

```
install_name_tool -change libpolybori.dylib ${absolutepathoflibpolybori.dylib} libpolybori_groebner.dylib
```



---

archive/issue_comments_126564.json:
```json
{
    "body": "Do you know how to run ipython under gdb?",
    "created_at": "2011-08-23T23:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126564",
    "user": "https://github.com/kiwifb"
}
```

Do you know how to run ipython under gdb?



---

archive/issue_comments_126565.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-08-23T23:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126565",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_126566.json:
```json
{
    "body": "Replying to [comment:69 fbissey]:\n> Do you know how to run ipython under gdb?\n\nUnfortunately not. But one should be able to find this in the `sage -gdb` script.\n\nThanks for pointing to `install_name_tool`",
    "created_at": "2011-08-23T23:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126566",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:69 fbissey]:
> Do you know how to run ipython under gdb?

Unfortunately not. But one should be able to find this in the `sage -gdb` script.

Thanks for pointing to `install_name_tool`



---

archive/issue_comments_126567.json:
```json
{
    "body": "that helped. Does this make any sense to you\n\n```\nython2.7(21230) malloc: *** error for object 0x249ae10: Non-aligned pointer being freed (2)\n*** set a breakpoint in malloc_error_break to debug\n\nProgram received signal EXC_BAD_ACCESS, Could not access memory.\nReason: KERN_PROTECTION_FAILURE at address: 0x0000005c\n0x90b39afa in std::__numpunct_cache<char>::_M_cache ()\n(gdb) bt\n#0  0x90b39afa in std::__numpunct_cache<char>::_M_cache ()\n#1  0x90b41feb in std::__write<char> ()\n#2  0x90b3c408 in std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::_M_insert_int<long> ()\n#3  0x90b3c54f in std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::do_put ()\n#4  0x02446f7a in std::ostream::_M_insert<long> ()\n#5  0x0166438e in polybori::CCuddCore::CCuddCore ()\n#6  0x01661680 in polybori::BoolePolyRing::BoolePolyRing ()\n#7  0x015a3d52 in init_module_PyPolyBoRi ()\n#8  0x021780fd in boost::python::handle_exception_impl ()\n#9  0x0217917c in boost::python::handle_exception<void (*)()> ()\n#10 0x02178e83 in boost::python::detail::init_module ()\n#11 0x015a3c2b in initPyPolyBoRi ()\n#12 0x00269231 in _PyImport_LoadDynamicModule ()\n```",
    "created_at": "2011-08-23T23:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126567",
    "user": "https://github.com/kiwifb"
}
```

that helped. Does this make any sense to you

```
ython2.7(21230) malloc: *** error for object 0x249ae10: Non-aligned pointer being freed (2)
*** set a breakpoint in malloc_error_break to debug

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x0000005c
0x90b39afa in std::__numpunct_cache<char>::_M_cache ()
(gdb) bt
#0  0x90b39afa in std::__numpunct_cache<char>::_M_cache ()
#1  0x90b41feb in std::__write<char> ()
#2  0x90b3c408 in std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::_M_insert_int<long> ()
#3  0x90b3c54f in std::num_put<char, std::ostreambuf_iterator<char, std::char_traits<char> > >::do_put ()
#4  0x02446f7a in std::ostream::_M_insert<long> ()
#5  0x0166438e in polybori::CCuddCore::CCuddCore ()
#6  0x01661680 in polybori::BoolePolyRing::BoolePolyRing ()
#7  0x015a3d52 in init_module_PyPolyBoRi ()
#8  0x021780fd in boost::python::handle_exception_impl ()
#9  0x0217917c in boost::python::handle_exception<void (*)()> ()
#10 0x02178e83 in boost::python::detail::init_module ()
#11 0x015a3c2b in initPyPolyBoRi ()
#12 0x00269231 in _PyImport_LoadDynamicModule ()
```



---

archive/issue_comments_126568.json:
```json
{
    "body": "Replying to [comment:66 fbissey]:\n> Looking back in this thread what happened to -Wl,-undefined -Wl,dynamic_lookup for OS X? I suspect that would do the trick we are after. I looked at what libtool does in the case of m4ri:\n\nI misunderstood that this was superseeded by `-Wl,-flat_namespace `. Should this also be added to the bundle?",
    "created_at": "2011-08-24T00:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126568",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:66 fbissey]:
> Looking back in this thread what happened to -Wl,-undefined -Wl,dynamic_lookup for OS X? I suspect that would do the trick we are after. I looked at what libtool does in the case of m4ri:

I misunderstood that this was superseeded by `-Wl,-flat_namespace `. Should this also be added to the bundle?



---

archive/issue_comments_126569.json:
```json
{
    "body": "Replying to [comment:71 fbissey]:\n> that helped. Does this make any sense to you\n\nYeah, it's the streaming of boost-python-based objects via std-streams. Moving hat stuff to a (third) shared lib seems to cure thing. I'm trying to get that into bitbicket now",
    "created_at": "2011-08-24T00:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126569",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:71 fbissey]:
> that helped. Does this make any sense to you

Yeah, it's the streaming of boost-python-based objects via std-streams. Moving hat stuff to a (third) shared lib seems to cure thing. I'm trying to get that into bitbicket now



---

archive/issue_comments_126570.json:
```json
{
    "body": "You mean site-package/polybori/dynamic/Pypolibori.{so,bundle}, I believe bundle is for frameworks in OS X, sage doesn't build python as a framework I believe (unless the build system default to it). \n\nIn any case I don't think so. \n\nOne would think that -flat_namespace and -undefined dynamic_lookup are equivalent but may be they aren't.",
    "created_at": "2011-08-24T00:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126570",
    "user": "https://github.com/kiwifb"
}
```

You mean site-package/polybori/dynamic/Pypolibori.{so,bundle}, I believe bundle is for frameworks in OS X, sage doesn't build python as a framework I believe (unless the build system default to it). 

In any case I don't think so. 

One would think that -flat_namespace and -undefined dynamic_lookup are equivalent but may be they aren't.



---

archive/issue_comments_126571.json:
```json
{
    "body": "So, I pushed my changes to bitbucket. But still ipbori only works when called from lib directory, because the install_name_tool calls are missing up to now. I hope, that it would work, if you add them into your ebuild script. (Maybe I can find a way to add those to scons tomorrow.)\n\nBTW: I had to remove-undefined dynamic_lookup flags. (Otherwise some of the malloc-errors occurred.)",
    "created_at": "2011-08-24T00:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126571",
    "user": "https://github.com/alexanderdreyer"
}
```

So, I pushed my changes to bitbucket. But still ipbori only works when called from lib directory, because the install_name_tool calls are missing up to now. I hope, that it would work, if you add them into your ebuild script. (Maybe I can find a way to add those to scons tomorrow.)

BTW: I had to remove-undefined dynamic_lookup flags. (Otherwise some of the malloc-errors occurred.)



---

archive/issue_comments_126572.json:
```json
{
    "body": "Attachment [polybori-0.8-rc.p2.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p2.patch) by @alexanderdreyer created at 2011-08-25 11:28:37\n\nmost recent cummulative patch",
    "created_at": "2011-08-25T11:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126572",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8-rc.p2.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p2.patch) by @alexanderdreyer created at 2011-08-25 11:28:37

most recent cummulative patch



---

archive/issue_comments_126573.json:
```json
{
    "body": "Attachment [polybori-0.8-rc.p3.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p3.patch) by @alexanderdreyer created at 2011-08-25 22:18:43\n\nRebased patch to 4.7.2alpha1",
    "created_at": "2011-08-25T22:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126573",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8-rc.p3.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc.p3.patch) by @alexanderdreyer created at 2011-08-25 22:18:43

Rebased patch to 4.7.2alpha1



---

archive/issue_comments_126574.json:
```json
{
    "body": "The spkg together with the rebased patch builds, installs and tests well on an SuSE Enterprise 11 and Mac OS X. It's not clear, whether PolyBoRi 0.8 is also affected by the incompatibility with newest libm4ri on Gentoo 32Bit, which is mentioned in #11574#27 (I cannot reproduce that issue.)",
    "created_at": "2011-08-26T08:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126574",
    "user": "https://github.com/alexanderdreyer"
}
```

The spkg together with the rebased patch builds, installs and tests well on an SuSE Enterprise 11 and Mac OS X. It's not clear, whether PolyBoRi 0.8 is also affected by the incompatibility with newest libm4ri on Gentoo 32Bit, which is mentioned in #11574#27 (I cannot reproduce that issue.)



---

archive/issue_comments_126575.json:
```json
{
    "body": "The following spkg includes the sources of the newest release candidate\nhttp://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-rc.p3.spkg\nThe upstream sources are now compatible with Gentoo-prefix (important for the sage-on-gentoo project) even on Darwin.\nIt also incorporates the fixes of #11574 and #11757, resp., for m4ri compatibility.",
    "created_at": "2011-09-02T20:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126575",
    "user": "https://github.com/alexanderdreyer"
}
```

The following spkg includes the sources of the newest release candidate
http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8-rc.p3.spkg
The upstream sources are now compatible with Gentoo-prefix (important for the sage-on-gentoo project) even on Darwin.
It also incorporates the fixes of #11574 and #11757, resp., for m4ri compatibility.



---

archive/issue_comments_126576.json:
```json
{
    "body": "Additional patch if #11574 is merged",
    "created_at": "2011-09-07T09:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126576",
    "user": "https://github.com/alexanderdreyer"
}
```

Additional patch if #11574 is merged



---

archive/issue_comments_126577.json:
```json
{
    "body": "Attachment [polybori-0.8-rc-11574.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc-11574.patch) by @alexanderdreyer created at 2011-09-07 09:23:09",
    "created_at": "2011-09-07T09:23:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126577",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8-rc-11574.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8-rc-11574.patch) by @alexanderdreyer created at 2011-09-07 09:23:09



---

archive/issue_comments_126578.json:
```json
{
    "body": "Patch for integration PolyBoRi's release 0.8.0 (depends on #11574)",
    "created_at": "2011-09-08T09:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126578",
    "user": "https://github.com/alexanderdreyer"
}
```

Patch for integration PolyBoRi's release 0.8.0 (depends on #11574)



---

archive/issue_comments_126579.json:
```json
{
    "body": "Attachment [polybori-0.8.0.p0.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0.p0.patch) by @alexanderdreyer created at 2011-09-08 09:42:56\n\nFinally, PolyBoRi 0.8 is out. Here's the updated spkg\nhttp://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8.0.p0.spkg\n\nThe most recent patch (for devel/sage) is http://trac.sagemath.org/sage_trac/attachment/ticket/11575/polybori-0.8.0.p0.patch\n\nNote that all depends on #11574 now (if someone want's to try out without #11574, please refer to the previous patch).\n\nThe tests from devel/sage/sage/rings/ and  devel/sage/sage/crypto/ ran successfully (tested with sage-4.7.2alpha1 on SuSE Enterprise 11, Gentoo i486, Mac OSX 10.5 ppc).",
    "created_at": "2011-09-08T09:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126579",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8.0.p0.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0.p0.patch) by @alexanderdreyer created at 2011-09-08 09:42:56

Finally, PolyBoRi 0.8 is out. Here's the updated spkg
http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8.0.p0.spkg

The most recent patch (for devel/sage) is http://trac.sagemath.org/sage_trac/attachment/ticket/11575/polybori-0.8.0.p0.patch

Note that all depends on #11574 now (if someone want's to try out without #11574, please refer to the previous patch).

The tests from devel/sage/sage/rings/ and  devel/sage/sage/crypto/ ran successfully (tested with sage-4.7.2alpha1 on SuSE Enterprise 11, Gentoo i486, Mac OSX 10.5 ppc).



---

archive/issue_comments_126580.json:
```json
{
    "body": "Set assignee to @alexanderdreyer.",
    "created_at": "2011-09-08T09:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126580",
    "user": "https://github.com/alexanderdreyer"
}
```

Set assignee to @alexanderdreyer.



---

archive/issue_comments_126581.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-08T09:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126581",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126582.json:
```json
{
    "body": "Mhhh, it fails to build for me on sage.math with 4.7.2.alpha1:\n\n```\n/mnt/usb1/scratch/malb/sage-4.7.2/local/include/csage/ccobject.h: In function \u2018T* Construct_p(void*, const P&) [with T = polybori::BooleVariable, P = int]\u2019:\nsage/rings/polynomial/pbori.cpp:35286:   instantiated from here\n/mnt/usb1/scratch/malb/sage-4.7.2/local/include/csage/ccobject.h:47: error: no matching function for call to \u2018polybori::BooleVariable::BooleVariable(const int&)\u2019\n/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:100: note: candidates are: polybori::BooleVariable::BooleVariable(const polybori::BoolePolynomial&)\n/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:67: note:                 polybori::BooleVariable::BooleVariable(const polybori::BooleVariable&)\n/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:63: note:                 polybori::BooleVariable::BooleVariable(const polybori::BoolePolyRing&)\n/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:59: note:                 polybori::BooleVariable::BooleVariable(int, const polybori::BoolePolyRing&)\nerror: command 'gcc' failed with exit status 1\n```\n\nHere's what patches I have applied:\n\n```\n$ hg qap\nm4ri_20110601.patch\ntrac_11574_m4ri_sse2.patch\npolybori-0.8.0.p0.patch\n```",
    "created_at": "2011-09-08T13:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126582",
    "user": "https://github.com/malb"
}
```

Mhhh, it fails to build for me on sage.math with 4.7.2.alpha1:

```
/mnt/usb1/scratch/malb/sage-4.7.2/local/include/csage/ccobject.h: In function ‘T* Construct_p(void*, const P&) [with T = polybori::BooleVariable, P = int]’:
sage/rings/polynomial/pbori.cpp:35286:   instantiated from here
/mnt/usb1/scratch/malb/sage-4.7.2/local/include/csage/ccobject.h:47: error: no matching function for call to ‘polybori::BooleVariable::BooleVariable(const int&)’
/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:100: note: candidates are: polybori::BooleVariable::BooleVariable(const polybori::BoolePolynomial&)
/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:67: note:                 polybori::BooleVariable::BooleVariable(const polybori::BooleVariable&)
/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:63: note:                 polybori::BooleVariable::BooleVariable(const polybori::BoolePolyRing&)
/mnt/usb1/scratch/malb/sage-4.7.2/local/include/polybori/BooleVariable.h:59: note:                 polybori::BooleVariable::BooleVariable(int, const polybori::BoolePolyRing&)
error: command 'gcc' failed with exit status 1
```

Here's what patches I have applied:

```
$ hg qap
m4ri_20110601.patch
trac_11574_m4ri_sse2.patch
polybori-0.8.0.p0.patch
```



---

archive/issue_comments_126583.json:
```json
{
    "body": "Replying to [comment:82 malb]:\n> Mhhh, it fails to build for me on sage.math with 4.7.2.alpha1:\n\n>[...]\nLooks like the changes to pbori.pyx were not effective. Did it rebuild `pbori.cpp` from `pbori.pyx`?",
    "created_at": "2011-09-09T08:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126583",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:82 malb]:
> Mhhh, it fails to build for me on sage.math with 4.7.2.alpha1:

>[...]
Looks like the changes to pbori.pyx were not effective. Did it rebuild `pbori.cpp` from `pbori.pyx`?



---

archive/issue_comments_126584.json:
```json
{
    "body": "Got it, I accidentally applied the HTML description of the patch instead of the patch. Hence, the patch did nothing.\n\nShall I delete all other attachments btw.?",
    "created_at": "2011-09-09T09:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126584",
    "user": "https://github.com/malb"
}
```

Got it, I accidentally applied the HTML description of the patch instead of the patch. Hence, the patch did nothing.

Shall I delete all other attachments btw.?



---

archive/issue_comments_126585.json:
```json
{
    "body": "Replying to [comment:84 malb]:\n> Got it, I accidentally applied the HTML description of the patch instead of the patch. Hence, the patch did nothing.\n\nI cannot count how often this happened to me :-)\n\n> Shall I delete all other attachments btw.?\n\nI prefer to keep them for documentation reasons.",
    "created_at": "2011-09-09T09:47:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126585",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:84 malb]:
> Got it, I accidentally applied the HTML description of the patch instead of the patch. Hence, the patch did nothing.

I cannot count how often this happened to me :-)

> Shall I delete all other attachments btw.?

I prefer to keep them for documentation reasons.



---

archive/issue_comments_126586.json:
```json
{
    "body": "Patch applies cleanly & doctests pass. I skimmed it and it looks good. I'll give it another read but we're quite close to a positive review.",
    "created_at": "2011-09-09T10:18:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126586",
    "user": "https://github.com/malb"
}
```

Patch applies cleanly & doctests pass. I skimmed it and it looks good. I'll give it another read but we're quite close to a positive review.



---

archive/issue_comments_126587.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-09-28T14:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126587",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126588.json:
```json
{
    "body": "Alright, talked to Alexander. Positive review.",
    "created_at": "2011-09-28T14:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126588",
    "user": "https://github.com/malb"
}
```

Alright, talked to Alexander. Positive review.



---

archive/issue_comments_126589.json:
```json
{
    "body": "oops, still needs SSE2 fix applied.",
    "created_at": "2011-09-28T14:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126589",
    "user": "https://github.com/malb"
}
```

oops, still needs SSE2 fix applied.



---

archive/issue_comments_126590.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-09-28T14:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126590",
    "user": "https://github.com/malb"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_126591.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-28T22:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126591",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126592.json:
```json
{
    "body": "Here's a new spkg with the sse2 fix (backported from PolyBoRi 0.8.1):\nhttp://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8.0.p1.spkg\nI also had to rebase the patch to for Sage 4.7.2alpha3.",
    "created_at": "2011-09-28T22:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126592",
    "user": "https://github.com/alexanderdreyer"
}
```

Here's a new spkg with the sse2 fix (backported from PolyBoRi 0.8.1):
http://boxen.math.washington.edu/home/dreyer/spkg/polybori-0.8.0.p1.spkg
I also had to rebase the patch to for Sage 4.7.2alpha3.



---

archive/issue_comments_126593.json:
```json
{
    "body": "Here are the essential changes between the patches:\n\n```\n+--- a/sage/rings/polynomial/pbori.pyx\n++++ b/sage/rings/polynomial/pbori.pyx  \n\n@@ -1664,16 +1502,24 @@                                                                                              \n          if PY_TYPE_CHECK(x, BooleanPolynomial):                                                                    \n              return x                                                                                               \n +        elif PY_TYPE_CHECK(x, BooleSet):                                                                           \n-+            return (<BooleSet>x)._ring._coerce_(x)                                                                 \n++            return (<BooleSet>x)._ring(x)                                                                          \n          elif PY_TYPE_CHECK(x, BooleanMonomial):                                                                    \n-             return (<BooleanMonomial>x)._ring._coerce_(x)                                                          \n+             return (<BooleanMonomial>x)._ring(x)                                                                   \n -#new_BP_from_PBMonom((<BooleanMonomial>x)._ring, (<BooleanMonomial>x)._pbmonom)                                    \n+-        else:                                                                                                      \n+-            #return get_cring()._coerce_(x)                                                                        \n +        elif PY_TYPE_CHECK(ring, BooleanPolynomialRing):                                                           \n-+            return (<BooleanPolynomialRing>ring)._coerce_(x)                                                       \n-         else:                                                                                                      \n--            return get_cring()._coerce_(x)                                                                         \n+             # It is a wrong use of the notion of \"coercion\"                                                        \n+             # to say that the boolean set is \"coerced\" into                                                        \n+             # a boolean polynomial ring: Boolean sets have                                                         \n+             # no parent, and thus there is no coercion map                                                         \n+             # from that parent to the ring.                                                                        \n+             # So, it is just a conversion. [Simon King]                                                            \n+-            return get_cring()(x)                                                                                  \n -                                                                                                                   \n -cdef class MonomialFactory:                                                                                        \n++            return (<BooleanPolynomialRing>ring)(x)                                                                \n++        else:                                                                                                      \n +            raise TypeError, \\                                                                                     \n +              \"Cannot generate Boolean polynomial from %s , %s%\"%(str(type(x)), str(type(ring)))                   \n +                                                                                                                   \n@@ -1719,7 +1565,7 @@                                                                                                \n +                   return result.lm()                                                                              \n +                return result                                                                                      \n +            except:                                                                                                \n-+                raise #TypeError, \"Cannot convert to Boolean Monomial %s\"%(str(type(x)))                           \n++                raise TypeError, \"Cannot convert to Boolean Monomial %s\"%(str(type(x)))                            \n +\n +cdef class VariableConstruct:\n      \"\"\"\n@@ -3019,7 +2865,7 @@\n +            if PY_TYPE_CHECK(arg, BooleanPolynomial):\n +                return arg\n +            elif PY_TYPE_CHECK(arg, BooleSet):\n-+                return (<BooleSet>arg)._ring._coerce_(arg)\n++                return (<BooleSet>arg)._ring(arg)\n +            elif PY_TYPE_CHECK(arg, BooleanMonomial):\n +                return (<BooleanMonomial>arg)._ring._coerce_(arg)\n +            elif PY_TYPE_CHECK(ring, BooleanPolynomialRing):\n```",
    "created_at": "2011-09-28T22:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126593",
    "user": "https://github.com/alexanderdreyer"
}
```

Here are the essential changes between the patches:

```
+--- a/sage/rings/polynomial/pbori.pyx
++++ b/sage/rings/polynomial/pbori.pyx  

@@ -1664,16 +1502,24 @@                                                                                              
          if PY_TYPE_CHECK(x, BooleanPolynomial):                                                                    
              return x                                                                                               
 +        elif PY_TYPE_CHECK(x, BooleSet):                                                                           
-+            return (<BooleSet>x)._ring._coerce_(x)                                                                 
++            return (<BooleSet>x)._ring(x)                                                                          
          elif PY_TYPE_CHECK(x, BooleanMonomial):                                                                    
-             return (<BooleanMonomial>x)._ring._coerce_(x)                                                          
+             return (<BooleanMonomial>x)._ring(x)                                                                   
 -#new_BP_from_PBMonom((<BooleanMonomial>x)._ring, (<BooleanMonomial>x)._pbmonom)                                    
+-        else:                                                                                                      
+-            #return get_cring()._coerce_(x)                                                                        
 +        elif PY_TYPE_CHECK(ring, BooleanPolynomialRing):                                                           
-+            return (<BooleanPolynomialRing>ring)._coerce_(x)                                                       
-         else:                                                                                                      
--            return get_cring()._coerce_(x)                                                                         
+             # It is a wrong use of the notion of "coercion"                                                        
+             # to say that the boolean set is "coerced" into                                                        
+             # a boolean polynomial ring: Boolean sets have                                                         
+             # no parent, and thus there is no coercion map                                                         
+             # from that parent to the ring.                                                                        
+             # So, it is just a conversion. [Simon King]                                                            
+-            return get_cring()(x)                                                                                  
 -                                                                                                                   
 -cdef class MonomialFactory:                                                                                        
++            return (<BooleanPolynomialRing>ring)(x)                                                                
++        else:                                                                                                      
 +            raise TypeError, \                                                                                     
 +              "Cannot generate Boolean polynomial from %s , %s%"%(str(type(x)), str(type(ring)))                   
 +                                                                                                                   
@@ -1719,7 +1565,7 @@                                                                                                
 +                   return result.lm()                                                                              
 +                return result                                                                                      
 +            except:                                                                                                
-+                raise #TypeError, "Cannot convert to Boolean Monomial %s"%(str(type(x)))                           
++                raise TypeError, "Cannot convert to Boolean Monomial %s"%(str(type(x)))                            
 +
 +cdef class VariableConstruct:
      """
@@ -3019,7 +2865,7 @@
 +            if PY_TYPE_CHECK(arg, BooleanPolynomial):
 +                return arg
 +            elif PY_TYPE_CHECK(arg, BooleSet):
-+                return (<BooleSet>arg)._ring._coerce_(arg)
++                return (<BooleSet>arg)._ring(arg)
 +            elif PY_TYPE_CHECK(arg, BooleanMonomial):
 +                return (<BooleanMonomial>arg)._ring._coerce_(arg)
 +            elif PY_TYPE_CHECK(ring, BooleanPolynomialRing):
```



---

archive/issue_comments_126594.json:
```json
{
    "body": "doctests work.",
    "created_at": "2011-09-29T09:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126594",
    "user": "https://github.com/malb"
}
```

doctests work.



---

archive/issue_comments_126595.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-09-29T09:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126595",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126596.json:
```json
{
    "body": "wow, thanks to all, awesome (as defined in the Oxford english dictionary).",
    "created_at": "2011-09-29T09:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126596",
    "user": "https://trac.sagemath.org/admin/accounts/users/PolyBoRi"
}
```

wow, thanks to all, awesome (as defined in the Oxford english dictionary).



---

archive/issue_comments_126597.json:
```json
{
    "body": "As discussed with Simon King, I uploaded another patch which does the following:\n\n```\n1505c1505\n< +            return (<BooleSet>x)._ring._element_constructor(x)\n---\n> +            return (<BooleSet>x)._ring(x)\n1521c1521\n< +            return (<BooleanPolynomialRing>ring)._element_constructor(x)\n---\n> +            return (<BooleanPolynomialRing>ring)(x)\n2868c2868\n< +                return (<BooleSet>arg)._ring._element_constructor(arg)\n---\n> +                return (<BooleSet>arg)._ring(arg)\n```",
    "created_at": "2011-09-29T10:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126597",
    "user": "https://github.com/alexanderdreyer"
}
```

As discussed with Simon King, I uploaded another patch which does the following:

```
1505c1505
< +            return (<BooleSet>x)._ring._element_constructor(x)
---
> +            return (<BooleSet>x)._ring(x)
1521c1521
< +            return (<BooleanPolynomialRing>ring)._element_constructor(x)
---
> +            return (<BooleanPolynomialRing>ring)(x)
2868c2868
< +                return (<BooleSet>arg)._ring._element_constructor(arg)
---
> +                return (<BooleSet>arg)._ring(arg)
```



---

archive/issue_comments_126598.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-09-29T11:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126598",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_126599.json:
```json
{
    "body": "Note the newest patch uses `_element_constructor_` instead of `_element_constructor`.",
    "created_at": "2011-09-29T11:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126599",
    "user": "https://github.com/alexanderdreyer"
}
```

Note the newest patch uses `_element_constructor_` instead of `_element_constructor`.



---

archive/issue_comments_126600.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-29T11:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126600",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126601.json:
```json
{
    "body": "The new splkg/patch  build/installs and tests successfully on SLES 11 on amd64.",
    "created_at": "2011-09-29T18:12:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126601",
    "user": "https://github.com/alexanderdreyer"
}
```

The new splkg/patch  build/installs and tests successfully on SLES 11 on amd64.



---

archive/issue_comments_126602.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-09-29T20:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126602",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126603.json:
```json
{
    "body": "Alright, back to positive review.",
    "created_at": "2011-09-29T20:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126603",
    "user": "https://github.com/malb"
}
```

Alright, back to positive review.



---

archive/issue_comments_126604.json:
```json
{
    "body": "The Sage library patch should be rebased to sage-4.7.2.alpha3.",
    "created_at": "2011-10-06T08:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126604",
    "user": "https://github.com/jdemeyer"
}
```

The Sage library patch should be rebased to sage-4.7.2.alpha3.



---

archive/issue_comments_126605.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-10-06T08:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126605",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_126606.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-10-06T21:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126606",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126607.json:
```json
{
    "body": "Since the patch applied without fuzz (and passes the tests) I guess the parent checksum in the patch was invalid (indeed it came from some prerelease). The current version of the patch should do its job.",
    "created_at": "2011-10-06T21:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126607",
    "user": "https://github.com/alexanderdreyer"
}
```

Since the patch applied without fuzz (and passes the tests) I guess the parent checksum in the patch was invalid (indeed it came from some prerelease). The current version of the patch should do its job.



---

archive/issue_comments_126608.json:
```json
{
    "body": "Please check, whether this patch applies.",
    "created_at": "2011-10-06T22:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126608",
    "user": "https://github.com/alexanderdreyer"
}
```

Please check, whether this patch applies.



---

archive/issue_comments_126609.json:
```json
{
    "body": "Yes, it does apply.  Possibly the previous patch also applied.  I tried to apply the patch to sage-4.7.2.alpha3 without #9138, this failed.  Since the fate of #9138 is not so clear (it could very well be unmerged in sage-4.7.2.alpha4), I will postpone testing this new PolyBoRi until it is clear how #9138 will evolve.",
    "created_at": "2011-10-07T08:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126609",
    "user": "https://github.com/jdemeyer"
}
```

Yes, it does apply.  Possibly the previous patch also applied.  I tried to apply the patch to sage-4.7.2.alpha3 without #9138, this failed.  Since the fate of #9138 is not so clear (it could very well be unmerged in sage-4.7.2.alpha4), I will postpone testing this new PolyBoRi until it is clear how #9138 will evolve.



---

archive/issue_comments_126610.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-10-07T08:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126610",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126611.json:
```json
{
    "body": "Alexander, could you also include (at least) the following:\n\n```diff\n\ndiff --git a/patches/SConstruct b/patches/SConstruct\n--- a/patches/SConstruct\n+++ b/patches/SConstruct\n@@ -545,6 +545,8 @@\n     env.Append(CPPDEFINES=[\"BSD\"])\n \n env.Append(LIBPATH=[CuddPath()])\n+if os.environ.has_key(\"LD_LIBRARY_PATH\"):\n+    env.Append(LIBPATH=os.environ[\"LD_LIBRARY_PATH\"].split(os.pathsep))\n \n cudd_resources = glob(CuddPath('util/*.c'))\n \n```\n\nOtherwise the build breaks with \"non-standard\" compiler setups since PolyBoRi (or `SConstruct`) invalidates any setting of (e.g.) `LDFLAGS`, `LD_LIBRARY_PATH` and `LIBRARY_PATH`, i.e., removes them from the environment.\n\nThe diff is against PolyBoRi 0.7.1.p6.",
    "created_at": "2011-10-07T13:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126611",
    "user": "https://github.com/nexttime"
}
```

Alexander, could you also include (at least) the following:

```diff

diff --git a/patches/SConstruct b/patches/SConstruct
--- a/patches/SConstruct
+++ b/patches/SConstruct
@@ -545,6 +545,8 @@
     env.Append(CPPDEFINES=["BSD"])
 
 env.Append(LIBPATH=[CuddPath()])
+if os.environ.has_key("LD_LIBRARY_PATH"):
+    env.Append(LIBPATH=os.environ["LD_LIBRARY_PATH"].split(os.pathsep))
 
 cudd_resources = glob(CuddPath('util/*.c'))
 
```

Otherwise the build breaks with "non-standard" compiler setups since PolyBoRi (or `SConstruct`) invalidates any setting of (e.g.) `LDFLAGS`, `LD_LIBRARY_PATH` and `LIBRARY_PATH`, i.e., removes them from the environment.

The diff is against PolyBoRi 0.7.1.p6.



---

archive/issue_comments_126612.json:
```json
{
    "body": "Replying to [comment:102 jdemeyer]:\nPlease don't tell me you plan to de-merge #9138.  It was really hard to get thing rebased to sage-4.7.2.alpha3 because of it.\nMaybe the PolyBoRi-related part of #9138 could stay anyway?",
    "created_at": "2011-10-07T13:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126612",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:102 jdemeyer]:
Please don't tell me you plan to de-merge #9138.  It was really hard to get thing rebased to sage-4.7.2.alpha3 because of it.
Maybe the PolyBoRi-related part of #9138 could stay anyway?



---

archive/issue_comments_126613.json:
```json
{
    "body": "Replying to [comment:103 leif]:\nHi Leif,,\n> {{{\n> #!diff\n\nenv.Append(LIBPATH=os.environ[\"LD_LIBRARY_PATH\"].split(os.pathsep))\n> }}}\n\nThis could be done in the custom.py file more easily.\n\n> Otherwise the build breaks with \"non-standard\" compiler setups since PolyBoRi (or `SConstruct`) invalidates any setting of (e.g.) `LDFLAGS`, `LD_LIBRARY_PATH` and `LIBRARY_PATH`, i.e., removes them from the environment.\n\nLD_LIBRARY_PATH is exported to the SCons-enviroment and it works for me. I'll check whether something has hanged in recent SCons versions.",
    "created_at": "2011-10-07T13:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126613",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:103 leif]:
Hi Leif,,
> {{{
> #!diff

env.Append(LIBPATH=os.environ["LD_LIBRARY_PATH"].split(os.pathsep))
> }}}

This could be done in the custom.py file more easily.

> Otherwise the build breaks with "non-standard" compiler setups since PolyBoRi (or `SConstruct`) invalidates any setting of (e.g.) `LDFLAGS`, `LD_LIBRARY_PATH` and `LIBRARY_PATH`, i.e., removes them from the environment.

LD_LIBRARY_PATH is exported to the SCons-enviroment and it works for me. I'll check whether something has hanged in recent SCons versions.



---

archive/issue_comments_126614.json:
```json
{
    "body": "The PolyBoRi spkg currently uses the following environment variables:\n`CC CXX SAGESOFLAGS PYTHONHOME SAGE_LOCAL`\n\nIt would be a two liner to support more. Here's what I frequently use:\n`CFLAGS CXXFLAGS CPPFLAGS LDFLAGS` \nDo we need more?",
    "created_at": "2011-10-07T14:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126614",
    "user": "https://github.com/alexanderdreyer"
}
```

The PolyBoRi spkg currently uses the following environment variables:
`CC CXX SAGESOFLAGS PYTHONHOME SAGE_LOCAL`

It would be a two liner to support more. Here's what I frequently use:
`CFLAGS CXXFLAGS CPPFLAGS LDFLAGS` 
Do we need more?



---

archive/issue_comments_126615.json:
```json
{
    "body": "Replying to [comment:104 AlexanderDreyer]:\n> Replying to [comment:102 jdemeyer]:\n> Please don't tell me you plan to de-merge #9138.  It was really hard to get thing rebased to sage-4.7.2.alpha3 because of it.\n> Maybe the PolyBoRi-related part of #9138 could stay anyway?\n\n\nI think the \"rescue mission\" for #9138 (i.e., ticket #11900) may be successful.",
    "created_at": "2011-10-07T14:36:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126615",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:104 AlexanderDreyer]:
> Replying to [comment:102 jdemeyer]:
> Please don't tell me you plan to de-merge #9138.  It was really hard to get thing rebased to sage-4.7.2.alpha3 because of it.
> Maybe the PolyBoRi-related part of #9138 could stay anyway?


I think the "rescue mission" for #9138 (i.e., ticket #11900) may be successful.



---

archive/issue_comments_126616.json:
```json
{
    "body": "Replying to [comment:104 AlexanderDreyer]:\n> Replying to [comment:102 jdemeyer]:\n> Please don't tell me you plan to de-merge #9138.  It was really hard to get thing rebased to sage-4.7.2.alpha3 because of it.\n> Maybe the PolyBoRi-related part of #9138 could stay anyway?\n\n\nFirst of all, Simon King is working really hard to fix #9138, see #11900.  Second, even if #9138 is unmerged in sage-4.7.2.alpha4, it will probably be merged again with #11900, say in sage-4.7.3.alpha0, so there will be no reason to rebase #11575.",
    "created_at": "2011-10-07T15:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126616",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:104 AlexanderDreyer]:
> Replying to [comment:102 jdemeyer]:
> Please don't tell me you plan to de-merge #9138.  It was really hard to get thing rebased to sage-4.7.2.alpha3 because of it.
> Maybe the PolyBoRi-related part of #9138 could stay anyway?


First of all, Simon King is working really hard to fix #9138, see #11900.  Second, even if #9138 is unmerged in sage-4.7.2.alpha4, it will probably be merged again with #11900, say in sage-4.7.3.alpha0, so there will be no reason to rebase #11575.



---

archive/issue_comments_126617.json:
```json
{
    "body": "Replying to [comment:106 AlexanderDreyer]:\n> The PolyBoRi spkg currently uses the following environment variables:\n> `CC CXX SAGESOFLAGS PYTHONHOME SAGE_LOCAL`\n> \n> It would be a two liner to support more. Here's what I frequently use:\n> `CFLAGS CXXFLAGS CPPFLAGS LDFLAGS` \n> Do we need more?\n\n\n*Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.\n\nOther platforms (i.e., operating systems) use different flavours of `LD_LIBRARY_PATH` etc. though, but I don't care much atm... ;-)",
    "created_at": "2011-10-07T15:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126617",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:106 AlexanderDreyer]:
> The PolyBoRi spkg currently uses the following environment variables:
> `CC CXX SAGESOFLAGS PYTHONHOME SAGE_LOCAL`
> 
> It would be a two liner to support more. Here's what I frequently use:
> `CFLAGS CXXFLAGS CPPFLAGS LDFLAGS` 
> Do we need more?


*Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.

Other platforms (i.e., operating systems) use different flavours of `LD_LIBRARY_PATH` etc. though, but I don't care much atm... ;-)



---

archive/issue_comments_126618.json:
```json
{
    "body": "Replying to [comment:109 leif]:\n> Replying to [comment:106 AlexanderDreyer]:\n> > The PolyBoRi spkg currently uses the following environment variables:\n> > `CC CXX SAGESOFLAGS PYTHONHOME SAGE_LOCAL`\n> > \n> > It would be a two liner to support more. Here's what I frequently use:\n> > `CFLAGS CXXFLAGS CPPFLAGS LDFLAGS` \n> > Do we need more?\n\n> \n> *Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.\n\n\nOoops, and of course `LD_LIBRARY_PATH`, as mentioned and in the diff.\n\n\n\n\n> Other platforms (i.e., operating systems) use different flavours of `LD_LIBRARY_PATH` etc. though, but I don't care much atm... ;-)",
    "created_at": "2011-10-07T15:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126618",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:109 leif]:
> Replying to [comment:106 AlexanderDreyer]:
> > The PolyBoRi spkg currently uses the following environment variables:
> > `CC CXX SAGESOFLAGS PYTHONHOME SAGE_LOCAL`
> > 
> > It would be a two liner to support more. Here's what I frequently use:
> > `CFLAGS CXXFLAGS CPPFLAGS LDFLAGS` 
> > Do we need more?

> 
> *Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.


Ooops, and of course `LD_LIBRARY_PATH`, as mentioned and in the diff.




> Other platforms (i.e., operating systems) use different flavours of `LD_LIBRARY_PATH` etc. though, but I don't care much atm... ;-)



---

archive/issue_comments_126619.json:
```json
{
    "body": "Replying to [comment:108 jdemeyer]:\n> First of all, Simon King is working really hard to fix #9138, see #11900.  Second, even if #9138 is unmerged in sage-4.7.2.alpha4, it will probably be merged again with #11900, say in sage-4.7.3.alpha0, so there will be no reason to rebase #11575.\n\nVery well, Simon is good at these things (one cannot be 100% bug/regression-free in the first). so i have to doubt that he manages the rescue mission. \nsage-4.7.3.alpha0 is early enough for PoylyBoRi 0.8 anyway.",
    "created_at": "2011-10-07T20:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126619",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:108 jdemeyer]:
> First of all, Simon King is working really hard to fix #9138, see #11900.  Second, even if #9138 is unmerged in sage-4.7.2.alpha4, it will probably be merged again with #11900, say in sage-4.7.3.alpha0, so there will be no reason to rebase #11575.

Very well, Simon is good at these things (one cannot be 100% bug/regression-free in the first). so i have to doubt that he manages the rescue mission. 
sage-4.7.3.alpha0 is early enough for PoylyBoRi 0.8 anyway.



---

archive/issue_comments_126620.json:
```json
{
    "body": "Replying to [comment:110 leif]:\n> > *Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.\n\n> \n> Ooops, and of course `LD_LIBRARY_PATH`, as mentioned and in the diff.\n\n\nOk, but I'll make a new ticket for this as it is not relation to the version update.",
    "created_at": "2011-10-07T20:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126620",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:110 leif]:
> > *Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.

> 
> Ooops, and of course `LD_LIBRARY_PATH`, as mentioned and in the diff.


Ok, but I'll make a new ticket for this as it is not relation to the version update.



---

archive/issue_comments_126621.json:
```json
{
    "body": "The environment variable issue is #11906.",
    "created_at": "2011-10-07T21:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126621",
    "user": "https://github.com/alexanderdreyer"
}
```

The environment variable issue is #11906.



---

archive/issue_comments_126622.json:
```json
{
    "body": "Replying to [comment:112 AlexanderDreyer]:\n> Replying to [comment:110 leif]:\n> > > *Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.\n\n> > \n> > Ooops, and of course `LD_LIBRARY_PATH`, as mentioned and in the diff.\n\n> \n> Ok, but I'll make a new ticket for this as it is not relation to the version update.\n\n\nNo problem. I ran into this a while ago, so I have my 0.7.1.p7 spkg.\n\nAnd I only remembered that when I came across this ticket... ;-)",
    "created_at": "2011-10-07T22:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126622",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:112 AlexanderDreyer]:
> Replying to [comment:110 leif]:
> > > *Adding* the latter list to the former should be sufficient. Maybe also add `LD_RUN_PATH`, which is used only if no `-rpath` parameters are present when linking, and (in general) perhaps `ABI` and `CPP` itself.

> > 
> > Ooops, and of course `LD_LIBRARY_PATH`, as mentioned and in the diff.

> 
> Ok, but I'll make a new ticket for this as it is not relation to the version update.


No problem. I ran into this a while ago, so I have my 0.7.1.p7 spkg.

And I only remembered that when I came across this ticket... ;-)



---

archive/issue_comments_126623.json:
```json
{
    "body": "Replying to [comment:114 leif]:\n> No problem. I ran into this a while ago, so I have my 0.7.1.p7 spkg.\n> \n> And I only remembered that when I came across this ticket... ;-)\n\nBut it's a good point anyway. As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.",
    "created_at": "2011-10-07T22:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126623",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:114 leif]:
> No problem. I ran into this a while ago, so I have my 0.7.1.p7 spkg.
> 
> And I only remembered that when I came across this ticket... ;-)

But it's a good point anyway. As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.



---

archive/issue_comments_126624.json:
```json
{
    "body": "Replying to [comment:115 AlexanderDreyer]:\n> As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.\n\n\n[In principle belongs to #11906:]\n\nIIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.\n\nThe problem was that it couldn't find [an appropriate] `libgcc[_s]`; all other paths are compiled into GCC (which used to be in `specs`). So `LDFLAGS` would also have helped (if they were used in the link commands).\n\nA work-around is to create symbolic links (in directories where they do not really belong), but since PolyBoRi is the only package that shows this behaviour (or error), I fixed the spkg rather than doing that, which I'd also have to do for a couple of different GCC installations.",
    "created_at": "2011-10-07T22:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126624",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:115 AlexanderDreyer]:
> As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.


[In principle belongs to #11906:]

IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.

The problem was that it couldn't find [an appropriate] `libgcc[_s]`; all other paths are compiled into GCC (which used to be in `specs`). So `LDFLAGS` would also have helped (if they were used in the link commands).

A work-around is to create symbolic links (in directories where they do not really belong), but since PolyBoRi is the only package that shows this behaviour (or error), I fixed the spkg rather than doing that, which I'd also have to do for a couple of different GCC installations.



---

archive/issue_comments_126625.json:
```json
{
    "body": "Replying to [comment:116 leif]:\n> Replying to [comment:115 AlexanderDreyer]:\n> > As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.\n\n> \n> IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.\n\n\nOk, according to the GCC documentation, you are right.\n\nCurrently (re)testing that...",
    "created_at": "2011-10-07T22:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126625",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:116 leif]:
> Replying to [comment:115 AlexanderDreyer]:
> > As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.

> 
> IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.


Ok, according to the GCC documentation, you are right.

Currently (re)testing that...



---

archive/issue_comments_126626.json:
```json
{
    "body": "Replying to [comment:116 leif]:\n> IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.\n\n`LD_LIBRARY_PATH` should be used for runtime search, not at link time. \n\nEven though `LD_LIBRARY_PATH` may be effective at link time as (unwanted?) side effect, I think the missing LDFLAGS caused your problems. (Since `LD_LIBRARY_PATH` had been imported before.)",
    "created_at": "2011-10-07T22:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126626",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:116 leif]:
> IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.

`LD_LIBRARY_PATH` should be used for runtime search, not at link time. 

Even though `LD_LIBRARY_PATH` may be effective at link time as (unwanted?) side effect, I think the missing LDFLAGS caused your problems. (Since `LD_LIBRARY_PATH` had been imported before.)



---

archive/issue_comments_126627.json:
```json
{
    "body": "Replying to [comment:117 leif]:\n> Replying to [comment:116 leif]:\n> > Replying to [comment:115 AlexanderDreyer]:\n> > > As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.\n\n> > \n> > IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.\n\n> \n> Ok, according to the GCC documentation, you are right.\n> \n> Currently (re)testing that...\n\n\nOk, replacing `LD_LIBRARY_PATH` with `LIBRARY_PATH` in my patch above (and setting that to a path along which `libgcc*` can be found) also works.\n\nBut I also noticed other things (when doing `./sage -f ...`):\n\n```\n...\nChecking for C header file gd.h... yes\nChecking for C library gd... no\n...\nChecking for C library m4ri... no\nChecking for C header file gd.h... yes\nChecking for C library gd... no\nSymlinking to M4RI/m4ri ...\n...\n```\n(Haven't tracked that further down, but it's strange, provided `$SAGE_LOCAL/[lib/]` **is** used there, since both libraries are present.)\n\n\n\n\nAlso, `spkg-install` (I think) shouldn't delete previous versions until the build succeeded.",
    "created_at": "2011-10-07T23:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126627",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:117 leif]:
> Replying to [comment:116 leif]:
> > Replying to [comment:115 AlexanderDreyer]:
> > > As far as I understand gcc's manual it should be enough to import `LIBRARY_PATH` into the build environment to avoid your work around.

> > 
> > IIRC that didn't help, because *the linker* doesn't use `LIBRARY_PATH` but `LD_LIBRARY_PATH`.

> 
> Ok, according to the GCC documentation, you are right.
> 
> Currently (re)testing that...


Ok, replacing `LD_LIBRARY_PATH` with `LIBRARY_PATH` in my patch above (and setting that to a path along which `libgcc*` can be found) also works.

But I also noticed other things (when doing `./sage -f ...`):

```
...
Checking for C header file gd.h... yes
Checking for C library gd... no
...
Checking for C library m4ri... no
Checking for C header file gd.h... yes
Checking for C library gd... no
Symlinking to M4RI/m4ri ...
...
```
(Haven't tracked that further down, but it's strange, provided `$SAGE_LOCAL/[lib/]` **is** used there, since both libraries are present.)




Also, `spkg-install` (I think) shouldn't delete previous versions until the build succeeded.



---

archive/issue_comments_126628.json:
```json
{
    "body": "Replying to [comment:119 leif]:\n[...] \n> Ok, replacing `LD_LIBRARY_PATH` with `LIBRARY_PATH` in my patch above (and setting that to a path along which `libgcc*` can be found) also works.\n\nTry to use the (inlined) patch from #11906. It directly reconstructs the original environment. Even though it will not utilize LDFLAGS yet.\n\n> But I also noticed other things (when doing `./sage -f ...`):\n> \n> ```\n> ...\n> Checking for C header file gd.h... yes\n> Checking for C library gd... no\n> ...\n> Checking for C library m4ri... no\n> Checking for C header file gd.h... yes\n> Checking for C library gd... no\n> Symlinking to M4RI/m4ri ...\n> ...\n> ```\n> (Haven't tracked that further down, but it's strange, provided `$SAGE_LOCAL/[lib/]` **is** used there, since both libraries are present.)\n\nMaybe the patched LIBPATH is corrupted. \n\n> Also, `spkg-install` (I think) shouldn't delete previous versions until the build succeeded.\n\nThen you're possibly using outdated headers.",
    "created_at": "2011-10-07T23:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126628",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:119 leif]:
[...] 
> Ok, replacing `LD_LIBRARY_PATH` with `LIBRARY_PATH` in my patch above (and setting that to a path along which `libgcc*` can be found) also works.

Try to use the (inlined) patch from #11906. It directly reconstructs the original environment. Even though it will not utilize LDFLAGS yet.

> But I also noticed other things (when doing `./sage -f ...`):
> 
> ```
> ...
> Checking for C header file gd.h... yes
> Checking for C library gd... no
> ...
> Checking for C library m4ri... no
> Checking for C header file gd.h... yes
> Checking for C library gd... no
> Symlinking to M4RI/m4ri ...
> ...
> ```
> (Haven't tracked that further down, but it's strange, provided `$SAGE_LOCAL/[lib/]` **is** used there, since both libraries are present.)

Maybe the patched LIBPATH is corrupted. 

> Also, `spkg-install` (I think) shouldn't delete previous versions until the build succeeded.

Then you're possibly using outdated headers.



---

archive/issue_comments_126629.json:
```json
{
    "body": "Replying to [comment:118 AlexanderDreyer]:\n> `LD_LIBRARY_PATH` should be used for runtime search, not at link time.\n\n\nAlso `ld` uses it, to look up libraries others depend on; `libstdc++` has `libgcc_s` in its `DT_NEEDED` tags.\n\nIf PolyBoRi itself would (directly) need it, its path would have to be in either `LDFLAGS` or `LIBRARY_PATH`.\n\n\n> I think the missing LDFLAGS caused your problems.\n\n\nAlternatively, see above.\n\n\n> (Since `LD_LIBRARY_PATH` had been imported before.) \n\n\nNope, at least not properly; otherwise my patch wouldn't have changed anything.",
    "created_at": "2011-10-07T23:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126629",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:118 AlexanderDreyer]:
> `LD_LIBRARY_PATH` should be used for runtime search, not at link time.


Also `ld` uses it, to look up libraries others depend on; `libstdc++` has `libgcc_s` in its `DT_NEEDED` tags.

If PolyBoRi itself would (directly) need it, its path would have to be in either `LDFLAGS` or `LIBRARY_PATH`.


> I think the missing LDFLAGS caused your problems.


Alternatively, see above.


> (Since `LD_LIBRARY_PATH` had been imported before.) 


Nope, at least not properly; otherwise my patch wouldn't have changed anything.



---

archive/issue_comments_126630.json:
```json
{
    "body": "Replying to [comment:120 AlexanderDreyer]:\n> Replying to [comment:119 leif]:\n> > Also, `spkg-install` (I think) shouldn't delete previous versions until the build succeeded.\n\n> Then you're possibly using outdated headers.\n\nA matter of the order of `-I...`s. PolyBoRi should just prepend the directories of the header files in the spkg.",
    "created_at": "2011-10-07T23:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126630",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:120 AlexanderDreyer]:
> Replying to [comment:119 leif]:
> > Also, `spkg-install` (I think) shouldn't delete previous versions until the build succeeded.

> Then you're possibly using outdated headers.

A matter of the order of `-I...`s. PolyBoRi should just prepend the directories of the header files in the spkg.



---

archive/issue_comments_126631.json:
```json
{
    "body": "Replying to [comment:121 leif]:\n> > I think the missing LDFLAGS caused your problems.\n\n> Alternatively, see above.\nAre you sure? Does your setup really work without invoking `make`?\n\nI mean, does plain\n\n```\ng++ -o helloworld helloworld.cc\n```\nsucceed for a C++ helloworld.cc like the following?\n\n```\n#include <iostream>\nint main() {\n  std::cout << \"Hello World\" << std::endl;\n  return 0;\n}\n```",
    "created_at": "2011-10-07T23:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126631",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:121 leif]:
> > I think the missing LDFLAGS caused your problems.

> Alternatively, see above.
Are you sure? Does your setup really work without invoking `make`?

I mean, does plain

```
g++ -o helloworld helloworld.cc
```
succeed for a C++ helloworld.cc like the following?

```
#include <iostream>
int main() {
  std::cout << "Hello World" << std::endl;
  return 0;
}
```



---

archive/issue_comments_126632.json:
```json
{
    "body": "Replying to [comment:123 AlexanderDreyer]:\n(Without LIBRARY_PATH of course.)",
    "created_at": "2011-10-07T23:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126632",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:123 AlexanderDreyer]:
(Without LIBRARY_PATH of course.)



---

archive/issue_comments_126633.json:
```json
{
    "body": "[Trac s***s...]\n\nReplying to [comment:120 AlexanderDreyer]:\n> Replying to [comment:119 leif]:\n> > But I also noticed other things (when doing `./sage -f ...`):\n\n{{{\n...\nChecking for C header file gd.h... yes\nChecking for C library gd... no\n...\nChecking for C library m4ri... no\nChecking for C header file gd.h... yes\nChecking for C library gd... no\nSymlinking to M4RI/m4ri ...\n...\n}}}\n> > (Haven't tracked that further down, but it's strange, provided `$SAGE_LOCAL/[lib/]` **is** used there, since both libraries are present.)\n\n> Maybe the patched LIBPATH is corrupted. \n\nI did and do get exactly the same with the vanilla 0.7.1.p6 spkg (which fails to build).",
    "created_at": "2011-10-07T23:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126633",
    "user": "https://github.com/nexttime"
}
```

[Trac s***s...]

Replying to [comment:120 AlexanderDreyer]:
> Replying to [comment:119 leif]:
> > But I also noticed other things (when doing `./sage -f ...`):

{{{
...
Checking for C header file gd.h... yes
Checking for C library gd... no
...
Checking for C library m4ri... no
Checking for C header file gd.h... yes
Checking for C library gd... no
Symlinking to M4RI/m4ri ...
...
}}}
> > (Haven't tracked that further down, but it's strange, provided `$SAGE_LOCAL/[lib/]` **is** used there, since both libraries are present.)

> Maybe the patched LIBPATH is corrupted. 

I did and do get exactly the same with the vanilla 0.7.1.p6 spkg (which fails to build).



---

archive/issue_comments_126634.json:
```json
{
    "body": "Replying to [comment:125 leif]:\nwith the vanilla 0.7.1.p6 spkg (which fails to build).\nThat's weired, what does config.log say?",
    "created_at": "2011-10-08T00:13:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126634",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:125 leif]:
with the vanilla 0.7.1.p6 spkg (which fails to build).
That's weired, what does config.log say?



---

archive/issue_comments_126635.json:
```json
{
    "body": "Replying to [comment:126 AlexanderDreyer]:\n> Replying to [comment:125 leif]:\n> with the vanilla 0.7.1.p6 spkg (which fails to build).\n> That's weired, what does config.log say?\n\nI just realized that you work around is active *after* configuring. So trying to link against gd and m4ri fails, becuase the compiler is still broken at that point.\n\nYou may add your work around to `patches/custom.py` (which is executed earlier) as follows:\n\n```\nif os.environ.has_key(\"LD_LIBRARY_PATH\"): \n  LIBPATH += os.environ[\"LD_LIBRARY_PATH\"].split(os.pathsep)\n```",
    "created_at": "2011-10-08T00:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126635",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:126 AlexanderDreyer]:
> Replying to [comment:125 leif]:
> with the vanilla 0.7.1.p6 spkg (which fails to build).
> That's weired, what does config.log say?

I just realized that you work around is active *after* configuring. So trying to link against gd and m4ri fails, becuase the compiler is still broken at that point.

You may add your work around to `patches/custom.py` (which is executed earlier) as follows:

```
if os.environ.has_key("LD_LIBRARY_PATH"): 
  LIBPATH += os.environ["LD_LIBRARY_PATH"].split(os.pathsep)
```



---

archive/issue_comments_126636.json:
```json
{
    "body": "Replying to [comment:123 AlexanderDreyer]:\n> Replying to [comment:121 leif]:\n> > > I think the missing LDFLAGS caused your problems.\n\n> > Alternatively, see above.\n> Are you sure? Does your setup really work without invoking `make`?\n\n\nSince (I now remember that) `g++` *always* adds `-lgcc_s` (also `gcc` when called with `-x c++`), even\n\n```\n$ echo \"int main(void){return 0;}\" > foo.c\n$ g++ -x c++ foo.c -o foo\n```\nrequires `libgcc_s.so` to be found, e.g. by setting `LIBRARY_PATH` (unless one uses `-static-libgcc`, since that's located in other directories).\n\n(I have to set *`LD_LIBRARY_PATH`* anyway, such that the runtime linker finds `libgmp` etc., which are used by `gcc` and `g++`.  But that's not sufficient to compile an executable like the above as C++.  So apparently PolyBoRi, or SConstruct, doesn't really invalidate `LD_LIBRARY_PATH` -- otherwise the compiler wouldn't have worked at all -- but `LIBRARY_PATH`, and with my current settings it doesn't matter whether I put the former or the latter into SCons's `LIBPATH`, since *both* contain the directory where `libgcc_s` lives.  IIRC I first tried adding things to where the \"`getenv`\" dictionary is set up, which didn't work, but I don't recall exactly.)",
    "created_at": "2011-10-08T00:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126636",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:123 AlexanderDreyer]:
> Replying to [comment:121 leif]:
> > > I think the missing LDFLAGS caused your problems.

> > Alternatively, see above.
> Are you sure? Does your setup really work without invoking `make`?


Since (I now remember that) `g++` *always* adds `-lgcc_s` (also `gcc` when called with `-x c++`), even

```
$ echo "int main(void){return 0;}" > foo.c
$ g++ -x c++ foo.c -o foo
```
requires `libgcc_s.so` to be found, e.g. by setting `LIBRARY_PATH` (unless one uses `-static-libgcc`, since that's located in other directories).

(I have to set *`LD_LIBRARY_PATH`* anyway, such that the runtime linker finds `libgmp` etc., which are used by `gcc` and `g++`.  But that's not sufficient to compile an executable like the above as C++.  So apparently PolyBoRi, or SConstruct, doesn't really invalidate `LD_LIBRARY_PATH` -- otherwise the compiler wouldn't have worked at all -- but `LIBRARY_PATH`, and with my current settings it doesn't matter whether I put the former or the latter into SCons's `LIBPATH`, since *both* contain the directory where `libgcc_s` lives.  IIRC I first tried adding things to where the "`getenv`" dictionary is set up, which didn't work, but I don't recall exactly.)



---

archive/issue_comments_126637.json:
```json
{
    "body": "Replying to [comment:126 AlexanderDreyer]:\n> Replying to [comment:125 leif]:\n> > with the vanilla 0.7.1.p6 spkg (which fails to build).\n\n> That's weired, what does config.log say?\n\nWell, that's funny:\n\n```\n\nscons: Configure: Checking for C header file gd.h...\n.sconf_temp/conftest_0.c <-\n  |\n  |#include \"gd.h\"\n  |\n  |\ngcc -o .sconf_temp/conftest_0.o -c -std=c99 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -I/tmp/leif/sage-4.7.2.alpha3-gcc-4.4.6/local/include .sconf_temp/conftest_0.c\nscons: Configure: yes\n\nscons: Configure: Checking for C library gd...\n.sconf_temp/conftest_1.c <-\n  |\n  |\n  |\n  |int\n  |main() {\n  |\n  |return 0;\n  |}\n  |\ngcc -o .sconf_temp/conftest_1.o -c -std=c99 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -I/tmp/leif/sage-4.7.2.alpha3-gcc-4.4.6/local/include .sconf_temp/conftest_1.c\ngcc -o .sconf_temp/conftest_1 .sconf_temp/conftest_1.o -L/tmp/leif/sage-4.7.2.alpha3-gcc-4.4.6/local/lib -lgd\n/usr/bin/ld: cannot find -lgcc_s\ncollect2: ld returned 1 exit status\nscons: Configure: no\n```\n\nIt's not immediately clear what triggers `libgcc_s` to apparently get pulled in there, since `libgd` doesn't need it (according to `ldd`), and it's plain C, compiled with `gcc` rather than `g++`.",
    "created_at": "2011-10-08T01:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126637",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:126 AlexanderDreyer]:
> Replying to [comment:125 leif]:
> > with the vanilla 0.7.1.p6 spkg (which fails to build).

> That's weired, what does config.log say?

Well, that's funny:

```

scons: Configure: Checking for C header file gd.h...
.sconf_temp/conftest_0.c <-
  |
  |#include "gd.h"
  |
  |
gcc -o .sconf_temp/conftest_0.o -c -std=c99 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -I/tmp/leif/sage-4.7.2.alpha3-gcc-4.4.6/local/include .sconf_temp/conftest_0.c
scons: Configure: yes

scons: Configure: Checking for C library gd...
.sconf_temp/conftest_1.c <-
  |
  |
  |
  |int
  |main() {
  |
  |return 0;
  |}
  |
gcc -o .sconf_temp/conftest_1.o -c -std=c99 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -I/tmp/leif/sage-4.7.2.alpha3-gcc-4.4.6/local/include .sconf_temp/conftest_1.c
gcc -o .sconf_temp/conftest_1 .sconf_temp/conftest_1.o -L/tmp/leif/sage-4.7.2.alpha3-gcc-4.4.6/local/lib -lgd
/usr/bin/ld: cannot find -lgcc_s
collect2: ld returned 1 exit status
scons: Configure: no
```

It's not immediately clear what triggers `libgcc_s` to apparently get pulled in there, since `libgd` doesn't need it (according to `ldd`), and it's plain C, compiled with `gcc` rather than `g++`.



---

archive/issue_comments_126638.json:
```json
{
    "body": "Ok, it's not `-std=c99` (which would be strange anyway), but I now realize that even\n\n```sh\n$ (unset LIBRARY_PATH; gcc -o foo foo.c)\n```\ndoesn't work, because\n\n```\n... -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed ...\n```\nis **always** added by that GCC. (At least earlier versions were IMHO smarter w.r.t. this.)",
    "created_at": "2011-10-08T01:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126638",
    "user": "https://github.com/nexttime"
}
```

Ok, it's not `-std=c99` (which would be strange anyway), but I now realize that even

```sh
$ (unset LIBRARY_PATH; gcc -o foo foo.c)
```
doesn't work, because

```
... -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed ...
```
is **always** added by that GCC. (At least earlier versions were IMHO smarter w.r.t. this.)



---

archive/issue_comments_126639.json:
```json
{
    "body": "Replying to [comment:127 AlexanderDreyer]:\n> I just realized that you work around is active *after* configuring. So trying to link against gd and m4ri fails, becuase the compiler is still broken at that point.\n> \n> You may add your work around to `patches/custom.py` (which is executed earlier) as follows:\n\n{{{\nif os.environ.has_key(\"LD_LIBRARY_PATH\"): \n  LIBPATH += os.environ[\"LD_LIBRARY_PATH\"].split(os.pathsep)\n}}}\n\nFWIW, *both* adding\n\n```python\nif os.environ.has_key(\"LIBRARY_PATH\"): \n    LIBPATH += os.environ[\"LIBRARY_PATH\"].split(os.pathsep)\n```\n(`LIBRARY_PATH`, not `LD_LIBRARY_PATH`) in `patches/custom.py` as well as changing `patches/SConstruct` to\n\n```python\n# Get paths an related things from current environment\n# todo: Are these settings sane in any case?\ngetenv = dict()\n# for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH'] :\nfor key in ['PATH', 'HOME', 'LD_LIBRARY_PATH', 'LIBRARY_PATH'] :\n    try:\n        getenv[key] = os.environ[key]\n    except KeyError:\n        pass\n```\n*independently* work for me, i.e., in both cases the build succeeds, and the GD and M4RI libraries are found by \"Configure\".\n\n\n\n\nBtw., it would be safer (and save a little space) to remove the M4RI source tree from the PolyBoRi *spkg*.",
    "created_at": "2011-10-08T02:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126639",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:127 AlexanderDreyer]:
> I just realized that you work around is active *after* configuring. So trying to link against gd and m4ri fails, becuase the compiler is still broken at that point.
> 
> You may add your work around to `patches/custom.py` (which is executed earlier) as follows:

{{{
if os.environ.has_key("LD_LIBRARY_PATH"): 
  LIBPATH += os.environ["LD_LIBRARY_PATH"].split(os.pathsep)
}}}

FWIW, *both* adding

```python
if os.environ.has_key("LIBRARY_PATH"): 
    LIBPATH += os.environ["LIBRARY_PATH"].split(os.pathsep)
```
(`LIBRARY_PATH`, not `LD_LIBRARY_PATH`) in `patches/custom.py` as well as changing `patches/SConstruct` to

```python
# Get paths an related things from current environment
# todo: Are these settings sane in any case?
getenv = dict()
# for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH'] :
for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH', 'LIBRARY_PATH'] :
    try:
        getenv[key] = os.environ[key]
    except KeyError:
        pass
```
*independently* work for me, i.e., in both cases the build succeeds, and the GD and M4RI libraries are found by "Configure".




Btw., it would be safer (and save a little space) to remove the M4RI source tree from the PolyBoRi *spkg*.



---

archive/issue_comments_126640.json:
```json
{
    "body": "Replying to [comment:131 leif]:\n> FWIW, *both* adding\n> \n> ```\n> #!python\n> if os.environ.has_key(\"LIBRARY_PATH\"): \n>     LIBPATH += os.environ[\"LIBRARY_PATH\"].split(os.pathsep)\n> ```\n> (`LIBRARY_PATH`, not `LD_LIBRARY_PATH`) in `patches/custom.py` as well as changing `patches/SConstruct` to\n> \n> ```\n> #!python\n> # Get paths an related things from current environment\n> # todo: Are these settings sane in any case?\n> getenv = dict()\n> # for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH'] :\n> for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH', 'LIBRARY_PATH'] :\n>     try:\n>         getenv[key] = os.environ[key]\n>     except KeyError:\n>         pass\n> ```\n> *independently* work for me, i.e., in both cases the build succeeds, and the GD and M4RI libraries are found by \"Configure\".\n\nExcellent! So this is in fact #11906, we can continue there.\n\n> Btw., it would be safer (and save a little space) to remove the M4RI source tree from the PolyBoRi *spkg*.\n\nGood idea!",
    "created_at": "2011-10-08T19:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126640",
    "user": "https://github.com/alexanderdreyer"
}
```

Replying to [comment:131 leif]:
> FWIW, *both* adding
> 
> ```
> #!python
> if os.environ.has_key("LIBRARY_PATH"): 
>     LIBPATH += os.environ["LIBRARY_PATH"].split(os.pathsep)
> ```
> (`LIBRARY_PATH`, not `LD_LIBRARY_PATH`) in `patches/custom.py` as well as changing `patches/SConstruct` to
> 
> ```
> #!python
> # Get paths an related things from current environment
> # todo: Are these settings sane in any case?
> getenv = dict()
> # for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH'] :
> for key in ['PATH', 'HOME', 'LD_LIBRARY_PATH', 'LIBRARY_PATH'] :
>     try:
>         getenv[key] = os.environ[key]
>     except KeyError:
>         pass
> ```
> *independently* work for me, i.e., in both cases the build succeeds, and the GD and M4RI libraries are found by "Configure".

Excellent! So this is in fact #11906, we can continue there.

> Btw., it would be safer (and save a little space) to remove the M4RI source tree from the PolyBoRi *spkg*.

Good idea!



---

archive/issue_comments_126641.json:
```json
{
    "body": "Replying to [comment:132 AlexanderDreyer]:\n> Replying to [comment:131 leif]:\n> > Btw., it would be safer (and save a little space) to remove the M4RI source tree from the PolyBoRi *spkg*.\n\n> Good idea!\n\nCf. #9472... ;-)",
    "created_at": "2011-10-08T20:33:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126641",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:132 AlexanderDreyer]:
> Replying to [comment:131 leif]:
> > Btw., it would be safer (and save a little space) to remove the M4RI source tree from the PolyBoRi *spkg*.

> Good idea!

Cf. #9472... ;-)



---

archive/issue_events_030352.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-16T15:45:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11403#event-30352"
}
```



---

archive/issue_comments_126642.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-11-05T18:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126642",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_126643.json:
```json
{
    "body": "The file `sage/rings/polynomial/pbori.pyx` fails to compile with Cython-0.15 (#11761) because Cython is more strict about undeclared variables.  Since Cython-0.15 is likely to be merged before or at the same time with this ticket, this should be fixed.\n\n```\nError compiling Cython file:\n------------------------------------------------------------\n...\n            ...\n            TypeError: argument must be a BooleanPolynomial.\n        \"\"\"\n        from polybori import red_tail\n        if not I:\n            return g\n                   ^\n------------------------------------------------------------\n\nsage/rings/polynomial/pbori.pyx:4538:20: local variable 'g' referenced before assignment\n```",
    "created_at": "2011-11-05T18:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126643",
    "user": "https://github.com/jdemeyer"
}
```

The file `sage/rings/polynomial/pbori.pyx` fails to compile with Cython-0.15 (#11761) because Cython is more strict about undeclared variables.  Since Cython-0.15 is likely to be merged before or at the same time with this ticket, this should be fixed.

```
Error compiling Cython file:
------------------------------------------------------------
...
            ...
            TypeError: argument must be a BooleanPolynomial.
        """
        from polybori import red_tail
        if not I:
            return g
                   ^
------------------------------------------------------------

sage/rings/polynomial/pbori.pyx:4538:20: local variable 'g' referenced before assignment
```



---

archive/issue_comments_126644.json:
```json
{
    "body": "Indeed, the line in question was buggy. So I corrected it and added a suitable doctest:\n\n```diff\ndiff --git a/sage/rings/polynomial/pbori.pyx b/sage/rings/polynomial/pbori.pyx\n--- a/sage/rings/polynomial/pbori.pyx\n+++ b/sage/rings/polynomial/pbori.pyx\n@@ -4516,7 +4516,9 @@\n             0\n             sage: p.reduce(I)\n             x1*x2*x3 + x2\n-\n+            sage: p.reduce([])\n+            x0*x1*x2 + x0*x1*x3 + x0*x2*x3 + x2\n+\n         .. note::\n\n            If this function is called repeatedly with the same I then\n@@ -4535,7 +4537,7 @@\n         \"\"\"\n         from polybori import red_tail\n         if not I:\n-            return g\n+            return self\n         if PY_TYPE_CHECK(I, BooleanPolynomialIdeal):\n             I = I.gens()\n         first = I[0]\n\n\n```",
    "created_at": "2011-11-05T19:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126644",
    "user": "https://github.com/alexanderdreyer"
}
```

Indeed, the line in question was buggy. So I corrected it and added a suitable doctest:

```diff
diff --git a/sage/rings/polynomial/pbori.pyx b/sage/rings/polynomial/pbori.pyx
--- a/sage/rings/polynomial/pbori.pyx
+++ b/sage/rings/polynomial/pbori.pyx
@@ -4516,7 +4516,9 @@
             0
             sage: p.reduce(I)
             x1*x2*x3 + x2
-
+            sage: p.reduce([])
+            x0*x1*x2 + x0*x1*x3 + x0*x2*x3 + x2
+
         .. note::

            If this function is called repeatedly with the same I then
@@ -4535,7 +4537,7 @@
         """
         from polybori import red_tail
         if not I:
-            return g
+            return self
         if PY_TYPE_CHECK(I, BooleanPolynomialIdeal):
             I = I.gens()
         first = I[0]


```



---

archive/issue_comments_126645.json:
```json
{
    "body": "Attachment [polybori-0.8.0.p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0.p1.patch) by @alexanderdreyer created at 2011-11-05 19:38:43\n\nPatch rebased to Sage 4.7.2 alpha3 (+ deps), fixed cygwin 0.15 issue",
    "created_at": "2011-11-05T19:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126645",
    "user": "https://github.com/alexanderdreyer"
}
```

Attachment [polybori-0.8.0.p1.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0.p1.patch) by @alexanderdreyer created at 2011-11-05 19:38:43

Patch rebased to Sage 4.7.2 alpha3 (+ deps), fixed cygwin 0.15 issue



---

archive/issue_comments_126646.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-05T19:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126646",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126647.json:
```json
{
    "body": "I uploaded a revised patch (with the same name).",
    "created_at": "2011-11-05T19:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126647",
    "user": "https://github.com/alexanderdreyer"
}
```

I uploaded a revised patch (with the same name).



---

archive/issue_comments_126648.json:
```json
{
    "body": "Something seems to have gone wrong with the rebased patch:\n\nI\n* took a fresh 4.7.2, \n* installed polybori-0.8.0.p1.spkg and\n* applied [attachment:polybori-0.8.0.p1.patch]\n\nThis gave me a few hunks and one conflict in PolynomialConstruct which I fixed. While it now compiles I get these failures:\n\n```\nFile \"/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx\", line 3859:\n    sage: loads(dumps(a)) == a\nException raised:\n    Traceback (most recent call last):\n    ...\n    AttributeError: ('sage.rings.polynomial.pbori.BooleanPolynomialRing' object has no attribute '_element_constructor_', <built-in function unpickle_BooleanPolynomial0>, (Boolean PolynomialRing in a, b, ([[2], [{{a}}]], Boolean PolynomialRing in a, b)))\n**********************************************************************\nFile \"/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx\", line 4487:\n    sage: PolynomialConstruct()(1)\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: incomplete format\n**********************************************************************\nFile \"/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx\", line 7445:\n    sage: loads(dumps(a+b)) == a+b # indirect doctest\nException raised:\n    Traceback (most recent call last):\n    ...\n    AttributeError: ('sage.rings.polynomial.pbori.BooleanPolynomialRing' object has no attribute '_element_constructor_', <built-in function unpickle_BooleanPolynomial0>, (Boolean PolynomialRing in a, b, c, d, ([[2], [{{a}, {b}}, {{b}}]], Boolean PolynomialRing in a, b, c, d)))\n**********************************************************************\nFile \"/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx\", line 7459:\n    sage: loads(dumps(a+b)) == a+b # indirect doctest\nException raised:\n    Traceback (most recent call last):\n    ...\n    AttributeError: ('sage.rings.polynomial.pbori.BooleanPolynomialRing' object has no attribute '_element_constructor_', <built-in function unpickle_BooleanPolynomial0>, (Boolean PolynomialRing in a, b, c, d, ([[2], [{{a}, {b}}, {{b}}]], Boolean PolynomialRing in a, b, c, d)))\n**********************************************************************\n```\n\nSo something went wrong and Alexander's element_constructor fixes didn't make it into this patch?",
    "created_at": "2011-11-07T11:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126648",
    "user": "https://github.com/malb"
}
```

Something seems to have gone wrong with the rebased patch:

I
* took a fresh 4.7.2, 
* installed polybori-0.8.0.p1.spkg and
* applied [attachment:polybori-0.8.0.p1.patch]

This gave me a few hunks and one conflict in PolynomialConstruct which I fixed. While it now compiles I get these failures:

```
File "/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx", line 3859:
    sage: loads(dumps(a)) == a
Exception raised:
    Traceback (most recent call last):
    ...
    AttributeError: ('sage.rings.polynomial.pbori.BooleanPolynomialRing' object has no attribute '_element_constructor_', <built-in function unpickle_BooleanPolynomial0>, (Boolean PolynomialRing in a, b, ([[2], [{{a}}]], Boolean PolynomialRing in a, b)))
**********************************************************************
File "/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx", line 4487:
    sage: PolynomialConstruct()(1)
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: incomplete format
**********************************************************************
File "/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx", line 7445:
    sage: loads(dumps(a+b)) == a+b # indirect doctest
Exception raised:
    Traceback (most recent call last):
    ...
    AttributeError: ('sage.rings.polynomial.pbori.BooleanPolynomialRing' object has no attribute '_element_constructor_', <built-in function unpickle_BooleanPolynomial0>, (Boolean PolynomialRing in a, b, c, d, ([[2], [{{a}, {b}}, {{b}}]], Boolean PolynomialRing in a, b, c, d)))
**********************************************************************
File "/opt/sage-4.7.2-polybori-0.8/devel/sage/sage/rings/polynomial/pbori.pyx", line 7459:
    sage: loads(dumps(a+b)) == a+b # indirect doctest
Exception raised:
    Traceback (most recent call last):
    ...
    AttributeError: ('sage.rings.polynomial.pbori.BooleanPolynomialRing' object has no attribute '_element_constructor_', <built-in function unpickle_BooleanPolynomial0>, (Boolean PolynomialRing in a, b, c, d, ([[2], [{{a}, {b}}, {{b}}]], Boolean PolynomialRing in a, b, c, d)))
**********************************************************************
```

So something went wrong and Alexander's element_constructor fixes didn't make it into this patch?



---

archive/issue_comments_126649.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-11-07T11:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126649",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_126650.json:
```json
{
    "body": "Replying to [comment:138 malb]:\n> Something seems to have gone wrong with the rebased patch:\n> \n> I\n> * took a fresh 4.7.2, \n> * installed polybori-0.8.0.p1.spkg and\n> * applied [attachment:polybori-0.8.0.p1.patch]\n\n\nDid you apply the dependency #9138?",
    "created_at": "2011-11-07T13:43:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126650",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:138 malb]:
> Something seems to have gone wrong with the rebased patch:
> 
> I
> * took a fresh 4.7.2, 
> * installed polybori-0.8.0.p1.spkg and
> * applied [attachment:polybori-0.8.0.p1.patch]


Did you apply the dependency #9138?



---

archive/issue_comments_126651.json:
```json
{
    "body": "Ha, no! Sorry for the noise then.",
    "created_at": "2011-11-07T14:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126651",
    "user": "https://github.com/malb"
}
```

Ha, no! Sorry for the noise then.



---

archive/issue_comments_126652.json:
```json
{
    "body": "Works as advertised, but I didn't try it with the new Cython yet.",
    "created_at": "2011-11-07T18:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126652",
    "user": "https://github.com/malb"
}
```

Works as advertised, but I didn't try it with the new Cython yet.



---

archive/issue_comments_126653.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-07T18:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126653",
    "user": "https://github.com/malb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_126654.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-09T12:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126654",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126655.json:
```json
{
    "body": "Works with Sage 4.8.alpha1.",
    "created_at": "2011-11-09T12:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126655",
    "user": "https://github.com/malb"
}
```

Works with Sage 4.8.alpha1.



---

archive/issue_comments_126656.json:
```json
{
    "body": "Could you re-export the patch with a username added?  Maybe you need to create a `$HOME/.hgrc` file?  See instructions at [http://sagemath.org/doc/developer/walk_through.html#submitting-a-change](http://sagemath.org/doc/developer/walk_through.html#submitting-a-change)",
    "created_at": "2011-11-09T20:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126656",
    "user": "https://github.com/jdemeyer"
}
```

Could you re-export the patch with a username added?  Maybe you need to create a `$HOME/.hgrc` file?  See instructions at [http://sagemath.org/doc/developer/walk_through.html#submitting-a-change](http://sagemath.org/doc/developer/walk_through.html#submitting-a-change)



---

archive/issue_comments_126657.json:
```json
{
    "body": "Thank for pointing this out. I wasn't aware, that `hg`'s `mq` doesn't write the username into the patch header. Now, I regenerated the patch using `hg export tip`.",
    "created_at": "2011-11-10T00:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126657",
    "user": "https://github.com/alexanderdreyer"
}
```

Thank for pointing this out. I wasn't aware, that `hg`'s `mq` doesn't write the username into the patch header. Now, I regenerated the patch using `hg export tip`.



---

archive/issue_comments_126658.json:
```json
{
    "body": "`@`jdemeyer Since #9138 (and its dependencies) is now about to enter Sage 5.0, could we change the milestone to sage-5.0 here? What do you thing?",
    "created_at": "2011-12-09T23:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126658",
    "user": "https://github.com/alexanderdreyer"
}
```

`@`jdemeyer Since #9138 (and its dependencies) is now about to enter Sage 5.0, could we change the milestone to sage-5.0 here? What do you thing?



---

archive/issue_events_030353.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-09T23:56:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11403#event-30353"
}
```



---

archive/issue_events_030354.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-09T23:56:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11403#event-30354"
}
```



---

archive/issue_comments_126659.json:
```json
{
    "body": "Rebased to latest #9138",
    "created_at": "2012-01-17T16:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126659",
    "user": "https://github.com/jdemeyer"
}
```

Rebased to latest #9138



---

archive/issue_comments_126660.json:
```json
{
    "body": "Attachment [polybori-0.8.0.p1.2.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0.p1.2.patch) by @jdemeyer created at 2012-01-18 08:15:32",
    "created_at": "2012-01-18T08:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126660",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [polybori-0.8.0.p1.2.patch](tarball://root/attachments/some-uuid/ticket11575/polybori-0.8.0.p1.2.patch) by @jdemeyer created at 2012-01-18 08:15:32



---

archive/issue_comments_126661.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-01-18T08:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11403#issuecomment-126661",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_030355.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-18T08:15:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11403",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11403#event-30355"
}
```
