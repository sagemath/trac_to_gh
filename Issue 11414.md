# Issue 11414: bug in p-adic extension norm method

Issue created by migration from https://trac.sagemath.org/ticket/11586

Original creator: was

Original creation time: 2011-07-11 11:04:02

Assignee: roed


```
R.<x> = QQ[]
f = x^2 + 3*x + 1
K = Qp(7)
M.<a> = K.extension(f)
M(7).norm()
```

The above outputs `1 + O(7^20)`, which is completely wrong.  The norm should be `7^2 + O(7^20)`, I think -- anyways, it should be divisible by 7. 

The problem is that the actual code for the norm, which ones sees by typing `a.norm??` assumes that the generator for M is in fact a generator for the maximal ideal of the ring of integers.  However, this assumption is just completely false. 

Typing `a.norm???` we see

```
...
    norm_of_uniformizer = (-1)**self.parent().degree() * self.parent().defining_polynomial()[0]
    if self.valuation() == 0:
        return self.parent().ground_ring()(self.unit_part().matrix_mod_pn().det())
    else:
        return self.parent().ground_ring()(self.unit_part().matrix_mod_pn().det()) * norm_of_uniformizer**self.valuation()
}}}    

The above is wrong as mentioned above.  Moreover, it is nonoptimal in that norm_of_uniformizer is computed but never used in the case when `self.valuation()==0`.

This bug caused some confusion when computing with p-adic L-series for a research paper...


---

Attachment


---

Comment by roed created at 2011-07-13 06:20:13

Changing status from new to needs_review.


---

Comment by roed created at 2011-07-13 06:20:13

Changing keywords from "" to "padic".


---

Comment by roed created at 2011-07-13 06:20:13

Sorry about that.  The attached patch should fix the problem (note that you need to apply #8241 first).


---

Comment by jen created at 2011-08-24 19:09:15

Changing status from needs_review to positive_review.


---

Comment by jen created at 2011-08-24 19:09:15

Great; this fixes the bug. All tests pass!


---

Comment by leif created at 2011-09-08 14:37:49

Make someone review #8241...


---

Comment by davidloeffler created at 2011-09-19 09:47:59

Isn't this what we have a milestone "sage-pending" for?


---

Comment by leif created at 2011-09-19 14:10:39

Replying to [comment:6 davidloeffler]:
> Isn't this what we have a milestone "sage-pending" for?

I personally don't use "sage-pending" for _that_ situation, since my script does dependency checking, so won't attempt to merge it, but considers it for inclusion, i.e., I'll see that it has positive review, and all of its dependencies with their state.

My interpretation (or use) of "sage-pending" is to postpone tickets for _other_ reasons, so I currently only see that they're postponed, and don't consider them further.

I thought this was the original intent, to have some "formal" way to plan which tickets get merged when during management of a specific release, also since we don't have milestones for devel releases.


---

Comment by jdemeyer created at 2012-03-23 15:19:21

Resolution: fixed
