# Issue 13832: gap_console() fails

Issue created by migration from Trac.

Original creator: gtoal

Original creation time: 2013-01-29 21:54:10

Assignee: tbd

Keywords: gap.py

I'm in IT support at a University and I was asked to install SAGE a few days ago for one of our mathematicians.  There didn't seem to be a suitable binary so I built from source as per http://www.sagemath.org/doc/installation/source.html using the current official release. ("Sage Version 5.5, Release Date: 2012-12-22",
"GAP4, Version: 4.4.12 of 17-Dec-2008, x86_64-unknown-linux-gnu-gcc")

When running sage, we found that the gap_console() command failed with symptoms identical to what is reported here:

  https://groups.google.com/forum/?fromgroups=#!topic/sage-support/bfswsbOuHn8

Although that ticket refers to a solution ("Fixed in http://trac.sagemath.org/13211") I wasn't able to locate the relevant patch or any other details at the latter address, just a comment "Also gap_console() was broken. Fixed it and added a meaningful doctest."

It may have slipped by regression testing as it is still present in the source.  I tracked it down and the cause is that when the command line to call gap is generated, there is a space missing between the "-L <workspace>" option and the following console.g script name.

The problem is in gap.py, and can be fixed in two ways.

1) if you prefer to consistently plant a space after every command-line item, then change the line

```C
             return "%s -L %s"%(gap_cmd, WORKSPACE), False
```

to

```C
             return "%s -L %s "%(gap_cmd, WORKSPACE), False
```

or

2) if you would rather add the spaces before each item, then modify

```C
    cmd, _ = gap_command(use_workspace_cache=use_workspace_cache)
    cmd += os.path.join(SAGE_EXTCODE,'gap','console.g')
    os.system(cmd)
```

to

```C
    cmd, _ = gap_command(use_workspace_cache=use_workspace_cache)
    cmd += ' '
    cmd += os.path.join(SAGE_EXTCODE,'gap','console.g')
    os.system(cmd)
```

(Personally I prefer the first option)

Could you also add a regression test to see that this doesn't come up
again please?


thanks,


Graham



---

Comment by aapitzsch created at 2014-08-19 16:50:49

No problems here with `gap_console()` command.


---

Comment by aapitzsch created at 2014-08-19 16:50:49

Changing status from new to needs_review.


---

Comment by kcrisman created at 2014-10-22 18:28:16

Changing status from needs_review to needs_info.


---

Comment by kcrisman created at 2014-10-22 18:28:16

To the original poster:
* If you look at http://trac.sagemath.org/attachment/ticket/13211/trac_13211_fix_gap_doctests_vb.patch and search for `gap_console()` you will see what is meant by this.  I agree that the reference was quite obscure.  It was fixed by simply making the workspace cache always be false.
* Secondly, this was merged only in Sage 5.6.beta1, so I think your release wouldn't have had this in any case.  Have you tried a newer version since? Thanks1

Please let us know if your problem is now fixed!  Hopefully this has done so, even though we haven't implemented your suggestion as to spaces.  Would that still be useful?


---

Comment by jdemeyer created at 2015-03-13 10:08:57

Changing status from needs_info to positive_review.


---

Comment by jdemeyer created at 2015-03-13 10:08:57

Let's assume this is fixed by #13211.


---

Comment by vbraun created at 2015-03-17 18:19:31

Resolution: fixed
