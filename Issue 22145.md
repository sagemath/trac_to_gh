# Issue 22145: Fix facade option for DisjointUnionEnumeratedSets

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2017-02-14 23:07:45

CC:  jdemeyer mmezzarobba nthiery

Currently, `DisjointUnionEnumeratedSets` has an option to be a facade parent, but the category framework, and hence the coercion framework, does not know it is a facade parent. This can lead to test suite failures and some other unexpected behaviors, such as not being able to create elements. In particular, this causes problems noted on #22029.


---

Comment by tscrim created at 2017-02-14 23:08:14

New commits:


---

Comment by tscrim created at 2017-02-14 23:08:14

Changing status from new to needs_review.


---

Comment by git created at 2017-02-14 23:09:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-02-14 23:10:32

Waiting for the bots to run all of the tests.


---

Comment by git created at 2017-02-17 02:50:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by andrew.mathas created at 2017-02-17 02:51:35

Looks good to me. All doc-tests past. I added one more doctest, which shows that this patch fixes an issue that I care about, and a missing `indirect doctest` tag to stop `sage -coverage` from complaining. I have not checked that the documentation builds but this should be OK because the changes only affect underscore methods. (There is no need to change the documentation because this patch ensures that `DisjointUnionEnumeratedSets` behaves as it is supposed to.)

If you are happy with my changes then please set to a positive review.


---

Comment by git created at 2017-02-17 06:22:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-02-17 06:24:24

Thank you for looking at this. I made some formatting corrections to your changes, and I added a quick note about the wrapped elements from our discussion on sage-combinat-devel. If my changes are good, then positive review.


---

Comment by andrew.mathas created at 2017-02-17 08:06:53

Changing status from needs_review to positive_review.


---

Comment by andrew.mathas created at 2017-02-17 08:06:53

Happy with this. Looks good -> positive review.


---

Comment by tscrim created at 2017-02-17 19:36:21

Thank you again.


---

Comment by vbraun created at 2017-02-22 15:14:06

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-02-22 15:14:14

Various test failures


---

Comment by git created at 2017-02-22 16:20:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-02-22 16:23:18

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2017-02-22 16:23:18

The problem comes from the fact that coercion of the E<sub>6</sub> crystal is a bit too permissive. However, properly fixing this issue would likely be expensive in terms of computations, which I don't really want to do at this stage. Instead, the workaround is actually something we should do IMO: test if the element's parents is one of the parents used in the construction.


---

Comment by chapoton created at 2017-02-23 15:15:14

still one failing doctest, see bot report


---

Comment by git created at 2017-02-23 15:44:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-02-23 15:45:01

Whoops, thought I got them all...


---

Comment by chapoton created at 2017-02-25 07:18:09

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2017-02-25 07:18:09

ok, let it be


---

Comment by vbraun created at 2017-03-01 18:51:10

Resolution: fixed
