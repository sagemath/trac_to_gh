# Issue 13921: module_morphism is too liberal on inverting

archive/issues_013921.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  sage-combinat\n\nKeywords: module morphism, inverse\n\nNot saying this is an actual issue, since it seems to depend on bad user input.\n\nSince I don't know how to reliably do function declarations in the console, I'm making a py file and then importing it:\n\nPY file:\n\n\n```\ndef diag_func(p):\n      if len(p)==0: return 1\n      else: return p[0]\n```\n\n\nConsole:\n\n\n```\nsage: attach ../diagbug.py #file quoted above\nsage: X = CombinatorialFreeModule(ZZ, Partitions(), prefix='x'); x = X.basis();\nsage: Y = CombinatorialFreeModule(ZZ, Partitions(), prefix='y'); y = Y.basis()\nsage: xty = X.module_morphism(diagonal=diag_func, codomain=Y)\nsage: ytx = ~xty                \nsage: ytx(y[Partition([3,2,1])])\n1/3*x[[3, 2, 1]]\nsage: ytx(y[Partition([3,2,1])]).parent()\nFree module generated by Partitions over Integer Ring\n```\n\n\nSince I'm working over ZZ, I'd have expected the \"ytx(y[Partition([3,2,1])])\" to throw an error, but definitely I'd have expected the parent to not be defined over ZZ.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14125\n\n",
    "created_at": "2013-02-14T22:40:15Z",
    "labels": [
        "linear algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "module_morphism is too liberal on inverting",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13921",
    "user": "darij"
}
```
Assignee: jason, was

CC:  sage-combinat

Keywords: module morphism, inverse

Not saying this is an actual issue, since it seems to depend on bad user input.

Since I don't know how to reliably do function declarations in the console, I'm making a py file and then importing it:

PY file:


```
def diag_func(p):
      if len(p)==0: return 1
      else: return p[0]
```


Console:


```
sage: attach ../diagbug.py #file quoted above
sage: X = CombinatorialFreeModule(ZZ, Partitions(), prefix='x'); x = X.basis();
sage: Y = CombinatorialFreeModule(ZZ, Partitions(), prefix='y'); y = Y.basis()
sage: xty = X.module_morphism(diagonal=diag_func, codomain=Y)
sage: ytx = ~xty                
sage: ytx(y[Partition([3,2,1])])
1/3*x[[3, 2, 1]]
sage: ytx(y[Partition([3,2,1])]).parent()
Free module generated by Partitions over Integer Ring
```


Since I'm working over ZZ, I'd have expected the "ytx(y[Partition([3,2,1])])" to throw an error, but definitely I'd have expected the parent to not be defined over ZZ.

Issue created by migration from https://trac.sagemath.org/ticket/14125


