# Issue 16427: Add a finite field implementation using FLINT's fq[_zech] module

archive/issues_016427.json:
```json
{
    "body": "CC:  @defeo @pjbruin erousseau\n\nKeywords: flint finite field\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16664\n\n",
    "created_at": "2014-07-16T13:39:17Z",
    "labels": [
        "finite rings",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Add a finite field implementation using FLINT's fq[_zech] module",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16427",
    "user": "jpflori"
}
```
CC:  @defeo @pjbruin erousseau

Keywords: flint finite field



Issue created by migration from https://trac.sagemath.org/ticket/16664





---

archive/issue_comments_215846.json:
```json
{
    "body": "I've set up something at `u/jpflori/flint_fq`.\nCompletely incomplete though.",
    "created_at": "2014-07-16T13:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215846",
    "user": "jpflori"
}
```

I've set up something at `u/jpflori/flint_fq`.
Completely incomplete though.



---

archive/issue_comments_215847.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-07-16T13:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215847",
    "user": "jpflori"
}
```

New commits:



---

archive/issue_comments_215848.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T12:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215848",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215849.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T12:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215849",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215850.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T13:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215850",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215851.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T15:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215851",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215852.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T15:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215852",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215853.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T15:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215853",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215854.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-18T13:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215854",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215855.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-18T13:46:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215855",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215856.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-18T13:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215856",
    "user": "jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_215857.json:
```json
{
    "body": "Not thouroughly tested but it at least passes its testsuite.\n\nComments welcome.",
    "created_at": "2014-07-18T13:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215857",
    "user": "jpflori"
}
```

Not thouroughly tested but it at least passes its testsuite.

Comments welcome.



---

archive/issue_comments_215858.json:
```json
{
    "body": "I've also pushed another branch including an implem using the fq_nmod type at ``u/jpflori/flint_fq_nmod``.\nNote that you'll need a FLINT version including my latest git commits from https://github.com/jpflori/flint2\nAt least now, FLINT seems to provide implementation faster than PARI for basic arithmetic over all ranges.\n\nDoing the same thing for the fq_zech type should be as easy as for the fq_nmod type.\nBut there is so much code duplication that it should definitely be templated (that should already be done for the fq and fq_nmod types alone).\nAnd not sure that the fq_zech type will be so useful as we have Givaro.",
    "created_at": "2014-07-21T15:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215858",
    "user": "jpflori"
}
```

I've also pushed another branch including an implem using the fq_nmod type at ``u/jpflori/flint_fq_nmod``.
Note that you'll need a FLINT version including my latest git commits from https://github.com/jpflori/flint2
At least now, FLINT seems to provide implementation faster than PARI for basic arithmetic over all ranges.

Doing the same thing for the fq_zech type should be as easy as for the fq_nmod type.
But there is so much code duplication that it should definitely be templated (that should already be done for the fq and fq_nmod types alone).
And not sure that the fq_zech type will be so useful as we have Givaro.



---

archive/issue_comments_215859.json:
```json
{
    "body": "Still depends on git version of FLINT, my changes are now merged upstream.\n----\nNew commits:",
    "created_at": "2014-07-29T12:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215859",
    "user": "jpflori"
}
```

Still depends on git version of FLINT, my changes are now merged upstream.
----
New commits:



---

archive/issue_comments_215860.json:
```json
{
    "body": "I'll do the templating stuff in a later tickets.\nIt really needs more thoughts than what I already did here, especially if I want to convert some other implementations to it.",
    "created_at": "2014-07-29T12:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215860",
    "user": "jpflori"
}
```

I'll do the templating stuff in a later tickets.
It really needs more thoughts than what I already did here, especially if I want to convert some other implementations to it.



---

archive/issue_comments_215861.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-18T16:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215861",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215862.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-19T12:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215862",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215863.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-19T13:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215863",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215864.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-19T15:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215864",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215865.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-19T19:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215865",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215866.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-21T10:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215866",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215867.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-22T13:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215867",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215868.json:
```json
{
    "body": "Needs to be merged.",
    "created_at": "2014-08-29T12:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215868",
    "user": "@jdemeyer"
}
```

Needs to be merged.



---

archive/issue_comments_215869.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-29T12:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215869",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_215870.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-01T13:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215870",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215871.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-01T13:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215871",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215872.json:
```json
{
    "body": "Should merge cleanly now.\n\nStill needs a git version of FLINT though.",
    "created_at": "2014-09-01T13:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215872",
    "user": "jpflori"
}
```

Should merge cleanly now.

Still needs a git version of FLINT though.



---

archive/issue_comments_215873.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-14T16:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215873",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215874.json:
```json
{
    "body": "Could you please explicitly list in \"Dependencies\" the tickets which are merged in this branch? I'm a bit lost in the git forest.",
    "created_at": "2014-10-15T08:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215874",
    "user": "@jdemeyer"
}
```

Could you please explicitly list in "Dependencies" the tickets which are merged in this branch? I'm a bit lost in the git forest.



---

archive/issue_comments_215875.json:
```json
{
    "body": "I don't really like the fact that `element_flint_fq_nmod.pyx` and `element_flint_fq.pyx` are almost identical. Wouldn't it make sense to implement a common base class for them or use templating techniques?",
    "created_at": "2014-10-15T08:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215875",
    "user": "@jdemeyer"
}
```

I don't really like the fact that `element_flint_fq_nmod.pyx` and `element_flint_fq.pyx` are almost identical. Wouldn't it make sense to implement a common base class for them or use templating techniques?



---

archive/issue_comments_215876.json:
```json
{
    "body": "Also, be aware of #16983 and #16855 which could potentially conflict.",
    "created_at": "2014-10-15T08:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215876",
    "user": "@jdemeyer"
}
```

Also, be aware of #16983 and #16855 which could potentially conflict.



---

archive/issue_comments_215877.json:
```json
{
    "body": "This is really work in progress, so it's not really ready for review.\nI thought very hard of templating but it was too much work for the time I had.\nNote that the `pari_ffelt` class at least (and maybe the `pari_mod` one) is also very similar, so the templating/common base class should surely cover a wider area.\n\nI'll fill in the dependencies asap.",
    "created_at": "2014-10-15T08:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215877",
    "user": "jpflori"
}
```

This is really work in progress, so it's not really ready for review.
I thought very hard of templating but it was too much work for the time I had.
Note that the `pari_ffelt` class at least (and maybe the `pari_mod` one) is also very similar, so the templating/common base class should surely cover a wider area.

I'll fill in the dependencies asap.



---

archive/issue_comments_215878.json:
```json
{
    "body": "Replying to [comment:32 jpflori]:\n> This is really work in progress, so it's not really ready for review.\nSure, I just wanted to give some comments based on a first glance.",
    "created_at": "2014-10-15T08:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215878",
    "user": "@jdemeyer"
}
```

Replying to [comment:32 jpflori]:
> This is really work in progress, so it's not really ready for review.
Sure, I just wanted to give some comments based on a first glance.



---

archive/issue_comments_215879.json:
```json
{
    "body": "Replying to [comment:32 jpflori]:\n> Note that the `pari_ffelt` class at least (and maybe the `pari_mod` one) is also very similar, so the templating/common base class should surely cover a wider area.\nPerhaps. I noticed you moved some functions to `element_base.pyx` in your branch, could that be made into a separate ticket?",
    "created_at": "2014-10-15T08:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215879",
    "user": "@jdemeyer"
}
```

Replying to [comment:32 jpflori]:
> Note that the `pari_ffelt` class at least (and maybe the `pari_mod` one) is also very similar, so the templating/common base class should surely cover a wider area.
Perhaps. I noticed you moved some functions to `element_base.pyx` in your branch, could that be made into a separate ticket?



---

archive/issue_comments_215880.json:
```json
{
    "body": "Ok, I'll try to do that (because I do agree it would be the good way to go and feel guilty about my dirty commits).\nThere are also some other things related to the PARI FF implem that I'll try to move out of this ticket.",
    "created_at": "2014-10-15T08:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215880",
    "user": "jpflori"
}
```

Ok, I'll try to do that (because I do agree it would be the good way to go and feel guilty about my dirty commits).
There are also some other things related to the PARI FF implem that I'll try to move out of this ticket.



---

archive/issue_comments_215881.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2014-10-16T15:01:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215881",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_215882.json:
```json
{
    "body": "Groumpf, I accidently merged #17148 and #15015 into this one...\nNot really a problem as we'll probably have to wait for a proper FLINT 2.5 for this one, and that should come after the actual MPIR 2.7.0 release.",
    "created_at": "2014-10-16T15:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215882",
    "user": "jpflori"
}
```

Groumpf, I accidently merged #17148 and #15015 into this one...
Not really a problem as we'll probably have to wait for a proper FLINT 2.5 for this one, and that should come after the actual MPIR 2.7.0 release.



---

archive/issue_comments_215883.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-16T16:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215883",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215884.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-17T10:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215884",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215885.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-08T15:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215885",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215886.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-09T11:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215886",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215887.json:
```json
{
    "body": "I guess the dependencies are correct now.\n\nApart from bug fixing and heavy testing, the real question is whether I should try to make some code factoring/templating now.",
    "created_at": "2014-12-09T13:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215887",
    "user": "jpflori"
}
```

I guess the dependencies are correct now.

Apart from bug fixing and heavy testing, the real question is whether I should try to make some code factoring/templating now.



---

archive/issue_comments_215888.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-14T10:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215888",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215889.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-05T11:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215889",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215890.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-05T11:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215890",
    "user": "jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_215891.json:
```json
{
    "body": "Like I said before, I still don't like that the `fq` files are almost identical to the `fq_nmod` files.\n\nAnd instead of writing comments like\n\n```\n# JPF: the following should definitely go into element_base.pyx.\n```\n\njust do it (on a different ticket please, same for `def rational_reconstruction`",
    "created_at": "2015-06-05T12:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215891",
    "user": "@jdemeyer"
}
```

Like I said before, I still don't like that the `fq` files are almost identical to the `fq_nmod` files.

And instead of writing comments like

```
# JPF: the following should definitely go into element_base.pyx.
```

just do it (on a different ticket please, same for `def rational_reconstruction`



---

archive/issue_comments_215892.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-05T12:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215892",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215893.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-05T12:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215893",
    "user": "jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_215894.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-05T13:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215894",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215895.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-05T13:54:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215895",
    "user": "jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_215896.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-01T15:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215896",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215897.json:
```json
{
    "body": "`@`Jeroen: where would you put the distutils magic to simplify linking with flint?\nIn only one pxd file in `src/sage/libs/flint` which is included by all other ones?\nOr in each of them?",
    "created_at": "2015-07-01T15:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215897",
    "user": "jpflori"
}
```

`@`Jeroen: where would you put the distutils magic to simplify linking with flint?
In only one pxd file in `src/sage/libs/flint` which is included by all other ones?
Or in each of them?



---

archive/issue_comments_215898.json:
```json
{
    "body": "Replying to [comment:55 jpflori]:\n> `@`Jeroen: where would you put the distutils magic to simplify linking with flint?\n> In only one pxd file in `src/sage/libs/flint` which is included by all other ones?\n> Or in each of them?\n\nFirst of all, I would prefer to move all changes to `libs/flint` to a different ticket.\n\nIf you want `distutils` magic, I would put it in every `.pxd` file which defines library functions (in practice, this is probably all of them except `types.pxd`).\n\nNote #18837 which makes FLINT-related changes to `module_list.py`. The new ticket should probably depend on #18837.",
    "created_at": "2015-07-01T15:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215898",
    "user": "@jdemeyer"
}
```

Replying to [comment:55 jpflori]:
> `@`Jeroen: where would you put the distutils magic to simplify linking with flint?
> In only one pxd file in `src/sage/libs/flint` which is included by all other ones?
> Or in each of them?

First of all, I would prefer to move all changes to `libs/flint` to a different ticket.

If you want `distutils` magic, I would put it in every `.pxd` file which defines library functions (in practice, this is probably all of them except `types.pxd`).

Note #18837 which makes FLINT-related changes to `module_list.py`. The new ticket should probably depend on #18837.



---

archive/issue_comments_215899.json:
```json
{
    "body": "Another small comment: you can replace\n\n```\n    ctypedef struct X:\n        pass\n```\n\nby\n\n```\n    ctypedef struct X\n```\n",
    "created_at": "2015-07-01T15:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215899",
    "user": "@jdemeyer"
}
```

Another small comment: you can replace

```
    ctypedef struct X:
        pass
```

by

```
    ctypedef struct X
```




---

archive/issue_comments_215900.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-03T08:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215900",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215901.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-03T16:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215901",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215902.json:
```json
{
    "body": "Replying to [comment:56 jdemeyer]:\n> Replying to [comment:55 jpflori]:\n> > `@`Jeroen: where would you put the distutils magic to simplify linking with flint?\n> > In only one pxd file in `src/sage/libs/flint` which is included by all other ones?\n> > Or in each of them?\n> \n> First of all, I would prefer to move all changes to `libs/flint` to a different ticket.\nI only add new files needed by this ticket, I'm not sure it would make sense to add these files in another ticket.",
    "created_at": "2015-07-16T12:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215902",
    "user": "jpflori"
}
```

Replying to [comment:56 jdemeyer]:
> Replying to [comment:55 jpflori]:
> > `@`Jeroen: where would you put the distutils magic to simplify linking with flint?
> > In only one pxd file in `src/sage/libs/flint` which is included by all other ones?
> > Or in each of them?
> 
> First of all, I would prefer to move all changes to `libs/flint` to a different ticket.
I only add new files needed by this ticket, I'm not sure it would make sense to add these files in another ticket.



---

archive/issue_comments_215903.json:
```json
{
    "body": "Ok, there is also a slight modification to `types.h`.",
    "created_at": "2015-07-16T12:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215903",
    "user": "jpflori"
}
```

Ok, there is also a slight modification to `types.h`.



---

archive/issue_comments_215904.json:
```json
{
    "body": "Replying to [comment:57 jdemeyer]:\n> Another small comment: you can replace\n> {{{\n>     ctypedef struct X:\n>         pass\n> }}}\n> by\n> {{{\n>     ctypedef struct X\n> }}}\nNoted.\nNote though that the other types in `types.h` use the syntax with `pass`.\nSo I'm not sure if we should not modify all of them at once later.",
    "created_at": "2015-07-16T12:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215904",
    "user": "jpflori"
}
```

Replying to [comment:57 jdemeyer]:
> Another small comment: you can replace
> {{{
>     ctypedef struct X:
>         pass
> }}}
> by
> {{{
>     ctypedef struct X
> }}}
Noted.
Note though that the other types in `types.h` use the syntax with `pass`.
So I'm not sure if we should not modify all of them at once later.



---

archive/issue_comments_215905.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-16T12:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215905",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_215906.json:
```json
{
    "body": "Replying to [comment:60 jpflori]:\n> I only add new files needed by this ticket, I'm not sure it would make sense to add these files in another ticket.\n\nBut you were talking about adding `# distutils: libraries = flint`, weren't you? I would suggest to do this on a new ticket. So, when you're changing `libs/flint` anyway, you might as well add the new files too.",
    "created_at": "2015-07-17T10:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215906",
    "user": "@jdemeyer"
}
```

Replying to [comment:60 jpflori]:
> I only add new files needed by this ticket, I'm not sure it would make sense to add these files in another ticket.

But you were talking about adding `# distutils: libraries = flint`, weren't you? I would suggest to do this on a new ticket. So, when you're changing `libs/flint` anyway, you might as well add the new files too.



---

archive/issue_comments_215907.json:
```json
{
    "body": "Replying to [comment:64 jdemeyer]:\n> Replying to [comment:60 jpflori]:\n> > I only add new files needed by this ticket, I'm not sure it would make sense to add these files in another ticket.\n> \n> But you were talking about adding `# distutils: libraries = flint`, weren't you? I would suggest to do this on a new ticket. So, when you're changing `libs/flint` anyway, you might as well add the new files too.\nOh yes, the distutils part should definitely be done elsewhere.",
    "created_at": "2015-07-17T11:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215907",
    "user": "jpflori"
}
```

Replying to [comment:64 jdemeyer]:
> Replying to [comment:60 jpflori]:
> > I only add new files needed by this ticket, I'm not sure it would make sense to add these files in another ticket.
> 
> But you were talking about adding `# distutils: libraries = flint`, weren't you? I would suggest to do this on a new ticket. So, when you're changing `libs/flint` anyway, you might as well add the new files too.
Oh yes, the distutils part should definitely be done elsewhere.



---

archive/issue_comments_215908.json:
```json
{
    "body": "Hello,\n\nIn `_element_constructor_` the following case should not happen\n\n```\nif isinstance(x, self.element_class) and x.parent() is self:\n```\n\nas if `parent(x)` is `self` then this is catched by the `__call__` of `Parent`. See line 1080-1083 of `parent.pyx`\n\n```\n        cdef R = parent_c(x) \n        cdef bint no_extra_args = len(args) == 0 and len(kwds) == 0 \n        if R is self and no_extra_args: \n            return x\n```\n\n\nInstead of making `__nonzero__` relies on `is_unit` I would rather implement `__nonzero__` and call it in bot `is_unit` and `is_zero`. BTW for the latter this is what is in `Element.is_zero` by default, so you can even remove it. The reason why is that there is a special slot for `__nonzero__` in Python objects. So the fastest (Python) way to do things should be\n\n```\nif not my_element:\n    XYZ\n```\n\nand not\n\n```\nif my_element.is_zero():\n    XYZ\n```\n\n\nWhat are the status of the flint patches? Are there incorporated in flint-2.5? If that is so, it would make sense to first include it into Sage.\n\nVincent",
    "created_at": "2015-08-10T10:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215908",
    "user": "@videlec"
}
```

Hello,

In `_element_constructor_` the following case should not happen

```
if isinstance(x, self.element_class) and x.parent() is self:
```

as if `parent(x)` is `self` then this is catched by the `__call__` of `Parent`. See line 1080-1083 of `parent.pyx`

```
        cdef R = parent_c(x) 
        cdef bint no_extra_args = len(args) == 0 and len(kwds) == 0 
        if R is self and no_extra_args: 
            return x
```


Instead of making `__nonzero__` relies on `is_unit` I would rather implement `__nonzero__` and call it in bot `is_unit` and `is_zero`. BTW for the latter this is what is in `Element.is_zero` by default, so you can even remove it. The reason why is that there is a special slot for `__nonzero__` in Python objects. So the fastest (Python) way to do things should be

```
if not my_element:
    XYZ
```

and not

```
if my_element.is_zero():
    XYZ
```


What are the status of the flint patches? Are there incorporated in flint-2.5? If that is so, it would make sense to first include it into Sage.

Vincent



---

archive/issue_comments_215909.json:
```json
{
    "body": "Replying to [comment:66 vdelecroix]:\n> Hello,\n> \n> In `_element_constructor_` the following case should not happen\n> {{{\n> if isinstance(x, self.element_class) and x.parent() is self:\n> }}}\n> as if `parent(x)` is `self` then this is catched by the `__call__` of `Parent`. See line 1080-1083 of `parent.pyx`\n> {{{\n>         cdef R = parent_c(x) \n>         cdef bint no_extra_args = len(args) == 0 and len(kwds) == 0 \n>         if R is self and no_extra_args: \n>             return x\n> }}}\n> \n> Instead of making `__nonzero__` relies on `is_unit` I would rather implement `__nonzero__` and call it in bot `is_unit` and `is_zero`. BTW for the latter this is what is in `Element.is_zero` by default, so you can even remove it. The reason why is that there is a special slot for `__nonzero__` in Python objects. So the fastest (Python) way to do things should be\n> {{{\n> if not my_element:\n>     XYZ\n> }}}\n> and not\n> {{{\n> if my_element.is_zero():\n>     XYZ\n> }}}\nThanks, I'll have a look at both of these.\nNot that the code is mainly cpoied/pasted from the PARI wrapper by Peter Bruin.\nI'll also check the PARI wrapper.\nNote the PARI wrapper is Python rather than Cython (as we have already have a cython \"proxy\" for PARI elements).\n\n> \n> What are the status of the flint patches? Are there incorporated in flint-2.5? If that is so, it would make sense to first include it into Sage.\nI guess so.\nIntegrating flint 2.5 first is a good idea anyway.\nIt will also allow to use the lacking in flint 2.4 fq_div function.\n> \n> Vincent",
    "created_at": "2015-08-10T10:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215909",
    "user": "jpflori"
}
```

Replying to [comment:66 vdelecroix]:
> Hello,
> 
> In `_element_constructor_` the following case should not happen
> {{{
> if isinstance(x, self.element_class) and x.parent() is self:
> }}}
> as if `parent(x)` is `self` then this is catched by the `__call__` of `Parent`. See line 1080-1083 of `parent.pyx`
> {{{
>         cdef R = parent_c(x) 
>         cdef bint no_extra_args = len(args) == 0 and len(kwds) == 0 
>         if R is self and no_extra_args: 
>             return x
> }}}
> 
> Instead of making `__nonzero__` relies on `is_unit` I would rather implement `__nonzero__` and call it in bot `is_unit` and `is_zero`. BTW for the latter this is what is in `Element.is_zero` by default, so you can even remove it. The reason why is that there is a special slot for `__nonzero__` in Python objects. So the fastest (Python) way to do things should be
> {{{
> if not my_element:
>     XYZ
> }}}
> and not
> {{{
> if my_element.is_zero():
>     XYZ
> }}}
Thanks, I'll have a look at both of these.
Not that the code is mainly cpoied/pasted from the PARI wrapper by Peter Bruin.
I'll also check the PARI wrapper.
Note the PARI wrapper is Python rather than Cython (as we have already have a cython "proxy" for PARI elements).

> 
> What are the status of the flint patches? Are there incorporated in flint-2.5? If that is so, it would make sense to first include it into Sage.
I guess so.
Integrating flint 2.5 first is a good idea anyway.
It will also allow to use the lacking in flint 2.4 fq_div function.
> 
> Vincent



---

archive/issue_comments_215910.json:
```json
{
    "body": "Replying to [comment:67 jpflori]:\n> Replying to [comment:66 vdelecroix]:\n> > What are the status of the flint patches? Are there incorporated in flint-2.5? If that is so, it would make sense to first include it into Sage.\n> I guess so.\n> Integrating flint 2.5 first is a good idea anyway.\n> It will also allow to use the lacking in flint 2.4 fq_div function.\n\nThis is #19009 (needs review).",
    "created_at": "2015-08-10T22:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215910",
    "user": "@videlec"
}
```

Replying to [comment:67 jpflori]:
> Replying to [comment:66 vdelecroix]:
> > What are the status of the flint patches? Are there incorporated in flint-2.5? If that is so, it would make sense to first include it into Sage.
> I guess so.
> Integrating flint 2.5 first is a good idea anyway.
> It will also allow to use the lacking in flint 2.4 fq_div function.

This is #19009 (needs review).



---

archive/issue_comments_215911.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-14T18:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215911",
    "user": "@videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_215912.json:
```json
{
    "body": "Conflicts with the flint upgrade (#19009).",
    "created_at": "2015-08-14T18:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215912",
    "user": "@videlec"
}
```

Conflicts with the flint upgrade (#19009).



---

archive/issue_comments_215913.json:
```json
{
    "body": "Conflicts with 6.10.beta6. If you fix this conflict, I can easily merge #19646.",
    "created_at": "2015-11-29T21:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215913",
    "user": "@jdemeyer"
}
```

Conflicts with 6.10.beta6. If you fix this conflict, I can easily merge #19646.



---

archive/issue_comments_215914.json:
```json
{
    "body": "I guess the branch here is now completely broken.\nA more current implementation can be found at https://github.com/defeo/ffisom/",
    "created_at": "2017-06-06T11:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16427#issuecomment-215914",
    "user": "jpflori"
}
```

I guess the branch here is now completely broken.
A more current implementation can be found at https://github.com/defeo/ffisom/
