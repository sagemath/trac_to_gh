# Issue 24611: Implement join of polytopes

Issue created by migration from Trac.

Original creator: jipilab

Original creation time: 2018-02-26 22:14:37

CC:  vdelecroix moritz mkoeppe chapoton

Keywords: days93, polytope

From â€‹https://www.csun.edu/~ctoth/Handbook/chap15.pdf:

The join of two polytopes `P` (of dimension d) and `Q` (of dimension d') is the (d+d'+1)-polytope obtained as the convex hull of `P\cup Q` after
embedding P and Q in a space where their affine hulls are skew.


---

Comment by jipilab created at 2018-02-27 15:05:41

Changing status from new to needs_review.


---

Comment by jipilab created at 2018-02-27 15:05:41

New commits:


---

Comment by vdelecroix created at 2018-02-28 08:51:01

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2018-02-28 08:51:01

According to the developer guide:

- the docstring should start with a one line sentence. Then a line break, then a longer description.

- better than `- ``other`` -- a :class:`Polyhedron_base`.`, I would just use `- ``other`` -- a polyhedron`.

- there is no need to fill an OUTPUT section as it is already described before.


And I would like to see the definition of a "skew subspace".


This is not the proper thing to do

```
        try:
            new_ring = self.parent()._coerce_base_ring(other)
        except TypeError:
            raise TypeError("no common canonical parent for objects with parents: " + str(self.parent())
                     + " and " + str(other.parent()))
```

You should try to coerce the objects to a common parent as in

```
sage: C = polytopes.cube()
sage: I = polytopes.icosahedron()
sage: cm = get_coercion_model()
sage: cm.common_parent(C, I)
Polyhedra in (Number Field in sqrt5 with defining polynomial x^2 - 5)^3
```

And even simpler, you could use the decorator ``@`coerce_binop` from `sage.structure.element`.

Moreover, when you construct the resulting polytope you should just use directly the common parent.


---

Comment by git created at 2018-02-28 11:46:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2018-02-28 11:49:39

> According to the developer guide:
> 

Yes, you are right. I should read it again every season... I made the changes you suggested.
> 
> 
> And I would like to see the definition of a "skew subspace".
> 
I added a short definition.

> And even simpler, you could use the decorator ``@`coerce_binop` from `sage.structure.element`.

Unfortunately, doing the join changes the dimension, and hence the parents.

Merci!


---

Comment by jipilab created at 2018-02-28 11:50:26

I'll put you as a review if you don't mind... ;)


---

Comment by jipilab created at 2018-02-28 11:50:26

Changing status from needs_work to needs_review.


---

Comment by git created at 2018-03-06 16:19:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by moritz created at 2018-04-06 14:45:46

Changing status from needs_review to needs_work.


---

Comment by moritz created at 2018-04-06 14:45:46

This looks like a nice new feature! A few remarks:


 *  In the description:
 ... of the two polyhedron plus ... --> ... of the two polyhedra plus ...




 * I would be nice to have some more test, for example:

```
C = polytopes.hypercube(5)
S = Polyhedron([This is the Trac macro *1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1-macro))
C.join(S).is_combinatorially_isomorphic(C.pyramid())
```


 * You wrote the method such that it works also for unbounded polyhedra: this should be doctested for at least one unbounded polyhedron!

Also: see the remarks by Vincent above, they are only partially integrated. You didn't address the coercion question, or am I missing something?


---

Comment by jipilab created at 2018-04-06 17:15:51

Replying to [comment:9 moritz]:
> This looks like a nice new feature! A few remarks:
> 
> 
>  *  In the description:
>  ... of the two polyhedron plus ... --> ... of the two polyhedra plus ...
> 
> 
> 
> 
>  * I would be nice to have some more test, for example:
> {{{
> C = polytopes.hypercube(5)
> S = Polyhedron([This is the Trac macro *1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1-macro))
> C.join(S).is_combinatorially_isomorphic(C.pyramid())
> }}}
> 
>  * You wrote the method such that it works also for unbounded polyhedra: this should be doctested for at least one unbounded polyhedron!

Indeed, I added a test and an unbounded example.

> 
> Also: see the remarks by Vincent above, they are only partially integrated. You didn't address the coercion question, or am I missing something?

Coercion can not be used since the dimension is included in the parent of Polyhedron objects and they can be different and the output also has a different dimension:


```
sage: C = polytopes.cube()
sage: S = polytopes.hypercube(2)
sage: C.parent()
Polyhedra in ZZ^3
sage: S.parent()
Polyhedra in ZZ^2
sage: cm = get_coercion_model()
sage: cm.common_parent(C,S)
Traceback (most recent call last):
...
TypeError: no common canonical parent for objects with parents: 'Polyhedra in ZZ^3' and 'Polyhedra in ZZ^2'
```


That's the explanation of the short sentence I gave above...


---

Comment by git created at 2018-04-06 17:16:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2018-04-06 17:17:19

Changing status from needs_work to needs_review.


---

Comment by jipilab created at 2018-04-06 17:19:03

Changing status from needs_review to needs_work.


---

Comment by jipilab created at 2018-04-06 17:19:03

It still needs to be added to the quick tips of the tutorial.


---

Comment by git created at 2018-04-09 16:40:03

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by jipilab created at 2018-04-09 16:41:01

Changing status from needs_work to needs_review.


---

Comment by jipilab created at 2018-04-09 16:41:01

Changing keywords from "days93, polytope" to "days93, polytope, IMA-PolyGeom".


---

Comment by moritz created at 2018-04-10 01:19:19

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-05-09 09:49:49

Resolution: fixed
