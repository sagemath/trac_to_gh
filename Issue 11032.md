# Issue 11032: Add inverse method to callable symbolic functions

archive/issues_011032.json:
```json
{
    "body": "Assignee: tba\n\nCC:  @kcrisman\n\nKeywords: InverseFunction, inverse function\n\nMathematica has an `InverseFunction` function:\n\nhttp://reference.wolfram.com/mathematica/ref/InverseFunction.html\n\nSage needs it, too!\n\nsage-devel discussion: http://groups.google.com/group/sage-devel/browse_thread/thread/d7d9af95a67d4481\n\nAskSage question and answer: http://ask.sagemath.org/question/502/can-sage-compute-the-inverse-of-a-function\n\nIssue created by migration from https://trac.sagemath.org/ticket/11202\n\n",
    "created_at": "2011-04-14T19:40:40Z",
    "labels": [
        "component: symbolics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Add inverse method to callable symbolic functions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11032",
    "user": "https://trac.sagemath.org/admin/accounts/users/ltw"
}
```
Assignee: tba

CC:  @kcrisman

Keywords: InverseFunction, inverse function

Mathematica has an `InverseFunction` function:

http://reference.wolfram.com/mathematica/ref/InverseFunction.html

Sage needs it, too!

sage-devel discussion: http://groups.google.com/group/sage-devel/browse_thread/thread/d7d9af95a67d4481

AskSage question and answer: http://ask.sagemath.org/question/502/can-sage-compute-the-inverse-of-a-function

Issue created by migration from https://trac.sagemath.org/ticket/11202





---

archive/issue_comments_120016.json:
```json
{
    "body": "Attachment [11202.patch](tarball://root/attachments/some-uuid/ticket11202/11202.patch) by @eviatarbach created at 2012-04-04 03:18:11",
    "created_at": "2012-04-04T03:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120016",
    "user": "https://github.com/eviatarbach"
}
```

Attachment [11202.patch](tarball://root/attachments/some-uuid/ticket11202/11202.patch) by @eviatarbach created at 2012-04-04 03:18:11



---

archive/issue_comments_120017.json:
```json
{
    "body": "Patch added!",
    "created_at": "2012-04-04T03:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120017",
    "user": "https://github.com/eviatarbach"
}
```

Patch added!



---

archive/issue_comments_120018.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-04-04T03:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120018",
    "user": "https://github.com/eviatarbach"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_120019.json:
```json
{
    "body": "Note that this method is faster than using roots, as was suggested by Kelvin Li:\n\n```\nsage: timeit('inverse(log(x), y)')\n125 loops, best of 3: 2.88 ms per loop\nsage: timeit('(log(x) - y).roots(x)')\n125 loops, best of 3: 3.39 ms per loop\n```",
    "created_at": "2012-04-04T03:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120019",
    "user": "https://github.com/eviatarbach"
}
```

Note that this method is faster than using roots, as was suggested by Kelvin Li:

```
sage: timeit('inverse(log(x), y)')
125 loops, best of 3: 2.88 ms per loop
sage: timeit('(log(x) - y).roots(x)')
125 loops, best of 3: 3.39 ms per loop
```



---

archive/issue_comments_120020.json:
```json
{
    "body": "Interesting.  I hope someone looks at this more carefully, because it would be great to have this more easily accessible.  Two comments:\n   * The documentation that would come up in this is in the functional.py file.  Since some people might think this is pretty fully featured, but it probably isn't, that documentation should be bigger, and point to the full doc in the expression file.\n   * I'd like to see, from whomever tests it, a pretty sizable number of test cases that indicate we won't get \"weird\" output.  Namely, what happens when `solve` is baffled?  Multivariate things?  Things that have inverses (like functions defined by integrals or something) but which won't have them shown here?  \nIn the past we've had a lot of complaints from adding \"early stage\" things.  I'm still in favor of doing so, as that's the only way this project improves, but we want to make sure that we make it really clear to even the most obtuse reader what the real status and abilities of something like this is.",
    "created_at": "2012-04-04T04:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120020",
    "user": "https://github.com/kcrisman"
}
```

Interesting.  I hope someone looks at this more carefully, because it would be great to have this more easily accessible.  Two comments:
   * The documentation that would come up in this is in the functional.py file.  Since some people might think this is pretty fully featured, but it probably isn't, that documentation should be bigger, and point to the full doc in the expression file.
   * I'd like to see, from whomever tests it, a pretty sizable number of test cases that indicate we won't get "weird" output.  Namely, what happens when `solve` is baffled?  Multivariate things?  Things that have inverses (like functions defined by integrals or something) but which won't have them shown here?  
In the past we've had a lot of complaints from adding "early stage" things.  I'm still in favor of doing so, as that's the only way this project improves, but we want to make sure that we make it really clear to even the most obtuse reader what the real status and abilities of something like this is.



---

archive/issue_comments_120021.json:
```json
{
    "body": "Okay, will do.\n\nI don't know what you mean by it not being \"fully featured\". It should be able to handle any invertible functions, assuming solve supports them. Those are really the only limitations here. If it can't solve it, it just leaves it unevaluated, the same way that solve does. For example,\n\n```\n(abs(x) == y).solve(x)\n[abs(x) == y]\n```\n\n\nDon't think there are many places for this to go wrong, since all it does is switch around two variables and solves for one of them. But I will add some test cases (or did you want someone else to do it, since you said \"from whomever tests it\"?). I did include a multivariate example, by the way. I don't know what you mean by functions defined by integrals; could you please give an example?\n\nThank you.",
    "created_at": "2012-04-04T04:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120021",
    "user": "https://github.com/eviatarbach"
}
```

Okay, will do.

I don't know what you mean by it not being "fully featured". It should be able to handle any invertible functions, assuming solve supports them. Those are really the only limitations here. If it can't solve it, it just leaves it unevaluated, the same way that solve does. For example,

```
(abs(x) == y).solve(x)
[abs(x) == y]
```


Don't think there are many places for this to go wrong, since all it does is switch around two variables and solves for one of them. But I will add some test cases (or did you want someone else to do it, since you said "from whomever tests it"?). I did include a multivariate example, by the way. I don't know what you mean by functions defined by integrals; could you please give an example?

Thank you.



---

archive/issue_comments_120022.json:
```json
{
    "body": "Please fill in your real name as Author.",
    "created_at": "2012-07-27T20:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120022",
    "user": "https://github.com/jdemeyer"
}
```

Please fill in your real name as Author.



---

archive/issue_comments_120023.json:
```json
{
    "body": "I've taken a look at your patch (haven't tried it yet). It looks like good work! Here's some feedback:\n\n```\nif not with_respect_to: \n  raise TypeError('You must specify with respect to which \\ \n\tvariable to take the inverse.') \n```\nI would test for\n\n```\nif with_respect_to == None or not with_respect_to.is_symbol():\n```\nI also think that a `ValueError` is more appropriate than a `TypeError`.\n\nAlso, it would be a nice enhancement if something like this would work:\n\n```\nsage: f(x) = log(x)\nsage: f\nx |--> log(x)\nsage: inverse(f)\nx |--> exp(x)\n```\n(or does it?)",
    "created_at": "2012-08-09T14:49:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120023",
    "user": "https://github.com/tkluck"
}
```

I've taken a look at your patch (haven't tried it yet). It looks like good work! Here's some feedback:

```
if not with_respect_to: 
  raise TypeError('You must specify with respect to which \ 
	variable to take the inverse.') 
```
I would test for

```
if with_respect_to == None or not with_respect_to.is_symbol():
```
I also think that a `ValueError` is more appropriate than a `TypeError`.

Also, it would be a nice enhancement if something like this would work:

```
sage: f(x) = log(x)
sage: f
x |--> log(x)
sage: inverse(f)
x |--> exp(x)
```
(or does it?)



---

archive/issue_comments_120024.json:
```json
{
    "body": "Replying to [comment:10 tkluck]:\n> I've taken a look at your patch (haven't tried it yet). It looks like good work! Here's some feedback:\n> \n> \n> ```\n> if not with_respect_to: \n>   raise TypeError('You must specify with respect to which \\ \n> \tvariable to take the inverse.') \n> ```\n> I would test for\n> \n> ```\n> if with_respect_to == None or not with_respect_to.is_symbol():\n> ```\n> I also think that a `ValueError` is more appropriate than a `TypeError`.\n> \n> Also, it would be a nice enhancement if something like this would work:\n> \n> ```\n> sage: f(x) = log(x)\n> sage: f\n> x |--> log(x)\n> sage: inverse(f)\n> x |--> exp(x)\n> ```\n> (or does it?)\n\nThanks for the feedback! I'll see if I can work on this soon.",
    "created_at": "2012-08-09T17:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120024",
    "user": "https://github.com/eviatarbach"
}
```

Replying to [comment:10 tkluck]:
> I've taken a look at your patch (haven't tried it yet). It looks like good work! Here's some feedback:
> 
> 
> ```
> if not with_respect_to: 
>   raise TypeError('You must specify with respect to which \ 
> 	variable to take the inverse.') 
> ```
> I would test for
> 
> ```
> if with_respect_to == None or not with_respect_to.is_symbol():
> ```
> I also think that a `ValueError` is more appropriate than a `TypeError`.
> 
> Also, it would be a nice enhancement if something like this would work:
> 
> ```
> sage: f(x) = log(x)
> sage: f
> x |--> log(x)
> sage: inverse(f)
> x |--> exp(x)
> ```
> (or does it?)

Thanks for the feedback! I'll see if I can work on this soon.



---

archive/issue_comments_120025.json:
```json
{
    "body": "> > {{{\n> > if not with_respect_to: \n> >   raise TypeError('You must specify with respect to which \\ \n> > \tvariable to take the inverse.') \n> > }}}\n> > I would test for\n> > \n> > ```\n> > if with_respect_to == None or not with_respect_to.is_symbol():\n> > ```\n\n\nOr `if with_respect_to is None`?",
    "created_at": "2012-08-10T01:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120025",
    "user": "https://github.com/kcrisman"
}
```

> > {{{
> > if not with_respect_to: 
> >   raise TypeError('You must specify with respect to which \ 
> > 	variable to take the inverse.') 
> > }}}
> > I would test for
> > 
> > ```
> > if with_respect_to == None or not with_respect_to.is_symbol():
> > ```


Or `if with_respect_to is None`?



---

archive/issue_comments_120026.json:
```json
{
    "body": "Replying to [comment:12 kcrisman]:\n\n> > > ` if with_respect_to == None or not with_respect_to.is_symbol(): `\n\n> Or `if with_respect_to is None` ?\n\n[This guy](http://jaredgrubb.blogspot.nl/2009/04/python-is-none-vs-none.html) agrees with you.",
    "created_at": "2012-08-10T07:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120026",
    "user": "https://github.com/tkluck"
}
```

Replying to [comment:12 kcrisman]:

> > > ` if with_respect_to == None or not with_respect_to.is_symbol(): `

> Or `if with_respect_to is None` ?

[This guy](http://jaredgrubb.blogspot.nl/2009/04/python-is-none-vs-none.html) agrees with you.



---

archive/issue_events_029012.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29012"
}
```



---

archive/issue_events_029013.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29013"
}
```



---

archive/issue_events_029014.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29014"
}
```



---

archive/issue_events_029015.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29015"
}
```



---

archive/issue_events_029016.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29016"
}
```



---

archive/issue_comments_120027.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-12T09:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120027",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_029017.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29017"
}
```



---

archive/issue_events_029018.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29018"
}
```



---

archive/issue_comments_120028.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-08-05T13:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120028",
    "user": "https://github.com/rwst"
}
```

New commits:



---

archive/issue_comments_120029.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-05T13:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120029",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_029019.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-08-05T13:19:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29019"
}
```



---

archive/issue_events_029020.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-08-05T13:19:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29020"
}
```



---

archive/issue_comments_120030.json:
```json
{
    "body": "Cannot reproduce the patchbot fails in `modular/modform/`, apparently a once-only problem of the librae patchbot.",
    "created_at": "2016-08-06T05:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120030",
    "user": "https://github.com/rwst"
}
```

Cannot reproduce the patchbot fails in `modular/modform/`, apparently a once-only problem of the librae patchbot.



---

archive/issue_comments_120031.json:
```json
{
    "body": "Is there a good reason that:\n\n```python\nsage: y = var('y')\nsage: log(x).inverse(y)\n```\nshould return `[y == exp(x)]` rather than `[x == exp(y)]`? I find the latter much more intuitive.\n\nThe tests should also cover some cases where errors are raised.\n\nMore trivially, there are some violated conventions in the docstring:\n\n- extra indentation and `-` instead of `--` in the `INPUT:` section\n- formatting of `OUTPUT:` section",
    "created_at": "2018-07-28T10:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120031",
    "user": "https://github.com/bryangingechen"
}
```

Is there a good reason that:

```python
sage: y = var('y')
sage: log(x).inverse(y)
```
should return `[y == exp(x)]` rather than `[x == exp(y)]`? I find the latter much more intuitive.

The tests should also cover some cases where errors are raised.

More trivially, there are some violated conventions in the docstring:

- extra indentation and `-` instead of `--` in the `INPUT:` section
- formatting of `OUTPUT:` section



---

archive/issue_events_029021.json:
```json
{
    "actor": "https://github.com/bryangingechen",
    "created_at": "2018-07-28T10:14:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29021"
}
```



---

archive/issue_events_029022.json:
```json
{
    "actor": "https://github.com/bryangingechen",
    "created_at": "2018-07-28T10:14:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11032#event-29022"
}
```



---

archive/issue_comments_120032.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-28T10:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11032",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11032#issuecomment-120032",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_review to needs_work.
