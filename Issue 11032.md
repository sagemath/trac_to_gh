# Issue 11032: Add inverse method to callable symbolic functions

Issue created by migration from https://trac.sagemath.org/ticket/11202

Original creator: ltw

Original creation time: 2011-04-14 19:40:40

Assignee: tba

CC:  kcrisman

Keywords: InverseFunction, inverse function

Mathematica has an `InverseFunction` function:

http://reference.wolfram.com/mathematica/ref/InverseFunction.html

Sage needs it, too!

sage-devel discussion: http://groups.google.com/group/sage-devel/browse_thread/thread/d7d9af95a67d4481

AskSage question and answer: http://ask.sagemath.org/question/502/can-sage-compute-the-inverse-of-a-function


---

Attachment


---

Comment by eviatarbach created at 2012-04-04 03:19:27

Patch added!


---

Comment by eviatarbach created at 2012-04-04 03:19:27

Changing status from new to needs_review.


---

Comment by eviatarbach created at 2012-04-04 03:49:27

Note that this method is faster than using roots, as was suggested by Kelvin Li:


```
sage: timeit('inverse(log(x), y)')
125 loops, best of 3: 2.88 ms per loop
sage: timeit('(log(x) - y).roots(x)')
125 loops, best of 3: 3.39 ms per loop
```



---

Comment by kcrisman created at 2012-04-04 04:25:09

Interesting.  I hope someone looks at this more carefully, because it would be great to have this more easily accessible.  Two comments:
 * The documentation that would come up in this is in the functional.py file.  Since some people might think this is pretty fully featured, but it probably isn't, that documentation should be bigger, and point to the full doc in the expression file.
 * I'd like to see, from whomever tests it, a pretty sizable number of test cases that indicate we won't get "weird" output.  Namely, what happens when `solve` is baffled?  Multivariate things?  Things that have inverses (like functions defined by integrals or something) but which won't have them shown here?  
In the past we've had a lot of complaints from adding "early stage" things.  I'm still in favor of doing so, as that's the only way this project improves, but we want to make sure that we make it really clear to even the most obtuse reader what the real status and abilities of something like this is.


---

Comment by eviatarbach created at 2012-04-04 04:56:52

Okay, will do.

I don't know what you mean by it not being "fully featured". It should be able to handle any invertible functions, assuming solve supports them. Those are really the only limitations here. If it can't solve it, it just leaves it unevaluated, the same way that solve does. For example,


```
(abs(x) == y).solve(x)
[abs(x) == y]
```



Don't think there are many places for this to go wrong, since all it does is switch around two variables and solves for one of them. But I will add some test cases (or did you want someone else to do it, since you said "from whomever tests it"?). I did include a multivariate example, by the way. I don't know what you mean by functions defined by integrals; could you please give an example?

Thank you.


---

Comment by jdemeyer created at 2012-07-27 20:42:05

Please fill in your real name as Author.


---

Comment by tkluck created at 2012-08-09 14:49:25

I've taken a look at your patch (haven't tried it yet). It looks like good work! Here's some feedback:


```
if not with_respect_to: 
  raise TypeError('You must specify with respect to which \ 
	variable to take the inverse.') 
```

I would test for

```
if with_respect_to == None or not with_respect_to.is_symbol():
```

I also think that a `ValueError` is more appropriate than a `TypeError`.

Also, it would be a nice enhancement if something like this would work:

```
sage: f(x) = log(x)
sage: f
x |--> log(x)
sage: inverse(f)
x |--> exp(x)
```

(or does it?)


---

Comment by eviatarbach created at 2012-08-09 17:23:02

Replying to [comment:10 tkluck]:
> I've taken a look at your patch (haven't tried it yet). It looks like good work! Here's some feedback:
> 
> {{{
> if not with_respect_to: 
>   raise TypeError('You must specify with respect to which \ 
> 	variable to take the inverse.') 
> }}}
> I would test for
> {{{
> if with_respect_to == None or not with_respect_to.is_symbol():
> }}}
> I also think that a `ValueError` is more appropriate than a `TypeError`.
> 
> Also, it would be a nice enhancement if something like this would work:
> {{{
> sage: f(x) = log(x)
> sage: f
> x |--> log(x)
> sage: inverse(f)
> x |--> exp(x)
> }}}
> (or does it?)
Thanks for the feedback! I'll see if I can work on this soon.


---

Comment by kcrisman created at 2012-08-10 01:17:33

> > {{{
> > if not with_respect_to: 
> >   raise TypeError('You must specify with respect to which \ 
> > 	variable to take the inverse.') 
> > }}}
> > I would test for
> > {{{
> > if with_respect_to == None or not with_respect_to.is_symbol():
> > }}}

Or `if with_respect_to is None`?


---

Comment by tkluck created at 2012-08-10 07:37:51

Replying to [comment:12 kcrisman]:

> > > ` if with_respect_to == None or not with_respect_to.is_symbol(): `
> Or `if with_respect_to is None` ?

[This guy](http://jaredgrubb.blogspot.nl/2009/04/python-is-none-vs-none.html) agrees with you.


---

Comment by rws created at 2014-05-12 09:19:36

Changing status from needs_review to needs_work.


---

Comment by rws created at 2016-08-05 13:19:52

New commits:


---

Comment by rws created at 2016-08-05 13:19:52

Changing status from needs_work to needs_review.


---

Comment by rws created at 2016-08-06 05:37:06

Cannot reproduce the patchbot fails in `modular/modform/`, apparently a once-only problem of the librae patchbot.


---

Comment by @bryangingechen created at 2018-07-28 10:14:56

Is there a good reason that:

```python
sage: y = var('y')
sage: log(x).inverse(y)
```

should return `[y == exp(x)]` rather than `[x == exp(y)]`? I find the latter much more intuitive.

The tests should also cover some cases where errors are raised.

More trivially, there are some violated conventions in the docstring:

- extra indentation and `-` instead of `--` in the `INPUT:` section
- formatting of `OUTPUT:` section


---

Comment by @bryangingechen created at 2018-07-28 10:19:01

Changing status from needs_review to needs_work.
