# Issue 15153: roots of polynomials and eigenvalues of matrices over finite fields

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2013-11-09 22:22:05

CC:  pbruin defeo

Keywords: sage-days55

Based on #14990 we implement root computations in the algebraic closure of finite fields.


---

Comment by vdelecroix created at 2013-11-09 22:42:21

Last 10 new commits:


---

Comment by git created at 2013-11-09 23:23:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2013-11-09 23:32:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2013-11-09 23:32:54

Changing status from new to needs_review.


---

Comment by rws created at 2014-05-11 07:58:36

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-06-09 00:16:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-09 00:18:14

Hello,

Needs review!

I will not do eigenspaces since it needs the implementation of algebraic conjugates... for another ticket.

Vincent


---

Comment by vdelecroix created at 2014-06-09 00:18:14

Changing status from needs_work to needs_review.


---

Comment by mmarco created at 2014-06-21 06:20:19

Is there some reason why it shouldn't work for any finite field with a fixed embedding on the algebraic closure? (or the algebraic closure itself)


---

Comment by vdelecroix created at 2014-06-21 07:59:13

Replying to [comment:13 mmarco]:
> Is there some reason why it shouldn't work for any finite field with a fixed embedding on the algebraic closure? (or the algebraic closure itself)

It is rather independent of that ticket. As soon as you make work the embeddings of finite fields into algebraic closures, then there will be nothing to change in my code to make the roots and eigenvalues work.

EDIT: For the algebraic closure itself... I will have a look.

Vincent


---

Comment by vdelecroix created at 2014-06-21 08:48:08

Ok. I had a look and the reason is because the inclusions are only implemented between the subfields:

```
sage: K = GF(5).algebraic_closure()
sage: K2, phi2 = K.subfield(2)
sage: K4, phi4 = K.subfield(4)
sage: z2 = K2.gen()
sage: K4(z2)
Traceback (most recent call last):
...
TypeError: unable to coerce from a finite field other than the prime subfield
```

But the following works

```
sage: f24 = K.inclusion(2,4)
sage: f24(K2.gen())
z4^3 + z4^2 + z4 + 3
```


I will at least fix the `_roots_univariate_polynomial` using the inclusion morphism.

Vincent


---

Comment by vdelecroix created at 2014-06-21 08:48:08

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-06-21 10:52:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-21 10:56:07

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2014-06-21 10:56:07

Ok. Now it works.


---

Comment by mmarco created at 2014-06-21 19:22:23

Looks good, but... shouldn't it make more sense to implement the factorization of polynomials? (it is basically what your code does).

We should get the roots for free from the factorization.


---

Comment by vdelecroix created at 2014-06-22 10:54:27

You are right, I will have a look where to implement the factor stuff.

I also set #16509 as a dependency since it makes more sense to use the smallest field possible for all the coefficients...

Vincent


---

Comment by git created at 2014-06-22 14:17:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2014-06-22 16:20:27

Since you are computing a factorization to get the roots, wouldn't it make more sense to go the other way around?. That is, write a complicated method that computes the factorization, and then just call it to get the roots.

It seems that what you ar doing is computing the factorization to get the roots, and then use the roots to compute the factorization.


---

Comment by vdelecroix created at 2014-06-22 16:33:55

Hey

The two things are equivalent in an algebraically closed field, right? And from the coding point of view, it is more natural the other way around. If you look at the part of the code which actually does the computation, I do not see where it looks more like a factorisation rather than a computation of roots

```
roots = [] # a list of pair (root,multiplicity)
for g,m in P(new_coeffs).factor():
    if g.degree() == 1:
        r = phi(-g.constant_coefficient())
        roots.append((r,m))
    else:
        ll = l * g.degree()
        psi = self.inclusion(l, ll)
        FF, pphi = self.subfield(ll)
        gg = PolynomialRing(FF, 'x')(map(psi, g))
        for r,_ in gg.roots(): # note: we know that multiplicity is 1
                roots.append((pphi(r),m))
```


If you have an alternative proposition, propose it, but I really do not see what you mean. The only `factor` which appears above is over the field where are defined the coefficients.

Vincent


---

Comment by mmarco created at 2014-06-22 16:53:12

Ok, if you really prefear it this way, you can leave it. Just check the commas (some of them don't have a space after, but they should).


---

Comment by git created at 2014-06-22 17:09:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-22 17:12:55

Replying to [comment:24 mmarco]:
> Ok, if you really prefear it this way, you can leave it.

I do not prefer it this way, I just do not see how to do the other way around. If you know and think it is better, please provide a branch.

> Just check the commas (some of them don't have a space after, but they should).

Why do they should?! These are just coding conventions and I do prefer
`for i,j,k in my_list` rather than `for i, j, k in my_list`. But as you saw I did it.


---

Comment by mmarco created at 2014-06-23 07:00:45

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2014-06-23 10:42:59

Thanks for the review!


---

Comment by vbraun created at 2014-06-23 21:12:33

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-06-23 21:12:33

reviewer name


---

Comment by mmarco created at 2014-06-23 21:15:06

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2014-06-23 21:23:39

Miguel, you are supposed to sign with your real name not the trac account name


---

Comment by vbraun created at 2014-06-24 14:09:04

Resolution: fixed


---

Comment by vbraun created at 2014-07-19 04:58:03

See #16681 for a followup
