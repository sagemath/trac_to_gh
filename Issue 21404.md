# Issue 21404: Permissions wrong in several files installed in SAGE_LOCAL

archive/issues_021404.json:
```json
{
    "body": "CC:  vbraun jdemeyer embray dimpase yzh\n\nThe files below are not world-readable. As a result, Sage installed by one user, using \"umask 022\", will fail for other users who are not members of the installer's group, with the following error message.\n\n```\nIOError: [Errno 13] Permission denied: '/home/mkoeppe/sage/local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/PKG-INFO\n```\n\n(This is on a fresh install of 7.4.beta6.)\n\nI would suggest that a check for sane permissions of the local tree be added to distribution/buildbot/... scripts.\n\n\n```\n$ find local ! -perm -o+r\nlocal/lib/python2.7/site-packages/dateutil/zoneinfo/zoneinfo--latest.tar.gz\nlocal/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/dependency_links.txt\nlocal/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/not-zip-safe\nlocal/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/PKG-INFO\nlocal/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/requires.txt\nlocal/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/SOURCES.txt\nlocal/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/top_level.txt\nlocal/share/ellcurves\nlocal/share/ellcurves/rank10\nlocal/share/ellcurves/rank11\nlocal/share/ellcurves/rank12\nlocal/share/ellcurves/rank14\nlocal/share/ellcurves/rank15\nlocal/share/ellcurves/rank17\nlocal/share/ellcurves/rank19\nlocal/share/ellcurves/rank20\nlocal/share/ellcurves/rank21\nlocal/share/ellcurves/rank22\nlocal/share/ellcurves/rank23\nlocal/share/ellcurves/rank24\nlocal/share/ellcurves/rank28\nlocal/share/ellcurves/rank4\nlocal/share/ellcurves/rank5\nlocal/share/ellcurves/rank6\nlocal/share/ellcurves/rank7\nlocal/share/ellcurves/rank8\nlocal/share/ellcurves/rank9\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/21641\n\n",
    "created_at": "2016-10-05T00:17:57Z",
    "labels": [
        "build",
        "blocker",
        "bug"
    ],
    "title": "Permissions wrong in several files installed in SAGE_LOCAL",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21404",
    "user": "mkoeppe"
}
```
CC:  vbraun jdemeyer embray dimpase yzh

The files below are not world-readable. As a result, Sage installed by one user, using "umask 022", will fail for other users who are not members of the installer's group, with the following error message.

```
IOError: [Errno 13] Permission denied: '/home/mkoeppe/sage/local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/PKG-INFO
```

(This is on a fresh install of 7.4.beta6.)

I would suggest that a check for sane permissions of the local tree be added to distribution/buildbot/... scripts.


```
$ find local ! -perm -o+r
local/lib/python2.7/site-packages/dateutil/zoneinfo/zoneinfo--latest.tar.gz
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/dependency_links.txt
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/not-zip-safe
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/PKG-INFO
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/requires.txt
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/SOURCES.txt
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/top_level.txt
local/share/ellcurves
local/share/ellcurves/rank10
local/share/ellcurves/rank11
local/share/ellcurves/rank12
local/share/ellcurves/rank14
local/share/ellcurves/rank15
local/share/ellcurves/rank17
local/share/ellcurves/rank19
local/share/ellcurves/rank20
local/share/ellcurves/rank21
local/share/ellcurves/rank22
local/share/ellcurves/rank23
local/share/ellcurves/rank24
local/share/ellcurves/rank28
local/share/ellcurves/rank4
local/share/ellcurves/rank5
local/share/ellcurves/rank6
local/share/ellcurves/rank7
local/share/ellcurves/rank8
local/share/ellcurves/rank9
```


Issue created by migration from https://trac.sagemath.org/ticket/21641





---

archive/issue_comments_297209.json:
```json
{
    "body": "I have been tempted to add a doctest to check that all files in `$SAGE_LOCAL` have sensible permissions (which should be only `0755` or `0644` when `umask == 0022`). That would be easy to do.\n\nHowever, I wouldn't want to run this doctest by default for all users because users should be free to change permissions or install external non-Sage stuff in `$SAGE_LOCAL`.",
    "created_at": "2016-10-05T08:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21404#issuecomment-297209",
    "user": "jdemeyer"
}
```

I have been tempted to add a doctest to check that all files in `$SAGE_LOCAL` have sensible permissions (which should be only `0755` or `0644` when `umask == 0022`). That would be easy to do.

However, I wouldn't want to run this doctest by default for all users because users should be free to change permissions or install external non-Sage stuff in `$SAGE_LOCAL`.



---

archive/issue_comments_297210.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-05T10:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21404#issuecomment-297210",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_297211.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-05T11:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21404#issuecomment-297211",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_297212.json:
```json
{
    "body": "This branch fixes the installation of `elliptic_curves` and upgrades `dateutil` to a newer version with the right permissions.\n\nIt doesn't really fix anything structurally, but I suggest not to do that on this ticket.",
    "created_at": "2016-10-05T11:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21404#issuecomment-297212",
    "user": "jdemeyer"
}
```

This branch fixes the installation of `elliptic_curves` and upgrades `dateutil` to a newer version with the right permissions.

It doesn't really fix anything structurally, but I suggest not to do that on this ticket.



---

archive/issue_comments_297213.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-08T14:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21404#issuecomment-297213",
    "user": "vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_297214.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-11T22:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21404",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21404#issuecomment-297214",
    "user": "vbraun"
}
```

Resolution: fixed
