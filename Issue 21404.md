# Issue 21404: Permissions wrong in several files installed in SAGE_LOCAL

Issue created by migration from https://trac.sagemath.org/ticket/21641

Original creator: mkoeppe

Original creation time: 2016-10-05 00:17:57

CC:  vbraun jdemeyer embray dimpase yzh

The files below are not world-readable. As a result, Sage installed by one user, using "umask 022", will fail for other users who are not members of the installer's group, with the following error message.

```
IOError: [Errno 13] Permission denied: '/home/mkoeppe/sage/local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/PKG-INFO
```

(This is on a fresh install of 7.4.beta6.)

I would suggest that a check for sane permissions of the local tree be added to distribution/buildbot/... scripts.


```
$ find local ! -perm -o+r
local/lib/python2.7/site-packages/dateutil/zoneinfo/zoneinfo--latest.tar.gz
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/dependency_links.txt
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/not-zip-safe
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/PKG-INFO
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/requires.txt
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/SOURCES.txt
local/lib/python2.7/site-packages/python_dateutil-2.2-py2.7.egg-info/top_level.txt
local/share/ellcurves
local/share/ellcurves/rank10
local/share/ellcurves/rank11
local/share/ellcurves/rank12
local/share/ellcurves/rank14
local/share/ellcurves/rank15
local/share/ellcurves/rank17
local/share/ellcurves/rank19
local/share/ellcurves/rank20
local/share/ellcurves/rank21
local/share/ellcurves/rank22
local/share/ellcurves/rank23
local/share/ellcurves/rank24
local/share/ellcurves/rank28
local/share/ellcurves/rank4
local/share/ellcurves/rank5
local/share/ellcurves/rank6
local/share/ellcurves/rank7
local/share/ellcurves/rank8
local/share/ellcurves/rank9
```



---

Comment by jdemeyer created at 2016-10-05 08:30:54

I have been tempted to add a doctest to check that all files in `$SAGE_LOCAL` have sensible permissions (which should be only `0755` or `0644` when `umask == 0022`). That would be easy to do.

However, I wouldn't want to run this doctest by default for all users because users should be free to change permissions or install external non-Sage stuff in `$SAGE_LOCAL`.


---

Comment by git created at 2016-10-05 10:39:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2016-10-05 11:42:18

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2016-10-05 11:42:18

This branch fixes the installation of `elliptic_curves` and upgrades `dateutil` to a newer version with the right permissions.

It doesn't really fix anything structurally, but I suggest not to do that on this ticket.


---

Comment by vbraun created at 2016-10-08 14:41:07

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-10-11 22:44:57

Resolution: fixed
