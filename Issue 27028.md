# Issue 27028: spkg-configure.m4 for NTL

archive/issues_027028.json:
```json
{
    "body": "CC:  embray fbissey jdemeyer\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/27265\n\n",
    "created_at": "2019-02-12T16:19:49Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "spkg-configure.m4 for NTL",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27028",
    "user": "dimpase"
}
```
CC:  embray fbissey jdemeyer



Issue created by migration from https://trac.sagemath.org/ticket/27265





---

archive/issue_comments_380583.json:
```json
{
    "body": "here we might want to check that NTL is built with gf2x. However, it appears that it's only question of better performance, not an exta API, if it gf2x is linked.",
    "created_at": "2019-03-20T17:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380583",
    "user": "dimpase"
}
```

here we might want to check that NTL is built with gf2x. However, it appears that it's only question of better performance, not an exta API, if it gf2x is linked.



---

archive/issue_comments_380584.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-20T22:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380584",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_380585.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2019-03-20T22:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380585",
    "user": "dimpase"
}
```

Last 10 new commits:



---

archive/issue_comments_380586.json:
```json
{
    "body": "nesting of `AC_...` tests is wrong.",
    "created_at": "2019-03-21T14:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380586",
    "user": "dimpase"
}
```

nesting of `AC_...` tests is wrong.



---

archive/issue_comments_380587.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380587",
    "user": "embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_380588.json:
```json
{
    "body": "also needs\n\n```diff\n+++ b/build/pkgs/flint/spkg-install\n@@ -17,7 +17,7 @@ echo \"Configuring FLINT.\"\n     --disable-static \\\n     --prefix=\"$SAGE_LOCAL\" \\\n     $SAGE_CONFIGURE_GMP \\\n-    $SAGE_CONFIGURE_NTL \\\n+    --with-ntl=\"$SAGE_NTL_PREFIX\" \\\n     $SAGE_CONFIGURE_MPFR \\\n     $FLINT_CONFIGURE || sdh_die \"Error: Failed to configure FLINT.\"\n```\n\nas completely omitting `--with-ntl` results in no NTL linked into flint.",
    "created_at": "2019-04-06T00:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380588",
    "user": "dimpase"
}
```

also needs

```diff
+++ b/build/pkgs/flint/spkg-install
@@ -17,7 +17,7 @@ echo "Configuring FLINT."
     --disable-static \
     --prefix="$SAGE_LOCAL" \
     $SAGE_CONFIGURE_GMP \
-    $SAGE_CONFIGURE_NTL \
+    --with-ntl="$SAGE_NTL_PREFIX" \
     $SAGE_CONFIGURE_MPFR \
     $FLINT_CONFIGURE || sdh_die "Error: Failed to configure FLINT."
```

as completely omitting `--with-ntl` results in no NTL linked into flint.



---

archive/issue_comments_380589.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-04-18T10:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380589",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_380590.json:
```json
{
    "body": "rebased over the latest #27212 and fixed comment:9 issue.",
    "created_at": "2019-04-18T10:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380590",
    "user": "dimpase"
}
```

rebased over the latest #27212 and fixed comment:9 issue.



---

archive/issue_comments_380591.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-18T21:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380591",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380592.json:
```json
{
    "body": "This is ready for review now. Note that often external NTL packages are built without `gf2x`, but `gf2x` is merely an optimisation. \n\nPerhaps, to be completely on the safe side, `spkg-configure` should check whether `gf2x` is in, and if it is, only use system's NTL if `gf2x` will come from the system, too.\n(But I  don't know how to check whether `gf2x` is used in NTL, at least not in an OS-independent way).",
    "created_at": "2019-04-19T07:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380592",
    "user": "dimpase"
}
```

This is ready for review now. Note that often external NTL packages are built without `gf2x`, but `gf2x` is merely an optimisation. 

Perhaps, to be completely on the safe side, `spkg-configure` should check whether `gf2x` is in, and if it is, only use system's NTL if `gf2x` will come from the system, too.
(But I  don't know how to check whether `gf2x` is used in NTL, at least not in an OS-independent way).



---

archive/issue_comments_380593.json:
```json
{
    "body": "Minor remark (it all looks ok) why keep `--with-ntl=\"$SAGE_NTL_PREFIX\"` instead of using `$SAGE_CONFIGURE_NTL` like everywhere else in `flint`?",
    "created_at": "2019-04-19T07:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380593",
    "user": "fbissey"
}
```

Minor remark (it all looks ok) why keep `--with-ntl="$SAGE_NTL_PREFIX"` instead of using `$SAGE_CONFIGURE_NTL` like everywhere else in `flint`?



---

archive/issue_comments_380594.json:
```json
{
    "body": "Replying to [comment:15 fbissey]:\n> Minor remark (it all looks ok) why keep `--with-ntl=\"$SAGE_NTL_PREFIX\"` instead of using `$SAGE_CONFIGURE_NTL` like everywhere else in `flint`?\n\nBecause `$SAGE_CONFIGURE_NTL` is empty if NTL comes from the system, but `flint` must have `--with-ntl` to build NTL interface.",
    "created_at": "2019-04-19T08:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380594",
    "user": "dimpase"
}
```

Replying to [comment:15 fbissey]:
> Minor remark (it all looks ok) why keep `--with-ntl="$SAGE_NTL_PREFIX"` instead of using `$SAGE_CONFIGURE_NTL` like everywhere else in `flint`?

Because `$SAGE_CONFIGURE_NTL` is empty if NTL comes from the system, but `flint` must have `--with-ntl` to build NTL interface.



---

archive/issue_comments_380595.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Replying to [comment:15 fbissey]:\n> > Minor remark (it all looks ok) why keep `--with-ntl=\"$SAGE_NTL_PREFIX\"` instead of using `$SAGE_CONFIGURE_NTL` like everywhere else in `flint`?\n> \n> Because `$SAGE_CONFIGURE_NTL` is empty if NTL comes from the system, but `flint` must have `--with-ntl` to build NTL interface.\n\nThank you for your answer. Once we get some bots reports I think we can move to a positive review.",
    "created_at": "2019-04-19T08:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380595",
    "user": "fbissey"
}
```

Replying to [comment:16 dimpase]:
> Replying to [comment:15 fbissey]:
> > Minor remark (it all looks ok) why keep `--with-ntl="$SAGE_NTL_PREFIX"` instead of using `$SAGE_CONFIGURE_NTL` like everywhere else in `flint`?
> 
> Because `$SAGE_CONFIGURE_NTL` is empty if NTL comes from the system, but `flint` must have `--with-ntl` to build NTL interface.

Thank you for your answer. Once we get some bots reports I think we can move to a positive review.



---

archive/issue_comments_380596.json:
```json
{
    "body": "bots will need need a configure tarball. I'll add it.",
    "created_at": "2019-04-19T09:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380596",
    "user": "dimpase"
}
```

bots will need need a configure tarball. I'll add it.



---

archive/issue_comments_380597.json:
```json
{
    "body": "Attachment [configure-318.tar.gz](tarball://root/attachments/some-uuid/ticket27265/configure-318.tar.gz) by dimpase created at 2019-04-19 09:58:05\n\nupdated configure spkg",
    "created_at": "2019-04-19T09:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380597",
    "user": "dimpase"
}
```

Attachment [configure-318.tar.gz](tarball://root/attachments/some-uuid/ticket27265/configure-318.tar.gz) by dimpase created at 2019-04-19 09:58:05

updated configure spkg



---

archive/issue_comments_380598.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-19T10:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380598",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380599.json:
```json
{
    "body": "arrgh, and why is this cannot be merged?",
    "created_at": "2019-04-19T10:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380599",
    "user": "dimpase"
}
```

arrgh, and why is this cannot be merged?



---

archive/issue_comments_380600.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-19T10:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380600",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_380601.json:
```json
{
    "body": "as noted on #27751, build/pkgs/barvinok/spkg-install has missing then(s) in if(s)",
    "created_at": "2019-04-30T13:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380601",
    "user": "dimpase"
}
```

as noted on #27751, build/pkgs/barvinok/spkg-install has missing then(s) in if(s)



---

archive/issue_comments_380602.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-04-30T13:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380602",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_380603.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-30T13:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380603",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380604.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-30T13:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380604",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_380605.json:
```json
{
    "body": "this is a followup to #27212, and related to `barvinok`, please review...",
    "created_at": "2019-04-30T14:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380605",
    "user": "dimpase"
}
```

this is a followup to #27212, and related to `barvinok`, please review...



---

archive/issue_comments_380606.json:
```json
{
    "body": "Changing keywords from \"\" to \"spkg-configure ntl\".",
    "created_at": "2019-05-10T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380606",
    "user": "embray"
}
```

Changing keywords from "" to "spkg-configure ntl".



---

archive/issue_comments_380607.json:
```json
{
    "body": "Changing component from build to build: configure.",
    "created_at": "2019-05-10T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380607",
    "user": "embray"
}
```

Changing component from build to build: configure.



---

archive/issue_comments_380608.json:
```json
{
    "body": "Trying to get this to work now.  I rebased it on current develop and reworked it similarly to #27259.  I also have it check if we are installing the gf2x SPKG or not (we really need a utility macro for dependency handling).\n\nBut I get this:\n\n\n```\nconfigure: === checking whether to install the ntl SPKG ===\nchecking installing gmp/mpir? ... no\nchecking installing gf2x? ... no\nchecking NTL/ZZ.h usability... yes\nchecking NTL/ZZ.h presence... yes\nchecking for NTL/ZZ.h... yes\n```\n\n\nbut then nothing.  I don't see any output related to the `AC_LINK_IFELSE` and `AC_RUN_IFELSE` commands.  I guess one of them is failing (I will check config.log next).\n\nI guess these macros just don't have any default output?  If not, we should add some.",
    "created_at": "2019-05-10T15:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380608",
    "user": "embray"
}
```

Trying to get this to work now.  I rebased it on current develop and reworked it similarly to #27259.  I also have it check if we are installing the gf2x SPKG or not (we really need a utility macro for dependency handling).

But I get this:


```
configure: === checking whether to install the ntl SPKG ===
checking installing gmp/mpir? ... no
checking installing gf2x? ... no
checking NTL/ZZ.h usability... yes
checking NTL/ZZ.h presence... yes
checking for NTL/ZZ.h... yes
```


but then nothing.  I don't see any output related to the `AC_LINK_IFELSE` and `AC_RUN_IFELSE` commands.  I guess one of them is failing (I will check config.log next).

I guess these macros just don't have any default output?  If not, we should add some.



---

archive/issue_comments_380609.json:
```json
{
    "body": "gf2x is not compulsory for NTL. It works without it, too. So just don't do it.",
    "created_at": "2019-05-10T15:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380609",
    "user": "dimpase"
}
```

gf2x is not compulsory for NTL. It works without it, too. So just don't do it.



---

archive/issue_comments_380610.json:
```json
{
    "body": "In fact, it's why it's not possible to check whether gf2x is used with NTL in any \"normal\" way, (one does not want to run ldd on the library, right?)",
    "created_at": "2019-05-10T15:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380610",
    "user": "dimpase"
}
```

In fact, it's why it's not possible to check whether gf2x is used with NTL in any "normal" way, (one does not want to run ldd on the library, right?)



---

archive/issue_comments_380611.json:
```json
{
    "body": "I see the problem; I messed up the NTL version check stuff you did.\n\nI don't even know what gf2x is so I'll take your word for it and remove that part.",
    "created_at": "2019-05-10T15:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380611",
    "user": "embray"
}
```

I see the problem; I messed up the NTL version check stuff you did.

I don't even know what gf2x is so I'll take your word for it and remove that part.



---

archive/issue_comments_380612.json:
```json
{
    "body": "gf2x does fast arithmetic for finite fields of even order. So without it NTL is a bit slower on these very special problems, that's all.",
    "created_at": "2019-05-10T15:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380612",
    "user": "dimpase"
}
```

gf2x does fast arithmetic for finite fields of even order. So without it NTL is a bit slower on these very special problems, that's all.



---

archive/issue_comments_380613.json:
```json
{
    "body": "Out of curiosity, where did you come up with 3.10 as the minimum version of NTL?  The version in Sage is 11.3.2, and the system package I have has 10.5.0.",
    "created_at": "2019-05-10T15:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380613",
    "user": "embray"
}
```

Out of curiosity, where did you come up with 3.10 as the minimum version of NTL?  The version in Sage is 11.3.2, and the system package I have has 10.5.0.



---

archive/issue_comments_380614.json:
```json
{
    "body": "Fedora 26 has NTL 10.3 (I guess you didn't mean 3.10...).",
    "created_at": "2019-05-10T16:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380614",
    "user": "dimpase"
}
```

Fedora 26 has NTL 10.3 (I guess you didn't mean 3.10...).



---

archive/issue_comments_380615.json:
```json
{
    "body": "Rebased and incorporated #27641.  Also fixed the version check, which didn't have correct logic.\n----\nNew commits:",
    "created_at": "2019-05-10T17:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380615",
    "user": "embray"
}
```

Rebased and incorporated #27641.  Also fixed the version check, which didn't have correct logic.
----
New commits:



---

archive/issue_comments_380616.json:
```json
{
    "body": "Right, you had 10.3.  I guess I was having a dyslexic moment.  I'll fix that.",
    "created_at": "2019-05-10T17:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380616",
    "user": "embray"
}
```

Right, you had 10.3.  I guess I was having a dyslexic moment.  I'll fix that.



---

archive/issue_comments_380617.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-10T17:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380617",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380618.json:
```json
{
    "body": "This builds for me, again on the Ubuntu 18.04 machine I'm using, with NTL 10.5.",
    "created_at": "2019-05-10T17:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380618",
    "user": "embray"
}
```

This builds for me, again on the Ubuntu 18.04 machine I'm using, with NTL 10.5.



---

archive/issue_comments_380619.json:
```json
{
    "body": "I am wondering why one needs these m4_push/popdefs...",
    "created_at": "2019-05-10T17:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380619",
    "user": "dimpase"
}
```

I am wondering why one needs these m4_push/popdefs...



---

archive/issue_comments_380620.json:
```json
{
    "body": "OK, this works. I've merged mpfr+mpc+ntl in the branch `u/dimpase/build/mpfr-mpc-ntl`\n(which is not automatic) and tested it, as well.",
    "created_at": "2019-05-11T21:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380620",
    "user": "dimpase"
}
```

OK, this works. I've merged mpfr+mpc+ntl in the branch `u/dimpase/build/mpfr-mpc-ntl`
(which is not automatic) and tested it, as well.



---

archive/issue_comments_380621.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-11T21:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380621",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_380622.json:
```json
{
    "body": "Should we go ahead and set that as the branch for *this* ticket, or create a new one just for updating the configure version?",
    "created_at": "2019-05-13T13:15:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380622",
    "user": "embray"
}
```

Should we go ahead and set that as the branch for *this* ticket, or create a new one just for updating the configure version?



---

archive/issue_comments_380623.json:
```json
{
    "body": "Replying to [comment:39 dimpase]:\n> I am wondering why one needs these m4_push/popdefs... \n\nI think it's not strictly necessary I'm just trying to avoid unnecessary cluttering of the macro namespace.",
    "created_at": "2019-05-13T13:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380623",
    "user": "embray"
}
```

Replying to [comment:39 dimpase]:
> I am wondering why one needs these m4_push/popdefs... 

I think it's not strictly necessary I'm just trying to avoid unnecessary cluttering of the macro namespace.



---

archive/issue_comments_380624.json:
```json
{
    "body": "well, we need to sort out the unfortunate merging of #27642, which seems to lead to merge conflicts here. (and for mpfr+mpc alone, too). Only after this is done, we can proceed here, I think.",
    "created_at": "2019-05-13T13:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380624",
    "user": "dimpase"
}
```

well, we need to sort out the unfortunate merging of #27642, which seems to lead to merge conflicts here. (and for mpfr+mpc alone, too). Only after this is done, we can proceed here, I think.



---

archive/issue_comments_380625.json:
```json
{
    "body": "I'm still surprised it would lead to merge conflicts, much less any that are non-trivial.  I'll have a look...",
    "created_at": "2019-05-13T14:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380625",
    "user": "embray"
}
```

I'm still surprised it would lead to merge conflicts, much less any that are non-trivial.  I'll have a look...



---

archive/issue_comments_380626.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2019-05-13T14:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380626",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_380627.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-05-13T14:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380627",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_380628.json:
```json
{
    "body": "Rebased on 8.8.beta5 and squashed some commits.",
    "created_at": "2019-05-13T14:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380628",
    "user": "embray"
}
```

Rebased on 8.8.beta5 and squashed some commits.



---

archive/issue_comments_380629.json:
```json
{
    "body": "This has sort of necessary (but trivial) conflicts with #27259 so I will base it on top of that ticket's branch.",
    "created_at": "2019-05-13T14:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380629",
    "user": "embray"
}
```

This has sort of necessary (but trivial) conflicts with #27259 so I will base it on top of that ticket's branch.



---

archive/issue_comments_380630.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-05-13T14:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380630",
    "user": "embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_380631.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-05-13T14:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380631",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_380632.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-05-13T14:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380632",
    "user": "embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_380633.json:
```json
{
    "body": "This ticket should probably not be merged by itself.  Instead please merge #27822 which incorporates this one.",
    "created_at": "2019-05-13T15:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380633",
    "user": "embray"
}
```

This ticket should probably not be merged by itself.  Instead please merge #27822 which incorporates this one.



---

archive/issue_comments_380634.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-13T15:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380634",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_380635.json:
```json
{
    "body": "lgtm",
    "created_at": "2019-05-13T15:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380635",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_380636.json:
```json
{
    "body": "You for some reason skipped \t2ebf5b367c62def637fdc2955a80134a56439e0b - which is crucial for building Flint right with external NTL, see comment:9",
    "created_at": "2019-05-13T16:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380636",
    "user": "dimpase"
}
```

You for some reason skipped 	2ebf5b367c62def637fdc2955a80134a56439e0b - which is crucial for building Flint right with external NTL, see comment:9



---

archive/issue_comments_380637.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-05-13T16:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380637",
    "user": "dimpase"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_380638.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-13T16:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380638",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380639.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-05-13T16:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380639",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_380640.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-05-13T21:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380640",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_380641.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2019-05-13T21:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380641",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_380642.json:
```json
{
    "body": "Caught a bug - the tests were sometimes passing due to more libs in LIBS, it seems.\nNow it should be OK. Please review.",
    "created_at": "2019-05-13T21:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380642",
    "user": "dimpase"
}
```

Caught a bug - the tests were sometimes passing due to more libs in LIBS, it seems.
Now it should be OK. Please review.



---

archive/issue_comments_380643.json:
```json
{
    "body": "Are you saying flint's configure actually breaks if you *don't* pass a `--with-ntl` option, even if it's empty?\n\nI had removed that while squashing because it looked like a mistake to me.",
    "created_at": "2019-05-14T06:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380643",
    "user": "embray"
}
```

Are you saying flint's configure actually breaks if you *don't* pass a `--with-ntl` option, even if it's empty?

I had removed that while squashing because it looked like a mistake to me.



---

archive/issue_comments_380644.json:
```json
{
    "body": "Also please avoid adding unnecessary merge commits. I'll just rebase this again...",
    "created_at": "2019-05-14T06:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380644",
    "user": "embray"
}
```

Also please avoid adding unnecessary merge commits. I'll just rebase this again...



---

archive/issue_comments_380645.json:
```json
{
    "body": "I see. It doesn't even enable the NTL interface if you don't pass `--with-ntl`. Also if you use `--with-ntl` without an argument it assumes you want `/usr/local` which is also not so good. It might be mostly harmless but I want to double-check because that could be confusing. \n\nThere are several things that are not so good about flint's hand-written configure script. I've offered to redo it with autoconf but Bill Hart complained that he didn't want to have to learn autoconf. And while I can completely understand the sentiment I think the fact is it would be better and much simpler if it did use autoconf. There's nothing much fancy it needs to do...",
    "created_at": "2019-05-14T07:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380645",
    "user": "embray"
}
```

I see. It doesn't even enable the NTL interface if you don't pass `--with-ntl`. Also if you use `--with-ntl` without an argument it assumes you want `/usr/local` which is also not so good. It might be mostly harmless but I want to double-check because that could be confusing. 

There are several things that are not so good about flint's hand-written configure script. I've offered to redo it with autoconf but Bill Hart complained that he didn't want to have to learn autoconf. And while I can completely understand the sentiment I think the fact is it would be better and much simpler if it did use autoconf. There's nothing much fancy it needs to do...



---

archive/issue_comments_380646.json:
```json
{
    "body": "Replying to [comment:57 embray]:\n> Are you saying flint's configure actually breaks if you *don't* pass a `--with-ntl` option, even if it's empty?\n\nyes, it won\u2019t link ntl unless \u2018\u2014with-ntl\u2019 is present.\n\n> \n> I had removed that while squashing because it looked like a mistake to me. \n\nthe joys of dealing dealings with hand-written configure scripts.",
    "created_at": "2019-05-14T07:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380646",
    "user": "dimpase"
}
```

Replying to [comment:57 embray]:
> Are you saying flint's configure actually breaks if you *don't* pass a `--with-ntl` option, even if it's empty?

yes, it won’t link ntl unless ‘—with-ntl’ is present.

> 
> I had removed that while squashing because it looked like a mistake to me. 

the joys of dealing dealings with hand-written configure scripts.



---

archive/issue_comments_380647.json:
```json
{
    "body": "Replying to [comment:59 embray]:\n> There are several things that are not so good about flint's hand-written configure script. I've offered to redo it with autoconf but Bill Hart complained that he didn't want to have to learn autoconf. And while I can completely understand the sentiment I think the fact is it would be better and much simpler if it did use autoconf. There's nothing much fancy it needs to do... \n\nWelcome! You are not the first one to offer. The worst thing about it, is that it infects \"descendant\" projects such as `arb`. `arb`'s configure script is just a tweaked version of the `flint` script.",
    "created_at": "2019-05-14T07:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380647",
    "user": "fbissey"
}
```

Replying to [comment:59 embray]:
> There are several things that are not so good about flint's hand-written configure script. I've offered to redo it with autoconf but Bill Hart complained that he didn't want to have to learn autoconf. And while I can completely understand the sentiment I think the fact is it would be better and much simpler if it did use autoconf. There's nothing much fancy it needs to do... 

Welcome! You are not the first one to offer. The worst thing about it, is that it infects "descendant" projects such as `arb`. `arb`'s configure script is just a tweaked version of the `flint` script.



---

archive/issue_comments_380648.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-05-14T09:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380648",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_380649.json:
```json
{
    "body": "rebased/squashed to remove the last merge commit.",
    "created_at": "2019-05-14T09:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380649",
    "user": "dimpase"
}
```

rebased/squashed to remove the last merge commit.



---

archive/issue_comments_380650.json:
```json
{
    "body": "Is it OK now? Also, could you please update #27822 in this respect?",
    "created_at": "2019-05-14T12:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380650",
    "user": "dimpase"
}
```

Is it OK now? Also, could you please update #27822 in this respect?



---

archive/issue_comments_380651.json:
```json
{
    "body": "Yes, I think this is ok now.  I'm still a little perturbed by the situation with flint but I think this will do for now.  I'll rebase #27822.",
    "created_at": "2019-05-17T11:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380651",
    "user": "embray"
}
```

Yes, I think this is ok now.  I'm still a little perturbed by the situation with flint but I think this will do for now.  I'll rebase #27822.



---

archive/issue_comments_380652.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-17T11:50:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380652",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_380653.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-05-17T11:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380653",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_380654.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:",
    "created_at": "2019-05-17T11:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380654",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:



---

archive/issue_comments_380655.json:
```json
{
    "body": "Oops, rebased an older version of the branch.",
    "created_at": "2019-05-17T11:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380655",
    "user": "embray"
}
```

Oops, rebased an older version of the branch.



---

archive/issue_comments_380656.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-05-17T11:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380656",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_380657.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-17T11:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380657",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_380658.json:
```json
{
    "body": "Missing quotes here:\n\n```diff\n--- a/build/pkgs/ntl/spkg-configure.m4\n+++ b/build/pkgs/ntl/spkg-configure.m4\n@@ -19,7 +19,7 @@ SAGE_SPKG_CONFIGURE([ntl], [\n         AC_LINK_IFELSE([\n             AC_LANG_PROGRAM([[#include <NTL/ZZ.h>]],\n                             [[NTL::ZZ a;]]\n-            )], [LIBS=$LIBS -lntl]\n+            )], [LIBS=\"$LIBS -lntl\"]\n                 [AC_MSG_RESULT([yes])], [\n             AC_MSG_RESULT([no]); sage_spkg_install_ntl=yes\n         ])\n```\n\n\nso it works if LIBS was empty, but breaks if it's already not...",
    "created_at": "2019-05-18T18:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380658",
    "user": "dimpase"
}
```

Missing quotes here:

```diff
--- a/build/pkgs/ntl/spkg-configure.m4
+++ b/build/pkgs/ntl/spkg-configure.m4
@@ -19,7 +19,7 @@ SAGE_SPKG_CONFIGURE([ntl], [
         AC_LINK_IFELSE([
             AC_LANG_PROGRAM([[#include <NTL/ZZ.h>]],
                             [[NTL::ZZ a;]]
-            )], [LIBS=$LIBS -lntl]
+            )], [LIBS="$LIBS -lntl"]
                 [AC_MSG_RESULT([yes])], [
             AC_MSG_RESULT([no]); sage_spkg_install_ntl=yes
         ])
```


so it works if LIBS was empty, but breaks if it's already not...



---

archive/issue_comments_380659.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2019-05-18T18:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380659",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_380660.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-05-18T18:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380660",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_380661.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-18T18:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380661",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_380662.json:
```json
{
    "body": "stumble upon this while trying this with more spkg-configs merged.",
    "created_at": "2019-05-18T18:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380662",
    "user": "dimpase"
}
```

stumble upon this while trying this with more spkg-configs merged.



---

archive/issue_comments_380663.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-05-20T18:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380663",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_380664.json:
```json
{
    "body": "Please only set this ticket to positive review after you have personally verified that a clean sage build works",
    "created_at": "2019-05-20T18:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380664",
    "user": "vbraun"
}
```

Please only set this ticket to positive review after you have personally verified that a clean sage build works



---

archive/issue_comments_380665.json:
```json
{
    "body": "what makes you think I did not do this?",
    "created_at": "2019-05-20T18:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380665",
    "user": "dimpase"
}
```

what makes you think I did not do this?



---

archive/issue_comments_380666.json:
```json
{
    "body": "A clean build worked great, it's a \"dirty\" build that revealed the problem of comment:72",
    "created_at": "2019-05-20T18:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380666",
    "user": "dimpase"
}
```

A clean build worked great, it's a "dirty" build that revealed the problem of comment:72



---

archive/issue_comments_380667.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-05-20T23:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380667",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_380668.json:
```json
{
    "body": "with clang on OSX, I just saw a failure to recognise NTL, due to c++ in the test called without `-std=gnu++11`.\n\nAdding `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` just above `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])` in NTL's spkg-configure.m4 fixes this.\n\nBut this seems to be a not very consistent way to do thing, as `SAGE_SPKG_CONFIGURE_GCC` ought to be called before the any other library tests. Do we have a way to force this?",
    "created_at": "2019-06-11T12:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380668",
    "user": "dimpase"
}
```

with clang on OSX, I just saw a failure to recognise NTL, due to c++ in the test called without `-std=gnu++11`.

Adding `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` just above `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])` in NTL's spkg-configure.m4 fixes this.

But this seems to be a not very consistent way to do thing, as `SAGE_SPKG_CONFIGURE_GCC` ought to be called before the any other library tests. Do we have a way to force this?



---

archive/issue_comments_380669.json:
```json
{
    "body": "It might work to just manually call `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` right at the beginning of `SAGE_SPKG_COLLECT`.",
    "created_at": "2019-06-11T14:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380669",
    "user": "embray"
}
```

It might work to just manually call `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` right at the beginning of `SAGE_SPKG_COLLECT`.



---

archive/issue_comments_380670.json:
```json
{
    "body": "Replying to [comment:80 embray]:\n> It might work to just manually call `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` right at the beginning of `SAGE_SPKG_COLLECT`.\n\nhmm, no, this does not work, as at this moment `SAGE_SPKG_CONFIGURE_GCC` is not defined.\n\nI am thinking of putting it into `SAGE_SPKG_CONFIGURE`, but this means it's a recursive call, so the only way I can think of would be avoid the recursion:\nto define essentially a copy of \n`SAGE_SPKG_CONFIGURE`, without this call, and then define `SAGE_SPKG_CONFIGURE_GCC` using this copy. After  this  `AC_REQUIRE(...)` would not involve a recursion.",
    "created_at": "2019-06-12T23:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380670",
    "user": "dimpase"
}
```

Replying to [comment:80 embray]:
> It might work to just manually call `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` right at the beginning of `SAGE_SPKG_COLLECT`.

hmm, no, this does not work, as at this moment `SAGE_SPKG_CONFIGURE_GCC` is not defined.

I am thinking of putting it into `SAGE_SPKG_CONFIGURE`, but this means it's a recursive call, so the only way I can think of would be avoid the recursion:
to define essentially a copy of 
`SAGE_SPKG_CONFIGURE`, without this call, and then define `SAGE_SPKG_CONFIGURE_GCC` using this copy. After  this  `AC_REQUIRE(...)` would not involve a recursion.



---

archive/issue_comments_380671.json:
```json
{
    "body": "Replying to [comment:81 dimpase]:\n> Replying to [comment:80 embray]:\n> > It might work to just manually call `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` right at the beginning of `SAGE_SPKG_COLLECT`.\n> \n> hmm, no, this does not work, as at this moment `SAGE_SPKG_CONFIGURE_GCC` is not defined.\n> \n> I am thinking of putting it into `SAGE_SPKG_CONFIGURE`, but this means it's a recursive call, so the only way I can think of would be avoid the recursion:\n> to define essentially a copy of \n> `SAGE_SPKG_CONFIGURE`, without this call, and then define `SAGE_SPKG_CONFIGURE_GCC` using this copy. After  this  `AC_REQUIRE(...)` would not involve a recursion.\n\nI have opened #28005 to deal with this.",
    "created_at": "2019-06-17T15:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380671",
    "user": "dimpase"
}
```

Replying to [comment:81 dimpase]:
> Replying to [comment:80 embray]:
> > It might work to just manually call `AC_REQUIRE([SAGE_SPKG_CONFIGURE_GCC])` right at the beginning of `SAGE_SPKG_COLLECT`.
> 
> hmm, no, this does not work, as at this moment `SAGE_SPKG_CONFIGURE_GCC` is not defined.
> 
> I am thinking of putting it into `SAGE_SPKG_CONFIGURE`, but this means it's a recursive call, so the only way I can think of would be avoid the recursion:
> to define essentially a copy of 
> `SAGE_SPKG_CONFIGURE`, without this call, and then define `SAGE_SPKG_CONFIGURE_GCC` using this copy. After  this  `AC_REQUIRE(...)` would not involve a recursion.

I have opened #28005 to deal with this.



---

archive/issue_comments_380672.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2019-07-15T15:49:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27028",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27028#issuecomment-380672",
    "user": "chapoton"
}
```

Resolution: duplicate
