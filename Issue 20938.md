# Issue 20938: Set ARCHFLAGS environment variable - for Perl modules

archive/issues_020938.json:
```json
{
    "body": "CC:  @videlec @jdemeyer @embray @vbraun tmonteil @dimpase @kcrisman\n\nTo make installing Perl modules easier on Mac OS X, we should set the ARCHFLAGS environment variable. This is to make sure that the output of \"perl -MExtUtils::Embed -e ldopts\" and \"perl -MExtUtils::Embed -e ccflags\" (picked up from system perl) do not contain -arch flags incompatible with our gcc.\n\nThis simplifies `perl_term_readline_gnu` (#20894), `polymake` (#20892), and makes installing `pypolymake` (#21170) as a pip package possible.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21175\n\n",
    "created_at": "2016-08-05T15:16:55Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Set ARCHFLAGS environment variable - for Perl modules",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20938",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @videlec @jdemeyer @embray @vbraun tmonteil @dimpase @kcrisman

To make installing Perl modules easier on Mac OS X, we should set the ARCHFLAGS environment variable. This is to make sure that the output of "perl -MExtUtils::Embed -e ldopts" and "perl -MExtUtils::Embed -e ccflags" (picked up from system perl) do not contain -arch flags incompatible with our gcc.

This simplifies `perl_term_readline_gnu` (#20894), `polymake` (#20892), and makes installing `pypolymake` (#21170) as a pip package possible.

Issue created by migration from https://trac.sagemath.org/ticket/21175





---

archive/issue_comments_289287.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-08-05T15:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289287",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_289288.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-05T15:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289288",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_289289.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-18T23:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289289",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_289290.json:
```json
{
    "body": "Needs review.",
    "created_at": "2016-08-18T23:59:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289290",
    "user": "https://github.com/mkoeppe"
}
```

Needs review.



---

archive/issue_comments_289291.json:
```json
{
    "body": "It looks OK on Linux; must it be tested on OSX too?",
    "created_at": "2016-08-26T12:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289291",
    "user": "https://github.com/dimpase"
}
```

It looks OK on Linux; must it be tested on OSX too?



---

archive/issue_comments_289292.json:
```json
{
    "body": "I have tested it on both platforms.",
    "created_at": "2016-08-26T13:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289292",
    "user": "https://github.com/mkoeppe"
}
```

I have tested it on both platforms.



---

archive/issue_comments_289293.json:
```json
{
    "body": "put in this, and then tried to install polymake on OSX, and got\n\n```\n[polymake-3.0r2] checking fink installation ... The Fink package system is a mandatory prerequisite to build and use polymake under MacOS.\n[polymake-3.0r2] Please refer to http://www.polymake.org/doku.php/mac for details and installation instructions.\n[polymake-3.0r2] If you already have Fink installed at a non-standard location, please specify it using option --with-fink\n[polymake-3.0r2] Error configuring Polymake\n```\n\nReally? Fink?",
    "created_at": "2016-08-26T16:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289293",
    "user": "https://github.com/dimpase"
}
```

put in this, and then tried to install polymake on OSX, and got

```
[polymake-3.0r2] checking fink installation ... The Fink package system is a mandatory prerequisite to build and use polymake under MacOS.
[polymake-3.0r2] Please refer to http://www.polymake.org/doku.php/mac for details and installation instructions.
[polymake-3.0r2] If you already have Fink installed at a non-standard location, please specify it using option --with-fink
[polymake-3.0r2] Error configuring Polymake
```

Really? Fink?



---

archive/issue_comments_289294.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-26T19:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289294",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_289295.json:
```json
{
    "body": "Thanks for catching this -- I killed the `--without-fink` by accident. Should work now.",
    "created_at": "2016-08-26T19:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289295",
    "user": "https://github.com/mkoeppe"
}
```

Thanks for catching this -- I killed the `--without-fink` by accident. Should work now.



---

archive/issue_comments_289296.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-27T12:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289296",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_289297.json:
```json
{
    "body": "OK, looks good now.",
    "created_at": "2016-08-27T12:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289297",
    "user": "https://github.com/dimpase"
}
```

OK, looks good now.



---

archive/issue_comments_289298.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-27T22:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289298",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_289299.json:
```json
{
    "body": "Reviewer name",
    "created_at": "2016-08-27T22:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289299",
    "user": "https://github.com/vbraun"
}
```

Reviewer name



---

archive/issue_comments_289300.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-08-28T05:33:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289300",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_289301.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-30T06:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289301",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_056494.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-30T06:46:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20938#event-56494"
}
```



---

archive/issue_comments_289302.json:
```json
{
    "body": "Follow-up in #29408",
    "created_at": "2020-04-09T03:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20938",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20938#issuecomment-289302",
    "user": "https://github.com/mkoeppe"
}
```

Follow-up in #29408
