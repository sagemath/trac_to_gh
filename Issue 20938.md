# Issue 20938: Set ARCHFLAGS environment variable - for Perl modules

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2016-08-05 15:16:55

CC:  vdelecroix jdemeyer embray vbraun tmonteil dimpase kcrisman

To make installing Perl modules easier on Mac OS X, we should set the ARCHFLAGS environment variable. This is to make sure that the output of "perl -MExtUtils::Embed -e ldopts" and "perl -MExtUtils::Embed -e ccflags" (picked up from system perl) do not contain -arch flags incompatible with our gcc.

This simplifies `perl_term_readline_gnu` (#20894), `polymake` (#20892), and makes installing `pypolymake` (#21170) as a pip package possible.


---

Comment by mkoeppe created at 2016-08-05 15:39:06

New commits:


---

Comment by mkoeppe created at 2016-08-05 15:39:06

Changing status from new to needs_review.


---

Comment by git created at 2016-08-18 23:54:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-08-18 23:59:31

Needs review.


---

Comment by dimpase created at 2016-08-26 12:09:47

It looks OK on Linux; must it be tested on OSX too?


---

Comment by mkoeppe created at 2016-08-26 13:49:53

I have tested it on both platforms.


---

Comment by dimpase created at 2016-08-26 16:02:07

put in this, and then tried to install polymake on OSX, and got

```
[polymake-3.0r2] checking fink installation ... The Fink package system is a mandatory prerequisite to build and use polymake under MacOS.
[polymake-3.0r2] Please refer to http://www.polymake.org/doku.php/mac for details and installation instructions.
[polymake-3.0r2] If you already have Fink installed at a non-standard location, please specify it using option --with-fink
[polymake-3.0r2] Error configuring Polymake
```

Really? Fink?


---

Comment by git created at 2016-08-26 19:21:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-08-26 19:25:24

Thanks for catching this -- I killed the `--without-fink` by accident. Should work now.


---

Comment by dimpase created at 2016-08-27 12:30:04

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2016-08-27 12:30:04

OK, looks good now.


---

Comment by vbraun created at 2016-08-27 22:36:27

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-08-27 22:36:27

Reviewer name


---

Comment by mkoeppe created at 2016-08-28 05:33:56

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-08-30 06:46:29

Resolution: fixed


---

Comment by mkoeppe created at 2020-04-09 03:41:43

Follow-up in #29408
