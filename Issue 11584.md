# Issue 11584: PolyBoRi 0.7.1 needs to activate -msse2

Issue created by migration from Trac.

Original creator: AlexanderDreyer

Original creation time: 2011-08-29 09:56:58

Assignee: AlexGhitza

CC:  strogdon leif malb burcin simon king

As pointed out in #11574: code which uses M4RI must explicitly provide the compiler option -msse2, (if the SSE2 extensions are available, but deactivated in gcc per default.)

The following spkg fixes this issue for PolyBoRI:  http://sage.math.washington.edu/home/dreyer/spkg/polybori-0.7.1.p5.spkg


---

Comment by AlexanderDreyer created at 2011-08-29 09:57:08

Changing status from new to needs_review.


---

Comment by malb created at 2011-08-31 10:56:21

I tested this SPKG on cicero and doctests pass.

There was a minor issue:

```
$ hg status
? patches/SConstruct.orig
? patches/SConstruct.rej
```

which I fixed in http://sage.math.washington.edu/home/malb/spkgs/polybori-0.7.1.p5.spkg.

Alexander, if you agree with this fix then just replace the link in the description of the ticket and we are good to go for a positive review.


---

Comment by AlexanderDreyer created at 2011-08-31 20:51:12

Sorry, I should know better. Thanks for removing the relicts. I'm fine with the new spkg.


---

Comment by malb created at 2011-08-31 23:55:38

Changing status from needs_review to positive_review.


---

Comment by leif created at 2011-09-01 02:40:53

Looks as if Alexander gets paid per changeset... ;-)


---

Comment by AlexanderDreyer created at 2011-09-01 08:11:07

Replying to [comment:5 leif]:
> Looks as if Alexander gets paid per changeset... ;-)
Not really, I'm currently on parental leave, so this is my private fun.


---

Comment by AlexanderDreyer created at 2011-09-01 08:11:26

Changing assignee from AlexGhitza to AlexanderDreyer.


---

Comment by AlexanderDreyer created at 2011-09-01 08:25:07

Replying to [comment:5 leif]:
> Looks as if Alexander gets paid per changeset... ;-)
PS: If you mean the number of small changesets making up this single fix: Yeah, there are indeed lots of changesets. The Gentoo Vm was so slow that I edited outside and  transferred edits via bitbucket. And it was 3 a.m....


---

Comment by leif created at 2011-09-01 08:47:39

Replying to [comment:8 AlexanderDreyer]:
> Replying to [comment:5 leif]:
> > Looks as if Alexander gets paid per changeset... ;-)
> PS: If you mean the number of small changesets making up this single fix...

What did you think?

I was wondering whether you had built some commit -> twitter interface. :)


---

Comment by AlexanderDreyer created at 2011-09-01 08:50:12

Replying to [comment:9 leif]:
> I was wondering whether you had built some commit -> twitter interface. :)
No, but that's a good idea for an April, 1st project ;-)


---

Comment by leif created at 2011-09-12 18:32:06

Resolution: fixed


---

Comment by AlexanderDreyer created at 2011-09-19 21:39:56

Unfortunately, it turned out that the `-sse2` guessing was wrong (failed on sparc Solaris).
The following spkg should fix this issue (not tested on sparc yet):
http://sage.math.washington.edu/home/malb/spkgs/polybori-0.7.1.p6.spkg


---

Comment by AlexanderDreyer created at 2011-09-19 21:45:44

Sorry, copy & paste mistake! The corrected URL is here:
http://sage.math.washington.edu/home/dreyer/spkg/polybori-0.7.1.p6.spkg


---

Comment by leif created at 2011-09-20 11:26:07

Replying to [comment:12 AlexanderDreyer]:
> Unfortunately, it turned out that the `-sse2` guessing was wrong (failed on sparc Solaris).
> The following spkg should fix this issue (not tested on sparc yet):
> [...]


```
...
polybori-0.7.1.p6
Machine:
SunOS mark 5.10 Generic_127111-01 sun4u sparc SUNW,Sun-Blade-2500
Deleting directories from past builds of previous/current versions of polybori-0.7.1.p6
Extracting package /home/leif/Sage/release/build/mark/sage-4.7.2.alpha3-prerelease-gcc-4.5.1/spkg/standard/polybori-0.7.1.p6.spkg ...
-rw-r--r--   1 leif     sage     1916931 Sep 19 17:26 /home/leif/Sage/release/build/mark/sage-4.7.2.alpha3-prerelease-gcc-4.5.1/spkg/standard/polybori-0.7.1.p6.spkg
Finished extraction
****************************************************
Host system
uname -a:
SunOS mark 5.10 Generic_127111-01 sun4u sparc SUNW,Sun-Blade-2500
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/local/gcc-4.5.1/sparc-SunOS-ultrasparc3-sun-as-ld/libexec/gcc/sparc-sun-solaris2.10/4.5.1/lto-wrapper
Target: sparc-sun-solaris2.10
Configured with: /usr/local/gcc-4.5.1/src/gcc-4.5.1/configure --enable-languages=c,c++,fortran --with-as=/usr/ccs/bin/as --with-ld=/usr/ccs/bin/ld --with-gmp=/usr/local/gmp-5.0.1/sparc-SunOS-ultrasparc3-gcc-4.5.0-abi32 --with-mpfr=/usr/local/mpfr-3.0.0/sparc-SunOS-ultrasparc3-gmp-5.0.1-abi32 --with-mpc=/usr/local/mpc-0.8.2/sparc-ultrasparc3-mpfr-3.0.0-gmp-5.0.1-gcc-4.5.0-abi32 --prefix=/usr/local/gcc-4.5.1/sparc-SunOS-ultrasparc3-sun-as-ld
Thread model: posix
gcc version 4.5.1 (GCC) 
****************************************************
Starting build...
Removing old PolyBoRi install...
Done removing old PolyBoRi install.
Running build_polybori...
scons: Reading SConscript files ...
sh: cc: not found
sunos linker detected!
Platform:  sunos5
Platform:  sunos5
Checking for C header file gd.h... yes
Checking for C library gd... yes
Checking for C++ header file unordered_map... no
Checking for C++ header file tr1/unordered_map... yes
Warning: No LaTeX to html converter found, Tutorial will not be installed
Checking for C library m4ri... yes
Checking for C header file gd.h... yes
Checking for C library gd... yes
Guessing m4ri compile flags... yes
no python extension
scons: done reading SConscript files.
scons: Building targets ...
g++ -o polybori/src/BoolePolyRing.o -c -O3 -Wno-long-long -Wreturn-type -g -fPIC -ftemplate-depth-100 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -DHAVE_GD -DHAVE_TR1_UNORDERED_MAP -DPACKED -DHAVE_M4RI -DHAVE_GD -DHAVE_IEEE_754 -DBSD -I/home/leif/Sage/release/build/mark/sage-4.7.2.alpha3-prerelease-gcc-4.5.1/local/include -I/home/leif/Sage/release/build/mark/sage-4.7.2.alpha3-prerelease-gcc-4.5.1/local/include/python2.6 -Ipolybori/include -ICudd/obj -ICudd/util -ICudd/cudd -ICudd/mtr -ICudd/st -ICudd/epd polybori/src/BoolePolyRing.cc

...

scons: done building targets.
Done installing PolyBoRi.

real    23m44.021s
user    20m28.186s
sys     1m34.198s
Successfully installed polybori-0.7.1.p6
```


Thanks!

Only the message now is a bit funny:

```
Guessing m4ri compile flags... yes
```



---

Comment by AlexanderDreyer created at 2011-09-20 19:59:36

Replying to [comment:15 leif]:
> Thanks!
Fine, I'm happy that this worked out.

> Only the message now is a bit funny:
> {{{
> Guessing m4ri compile flags... yes
> }}}
Yes, but it is useful for debugging reasons: `... no` means that including m4ri's config headers failed.
