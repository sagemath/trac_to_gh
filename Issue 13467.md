# Issue 13467: p.lift(...) results are non-deterministic and incoherent for multivariate polynomials

Issue created by migration from https://trac.sagemath.org/ticket/13671

Original creator: Bouillaguet

Original creation time: 2012-10-30 13:37:50

Assignee: malb

CC:  mstreng malb

Keywords: polynomial rings, mathematically wrong result


```
sage: R.<x1,x2> = QQ[]
sage: I = R.ideal(x2**2 + x1 - 2, x1**2 - 1)
sage: test = I.gen(0) + x2*I.gen(1)
sage: test.lift(I) # correct
[1, x2]
sage: (test+1).lift(I) # invalid input, should give error
[0, 0]
sage: test.lift(I) # incorrect
[0, 0]
```


p.lift(I) should raise an exception "ValueError: polynomial is not in the ideal" instead of returning [0,0,...,0] in the first place...


---

Comment by malb created at 2012-11-05 12:32:25

Hans (of Singular) wrote:

> An additional comment:
> WerrorS also sets the global variable errorreported,
> which is used at many places to abort after an error
> (and to avoid general error message if there was already one
> (hopefully more specific)).
> errorreported is reset to 0 in the error handling branch of the singular
> interpreter.
> Maybe something equivalent is missing for the routine from libsingular
> not called via the singular interpreter?

This could be it, we don't reset it.


---

Comment by Bouillaguet created at 2012-11-05 22:02:43

Changing status from new to needs_review.


---

Comment by mstreng created at 2012-11-05 22:19:29

Did you ask Gauss to write the patch for you?

```
# HG changeset patch
# User Carl Friedrich Gauss <cfgauss@uni-goettingen.de>
```

You should update the `.hmrc` file in your home directory (use your own name and email address) and export a new patch here and at #13675.


---

Comment by mstreng created at 2012-11-05 22:19:29

Changing status from needs_review to needs_work.


---

Comment by mstreng created at 2012-11-05 22:28:44

ps. Would it be possible to add a check which error was reported by Singular? Just in case self is in I, but Singular reports an error for some other reason (in which case I guess `RuntimeError` is appropriate).


---

Comment by Bouillaguet created at 2012-11-05 22:53:52

Changing status from needs_work to needs_review.


---

Comment by Bouillaguet created at 2012-11-05 22:53:52

Replying to [comment:4 mstreng]:
> ps. Would it be possible to add a check which error was reported by Singular? Just in case self is in I, but Singular reports an error for some other reason (in which case I guess `RuntimeError` is appropriate).

I renamed myself and tested that Singular returns ``1`` when the polynomial is not in the ideal...


---

Comment by mstreng created at 2012-11-05 23:06:09


```
4088	            errorreported = 0 
4089	            if errorreported == 1: 
```

This looks like it does not work.


---

Comment by Bouillaguet created at 2012-11-05 23:11:18

Replying to [comment:6 mstreng]:
> {{{
> 4088	            errorreported = 0 
> 4089	            if errorreported == 1: 
> }}}
> This looks like it does not work.

Good lord, that was stupid.


---

Attachment

Apparently fixing the bug


---

Comment by mstreng created at 2012-11-06 00:15:15

Looks good!


---

Comment by mstreng created at 2012-11-06 00:15:15

Changing status from needs_review to positive_review.


---

Comment by Bouillaguet created at 2012-11-06 00:17:58

Replying to [comment:8 mstreng]:
> Looks good!

I don't understand the circular dependency... Why would this one depend on #13675 ?


---

Comment by mstreng created at 2012-11-06 00:21:22

Replying to [comment:9 Bouillaguet]:
> I don't understand the circular dependency... Why would this one depend on #13675 ?

Not all doctests pass when only this patch is applied.


---

Comment by jdemeyer created at 2012-11-13 08:21:32

Resolution: fixed
