# Issue 17003: some rationals not in RIF

archive/issues_017003.json:
```json
{
    "body": "Keywords: rationals, real interval field, inclusion\n\nWe have\n\n```\nsage: 3/2 in RIF\nTrue\nsage: 2/3 in RIF\nFalse\n```\n\nwhich is a bit surprising. The elements can be converted to RIF:\n\n```\nsage: RIF(2/3)\n0.6666666666666667?\nsage: RIF(3/2)\n1.5000000000000000?\n```\n\nThis is also in contrast to\n\n```\nsage: 2/3 in RR\nTrue\nsage: 3/2 in RR\nTrue\n```\n\n\nI've noticed this because of\n\n```\nsage: SR(3/2) in RIF\nTrue                                                                            \nsage: SR(2/3) in RIF\nFalse\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/17240\n\n",
    "created_at": "2014-10-28T10:49:03Z",
    "labels": [
        "misc",
        "major",
        "bug"
    ],
    "title": "some rationals not in RIF",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17003",
    "user": "dkrenn"
}
```
Keywords: rationals, real interval field, inclusion

We have

```
sage: 3/2 in RIF
True
sage: 2/3 in RIF
False
```

which is a bit surprising. The elements can be converted to RIF:

```
sage: RIF(2/3)
0.6666666666666667?
sage: RIF(3/2)
1.5000000000000000?
```

This is also in contrast to

```
sage: 2/3 in RR
True
sage: 3/2 in RR
True
```


I've noticed this because of

```
sage: SR(3/2) in RIF
True                                                                            
sage: SR(2/3) in RIF
False
```


Issue created by migration from https://trac.sagemath.org/ticket/17240





---

archive/issue_comments_225552.json:
```json
{
    "body": "This is not really a bug since is is consistent with the documentation, see `RIF.__contains__??` : if x is not already an element of A, \"x in A\" means there is an element in A that is equal to x, which is true for 3/2 but not for 2/3. Indeed, 2/3 has no exact floating point representation, so any candidate in RIF to be equal to 2/3 will be a non trivial interval, for which equality can not hold:\n\n\n```\nsage: RIF(2/3).endpoints()\n(0.666666666666666, 0.666666666666667)\nsage: RIF(3/2).endpoints()\n(1.50000000000000, 1.50000000000000)\n```\n",
    "created_at": "2014-10-28T17:16:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225552",
    "user": "tmonteil"
}
```

This is not really a bug since is is consistent with the documentation, see `RIF.__contains__??` : if x is not already an element of A, "x in A" means there is an element in A that is equal to x, which is true for 3/2 but not for 2/3. Indeed, 2/3 has no exact floating point representation, so any candidate in RIF to be equal to 2/3 will be a non trivial interval, for which equality can not hold:


```
sage: RIF(2/3).endpoints()
(0.666666666666666, 0.666666666666667)
sage: RIF(3/2).endpoints()
(1.50000000000000, 1.50000000000000)
```




---

archive/issue_comments_225553.json:
```json
{
    "body": "Replying to [comment:1 tmonteil]:\n> This is not really a bug since is is consistent with the documentation, see `RIF.__contains__??` [...]\n\nI see; my mistake. I've added an example to the documentation which shows this.\n----\nNew commits:",
    "created_at": "2014-10-28T18:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225553",
    "user": "dkrenn"
}
```

Replying to [comment:1 tmonteil]:
> This is not really a bug since is is consistent with the documentation, see `RIF.__contains__??` [...]

I see; my mistake. I've added an example to the documentation which shows this.
----
New commits:



---

archive/issue_comments_225554.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2014-10-28T18:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225554",
    "user": "dkrenn"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_225555.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2014-10-28T18:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225555",
    "user": "dkrenn"
}
```

Changing priority from major to minor.



---

archive/issue_comments_225556.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-28T18:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225556",
    "user": "dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_225557.json:
```json
{
    "body": "Changing component from misc to documentation.",
    "created_at": "2014-10-28T18:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225557",
    "user": "dkrenn"
}
```

Changing component from misc to documentation.



---

archive/issue_comments_225558.json:
```json
{
    "body": "Documentation is always welcome.\n\nPerhaps could you also use the `.is_exact()` method in both cases and then the `.endpoints()` method in the 2/3 case to show the difference, since equal string representations for floating point numbers does not necessarily imply equality of floating point numbers ?\n\nSee for example:\n\n\n```\nsage: 1.0 + 1.0.ulp()\n1.00000000000000\nsage: 1.0\n1.00000000000000\nsage: 1.0 + 1.0.ulp() == 1.0\nFalse\n```\n",
    "created_at": "2014-10-30T17:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225558",
    "user": "tmonteil"
}
```

Documentation is always welcome.

Perhaps could you also use the `.is_exact()` method in both cases and then the `.endpoints()` method in the 2/3 case to show the difference, since equal string representations for floating point numbers does not necessarily imply equality of floating point numbers ?

See for example:


```
sage: 1.0 + 1.0.ulp()
1.00000000000000
sage: 1.0
1.00000000000000
sage: 1.0 + 1.0.ulp() == 1.0
False
```




---

archive/issue_comments_225559.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-30T17:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225559",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_225560.json:
```json
{
    "body": "Replying to [comment:5 tmonteil]:\n> Documentation is always welcome.\n> \n> Perhaps could you also use the `.is_exact()` method in both cases and then the `.endpoints()` method in the 2/3 case to show the difference, since equal string representations for floating point numbers does not necessarily imply equality of floating point numbers ?\n\nDone.",
    "created_at": "2014-10-30T17:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225560",
    "user": "dkrenn"
}
```

Replying to [comment:5 tmonteil]:
> Documentation is always welcome.
> 
> Perhaps could you also use the `.is_exact()` method in both cases and then the `.endpoints()` method in the 2/3 case to show the difference, since equal string representations for floating point numbers does not necessarily imply equality of floating point numbers ?

Done.



---

archive/issue_comments_225561.json:
```json
{
    "body": "I tried to make explanations more explicit. Please tell if it is easier to understand.\n----\nNew commits:",
    "created_at": "2014-10-31T14:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225561",
    "user": "tmonteil"
}
```

I tried to make explanations more explicit. Please tell if it is easier to understand.
----
New commits:



---

archive/issue_comments_225562.json:
```json
{
    "body": "I was about to give this positive review when I realized that this is almost certainly not going to appear in the *visible* documentation.  Is there somewhere in the RIF documentation (maybe the top of the module?) that this really good documentation can appear to people who are likely to need it (as opposed to those reading the `__contains__` source, who probably know what `ulp`s are)?  Otherwise this is great.",
    "created_at": "2014-12-19T14:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225562",
    "user": "kcrisman"
}
```

I was about to give this positive review when I realized that this is almost certainly not going to appear in the *visible* documentation.  Is there somewhere in the RIF documentation (maybe the top of the module?) that this really good documentation can appear to people who are likely to need it (as opposed to those reading the `__contains__` source, who probably know what `ulp`s are)?  Otherwise this is great.



---

archive/issue_comments_225563.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-19T14:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225563",
    "user": "kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_225564.json:
```json
{
    "body": "You can look at [the page of the doc](http://sagemath.org/doc/reference/structure/sage/structure/parent.html#sage.structure.parent.Parent.__contains__), the `__contains__` method appears since, in the documentation of the `Parent` class, there is a line:\n\n\n```\n    .. automethod:: __contains__\n```\n\n\nThis lets the hidden method `__contains__` to be visible in the doc.\n\nThat said, i agree that something about this could be made explicit in the doc of `RIF`, not only `Parent`.",
    "created_at": "2014-12-19T17:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225564",
    "user": "tmonteil"
}
```

You can look at [the page of the doc](http://sagemath.org/doc/reference/structure/sage/structure/parent.html#sage.structure.parent.Parent.__contains__), the `__contains__` method appears since, in the documentation of the `Parent` class, there is a line:


```
    .. automethod:: __contains__
```


This lets the hidden method `__contains__` to be visible in the doc.

That said, i agree that something about this could be made explicit in the doc of `RIF`, not only `Parent`.



---

archive/issue_comments_225565.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-03-25T19:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225565",
    "user": "chapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_225566.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2015-03-25T19:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225566",
    "user": "chapoton"
}
```

Looks good to me.



---

archive/issue_comments_225567.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-15T06:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17003#issuecomment-225567",
    "user": "vbraun"
}
```

Resolution: fixed
