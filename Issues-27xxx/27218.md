# Issue 27218: Ensure that GAP's package build toolchain is fully available for building compiled package

archive/issues_026981.json:
```json
{
    "assignees": [],
    "body": "crypting makes use of GAP's compiler (aka `gac`), and other tooling, namely, `libtool`.\n\n`gac` is installed with broken information about various paths and `sysinfo.gap` location, and `libtool` isn't installed at all, it seems.\n\nHere is how gac's entries should be corrected:\n\n```\nabs_top_srcdir=\"${SAGE_LOCAL}/share/gap/src\"\nabs_top_builddir=\"${abs_top_srcdir}\" # obsolete naming...\n```\nand one should source `sysinfo.gap` as\n\n```\n. \"${abs_top_builddir}/../sysinfo.gap\"\n```\n\n`libtool` should be installed along with `gac`.\n\n\nCC:  zerline @embray @kiwifb\n\nKeywords: **GAP packages**\n\nBranch/Commit: **[ca94bd9](https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Erik Bray**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27218_\n\n",
    "closed_at": "2019-02-23T23:14:52Z",
    "created_at": "2019-02-04T18:53:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Ensure that GAP's package build toolchain is fully available for building compiled package",
    "type": "issue",
    "updated_at": "2019-02-23T23:14:52Z",
    "url": "https://github.com/sagemath/sage/issues/27218",
    "user": "https://github.com/dimpase"
}
```
crypting makes use of GAP's compiler (aka `gac`), and other tooling, namely, `libtool`.

`gac` is installed with broken information about various paths and `sysinfo.gap` location, and `libtool` isn't installed at all, it seems.

Here is how gac's entries should be corrected:

```
abs_top_srcdir="${SAGE_LOCAL}/share/gap/src"
abs_top_builddir="${abs_top_srcdir}" # obsolete naming...
```
and one should source `sysinfo.gap` as

```
. "${abs_top_builddir}/../sysinfo.gap"
```

`libtool` should be installed along with `gac`.


CC:  zerline @embray @kiwifb

Keywords: **GAP packages**

Branch/Commit: **[ca94bd9](https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6)**

Reviewer: **Dima Pasechnik**

Author: **Erik Bray**

_Issue created by migration from https://trac.sagemath.org/ticket/27218_





---

archive/issue_events_343209.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-04T18:53:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343209"
}
```



---

archive/issue_events_343210.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-04T18:53:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343210"
}
```



---

archive/issue_events_343211.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-04T18:53:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343211"
}
```



---

archive/issue_events_343212.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-04T18:53:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343212"
}
```



---

archive/issue_comments_423175.json:
```json
{
    "body": "Dependencies: **#26930**",
    "created_at": "2019-02-04T19:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423175",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#26930**



---

archive/issue_comments_423176.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThe following patch (to the branch of #26930) installs crypting to the right place, and starts installation\n\n```\n--- a/build/pkgs/gap_packages/spkg-install\n+++ b/build/pkgs/gap_packages/spkg-install\n@@ -17,6 +17,7 @@ sdh_install \\\n     crime-* \\\n     cryst \\\n     crystcat \\\n+    crypting-* \\\n     design \\\n     gbnp \\\n     Hap* \\\n@@ -63,7 +64,7 @@ install_compiled_pkg()\n #\n # These packages have an old ./configure that take the GAP_ROOT as a positional\n # argument\n-for pkg in cohomolo-* grape-* guava-*\n+for pkg in cohomolo-* crypting-* grape-* guava-*\n do\n     echo \"Building GAP package $pkg\"\n     cd \"$PKG_SRC_DIR/$pkg\"\n```\n\nHowever, this still needs work, as building fails with \n\n```\n[gap_packages-4.10.0] Building GAP package crypting-0.9\n[gap_packages-4.10.0] Using config in /home/dimpase/Sage/sagetrac-mirror/local/share/gap/sysinfo.gap\n[gap_packages-4.10.0] Building gap_packages-4.10.0\n[gap_packages-4.10.0] make[2]: Entering directory '/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/crypting-0.9'\n[gap_packages-4.10.0] /home/dimpase/Sage/sagetrac-mirror/local/share/gap/gac: 73: .: Can't open /home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src/sysinfo.gap\n[gap_packages-4.10.0] Makefile:104: recipe for target 'obj/crypting.lo' failed\n```\n\nBasically, `gac` expects `sysinfo.gap` in the build tree, not in place announced in the 2nd line: `Using config in...`.",
    "created_at": "2019-02-04T20:08:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423176",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'>Comment 2:</a>
The following patch (to the branch of #26930) installs crypting to the right place, and starts installation

```
--- a/build/pkgs/gap_packages/spkg-install
+++ b/build/pkgs/gap_packages/spkg-install
@@ -17,6 +17,7 @@ sdh_install \
     crime-* \
     cryst \
     crystcat \
+    crypting-* \
     design \
     gbnp \
     Hap* \
@@ -63,7 +64,7 @@ install_compiled_pkg()
 #
 # These packages have an old ./configure that take the GAP_ROOT as a positional
 # argument
-for pkg in cohomolo-* grape-* guava-*
+for pkg in cohomolo-* crypting-* grape-* guava-*
 do
     echo "Building GAP package $pkg"
     cd "$PKG_SRC_DIR/$pkg"
```

However, this still needs work, as building fails with 

```
[gap_packages-4.10.0] Building GAP package crypting-0.9
[gap_packages-4.10.0] Using config in /home/dimpase/Sage/sagetrac-mirror/local/share/gap/sysinfo.gap
[gap_packages-4.10.0] Building gap_packages-4.10.0
[gap_packages-4.10.0] make[2]: Entering directory '/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/crypting-0.9'
[gap_packages-4.10.0] /home/dimpase/Sage/sagetrac-mirror/local/share/gap/gac: 73: .: Can't open /home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src/sysinfo.gap
[gap_packages-4.10.0] Makefile:104: recipe for target 'obj/crypting.lo' failed
```

Basically, `gac` expects `sysinfo.gap` in the build tree, not in place announced in the 2nd line: `Using config in...`.



---

archive/issue_comments_423177.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI didn't look in detail into libtool yet...",
    "created_at": "2019-02-04T23:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423177",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'>Comment 4:</a>
I didn't look in detail into libtool yet...



---

archive/issue_comments_423178.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,18 @@\n-see the subject (to be edited)\n+cryping makes use of GAP's compiler (aka gac), and other tooling, namely, libtool.\n+\n+gac is installed with broken information about various paths and sysinfo.gap, and libtool isn't installed at all, it seems.\n+\n+Here is how gac's entries should be corrected:\n+\n+```\n+abs_top_srcdir=\"${SAGE_LOCAL}/share/gap/src\"\n+abs_top_builddir=\"${abs_top_srcdir}\" # obsolete naming...\n+```\n+and one should source `sysinfo.gap` as\n+\n+```\n+. \"${abs_top_builddir}/../sysinfo.gap\"\n+```\n+\n+libtool should be installed, as well as gac...\n+\n``````\n",
    "created_at": "2019-02-04T23:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423178",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,18 @@
-see the subject (to be edited)
+cryping makes use of GAP's compiler (aka gac), and other tooling, namely, libtool.
+
+gac is installed with broken information about various paths and sysinfo.gap, and libtool isn't installed at all, it seems.
+
+Here is how gac's entries should be corrected:
+
+```
+abs_top_srcdir="${SAGE_LOCAL}/share/gap/src"
+abs_top_builddir="${abs_top_srcdir}" # obsolete naming...
+```
+and one should source `sysinfo.gap` as
+
+```
+. "${abs_top_builddir}/../sysinfo.gap"
+```
+
+libtool should be installed, as well as gac...
+
``````




---

archive/issue_comments_423179.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n-cryping makes use of GAP's compiler (aka gac), and other tooling, namely, libtool.\n+crypting makes use of GAP's compiler (aka `gac`), and other tooling, namely, `libtool`.\n \n-gac is installed with broken information about various paths and sysinfo.gap, and libtool isn't installed at all, it seems.\n+`gac` is installed with broken information about various paths and `sysinfo.gap` location, and `libtool` isn't installed at all, it seems.\n \n Here is how gac's entries should be corrected:\n \n@@ -14,5 +14,5 @@\n . \"${abs_top_builddir}/../sysinfo.gap\"\n ```\n \n-libtool should be installed, as well as gac...\n+`libtool` should be installed along with `gac`.\n \n``````\n",
    "created_at": "2019-02-04T23:37:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423179",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
-cryping makes use of GAP's compiler (aka gac), and other tooling, namely, libtool.
+crypting makes use of GAP's compiler (aka `gac`), and other tooling, namely, `libtool`.
 
-gac is installed with broken information about various paths and sysinfo.gap, and libtool isn't installed at all, it seems.
+`gac` is installed with broken information about various paths and `sysinfo.gap` location, and `libtool` isn't installed at all, it seems.
 
 Here is how gac's entries should be corrected:
 
@@ -14,5 +14,5 @@
 . "${abs_top_builddir}/../sysinfo.gap"
 ```
 
-libtool should be installed, as well as gac...
+`libtool` should be installed along with `gac`.
 
``````




---

archive/issue_comments_423180.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAfter fixing `gac` as above, I get\n\n```\n[gap_packages-4.10.0] Building GAP package crypting-0.9\n[gap_packages-4.10.0] Using config in /home/dimpase/Sage/sagetrac-mirror/local/share/gap/sysinfo.gap\n[gap_packages-4.10.0] Building gap_packages-4.10.0\n[gap_packages-4.10.0] make[2]: Entering directory '/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/crypting-0.9'\n[gap_packages-4.10.0] /bin/bash /home/dimpase/Sage/sagetrac-mirror/local/share/gap/src/libtool --mode=compile gcc -O2 -g -MQ obj/crypting.lo -MMD -MP -MF obj/.deps/crypting.d -o obj/crypting.lo -I/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src/src -I/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/home/dimpase/Sage/sagetrac-mirror/local/include -c src/crypting.c\n[gap_packages-4.10.0] /bin/bash: /home/dimpase/Sage/sagetrac-mirror/local/share/gap/src/libtool: No such file or directory\n[gap_packages-4.10.0] Makefile:104: recipe for target 'obj/crypting.lo' failed\n```",
    "created_at": "2019-02-04T23:58:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423180",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'>Comment 6:</a>
After fixing `gac` as above, I get

```
[gap_packages-4.10.0] Building GAP package crypting-0.9
[gap_packages-4.10.0] Using config in /home/dimpase/Sage/sagetrac-mirror/local/share/gap/sysinfo.gap
[gap_packages-4.10.0] Building gap_packages-4.10.0
[gap_packages-4.10.0] make[2]: Entering directory '/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap_packages-4.10.0/src/pkg/crypting-0.9'
[gap_packages-4.10.0] /bin/bash /home/dimpase/Sage/sagetrac-mirror/local/share/gap/src/libtool --mode=compile gcc -O2 -g -MQ obj/crypting.lo -MMD -MP -MF obj/.deps/crypting.d -o obj/crypting.lo -I/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src/gen -I/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src/src -I/home/dimpase/Sage/sagetrac-mirror/local/var/tmp/sage/build/gap-4.10.0/src -DHAVE_CONFIG_H -I/home/dimpase/Sage/sagetrac-mirror/local/include -c src/crypting.c
[gap_packages-4.10.0] /bin/bash: /home/dimpase/Sage/sagetrac-mirror/local/share/gap/src/libtool: No such file or directory
[gap_packages-4.10.0] Makefile:104: recipe for target 'obj/crypting.lo' failed
```



---

archive/issue_comments_423181.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nWhat an horrible little thing. It relies on gap's libtool to be configured I am guessing. `gac` should just go and die, I haven't changed my opinion since previous version of gap. Using all this stuff to fail to build something from one source file and installing it? Priceless.\n\nAt least `IO` uses real autotools so things are more easily correctable. Here I feel like using\n* a patch (same issue as `IO`)\n* a one liner compilation in spkg-install - libtool makes it easy to have the right extension so may be more line just to have that right\n* manual installation where gap expect it. That involves sourcing `sysinfo.gap` to find `GAParch`.\n\nOne liner: `$CC -shared -fPIC ${CFLAGS} crypting.{SOEXT} src/crypting.c`",
    "created_at": "2019-02-05T01:38:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423181",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'>Comment 7:</a>
What an horrible little thing. It relies on gap's libtool to be configured I am guessing. `gac` should just go and die, I haven't changed my opinion since previous version of gap. Using all this stuff to fail to build something from one source file and installing it? Priceless.

At least `IO` uses real autotools so things are more easily correctable. Here I feel like using
* a patch (same issue as `IO`)
* a one liner compilation in spkg-install - libtool makes it easy to have the right extension so may be more line just to have that right
* manual installation where gap expect it. That involves sourcing `sysinfo.gap` to find `GAParch`.

One liner: `$CC -shared -fPIC ${CFLAGS} crypting.{SOEXT} src/crypting.c`



---

archive/issue_events_343213.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:39:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343213"
}
```



---

archive/issue_events_343214.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:39:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343214"
}
```



---

archive/issue_events_343215.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:39:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343215"
}
```



---

archive/issue_events_343216.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:39:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343216"
}
```



---

archive/issue_comments_423182.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nThe following works:\n\n1) create a symbolic link from SAGE_LOCAL/include/gap to SAGE_LOCAL/include/src\n(this makes the patch for include locations unnecessary, also for GAP's IO\n\n2) install GAP's libtool the same way we install gac.\n(it should be one level below gac, in src/ subdirectory)\n\n3) patch gac as explained\n\nafter this, with the patch in comment 2, crypting gets installed just fine.\n\n\n---\n\nmy plan is now to do everything on #26930, and close this one, because it's too many small interconnecting things.",
    "created_at": "2019-02-05T13:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423182",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'>Comment 8:</a>
The following works:

1) create a symbolic link from SAGE_LOCAL/include/gap to SAGE_LOCAL/include/src
(this makes the patch for include locations unnecessary, also for GAP's IO

2) install GAP's libtool the same way we install gac.
(it should be one level below gac, in src/ subdirectory)

3) patch gac as explained

after this, with the patch in comment 2, crypting gets installed just fine.


---

my plan is now to do everything on #26930, and close this one, because it's too many small interconnecting things.



---

archive/issue_events_343217.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:40:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343217"
}
```



---

archive/issue_events_343218.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-05T13:40:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343218"
}
```



---

archive/issue_comments_423183.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2019-02-05T13:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423183",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_423184.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nfurther work on this on #26930",
    "created_at": "2019-02-05T13:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423184",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'>Comment 9:</a>
further work on this on #26930



---

archive/issue_comments_423185.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI think you're trying to combine too many different things in #26930.  Let's repurpose this ticket for fixing aspects of the GAP \"installation\" such as `sysinfo.gap` and correct installation of `gac`.\n\nThen you can make #26930 depend on this.",
    "created_at": "2019-02-05T15:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423185",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'>Comment 10:</a>
I think you're trying to combine too many different things in #26930.  Let's repurpose this ticket for fixing aspects of the GAP "installation" such as `sysinfo.gap` and correct installation of `gac`.

Then you can make #26930 depend on this.



---

archive/issue_events_343219.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T15:37:15Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "title_is": "Fix problems with GAP installation affecting building of compiled GAP packages",
    "title_was": "add GAP package crypting and possibly more.",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343219"
}
```



---

archive/issue_events_343220.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T15:37:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343220"
}
```



---

archive/issue_events_343221.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T15:37:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343221"
}
```



---

archive/issue_events_343222.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T15:37:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343222"
}
```



---

archive/issue_comments_423186.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nSo it appears that for building various compiled packages, their build system assumes you're also running GAP itself out of a source tree, such that various build-related utilities and files used for building GAP itself can be repurposed for building GAP packages.\n\nPart of me is almost tempted to say that GAP packages should be built in a GAP build tree (i.e. re-extracting the main GAP source tarball, running `./configure` in it (though maybe not `make`; unclear) and then building the extension package.\n\nHowever, what is actually needed for this might be narrow enough that we can install it into `share/gap`.  It's also clear that the `sysinfo.gap` file needs to be patched up.  Let me examine exactly what the \"crypting\" package is trying to do before moving forward.",
    "created_at": "2019-02-05T15:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423186",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'>Comment 11:</a>
So it appears that for building various compiled packages, their build system assumes you're also running GAP itself out of a source tree, such that various build-related utilities and files used for building GAP itself can be repurposed for building GAP packages.

Part of me is almost tempted to say that GAP packages should be built in a GAP build tree (i.e. re-extracting the main GAP source tarball, running `./configure` in it (though maybe not `make`; unclear) and then building the extension package.

However, what is actually needed for this might be narrow enough that we can install it into `share/gap`.  It's also clear that the `sysinfo.gap` file needs to be patched up.  Let me examine exactly what the "crypting" package is trying to do before moving forward.



---

archive/issue_events_343223.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T15:41:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "title_is": "Ensure that GAP's package build toolchain is fully available for building compiled package",
    "title_was": "Fix problems with GAP installation affecting building of compiled GAP packages",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343223"
}
```



---

archive/issue_comments_423187.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI got crypting pkg building out of the build tree, see my comments above.",
    "created_at": "2019-02-05T15:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423187",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'>Comment 13:</a>
I got crypting pkg building out of the build tree, see my comments above.



---

archive/issue_comments_423188.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nAlso clearly `gac` needs to be fixed.  It *is* installed (something I recall making sure of), but I didn't realize that it was partially generated, with hard-coded paths in it :(",
    "created_at": "2019-02-05T15:58:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423188",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'>Comment 14:</a>
Also clearly `gac` needs to be fixed.  It *is* installed (something I recall making sure of), but I didn't realize that it was partially generated, with hard-coded paths in it :(



---

archive/issue_comments_423189.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@embray](#comment%3A14):\n> Also clearly `gac` needs to be fixed.  It *is* installed (something I recall making sure of), but I didn't realize that it was partially generated, with hard-coded paths in it :(\n\nWell, this should have been clear from the ticket description.It suffices to do the changes as indicated there for it to be good enough for the job. And while clearing up sysinfo.gap would be nice, I'd rather leave it to upstream.",
    "created_at": "2019-02-05T16:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423189",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@embray](#comment%3A14):
> Also clearly `gac` needs to be fixed.  It *is* installed (something I recall making sure of), but I didn't realize that it was partially generated, with hard-coded paths in it :(

Well, this should have been clear from the ticket description.It suffices to do the changes as indicated there for it to be good enough for the job. And while clearing up sysinfo.gap would be nice, I'd rather leave it to upstream.



---

archive/issue_comments_423190.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@dimpase](#comment%3A15):\n> Replying to [@embray](#comment%3A14):\n> > Also clearly `gac` needs to be fixed.  It *is* installed (something I recall making sure of), but I didn't realize that it was partially generated, with hard-coded paths in it :(\n\n> \n> Well, this should have been clear from the ticket description.It suffices to do the changes as indicated there for it to be good enough for the job. And while clearing up sysinfo.gap would be nice, I'd rather leave it to upstream.\n\nYes, I was just confirming.\n\nI think sysinfo.gap needs to be fixed as well, but that's easy enough.\n\nI would rather leave *all* of this to upstream, though maybe our experiences here will help me help them improve the installation system for GAP.",
    "created_at": "2019-02-05T16:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423190",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@dimpase](#comment%3A15):
> Replying to [@embray](#comment%3A14):
> > Also clearly `gac` needs to be fixed.  It *is* installed (something I recall making sure of), but I didn't realize that it was partially generated, with hard-coded paths in it :(

> 
> Well, this should have been clear from the ticket description.It suffices to do the changes as indicated there for it to be good enough for the job. And while clearing up sysinfo.gap would be nice, I'd rather leave it to upstream.

Yes, I was just confirming.

I think sysinfo.gap needs to be fixed as well, but that's easy enough.

I would rather leave *all* of this to upstream, though maybe our experiences here will help me help them improve the installation system for GAP.



---

archive/issue_comments_423191.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nAre you planning to work on this? If not, should I have a go at it?",
    "created_at": "2019-02-05T16:33:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423191",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'>Comment 17:</a>
Are you planning to work on this? If not, should I have a go at it?



---

archive/issue_comments_423192.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nWith this fix, which is admittedly a hack (but an appropriate one), I was able to compile the crypting package from just any arbitrary location so long as I ran `configure $SAGE_LOCAL/share/gap` first.\n\nActually *installing* is another question, albeit mostly just a question of copying the source tree for the package into `$SAGE_LOCAL/share/gap/pkg` while making sure to strip out any build artifacts.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe9f442280f9f3731284579175ee748b428c864b\">fe9f442</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>\n",
    "created_at": "2019-02-05T16:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423192",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'>Comment 18:</a>
With this fix, which is admittedly a hack (but an appropriate one), I was able to compile the crypting package from just any arbitrary location so long as I ran `configure $SAGE_LOCAL/share/gap` first.

Actually *installing* is another question, albeit mostly just a question of copying the source tree for the package into `$SAGE_LOCAL/share/gap/pkg` while making sure to strip out any build artifacts.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe9f442280f9f3731284579175ee748b428c864b">fe9f442</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>




---

archive/issue_comments_423193.json:
```json
{
    "body": "Author: **Erik Bray**",
    "created_at": "2019-02-05T16:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423193",
    "user": "https://github.com/embray"
}
```

Author: **Erik Bray**



---

archive/issue_events_343224.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T16:37:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343224"
}
```



---

archive/issue_events_343225.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-05T16:37:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343225"
}
```



---

archive/issue_comments_423194.json:
```json
{
    "body": "Branch: **[u/embray/ticket-27218](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-27218)**",
    "created_at": "2019-02-05T16:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423194",
    "user": "https://github.com/embray"
}
```

Branch: **[u/embray/ticket-27218](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-27218)**



---

archive/issue_comments_423195.json:
```json
{
    "body": "Commit: **[fe9f442](https://github.com/sagemath/sagetrac-mirror/commit/fe9f442280f9f3731284579175ee748b428c864b)**",
    "created_at": "2019-02-05T16:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423195",
    "user": "https://github.com/embray"
}
```

Commit: **[fe9f442](https://github.com/sagemath/sagetrac-mirror/commit/fe9f442280f9f3731284579175ee748b428c864b)**



---

archive/issue_comments_423196.json:
```json
{
    "body": "Changed dependencies from **#26930** to none",
    "created_at": "2019-02-05T16:37:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423196",
    "user": "https://github.com/embray"
}
```

Changed dependencies from **#26930** to none



---

archive/issue_comments_423197.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nThis also worked for configuring and compiling the IO package without any needless patches.",
    "created_at": "2019-02-05T16:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423197",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'>Comment 20:</a>
This also worked for configuring and compiling the IO package without any needless patches.



---

archive/issue_comments_423198.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\ncould you also add to this branch the installation of crypting and io in gap_packages/spkg-install ? This would be a good test.",
    "created_at": "2019-02-05T16:45:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423198",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'>Comment 21:</a>
could you also add to this branch the installation of crypting and io in gap_packages/spkg-install ? This would be a good test.



---

archive/issue_comments_423199.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nThis is important if anyone wants to install compiled GAP packages with Sage's GAP, whether manually, or through an SPKG.",
    "created_at": "2019-02-05T16:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423199",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'>Comment 22:</a>
This is important if anyone wants to install compiled GAP packages with Sage's GAP, whether manually, or through an SPKG.



---

archive/issue_comments_423200.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nReplying to [@dimpase](#comment%3A21):\n> could you also add to this branch the installation of crypting and io in gap_packages/spkg-install ? This would be a good test.\n\nWorking on that now.",
    "created_at": "2019-02-05T16:46:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423200",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'>Comment 23:</a>
Replying to [@dimpase](#comment%3A21):
> could you also add to this branch the installation of crypting and io in gap_packages/spkg-install ? This would be a good test.

Working on that now.



---

archive/issue_comments_423201.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nActually, this should also bump the patch-level on the GAP SPKG.",
    "created_at": "2019-02-05T16:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423201",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'>Comment 24:</a>
Actually, this should also bump the patch-level on the GAP SPKG.



---

archive/issue_comments_423202.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a2aaa89afe10cdefe6d09cde6a04f6ac3aec207\">5a2aaa8</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>\n",
    "created_at": "2019-02-05T16:47:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423202",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a2aaa89afe10cdefe6d09cde6a04f6ac3aec207">5a2aaa8</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>




---

archive/issue_comments_423203.json:
```json
{
    "body": "Changed commit from **[fe9f442](https://github.com/sagemath/sagetrac-mirror/commit/fe9f442280f9f3731284579175ee748b428c864b)** to **[5a2aaa8](https://github.com/sagemath/sagetrac-mirror/commit/5a2aaa89afe10cdefe6d09cde6a04f6ac3aec207)**",
    "created_at": "2019-02-05T16:47:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423203",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fe9f442](https://github.com/sagemath/sagetrac-mirror/commit/fe9f442280f9f3731284579175ee748b428c864b)** to **[5a2aaa8](https://github.com/sagemath/sagetrac-mirror/commit/5a2aaa89afe10cdefe6d09cde6a04f6ac3aec207)**



---

archive/issue_comments_423204.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nFor the record I don't intend to install gap's libtool in sage-on-gentoo. Yes gap has ugly bits just like sage had 10 years ago. `gac` could be an interesting tool once fixed and `sysinfo.gap` similarly needs to be more conform to an installation rather than an in tree thing. \n\nIn the few packages where it was important so far, only `GAParch` was really needed for an install for me. The rest was superfluous. It would be useful if `sysinfo.gap` had the proper include path so the problem of `#include \"src/...\"` versus `#include \"gap/...\"` would go away. Sounds like a job for pkg-config.",
    "created_at": "2019-02-05T19:30:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423204",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'>Comment 26:</a>
For the record I don't intend to install gap's libtool in sage-on-gentoo. Yes gap has ugly bits just like sage had 10 years ago. `gac` could be an interesting tool once fixed and `sysinfo.gap` similarly needs to be more conform to an installation rather than an in tree thing. 

In the few packages where it was important so far, only `GAParch` was really needed for an install for me. The rest was superfluous. It would be useful if `sysinfo.gap` had the proper include path so the problem of `#include "src/..."` versus `#include "gap/..."` would go away. Sounds like a job for pkg-config.



---

archive/issue_comments_423205.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nReplying to [@kiwifb](#comment%3A26):\n> For the record I don't intend to install gap's libtool in sage-on-gentoo.\n\nTypically, `libtool` is not installed. It is shipped as part of the package installer and only used as build tool, analogous to `configure` for example.",
    "created_at": "2019-02-06T09:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423205",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'>Comment 27:</a>
Replying to [@kiwifb](#comment%3A26):
> For the record I don't intend to install gap's libtool in sage-on-gentoo.

Typically, `libtool` is not installed. It is shipped as part of the package installer and only used as build tool, analogous to `configure` for example.



---

archive/issue_comments_423206.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nGiven that we use the same tarball for gap and for gap_packages, couldn't we just run `libtool` from the source tarball, the way how it's usually done?",
    "created_at": "2019-02-06T10:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423206",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'>Comment 28:</a>
Given that we use the same tarball for gap and for gap_packages, couldn't we just run `libtool` from the source tarball, the way how it's usually done?



---

archive/issue_comments_423207.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@jdemeyer](#comment%3A28):\n> Given that we use the same tarball for gap and for gap_packages, couldn't we just run `libtool` from the source tarball, the way how it's usually done?\n\nnot all GAP packages live in this tarball. Not installing the necessary components to build GAP packages will lead to a half-broken GAP installation. I don't think it's a good idea.",
    "created_at": "2019-02-06T10:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423207",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@jdemeyer](#comment%3A28):
> Given that we use the same tarball for gap and for gap_packages, couldn't we just run `libtool` from the source tarball, the way how it's usually done?

not all GAP packages live in this tarball. Not installing the necessary components to build GAP packages will lead to a half-broken GAP installation. I don't think it's a good idea.



---

archive/issue_events_343226.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-06T11:24:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343226"
}
```



---

archive/issue_events_343227.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-06T11:24:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343227"
}
```



---

archive/issue_comments_423208.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nRegarding this branch:\n\n```\n[gap_packages-4.10.0.p0] Building GAP package crypting-0.9\n[gap_packages-4.10.0.p0] Using config in /mnt/opt/Sage/sage-dev/local/share/gap/sysinfo.gap\n[gap_packages-4.10.0.p0] Building gap_packages-4.10.0.p0\n[gap_packages-4.10.0.p0] make[2]: Entering directory '/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap_packages-4.10.0.p0/src/pkg/crypting-0.9'\n[gap_packages-4.10.0.p0] /usr/bin/bash /mnt/opt/Sage/sage-dev/local/share/gap/libtool --mode=compile gcc -O2 -g -MQ obj/crypting.lo -MMD -MP -MF obj/.deps/crypting.d -o obj/crypting.lo -I/mnt/opt/Sage/sage-dev/local/share/gap/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include -c src/crypting.c\n[gap_packages-4.10.0.p0] libtool: compile:  gcc -O2 -g -MQ obj/crypting.lo -MMD -MP -MF obj/.deps/crypting.d -I/mnt/opt/Sage/sage-dev/local/share/gap/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include -c src/crypting.c  -fPIC -DPIC -o obj/.libs/crypting.o\n[gap_packages-4.10.0.p0] src/crypting.c:5:10: fatal error: src/compiled.h: No such file or directory\n[gap_packages-4.10.0.p0]  #include \"src/compiled.h\"          /* GAP headers */\n[gap_packages-4.10.0.p0]           ^~~~~~~~~~~~~~~~\n```\n\nThat is, one still needs to take care of header location.\nE.g.\n\n```\nln -s $SAGE_LOCAL/include/gap $SAGE_LOCAL/include/src\n```\nallows crypting to be installed using the patch in comment 2.\nWould you like this header issue to be solved here, or done on #26930?",
    "created_at": "2019-02-06T11:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423208",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'>Comment 30:</a>
Regarding this branch:

```
[gap_packages-4.10.0.p0] Building GAP package crypting-0.9
[gap_packages-4.10.0.p0] Using config in /mnt/opt/Sage/sage-dev/local/share/gap/sysinfo.gap
[gap_packages-4.10.0.p0] Building gap_packages-4.10.0.p0
[gap_packages-4.10.0.p0] make[2]: Entering directory '/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap_packages-4.10.0.p0/src/pkg/crypting-0.9'
[gap_packages-4.10.0.p0] /usr/bin/bash /mnt/opt/Sage/sage-dev/local/share/gap/libtool --mode=compile gcc -O2 -g -MQ obj/crypting.lo -MMD -MP -MF obj/.deps/crypting.d -o obj/crypting.lo -I/mnt/opt/Sage/sage-dev/local/share/gap/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include -c src/crypting.c
[gap_packages-4.10.0.p0] libtool: compile:  gcc -O2 -g -MQ obj/crypting.lo -MMD -MP -MF obj/.deps/crypting.d -I/mnt/opt/Sage/sage-dev/local/share/gap/gen -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src/src -I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src -DHAVE_CONFIG_H -I/mnt/opt/Sage/sage-dev/local/include -c src/crypting.c  -fPIC -DPIC -o obj/.libs/crypting.o
[gap_packages-4.10.0.p0] src/crypting.c:5:10: fatal error: src/compiled.h: No such file or directory
[gap_packages-4.10.0.p0]  #include "src/compiled.h"          /* GAP headers */
[gap_packages-4.10.0.p0]           ^~~~~~~~~~~~~~~~
```

That is, one still needs to take care of header location.
E.g.

```
ln -s $SAGE_LOCAL/include/gap $SAGE_LOCAL/include/src
```
allows crypting to be installed using the patch in comment 2.
Would you like this header issue to be solved here, or done on #26930?



---

archive/issue_comments_423209.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nReplying to [@kiwifb](#comment%3A26):\n> For the record I don't intend to install gap's libtool in sage-on-gentoo. Yes gap has ugly bits just like sage had 10 years ago.\n\nYou mean just like sage has now? ;)",
    "created_at": "2019-02-06T12:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423209",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'>Comment 31:</a>
Replying to [@kiwifb](#comment%3A26):
> For the record I don't intend to install gap's libtool in sage-on-gentoo. Yes gap has ugly bits just like sage had 10 years ago.

You mean just like sage has now? ;)



---

archive/issue_comments_423210.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nSomething about this still isn't working right then, because this\n\n```\n-I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src/src\n```\n\nshould not be in the compile flags.  I thought I made sure there would be no more references to the build directory, but I was tired last night when I was working on this so I must have missed something.\n\nAlso I agree with Jeroen of course that normally a libtool script should not be installed, though in this case it might be reasonable to do.",
    "created_at": "2019-02-06T12:27:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423210",
    "user": "https://github.com/embray"
}
```

<a id='comment:32'>Comment 32:</a>
Something about this still isn't working right then, because this

```
-I/mnt/opt/Sage/sage-dev/local/var/tmp/sage/build/gap-4.10.0.p0/src/src
```

should not be in the compile flags.  I thought I made sure there would be no more references to the build directory, but I was tired last night when I was working on this so I must have missed something.

Also I agree with Jeroen of course that normally a libtool script should not be installed, though in this case it might be reasonable to do.



---

archive/issue_events_343228.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-06T12:27:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343228"
}
```



---

archive/issue_events_343229.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-06T12:27:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343229"
}
```



---

archive/issue_comments_423211.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nOops, duh, I left a `g` off the sed replacement pattern.  That's why you correctly have `-I/mnt/opt/Sage/sage-dev/local/share/gap/gen`, but then the rest of the `-I` flags still have the wrong path \ud83e\udd26\ud83c\udffc\u200d\u2640\ufe0f",
    "created_at": "2019-02-06T12:35:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423211",
    "user": "https://github.com/embray"
}
```

<a id='comment:34'>Comment 34:</a>
Oops, duh, I left a `g` off the sed replacement pattern.  That's why you correctly have `-I/mnt/opt/Sage/sage-dev/local/share/gap/gen`, but then the rest of the `-I` flags still have the wrong path 



---

archive/issue_comments_423212.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nBy the way, you should use `$SED`, not `sed`, right?",
    "created_at": "2019-02-06T12:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423212",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'>Comment 35:</a>
By the way, you should use `$SED`, not `sed`, right?



---

archive/issue_comments_423213.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nI can confirm that after adding that `|g` to `sed` pattern, everything is fine, great!\nPlease fix this in your branch, and you can flip it to positive review then.",
    "created_at": "2019-02-06T12:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423213",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'>Comment 36:</a>
I can confirm that after adding that `|g` to `sed` pattern, everything is fine, great!
Please fix this in your branch, and you can flip it to positive review then.



---

archive/issue_comments_423214.json:
```json
{
    "body": "Changed commit from **[5a2aaa8](https://github.com/sagemath/sagetrac-mirror/commit/5a2aaa89afe10cdefe6d09cde6a04f6ac3aec207)** to **[631a541](https://github.com/sagemath/sagetrac-mirror/commit/631a5415da905628b25144212ee08be7ab50c2f4)**",
    "created_at": "2019-02-06T13:59:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423214",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5a2aaa8](https://github.com/sagemath/sagetrac-mirror/commit/5a2aaa89afe10cdefe6d09cde6a04f6ac3aec207)** to **[631a541](https://github.com/sagemath/sagetrac-mirror/commit/631a5415da905628b25144212ee08be7ab50c2f4)**



---

archive/issue_comments_423215.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/631a5415da905628b25144212ee08be7ab50c2f4\">631a541</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>\n",
    "created_at": "2019-02-06T13:59:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423215",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:37'>Comment 37:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/631a5415da905628b25144212ee08be7ab50c2f4">631a541</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>




---

archive/issue_comments_423216.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nShould also fix up `bin/gap.sh` (although we don't use it in Sage, it should still contain the correct paths, maybe just in case some pkg uses it during a build) and also `doc/make_doc` contains references to the GAP builddir.",
    "created_at": "2019-02-06T14:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423216",
    "user": "https://github.com/embray"
}
```

<a id='comment:38'>Comment 38:</a>
Should also fix up `bin/gap.sh` (although we don't use it in Sage, it should still contain the correct paths, maybe just in case some pkg uses it during a build) and also `doc/make_doc` contains references to the GAP builddir.



---

archive/issue_comments_423217.json:
```json
{
    "body": "Changed commit from **[631a541](https://github.com/sagemath/sagetrac-mirror/commit/631a5415da905628b25144212ee08be7ab50c2f4)** to **[3827170](https://github.com/sagemath/sagetrac-mirror/commit/38271700f9323038b8268edcf4d7bb817dc7bf74)**",
    "created_at": "2019-02-06T14:19:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423217",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[631a541](https://github.com/sagemath/sagetrac-mirror/commit/631a5415da905628b25144212ee08be7ab50c2f4)** to **[3827170](https://github.com/sagemath/sagetrac-mirror/commit/38271700f9323038b8268edcf4d7bb817dc7bf74)**



---

archive/issue_comments_423218.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38271700f9323038b8268edcf4d7bb817dc7bf74\">3827170</a></td><td><code>make similar replacements in a couple more files that reference the GAP build directory</code></td></tr></table>\n",
    "created_at": "2019-02-06T14:19:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423218",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>Comment 39:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38271700f9323038b8268edcf4d7bb817dc7bf74">3827170</a></td><td><code>make similar replacements in a couple more files that reference the GAP build directory</code></td></tr></table>




---

archive/issue_comments_423219.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nReplying to [@dimpase](#comment%3A35):\n> By the way, you should use `$SED`, not `sed`, right?\n\nThat's generally just in an autoconf macro, where if you have done `AC_PROG_SED`.  It's not necessarily bad practice to use a `$SED` variable either, in case it needs to be overridden for some reason, but in that case you'd still have to set a default somewhere, and we aren't doing that in any other `spkg-install` script.",
    "created_at": "2019-02-06T14:22:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423219",
    "user": "https://github.com/embray"
}
```

<a id='comment:40'>Comment 40:</a>
Replying to [@dimpase](#comment%3A35):
> By the way, you should use `$SED`, not `sed`, right?

That's generally just in an autoconf macro, where if you have done `AC_PROG_SED`.  It's not necessarily bad practice to use a `$SED` variable either, in case it needs to be overridden for some reason, but in that case you'd still have to set a default somewhere, and we aren't doing that in any other `spkg-install` script.



---

archive/issue_events_343230.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-06T14:22:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343230"
}
```



---

archive/issue_events_343231.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-06T14:22:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343231"
}
```



---

archive/issue_events_343232.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-06T15:23:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343232"
}
```



---

archive/issue_events_343233.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-02-06T15:23:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343233"
}
```



---

archive/issue_comments_423220.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nOK, thanks!",
    "created_at": "2019-02-06T15:23:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423220",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'>Comment 42:</a>
OK, thanks!



---

archive/issue_comments_423221.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nReplying to [@embray](#comment%3A31):\n> Replying to [@kiwifb](#comment%3A26):\n> > For the record I don't intend to install gap's libtool in sage-on-gentoo. Yes gap has ugly bits just like sage had 10 years ago.\n\n> \n> You mean just like sage has now? ;)\n\nYes :) but 10 years ago it was way worse. Where do you want me to start ;) Enough off topic from me.",
    "created_at": "2019-02-06T17:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423221",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:43'>Comment 43:</a>
Replying to [@embray](#comment%3A31):
> Replying to [@kiwifb](#comment%3A26):
> > For the record I don't intend to install gap's libtool in sage-on-gentoo. Yes gap has ugly bits just like sage had 10 years ago.

> 
> You mean just like sage has now? ;)

Yes :) but 10 years ago it was way worse. Where do you want me to start ;) Enough off topic from me.



---

archive/issue_comments_423222.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nOn OSX:\n\n```\nsed: 1: \"/Users/buildslave-sage/ ...\": undefined label 'uildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/gap-4.10.0.p0/inst/Users/buildslave-sage/slave/sage_git/build/local/bin/gac'\n```",
    "created_at": "2019-02-08T12:35:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423222",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:44'>Comment 44:</a>
On OSX:

```
sed: 1: "/Users/buildslave-sage/ ...": undefined label 'uildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/gap-4.10.0.p0/inst/Users/buildslave-sage/slave/sage_git/build/local/bin/gac'
```



---

archive/issue_events_343234.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-08T12:35:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343234"
}
```



---

archive/issue_events_343235.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-08T12:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343235"
}
```



---

archive/issue_comments_423223.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nIt appears on OSX you need `sed -i -e <pattern>` or else it will treat `<pattern>` as the optional parameter to `-i`.  I really hate this platform.",
    "created_at": "2019-02-08T12:53:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423223",
    "user": "https://github.com/embray"
}
```

<a id='comment:45'>Comment 45:</a>
It appears on OSX you need `sed -i -e <pattern>` or else it will treat `<pattern>` as the optional parameter to `-i`.  I really hate this platform.



---

archive/issue_comments_423224.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6\">ca94bd9</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>\n",
    "created_at": "2019-02-08T13:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423224",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:46'>Comment 46:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6">ca94bd9</a></td><td><code>Trac #27218: Ensure that the same libtool that was used to build GAP is also</code></td></tr></table>




---

archive/issue_comments_423225.json:
```json
{
    "body": "Changed commit from **[3827170](https://github.com/sagemath/sagetrac-mirror/commit/38271700f9323038b8268edcf4d7bb817dc7bf74)** to **[ca94bd9](https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6)**",
    "created_at": "2019-02-08T13:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423225",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3827170](https://github.com/sagemath/sagetrac-mirror/commit/38271700f9323038b8268edcf4d7bb817dc7bf74)** to **[ca94bd9](https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6)**



---

archive/issue_comments_423226.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nReplying to [@embray](#comment%3A45):\n> It appears on OSX you need `sed -i -e <pattern>` or else it will treat `<pattern>` as the optional parameter to `-i`.  I really hate this platform.\n\nYes, this hit us already at #25321 (\"sed -i is not portable\").",
    "created_at": "2019-02-09T00:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423226",
    "user": "https://github.com/slel"
}
```

<a id='comment:47'>Comment 47:</a>
Replying to [@embray](#comment%3A45):
> It appears on OSX you need `sed -i -e <pattern>` or else it will treat `<pattern>` as the optional parameter to `-i`.  I really hate this platform.

Yes, this hit us already at #25321 ("sed -i is not portable").



---

archive/issue_comments_423227.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nThis particular bug is fixed, but I still cannot reinstall GAP spkg on OSX without first manually removing all of `SAGE_LOCAL/share/gap`. Some file permissions are wrong (on OSX)...",
    "created_at": "2019-02-09T08:27:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423227",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'>Comment 48:</a>
This particular bug is fixed, but I still cannot reinstall GAP spkg on OSX without first manually removing all of `SAGE_LOCAL/share/gap`. Some file permissions are wrong (on OSX)...



---

archive/issue_comments_423228.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nAlso, on OSX paths to binary files of GAP packages are not correct. E.g. `local/lib/gap/pkg/io-4.5.4/x86_64-apple-darwin17.7.0-default64/` instead of `local/lib/gap/pkg/io-4.5.4/bin/x86_64-apple-darwin17.7.0-default64/`, and IO package does not load.\nIf I do \n\n```\n$ mkdir local/lib/gap/pkg/io-4.5.4/bin\n$ mv local/lib/gap/pkg/io-4.5.4/x86_64-apple-darwin17.7.0-default64 local/lib/gap/pkg/io-4.5.4\n```\nthen it works.",
    "created_at": "2019-02-09T10:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423228",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:49'>Comment 49:</a>
Also, on OSX paths to binary files of GAP packages are not correct. E.g. `local/lib/gap/pkg/io-4.5.4/x86_64-apple-darwin17.7.0-default64/` instead of `local/lib/gap/pkg/io-4.5.4/bin/x86_64-apple-darwin17.7.0-default64/`, and IO package does not load.
If I do 

```
$ mkdir local/lib/gap/pkg/io-4.5.4/bin
$ mv local/lib/gap/pkg/io-4.5.4/x86_64-apple-darwin17.7.0-default64 local/lib/gap/pkg/io-4.5.4
```
then it works.



---

archive/issue_comments_423229.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nperhaps one should switch from doing `cp` etc. to doing `install`, as suggested on https://github.com/gap-system/gap-distribution/issues/72",
    "created_at": "2019-02-09T13:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423229",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:50'>Comment 50:</a>
perhaps one should switch from doing `cp` etc. to doing `install`, as suggested on https://github.com/gap-system/gap-distribution/issues/72



---

archive/issue_events_343236.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-22T14:08:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343236"
}
```



---

archive/issue_events_343237.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-22T14:08:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343237"
}
```



---

archive/issue_comments_423230.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nForgot to set this back to needs review after fixing the sed call.  Other problems about uninstalling packages on OSX are separate and unrelated to this ticket (see e.g. #27124).",
    "created_at": "2019-02-22T14:08:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423230",
    "user": "https://github.com/embray"
}
```

<a id='comment:51'>Comment 51:</a>
Forgot to set this back to needs review after fixing the sed call.  Other problems about uninstalling packages on OSX are separate and unrelated to this ticket (see e.g. #27124).



---

archive/issue_comments_423231.json:
```json
{
    "body": "Changed branch from **[u/embray/ticket-27218](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-27218)** to **[ca94bd9](https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6)**",
    "created_at": "2019-02-23T23:14:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27218#issuecomment-423231",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/embray/ticket-27218](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-27218)** to **[ca94bd9](https://github.com/sagemath/sagetrac-mirror/commit/ca94bd97d73ee544c273fbb28cb774b3af12ecb6)**



---

archive/issue_events_343238.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-23T23:14:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343238"
}
```



---

archive/issue_events_343239.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a0743513726f9b7960367d97bdfa6ea8060e51df",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-02-23T23:14:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27218",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27218#event-343239"
}
```
