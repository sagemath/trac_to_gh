# Issue 27581: Initializing the components of a tensor field while declaring it

archive/issues_027344.json:
```json
{
    "body": "Currently (Sage 8.7), the definition of a tensor field on a differentiable manifold is a 2-step operation. For instance, for a vector field:\n\n```\nsage: M = Manifold(2, 'M')\nsage: X.<x,y> = M.chart()\nsage: v = M.vector_field()  # step 1: declaration\nsage: v[:] = -y, x          # step 2: initialization of components\nsage: v.display()\n-y d/dx + x d/dy\n```\nThis ticket adds the possibility to perform the definition in a single step:\n\n```\nsage: v = M.vector_field(-y, x)\nsage: v.display()\n-y d/dx + x d/dy\n```\nMoreover, some flexibility is introduced in passing the components: it can be a list:\n\n```\nsage: M.vector_field([-y, x]).display()\n-y d/dx + x d/dy\n```\nor more generally any iterable, like a vector of symbolic expressions:\n\n```\nsage: M.vector_field(vector([-y, x])).display()\n-y d/dx + x d/dy\n```\nThe components can also be provided in a vector frame distinct from the default one:\n\n```\nsage: f = M.vector_frame('f')\nsage: M.vector_field(y^2, -1, frame=f).display(f)\ny^2 f_0 - f_1\n```\nAn alternative is passing a dictionary, the keys of which are the vector frames in which the components are defined:\n\n```\nsage: M.vector_field({f: [y^2, -1]}).display(f)\ny^2 f_0 - f_1\n```\nThe dictionary is mandatory if the components are given in various frames at once:\n\n```\nsage: M.vector_field({X.frame(): [-y, x], f: [y^2, -1]}).display(f)\ny^2 f_0 - f_1\n```\n\nNote that the possibility of initializing the components while declaring a vector field was introduced on Euclidean spaces in #24623. This ticket extends this to any kind of differentiable manifold and any kind of tensor field.  Accordingly, the redefinition of the method `vector_field` in the class `EuclideanSpace` has been suppressed: it falls back now to the method `vector_field` of the mother class `DifferentiableManifold`.\n\nBasically the (optional) component initialization is performed by the method `TensorField._init_components`, which is invoked by all the end-user methods devoted to the creation of tensor fields on manifolds, i.e. the methods `automorphism_field`, `diff_form`, `multivector_field`, `one_form`, `sym_bilin_form_field`, `tensor_field` and `vector_field` of class `DifferentiableManifold`.\n\nCC:  @tscrim\n\nKeywords: tensor field, manifold\n\nBranch/Commit: [990a858f1ce18c6537f9c6de7603dcc58f4b9cc2](https://github.com/sagemath/sagetrac-mirror/commit/990a858f1ce18c6537f9c6de7603dcc58f4b9cc2)\n\nReviewer: Travis Scrimshaw\n\nAuthor: Eric Gourgoulhon\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27581\n\n",
    "closed_at": "2019-04-02T21:30:03Z",
    "created_at": "2019-03-31T14:28:19Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Initializing the components of a tensor field while declaring it",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27581",
    "user": "https://github.com/egourgoulhon"
}
```
Currently (Sage 8.7), the definition of a tensor field on a differentiable manifold is a 2-step operation. For instance, for a vector field:

```
sage: M = Manifold(2, 'M')
sage: X.<x,y> = M.chart()
sage: v = M.vector_field()  # step 1: declaration
sage: v[:] = -y, x          # step 2: initialization of components
sage: v.display()
-y d/dx + x d/dy
```
This ticket adds the possibility to perform the definition in a single step:

```
sage: v = M.vector_field(-y, x)
sage: v.display()
-y d/dx + x d/dy
```
Moreover, some flexibility is introduced in passing the components: it can be a list:

```
sage: M.vector_field([-y, x]).display()
-y d/dx + x d/dy
```
or more generally any iterable, like a vector of symbolic expressions:

```
sage: M.vector_field(vector([-y, x])).display()
-y d/dx + x d/dy
```
The components can also be provided in a vector frame distinct from the default one:

```
sage: f = M.vector_frame('f')
sage: M.vector_field(y^2, -1, frame=f).display(f)
y^2 f_0 - f_1
```
An alternative is passing a dictionary, the keys of which are the vector frames in which the components are defined:

```
sage: M.vector_field({f: [y^2, -1]}).display(f)
y^2 f_0 - f_1
```
The dictionary is mandatory if the components are given in various frames at once:

```
sage: M.vector_field({X.frame(): [-y, x], f: [y^2, -1]}).display(f)
y^2 f_0 - f_1
```

Note that the possibility of initializing the components while declaring a vector field was introduced on Euclidean spaces in #24623. This ticket extends this to any kind of differentiable manifold and any kind of tensor field.  Accordingly, the redefinition of the method `vector_field` in the class `EuclideanSpace` has been suppressed: it falls back now to the method `vector_field` of the mother class `DifferentiableManifold`.

Basically the (optional) component initialization is performed by the method `TensorField._init_components`, which is invoked by all the end-user methods devoted to the creation of tensor fields on manifolds, i.e. the methods `automorphism_field`, `diff_form`, `multivector_field`, `one_form`, `sym_bilin_form_field`, `tensor_field` and `vector_field` of class `DifferentiableManifold`.

CC:  @tscrim

Keywords: tensor field, manifold

Branch/Commit: [990a858f1ce18c6537f9c6de7603dcc58f4b9cc2](https://github.com/sagemath/sagetrac-mirror/commit/990a858f1ce18c6537f9c6de7603dcc58f4b9cc2)

Reviewer: Travis Scrimshaw

Author: Eric Gourgoulhon

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27581





---

archive/issue_comments_533970.json:
```json
{
    "body": "Changing branch from \"\" to \"public/manifolds/tensor_init_comp\"",
    "created_at": "2019-03-31T14:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533970",
    "user": "https://github.com/egourgoulhon"
}
```

Changing branch from "" to "public/manifolds/tensor_init_comp"



---

archive/issue_comments_533971.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[b2a0a7f](https://github.com/sagemath/sagetrac-mirror/commit/b2a0a7f64871e3a7cf34f7dfae9831f398289054)|`Add possibility to initialize the components while creating a vector field`|\n|[96ea4e7](https://github.com/sagemath/sagetrac-mirror/commit/96ea4e789115a8576b41a886cc190d91ae88dfb1)|`Add possibility to initialize the components while creating a differential form`|\n|[cc0ebfa](https://github.com/sagemath/sagetrac-mirror/commit/cc0ebfaa29b5cce9cbfb51867d2cc17d464956fb)|`Add possibility to initialize the components while creating a tensor field`|\n|[0b38c84](https://github.com/sagemath/sagetrac-mirror/commit/0b38c848772e73ed9129a358d87367aac3f21691)|`Add possibility to initialize the components while creating a field of tangent-space automorphisms`|\n|[22ad0ba](https://github.com/sagemath/sagetrac-mirror/commit/22ad0ba259c6d17a3ad7164c18debff8e43a2cb9)|`Add possibility to initialize the components while creating a multivector field`|\n|[ce2b064](https://github.com/sagemath/sagetrac-mirror/commit/ce2b064f6be21e4e4b1f321d79fb15725dd8d53c)|`Final clean up regarding the initialization of components at tensor field construction`|",
    "created_at": "2019-03-31T14:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533971",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[b2a0a7f](https://github.com/sagemath/sagetrac-mirror/commit/b2a0a7f64871e3a7cf34f7dfae9831f398289054)|`Add possibility to initialize the components while creating a vector field`|
|[96ea4e7](https://github.com/sagemath/sagetrac-mirror/commit/96ea4e789115a8576b41a886cc190d91ae88dfb1)|`Add possibility to initialize the components while creating a differential form`|
|[cc0ebfa](https://github.com/sagemath/sagetrac-mirror/commit/cc0ebfaa29b5cce9cbfb51867d2cc17d464956fb)|`Add possibility to initialize the components while creating a tensor field`|
|[0b38c84](https://github.com/sagemath/sagetrac-mirror/commit/0b38c848772e73ed9129a358d87367aac3f21691)|`Add possibility to initialize the components while creating a field of tangent-space automorphisms`|
|[22ad0ba](https://github.com/sagemath/sagetrac-mirror/commit/22ad0ba259c6d17a3ad7164c18debff8e43a2cb9)|`Add possibility to initialize the components while creating a multivector field`|
|[ce2b064](https://github.com/sagemath/sagetrac-mirror/commit/ce2b064f6be21e4e4b1f321d79fb15725dd8d53c)|`Final clean up regarding the initialization of components at tensor field construction`|



---

archive/issue_comments_533972.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-31T14:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533972",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_533973.json:
```json
{
    "body": "Changing commit from \"\" to \"ce2b064f6be21e4e4b1f321d79fb15725dd8d53c\"",
    "created_at": "2019-03-31T14:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533973",
    "user": "https://github.com/egourgoulhon"
}
```

Changing commit from "" to "ce2b064f6be21e4e4b1f321d79fb15725dd8d53c"



---

archive/issue_comments_533974.json:
```json
{
    "body": "<a id='comment:2'></a>\nHave to fix some merge conflict with Sage 8.8.beta0.",
    "created_at": "2019-03-31T14:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533974",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:2'></a>
Have to fix some merge conflict with Sage 8.8.beta0.



---

archive/issue_comments_533975.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-31T14:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533975",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_533976.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|\n|[990a858](https://github.com/sagemath/sagetrac-mirror/commit/990a858f1ce18c6537f9c6de7603dcc58f4b9cc2)|`Merge branch 'public/manifolds/tensor_init_comp' of git://trac.sagemath.org/sage into Sage 8.8.beta0`|",
    "created_at": "2019-03-31T16:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|
|[990a858](https://github.com/sagemath/sagetrac-mirror/commit/990a858f1ce18c6537f9c6de7603dcc58f4b9cc2)|`Merge branch 'public/manifolds/tensor_init_comp' of git://trac.sagemath.org/sage into Sage 8.8.beta0`|



---

archive/issue_comments_533977.json:
```json
{
    "body": "Changing commit from \"ce2b064f6be21e4e4b1f321d79fb15725dd8d53c\" to \"990a858f1ce18c6537f9c6de7603dcc58f4b9cc2\"",
    "created_at": "2019-03-31T16:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533977",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ce2b064f6be21e4e4b1f321d79fb15725dd8d53c" to "990a858f1ce18c6537f9c6de7603dcc58f4b9cc2"



---

archive/issue_comments_533978.json:
```json
{
    "body": "<a id='comment:4'></a>\nMerge conflict solved.",
    "created_at": "2019-03-31T16:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533978",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:4'></a>
Merge conflict solved.



---

archive/issue_comments_533979.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-31T16:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533979",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_533980.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-At the moment, the definition of a tensor field on a differentiable manifold is a 2-step operation. For instance, for a vector field:\n+Currently (Sage 8.7), the definition of a tensor field on a differentiable manifold is a 2-step operation. For instance, for a vector field:\n \n ```\n sage: M = Manifold(2, 'M')\n@@ -8,7 +8,7 @@\n sage: v.display()\n -y d/dx + x d/dy\n ```\n-With this ticket, this can be achieved in a single step:\n+This ticket adds the possibility to perform the definition in a single step:\n \n ```\n sage: v = M.vector_field(-y, x)\n@@ -21,7 +21,7 @@\n sage: M.vector_field([-y, x]).display()\n -y d/dx + x d/dy\n ```\n-on more generally any iterable, like a vector of symbolic expressions:\n+or more generally any iterable, like a vector of symbolic expressions:\n \n ```\n sage: M.vector_field(vector([-y, x])).display()\n@@ -47,4 +47,6 @@\n y^2 f_0 - f_1\n ```\n \n-*Remark:* the possibility of initializing the components while declaring a vector field was introduced on Euclidean spaces in #24623. This ticket extends it to any kind of differentiable manifold and any kind of tensor field.  \n+Note that the possibility of initializing the components while declaring a vector field was introduced on Euclidean spaces in #24623. This ticket extends this to any kind of differentiable manifold and any kind of tensor field.  Accordingly, the redefinition of the method `vector_field` in the class `EuclideanSpace` has been suppressed: it falls back now to the method `vector_field` of the mother class `DifferentiableManifold`.\n+\n+Basically the (optional) component initialization is performed by the method `TensorField._init_components`, which is invoked by all the end-user methods devoted to the creation of tensor fields on manifolds, i.e. the methods `automorphism_field`, `diff_form`, `multivector_field`, `one_form`, `sym_bilin_form_field`, `tensor_field` and `vector_field` of class `DifferentiableManifold`.\n``````\n",
    "created_at": "2019-03-31T17:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533980",
    "user": "https://github.com/egourgoulhon"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-At the moment, the definition of a tensor field on a differentiable manifold is a 2-step operation. For instance, for a vector field:
+Currently (Sage 8.7), the definition of a tensor field on a differentiable manifold is a 2-step operation. For instance, for a vector field:
 
 ```
 sage: M = Manifold(2, 'M')
@@ -8,7 +8,7 @@
 sage: v.display()
 -y d/dx + x d/dy
 ```
-With this ticket, this can be achieved in a single step:
+This ticket adds the possibility to perform the definition in a single step:
 
 ```
 sage: v = M.vector_field(-y, x)
@@ -21,7 +21,7 @@
 sage: M.vector_field([-y, x]).display()
 -y d/dx + x d/dy
 ```
-on more generally any iterable, like a vector of symbolic expressions:
+or more generally any iterable, like a vector of symbolic expressions:
 
 ```
 sage: M.vector_field(vector([-y, x])).display()
@@ -47,4 +47,6 @@
 y^2 f_0 - f_1
 ```
 
-*Remark:* the possibility of initializing the components while declaring a vector field was introduced on Euclidean spaces in #24623. This ticket extends it to any kind of differentiable manifold and any kind of tensor field.  
+Note that the possibility of initializing the components while declaring a vector field was introduced on Euclidean spaces in #24623. This ticket extends this to any kind of differentiable manifold and any kind of tensor field.  Accordingly, the redefinition of the method `vector_field` in the class `EuclideanSpace` has been suppressed: it falls back now to the method `vector_field` of the mother class `DifferentiableManifold`.
+
+Basically the (optional) component initialization is performed by the method `TensorField._init_components`, which is invoked by all the end-user methods devoted to the creation of tensor fields on manifolds, i.e. the methods `automorphism_field`, `diff_form`, `multivector_field`, `one_form`, `sym_bilin_form_field`, `tensor_field` and `vector_field` of class `DifferentiableManifold`.
``````




---

archive/issue_comments_533981.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2019-03-31T22:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533981",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_533982.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-31T22:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533982",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_533983.json:
```json
{
    "body": "<a id='comment:6'></a>\nLGTM.",
    "created_at": "2019-03-31T22:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533983",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
LGTM.



---

archive/issue_comments_533984.json:
```json
{
    "body": "<a id='comment:7'></a>\nThanks for the review!",
    "created_at": "2019-04-01T08:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533984",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:7'></a>
Thanks for the review!



---

archive/issue_comments_533985.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-02T21:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533985",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_077679.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-02T21:30:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27581#event-77679"
}
```



---

archive/issue_comments_533986.json:
```json
{
    "body": "Changing branch from \"public/manifolds/tensor_init_comp\" to \"990a858f1ce18c6537f9c6de7603dcc58f4b9cc2\"",
    "created_at": "2019-04-02T21:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27581#issuecomment-533986",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/manifolds/tensor_init_comp" to "990a858f1ce18c6537f9c6de7603dcc58f4b9cc2"
