# Issue 27836: Three.js: Add flat shading for Platonic solids

archive/issues_027599.json:
```json
{
    "body": "This ticket adds internal options to set flat shading for the Platonic solids and pass it through the JSON representation to the Three.js rendering template.\n\nThe major change is in the `json_repr` method of the `IndexFaceSet`. This representation is currently only used by the Three.js renderer and the canvas renderer, but it shouldn't affect the latter. I would rather have made the change in the `_rich_repr_threejs` method in `plot/plot3d/base.pyx` so it would only apply to Three.js plots. The problem is the existence of `Graphics3dGroups`, which have a JSON representation that can be nested. I didn't see any good way to search recursively a possibly nested array while traversing the `self.all` object, so making the change before the nested object is created seemed like the best way forward.\n\nIf anyone has a more Pythonic approach, let me know.\n\nCC:  @egourgoulhon\n\nKeywords: threejs\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Paul Masson\n\nBranch: 9fde6da263becdda47755f3963c99dd957a2690c\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27836\n\n",
    "closed_at": "2019-05-24T18:29:54Z",
    "created_at": "2019-05-16T00:45:02Z",
    "labels": [
        "component: graphics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Three.js: Add flat shading for Platonic solids",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27836",
    "user": "https://github.com/paulmasson"
}
```
This ticket adds internal options to set flat shading for the Platonic solids and pass it through the JSON representation to the Three.js rendering template.

The major change is in the `json_repr` method of the `IndexFaceSet`. This representation is currently only used by the Three.js renderer and the canvas renderer, but it shouldn't affect the latter. I would rather have made the change in the `_rich_repr_threejs` method in `plot/plot3d/base.pyx` so it would only apply to Three.js plots. The problem is the existence of `Graphics3dGroups`, which have a JSON representation that can be nested. I didn't see any good way to search recursively a possibly nested array while traversing the `self.all` object, so making the change before the nested object is created seemed like the best way forward.

If anyone has a more Pythonic approach, let me know.

CC:  @egourgoulhon

Keywords: threejs

Reviewer: Eric Gourgoulhon

Author: Paul Masson

Branch: 9fde6da263becdda47755f3963c99dd957a2690c

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27836





---

archive/issue_comments_538201.json:
```json
{
    "body": "Changing branch from \"\" to \"u/paulmasson/flat-shading\"",
    "created_at": "2019-05-16T00:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538201",
    "user": "https://github.com/paulmasson"
}
```

Changing branch from "" to "u/paulmasson/flat-shading"



---

archive/issue_comments_538202.json:
```json
{
    "body": "Changing commit from \"\" to \"9fde6da263becdda47755f3963c99dd957a2690c\"",
    "created_at": "2019-05-16T00:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538202",
    "user": "https://github.com/paulmasson"
}
```

Changing commit from "" to "9fde6da263becdda47755f3963c99dd957a2690c"



---

archive/issue_comments_538203.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-05-16T00:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538203",
    "user": "https://github.com/paulmasson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_538204.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2019-05-16T00:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538204",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_538205.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-19T10:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538205",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_538206.json:
```json
{
    "body": "<a id='comment:3'></a>LGTM. Thanks for this improvement!",
    "created_at": "2019-05-19T10:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538206",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'></a>LGTM. Thanks for this improvement!



---

archive/issue_comments_538207.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Eric Gourgoulhon\"",
    "created_at": "2019-05-19T10:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538207",
    "user": "https://github.com/egourgoulhon"
}
```

Changing reviewer from "" to "Eric Gourgoulhon"



---

archive/issue_events_069001.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-24T18:29:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27836#event-69001"
}
```



---

archive/issue_comments_538208.json:
```json
{
    "body": "Changing branch from \"u/paulmasson/flat-shading\" to \"9fde6da263becdda47755f3963c99dd957a2690c\"",
    "created_at": "2019-05-24T18:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538208",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/paulmasson/flat-shading" to "9fde6da263becdda47755f3963c99dd957a2690c"



---

archive/issue_comments_538209.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-05-24T18:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538209",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_538210.json:
```json
{
    "body": "Changing commit from \"9fde6da263becdda47755f3963c99dd957a2690c\" to \"\"",
    "created_at": "2019-08-12T11:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538210",
    "user": "https://github.com/embray"
}
```

Changing commit from "9fde6da263becdda47755f3963c99dd957a2690c" to ""



---

archive/issue_comments_538211.json:
```json
{
    "body": "<a id='comment:6'></a>Thanks for fixing this.  I agree there is need for a lot of refactoring in the plot3d code to better manage different options for specific rendering backends, as well as things like lighting an textures, in a more consistent manner.  A whole project unto itself.  But this looks good enough for now.",
    "created_at": "2019-08-12T11:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538211",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>Thanks for fixing this.  I agree there is need for a lot of refactoring in the plot3d code to better manage different options for specific rendering backends, as well as things like lighting an textures, in a more consistent manner.  A whole project unto itself.  But this looks good enough for now.



---

archive/issue_comments_538212.json:
```json
{
    "body": "<a id='comment:7'></a>Follow-up at #31426 for more general polyhedra.",
    "created_at": "2021-02-22T14:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27836",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27836#issuecomment-538212",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>Follow-up at #31426 for more general polyhedra.
