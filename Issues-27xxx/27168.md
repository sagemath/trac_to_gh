# Issue 27168: spkg-configure.m4 for freetype

archive/issues_026931.json:
```json
{
    "assignees": [],
    "body": "It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.\n\nTicket closed as duplicate after the corresponding changes were integrated in #27825.\n\nDepends on #27186\n\nCC:  @embray @mkoeppe @orlitzky\n\nKeywords: **spkg-configure freetype**\n\nBranch/Commit: **[public/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/freetype-config) @ [8b2cf94](https://github.com/sagemath/sagetrac-mirror/commit/8b2cf94e4d041d0bbe4d27bf98af5c7dbbed1c59)**\n\nReviewer: **Fran\u00e7ois Bissey, Erik Bray**\n\nAuthor: **Dima Pasechnik**\n\nComponent: **build: configure**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27168_\n\n",
    "closed_at": "2019-07-05T07:52:59Z",
    "created_at": "2019-01-29T16:54:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "spkg-configure.m4 for freetype",
    "type": "issue",
    "updated_at": "2019-07-08T14:40:30Z",
    "url": "https://github.com/sagemath/sage/issues/27168",
    "user": "https://github.com/dimpase"
}
```
It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.

Ticket closed as duplicate after the corresponding changes were integrated in #27825.

Depends on #27186

CC:  @embray @mkoeppe @orlitzky

Keywords: **spkg-configure freetype**

Branch/Commit: **[public/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/freetype-config) @ [8b2cf94](https://github.com/sagemath/sagetrac-mirror/commit/8b2cf94e4d041d0bbe4d27bf98af5c7dbbed1c59)**

Reviewer: **Fran√ßois Bissey, Erik Bray**

Author: **Dima Pasechnik**

Component: **build: configure**

_Issue created by migration from https://trac.sagemath.org/ticket/27168_





---

archive/issue_events_373314.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-29T16:54:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373314"
}
```



---

archive/issue_events_373315.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-29T16:54:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373315"
}
```



---

archive/issue_events_373316.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-29T16:54:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373316"
}
```



---

archive/issue_events_373317.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-29T16:54:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373317"
}
```



---

archive/issue_comments_419335.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI think we already have a generic ticket about this, so let's have this one just focus specifically on freetype.",
    "created_at": "2019-01-29T16:58:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419335",
    "user": "https://github.com/embray"
}
```

<div id="comment:1" align="right">comment:1</div>

I think we already have a generic ticket about this, so let's have this one just focus specifically on freetype.



---

archive/issue_events_373318.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-29T16:58:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "title_is": "spkg-configure.m4 for freetype",
    "title_was": "spkg-configure.m4 for more spkg libraries, e.g. freetype",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373318"
}
```



---

archive/issue_comments_419336.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nPerhaps of interest, from cairo's own `configure.ac`: https://cgit.freedesktop.org/cairo/tree/configure.ac#n489\n\nWe can probably reuse much of this.",
    "created_at": "2019-01-29T17:01:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419336",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">comment:2</div>

Perhaps of interest, from cairo's own `configure.ac`: https://cgit.freedesktop.org/cairo/tree/configure.ac#n489

We can probably reuse much of this.



---

archive/issue_comments_419337.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI actually do not know how to deal with freetype's deps: bzip2, libpng (and zlib - not explicitly listed, but a dep of libpng).\n\nNaturally, if we have to build any of these, we cannot use a system's freetype.\n\nWhich brings up the need for a proper dependencies resolver, and raises the question whether we are doing all this right. \n\nIMHO a better plan would be to spin off some, and then all,\nnon-python deps of Sage into a separate (auto-tools) project/package, which builds and installs them into SAGE_LOCAL (just the autotools `--prefix` parameter).\nThis would allow this to be gradual, once the initial setup, with just a handful already `spkg-configure.m4`-ed packages spun off.\nThe advantage is that the dependency resolution would be a natural top-down thing.",
    "created_at": "2019-01-30T10:14:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419337",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

I actually do not know how to deal with freetype's deps: bzip2, libpng (and zlib - not explicitly listed, but a dep of libpng).

Naturally, if we have to build any of these, we cannot use a system's freetype.

Which brings up the need for a proper dependencies resolver, and raises the question whether we are doing all this right. 

IMHO a better plan would be to spin off some, and then all,
non-python deps of Sage into a separate (auto-tools) project/package, which builds and installs them into SAGE_LOCAL (just the autotools `--prefix` parameter).
This would allow this to be gradual, once the initial setup, with just a handful already `spkg-configure.m4`-ed packages spun off.
The advantage is that the dependency resolution would be a natural top-down thing.



---

archive/issue_comments_419338.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI understand what you're saying and have thought about this problem as well, albeit without a completely clear solution. On the one hand I think it should be possible to use a system package regardless of its dependencies. On the other hand it is asking for trouble doing something like, as in your example, building a bz2 for Sage, but then using a libfreetype from the system which was compiled against its system libbz2. This may \"just work\" but mostly only by luck.\n\nThis was less of a problem when this mechanism was used only for a handful of packages that didn't live somewhere deep in the package dependency graph (the old configure.ac checked for these packages in more or less arbitrary order, and that is still the case unfortunately.\n\nI don't agree with your idea of bundling a bunch of packages together but I'm not sure I understand it either. I think there are a couple things to do here:\n\nUsing the freetype/bz2 example again: if we add a spkg-configure.m4 for one package, we should also do so for all its build dependencies. That way, assuming they are detected properly, it will properly use the system packages for the entire dependency tree rooted at freetype.\n\nHowever, I should also add some logic to SAGE_SPKG_COLLECT (likely with an external helper script) to actually load the package dependency graph and do these checks in a reasonable such that we don't even try to use a package from the system unless we've already detected all its dependencies from the system.",
    "created_at": "2019-01-30T12:17:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419338",
    "user": "https://github.com/embray"
}
```

<div id="comment:4" align="right">comment:4</div>

I understand what you're saying and have thought about this problem as well, albeit without a completely clear solution. On the one hand I think it should be possible to use a system package regardless of its dependencies. On the other hand it is asking for trouble doing something like, as in your example, building a bz2 for Sage, but then using a libfreetype from the system which was compiled against its system libbz2. This may "just work" but mostly only by luck.

This was less of a problem when this mechanism was used only for a handful of packages that didn't live somewhere deep in the package dependency graph (the old configure.ac checked for these packages in more or less arbitrary order, and that is still the case unfortunately.

I don't agree with your idea of bundling a bunch of packages together but I'm not sure I understand it either. I think there are a couple things to do here:

Using the freetype/bz2 example again: if we add a spkg-configure.m4 for one package, we should also do so for all its build dependencies. That way, assuming they are detected properly, it will properly use the system packages for the entire dependency tree rooted at freetype.

However, I should also add some logic to SAGE_SPKG_COLLECT (likely with an external helper script) to actually load the package dependency graph and do these checks in a reasonable such that we don't even try to use a package from the system unless we've already detected all its dependencies from the system.



---

archive/issue_comments_419339.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@embray](#comment:4):\n> I understand what you're saying and have thought about this problem as well, albeit without a completely clear solution. On the one hand I think it should be possible to use a system package regardless of its dependencies. On the other hand it is asking for trouble doing something like, as in your example, building a bz2 for Sage, but then using a libfreetype from the system which was compiled against its system libbz2. This may \"just work\" but mostly only by luck.\n> \n> This was less of a problem when this mechanism was used only for a handful of packages that didn't live somewhere deep in the package dependency graph (the old configure.ac checked for these packages in more or less arbitrary order, and that is still the case unfortunately.\n> \n> I don't agree with your idea of bundling a bunch of packages together but I'm not sure I understand it either. \n\nWell, perhaps bundling is a wrong word, but the idea is that once you removed a lot of stuff from Sage, you need means to build few missing pieces in a coherent way.\nThe complexity of doing this inside Sage is too much, in particular due to inflexible and a bit broken dependency resolution we have.\n \n> I think there are a couple things to do here:\n> \n> Using the freetype/bz2 example again: if we add a spkg-configure.m4 for one package, we should also do so for all its build dependencies. That way, assuming they are detected properly, it will properly use the system packages for the entire dependency tree rooted at freetype.\n\nI don't see why this always be the case. E.g. our current libgd is pretty old, and \nit does not need dependencies as new as provided by Sage (e.g. bz2). So the host system might have its own libgd, matching our version requirements, and spkg-configure.m4 would tell Sage to stay with the system's libgd. Yet, a newer libgd dependency, bz2, required by Sage for some reason, gets built by Sage. Oops, now we have system's libgd that might get mis-linked to Sage's bz2, or, worse, stuff gets broken during loading at runtime\n(or, even worse, gets subtly broken and result in wrong results).\nThis is really playing with fire.\n\nOften (freetype is a good example) Sage dependencies get updated just because something breaks on version N of BlaFoo OS, without much regard to whether this might break\nSage on version N-1 of BlaFoo OS (often, but by no means always, it is meant to continue working...).",
    "created_at": "2019-01-30T12:47:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419339",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@embray](#comment:4):
> I understand what you're saying and have thought about this problem as well, albeit without a completely clear solution. On the one hand I think it should be possible to use a system package regardless of its dependencies. On the other hand it is asking for trouble doing something like, as in your example, building a bz2 for Sage, but then using a libfreetype from the system which was compiled against its system libbz2. This may "just work" but mostly only by luck.
> 
> This was less of a problem when this mechanism was used only for a handful of packages that didn't live somewhere deep in the package dependency graph (the old configure.ac checked for these packages in more or less arbitrary order, and that is still the case unfortunately.
> 
> I don't agree with your idea of bundling a bunch of packages together but I'm not sure I understand it either. 

Well, perhaps bundling is a wrong word, but the idea is that once you removed a lot of stuff from Sage, you need means to build few missing pieces in a coherent way.
The complexity of doing this inside Sage is too much, in particular due to inflexible and a bit broken dependency resolution we have.
 
> I think there are a couple things to do here:
> 
> Using the freetype/bz2 example again: if we add a spkg-configure.m4 for one package, we should also do so for all its build dependencies. That way, assuming they are detected properly, it will properly use the system packages for the entire dependency tree rooted at freetype.

I don't see why this always be the case. E.g. our current libgd is pretty old, and 
it does not need dependencies as new as provided by Sage (e.g. bz2). So the host system might have its own libgd, matching our version requirements, and spkg-configure.m4 would tell Sage to stay with the system's libgd. Yet, a newer libgd dependency, bz2, required by Sage for some reason, gets built by Sage. Oops, now we have system's libgd that might get mis-linked to Sage's bz2, or, worse, stuff gets broken during loading at runtime
(or, even worse, gets subtly broken and result in wrong results).
This is really playing with fire.

Often (freetype is a good example) Sage dependencies get updated just because something breaks on version N of BlaFoo OS, without much regard to whether this might break
Sage on version N-1 of BlaFoo OS (often, but by no means always, it is meant to continue working...).



---

archive/issue_comments_419340.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThinking more about it, I should take a part of my comments above back - I have not quite understood the whole scheme of things. \nIt now seems to me that as soon as an spkg blah gets an spkg-configure.m4, all of its dependencies must have get it too, and then autoconf would do its magic just fine.\n\nThat is, for freetype this means that also libpng and bzip2 must also get spkg-configure.m4's. Thus the title change.",
    "created_at": "2019-01-30T13:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419340",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

Thinking more about it, I should take a part of my comments above back - I have not quite understood the whole scheme of things. 
It now seems to me that as soon as an spkg blah gets an spkg-configure.m4, all of its dependencies must have get it too, and then autoconf would do its magic just fine.

That is, for freetype this means that also libpng and bzip2 must also get spkg-configure.m4's. Thus the title change.



---

archive/issue_comments_419341.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.\n+\n+Also, its dependencies libpng and bzip2 must get their spkg-configure.m4's, to avoid misconfigurations (see discussion below in comments).\n``````\n",
    "created_at": "2019-01-30T13:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419341",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.
+
+Also, its dependencies libpng and bzip2 must get their spkg-configure.m4's, to avoid misconfigurations (see discussion below in comments).
``````




---

archive/issue_events_373319.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-01-30T13:22:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "title_is": "spkg-configure.m4 for freetype and its dependencies",
    "title_was": "spkg-configure.m4 for freetype",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373319"
}
```



---

archive/issue_comments_419342.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHere is 1st try for bzip2, appears working:\n\n```m4\nSAGE_SPKG_CONFIGURE([bzip2], [\n    AC_SEARCH_LIBS([BZ2_bzCompress], [bz2], [], [sage_spkg_install_bzip2=yes])\n    AC_CHECK_HEADER(bzlib.h, [], [sage_spkg_install_bzip2=yes])\n    AC_CHECK_PROG(bzip2, [break], [sage_spkg_install_bzip2=yes])\n])\n```",
    "created_at": "2019-01-31T12:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419342",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

Here is 1st try for bzip2, appears working:

```m4
SAGE_SPKG_CONFIGURE([bzip2], [
    AC_SEARCH_LIBS([BZ2_bzCompress], [bz2], [], [sage_spkg_install_bzip2=yes])
    AC_CHECK_HEADER(bzlib.h, [], [sage_spkg_install_bzip2=yes])
    AC_CHECK_PROG(bzip2, [break], [sage_spkg_install_bzip2=yes])
])
```



---

archive/issue_comments_419343.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2019-01-31T12:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419343",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_comments_419344.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@dimpase](#comment:5):\n> Replying to [@embray](#comment:4):\n> > Using the freetype/bz2 example again: if we add a spkg-configure.m4 for one package, we should also do so for all its build dependencies. That way, assuming they are detected properly, it will properly use the system packages for the entire dependency tree rooted at freetype.\n\n> \n> I don't see why this always be the case. E.g. our current libgd is pretty old, and \n> it does not need dependencies as new as provided by Sage (e.g. bz2). So the host system might have its own libgd, matching our version requirements, and spkg-configure.m4 would tell Sage to stay with the system's libgd. Yet, a newer libgd dependency, bz2, required by Sage for some reason, gets built by Sage. Oops, now we have system's libgd that might get mis-linked to Sage's bz2, or, worse, stuff gets broken during loading at runtime\n> (or, even worse, gets subtly broken and result in wrong results).\n> This is really playing with fire.\n\nI agree with this ofc.  If for some reason Sage (or really some other dependency of Sage) specifically needs some recent-enough libbz2 (for example) then we really need to check for that version on the system (either by actual version number, though better by feature checks if possible).  If not found, then we have to build our own copy.  And my point is that in that case we then need to also, at least by default, build all other dependencies that depend on that libbz2, regardless whether they can otherwise be found on the system.",
    "created_at": "2019-01-31T12:21:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419344",
    "user": "https://github.com/embray"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@dimpase](#comment:5):
> Replying to [@embray](#comment:4):
> > Using the freetype/bz2 example again: if we add a spkg-configure.m4 for one package, we should also do so for all its build dependencies. That way, assuming they are detected properly, it will properly use the system packages for the entire dependency tree rooted at freetype.

> 
> I don't see why this always be the case. E.g. our current libgd is pretty old, and 
> it does not need dependencies as new as provided by Sage (e.g. bz2). So the host system might have its own libgd, matching our version requirements, and spkg-configure.m4 would tell Sage to stay with the system's libgd. Yet, a newer libgd dependency, bz2, required by Sage for some reason, gets built by Sage. Oops, now we have system's libgd that might get mis-linked to Sage's bz2, or, worse, stuff gets broken during loading at runtime
> (or, even worse, gets subtly broken and result in wrong results).
> This is really playing with fire.

I agree with this ofc.  If for some reason Sage (or really some other dependency of Sage) specifically needs some recent-enough libbz2 (for example) then we really need to check for that version on the system (either by actual version number, though better by feature checks if possible).  If not found, then we have to build our own copy.  And my point is that in that case we then need to also, at least by default, build all other dependencies that depend on that libbz2, regardless whether they can otherwise be found on the system.



---

archive/issue_comments_419345.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@dimpase](#comment:7):\n> Here is 1st try for bzip2, appears working:\n> \n> ```m4\n> SAGE_SPKG_CONFIGURE([bzip2], [\n>     AC_SEARCH_LIBS([BZ2_bzCompress], [bz2], [], [sage_spkg_install_bzip2=yes])\n>     AC_CHECK_HEADER(bzlib.h, [], [sage_spkg_install_bzip2=yes])\n>     AC_CHECK_PROG(bzip2, [break], [sage_spkg_install_bzip2=yes])\n> ])\n> ```\n\nThat looks good, though I think we need to switch the order of `AC_CHECK_HEADER` and `AC_SEARCH_LIBS`.  I've found that the result of `AC_CHECK_HEADER` can be used by `AC_SEARCH_LIBS` so that it can find the correct headers when building test programs.  I'm not entirely sure how that mechanism works, but I did find that to be the case with libffi for example...",
    "created_at": "2019-01-31T12:23:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419345",
    "user": "https://github.com/embray"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@dimpase](#comment:7):
> Here is 1st try for bzip2, appears working:
> 
> ```m4
> SAGE_SPKG_CONFIGURE([bzip2], [
>     AC_SEARCH_LIBS([BZ2_bzCompress], [bz2], [], [sage_spkg_install_bzip2=yes])
>     AC_CHECK_HEADER(bzlib.h, [], [sage_spkg_install_bzip2=yes])
>     AC_CHECK_PROG(bzip2, [break], [sage_spkg_install_bzip2=yes])
> ])
> ```

That looks good, though I think we need to switch the order of `AC_CHECK_HEADER` and `AC_SEARCH_LIBS`.  I've found that the result of `AC_CHECK_HEADER` can be used by `AC_SEARCH_LIBS` so that it can find the correct headers when building test programs.  I'm not entirely sure how that mechanism works, but I did find that to be the case with libffi for example...



---

archive/issue_comments_419346.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOK. Do you think we need to check the version of bzip2 (it's been 1.0.6 for 5+ years already)?",
    "created_at": "2019-01-31T12:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419346",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

OK. Do you think we need to check the version of bzip2 (it's been 1.0.6 for 5+ years already)?



---

archive/issue_comments_419347.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI'll make a specific ticket for adding an spkg-configure.m4 for bzip2 and add it as a dependency of this ticket.\n\nI'm testing this out right now.  My general feeling about version checks is to avoid it until and unless we know a specific reason we need it.",
    "created_at": "2019-01-31T12:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419347",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

I'll make a specific ticket for adding an spkg-configure.m4 for bzip2 and add it as a dependency of this ticket.

I'm testing this out right now.  My general feeling about version checks is to avoid it until and unless we know a specific reason we need it.



---

archive/issue_comments_419348.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHere the reason would be to avoid nasty surprises for people installing Sage in weird places. \n\nActually, while I was at it\n\n```\n$ bzip2 --version 2>&1 | sed -n -e 's/bzip2.* Version *\\([[0-9]]*\\.[[0-9]]*\\.[[0-9]]*\\).*/\\1/p'\n```\noutputs 1.0.6, as needed. (then one can steal the rest of version-checking from spkg-configure.m4 of patch spkg, say, to check the version).",
    "created_at": "2019-01-31T13:18:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419348",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Here the reason would be to avoid nasty surprises for people installing Sage in weird places. 

Actually, while I was at it

```
$ bzip2 --version 2>&1 | sed -n -e 's/bzip2.* Version *\([[0-9]]*\.[[0-9]]*\.[[0-9]]*\).*/\1/p'
```
outputs 1.0.6, as needed. (then one can steal the rest of version-checking from spkg-configure.m4 of patch spkg, say, to check the version).



---

archive/issue_comments_419349.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI'm not sure what nasty surprises you have in mind.  I don't think many people use this package directly.",
    "created_at": "2019-01-31T14:00:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419349",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">comment:13</div>

I'm not sure what nasty surprises you have in mind.  I don't think many people use this package directly.



---

archive/issue_comments_419350.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nForgot to add here: #27182",
    "created_at": "2019-01-31T14:02:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419350",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Forgot to add here: #27182



---

archive/issue_comments_419351.json:
```json
{
    "body": "Dependencies: **#27182**",
    "created_at": "2019-01-31T14:02:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419351",
    "user": "https://github.com/embray"
}
```

Dependencies: **#27182**



---

archive/issue_comments_419352.json:
```json
{
    "body": "Changed dependencies from **#27182** to **#27182 #27186**",
    "created_at": "2019-01-31T14:11:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419352",
    "user": "https://github.com/embray"
}
```

Changed dependencies from **#27182** to **#27182 #27186**



---

archive/issue_comments_419353.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@embray](#comment:13):\n> I'm not sure what nasty surprises you have in mind.  I don't think many people use this package directly.\n\nSomebody starts installing Sage on an HPC cluster with typical semi-obsolete 10 years-old Linux version, and it fails as it picks up system's bzlib2 from previous century...",
    "created_at": "2019-01-31T14:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419353",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@embray](#comment:13):
> I'm not sure what nasty surprises you have in mind.  I don't think many people use this package directly.

Somebody starts installing Sage on an HPC cluster with typical semi-obsolete 10 years-old Linux version, and it fails as it picks up system's bzlib2 from previous century...



---

archive/issue_comments_419354.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI mean, that's fine.  If it doesn't pick it up then it doesn't, and installs Sage's instead.",
    "created_at": "2019-01-31T14:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419354",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

I mean, that's fine.  If it doesn't pick it up then it doesn't, and installs Sage's instead.



---

archive/issue_comments_419355.json:
```json
{
    "body": "Changed keywords from none to **spkg-configure**",
    "created_at": "2019-02-12T09:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419355",
    "user": "https://github.com/dimpase"
}
```

Changed keywords from none to **spkg-configure**



---

archive/issue_comments_419356.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419356",
    "user": "https://github.com/embray"
}
```

<div id="comment:19" align="right">comment:19</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_373320.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373320"
}
```



---

archive/issue_events_373321.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373321"
}
```



---

archive/issue_comments_419357.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d20b81b518d505c95d4e70b289b9147409bfdbf0\">d20b81b</a></td><td><code>spkg-configure for libpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f5aaa77a5e880069733d2dbd4db9b3b696f6e48\">2f5aaa7</a></td><td><code>don't check unneeded requirements for system libpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d09cdd18e73bc6900a537db04f93fc3187c92d12\">d09cdd1</a></td><td><code>a straightforward version with pkg-config only</code></td></tr></table>\n",
    "created_at": "2019-04-16T19:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419357",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:20"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d20b81b518d505c95d4e70b289b9147409bfdbf0">d20b81b</a></td><td><code>spkg-configure for libpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f5aaa77a5e880069733d2dbd4db9b3b696f6e48">2f5aaa7</a></td><td><code>don't check unneeded requirements for system libpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d09cdd18e73bc6900a537db04f93fc3187c92d12">d09cdd1</a></td><td><code>a straightforward version with pkg-config only</code></td></tr></table>




---

archive/issue_comments_419358.json:
```json
{
    "body": "Commit: **[d09cdd1](https://github.com/sagemath/sagetrac-mirror/commit/d09cdd18e73bc6900a537db04f93fc3187c92d12)**",
    "created_at": "2019-04-16T19:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419358",
    "user": "https://github.com/dimpase"
}
```

Commit: **[d09cdd1](https://github.com/sagemath/sagetrac-mirror/commit/d09cdd18e73bc6900a537db04f93fc3187c92d12)**



---

archive/issue_comments_419359.json:
```json
{
    "body": "Branch: **[u/dimpase/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/freetype-config)**",
    "created_at": "2019-04-16T19:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419359",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/freetype-config)**



---

archive/issue_comments_419360.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n`libgd` configure needs `--with-freetype=yes` if one goes for system's freetype,\ninstead of `--with-freetype=\"$SAGE_LOCAL\"`.",
    "created_at": "2019-04-16T19:49:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419360",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

`libgd` configure needs `--with-freetype=yes` if one goes for system's freetype,
instead of `--with-freetype="$SAGE_LOCAL"`.



---

archive/issue_comments_419361.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0422aec4197a21cf088a75f6cf168571bb6992b\">a0422ae</a></td><td><code>add SAGE_FREETYPE_PREFIX for libgd</code></td></tr></table>\n",
    "created_at": "2019-04-16T20:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419361",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0422aec4197a21cf088a75f6cf168571bb6992b">a0422ae</a></td><td><code>add SAGE_FREETYPE_PREFIX for libgd</code></td></tr></table>




---

archive/issue_comments_419362.json:
```json
{
    "body": "Changed commit from **[d09cdd1](https://github.com/sagemath/sagetrac-mirror/commit/d09cdd18e73bc6900a537db04f93fc3187c92d12)** to **[a0422ae](https://github.com/sagemath/sagetrac-mirror/commit/a0422aec4197a21cf088a75f6cf168571bb6992b)**",
    "created_at": "2019-04-16T20:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419362",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d09cdd1](https://github.com/sagemath/sagetrac-mirror/commit/d09cdd18e73bc6900a537db04f93fc3187c92d12)** to **[a0422ae](https://github.com/sagemath/sagetrac-mirror/commit/a0422aec4197a21cf088a75f6cf168571bb6992b)**



---

archive/issue_events_373322.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-04-16T21:32:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373322"
}
```



---

archive/issue_events_373323.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-04-16T21:33:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373323"
}
```



---

archive/issue_events_373324.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-04-16T21:33:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373324"
}
```



---

archive/issue_events_373325.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-04-16T21:33:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "title_is": "spkg-configure.m4 for freetype",
    "title_was": "spkg-configure.m4 for freetype and its dependencies",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373325"
}
```



---

archive/issue_comments_419363.json:
```json
{
    "body": "Changed dependencies from **#27182 #27186** to **#27186**",
    "created_at": "2019-04-16T21:33:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419363",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#27182 #27186** to **#27186**



---

archive/issue_comments_419364.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,2 @@\n It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.\n \n-Also, its dependencies libpng and bzip2 must get their spkg-configure.m4's, to avoid misconfigurations (see discussion below in comments).\n``````\n",
    "created_at": "2019-04-16T21:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419364",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,2 @@
 It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.
 
-Also, its dependencies libpng and bzip2 must get their spkg-configure.m4's, to avoid misconfigurations (see discussion below in comments).
``````




---

archive/issue_events_373326.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-04-16T21:34:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373326"
}
```



---

archive/issue_events_373327.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-04-16T21:34:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373327"
}
```



---

archive/issue_comments_419365.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4d89709cd432fa048fa5bb978943ceedfd4c8ca\">f4d8970</a></td><td><code>spkg-configure for libpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5fa38e5cf37358667af98562983919664e07503\">f5fa38e</a></td><td><code>don't check unneeded requirements for system libpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e8b1a23a0316eb3d34e7c7a80fc6b95f054d716\">1e8b1a2</a></td><td><code>bumped up configure spkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f689d8d6aa5ab6dd06e3bdf2144ff820fe747626\">f689d8d</a></td><td><code>a straightforward version with pkg-config only</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e1c041f69fc11fec9ff1fa645ddb0c38006b5c7\">3e1c041</a></td><td><code>add SAGE_FREETYPE_PREFIX for libgd</code></td></tr></table>\n",
    "created_at": "2019-04-30T17:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419365",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4d89709cd432fa048fa5bb978943ceedfd4c8ca">f4d8970</a></td><td><code>spkg-configure for libpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5fa38e5cf37358667af98562983919664e07503">f5fa38e</a></td><td><code>don't check unneeded requirements for system libpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e8b1a23a0316eb3d34e7c7a80fc6b95f054d716">1e8b1a2</a></td><td><code>bumped up configure spkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f689d8d6aa5ab6dd06e3bdf2144ff820fe747626">f689d8d</a></td><td><code>a straightforward version with pkg-config only</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e1c041f69fc11fec9ff1fa645ddb0c38006b5c7">3e1c041</a></td><td><code>add SAGE_FREETYPE_PREFIX for libgd</code></td></tr></table>




---

archive/issue_comments_419366.json:
```json
{
    "body": "Changed commit from **[a0422ae](https://github.com/sagemath/sagetrac-mirror/commit/a0422aec4197a21cf088a75f6cf168571bb6992b)** to **[3e1c041](https://github.com/sagemath/sagetrac-mirror/commit/3e1c041f69fc11fec9ff1fa645ddb0c38006b5c7)**",
    "created_at": "2019-04-30T17:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419366",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a0422ae](https://github.com/sagemath/sagetrac-mirror/commit/a0422aec4197a21cf088a75f6cf168571bb6992b)** to **[3e1c041](https://github.com/sagemath/sagetrac-mirror/commit/3e1c041f69fc11fec9ff1fa645ddb0c38006b5c7)**



---

archive/issue_comments_419367.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6e554f8755a08140b67ccad28f72d5c30d1d207\">a6e554f</a></td><td><code>spkg-configure for libpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adc901cdcb4ae4850a9dcc4a009add6c569903fc\">adc901c</a></td><td><code>don't check unneeded requirements for system libpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61daadde5fdc2622f07a8e01f4343b477a6dd23a\">61daadd</a></td><td><code>a straightforward version with pkg-config only</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9eeaa56f37f863635edd9edc02a9bfa98bc47517\">9eeaa56</a></td><td><code>add SAGE_FREETYPE_PREFIX for libgd</code></td></tr></table>\n",
    "created_at": "2019-05-13T13:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419367",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6e554f8755a08140b67ccad28f72d5c30d1d207">a6e554f</a></td><td><code>spkg-configure for libpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adc901cdcb4ae4850a9dcc4a009add6c569903fc">adc901c</a></td><td><code>don't check unneeded requirements for system libpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61daadde5fdc2622f07a8e01f4343b477a6dd23a">61daadd</a></td><td><code>a straightforward version with pkg-config only</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9eeaa56f37f863635edd9edc02a9bfa98bc47517">9eeaa56</a></td><td><code>add SAGE_FREETYPE_PREFIX for libgd</code></td></tr></table>




---

archive/issue_comments_419368.json:
```json
{
    "body": "Changed commit from **[3e1c041](https://github.com/sagemath/sagetrac-mirror/commit/3e1c041f69fc11fec9ff1fa645ddb0c38006b5c7)** to **[9eeaa56](https://github.com/sagemath/sagetrac-mirror/commit/9eeaa56f37f863635edd9edc02a9bfa98bc47517)**",
    "created_at": "2019-05-13T13:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419368",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3e1c041](https://github.com/sagemath/sagetrac-mirror/commit/3e1c041f69fc11fec9ff1fa645ddb0c38006b5c7)** to **[9eeaa56](https://github.com/sagemath/sagetrac-mirror/commit/9eeaa56f37f863635edd9edc02a9bfa98bc47517)**



---

archive/issue_comments_419369.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\ncan we get this through? (I deliberately not do a configure bump here, to lessen the rebasing hell...)",
    "created_at": "2019-05-13T13:54:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419369",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

can we get this through? (I deliberately not do a configure bump here, to lessen the rebasing hell...)



---

archive/issue_events_373328.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2019-05-15T08:16:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373328"
}
```



---

archive/issue_events_373329.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2019-05-15T08:16:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373329"
}
```



---

archive/issue_comments_419370.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nLGTM",
    "created_at": "2019-05-15T08:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419370",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">comment:30</div>

LGTM



---

archive/issue_comments_419371.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2019-05-15T08:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419371",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Fran√ßois Bissey**



---

archive/issue_comments_419372.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThanks! And how about its dependency, #27186 ?",
    "created_at": "2019-05-15T08:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419372",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

Thanks! And how about its dependency, #27186 ?



---

archive/issue_comments_419373.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nPlease merge together with #27825",
    "created_at": "2019-05-15T08:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419373",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">comment:32</div>

Please merge together with #27825



---

archive/issue_comments_419374.json:
```json
{
    "body": "Changed keywords from **spkg-configure** to **spkg-configure freetype**",
    "created_at": "2019-05-17T09:39:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419374",
    "user": "https://github.com/embray"
}
```

Changed keywords from **spkg-configure** to **spkg-configure freetype**



---

archive/issue_comments_419375.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nPlease never set these to positive review until I've had a chance to OK them on Cygwin.",
    "created_at": "2019-05-17T09:39:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419375",
    "user": "https://github.com/embray"
}
```

<div id="comment:33" align="right">comment:33</div>

Please never set these to positive review until I've had a chance to OK them on Cygwin.



---

archive/issue_events_373330.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-17T09:39:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373330"
}
```



---

archive/issue_events_373331.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-17T09:39:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373331"
}
```



---

archive/issue_events_373332.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-17T09:39:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373332"
}
```



---

archive/issue_events_373333.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-17T09:39:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "000080",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373333"
}
```



---

archive/issue_comments_419376.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI don't like this:\n\n```\n+    if test x$sage_spkg_install_freetype = xyes; then\n+      AC_SUBST(SAGE_FREETYPE_PREFIX, ['$SAGE_LOCAL'])\n+    else\n+      AC_SUBST(SAGE_FREETYPE_PREFIX, [yes])\n+    fi\n```\n\nI think if we need this variable at all (which it seems we do currently for building libgd) it should either be an actual filesystem path or empty for consistency's sake.  If some random package (like again, libgd) requires you to pass `--with-freetype=yes` that should be handled in its spkg-install, e.g. like\n\n```\nif [ -n \"$SAGE_FREETYPE_PREFIX\" ]; then\n    CONFIGURE_LIBGD=\"$CONFIGURE_LIBGD --with-freetype=$SAGE_FREETYPE_PREFIX\"\nelse\n    CONFIGURE_LIBGD=\"$CONFIGURE_LIBGD --with-freetype=yes\"\nfi\n```\n\nor something along those lines.",
    "created_at": "2019-05-17T09:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419376",
    "user": "https://github.com/embray"
}
```

<div id="comment:34" align="right">comment:34</div>

I don't like this:

```
+    if test x$sage_spkg_install_freetype = xyes; then
+      AC_SUBST(SAGE_FREETYPE_PREFIX, ['$SAGE_LOCAL'])
+    else
+      AC_SUBST(SAGE_FREETYPE_PREFIX, [yes])
+    fi
```

I think if we need this variable at all (which it seems we do currently for building libgd) it should either be an actual filesystem path or empty for consistency's sake.  If some random package (like again, libgd) requires you to pass `--with-freetype=yes` that should be handled in its spkg-install, e.g. like

```
if [ -n "$SAGE_FREETYPE_PREFIX" ]; then
    CONFIGURE_LIBGD="$CONFIGURE_LIBGD --with-freetype=$SAGE_FREETYPE_PREFIX"
else
    CONFIGURE_LIBGD="$CONFIGURE_LIBGD --with-freetype=yes"
fi
```

or something along those lines.



---

archive/issue_comments_419377.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nYep, I agree that it's inconsistent with way such an inconsistency is dealt with in Flint, I'll fix this.",
    "created_at": "2019-05-17T10:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419377",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:35" align="right">comment:35</div>

Yep, I agree that it's inconsistent with way such an inconsistency is dealt with in Flint, I'll fix this.



---

archive/issue_comments_419378.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nI also noticed some inconsistencies in the formatting of some of the messages, as compared to the stuff in #27822 since I change the messages in those ticket to be more consistent with the style of other autoconf messages (e.g. using mostly lower-case, like \"no\" instead of \"No.\").  This is just trivial nitpick though.  I can fix those up if you want.",
    "created_at": "2019-05-17T11:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419378",
    "user": "https://github.com/embray"
}
```

<div id="comment:36" align="right">comment:36</div>

I also noticed some inconsistencies in the formatting of some of the messages, as compared to the stuff in #27822 since I change the messages in those ticket to be more consistent with the style of other autoconf messages (e.g. using mostly lower-case, like "no" instead of "No.").  This is just trivial nitpick though.  I can fix those up if you want.



---

archive/issue_comments_419379.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nPlease do the fixes (and do not forget about mpfr/mpc/ntl bunch, #27822 and #27265, which is currently not moving forward, too).",
    "created_at": "2019-05-17T11:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419379",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

Please do the fixes (and do not forget about mpfr/mpc/ntl bunch, #27822 and #27265, which is currently not moving forward, too).



---

archive/issue_comments_419380.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nHere are some minor updates that incorporate my review comments from earlier in this ticket, and a few other minor tweaks that seemed worth including.  Please review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b1850a3b6cc7a8cf84e70c683c54f028f3564e8\">4b1850a</a></td><td><code>For consistency's sake, set SAGE_FREETYPE_PREFIX to empty when using the system lib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eef8a646ada59e95ca08573f32349f8bb5f7da00\">eef8a64</a></td><td><code>As we are updating libgd, go ahead and add an spkg-legacy-uninstall for removing old versions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b2cf94e4d041d0bbe4d27bf98af5c7dbbed1c59\">8b2cf94</a></td><td><code>Update these messages to match stylistically with the similar messages</code></td></tr></table>\n",
    "created_at": "2019-05-23T13:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419380",
    "user": "https://github.com/embray"
}
```

<div id="comment:38" align="right">comment:38</div>

Here are some minor updates that incorporate my review comments from earlier in this ticket, and a few other minor tweaks that seemed worth including.  Please review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b1850a3b6cc7a8cf84e70c683c54f028f3564e8">4b1850a</a></td><td><code>For consistency's sake, set SAGE_FREETYPE_PREFIX to empty when using the system lib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eef8a646ada59e95ca08573f32349f8bb5f7da00">eef8a64</a></td><td><code>As we are updating libgd, go ahead and add an spkg-legacy-uninstall for removing old versions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b2cf94e4d041d0bbe4d27bf98af5c7dbbed1c59">8b2cf94</a></td><td><code>Update these messages to match stylistically with the similar messages</code></td></tr></table>




---

archive/issue_comments_419381.json:
```json
{
    "body": "Changed commit from **[9eeaa56](https://github.com/sagemath/sagetrac-mirror/commit/9eeaa56f37f863635edd9edc02a9bfa98bc47517)** to **[8b2cf94](https://github.com/sagemath/sagetrac-mirror/commit/8b2cf94e4d041d0bbe4d27bf98af5c7dbbed1c59)**",
    "created_at": "2019-05-23T13:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419381",
    "user": "https://github.com/embray"
}
```

Changed commit from **[9eeaa56](https://github.com/sagemath/sagetrac-mirror/commit/9eeaa56f37f863635edd9edc02a9bfa98bc47517)** to **[8b2cf94](https://github.com/sagemath/sagetrac-mirror/commit/8b2cf94e4d041d0bbe4d27bf98af5c7dbbed1c59)**



---

archive/issue_comments_419382.json:
```json
{
    "body": "Changed reviewer from **Fran\u00e7ois Bissey** to **Fran\u00e7ois Bissey, Erik Bray**",
    "created_at": "2019-05-23T13:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419382",
    "user": "https://github.com/embray"
}
```

Changed reviewer from **Fran√ßois Bissey** to **Fran√ßois Bissey, Erik Bray**



---

archive/issue_comments_419383.json:
```json
{
    "body": "Changed branch from **[u/dimpase/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/freetype-config)** to **[public/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/freetype-config)**",
    "created_at": "2019-05-23T13:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419383",
    "user": "https://github.com/embray"
}
```

Changed branch from **[u/dimpase/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/freetype-config)** to **[public/packages/freetype-config](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/freetype-config)**



---

archive/issue_comments_419384.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nthis ought to be rebased over 8.8.beta6...",
    "created_at": "2019-05-23T21:08:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419384",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:39" align="right">comment:39</div>

this ought to be rebased over 8.8.beta6...



---

archive/issue_comments_419385.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nOK, this looks good, I've cherry-picked these into `u/dimpase/packages/libgd-config`.\nLet's continue on #27825.",
    "created_at": "2019-05-24T09:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419385",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

OK, this looks good, I've cherry-picked these into `u/dimpase/packages/libgd-config`.
Let's continue on #27825.



---

archive/issue_events_373334.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-24T09:06:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373334"
}
```



---

archive/issue_events_373335.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-24T09:06:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373335"
}
```



---

archive/issue_events_373336.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-24T09:06:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373336"
}
```



---

archive/issue_events_373337.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-24T09:06:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373337"
}
```



---

archive/issue_events_373338.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-24T09:06:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373338"
}
```



---

archive/issue_comments_419386.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nideally, we should be adding an extra parameter to `SAGE_SPKG_CONFIGURE` to list dependencies that must be verified to come from the system, instead of this monotonous\ncopypastes for these checks.\n\n(It could even be the 2nd parameter, and we then mass-edit all the spkg-configure.m4 to make use of it)",
    "created_at": "2019-05-25T07:56:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419386",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">comment:41</div>

ideally, we should be adding an extra parameter to `SAGE_SPKG_CONFIGURE` to list dependencies that must be verified to come from the system, instead of this monotonous
copypastes for these checks.

(It could even be the 2nd parameter, and we then mass-edit all the spkg-configure.m4 to make use of it)



---

archive/issue_comments_419387.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nIt doesn't necessarily have to be an argument to `SAGE_SPKG_CONFIGURE`, although that could be nice.  It could also be a macro similar to `AC_REQUIRE` that you would put at the top.  I agree it should be made less repetitive either way.",
    "created_at": "2019-05-31T16:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419387",
    "user": "https://github.com/embray"
}
```

<div id="comment:42" align="right">comment:42</div>

It doesn't necessarily have to be an argument to `SAGE_SPKG_CONFIGURE`, although that could be nice.  It could also be a macro similar to `AC_REQUIRE` that you would put at the top.  I agree it should be made less repetitive either way.



---

archive/issue_events_373339.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-05T07:52:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373339"
}
```



---

archive/issue_events_373340.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-05T07:52:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373340"
}
```



---

archive/issue_events_373341.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-05T07:52:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27168#event-373341"
}
```



---

archive/issue_comments_419388.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,3 @@\n It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.\n \n+Ticket closed as duplicate after the corresponding changes were integrated in #27825.\n``````\n",
    "created_at": "2019-07-08T14:40:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27168#issuecomment-419388",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,3 @@
 It gets ugly with library conflicts, so more libraries available on the system should be used instead of ones shipped by Sage, e.g. `freetype` is a good example. Freetype may be used by R packages, and they in turn might depend on other system libraries we don't even know about, cf. e.g. #27163.
 
+Ticket closed as duplicate after the corresponding changes were integrated in #27825.
``````

