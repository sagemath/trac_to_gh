# Issue 27354: Add assume() warning against chained comparisons

archive/issues_027117.json:
```json
{
    "body": "Evan O'Dorney reported that `assume(0 < x < 1)` doesn't work the way you'd expect it to:\n\nhttps://groups.google.com/forum/#!topic/sage-devel/-OdekKRf504\n\nHe's right, but this is probably unfixable. The chained comparison is translated by python into an \"and\" statement, and those aren't valid assumptions. Some other weird stuff takes place, too, and you wind up with junk. We should warn about this in the `assume()` documentation.\n\n\n**CC:**  @kcrisman @jdemeyer @rwst @mwageringel @egourgoulhon\n\n**Branch/Commit:** [ff2efa420ac20657cdce209a9171fd708bac1040](https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040)\n\n**Reviewer:** Karl-Dieter Crisman, Jeroen Demeyer, Markus Wageringel\n\n**Author:** Michael Orlitzky\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27354\n\n",
    "closed_at": "2020-04-12T15:34:27Z",
    "created_at": "2019-02-25T23:42:45Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Add assume() warning against chained comparisons",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27354",
    "user": "https://github.com/orlitzky"
}
```
Evan O'Dorney reported that `assume(0 < x < 1)` doesn't work the way you'd expect it to:

https://groups.google.com/forum/#!topic/sage-devel/-OdekKRf504

He's right, but this is probably unfixable. The chained comparison is translated by python into an "and" statement, and those aren't valid assumptions. Some other weird stuff takes place, too, and you wind up with junk. We should warn about this in the `assume()` documentation.


**CC:**  @kcrisman @jdemeyer @rwst @mwageringel @egourgoulhon

**Branch/Commit:** [ff2efa420ac20657cdce209a9171fd708bac1040](https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040)

**Reviewer:** Karl-Dieter Crisman, Jeroen Demeyer, Markus Wageringel

**Author:** Michael Orlitzky

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/27354





---

archive/issue_comments_528719.json:
```json
{
    "body": "**Author:** Michael Orlitzky",
    "created_at": "2019-02-25T23:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528719",
    "user": "https://github.com/orlitzky"
}
```

**Author:** Michael Orlitzky



---

archive/issue_comments_528720.json:
```json
{
    "body": "**Branch:** [u/mjo/ticket/27354](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/27354)",
    "created_at": "2019-02-25T23:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528720",
    "user": "https://github.com/orlitzky"
}
```

**Branch:** [u/mjo/ticket/27354](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/27354)



---

archive/issue_comments_528721.json:
```json
{
    "body": "**Commit:** [167c92664f8dcf60aed197ed781cdecb95b76d9c](https://github.com/sagemath/sagetrac-mirror/commit/167c92664f8dcf60aed197ed781cdecb95b76d9c)",
    "created_at": "2019-02-25T23:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528721",
    "user": "https://github.com/orlitzky"
}
```

**Commit:** [167c92664f8dcf60aed197ed781cdecb95b76d9c](https://github.com/sagemath/sagetrac-mirror/commit/167c92664f8dcf60aed197ed781cdecb95b76d9c)



---

archive/issue_comments_528722.json:
```json
{
    "body": "<a id='comment:1'></a>\nI need to force-push a better commit message but the docs are there.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/167c92664f8dcf60aed197ed781cdecb95b76d9c\">167c926</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>\n",
    "created_at": "2019-02-25T23:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528722",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:1'></a>
I need to force-push a better commit message but the docs are there.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/167c92664f8dcf60aed197ed781cdecb95b76d9c">167c926</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>




---

archive/issue_comments_528723.json:
```json
{
    "body": "**Changing commit** from \"[167c92664f8dcf60aed197ed781cdecb95b76d9c](https://github.com/sagemath/sagetrac-mirror/commit/167c92664f8dcf60aed197ed781cdecb95b76d9c)\" to \"[fd0b535ae3c92b321b10df873743ad34fe50ff69](https://github.com/sagemath/sagetrac-mirror/commit/fd0b535ae3c92b321b10df873743ad34fe50ff69)\".",
    "created_at": "2019-02-26T01:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528723",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[167c92664f8dcf60aed197ed781cdecb95b76d9c](https://github.com/sagemath/sagetrac-mirror/commit/167c92664f8dcf60aed197ed781cdecb95b76d9c)" to "[fd0b535ae3c92b321b10df873743ad34fe50ff69](https://github.com/sagemath/sagetrac-mirror/commit/fd0b535ae3c92b321b10df873743ad34fe50ff69)".



---

archive/issue_comments_528724.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd0b535ae3c92b321b10df873743ad34fe50ff69\">fd0b535</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>\n",
    "created_at": "2019-02-26T01:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528724",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd0b535ae3c92b321b10df873743ad34fe50ff69">fd0b535</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>




---

archive/issue_comments_528725.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2019-02-26T01:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528725",
    "user": "https://github.com/orlitzky"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_528726.json:
```json
{
    "body": "<a id='comment:4'></a>\nOverall this looks very nice.  I'd add a `forget()` at the end just to be oll korrect.  Also, do we want the warning block to be the first thing people see?  I'm not sure what the regulations are on where that could be added, but probably it shouldn't be the very first thing, before one reads even how to use `assume()` in the first place.",
    "created_at": "2019-02-26T02:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528726",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Overall this looks very nice.  I'd add a `forget()` at the end just to be oll korrect.  Also, do we want the warning block to be the first thing people see?  I'm not sure what the regulations are on where that could be added, but probably it shouldn't be the very first thing, before one reads even how to use `assume()` in the first place.



---

archive/issue_comments_528727.json:
```json
{
    "body": "**Changing commit** from \"[fd0b535ae3c92b321b10df873743ad34fe50ff69](https://github.com/sagemath/sagetrac-mirror/commit/fd0b535ae3c92b321b10df873743ad34fe50ff69)\" to \"[c9a3468a291fa0c086a22e351272a0bcafb92bee](https://github.com/sagemath/sagetrac-mirror/commit/c9a3468a291fa0c086a22e351272a0bcafb92bee)\".",
    "created_at": "2019-02-26T19:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528727",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fd0b535ae3c92b321b10df873743ad34fe50ff69](https://github.com/sagemath/sagetrac-mirror/commit/fd0b535ae3c92b321b10df873743ad34fe50ff69)" to "[c9a3468a291fa0c086a22e351272a0bcafb92bee](https://github.com/sagemath/sagetrac-mirror/commit/c9a3468a291fa0c086a22e351272a0bcafb92bee)".



---

archive/issue_comments_528728.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/337bb5c8c2051fd7ff5aab6bdb57bf3730920904\">337bb5c</a></td><td><code>Trac #27354: call forget() consistently in assume() examples and tests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f831b3cd93ccf7e7159d22f1e3479d5bf676cca6\">f831b3c</a></td><td><code>Trac #27354: fix a pointless try/except in assume().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/030e159853fd06b4880a88a2520a3828f577769f\">030e159</a></td><td><code>Trac #27354: add INPUT and OUTPUT documentation for assume().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9a3468a291fa0c086a22e351272a0bcafb92bee\">c9a3468</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>\n",
    "created_at": "2019-02-26T19:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528728",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/337bb5c8c2051fd7ff5aab6bdb57bf3730920904">337bb5c</a></td><td><code>Trac #27354: call forget() consistently in assume() examples and tests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f831b3cd93ccf7e7159d22f1e3479d5bf676cca6">f831b3c</a></td><td><code>Trac #27354: fix a pointless try/except in assume().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/030e159853fd06b4880a88a2520a3828f577769f">030e159</a></td><td><code>Trac #27354: add INPUT and OUTPUT documentation for assume().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9a3468a291fa0c086a22e351272a0bcafb92bee">c9a3468</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>




---

archive/issue_comments_528729.json:
```json
{
    "body": "<a id='comment:6'></a>\nBetter? Now that there are some input/output docs, the warning isn't the first thing that the user will see. I realize that the INPUT block is highly confusing, but so is the interface it describes =)",
    "created_at": "2019-02-26T19:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528729",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:6'></a>
Better? Now that there are some input/output docs, the warning isn't the first thing that the user will see. I realize that the INPUT block is highly confusing, but so is the interface it describes =)



---

archive/issue_comments_528730.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2019-02-27T02:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528730",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_comments_528731.json:
```json
{
    "body": "<a id='comment:7'></a>\n`if we are given junk` - nice.\n\nActually, really nice improvement, thank you!  I don't see any obvious problems and I think your markup is correct, so once the patchbot says yes let's go.  It is weird that I can't even figure out how to trigger that (untested and hence broken) exception in the current code.",
    "created_at": "2019-02-27T02:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528731",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>
`if we are given junk` - nice.

Actually, really nice improvement, thank you!  I don't see any obvious problems and I think your markup is correct, so once the patchbot says yes let's go.  It is weird that I can't even figure out how to trigger that (untested and hence broken) exception in the current code.



---

archive/issue_comments_528732.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [kcrisman](#comment%3A7):\n> It is weird that I can't even figure out how to trigger that (untested and hence broken) exception in the current code.\n\n\nI don't think you can. I'll bet that it should have been `except AttributeError` all along, but nobody noticed because it wasn't tested.",
    "created_at": "2019-02-27T03:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528732",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:8'></a>
Replying to [kcrisman](#comment%3A7):
> It is weird that I can't even figure out how to trigger that (untested and hence broken) exception in the current code.


I don't think you can. I'll bet that it should have been `except AttributeError` all along, but nobody noticed because it wasn't tested.



---

archive/issue_comments_528733.json:
```json
{
    "body": "<a id='comment:9'></a>\n1. I find this explanation not very clear:\n\n```\nDon't use python's chained comparison notation in assumptions.\nThe expression ``0 < x < 1``, is translated literally in python\nto ``(0 < x) and (x < 1)``, but the value of ``x < 1`` is always\nfalse when ``x`` is a symbolic variable. By an unlucky coincidence\nno error is raised, but needless to say, you don't wind up with\nthe assumptions that you wanted.\n```\n\nI would write something like\n\n```\nPython's chained comparison notation like ``assume(0 < x < 1)`` does not work.\nThis is because Python literally translates the expression ``0 < x < 1``\nto ``(0 < x) and (x < 1)``. Since the value of ``0 < x`` is typically\nfalse, the expression ``0 < x < 1`` evaluates to ``0 < x``.\n```\n\n2. Also this\n\n```\nSince both ``0 < x`` and\n``1 < x`` are false, the conjunction is false, and is thus itself\nequivalent to ``0 < x``. So, the simplification of ``0 < x < 1``\nto ``0 < x`` by python is admissible\n```\nis a bit strangely written. The fact that `0 < x < 1` equals `0 < x` is not an \"admissible simplification\", it's part of the Python language that `0 < x < 1` gets interpreted as `(0 < x) and (x < 1)` and that `X and Y` is `X` whenever `X` is false.\n\n3. Use 4 spaces for indentation, also in that `.. WARNING::` block.\n\n4. Why are we changing\n\n```\n        sage: var('n, P, r, r2')\n        (n, P, r, r2)\n```\nto\n\n```\nsage: n,P,r,r2 = SR.var('n, P, r, r2')\n```",
    "created_at": "2019-02-27T06:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528733",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
1. I find this explanation not very clear:

```
Don't use python's chained comparison notation in assumptions.
The expression ``0 < x < 1``, is translated literally in python
to ``(0 < x) and (x < 1)``, but the value of ``x < 1`` is always
false when ``x`` is a symbolic variable. By an unlucky coincidence
no error is raised, but needless to say, you don't wind up with
the assumptions that you wanted.
```

I would write something like

```
Python's chained comparison notation like ``assume(0 < x < 1)`` does not work.
This is because Python literally translates the expression ``0 < x < 1``
to ``(0 < x) and (x < 1)``. Since the value of ``0 < x`` is typically
false, the expression ``0 < x < 1`` evaluates to ``0 < x``.
```

2. Also this

```
Since both ``0 < x`` and
``1 < x`` are false, the conjunction is false, and is thus itself
equivalent to ``0 < x``. So, the simplification of ``0 < x < 1``
to ``0 < x`` by python is admissible
```
is a bit strangely written. The fact that `0 < x < 1` equals `0 < x` is not an "admissible simplification", it's part of the Python language that `0 < x < 1` gets interpreted as `(0 < x) and (x < 1)` and that `X and Y` is `X` whenever `X` is false.

3. Use 4 spaces for indentation, also in that `.. WARNING::` block.

4. Why are we changing

```
        sage: var('n, P, r, r2')
        (n, P, r, r2)
```
to

```
sage: n,P,r,r2 = SR.var('n, P, r, r2')
```



---

archive/issue_comments_528734.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2019-02-27T06:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528734",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_528735.json:
```json
{
    "body": "**Changing commit** from \"[c9a3468a291fa0c086a22e351272a0bcafb92bee](https://github.com/sagemath/sagetrac-mirror/commit/c9a3468a291fa0c086a22e351272a0bcafb92bee)\" to \"[f967a1647b93e73acc7d441d7099a0ed73b6d356](https://github.com/sagemath/sagetrac-mirror/commit/f967a1647b93e73acc7d441d7099a0ed73b6d356)\".",
    "created_at": "2019-02-27T15:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528735",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c9a3468a291fa0c086a22e351272a0bcafb92bee](https://github.com/sagemath/sagetrac-mirror/commit/c9a3468a291fa0c086a22e351272a0bcafb92bee)" to "[f967a1647b93e73acc7d441d7099a0ed73b6d356](https://github.com/sagemath/sagetrac-mirror/commit/f967a1647b93e73acc7d441d7099a0ed73b6d356)".



---

archive/issue_comments_528736.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a51f7846358091ee7e617b3b6c9663c4588e9d7\">7a51f78</a></td><td><code>Trac #27354: call forget() consistently in assume() examples and tests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b23bfe81fc71a24e4f62fd72689e3687b4ddbfb5\">b23bfe8</a></td><td><code>Trac #27354: replace one use of var() with SR.var() in a doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acb24673e7db5ff753d45b1af39b4fac47dbfde8\">acb2467</a></td><td><code>Trac #27354: fix a pointless try/except in assume().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/751e63026ed76e4c5bc1c57e403ee0ce919f0fe0\">751e630</a></td><td><code>Trac #27354: add INPUT and OUTPUT documentation for assume().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f967a1647b93e73acc7d441d7099a0ed73b6d356\">f967a16</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>\n",
    "created_at": "2019-02-27T15:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528736",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a51f7846358091ee7e617b3b6c9663c4588e9d7">7a51f78</a></td><td><code>Trac #27354: call forget() consistently in assume() examples and tests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b23bfe81fc71a24e4f62fd72689e3687b4ddbfb5">b23bfe8</a></td><td><code>Trac #27354: replace one use of var() with SR.var() in a doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acb24673e7db5ff753d45b1af39b4fac47dbfde8">acb2467</a></td><td><code>Trac #27354: fix a pointless try/except in assume().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/751e63026ed76e4c5bc1c57e403ee0ce919f0fe0">751e630</a></td><td><code>Trac #27354: add INPUT and OUTPUT documentation for assume().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f967a1647b93e73acc7d441d7099a0ed73b6d356">f967a16</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>




---

archive/issue_comments_528737.json:
```json
{
    "body": "**Changing commit** from \"[f967a1647b93e73acc7d441d7099a0ed73b6d356](https://github.com/sagemath/sagetrac-mirror/commit/f967a1647b93e73acc7d441d7099a0ed73b6d356)\" to \"[ff2efa420ac20657cdce209a9171fd708bac1040](https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040)\".",
    "created_at": "2019-02-27T15:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f967a1647b93e73acc7d441d7099a0ed73b6d356](https://github.com/sagemath/sagetrac-mirror/commit/f967a1647b93e73acc7d441d7099a0ed73b6d356)" to "[ff2efa420ac20657cdce209a9171fd708bac1040](https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040)".



---

archive/issue_comments_528738.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040\">ff2efa4</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>\n",
    "created_at": "2019-02-27T15:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040">ff2efa4</a></td><td><code>Trac #27354: warn against chained comparisons in assume().</code></td></tr></table>




---

archive/issue_comments_528739.json:
```json
{
    "body": "**Changing reviewer** from \"Karl-Dieter Crisman\" to \"Karl-Dieter Crisman, Jeroen Demeyer\".",
    "created_at": "2019-02-27T16:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528739",
    "user": "https://github.com/orlitzky"
}
```

**Changing reviewer** from "Karl-Dieter Crisman" to "Karl-Dieter Crisman, Jeroen Demeyer".



---

archive/issue_comments_528740.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jdemeyer](#comment%3A9):\n> 1. I find this explanation not very clear:\n> \n> 2. Also this\n\n\nI was trying to weasel out of explaining exactly what's going on =P\n\nThe python docs are a bit ambiguous, since they say that `x and y` means \"if x is false, then x, else y.\" In our case, `x` is **not** false -- it's a symbolic expression such that `bool(x)` is false. But I guess that still gets simplified to `x`, and that's why you get a junk result rather than an error.\n\nIn any case, I've tried to make the explanation in the WARNING block \nmore precise, so that I don't need to waffle about it in the test case.\n\n\n> \n> 3. Use 4 spaces for indentation, also in that `.. WARNING::` block.\n\n\nFixed.\n\n\n> 4. Why are we changing\n\n\nUsing `var()` to inject names into the global scope is a bad practice, so I think we should avoid it in EXAMPLES where possible. It didn't belong in that commit, though, so I've separated it out.",
    "created_at": "2019-02-27T16:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528740",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:12'></a>
Replying to [jdemeyer](#comment%3A9):
> 1. I find this explanation not very clear:
> 
> 2. Also this


I was trying to weasel out of explaining exactly what's going on =P

The python docs are a bit ambiguous, since they say that `x and y` means "if x is false, then x, else y." In our case, `x` is **not** false -- it's a symbolic expression such that `bool(x)` is false. But I guess that still gets simplified to `x`, and that's why you get a junk result rather than an error.

In any case, I've tried to make the explanation in the WARNING block 
more precise, so that I don't need to waffle about it in the test case.


> 
> 3. Use 4 spaces for indentation, also in that `.. WARNING::` block.


Fixed.


> 4. Why are we changing


Using `var()` to inject names into the global scope is a bad practice, so I think we should avoid it in EXAMPLES where possible. It didn't belong in that commit, though, so I've separated it out.



---

archive/issue_comments_528741.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2019-02-27T16:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528741",
    "user": "https://github.com/orlitzky"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_528742.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [mjo](#comment%3A12):\n> `x` is **not** false -- it's a symbolic expression such that `bool(x)` is false.\n\n\nFrom Python's point of view, that's just the same. I wouldn't call it a simplification, it's just asking for the boolean value of a Python object (this object being the expression `0 < x`).\n\n> Using `var()` to inject names into the global scope is a bad practice, so I think we should avoid it in EXAMPLES where possible.\n\n\nThat's news to me. Is there a general consensus that using `var()` is a bad idea? Without such a consensus, I would rather not make those changes here.",
    "created_at": "2019-02-27T16:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528742",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Replying to [mjo](#comment%3A12):
> `x` is **not** false -- it's a symbolic expression such that `bool(x)` is false.


From Python's point of view, that's just the same. I wouldn't call it a simplification, it's just asking for the boolean value of a Python object (this object being the expression `0 < x`).

> Using `var()` to inject names into the global scope is a bad practice, so I think we should avoid it in EXAMPLES where possible.


That's news to me. Is there a general consensus that using `var()` is a bad idea? Without such a consensus, I would rather not make those changes here.



---

archive/issue_comments_528743.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A13):\n> \n> > Using `var()` to inject names into the global scope is a bad practice, so I think we should avoid it in EXAMPLES where possible.\n\n> \n> That's news to me. Is there a general consensus that using `var()` is a bad idea? Without such a consensus, I would rather not make those changes here.\n\n\nIt's banned in the sage library because it causes non-local bugs. If I write\n\n```\ndef foo():\n    var('x')\n    return baz(bar(x))\n```\n\nand then later call `foo`, it's going to clobber whatever `x` already exists. Unless you're familiar with the *implementation* of `foo`, you won't know what happened. Instead, I should be writing\n\n```\ndef foo():\n    x = SR.var('x')\n    return baz(bar(x))\n```\n\nNow it's safe to call `foo` even when I have my own `x` in scope. One of these is always safe, and the other isn't. I don't know about consensus, but since `SR.var()` is strictly better, I think we should teach people the safe thing instead.",
    "created_at": "2019-02-27T16:29:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528743",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A13):
> 
> > Using `var()` to inject names into the global scope is a bad practice, so I think we should avoid it in EXAMPLES where possible.

> 
> That's news to me. Is there a general consensus that using `var()` is a bad idea? Without such a consensus, I would rather not make those changes here.


It's banned in the sage library because it causes non-local bugs. If I write

```
def foo():
    var('x')
    return baz(bar(x))
```

and then later call `foo`, it's going to clobber whatever `x` already exists. Unless you're familiar with the *implementation* of `foo`, you won't know what happened. Instead, I should be writing

```
def foo():
    x = SR.var('x')
    return baz(bar(x))
```

Now it's safe to call `foo` even when I have my own `x` in scope. One of these is always safe, and the other isn't. I don't know about consensus, but since `SR.var()` is strictly better, I think we should teach people the safe thing instead.



---

archive/issue_events_077030.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27354#event-77030"
}
```



---

archive/issue_comments_528744.json:
```json
{
    "body": "<a id='comment:15'></a>\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528744",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_528745.json:
```json
{
    "body": "<a id='comment:16'></a>\nMoving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528745",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_events_077031.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27354#event-77031"
}
```



---

archive/issue_events_077032.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27354#event-77032"
}
```



---

archive/issue_events_077033.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27354#event-77033"
}
```



---

archive/issue_events_077034.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27354#event-77034"
}
```



---

archive/issue_comments_528746.json:
```json
{
    "body": "<a id='comment:17'></a>\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528746",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
Ticket retargeted after milestone closed



---

archive/issue_comments_528747.json:
```json
{
    "body": "<a id='comment:18'></a>\nCC'ing a few other people with recent commits under `src/sage/symbolic/`. There's only one line of code changed here (dropped a try/catch, explained in the commit message)... the rest is just additional documentation and tests.",
    "created_at": "2020-04-09T14:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528747",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:18'></a>
CC'ing a few other people with recent commits under `src/sage/symbolic/`. There's only one line of code changed here (dropped a try/catch, explained in the commit message)... the rest is just additional documentation and tests.



---

archive/issue_comments_528748.json:
```json
{
    "body": "<a id='comment:19'></a>\nI'm okay with the code change, as explained above, but I don't know exactly what is new since the time I said \"if patchbot says yes then it's fine\".  I guess you could even add an example documenting that \n\n> The two types can be combined, but a symbolic inequality cannot appear in the middle of a list of variables.\n\n\nbut given how long this has been here maybe it's better to just let it go.\n\nI'd still want patchbot and/or another human to be happy, though.",
    "created_at": "2020-04-09T14:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528748",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:19'></a>
I'm okay with the code change, as explained above, but I don't know exactly what is new since the time I said "if patchbot says yes then it's fine".  I guess you could even add an example documenting that 

> The two types can be combined, but a symbolic inequality cannot appear in the middle of a list of variables.


but given how long this has been here maybe it's better to just let it go.

I'd still want patchbot and/or another human to be happy, though.



---

archive/issue_comments_528749.json:
```json
{
    "body": "<a id='comment:20'></a>\nBy the way, I'm okay with not using `SR.var` in testing code, since that is supposed to code people might actually use, but I am also okay with the versions you have for the reasons you state.",
    "created_at": "2020-04-09T14:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528749",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>
By the way, I'm okay with not using `SR.var` in testing code, since that is supposed to code people might actually use, but I am also okay with the versions you have for the reasons you state.



---

archive/issue_comments_528750.json:
```json
{
    "body": "<a id='comment:21'></a>\nI think the patchbots are OK? There was significant discussion since you said \"once the patchbot says yes let's go\", enough so that I wouldn't feel comfortable marking this positive-review on your behalf.",
    "created_at": "2020-04-09T15:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528750",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:21'></a>
I think the patchbots are OK? There was significant discussion since you said "once the patchbot says yes let's go", enough so that I wouldn't feel comfortable marking this positive-review on your behalf.



---

archive/issue_comments_528751.json:
```json
{
    "body": "<a id='comment:22'></a>\nUnfortunately since there were forced pushes I'm not sure what is exactly different in the commits.  But I think that what you have is pretty comprehensive, and I think you responded adequately in the new commits to Jeroen's question.  I guess it would be good for one other person to confirm that since I can't literally test this right now (or for the foreseeable future) but I think that you were pretty comprehensive so I am okay with a positive review, for my part.",
    "created_at": "2020-04-09T15:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528751",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'></a>
Unfortunately since there were forced pushes I'm not sure what is exactly different in the commits.  But I think that what you have is pretty comprehensive, and I think you responded adequately in the new commits to Jeroen's question.  I guess it would be good for one other person to confirm that since I can't literally test this right now (or for the foreseeable future) but I think that you were pretty comprehensive so I am okay with a positive review, for my part.



---

archive/issue_comments_528752.json:
```json
{
    "body": "<a id='comment:23'></a>\nAh, try the \"(Commits)\" link next to the branch name in the ticket properties. Each one should make sense on its own. That way you don't have to worry about the forced pushes.",
    "created_at": "2020-04-09T15:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528752",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:23'></a>
Ah, try the "(Commits)" link next to the branch name in the ticket properties. Each one should make sense on its own. That way you don't have to worry about the forced pushes.



---

archive/issue_comments_528753.json:
```json
{
    "body": "<a id='comment:24'></a>\nOh, it all makes sense (and I've used those links plenty of times) - what I meant was that I don't know what has changed since my previous review since, presumably, the individual commits are also different from what they were before.  Anyway, I have no problems with this branch.",
    "created_at": "2020-04-09T16:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528753",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>
Oh, it all makes sense (and I've used those links plenty of times) - what I meant was that I don't know what has changed since my previous review since, presumably, the individual commits are also different from what they were before.  Anyway, I have no problems with this branch.



---

archive/issue_comments_528754.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-04-09T17:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528754",
    "user": "https://github.com/mwageringel"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_528755.json:
```json
{
    "body": "<a id='comment:25'></a>\nThe changes look good to me as well, so I am setting this to positive.",
    "created_at": "2020-04-09T17:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528755",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:25'></a>
The changes look good to me as well, so I am setting this to positive.



---

archive/issue_comments_528756.json:
```json
{
    "body": "**Changing reviewer** from \"Karl-Dieter Crisman, Jeroen Demeyer\" to \"Karl-Dieter Crisman, Jeroen Demeyer, Markus Wageringel\".",
    "created_at": "2020-04-09T17:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528756",
    "user": "https://github.com/mwageringel"
}
```

**Changing reviewer** from "Karl-Dieter Crisman, Jeroen Demeyer" to "Karl-Dieter Crisman, Jeroen Demeyer, Markus Wageringel".



---

archive/issue_comments_528757.json:
```json
{
    "body": "<a id='comment:26'></a>\nThanks!",
    "created_at": "2020-04-09T18:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528757",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:26'></a>
Thanks!



---

archive/issue_events_077035.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-12T15:34:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27354#event-77035"
}
```



---

archive/issue_comments_528758.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2020-04-12T15:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528758",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_528759.json:
```json
{
    "body": "**Changing branch** from \"[u/mjo/ticket/27354](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/27354)\" to \"[ff2efa420ac20657cdce209a9171fd708bac1040](https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040)\".",
    "created_at": "2020-04-12T15:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27354#issuecomment-528759",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mjo/ticket/27354](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/27354)" to "[ff2efa420ac20657cdce209a9171fd708bac1040](https://github.com/sagemath/sagetrac-mirror/commit/ff2efa420ac20657cdce209a9171fd708bac1040)".
