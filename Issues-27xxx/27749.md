# Issue 27749: is_globally_equivalent_to is not symmetric

archive/issues_027512.json:
```json
{
    "assignees": [],
    "body": "\n```\nQ = QuadraticForm(ZZ, 2, [2,3,5])\nP = QuadraticForm(ZZ, 2, [8,6,5])\nQ.is_globally_equivalent_to(P)\nTrue\nP.is_globally_equivalent_to(Q)\nFalse\n```\nThe expected output in any case is `False`. \nThe underlying computation is done with Pari.\n\nUpstream ticket (PARI):\n- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)\n  \n\nCC:  @slel @orlitzky @kliem\n\nKeywords: **pari**\n\nBranch: **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Samuel Leli\u00e8vre**\n\nAuthor: **Simon Brandhorst**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27749_\n\n",
    "closed_at": "2020-10-03T22:57:33Z",
    "created_at": "2019-04-29T14:03:30Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20quadratic%20forms",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "is_globally_equivalent_to is not symmetric",
    "type": "issue",
    "updated_at": "2020-10-20T11:50:21Z",
    "url": "https://github.com/sagemath/sage/issues/27749",
    "user": "https://github.com/simonbrandhorst"
}
```

```
Q = QuadraticForm(ZZ, 2, [2,3,5])
P = QuadraticForm(ZZ, 2, [8,6,5])
Q.is_globally_equivalent_to(P)
True
P.is_globally_equivalent_to(Q)
False
```
The expected output in any case is `False`. 
The underlying computation is done with Pari.

Upstream ticket (PARI):
- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)
  

CC:  @slel @orlitzky @kliem

Keywords: **pari**

Branch: **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Samuel Lelièvre**

Author: **Simon Brandhorst**

_Issue created by migration from https://trac.sagemath.org/ticket/27749_





---

archive/issue_events_362472.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2019-04-29T14:03:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362472"
}
```



---

archive/issue_events_362473.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2019-04-29T14:03:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20quadratic%20forms",
    "label_color": "0000ff",
    "label_name": "component: quadratic forms",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362473"
}
```



---

archive/issue_events_362474.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2019-04-29T14:03:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362474"
}
```



---

archive/issue_events_362475.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2019-04-29T14:03:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362475"
}
```



---

archive/issue_comments_433219.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2019-04-29T16:04:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433219",
    "user": "https://github.com/simonbrandhorst"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_433220.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2019-04-29T20:32:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433220",
    "user": "https://github.com/slel"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_433221.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,7 @@\n ```\n The expected output in any case is `False`. \n The underlying computation is done with Pari.\n+\n+Upstream ticket (PARI):\n+- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)\n+  \n``````\n",
    "created_at": "2019-04-29T20:32:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433221",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,7 @@
 ```
 The expected output in any case is `False`. 
 The underlying computation is done with Pari.
+
+Upstream ticket (PARI):
+- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)
+  
``````




---

archive/issue_comments_433222.json:
```json
{
    "body": "Changed keywords from **** to **pari**",
    "created_at": "2019-04-29T20:32:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433222",
    "user": "https://github.com/slel"
}
```

Changed keywords from **** to **pari**



---

archive/issue_events_362476.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:55:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362476"
}
```



---

archive/issue_comments_433223.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433223",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'>Comment 3:</a>
As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_433224.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThis is still failing in pari 2.11.2 from May 2019 (currently in sage)\n\nbut works in pari [2, 11, 4, 23175, \"e4f812ce9f\"].\n\nThis will need a doctest once pari is updated.",
    "created_at": "2020-04-28T17:26:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433224",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'>Comment 4:</a>
This is still failing in pari 2.11.2 from May 2019 (currently in sage)

but works in pari [2, 11, 4, 23175, "e4f812ce9f"].

This will need a doctest once pari is updated.



---

archive/issue_comments_433225.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nSee also discussion in #29472",
    "created_at": "2020-04-28T17:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433225",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>Comment 7:</a>
See also discussion in #29472



---

archive/issue_comments_433226.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\n\n```\nsage: Q = QuadraticForm(ZZ, 2, [2,3,5]) \n....: P = QuadraticForm(ZZ, 2, [8,6,5]) \n....: Q.is_globally_equivalent_to(P)                                         \nFalse\nsage: P.is_globally_equivalent_to(Q)                                         \nFalse\nsage: pari.version()                                                         \n(2, 11, 4)\n```",
    "created_at": "2020-09-26T18:25:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433226",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:8'>Comment 8:</a>

```
sage: Q = QuadraticForm(ZZ, 2, [2,3,5]) 
....: P = QuadraticForm(ZZ, 2, [8,6,5]) 
....: Q.is_globally_equivalent_to(P)                                         
False
sage: P.is_globally_equivalent_to(Q)                                         
False
sage: pari.version()                                                         
(2, 11, 4)
```



---

archive/issue_comments_433227.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nThe pari upgrade happened in\n\n- #29313: Upgrade to pari 2.11.4\n\nwhich was merged in Sage 9.2.beta7.",
    "created_at": "2020-09-26T18:31:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433227",
    "user": "https://github.com/slel"
}
```

<a id='comment:9'>Comment 9:</a>
The pari upgrade happened in

- #29313: Upgrade to pari 2.11.4

which was merged in Sage 9.2.beta7.



---

archive/issue_events_362477.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-09-26T18:32:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362477"
}
```



---

archive/issue_comments_433228.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2020-09-26T18:32:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433228",
    "user": "https://github.com/slel"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_433229.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nCan someone add the doctest?",
    "created_at": "2020-09-26T18:32:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433229",
    "user": "https://github.com/slel"
}
```

<a id='comment:10'>Comment 10:</a>
Can someone add the doctest?



---

archive/issue_comments_433230.json:
```json
{
    "body": "Branch: **[u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric)**",
    "created_at": "2020-09-26T18:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433230",
    "user": "https://github.com/simonbrandhorst"
}
```

Branch: **[u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric)**



---

archive/issue_comments_433231.json:
```json
{
    "body": "Commit: **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)**",
    "created_at": "2020-09-26T18:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433231",
    "user": "https://github.com/simonbrandhorst"
}
```

Commit: **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)**



---

archive/issue_comments_433232.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88\">be9f880</a></td><td><code>document that the bug in equivalence testing is fixed</code></td></tr></table>\n",
    "created_at": "2020-09-26T18:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433232",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:12'>Comment 12:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88">be9f880</a></td><td><code>document that the bug in equivalence testing is fixed</code></td></tr></table>




---

archive/issue_events_362478.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2020-09-26T18:34:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362478"
}
```



---

archive/issue_events_362479.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-09-27T13:17:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362479"
}
```



---

archive/issue_events_362480.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-09-27T13:17:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362480"
}
```



---

archive/issue_comments_433233.json:
```json
{
    "body": "Reviewer: **Samuel Leli\u00e8vre**",
    "created_at": "2020-09-27T13:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433233",
    "user": "https://github.com/slel"
}
```

Reviewer: **Samuel Lelièvre**



---

archive/issue_comments_433234.json:
```json
{
    "body": "Author: **Simon Brandhorst**",
    "created_at": "2020-09-27T13:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433234",
    "user": "https://github.com/slel"
}
```

Author: **Simon Brandhorst**



---

archive/issue_comments_433235.json:
```json
{
    "body": "Changed branch from **[u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric)** to **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)**",
    "created_at": "2020-10-03T22:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433235",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric)** to **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)**



---

archive/issue_events_362481.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-10-03T22:57:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362481"
}
```



---

archive/issue_events_362482.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a379746839a643292c13d7edb73ab1cfc38fdf69",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-10-03T22:57:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27749#event-362482"
}
```



---

archive/issue_comments_433236.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nShouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in\n`quadratic_form__equivalence_testing` added by this ticket?",
    "created_at": "2020-10-20T10:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433236",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'>Comment 15:</a>
Shouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in
`quadratic_form__equivalence_testing` added by this ticket?



---

archive/issue_comments_433237.json:
```json
{
    "body": "Changed commit from **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)** to none",
    "created_at": "2020-10-20T10:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433237",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)** to none



---

archive/issue_comments_433238.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@dimpase](#comment%3A15):\n> Shouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in\n> `quadratic_form__equivalence_testing` added by this ticket? \n\nshould be fixed by #30800",
    "created_at": "2020-10-20T11:50:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27749#issuecomment-433238",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@dimpase](#comment%3A15):
> Shouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in
> `quadratic_form__equivalence_testing` added by this ticket? 

should be fixed by #30800
