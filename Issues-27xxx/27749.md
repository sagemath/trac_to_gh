# Issue 27749: is_globally_equivalent_to is not symmetric

archive/issues_027512.json:
```json
{
    "body": "\n```\nQ = QuadraticForm(ZZ, 2, [2,3,5])\nP = QuadraticForm(ZZ, 2, [8,6,5])\nQ.is_globally_equivalent_to(P)\nTrue\nP.is_globally_equivalent_to(Q)\nFalse\n```\nThe expected output in any case is `False`. \nThe underlying computation is done with Pari.\n\nUpstream ticket (PARI):\n- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)\n  \n\nCC:  @slel @orlitzky @kliem\n\nKeywords: pari\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Samuel Leli\u00e8vre\n\nAuthor: Simon Brandhorst\n\nBranch: be9f8807a8e416dc117e010872641da56d2c9a88\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27749\n\n",
    "closed_at": "2020-10-03T22:57:33Z",
    "created_at": "2019-04-29T14:03:30Z",
    "labels": [
        "component: quadratic forms",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "is_globally_equivalent_to is not symmetric",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27749",
    "user": "https://github.com/simonbrandhorst"
}
```

```
Q = QuadraticForm(ZZ, 2, [2,3,5])
P = QuadraticForm(ZZ, 2, [8,6,5])
Q.is_globally_equivalent_to(P)
True
P.is_globally_equivalent_to(Q)
False
```
The expected output in any case is `False`. 
The underlying computation is done with Pari.

Upstream ticket (PARI):
- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)
  

CC:  @slel @orlitzky @kliem

Keywords: pari

Upstream: Fixed upstream, in a later stable release.

Reviewer: Samuel Leli√®vre

Author: Simon Brandhorst

Branch: be9f8807a8e416dc117e010872641da56d2c9a88

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27749





---

archive/issue_comments_529397.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2019-04-29T16:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529397",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_529398.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, but not in a stable release.\"",
    "created_at": "2019-04-29T20:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529398",
    "user": "https://github.com/slel"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, but not in a stable release."



---

archive/issue_comments_529399.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,7 @@\n ```\n The expected output in any case is `False`. \n The underlying computation is done with Pari.\n+\n+Upstream ticket (PARI):\n+- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)\n+  \n``````\n",
    "created_at": "2019-04-29T20:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529399",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,7 @@
 ```
 The expected output in any case is `False`. 
 The underlying computation is done with Pari.
+
+Upstream ticket (PARI):
+- [PARI bug #2140: Bug: qfisom not symmetric](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2140)
+  
``````




---

archive/issue_comments_529400.json:
```json
{
    "body": "Changing keywords from \"\" to \"pari\".",
    "created_at": "2019-04-29T20:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529400",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "pari".



---

archive/issue_comments_529401.json:
```json
{
    "body": "<a id='comment:3'></a>\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529401",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>
As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_529402.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis is still failing in pari 2.11.2 from May 2019 (currently in sage)\n\nbut works in pari [2, 11, 4, 23175, \"e4f812ce9f\"].\n\nThis will need a doctest once pari is updated.",
    "created_at": "2020-04-28T17:26:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529402",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
This is still failing in pari 2.11.2 from May 2019 (currently in sage)

but works in pari [2, 11, 4, 23175, "e4f812ce9f"].

This will need a doctest once pari is updated.



---

archive/issue_comments_529403.json:
```json
{
    "body": "<a id='comment:7'></a>\nSee also discussion in #29472",
    "created_at": "2020-04-28T17:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529403",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
See also discussion in #29472



---

archive/issue_comments_529404.json:
```json
{
    "body": "<a id='comment:8'></a>\n\n```\nsage: Q = QuadraticForm(ZZ, 2, [2,3,5]) \n....: P = QuadraticForm(ZZ, 2, [8,6,5]) \n....: Q.is_globally_equivalent_to(P)                                         \nFalse\nsage: P.is_globally_equivalent_to(Q)                                         \nFalse\nsage: pari.version()                                                         \n(2, 11, 4)\n```",
    "created_at": "2020-09-26T18:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529404",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:8'></a>

```
sage: Q = QuadraticForm(ZZ, 2, [2,3,5]) 
....: P = QuadraticForm(ZZ, 2, [8,6,5]) 
....: Q.is_globally_equivalent_to(P)                                         
False
sage: P.is_globally_equivalent_to(Q)                                         
False
sage: pari.version()                                                         
(2, 11, 4)
```



---

archive/issue_comments_529405.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe pari upgrade happened in\n\n- #29313: Upgrade to pari 2.11.4\n\nwhich was merged in Sage 9.2.beta7.",
    "created_at": "2020-09-26T18:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529405",
    "user": "https://github.com/slel"
}
```

<a id='comment:9'></a>
The pari upgrade happened in

- #29313: Upgrade to pari 2.11.4

which was merged in Sage 9.2.beta7.



---

archive/issue_events_085867.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-09-26T18:32:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27749#event-85867"
}
```



---

archive/issue_comments_529406.json:
```json
{
    "body": "Changing upstream from \"Fixed upstream, but not in a stable release.\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2020-09-26T18:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529406",
    "user": "https://github.com/slel"
}
```

Changing upstream from "Fixed upstream, but not in a stable release." to "Fixed upstream, in a later stable release."



---

archive/issue_comments_529407.json:
```json
{
    "body": "<a id='comment:10'></a>\nCan someone add the doctest?",
    "created_at": "2020-09-26T18:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529407",
    "user": "https://github.com/slel"
}
```

<a id='comment:10'></a>
Can someone add the doctest?



---

archive/issue_comments_529408.json:
```json
{
    "body": "Changing branch from \"\" to \"u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric\"",
    "created_at": "2020-09-26T18:33:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529408",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing branch from "" to "u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric"



---

archive/issue_comments_529409.json:
```json
{
    "body": "Changing commit from \"\" to \"be9f8807a8e416dc117e010872641da56d2c9a88\"",
    "created_at": "2020-09-26T18:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529409",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing commit from "" to "be9f8807a8e416dc117e010872641da56d2c9a88"



---

archive/issue_comments_529410.json:
```json
{
    "body": "<a id='comment:12'></a>\nNew commits:\n|                                                                                                                                          |                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)|`document that the bug in equivalence testing is fixed`|",
    "created_at": "2020-09-26T18:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529410",
    "user": "https://github.com/simonbrandhorst"
}
```

<a id='comment:12'></a>
New commits:
|                                                                                                                                          |                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[be9f880](https://github.com/sagemath/sagetrac-mirror/commit/be9f8807a8e416dc117e010872641da56d2c9a88)|`document that the bug in equivalence testing is fixed`|



---

archive/issue_comments_529411.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-26T18:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529411",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_529412.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-27T13:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529412",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_529413.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Samuel Leli\u00e8vre\"",
    "created_at": "2020-09-27T13:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529413",
    "user": "https://github.com/slel"
}
```

Changing reviewer from "" to "Samuel Leli√®vre"



---

archive/issue_comments_529414.json:
```json
{
    "body": "Changing author from \"\" to \"Simon Brandhorst\"",
    "created_at": "2020-09-27T13:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529414",
    "user": "https://github.com/slel"
}
```

Changing author from "" to "Simon Brandhorst"



---

archive/issue_comments_529415.json:
```json
{
    "body": "Changing branch from \"u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric\" to \"be9f8807a8e416dc117e010872641da56d2c9a88\"",
    "created_at": "2020-10-03T22:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529415",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/sbrandhorst/is_globally_equivalent_to_is_not_symmetric" to "be9f8807a8e416dc117e010872641da56d2c9a88"



---

archive/issue_comments_529416.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-10-03T22:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529416",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_085868.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-10-03T22:57:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27749#event-85868"
}
```



---

archive/issue_comments_529417.json:
```json
{
    "body": "<a id='comment:15'></a>\nShouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in\n`quadratic_form__equivalence_testing` added by this ticket?",
    "created_at": "2020-10-20T10:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529417",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>
Shouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in
`quadratic_form__equivalence_testing` added by this ticket?



---

archive/issue_comments_529418.json:
```json
{
    "body": "Changing commit from \"be9f8807a8e416dc117e010872641da56d2c9a88\" to \"\"",
    "created_at": "2020-10-20T10:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529418",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "be9f8807a8e416dc117e010872641da56d2c9a88" to ""



---

archive/issue_comments_529419.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [dimpase](#comment%3A15):\n> Shouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in\n> `quadratic_form__equivalence_testing` added by this ticket? \n\n\nshould be fixed by #30800",
    "created_at": "2020-10-20T11:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27749",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27749#issuecomment-529419",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
Replying to [dimpase](#comment%3A15):
> Shouldn't a test be added to `spkg-configure.m4` of pari? Note that e.g. on Fedora 30 one has pari/gp version 2.11.2, which passes all the tests we currently have there, but fails the test in
> `quadratic_form__equivalence_testing` added by this ticket? 


should be fixed by #30800
