# Issue 27039: Add DESTDIR support for optional packages that use autotools

archive/issues_026802.json:
```json
{
    "assignees": [],
    "body": "All these packages have standard autotools builds, so their transformation was mostly mechanical and trivial.  Only two slight exceptions:\n\n* The `configure` script for deformation is not actually generated by autoconf and does not support all the standard options (e.g. `--libdir`).  However, the rest of it is straightforward.\n\n* For mpfrcx we also add an `spkg-legacy-uninstall` script.\n\nI've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical, and doctests pass for me on Linux. There should really be no difference for these packages compared to how they were previously built and installed.\n\nKeywords: **destdir 4ti2 bliss cbc csdp deformation fricas gp2c igraph latte_int libogg lidia lrslib mpfrcx sirocco tdlib**\n\nBranch: **[`1747a4c`](https://github.com/sagemath/sagetrac-mirror/commit/1747a4c591676b9166ca47b1ae6c6a2d721bd52e)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Erik Bray**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27039_\n\n",
    "closed_at": "2019-01-24T18:17:37Z",
    "created_at": "2019-01-10T13:37:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add DESTDIR support for optional packages that use autotools",
    "type": "issue",
    "updated_at": "2019-01-31T12:39:20Z",
    "url": "https://github.com/sagemath/sage/issues/27039",
    "user": "https://github.com/embray"
}
```
All these packages have standard autotools builds, so their transformation was mostly mechanical and trivial.  Only two slight exceptions:

* The `configure` script for deformation is not actually generated by autoconf and does not support all the standard options (e.g. `--libdir`).  However, the rest of it is straightforward.

* For mpfrcx we also add an `spkg-legacy-uninstall` script.

I've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical, and doctests pass for me on Linux. There should really be no difference for these packages compared to how they were previously built and installed.

Keywords: **destdir 4ti2 bliss cbc csdp deformation fricas gp2c igraph latte_int libogg lidia lrslib mpfrcx sirocco tdlib**

Branch: **[`1747a4c`](https://github.com/sagemath/sagetrac-mirror/commit/1747a4c591676b9166ca47b1ae6c6a2d721bd52e)**

Reviewer: **Frédéric Chapoton**

Author: **Erik Bray**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/27039_





---

archive/issue_events_373408.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T13:37:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373408"
}
```



---

archive/issue_events_373409.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T13:37:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373409"
}
```



---

archive/issue_events_373410.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T13:37:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373410"
}
```



---

archive/issue_comments_416945.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n * For mpfrcx we also add an `spkg-legacy-uninstall` script.\n \n-I've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical.  Still running the doctests to be sure, but there should really be no difference for these packages compared to how they were previously built and installed.\n+I've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical, and doctests pass for me on Linux. There should really be no difference for these packages compared to how they were previously built and installed.\n``````\n",
    "created_at": "2019-01-10T15:12:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416945",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 * For mpfrcx we also add an `spkg-legacy-uninstall` script.
 
-I've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical.  Still running the doctests to be sure, but there should really be no difference for these packages compared to how they were previously built and installed.
+I've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical, and doctests pass for me on Linux. There should really be no difference for these packages compared to how they were previously built and installed.
``````




---

archive/issue_events_373411.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-10T15:12:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373411"
}
```



---

archive/issue_comments_416946.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIn `tdlib`, you added `sdh_make` where there was no `make`. Is this ok ?\n\nOtherwise, positive review",
    "created_at": "2019-01-15T19:00:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416946",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:2" align="right">comment:2</div>

In `tdlib`, you added `sdh_make` where there was no `make`. Is this ok ?

Otherwise, positive review



---

archive/issue_comments_416947.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@fchapoton](#comment:2):\n> In `tdlib`, you added `sdh_make` where there was no `make`. Is this ok ?\n> \n> Otherwise, positive review\n\nI double-checked on this just to be sure, but it is indeed a standard automake package so it is harmless to add the make call, and it looks more \"standard\" without it.  The fact is, this package is just a collection of headers, so there is nothing to \"build\" with a `make` call and it's possible to just skip straight to `make install`.  But should that change for any reason at least our bases are covered this way.  Good catch though--it wasn't obvious.",
    "created_at": "2019-01-16T10:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416947",
    "user": "https://github.com/embray"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@fchapoton](#comment:2):
> In `tdlib`, you added `sdh_make` where there was no `make`. Is this ok ?
> 
> Otherwise, positive review

I double-checked on this just to be sure, but it is indeed a standard automake package so it is harmless to add the make call, and it looks more "standard" without it.  The fact is, this package is just a collection of headers, so there is nothing to "build" with a `make` call and it's possible to just skip straight to `make install`.  But should that change for any reason at least our bases are covered this way.  Good catch though--it wasn't obvious.



---

archive/issue_events_373412.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-16T12:38:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373412"
}
```



---

archive/issue_events_373413.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-16T12:38:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373413"
}
```



---

archive/issue_comments_416948.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nok, thanks",
    "created_at": "2019-01-16T12:38:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416948",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

ok, thanks



---

archive/issue_comments_416949.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-01-16T12:38:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416949",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_events_373414.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373414"
}
```



---

archive/issue_events_373415.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27039#event-373415"
}
```



---

archive/issue_comments_416950.json:
```json
{
    "body": "Changed branch from **[u/embray/build/destdir-optional-autotools](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/destdir-optional-autotools)** to **[`1747a4c`](https://github.com/sagemath/sagetrac-mirror/commit/1747a4c591676b9166ca47b1ae6c6a2d721bd52e)**",
    "created_at": "2019-01-24T18:17:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416950",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/embray/build/destdir-optional-autotools](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/destdir-optional-autotools)** to **[`1747a4c`](https://github.com/sagemath/sagetrac-mirror/commit/1747a4c591676b9166ca47b1ae6c6a2d721bd52e)**



---

archive/issue_comments_416951.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nGreat to see this merged.  Thanks!",
    "created_at": "2019-01-31T12:39:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416951",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

Great to see this merged.  Thanks!



---

archive/issue_comments_416952.json:
```json
{
    "body": "Changed commit from **[`1747a4c`](https://github.com/sagemath/sagetrac-mirror/commit/1747a4c591676b9166ca47b1ae6c6a2d721bd52e)** to none",
    "created_at": "2019-01-31T12:39:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27039#issuecomment-416952",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`1747a4c`](https://github.com/sagemath/sagetrac-mirror/commit/1747a4c591676b9166ca47b1ae6c6a2d721bd52e)** to none
