# Issue 27675: py3 fixes in rings/polynomial/polynomial_element.pyx

archive/issues_027438.json:
```json
{
    "assignees": [],
    "body": "Mark some `long(...)` tests as `# py2`, and also deprecate the `__long__` method.\n\n**Branch/Commit:** [44d4301714d0813a205df645beb4df060188c3cc](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** John Palmieri\n\nIssue created by migration from https://trac.sagemath.org/ticket/27675\n\n",
    "closed_at": "2019-04-18T19:56:31Z",
    "created_at": "2019-04-16T00:06:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3 fixes in rings/polynomial/polynomial_element.pyx",
    "type": "issue",
    "updated_at": "2019-04-18T19:56:31Z",
    "url": "https://github.com/sagemath/sage/issues/27675",
    "user": "https://github.com/jhpalmieri"
}
```
Mark some `long(...)` tests as `# py2`, and also deprecate the `__long__` method.

**Branch/Commit:** [44d4301714d0813a205df645beb4df060188c3cc](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)

**Reviewer:** Travis Scrimshaw

**Author:** John Palmieri

Issue created by migration from https://trac.sagemath.org/ticket/27675





---

archive/issue_events_332048.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332048"
}
```



---

archive/issue_events_332049.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "08517b",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332049"
}
```



---

archive/issue_events_332050.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332050"
}
```



---

archive/issue_comments_431600.json:
```json
{
    "body": "**Branch:** [u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)",
    "created_at": "2019-04-16T00:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431600",
    "user": "https://github.com/jhpalmieri"
}
```

**Branch:** [u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)



---

archive/issue_comments_431601.json:
```json
{
    "body": "**Commit:** [70acaf6957a79f53a802c3ad219a2479291a8570](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)",
    "created_at": "2019-04-16T00:07:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431601",
    "user": "https://github.com/jhpalmieri"
}
```

**Commit:** [70acaf6957a79f53a802c3ad219a2479291a8570](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)



---

archive/issue_events_332051.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:07:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332051"
}
```



---

archive/issue_comments_431602.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570\">70acaf6</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>\n",
    "created_at": "2019-04-16T00:07:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431602",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570">70acaf6</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>




---

archive/issue_events_332052.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-16T05:59:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332052"
}
```



---

archive/issue_events_332053.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-16T05:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332053"
}
```



---

archive/issue_comments_431603.json:
```json
{
    "body": "<a id='comment:3'></a>\nfailing doctests, see patchbot",
    "created_at": "2019-04-16T05:59:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431603",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
failing doctests, see patchbot



---

archive/issue_comments_431604.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc\">44d4301</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>\n",
    "created_at": "2019-04-16T14:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431604",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc">44d4301</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>




---

archive/issue_comments_431605.json:
```json
{
    "body": "**Changing commit** from \"[70acaf6957a79f53a802c3ad219a2479291a8570](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)\" to \"[44d4301714d0813a205df645beb4df060188c3cc](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)\".",
    "created_at": "2019-04-16T14:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431605",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[70acaf6957a79f53a802c3ad219a2479291a8570](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)" to "[44d4301714d0813a205df645beb4df060188c3cc](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)".



---

archive/issue_comments_431606.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis should fix the doctests. A question about Python 3, though: in an interactive session, I see this:\n\n```\nsage: R.<x> = PolynomialRing(QQ)\nsage: S.<a> = R.quotient(x^3-2)\nsage: long(S(10))\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-4-be7f7f725292> in <module>()\n----> 1 long(S(Integer(10)))\n\nNameError: name 'long' is not defined\n```\nBut this (from `polynomial_quotient_ring_element.py`) passes doctests with Python 3:\n\n```\n            sage: R.<x> = PolynomialRing(QQ)\n            sage: S.<a> = R.quotient(x^3-2)\n            sage: long(S(10))\n            10L\n```\nIn this ticket I've decided to mark that test as `# py2`, but it doesn't seem to be necessary, and I don't understand why. Any explanations? (I've confirmed that the test is actually being run.)",
    "created_at": "2019-04-16T14:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431606",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
This should fix the doctests. A question about Python 3, though: in an interactive session, I see this:

```
sage: R.<x> = PolynomialRing(QQ)
sage: S.<a> = R.quotient(x^3-2)
sage: long(S(10))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-4-be7f7f725292> in <module>()
----> 1 long(S(Integer(10)))

NameError: name 'long' is not defined
```
But this (from `polynomial_quotient_ring_element.py`) passes doctests with Python 3:

```
            sage: R.<x> = PolynomialRing(QQ)
            sage: S.<a> = R.quotient(x^3-2)
            sage: long(S(10))
            10L
```
In this ticket I've decided to mark that test as `# py2`, but it doesn't seem to be necessary, and I don't understand why. Any explanations? (I've confirmed that the test is actually being run.)



---

archive/issue_events_332054.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T14:49:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332054"
}
```



---

archive/issue_events_332055.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T14:49:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332055"
}
```



---

archive/issue_comments_431607.json:
```json
{
    "body": "<a id='comment:7'></a>\nHere's the answer to my question: in `doctest/forker.py`, we have\n\n```\n    if six.PY2:\n        extra_globals = {}\n    else:\n        extra_globals = {'long': int}\n    \"\"\"\n    Extra objects to place in the global namespace in which tests are run.\n    Normally this should be empty but there are special cases where it may\n    be useful.\n\n    In particular, on Python 3 add ``long`` as an alias for ``int`` so that\n    tests that use the ``long`` built-in (of which there are many) still pass.\n    We do this so that the test suite can run on Python 3 while Python 2 is\n    still the default.\n    \"\"\"\n```\nI think we should clean this up: Sage's actual behavior should not differ that much from doctest behavior. (Not on this ticket, obviously.)",
    "created_at": "2019-04-16T15:31:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431607",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
Here's the answer to my question: in `doctest/forker.py`, we have

```
    if six.PY2:
        extra_globals = {}
    else:
        extra_globals = {'long': int}
    """
    Extra objects to place in the global namespace in which tests are run.
    Normally this should be empty but there are special cases where it may
    be useful.

    In particular, on Python 3 add ``long`` as an alias for ``int`` so that
    tests that use the ``long`` built-in (of which there are many) still pass.
    We do this so that the test suite can run on Python 3 while Python 2 is
    still the default.
    """
```
I think we should clean this up: Sage's actual behavior should not differ that much from doctest behavior. (Not on this ticket, obviously.)



---

archive/issue_events_332056.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-04-17T00:24:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332056"
}
```



---

archive/issue_events_332057.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-04-17T00:24:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332057"
}
```



---

archive/issue_comments_431608.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2019-04-17T00:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431608",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_431609.json:
```json
{
    "body": "<a id='comment:8'></a>\nLGTM.",
    "created_at": "2019-04-17T00:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431609",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
LGTM.



---

archive/issue_comments_431610.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)\" to \"[44d4301714d0813a205df645beb4df060188c3cc](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)\".",
    "created_at": "2019-04-18T19:56:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431610",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)" to "[44d4301714d0813a205df645beb4df060188c3cc](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)".



---

archive/issue_events_332058.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-18T19:56:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332058"
}
```



---

archive/issue_events_332059.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3ce5aa83c99e56bdd3ee902cdc5cae710c42b15b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-04-18T19:56:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-332059"
}
```
