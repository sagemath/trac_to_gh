# Issue 27675: py3 fixes in rings/polynomial/polynomial_element.pyx

archive/issues_027438.json:
```json
{
    "assignees": [],
    "body": "Mark some `long(...)` tests as `# py2`, and also deprecate the `__long__` method.\n\nBranch/Commit: **[44d4301](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **John Palmieri**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27675_\n\n",
    "closed_at": "2019-04-18T19:56:31Z",
    "created_at": "2019-04-16T00:06:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3 fixes in rings/polynomial/polynomial_element.pyx",
    "type": "issue",
    "updated_at": "2019-04-18T19:56:31Z",
    "url": "https://github.com/sagemath/sage/issues/27675",
    "user": "https://github.com/jhpalmieri"
}
```
Mark some `long(...)` tests as `# py2`, and also deprecate the `__long__` method.

Branch/Commit: **[44d4301](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)**

Reviewer: **Travis Scrimshaw**

Author: **John Palmieri**

_Issue created by migration from https://trac.sagemath.org/ticket/27675_





---

archive/issue_events_348733.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348733"
}
```



---

archive/issue_events_348734.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348734"
}
```



---

archive/issue_events_348735.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348735"
}
```



---

archive/issue_events_348736.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:06:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348736"
}
```



---

archive/issue_comments_431778.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)**",
    "created_at": "2019-04-16T00:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431778",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)**



---

archive/issue_comments_431779.json:
```json
{
    "body": "Commit: **[70acaf6](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)**",
    "created_at": "2019-04-16T00:07:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431779",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[70acaf6](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)**



---

archive/issue_events_348737.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T00:07:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348737"
}
```



---

archive/issue_comments_431780.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570\">70acaf6</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>\n",
    "created_at": "2019-04-16T00:07:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431780",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'>Comment 2:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570">70acaf6</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>




---

archive/issue_events_348738.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-16T05:59:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348738"
}
```



---

archive/issue_events_348739.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-16T05:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348739"
}
```



---

archive/issue_comments_431781.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nfailing doctests, see patchbot",
    "created_at": "2019-04-16T05:59:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431781",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'>Comment 3:</a>
failing doctests, see patchbot



---

archive/issue_comments_431782.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc\">44d4301</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>\n",
    "created_at": "2019-04-16T14:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431782",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc">44d4301</a></td><td><code>trac 27675: py3 fixes in rings/polynomial/polynomial_element.pyx</code></td></tr></table>




---

archive/issue_comments_431783.json:
```json
{
    "body": "Changed commit from **[70acaf6](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)** to **[44d4301](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)**",
    "created_at": "2019-04-16T14:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431783",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[70acaf6](https://github.com/sagemath/sagetrac-mirror/commit/70acaf6957a79f53a802c3ad219a2479291a8570)** to **[44d4301](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)**



---

archive/issue_comments_431784.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nThis should fix the doctests. A question about Python 3, though: in an interactive session, I see this:\n\n```\nsage: R.<x> = PolynomialRing(QQ)\nsage: S.<a> = R.quotient(x^3-2)\nsage: long(S(10))\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-4-be7f7f725292> in <module>()\n----> 1 long(S(Integer(10)))\n\nNameError: name 'long' is not defined\n```\nBut this (from `polynomial_quotient_ring_element.py`) passes doctests with Python 3:\n\n```\n            sage: R.<x> = PolynomialRing(QQ)\n            sage: S.<a> = R.quotient(x^3-2)\n            sage: long(S(10))\n            10L\n```\nIn this ticket I've decided to mark that test as `# py2`, but it doesn't seem to be necessary, and I don't understand why. Any explanations? (I've confirmed that the test is actually being run.)",
    "created_at": "2019-04-16T14:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431784",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'>Comment 5:</a>
This should fix the doctests. A question about Python 3, though: in an interactive session, I see this:

```
sage: R.<x> = PolynomialRing(QQ)
sage: S.<a> = R.quotient(x^3-2)
sage: long(S(10))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-4-be7f7f725292> in <module>()
----> 1 long(S(Integer(10)))

NameError: name 'long' is not defined
```
But this (from `polynomial_quotient_ring_element.py`) passes doctests with Python 3:

```
            sage: R.<x> = PolynomialRing(QQ)
            sage: S.<a> = R.quotient(x^3-2)
            sage: long(S(10))
            10L
```
In this ticket I've decided to mark that test as `# py2`, but it doesn't seem to be necessary, and I don't understand why. Any explanations? (I've confirmed that the test is actually being run.)



---

archive/issue_events_348740.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T14:49:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348740"
}
```



---

archive/issue_events_348741.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-04-16T14:49:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348741"
}
```



---

archive/issue_comments_431785.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nHere's the answer to my question: in `doctest/forker.py`, we have\n\n```\n    if six.PY2:\n        extra_globals = {}\n    else:\n        extra_globals = {'long': int}\n    \"\"\"\n    Extra objects to place in the global namespace in which tests are run.\n    Normally this should be empty but there are special cases where it may\n    be useful.\n\n    In particular, on Python 3 add ``long`` as an alias for ``int`` so that\n    tests that use the ``long`` built-in (of which there are many) still pass.\n    We do this so that the test suite can run on Python 3 while Python 2 is\n    still the default.\n    \"\"\"\n```\nI think we should clean this up: Sage's actual behavior should not differ that much from doctest behavior. (Not on this ticket, obviously.)",
    "created_at": "2019-04-16T15:31:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431785",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'>Comment 7:</a>
Here's the answer to my question: in `doctest/forker.py`, we have

```
    if six.PY2:
        extra_globals = {}
    else:
        extra_globals = {'long': int}
    """
    Extra objects to place in the global namespace in which tests are run.
    Normally this should be empty but there are special cases where it may
    be useful.

    In particular, on Python 3 add ``long`` as an alias for ``int`` so that
    tests that use the ``long`` built-in (of which there are many) still pass.
    We do this so that the test suite can run on Python 3 while Python 2 is
    still the default.
    """
```
I think we should clean this up: Sage's actual behavior should not differ that much from doctest behavior. (Not on this ticket, obviously.)



---

archive/issue_events_348742.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-04-17T00:24:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348742"
}
```



---

archive/issue_events_348743.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-04-17T00:24:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348743"
}
```



---

archive/issue_comments_431786.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2019-04-17T00:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431786",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_431787.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nLGTM.",
    "created_at": "2019-04-17T00:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431787",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'>Comment 8:</a>
LGTM.



---

archive/issue_comments_431788.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)** to **[44d4301](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)**",
    "created_at": "2019-04-18T19:56:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27675#issuecomment-431788",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/poly_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/poly_element)** to **[44d4301](https://github.com/sagemath/sagetrac-mirror/commit/44d4301714d0813a205df645beb4df060188c3cc)**



---

archive/issue_events_348744.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-18T19:56:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348744"
}
```



---

archive/issue_events_348745.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3ce5aa83c99e56bdd3ee902cdc5cae710c42b15b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-04-18T19:56:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27675",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27675#event-348745"
}
```
