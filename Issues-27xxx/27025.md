# Issue 27025: NULL and multiple output from R

archive/issues_026788.json:
```json
{
    "assignees": [],
    "body": "In Sage 8.4 we had\n\n```\nsage: r.eval(\"graphics.off()\")\n''\nsage: r.eval(\"\"\"\n....: 1\n....: 2\n....: \"\"\")\n'[1] 1\\n[1] 2'\n```\nin Sage 8.5 this gives\n\n```\nsage: r.eval(\"graphics.off()\")\n'NULL'\nsage: r.eval(\"\"\"\n....: 1\n....: 2\n....: \"\"\")\n'[1] 2'\n```\nwhich is annoying and inconsistent with the output one gets from R using these commands:\n\n```\n> graphics.off()\n> 1\n[1] 1\n> 2\n[1] 2\n```\nI've also seen this example in the documentation:\n\n```\nsage: r.png(filename='\"%s\"'%filename)             # optional -- rgraphics\nNULL\n```\nwhich again I think is wrong - there should be no NULL output when saving a file.\n\nCC:  @timokau @kiwifb\n\nBranch/Commit: **[u/gh-timokau/r-empty-results](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/r-empty-results) @ [`f05ee12`](https://github.com/sagemath/sagetrac-mirror/commit/f05ee1203de8eeb6daa67cb8770822f9ab144b82)**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27025_\n\n",
    "created_at": "2019-01-06T22:39:24Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "NULL and multiple output from R",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/27025",
    "user": "https://github.com/novoselt"
}
```
In Sage 8.4 we had

```
sage: r.eval("graphics.off()")
''
sage: r.eval("""
....: 1
....: 2
....: """)
'[1] 1\n[1] 2'
```
in Sage 8.5 this gives

```
sage: r.eval("graphics.off()")
'NULL'
sage: r.eval("""
....: 1
....: 2
....: """)
'[1] 2'
```
which is annoying and inconsistent with the output one gets from R using these commands:

```
> graphics.off()
> 1
[1] 1
> 2
[1] 2
```
I've also seen this example in the documentation:

```
sage: r.png(filename='"%s"'%filename)             # optional -- rgraphics
NULL
```
which again I think is wrong - there should be no NULL output when saving a file.

CC:  @timokau @kiwifb

Branch/Commit: **[u/gh-timokau/r-empty-results](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/r-empty-results) @ [`f05ee12`](https://github.com/sagemath/sagetrac-mirror/commit/f05ee1203de8eeb6daa67cb8770822f9ab144b82)**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/27025_





---

archive/issue_events_368414.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2019-01-06T22:39:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368414"
}
```



---

archive/issue_events_368415.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2019-01-06T22:39:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368415"
}
```



---

archive/issue_events_368416.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2019-01-06T22:39:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368416"
}
```



---

archive/issue_events_368417.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2019-01-06T22:39:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368417"
}
```



---

archive/issue_comments_416657.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAs an example of why this NULL is annoying:\nhttp://faculty.sfasu.edu/judsontw/math-s304/section-16.html\n\nAlso, if there were cells relying on multiple output from multiple commands, they behave differently now as well.",
    "created_at": "2019-01-06T22:53:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416657",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:1" align="right">comment:1</div>

As an example of why this NULL is annoying:
http://faculty.sfasu.edu/judsontw/math-s304/section-16.html

Also, if there were cells relying on multiple output from multiple commands, they behave differently now as well.



---

archive/issue_comments_416658.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI agree this should definitely be fixed.\n\nIncidentally, this is the opposite of what I did in the recent updates to the libgap interface (#22626): Previously, void-returning GAP functions would have their \"return value\" wrapped in a null `GapElement` that actually repr'd as `NULL` which was obviously annoying and distracting.  \n\nIn this case, the old behavior still returned an empty string, which still looks wrong to me.  It should check whether the expression in question has an actual return value or not, and if not then `r.eval` should just return `None`.",
    "created_at": "2019-01-14T09:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416658",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">comment:2</div>

I agree this should definitely be fixed.

Incidentally, this is the opposite of what I did in the recent updates to the libgap interface (#22626): Previously, void-returning GAP functions would have their "return value" wrapped in a null `GapElement` that actually repr'd as `NULL` which was obviously annoying and distracting.  

In this case, the old behavior still returned an empty string, which still looks wrong to me.  It should check whether the expression in question has an actual return value or not, and if not then `r.eval` should just return `None`.



---

archive/issue_comments_416659.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nRight, thanks for reporting. The `eval` function actually just hands of to `rpy2`:\n\n```\ndef eval(self, code, *args, **kwds):\n    self._lazy_init()\n    return str(robjects.r(code)).rstrip()\n```\n\nIn this case `robjects.r(\"graphics.off()\")` is `rpy2.rinterface.NULL`, which unfortunately is implemented to have a string representation of `NULL`. I'd argue this is an upstream bug bug since I think upstream doesn't want to do new python2 releases, we need to fix it ourselves here.\n\nThe fix should be trivial. Just add a `if result == rpy2.rinterface.NULL` to `eval`. However do you know why\n\n```\nsage: r.png(filename='\"%s\"'%filename)             # optional -- rgraphics\nNULL\n```\n\nis different? I didn't touch that in my recent R changes, so that always returned NULL.",
    "created_at": "2019-01-14T19:51:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416659",
    "user": "https://github.com/timokau"
}
```

<div id="comment:3" align="right">comment:3</div>

Right, thanks for reporting. The `eval` function actually just hands of to `rpy2`:

```
def eval(self, code, *args, **kwds):
    self._lazy_init()
    return str(robjects.r(code)).rstrip()
```

In this case `robjects.r("graphics.off()")` is `rpy2.rinterface.NULL`, which unfortunately is implemented to have a string representation of `NULL`. I'd argue this is an upstream bug bug since I think upstream doesn't want to do new python2 releases, we need to fix it ourselves here.

The fix should be trivial. Just add a `if result == rpy2.rinterface.NULL` to `eval`. However do you know why

```
sage: r.png(filename='"%s"'%filename)             # optional -- rgraphics
NULL
```

is different? I didn't touch that in my recent R changes, so that always returned NULL.



---

archive/issue_comments_416660.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nTested only the `r.py` file without any optionals though.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f05ee1203de8eeb6daa67cb8770822f9ab144b82\"><code>f05ee12</code></a></td><td><code>Fix R interface string representation of empty results</code></td></tr></table>\n",
    "created_at": "2019-01-14T20:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416660",
    "user": "https://github.com/timokau"
}
```

<div id="comment:4" align="right">comment:4</div>

Tested only the `r.py` file without any optionals though.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f05ee1203de8eeb6daa67cb8770822f9ab144b82"><code>f05ee12</code></a></td><td><code>Fix R interface string representation of empty results</code></td></tr></table>




---

archive/issue_comments_416661.json:
```json
{
    "body": "Branch: **[u/gh-timokau/r-empty-results](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/r-empty-results)**",
    "created_at": "2019-01-14T20:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416661",
    "user": "https://github.com/timokau"
}
```

Branch: **[u/gh-timokau/r-empty-results](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/r-empty-results)**



---

archive/issue_events_368418.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2019-01-14T20:17:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368418"
}
```



---

archive/issue_comments_416662.json:
```json
{
    "body": "Commit: **[`f05ee12`](https://github.com/sagemath/sagetrac-mirror/commit/f05ee1203de8eeb6daa67cb8770822f9ab144b82)**",
    "created_at": "2019-01-14T20:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416662",
    "user": "https://github.com/timokau"
}
```

Commit: **[`f05ee12`](https://github.com/sagemath/sagetrac-mirror/commit/f05ee1203de8eeb6daa67cb8770822f9ab144b82)**



---

archive/issue_comments_416663.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNo idea about `r.png` returning NULL before and after - I thought it was a recent change.\n\nBut apart from NULL there is also change in behaviour for multi-line input. For SageMathCell, that adds that extra graphics command, this means that default output of single commands is not shown at all: https://sagecell.sagemath.org/?z=eJwzBAAAMgAy&lang=r Is it easy to restore old behaviour for this case?",
    "created_at": "2019-01-14T20:42:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416663",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:5" align="right">comment:5</div>

No idea about `r.png` returning NULL before and after - I thought it was a recent change.

But apart from NULL there is also change in behaviour for multi-line input. For SageMathCell, that adds that extra graphics command, this means that default output of single commands is not shown at all: https://sagecell.sagemath.org/?z=eJwzBAAAMgAy&lang=r Is it easy to restore old behaviour for this case?



---

archive/issue_comments_416664.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI'm not entirely sure what you mean. Do you mean multiline input to `eval()`? How should that behave? Just pass each line to R separately? Does R have some sort of line-continuation that must be considered?",
    "created_at": "2019-01-14T21:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416664",
    "user": "https://github.com/timokau"
}
```

<div id="comment:6" align="right">comment:6</div>

I'm not entirely sure what you mean. Do you mean multiline input to `eval()`? How should that behave? Just pass each line to R separately? Does R have some sort of line-continuation that must be considered?



---

archive/issue_comments_416665.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI gave an example in the description of how things worked before and what happens now. I don't know how it should be implemented as my knowledge of R is extremely limited, I only learned enough to save graphics to a file ;-)",
    "created_at": "2019-01-14T23:14:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416665",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:7" align="right">comment:7</div>

I gave an example in the description of how things worked before and what happens now. I don't know how it should be implemented as my knowledge of R is extremely limited, I only learned enough to save graphics to a file ;-)



---

archive/issue_comments_416666.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFor your examples just splitting on newline would work. But the same issue seems to appear any time you eval more than one statement, for example `r.eval(\"1;3\")`.\n\nI'd personally argue that is out of scope for eval, but since it was supported before...\n\nI don't know much about R myself, I only messed with it in the first place because it was stuck on an old version for so long and nobody else was doing anything.",
    "created_at": "2019-01-15T09:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416666",
    "user": "https://github.com/timokau"
}
```

<div id="comment:8" align="right">comment:8</div>

For your examples just splitting on newline would work. But the same issue seems to appear any time you eval more than one statement, for example `r.eval("1;3")`.

I'd personally argue that is out of scope for eval, but since it was supported before...

I don't know much about R myself, I only messed with it in the first place because it was stuck on an old version for so long and nobody else was doing anything.



---

archive/issue_comments_416667.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nIn\n\n```diff\n         \"\"\"\n         self._lazy_init()\n-        return str(robjects.r(code)).rstrip()\n+        result = robjects.r(code)\n+        if result == rinterface.NULL:\n+            # trac #27025\n+            result = None\n+        else:\n+            result = str(result)\n+\n+        if isinstance(result, str):\n+            # no trailing newlines\n+            result = result.rstrip()\n \n+        return result\n```\n\nThis looks like it could be simplified: If `result != NULL` then you always do `result = str(result)` anyways, so why not just move the `.rstrip()` into the statement in the `else:` block and get rid of the superfluous `isinstance(result, str)`?\n\nI'm also surprised now, upon reading the docs for the eval method, that it *always* returns the result s a string, and not the actual wrapped R object itself (as the libgap interface would do).  Why is this?  That makes me rethink having it ever return `None` in the first place.  Though I'd be more inclined to say the eval-returns-a-string interface is a mistake in the first place and should be done away with.",
    "created_at": "2019-01-15T15:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416667",
    "user": "https://github.com/embray"
}
```

<div id="comment:9" align="right">comment:9</div>

In

```diff
         """
         self._lazy_init()
-        return str(robjects.r(code)).rstrip()
+        result = robjects.r(code)
+        if result == rinterface.NULL:
+            # trac #27025
+            result = None
+        else:
+            result = str(result)
+
+        if isinstance(result, str):
+            # no trailing newlines
+            result = result.rstrip()
 
+        return result
```

This looks like it could be simplified: If `result != NULL` then you always do `result = str(result)` anyways, so why not just move the `.rstrip()` into the statement in the `else:` block and get rid of the superfluous `isinstance(result, str)`?

I'm also surprised now, upon reading the docs for the eval method, that it *always* returns the result s a string, and not the actual wrapped R object itself (as the libgap interface would do).  Why is this?  That makes me rethink having it ever return `None` in the first place.  Though I'd be more inclined to say the eval-returns-a-string interface is a mistake in the first place and should be done away with.



---

archive/issue_comments_416668.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@embray](#comment:9):\n> In\n> \n> ```diff\n>          \"\"\"\n>          self._lazy_init()\n> -        return str(robjects.r(code)).rstrip()\n> +        result = robjects.r(code)\n> +        if result == rinterface.NULL:\n> +            # trac #27025\n> +            result = None\n> +        else:\n> +            result = str(result)\n> +\n> +        if isinstance(result, str):\n> +            # no trailing newlines\n> +            result = result.rstrip()\n>  \n> +        return result\n> ```\n> \n> This looks like it could be simplified: If `result != NULL` then you always do `result = str(result)` anyways, so why not just move the `.rstrip()` into the statement in the `else:` block and get rid of the superfluous `isinstance(result, str)`?\n\nI think I had a reason for that, but I can't remember it and I can't see any reason now. So it can probably be changed.\n\n> I'm also surprised now, upon reading the docs for the eval method, that it *always* returns the result s a string, and not the actual wrapped R object itself (as the libgap interface would do).  Why is this?  That makes me rethink having it ever return `None` in the first place.  Though I'd be more inclined to say the eval-returns-a-string interface is a mistake in the first place and should be done away with.\n\nIf you wanted a proper object, you'd use `__call__` instead: `r(\"42\")`. Not sure why its done that way, I assume its just a symptom of having been a pexpect interface before. There it was natural to eval first and then translate to an object. Now we do it the other way around: get an object first, then produce a string if requested.\n\nGap does the same thing:\n\n```\nsage: type(gap.eval('42;'))\n<type: 'str'>\n```",
    "created_at": "2019-01-15T17:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416668",
    "user": "https://github.com/timokau"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@embray](#comment:9):
> In
> 
> ```diff
>          """
>          self._lazy_init()
> -        return str(robjects.r(code)).rstrip()
> +        result = robjects.r(code)
> +        if result == rinterface.NULL:
> +            # trac #27025
> +            result = None
> +        else:
> +            result = str(result)
> +
> +        if isinstance(result, str):
> +            # no trailing newlines
> +            result = result.rstrip()
>  
> +        return result
> ```
> 
> This looks like it could be simplified: If `result != NULL` then you always do `result = str(result)` anyways, so why not just move the `.rstrip()` into the statement in the `else:` block and get rid of the superfluous `isinstance(result, str)`?

I think I had a reason for that, but I can't remember it and I can't see any reason now. So it can probably be changed.

> I'm also surprised now, upon reading the docs for the eval method, that it *always* returns the result s a string, and not the actual wrapped R object itself (as the libgap interface would do).  Why is this?  That makes me rethink having it ever return `None` in the first place.  Though I'd be more inclined to say the eval-returns-a-string interface is a mistake in the first place and should be done away with.

If you wanted a proper object, you'd use `__call__` instead: `r("42")`. Not sure why its done that way, I assume its just a symptom of having been a pexpect interface before. There it was natural to eval first and then translate to an object. Now we do it the other way around: get an object first, then produce a string if requested.

Gap does the same thing:

```
sage: type(gap.eval('42;'))
<type: 'str'>
```



---

archive/issue_comments_416669.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nRight, I believe we talked about that before on the mailing list.  I understand that the existing interface makes sense in light of its origin as a pexpect interface.  Perhaps this should in fact be moved into `sage.lib` instead of `sage.interfaces` and updated to a more common interface, while deprecating the old interface.  Now that I think about it I think it should have been done that way in the first place, but I didn't speak up in time so oh well.  Could you please open a ticket for that?  I think we should make a stronger effort to be consistent.",
    "created_at": "2019-01-15T17:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416669",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

Right, I believe we talked about that before on the mailing list.  I understand that the existing interface makes sense in light of its origin as a pexpect interface.  Perhaps this should in fact be moved into `sage.lib` instead of `sage.interfaces` and updated to a more common interface, while deprecating the old interface.  Now that I think about it I think it should have been done that way in the first place, but I didn't speak up in time so oh well.  Could you please open a ticket for that?  I think we should make a stronger effort to be consistent.



---

archive/issue_events_368419.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368419"
}
```



---

archive/issue_events_368420.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368420"
}
```



---

archive/issue_comments_416670.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416670",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_416671.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@embray](#comment:11):\n> Right, I believe we talked about that before on the mailing list.  I understand that the existing interface makes sense in light of its origin as a pexpect interface.  Perhaps this should in fact be moved into `sage.lib` instead of `sage.interfaces` and updated to a more common interface, while deprecating the old interface.  Now that I think about it I think it should have been done that way in the first place, but I didn't speak up in time so oh well.  Could you please open a ticket for that?  I think we should make a stronger effort to be consistent.\n\nI don't think it should have been done like that. The point was to provide a drop-in replacement for the old interface. If we just want an R interface without backward compatibility concerns, I'd just tell users to use rpy2 directly.",
    "created_at": "2019-01-15T19:14:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416671",
    "user": "https://github.com/timokau"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@embray](#comment:11):
> Right, I believe we talked about that before on the mailing list.  I understand that the existing interface makes sense in light of its origin as a pexpect interface.  Perhaps this should in fact be moved into `sage.lib` instead of `sage.interfaces` and updated to a more common interface, while deprecating the old interface.  Now that I think about it I think it should have been done that way in the first place, but I didn't speak up in time so oh well.  Could you please open a ticket for that?  I think we should make a stronger effort to be consistent.

I don't think it should have been done like that. The point was to provide a drop-in replacement for the old interface. If we just want an R interface without backward compatibility concerns, I'd just tell users to use rpy2 directly.



---

archive/issue_comments_416672.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nExcept it's clearly not just a drop-in replacement; it's a rather different way to go about things.  Regardless, what's done is done, and it's still by far a net positive so I'm not complaining :)",
    "created_at": "2019-01-16T10:43:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416672",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Except it's clearly not just a drop-in replacement; it's a rather different way to go about things.  Regardless, what's done is done, and it's still by far a net positive so I'm not complaining :)



---

archive/issue_comments_416673.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIt mostly is. Due to my little R usage and a lack of tests, some issues were probably inevitable. I'm only aware of this issue (the multiline thing may be hard to fix depending on how R handles these) and the multiple instances issue (wontfix from me).\n\nI wouldn't be opposed to deprecating the old api altogether and using rpy2 (maybe a very thin wrapper) instead. But I don't want to fight that fight myself :)",
    "created_at": "2019-01-16T11:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416673",
    "user": "https://github.com/timokau"
}
```

<div id="comment:15" align="right">comment:15</div>

It mostly is. Due to my little R usage and a lack of tests, some issues were probably inevitable. I'm only aware of this issue (the multiline thing may be hard to fix depending on how R handles these) and the multiple instances issue (wontfix from me).

I wouldn't be opposed to deprecating the old api altogether and using rpy2 (maybe a very thin wrapper) instead. But I don't want to fight that fight myself :)



---

archive/issue_events_368421.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2019-01-17T01:31:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368421"
}
```



---

archive/issue_events_368422.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2019-01-17T01:31:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368422"
}
```



---

archive/issue_comments_416674.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nIf someone is just interested in using R, then Sage is probably not the best way to do it. If someone just wants to use R from !Sage/Python specifically, then rpy2 is quite sensible with whatever decisions it comes. But the point of particular output from `eval` etc. is that every interface in Sage (at least in theory), behaves this way. In particular, it is supposed to return a string and it used to return the empty string rather than `None` as \"no output\". I think this definitely has to be the case again.\n\nRegarding multiline treatment - it may be less important as notebooks often show only the last output from commands in a single \"cell\" and a single call to `eval` is kind of like executing a \"cell\". It is still unfortunate that old behaviour is changed without deprecation period, but if nobody else complains and nobody wants to work on it, well then...",
    "created_at": "2019-01-17T01:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416674",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:16" align="right">comment:16</div>

If someone is just interested in using R, then Sage is probably not the best way to do it. If someone just wants to use R from !Sage/Python specifically, then rpy2 is quite sensible with whatever decisions it comes. But the point of particular output from `eval` etc. is that every interface in Sage (at least in theory), behaves this way. In particular, it is supposed to return a string and it used to return the empty string rather than `None` as "no output". I think this definitely has to be the case again.

Regarding multiline treatment - it may be less important as notebooks often show only the last output from commands in a single "cell" and a single call to `eval` is kind of like executing a "cell". It is still unfortunate that old behaviour is changed without deprecation period, but if nobody else complains and nobody wants to work on it, well then...



---

archive/issue_comments_416675.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI will look into it at some point but it's definitely not a priority for me right now.  As you said, while it's absolutely useful to have an R interface in Sage, that's useful more as a glue layer, and not for doing serious R programming, which should just be done in an R-specific UI.",
    "created_at": "2019-01-18T10:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416675",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

I will look into it at some point but it's definitely not a priority for me right now.  As you said, while it's absolutely useful to have an R interface in Sage, that's useful more as a glue layer, and not for doing serious R programming, which should just be done in an R-specific UI.



---

archive/issue_comments_416676.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nExcept, of course, for using it via SageMathCell where Sage is a necessary proxy between browser and R ;-) So I do hope that the issue will be solved in the next 8.7 release...",
    "created_at": "2019-01-18T17:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416676",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:18" align="right">comment:18</div>

Except, of course, for using it via SageMathCell where Sage is a necessary proxy between browser and R ;-) So I do hope that the issue will be solved in the next 8.7 release...



---

archive/issue_events_368423.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368423"
}
```



---

archive/issue_events_368424.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368424"
}
```



---

archive/issue_comments_416677.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416677",
    "user": "https://github.com/embray"
}
```

<div id="comment:19" align="right">comment:19</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_416678.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nTickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416678",
    "user": "https://github.com/embray"
}
```

<div id="comment:20" align="right">comment:20</div>

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_events_368425.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368425"
}
```



---

archive/issue_events_368426.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368426"
}
```



---

archive/issue_events_368427.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368427"
}
```



---

archive/issue_events_368428.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368428"
}
```



---

archive/issue_comments_416679.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416679",
    "user": "https://github.com/embray"
}
```

<div id="comment:21" align="right">comment:21</div>

Ticket retargeted after milestone closed



---

archive/issue_comments_416680.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416680",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_368429.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368429"
}
```



---

archive/issue_events_368430.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368430"
}
```



---

archive/issue_events_368431.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368431"
}
```



---

archive/issue_events_368432.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368432"
}
```



---

archive/issue_comments_416681.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416681",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_368433.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368433"
}
```



---

archive/issue_events_368434.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368434"
}
```



---

archive/issue_comments_416682.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27025#issuecomment-416682",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_368435.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368435"
}
```



---

archive/issue_events_368436.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368436"
}
```



---

archive/issue_events_368437.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368437"
}
```



---

archive/issue_events_368438.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368438"
}
```



---

archive/issue_events_368439.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368439"
}
```



---

archive/issue_events_368440.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368440"
}
```



---

archive/issue_events_368441.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368441"
}
```



---

archive/issue_events_368442.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27025",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27025#event-368442"
}
```
