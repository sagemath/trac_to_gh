# Issue 27346: py3: fix FindStat interface and FancyTuple

archive/issues_027109.json:
```json
{
    "assignees": [],
    "body": "various little fixes here and there...\n\nCC:  @fchapoton @embray\n\nBranch/Commit: **[488e74e](https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Martin Rubey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27346_\n\n",
    "closed_at": "2019-03-13T18:29:35Z",
    "created_at": "2019-02-24T22:01:30Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: fix FindStat interface and FancyTuple",
    "type": "issue",
    "updated_at": "2019-03-13T18:29:35Z",
    "url": "https://github.com/sagemath/sage/issues/27346",
    "user": "https://github.com/mantepse"
}
```
various little fixes here and there...

CC:  @fchapoton @embray

Branch/Commit: **[488e74e](https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9)**

Reviewer: **Frédéric Chapoton**

Author: **Martin Rubey**

_Issue created by migration from https://trac.sagemath.org/ticket/27346_





---

archive/issue_events_357496.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-02-24T22:01:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357496"
}
```



---

archive/issue_events_357497.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-02-24T22:01:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357497"
}
```



---

archive/issue_comments_425672.json:
```json
{
    "body": "Branch: **[u/mantepse/py3__fix_findstat_interface_and_fancytuple](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/py3__fix_findstat_interface_and_fancytuple)**",
    "created_at": "2019-02-24T22:02:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425672",
    "user": "https://github.com/mantepse"
}
```

Branch: **[u/mantepse/py3__fix_findstat_interface_and_fancytuple](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/py3__fix_findstat_interface_and_fancytuple)**



---

archive/issue_events_357498.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-02-24T22:03:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357498"
}
```



---

archive/issue_events_357499.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-02-24T22:03:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357499"
}
```



---

archive/issue_comments_425673.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66931ff6189650c6b7c8a145978340dd24d627d2\">66931ff</a></td><td><code>make FindStat interface and FancyTuple python3 compatible</code></td></tr></table>\n",
    "created_at": "2019-02-24T22:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425673",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'>Comment 2:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66931ff6189650c6b7c8a145978340dd24d627d2">66931ff</a></td><td><code>make FindStat interface and FancyTuple python3 compatible</code></td></tr></table>




---

archive/issue_events_357500.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-02-24T22:03:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357500"
}
```



---

archive/issue_comments_425674.json:
```json
{
    "body": "Author: **Martin Rubey**",
    "created_at": "2019-02-24T22:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425674",
    "user": "https://github.com/mantepse"
}
```

Author: **Martin Rubey**



---

archive/issue_comments_425675.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+various little fixes here and there...\n``````\n",
    "created_at": "2019-02-24T22:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425675",
    "user": "https://github.com/mantepse"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+various little fixes here and there...
``````




---

archive/issue_comments_425676.json:
```json
{
    "body": "Commit: **[66931ff](https://github.com/sagemath/sagetrac-mirror/commit/66931ff6189650c6b7c8a145978340dd24d627d2)**",
    "created_at": "2019-02-24T22:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425676",
    "user": "https://github.com/mantepse"
}
```

Commit: **[66931ff](https://github.com/sagemath/sagetrac-mirror/commit/66931ff6189650c6b7c8a145978340dd24d627d2)**



---

archive/issue_comments_425677.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nThis is wrong:\n\n```\n+        if sys.version_info[0] < 3 and isinstance(result, unicode):\n```\nThe \"unicode\" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.",
    "created_at": "2019-02-25T08:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425677",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'>Comment 3:</a>
This is wrong:

```
+        if sys.version_info[0] < 3 and isinstance(result, unicode):
```
The "unicode" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.



---

archive/issue_comments_425678.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nWhy is this ticket needed at all ? All doctests pass with py3, if I am not mistaken.",
    "created_at": "2019-02-25T09:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425678",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'>Comment 4:</a>
Why is this ticket needed at all ? All doctests pass with py3, if I am not mistaken.



---

archive/issue_comments_425679.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [@fchapoton](#comment%3A4):\n> Why is this ticket needed at all ? All doctests pass with py3, if I am not mistaken.\n\nUnfortunately, not at all:\n\n```\nmartin@convex63:~/sage-python3$ ./sage -t --optional=sage,internet src/sage/databases/findstat.py \ntoo many failed tests, not using stored timings\nRunning doctests with ID 2019-02-25-10-44-09-a715d7b7.\nGit branch: develop\nUsing --optional=internet,memlimit,sage\nDoctesting 1 file.\nsage -t src/sage/databases/findstat.py\n...\n28 items had failures:\n  11 of  16 in sage.databases.findstat\n   6 of  11 in sage.databases.findstat.FindStat\n   4 of  10 in sage.databases.findstat.FindStat.__call__\n   2 of   6 in sage.databases.findstat.FindStatCollection\n   1 of   3 in sage.databases.findstat.FindStatCollections.__iter__\n   7 of   9 in sage.databases.findstat.FindStatCollections._element_constructor_\n   2 of   3 in sage.databases.findstat.FindStatMap.description\n   2 of   3 in sage.databases.findstat.FindStatMap.id\n   2 of   3 in sage.databases.findstat.FindStatMap.id_str\n   2 of   3 in sage.databases.findstat.FindStatMap.name\n   1 of   3 in sage.databases.findstat.FindStatMaps\n   3 of   5 in sage.databases.findstat.FindStatStatistic.__eq__\n   2 of   4 in sage.databases.findstat.FindStatStatistic.__getitem__\n   1 of   3 in sage.databases.findstat.FindStatStatistic.__init__\n   3 of   4 in sage.databases.findstat.FindStatStatistic.__ne__\n   2 of   4 in sage.databases.findstat.FindStatStatistic.__repr__\n   1 of   9 in sage.databases.findstat.FindStatStatistic._find_by_values\n   4 of   6 in sage.databases.findstat.FindStatStatistic._generating_functions_dict\n   3 of   8 in sage.databases.findstat.FindStatStatistic._raise_error_modifying_statistic_with_perfect_match\n   1 of   3 in sage.databases.findstat.FindStatStatistic.data\n   3 of   5 in sage.databases.findstat.FindStatStatistic.first_terms\n   1 of   2 in sage.databases.findstat.FindStatStatistic.function\n   1 of   2 in sage.databases.findstat.FindStatStatistic.references\n   3 of   4 in sage.databases.findstat.FindStatStatistic.set_code\n   5 of   6 in sage.databases.findstat.FindStatStatistic.set_description\n   3 of   4 in sage.databases.findstat.FindStatStatistic.set_references\n   3 of   4 in sage.databases.findstat.FindStatStatistic.set_sage_code\n   1 of   2 in sage.databases.findstat.FindStatStatistic.submit\n    [247 tests, 80 failures, 16.24 s]\n----------------------------------------------------------------------\nsage -t src/sage/databases/findstat.py  # 80 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 16.3 seconds\n    cpu time: 3.0 seconds\n    cumulative wall time: 16.2 seconds\n```",
    "created_at": "2019-02-25T09:44:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425679",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [@fchapoton](#comment%3A4):
> Why is this ticket needed at all ? All doctests pass with py3, if I am not mistaken.

Unfortunately, not at all:

```
martin@convex63:~/sage-python3$ ./sage -t --optional=sage,internet src/sage/databases/findstat.py 
too many failed tests, not using stored timings
Running doctests with ID 2019-02-25-10-44-09-a715d7b7.
Git branch: develop
Using --optional=internet,memlimit,sage
Doctesting 1 file.
sage -t src/sage/databases/findstat.py
...
28 items had failures:
  11 of  16 in sage.databases.findstat
   6 of  11 in sage.databases.findstat.FindStat
   4 of  10 in sage.databases.findstat.FindStat.__call__
   2 of   6 in sage.databases.findstat.FindStatCollection
   1 of   3 in sage.databases.findstat.FindStatCollections.__iter__
   7 of   9 in sage.databases.findstat.FindStatCollections._element_constructor_
   2 of   3 in sage.databases.findstat.FindStatMap.description
   2 of   3 in sage.databases.findstat.FindStatMap.id
   2 of   3 in sage.databases.findstat.FindStatMap.id_str
   2 of   3 in sage.databases.findstat.FindStatMap.name
   1 of   3 in sage.databases.findstat.FindStatMaps
   3 of   5 in sage.databases.findstat.FindStatStatistic.__eq__
   2 of   4 in sage.databases.findstat.FindStatStatistic.__getitem__
   1 of   3 in sage.databases.findstat.FindStatStatistic.__init__
   3 of   4 in sage.databases.findstat.FindStatStatistic.__ne__
   2 of   4 in sage.databases.findstat.FindStatStatistic.__repr__
   1 of   9 in sage.databases.findstat.FindStatStatistic._find_by_values
   4 of   6 in sage.databases.findstat.FindStatStatistic._generating_functions_dict
   3 of   8 in sage.databases.findstat.FindStatStatistic._raise_error_modifying_statistic_with_perfect_match
   1 of   3 in sage.databases.findstat.FindStatStatistic.data
   3 of   5 in sage.databases.findstat.FindStatStatistic.first_terms
   1 of   2 in sage.databases.findstat.FindStatStatistic.function
   1 of   2 in sage.databases.findstat.FindStatStatistic.references
   3 of   4 in sage.databases.findstat.FindStatStatistic.set_code
   5 of   6 in sage.databases.findstat.FindStatStatistic.set_description
   3 of   4 in sage.databases.findstat.FindStatStatistic.set_references
   3 of   4 in sage.databases.findstat.FindStatStatistic.set_sage_code
   1 of   2 in sage.databases.findstat.FindStatStatistic.submit
    [247 tests, 80 failures, 16.24 s]
----------------------------------------------------------------------
sage -t src/sage/databases/findstat.py  # 80 doctests failed
----------------------------------------------------------------------
Total time for all tests: 16.3 seconds
    cpu time: 3.0 seconds
    cumulative wall time: 16.2 seconds
```



---

archive/issue_comments_425680.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@fchapoton](#comment%3A3):\n> This is wrong:\n> \n> ```\n> +        if sys.version_info[0] < 3 and isinstance(result, unicode):\n> ```\n> The \"unicode\" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.\n\nI took this from #23475:\n\n```\ndiff --git a/src/sage/structure/sage_object.pyx b/src/sage/structure/sage_object.pyx\nindex ca1227b..6a00995 100644\n--- a/src/sage/structure/sage_object.pyx\n+++ b/src/sage/structure/sage_object.pyx\n@@ -235,8 +235,8 @@ cdef class SageObject:\n             return str(type(self))\n         else:\n             result = repr_func()\n-            if isinstance(result, unicode):\n-                # Py3 compatibility: allow _repr_ to return unicode\n+            if sys.version_info[0] < 3 and isinstance(result, unicode):\n+                # for Py3 compatibility: allow _repr_ to return unicode\n                 return result.encode('utf-8')\n             else:\n                 return result\n```",
    "created_at": "2019-02-25T09:46:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425680",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@fchapoton](#comment%3A3):
> This is wrong:
> 
> ```
> +        if sys.version_info[0] < 3 and isinstance(result, unicode):
> ```
> The "unicode" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.

I took this from #23475:

```
diff --git a/src/sage/structure/sage_object.pyx b/src/sage/structure/sage_object.pyx
index ca1227b..6a00995 100644
--- a/src/sage/structure/sage_object.pyx
+++ b/src/sage/structure/sage_object.pyx
@@ -235,8 +235,8 @@ cdef class SageObject:
             return str(type(self))
         else:
             result = repr_func()
-            if isinstance(result, unicode):
-                # Py3 compatibility: allow _repr_ to return unicode
+            if sys.version_info[0] < 3 and isinstance(result, unicode):
+                # for Py3 compatibility: allow _repr_ to return unicode
                 return result.encode('utf-8')
             else:
                 return result
```



---

archive/issue_comments_425681.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThis is available only inside .pyx files, not for .py files\n\nReplying to [@mantepse](#comment%3A6):\n> Replying to [@fchapoton](#comment%3A3):\n> > This is wrong:\n> > \n> > ```\n> > +        if sys.version_info[0] < 3 and isinstance(result, unicode):\n> > ```\n> > The \"unicode\" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.\n\n> \n> I took this from #23475:\n> \n> ```\n> diff --git a/src/sage/structure/sage_object.pyx b/src/sage/structure/sage_object.pyx\n> index ca1227b..6a00995 100644\n> --- a/src/sage/structure/sage_object.pyx\n> +++ b/src/sage/structure/sage_object.pyx\n> @@ -235,8 +235,8 @@ cdef class SageObject:\n>              return str(type(self))\n>          else:\n>              result = repr_func()\n> -            if isinstance(result, unicode):\n> -                # Py3 compatibility: allow _repr_ to return unicode\n> +            if sys.version_info[0] < 3 and isinstance(result, unicode):\n> +                # for Py3 compatibility: allow _repr_ to return unicode\n>                  return result.encode('utf-8')\n>              else:\n>                  return result\n> ```",
    "created_at": "2019-02-25T12:24:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425681",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'>Comment 7:</a>
This is available only inside .pyx files, not for .py files

Replying to [@mantepse](#comment%3A6):
> Replying to [@fchapoton](#comment%3A3):
> > This is wrong:
> > 
> > ```
> > +        if sys.version_info[0] < 3 and isinstance(result, unicode):
> > ```
> > The "unicode" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.

> 
> I took this from #23475:
> 
> ```
> diff --git a/src/sage/structure/sage_object.pyx b/src/sage/structure/sage_object.pyx
> index ca1227b..6a00995 100644
> --- a/src/sage/structure/sage_object.pyx
> +++ b/src/sage/structure/sage_object.pyx
> @@ -235,8 +235,8 @@ cdef class SageObject:
>              return str(type(self))
>          else:
>              result = repr_func()
> -            if isinstance(result, unicode):
> -                # Py3 compatibility: allow _repr_ to return unicode
> +            if sys.version_info[0] < 3 and isinstance(result, unicode):
> +                # for Py3 compatibility: allow _repr_ to return unicode
>                  return result.encode('utf-8')
>              else:
>                  return result
> ```



---

archive/issue_comments_425682.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nStrange, because it seems to work.  Anyway, I have no idea how to fix it differently, can you help?\n\nReplying to [@fchapoton](#comment%3A7):\n> This is available only inside .pyx files, not for .py files\n> \n> Replying to [@mantepse](#comment%3A6):\n> > Replying to [@fchapoton](#comment%3A3):\n> > > This is wrong:\n> > > \n> > > ```\n> > > +        if sys.version_info[0] < 3 and isinstance(result, unicode):\n> > > ```\n> > > The \"unicode\" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.\n\n> > \n> > I took this from #23475:\n> > \n> > ```\n> > diff --git a/src/sage/structure/sage_object.pyx b/src/sage/structure/sage_object.pyx\n> > index ca1227b..6a00995 100644\n> > --- a/src/sage/structure/sage_object.pyx\n> > +++ b/src/sage/structure/sage_object.pyx\n> > @@ -235,8 +235,8 @@ cdef class SageObject:\n> >              return str(type(self))\n> >          else:\n> >              result = repr_func()\n> > -            if isinstance(result, unicode):\n> > -                # Py3 compatibility: allow _repr_ to return unicode\n> > +            if sys.version_info[0] < 3 and isinstance(result, unicode):\n> > +                # for Py3 compatibility: allow _repr_ to return unicode\n> >                  return result.encode('utf-8')\n> >              else:\n> >                  return result\n> > ```",
    "created_at": "2019-02-25T12:36:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425682",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'>Comment 8:</a>
Strange, because it seems to work.  Anyway, I have no idea how to fix it differently, can you help?

Replying to [@fchapoton](#comment%3A7):
> This is available only inside .pyx files, not for .py files
> 
> Replying to [@mantepse](#comment%3A6):
> > Replying to [@fchapoton](#comment%3A3):
> > > This is wrong:
> > > 
> > > ```
> > > +        if sys.version_info[0] < 3 and isinstance(result, unicode):
> > > ```
> > > The "unicode" keyword cannot be used in code that is compatible with both py2 and py3. And one should refrain from using sys.version_info everywhere.

> > 
> > I took this from #23475:
> > 
> > ```
> > diff --git a/src/sage/structure/sage_object.pyx b/src/sage/structure/sage_object.pyx
> > index ca1227b..6a00995 100644
> > --- a/src/sage/structure/sage_object.pyx
> > +++ b/src/sage/structure/sage_object.pyx
> > @@ -235,8 +235,8 @@ cdef class SageObject:
> >              return str(type(self))
> >          else:
> >              result = repr_func()
> > -            if isinstance(result, unicode):
> > -                # Py3 compatibility: allow _repr_ to return unicode
> > +            if sys.version_info[0] < 3 and isinstance(result, unicode):
> > +                # for Py3 compatibility: allow _repr_ to return unicode
> >                  return result.encode('utf-8')
> >              else:
> >                  return result
> > ```



---

archive/issue_comments_425683.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\n\n```diff\n\ndiff --git a/src/sage/databases/findstat.py b/src/sage/databases/findstat.py\nindex 5bd5fff..e6af9e0 100644\n--- a/src/sage/databases/findstat.py\n+++ b/src/sage/databases/findstat.py\n@@ -411,12 +411,9 @@ class FindStat(SageObject):\n         sage: p = findstat({pi: pi.length() for pi in l}, depth=0); p           # optional -- internet, random\n         0: (St000018: The number of inversions of a permutation., [], 873)\n \n-    Note however, that the results of these two queries are not\n-    necessarily the same, because we compare queries by the data\n-    sent, and the ordering of the data might be different::\n-\n-        sage: p == q                                                            # optional -- internet\n-        False\n+    Note however, that the results of these two queries need not\n+    compare equal, because we compare queries by the data\n+    sent, and the ordering of the data might be different.\n```\n\nNot that I understand what this example is demonstrating or whether it's important, but I also don't understand why it was removed in service to Python 3 fixes?  Why shouldn't this example work on Python 3?  Or is it an example that is not expected to work at all (or maybe if the example is random it might be better if it were kept but marked `# random`, emphasizing that the result may or may not be false).",
    "created_at": "2019-02-25T12:45:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425683",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'>Comment 9:</a>

```diff

diff --git a/src/sage/databases/findstat.py b/src/sage/databases/findstat.py
index 5bd5fff..e6af9e0 100644
--- a/src/sage/databases/findstat.py
+++ b/src/sage/databases/findstat.py
@@ -411,12 +411,9 @@ class FindStat(SageObject):
         sage: p = findstat({pi: pi.length() for pi in l}, depth=0); p           # optional -- internet, random
         0: (St000018: The number of inversions of a permutation., [], 873)
 
-    Note however, that the results of these two queries are not
-    necessarily the same, because we compare queries by the data
-    sent, and the ordering of the data might be different::
-
-        sage: p == q                                                            # optional -- internet
-        False
+    Note however, that the results of these two queries need not
+    compare equal, because we compare queries by the data
+    sent, and the ordering of the data might be different.
```

Not that I understand what this example is demonstrating or whether it's important, but I also don't understand why it was removed in service to Python 3 fixes?  Why shouldn't this example work on Python 3?  Or is it an example that is not expected to work at all (or maybe if the example is random it might be better if it were kept but marked `# random`, emphasizing that the result may or may not be false).



---

archive/issue_comments_425684.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI removed it, because with python3 it surprisingly gave `True`, but more importantly, because I think it is not very interesting.  When I implemented all this, I was not sure how to structure the various results returned by findstat.  I now know a little better, and I have plans for a much better interface, but not really the time right now.\n\nIf you insist, I can mark the doctest as random.\n\nReplying to [@embray](#comment%3A9):\n> \n> ```diff\n> \n> diff --git a/src/sage/databases/findstat.py b/src/sage/databases/findstat.py\n> index 5bd5fff..e6af9e0 100644\n> --- a/src/sage/databases/findstat.py\n> +++ b/src/sage/databases/findstat.py\n> @@ -411,12 +411,9 @@ class FindStat(SageObject):\n>          sage: p = findstat({pi: pi.length() for pi in l}, depth=0); p           # optional -- internet, random\n>          0: (St000018: The number of inversions of a permutation., [], 873)\n>  \n> -    Note however, that the results of these two queries are not\n> -    necessarily the same, because we compare queries by the data\n> -    sent, and the ordering of the data might be different::\n> -\n> -        sage: p == q                                                            # optional -- internet\n> -        False\n> +    Note however, that the results of these two queries need not\n> +    compare equal, because we compare queries by the data\n> +    sent, and the ordering of the data might be different.\n> ```\n> \n> Not that I understand what this example is demonstrating or whether it's important, but I also don't understand why it was removed in service to Python 3 fixes?  Why shouldn't this example work on Python 3?  Or is it an example that is not expected to work at all (or maybe if the example is random it might be better if it were kept but marked `# random`, emphasizing that the result may or may not be false).",
    "created_at": "2019-02-25T14:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425684",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'>Comment 10:</a>
I removed it, because with python3 it surprisingly gave `True`, but more importantly, because I think it is not very interesting.  When I implemented all this, I was not sure how to structure the various results returned by findstat.  I now know a little better, and I have plans for a much better interface, but not really the time right now.

If you insist, I can mark the doctest as random.

Replying to [@embray](#comment%3A9):
> 
> ```diff
> 
> diff --git a/src/sage/databases/findstat.py b/src/sage/databases/findstat.py
> index 5bd5fff..e6af9e0 100644
> --- a/src/sage/databases/findstat.py
> +++ b/src/sage/databases/findstat.py
> @@ -411,12 +411,9 @@ class FindStat(SageObject):
>          sage: p = findstat({pi: pi.length() for pi in l}, depth=0); p           # optional -- internet, random
>          0: (St000018: The number of inversions of a permutation., [], 873)
>  
> -    Note however, that the results of these two queries are not
> -    necessarily the same, because we compare queries by the data
> -    sent, and the ordering of the data might be different::
> -
> -        sage: p == q                                                            # optional -- internet
> -        False
> +    Note however, that the results of these two queries need not
> +    compare equal, because we compare queries by the data
> +    sent, and the ordering of the data might be different.
> ```
> 
> Not that I understand what this example is demonstrating or whether it's important, but I also don't understand why it was removed in service to Python 3 fixes?  Why shouldn't this example work on Python 3?  Or is it an example that is not expected to work at all (or maybe if the example is random it might be better if it were kept but marked `# random`, emphasizing that the result may or may not be false).



---

archive/issue_comments_425685.json:
```json
{
    "body": "Changed commit from **[66931ff](https://github.com/sagemath/sagetrac-mirror/commit/66931ff6189650c6b7c8a145978340dd24d627d2)** to **[66b263c](https://github.com/sagemath/sagetrac-mirror/commit/66b263c709c0ae468916680b744fe18e843416a7)**",
    "created_at": "2019-03-07T08:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425685",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[66931ff](https://github.com/sagemath/sagetrac-mirror/commit/66931ff6189650c6b7c8a145978340dd24d627d2)** to **[66b263c](https://github.com/sagemath/sagetrac-mirror/commit/66b263c709c0ae468916680b744fe18e843416a7)**



---

archive/issue_comments_425686.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66b263c709c0ae468916680b744fe18e843416a7\">66b263c</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into t/27346/py3__fix_findstat_interface_and_fancytuple</code></td></tr></table>\n",
    "created_at": "2019-03-07T08:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425686",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66b263c709c0ae468916680b744fe18e843416a7">66b263c</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into t/27346/py3__fix_findstat_interface_and_fancytuple</code></td></tr></table>




---

archive/issue_comments_425687.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\ninside `src/sage/databases/oeis.py`, use `bytes_to_str`\n\navailable from\n\n```\nfrom sage.cpython.string import bytes_to_str\n```",
    "created_at": "2019-03-10T12:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425687",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'>Comment 12:</a>
inside `src/sage/databases/oeis.py`, use `bytes_to_str`

available from

```
from sage.cpython.string import bytes_to_str
```



---

archive/issue_comments_425688.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9\">488e74e</a></td><td><code>remove seemingly unnecessary python3 treatment</code></td></tr></table>\n",
    "created_at": "2019-03-10T14:46:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425688",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9">488e74e</a></td><td><code>remove seemingly unnecessary python3 treatment</code></td></tr></table>




---

archive/issue_comments_425689.json:
```json
{
    "body": "Changed commit from **[66b263c](https://github.com/sagemath/sagetrac-mirror/commit/66b263c709c0ae468916680b744fe18e843416a7)** to **[488e74e](https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9)**",
    "created_at": "2019-03-10T14:46:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425689",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[66b263c](https://github.com/sagemath/sagetrac-mirror/commit/66b263c709c0ae468916680b744fe18e843416a7)** to **[488e74e](https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9)**



---

archive/issue_comments_425690.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI don't get it, now it works without any special treatment.",
    "created_at": "2019-03-10T14:49:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425690",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:14'>Comment 14:</a>
I don't get it, now it works without any special treatment.



---

archive/issue_comments_425691.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nworks for me on python3",
    "created_at": "2019-03-10T17:22:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425691",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'>Comment 15:</a>
works for me on python3



---

archive/issue_comments_425692.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-03-11T12:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425692",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_425693.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nok, let it be.",
    "created_at": "2019-03-11T12:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425693",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'>Comment 16:</a>
ok, let it be.



---

archive/issue_events_357501.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-11T12:32:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357501"
}
```



---

archive/issue_events_357502.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-11T12:32:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357502"
}
```



---

archive/issue_comments_425694.json:
```json
{
    "body": "Changed branch from **[u/mantepse/py3__fix_findstat_interface_and_fancytuple](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/py3__fix_findstat_interface_and_fancytuple)** to **[488e74e](https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9)**",
    "created_at": "2019-03-13T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27346#issuecomment-425694",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mantepse/py3__fix_findstat_interface_and_fancytuple](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/py3__fix_findstat_interface_and_fancytuple)** to **[488e74e](https://github.com/sagemath/sagetrac-mirror/commit/488e74e8ddfa36757ca0479ea540778e8338f8b9)**



---

archive/issue_events_357503.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-13T18:29:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357503"
}
```



---

archive/issue_events_357504.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bc7c117e21f9421698a875195918cc8f8e0fc80b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-13T18:29:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27346",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27346#event-357504"
}
```
