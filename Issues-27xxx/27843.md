# Issue 27843: Tab_completion in Mathematica interface causes Sage to crash

archive/issues_027606.json:
```json
{
    "assignees": [],
    "body": "Calling the tab completion of the Mathematica interface like `mathematica.[TAB]` causes Sage to crash.\n\nThe error is a `UnicodeDecodeError` in the IPython interpreter. Some of the Mathematica keywords involve Unicode characters which do not seem to be correctly encoded. For example:\n\n```\nsage: s = mathematica._tab_completion()[-1]; s\n'\\xef\\x8e\\xaf'\nsage: type(s)\n<type 'str'>\n```\n\nThis was tested using Sage 8.7, Python 2 and Mathematica 11.3 on Linux. The crash report is attached.\n\n\nKeywords: **Mathematica, IPython, Unicode**\n\nReviewer: **Markus Wageringel**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27843_\n\n",
    "closed_at": "2020-05-21T18:19:03Z",
    "created_at": "2019-05-16T20:47:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Tab_completion in Mathematica interface causes Sage to crash",
    "type": "issue",
    "updated_at": "2020-05-21T18:19:03Z",
    "url": "https://github.com/sagemath/sage/issues/27843",
    "user": "https://github.com/mwageringel"
}
```
Calling the tab completion of the Mathematica interface like `mathematica.[TAB]` causes Sage to crash.

The error is a `UnicodeDecodeError` in the IPython interpreter. Some of the Mathematica keywords involve Unicode characters which do not seem to be correctly encoded. For example:

```
sage: s = mathematica._tab_completion()[-1]; s
'\xef\x8e\xaf'
sage: type(s)
<type 'str'>
```

This was tested using Sage 8.7, Python 2 and Mathematica 11.3 on Linux. The crash report is attached.


Keywords: **Mathematica, IPython, Unicode**

Reviewer: **Markus Wageringel**

_Issue created by migration from https://trac.sagemath.org/ticket/27843_





---

archive/issue_events_350837.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-05-16T20:47:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350837"
}
```



---

archive/issue_events_350838.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-05-16T20:47:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350838"
}
```



---

archive/issue_events_350839.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-05-16T20:47:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350839"
}
```



---

archive/issue_comments_435104.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nAttachment: **[Sage_crash_report.txt](https://github.com/sagemath/sage/files/ticket27843/Sage_crash_report.txt)**\n\nApparently this is part of a larger problem \u2013 support for unicode in this and other interfaces. See also #24268. In Python 3, the problem above does not seem to exist. I am not sure how to make this work in Python 2.",
    "created_at": "2019-05-20T21:53:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27843#issuecomment-435104",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:1'>Comment 1:</a>
Attachment: **[Sage_crash_report.txt](https://github.com/sagemath/sage/files/ticket27843/Sage_crash_report.txt)**

Apparently this is part of a larger problem â€“ support for unicode in this and other interfaces. See also #24268. In Python 3, the problem above does not seem to exist. I am not sure how to make this work in Python 2.



---

archive/issue_comments_435105.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27843#issuecomment-435105",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'>Comment 2:</a>
As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_events_350840.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:55:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350840"
}
```



---

archive/issue_events_350841.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-05-21T17:22:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350841"
}
```



---

archive/issue_comments_435106.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nThis problem does not exist anymore with Python 3, so this ticket can be closed.",
    "created_at": "2020-05-21T17:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27843#issuecomment-435106",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:3'>Comment 3:</a>
This problem does not exist anymore with Python 3, so this ticket can be closed.



---

archive/issue_events_350842.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-05-21T17:22:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350842"
}
```



---

archive/issue_events_350843.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-05-21T17:22:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350843"
}
```



---

archive/issue_comments_435107.json:
```json
{
    "body": "Reviewer: **Markus Wageringel**",
    "created_at": "2020-05-21T17:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27843#issuecomment-435107",
    "user": "https://github.com/mwageringel"
}
```

Reviewer: **Markus Wageringel**



---

archive/issue_events_350844.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-05-21T18:19:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350844"
}
```



---

archive/issue_events_350845.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-05-21T18:19:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27843",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27843#event-350845"
}
```
