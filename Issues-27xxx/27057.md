# Issue 27057: speedup crystal weight and spin e/f

archive/issues_026820.json:
```json
{
    "assignees": [],
    "body": "\n\nCC:  @tscrim @anneschilling\n\nComponent: **combinatorics**\n\nAuthor: **Travis Scrimshaw**\n\nBranch/Commit: **[`d2fe93d`](https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf)**\n\nReviewer: **Travis Scrimshaw, Martin Rubey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27057_\n\n",
    "closed_at": "2019-01-26T15:55:41Z",
    "created_at": "2019-01-14T23:33:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "speedup crystal weight and spin e/f",
    "type": "issue",
    "updated_at": "2019-01-26T15:55:41Z",
    "url": "https://github.com/sagemath/sage/issues/27057",
    "user": "https://github.com/mantepse"
}
```


CC:  @tscrim @anneschilling

Component: **combinatorics**

Author: **Travis Scrimshaw**

Branch/Commit: **[`d2fe93d`](https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf)**

Reviewer: **Travis Scrimshaw, Martin Rubey**

_Issue created by migration from https://trac.sagemath.org/ticket/27057_





---

archive/issue_events_368909.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-14T23:33:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368909"
}
```



---

archive/issue_events_368910.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-14T23:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368910"
}
```



---

archive/issue_comments_417245.json:
```json
{
    "body": "Branch: **[u/mantepse/speedup_crystal_weight_and_spin_e_f](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/speedup_crystal_weight_and_spin_e_f)**",
    "created_at": "2019-01-14T23:35:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417245",
    "user": "https://github.com/mantepse"
}
```

Branch: **[u/mantepse/speedup_crystal_weight_and_spin_e_f](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/speedup_crystal_weight_and_spin_e_f)**



---

archive/issue_events_368911.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-14T23:45:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368911"
}
```



---

archive/issue_comments_417246.json:
```json
{
    "body": "Commit: **[`6f26a6e`](https://github.com/sagemath/sagetrac-mirror/commit/6f26a6e4bd140284b868bff00d69f0f60fa6a44e)**",
    "created_at": "2019-01-14T23:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417246",
    "user": "https://github.com/mantepse"
}
```

Commit: **[`6f26a6e`](https://github.com/sagemath/sagetrac-mirror/commit/6f26a6e4bd140284b868bff00d69f0f60fa6a44e)**



---

archive/issue_events_368912.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-14T23:45:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368912"
}
```



---

archive/issue_comments_417247.json:
```json
{
    "body": "Author: **Martin Rubey**",
    "created_at": "2019-01-14T23:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417247",
    "user": "https://github.com/mantepse"
}
```

Author: **Martin Rubey**



---

archive/issue_events_368913.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-14T23:45:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368913"
}
```



---

archive/issue_comments_417248.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI need faster crystals, but I am not sure how to go about it.  Here is a first try - old:\n\n```\nsage: n = 3; r = 7; C = crystals.Spins(CartanType([\"B\", n])); T = crystals.TensorProduct(*[C for i in range(r)])\nsage: hi = T.highest_weight_vectors()\nsage: %timeit [v.weight() for v in T.highest_weight_vectors()]\n1 loop, best of 3: 6.52 s per loop\n```\nnew:\n\n```\nsage: n = 3; r = 7; C = crystals.Spins(CartanType([\"B\", n])); T = crystals.TensorProduct(*[C for i in range(r)])\nsage: hi = T.highest_weight_vectors()\nsage: %timeit [v.weight() for v in T.highest_weight_vectors()]\n1 loop, best of 3: 4.22 s per loop\n```\n\nRemoving the assertions `assert i in self.index_set()` in `spins.py` would also save some time, I don't know how useful they are.  Perhaps they can be replaced with `assert 0 < i <= rank`?\n\nSomewhat surprisingly, a large amount of time is used in recomputing `root_system` of a Cartan type, in `weight_lattice_realization`.  I think it makes sense to cache it, but maybe I am overlooking something better.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f26a6e4bd140284b868bff00d69f0f60fa6a44e\"><code>6f26a6e</code></a></td><td><code>avoid calling cartan_type in spin e / f, cache root_system, avoid calls in weight_lattice_realization</code></td></tr></table>\n",
    "created_at": "2019-01-14T23:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417248",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:2" align="right">comment:2</div>

I need faster crystals, but I am not sure how to go about it.  Here is a first try - old:

```
sage: n = 3; r = 7; C = crystals.Spins(CartanType(["B", n])); T = crystals.TensorProduct(*[C for i in range(r)])
sage: hi = T.highest_weight_vectors()
sage: %timeit [v.weight() for v in T.highest_weight_vectors()]
1 loop, best of 3: 6.52 s per loop
```
new:

```
sage: n = 3; r = 7; C = crystals.Spins(CartanType(["B", n])); T = crystals.TensorProduct(*[C for i in range(r)])
sage: hi = T.highest_weight_vectors()
sage: %timeit [v.weight() for v in T.highest_weight_vectors()]
1 loop, best of 3: 4.22 s per loop
```

Removing the assertions `assert i in self.index_set()` in `spins.py` would also save some time, I don't know how useful they are.  Perhaps they can be replaced with `assert 0 < i <= rank`?

Somewhat surprisingly, a large amount of time is used in recomputing `root_system` of a Cartan type, in `weight_lattice_realization`.  I think it makes sense to cache it, but maybe I am overlooking something better.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f26a6e4bd140284b868bff00d69f0f60fa6a44e"><code>6f26a6e</code></a></td><td><code>avoid calling cartan_type in spin e / f, cache root_system, avoid calls in weight_lattice_realization</code></td></tr></table>




---

archive/issue_comments_417249.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI am worried that caching `root_system` would lead to a memory leak since `RootSystem` is a `UniqueRepresentation` (there already is a memory leak for root systems IIRC, but this will likely make the problem worse).\n\nWe do not want to do `assert` for validating user input (they should only be used for serious problems); instead raise a, e.g., `ValueError`. (This is a holdover from older code.) However, generically, the `index_set()` does not have to be `[n]`. Granted, many of the crystals are using this as an assumption (e.g., `CrystalOfLetters`) for various reasons. I probably would not remove the check within Sage itself because it is already there. If this does become a serious bottleneck in the computations you need, I would simply remove them from the code for your computation.\n\nTo really get a good speedup, I would cythonize the spin crystals (use some sort of bitset or bint array) and implement a custom `weight` function. You probably also want to have a better check for `epsilon` and `phi` too.",
    "created_at": "2019-01-15T00:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417249",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

I am worried that caching `root_system` would lead to a memory leak since `RootSystem` is a `UniqueRepresentation` (there already is a memory leak for root systems IIRC, but this will likely make the problem worse).

We do not want to do `assert` for validating user input (they should only be used for serious problems); instead raise a, e.g., `ValueError`. (This is a holdover from older code.) However, generically, the `index_set()` does not have to be `[n]`. Granted, many of the crystals are using this as an assumption (e.g., `CrystalOfLetters`) for various reasons. I probably would not remove the check within Sage itself because it is already there. If this does become a serious bottleneck in the computations you need, I would simply remove them from the code for your computation.

To really get a good speedup, I would cythonize the spin crystals (use some sort of bitset or bint array) and implement a custom `weight` function. You probably also want to have a better check for `epsilon` and `phi` too.



---

archive/issue_comments_417250.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThank you for looking into this!  One question: I realize that the index set does not need to be `[n]` generically, but it does it have to be `[n]` within `spins.py`?  (I think otherwise `ret[i] = 1` shouldn't work, right?)\n\nSince `weight` is currently the worst offender, I'll try implementing a custom weight function first.\n\nI'll keep pushing to this ticket, but leave it as `needs info` - in case anything is good to keep.",
    "created_at": "2019-01-15T05:48:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417250",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:4" align="right">comment:4</div>

Thank you for looking into this!  One question: I realize that the index set does not need to be `[n]` generically, but it does it have to be `[n]` within `spins.py`?  (I think otherwise `ret[i] = 1` shouldn't work, right?)

Since `weight` is currently the worst offender, I'll try implementing a custom weight function first.

I'll keep pushing to this ticket, but leave it as `needs info` - in case anything is good to keep.



---

archive/issue_comments_417251.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYea, it seems to be that way for `spins.py` (but also for `letters.pyx`, and subsequently all tableaux).",
    "created_at": "2019-01-15T05:52:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417251",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

Yea, it seems to be that way for `spins.py` (but also for `letters.pyx`, and subsequently all tableaux).



---

archive/issue_comments_417252.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n#18426 is the ticket concerning a memory leak involving root systems.",
    "created_at": "2019-01-15T06:28:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417252",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:6" align="right">comment:6</div>

#18426 is the ticket concerning a memory leak involving root systems.



---

archive/issue_comments_417253.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@mantepse](#comment%3A6):\n> #25560 is the ticket concerining a memory leak involving root systems.\n\n#18426",
    "created_at": "2019-01-15T06:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417253",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@mantepse](#comment%3A6):
> #25560 is the ticket concerining a memory leak involving root systems.

#18426



---

archive/issue_comments_417254.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBesides, is there a good reason to cache `highest_weight_vectors`?\n\nI am frequently iterating over the highest weight vectors of tensor powers.  In fact, I would prefer it to be an iterator, but that's probably asking for too much.",
    "created_at": "2019-01-15T10:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417254",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:8" align="right">comment:8</div>

Besides, is there a good reason to cache `highest_weight_vectors`?

I am frequently iterating over the highest weight vectors of tensor powers.  In fact, I would prefer it to be an iterator, but that's probably asking for too much.



---

archive/issue_comments_417255.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe338aef61cf7cdff9805ffca6ca73068d5655c3\"><code>fe338ae</code></a></td><td><code>add dedicated weight method for spin crystals</code></td></tr></table>\n",
    "created_at": "2019-01-15T11:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417255",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe338aef61cf7cdff9805ffca6ca73068d5655c3"><code>fe338ae</code></a></td><td><code>add dedicated weight method for spin crystals</code></td></tr></table>




---

archive/issue_comments_417256.json:
```json
{
    "body": "Changed commit from **[`6f26a6e`](https://github.com/sagemath/sagetrac-mirror/commit/6f26a6e4bd140284b868bff00d69f0f60fa6a44e)** to **[`fe338ae`](https://github.com/sagemath/sagetrac-mirror/commit/fe338aef61cf7cdff9805ffca6ca73068d5655c3)**",
    "created_at": "2019-01-15T11:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417256",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6f26a6e`](https://github.com/sagemath/sagetrac-mirror/commit/6f26a6e4bd140284b868bff00d69f0f60fa6a44e)** to **[`fe338ae`](https://github.com/sagemath/sagetrac-mirror/commit/fe338aef61cf7cdff9805ffca6ca73068d5655c3)**



---

archive/issue_comments_417257.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nCaching `Crystals.ParentMethods.weight_lattice_realization` yields an even greater speedup.  But maybe it would be even better if crystal elements would know (and cache) their `weight_lattice_realization`, because then we wouldn't constantly need to redirect via the parent.  Note for example that there is `Crystals.ElementMethods.cartan_type`.  Is there a good reason not to do this?",
    "created_at": "2019-01-15T11:39:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417257",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:10" align="right">comment:10</div>

Caching `Crystals.ParentMethods.weight_lattice_realization` yields an even greater speedup.  But maybe it would be even better if crystal elements would know (and cache) their `weight_lattice_realization`, because then we wouldn't constantly need to redirect via the parent.  Note for example that there is `Crystals.ElementMethods.cartan_type`.  Is there a good reason not to do this?



---

archive/issue_comments_417258.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417258",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_368914.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368914"
}
```



---

archive/issue_events_368915.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368915"
}
```



---

archive/issue_comments_417259.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSo I am not fully convinced of the elements having a `cartan_type`, but that is, in a way, data associated to the element. However, the weight lattice realization is definitely not. So I am -1 on caching it in the elements.\n\nHow much of a speedup do you get with caching it? I am probably in favor of caching it, but I would be interested in seeing how performance critical it is first (at least, I do not think computing the weight is the slow part).\n\nWe cache the `highest_weight_vectors` because it is an (relatively) expensive computation that can be used in some other computations. If you make it into an iterator, you loose that part or have to add a second method. Again, if you find it better for your computations, you can just make local changes.\n\nAlso, I think if you really need speed, you should cythonize this. I might be able to do that soon, but it is a little lower on the priority list for me right now.",
    "created_at": "2019-01-19T17:38:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417259",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

So I am not fully convinced of the elements having a `cartan_type`, but that is, in a way, data associated to the element. However, the weight lattice realization is definitely not. So I am -1 on caching it in the elements.

How much of a speedup do you get with caching it? I am probably in favor of caching it, but I would be interested in seeing how performance critical it is first (at least, I do not think computing the weight is the slow part).

We cache the `highest_weight_vectors` because it is an (relatively) expensive computation that can be used in some other computations. If you make it into an iterator, you loose that part or have to add a second method. Again, if you find it better for your computations, you can just make local changes.

Also, I think if you really need speed, you should cythonize this. I might be able to do that soon, but it is a little lower on the priority list for me right now.



---

archive/issue_comments_417260.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThanks for looking into this!\n\nI can only answer to your comment on the `highest_weight_vectors` caching: my (very minor) problem is that after computing\n\n```\nsage: C = crystals.Letters(\"A5\")\nsage: T = crystals.TensorProduct(*([C]*14))\nsage: hi = T.highest_weight_vectors()\n# do some stuff\nsage: C = crystals.Letters(\"C5\")\nsage: T = crystals.TensorProduct(*([C]*14))\nsage: hi = T.highest_weight_vectors()\n# do some stuff\nsage: C = crystals.Spins(\"B5\")\nsage: T = crystals.TensorProduct(*([C]*14))\nsage: hi = T.highest_weight_vectors()\n```\nI do not know how to free the memory - and until very recently, I did not understand why my computer became unusable...",
    "created_at": "2019-01-19T18:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417260",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:13" align="right">comment:13</div>

Thanks for looking into this!

I can only answer to your comment on the `highest_weight_vectors` caching: my (very minor) problem is that after computing

```
sage: C = crystals.Letters("A5")
sage: T = crystals.TensorProduct(*([C]*14))
sage: hi = T.highest_weight_vectors()
# do some stuff
sage: C = crystals.Letters("C5")
sage: T = crystals.TensorProduct(*([C]*14))
sage: hi = T.highest_weight_vectors()
# do some stuff
sage: C = crystals.Spins("B5")
sage: T = crystals.TensorProduct(*([C]*14))
sage: hi = T.highest_weight_vectors()
```
I do not know how to free the memory - and until very recently, I did not understand why my computer became unusable...



---

archive/issue_comments_417261.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThat is a misrepresenation. It is not the `@cached_method` that is the problem. If the memory is not being freed, then there is a memory leak. If so, then my guess is it is a side effect of #18426.",
    "created_at": "2019-01-19T18:09:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417261",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

That is a misrepresenation. It is not the `@cached_method` that is the problem. If the memory is not being freed, then there is a memory leak. If so, then my guess is it is a side effect of #18426.



---

archive/issue_comments_417262.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAre you saying that the highest weight vectors shouldn't take up so much space?\nI just tried\n\n```\nsage: C = crystals.Letters(\"A5\")\nsage: for d in range(2, 14):\n....:     T = crystals.TensorProduct(*([C]*d))\n....:     hi = T.highest_weight_vectors()\n....:     print len(hi)\n```\nafter which, according to htop, a big portion of the available memory on my laptop was used.\n\nIt is not a big problem for me, because I can do such experiments with \"large\" tensor powers (eg., yesterday I had to check something for `crystals.Spins(5)` with `d=16`) in a separate sage process, and not on my laptop.",
    "created_at": "2019-01-19T18:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417262",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:15" align="right">comment:15</div>

Are you saying that the highest weight vectors shouldn't take up so much space?
I just tried

```
sage: C = crystals.Letters("A5")
sage: for d in range(2, 14):
....:     T = crystals.TensorProduct(*([C]*d))
....:     hi = T.highest_weight_vectors()
....:     print len(hi)
```
after which, according to htop, a big portion of the available memory on my laptop was used.

It is not a big problem for me, because I can do such experiments with "large" tensor powers (eg., yesterday I had to check something for `crystals.Spins(5)` with `d=16`) in a separate sage process, and not on my laptop.



---

archive/issue_comments_417263.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nNo. I am asking you what you observed. Are you seeing a memory leak or is it just high usage in that specific computation?\n\nIt is almost certainly not the caching of the highest weight vectors that is causing the high memory usage. The highest weight vectors requires a certain amount of iteration over the crystal, which is not O(1) in memory (I am not sure of an algorithm that could be). So you might get some memory improvement for your particular computation by storing the list of elements in the crystal (currently I believe it regenerates them for each factor, a by-product of being an iterator).",
    "created_at": "2019-01-19T19:37:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417263",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:16" align="right">comment:16</div>

No. I am asking you what you observed. Are you seeing a memory leak or is it just high usage in that specific computation?

It is almost certainly not the caching of the highest weight vectors that is causing the high memory usage. The highest weight vectors requires a certain amount of iteration over the crystal, which is not O(1) in memory (I am not sure of an algorithm that could be). So you might get some memory improvement for your particular computation by storing the list of elements in the crystal (currently I believe it regenerates them for each factor, a by-product of being an iterator).



---

archive/issue_comments_417264.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI don't really understand the question.  I am observing that after the sequence of instructions above the memory of my computer is used up, and it doesn't go down anymore.  \n\nIn numbers:\n\n```\nsage: C = crystals.Letters(\"A5\")\nsage: for d in range(2, 13):\n....:     T = crystals.TensorProduct(*([C]*d))\n....:     hi = T.highest_weight_vectors()\n....:     print get_memory_usage(), len(hi)\n\n4192.42578125 2\n4192.42578125 4\n4192.67578125 10\n4192.67578125 26\n4192.67578125 76\n4192.92578125 231\n4193.17578125 756\n4195.19140625 2556\n4201.953125 9096\n4226.99609375 33231\n4320.625 126060\nsage: \n```",
    "created_at": "2019-01-19T20:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417264",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:17" align="right">comment:17</div>

I don't really understand the question.  I am observing that after the sequence of instructions above the memory of my computer is used up, and it doesn't go down anymore.  

In numbers:

```
sage: C = crystals.Letters("A5")
sage: for d in range(2, 13):
....:     T = crystals.TensorProduct(*([C]*d))
....:     hi = T.highest_weight_vectors()
....:     print get_memory_usage(), len(hi)

4192.42578125 2
4192.42578125 4
4192.67578125 10
4192.67578125 26
4192.67578125 76
4192.92578125 231
4193.17578125 756
4195.19140625 2556
4201.953125 9096
4226.99609375 33231
4320.625 126060
sage: 
```



---

archive/issue_comments_417265.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nBy doing a cythonization, I get the following:\n\n```\nsage: C = crystals.SpinsMinus(['D',4])\nsage: D = crystals.SpinsPlus(['D',4])\nsage: T = tensor([C,D,C,D,C,D])\nsage: T.cardinality()\n262144\nsage: %time for x in T: pass\nCPU times: user 2.31 s, sys: 5.79 ms, total: 2.31 s\nWall time: 2.29 s\nsage: %time hw = T.highest_weight_vectors()\nCPU times: user 16.6 ms, sys: 135 \u00b5s, total: 16.8 ms\nWall time: 14.5 ms\nsage: %time for x in T: _ = x.weight()\nCPU times: user 32.9 s, sys: 34 ms, total: 33 s\nWall time: 32.9 s\nsage: %time for x in T: _ = x.weight()    # with caching weight_lattice_realization()\nCPU times: user 19.3 s, sys: 23.1 ms, total: 19.3 s\nWall time: 19.3 s\n```\nvs Sage 8.6:\n\n```\nsage: C = crystals.SpinsMinus(['D',4])\nsage: D = crystals.SpinsPlus(['D',4])\nsage: T = tensor([C,D,C,D,C,D])\nsage: T.cardinality()\n262144\nsage: %time for x in T: pass\nCPU times: user 5.21 s, sys: 30.5 ms, total: 5.24 s\nWall time: 5.19 s\nsage: %time hw = T.highest_weight_vectors()\nCPU times: user 93.4 ms, sys: 8.53 ms, total: 102 ms\nWall time: 82.5 ms\nsage: %time for x in T: _ = x.weight()\n> 1 minute\n```\n\nHowever, there is a definite memory leak with the tensor product:\n\n```\nsage: C = crystals.Letters('A5')\nsage: T = tensor([C]*12)\nsage: T._dummy = True\nsage: del T\nsage: import gc\nsage: gc.collect()\nsage: T = tensor([C]*12)\nsage: T._dummy\nTrue\n```\nI get the same when just doing for `C`. So that is one step closer to the memory leak, but that is a separate issue.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/abbbbeee2171c78e842168dc4b678eb873ee47dc\"><code>abbbbee</code></a></td><td><code>Cythonization of spin crystals.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31c666c89d791cfc4f51e87f6e71334275d1b817\"><code>31c666c</code></a></td><td><code>Caching weight_lattice_realization.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/844ae90644b5c669955d5e0587d1d9e0cd3a1082\"><code>844ae90</code></a></td><td><code>Forgot to add letters.pxd.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5d24018cb89b774f8a163005f602d27797068a7\"><code>a5d2401</code></a></td><td><code>Full coverage and other cleanup.</code></td></tr></table>\n",
    "created_at": "2019-01-20T01:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417265",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

By doing a cythonization, I get the following:

```
sage: C = crystals.SpinsMinus(['D',4])
sage: D = crystals.SpinsPlus(['D',4])
sage: T = tensor([C,D,C,D,C,D])
sage: T.cardinality()
262144
sage: %time for x in T: pass
CPU times: user 2.31 s, sys: 5.79 ms, total: 2.31 s
Wall time: 2.29 s
sage: %time hw = T.highest_weight_vectors()
CPU times: user 16.6 ms, sys: 135 Âµs, total: 16.8 ms
Wall time: 14.5 ms
sage: %time for x in T: _ = x.weight()
CPU times: user 32.9 s, sys: 34 ms, total: 33 s
Wall time: 32.9 s
sage: %time for x in T: _ = x.weight()    # with caching weight_lattice_realization()
CPU times: user 19.3 s, sys: 23.1 ms, total: 19.3 s
Wall time: 19.3 s
```
vs Sage 8.6:

```
sage: C = crystals.SpinsMinus(['D',4])
sage: D = crystals.SpinsPlus(['D',4])
sage: T = tensor([C,D,C,D,C,D])
sage: T.cardinality()
262144
sage: %time for x in T: pass
CPU times: user 5.21 s, sys: 30.5 ms, total: 5.24 s
Wall time: 5.19 s
sage: %time hw = T.highest_weight_vectors()
CPU times: user 93.4 ms, sys: 8.53 ms, total: 102 ms
Wall time: 82.5 ms
sage: %time for x in T: _ = x.weight()
> 1 minute
```

However, there is a definite memory leak with the tensor product:

```
sage: C = crystals.Letters('A5')
sage: T = tensor([C]*12)
sage: T._dummy = True
sage: del T
sage: import gc
sage: gc.collect()
sage: T = tensor([C]*12)
sage: T._dummy
True
```
I get the same when just doing for `C`. So that is one step closer to the memory leak, but that is a separate issue.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/abbbbeee2171c78e842168dc4b678eb873ee47dc"><code>abbbbee</code></a></td><td><code>Cythonization of spin crystals.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31c666c89d791cfc4f51e87f6e71334275d1b817"><code>31c666c</code></a></td><td><code>Caching weight_lattice_realization.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/844ae90644b5c669955d5e0587d1d9e0cd3a1082"><code>844ae90</code></a></td><td><code>Forgot to add letters.pxd.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5d24018cb89b774f8a163005f602d27797068a7"><code>a5d2401</code></a></td><td><code>Full coverage and other cleanup.</code></td></tr></table>




---

archive/issue_comments_417266.json:
```json
{
    "body": "Changed branch from **[u/mantepse/speedup_crystal_weight_and_spin_e_f](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/speedup_crystal_weight_and_spin_e_f)** to **[public/crystals/cythonize_spins-27057](https://github.com/sagemath/sagetrac-mirror/tree/public/crystals/cythonize_spins-27057)**",
    "created_at": "2019-01-20T01:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417266",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/mantepse/speedup_crystal_weight_and_spin_e_f](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/speedup_crystal_weight_and_spin_e_f)** to **[public/crystals/cythonize_spins-27057](https://github.com/sagemath/sagetrac-mirror/tree/public/crystals/cythonize_spins-27057)**



---

archive/issue_comments_417267.json:
```json
{
    "body": "Changed commit from **[`fe338ae`](https://github.com/sagemath/sagetrac-mirror/commit/fe338aef61cf7cdff9805ffca6ca73068d5655c3)** to **[`a5d2401`](https://github.com/sagemath/sagetrac-mirror/commit/a5d24018cb89b774f8a163005f602d27797068a7)**",
    "created_at": "2019-01-20T01:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417267",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[`fe338ae`](https://github.com/sagemath/sagetrac-mirror/commit/fe338aef61cf7cdff9805ffca6ca73068d5655c3)** to **[`a5d2401`](https://github.com/sagemath/sagetrac-mirror/commit/a5d24018cb89b774f8a163005f602d27797068a7)**



---

archive/issue_comments_417268.json:
```json
{
    "body": "Changed author from **Martin Rubey** to **Martin Rubey, Travis Scrimshaw**",
    "created_at": "2019-01-20T01:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417268",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Martin Rubey** to **Martin Rubey, Travis Scrimshaw**



---

archive/issue_events_368916.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-20T01:26:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368916"
}
```



---

archive/issue_events_368917.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-20T01:26:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368917"
}
```



---

archive/issue_comments_417269.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2019-01-20T01:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417269",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_417270.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThat looks wonderful!\n\nI'll be playing with this until (something like) tomorrow!\n\n1+1/2 immediate questions:\n\n```\nsage: C = crystals.Spins(\"B3\")\nsage: C[0].value\n```\ndoesn't exist anymore.\n\n1) is this intentional, should there be a deprecation?\n2) I used it to identify particular elements of the crystal when it needs to be really fast.  Should I be using something else anyway?\n\nI created #27083 for the memory leak.",
    "created_at": "2019-01-20T11:25:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417270",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:19" align="right">comment:19</div>

That looks wonderful!

I'll be playing with this until (something like) tomorrow!

1+1/2 immediate questions:

```
sage: C = crystals.Spins("B3")
sage: C[0].value
```
doesn't exist anymore.

1) is this intentional, should there be a deprecation?
2) I used it to identify particular elements of the crystal when it needs to be really fast.  Should I be using something else anyway?

I created #27083 for the memory leak.



---

archive/issue_comments_417271.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n1) Yes it is intentional as it has be repurposed as an array of `bint` (booleans), but is only available using Cython code. I can make it public, but it will behave completely differently. For 2), you should be using the normal `==` to compare two crystal elements. It should not really be much slower than comparing by `value` (and any speedup you saw before should now be erased as the internal data structure has changed).\n\nAfter some thought, I think it is best for now to have a `value` `@property`. I am not sure about fully deprecating it at this point, but I am leaning towards it. Something else that might be worthwhile is adding a `__getitem__`. Thoughts?",
    "created_at": "2019-01-20T17:53:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417271",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

1) Yes it is intentional as it has be repurposed as an array of `bint` (booleans), but is only available using Cython code. I can make it public, but it will behave completely differently. For 2), you should be using the normal `==` to compare two crystal elements. It should not really be much slower than comparing by `value` (and any speedup you saw before should now be erased as the internal data structure has changed).

After some thought, I think it is best for now to have a `value` `@property`. I am not sure about fully deprecating it at this point, but I am leaning towards it. Something else that might be worthwhile is adding a `__getitem__`. Thoughts?



---

archive/issue_comments_417272.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e9d29b1e7f89a54075f5d45fd966db8d4beef2a\"><code>4e9d29b</code></a></td><td><code>Squeezing some more speed out.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/222bb33d6e691f5305bf7f13e8334b8775a883c4\"><code>222bb33</code></a></td><td><code>Some little cleanup and a deprecation for value.</code></td></tr></table>\n",
    "created_at": "2019-01-20T17:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417272",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e9d29b1e7f89a54075f5d45fd966db8d4beef2a"><code>4e9d29b</code></a></td><td><code>Squeezing some more speed out.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/222bb33d6e691f5305bf7f13e8334b8775a883c4"><code>222bb33</code></a></td><td><code>Some little cleanup and a deprecation for value.</code></td></tr></table>




---

archive/issue_comments_417273.json:
```json
{
    "body": "Changed commit from **[`a5d2401`](https://github.com/sagemath/sagetrac-mirror/commit/a5d24018cb89b774f8a163005f602d27797068a7)** to **[`222bb33`](https://github.com/sagemath/sagetrac-mirror/commit/222bb33d6e691f5305bf7f13e8334b8775a883c4)**",
    "created_at": "2019-01-20T17:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417273",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a5d2401`](https://github.com/sagemath/sagetrac-mirror/commit/a5d24018cb89b774f8a163005f602d27797068a7)** to **[`222bb33`](https://github.com/sagemath/sagetrac-mirror/commit/222bb33d6e691f5305bf7f13e8334b8775a883c4)**



---

archive/issue_comments_417274.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf\"><code>d2fe93d</code></a></td><td><code>Some little cleanup and a @property for value.</code></td></tr></table>\n",
    "created_at": "2019-01-20T17:54:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417274",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf"><code>d2fe93d</code></a></td><td><code>Some little cleanup and a @property for value.</code></td></tr></table>




---

archive/issue_comments_417275.json:
```json
{
    "body": "Changed commit from **[`222bb33`](https://github.com/sagemath/sagetrac-mirror/commit/222bb33d6e691f5305bf7f13e8334b8775a883c4)** to **[`d2fe93d`](https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf)**",
    "created_at": "2019-01-20T17:54:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417275",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`222bb33`](https://github.com/sagemath/sagetrac-mirror/commit/222bb33d6e691f5305bf7f13e8334b8775a883c4)** to **[`d2fe93d`](https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf)**



---

archive/issue_comments_417276.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Martin Rubey**",
    "created_at": "2019-01-23T11:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417276",
    "user": "https://github.com/mantepse"
}
```

Changed reviewer from **Travis Scrimshaw** to **Travis Scrimshaw, Martin Rubey**



---

archive/issue_comments_417277.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nExcellent!  Many thanks!",
    "created_at": "2019-01-23T11:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417277",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:23" align="right">comment:23</div>

Excellent!  Many thanks!



---

archive/issue_events_368918.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-23T11:25:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368918"
}
```



---

archive/issue_events_368919.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2019-01-23T11:25:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368919"
}
```



---

archive/issue_comments_417278.json:
```json
{
    "body": "Changed author from **Martin Rubey, Travis Scrimshaw** to **Travis Scrimshaw**",
    "created_at": "2019-01-23T11:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417278",
    "user": "https://github.com/mantepse"
}
```

Changed author from **Martin Rubey, Travis Scrimshaw** to **Travis Scrimshaw**



---

archive/issue_comments_417279.json:
```json
{
    "body": "Changed branch from **[public/crystals/cythonize_spins-27057](https://github.com/sagemath/sagetrac-mirror/tree/public/crystals/cythonize_spins-27057)** to **[`d2fe93d`](https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf)**",
    "created_at": "2019-01-26T15:55:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27057#issuecomment-417279",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/crystals/cythonize_spins-27057](https://github.com/sagemath/sagetrac-mirror/tree/public/crystals/cythonize_spins-27057)** to **[`d2fe93d`](https://github.com/sagemath/sagetrac-mirror/commit/d2fe93d9fb8a2fd8051c266e23724519c77e8fdf)**



---

archive/issue_events_368920.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-26T15:55:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368920"
}
```



---

archive/issue_events_368921.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "62bdcc466a420ef1a780bc48ef9f1e8a19d9a6bc",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-26T15:55:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27057",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27057#event-368921"
}
```
