# Issue 27529: py3: tiny fix in env.py

archive/issues_027292.json:
```json
{
    "assignees": [],
    "body": "\n\nCC:  @embray @jdemeyer @tscrim @kiwifb\n\nComponent: **python3**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nBranch/Commit: **[`8ebcdc6`](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)**\n\nReviewer: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27529_\n\n",
    "closed_at": "2019-06-02T22:04:33Z",
    "created_at": "2019-03-22T07:57:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: tiny fix in env.py",
    "type": "issue",
    "updated_at": "2019-06-02T22:04:33Z",
    "url": "https://github.com/sagemath/sage/issues/27529",
    "user": "https://github.com/fchapoton"
}
```


CC:  @embray @jdemeyer @tscrim @kiwifb

Component: **python3**

Author: **Frédéric Chapoton**

Branch/Commit: **[`8ebcdc6`](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)**

Reviewer: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/27529_





---

archive/issue_events_375069.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375069"
}
```



---

archive/issue_events_375070.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375070"
}
```



---

archive/issue_events_375071.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375071"
}
```



---

archive/issue_events_375072.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375072"
}
```



---

archive/issue_events_375073.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375073"
}
```



---

archive/issue_comments_426369.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7\"><code>c6ca0b1</code></a></td><td><code>py3 tiny fix in env.py</code></td></tr></table>\n",
    "created_at": "2019-03-22T07:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426369",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7"><code>c6ca0b1</code></a></td><td><code>py3 tiny fix in env.py</code></td></tr></table>




---

archive/issue_comments_426370.json:
```json
{
    "body": "Commit: **[`c6ca0b1`](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)**",
    "created_at": "2019-03-22T07:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426370",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`c6ca0b1`](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)**



---

archive/issue_comments_426371.json:
```json
{
    "body": "Branch: **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)**",
    "created_at": "2019-03-22T07:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426371",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)**



---

archive/issue_comments_426372.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\ngreen bot, please review",
    "created_at": "2019-03-22T12:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426372",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:2" align="right">comment:2</div>

green bot, please review



---

archive/issue_events_375074.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-22T12:29:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375074"
}
```



---

archive/issue_events_375075.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-22T12:29:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375075"
}
```



---

archive/issue_comments_426373.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nPlease use `sys.executable` instead.",
    "created_at": "2019-03-22T12:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426373",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Please use `sys.executable` instead.



---

archive/issue_comments_426374.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d\"><code>812181f</code></a></td><td><code>using sys.executable instead</code></td></tr></table>\n",
    "created_at": "2019-03-22T12:37:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426374",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d"><code>812181f</code></a></td><td><code>using sys.executable instead</code></td></tr></table>




---

archive/issue_comments_426375.json:
```json
{
    "body": "Changed commit from **[`c6ca0b1`](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)** to **[`812181f`](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)**",
    "created_at": "2019-03-22T12:37:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426375",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c6ca0b1`](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)** to **[`812181f`](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)**



---

archive/issue_comments_426376.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nindeed, better. Thx",
    "created_at": "2019-03-22T12:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426376",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

indeed, better. Thx



---

archive/issue_events_375076.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T12:37:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375076"
}
```



---

archive/issue_events_375077.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T12:37:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375077"
}
```



---

archive/issue_comments_426377.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nthere is another one in src/sage/doctest/control.py, let us fix it too",
    "created_at": "2019-03-22T12:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426377",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

there is another one in src/sage/doctest/control.py, let us fix it too



---

archive/issue_comments_426378.json:
```json
{
    "body": "Changed commit from **[`812181f`](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)** to **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)**",
    "created_at": "2019-03-22T12:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426378",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`812181f`](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)** to **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)**



---

archive/issue_comments_426379.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65\"><code>83aa62d</code></a></td><td><code>another use of sys.executable</code></td></tr></table>\n",
    "created_at": "2019-03-22T12:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426379",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65"><code>83aa62d</code></a></td><td><code>another use of sys.executable</code></td></tr></table>




---

archive/issue_comments_426380.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nVery good! Positive review if this passes tests on Python 2 and 3.",
    "created_at": "2019-03-22T12:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426380",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Very good! Positive review if this passes tests on Python 2 and 3.



---

archive/issue_comments_426381.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2019-03-22T12:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426381",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_426382.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nhmm. The change in doctest control breaks one doctest in python3:\n\n```\nsage -t --long src/sage/doctest/control.py\n**********************************************************************\nFile \"src/sage/doctest/control.py\", line 630, in sage.doctest.control.DocTestController.test_safe_directory\nFailed example:\n    DC.test_safe_directory(d)\nExpected:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: refusing to run doctests...\nGot:\n    <BLANKLINE>\n```\nI am not sure what to do :\n- undo this change ?\n- tag the doctest with # py2 ?",
    "created_at": "2019-03-22T14:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426382",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

hmm. The change in doctest control breaks one doctest in python3:

```
sage -t --long src/sage/doctest/control.py
**********************************************************************
File "src/sage/doctest/control.py", line 630, in sage.doctest.control.DocTestController.test_safe_directory
Failed example:
    DC.test_safe_directory(d)
Expected:
    Traceback (most recent call last):
    ...
    RuntimeError: refusing to run doctests...
Got:
    <BLANKLINE>
```
I am not sure what to do :
- undo this change ?
- tag the doctest with # py2 ?



---

archive/issue_comments_426383.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThat's interesting. It means two things if I am not mistaken.\n* python3 does allow you to run stuff from unsafe directories just like python2\n* the doctest and possibly the functionality never worked with python3. That bit must have always called python2.",
    "created_at": "2019-03-22T18:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426383",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

That's interesting. It means two things if I am not mistaken.
* python3 does allow you to run stuff from unsafe directories just like python2
* the doctest and possibly the functionality never worked with python3. That bit must have always called python2.



---

archive/issue_comments_426384.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n1. `doctest` is not tested by `python3-known-passing.txt`, so that doctest failure doesn't have to prevent merging this ticket. The fix makes sense, despite that it breaks a doctest.\n\n2. I posted about this failure on https://groups.google.com/d/msg/sage-devel/_pH7bjQmw5A/IJz_zlMxAwAJ but that thread didn't come to a conclusion.",
    "created_at": "2019-03-22T20:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426384",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

1. `doctest` is not tested by `python3-known-passing.txt`, so that doctest failure doesn't have to prevent merging this ticket. The fix makes sense, despite that it breaks a doctest.

2. I posted about this failure on https://groups.google.com/d/msg/sage-devel/_pH7bjQmw5A/IJz_zlMxAwAJ but that thread didn't come to a conclusion.



---

archive/issue_comments_426385.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI would prefer not to have any new py3-failing file.",
    "created_at": "2019-03-23T06:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426385",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

I would prefer not to have any new py3-failing file.



---

archive/issue_comments_426386.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nok, let it be. Jeroen, I am setting to positive in your name.",
    "created_at": "2019-03-23T20:45:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426386",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

ok, let it be. Jeroen, I am setting to positive in your name.



---

archive/issue_events_375078.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-23T20:45:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375078"
}
```



---

archive/issue_events_375079.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-23T20:45:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375079"
}
```



---

archive/issue_comments_426387.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI'm also not too happy with this situation, but at least this edited test reflects better the reality that it's failing on Python 3. Note that this specific test has always been somewhat controversial.",
    "created_at": "2019-03-23T21:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426387",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

I'm also not too happy with this situation, but at least this edited test reflects better the reality that it's failing on Python 3. Note that this specific test has always been somewhat controversial.



---

archive/issue_events_375080.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T11:06:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375080"
}
```



---

archive/issue_events_375081.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T11:06:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375081"
}
```



---

archive/issue_comments_426388.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nPlease squash your commits, and maybe reference this ticket # in the commit message.",
    "created_at": "2019-03-25T11:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426388",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

Please squash your commits, and maybe reference this ticket # in the commit message.



---

archive/issue_comments_426389.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nSee #26457 which discusses the possibility of removing this test altogether, or #25358 (which would conflict with this) for an alternative middle-ground.\n\nI would rather we go ahead and do one of these than make fixes to a test that's dubious in the first place.",
    "created_at": "2019-03-25T11:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426389",
    "user": "https://github.com/embray"
}
```

<div id="comment:16" align="right">comment:16</div>

See #26457 which discusses the possibility of removing this test altogether, or #25358 (which would conflict with this) for an alternative middle-ground.

I would rather we go ahead and do one of these than make fixes to a test that's dubious in the first place.



---

archive/issue_events_375082.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:43:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375082"
}
```



---

archive/issue_events_375083.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:43:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375083"
}
```



---

archive/issue_comments_426390.json:
```json
{
    "body": "Changed branch from **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)** to **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)**",
    "created_at": "2019-03-25T19:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426390",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)** to **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)**



---

archive/issue_comments_426391.json:
```json
{
    "body": "Changed commit from **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)** to none",
    "created_at": "2019-03-25T19:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426391",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)** to none



---

archive/issue_events_375084.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:45:42Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375084"
}
```



---

archive/issue_events_375085.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-26T11:58:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375085"
}
```



---

archive/issue_events_375086.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-29T20:25:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375086"
}
```



---

archive/issue_events_375087.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-29T20:25:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375087"
}
```



---

archive/issue_comments_426392.json:
```json
{
    "body": "Commit: **[`e928ec7`](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)**",
    "created_at": "2019-03-29T20:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426392",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`e928ec7`](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)**



---

archive/issue_comments_426393.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d\"><code>e928ec7</code></a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>\n",
    "created_at": "2019-03-29T20:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426393",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d"><code>e928ec7</code></a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>




---

archive/issue_comments_426394.json:
```json
{
    "body": "Changed branch from **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)** to **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)**",
    "created_at": "2019-03-29T20:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426394",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[`83aa62d`](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)** to **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)**



---

archive/issue_comments_426395.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWhy don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.",
    "created_at": "2019-05-29T02:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426395",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

Why don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.



---

archive/issue_comments_426396.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@jhpalmieri](#comment%3A22):\n> Why don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.\n\nWorks for me.",
    "created_at": "2019-05-29T02:42:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426396",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@jhpalmieri](#comment%3A22):
> Why don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.

Works for me.



---

archive/issue_comments_426397.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAnd just to make sure I understand correctly: there are two issues with the tests\n\n```\n    Check that Sage refuses to run doctests from a directory whose\n    permissions are too loose.  We create a world-writable directory\n    inside a safe temporary directory to test this::\n\n        sage: d = os.path.join(tmp_dir(), \"test\")\n        sage: os.mkdir(d)\n        sage: os.chmod(d, 0o777)\n        sage: (out, err, ret) = test_executable([\"sage\", \"-t\", \"nonexisting.py\"], cwd=d)\n        sage: print(err)\n        ...\n        RuntimeError: refusing to run doctests...\n        sage: (out, err, ret) = test_executable([\"sage\", \"-tp\", \"1\", \"nonexisting.py\"], cwd=d)\n        sage: print(err)\n        ...\n        RuntimeError: refusing to run doctests...\n```\nright? First, they don't work at all with Python 3 because of `subprocess.call(['python', ...`, and second, they don't work with an unpatched Python. We can fix the second of these by tagging the doctests `# build`. We could fix the first in a less than ideal way by tagging the doctests `# py2`.",
    "created_at": "2019-05-29T02:51:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426397",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

And just to make sure I understand correctly: there are two issues with the tests

```
    Check that Sage refuses to run doctests from a directory whose
    permissions are too loose.  We create a world-writable directory
    inside a safe temporary directory to test this::

        sage: d = os.path.join(tmp_dir(), "test")
        sage: os.mkdir(d)
        sage: os.chmod(d, 0o777)
        sage: (out, err, ret) = test_executable(["sage", "-t", "nonexisting.py"], cwd=d)
        sage: print(err)
        ...
        RuntimeError: refusing to run doctests...
        sage: (out, err, ret) = test_executable(["sage", "-tp", "1", "nonexisting.py"], cwd=d)
        sage: print(err)
        ...
        RuntimeError: refusing to run doctests...
```
right? First, they don't work at all with Python 3 because of `subprocess.call(['python', ...`, and second, they don't work with an unpatched Python. We can fix the second of these by tagging the doctests `# build`. We could fix the first in a less than ideal way by tagging the doctests `# py2`.



---

archive/issue_comments_426398.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThey would \"work\" if python was python3 which can kind of happen in sage-on-distro. But yes they are the kind of tests the `# build` tag is suitable for. More so than `# py2`.",
    "created_at": "2019-05-29T04:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426398",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

They would "work" if python was python3 which can kind of happen in sage-on-distro. But yes they are the kind of tests the `# build` tag is suitable for. More so than `# py2`.



---

archive/issue_comments_426399.json:
```json
{
    "body": "Changed commit from **[`e928ec7`](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)** to **[`8ebcdc6`](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)**",
    "created_at": "2019-05-30T15:46:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426399",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e928ec7`](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)** to **[`8ebcdc6`](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)**



---

archive/issue_comments_426400.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99\"><code>8ebcdc6</code></a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>\n",
    "created_at": "2019-05-30T15:46:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426400",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99"><code>8ebcdc6</code></a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>




---

archive/issue_comments_426401.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nHere is a branch with only the changes in env.py. Positive ?",
    "created_at": "2019-05-30T15:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426401",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:27" align="right">comment:27</div>

Here is a branch with only the changes in env.py. Positive ?



---

archive/issue_comments_426402.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI think so. Jeroen already reviewed positively before, and I can confirm that the change fixes the py3 problem with `env.py`.",
    "created_at": "2019-05-30T20:25:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426402",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:28" align="right">comment:28</div>

I think so. Jeroen already reviewed positively before, and I can confirm that the change fixes the py3 problem with `env.py`.



---

archive/issue_events_375088.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-05-30T20:25:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375088"
}
```



---

archive/issue_events_375089.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-05-30T20:25:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375089"
}
```



---

archive/issue_comments_426403.json:
```json
{
    "body": "Changed branch from **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)** to **[`8ebcdc6`](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)**",
    "created_at": "2019-06-02T22:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-426403",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)** to **[`8ebcdc6`](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)**



---

archive/issue_events_375090.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-02T22:04:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375090"
}
```



---

archive/issue_events_375091.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f6e6ae8d258c1f0cfb2f7a3b2288bee522a741ad",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-06-02T22:04:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-375091"
}
```
