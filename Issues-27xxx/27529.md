# Issue 27529: py3: tiny fix in env.py

archive/issues_027292.json:
```json
{
    "assignees": [],
    "body": "\n\n**CC:**  @embray @jdemeyer @tscrim @kiwifb\n\n**Branch/Commit:** [8ebcdc67d8abfec50d7891496bd6f069bd76ad99](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton\n\nIssue created by migration from https://trac.sagemath.org/ticket/27529\n\n",
    "closed_at": "2019-06-02T22:04:33Z",
    "created_at": "2019-03-22T07:57:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: tiny fix in env.py",
    "type": "issue",
    "updated_at": "2019-06-02T22:04:33Z",
    "url": "https://github.com/sagemath/sage/issues/27529",
    "user": "https://github.com/fchapoton"
}
```


**CC:**  @embray @jdemeyer @tscrim @kiwifb

**Branch/Commit:** [8ebcdc67d8abfec50d7891496bd6f069bd76ad99](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)

**Reviewer:** Jeroen Demeyer

**Author:** Frédéric Chapoton

Issue created by migration from https://trac.sagemath.org/ticket/27529





---

archive/issue_events_330491.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330491"
}
```



---

archive/issue_events_330492.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "08517b",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330492"
}
```



---

archive/issue_events_330493.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330493"
}
```



---

archive/issue_events_330494.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T07:57:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330494"
}
```



---

archive/issue_comments_429149.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7\">c6ca0b1</a></td><td><code>py3 tiny fix in env.py</code></td></tr></table>\n",
    "created_at": "2019-03-22T07:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429149",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7">c6ca0b1</a></td><td><code>py3 tiny fix in env.py</code></td></tr></table>




---

archive/issue_comments_429150.json:
```json
{
    "body": "**Commit:** [c6ca0b109482c081c79da9cfdb507793148c8fe7](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)",
    "created_at": "2019-03-22T07:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429150",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [c6ca0b109482c081c79da9cfdb507793148c8fe7](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)



---

archive/issue_comments_429151.json:
```json
{
    "body": "**Branch:** [u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)",
    "created_at": "2019-03-22T07:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429151",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)



---

archive/issue_comments_429152.json:
```json
{
    "body": "<a id='comment:2'></a>\ngreen bot, please review",
    "created_at": "2019-03-22T12:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429152",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
green bot, please review



---

archive/issue_events_330495.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-22T12:29:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330495"
}
```



---

archive/issue_events_330496.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-22T12:29:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330496"
}
```



---

archive/issue_comments_429153.json:
```json
{
    "body": "<a id='comment:3'></a>\nPlease use `sys.executable` instead.",
    "created_at": "2019-03-22T12:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429153",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Please use `sys.executable` instead.



---

archive/issue_comments_429154.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d\">812181f</a></td><td><code>using sys.executable instead</code></td></tr></table>\n",
    "created_at": "2019-03-22T12:37:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429154",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d">812181f</a></td><td><code>using sys.executable instead</code></td></tr></table>




---

archive/issue_comments_429155.json:
```json
{
    "body": "**Changing commit** from \"[c6ca0b109482c081c79da9cfdb507793148c8fe7](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)\" to \"[812181f084f197c48be617e83f8f2414b6462c0d](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)\".",
    "created_at": "2019-03-22T12:37:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429155",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c6ca0b109482c081c79da9cfdb507793148c8fe7](https://github.com/sagemath/sagetrac-mirror/commit/c6ca0b109482c081c79da9cfdb507793148c8fe7)" to "[812181f084f197c48be617e83f8f2414b6462c0d](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)".



---

archive/issue_comments_429156.json:
```json
{
    "body": "<a id='comment:5'></a>\nindeed, better. Thx",
    "created_at": "2019-03-22T12:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429156",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
indeed, better. Thx



---

archive/issue_events_330497.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T12:37:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330497"
}
```



---

archive/issue_events_330498.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-22T12:37:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330498"
}
```



---

archive/issue_comments_429157.json:
```json
{
    "body": "<a id='comment:6'></a>\nthere is another one in src/sage/doctest/control.py, let us fix it too",
    "created_at": "2019-03-22T12:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429157",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
there is another one in src/sage/doctest/control.py, let us fix it too



---

archive/issue_comments_429158.json:
```json
{
    "body": "**Changing commit** from \"[812181f084f197c48be617e83f8f2414b6462c0d](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)\" to \"[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)\".",
    "created_at": "2019-03-22T12:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429158",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[812181f084f197c48be617e83f8f2414b6462c0d](https://github.com/sagemath/sagetrac-mirror/commit/812181f084f197c48be617e83f8f2414b6462c0d)" to "[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)".



---

archive/issue_comments_429159.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65\">83aa62d</a></td><td><code>another use of sys.executable</code></td></tr></table>\n",
    "created_at": "2019-03-22T12:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429159",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65">83aa62d</a></td><td><code>another use of sys.executable</code></td></tr></table>




---

archive/issue_comments_429160.json:
```json
{
    "body": "<a id='comment:8'></a>\nVery good! Positive review if this passes tests on Python 2 and 3.",
    "created_at": "2019-03-22T12:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429160",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Very good! Positive review if this passes tests on Python 2 and 3.



---

archive/issue_comments_429161.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2019-03-22T12:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429161",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_429162.json:
```json
{
    "body": "<a id='comment:9'></a>\nhmm. The change in doctest control breaks one doctest in python3:\n\n```\nsage -t --long src/sage/doctest/control.py\n**********************************************************************\nFile \"src/sage/doctest/control.py\", line 630, in sage.doctest.control.DocTestController.test_safe_directory\nFailed example:\n    DC.test_safe_directory(d)\nExpected:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: refusing to run doctests...\nGot:\n    <BLANKLINE>\n```\nI am not sure what to do :\n- undo this change ?\n- tag the doctest with # py2 ?",
    "created_at": "2019-03-22T14:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429162",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
hmm. The change in doctest control breaks one doctest in python3:

```
sage -t --long src/sage/doctest/control.py
**********************************************************************
File "src/sage/doctest/control.py", line 630, in sage.doctest.control.DocTestController.test_safe_directory
Failed example:
    DC.test_safe_directory(d)
Expected:
    Traceback (most recent call last):
    ...
    RuntimeError: refusing to run doctests...
Got:
    <BLANKLINE>
```
I am not sure what to do :
- undo this change ?
- tag the doctest with # py2 ?



---

archive/issue_comments_429163.json:
```json
{
    "body": "<a id='comment:10'></a>\nThat's interesting. It means two things if I am not mistaken.\n* python3 does allow you to run stuff from unsafe directories just like python2\n* the doctest and possibly the functionality never worked with python3. That bit must have always called python2.",
    "created_at": "2019-03-22T18:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429163",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'></a>
That's interesting. It means two things if I am not mistaken.
* python3 does allow you to run stuff from unsafe directories just like python2
* the doctest and possibly the functionality never worked with python3. That bit must have always called python2.



---

archive/issue_comments_429164.json:
```json
{
    "body": "<a id='comment:11'></a>\n1. `doctest` is not tested by `python3-known-passing.txt`, so that doctest failure doesn't have to prevent merging this ticket. The fix makes sense, despite that it breaks a doctest.\n\n2. I posted about this failure on https://groups.google.com/d/msg/sage-devel/_pH7bjQmw5A/IJz_zlMxAwAJ but that thread didn't come to a conclusion.",
    "created_at": "2019-03-22T20:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429164",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
1. `doctest` is not tested by `python3-known-passing.txt`, so that doctest failure doesn't have to prevent merging this ticket. The fix makes sense, despite that it breaks a doctest.

2. I posted about this failure on https://groups.google.com/d/msg/sage-devel/_pH7bjQmw5A/IJz_zlMxAwAJ but that thread didn't come to a conclusion.



---

archive/issue_comments_429165.json:
```json
{
    "body": "<a id='comment:12'></a>\nI would prefer not to have any new py3-failing file.",
    "created_at": "2019-03-23T06:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429165",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>
I would prefer not to have any new py3-failing file.



---

archive/issue_comments_429166.json:
```json
{
    "body": "<a id='comment:13'></a>\nok, let it be. Jeroen, I am setting to positive in your name.",
    "created_at": "2019-03-23T20:45:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429166",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
ok, let it be. Jeroen, I am setting to positive in your name.



---

archive/issue_events_330499.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-23T20:45:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330499"
}
```



---

archive/issue_events_330500.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-23T20:45:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330500"
}
```



---

archive/issue_comments_429167.json:
```json
{
    "body": "<a id='comment:14'></a>\nI'm also not too happy with this situation, but at least this edited test reflects better the reality that it's failing on Python 3. Note that this specific test has always been somewhat controversial.",
    "created_at": "2019-03-23T21:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429167",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
I'm also not too happy with this situation, but at least this edited test reflects better the reality that it's failing on Python 3. Note that this specific test has always been somewhat controversial.



---

archive/issue_events_330501.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T11:06:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330501"
}
```



---

archive/issue_events_330502.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T11:06:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330502"
}
```



---

archive/issue_comments_429168.json:
```json
{
    "body": "<a id='comment:15'></a>\nPlease squash your commits, and maybe reference this ticket # in the commit message.",
    "created_at": "2019-03-25T11:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429168",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Please squash your commits, and maybe reference this ticket # in the commit message.



---

archive/issue_comments_429169.json:
```json
{
    "body": "<a id='comment:16'></a>\nSee #26457 which discusses the possibility of removing this test altogether, or #25358 (which would conflict with this) for an alternative middle-ground.\n\nI would rather we go ahead and do one of these than make fixes to a test that's dubious in the first place.",
    "created_at": "2019-03-25T11:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429169",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
See #26457 which discusses the possibility of removing this test altogether, or #25358 (which would conflict with this) for an alternative middle-ground.

I would rather we go ahead and do one of these than make fixes to a test that's dubious in the first place.



---

archive/issue_events_330503.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:43:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330503"
}
```



---

archive/issue_events_330504.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:43:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330504"
}
```



---

archive/issue_comments_429170.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)\" to \"[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)\".",
    "created_at": "2019-03-25T19:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429170",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)" to "[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)".



---

archive/issue_comments_429171.json:
```json
{
    "body": "**Changing commit** from \"[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)\" to \"\".",
    "created_at": "2019-03-25T19:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429171",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)" to "".



---

archive/issue_events_330505.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-26T11:58:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330505"
}
```



---

archive/issue_events_330506.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-29T20:25:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330506"
}
```



---

archive/issue_events_330507.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-29T20:25:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330507"
}
```



---

archive/issue_comments_429172.json:
```json
{
    "body": "**Commit:** [e928ec7891d2c8d9134dd238c1859dd26f20d67d](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)",
    "created_at": "2019-03-29T20:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429172",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [e928ec7891d2c8d9134dd238c1859dd26f20d67d](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)



---

archive/issue_comments_429173.json:
```json
{
    "body": "<a id='comment:21'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d\">e928ec7</a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>\n",
    "created_at": "2019-03-29T20:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429173",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d">e928ec7</a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>




---

archive/issue_comments_429174.json:
```json
{
    "body": "**Changing branch** from \"[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)\" to \"[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)\".",
    "created_at": "2019-03-29T20:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429174",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[83aa62d3846a861c07e9b0a6edd4aeb915eedf65](https://github.com/sagemath/sagetrac-mirror/commit/83aa62d3846a861c07e9b0a6edd4aeb915eedf65)" to "[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)".



---

archive/issue_comments_429175.json:
```json
{
    "body": "<a id='comment:22'></a>\nWhy don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.",
    "created_at": "2019-05-29T02:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429175",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>
Why don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.



---

archive/issue_comments_429176.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [@jhpalmieri](#comment%3A22):\n> Why don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.\n\nWorks for me.",
    "created_at": "2019-05-29T02:42:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429176",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>
Replying to [@jhpalmieri](#comment%3A22):
> Why don't we split this (already tiny fix) into pieces? The change in `env.py` should be safe, right? The more controversial doctest can be dealt with elsewhere.

Works for me.



---

archive/issue_comments_429177.json:
```json
{
    "body": "<a id='comment:24'></a>\nAnd just to make sure I understand correctly: there are two issues with the tests\n\n```\n    Check that Sage refuses to run doctests from a directory whose\n    permissions are too loose.  We create a world-writable directory\n    inside a safe temporary directory to test this::\n\n        sage: d = os.path.join(tmp_dir(), \"test\")\n        sage: os.mkdir(d)\n        sage: os.chmod(d, 0o777)\n        sage: (out, err, ret) = test_executable([\"sage\", \"-t\", \"nonexisting.py\"], cwd=d)\n        sage: print(err)\n        ...\n        RuntimeError: refusing to run doctests...\n        sage: (out, err, ret) = test_executable([\"sage\", \"-tp\", \"1\", \"nonexisting.py\"], cwd=d)\n        sage: print(err)\n        ...\n        RuntimeError: refusing to run doctests...\n```\nright? First, they don't work at all with Python 3 because of `subprocess.call(['python', ...`, and second, they don't work with an unpatched Python. We can fix the second of these by tagging the doctests `# build`. We could fix the first in a less than ideal way by tagging the doctests `# py2`.",
    "created_at": "2019-05-29T02:51:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429177",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>
And just to make sure I understand correctly: there are two issues with the tests

```
    Check that Sage refuses to run doctests from a directory whose
    permissions are too loose.  We create a world-writable directory
    inside a safe temporary directory to test this::

        sage: d = os.path.join(tmp_dir(), "test")
        sage: os.mkdir(d)
        sage: os.chmod(d, 0o777)
        sage: (out, err, ret) = test_executable(["sage", "-t", "nonexisting.py"], cwd=d)
        sage: print(err)
        ...
        RuntimeError: refusing to run doctests...
        sage: (out, err, ret) = test_executable(["sage", "-tp", "1", "nonexisting.py"], cwd=d)
        sage: print(err)
        ...
        RuntimeError: refusing to run doctests...
```
right? First, they don't work at all with Python 3 because of `subprocess.call(['python', ...`, and second, they don't work with an unpatched Python. We can fix the second of these by tagging the doctests `# build`. We could fix the first in a less than ideal way by tagging the doctests `# py2`.



---

archive/issue_comments_429178.json:
```json
{
    "body": "<a id='comment:25'></a>\nThey would \"work\" if python was python3 which can kind of happen in sage-on-distro. But yes they are the kind of tests the `# build` tag is suitable for. More so than `# py2`.",
    "created_at": "2019-05-29T04:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429178",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:25'></a>
They would "work" if python was python3 which can kind of happen in sage-on-distro. But yes they are the kind of tests the `# build` tag is suitable for. More so than `# py2`.



---

archive/issue_comments_429179.json:
```json
{
    "body": "**Changing commit** from \"[e928ec7891d2c8d9134dd238c1859dd26f20d67d](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)\" to \"[8ebcdc67d8abfec50d7891496bd6f069bd76ad99](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)\".",
    "created_at": "2019-05-30T15:46:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429179",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e928ec7891d2c8d9134dd238c1859dd26f20d67d](https://github.com/sagemath/sagetrac-mirror/commit/e928ec7891d2c8d9134dd238c1859dd26f20d67d)" to "[8ebcdc67d8abfec50d7891496bd6f069bd76ad99](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)".



---

archive/issue_comments_429180.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99\">8ebcdc6</a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>\n",
    "created_at": "2019-05-30T15:46:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429180",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99">8ebcdc6</a></td><td><code>trac #27529 py3 tiny fix in env.py (using sys.executable)</code></td></tr></table>




---

archive/issue_comments_429181.json:
```json
{
    "body": "<a id='comment:27'></a>\nHere is a branch with only the changes in env.py. Positive ?",
    "created_at": "2019-05-30T15:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429181",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>
Here is a branch with only the changes in env.py. Positive ?



---

archive/issue_comments_429182.json:
```json
{
    "body": "<a id='comment:28'></a>\nI think so. Jeroen already reviewed positively before, and I can confirm that the change fixes the py3 problem with `env.py`.",
    "created_at": "2019-05-30T20:25:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429182",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
I think so. Jeroen already reviewed positively before, and I can confirm that the change fixes the py3 problem with `env.py`.



---

archive/issue_events_330508.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-05-30T20:25:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330508"
}
```



---

archive/issue_events_330509.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-05-30T20:25:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330509"
}
```



---

archive/issue_comments_429183.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)\" to \"[8ebcdc67d8abfec50d7891496bd6f069bd76ad99](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)\".",
    "created_at": "2019-06-02T22:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27529#issuecomment-429183",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/chapoton/27529](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27529)" to "[8ebcdc67d8abfec50d7891496bd6f069bd76ad99](https://github.com/sagemath/sagetrac-mirror/commit/8ebcdc67d8abfec50d7891496bd6f069bd76ad99)".



---

archive/issue_events_330510.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-02T22:04:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330510"
}
```



---

archive/issue_events_330511.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f6e6ae8d258c1f0cfb2f7a3b2288bee522a741ad",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-06-02T22:04:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27529",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27529#event-330511"
}
```
