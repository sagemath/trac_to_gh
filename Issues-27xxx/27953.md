# Issue 27953: Integral curves over finite fields: base classes

archive/issues_027716.json:
```json
{
    "body": "This is a subticket for #27873. Main things done in this ticket are:\n\n- Base classes for integral curves over finite fields are added.\n\n- The constructor of curves is refactored to support integral curves.\n\n- Curves over **prime** finite fields are removed (become curves over finite fields).\n\n- Integral curves are equipped with function fields.\n\nBranch/Commit: a9d0626498c1b295f16817cd26b56713eca20a19\n\nReviewer: Travis Scrimshaw\n\nAuthor: Kwankyu Lee\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27953\n\n",
    "closed_at": "2020-01-05T15:47:44Z",
    "created_at": "2019-06-08T22:36:11Z",
    "labels": [
        "component: algebraic geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Integral curves over finite fields: base classes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27953",
    "user": "https://github.com/kwankyu"
}
```
This is a subticket for #27873. Main things done in this ticket are:

- Base classes for integral curves over finite fields are added.

- The constructor of curves is refactored to support integral curves.

- Curves over **prime** finite fields are removed (become curves over finite fields).

- Integral curves are equipped with function fields.

Branch/Commit: a9d0626498c1b295f16817cd26b56713eca20a19

Reviewer: Travis Scrimshaw

Author: Kwankyu Lee

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27953





---

archive/issue_comments_541166.json:
```json
{
    "body": "Changing author from \"\" to \"Kwankyu Lee\"",
    "created_at": "2019-06-08T22:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541166",
    "user": "https://github.com/kwankyu"
}
```

Changing author from "" to "Kwankyu Lee"



---

archive/issue_comments_541167.json:
```json
{
    "body": "Changing branch from \"\" to \"u/klee/27953\"",
    "created_at": "2019-06-08T22:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541167",
    "user": "https://github.com/kwankyu"
}
```

Changing branch from "" to "u/klee/27953"



---

archive/issue_comments_541168.json:
```json
{
    "body": "Changing commit from \"\" to \"05e005300847eb5a15c8959a427ff7aa400689ba\"",
    "created_at": "2019-06-08T22:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "05e005300847eb5a15c8959a427ff7aa400689ba"



---

archive/issue_comments_541169.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-08T22:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541170.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#27951\"",
    "created_at": "2019-06-08T22:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541170",
    "user": "https://github.com/kwankyu"
}
```

Changing dependencies from "" to "#27951"



---

archive/issue_comments_541171.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n This is a subticket for #27873.\n \n-Integral curves over finite fields with function fields attached and with minimal functionality is added.\n+Base classes for Integral curves over finite fields with function fields attached  is added.\n \n The constructor of curves is refactored to support integral curves.\n \n-Curves over **prime** finite fields are removed.\n+Curves over **prime** finite fields are removed. \n \n Comment: 1\n \n``````\n",
    "created_at": "2019-06-09T03:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541171",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
 This is a subticket for #27873.
 
-Integral curves over finite fields with function fields attached and with minimal functionality is added.
+Base classes for Integral curves over finite fields with function fields attached  is added.
 
 The constructor of curves is refactored to support integral curves.
 
-Curves over **prime** finite fields are removed.
+Curves over **prime** finite fields are removed. 
 
 Comment: 1
 
``````




---

archive/issue_comments_541172.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+This is a subticket for #27873.\n \n+Base classes for integral curves over finite fields with function fields attached  are added.\n+\n+The constructor of curves is refactored to support integral curves.\n+\n+Curves over **prime** finite fields are removed. \n \n Comment: 1\n \n``````\n",
    "created_at": "2019-06-09T03:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541172",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+This is a subticket for #27873.
 
+Base classes for integral curves over finite fields with function fields attached  are added.
+
+The constructor of curves is refactored to support integral curves.
+
+Curves over **prime** finite fields are removed. 
 
 Comment: 1
 
``````




---

archive/issue_comments_541173.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-09T03:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541173",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_541174.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-06-09T03:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541174",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_541175.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-09T04:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541176.json:
```json
{
    "body": "Changing commit from \"05e005300847eb5a15c8959a427ff7aa400689ba\" to \"992e6dacbd3f717c1aa2e6f0b93f684e2e6293de\"",
    "created_at": "2019-06-09T04:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "05e005300847eb5a15c8959a427ff7aa400689ba" to "992e6dacbd3f717c1aa2e6f0b93f684e2e6293de"



---

archive/issue_comments_541177.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-06-09T07:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541177",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_541178.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-06-09T07:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541178",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_541179.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-06-10T06:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_541180.json:
```json
{
    "body": "Changing commit from \"992e6dacbd3f717c1aa2e6f0b93f684e2e6293de\" to \"45725bbafa12b08a5e7f4de8e409266d04dc9522\"",
    "created_at": "2019-06-10T06:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "992e6dacbd3f717c1aa2e6f0b93f684e2e6293de" to "45725bbafa12b08a5e7f4de8e409266d04dc9522"



---

archive/issue_comments_541181.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+This is a subticket for #27873.\n \n+Base classes for integral curves over finite fields are added.\n+\n+The constructor of curves is refactored to support integral curves.\n+\n+Curves over **prime** finite fields are removed. \n+\n+Integral curves are equipped with function fields.\n \n Comment: 1\n \n``````\n",
    "created_at": "2019-06-10T07:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541181",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+This is a subticket for #27873.
 
+Base classes for integral curves over finite fields are added.
+
+The constructor of curves is refactored to support integral curves.
+
+Curves over **prime** finite fields are removed. 
+
+Integral curves are equipped with function fields.
 
 Comment: 1
 
``````




---

archive/issue_comments_541182.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+This is a subticket for #27873.\n \n+Base classes for integral curves over finite fields are added.\n+\n+The constructor of curves is refactored to support integral curves.\n+\n+Curves over **prime** finite fields are removed (become curves over finite fields).\n+\n+Integral curves are equipped with function fields.\n \n Comment: 1\n \n``````\n",
    "created_at": "2019-06-10T08:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541182",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+This is a subticket for #27873.
 
+Base classes for integral curves over finite fields are added.
+
+The constructor of curves is refactored to support integral curves.
+
+Curves over **prime** finite fields are removed (become curves over finite fields).
+
+Integral curves are equipped with function fields.
 
 Comment: 1
 
``````




---

archive/issue_events_069275.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27953#event-69275"
}
```



---

archive/issue_comments_541183.json:
```json
{
    "body": "<a id='comment:15'></a>Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541183",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_comments_541184.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-09T21:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541184",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_541185.json:
```json
{
    "body": "Changing dependencies from \"#27951\" to \"\"",
    "created_at": "2019-07-09T21:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541185",
    "user": "https://github.com/kwankyu"
}
```

Changing dependencies from "#27951" to ""



---

archive/issue_comments_541186.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+This is a subticket for #27873. Main things done in this ticket are:\n \n+- Base classes for integral curves over finite fields are added.\n+\n+- The constructor of curves is refactored to support integral curves.\n+\n+- Curves over **prime** finite fields are removed (become curves over finite fields).\n+\n+- Integral curves are equipped with function fields.\n \n Comment: 1\n \n``````\n",
    "created_at": "2019-07-09T21:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541186",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+This is a subticket for #27873. Main things done in this ticket are:
 
+- Base classes for integral curves over finite fields are added.
+
+- The constructor of curves is refactored to support integral curves.
+
+- Curves over **prime** finite fields are removed (become curves over finite fields).
+
+- Integral curves are equipped with function fields.
 
 Comment: 1
 
``````




---

archive/issue_comments_541187.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-16T07:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541188.json:
```json
{
    "body": "Changing commit from \"45725bbafa12b08a5e7f4de8e409266d04dc9522\" to \"f48bca3fbaf37944736a68ef8ea78b0729a08afd\"",
    "created_at": "2019-09-16T07:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "45725bbafa12b08a5e7f4de8e409266d04dc9522" to "f48bca3fbaf37944736a68ef8ea78b0729a08afd"



---

archive/issue_comments_541189.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-09-16T07:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541189",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_541190.json:
```json
{
    "body": "Changing commit from \"f48bca3fbaf37944736a68ef8ea78b0729a08afd\" to \"e3892de166cb33b5adccd35bb3cea1ce8d0f7aab\"",
    "created_at": "2019-09-16T07:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f48bca3fbaf37944736a68ef8ea78b0729a08afd" to "e3892de166cb33b5adccd35bb3cea1ce8d0f7aab"



---

archive/issue_comments_541191.json:
```json
{
    "body": "Changing commit from \"e3892de166cb33b5adccd35bb3cea1ce8d0f7aab\" to \"977ace651af9b99689f7b6507f91f8b4e2588ae9\"",
    "created_at": "2019-12-02T08:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e3892de166cb33b5adccd35bb3cea1ce8d0f7aab" to "977ace651af9b99689f7b6507f91f8b4e2588ae9"



---

archive/issue_comments_541192.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-12-02T08:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541192",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_069276.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2019-12-02T08:57:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27953#event-69276"
}
```



---

archive/issue_events_069277.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2019-12-02T08:57:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27953#event-69277"
}
```



---

archive/issue_comments_541193.json:
```json
{
    "body": "<a id='comment:22'></a>I have a few comments.\n\nThis can be simplified:\n\n```diff\n-            points = []\n-            for x in K:\n-                for y in K:\n-                    if f(x,y) == 0:\n-                        points.append(self((x,y)))\n-            points.sort()\n-            return points\n+            return sorted((self((x,y)) for x in K for y in K if f(x,y) == 0))\n```\nwhich should be faster too.\n\nIn `_nonsingular_model`, the `TESTS::` block needs to be indented.\n\nThe line `super(IntegralAffineCurve, self)._element_constructor_(x)` is missing the `return`.\n\n```diff\n-s = set([p for f in self._coordinate_functions if f for p in f.poles()])\n+s = set(p for f in self._coordinate_functions if f for p in f.poles())\n```\n(although you can just as easily combine it with the line after it.\n\nTypically we do:\n\n```\n-        OUTPUT: a list of polynomials in the coordinate ring of the ambient\n-        space of the curve this point is on.\n+        OUTPUT:\n+\n+        a list of polynomials in the coordinate ring of the ambient\n+        space of the curve this point is on\n```\nsince it is a longer description.\n\nBe careful when changing input parameter names, e.g.,{\n\n```diff\n-def affine_patch(self, i, AA=None):\n+def affine_patch(self, i, A=None):\n```\nas this is a backwards incompatible change. I would either recommend not doing it or adding a deprecation (I think there is a decorator that does this, but I don't remember what it is offhand). However, this is likely not passed as `foo.affine_patch(i, AA=bar)`, so it might not matter so much. In the `ProjectiveSpace_ring.__clascall__`, I would say that is a much more necessary change and should just be done outright.",
    "created_at": "2019-12-12T04:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541193",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>I have a few comments.

This can be simplified:

```diff
-            points = []
-            for x in K:
-                for y in K:
-                    if f(x,y) == 0:
-                        points.append(self((x,y)))
-            points.sort()
-            return points
+            return sorted((self((x,y)) for x in K for y in K if f(x,y) == 0))
```
which should be faster too.

In `_nonsingular_model`, the `TESTS::` block needs to be indented.

The line `super(IntegralAffineCurve, self)._element_constructor_(x)` is missing the `return`.

```diff
-s = set([p for f in self._coordinate_functions if f for p in f.poles()])
+s = set(p for f in self._coordinate_functions if f for p in f.poles())
```
(although you can just as easily combine it with the line after it.

Typically we do:

```
-        OUTPUT: a list of polynomials in the coordinate ring of the ambient
-        space of the curve this point is on.
+        OUTPUT:
+
+        a list of polynomials in the coordinate ring of the ambient
+        space of the curve this point is on
```
since it is a longer description.

Be careful when changing input parameter names, e.g.,{

```diff
-def affine_patch(self, i, AA=None):
+def affine_patch(self, i, A=None):
```
as this is a backwards incompatible change. I would either recommend not doing it or adding a deprecation (I think there is a decorator that does this, but I don't remember what it is offhand). However, this is likely not passed as `foo.affine_patch(i, AA=bar)`, so it might not matter so much. In the `ProjectiveSpace_ring.__clascall__`, I would say that is a much more necessary change and should just be done outright.



---

archive/issue_comments_541194.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 tscrim]:\n> I have a few comments.\n> \n> This can be simplified:\n> \n> ```diff\n> -            points = []\n> -            for x in K:\n> -                for y in K:\n> -                    if f(x,y) == 0:\n> -                        points.append(self((x,y)))\n> -            points.sort()\n> -            return points\n> +            return sorted((self((x,y)) for x in K for y in K if f(x,y) == 0))\n> ```\n> which should be faster too.\n\n\nDone. Thanks.\n\n> In `_nonsingular_model`, the `TESTS::` block needs to be indented.\n\n\nDone.\n\n> The line `super(IntegralAffineCurve, self)._element_constructor_(x)` is missing the `return`.\n\n\nThis revealed that the method `_element_constructor_` itself is not needed here. Removed.\n\n> {{{#!diff\n> -s = set([p for f in self._coordinate_functions if f for p in f.poles()])\n> +s = set(p for f in self._coordinate_functions if f for p in f.poles())\n> }}}\n> (although you can just as easily combine it with the line after it.\n\n\nDone.\n\n> Typically we do:\n> \n> ```\n> -        OUTPUT: a list of polynomials in the coordinate ring of the ambient\n> -        space of the curve this point is on.\n> +        OUTPUT:\n> +\n> +        a list of polynomials in the coordinate ring of the ambient\n> +        space of the curve this point is on\n> ```\n> since it is a longer description.\n\n\nDone. And I also touched a few other docstrings as I can spot.\n\n> Be careful when changing input parameter names, e.g.,{\n> \n> ```diff\n> -def affine_patch(self, i, AA=None):\n> +def affine_patch(self, i, A=None):\n> ```\n> as this is a backwards incompatible change. I would either recommend not doing it or adding a deprecation (I think there is a decorator that does this, but I don't remember what it is offhand). However, this is likely not passed as `foo.affine_patch(i, AA=bar)`, so it might not matter so much. In the `ProjectiveSpace_ring.__clascall__`, I would say that is a much more necessary change and should just be done outright.\n\n\nI recovered it, as I realized it means \"ambient affine\", so double A is appropriate.",
    "created_at": "2019-12-20T01:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541194",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:23'></a>Replying to [comment:22 tscrim]:
> I have a few comments.
> 
> This can be simplified:
> 
> ```diff
> -            points = []
> -            for x in K:
> -                for y in K:
> -                    if f(x,y) == 0:
> -                        points.append(self((x,y)))
> -            points.sort()
> -            return points
> +            return sorted((self((x,y)) for x in K for y in K if f(x,y) == 0))
> ```
> which should be faster too.


Done. Thanks.

> In `_nonsingular_model`, the `TESTS::` block needs to be indented.


Done.

> The line `super(IntegralAffineCurve, self)._element_constructor_(x)` is missing the `return`.


This revealed that the method `_element_constructor_` itself is not needed here. Removed.

> {{{#!diff
> -s = set([p for f in self._coordinate_functions if f for p in f.poles()])
> +s = set(p for f in self._coordinate_functions if f for p in f.poles())
> }}}
> (although you can just as easily combine it with the line after it.


Done.

> Typically we do:
> 
> ```
> -        OUTPUT: a list of polynomials in the coordinate ring of the ambient
> -        space of the curve this point is on.
> +        OUTPUT:
> +
> +        a list of polynomials in the coordinate ring of the ambient
> +        space of the curve this point is on
> ```
> since it is a longer description.


Done. And I also touched a few other docstrings as I can spot.

> Be careful when changing input parameter names, e.g.,{
> 
> ```diff
> -def affine_patch(self, i, AA=None):
> +def affine_patch(self, i, A=None):
> ```
> as this is a backwards incompatible change. I would either recommend not doing it or adding a deprecation (I think there is a decorator that does this, but I don't remember what it is offhand). However, this is likely not passed as `foo.affine_patch(i, AA=bar)`, so it might not matter so much. In the `ProjectiveSpace_ring.__clascall__`, I would say that is a much more necessary change and should just be done outright.


I recovered it, as I realized it means "ambient affine", so double A is appropriate.



---

archive/issue_comments_541195.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-20T01:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541195",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541196.json:
```json
{
    "body": "Changing commit from \"977ace651af9b99689f7b6507f91f8b4e2588ae9\" to \"78950cb43837dd66a34fa68c80a90ebdacf345ae\"",
    "created_at": "2019-12-20T01:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541196",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "977ace651af9b99689f7b6507f91f8b4e2588ae9" to "78950cb43837dd66a34fa68c80a90ebdacf345ae"



---

archive/issue_comments_541197.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-20T01:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541198.json:
```json
{
    "body": "Changing commit from \"78950cb43837dd66a34fa68c80a90ebdacf345ae\" to \"7a03541e85a8aca178b38afabede52f817890e9d\"",
    "created_at": "2019-12-20T01:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "78950cb43837dd66a34fa68c80a90ebdacf345ae" to "7a03541e85a8aca178b38afabede52f817890e9d"



---

archive/issue_comments_541199.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-20T09:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541199",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_541200.json:
```json
{
    "body": "Changing commit from \"7a03541e85a8aca178b38afabede52f817890e9d\" to \"dd842eb15a3e1c8303a58d3cd43ba19f3b66f541\"",
    "created_at": "2019-12-20T16:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541200",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7a03541e85a8aca178b38afabede52f817890e9d" to "dd842eb15a3e1c8303a58d3cd43ba19f3b66f541"



---

archive/issue_comments_541201.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-20T16:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541201",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541202.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-12-20T16:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541202",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_541203.json:
```json
{
    "body": "<a id='comment:28'></a>Now generic affine and projective curves do not assume fields as base ring.",
    "created_at": "2019-12-20T16:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541203",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:28'></a>Now generic affine and projective curves do not assume fields as base ring.



---

archive/issue_comments_541204.json:
```json
{
    "body": "Changing commit from \"dd842eb15a3e1c8303a58d3cd43ba19f3b66f541\" to \"9a0db01b614246e6c9b6d6da3197d3148d3f33fb\"",
    "created_at": "2019-12-21T02:02:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541204",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dd842eb15a3e1c8303a58d3cd43ba19f3b66f541" to "9a0db01b614246e6c9b6d6da3197d3148d3f33fb"



---

archive/issue_comments_541205.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-21T02:02:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_541206.json:
```json
{
    "body": "Changing commit from \"9a0db01b614246e6c9b6d6da3197d3148d3f33fb\" to \"dd842eb15a3e1c8303a58d3cd43ba19f3b66f541\"",
    "created_at": "2019-12-21T02:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9a0db01b614246e6c9b6d6da3197d3148d3f33fb" to "dd842eb15a3e1c8303a58d3cd43ba19f3b66f541"



---

archive/issue_comments_541207.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-12-21T02:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_541208.json:
```json
{
    "body": "<a id='comment:31'></a>There was a noise in commits, caused by my confusion. Sorry!",
    "created_at": "2019-12-21T02:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541208",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:31'></a>There was a noise in commits, caused by my confusion. Sorry!



---

archive/issue_comments_541209.json:
```json
{
    "body": "<a id='comment:32'></a>You can use `X in Fields` instead of `X in Fields()` (so it avoids creating a temporary object). Once changed, you can set a positive review.",
    "created_at": "2019-12-23T16:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541209",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'></a>You can use `X in Fields` instead of `X in Fields()` (so it avoids creating a temporary object). Once changed, you can set a positive review.



---

archive/issue_comments_541210.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2019-12-23T16:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541210",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_541211.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:32 tscrim]:\n> You can use `X in Fields` instead of `X in Fields()` (so it avoids creating a temporary object). \n\n\n`X in Fields` also works.  But as far as I know, `X in Fields()` is the documented style and more importantly\n\n```\nsage: from sage.categories.fields import Fields  \nsage: time QQ in Fields\nCPU times: user 34 \u00b5s, sys: 0 ns, total: 34 \u00b5s\nWall time: 37.2 \u00b5s\nTrue\nsage: time QQ in Fields()\nCPU times: user 13 \u00b5s, sys: 1 \u00b5s, total: 14 \u00b5s\nWall time: 16.2 \u00b5s\nTrue\nsage: type(Fields)\n<class 'sage.misc.classcall_metaclass.ClasscallMetaclass'>\nsage: type(Fields())\n<class 'sage.categories.fields.Fields_with_category'>\n```\nI would like the syntax `X in Fields` but now I got used to `X in Fields()`.",
    "created_at": "2019-12-24T00:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541211",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:33'></a>Replying to [comment:32 tscrim]:
> You can use `X in Fields` instead of `X in Fields()` (so it avoids creating a temporary object). 


`X in Fields` also works.  But as far as I know, `X in Fields()` is the documented style and more importantly

```
sage: from sage.categories.fields import Fields  
sage: time QQ in Fields
CPU times: user 34 µs, sys: 0 ns, total: 34 µs
Wall time: 37.2 µs
True
sage: time QQ in Fields()
CPU times: user 13 µs, sys: 1 µs, total: 14 µs
Wall time: 16.2 µs
True
sage: type(Fields)
<class 'sage.misc.classcall_metaclass.ClasscallMetaclass'>
sage: type(Fields())
<class 'sage.categories.fields.Fields_with_category'>
```
I would like the syntax `X in Fields` but now I got used to `X in Fields()`.



---

archive/issue_comments_541212.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-24T15:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541212",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_541213.json:
```json
{
    "body": "<a id='comment:34'></a>Hmm...curious. Using `%timeit` also yields that `X in Fields()` is faster. It probably matters more when there is a category with a base ring dependency (e.g., `Algebras(R)`) where it needs to resolve the entire category hierarchy. Anyways, positive review. Thank you.",
    "created_at": "2019-12-24T15:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541213",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>Hmm...curious. Using `%timeit` also yields that `X in Fields()` is faster. It probably matters more when there is a category with a base ring dependency (e.g., `Algebras(R)`) where it needs to resolve the entire category hierarchy. Anyways, positive review. Thank you.



---

archive/issue_comments_541214.json:
```json
{
    "body": "Changing commit from \"dd842eb15a3e1c8303a58d3cd43ba19f3b66f541\" to \"a9d0626498c1b295f16817cd26b56713eca20a19\"",
    "created_at": "2019-12-25T09:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dd842eb15a3e1c8303a58d3cd43ba19f3b66f541" to "a9d0626498c1b295f16817cd26b56713eca20a19"



---

archive/issue_comments_541215.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-12-25T09:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_541216.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2019-12-25T09:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_541217.json:
```json
{
    "body": "<a id='comment:36'></a>The last commit is to fix merge conflicts.",
    "created_at": "2019-12-25T09:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541217",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:36'></a>The last commit is to fix merge conflicts.



---

archive/issue_comments_541218.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-25T09:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541218",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_069278.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-01-01T21:01:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27953#event-69278"
}
```



---

archive/issue_events_069279.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-01-01T21:01:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27953#event-69279"
}
```



---

archive/issue_comments_541219.json:
```json
{
    "body": "<a id='comment:37'></a>9.0 is out",
    "created_at": "2020-01-01T21:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541219",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'></a>9.0 is out



---

archive/issue_comments_541220.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-05T15:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541220",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069280.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-05T15:47:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27953#event-69280"
}
```



---

archive/issue_comments_541221.json:
```json
{
    "body": "Changing branch from \"u/klee/27953\" to \"a9d0626498c1b295f16817cd26b56713eca20a19\"",
    "created_at": "2020-01-05T15:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27953#issuecomment-541221",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/klee/27953" to "a9d0626498c1b295f16817cd26b56713eca20a19"
