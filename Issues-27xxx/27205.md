# Issue 27205: Don't ignore "pkg-config --libs-only-other" when building sagelib; and fix linbox.pc

archive/issues_026968.json:
```json
{
    "assignees": [],
    "body": "When sage uses pkgconfig to determine compile flags, for example in `src/module_list.py` and `src/sage/env.py` it only extracts the \"libraries\" but not the \"libs\" field from pkg-config. In the case of fflas-ffpack this field (as well as cflags) contains `-fopenmp`. So sage builds but does not link with this flag which leads to missing symbols on Ubuntu:\n\n```\nImportError: /<<PKGBUILDDIR>>/debian/build/usr/lib/python2.7/dist-packages/sage/matrix/matrix_modn_sparse.so: undefined symbol: GOMP_loop_ull_runtime_start\n```\n\nThis was mentioned in https://bugs.debian.org/919573 .\n\nTo reproduce:\n\n```\n  tox -e docker-debian-bullseye-standard\n```\nThe resulting sage crashes on startup with the above error.\n\nApplying the Debian patch reveals another Sage bug:\n\n```\n$ pkg-config --libs linbox\n-L/sage/local/lib -llinbox @LINBOXSAGE_LIBS@ -lntl -lmpfr -liml -lflint -fopenmp -lblas -llapack -lgivaro -lgmp -lgmpxx\n```\nThis is linbox upstream issue https://github.com/linbox-team/linbox/pull/170\n\nThis ticket fixes both.\n\n\nCC:  @kiwifb @ClementPernet @antonio-rojas @dimpase @mkoeppe @isuruf @vbraun\n\nBranch: **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Tobias Hansen, Matthias Koeppe**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27205_\n\n",
    "closed_at": "2020-04-23T22:33:30Z",
    "created_at": "2019-02-02T13:31:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Don't ignore \"pkg-config --libs-only-other\" when building sagelib; and fix linbox.pc",
    "type": "issue",
    "updated_at": "2020-04-24T14:09:43Z",
    "url": "https://github.com/sagemath/sage/issues/27205",
    "user": "https://github.com/tobihan"
}
```
When sage uses pkgconfig to determine compile flags, for example in `src/module_list.py` and `src/sage/env.py` it only extracts the "libraries" but not the "libs" field from pkg-config. In the case of fflas-ffpack this field (as well as cflags) contains `-fopenmp`. So sage builds but does not link with this flag which leads to missing symbols on Ubuntu:

```
ImportError: /<<PKGBUILDDIR>>/debian/build/usr/lib/python2.7/dist-packages/sage/matrix/matrix_modn_sparse.so: undefined symbol: GOMP_loop_ull_runtime_start
```

This was mentioned in https://bugs.debian.org/919573 .

To reproduce:

```
  tox -e docker-debian-bullseye-standard
```
The resulting sage crashes on startup with the above error.

Applying the Debian patch reveals another Sage bug:

```
$ pkg-config --libs linbox
-L/sage/local/lib -llinbox @LINBOXSAGE_LIBS@ -lntl -lmpfr -liml -lflint -fopenmp -lblas -llapack -lgivaro -lgmp -lgmpxx
```
This is linbox upstream issue https://github.com/linbox-team/linbox/pull/170

This ticket fixes both.


CC:  @kiwifb @ClementPernet @antonio-rojas @dimpase @mkoeppe @isuruf @vbraun

Branch: **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)**

Reviewer: **Dima Pasechnik**

Author: **Tobias Hansen, Matthias Koeppe**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/27205_





---

archive/issue_events_373775.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2019-02-02T13:31:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373775"
}
```



---

archive/issue_events_373776.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2019-02-02T13:31:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373776"
}
```



---

archive/issue_events_373777.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2019-02-02T13:31:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373777"
}
```



---

archive/issue_events_373778.json:
```json
{
    "actor": "https://github.com/tobihan",
    "created_at": "2019-02-02T13:31:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373778"
}
```



---

archive/issue_comments_420023.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI think we are either misusing `pkgconfig` or there is something wrong with `pkgconfig` upstream.",
    "created_at": "2019-02-03T11:46:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420023",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

I think we are either misusing `pkgconfig` or there is something wrong with `pkgconfig` upstream.



---

archive/issue_comments_420024.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n`pkg-config --libs` or `pkgconfig.libs(pkg)` in Python gives the LDFLAGS required for the package. According to the manpage of pkg-config this splits into `pkg-config --libs-only-l`, `pkg-config --libs-only-L` and `pkg-config --libs-only-other`. \n\nWhat sage does is to get `pkg-config --libs-only-l`, `pkg-config --libs-only-L` by means of `pkgconfig.parse(pkg)['libraries']` and `pkgconfig.parse(pkg)['library_dirs']`, missing the content of `pkg-config --libs-only-other`.",
    "created_at": "2019-02-03T12:05:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420024",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:2" align="right">comment:2</div>

`pkg-config --libs` or `pkgconfig.libs(pkg)` in Python gives the LDFLAGS required for the package. According to the manpage of pkg-config this splits into `pkg-config --libs-only-l`, `pkg-config --libs-only-L` and `pkg-config --libs-only-other`. 

What sage does is to get `pkg-config --libs-only-l`, `pkg-config --libs-only-L` by means of `pkgconfig.parse(pkg)['libraries']` and `pkgconfig.parse(pkg)['library_dirs']`, missing the content of `pkg-config --libs-only-other`.



---

archive/issue_comments_420025.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere is `extra_link_args` to specify the remaining LDFLAGS in distutils extensions.",
    "created_at": "2019-02-05T15:10:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420025",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:3" align="right">comment:3</div>

There is `extra_link_args` to specify the remaining LDFLAGS in distutils extensions.



---

archive/issue_comments_420026.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI created this patch which takes care of the extra flags only for linbox and fflas-ffpack for now:\n\nhttps://salsa.debian.org/science-team/sagemath/blob/master/debian/patches/u1-pkgconfig-extra-link-flags.patch\n\nTo apply it here, should I do the same for all modules that use pkgconfig in env.py and module_list.py?",
    "created_at": "2019-02-06T10:56:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420026",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:4" align="right">comment:4</div>

I created this patch which takes care of the extra flags only for linbox and fflas-ffpack for now:

https://salsa.debian.org/science-team/sagemath/blob/master/debian/patches/u1-pkgconfig-extra-link-flags.patch

To apply it here, should I do the same for all modules that use pkgconfig in env.py and module_list.py?



---

archive/issue_comments_420027.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nClearly an oversight on my part when I last updated that pkg-config bit. I didn't know about `--libs-only-other` and thought we would get something like `-fopenmp` from `cflags`. I see `pkgconfig` (the python binding) had a few new releases since I last updated it, but nothing that would help.\n\nI think we should make a feature request for upstream `pkgconfig` so we can simplify the stuff in your patch. Did you make one? \n\nFor the case at hand here in Gentoo I don't have any problems with linking. I am guessing this is because `libgomp` is in the `NEEDED` list of `libfflas`. I am more concerned that `-fopenmp` in not in `CFLAGS` where it could have an impact on section of headers being used. At linking it only bring the openmp runtime (libgomp when using gcc) which feels a little bit too late and is only interesting if you have a direct use of openmp symbol or indirect but unresolved ones (which is not the case for me here).",
    "created_at": "2019-02-06T22:03:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420027",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:6" align="right">comment:6</div>

Clearly an oversight on my part when I last updated that pkg-config bit. I didn't know about `--libs-only-other` and thought we would get something like `-fopenmp` from `cflags`. I see `pkgconfig` (the python binding) had a few new releases since I last updated it, but nothing that would help.

I think we should make a feature request for upstream `pkgconfig` so we can simplify the stuff in your patch. Did you make one? 

For the case at hand here in Gentoo I don't have any problems with linking. I am guessing this is because `libgomp` is in the `NEEDED` list of `libfflas`. I am more concerned that `-fopenmp` in not in `CFLAGS` where it could have an impact on section of headers being used. At linking it only bring the openmp runtime (libgomp when using gcc) which feels a little bit too late and is only interesting if you have a direct use of openmp symbol or indirect but unresolved ones (which is not the case for me here).



---

archive/issue_comments_420028.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI have opened https://github.com/matze/pkgconfig/issues/38 for upstream pkgconfig to help deal with this issue. Of course in the meantime the debian patch is OK.",
    "created_at": "2019-02-06T22:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420028",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:7" align="right">comment:7</div>

I have opened https://github.com/matze/pkgconfig/issues/38 for upstream pkgconfig to help deal with this issue. Of course in the meantime the debian patch is OK.



---

archive/issue_comments_420029.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThanks. On Debian `-fopenmp` *is* in the cflags of linbox and fflas-ffpack. That's precisely why this was discovered: If you build with this flag you also need to link with it. The build failed on Ubuntu with a missing symbol from libgomp. For some reason that I don't know the build didn't fail on Debian.",
    "created_at": "2019-02-07T00:14:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420029",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:8" align="right">comment:8</div>

Thanks. On Debian `-fopenmp` *is* in the cflags of linbox and fflas-ffpack. That's precisely why this was discovered: If you build with this flag you also need to link with it. The build failed on Ubuntu with a missing symbol from libgomp. For some reason that I don't know the build didn't fail on Debian.



---

archive/issue_comments_420030.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nWell, I have been giving this some thoughts and I have come to the conclusion that you cannot have that problem unless either `libfflas.so` or `libffpack.so` is underlinked relative to `libgomp`. linbox, while it does have a openmp configure option, doesn't link to the openmp runtime as far as I can see. So the trouble come from fflas-ffpack.",
    "created_at": "2019-02-07T00:21:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420030",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

Well, I have been giving this some thoughts and I have come to the conclusion that you cannot have that problem unless either `libfflas.so` or `libffpack.so` is underlinked relative to `libgomp`. linbox, while it does have a openmp configure option, doesn't link to the openmp runtime as far as I can see. So the trouble come from fflas-ffpack.



---

archive/issue_comments_420031.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAfter closer inspection it could also happen if you use openblas compiled with openmp and it is underlinked. I guess that's another possibility, and in that case adding fflas-ffpack's flag to fix it, is just accidental.",
    "created_at": "2019-02-07T00:29:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420031",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

After closer inspection it could also happen if you use openblas compiled with openmp and it is underlinked. I guess that's another possibility, and in that case adding fflas-ffpack's flag to fix it, is just accidental.



---

archive/issue_comments_420032.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420032",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_373779.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373779"
}
```



---

archive/issue_events_373780.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373780"
}
```



---

archive/issue_events_373781.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:54:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373781"
}
```



---

archive/issue_comments_420033.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420033",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">comment:13</div>

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_420034.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI have also been seeing problems like this on Cygwin lately, though I'm not sure where it began.\n\nI've been compiling fflas-ffpack with `FFLAS_FFPACK_CONFIGURE=--disable-openmp`.",
    "created_at": "2019-11-13T13:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420034",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

I have also been seeing problems like this on Cygwin lately, though I'm not sure where it began.

I've been compiling fflas-ffpack with `FFLAS_FFPACK_CONFIGURE=--disable-openmp`.



---

archive/issue_events_373782.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T07:21:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373782"
}
```



---

archive/issue_comments_420035.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI think this is showing up in https://github.com/mkoeppe/sage/runs/581024689?check_suite_focus=true too",
    "created_at": "2020-04-14T07:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420035",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

I think this is showing up in https://github.com/mkoeppe/sage/runs/581024689?check_suite_focus=true too



---

archive/issue_events_373783.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-15T14:40:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373783"
}
```



---

archive/issue_events_373784.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-15T14:40:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373784"
}
```



---

archive/issue_comments_420036.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nthis seems to be related to OpenMP:\n\n```\n2020-04-12T20:04:09.1360983Z   [dochtml]   ImportError: /sage/local/lib/python3.7/site-packages/sage/matrix/matrix_modn_sparse.cpython-37m-x86_64-linux-gnu.so: undefined symbol: GOMP_loop_ull_maybe_nonmonotonic_runtime_next\n```",
    "created_at": "2020-04-15T17:10:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420036",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

this seems to be related to OpenMP:

```
2020-04-12T20:04:09.1360983Z   [dochtml]   ImportError: /sage/local/lib/python3.7/site-packages/sage/matrix/matrix_modn_sparse.cpython-37m-x86_64-linux-gnu.so: undefined symbol: GOMP_loop_ull_maybe_nonmonotonic_runtime_next
```



---

archive/issue_comments_420037.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nLooks like fflas-ffpack have openmp pragmas on their header files. Sage should detect whether `__FFLASFFPACK_USE_OPENMP` is defined in `spkg-configure.m4` and add `-fopenmp` to `extra_link_args` until the `pkgconfig` issue is fixed",
    "created_at": "2020-04-15T22:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420037",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:20" align="right">comment:20</div>

Looks like fflas-ffpack have openmp pragmas on their header files. Sage should detect whether `__FFLASFFPACK_USE_OPENMP` is defined in `spkg-configure.m4` and add `-fopenmp` to `extra_link_args` until the `pkgconfig` issue is fixed



---

archive/issue_events_373785.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-17T00:31:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "title_is": "Sage ignores libs from pkgconfig; also linbox.pc broken by a Sage patch",
    "title_was": "Sage ignores libs from pkgconfig",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373785"
}
```



---

archive/issue_comments_420038.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,19 @@\n ```\n \n This was mentioned in https://bugs.debian.org/919573 .\n+\n+To reproduce:\n+\n+```\n+  tox -e docker-debian-bullseye-standard\n+```\n+The resulting sage crashes on startup with the above error.\n+\n+Applying the Debian patch reveals another Sage bug:\n+\n+```\n+$ pkg-config --libs linbox\n+-L/sage/local/lib -llinbox @LINBOXSAGE_LIBS@ -lntl -lmpfr -liml -lflint -fopenmp -lblas -llapack -lgivaro -lgmp -lgmpxx\n+```\n+\n+\n``````\n",
    "created_at": "2020-04-17T00:31:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420038",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,19 @@
 ```
 
 This was mentioned in https://bugs.debian.org/919573 .
+
+To reproduce:
+
+```
+  tox -e docker-debian-bullseye-standard
+```
+The resulting sage crashes on startup with the above error.
+
+Applying the Debian patch reveals another Sage bug:
+
+```
+$ pkg-config --libs linbox
+-L/sage/local/lib -llinbox @LINBOXSAGE_LIBS@ -lntl -lmpfr -liml -lflint -fopenmp -lblas -llapack -lgivaro -lgmp -lgmpxx
+```
+
+
``````




---

archive/issue_comments_420039.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,5 +19,5 @@\n $ pkg-config --libs linbox\n -L/sage/local/lib -llinbox @LINBOXSAGE_LIBS@ -lntl -lmpfr -liml -lflint -fopenmp -lblas -llapack -lgivaro -lgmp -lgmpxx\n ```\n+This is linbox upstream issue https://github.com/linbox-team/linbox/pull/170\n \n-\n``````\n",
    "created_at": "2020-04-17T01:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420039",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,5 +19,5 @@
 $ pkg-config --libs linbox
 -L/sage/local/lib -llinbox @LINBOXSAGE_LIBS@ -lntl -lmpfr -liml -lflint -fopenmp -lblas -llapack -lgivaro -lgmp -lgmpxx
 ```
+This is linbox upstream issue https://github.com/linbox-team/linbox/pull/170
 
-
``````




---

archive/issue_comments_420040.json:
```json
{
    "body": "Branch: **[u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch)**",
    "created_at": "2020-04-17T01:16:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420040",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch)**



---

archive/issue_comments_420041.json:
```json
{
    "body": "Commit: **[`257f057`](https://github.com/sagemath/sagetrac-mirror/commit/257f0572b74fa06f8dc05cfe00db582e785fdd5c)**",
    "created_at": "2020-04-17T01:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420041",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`257f057`](https://github.com/sagemath/sagetrac-mirror/commit/257f0572b74fa06f8dc05cfe00db582e785fdd5c)**



---

archive/issue_events_373786.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-17T01:21:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "title_is": "Pass \"pkg-config --libs-only-other\" and fix linbox.pc",
    "title_was": "Sage ignores libs from pkgconfig; also linbox.pc broken by a Sage patch",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373786"
}
```



---

archive/issue_comments_420042.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5ccfc84215acfb8d190e247b52b4d5fa5e8ba59\">f5ccfc8</a></td><td><code>Also use LDFLAGS from pkg-config that are not -l or -L</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/257f0572b74fa06f8dc05cfe00db582e785fdd5c\">257f057</a></td><td><code>Add linbox patch</code></td></tr></table>\n",
    "created_at": "2020-04-17T01:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420042",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5ccfc84215acfb8d190e247b52b4d5fa5e8ba59">f5ccfc8</a></td><td><code>Also use LDFLAGS from pkg-config that are not -l or -L</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/257f0572b74fa06f8dc05cfe00db582e785fdd5c">257f057</a></td><td><code>Add linbox patch</code></td></tr></table>




---

archive/issue_comments_420043.json:
```json
{
    "body": "Author: **Tobias Hansen, Matthias Koeppe**",
    "created_at": "2020-04-17T01:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420043",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Tobias Hansen, Matthias Koeppe**



---

archive/issue_events_373787.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-17T01:22:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "title_is": "Don't ignore \"pkg-config --libs-only-other\" when building sagelib; and fix linbox.pc",
    "title_was": "Pass \"pkg-config --libs-only-other\" and fix linbox.pc",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373787"
}
```



---

archive/issue_comments_420044.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79a6577366bade22b96acddf4d2ec58772dad385\">79a6577</a></td><td><code>backport patch</code></td></tr></table>\n",
    "created_at": "2020-04-17T03:05:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420044",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79a6577366bade22b96acddf4d2ec58772dad385">79a6577</a></td><td><code>backport patch</code></td></tr></table>




---

archive/issue_comments_420045.json:
```json
{
    "body": "Changed commit from **[`257f057`](https://github.com/sagemath/sagetrac-mirror/commit/257f0572b74fa06f8dc05cfe00db582e785fdd5c)** to **[`79a6577`](https://github.com/sagemath/sagetrac-mirror/commit/79a6577366bade22b96acddf4d2ec58772dad385)**",
    "created_at": "2020-04-17T03:05:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420045",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`257f057`](https://github.com/sagemath/sagetrac-mirror/commit/257f0572b74fa06f8dc05cfe00db582e785fdd5c)** to **[`79a6577`](https://github.com/sagemath/sagetrac-mirror/commit/79a6577366bade22b96acddf4d2ec58772dad385)**



---

archive/issue_comments_420046.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,5 @@\n ```\n This is linbox upstream issue https://github.com/linbox-team/linbox/pull/170\n \n+This ticket fixes both.\n+\n``````\n",
    "created_at": "2020-04-17T04:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420046",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,5 @@
 ```
 This is linbox upstream issue https://github.com/linbox-team/linbox/pull/170
 
+This ticket fixes both.
+
``````




---

archive/issue_comments_420047.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nFixes the problem on `debian-bullseye-standard`.",
    "created_at": "2020-04-17T04:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420047",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Fixes the problem on `debian-bullseye-standard`.



---

archive/issue_events_373788.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-17T04:32:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373788"
}
```



---

archive/issue_comments_420048.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\ngood catch. needs testing.\n\nby the way, is there a ticket to make gh action testing doable from CLI?",
    "created_at": "2020-04-17T08:28:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420048",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

good catch. needs testing.

by the way, is there a ticket to make gh action testing doable from CLI?



---

archive/issue_comments_420049.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nTests running at https://github.com/mkoeppe/sage/actions/runs/80516747",
    "created_at": "2020-04-17T15:59:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420049",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Tests running at https://github.com/mkoeppe/sage/actions/runs/80516747



---

archive/issue_comments_420050.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@dimpase](#comment:28):\n> by the way, is there a ticket to make gh action testing doable from CLI?\n\nNo ticket; but from a comment in #29087:\n`gh pr create -f -d` would be a command line interface to trigger the GH actions run. \u200bhttps://cli.github.com/manual/gh_pr_create",
    "created_at": "2020-04-17T16:03:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420050",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@dimpase](#comment:28):
> by the way, is there a ticket to make gh action testing doable from CLI?

No ticket; but from a comment in #29087:
`gh pr create -f -d` would be a command line interface to trigger the GH actions run. â€‹https://cli.github.com/manual/gh_pr_create



---

archive/issue_comments_420051.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe tests are ready; needs review",
    "created_at": "2020-04-18T04:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420051",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

The tests are ready; needs review



---

archive/issue_comments_420052.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nLet's get this into 9.1 please...",
    "created_at": "2020-04-18T16:05:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420052",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Let's get this into 9.1 please...



---

archive/issue_comments_420053.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nlgtm, thanks.",
    "created_at": "2020-04-18T16:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420053",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:33" align="right">comment:33</div>

lgtm, thanks.



---

archive/issue_comments_420054.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-04-18T16:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420054",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_373789.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-18T16:16:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373789"
}
```



---

archive/issue_events_373790.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-18T16:16:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373790"
}
```



---

archive/issue_comments_420055.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThanks!",
    "created_at": "2020-04-18T18:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420055",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Thanks!



---

archive/issue_events_373791.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-20T22:22:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373791"
}
```



---

archive/issue_events_373792.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-20T22:22:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373792"
}
```



---

archive/issue_comments_420056.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nSee patchbot:\n\n```\n[sagelib-9.1.rc0] g++: error: LINBOXSAGE_LIBS@: No such file or directory\n```",
    "created_at": "2020-04-20T22:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420056",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:35" align="right">comment:35</div>

See patchbot:

```
[sagelib-9.1.rc0] g++: error: LINBOXSAGE_LIBS@: No such file or directory
```



---

archive/issue_comments_420057.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nShould have bumped the patch level",
    "created_at": "2020-04-20T22:54:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420057",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

Should have bumped the patch level



---

archive/issue_comments_420058.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26\">d678f78</a></td><td><code>build/pkgs/linbox/package-version.txt: Bump up the patchlevel so that incremental builds of sagelib do not fail</code></td></tr></table>\n",
    "created_at": "2020-04-20T22:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420058",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26">d678f78</a></td><td><code>build/pkgs/linbox/package-version.txt: Bump up the patchlevel so that incremental builds of sagelib do not fail</code></td></tr></table>




---

archive/issue_comments_420059.json:
```json
{
    "body": "Changed commit from **[`79a6577`](https://github.com/sagemath/sagetrac-mirror/commit/79a6577366bade22b96acddf4d2ec58772dad385)** to **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)**",
    "created_at": "2020-04-20T22:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420059",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`79a6577`](https://github.com/sagemath/sagetrac-mirror/commit/79a6577366bade22b96acddf4d2ec58772dad385)** to **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)**



---

archive/issue_events_373793.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-20T22:56:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373793"
}
```



---

archive/issue_events_373794.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-20T22:56:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373794"
}
```



---

archive/issue_events_373795.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-23T22:33:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373795"
}
```



---

archive/issue_events_373796.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e40cbb5e55cc7a1bcd0e8627c1f226a2c5f7cd84",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-04-23T22:33:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27205#event-373796"
}
```



---

archive/issue_comments_420060.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch)** to **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)**",
    "created_at": "2020-04-23T22:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420060",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_ignores_libs_from_pkgconfig__also_linbox_pc_broken_by_a_sage_patch)** to **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)**



---

archive/issue_comments_420061.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nDoes this ticket fix the following error when building the documentation?\n\n```\n [dochtml] installing. Log file: logs/dochtml.log\n  [dochtml] error installing, exit status 1. End of log file:\n  [dochtml]   Traceback (most recent call last):\n  [dochtml]     File \"/sage/local/lib/python3.7/runpy.py\", line 183, in _run_module_as_main\n  [dochtml]       mod_name, mod_spec, code = _get_module_details(mod_name, _Error)\n  [dochtml]     File \"/sage/local/lib/python3.7/runpy.py\", line 142, in _get_module_details\n  [dochtml]       return _get_module_details(pkg_main_name, error)\n  [dochtml]     File \"/sage/local/lib/python3.7/runpy.py\", line 109, in _get_module_details\n  [dochtml]       __import__(pkg_name)\n  [dochtml]     File \"/sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 59, in <module>\n  [dochtml]       import sage.all\n  [dochtml]     File \"/sage/local/lib/python3.7/site-packages/sage/all.py\", line 132, in <module>\n  [dochtml]       from sage.matrix.all     import *\n  [dochtml]     File \"/sage/local/lib/python3.7/site-packages/sage/matrix/__init__.py\", line 2, in <module>\n  [dochtml]       import sage.matrix.args\n  [dochtml]     File \"sage/matrix/args.pyx\", line 23, in init sage.matrix.args (build/cythonized/sage/matrix/args.c:21217)\n  [dochtml]     File \"/sage/local/lib/python3.7/site-packages/sage/matrix/matrix_space.py\", line 46, in <module>\n  [dochtml]       from . import matrix_modn_sparse\n  [dochtml]   ImportError: /sage/local/lib/python3.7/site-packages/sage/matrix/matrix_modn_sparse.cpython-37m-x86_64-linux-gnu.so: undefined symbol: GOMP_loop_ull_maybe_nonmonotonic_runtime_next\n  [dochtml] Full log file: logs/dochtml.log\n```\n\nE.g. on ubuntu-focal or debian bullseye: [https://github.com/mkoeppe/sage/runs/610674634](https://github.com/mkoeppe/sage/runs/610674634)\n\nThis is a new bug that appears to have been introduced in 9.1.rc1.",
    "created_at": "2020-04-24T05:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420061",
    "user": "https://github.com/kliem"
}
```

<div id="comment:40" align="right">comment:40</div>

Does this ticket fix the following error when building the documentation?

```
 [dochtml] installing. Log file: logs/dochtml.log
  [dochtml] error installing, exit status 1. End of log file:
  [dochtml]   Traceback (most recent call last):
  [dochtml]     File "/sage/local/lib/python3.7/runpy.py", line 183, in _run_module_as_main
  [dochtml]       mod_name, mod_spec, code = _get_module_details(mod_name, _Error)
  [dochtml]     File "/sage/local/lib/python3.7/runpy.py", line 142, in _get_module_details
  [dochtml]       return _get_module_details(pkg_main_name, error)
  [dochtml]     File "/sage/local/lib/python3.7/runpy.py", line 109, in _get_module_details
  [dochtml]       __import__(pkg_name)
  [dochtml]     File "/sage/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 59, in <module>
  [dochtml]       import sage.all
  [dochtml]     File "/sage/local/lib/python3.7/site-packages/sage/all.py", line 132, in <module>
  [dochtml]       from sage.matrix.all     import *
  [dochtml]     File "/sage/local/lib/python3.7/site-packages/sage/matrix/__init__.py", line 2, in <module>
  [dochtml]       import sage.matrix.args
  [dochtml]     File "sage/matrix/args.pyx", line 23, in init sage.matrix.args (build/cythonized/sage/matrix/args.c:21217)
  [dochtml]     File "/sage/local/lib/python3.7/site-packages/sage/matrix/matrix_space.py", line 46, in <module>
  [dochtml]       from . import matrix_modn_sparse
  [dochtml]   ImportError: /sage/local/lib/python3.7/site-packages/sage/matrix/matrix_modn_sparse.cpython-37m-x86_64-linux-gnu.so: undefined symbol: GOMP_loop_ull_maybe_nonmonotonic_runtime_next
  [dochtml] Full log file: logs/dochtml.log
```

E.g. on ubuntu-focal or debian bullseye: [https://github.com/mkoeppe/sage/runs/610674634](https://github.com/mkoeppe/sage/runs/610674634)

This is a new bug that appears to have been introduced in 9.1.rc1.



---

archive/issue_comments_420062.json:
```json
{
    "body": "Changed commit from **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)** to none",
    "created_at": "2020-04-24T05:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420062",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[`d678f78`](https://github.com/sagemath/sagetrac-mirror/commit/d678f78a41dc5f75c7166678c79e1640b5941b26)** to none



---

archive/issue_comments_420063.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nYes, this ticket fixes this bug.",
    "created_at": "2020-04-24T14:09:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27205#issuecomment-420063",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

Yes, this ticket fixes this bug.
