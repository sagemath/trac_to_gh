# Issue 27692: py3: fix src/sage/misc/nested_class.pyx

archive/issues_027455.json:
```json
{
    "assignees": [],
    "body": "traceback:\n\n```\nsage -t --long src/sage/misc/nested_class.pyx\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 39, in sage.misc.nested_class\nFailed example:\n    A1.A2.A3\nExpected:\n    <class sage.misc.nested_class.A3 at ...>\nGot:\n    <class 'sage.misc.nested_class.A1.A2.A3'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 42, in sage.misc.nested_class\nFailed example:\n    nested_pickle(A1)\nExpected:\n    <class sage.misc.nested_class.A1 at ...>\nGot:\n    <class 'sage.misc.nested_class.A1'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 45, in sage.misc.nested_class\nFailed example:\n    A1.A2\nExpected:\n    <class sage.misc.nested_class.A1.A2 at ...>\nGot:\n    <class 'sage.misc.nested_class.A1.A2'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 48, in sage.misc.nested_class\nFailed example:\n    A1.A2.A3\nExpected:\n    <class sage.misc.nested_class.A1.A2.A3 at ...>\nGot:\n    <class 'sage.misc.nested_class.A1.A2.A3'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 131, in sage.misc.nested_class.modify_for_nested_pickle\nFailed example:\n    getattr(module, 'A.B', 'Not found')\nExpected:\n    <class '__main__.X.A.B'>\nGot:\n    <class '__main__.A.B'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 133, in sage.misc.nested_class.modify_for_nested_pickle\nFailed example:\n    getattr(module, 'X.A.B', 'Not found')\nExpected:\n    <class '__main__.X.A.B'>\nGot:\n    <class '__main__.A.B'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 219, in sage.misc.nested_class.nested_pickle\nFailed example:\n    getattr(module, 'A.B', 'Not found')\nExpected:\n    <class __main__.A.B at ...>\nGot:\n    <class '__main__.A.B'>\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 259, in sage.misc.nested_class.NestedClassMetaclass\nFailed example:\n    A3.B.__name__\nExpected:\n    'A3.B'\nGot:\n    'B'\n**********************************************************************\nFile \"src/sage/misc/nested_class.pyx\", line 261, in sage.misc.nested_class.NestedClassMetaclass\nFailed example:\n    getattr(sys.modules['__main__'], 'A3.B', 'Not found')\nExpected:\n    <class '__main__.A3.B'>\nGot:\n    'Not found'\n**********************************************************************\n4 items had failures:\n   4 of  14 in sage.misc.nested_class\n   2 of   6 in sage.misc.nested_class.NestedClassMetaclass\n   2 of  23 in sage.misc.nested_class.modify_for_nested_pickle\n   1 of   9 in sage.misc.nested_class.nested_pickle\n    [68 tests, 9 failures, 1.77 s]\n\n```\n\nAssignee: **@embray**\n\nCC:  @embray @jdemeyer @kiwifb\n\nBranch/Commit: **[562ff1e](https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, John Palmieri**\n\nAuthor: **Erik Bray, Kwankyu Lee**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27692_\n\n",
    "closed_at": "2019-08-01T22:55:00Z",
    "created_at": "2019-04-17T16:30:07Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: fix src/sage/misc/nested_class.pyx",
    "type": "issue",
    "updated_at": "2019-08-01T22:55:00Z",
    "url": "https://github.com/sagemath/sage/issues/27692",
    "user": "https://github.com/fchapoton"
}
```
traceback:

```
sage -t --long src/sage/misc/nested_class.pyx
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 39, in sage.misc.nested_class
Failed example:
    A1.A2.A3
Expected:
    <class sage.misc.nested_class.A3 at ...>
Got:
    <class 'sage.misc.nested_class.A1.A2.A3'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 42, in sage.misc.nested_class
Failed example:
    nested_pickle(A1)
Expected:
    <class sage.misc.nested_class.A1 at ...>
Got:
    <class 'sage.misc.nested_class.A1'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 45, in sage.misc.nested_class
Failed example:
    A1.A2
Expected:
    <class sage.misc.nested_class.A1.A2 at ...>
Got:
    <class 'sage.misc.nested_class.A1.A2'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 48, in sage.misc.nested_class
Failed example:
    A1.A2.A3
Expected:
    <class sage.misc.nested_class.A1.A2.A3 at ...>
Got:
    <class 'sage.misc.nested_class.A1.A2.A3'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 131, in sage.misc.nested_class.modify_for_nested_pickle
Failed example:
    getattr(module, 'A.B', 'Not found')
Expected:
    <class '__main__.X.A.B'>
Got:
    <class '__main__.A.B'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 133, in sage.misc.nested_class.modify_for_nested_pickle
Failed example:
    getattr(module, 'X.A.B', 'Not found')
Expected:
    <class '__main__.X.A.B'>
Got:
    <class '__main__.A.B'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 219, in sage.misc.nested_class.nested_pickle
Failed example:
    getattr(module, 'A.B', 'Not found')
Expected:
    <class __main__.A.B at ...>
Got:
    <class '__main__.A.B'>
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 259, in sage.misc.nested_class.NestedClassMetaclass
Failed example:
    A3.B.__name__
Expected:
    'A3.B'
Got:
    'B'
**********************************************************************
File "src/sage/misc/nested_class.pyx", line 261, in sage.misc.nested_class.NestedClassMetaclass
Failed example:
    getattr(sys.modules['__main__'], 'A3.B', 'Not found')
Expected:
    <class '__main__.A3.B'>
Got:
    'Not found'
**********************************************************************
4 items had failures:
   4 of  14 in sage.misc.nested_class
   2 of   6 in sage.misc.nested_class.NestedClassMetaclass
   2 of  23 in sage.misc.nested_class.modify_for_nested_pickle
   1 of   9 in sage.misc.nested_class.nested_pickle
    [68 tests, 9 failures, 1.77 s]

```

Assignee: **@embray**

CC:  @embray @jdemeyer @kiwifb

Branch/Commit: **[562ff1e](https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2)**

Reviewer: **Frédéric Chapoton, John Palmieri**

Author: **Erik Bray, Kwankyu Lee**

_Issue created by migration from https://trac.sagemath.org/ticket/27692_





---

archive/issue_events_361755.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-17T16:30:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361755"
}
```



---

archive/issue_events_361756.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-17T16:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361756"
}
```



---

archive/issue_events_361757.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-17T16:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361757"
}
```



---

archive/issue_comments_432094.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nTo get the same repr for a class (without \"at ...\") in both Py2 and Py3, it may be as simple as defining the classes with `class A(object):`. It looks like the difference in printing is between old-style and new-style classes, and python3 has only new style classes. So, including the `(object)` brings the example in Py2 closer to what it does in Py3.\n\nThe problem with \"name\" might need more work.",
    "created_at": "2019-04-17T19:09:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432094",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:1" align="right">Comment 1</div>

To get the same repr for a class (without "at ...") in both Py2 and Py3, it may be as simple as defining the classes with `class A(object):`. It looks like the difference in printing is between old-style and new-style classes, and python3 has only new style classes. So, including the `(object)` brings the example in Py2 closer to what it does in Py3.

The problem with "name" might need more work.



---

archive/issue_comments_432095.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nAt some point I definitely fixed or changed something related to this but I'm wracking my brain to remember where.",
    "created_at": "2019-04-19T17:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432095",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">Comment 2</div>

At some point I definitely fixed or changed something related to this but I'm wracking my brain to remember where.



---

archive/issue_comments_432096.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nIIRC one of the main issues here is that I (?) fixed pickling of nested classes such that `NestedClassMetaclass` is all but unnecessary.  But I might have dreamed it; it's all a bit foggy.",
    "created_at": "2019-04-19T17:19:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432096",
    "user": "https://github.com/embray"
}
```

<div id="comment:3" align="right">Comment 3</div>

IIRC one of the main issues here is that I (?) fixed pickling of nested classes such that `NestedClassMetaclass` is all but unnecessary.  But I might have dreamed it; it's all a bit foggy.



---

archive/issue_comments_432097.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nHere it is--it turns out that the issue this is trying to work around just isn't relevant on Python 3, so it makes `NestedClassMetaclass` a no-op to be removed whenever we drop Python 2 support.\n\n```diff\ndiff --git a/src/sage/misc/nested_class.pyx b/src/sage/misc/nested_class.pyx\nindex 3cd3dfc..cf9c352 100644\n--- a/src/sage/misc/nested_class.pyx\n+++ b/src/sage/misc/nested_class.pyx\n@@ -36,23 +36,27 @@ EXAMPLES::\n\n     sage: A1.A2.A3.__name__\n     'A3'\n-    sage: A1.A2.A3\n+    sage: A1.A2.A3  # py2\n     <class sage.misc.nested_class.A3 at ...>\n\n-    sage: nested_pickle(A1)\n+    sage: nested_pickle(A1)  # py2\n     <class sage.misc.nested_class.A1 at ...>\n\n-    sage: A1.A2\n+    sage: A1.A2  # py2\n     <class sage.misc.nested_class.A1.A2 at ...>\n+    sage: A1.A2  # py3 - note: here we have he desired name for free\n+    <class 'sage.misc.nested_class.A1.A2'>\n\n-    sage: A1.A2.A3\n+    sage: A1.A2.A3  # py2\n     <class sage.misc.nested_class.A1.A2.A3 at ...>\n-    sage: A1.A2.A3.__name__\n+    sage: A1.A2.A3  # py3\n+    <class 'sage.misc.nested_class.A1.A2.A3'>\n+    sage: A1.A2.A3.__name__  # py2\n     'A1.A2.A3'\n\n-    sage: sage.misc.nested_class.__dict__['A1.A2'] is A1.A2\n+    sage: sage.misc.nested_class.__dict__['A1.A2'] is A1.A2  # py2\n     True\n-    sage: sage.misc.nested_class.__dict__['A1.A2.A3'] is A1.A2.A3\n+    sage: sage.misc.nested_class.__dict__['A1.A2.A3'] is A1.A2.A3  # py2\n     True\n\n All of this is not perfect. In the following scenario::\n@@ -85,6 +89,8 @@ cpdef modify_for_nested_pickle(cls, str name_prefix, module, first_run=True):\n     giving them a mangled name and putting the mangled name in the\n     module namespace.\n\n+    On Python 3 this is a no-op and does not perform any mangling.\n+\n     INPUT:\n\n     - ``cls`` - The class to modify.\n@@ -111,26 +117,26 @@ cpdef modify_for_nested_pickle(cls, str name_prefix, module, first_run=True):\n         sage: getattr(module, 'A.B', 'Not found')\n         'Not found'\n         sage: modify_for_nested_pickle(A, 'A', sys.modules['__main__'])\n-        sage: A.B.__name__\n+        sage: A.B.__name__  # py2\n         'A.B'\n-        sage: getattr(module, 'A.B', 'Not found')\n+        sage: getattr(module, 'A.B', 'Not found')  # py2\n         <class '__main__.A.B'>\n\n     Here we demonstrate the effect of the ``first_run`` argument::\n\n         sage: modify_for_nested_pickle(A, 'X', sys.modules['__main__'])\n-        sage: A.B.__name__ # nothing changed\n+        sage: A.B.__name__ # py2: nothing changed\n         'A.B'\n         sage: modify_for_nested_pickle(A, 'X', sys.modules['__main__'], first_run=False)\n-        sage: A.B.__name__\n+        sage: A.B.__name__  # py2\n         'X.A.B'\n\n     Note that the class is now found in the module under both its old and\n     its new name::\n\n-        sage: getattr(module, 'A.B', 'Not found')\n+        sage: getattr(module, 'A.B', 'Not found')  # py2\n         <class '__main__.X.A.B'>\n-        sage: getattr(module, 'X.A.B', 'Not found')\n+        sage: getattr(module, 'X.A.B', 'Not found')  # py2\n         <class '__main__.X.A.B'>\n\n\n@@ -151,17 +157,20 @@ cpdef modify_for_nested_pickle(cls, str name_prefix, module, first_run=True):\n\n     Before :trac:`9107`, the name of ``A1.B1.C1`` would have been wrong::\n\n-        sage: A1.B1.C1.__name__\n+        sage: A1.B1.C1.__name__  # py2\n         'A1.B1.C1'\n-        sage: A1.B2.C2.__name__\n+        sage: A1.B2.C2.__name__  # py2\n         'A1.B2.C2'\n         sage: A_module = sys.modules[A1.__module__]\n-        sage: getattr(A_module, 'A1.B1.C1', 'Not found').__name__\n+        sage: getattr(A_module, 'A1.B1.C1', 'Not found').__name__  # py2\n         'A1.B1.C1'\n-        sage: getattr(A_module, 'A1.B2.C2', 'Not found').__name__\n+        sage: getattr(A_module, 'A1.B2.C2', 'Not found').__name__  # py2\n         'A1.B2.C2'\n\n     \"\"\"\n+    IF PY_MAJOR_VERSION >= 3:\n+        return\n+\n     cdef str name, dotted_name\n     cdef str mod_name = module.__name__\n     cdef str cls_name = cls.__name__+'.'\n@@ -214,9 +223,9 @@ def nested_pickle(cls):\n     then the name of class ``\"B\"`` will be modified to ``\"A.B\"``, and the ``\"A.B\"``\n     attribute of the module will be set to class ``\"B\"``::\n\n-        sage: A.B.__name__\n+        sage: A.B.__name__  # py2\n         'A.B'\n-        sage: getattr(module, 'A.B', 'Not found')\n+        sage: getattr(module, 'A.B', 'Not found')  # py2\n         <class __main__.A.B at ...>\n\n     In Python 2.6, decorators work with classes; then ``@nested_pickle``\n@@ -245,6 +254,9 @@ cdef class NestedClassMetaclass(type):\n     r\"\"\"\n     A metaclass for nested pickling.\n\n+    On Python 3 this is just a direct wrapper around the base `type` and does\n+    not do anything.\n+\n     Check that one can use a metaclass to ensure nested_pickle\n     is called on any derived subclass::\n\n@@ -256,11 +268,12 @@ cdef class NestedClassMetaclass(type):\n         ....:     class B(object):\n         ....:         pass\n         ...\n-        sage: A3.B.__name__\n+        sage: A3.B.__name__  # py2\n         'A3.B'\n-        sage: getattr(sys.modules['__main__'], 'A3.B', 'Not found')\n+        sage: getattr(sys.modules['__main__'], 'A3.B', 'Not found')  # py2\n         <class '__main__.A3.B'>\n     \"\"\"\n+\n     def __init__(self, *args):\n         r\"\"\"\n         This invokes the nested_pickle on construction.\n@@ -273,7 +286,7 @@ cdef class NestedClassMetaclass(type):\n         ...\n         sage: A.B\n         <class '__main__.A.B'>\n-        sage: getattr(sys.modules['__main__'], 'A.B', 'Not found')\n+        sage: getattr(sys.modules['__main__'], 'A.B', 'Not found')  # py2\n         <class '__main__.A.B'>\n         \"\"\"\n         modify_for_nested_pickle(self, self.__name__, sys_modules[self.__module__])\n@@ -306,9 +319,9 @@ class MainClass(object, metaclass=NestedClassMetaclass):\n                 sage: from sage.misc.nested_class import *\n                 sage: loads(dumps(MainClass.NestedClass.NestedSubClass()))\n                 <sage.misc.nested_class.MainClass.NestedClass.NestedSubClass object at 0x...>\n-                sage: getattr(sage.misc.nested_class, 'MainClass.NestedClass.NestedSubClass')\n+                sage: getattr(sage.misc.nested_class, 'MainClass.NestedClass.NestedSubClass')  # py2\n                 <class 'sage.misc.nested_class.MainClass.NestedClass.NestedSubClass'>\n-                sage: MainClass.NestedClass.NestedSubClass.__name__\n+                sage: MainClass.NestedClass.NestedSubClass.__name__  # py2\n                 'MainClass.NestedClass.NestedSubClass'\n             \"\"\"\n             def dummy(self, x, *args, r=(1,2,3.4), **kwds):\n@@ -321,7 +334,7 @@ class MainClass(object, metaclass=NestedClassMetaclass):\n                     sage: from sage.misc.nested_class import MainClass\n                     sage: print(MainClass.NestedClass.NestedSubClass.dummy.__doc__)\n                     NestedSubClass.dummy(self, x, *args, r=(1, 2, 3.4), **kwds)\n-                    File: sage/misc/nested_class.pyx (starting at line 314)\n+                    File: sage/misc/nested_class.pyx (starting at line 327)\n                     <BLANKLINE>\n                                     A dummy method to demonstrate the embedding of\n                                     method signature for nested classes.\n```",
    "created_at": "2019-04-19T17:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432097",
    "user": "https://github.com/embray"
}
```

<div id="comment:4" align="right">Comment 4</div>

Here it is--it turns out that the issue this is trying to work around just isn't relevant on Python 3, so it makes `NestedClassMetaclass` a no-op to be removed whenever we drop Python 2 support.

```diff
diff --git a/src/sage/misc/nested_class.pyx b/src/sage/misc/nested_class.pyx
index 3cd3dfc..cf9c352 100644
--- a/src/sage/misc/nested_class.pyx
+++ b/src/sage/misc/nested_class.pyx
@@ -36,23 +36,27 @@ EXAMPLES::

     sage: A1.A2.A3.__name__
     'A3'
-    sage: A1.A2.A3
+    sage: A1.A2.A3  # py2
     <class sage.misc.nested_class.A3 at ...>

-    sage: nested_pickle(A1)
+    sage: nested_pickle(A1)  # py2
     <class sage.misc.nested_class.A1 at ...>

-    sage: A1.A2
+    sage: A1.A2  # py2
     <class sage.misc.nested_class.A1.A2 at ...>
+    sage: A1.A2  # py3 - note: here we have he desired name for free
+    <class 'sage.misc.nested_class.A1.A2'>

-    sage: A1.A2.A3
+    sage: A1.A2.A3  # py2
     <class sage.misc.nested_class.A1.A2.A3 at ...>
-    sage: A1.A2.A3.__name__
+    sage: A1.A2.A3  # py3
+    <class 'sage.misc.nested_class.A1.A2.A3'>
+    sage: A1.A2.A3.__name__  # py2
     'A1.A2.A3'

-    sage: sage.misc.nested_class.__dict__['A1.A2'] is A1.A2
+    sage: sage.misc.nested_class.__dict__['A1.A2'] is A1.A2  # py2
     True
-    sage: sage.misc.nested_class.__dict__['A1.A2.A3'] is A1.A2.A3
+    sage: sage.misc.nested_class.__dict__['A1.A2.A3'] is A1.A2.A3  # py2
     True

 All of this is not perfect. In the following scenario::
@@ -85,6 +89,8 @@ cpdef modify_for_nested_pickle(cls, str name_prefix, module, first_run=True):
     giving them a mangled name and putting the mangled name in the
     module namespace.

+    On Python 3 this is a no-op and does not perform any mangling.
+
     INPUT:

     - ``cls`` - The class to modify.
@@ -111,26 +117,26 @@ cpdef modify_for_nested_pickle(cls, str name_prefix, module, first_run=True):
         sage: getattr(module, 'A.B', 'Not found')
         'Not found'
         sage: modify_for_nested_pickle(A, 'A', sys.modules['__main__'])
-        sage: A.B.__name__
+        sage: A.B.__name__  # py2
         'A.B'
-        sage: getattr(module, 'A.B', 'Not found')
+        sage: getattr(module, 'A.B', 'Not found')  # py2
         <class '__main__.A.B'>

     Here we demonstrate the effect of the ``first_run`` argument::

         sage: modify_for_nested_pickle(A, 'X', sys.modules['__main__'])
-        sage: A.B.__name__ # nothing changed
+        sage: A.B.__name__ # py2: nothing changed
         'A.B'
         sage: modify_for_nested_pickle(A, 'X', sys.modules['__main__'], first_run=False)
-        sage: A.B.__name__
+        sage: A.B.__name__  # py2
         'X.A.B'

     Note that the class is now found in the module under both its old and
     its new name::

-        sage: getattr(module, 'A.B', 'Not found')
+        sage: getattr(module, 'A.B', 'Not found')  # py2
         <class '__main__.X.A.B'>
-        sage: getattr(module, 'X.A.B', 'Not found')
+        sage: getattr(module, 'X.A.B', 'Not found')  # py2
         <class '__main__.X.A.B'>


@@ -151,17 +157,20 @@ cpdef modify_for_nested_pickle(cls, str name_prefix, module, first_run=True):

     Before :trac:`9107`, the name of ``A1.B1.C1`` would have been wrong::

-        sage: A1.B1.C1.__name__
+        sage: A1.B1.C1.__name__  # py2
         'A1.B1.C1'
-        sage: A1.B2.C2.__name__
+        sage: A1.B2.C2.__name__  # py2
         'A1.B2.C2'
         sage: A_module = sys.modules[A1.__module__]
-        sage: getattr(A_module, 'A1.B1.C1', 'Not found').__name__
+        sage: getattr(A_module, 'A1.B1.C1', 'Not found').__name__  # py2
         'A1.B1.C1'
-        sage: getattr(A_module, 'A1.B2.C2', 'Not found').__name__
+        sage: getattr(A_module, 'A1.B2.C2', 'Not found').__name__  # py2
         'A1.B2.C2'

     """
+    IF PY_MAJOR_VERSION >= 3:
+        return
+
     cdef str name, dotted_name
     cdef str mod_name = module.__name__
     cdef str cls_name = cls.__name__+'.'
@@ -214,9 +223,9 @@ def nested_pickle(cls):
     then the name of class ``"B"`` will be modified to ``"A.B"``, and the ``"A.B"``
     attribute of the module will be set to class ``"B"``::

-        sage: A.B.__name__
+        sage: A.B.__name__  # py2
         'A.B'
-        sage: getattr(module, 'A.B', 'Not found')
+        sage: getattr(module, 'A.B', 'Not found')  # py2
         <class __main__.A.B at ...>

     In Python 2.6, decorators work with classes; then ``@nested_pickle``
@@ -245,6 +254,9 @@ cdef class NestedClassMetaclass(type):
     r"""
     A metaclass for nested pickling.

+    On Python 3 this is just a direct wrapper around the base `type` and does
+    not do anything.
+
     Check that one can use a metaclass to ensure nested_pickle
     is called on any derived subclass::

@@ -256,11 +268,12 @@ cdef class NestedClassMetaclass(type):
         ....:     class B(object):
         ....:         pass
         ...
-        sage: A3.B.__name__
+        sage: A3.B.__name__  # py2
         'A3.B'
-        sage: getattr(sys.modules['__main__'], 'A3.B', 'Not found')
+        sage: getattr(sys.modules['__main__'], 'A3.B', 'Not found')  # py2
         <class '__main__.A3.B'>
     """
+
     def __init__(self, *args):
         r"""
         This invokes the nested_pickle on construction.
@@ -273,7 +286,7 @@ cdef class NestedClassMetaclass(type):
         ...
         sage: A.B
         <class '__main__.A.B'>
-        sage: getattr(sys.modules['__main__'], 'A.B', 'Not found')
+        sage: getattr(sys.modules['__main__'], 'A.B', 'Not found')  # py2
         <class '__main__.A.B'>
         """
         modify_for_nested_pickle(self, self.__name__, sys_modules[self.__module__])
@@ -306,9 +319,9 @@ class MainClass(object, metaclass=NestedClassMetaclass):
                 sage: from sage.misc.nested_class import *
                 sage: loads(dumps(MainClass.NestedClass.NestedSubClass()))
                 <sage.misc.nested_class.MainClass.NestedClass.NestedSubClass object at 0x...>
-                sage: getattr(sage.misc.nested_class, 'MainClass.NestedClass.NestedSubClass')
+                sage: getattr(sage.misc.nested_class, 'MainClass.NestedClass.NestedSubClass')  # py2
                 <class 'sage.misc.nested_class.MainClass.NestedClass.NestedSubClass'>
-                sage: MainClass.NestedClass.NestedSubClass.__name__
+                sage: MainClass.NestedClass.NestedSubClass.__name__  # py2
                 'MainClass.NestedClass.NestedSubClass'
             """
             def dummy(self, x, *args, r=(1,2,3.4), **kwds):
@@ -321,7 +334,7 @@ class MainClass(object, metaclass=NestedClassMetaclass):
                     sage: from sage.misc.nested_class import MainClass
                     sage: print(MainClass.NestedClass.NestedSubClass.dummy.__doc__)
                     NestedSubClass.dummy(self, x, *args, r=(1, 2, 3.4), **kwds)
-                    File: sage/misc/nested_class.pyx (starting at line 314)
+                    File: sage/misc/nested_class.pyx (starting at line 327)
                     <BLANKLINE>
                                     A dummy method to demonstrate the embedding of
                                     method signature for nested classes.
```



---

archive/issue_comments_432098.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nAnd most of the tests are skipped on Python 3 as they are not relevant.",
    "created_at": "2019-04-19T17:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432098",
    "user": "https://github.com/embray"
}
```

<div id="comment:5" align="right">Comment 5</div>

And most of the tests are skipped on Python 3 as they are not relevant.



---

archive/issue_comments_432099.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nbranch please",
    "created_at": "2019-04-24T06:02:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432099",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">Comment 6</div>

branch please



---

archive/issue_comments_432100.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nHere you go.  With this, all the tests for `src/sage/misc/nested_class.pyx` pass on Python 3 (though many of them are simply skipped as inapplicable).\n\nThere might be some other minor failures related to this in miscellaneous modules, but I am not sure.  Everything in python3-known-passing.txt still passes.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c876038bf90c23efcb0e95e2757898f3358cec9b\">c876038</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>\n",
    "created_at": "2019-04-24T13:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432100",
    "user": "https://github.com/embray"
}
```

<div id="comment:7" align="right">Comment 7</div>

Here you go.  With this, all the tests for `src/sage/misc/nested_class.pyx` pass on Python 3 (though many of them are simply skipped as inapplicable).

There might be some other minor failures related to this in miscellaneous modules, but I am not sure.  Everything in python3-known-passing.txt still passes.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c876038bf90c23efcb0e95e2757898f3358cec9b">c876038</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>




---

archive/issue_comments_432101.json:
```json
{
    "body": "Branch: **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)**",
    "created_at": "2019-04-24T13:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432101",
    "user": "https://github.com/embray"
}
```

Branch: **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)**



---

archive/issue_events_361758.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-04-24T13:19:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361758"
}
```



---

archive/issue_comments_432102.json:
```json
{
    "body": "Commit: **[c876038](https://github.com/sagemath/sagetrac-mirror/commit/c876038bf90c23efcb0e95e2757898f3358cec9b)**",
    "created_at": "2019-04-24T13:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432102",
    "user": "https://github.com/embray"
}
```

Commit: **[c876038](https://github.com/sagemath/sagetrac-mirror/commit/c876038bf90c23efcb0e95e2757898f3358cec9b)**



---

archive/issue_comments_432103.json:
```json
{
    "body": "Author: **Erik Bray**",
    "created_at": "2019-04-24T13:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432103",
    "user": "https://github.com/embray"
}
```

Author: **Erik Bray**



---

archive/issue_comments_432104.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\none failing doctest in src/sage/misc/sageinspect.py, see patchbot",
    "created_at": "2019-04-24T17:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432104",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">Comment 8</div>

one failing doctest in src/sage/misc/sageinspect.py, see patchbot



---

archive/issue_events_361759.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-24T17:06:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361759"
}
```



---

archive/issue_events_361760.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-24T17:06:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361760"
}
```



---

archive/issue_comments_432105.json:
```json
{
    "body": "Changed branch from **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)** to **[public/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/public/python3/ticket-27692)**",
    "created_at": "2019-04-25T11:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432105",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)** to **[public/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/public/python3/ticket-27692)**



---

archive/issue_comments_432106.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nI fixed the doctest\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4e9eb3a96965c2a05fc58afefb7b4a0024f3dbe\">a4e9eb3</a></td><td><code>Merge branch 'u/embray/python3/ticket-27692' in 8.8.b3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a902cb23d6a81d04c49b9c0ceb5eab97d4f4a6c4\">a902cb2</a></td><td><code>fix doctest in sageinspect</code></td></tr></table>\n",
    "created_at": "2019-04-25T11:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432106",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">Comment 10</div>

I fixed the doctest

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4e9eb3a96965c2a05fc58afefb7b4a0024f3dbe">a4e9eb3</a></td><td><code>Merge branch 'u/embray/python3/ticket-27692' in 8.8.b3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a902cb23d6a81d04c49b9c0ceb5eab97d4f4a6c4">a902cb2</a></td><td><code>fix doctest in sageinspect</code></td></tr></table>




---

archive/issue_comments_432107.json:
```json
{
    "body": "Changed commit from **[c876038](https://github.com/sagemath/sagetrac-mirror/commit/c876038bf90c23efcb0e95e2757898f3358cec9b)** to **[a902cb2](https://github.com/sagemath/sagetrac-mirror/commit/a902cb23d6a81d04c49b9c0ceb5eab97d4f4a6c4)**",
    "created_at": "2019-04-25T11:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432107",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[c876038](https://github.com/sagemath/sagetrac-mirror/commit/c876038bf90c23efcb0e95e2757898f3358cec9b)** to **[a902cb2](https://github.com/sagemath/sagetrac-mirror/commit/a902cb23d6a81d04c49b9c0ceb5eab97d4f4a6c4)**



---

archive/issue_events_361761.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-25T11:44:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361761"
}
```



---

archive/issue_events_361762.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-04-25T11:44:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361762"
}
```



---

archive/issue_comments_432108.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nRight...there's always one of those...",
    "created_at": "2019-04-25T12:49:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432108",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">Comment 11</div>

Right...there's always one of those...



---

archive/issue_comments_432109.json:
```json
{
    "body": "Changed commit from **[a902cb2](https://github.com/sagemath/sagetrac-mirror/commit/a902cb23d6a81d04c49b9c0ceb5eab97d4f4a6c4)** to **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)**",
    "created_at": "2019-04-25T12:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432109",
    "user": "https://github.com/embray"
}
```

Changed commit from **[a902cb2](https://github.com/sagemath/sagetrac-mirror/commit/a902cb23d6a81d04c49b9c0ceb5eab97d4f4a6c4)** to **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)**



---

archive/issue_events_361763.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-04-25T12:51:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361763"
}
```



---

archive/issue_events_361764.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-04-25T12:51:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361764"
}
```



---

archive/issue_comments_432110.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa\">174e895</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>\n",
    "created_at": "2019-04-25T12:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432110",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">Comment 12</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa">174e895</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>




---

archive/issue_comments_432111.json:
```json
{
    "body": "Changed branch from **[public/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/public/python3/ticket-27692)** to **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)**",
    "created_at": "2019-04-25T12:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432111",
    "user": "https://github.com/embray"
}
```

Changed branch from **[public/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/public/python3/ticket-27692)** to **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)**



---

archive/issue_comments_432112.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nok, great. Thx",
    "created_at": "2019-04-25T14:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432112",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">Comment 13</div>

ok, great. Thx



---

archive/issue_comments_432113.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-04-25T14:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432113",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_events_361765.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-29T12:35:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361765"
}
```



---

archive/issue_events_361766.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-29T12:35:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361766"
}
```



---

archive/issue_comments_432114.json:
```json
{
    "body": "Changed branch from **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)** to **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)**",
    "created_at": "2019-04-29T12:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432114",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)** to **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)**



---

archive/issue_comments_432115.json:
```json
{
    "body": "Changed branch from **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)** to **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)**",
    "created_at": "2019-05-02T13:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432115",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)** to **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)**



---

archive/issue_comments_432116.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nThis ticket breaks docbuild on python3 (only); I don't know why but it does. Error is:\n\n```\n$ make doc-clean && make -j40 && make doc-html\n[...]\n[dochtml] Error building the documentation.\n[dochtml] multiprocessing.pool.RemoteTraceback: \n[dochtml] \"\"\"\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/multiprocessing/pool.py\", line 121, in worker\n[dochtml]     result = (True, func(*args, **kwds))\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/multiprocessing/pool.py\", line 44, in mapstar\n[dochtml]     return list(map(*args))\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 79, in build_ref_doc\n[dochtml]     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 761, in _wrapper\n[dochtml]     getattr(DocBuilder, build_type)(self, *args, **kwds)\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 133, in f\n[dochtml]     runsphinx()\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/sphinxbuild.py\", line 314, in runsphinx\n[dochtml]     sys.stderr.raise_errors()\n[dochtml]   File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/sphinxbuild.py\", line 249, in raise_errors\n[dochtml]     raise OSError(self._error)\n[dochtml] OSError: /var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/ncsf_qsym/qsym.py:docstring of sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Fundamental.Eulerian:55: WARNING: Duplicate explicit target name: \"sw2010\".\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa\">174e895</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>\n",
    "created_at": "2019-05-02T13:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432116",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">Comment 15</div>

This ticket breaks docbuild on python3 (only); I don't know why but it does. Error is:

```
$ make doc-clean && make -j40 && make doc-html
[...]
[dochtml] Error building the documentation.
[dochtml] multiprocessing.pool.RemoteTraceback: 
[dochtml] """
[dochtml] Traceback (most recent call last):
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/multiprocessing/pool.py", line 121, in worker
[dochtml]     result = (True, func(*args, **kwds))
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/multiprocessing/pool.py", line 44, in mapstar
[dochtml]     return list(map(*args))
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 79, in build_ref_doc
[dochtml]     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 761, in _wrapper
[dochtml]     getattr(DocBuilder, build_type)(self, *args, **kwds)
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 133, in f
[dochtml]     runsphinx()
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/sphinxbuild.py", line 314, in runsphinx
[dochtml]     sys.stderr.raise_errors()
[dochtml]   File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage_setup/docbuild/sphinxbuild.py", line 249, in raise_errors
[dochtml]     raise OSError(self._error)
[dochtml] OSError: /var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/combinat/ncsf_qsym/qsym.py:docstring of sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Fundamental.Eulerian:55: WARNING: Duplicate explicit target name: "sw2010".
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa">174e895</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>




---

archive/issue_comments_432117.json:
```json
{
    "body": "Assignee: **@embray**",
    "created_at": "2019-05-02T13:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432117",
    "user": "https://github.com/embray"
}
```

Assignee: **@embray**



---

archive/issue_events_361767.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-02T13:37:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361767"
}
```



---

archive/issue_events_361768.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-02T13:38:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361768"
}
```



---

archive/issue_events_361769.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-05-02T13:38:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361769"
}
```



---

archive/issue_comments_432118.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nNot sure why I can't just progress straight to needs_work...",
    "created_at": "2019-05-02T13:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432118",
    "user": "https://github.com/embray"
}
```

<div id="comment:18" align="right">Comment 18</div>

Not sure why I can't just progress straight to needs_work...



---

archive/issue_comments_432119.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI suppose it's possible there's some strange interaction between this, and how Sphinx treats nested classes (either in plain Sphinx, or something particular that Sage does with it...)",
    "created_at": "2019-05-02T13:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432119",
    "user": "https://github.com/embray"
}
```

<div id="comment:19" align="right">Comment 19</div>

I suppose it's possible there's some strange interaction between this, and how Sphinx treats nested classes (either in plain Sphinx, or something particular that Sage does with it...)



---

archive/issue_comments_432120.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nOr how Sphinx treats cached methods? A bandaid (untested) might be to move the citation out of `qsym.py` to the master bibliography file.",
    "created_at": "2019-05-02T17:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432120",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">Comment 20</div>

Or how Sphinx treats cached methods? A bandaid (untested) might be to move the citation out of `qsym.py` to the master bibliography file.



---

archive/issue_comments_432121.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nIn fact that file has its own bibliography at the start, so this change might fix it:\n\n```diff\ndiff --git a/src/sage/combinat/ncsf_qsym/qsym.py b/src/sage/combinat/ncsf_qsym/qsym.py\nindex ae7d830ed5..61004f24cd 100644\n--- a/src/sage/combinat/ncsf_qsym/qsym.py\n+++ b/src/sage/combinat/ncsf_qsym/qsym.py\n@@ -62,6 +62,10 @@ REFERENCES:\n    Quasisymmetric Functions Expand Positively into Young Quasisymmetric\n    Schur Functions*. :arxiv:`1606.03519`\n \n+.. [SW2010] John Shareshian and Michelle Wachs.\n+   *Eulerian quasisymmetric functions*. (2010).\n+   :arxiv:`0812.0764v2`\n+\n AUTHOR:\n \n - Jason Bandlow\n@@ -2348,12 +2352,6 @@ class QuasiSymmetricFunctions(UniqueRepresentation, Parent):\n             - ``k`` -- (optional) if specified, determines the number of fixed\n               points of the permutations which are being summed over\n \n-            REFERENCES:\n-\n-            .. [SW2010] John Shareshian and Michelle Wachs.\n-               *Eulerian quasisymmetric functions*. (2010).\n-               :arxiv:`0812.0764v2`\n-\n             EXAMPLES::\n \n                 sage: F = QuasiSymmetricFunctions(QQ).F()\n```\nAgain, this is just a bandaid.",
    "created_at": "2019-05-02T17:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432121",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">Comment 21</div>

In fact that file has its own bibliography at the start, so this change might fix it:

```diff
diff --git a/src/sage/combinat/ncsf_qsym/qsym.py b/src/sage/combinat/ncsf_qsym/qsym.py
index ae7d830ed5..61004f24cd 100644
--- a/src/sage/combinat/ncsf_qsym/qsym.py
+++ b/src/sage/combinat/ncsf_qsym/qsym.py
@@ -62,6 +62,10 @@ REFERENCES:
    Quasisymmetric Functions Expand Positively into Young Quasisymmetric
    Schur Functions*. :arxiv:`1606.03519`
 
+.. [SW2010] John Shareshian and Michelle Wachs.
+   *Eulerian quasisymmetric functions*. (2010).
+   :arxiv:`0812.0764v2`
+
 AUTHOR:
 
 - Jason Bandlow
@@ -2348,12 +2352,6 @@ class QuasiSymmetricFunctions(UniqueRepresentation, Parent):
             - ``k`` -- (optional) if specified, determines the number of fixed
               points of the permutations which are being summed over
 
-            REFERENCES:
-
-            .. [SW2010] John Shareshian and Michelle Wachs.
-               *Eulerian quasisymmetric functions*. (2010).
-               :arxiv:`0812.0764v2`
-
             EXAMPLES::
 
                 sage: F = QuasiSymmetricFunctions(QQ).F()
```
Again, this is just a bandaid.



---

archive/issue_comments_432122.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nGood job on Volker to find it out. I couldn't figure which ticket was causing that breakage.",
    "created_at": "2019-05-02T20:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432122",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">Comment 22</div>

Good job on Volker to find it out. I couldn't figure which ticket was causing that breakage.



---

archive/issue_comments_432123.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nHasn't there been some effort I've seen elsewhere to move bibliographies to module top-levels anyways (probably in part to prevent problems like this)?",
    "created_at": "2019-05-03T13:52:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432123",
    "user": "https://github.com/embray"
}
```

<div id="comment:23" align="right">Comment 23</div>

Hasn't there been some effort I've seen elsewhere to move bibliographies to module top-levels anyways (probably in part to prevent problems like this)?



---

archive/issue_comments_432124.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nOr, I guess maybe I'm thinking of #27497, which is not exactly as I described.",
    "created_at": "2019-05-03T13:53:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432124",
    "user": "https://github.com/embray"
}
```

<div id="comment:24" align="right">Comment 24</div>

Or, I guess maybe I'm thinking of #27497, which is not exactly as I described.



---

archive/issue_comments_432125.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nThe preferred thing is to move all references to the master bibliography file. `combinat` and `graphs` are the two directories remaining where this needs to be done.",
    "created_at": "2019-05-03T17:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432125",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">Comment 25</div>

The preferred thing is to move all references to the master bibliography file. `combinat` and `graphs` are the two directories remaining where this needs to be done.



---

archive/issue_comments_432126.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nI think my proposed change in [comment:21](#comment%3A21) fixes the docbuilding problem. Should we incorporate it since it's the right thing to do to collect all of the references, or is it indicative of a further problem that needs investigating? (Do we care how Sphinx handles nested and/or cached methods, if that is indeed the problem?)",
    "created_at": "2019-05-05T21:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432126",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">Comment 26</div>

I think my proposed change in [comment:21](#comment%3A21) fixes the docbuilding problem. Should we incorporate it since it's the right thing to do to collect all of the references, or is it indicative of a further problem that needs investigating? (Do we care how Sphinx handles nested and/or cached methods, if that is indeed the problem?)



---

archive/issue_comments_432127.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@jhpalmieri](#comment%3A26):\n> I think my proposed change in [comment:21](#comment%3A21) fixes the docbuilding problem. Should we incorporate it since it's the right thing to do to collect all of the references, or is it indicative of a further problem that needs investigating? (Do we care how Sphinx handles nested and/or cached methods, if that is indeed the problem?)\n\nOn one hand, it might be indicative of a deeper problem; on the other hand I don't think it's something I want to place high priority on.  I agree that this change fixes the problem for now.  I just want to confirm that the compiled docs do still look as expected and then I'll update this branch and set it back to positive review.",
    "created_at": "2019-05-06T14:17:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432127",
    "user": "https://github.com/embray"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@jhpalmieri](#comment%3A26):
> I think my proposed change in [comment:21](#comment%3A21) fixes the docbuilding problem. Should we incorporate it since it's the right thing to do to collect all of the references, or is it indicative of a further problem that needs investigating? (Do we care how Sphinx handles nested and/or cached methods, if that is indeed the problem?)

On one hand, it might be indicative of a deeper problem; on the other hand I don't think it's something I want to place high priority on.  I agree that this change fixes the problem for now.  I just want to confirm that the compiled docs do still look as expected and then I'll update this branch and set it back to positive review.



---

archive/issue_comments_432128.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nThere does appear to be a legitimate issue here w.r.t. Sphinx.\n\nIn the class `QuasiSymmetricFunctions` the nested class `Fundamental` also has an alias of just `F`.  That is, in the class body it has:\n\n```\nF = Fundamental\n```\n\njust as a shortcut.  This does not affect the qualified name of the class, which is still correct:\n\n```\nsage: QuasiSymmetricFunctions.Fundamental.__qualname__\n'QuasiSymmetricFunctions.Fundamental'\n```\n\nbut for some reason Sphinx is outputting the docs for `QuasiSymmetricFunctions` with this nested class listed as just \"F\" instead of \"Fundamental\", whereas in the [current docs](http://doc.sagemath.org/html/en/reference/combinat/sage/combinat/ncsf_qsym/qsym.html#sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Fundamental) it's listed correctly as \"Fundamental\".",
    "created_at": "2019-05-07T15:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432128",
    "user": "https://github.com/embray"
}
```

<div id="comment:28" align="right">Comment 28</div>

There does appear to be a legitimate issue here w.r.t. Sphinx.

In the class `QuasiSymmetricFunctions` the nested class `Fundamental` also has an alias of just `F`.  That is, in the class body it has:

```
F = Fundamental
```

just as a shortcut.  This does not affect the qualified name of the class, which is still correct:

```
sage: QuasiSymmetricFunctions.Fundamental.__qualname__
'QuasiSymmetricFunctions.Fundamental'
```

but for some reason Sphinx is outputting the docs for `QuasiSymmetricFunctions` with this nested class listed as just "F" instead of "Fundamental", whereas in the [current docs](http://doc.sagemath.org/html/en/reference/combinat/sage/combinat/ncsf_qsym/qsym.html#sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Fundamental) it's listed correctly as "Fundamental".



---

archive/issue_comments_432129.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nBack when I was last looking into this I was on the verge of tracking down the issue, but then everything went up in the air for a few weeks and now I'm not exactly sure where I was with this, though the issue did seem to be somewhere in one of Sage's Sphinx extensions.",
    "created_at": "2019-06-07T15:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432129",
    "user": "https://github.com/embray"
}
```

<div id="comment:29" align="right">Comment 29</div>

Back when I was last looking into this I was on the verge of tracking down the issue, but then everything went up in the air for a few weeks and now I'm not exactly sure where I was with this, though the issue did seem to be somewhere in one of Sage's Sphinx extensions.



---

archive/issue_comments_432130.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nIs there any hope for progress here ? This is now the top-failing file, by number of failures.",
    "created_at": "2019-06-12T08:15:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432130",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:30" align="right">Comment 30</div>

Is there any hope for progress here ? This is now the top-failing file, by number of failures.



---

archive/issue_comments_432131.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nI think so.  I (or someone) needs to work out exactly what's going on, IIRC in sage_autodoc, such that aliases for some nested classes are being preferred over the class itself.\n\nI think it might just be some dict sorting issue, but it needs to actually explicitly detect cases where an object's attribute name is not the same as its `__name__`.\n\nThat is, when looping over the members of, for example, `QuasiSymmetricFunctions`, you'll find a `Fundamental` member and an `F` member which both point to the same object, the class named `Fundamental`.  The docbuild is failing because this member is being listed as just \"class F\" and not \"class Fundamental\".",
    "created_at": "2019-06-12T08:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432131",
    "user": "https://github.com/embray"
}
```

<div id="comment:31" align="right">Comment 31</div>

I think so.  I (or someone) needs to work out exactly what's going on, IIRC in sage_autodoc, such that aliases for some nested classes are being preferred over the class itself.

I think it might just be some dict sorting issue, but it needs to actually explicitly detect cases where an object's attribute name is not the same as its `__name__`.

That is, when looping over the members of, for example, `QuasiSymmetricFunctions`, you'll find a `Fundamental` member and an `F` member which both point to the same object, the class named `Fundamental`.  The docbuild is failing because this member is being listed as just "class F" and not "class Fundamental".



---

archive/issue_comments_432132.json:
```json
{
    "body": "Changed commit from **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)** to **[4214075](https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292)**",
    "created_at": "2019-06-13T08:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432132",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[174e895](https://github.com/sagemath/sagetrac-mirror/commit/174e8956aa38a325ec189f786c4ee27c246c55fa)** to **[4214075](https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292)**



---

archive/issue_comments_432133.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292\">4214075</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>\n",
    "created_at": "2019-06-13T08:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432133",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32" align="right">Comment 32</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292">4214075</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr></table>




---

archive/issue_comments_432134.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nRebased.  Going to keep investigating the docbuild issue now.",
    "created_at": "2019-06-13T08:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432134",
    "user": "https://github.com/embray"
}
```

<div id="comment:33" align="right">Comment 33</div>

Rebased.  Going to keep investigating the docbuild issue now.



---

archive/issue_comments_432135.json:
```json
{
    "body": "Changed commit from **[4214075](https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292)** to **[291d584](https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18)**",
    "created_at": "2019-06-13T08:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432135",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4214075](https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292)** to **[291d584](https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18)**



---

archive/issue_comments_432136.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18\">291d584</a></td><td><code>Move this reference to the module level.</code></td></tr></table>\n",
    "created_at": "2019-06-13T08:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432136",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34" align="right">Comment 34</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18">291d584</a></td><td><code>Move this reference to the module level.</code></td></tr></table>




---

archive/issue_comments_432137.json:
```json
{
    "body": "Changed commit from **[291d584](https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18)** to **[8337e67](https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4)**",
    "created_at": "2019-06-13T10:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432137",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[291d584](https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18)** to **[8337e67](https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4)**



---

archive/issue_comments_432138.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4\">8337e67</a></td><td><code>Fix up sage_autodoc to work with normal Python 3 nested classes with qualnames,</code></td></tr></table>\n",
    "created_at": "2019-06-13T10:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432138",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35" align="right">Comment 35</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4">8337e67</a></td><td><code>Fix up sage_autodoc to work with normal Python 3 nested classes with qualnames,</code></td></tr></table>




---

archive/issue_comments_432139.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nThe above commit fixes the docbuild issue for me.  The resulting docs now look as expected: `QuasiSymmetricFunctions.Fundamental` is documented as a nested class in `QuasiSymmetricFunctions`, while `QuasiSymmetricFunctions.F` is documented as an attribute, which is simply an alias for `QuasiSymmetricFunctions.Fundamental`.\n\nNeed to double-check that this still holds on Python 2 with this branch.",
    "created_at": "2019-06-13T10:41:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432139",
    "user": "https://github.com/embray"
}
```

<div id="comment:36" align="right">Comment 36</div>

The above commit fixes the docbuild issue for me.  The resulting docs now look as expected: `QuasiSymmetricFunctions.Fundamental` is documented as a nested class in `QuasiSymmetricFunctions`, while `QuasiSymmetricFunctions.F` is documented as an attribute, which is simply an alias for `QuasiSymmetricFunctions.Fundamental`.

Need to double-check that this still holds on Python 2 with this branch.



---

archive/issue_comments_432140.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nI think this is good for Python 2 as well.  Strangely, the `.F` alias does not get documented in the autodoc for the class on Python 2, and that appears to be the case in the current version of the docs as well. That difference is consistent before and after this change, whereas the Python 3 version seems better so I'm content to leave it at that.",
    "created_at": "2019-06-13T19:19:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432140",
    "user": "https://github.com/embray"
}
```

<div id="comment:37" align="right">Comment 37</div>

I think this is good for Python 2 as well.  Strangely, the `.F` alias does not get documented in the autodoc for the class on Python 2, and that appears to be the case in the current version of the docs as well. That difference is consistent before and after this change, whereas the Python 3 version seems better so I'm content to leave it at that.



---

archive/issue_events_361770.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-13T19:19:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361770"
}
```



---

archive/issue_events_361771.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-13T19:19:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361771"
}
```



---

archive/issue_comments_432141.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nThis looks okay to me, but others should investigate, too.",
    "created_at": "2019-06-13T21:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432141",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:38" align="right">Comment 38</div>

This looks okay to me, but others should investigate, too.



---

archive/issue_comments_432142.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\npatchbot reports some pyflakes errors (easy to fix) and a docbuild failure:\n\n```\n+[dochtml] OSError: /home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/combinat/dyck_word.py:\ndocstring of sage.combinat.dyck_word.DyckWord_complete.pyramid_weight:23:\nWARNING: Duplicate explicit target name: \"ds1992\".\n```",
    "created_at": "2019-06-14T06:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432142",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:39" align="right">Comment 39</div>

patchbot reports some pyflakes errors (easy to fix) and a docbuild failure:

```
+[dochtml] OSError: /home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/combinat/dyck_word.py:
docstring of sage.combinat.dyck_word.DyckWord_complete.pyramid_weight:23:
WARNING: Duplicate explicit target name: "ds1992".
```



---

archive/issue_comments_432143.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nAfter I fix the references in `dyck_word.py`, I get a ton of other \"Duplicate citation\" and \"Duplicate explicit target names\" from other files in `sage/combinat`. For example:\n\n```\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:376: WARNING: Duplicate explicit target name: \"propp2001\".\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:381: WARNING: Duplicate explicit target name: \"striker2015\".\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element.gyration:9: WARNING: Duplicate explicit target name: \"wieland00\".\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:376: WARNING: duplicate citation Propp2001, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/fully_packed_loop.rst\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:381: WARNING: duplicate citation Striker2015, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/fully_packed_loop.rst\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element.gyration:9: WARNING: duplicate citation Wieland00, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/fully_packed_loop.rst\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/interval_posets.py:docstring of sage.combinat.interval_posets.TamariIntervalPosets_all.Element.cubical_coordinates:14: WARNING: Duplicate explicit target name: \"combe2019\".\n[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/interval_posets.py:docstring of sage.combinat.interval_posets.TamariIntervalPosets_all.Element.cubical_coordinates:14: WARNING: duplicate citation Combe2019, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/interval_posets.rst\n```",
    "created_at": "2019-06-14T15:21:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432143",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:40" align="right">Comment 40</div>

After I fix the references in `dyck_word.py`, I get a ton of other "Duplicate citation" and "Duplicate explicit target names" from other files in `sage/combinat`. For example:

```
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:376: WARNING: Duplicate explicit target name: "propp2001".
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:381: WARNING: Duplicate explicit target name: "striker2015".
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element.gyration:9: WARNING: Duplicate explicit target name: "wieland00".
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:376: WARNING: duplicate citation Propp2001, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/fully_packed_loop.rst
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element:381: WARNING: duplicate citation Striker2015, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/fully_packed_loop.rst
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/fully_packed_loop.py:docstring of sage.combinat.fully_packed_loop.FullyPackedLoops.Element.gyration:9: WARNING: duplicate citation Wieland00, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/fully_packed_loop.rst
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/interval_posets.py:docstring of sage.combinat.interval_posets.TamariIntervalPosets_all.Element.cubical_coordinates:14: WARNING: Duplicate explicit target name: "combe2019".
[combinat ] /Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/combinat/interval_posets.py:docstring of sage.combinat.interval_posets.TamariIntervalPosets_all.Element.cubical_coordinates:14: WARNING: duplicate citation Combe2019, other instance in /Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/en/reference/combinat/sage/combinat/interval_posets.rst
```



---

archive/issue_comments_432144.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nThis fixes the pyflakes errors:\n\n```diff\ndiff --git a/src/sage_setup/docbuild/ext/sage_autodoc.py b/src/sage_setup/docbuild/ext/sage_autodoc.py\nindex 9cce254a13..b75791de36 100644\n--- a/src/sage_setup/docbuild/ext/sage_autodoc.py\n+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py\n@@ -30,25 +30,21 @@ AUTHORS:\n import inspect\n import re\n import sys\n-import warnings\n \n from docutils.statemachine import ViewList\n-from six import PY2, iteritems, itervalues, text_type, class_types, string_types\n+from six import PY2, itervalues, text_type, class_types, string_types\n \n import sphinx\n-from sphinx.errors import ExtensionError\n from sphinx.ext.autodoc.importer import mock, import_object, get_object_members\n-from sphinx.ext.autodoc.inspector import format_annotation\n from sphinx.locale import _, __\n from sphinx.pycode import ModuleAnalyzer\n-from sphinx.errors import ExtensionError, PycodeError\n+from sphinx.errors import PycodeError\n from sphinx.util import logging\n from sphinx.util import rpartition, force_decode\n from sphinx.util.docstrings import prepare_docstring\n-from sphinx.util.inspect import Signature, isdescriptor, safe_getmembers, \\\n+from sphinx.util.inspect import isdescriptor, safe_getmembers, \\\n     safe_getattr, object_description, is_builtin_class_method, \\\n     isenumattribute, isclassmethod, isstaticmethod, getdoc\n-from sphinx.util.inspect import getargspec\n \n from sage.misc.sageinspect import (sage_getdoc_original,\n                                    sage_getargspec, isclassinstance,\n```\nor at least, it fixes the ones that ought to be fixed.",
    "created_at": "2019-06-14T15:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432144",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:41" align="right">Comment 41</div>

This fixes the pyflakes errors:

```diff
diff --git a/src/sage_setup/docbuild/ext/sage_autodoc.py b/src/sage_setup/docbuild/ext/sage_autodoc.py
index 9cce254a13..b75791de36 100644
--- a/src/sage_setup/docbuild/ext/sage_autodoc.py
+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py
@@ -30,25 +30,21 @@ AUTHORS:
 import inspect
 import re
 import sys
-import warnings
 
 from docutils.statemachine import ViewList
-from six import PY2, iteritems, itervalues, text_type, class_types, string_types
+from six import PY2, itervalues, text_type, class_types, string_types
 
 import sphinx
-from sphinx.errors import ExtensionError
 from sphinx.ext.autodoc.importer import mock, import_object, get_object_members
-from sphinx.ext.autodoc.inspector import format_annotation
 from sphinx.locale import _, __
 from sphinx.pycode import ModuleAnalyzer
-from sphinx.errors import ExtensionError, PycodeError
+from sphinx.errors import PycodeError
 from sphinx.util import logging
 from sphinx.util import rpartition, force_decode
 from sphinx.util.docstrings import prepare_docstring
-from sphinx.util.inspect import Signature, isdescriptor, safe_getmembers, \
+from sphinx.util.inspect import isdescriptor, safe_getmembers, \
     safe_getattr, object_description, is_builtin_class_method, \
     isenumattribute, isclassmethod, isstaticmethod, getdoc
-from sphinx.util.inspect import getargspec
 
 from sage.misc.sageinspect import (sage_getdoc_original,
                                    sage_getargspec, isclassinstance,
```
or at least, it fixes the ones that ought to be fixed.



---

archive/issue_comments_432145.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@jhpalmieri](#comment%3A40):\n> After I fix the references in `dyck_word.py`, I get a ton of other \"Duplicate citation\" and \"Duplicate explicit target names\" from other files in `sage/combinat`. For example:\n\nI didn't have this problem before, so is it possible it was recently introduced?  Perhaps it's just another citation that needs to be moved to the module-level, or the master citations list?",
    "created_at": "2019-06-14T16:05:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432145",
    "user": "https://github.com/embray"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@jhpalmieri](#comment%3A40):
> After I fix the references in `dyck_word.py`, I get a ton of other "Duplicate citation" and "Duplicate explicit target names" from other files in `sage/combinat`. For example:

I didn't have this problem before, so is it possible it was recently introduced?  Perhaps it's just another citation that needs to be moved to the module-level, or the master citations list?



---

archive/issue_comments_432146.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nIt may only appear if you do `make doc-clean`. My guess is that whatever is forcing us to move the references in `dyck_word.py` to the module-level is also going to force us to move other references. The references in `FullyPackedLoop` are in a class with the decoration `@add_metaclass(InheritComparisonClasscallMetaclass)`. The reference `Combe2019` is in a method with `@cached_method`. Do we have to move all references in classes, methods, with these decorations to the module-level?",
    "created_at": "2019-06-14T16:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432146",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:43" align="right">Comment 43</div>

It may only appear if you do `make doc-clean`. My guess is that whatever is forcing us to move the references in `dyck_word.py` to the module-level is also going to force us to move other references. The references in `FullyPackedLoop` are in a class with the decoration `@add_metaclass(InheritComparisonClasscallMetaclass)`. The reference `Combe2019` is in a method with `@cached_method`. Do we have to move all references in classes, methods, with these decorations to the module-level?



---

archive/issue_comments_432147.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nAnother issue: in `tableau_tuple.py` we have\n\n```\nfrom sage.combinat.tableau import (Tableau, ...)\n```\nand later\n\n```\nclass TableauTuple(CombinatorialElement):\n    ...\n    Element = Tableau\n```\nand now Sphinx thinks that all of the references in the `Element` class are duplicates of those from `Tableau`. This seems to be fixed by moving all of the references to the master bibliography file.",
    "created_at": "2019-06-14T18:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432147",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">Comment 44</div>

Another issue: in `tableau_tuple.py` we have

```
from sage.combinat.tableau import (Tableau, ...)
```
and later

```
class TableauTuple(CombinatorialElement):
    ...
    Element = Tableau
```
and now Sphinx thinks that all of the references in the `Element` class are duplicates of those from `Tableau`. This seems to be fixed by moving all of the references to the master bibliography file.



---

archive/issue_comments_432148.json:
```json
{
    "body": "Changed branch from **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)** to **[u/jhpalmieri/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/python3/ticket-27692)**",
    "created_at": "2019-06-14T19:17:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432148",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/embray/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/ticket-27692)** to **[u/jhpalmieri/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/python3/ticket-27692)**



---

archive/issue_comments_432149.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nI'm getting some doctest failures with Python 3. Does anyone else see them?\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/categories/category.py  # 5 doctests failed\nsage -t --long src/sage/categories/primer.py  # 1 doctest failed\nsage -t --long src/sage/categories/category_with_axiom.py  # 5 doctests failed\nsage -t --long src/sage/categories/homsets.py  # 1 doctest failed\nsage -t --long src/sage/categories/polyhedra.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\nFor example:\n\n```\nsage -t --long src/sage/categories/homsets.py\n**********************************************************************\nFile \"src/sage/categories/homsets.py\", line 56, in sage.categories.homsets.HomsetsCategory.default_super_categories\nFailed example:\n    type(H)\nExpected:\n    <class 'sage.categories.additive_monoids.AdditiveMonoids.Homsets_with_category'>\nGot:\n    <class 'sage.categories.additive_monoids.Homsets_with_category'>\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ce1df63395571218cc6659e73660c5d7b0adca6\">6ce1df6</a></td><td><code>trac 27692: pyflakes cleanup in sage_autodoc.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca\">4475f30</a></td><td><code>trac 27692: move some references to master bibliography file</code></td></tr></table>\n",
    "created_at": "2019-06-14T21:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432149",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:46" align="right">Comment 46</div>

I'm getting some doctest failures with Python 3. Does anyone else see them?

```
----------------------------------------------------------------------
sage -t --long src/sage/categories/category.py  # 5 doctests failed
sage -t --long src/sage/categories/primer.py  # 1 doctest failed
sage -t --long src/sage/categories/category_with_axiom.py  # 5 doctests failed
sage -t --long src/sage/categories/homsets.py  # 1 doctest failed
sage -t --long src/sage/categories/polyhedra.py  # 1 doctest failed
----------------------------------------------------------------------
```
For example:

```
sage -t --long src/sage/categories/homsets.py
**********************************************************************
File "src/sage/categories/homsets.py", line 56, in sage.categories.homsets.HomsetsCategory.default_super_categories
Failed example:
    type(H)
Expected:
    <class 'sage.categories.additive_monoids.AdditiveMonoids.Homsets_with_category'>
Got:
    <class 'sage.categories.additive_monoids.Homsets_with_category'>
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ce1df63395571218cc6659e73660c5d7b0adca6">6ce1df6</a></td><td><code>trac 27692: pyflakes cleanup in sage_autodoc.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca">4475f30</a></td><td><code>trac 27692: move some references to master bibliography file</code></td></tr></table>




---

archive/issue_comments_432150.json:
```json
{
    "body": "Changed commit from **[8337e67](https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4)** to **[4475f30](https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca)**",
    "created_at": "2019-06-14T21:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432150",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[8337e67](https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4)** to **[4475f30](https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca)**



---

archive/issue_comments_432151.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nI can confirm the same failure in categories/ with the present branch here.",
    "created_at": "2019-06-15T06:39:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432151",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:47" align="right">Comment 47</div>

I can confirm the same failure in categories/ with the present branch here.



---

archive/issue_comments_432152.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nThis has doctests failure with python3",
    "created_at": "2019-06-18T06:40:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432152",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:48" align="right">Comment 48</div>

This has doctests failure with python3



---

archive/issue_events_361772.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-18T06:40:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361772"
}
```



---

archive/issue_events_361773.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-18T06:40:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361773"
}
```



---

archive/issue_comments_432153.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nMoving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432153",
    "user": "https://github.com/embray"
}
```

<div id="comment:49" align="right">Comment 49</div>

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_events_361774.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361774"
}
```



---

archive/issue_events_361775.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361775"
}
```



---

archive/issue_comments_432154.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nIs there any hope for progress here ?\n\nEDIT: the branch is now red",
    "created_at": "2019-07-03T12:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432154",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:50" align="right">Comment 50</div>

Is there any hope for progress here ?

EDIT: the branch is now red



---

archive/issue_comments_432155.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nI have made #28105 for just moving the references.",
    "created_at": "2019-07-03T12:27:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432155",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:51" align="right">Comment 51</div>

I have made #28105 for just moving the references.



---

archive/issue_comments_432156.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nErik, John ? The branch is now red. Is there any hope to make at least a partial progress on this file ?",
    "created_at": "2019-07-10T19:45:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432156",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:52" align="right">Comment 52</div>

Erik, John ? The branch is now red. Is there any hope to make at least a partial progress on this file ?



---

archive/issue_comments_432157.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nReplying to [@embray](#comment%3A28):\n> There does appear to be a legitimate issue here w.r.t. Sphinx.\n> \n> In the class `QuasiSymmetricFunctions` the nested class `Fundamental` also has an alias of just `F`.  That is, in the class body it has:\n> \n> ```\n> F = Fundamental\n> ```\n> \n> just as a shortcut.  This does not affect the qualified name of the class, which is still correct:\n> \n> ```\n> sage: QuasiSymmetricFunctions.Fundamental.__qualname__\n> 'QuasiSymmetricFunctions.Fundamental'\n> ```\n> \n> but for some reason Sphinx is outputting the docs for `QuasiSymmetricFunctions` with this nested class listed as just \"F\" instead of \"Fundamental\", whereas in the [current docs](http://doc.sagemath.org/html/en/reference/combinat/sage/combinat/ncsf_qsym/qsym.html#sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Fundamental) it's listed correctly as \"Fundamental\".\n\nI don't see this problem, at least with a Python 3 build. I see\n\n```\nF\n    alias of QuasiSymmetricFunctions.Fundamental\n\nclass Fundamental(QSym)\n    ...\n```\nWithout this branch, the first two lines are missing, but everything else looks the same.",
    "created_at": "2019-07-10T20:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432157",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:53" align="right">Comment 53</div>

Replying to [@embray](#comment%3A28):
> There does appear to be a legitimate issue here w.r.t. Sphinx.
> 
> In the class `QuasiSymmetricFunctions` the nested class `Fundamental` also has an alias of just `F`.  That is, in the class body it has:
> 
> ```
> F = Fundamental
> ```
> 
> just as a shortcut.  This does not affect the qualified name of the class, which is still correct:
> 
> ```
> sage: QuasiSymmetricFunctions.Fundamental.__qualname__
> 'QuasiSymmetricFunctions.Fundamental'
> ```
> 
> but for some reason Sphinx is outputting the docs for `QuasiSymmetricFunctions` with this nested class listed as just "F" instead of "Fundamental", whereas in the [current docs](http://doc.sagemath.org/html/en/reference/combinat/sage/combinat/ncsf_qsym/qsym.html#sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Fundamental) it's listed correctly as "Fundamental".

I don't see this problem, at least with a Python 3 build. I see

```
F
    alias of QuasiSymmetricFunctions.Fundamental

class Fundamental(QSym)
    ...
```
Without this branch, the first two lines are missing, but everything else looks the same.



---

archive/issue_comments_432158.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nOn the other hand, with this branch I see a new py3 doctest failure:\n\n```\nFile \"src/sage/misc/c3_controlled.pyx\", line 449, in sage.misc.c3_controlled.CmpKey\nFailed example:\n    Sets().Infinite()._cmp_key\nExpected:\n    (4, ...)\nGot:\n    (0, 40)\n**********************************************************************\n1 item had failures:\n   1 of  27 in sage.misc.c3_controlled.CmpKey\n```",
    "created_at": "2019-07-10T20:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432158",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:54" align="right">Comment 54</div>

On the other hand, with this branch I see a new py3 doctest failure:

```
File "src/sage/misc/c3_controlled.pyx", line 449, in sage.misc.c3_controlled.CmpKey
Failed example:
    Sets().Infinite()._cmp_key
Expected:
    (4, ...)
Got:
    (0, 40)
**********************************************************************
1 item had failures:
   1 of  27 in sage.misc.c3_controlled.CmpKey
```



---

archive/issue_comments_432159.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67f61320de40510c21c4dc148de092f002e19c3c\">67f6132</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f63e7d44b7313590f1e315e832599a5e77c627a\">5f63e7d</a></td><td><code>Fix up sage_autodoc to work with normal Python 3 nested classes with qualnames,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8a9b9fafceec5d00661410386e247801441339e\">e8a9b9f</a></td><td><code>trac 27692: pyflakes cleanup in sage_autodoc.py</code></td></tr></table>\n",
    "created_at": "2019-07-10T21:30:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432159",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:55" align="right">Comment 55</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67f61320de40510c21c4dc148de092f002e19c3c">67f6132</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f63e7d44b7313590f1e315e832599a5e77c627a">5f63e7d</a></td><td><code>Fix up sage_autodoc to work with normal Python 3 nested classes with qualnames,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8a9b9fafceec5d00661410386e247801441339e">e8a9b9f</a></td><td><code>trac 27692: pyflakes cleanup in sage_autodoc.py</code></td></tr></table>




---

archive/issue_comments_432160.json:
```json
{
    "body": "Changed commit from **[4475f30](https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca)** to **[e8a9b9f](https://github.com/sagemath/sagetrac-mirror/commit/e8a9b9fafceec5d00661410386e247801441339e)**",
    "created_at": "2019-07-10T21:30:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432160",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4475f30](https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca)** to **[e8a9b9f](https://github.com/sagemath/sagetrac-mirror/commit/e8a9b9fafceec5d00661410386e247801441339e)**



---

archive/issue_comments_432161.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nRebased to 8.9.beta2.",
    "created_at": "2019-07-10T21:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432161",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:56" align="right">Comment 56</div>

Rebased to 8.9.beta2.



---

archive/issue_comments_432162.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nIn my opinion, if the new doctest failure in `c3_controlled.pyx` can be fixed, then this is ready to go. I don't know what's causing it, though.",
    "created_at": "2019-07-10T23:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432162",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:57" align="right">Comment 57</div>

In my opinion, if the new doctest failure in `c3_controlled.pyx` can be fixed, then this is ready to go. I don't know what's causing it, though.



---

archive/issue_comments_432163.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nThis seems to be an issue with class name of `Sets().Infinite()`\n\nin the flags tables, one sees\n\n```\n{'FacadeSets': 1,\n 'FiniteSets': 2,\n 'Sets.Infinite': 4,\n 'EnumeratedSets': 8,\n```\nwhere the second line is the only line with a dot inside.",
    "created_at": "2019-07-11T10:25:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432163",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:58" align="right">Comment 58</div>

This seems to be an issue with class name of `Sets().Infinite()`

in the flags tables, one sees

```
{'FacadeSets': 1,
 'FiniteSets': 2,
 'Sets.Infinite': 4,
 'EnumeratedSets': 8,
```
where the second line is the only line with a dot inside.



---

archive/issue_comments_432164.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nIt may be more complicated than that. I made this change:\n\n```diff\ndiff --git a/src/sage/misc/c3_controlled.pyx b/src/sage/misc/c3_controlled.pyx\nindex 323086fb8e..9b404e8b70 100644\n--- a/src/sage/misc/c3_controlled.pyx\n+++ b/src/sage/misc/c3_controlled.pyx\n@@ -375,7 +375,7 @@ from sage.structure.dynamic_class import dynamic_class\n ##############################################################################\n \n cdef tuple atoms = (\"FacadeSets\",\n-                    \"FiniteSets\", \"Sets.Infinite\", \"EnumeratedSets\", \"SetsWithGrading\",\n+                    \"FiniteSets\", \"InfiniteSets\", \"EnumeratedSets\", \"SetsWithGrading\",\n                     \"Posets\", \"LatticePosets\", \"Crystals\", \"AdditiveMagmas\",\n                     \"FiniteDimensionalModules\", \"GradedModules\", \"ModulesWithBasis\",\n                     \"Magmas\", \"Semigroups\", \"Monoids\", \"PermutationGroups\",\n```\nand then added a statement to print `flags`. I got this:\n\n```\n{'FacadeSets': 1, 'FiniteSets': 2, 'InfiniteSets': 4, 'EnumeratedSets': 8, 'SetsWithGrading': 16, 'Posets': 32, 'LatticePosets': 64, 'Crystals': 128, 'AdditiveMagmas': 256, 'FiniteDimensionalModules': 512, 'GradedModules': 1024, 'ModulesWithBasis': 2048, 'Magmas': 4096, 'Semigroups': 8192, 'Monoids': 16384, 'PermutationGroups': 32768, 'MagmasAndAdditiveMagmas': 65536, 'Rngs': 131072, 'Domains': 262144, 'HopfAlgebras': 524288}\nsage: Sets().Finite()._cmp_key\n(2, 55)\nsage: Sets().Infinite()._cmp_key\n(0, 40)\nsage: Sets().Enumerated()._cmp_key\n(8, 42)\n```\nSo although `InfiniteSets` is now in `flags` with value of 4, the `_cmp_key` is still 0 for `Sets().Infinite()`.",
    "created_at": "2019-07-11T17:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432164",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:59" align="right">Comment 59</div>

It may be more complicated than that. I made this change:

```diff
diff --git a/src/sage/misc/c3_controlled.pyx b/src/sage/misc/c3_controlled.pyx
index 323086fb8e..9b404e8b70 100644
--- a/src/sage/misc/c3_controlled.pyx
+++ b/src/sage/misc/c3_controlled.pyx
@@ -375,7 +375,7 @@ from sage.structure.dynamic_class import dynamic_class
 ##############################################################################
 
 cdef tuple atoms = ("FacadeSets",
-                    "FiniteSets", "Sets.Infinite", "EnumeratedSets", "SetsWithGrading",
+                    "FiniteSets", "InfiniteSets", "EnumeratedSets", "SetsWithGrading",
                     "Posets", "LatticePosets", "Crystals", "AdditiveMagmas",
                     "FiniteDimensionalModules", "GradedModules", "ModulesWithBasis",
                     "Magmas", "Semigroups", "Monoids", "PermutationGroups",
```
and then added a statement to print `flags`. I got this:

```
{'FacadeSets': 1, 'FiniteSets': 2, 'InfiniteSets': 4, 'EnumeratedSets': 8, 'SetsWithGrading': 16, 'Posets': 32, 'LatticePosets': 64, 'Crystals': 128, 'AdditiveMagmas': 256, 'FiniteDimensionalModules': 512, 'GradedModules': 1024, 'ModulesWithBasis': 2048, 'Magmas': 4096, 'Semigroups': 8192, 'Monoids': 16384, 'PermutationGroups': 32768, 'MagmasAndAdditiveMagmas': 65536, 'Rngs': 131072, 'Domains': 262144, 'HopfAlgebras': 524288}
sage: Sets().Finite()._cmp_key
(2, 55)
sage: Sets().Infinite()._cmp_key
(0, 40)
sage: Sets().Enumerated()._cmp_key
(8, 42)
```
So although `InfiniteSets` is now in `flags` with value of 4, the `_cmp_key` is still 0 for `Sets().Infinite()`.



---

archive/issue_comments_432165.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nWithout this branch:\n\n```\nsage: C = Sets().Infinite()\nsage: C.__class__.__name__\n'Sets.Infinite_with_category'\n```\nWith this branch:\n\n```\nsage: C = Sets().Infinite()\nsage: C.__class__.__name__\n'Infinite_with_category'\n```\nChanging `Sets.Infinite` to just `Infinite` in `atoms` fixes the doctest, but it doesn't feel like the right thing to do.",
    "created_at": "2019-07-11T17:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432165",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:60" align="right">Comment 60</div>

Without this branch:

```
sage: C = Sets().Infinite()
sage: C.__class__.__name__
'Sets.Infinite_with_category'
```
With this branch:

```
sage: C = Sets().Infinite()
sage: C.__class__.__name__
'Infinite_with_category'
```
Changing `Sets.Infinite` to just `Infinite` in `atoms` fixes the doctest, but it doesn't feel like the right thing to do.



---

archive/issue_comments_432166.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nThis seems like a direct consequence of the change in `nested_class.pyx`. Do we do:\n\n```\nif PY2:\n    ... define atoms using Sets.Infinite ...\nelse:\n    ... define atoms using Infinite ...\n```\nSeems ugly.",
    "created_at": "2019-07-11T17:45:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432166",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:61" align="right">Comment 61</div>

This seems like a direct consequence of the change in `nested_class.pyx`. Do we do:

```
if PY2:
    ... define atoms using Sets.Infinite ...
else:
    ... define atoms using Infinite ...
```
Seems ugly.



---

archive/issue_comments_432167.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nFor example:\n\n```diff\ndiff --git a/src/sage/misc/c3_controlled.pyx b/src/sage/misc/c3_controlled.pyx\nindex 323086fb8e..2c7cd0f573 100644\n--- a/src/sage/misc/c3_controlled.pyx\n+++ b/src/sage/misc/c3_controlled.pyx\n@@ -369,13 +369,19 @@ from sage.misc.classcall_metaclass import ClasscallMetaclass, typecall\n from sage.misc.cachefunc import cached_function, cached_method\n from sage.misc.lazy_attribute import lazy_attribute\n from sage.structure.dynamic_class import dynamic_class\n+from six import PY2\n \n ##############################################################################\n # Implementation of the total order between categories\n ##############################################################################\n \n+if PY2:\n+    infinitesets = \"Sets.Infinite\"\n+else:\n+    infinitesets = \"Infinite\"\n+\n cdef tuple atoms = (\"FacadeSets\",\n-                    \"FiniteSets\", \"Sets.Infinite\", \"EnumeratedSets\", \"SetsWithGrading\",\n+                    \"FiniteSets\", infinitesets, \"EnumeratedSets\", \"SetsWithGrading\",\n                     \"Posets\", \"LatticePosets\", \"Crystals\", \"AdditiveMagmas\",\n                     \"FiniteDimensionalModules\", \"GradedModules\", \"ModulesWithBasis\",\n                     \"Magmas\", \"Semigroups\", \"Monoids\", \"PermutationGroups\",\n```\nI don't like it, but it works.",
    "created_at": "2019-07-11T17:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432167",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:62" align="right">Comment 62</div>

For example:

```diff
diff --git a/src/sage/misc/c3_controlled.pyx b/src/sage/misc/c3_controlled.pyx
index 323086fb8e..2c7cd0f573 100644
--- a/src/sage/misc/c3_controlled.pyx
+++ b/src/sage/misc/c3_controlled.pyx
@@ -369,13 +369,19 @@ from sage.misc.classcall_metaclass import ClasscallMetaclass, typecall
 from sage.misc.cachefunc import cached_function, cached_method
 from sage.misc.lazy_attribute import lazy_attribute
 from sage.structure.dynamic_class import dynamic_class
+from six import PY2
 
 ##############################################################################
 # Implementation of the total order between categories
 ##############################################################################
 
+if PY2:
+    infinitesets = "Sets.Infinite"
+else:
+    infinitesets = "Infinite"
+
 cdef tuple atoms = ("FacadeSets",
-                    "FiniteSets", "Sets.Infinite", "EnumeratedSets", "SetsWithGrading",
+                    "FiniteSets", infinitesets, "EnumeratedSets", "SetsWithGrading",
                     "Posets", "LatticePosets", "Crystals", "AdditiveMagmas",
                     "FiniteDimensionalModules", "GradedModules", "ModulesWithBasis",
                     "Magmas", "Semigroups", "Monoids", "PermutationGroups",
```
I don't like it, but it works.



---

archive/issue_comments_432168.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292\">4214075</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18\">291d584</a></td><td><code>Move this reference to the module level.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4\">8337e67</a></td><td><code>Fix up sage_autodoc to work with normal Python 3 nested classes with qualnames,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ce1df63395571218cc6659e73660c5d7b0adca6\">6ce1df6</a></td><td><code>trac 27692: pyflakes cleanup in sage_autodoc.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca\">4475f30</a></td><td><code>trac 27692: move some references to master bibliography file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78ab9c57bc7f136748b4de34df47085c70b4aa75\">78ab9c5</a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb6d5fa684eb8ba8ddce9c38211cfe1e2e83d2e8\">fb6d5fa</a></td><td><code>Keep NestedClassMetaClass functional even with Python 3</code></td></tr></table>\n",
    "created_at": "2019-07-11T21:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432168",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:63" align="right">Comment 63</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42140750b92b7827d3619d0c3c6abbd9b2790292">4214075</a></td><td><code>py3: Make NestedClassMetaclass do nothing on Python 3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/291d58442794d76d904404d9b58245d98d53ed18">291d584</a></td><td><code>Move this reference to the module level.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8337e67599e7e3e96c705fd48fd102123ace9dc4">8337e67</a></td><td><code>Fix up sage_autodoc to work with normal Python 3 nested classes with qualnames,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ce1df63395571218cc6659e73660c5d7b0adca6">6ce1df6</a></td><td><code>trac 27692: pyflakes cleanup in sage_autodoc.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4475f3072623e8a5f7a8e35d3fdcb4116e7990ca">4475f30</a></td><td><code>trac 27692: move some references to master bibliography file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78ab9c57bc7f136748b4de34df47085c70b4aa75">78ab9c5</a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb6d5fa684eb8ba8ddce9c38211cfe1e2e83d2e8">fb6d5fa</a></td><td><code>Keep NestedClassMetaClass functional even with Python 3</code></td></tr></table>




---

archive/issue_comments_432169.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/python3/ticket-27692)** to **[public/27692](https://github.com/sagemath/sagetrac-mirror/tree/public/27692)**",
    "created_at": "2019-07-11T21:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432169",
    "user": "https://github.com/kwankyu"
}
```

Changed branch from **[u/jhpalmieri/python3/ticket-27692](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/python3/ticket-27692)** to **[public/27692](https://github.com/sagemath/sagetrac-mirror/tree/public/27692)**



---

archive/issue_comments_432170.json:
```json
{
    "body": "Changed commit from **[e8a9b9f](https://github.com/sagemath/sagetrac-mirror/commit/e8a9b9fafceec5d00661410386e247801441339e)** to **[fb6d5fa](https://github.com/sagemath/sagetrac-mirror/commit/fb6d5fa684eb8ba8ddce9c38211cfe1e2e83d2e8)**",
    "created_at": "2019-07-11T21:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432170",
    "user": "https://github.com/kwankyu"
}
```

Changed commit from **[e8a9b9f](https://github.com/sagemath/sagetrac-mirror/commit/e8a9b9fafceec5d00661410386e247801441339e)** to **[fb6d5fa](https://github.com/sagemath/sagetrac-mirror/commit/fb6d5fa684eb8ba8ddce9c38211cfe1e2e83d2e8)**



---

archive/issue_comments_432171.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nIn the commit fb6d5fa, I followed different approach to solve the issue. I keep `NestedClassMetaclass` as it was even with python3, but fixes doctests appropriately for both python2 and python3. See the note in the module docstring.\n\nI think this approach is simple and the right one at this stage.\n\nTo a reviewer: I am not completely sure about what I wrote in the note. Please correct the note.",
    "created_at": "2019-07-11T22:02:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432171",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:64" align="right">Comment 64</div>

In the commit fb6d5fa, I followed different approach to solve the issue. I keep `NestedClassMetaclass` as it was even with python3, but fixes doctests appropriately for both python2 and python3. See the note in the module docstring.

I think this approach is simple and the right one at this stage.

To a reviewer: I am not completely sure about what I wrote in the note. Please correct the note.



---

archive/issue_events_361776.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2019-07-11T22:02:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361776"
}
```



---

archive/issue_events_361777.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2019-07-11T22:02:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361777"
}
```



---

archive/issue_comments_432172.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nTests pass for me. The approach seems okay to me, but I am not an expert on this aspect of the code. What do others think? @embray?",
    "created_at": "2019-07-12T15:04:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432172",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:66" align="right">Comment 66</div>

Tests pass for me. The approach seems okay to me, but I am not an expert on this aspect of the code. What do others think? @embray?



---

archive/issue_comments_432173.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">Comment 67</div>\n\nI add that Erik's approach should be considered when we drop the support on python2 and remove the nested class module altogether.",
    "created_at": "2019-07-15T00:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432173",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:67" align="right">Comment 67</div>

I add that Erik's approach should be considered when we drop the support on python2 and remove the nested class module altogether.



---

archive/issue_comments_432174.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">Comment 68</div>\n\nIt would be nice to improve the documentation. This is not a new addition, but what do \"save_global\" and \"load_global\" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)",
    "created_at": "2019-07-18T17:32:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432174",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:68" align="right">Comment 68</div>

It would be nice to improve the documentation. This is not a new addition, but what do "save_global" and "load_global" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)



---

archive/issue_comments_432175.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">Comment 69</div>\n\nThe only issue here is the note added by klee. Is it correct? If so, I think this is ready to go.",
    "created_at": "2019-07-18T17:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432175",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:69" align="right">Comment 69</div>

The only issue here is the note added by klee. Is it correct? If so, I think this is ready to go.



---

archive/issue_comments_432176.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">Comment 70</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04645f15a23259ec14ae054ae846bc6c29245a45\">04645f1</a></td><td><code>Correct the note</code></td></tr></table>\n",
    "created_at": "2019-07-19T02:10:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432176",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:70" align="right">Comment 70</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04645f15a23259ec14ae054ae846bc6c29245a45">04645f1</a></td><td><code>Correct the note</code></td></tr></table>




---

archive/issue_comments_432177.json:
```json
{
    "body": "Changed commit from **[fb6d5fa](https://github.com/sagemath/sagetrac-mirror/commit/fb6d5fa684eb8ba8ddce9c38211cfe1e2e83d2e8)** to **[04645f1](https://github.com/sagemath/sagetrac-mirror/commit/04645f15a23259ec14ae054ae846bc6c29245a45)**",
    "created_at": "2019-07-19T02:10:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432177",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fb6d5fa](https://github.com/sagemath/sagetrac-mirror/commit/fb6d5fa684eb8ba8ddce9c38211cfe1e2e83d2e8)** to **[04645f1](https://github.com/sagemath/sagetrac-mirror/commit/04645f15a23259ec14ae054ae846bc6c29245a45)**



---

archive/issue_comments_432178.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">Comment 71</div>\n\nReplying to [@jhpalmieri](#comment%3A68):\n> It would be nice to improve the documentation. This is not a new addition, but what do \"save_global\" and \"load_global\" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)\n\nThey are C functions in cPickle module (actually cPickle.c), and not visible to a user.",
    "created_at": "2019-07-19T02:13:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432178",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:71" align="right">Comment 71</div>

Replying to [@jhpalmieri](#comment%3A68):
> It would be nice to improve the documentation. This is not a new addition, but what do "save_global" and "load_global" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)

They are C functions in cPickle module (actually cPickle.c), and not visible to a user.



---

archive/issue_comments_432179.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">Comment 72</div>\n\nIn the last commit, I corrected the note, after investigating cPickle of python2 and the pickle module of python3. So I am now sure that what it says is correct.\n\nI think this ticket is now good to go.",
    "created_at": "2019-07-19T02:15:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432179",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:72" align="right">Comment 72</div>

In the last commit, I corrected the note, after investigating cPickle of python2 and the pickle module of python3. So I am now sure that what it says is correct.

I think this ticket is now good to go.



---

archive/issue_comments_432180.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">Comment 73</div>\n\nReplying to [@kwankyu](#comment%3A71):\n> Replying to [@jhpalmieri](#comment%3A68):\n> > It would be nice to improve the documentation. This is not a new addition, but what do \"save_global\" and \"load_global\" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)\n\n> \n> They are C functions in cPickle module (actually cPickle.c), and not visible to a user.\n\nExactly. Not only not visible to a user, but as I said, not documented anywhere, so having them as part of our documentation is not helpful.",
    "created_at": "2019-07-19T05:09:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432180",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:73" align="right">Comment 73</div>

Replying to [@kwankyu](#comment%3A71):
> Replying to [@jhpalmieri](#comment%3A68):
> > It would be nice to improve the documentation. This is not a new addition, but what do "save_global" and "load_global" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)

> 
> They are C functions in cPickle module (actually cPickle.c), and not visible to a user.

Exactly. Not only not visible to a user, but as I said, not documented anywhere, so having them as part of our documentation is not helpful.



---

archive/issue_comments_432181.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">Comment 74</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/040265b3d75faac9df1b5618ed1035943edb1de9\">040265b</a></td><td><code>Remove mentioning undocumented functions in cPickle</code></td></tr></table>\n",
    "created_at": "2019-07-19T06:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432181",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74" align="right">Comment 74</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/040265b3d75faac9df1b5618ed1035943edb1de9">040265b</a></td><td><code>Remove mentioning undocumented functions in cPickle</code></td></tr></table>




---

archive/issue_comments_432182.json:
```json
{
    "body": "Changed commit from **[04645f1](https://github.com/sagemath/sagetrac-mirror/commit/04645f15a23259ec14ae054ae846bc6c29245a45)** to **[040265b](https://github.com/sagemath/sagetrac-mirror/commit/040265b3d75faac9df1b5618ed1035943edb1de9)**",
    "created_at": "2019-07-19T06:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432182",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[04645f1](https://github.com/sagemath/sagetrac-mirror/commit/04645f15a23259ec14ae054ae846bc6c29245a45)** to **[040265b](https://github.com/sagemath/sagetrac-mirror/commit/040265b3d75faac9df1b5618ed1035943edb1de9)**



---

archive/issue_comments_432183.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">Comment 75</div>\n\nReplying to [@jhpalmieri](#comment%3A73):\n> Replying to [@kwankyu](#comment%3A71):\n> > Replying to [@jhpalmieri](#comment%3A68):\n> > > It would be nice to improve the documentation. This is not a new addition, but what do \"save_global\" and \"load_global\" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)\n\n> > \n> > They are C functions in cPickle module (actually cPickle.c), and not visible to a user.\n\n> \n> Exactly. Not only not visible to a user, but as I said, not documented anywhere, so having them as part of our documentation is not helpful.\n\nOk. Then let's remove them here.",
    "created_at": "2019-07-19T06:02:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432183",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:75" align="right">Comment 75</div>

Replying to [@jhpalmieri](#comment%3A73):
> Replying to [@kwankyu](#comment%3A71):
> > Replying to [@jhpalmieri](#comment%3A68):
> > > It would be nice to improve the documentation. This is not a new addition, but what do "save_global" and "load_global" refer to? I guess they are methods in Python's pickle module, but they are undocumented, which makes them less than ideal as reference points. (Fixing this could certainly wait until another ticket.)

> > 
> > They are C functions in cPickle module (actually cPickle.c), and not visible to a user.

> 
> Exactly. Not only not visible to a user, but as I said, not documented anywhere, so having them as part of our documentation is not helpful.

Ok. Then let's remove them here.



---

archive/issue_comments_432184.json:
```json
{
    "body": "Changed author from **Erik Bray** to **Erik Bray, Kwankyu Lee**",
    "created_at": "2019-07-20T10:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432184",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Erik Bray** to **Erik Bray, Kwankyu Lee**



---

archive/issue_comments_432185.json:
```json
{
    "body": "Changed reviewer from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, John Palmieri, Kwankyu Lee**",
    "created_at": "2019-07-20T10:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432185",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Frédéric Chapoton** to **Frédéric Chapoton, John Palmieri, Kwankyu Lee**



---

archive/issue_comments_432186.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">Comment 76</div>\n\nI think that it is more than time to move on here.\n\nGiven that John and Kwankyu said \"good to go\", I am setting to positive",
    "created_at": "2019-07-20T10:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432186",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:76" align="right">Comment 76</div>

I think that it is more than time to move on here.

Given that John and Kwankyu said "good to go", I am setting to positive



---

archive/issue_events_361778.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-20T10:57:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361778"
}
```



---

archive/issue_events_361779.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-20T10:57:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361779"
}
```



---

archive/issue_events_361780.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-23T21:03:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361780"
}
```



---

archive/issue_events_361781.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-23T21:03:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361781"
}
```



---

archive/issue_comments_432187.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">Comment 77</div>\n\nNow it fails on py2 with:\n\n```\n[dochtml] OSError: /var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/tableau.py:docstring of sage.combinat.tableau.Tableaux.Element.promotion:40: WARNING: Duplicate explicit target name: \"hai1992\".\n```",
    "created_at": "2019-07-23T21:03:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432187",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:77" align="right">Comment 77</div>

Now it fails on py2 with:

```
[dochtml] OSError: /var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/tableau.py:docstring of sage.combinat.tableau.Tableaux.Element.promotion:40: WARNING: Duplicate explicit target name: "hai1992".
```



---

archive/issue_comments_432188.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">Comment 78</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1e3a4c553ef07e708b21de402d24c7e3e916cab\">a1e3a4c</a></td><td><code>Merge branch 'develop' into t/27692/public/27692</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86df126957ba2b27bd97dcf90887f5e4608476cf\">86df126</a></td><td><code>trac 27692: fix one citation</code></td></tr></table>\n",
    "created_at": "2019-07-23T23:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432188",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:78" align="right">Comment 78</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1e3a4c553ef07e708b21de402d24c7e3e916cab">a1e3a4c</a></td><td><code>Merge branch 'develop' into t/27692/public/27692</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86df126957ba2b27bd97dcf90887f5e4608476cf">86df126</a></td><td><code>trac 27692: fix one citation</code></td></tr></table>




---

archive/issue_comments_432189.json:
```json
{
    "body": "Changed commit from **[040265b](https://github.com/sagemath/sagetrac-mirror/commit/040265b3d75faac9df1b5618ed1035943edb1de9)** to **[86df126](https://github.com/sagemath/sagetrac-mirror/commit/86df126957ba2b27bd97dcf90887f5e4608476cf)**",
    "created_at": "2019-07-23T23:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432189",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[040265b](https://github.com/sagemath/sagetrac-mirror/commit/040265b3d75faac9df1b5618ed1035943edb1de9)** to **[86df126](https://github.com/sagemath/sagetrac-mirror/commit/86df126957ba2b27bd97dcf90887f5e4608476cf)**



---

archive/issue_events_361782.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-07-23T23:38:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361782"
}
```



---

archive/issue_events_361783.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-07-23T23:38:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361783"
}
```



---

archive/issue_comments_432190.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">Comment 79</div>\n\nThis should fix the problem.",
    "created_at": "2019-07-23T23:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432190",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:79" align="right">Comment 79</div>

This should fix the problem.



---

archive/issue_comments_432191.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">Comment 80</div>\n\nNow the pdf docs are broken\n\n```\n[docpdf] Underfull \\hbox (badness 10000) in paragraph at lines 4766--4767\n[docpdf] \\T1/ptm/m/n/10 Bases: [][]\\T1/pcr/m/n/10 sage.categories.category_with_axiom.\n[docpdf] \n[docpdf] ! LaTeX Error: Too deeply nested.\n[docpdf] \n[docpdf] See the LaTeX manual or LaTeX Companion for explanation.\n[docpdf] Type  H <return>  for immediate help.\n[docpdf]  ...                                              \n[docpdf]                                                   \n[docpdf] l.4779 \\begin{itemize}\n[docpdf]                       \n[docpdf] ? \n[docpdf] ! Emergency stop.\n[docpdf]  ...                                              \n```",
    "created_at": "2019-07-27T22:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432191",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:80" align="right">Comment 80</div>

Now the pdf docs are broken

```
[docpdf] Underfull \hbox (badness 10000) in paragraph at lines 4766--4767
[docpdf] \T1/ptm/m/n/10 Bases: [][]\T1/pcr/m/n/10 sage.categories.category_with_axiom.
[docpdf] 
[docpdf] ! LaTeX Error: Too deeply nested.
[docpdf] 
[docpdf] See the LaTeX manual or LaTeX Companion for explanation.
[docpdf] Type  H <return>  for immediate help.
[docpdf]  ...                                              
[docpdf]                                                   
[docpdf] l.4779 \begin{itemize}
[docpdf]                       
[docpdf] ? 
[docpdf] ! Emergency stop.
[docpdf]  ...                                              
```



---

archive/issue_events_361784.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-27T22:27:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361784"
}
```



---

archive/issue_events_361785.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-27T22:27:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361785"
}
```



---

archive/issue_comments_432192.json:
```json
{
    "body": "Changed commit from **[86df126](https://github.com/sagemath/sagetrac-mirror/commit/86df126957ba2b27bd97dcf90887f5e4608476cf)** to **[2f3fc35](https://github.com/sagemath/sagetrac-mirror/commit/2f3fc35b3806fdd731bf5b90f11ff95df389eae8)**",
    "created_at": "2019-07-28T17:46:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432192",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[86df126](https://github.com/sagemath/sagetrac-mirror/commit/86df126957ba2b27bd97dcf90887f5e4608476cf)** to **[2f3fc35](https://github.com/sagemath/sagetrac-mirror/commit/2f3fc35b3806fdd731bf5b90f11ff95df389eae8)**



---

archive/issue_comments_432193.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">Comment 81</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13eb46fdaf4fb5642bfb335ea8e41ddddbd6a2a9\">13eb46f</a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb30abbb79fef6c84337713afefb3d681f914c51\">fb30abb</a></td><td><code>Merge branch 'public/27692'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fefe75ee6fa08988be259d158c9af1c8319ff411\">fefe75e</a></td><td><code>Fix class documenter in sage_autodoc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f3fc35b3806fdd731bf5b90f11ff95df389eae8\">2f3fc35</a></td><td><code>Recover some original docstrings</code></td></tr></table>\n",
    "created_at": "2019-07-28T17:46:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432193",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:81" align="right">Comment 81</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13eb46fdaf4fb5642bfb335ea8e41ddddbd6a2a9">13eb46f</a></td><td><code>Merge branch 'develop'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb30abbb79fef6c84337713afefb3d681f914c51">fb30abb</a></td><td><code>Merge branch 'public/27692'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fefe75ee6fa08988be259d158c9af1c8319ff411">fefe75e</a></td><td><code>Fix class documenter in sage_autodoc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f3fc35b3806fdd731bf5b90f11ff95df389eae8">2f3fc35</a></td><td><code>Recover some original docstrings</code></td></tr></table>




---

archive/issue_comments_432194.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">Comment 82</div>\n\nSeems to have fixed pdf docs.",
    "created_at": "2019-07-28T17:50:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432194",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:82" align="right">Comment 82</div>

Seems to have fixed pdf docs.



---

archive/issue_events_361786.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2019-07-28T17:50:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361786"
}
```



---

archive/issue_events_361787.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2019-07-28T17:50:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361787"
}
```



---

archive/issue_comments_432195.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">Comment 84</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8cc2149816f2045f8476bd61acf4550d8c6698a\">d8cc214</a></td><td><code>Make aliases documented</code></td></tr></table>\n",
    "created_at": "2019-07-29T06:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432195",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:84" align="right">Comment 84</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8cc2149816f2045f8476bd61acf4550d8c6698a">d8cc214</a></td><td><code>Make aliases documented</code></td></tr></table>




---

archive/issue_comments_432196.json:
```json
{
    "body": "Changed commit from **[2f3fc35](https://github.com/sagemath/sagetrac-mirror/commit/2f3fc35b3806fdd731bf5b90f11ff95df389eae8)** to **[d8cc214](https://github.com/sagemath/sagetrac-mirror/commit/d8cc2149816f2045f8476bd61acf4550d8c6698a)**",
    "created_at": "2019-07-29T06:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432196",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2f3fc35](https://github.com/sagemath/sagetrac-mirror/commit/2f3fc35b3806fdd731bf5b90f11ff95df389eae8)** to **[d8cc214](https://github.com/sagemath/sagetrac-mirror/commit/d8cc2149816f2045f8476bd61acf4550d8c6698a)**



---

archive/issue_comments_432197.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">Comment 85</div>\n\nThe last commit makes aliases of nested classes documented.\n\nIt looks all good to me. But the nested class stuff of Sage is very subtle, and these changes might have unexpected effects at unexpected places in the documentation. \n\nPlease check the generated docs carefully, before we move on.",
    "created_at": "2019-07-29T06:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432197",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:85" align="right">Comment 85</div>

The last commit makes aliases of nested classes documented.

It looks all good to me. But the nested class stuff of Sage is very subtle, and these changes might have unexpected effects at unexpected places in the documentation. 

Please check the generated docs carefully, before we move on.



---

archive/issue_comments_432198.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">Comment 86</div>\n\nNeeds rebasing on top of 8.9.beta4.",
    "created_at": "2019-07-29T07:10:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432198",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:86" align="right">Comment 86</div>

Needs rebasing on top of 8.9.beta4.



---

archive/issue_comments_432199.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">Comment 87</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2\">562ff1e</a></td><td><code>Fix nested_class for python 3</code></td></tr></table>\n",
    "created_at": "2019-07-29T07:52:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432199",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:87" align="right">Comment 87</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2">562ff1e</a></td><td><code>Fix nested_class for python 3</code></td></tr></table>




---

archive/issue_comments_432200.json:
```json
{
    "body": "Changed commit from **[d8cc214](https://github.com/sagemath/sagetrac-mirror/commit/d8cc2149816f2045f8476bd61acf4550d8c6698a)** to **[562ff1e](https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2)**",
    "created_at": "2019-07-29T07:52:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432200",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d8cc214](https://github.com/sagemath/sagetrac-mirror/commit/d8cc2149816f2045f8476bd61acf4550d8c6698a)** to **[562ff1e](https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2)**



---

archive/issue_comments_432201.json:
```json
{
    "body": "Changed reviewer from **Fr\u00e9d\u00e9ric Chapoton, John Palmieri, Kwankyu Lee** to **Fr\u00e9d\u00e9ric Chapoton, John Palmieri**",
    "created_at": "2019-07-29T09:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432201",
    "user": "https://github.com/kwankyu"
}
```

Changed reviewer from **Frédéric Chapoton, John Palmieri, Kwankyu Lee** to **Frédéric Chapoton, John Palmieri**



---

archive/issue_comments_432202.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">Comment 89</div>\n\nWith the new version, attributes appear in the reference manual. This is a change, but it is fine with me.",
    "created_at": "2019-07-29T22:44:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432202",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:89" align="right">Comment 89</div>

With the new version, attributes appear in the reference manual. This is a change, but it is fine with me.



---

archive/issue_events_361788.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-07-29T23:26:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361788"
}
```



---

archive/issue_events_361789.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-07-29T23:26:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361789"
}
```



---

archive/issue_comments_432203.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">Comment 90</div>\n\nThat's the only real difference, as far as I can tell. There may be some small differences in the indices (files like http://doc.sagemath.org/html/en/reference/genindex-A.html), as well, but very minor ones. I am happy with this.\n\n(Edit: I built docs with both Python 2 and Python 3, with and without this branch, and ran `diff -r ...` on the resulting doc directories, so I could see all of the differences. I only checked the `html` and `latex` output.)",
    "created_at": "2019-07-29T23:26:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432203",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:90" align="right">Comment 90</div>

That's the only real difference, as far as I can tell. There may be some small differences in the indices (files like http://doc.sagemath.org/html/en/reference/genindex-A.html), as well, but very minor ones. I am happy with this.

(Edit: I built docs with both Python 2 and Python 3, with and without this branch, and ran `diff -r ...` on the resulting doc directories, so I could see all of the differences. I only checked the `html` and `latex` output.)



---

archive/issue_comments_432204.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">Comment 91</div>\n\nI am also happy with more documentation. Just for the record, more members of a class, like attributes and aliases, now appear in the documentation because of a  change in `skip_member` function defined in `sage/docs/conf.py`, which used to skip them for documentation:\n\n```\n     objname = getattr(obj, \"__name__\", None)\n     if objname is not None:\n-        if objname.find('.') != -1 and objname.split('.')[-1] != name:\n-            return True\n+        # check if name was inserted to the module by NestedClassMetaclass\n+        if name.find('.') != -1 and objname.find('.') != -1:\n+            if objname.split('.')[-1] == name.split('.')[-1]:\n+                return True\n \n     if name.find(\"userchild_download_worksheets.zip\") != -1:\n         return True\n```",
    "created_at": "2019-07-30T01:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432204",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:91" align="right">Comment 91</div>

I am also happy with more documentation. Just for the record, more members of a class, like attributes and aliases, now appear in the documentation because of a  change in `skip_member` function defined in `sage/docs/conf.py`, which used to skip them for documentation:

```
     objname = getattr(obj, "__name__", None)
     if objname is not None:
-        if objname.find('.') != -1 and objname.split('.')[-1] != name:
-            return True
+        # check if name was inserted to the module by NestedClassMetaclass
+        if name.find('.') != -1 and objname.find('.') != -1:
+            if objname.split('.')[-1] == name.split('.')[-1]:
+                return True
 
     if name.find("userchild_download_worksheets.zip") != -1:
         return True
```



---

archive/issue_events_361790.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-01T22:55:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361790"
}
```



---

archive/issue_events_361791.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "92ff95d408a3655a2383353ce92a2948b7f794d3",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-08-01T22:55:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27692#event-361791"
}
```



---

archive/issue_comments_432205.json:
```json
{
    "body": "Changed branch from **[public/27692](https://github.com/sagemath/sagetrac-mirror/tree/public/27692)** to **[562ff1e](https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2)**",
    "created_at": "2019-08-01T22:55:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27692#issuecomment-432205",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/27692](https://github.com/sagemath/sagetrac-mirror/tree/public/27692)** to **[562ff1e](https://github.com/sagemath/sagetrac-mirror/commit/562ff1e1f69908bdc5a622a61510d5bdea8c51b2)**
