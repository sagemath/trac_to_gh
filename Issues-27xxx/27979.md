# Issue 27979: Add missing implementation in Macaulay2 interface

archive/issues_027742.json:
```json
{
    "body": "This ticket implements the following changes to the Macaulay2 interface:\n\n- Naming of Macaulay2/interface elements is improved.\n\n  The constructor for interface elements now correctly handles the `name` parameter (which previously got ignored in some cases). For example, this works now:\n  {{{\n  sage: A = macaulay2(ZZ['x,y,z'], name='A')\n  sage: A.name()\n  'A'\n  }}}\n\n  Moreover, Macaulay2Elements can now be renamed, as `name()` was implemented. In particular, this works for polynomial rings, so the `sage0`, etc., identifiers can be avoided in the Macaulay2 output. For example:\n  {{{\n  sage: S = macaulay2(QQ['x,y'])\n  sage: S.name()\n  'sage0'\n  sage: R = S.name(\"R\")\n  sage: R.name()\n  'R'\n  sage: R.vars().cokernel().resolution()\n   1      2      1\n  R  <-- R  <-- R  <-- 0\n\n  0      1      2      3\n  }}}\n\n- The `_contains` operator (i.e. `in`) is implemented:\n  {{{\n  sage: '\"x\"' in macaulay2('hashTable {\"x\" => 1}')\n  True\n  }}}\n\n- Seeds are implemented.\n\nMoreover, this ticket provides small fixes:\n\n- The syntax `..` for defining a polynomial ring can now be used more than just once:\n  {{{\n  sage: macaulay2.ring('QQ', '[a_0..a_2,b..<d,f]').vars()\n  | a_0 a_1 a_2 b c f |\n  }}}\n\n- Tab completion is slightly improved to avoid the use of global variables.\n\n- The `latex()` doctest now works with Macaulay2 1.12 and 1.13.\n\nKeywords: macaulay2\n\nBranch/Commit: 2eba33ce199bcdc52b3b1c7840e8174625865ae9\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Markus Wageringel\n\nDependencies: #27848\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27979\n\n",
    "closed_at": "2019-06-28T04:30:17Z",
    "created_at": "2019-06-12T21:34:14Z",
    "labels": [
        "component: interfaces: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Add missing implementation in Macaulay2 interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27979",
    "user": "https://github.com/mwageringel"
}
```
This ticket implements the following changes to the Macaulay2 interface:

- Naming of Macaulay2/interface elements is improved.

  The constructor for interface elements now correctly handles the `name` parameter (which previously got ignored in some cases). For example, this works now:
  {{{
  sage: A = macaulay2(ZZ['x,y,z'], name='A')
  sage: A.name()
  'A'
  }}}

  Moreover, Macaulay2Elements can now be renamed, as `name()` was implemented. In particular, this works for polynomial rings, so the `sage0`, etc., identifiers can be avoided in the Macaulay2 output. For example:
  {{{
  sage: S = macaulay2(QQ['x,y'])
  sage: S.name()
  'sage0'
  sage: R = S.name("R")
  sage: R.name()
  'R'
  sage: R.vars().cokernel().resolution()
   1      2      1
  R  <-- R  <-- R  <-- 0

  0      1      2      3
  }}}

- The `_contains` operator (i.e. `in`) is implemented:
  {{{
  sage: '"x"' in macaulay2('hashTable {"x" => 1}')
  True
  }}}

- Seeds are implemented.

Moreover, this ticket provides small fixes:

- The syntax `..` for defining a polynomial ring can now be used more than just once:
  {{{
  sage: macaulay2.ring('QQ', '[a_0..a_2,b..<d,f]').vars()
  | a_0 a_1 a_2 b c f |
  }}}

- Tab completion is slightly improved to avoid the use of global variables.

- The `latex()` doctest now works with Macaulay2 1.12 and 1.13.

Keywords: macaulay2

Branch/Commit: 2eba33ce199bcdc52b3b1c7840e8174625865ae9

Reviewer: Frédéric Chapoton

Author: Markus Wageringel

Dependencies: #27848

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27979





---

archive/issue_comments_541963.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-mwageringel/macaulay2_fixes_27979\"",
    "created_at": "2019-06-12T21:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541963",
    "user": "https://github.com/mwageringel"
}
```

Changing branch from "" to "u/gh-mwageringel/macaulay2_fixes_27979"



---

archive/issue_comments_541964.json:
```json
{
    "body": "Changing commit from \"\" to \"70bd941b1dde945b8562fbc30ea224ecb94b663a\"",
    "created_at": "2019-06-12T21:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541964",
    "user": "https://github.com/mwageringel"
}
```

Changing commit from "" to "70bd941b1dde945b8562fbc30ea224ecb94b663a"



---

archive/issue_comments_541965.json:
```json
{
    "body": "Changing author from \"\" to \"Markus Wageringel\"",
    "created_at": "2019-06-12T21:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541965",
    "user": "https://github.com/mwageringel"
}
```

Changing author from "" to "Markus Wageringel"



---

archive/issue_comments_541966.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe first two commits fixing some doctests are from #27848. To run the tests on all files that have optional Macaulay2 doctests, you can use:\n\n```\nsage -t --long --optional=sage,macaulay2 $(grep -i \"optional.*macaulay2\" -r src/sage -l | paste -sd \" \" -)\n```\nTested using Macaulay2 1.13.\n\n---\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[8bd9f5d](https://git.sagemath.org/sage.git/commit?id=8bd9f5d1ef51871de877455f79bf953c7193754c)|`Fixed further Macaulay2-related doctests`|\n|[406beb2](https://git.sagemath.org/sage.git/commit?id=406beb2d05430a3c7f1c13d4e208057571bad9d5)|`fix ascii art for matrices in Macaulay2 1.13+`|\n|[72296c3](https://git.sagemath.org/sage.git/commit?id=72296c3fec1846ca074449126093cc8b504f5e34)|`Fixed `..` notation for variables of M2 polynomial rings`|\n|[319caeb](https://git.sagemath.org/sage.git/commit?id=319caeb778281fedc6b29fedcf766f23b93a8d40)|`Make _tab_completion of Macaulay2 interface more robust`|\n|[a63d430](https://git.sagemath.org/sage.git/commit?id=a63d4305d87d33c2a48d40e0d18b7b7ad45b5cc6)|`Improve naming of interface/Macaulay2 elements`|\n|[6db4e9a](https://git.sagemath.org/sage.git/commit?id=6db4e9abbb3e5db8e0b3b2cab014768fadf95d4e)|`implement macaulay2._contains as #? operator`|\n|[70bd941](https://git.sagemath.org/sage.git/commit?id=70bd941b1dde945b8562fbc30ea224ecb94b663a)|`implement seed in Macaulay2 interface`|",
    "created_at": "2019-06-12T21:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541966",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:1'></a>
The first two commits fixing some doctests are from #27848. To run the tests on all files that have optional Macaulay2 doctests, you can use:

```
sage -t --long --optional=sage,macaulay2 $(grep -i "optional.*macaulay2" -r src/sage -l | paste -sd " " -)
```
Tested using Macaulay2 1.13.

---
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[8bd9f5d](https://git.sagemath.org/sage.git/commit?id=8bd9f5d1ef51871de877455f79bf953c7193754c)|`Fixed further Macaulay2-related doctests`|
|[406beb2](https://git.sagemath.org/sage.git/commit?id=406beb2d05430a3c7f1c13d4e208057571bad9d5)|`fix ascii art for matrices in Macaulay2 1.13+`|
|[72296c3](https://git.sagemath.org/sage.git/commit?id=72296c3fec1846ca074449126093cc8b504f5e34)|`Fixed `..` notation for variables of M2 polynomial rings`|
|[319caeb](https://git.sagemath.org/sage.git/commit?id=319caeb778281fedc6b29fedcf766f23b93a8d40)|`Make _tab_completion of Macaulay2 interface more robust`|
|[a63d430](https://git.sagemath.org/sage.git/commit?id=a63d4305d87d33c2a48d40e0d18b7b7ad45b5cc6)|`Improve naming of interface/Macaulay2 elements`|
|[6db4e9a](https://git.sagemath.org/sage.git/commit?id=6db4e9abbb3e5db8e0b3b2cab014768fadf95d4e)|`implement macaulay2._contains as #? operator`|
|[70bd941](https://git.sagemath.org/sage.git/commit?id=70bd941b1dde945b8562fbc30ea224ecb94b663a)|`implement seed in Macaulay2 interface`|



---

archive/issue_comments_541967.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-12T21:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541967",
    "user": "https://github.com/mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_541968.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-06-12T21:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541968",
    "user": "https://github.com/mwageringel"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_541969.json:
```json
{
    "body": "Changing commit from \"70bd941b1dde945b8562fbc30ea224ecb94b663a\" to \"201525bc9fbe2e4300adc5867b9d3624d105e9f2\"",
    "created_at": "2019-06-13T05:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "70bd941b1dde945b8562fbc30ea224ecb94b663a" to "201525bc9fbe2e4300adc5867b9d3624d105e9f2"



---

archive/issue_comments_541970.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[f7db332](https://git.sagemath.org/sage.git/commit/?id=f7db33289e651fbe9b8231b27d3dd74278ec1fd2)|`implement seed in Macaulay2 interface`|\n|[201525b](https://git.sagemath.org/sage.git/commit/?id=201525bc9fbe2e4300adc5867b9d3624d105e9f2)|`adjust latex() doctest for multiple Macaulay2 versions`|",
    "created_at": "2019-06-13T05:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541970",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[f7db332](https://git.sagemath.org/sage.git/commit/?id=f7db33289e651fbe9b8231b27d3dd74278ec1fd2)|`implement seed in Macaulay2 interface`|
|[201525b](https://git.sagemath.org/sage.git/commit/?id=201525bc9fbe2e4300adc5867b9d3624d105e9f2)|`adjust latex() doctest for multiple Macaulay2 versions`|



---

archive/issue_comments_541971.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe oldstyle print reported by the patchbot is not Python code, but Macaulay2 code, so not relevant.",
    "created_at": "2019-06-13T06:06:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541971",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:3'></a>
The oldstyle print reported by the patchbot is not Python code, but Macaulay2 code, so not relevant.



---

archive/issue_comments_541972.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -42,3 +42,4 @@\n \n - Tab completion is slightly improved to avoid the use of global variables.\n \n+- The `latex()` doctest now works with Macaulay2 1.12 and 1.13.\n``````\n",
    "created_at": "2019-06-13T06:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541972",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -42,3 +42,4 @@
 
 - Tab completion is slightly improved to avoid the use of global variables.
 
+- The `latex()` doctest now works with Macaulay2 1.12 and 1.13.
``````




---

archive/issue_comments_541973.json:
```json
{
    "body": "Changing commit from \"201525bc9fbe2e4300adc5867b9d3624d105e9f2\" to \"2eba33ce199bcdc52b3b1c7840e8174625865ae9\"",
    "created_at": "2019-06-21T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541973",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "201525bc9fbe2e4300adc5867b9d3624d105e9f2" to "2eba33ce199bcdc52b3b1c7840e8174625865ae9"



---

archive/issue_comments_541974.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-21T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541974",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_541975.json:
```json
{
    "body": "<a id='comment:5'></a>\nLooks good to me.\n\nI have rebased the branch on top of the branch of #27848. And then squashed the commits into a single one.\n\nI am setting this to positive.\n\n---\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[a4036cd](https://git.sagemath.org/sage.git/commit?id=a4036cd90cffae921775694882b8f260d516122a)|`Fixed further Macaulay2-related doctests`|\n|[c0321d3](https://git.sagemath.org/sage.git/commit?id=c0321d36db902e7afe450cc8bcecdde4e94294f5)|`fix ascii art for matrices in Macaulay2 1.13+`|\n|[7fe0483](https://git.sagemath.org/sage.git/commit?id=7fe0483d05774e15dae76ac08647fbd2c845404a)|`deprecate Macaulay2Element.to_sage`|\n|[68b5715](https://git.sagemath.org/sage.git/commit?id=68b5715da0aa18c249860c4a719c060088a5f998)|`deprecate Macaulay2Element.structure_sheaf`|\n|[e0ead46](https://git.sagemath.org/sage.git/commit?id=e0ead46643b671d0158424e98c7e77120f9b7ff8)|`py3 fixes`|\n|[2eba33c](https://git.sagemath.org/sage.git/commit?id=2eba33ce199bcdc52b3b1c7840e8174625865ae9)|`trac 27979 several enhancements to M2 interface`|",
    "created_at": "2019-06-21T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541975",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
Looks good to me.

I have rebased the branch on top of the branch of #27848. And then squashed the commits into a single one.

I am setting this to positive.

---
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[a4036cd](https://git.sagemath.org/sage.git/commit?id=a4036cd90cffae921775694882b8f260d516122a)|`Fixed further Macaulay2-related doctests`|
|[c0321d3](https://git.sagemath.org/sage.git/commit?id=c0321d36db902e7afe450cc8bcecdde4e94294f5)|`fix ascii art for matrices in Macaulay2 1.13+`|
|[7fe0483](https://git.sagemath.org/sage.git/commit?id=7fe0483d05774e15dae76ac08647fbd2c845404a)|`deprecate Macaulay2Element.to_sage`|
|[68b5715](https://git.sagemath.org/sage.git/commit?id=68b5715da0aa18c249860c4a719c060088a5f998)|`deprecate Macaulay2Element.structure_sheaf`|
|[e0ead46](https://git.sagemath.org/sage.git/commit?id=e0ead46643b671d0158424e98c7e77120f9b7ff8)|`py3 fixes`|
|[2eba33c](https://git.sagemath.org/sage.git/commit?id=2eba33ce199bcdc52b3b1c7840e8174625865ae9)|`trac 27979 several enhancements to M2 interface`|



---

archive/issue_comments_541976.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#27848\"",
    "created_at": "2019-06-21T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541976",
    "user": "https://github.com/fchapoton"
}
```

Changing dependencies from "" to "#27848"



---

archive/issue_comments_541977.json:
```json
{
    "body": "Changing branch from \"u/gh-mwageringel/macaulay2_fixes_27979\" to \"public/ticket/27979\"",
    "created_at": "2019-06-21T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541977",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "u/gh-mwageringel/macaulay2_fixes_27979" to "public/ticket/27979"



---

archive/issue_comments_541978.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2019-06-21T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541978",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton"



---

archive/issue_comments_541979.json:
```json
{
    "body": "<a id='comment:6'></a>\nThank you.",
    "created_at": "2019-06-21T19:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541979",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:6'></a>
Thank you.



---

archive/issue_events_069337.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-28T04:30:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27979#event-69337"
}
```



---

archive/issue_comments_541980.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-28T04:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541980",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_541981.json:
```json
{
    "body": "Changing branch from \"public/ticket/27979\" to \"2eba33ce199bcdc52b3b1c7840e8174625865ae9\"",
    "created_at": "2019-06-28T04:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541981",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/ticket/27979" to "2eba33ce199bcdc52b3b1c7840e8174625865ae9"



---

archive/issue_events_069338.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:34:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27979#event-69338"
}
```



---

archive/issue_comments_541982.json:
```json
{
    "body": "<a id='comment:8'></a>\nNot in Sage 8.8.  Let's please to try keep tickets' milestones related to the release in which we actually intend to include them, and in particular the release in which they were *actually* included, especially when closing tickets.",
    "created_at": "2019-07-03T11:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27979#issuecomment-541982",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
Not in Sage 8.8.  Let's please to try keep tickets' milestones related to the release in which we actually intend to include them, and in particular the release in which they were *actually* included, especially when closing tickets.
