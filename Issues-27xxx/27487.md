# Issue 27487: spkg-configure.m4 for cmake

archive/issues_027250.json:
```json
{
    "body": "CC:  @embray @kiwifb @slel @vinklein\n\npractically a copy of the one for patch\n\nIssue created by migration from https://trac.sagemath.org/ticket/27487\n\n",
    "closed_at": "2019-05-06T11:56:34Z",
    "created_at": "2019-03-14T16:26:25Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "spkg-configure.m4 for cmake",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27487",
    "user": "https://github.com/dimpase"
}
```
CC:  @embray @kiwifb @slel @vinklein

practically a copy of the one for patch

Issue created by migration from https://trac.sagemath.org/ticket/27487





---

archive/issue_comments_383559.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-14T16:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383559",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_383560.json:
```json
{
    "body": "Well, this system's cmake is < 3.11, so in this case it \"worked\" in that it refused to use my system cmake.  I don't know how strict the 3.11 requirement is but I'm fine with leaving it for now.\n\nI'll also test on a system with a newer cmake.",
    "created_at": "2019-03-14T16:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383560",
    "user": "https://github.com/embray"
}
```

Well, this system's cmake is < 3.11, so in this case it "worked" in that it refused to use my system cmake.  I don't know how strict the 3.11 requirement is but I'm fine with leaving it for now.

I'll also test on a system with a newer cmake.



---

archive/issue_comments_383561.json:
```json
{
    "body": "Apparently 3.11 is actually quite recent.  Unless there's a specific need for it, let's try setting to just 3.0 and see how that goes (my Cygwin has ~~3.8~~3.6.2 for example).",
    "created_at": "2019-03-14T16:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383561",
    "user": "https://github.com/embray"
}
```

Apparently 3.11 is actually quite recent.  Unless there's a specific need for it, let's try setting to just 3.0 and see how that goes (my Cygwin has ~~3.8~~3.6.2 for example).



---

archive/issue_comments_383562.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-03-14T16:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_383563.json:
```json
{
    "body": "OK, now it's 3.0.",
    "created_at": "2019-03-14T16:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383563",
    "user": "https://github.com/dimpase"
}
```

OK, now it's 3.0.



---

archive/issue_comments_383564.json:
```json
{
    "body": "Are you still checking this? There is an extra complication here that cmake\nkeeps 3.x for long, issuing updates with numbers 3.x.y to them on a regular basis.\nPerhaps it's better to go all the way to x big enough for the meaningful cases such as current cygwin etc.",
    "created_at": "2019-03-19T11:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383564",
    "user": "https://github.com/dimpase"
}
```

Are you still checking this? There is an extra complication here that cmake
keeps 3.x for long, issuing updates with numbers 3.x.y to them on a regular basis.
Perhaps it's better to go all the way to x big enough for the meaningful cases such as current cygwin etc.



---

archive/issue_events_068253.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27487#event-68253"
}
```



---

archive/issue_comments_383565.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383565",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_383566.json:
```json
{
    "body": "Note: we upgraded to cmake 3.11.0 in #25109 because cmake 3.8.1 was\nnot enough to build primecount 4.3 (an optional package).\n\nHowever, primecount 4.6 was released on 2019-04-13 and lowered the\nrequirement from cmake 3.9 to cmake 3.4, if I understand correctly.",
    "created_at": "2019-04-14T02:28:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383566",
    "user": "https://github.com/slel"
}
```

Note: we upgraded to cmake 3.11.0 in #25109 because cmake 3.8.1 was
not enough to build primecount 4.3 (an optional package).

However, primecount 4.6 was released on 2019-04-13 and lowered the
requirement from cmake 3.9 to cmake 3.4, if I understand correctly.



---

archive/issue_comments_383567.json:
```json
{
    "body": "See the [primecount changelog](https://github.com/kimwalisch/primecount/blob/master/ChangeLog)\n-- no tarball on the GitHub releases page yet.",
    "created_at": "2019-04-14T02:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383567",
    "user": "https://github.com/slel"
}
```

See the [primecount changelog](https://github.com/kimwalisch/primecount/blob/master/ChangeLog)
-- no tarball on the GitHub releases page yet.



---

archive/issue_comments_383568.json:
```json
{
    "body": "Tarball now uploaded to GitHub. The upgrade to primecount 4.6 is tracked at #27662.\n\nConsider cmake 3.4.3 (released 2016-01-25) rather than cmake 3.0.2 (released 2014-09-11).",
    "created_at": "2019-04-14T18:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383568",
    "user": "https://github.com/slel"
}
```

Tarball now uploaded to GitHub. The upgrade to primecount 4.6 is tracked at #27662.

Consider cmake 3.4.3 (released 2016-01-25) rather than cmake 3.0.2 (released 2014-09-11).



---

archive/issue_comments_383569.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-14T22:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383569",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_383570.json:
```json
{
    "body": "bumped up the minimal cmake version to 3.4.\nPlease review.",
    "created_at": "2019-04-14T22:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383570",
    "user": "https://github.com/dimpase"
}
```

bumped up the minimal cmake version to 3.4.
Please review.



---

archive/issue_comments_383571.json:
```json
{
    "body": "Okay, sounds good to me.  Does this mean we still need to upgrade primecount though?",
    "created_at": "2019-04-24T14:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383571",
    "user": "https://github.com/embray"
}
```

Okay, sounds good to me.  Does this mean we still need to upgrade primecount though?



---

archive/issue_comments_383572.json:
```json
{
    "body": "Replying to [comment:13 embray]:\n> Okay, sounds good to me.  Does this mean we still need to upgrade primecount though?\n\n\ndone at #27662",
    "created_at": "2019-04-25T05:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383572",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:13 embray]:
> Okay, sounds good to me.  Does this mean we still need to upgrade primecount though?


done at #27662



---

archive/issue_comments_383573.json:
```json
{
    "body": "To review: \n\n* pull the branch\n* make sure Sage's cmake is not installed. (`make cmake-clean` should do the job)\n* make sure you have `cmake` (version 3.4 or better) installed on the box.\n* run `./bootstrap` (you nedd autotools, yes)\n* run `./configure` and inspect its output - you should see that `cmake` is marked as `not installed)\n* to make sure this all works, try it on #27662 (or some other cmake-dependent Sage thing)\n\nAs this branch merely adds an `spkg-configure.m4` file, there is no pressing need to have Sage's configure package updated. It will get in as soon as an update of the latter happens.",
    "created_at": "2019-04-25T10:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383573",
    "user": "https://github.com/dimpase"
}
```

To review: 

* pull the branch
* make sure Sage's cmake is not installed. (`make cmake-clean` should do the job)
* make sure you have `cmake` (version 3.4 or better) installed on the box.
* run `./bootstrap` (you nedd autotools, yes)
* run `./configure` and inspect its output - you should see that `cmake` is marked as `not installed)
* to make sure this all works, try it on #27662 (or some other cmake-dependent Sage thing)

As this branch merely adds an `spkg-configure.m4` file, there is no pressing need to have Sage's configure package updated. It will get in as soon as an update of the latter happens.



---

archive/issue_comments_383574.json:
```json
{
    "body": "At least, `cmake-3.14.1` is successfully detected on arch.",
    "created_at": "2019-04-25T14:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383574",
    "user": "https://github.com/videlec"
}
```

At least, `cmake-3.14.1` is successfully detected on arch.



---

archive/issue_comments_383575.json:
```json
{
    "body": "And `sage -i primecount` did not trigger `cmake` compilation!\n\nThank you.",
    "created_at": "2019-04-25T14:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383575",
    "user": "https://github.com/videlec"
}
```

And `sage -i primecount` did not trigger `cmake` compilation!

Thank you.



---

archive/issue_comments_383576.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-25T14:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383576",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_383577.json:
```json
{
    "body": "Thanks!",
    "created_at": "2019-04-25T15:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383577",
    "user": "https://github.com/dimpase"
}
```

Thanks!



---

archive/issue_events_068254.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-06T11:56:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27487#event-68254"
}
```



---

archive/issue_comments_383578.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-05-06T11:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27487",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27487#issuecomment-383578",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
