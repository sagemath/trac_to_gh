# Issue 27534: Implement Lawrence extension for polytopes

archive/issues_027297.json:
```json
{
    "body": "Adding the following methods to base.py:\n* `lawrence_extension(self, v)`: \n  Return the Lawrence extension of `self` on the point `v`.\n* `lawrence_polytope(self)`:\n  Return the Lawrence polytope of `self`.\n* `is_lawrence_polytope(self)`:\n  Return `true` if `self` is a Lawrence polytope.\n\nfor definitions, see \nSection 6.6 of Lectures on Polytopes, G\u00fcnter M. Ziegler, [Zie2007]\n\n**CC:**  @jplab\n\n**Keywords:** polytopes, lawrence extension\n\n**Branch:** [bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)\n\n**Reviewer:** Jonathan Kliem\n\n**Author:** Laith Rastanawi\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27534\n\n",
    "closed_at": "2019-04-10T15:28:40Z",
    "created_at": "2019-03-22T15:28:19Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Implement Lawrence extension for polytopes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27534",
    "user": "https://github.com/LaisRast"
}
```
Adding the following methods to base.py:
* `lawrence_extension(self, v)`: 
  Return the Lawrence extension of `self` on the point `v`.
* `lawrence_polytope(self)`:
  Return the Lawrence polytope of `self`.
* `is_lawrence_polytope(self)`:
  Return `true` if `self` is a Lawrence polytope.

for definitions, see 
Section 6.6 of Lectures on Polytopes, Günter M. Ziegler, [Zie2007]

**CC:**  @jplab

**Keywords:** polytopes, lawrence extension

**Branch:** [bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)

**Reviewer:** Jonathan Kliem

**Author:** Laith Rastanawi

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/27534





---

archive/issue_comments_532951.json:
```json
{
    "body": "**Commit:** [a7849b3ecea4f36f7233940ee6d18a0af943013c](https://github.com/sagemath/sagetrac-mirror/commit/a7849b3ecea4f36f7233940ee6d18a0af943013c)",
    "created_at": "2019-03-22T15:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532951",
    "user": "https://github.com/LaisRast"
}
```

**Commit:** [a7849b3ecea4f36f7233940ee6d18a0af943013c](https://github.com/sagemath/sagetrac-mirror/commit/a7849b3ecea4f36f7233940ee6d18a0af943013c)



---

archive/issue_comments_532952.json:
```json
{
    "body": "**Branch:** [public/27534](https://github.com/sagemath/sagetrac-mirror/tree/public/27534)",
    "created_at": "2019-03-22T15:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532952",
    "user": "https://github.com/LaisRast"
}
```

**Branch:** [public/27534](https://github.com/sagemath/sagetrac-mirror/tree/public/27534)



---

archive/issue_comments_532953.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7849b3ecea4f36f7233940ee6d18a0af943013c\">a7849b3</a></td><td><code>adding Lawrence polytope</code></td></tr></table>\n",
    "created_at": "2019-03-22T15:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532953",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7849b3ecea4f36f7233940ee6d18a0af943013c">a7849b3</a></td><td><code>adding Lawrence polytope</code></td></tr></table>




---

archive/issue_comments_532954.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2019-03-22T15:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532954",
    "user": "https://github.com/LaisRast"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_532955.json:
```json
{
    "body": "<a id='comment:3'></a>\nA few small comments.\n\n1. Single quotes (or whatever the name of those things is) is for latex, double for code-style. There is at least one place (using `self`), where this is inconsistent.\n2. `The Lawrence extension of P`, what is P? How about `The Lawrence extension of a polytope P`?\n3. A comment I just received myself: \"These bullet points for `INPUT:` do not, by general Sage convention, end in a period/full-stop.\"\n4. It seems to me that the requirement of being full dimensional is not necessary. Instead one can require 0 to be contained, if its not full dimensional. If a polytope `P` satisfies \"ax = 0\" for all x in P, then the lawrence extension will just satisfie \"(a,0)x =  0\". I.e. if all hyperplanes containing P are linear, then the Lawrence extension will be contained in the \"same\" hyperplanes. I propose something like:\n\n```diff\n-        if not self.is_full_dimensional():\n-            raise NotImplementedError(\"`self` must be full dimensional\")\n+        if not self.is_full_dimensional():\n+            if not self.contains([0]*self.ambient_dim()):\n+                raise NotImplementedError(\"``self`` must be full-dimensional or contain the origin, try ``self.translation``\")\n```\nThen, one can add an example that explains how to proceed in case of a not full-dimensional polytope:\n\n```\nsage: P = polytopes.permutahedron(4)\nsage: Q = lawrence_polytope(P)\nTraceback (most recent call last):\n...\nNotImplementedError: ``self`` must be full-dimensional or contain the origin, try ``self.translation``\nsage: T = P.translation(-vector(P.vertices()[0]))\nsage: Q = lawrence_polytope(T)\nsage: Q\nA 26-dimensional polyhedron in ZZ^28 defined as the convex hull of 47 vertices\n```\nMaybe add another example like this to the Lawrence extension (maybe `Birkhoff_polytope(3)`).\n5. I find too many commands in one line hard to read:\n\n```diff\n-            sage: P = polytopes.cube(); Q = P.lawrence_polytope(); Q.is_lawrence_polytope()\n-            True\n+            sage: P = polytopes.cube()\n+            sage: Q = P.lawrence_polytope()\n+            sage: Q.is_lawrence_polytope()\n+            True\n```\n6. I would use `True` instead of `true`.\n7. You never use `d = self.dim()`.",
    "created_at": "2019-03-22T20:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532955",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>
A few small comments.

1. Single quotes (or whatever the name of those things is) is for latex, double for code-style. There is at least one place (using `self`), where this is inconsistent.
2. `The Lawrence extension of P`, what is P? How about `The Lawrence extension of a polytope P`?
3. A comment I just received myself: "These bullet points for `INPUT:` do not, by general Sage convention, end in a period/full-stop."
4. It seems to me that the requirement of being full dimensional is not necessary. Instead one can require 0 to be contained, if its not full dimensional. If a polytope `P` satisfies "ax = 0" for all x in P, then the lawrence extension will just satisfie "(a,0)x =  0". I.e. if all hyperplanes containing P are linear, then the Lawrence extension will be contained in the "same" hyperplanes. I propose something like:

```diff
-        if not self.is_full_dimensional():
-            raise NotImplementedError("`self` must be full dimensional")
+        if not self.is_full_dimensional():
+            if not self.contains([0]*self.ambient_dim()):
+                raise NotImplementedError("``self`` must be full-dimensional or contain the origin, try ``self.translation``")
```
Then, one can add an example that explains how to proceed in case of a not full-dimensional polytope:

```
sage: P = polytopes.permutahedron(4)
sage: Q = lawrence_polytope(P)
Traceback (most recent call last):
...
NotImplementedError: ``self`` must be full-dimensional or contain the origin, try ``self.translation``
sage: T = P.translation(-vector(P.vertices()[0]))
sage: Q = lawrence_polytope(T)
sage: Q
A 26-dimensional polyhedron in ZZ^28 defined as the convex hull of 47 vertices
```
Maybe add another example like this to the Lawrence extension (maybe `Birkhoff_polytope(3)`).
5. I find too many commands in one line hard to read:

```diff
-            sage: P = polytopes.cube(); Q = P.lawrence_polytope(); Q.is_lawrence_polytope()
-            True
+            sage: P = polytopes.cube()
+            sage: Q = P.lawrence_polytope()
+            sage: Q.is_lawrence_polytope()
+            True
```
6. I would use `True` instead of `true`.
7. You never use `d = self.dim()`.



---

archive/issue_comments_532956.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2019-03-22T20:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532956",
    "user": "https://github.com/kliem"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_532957.json:
```json
{
    "body": "**Reviewer:** Jonathan Kliem",
    "created_at": "2019-03-22T20:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532957",
    "user": "https://github.com/kliem"
}
```

**Reviewer:** Jonathan Kliem



---

archive/issue_comments_532958.json:
```json
{
    "body": "<a id='comment:4'></a>\nThanks for your comments.\n\nThe functions need to be rewritten entirely: for instance, my function `lawrence_polytope` does produce a Lawrence polytope, but not **the** Lawrence polytope of `self` according to the usual definitions (there are two different definitions for it). \n\nI will come back to this ticket later and fix everything.",
    "created_at": "2019-03-24T00:32:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532958",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:4'></a>
Thanks for your comments.

The functions need to be rewritten entirely: for instance, my function `lawrence_polytope` does produce a Lawrence polytope, but not **the** Lawrence polytope of `self` according to the usual definitions (there are two different definitions for it). 

I will come back to this ticket later and fix everything.



---

archive/issue_comments_532959.json:
```json
{
    "body": "<a id='comment:5'></a>\nOne more remark.\n\n`is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.\n\nInstead of computing the Gale-transform, one could just grap the information from the facets.\n\n1. Create a list of vertices `V`.\n2. Iterate through all facets `F` containing exactly `n-1` vertices.\n3. Remove the vertex not contained in `F` from `V` (this vertex \"is\" the origin in the Gale transform).\n4. Iterate through all facets `F` containing exactly `n-2` vertices.\n5. Let v_1,v_2 not be in `F`. If v_1 and v_2 in `V`, remove them.\n\nIf at the end of this `V` is empty, the Gale diagram is centrally symmetric. If not, then it is not.",
    "created_at": "2019-03-24T15:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532959",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>
One more remark.

`is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.

Instead of computing the Gale-transform, one could just grap the information from the facets.

1. Create a list of vertices `V`.
2. Iterate through all facets `F` containing exactly `n-1` vertices.
3. Remove the vertex not contained in `F` from `V` (this vertex "is" the origin in the Gale transform).
4. Iterate through all facets `F` containing exactly `n-2` vertices.
5. Let v_1,v_2 not be in `F`. If v_1 and v_2 in `V`, remove them.

If at the end of this `V` is empty, the Gale diagram is centrally symmetric. If not, then it is not.



---

archive/issue_comments_532960.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [gh-kliem](#comment%3A5):\n> One more remark.\n> \n> `is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.\n\n\nIt is hard to have an algorithm that gets faster as the input gets larger!\n\nIn spite of that, yes, it might not be optimized, but I would not go into intricate implementation of the function unless there is yet a known use case.\n\nOne suggestion:\n\nPerles' example of a non-rational polytope uses lawrence extension to be constructed. It would be nice to add the example to the library of polytopes (either using lawrence extension or just hard-coding the vertices. Or even better, hard-coding the vertices and in the test of the function for the polytope, construct the polytope using lawrence extension and check that it is really combinatorially isomorphic.",
    "created_at": "2019-03-30T11:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532960",
    "user": "https://github.com/jplab"
}
```

<a id='comment:6'></a>
Replying to [gh-kliem](#comment%3A5):
> One more remark.
> 
> `is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.


It is hard to have an algorithm that gets faster as the input gets larger!

In spite of that, yes, it might not be optimized, but I would not go into intricate implementation of the function unless there is yet a known use case.

One suggestion:

Perles' example of a non-rational polytope uses lawrence extension to be constructed. It would be nice to add the example to the library of polytopes (either using lawrence extension or just hard-coding the vertices. Or even better, hard-coding the vertices and in the test of the function for the polytope, construct the polytope using lawrence extension and check that it is really combinatorially isomorphic.



---

archive/issue_comments_532961.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe Title of the ticket should be more precise about what the ticket provides.\n\nIn order to make this ticket more accessible, it would be nice to have related keywords: polytopes and lawrence extension.",
    "created_at": "2019-03-30T11:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532961",
    "user": "https://github.com/jplab"
}
```

<a id='comment:7'></a>
The Title of the ticket should be more precise about what the ticket provides.

In order to make this ticket more accessible, it would be nice to have related keywords: polytopes and lawrence extension.



---

archive/issue_comments_532962.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jipilab](#comment%3A6):\n> Replying to [gh-kliem](#comment%3A5):\n> > One more remark.\n> > \n> > `is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.\n\n> \n> It is hard to have an algorithm that gets faster as the input gets larger!\nSure. But its also nice to not recalculate something that is already known.\n> \n> In spite of that, yes, it might not be optimized, but I would not go into intricate implementation of the function unless there is yet a known use case.\n> \n\nWhether a polytope is a Lawrence polytope can simply be decided from the incidence matrix.\nIt is simply the question, whether the vertices V can be labeled v<sub>1</sub>,...,v<sub>n</sub>,w<sub>1</sub>,...,w<sub>2m</sub> such that V\\{v<sub>i</sub>} and V\\{w<sub>2j</sub>,w<sub>2j+1</sub>} is a facet.\n\nMoreover, the current version has issues. We discovered that `gale_transform()` is not normalized. At the moment the answer depends on the realization of the polytope. Also, the current code will return `True` for the bipyramid over a triangle. To my understanding this is not a Lawrence polytope as the Gale diagram is not symmetric with respect to multiplicity.",
    "created_at": "2019-03-30T15:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532962",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>
Replying to [jipilab](#comment%3A6):
> Replying to [gh-kliem](#comment%3A5):
> > One more remark.
> > 
> > `is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.

> 
> It is hard to have an algorithm that gets faster as the input gets larger!
Sure. But its also nice to not recalculate something that is already known.
> 
> In spite of that, yes, it might not be optimized, but I would not go into intricate implementation of the function unless there is yet a known use case.
> 

Whether a polytope is a Lawrence polytope can simply be decided from the incidence matrix.
It is simply the question, whether the vertices V can be labeled v<sub>1</sub>,...,v<sub>n</sub>,w<sub>1</sub>,...,w<sub>2m</sub> such that V\{v<sub>i</sub>} and V\{w<sub>2j</sub>,w<sub>2j+1</sub>} is a facet.

Moreover, the current version has issues. We discovered that `gale_transform()` is not normalized. At the moment the answer depends on the realization of the polytope. Also, the current code will return `True` for the bipyramid over a triangle. To my understanding this is not a Lawrence polytope as the Gale diagram is not symmetric with respect to multiplicity.



---

archive/issue_comments_532963.json:
```json
{
    "body": "<a id='comment:9'></a>\nIs a pyramid over a Lawrence polytope a Lawrence polytope? I think the definition should allow for an arbitrary number of points at the origin of the Gale diagram.\n\n`polymake`'s construction of a Lawrence polytope of a polytope with a vertex at the origin will even have an odd number of points. This construction is according to Bernd Sturmfels' definition, I think.\n\nLet V be the vertex matrix of a polytope. The Lawrence polytope will have the following vertices according to G\u00fcnter Ziegler (Lectures on Polytopes):\n\n```\n            \\begin{pmatrix}\n             V      &   V    \\\\\n             I_n    &   2*I_n\n            \\end{pmatrix},\n```\nAccording to Bernd Sturmfels (https://arxiv.org/pdf/math/0202104.pdf):\n\n```\n            \\begin{pmatrix}\n             V      &   0    \\\\\n             I_n    &   I_n\n            \\end{pmatrix},\n```\nBoth construction yield centrally symmetric Gale diagrams, but the second construction might not have an odd number of points, as pointed out.\n\nOnly the first construction will \"add\" for each point x in the Gale diagram a point -x.\n\nBtw, the first construction will not have `gale_transform` be centrally symmetric, before normalizing. E.g. when applying it for the cube, those are the coordinates of the Gale transform:\n\n```\nsage: P = polytopes.cube()\nsage: I_n = matrix.identity(8)\nsage: V = P.vertices_matrix()\nsage: lambda_V = block_matrix([[V,V],[I_n, 2*I_n]])\nsage: Polyhedron(lambda_V.transpose()).gale_transform()\n\n[(2, 0, 0, 0),\n (-1, 0, 0, 0),\n (0, 2, 0, 0),\n (0, -1, 0, 0),\n (0, 0, 2, 0),\n (0, 0, -1, 0),\n (-2, -2, -2, 0),\n (1, 1, 1, 0),\n (0, 0, 0, 2),\n (0, 0, 0, -1),\n (-2, -2, 0, -2),\n (1, 1, 0, 1),\n (-2, 0, -2, -2),\n (1, 0, 1, 1),\n (4, 2, 2, 2),\n (-2, -1, -1, -1)]\n```",
    "created_at": "2019-03-30T15:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532963",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>
Is a pyramid over a Lawrence polytope a Lawrence polytope? I think the definition should allow for an arbitrary number of points at the origin of the Gale diagram.

`polymake`'s construction of a Lawrence polytope of a polytope with a vertex at the origin will even have an odd number of points. This construction is according to Bernd Sturmfels' definition, I think.

Let V be the vertex matrix of a polytope. The Lawrence polytope will have the following vertices according to Günter Ziegler (Lectures on Polytopes):

```
            \begin{pmatrix}
             V      &   V    \\
             I_n    &   2*I_n
            \end{pmatrix},
```
According to Bernd Sturmfels (https://arxiv.org/pdf/math/0202104.pdf):

```
            \begin{pmatrix}
             V      &   0    \\
             I_n    &   I_n
            \end{pmatrix},
```
Both construction yield centrally symmetric Gale diagrams, but the second construction might not have an odd number of points, as pointed out.

Only the first construction will "add" for each point x in the Gale diagram a point -x.

Btw, the first construction will not have `gale_transform` be centrally symmetric, before normalizing. E.g. when applying it for the cube, those are the coordinates of the Gale transform:

```
sage: P = polytopes.cube()
sage: I_n = matrix.identity(8)
sage: V = P.vertices_matrix()
sage: lambda_V = block_matrix([[V,V],[I_n, 2*I_n]])
sage: Polyhedron(lambda_V.transpose()).gale_transform()

[(2, 0, 0, 0),
 (-1, 0, 0, 0),
 (0, 2, 0, 0),
 (0, -1, 0, 0),
 (0, 0, 2, 0),
 (0, 0, -1, 0),
 (-2, -2, -2, 0),
 (1, 1, 1, 0),
 (0, 0, 0, 2),
 (0, 0, 0, -1),
 (-2, -2, 0, -2),
 (1, 1, 0, 1),
 (-2, 0, -2, -2),
 (1, 0, 1, 1),
 (4, 2, 2, 2),
 (-2, -1, -1, -1)]
```



---

archive/issue_comments_532964.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69cd2c3f76444244edc5fa2d9d38001ac695ba36\">69cd2c3</a></td><td><code>improve is_lawrence and fix lawrence_polytope</code></td></tr></table>\n",
    "created_at": "2019-04-05T08:13:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69cd2c3f76444244edc5fa2d9d38001ac695ba36">69cd2c3</a></td><td><code>improve is_lawrence and fix lawrence_polytope</code></td></tr></table>




---

archive/issue_comments_532965.json:
```json
{
    "body": "**Changing commit** from \"[a7849b3ecea4f36f7233940ee6d18a0af943013c](https://github.com/sagemath/sagetrac-mirror/commit/a7849b3ecea4f36f7233940ee6d18a0af943013c)\" to \"[69cd2c3f76444244edc5fa2d9d38001ac695ba36](https://github.com/sagemath/sagetrac-mirror/commit/69cd2c3f76444244edc5fa2d9d38001ac695ba36)\".",
    "created_at": "2019-04-05T08:13:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532965",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a7849b3ecea4f36f7233940ee6d18a0af943013c](https://github.com/sagemath/sagetrac-mirror/commit/a7849b3ecea4f36f7233940ee6d18a0af943013c)" to "[69cd2c3f76444244edc5fa2d9d38001ac695ba36](https://github.com/sagemath/sagetrac-mirror/commit/69cd2c3f76444244edc5fa2d9d38001ac695ba36)".



---

archive/issue_comments_532966.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2019-04-05T08:30:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532966",
    "user": "https://github.com/LaisRast"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_532967.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [gh-kliem](#comment%3A5):\n> One more remark.\n> \n> `is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.\n> \n> Instead of computing the Gale-transform, one could just grap the information from the facets.\n> \n> 1. Create a list of vertices `V`.\n> 2. Iterate through all facets `F` containing exactly `n-1` vertices.\n> 3. Remove the vertex not contained in `F` from `V` (this vertex \"is\" the origin in the Gale transform).\n> 4. Iterate through all facets `F` containing exactly `n-2` vertices.\n> 5. Let v_1,v_2 not be in `F`. If v_1 and v_2 in `V`, remove them.\n> \n> If at the end of this `V` is empty, the Gale diagram is centrally symmetric. If not, then it is not.\n\n\nThis is really helpful and fast. I implemented this in `is_lawrence_polytope`.\n\n\n> Both construction yield centrally symmetric Gale diagrams, but the second construction might not have an odd number of points, as pointed out.\n\nI decided to only put the construction given by Ziegler. It works in the case where the polytope is not full-dimensional.",
    "created_at": "2019-04-05T08:30:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532967",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:11'></a>
Replying to [gh-kliem](#comment%3A5):
> One more remark.
> 
> `is_lawrence_polytope` is very slow in cases, where the polytope does not have few vertices. Try checking this for `permutahedron(6)`.
> 
> Instead of computing the Gale-transform, one could just grap the information from the facets.
> 
> 1. Create a list of vertices `V`.
> 2. Iterate through all facets `F` containing exactly `n-1` vertices.
> 3. Remove the vertex not contained in `F` from `V` (this vertex "is" the origin in the Gale transform).
> 4. Iterate through all facets `F` containing exactly `n-2` vertices.
> 5. Let v_1,v_2 not be in `F`. If v_1 and v_2 in `V`, remove them.
> 
> If at the end of this `V` is empty, the Gale diagram is centrally symmetric. If not, then it is not.


This is really helpful and fast. I implemented this in `is_lawrence_polytope`.


> Both construction yield centrally symmetric Gale diagrams, but the second construction might not have an odd number of points, as pointed out.

I decided to only put the construction given by Ziegler. It works in the case where the polytope is not full-dimensional.



---

archive/issue_comments_532968.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jipilab](#comment%3A6):\n> One suggestion:\n> \n> Perles' example of a non-rational polytope uses lawrence extension to be constructed. It would be nice to add the example to the library of polytopes (either using lawrence extension or just hard-coding the vertices. Or even better, hard-coding the vertices and in the test of the function for the polytope, construct the polytope using lawrence extension and check that it is really combinatorially isomorphic.\n\n\nThis would be a very nice example. I think this needs its own ticket \"adding Perles's example to polytopes library\". After that we can add it to the test of the function `lawrence_extension` .",
    "created_at": "2019-04-05T08:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532968",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:12'></a>
Replying to [jipilab](#comment%3A6):
> One suggestion:
> 
> Perles' example of a non-rational polytope uses lawrence extension to be constructed. It would be nice to add the example to the library of polytopes (either using lawrence extension or just hard-coding the vertices. Or even better, hard-coding the vertices and in the test of the function for the polytope, construct the polytope using lawrence extension and check that it is really combinatorially isomorphic.


This would be a very nice example. I think this needs its own ticket "adding Perles's example to polytopes library". After that we can add it to the test of the function `lawrence_extension` .



---

archive/issue_events_077523.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "rename": {
        "from": "Lawrence Extension",
        "to": "Implement Lawrence extension for polytopes"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27534#event-77523"
}
```



---

archive/issue_comments_532969.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Adding the following methods to base.py:\n * `lawrence_extension(self, v)`: \n-  Return the Lawrence extension of `self` on the vertex `v`.\n+  Return the Lawrence extension of `self` on the point `v`.\n * `lawrence_polytope(self)`:\n   Return the Lawrence polytope of `self`.\n * `is_lawrence_polytope(self)`:\n``````\n",
    "created_at": "2019-04-05T08:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532969",
    "user": "https://github.com/LaisRast"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Adding the following methods to base.py:
 * `lawrence_extension(self, v)`: 
-  Return the Lawrence extension of `self` on the vertex `v`.
+  Return the Lawrence extension of `self` on the point `v`.
 * `lawrence_polytope(self)`:
   Return the Lawrence polytope of `self`.
 * `is_lawrence_polytope(self)`:
``````




---

archive/issue_comments_532970.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"polytopes, lawrence extension\".",
    "created_at": "2019-04-05T08:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532970",
    "user": "https://github.com/LaisRast"
}
```

**Changing keywords** from "" to "polytopes, lawrence extension".



---

archive/issue_comments_532971.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a975b55312cfd8227a88b934901005dbb6b7ef95\">a975b55</a></td><td><code>change the name of the variable non_vertices to facet_non_vertices</code></td></tr></table>\n",
    "created_at": "2019-04-05T12:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532971",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a975b55312cfd8227a88b934901005dbb6b7ef95">a975b55</a></td><td><code>change the name of the variable non_vertices to facet_non_vertices</code></td></tr></table>




---

archive/issue_comments_532972.json:
```json
{
    "body": "**Changing commit** from \"[69cd2c3f76444244edc5fa2d9d38001ac695ba36](https://github.com/sagemath/sagetrac-mirror/commit/69cd2c3f76444244edc5fa2d9d38001ac695ba36)\" to \"[a975b55312cfd8227a88b934901005dbb6b7ef95](https://github.com/sagemath/sagetrac-mirror/commit/a975b55312cfd8227a88b934901005dbb6b7ef95)\".",
    "created_at": "2019-04-05T12:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532972",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[69cd2c3f76444244edc5fa2d9d38001ac695ba36](https://github.com/sagemath/sagetrac-mirror/commit/69cd2c3f76444244edc5fa2d9d38001ac695ba36)" to "[a975b55312cfd8227a88b934901005dbb6b7ef95](https://github.com/sagemath/sagetrac-mirror/commit/a975b55312cfd8227a88b934901005dbb6b7ef95)".



---

archive/issue_comments_532973.json:
```json
{
    "body": "<a id='comment:15'></a>\nSorry. I know this is on \"needs_review\".\nI only changed the name of a variable from `non_vertices` to `facet_non_vertices`.",
    "created_at": "2019-04-05T12:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532973",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:15'></a>
Sorry. I know this is on "needs_review".
I only changed the name of a variable from `non_vertices` to `facet_non_vertices`.



---

archive/issue_comments_532974.json:
```json
{
    "body": "<a id='comment:16'></a>\n\n```\n+src/sage/geometry/polyhedron/base.py:509: undefined name 'x'\n+src/sage/geometry/polyhedron/base.py:4030: 'sage.matrix.constructor.block_matrix' imported but unused\n```\n\nMaybe one could add `x = None`, before line 503.\nThen we don't get that `pyflakes` error anymore.\n\nDelete line 4030.",
    "created_at": "2019-04-05T17:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532974",
    "user": "https://github.com/kliem"
}
```

<a id='comment:16'></a>

```
+src/sage/geometry/polyhedron/base.py:509: undefined name 'x'
+src/sage/geometry/polyhedron/base.py:4030: 'sage.matrix.constructor.block_matrix' imported but unused
```

Maybe one could add `x = None`, before line 503.
Then we don't get that `pyflakes` error anymore.

Delete line 4030.



---

archive/issue_comments_532975.json:
```json
{
    "body": "<a id='comment:17'></a>\nTiny things:\n\n```diff\n-        I_n= matrix.identity(n)\n-        lambda_V = block_matrix([[V, I_n],[V, 2*I_n]])\n+        I_n = matrix.identity(n)\n+        lambda_V = block_matrix([[V, I_n], [V, 2*I_n]])\n```\n\n```diff\n+            For more information, see [BaSt1990]_.\n-\n+        \"\"\"\n-\n```\n\nI think, there are in general no blank lines after the end of the docstring `\"\"\"`.\n\nAlso there is a double blank line.\n\n```\nsage: Q = polytopes.regular_polygon(4).pyramid()\n```\nInstead of Q, I would maybe use something more descriptive as `egyptian` or `egyptian_py`.\nThen one does not have to read all of `polytopes.regular_polygon(4).pyramid()` to understand the construction.\n\nThis is all that I can come up with.",
    "created_at": "2019-04-05T19:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532975",
    "user": "https://github.com/kliem"
}
```

<a id='comment:17'></a>
Tiny things:

```diff
-        I_n= matrix.identity(n)
-        lambda_V = block_matrix([[V, I_n],[V, 2*I_n]])
+        I_n = matrix.identity(n)
+        lambda_V = block_matrix([[V, I_n], [V, 2*I_n]])
```

```diff
+            For more information, see [BaSt1990]_.
-
+        """
-
```

I think, there are in general no blank lines after the end of the docstring `"""`.

Also there is a double blank line.

```
sage: Q = polytopes.regular_polygon(4).pyramid()
```
Instead of Q, I would maybe use something more descriptive as `egyptian` or `egyptian_py`.
Then one does not have to read all of `polytopes.regular_polygon(4).pyramid()` to understand the construction.

This is all that I can come up with.



---

archive/issue_comments_532976.json:
```json
{
    "body": "**Changing commit** from \"[a975b55312cfd8227a88b934901005dbb6b7ef95](https://github.com/sagemath/sagetrac-mirror/commit/a975b55312cfd8227a88b934901005dbb6b7ef95)\" to \"[e5c6cad97afb517d6ccfee370f81869c6a492314](https://github.com/sagemath/sagetrac-mirror/commit/e5c6cad97afb517d6ccfee370f81869c6a492314)\".",
    "created_at": "2019-04-05T21:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a975b55312cfd8227a88b934901005dbb6b7ef95](https://github.com/sagemath/sagetrac-mirror/commit/a975b55312cfd8227a88b934901005dbb6b7ef95)" to "[e5c6cad97afb517d6ccfee370f81869c6a492314](https://github.com/sagemath/sagetrac-mirror/commit/e5c6cad97afb517d6ccfee370f81869c6a492314)".



---

archive/issue_comments_532977.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5c6cad97afb517d6ccfee370f81869c6a492314\">e5c6cad</a></td><td><code>fixing pyflakes undefined variable error/cleaning the code</code></td></tr></table>\n",
    "created_at": "2019-04-05T21:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532977",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5c6cad97afb517d6ccfee370f81869c6a492314">e5c6cad</a></td><td><code>fixing pyflakes undefined variable error/cleaning the code</code></td></tr></table>




---

archive/issue_comments_532978.json:
```json
{
    "body": "**Changing commit** from \"[e5c6cad97afb517d6ccfee370f81869c6a492314](https://github.com/sagemath/sagetrac-mirror/commit/e5c6cad97afb517d6ccfee370f81869c6a492314)\" to \"[bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)\".",
    "created_at": "2019-04-05T21:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532978",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e5c6cad97afb517d6ccfee370f81869c6a492314](https://github.com/sagemath/sagetrac-mirror/commit/e5c6cad97afb517d6ccfee370f81869c6a492314)" to "[bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)".



---

archive/issue_comments_532979.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e\">bc1b9cd</a></td><td><code>change variable name from egyption_py to egyption_pyramid</code></td></tr></table>\n",
    "created_at": "2019-04-05T21:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532979",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e">bc1b9cd</a></td><td><code>change variable name from egyption_py to egyption_pyramid</code></td></tr></table>




---

archive/issue_comments_532980.json:
```json
{
    "body": "<a id='comment:20'></a>\nLooks fine to me.",
    "created_at": "2019-04-08T08:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532980",
    "user": "https://github.com/kliem"
}
```

<a id='comment:20'></a>
Looks fine to me.



---

archive/issue_comments_532981.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2019-04-08T08:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532981",
    "user": "https://github.com/kliem"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_532982.json:
```json
{
    "body": "**Changing branch** from \"[public/27534](https://github.com/sagemath/sagetrac-mirror/tree/public/27534)\" to \"[bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)\".",
    "created_at": "2019-04-10T15:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532982",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/27534](https://github.com/sagemath/sagetrac-mirror/tree/public/27534)" to "[bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)".



---

archive/issue_comments_532983.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2019-04-10T15:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532983",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_077524.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-10T15:28:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27534#event-77524"
}
```



---

archive/issue_comments_532984.json:
```json
{
    "body": "<a id='comment:22'></a>\nHere is one things that could have been changed in this ticket:\n\n```diff\n-     raise NotImplementedError(\"self must be a polytope\")\n+     raise NotImplementedError(\"Only polytopes (compact polyhedra) are allowed.\")\n```\n\nlike in `bounding_box` or\n\n```diff\n-     raise NotImplementedError(\"self must be a polytope\")\n+     raise NotImplementedError(\"The polytope has to be compact.\")\n```\n\nlike in `barycentric_subdivision`. Usually `self` is replaced by something more informative about the actual object and making the requirement precise (in this case 'compactness'). Since polytope is not a universally defined word, mentioning compactness makes thing completely unambiguous.\n\nThis could be changed some other time when practical.",
    "created_at": "2019-04-16T07:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532984",
    "user": "https://github.com/jplab"
}
```

<a id='comment:22'></a>
Here is one things that could have been changed in this ticket:

```diff
-     raise NotImplementedError("self must be a polytope")
+     raise NotImplementedError("Only polytopes (compact polyhedra) are allowed.")
```

like in `bounding_box` or

```diff
-     raise NotImplementedError("self must be a polytope")
+     raise NotImplementedError("The polytope has to be compact.")
```

like in `barycentric_subdivision`. Usually `self` is replaced by something more informative about the actual object and making the requirement precise (in this case 'compactness'). Since polytope is not a universally defined word, mentioning compactness makes thing completely unambiguous.

This could be changed some other time when practical.



---

archive/issue_comments_532985.json:
```json
{
    "body": "**Changing commit** from \"[bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)\" to \"\".",
    "created_at": "2019-04-16T07:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27534#issuecomment-532985",
    "user": "https://github.com/jplab"
}
```

**Changing commit** from "[bc1b9cd71307b02eee6ff17e33aa3fe05089230e](https://github.com/sagemath/sagetrac-mirror/commit/bc1b9cd71307b02eee6ff17e33aa3fe05089230e)" to "".
