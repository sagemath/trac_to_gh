# Issue 27413: Implement picard group and unit group for non-maximal orders

archive/issues_027176.json:
```json
{
    "body": "The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.\n\nNon-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, \n\n```\nsage: K.<a> = NumberField(x^2-5)\nsage: O = K.order(a); O.is_maximal()\nFalse\nsage: O.ideal(2)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-10-8da0cc5ea6ab> in <module>()\n----> 1 O.ideal(Integer(2))\n\n/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)\n    232         \"\"\"\n    233         if not self.is_maximal():\n--> 234             raise NotImplementedError(\"ideals of non-maximal orders not yet supported.\")\n    235         I = self.number_field().ideal(*args, **kwds)\n    236         if not I.is_integral():\n\nNotImplementedError: ideals of non-maximal orders not yet supported. \n```\nSo this might be hard.\n\n## Progress\n\nThis current branch can:\n\n* return the underlying free module of a fractional ideal of an order given the generators.\n* compute the conductor of a non-maximal order as both an ideal of the maximal order and the non-maximal order.\n* intersect fractional ideals of non-maximal orders with non-maximal orders.\n* return the prime factors of an integral ideal of a non-maximal order.\n\n\n## Github\n\nI've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development. But I'll push to this ticket every now and then.\n\nKeywords: class group, unit group, non-maximal order, picard group\n\nBranch: u/klui/implement_picard_group_and_unit_group_for_non_maximal_orders\n\nStatus: new\n\nCommit: 3df71d581a10a14a5399b79f666560e1fd2dfc6b\n\nIssue created by migration from https://trac.sagemath.org/ticket/27413\n\n",
    "created_at": "2019-03-04T01:19:11Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Implement picard group and unit group for non-maximal orders",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27413",
    "user": "https://github.com/kevinywlui"
}
```
The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.

Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, 

```
sage: K.<a> = NumberField(x^2-5)
sage: O = K.order(a); O.is_maximal()
False
sage: O.ideal(2)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-8da0cc5ea6ab> in <module>()
----> 1 O.ideal(Integer(2))

/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)
    232         """
    233         if not self.is_maximal():
--> 234             raise NotImplementedError("ideals of non-maximal orders not yet supported.")
    235         I = self.number_field().ideal(*args, **kwds)
    236         if not I.is_integral():

NotImplementedError: ideals of non-maximal orders not yet supported. 
```
So this might be hard.

## Progress

This current branch can:

* return the underlying free module of a fractional ideal of an order given the generators.
* compute the conductor of a non-maximal order as both an ideal of the maximal order and the non-maximal order.
* intersect fractional ideals of non-maximal orders with non-maximal orders.
* return the prime factors of an integral ideal of a non-maximal order.


## Github

I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development. But I'll push to this ticket every now and then.

Keywords: class group, unit group, non-maximal order, picard group

Branch: u/klui/implement_picard_group_and_unit_group_for_non_maximal_orders

Status: new

Commit: 3df71d581a10a14a5399b79f666560e1fd2dfc6b

Issue created by migration from https://trac.sagemath.org/ticket/27413





---

archive/issue_comments_407756.json:
```json
{
    "body": "Changing component from modular forms to number fields.",
    "created_at": "2019-03-05T04:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407756",
    "user": "https://github.com/kevinywlui"
}
```

Changing component from modular forms to number fields.



---

archive/issue_comments_407757.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-08-17T20:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407757",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_407758.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -23,6 +23,11 @@\n ```\n So this might be hard.\n \n+\n+## Github\n+\n+I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development.\n+\n Component: modular forms\n \n Comment: 1\n```\n",
    "created_at": "2019-08-17T20:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407758",
    "user": "https://github.com/kevinywlui"
}
```

Description changed:
```diff
--- 
+++ 
@@ -23,6 +23,11 @@
 ```
 So this might be hard.
 
+
+## Github
+
+I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development.
+
 Component: modular forms
 
 Comment: 1
```




---

archive/issue_comments_407759.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-17T23:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407759",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407760.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,40 @@\n+The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.\n \n+Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, \n+\n+```\n+sage: K.<a> = NumberField(x^2-5)\n+sage: O = K.order(a); O.is_maximal()\n+False\n+sage: O.ideal(2)\n+---------------------------------------------------------------------------\n+NotImplementedError                       Traceback (most recent call last)\n+<ipython-input-10-8da0cc5ea6ab> in <module>()\n+----> 1 O.ideal(Integer(2))\n+\n+/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)\n+    232         \"\"\"\n+    233         if not self.is_maximal():\n+--> 234             raise NotImplementedError(\"ideals of non-maximal orders not yet supported.\")\n+    235         I = self.number_field().ideal(*args, **kwds)\n+    236         if not I.is_integral():\n+\n+NotImplementedError: ideals of non-maximal orders not yet supported. \n+```\n+So this might be hard.\n+\n+## Progress\n+\n+This current branch can:\n+\n+* return the underlying free module of a fractional ideal of an order given the generators.\n+* compute the conductor of a non-maximal order as both an ideal of the maximal order and the non-maximal order.\n+* intersect fractional ideals of non-maximal orders with non-maximal orders.\n+\n+\n+## Github\n+\n+I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development. But I'll push to this ticket every now and then.\n \n Component: modular forms\n \n```\n",
    "created_at": "2019-08-17T23:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407760",
    "user": "https://github.com/kevinywlui"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,40 @@
+The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.
 
+Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, 
+
+```
+sage: K.<a> = NumberField(x^2-5)
+sage: O = K.order(a); O.is_maximal()
+False
+sage: O.ideal(2)
+---------------------------------------------------------------------------
+NotImplementedError                       Traceback (most recent call last)
+<ipython-input-10-8da0cc5ea6ab> in <module>()
+----> 1 O.ideal(Integer(2))
+
+/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)
+    232         """
+    233         if not self.is_maximal():
+--> 234             raise NotImplementedError("ideals of non-maximal orders not yet supported.")
+    235         I = self.number_field().ideal(*args, **kwds)
+    236         if not I.is_integral():
+
+NotImplementedError: ideals of non-maximal orders not yet supported. 
+```
+So this might be hard.
+
+## Progress
+
+This current branch can:
+
+* return the underlying free module of a fractional ideal of an order given the generators.
+* compute the conductor of a non-maximal order as both an ideal of the maximal order and the non-maximal order.
+* intersect fractional ideals of non-maximal orders with non-maximal orders.
+
+
+## Github
+
+I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development. But I'll push to this ticket every now and then.
 
 Component: modular forms
 
```




---

archive/issue_comments_407761.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-08-19T02:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407761",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_407762.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,41 @@\n+The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.\n \n+Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, \n+\n+```\n+sage: K.<a> = NumberField(x^2-5)\n+sage: O = K.order(a); O.is_maximal()\n+False\n+sage: O.ideal(2)\n+---------------------------------------------------------------------------\n+NotImplementedError                       Traceback (most recent call last)\n+<ipython-input-10-8da0cc5ea6ab> in <module>()\n+----> 1 O.ideal(Integer(2))\n+\n+/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)\n+    232         \"\"\"\n+    233         if not self.is_maximal():\n+--> 234             raise NotImplementedError(\"ideals of non-maximal orders not yet supported.\")\n+    235         I = self.number_field().ideal(*args, **kwds)\n+    236         if not I.is_integral():\n+\n+NotImplementedError: ideals of non-maximal orders not yet supported. \n+```\n+So this might be hard.\n+\n+## Progress\n+\n+This current branch can:\n+\n+* return the underlying free module of a fractional ideal of an order given the generators.\n+* compute the conductor of a non-maximal order as both an ideal of the maximal order and the non-maximal order.\n+* intersect fractional ideals of non-maximal orders with non-maximal orders.\n+* return the prime factors of an integral ideal of a non-maximal order.\n+\n+\n+## Github\n+\n+I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development. But I'll push to this ticket every now and then.\n \n Component: modular forms\n \n```\n",
    "created_at": "2019-08-19T02:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27413",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27413#issuecomment-407762",
    "user": "https://github.com/kevinywlui"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,41 @@
+The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.
 
+Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, 
+
+```
+sage: K.<a> = NumberField(x^2-5)
+sage: O = K.order(a); O.is_maximal()
+False
+sage: O.ideal(2)
+---------------------------------------------------------------------------
+NotImplementedError                       Traceback (most recent call last)
+<ipython-input-10-8da0cc5ea6ab> in <module>()
+----> 1 O.ideal(Integer(2))
+
+/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)
+    232         """
+    233         if not self.is_maximal():
+--> 234             raise NotImplementedError("ideals of non-maximal orders not yet supported.")
+    235         I = self.number_field().ideal(*args, **kwds)
+    236         if not I.is_integral():
+
+NotImplementedError: ideals of non-maximal orders not yet supported. 
+```
+So this might be hard.
+
+## Progress
+
+This current branch can:
+
+* return the underlying free module of a fractional ideal of an order given the generators.
+* compute the conductor of a non-maximal order as both an ideal of the maximal order and the non-maximal order.
+* intersect fractional ideals of non-maximal orders with non-maximal orders.
+* return the prime factors of an integral ideal of a non-maximal order.
+
+
+## Github
+
+I've been using Github for version control. See https://github.com/kevinywlui/sage/tree/order for the lastest development. But I'll push to this ticket every now and then.
 
 Component: modular forms
 
```

