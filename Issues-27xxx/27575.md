# Issue 27575: Three.js: Fix CDN Fallback

archive/issues_027338.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThe Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded, which was silently failing. This small change fixes that.\n\nRenders [this discussion](https://groups.google.com/forum/?nomobile=true#!topic/sage-devel/QC5-9rexyJo) moot.\n\nCC:  @egourgoulhon @novoselt @slel\n\nComponent: **graphics**\n\nKeywords: **threejs**\n\nAuthor: **Paul Masson**\n\nBranch/Commit: **[`a355a67`](https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417)**\n\nReviewer: **Julian R\u00fcth**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27575_\n\n",
    "closed_at": "2019-04-03T18:38:35Z",
    "created_at": "2019-03-30T19:42:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Three.js: Fix CDN Fallback",
    "type": "issue",
    "updated_at": "2019-04-03T18:38:35Z",
    "url": "https://github.com/sagemath/sage/issues/27575",
    "user": "https://github.com/paulmasson"
}
```
<div id="comment:0"></div>

The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded, which was silently failing. This small change fixes that.

Renders [this discussion](https://groups.google.com/forum/?nomobile=true#!topic/sage-devel/QC5-9rexyJo) moot.

CC:  @egourgoulhon @novoselt @slel

Component: **graphics**

Keywords: **threejs**

Author: **Paul Masson**

Branch/Commit: **[`a355a67`](https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417)**

Reviewer: **Julian RÃ¼th**

_Issue created by migration from https://trac.sagemath.org/ticket/27575_





---

archive/issue_events_375640.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-03-30T19:42:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375640"
}
```



---

archive/issue_events_375641.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-03-30T19:42:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375641"
}
```



---

archive/issue_comments_427218.json:
```json
{
    "body": "Branch: **[u/paulmasson/three_js__fix_cdn_fallback](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/three_js__fix_cdn_fallback)**",
    "created_at": "2019-03-30T19:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427218",
    "user": "https://github.com/paulmasson"
}
```

Branch: **[u/paulmasson/three_js__fix_cdn_fallback](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/three_js__fix_cdn_fallback)**



---

archive/issue_events_375642.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-03-30T19:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375642"
}
```



---

archive/issue_events_375643.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-03-30T19:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375643"
}
```



---

archive/issue_comments_427219.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/378512d2fb497c4297895ae9386afe862a26249b\"><code>378512d</code></a></td><td><code>Fix CDN fallback</code></td></tr></table>\n",
    "created_at": "2019-03-30T19:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427219",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/378512d2fb497c4297895ae9386afe862a26249b"><code>378512d</code></a></td><td><code>Fix CDN fallback</code></td></tr></table>




---

archive/issue_comments_427220.json:
```json
{
    "body": "Commit: **[`378512d`](https://github.com/sagemath/sagetrac-mirror/commit/378512d2fb497c4297895ae9386afe862a26249b)**",
    "created_at": "2019-03-30T19:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427220",
    "user": "https://github.com/paulmasson"
}
```

Commit: **[`378512d`](https://github.com/sagemath/sagetrac-mirror/commit/378512d2fb497c4297895ae9386afe862a26249b)**



---

archive/issue_events_375644.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2019-03-30T19:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375644"
}
```



---

archive/issue_comments_427221.json:
```json
{
    "body": "Author: **Paul Masson**",
    "created_at": "2019-03-30T19:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427221",
    "user": "https://github.com/paulmasson"
}
```

Author: **Paul Masson**



---

archive/issue_comments_427222.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n+The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded which was silently failing. This small change fixes that for most browsers, but it will not work for Internet Explorer. The fix to cover this old browser would be much more clumsy and not encourage users to move to better browser options.\n \n+Renders [this discussion](https://groups.google.com/forum/?nomobile=true#!topic/sage-devel/QC5-9rexyJo) moot.\n``````\n",
    "created_at": "2019-03-30T19:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427222",
    "user": "https://github.com/paulmasson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
+The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded which was silently failing. This small change fixes that for most browsers, but it will not work for Internet Explorer. The fix to cover this old browser would be much more clumsy and not encourage users to move to better browser options.
 
+Renders [this discussion](https://groups.google.com/forum/?nomobile=true#!topic/sage-devel/QC5-9rexyJo) moot.
``````




---

archive/issue_comments_427223.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe \"mooted\" discussion is about such a fallback should be on by default. Do I get it right that the fallback was simply broken, and the branch here fixes it, so that it silently works?",
    "created_at": "2019-03-31T15:25:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427223",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

The "mooted" discussion is about such a fallback should be on by default. Do I get it right that the fallback was simply broken, and the branch here fixes it, so that it silently works?



---

archive/issue_comments_427224.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nCould you explain why this makes a difference? I.e., I don't understand why this change would make a difference to the browser.\n\nAlso, how does this compare to https://github.com/sagemath/sage/issues/26434?",
    "created_at": "2019-03-31T15:35:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427224",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:4" align="right">comment:4</div>

Could you explain why this makes a difference? I.e., I don't understand why this change would make a difference to the browser.

Also, how does this compare to https://github.com/sagemath/sage/issues/26434?



---

archive/issue_comments_427225.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI thought I had understood, but I think I don't. The online scripts don't seem to contain a `'`. So why did it not work before?",
    "created_at": "2019-03-31T15:39:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427225",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:5" align="right">comment:5</div>

I thought I had understood, but I think I don't. The online scripts don't seem to contain a `'`. So why did it not work before?



---

archive/issue_comments_427226.json:
```json
{
    "body": "Changed commit from **[`378512d`](https://github.com/sagemath/sagetrac-mirror/commit/378512d2fb497c4297895ae9386afe862a26249b)** to **[`9a81aed`](https://github.com/sagemath/sagetrac-mirror/commit/9a81aedc9a591d8ca64605ad2fab601d70609735)**",
    "created_at": "2019-03-31T21:20:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427226",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`378512d`](https://github.com/sagemath/sagetrac-mirror/commit/378512d2fb497c4297895ae9386afe862a26249b)** to **[`9a81aed`](https://github.com/sagemath/sagetrac-mirror/commit/9a81aedc9a591d8ca64605ad2fab601d70609735)**



---

archive/issue_comments_427227.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a81aedc9a591d8ca64605ad2fab601d70609735\"><code>9a81aed</code></a></td><td><code>Fix CDN fallback</code></td></tr></table>\n",
    "created_at": "2019-03-31T21:20:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427227",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a81aedc9a591d8ca64605ad2fab601d70609735"><code>9a81aed</code></a></td><td><code>Fix CDN fallback</code></td></tr></table>




---

archive/issue_comments_427228.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded which was silently failing. This small change fixes that for most browsers, but it will not work for Internet Explorer. The fix to cover this old browser would be much more clumsy and not encourage users to move to better browser options.\n+The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded, which was silently failing. This small change fixes that.\n \n Renders [this discussion](https://groups.google.com/forum/?nomobile=true#!topic/sage-devel/QC5-9rexyJo) moot.\n``````\n",
    "created_at": "2019-03-31T21:22:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427228",
    "user": "https://github.com/paulmasson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded which was silently failing. This small change fixes that for most browsers, but it will not work for Internet Explorer. The fix to cover this old browser would be much more clumsy and not encourage users to move to better browser options.
+The Three.js viewer for notebooks already had a fallback to the online CDN when the local files are not loaded, which was silently failing. This small change fixes that.
 
 Renders [this discussion](https://groups.google.com/forum/?nomobile=true#!topic/sage-devel/QC5-9rexyJo) moot.
``````




---

archive/issue_comments_427229.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@dimpase](#comment%3A3):\n> The \"mooted\" discussion is about such a fallback should be on by default. Do I get it right that the fallback was simply broken, and the branch here fixes it, so that it silently works? \n\nIt only silently works when the notebook is moved to a remote location. A locally served notebook should not have any problem finding the JS files and the the fallback will not be activated.",
    "created_at": "2019-03-31T21:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427229",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@dimpase](#comment%3A3):
> The "mooted" discussion is about such a fallback should be on by default. Do I get it right that the fallback was simply broken, and the branch here fixes it, so that it silently works? 

It only silently works when the notebook is moved to a remote location. A locally served notebook should not have any problem finding the JS files and the the fallback will not be activated.



---

archive/issue_comments_427230.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@saraedum](#comment%3A5):\n> I thought I had understood, but I think I don't. The online scripts don't seem to contain a `'`. So why did it not work before?\n\nA regular string in JS needs line continuation markers. The back ticks turn the string into a template literal, which is allowed to include new lines.\n\nAfter reviewing the code in #22670 that added this fallback, I reverted to a normal JS string. That way older browsers and other environments should be supported.",
    "created_at": "2019-03-31T21:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427230",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@saraedum](#comment%3A5):
> I thought I had understood, but I think I don't. The online scripts don't seem to contain a `'`. So why did it not work before?

A regular string in JS needs line continuation markers. The back ticks turn the string into a template literal, which is allowed to include new lines.

After reviewing the code in #22670 that added this fallback, I reverted to a normal JS string. That way older browsers and other environments should be supported.



---

archive/issue_comments_427231.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@saraedum](#comment%3A4):\n> Also, how does this compare to https://github.com/sagemath/sage/issues/26434?\n\nAs a JS person, I would never think of copying an entire library into every file I create. While it is a possible solution, it just doesn't seem elegant. This fallback is intended for files shared on the web, which implies internet access to a CDN.\n\nPlease describe what problems you encountered at Luminy. Was there any lack of internet access? If this fallback had been working properly, then perhaps there would have been no issues.",
    "created_at": "2019-03-31T21:39:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427231",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@saraedum](#comment%3A4):
> Also, how does this compare to https://github.com/sagemath/sage/issues/26434?

As a JS person, I would never think of copying an entire library into every file I create. While it is a possible solution, it just doesn't seem elegant. This fallback is intended for files shared on the web, which implies internet access to a CDN.

Please describe what problems you encountered at Luminy. Was there any lack of internet access? If this fallback had been working properly, then perhaps there would have been no issues.



---

archive/issue_comments_427232.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@paulmasson](#comment%3A9):\n> Replying to [@saraedum](#comment%3A5):\n> > I thought I had understood, but I think I don't. The online scripts don't seem to contain a `'`. So why did it not work before?\n> \n> A regular string in JS needs line continuation markers. The back ticks turn the string into a template literal, which is allowed to include new lines.\n\nSure. That makes sense.",
    "created_at": "2019-03-31T22:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427232",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@paulmasson](#comment%3A9):
> Replying to [@saraedum](#comment%3A5):
> > I thought I had understood, but I think I don't. The online scripts don't seem to contain a `'`. So why did it not work before?
> 
> A regular string in JS needs line continuation markers. The back ticks turn the string into a template literal, which is allowed to include new lines.

Sure. That makes sense.



---

archive/issue_comments_427233.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@paulmasson](#comment%3A10):\n> Replying to [@saraedum](#comment%3A4):\n> > Also, how does this compare to https://github.com/sagemath/sage/issues/26434?\n> \n> As a JS person, I would never think of copying an entire library into every file I create. While it is a possible solution, it just doesn't seem elegant.\n\nI agree that it's not elegant. But you probably wouldn't dynamically emit script tags, would you?\n\n> This fallback is intended for files shared on the web, which implies internet access to a CDN.\n\nPersonally, I really don't mind if this code contacts a CDN but one could argue that this could also run in a local webserver that is not meant to access the internet.\n\n> Please describe what problems you encountered at Luminy. Was there any lack of internet access? If this fallback had been working properly, then perhaps there would have been no issues.\n\nThere was no lack of internet access. I forget what the setup was unfortunately. Somehow this was served through an interface/web server that could not resolve the path to the local three.js assets. I assume that this fallback would have fixed the problem.\n\nSo, I'll set this to positive review as this definitely fixes an existing bug (currently, we are emitting JavaScript code with a Syntax Error.) Whether this is a privacy issue in the first place can be discussed in a new issue imho. Feel free to set that one to critical if you have strong feelings about it.",
    "created_at": "2019-03-31T22:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427233",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@paulmasson](#comment%3A10):
> Replying to [@saraedum](#comment%3A4):
> > Also, how does this compare to https://github.com/sagemath/sage/issues/26434?
> 
> As a JS person, I would never think of copying an entire library into every file I create. While it is a possible solution, it just doesn't seem elegant.

I agree that it's not elegant. But you probably wouldn't dynamically emit script tags, would you?

> This fallback is intended for files shared on the web, which implies internet access to a CDN.

Personally, I really don't mind if this code contacts a CDN but one could argue that this could also run in a local webserver that is not meant to access the internet.

> Please describe what problems you encountered at Luminy. Was there any lack of internet access? If this fallback had been working properly, then perhaps there would have been no issues.

There was no lack of internet access. I forget what the setup was unfortunately. Somehow this was served through an interface/web server that could not resolve the path to the local three.js assets. I assume that this fallback would have fixed the problem.

So, I'll set this to positive review as this definitely fixes an existing bug (currently, we are emitting JavaScript code with a Syntax Error.) Whether this is a privacy issue in the first place can be discussed in a new issue imho. Feel free to set that one to critical if you have strong feelings about it.



---

archive/issue_comments_427234.json:
```json
{
    "body": "Reviewer: **Julian R\u00fcth**",
    "created_at": "2019-03-31T22:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427234",
    "user": "https://github.com/saraedum"
}
```

Reviewer: **Julian RÃ¼th**



---

archive/issue_events_375645.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-03-31T22:23:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375645"
}
```



---

archive/issue_events_375646.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-03-31T22:23:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375646"
}
```



---

archive/issue_comments_427235.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAh, so the place where this does not work without the CDN is CoCalc btw. Let me build Sage there to check that it is actually fixed with this.",
    "created_at": "2019-03-31T22:36:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427235",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:13" align="right">comment:13</div>

Ah, so the place where this does not work without the CDN is CoCalc btw. Let me build Sage there to check that it is actually fixed with this.



---

archive/issue_events_375647.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-03-31T22:36:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375647"
}
```



---

archive/issue_events_375648.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-03-31T22:36:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375648"
}
```



---

archive/issue_events_375649.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-03-31T22:36:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375649"
}
```



---

archive/issue_events_375650.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-03-31T22:36:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375650"
}
```



---

archive/issue_comments_427236.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417\"><code>a355a67</code></a></td><td><code>Better HTML output</code></td></tr></table>\n",
    "created_at": "2019-04-01T02:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427236",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417"><code>a355a67</code></a></td><td><code>Better HTML output</code></td></tr></table>




---

archive/issue_comments_427237.json:
```json
{
    "body": "Changed commit from **[`9a81aed`](https://github.com/sagemath/sagetrac-mirror/commit/9a81aedc9a591d8ca64605ad2fab601d70609735)** to **[`a355a67`](https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417)**",
    "created_at": "2019-04-01T02:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427237",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9a81aed`](https://github.com/sagemath/sagetrac-mirror/commit/9a81aedc9a591d8ca64605ad2fab601d70609735)** to **[`a355a67`](https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417)**



---

archive/issue_comments_427238.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThis final commit does not change functionality, but produces cleaner HTML output. The inserted script tags will now appear on separate lines. Sorry for any inconvenience this change might cause.",
    "created_at": "2019-04-01T02:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427238",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:17" align="right">comment:17</div>

This final commit does not change functionality, but produces cleaner HTML output. The inserted script tags will now appear on separate lines. Sorry for any inconvenience this change might cause.



---

archive/issue_comments_427239.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI currently waiting for my upgrade on CoCalc. Somehow, I cannot build Sage there anymore\u2026",
    "created_at": "2019-04-01T02:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427239",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:18" align="right">comment:18</div>

I currently waiting for my upgrade on CoCalc. Somehow, I cannot build Sage there anymoreâ¦



---

archive/issue_comments_427240.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nslelievre: Could you test this on CoCalc (or share one of your many upgrades with me so I can try myself?)",
    "created_at": "2019-04-01T02:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427240",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:20" align="right">comment:20</div>

slelievre: Could you test this on CoCalc (or share one of your many upgrades with me so I can try myself?)



---

archive/issue_comments_427241.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@saraedum](#comment%3A13):\n> Ah, so the place where this does not work without the CDN is CoCalc btw.\n\nAnother place where this does not work without the CDN is nbviewer.jupyter.org. With the code in this ticket branch, one can indeed get threejs rendering without having to add the option `online=True`, as [this example](https://nbviewer.jupyter.org/github/egourgoulhon/SageMathTest/blob/master/Worksheets/test_dodecahedron_threejs.ipynb) demonstrates. Accordingly, I am +1 for a positive review!",
    "created_at": "2019-04-01T16:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427241",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@saraedum](#comment%3A13):
> Ah, so the place where this does not work without the CDN is CoCalc btw.

Another place where this does not work without the CDN is nbviewer.jupyter.org. With the code in this ticket branch, one can indeed get threejs rendering without having to add the option `online=True`, as [this example](https://nbviewer.jupyter.org/github/egourgoulhon/SageMathTest/blob/master/Worksheets/test_dodecahedron_threejs.ipynb) demonstrates. Accordingly, I am +1 for a positive review!



---

archive/issue_comments_427242.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nBuilding on CoCalc failed somehow. Since it works on the nbviewer, I assume it also works on CoCalc; at least it certainly won't make the situation worse.",
    "created_at": "2019-04-01T16:39:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427242",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:22" align="right">comment:22</div>

Building on CoCalc failed somehow. Since it works on the nbviewer, I assume it also works on CoCalc; at least it certainly won't make the situation worse.



---

archive/issue_events_375651.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-04-01T16:39:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375651"
}
```



---

archive/issue_events_375652.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2019-04-01T16:39:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375652"
}
```



---

archive/issue_comments_427243.json:
```json
{
    "body": "Changed keywords from none to **threejs**",
    "created_at": "2019-04-02T13:20:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427243",
    "user": "https://github.com/embray"
}
```

Changed keywords from none to **threejs**



---

archive/issue_events_375653.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-03T18:38:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375653"
}
```



---

archive/issue_events_375654.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "eac2a4d3635ed886ded41deb2fabf25c4bcd9826",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-04-03T18:38:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27575#event-375654"
}
```



---

archive/issue_comments_427244.json:
```json
{
    "body": "Changed branch from **[u/paulmasson/three_js__fix_cdn_fallback](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/three_js__fix_cdn_fallback)** to **[`a355a67`](https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417)**",
    "created_at": "2019-04-03T18:38:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27575#issuecomment-427244",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/paulmasson/three_js__fix_cdn_fallback](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/three_js__fix_cdn_fallback)** to **[`a355a67`](https://github.com/sagemath/sagetrac-mirror/commit/a355a67151634944683c4f987630cd03f33f4417)**
