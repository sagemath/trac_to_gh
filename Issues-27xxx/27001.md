# Issue 27001: py3: fix pip_installed_packages

archive/issues_026764.json:
```json
{
    "assignees": [],
    "body": "by using pip3 when appropriate\n\nCC:  @embray @jdemeyer\n\nBranch/Commit: **[`b3722ac`](https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211)**\n\nReviewer: **Erik Bray**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27001_\n\n",
    "closed_at": "2019-03-02T09:38:26Z",
    "created_at": "2019-01-02T15:42:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: fix pip_installed_packages",
    "type": "issue",
    "updated_at": "2019-03-02T09:38:26Z",
    "url": "https://github.com/sagemath/sage/issues/27001",
    "user": "https://github.com/fchapoton"
}
```
by using pip3 when appropriate

CC:  @embray @jdemeyer

Branch/Commit: **[`b3722ac`](https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211)**

Reviewer: **Erik Bray**

Author: **Frédéric Chapoton**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/27001_





---

archive/issue_events_371037.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:42:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371037"
}
```



---

archive/issue_events_371038.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:42:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "000080",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371038"
}
```



---

archive/issue_events_371039.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:42:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371039"
}
```



---

archive/issue_events_371040.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:42:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371040"
}
```



---

archive/issue_comments_416435.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a06f005ecdf70d790b104c314aaee5cf8427a216\"><code>a06f005</code></a></td><td><code>fix choice of pip in pip_installed_packages</code></td></tr></table>\n",
    "created_at": "2019-01-02T15:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416435",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a06f005ecdf70d790b104c314aaee5cf8427a216"><code>a06f005</code></a></td><td><code>fix choice of pip in pip_installed_packages</code></td></tr></table>




---

archive/issue_events_371041.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371041"
}
```



---

archive/issue_comments_416436.json:
```json
{
    "body": "Commit: **[`a06f005`](https://github.com/sagemath/sagetrac-mirror/commit/a06f005ecdf70d790b104c314aaee5cf8427a216)**",
    "created_at": "2019-01-02T15:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416436",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`a06f005`](https://github.com/sagemath/sagetrac-mirror/commit/a06f005ecdf70d790b104c314aaee5cf8427a216)**



---

archive/issue_comments_416437.json:
```json
{
    "body": "Branch: **[u/chapoton/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27001)**",
    "created_at": "2019-01-02T15:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416437",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27001)**



---

archive/issue_comments_416438.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis should really be\n\n```diff\ndiff --git a/src/sage/misc/package.py b/src/sage/misc/package.py\nindex 689e5a2..f7bfbc4 100644\n--- a/src/sage/misc/package.py\n+++ b/src/sage/misc/package.py\n@@ -48,6 +48,7 @@ from sage.env import SAGE_ROOT, SAGE_PKGS\n import json\n import os\n import subprocess\n+import sys\n try:\n     # Python 3.3+\n     from urllib.request import urlopen\n@@ -142,9 +143,12 @@ def pip_installed_packages():\n         sage: d['beautifulsoup']   # optional - beautifulsoup\n         u'...'\n     \"\"\"\n-    proc = subprocess.Popen([\"pip\", \"list\", \"--no-index\", \"--format\", \"json\"],\n+    proc = subprocess.Popen([sys.executable, \"-m\", \"pip\", \"list\", \"--no-index\",\n+                             \"--format\", \"json\"], stdout=subprocess.PIPE)\n     stdout = proc.communicate()[0].decode()\n-    return {package['name'].lower():package['version'] for package in json.load\n+    return {package['name'].lower(): package['version']\n+            for package in json.loads(stdout)}\n+\n\n def list_packages(*pkg_types, **opts):\n     r\"\"\"\n```\n\nApparently I already had this fix in my python3 branch: I apologize for forgetting to make a ticket for it.",
    "created_at": "2019-01-02T15:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416438",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">comment:2</div>

This should really be

```diff
diff --git a/src/sage/misc/package.py b/src/sage/misc/package.py
index 689e5a2..f7bfbc4 100644
--- a/src/sage/misc/package.py
+++ b/src/sage/misc/package.py
@@ -48,6 +48,7 @@ from sage.env import SAGE_ROOT, SAGE_PKGS
 import json
 import os
 import subprocess
+import sys
 try:
     # Python 3.3+
     from urllib.request import urlopen
@@ -142,9 +143,12 @@ def pip_installed_packages():
         sage: d['beautifulsoup']   # optional - beautifulsoup
         u'...'
     """
-    proc = subprocess.Popen(["pip", "list", "--no-index", "--format", "json"],
+    proc = subprocess.Popen([sys.executable, "-m", "pip", "list", "--no-index",
+                             "--format", "json"], stdout=subprocess.PIPE)
     stdout = proc.communicate()[0].decode()
-    return {package['name'].lower():package['version'] for package in json.load
+    return {package['name'].lower(): package['version']
+            for package in json.loads(stdout)}
+

 def list_packages(*pkg_types, **opts):
     r"""
```

Apparently I already had this fix in my python3 branch: I apologize for forgetting to make a ticket for it.



---

archive/issue_events_371042.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:47:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371042"
}
```



---

archive/issue_events_371043.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:47:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371043"
}
```



---

archive/issue_comments_416439.json:
```json
{
    "body": "Changed commit from **[`a06f005`](https://github.com/sagemath/sagetrac-mirror/commit/a06f005ecdf70d790b104c314aaee5cf8427a216)** to **[`d5040c0`](https://github.com/sagemath/sagetrac-mirror/commit/d5040c0b4ad10323909d0642143d3a16bea41b54)**",
    "created_at": "2019-01-02T15:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416439",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a06f005`](https://github.com/sagemath/sagetrac-mirror/commit/a06f005ecdf70d790b104c314aaee5cf8427a216)** to **[`d5040c0`](https://github.com/sagemath/sagetrac-mirror/commit/d5040c0b4ad10323909d0642143d3a16bea41b54)**



---

archive/issue_comments_416440.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5040c0b4ad10323909d0642143d3a16bea41b54\"><code>d5040c0</code></a></td><td><code>fix choice of pip in pip_installed_packages</code></td></tr></table>\n",
    "created_at": "2019-01-02T15:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416440",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5040c0b4ad10323909d0642143d3a16bea41b54"><code>d5040c0</code></a></td><td><code>fix choice of pip in pip_installed_packages</code></td></tr></table>




---

archive/issue_comments_416441.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\ndone",
    "created_at": "2019-01-02T15:53:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416441",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

done



---

archive/issue_events_371044.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:53:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371044"
}
```



---

archive/issue_events_371045.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-02T15:53:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371045"
}
```



---

archive/issue_events_371046.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:56:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371046"
}
```



---

archive/issue_events_371047.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:56:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371047"
}
```



---

archive/issue_comments_416442.json:
```json
{
    "body": "Reviewer: **Erik Bray**",
    "created_at": "2019-01-02T15:56:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416442",
    "user": "https://github.com/embray"
}
```

Reviewer: **Erik Bray**



---

archive/issue_events_371048.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:56:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371048"
}
```



---

archive/issue_events_371049.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:56:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371049"
}
```



---

archive/issue_events_371050.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:56:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371050"
}
```



---

archive/issue_events_371051.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-02T15:56:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371051"
}
```



---

archive/issue_comments_416443.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOk thanks!",
    "created_at": "2019-01-02T15:56:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416443",
    "user": "https://github.com/embray"
}
```

<div id="comment:5" align="right">comment:5</div>

Ok thanks!



---

archive/issue_events_371052.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371052"
}
```



---

archive/issue_events_371053.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371053"
}
```



---

archive/issue_comments_416444.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416444",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_371054.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-26T15:52:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371054"
}
```



---

archive/issue_events_371055.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-26T15:52:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371055"
}
```



---

archive/issue_comments_416445.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n\n```\nsage -t --long src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 412, in sage.tests.cmdline.test_executable\nFailed example:\n    print(err)\nExpected:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: refusing to run doctests...\nGot:\n    sys:1: RuntimeWarning: not adding directory '' to sys.path since everybody can write to it.\n    Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage_git/build/src/bin/sage-runtests\", line 163, in <module>\n        err = DC.run()\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 1200, in run\n        self.test_safe_directory()\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 643, in test_safe_directory\n        .format(os.getcwd()))\n    RuntimeError: refusing to run doctests from the current directory '/var/lib/buildbot/.sage/temp/kucalc/160488/dir_OqlYHZ/test' since untrusted users could put files in this directory, making it unsafe to run Sage code from\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 417, in sage.tests.cmdline.test_executable\nFailed example:\n    print(err)\nExpected:\n    Traceback (most recent call last):\n    ...\n    RuntimeError: refusing to run doctests...\nGot:\n    sys:1: RuntimeWarning: not adding directory '' to sys.path since everybody can write to it.\n    Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage_git/build/src/bin/sage-runtests\", line 163, in <module>\n        err = DC.run()\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 1200, in run\n        self.test_safe_directory()\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 643, in test_safe_directory\n        .format(os.getcwd()))\n    RuntimeError: refusing to run doctests from the current directory '/var/lib/buildbot/.sage/temp/kucalc/160488/dir_OqlYHZ/test' since untrusted users could put files in this directory, making it unsafe to run Sage code from\n    <BLANKLINE>\n**********************************************************************\n1 item had failures:\n   2 of 251 in sage.tests.cmdline.test_executable\n    [250 tests, 2 failures, 41.92 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/tests/cmdline.py  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-01-26T15:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416445",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>


```
sage -t --long src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 412, in sage.tests.cmdline.test_executable
Failed example:
    print(err)
Expected:
    Traceback (most recent call last):
    ...
    RuntimeError: refusing to run doctests...
Got:
    sys:1: RuntimeWarning: not adding directory '' to sys.path since everybody can write to it.
    Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/src/bin/sage-runtests", line 163, in <module>
        err = DC.run()
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1200, in run
        self.test_safe_directory()
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py", line 643, in test_safe_directory
        .format(os.getcwd()))
    RuntimeError: refusing to run doctests from the current directory '/var/lib/buildbot/.sage/temp/kucalc/160488/dir_OqlYHZ/test' since untrusted users could put files in this directory, making it unsafe to run Sage code from
    <BLANKLINE>
**********************************************************************
File "src/sage/tests/cmdline.py", line 417, in sage.tests.cmdline.test_executable
Failed example:
    print(err)
Expected:
    Traceback (most recent call last):
    ...
    RuntimeError: refusing to run doctests...
Got:
    sys:1: RuntimeWarning: not adding directory '' to sys.path since everybody can write to it.
    Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/src/bin/sage-runtests", line 163, in <module>
        err = DC.run()
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1200, in run
        self.test_safe_directory()
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/control.py", line 643, in test_safe_directory
        .format(os.getcwd()))
    RuntimeError: refusing to run doctests from the current directory '/var/lib/buildbot/.sage/temp/kucalc/160488/dir_OqlYHZ/test' since untrusted users could put files in this directory, making it unsafe to run Sage code from
    <BLANKLINE>
**********************************************************************
1 item had failures:
   2 of 251 in sage.tests.cmdline.test_executable
    [250 tests, 2 failures, 41.92 s]
----------------------------------------------------------------------
sage -t --long src/sage/tests/cmdline.py  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_416446.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nErik or Jeroen, any idea on how to fix that ?",
    "created_at": "2019-01-27T19:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416446",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

Erik or Jeroen, any idea on how to fix that ?



---

archive/issue_comments_416447.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nshould I just add `...` before the actual doctest ?",
    "created_at": "2019-01-29T08:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416447",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

should I just add `...` before the actual doctest ?



---

archive/issue_comments_416448.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n#26457 has discussion about rewriting, if not entirely removing that test.",
    "created_at": "2019-01-29T17:16:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416448",
    "user": "https://github.com/embray"
}
```

<div id="comment:10" align="right">comment:10</div>

#26457 has discussion about rewriting, if not entirely removing that test.



---

archive/issue_comments_416449.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nso what should we do here ?",
    "created_at": "2019-02-05T19:32:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416449",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">comment:11</div>

so what should we do here ?



---

archive/issue_comments_416450.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@fchapoton](#comment:11):\n> so what should we do here ?\n\n(edited because original answer was wrong)\n\nIt seems that the doctest framework is using `pip_installed_packages` which is now causing Python to be run from an artificially unsafe directory. In this case, it's fine to just change the doctest output.",
    "created_at": "2019-02-06T09:25:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416450",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@fchapoton](#comment:11):
> so what should we do here ?

(edited because original answer was wrong)

It seems that the doctest framework is using `pip_installed_packages` which is now causing Python to be run from an artificially unsafe directory. In this case, it's fine to just change the doctest output.



---

archive/issue_comments_416451.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIf I add `...` at the beginning of the doctest output, then it passes with Python 2 but not Python 3 (which doesn't print the extra line `sys:1: RuntimeWarning: ...`).",
    "created_at": "2019-02-17T02:30:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416451",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:13" align="right">comment:13</div>

If I add `...` at the beginning of the doctest output, then it passes with Python 2 but not Python 3 (which doesn't print the extra line `sys:1: RuntimeWarning: ...`).



---

archive/issue_comments_416452.json:
```json
{
    "body": "Changed branch from **[u/chapoton/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27001)** to **[u/jhpalmieri/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/27001)**",
    "created_at": "2019-02-21T17:20:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416452",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/chapoton/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27001)** to **[u/jhpalmieri/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/27001)**



---

archive/issue_events_371056.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-02-21T17:24:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371056"
}
```



---

archive/issue_events_371057.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-02-21T17:24:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371057"
}
```



---

archive/issue_comments_416453.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI see two options: either\n\n```diff\ndiff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py\nindex df938c8211..a5e2e6fbbf 100644\n--- a/src/sage/tests/cmdline.py\n+++ b/src/sage/tests/cmdline.py\n@@ -409,12 +409,21 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         sage: os.mkdir(d)\n         sage: os.chmod(d, 0o777)\n         sage: (out, err, ret) = test_executable([\"sage\", \"-t\", \"nonexisting.py\"], cwd=d)\n-        sage: print(err)\n+        sage: print(err) # py2\n+        ...\n+        Traceback (most recent call last):\n+        ...\n+        sage: print(err) # py3\n         Traceback (most recent call last):\n         ...\n         RuntimeError: refusing to run doctests...\n         sage: (out, err, ret) = test_executable([\"sage\", \"-tp\", \"1\", \"nonexisting.py\"], cwd=d)\n-        sage: print(err)\n+        sage: print(err) # py2\n+        ...\n+        Traceback (most recent call last):\n+        ...\n+        RuntimeError: refusing to run doctests...\n+        sage: print(err) # py3\n         Traceback (most recent call last):\n         ...\n         RuntimeError: refusing to run doctests...\n```\nor\n\n```diff\ndiff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py\nindex df938c8211..08bda7c435 100644\n--- a/src/sage/tests/cmdline.py\n+++ b/src/sage/tests/cmdline.py\n@@ -410,12 +410,10 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         sage: os.chmod(d, 0o777)\n         sage: (out, err, ret) = test_executable([\"sage\", \"-t\", \"nonexisting.py\"], cwd=d)\n         sage: print(err)\n-        Traceback (most recent call last):\n         ...\n         RuntimeError: refusing to run doctests...\n         sage: (out, err, ret) = test_executable([\"sage\", \"-tp\", \"1\", \"nonexisting.py\"], cwd=d)\n         sage: print(err)\n-        Traceback (most recent call last):\n         ...\n         RuntimeError: refusing to run doctests...\n \n```\nHere is a branch using the second version.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cfefd2ee31b3dc2fccb05d4d660a687f8765a67e\"><code>cfefd2e</code></a></td><td><code>fix choice of pip in pip_installed_packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211\"><code>b3722ac</code></a></td><td><code>trac 27001: fix doctest</code></td></tr></table>\n",
    "created_at": "2019-02-21T17:24:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416453",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

I see two options: either

```diff
diff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py
index df938c8211..a5e2e6fbbf 100644
--- a/src/sage/tests/cmdline.py
+++ b/src/sage/tests/cmdline.py
@@ -409,12 +409,21 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         sage: os.mkdir(d)
         sage: os.chmod(d, 0o777)
         sage: (out, err, ret) = test_executable(["sage", "-t", "nonexisting.py"], cwd=d)
-        sage: print(err)
+        sage: print(err) # py2
+        ...
+        Traceback (most recent call last):
+        ...
+        sage: print(err) # py3
         Traceback (most recent call last):
         ...
         RuntimeError: refusing to run doctests...
         sage: (out, err, ret) = test_executable(["sage", "-tp", "1", "nonexisting.py"], cwd=d)
-        sage: print(err)
+        sage: print(err) # py2
+        ...
+        Traceback (most recent call last):
+        ...
+        RuntimeError: refusing to run doctests...
+        sage: print(err) # py3
         Traceback (most recent call last):
         ...
         RuntimeError: refusing to run doctests...
```
or

```diff
diff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py
index df938c8211..08bda7c435 100644
--- a/src/sage/tests/cmdline.py
+++ b/src/sage/tests/cmdline.py
@@ -410,12 +410,10 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         sage: os.chmod(d, 0o777)
         sage: (out, err, ret) = test_executable(["sage", "-t", "nonexisting.py"], cwd=d)
         sage: print(err)
-        Traceback (most recent call last):
         ...
         RuntimeError: refusing to run doctests...
         sage: (out, err, ret) = test_executable(["sage", "-tp", "1", "nonexisting.py"], cwd=d)
         sage: print(err)
-        Traceback (most recent call last):
         ...
         RuntimeError: refusing to run doctests...
 
```
Here is a branch using the second version.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cfefd2ee31b3dc2fccb05d4d660a687f8765a67e"><code>cfefd2e</code></a></td><td><code>fix choice of pip in pip_installed_packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211"><code>b3722ac</code></a></td><td><code>trac 27001: fix doctest</code></td></tr></table>




---

archive/issue_comments_416454.json:
```json
{
    "body": "Changed commit from **[`d5040c0`](https://github.com/sagemath/sagetrac-mirror/commit/d5040c0b4ad10323909d0642143d3a16bea41b54)** to **[`b3722ac`](https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211)**",
    "created_at": "2019-02-21T17:24:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416454",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`d5040c0`](https://github.com/sagemath/sagetrac-mirror/commit/d5040c0b4ad10323909d0642143d3a16bea41b54)** to **[`b3722ac`](https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211)**



---

archive/issue_comments_416455.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nok, looks good to me. Jeroen, do you approve ?",
    "created_at": "2019-02-22T19:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416455",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

ok, looks good to me. Jeroen, do you approve ?



---

archive/issue_comments_416456.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI thought that the doctest parser got confused if we started a line with `...` (it would get confused with a continuation prompt like `....:`).  Or did we fix that?",
    "created_at": "2019-02-26T14:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416456",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

I thought that the doctest parser got confused if we started a line with `...` (it would get confused with a continuation prompt like `....:`).  Or did we fix that?



---

archive/issue_comments_416457.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIt passes tests for me with Python 2 and Python 3, so I guess we fixed it.",
    "created_at": "2019-02-26T18:55:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416457",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:18" align="right">comment:18</div>

It passes tests for me with Python 2 and Python 3, so I guess we fixed it.



---

archive/issue_events_371058.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T15:14:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371058"
}
```



---

archive/issue_events_371059.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T15:14:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371059"
}
```



---

archive/issue_comments_416458.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI don't remember that, but I guess so!",
    "created_at": "2019-02-28T15:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416458",
    "user": "https://github.com/embray"
}
```

<div id="comment:19" align="right">comment:19</div>

I don't remember that, but I guess so!



---

archive/issue_comments_416459.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n(I'm not Jeroen, obviously, but I think this seems to reflect his suggestion)",
    "created_at": "2019-02-28T15:15:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416459",
    "user": "https://github.com/embray"
}
```

<div id="comment:20" align="right">comment:20</div>

(I'm not Jeroen, obviously, but I think this seems to reflect his suggestion)



---

archive/issue_comments_416460.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI am slightly worried by [comment:17](#comment:17) too.\n\nMaybe we should make sure that this is fixed and the doctests are run ?",
    "created_at": "2019-02-28T15:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416460",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

I am slightly worried by [comment:17](#comment:17) too.

Maybe we should make sure that this is fixed and the doctests are run ?



---

archive/issue_comments_416461.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@embray](#comment:17):\n> I thought that the doctest parser got confused if we started a line with `...` (it would get confused with a continuation prompt like `....:`).  Or did we fix that?\n\nI somehow seem to recall that this was fixed and that now a `....:` continuation is required after a `sage:` prompt.",
    "created_at": "2019-02-28T15:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416461",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@embray](#comment:17):
> I thought that the doctest parser got confused if we started a line with `...` (it would get confused with a continuation prompt like `....:`).  Or did we fix that?

I somehow seem to recall that this was fixed and that now a `....:` continuation is required after a `sage:` prompt.



---

archive/issue_comments_416462.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nok, then let's go.",
    "created_at": "2019-02-28T15:29:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416462",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">comment:23</div>

ok, then let's go.



---

archive/issue_comments_416463.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jhpalmieri](#comment:13):\n> If I add `...` at the beginning of the doctest output, then it passes with Python 2 but not Python 3 (which doesn't print the extra line `sys:1: RuntimeWarning: ...`).\n\nI just posted a new topic on sage-devel `What to do with the sys.path security patch?` referring this.",
    "created_at": "2019-02-28T15:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416463",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jhpalmieri](#comment:13):
> If I add `...` at the beginning of the doctest output, then it passes with Python 2 but not Python 3 (which doesn't print the extra line `sys:1: RuntimeWarning: ...`).

I just posted a new topic on sage-devel `What to do with the sys.path security patch?` referring this.



---

archive/issue_comments_416464.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@fchapoton](#comment:21):\n> I am slightly worried by [comment:17](#comment:17) too.\n> \n> Maybe we should make sure that this is fixed and the doctests are run ?\n\nI will confirm that the tests are run: they fail if I change the text.",
    "created_at": "2019-02-28T16:09:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416464",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@fchapoton](#comment:21):
> I am slightly worried by [comment:17](#comment:17) too.
> 
> Maybe we should make sure that this is fixed and the doctests are run ?

I will confirm that the tests are run: they fail if I change the text.



---

archive/issue_events_371060.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-02T09:38:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371060"
}
```



---

archive/issue_events_371061.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "93923a826ccf9f4fbf153b71d76f9324d436dbcd",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-02T09:38:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27001#event-371061"
}
```



---

archive/issue_comments_416465.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/27001)** to **[`b3722ac`](https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211)**",
    "created_at": "2019-03-02T09:38:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27001#issuecomment-416465",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/27001](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/27001)** to **[`b3722ac`](https://github.com/sagemath/sagetrac-mirror/commit/b3722ac58a78ff4ab30111da4d6a895c18b63211)**
