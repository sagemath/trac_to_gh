# Issue 27049: py3: some fix in Riemann surfaces

archive/issues_026812.json:
```json
{
    "body": "only partial, there remains 4 failing doctests out of 36\n\nCC:  @tscrim\n\nReviewer: Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton, Nils Bruin\n\nBranch: f6b68b9ad9b814bc20cdec7275ebfd4375e8f1ca\n\nCommit: f6b68b9ad9b814bc20cdec7275ebfd4375e8f1ca\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27049\n\n",
    "closed_at": "2019-01-24T18:17:31Z",
    "created_at": "2019-01-13T09:31:04Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "py3: some fix in Riemann surfaces",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27049",
    "user": "https://github.com/fchapoton"
}
```
only partial, there remains 4 failing doctests out of 36

CC:  @tscrim

Reviewer: Travis Scrimshaw

Author: Frédéric Chapoton, Nils Bruin

Branch: f6b68b9ad9b814bc20cdec7275ebfd4375e8f1ca

Commit: f6b68b9ad9b814bc20cdec7275ebfd4375e8f1ca

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27049





---

archive/issue_comments_376745.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-13T09:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376745",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_376746.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2019-01-13T09:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376746",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_376747.json:
```json
{
    "body": "<a id='comment:2'></a>green bot, please review",
    "created_at": "2019-01-13T14:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376747",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>green bot, please review



---

archive/issue_comments_376748.json:
```json
{
    "body": "<a id='comment:3'></a>LGTM.",
    "created_at": "2019-01-13T17:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376748",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>LGTM.



---

archive/issue_comments_376749.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-13T17:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376749",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_376750.json:
```json
{
    "body": "<a id='comment:5'></a>Changed back to using sqrt method. It's much faster because it doesn't have to do all the generic stuff. This is a core routine -- it actually makes a difference if it's fast.\n\n(also -- not a fan of all the trivial whitespace edits. It makes it hard to tell from the diff what has actually changed. If you have to touch a line anyway: sure, go ahead. Otherwise I think it's better to just leave it in the original form and not impose (subjective) aesthetics --PEP8's suggestions are mainly against too much whitespace; less so for too little :-) )\n\n---\nNew commits:",
    "created_at": "2019-01-14T21:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376750",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:5'></a>Changed back to using sqrt method. It's much faster because it doesn't have to do all the generic stuff. This is a core routine -- it actually makes a difference if it's fast.

(also -- not a fan of all the trivial whitespace edits. It makes it hard to tell from the diff what has actually changed. If you have to touch a line anyway: sure, go ahead. Otherwise I think it's better to just leave it in the original form and not impose (subjective) aesthetics --PEP8's suggestions are mainly against too much whitespace; less so for too little :-) )

---
New commits:



---

archive/issue_comments_376751.json:
```json
{
    "body": "<a id='comment:6'></a>Very minor change, but I guess someone should take a look at it before we set it back to positive review.",
    "created_at": "2019-01-14T21:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376751",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:6'></a>Very minor change, but I guess someone should take a look at it before we set it back to positive review.



---

archive/issue_comments_376752.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-01-14T21:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376752",
    "user": "https://github.com/nbruin"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_376753.json:
```json
{
    "body": "<a id='comment:7'></a>It would be fine with me except it can have a `float` input, which leads to these doctest failures (according to the patchbot):\n\n```\nsage -t --long src/sage/schemes/riemann_surfaces/riemann_surface.py  # 32 doctests failed\n```",
    "created_at": "2019-01-15T06:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376753",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>It would be fine with me except it can have a `float` input, which leads to these doctest failures (according to the patchbot):

```
sage -t --long src/sage/schemes/riemann_surfaces/riemann_surface.py  # 32 doctests failed
```



---

archive/issue_comments_376754.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-15T06:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376754",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_376755.json:
```json
{
    "body": "<a id='comment:8'></a>Whatever way, the point of this ticket is to make this module's doctests pass with both python2 and python3. If you want to keep the speed, this may not be so easy.\n\nEDIT: pep8 is official for sage, see\n\nhttps://doc.sagemath.org/html/en/developer/coding_basics.html#python-code-style",
    "created_at": "2019-01-15T07:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376755",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>Whatever way, the point of this ticket is to make this module's doctests pass with both python2 and python3. If you want to keep the speed, this may not be so easy.

EDIT: pep8 is official for sage, see

https://doc.sagemath.org/html/en/developer/coding_basics.html#python-code-style



---

archive/issue_comments_376756.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 tscrim]:\n> It would be fine with me except it can have a `float` input, which leads to these doctest failures (according to the patchbot)\n\n\nThat's strange. I cannot replicate that behaviour. It seems to me this bot is testing python 2, so it doesn't look like a py2/3 issue. Is this bot anomalous? If I had access to a platform where this behaviour occurs, I could probably debug this quite quickly.",
    "created_at": "2019-01-15T07:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376756",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:9'></a>Replying to [comment:7 tscrim]:
> It would be fine with me except it can have a `float` input, which leads to these doctest failures (according to the patchbot)


That's strange. I cannot replicate that behaviour. It seems to me this bot is testing python 2, so it doesn't look like a py2/3 issue. Is this bot anomalous? If I had access to a platform where this behaviour occurs, I could probably debug this quite quickly.



---

archive/issue_comments_376757.json:
```json
{
    "body": "<a id='comment:10'></a>Maybe this python3-like behaviour is caused by the line\n\n```\nfrom __future__ import division\n```\nthat we really want to add.",
    "created_at": "2019-01-15T07:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376757",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>Maybe this python3-like behaviour is caused by the line

```
from __future__ import division
```
that we really want to add.



---

archive/issue_comments_376758.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 chapoton]:\n> Maybe this python3-like behaviour is caused by the line\n> \n> ```\n> from __future__ import division\n> ```\n> that we really want to add.\n\n\nApparently only on some platforms then, because I ran this exact branch without problems. It means some divisions need to be encoded differently. \n\nIs it indeed the case that dividing an element of RealField by a python integer may yield a float on some and a RealField element on others if \"division\" is imported? That would be really bad and would make porting a lot harder.",
    "created_at": "2019-01-15T07:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376758",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:11'></a>Replying to [comment:10 chapoton]:
> Maybe this python3-like behaviour is caused by the line
> 
> ```
> from __future__ import division
> ```
> that we really want to add.


Apparently only on some platforms then, because I ran this exact branch without problems. It means some divisions need to be encoded differently. 

Is it indeed the case that dividing an element of RealField by a python integer may yield a float on some and a RealField element on others if "division" is imported? That would be really bad and would make porting a lot harder.



---

archive/issue_comments_376759.json:
```json
{
    "body": "<a id='comment:12'></a>I don't know.\n\nWe could try to use `**QQ((1,2))`but it will probably be just as slow as `sqrt(...)`",
    "created_at": "2019-01-15T07:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376759",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>I don't know.

We could try to use `**QQ((1,2))`but it will probably be just as slow as `sqrt(...)`



---

archive/issue_comments_376760.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 chapoton]:\n> We could try to use `**QQ((1,2))`but it will probably be just as slow as `sqrt(...)`\n\n\nNo, if this really is a problem we can replace the \"division by two\" by an exponent operation, which would be very fast. I just need to know which operations are the problematic ones. On the computers I have access to, there is no problem, so I can't debug the problem presently.",
    "created_at": "2019-01-15T08:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376760",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:13'></a>Replying to [comment:12 chapoton]:
> We could try to use `**QQ((1,2))`but it will probably be just as slow as `sqrt(...)`


No, if this really is a problem we can replace the "division by two" by an exponent operation, which would be very fast. I just need to know which operations are the problematic ones. On the computers I have access to, there is no problem, so I can't debug the problem presently.



---

archive/issue_comments_376761.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-15T08:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376761",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_376762.json:
```json
{
    "body": "<a id='comment:15'></a>Let's see how the bot fares with this.",
    "created_at": "2019-01-15T08:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376762",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:15'></a>Let's see how the bot fares with this.



---

archive/issue_comments_376763.json:
```json
{
    "body": "<a id='comment:16'></a>got with python2 77 doctests failings in the modified file, for example\n\n```\nFile \"src/sage/schemes/riemann_surfaces/riemann_surface.py\", line 2244, in sage.schemes.riemann_surfaces.riemann_surface.RiemannSurfaceSum.__add__\nFailed example:\n    S1+S1+S1\nException raised:\n    Traceback (most recent call last):\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.riemann_surfaces.riemann_surface.RiemannSurfaceSum.__add__[3]>\", line 1, in <module>\n        S1+S1+S1\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 2043, in __add__\n        return RiemannSurfaceSum([self,other])\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 2168, in __init__\n        PM = s.period_matrix()\n      File \"sage/misc/cachefunc.pyx\", line 2314, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12763)\n        self.cache = f(self._instance)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 1562, in period_matrix\n        PM=self.matrix_of_integral_values(differentials)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 1499, in matrix_of_integral_values\n        cycles = self.homology_basis()\n      File \"sage/misc/cachefunc.pyx\", line 2314, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12763)\n        self.cache = f(self._instance)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 1170, in homology_basis\n        edgesu = self.upstairs_edges()\n      File \"sage/misc/cachefunc.pyx\", line 2314, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12763)\n        self.cache = f(self._instance)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 935, in upstairs_edges\n        homotopycont = self.homotopy_continuation(e)\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 711, in homotopy_continuation\n        delta = self._compute_delta(path(T), epsilon, wvalues=currw)/path_length\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py\", line 650, in _compute_delta\n        lowerbound = self._CC(self._a0) >> 1\n    TypeError: unsupported operand type(s) for >>: 'sage.rings.complex_number.ComplexNumber' and 'int'\n```",
    "created_at": "2019-01-15T08:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376763",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>got with python2 77 doctests failings in the modified file, for example

```
File "src/sage/schemes/riemann_surfaces/riemann_surface.py", line 2244, in sage.schemes.riemann_surfaces.riemann_surface.RiemannSurfaceSum.__add__
Failed example:
    S1+S1+S1
Exception raised:
    Traceback (most recent call last):
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.riemann_surfaces.riemann_surface.RiemannSurfaceSum.__add__[3]>", line 1, in <module>
        S1+S1+S1
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 2043, in __add__
        return RiemannSurfaceSum([self,other])
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 2168, in __init__
        PM = s.period_matrix()
      File "sage/misc/cachefunc.pyx", line 2314, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12763)
        self.cache = f(self._instance)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 1562, in period_matrix
        PM=self.matrix_of_integral_values(differentials)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 1499, in matrix_of_integral_values
        cycles = self.homology_basis()
      File "sage/misc/cachefunc.pyx", line 2314, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12763)
        self.cache = f(self._instance)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 1170, in homology_basis
        edgesu = self.upstairs_edges()
      File "sage/misc/cachefunc.pyx", line 2314, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12763)
        self.cache = f(self._instance)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 935, in upstairs_edges
        homotopycont = self.homotopy_continuation(e)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 711, in homotopy_continuation
        delta = self._compute_delta(path(T), epsilon, wvalues=currw)/path_length
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/schemes/riemann_surfaces/riemann_surface.py", line 650, in _compute_delta
        lowerbound = self._CC(self._a0) >> 1
    TypeError: unsupported operand type(s) for >>: 'sage.rings.complex_number.ComplexNumber' and 'int'
```



---

archive/issue_comments_376764.json:
```json
{
    "body": "<a id='comment:17'></a>Did you try with a python3-built sage ?\n\nReplying to [comment:13 nbruin]:\n> Replying to [comment:12 chapoton]:\n> > We could try to use `**QQ((1,2))`but it will probably be just as slow as `sqrt(...)`\n\n> \n> No, if this really is a problem we can replace the \"division by two\" by an exponent operation, which would be very fast. I just need to know which operations are the problematic ones. On the computers I have access to, there is no problem, so I can't debug the problem presently.",
    "created_at": "2019-01-15T08:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376764",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>Did you try with a python3-built sage ?

Replying to [comment:13 nbruin]:
> Replying to [comment:12 chapoton]:
> > We could try to use `**QQ((1,2))`but it will probably be just as slow as `sqrt(...)`

> 
> No, if this really is a problem we can replace the "division by two" by an exponent operation, which would be very fast. I just need to know which operations are the problematic ones. On the computers I have access to, there is no problem, so I can't debug the problem presently.



---

archive/issue_comments_376765.json:
```json
{
    "body": "<a id='comment:18'></a>When undoing the bad change in `lowerbound = self._CC(self._a0) >> 1`,\nI still get 36 failing doctests in python3 and 32 failing doctests in python2 (same as the one reported by Travis above)",
    "created_at": "2019-01-15T08:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376765",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>When undoing the bad change in `lowerbound = self._CC(self._a0) >> 1`,
I still get 36 failing doctests in python3 and 32 failing doctests in python2 (same as the one reported by Travis above)



---

archive/issue_comments_376766.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-15T08:43:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376766",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_376767.json:
```json
{
    "body": "<a id='comment:20'></a>By running \"sage -b\" I was able to replicate the erroneous behaviour :-). Turns out the problem arose from an erroneous \"fractional\" exponent that was never fractional, so this code was actually not behaving as intended before, but doing so silently.\n\nHopefully the problem is solved now.",
    "created_at": "2019-01-15T08:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376767",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:20'></a>By running "sage -b" I was able to replicate the erroneous behaviour :-). Turns out the problem arose from an erroneous "fractional" exponent that was never fractional, so this code was actually not behaving as intended before, but doing so silently.

Hopefully the problem is solved now.



---

archive/issue_comments_376768.json:
```json
{
    "body": "<a id='comment:21'></a>ok, thanks. This seems to work both in python2 and in python3. I have launched my bot on it.",
    "created_at": "2019-01-15T09:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376768",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>ok, thanks. This seems to work both in python2 and in python3. I have launched my bot on it.



---

archive/issue_comments_376769.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-15T09:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376769",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_067179.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-15T09:08:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27049#event-67179"
}
```



---

archive/issue_comments_376770.json:
```json
{
    "body": "<a id='comment:24'></a>Bot is now green. so this should be good to go. Positive review, everybody ?",
    "created_at": "2019-01-15T10:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376770",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'></a>Bot is now green. so this should be good to go. Positive review, everybody ?



---

archive/issue_comments_376771.json:
```json
{
    "body": "<a id='comment:25'></a>LGTM.",
    "created_at": "2019-01-15T16:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376771",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>LGTM.



---

archive/issue_comments_376772.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-15T16:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376772",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_067180.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27049#event-67180"
}
```



---

archive/issue_comments_376773.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-24T18:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27049",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27049#issuecomment-376773",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
