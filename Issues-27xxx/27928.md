# Issue 27928: Implement Lex DFS

archive/issues_027691.json:
```json
{
    "body": "In this ticket, we implement Lex DFS traversal as described in [this](http://www.cs.toronto.edu/~krueger/papers/unified.ps) paper. Also, we rewrite the code for Lex BFS to follow the pseudocode in the paper which is easier to understand.\n\nKeywords: gsoc19\n\nBranch/Commit: 6593331d42b23a90800a7738cd2ce9c118ba67ff\n\nReviewer: David Coudert\n\nAuthor: Georgios Giapitzakis Tzintanos\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27928\n\n",
    "closed_at": "2019-07-14T08:32:25Z",
    "created_at": "2019-06-04T14:42:54Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Implement Lex DFS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27928",
    "user": "https://github.com/giorgosgiapis"
}
```
In this ticket, we implement Lex DFS traversal as described in [this](http://www.cs.toronto.edu/~krueger/papers/unified.ps) paper. Also, we rewrite the code for Lex BFS to follow the pseudocode in the paper which is easier to understand.

Keywords: gsoc19

Branch/Commit: 6593331d42b23a90800a7738cd2ce9c118ba67ff

Reviewer: David Coudert

Author: Georgios Giapitzakis Tzintanos

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27928





---

archive/issue_comments_390475.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-04T15:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390475",
    "user": "https://github.com/giorgosgiapis"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_390476.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2019-06-04T15:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390476",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_390477.json:
```json
{
    "body": "<a id='comment:3'></a>Long time ago, we tried to implement the linear time algorithm for LexBFS, but it's not finalized. See #11736. It could give you some ideas. At least a working and clean LexBFS is a great improvement.\n\n\nSome comments:\n\n- You should let a brief description of the algorithm and add a reference in `src/doc/en/reference/references/index.rst`\n\n```diff\n-        This algorithm maintains for each vertex left in the graph a code\n-        corresponding to the vertices already removed. The vertex of maximal\n-        code (according to the lexicographic order) is then removed, and the\n-        codes are updated.\n+        The algorithm used is described in\n+        `this <http://www.cs.toronto.edu/~krueger/papers/unified.ps>`_ by\n+        Derek G. Corneil and Richard Krueger.\n```\n\n- no need for this empty line\n\n```diff\n+\n+        nV = self.order()\n```\n\n- unless I missed something\n\n```diff\n-            edges = [(id_inv[i], id_inv[pred[i]]) for i in range(self.order()) if pred[i] != -1]\n+            edges = [(id_inv[i], id_inv[pred[i]]) for i in range(nV) if pred[i] != -1]\n```\n\n- instead of lambda, it might be better to use a def\n\n```diff\n         l = lambda x: code[x]\n+        def l(x):\n+            return code[x]\n```\n\n\n- in `lex_DFS`, instead of defining `add_element = (lambda y: value.append(id_inv[y])) if not reverse else (lambda y: value.insert(0, id_inv[y]))`, you should always do `value.append(id_inv[y])` and after the while loop reverse the list if `reverse` is true. Indeed, inserting at the beginning of a list is costly.\n\n- in the code, is it possible to insert at the end of the list and use a different comparison function ? I'm not sure it is a good idea. At least think about it.\n\n- I did not check carefully if the 3-sun graph is already defined in our graph constructors...\n\n- both methods are defined in `generic_graph.py`. What happen if `self` is directed ?",
    "created_at": "2019-06-12T15:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390477",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'></a>Long time ago, we tried to implement the linear time algorithm for LexBFS, but it's not finalized. See #11736. It could give you some ideas. At least a working and clean LexBFS is a great improvement.


Some comments:

- You should let a brief description of the algorithm and add a reference in `src/doc/en/reference/references/index.rst`

```diff
-        This algorithm maintains for each vertex left in the graph a code
-        corresponding to the vertices already removed. The vertex of maximal
-        code (according to the lexicographic order) is then removed, and the
-        codes are updated.
+        The algorithm used is described in
+        `this <http://www.cs.toronto.edu/~krueger/papers/unified.ps>`_ by
+        Derek G. Corneil and Richard Krueger.
```

- no need for this empty line

```diff
+
+        nV = self.order()
```

- unless I missed something

```diff
-            edges = [(id_inv[i], id_inv[pred[i]]) for i in range(self.order()) if pred[i] != -1]
+            edges = [(id_inv[i], id_inv[pred[i]]) for i in range(nV) if pred[i] != -1]
```

- instead of lambda, it might be better to use a def

```diff
         l = lambda x: code[x]
+        def l(x):
+            return code[x]
```


- in `lex_DFS`, instead of defining `add_element = (lambda y: value.append(id_inv[y])) if not reverse else (lambda y: value.insert(0, id_inv[y]))`, you should always do `value.append(id_inv[y])` and after the while loop reverse the list if `reverse` is true. Indeed, inserting at the beginning of a list is costly.

- in the code, is it possible to insert at the end of the list and use a different comparison function ? I'm not sure it is a good idea. At least think about it.

- I did not check carefully if the 3-sun graph is already defined in our graph constructors...

- both methods are defined in `generic_graph.py`. What happen if `self` is directed ?



---

archive/issue_comments_390478.json:
```json
{
    "body": "<a id='comment:4'></a>Both Lex BFS and Lex DFS can be implemented in O(n+m) time. In #27518 I implemented a function to return the adjacency list of a boost graph. What we could do now is just convert our graph to a boost graph, get its adjacency list and then run the linear time algorithm for both Lex BFS and Lex DFS. Should I proceed to the creation of this method in `generic_graph_pyx`?\\\\\n\\\\\n\n\n> - both methods are defined in `generic_graph.py`. What happen if `self` is directed ?\n\n\nI don't think that a directed graph can cause any problem. The algorithm should work for both directed and undirected graphs.",
    "created_at": "2019-06-13T10:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390478",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:4'></a>Both Lex BFS and Lex DFS can be implemented in O(n+m) time. In #27518 I implemented a function to return the adjacency list of a boost graph. What we could do now is just convert our graph to a boost graph, get its adjacency list and then run the linear time algorithm for both Lex BFS and Lex DFS. Should I proceed to the creation of this method in `generic_graph_pyx`?\\
\\


> - both methods are defined in `generic_graph.py`. What happen if `self` is directed ?


I don't think that a directed graph can cause any problem. The algorithm should work for both directed and undirected graphs.



---

archive/issue_comments_390479.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 gh-giorgosgiapis]:\n> Both Lex BFS and Lex DFS can be implemented in O(n+m) time. In #27518 I implemented a function to return the adjacency list of a boost graph.\n\nwhich method ?\n\n> What we could do now is just convert our graph to a boost graph, get its adjacency list and then run the linear time algorithm for both Lex BFS and Lex DFS. Should I proceed to the creation of this method in `generic_graph_pyx`?\n\n\nIf you use boost, the best is certainly to add the method to `boost_graph.pyx`\n\n> > - both methods are defined in `generic_graph.py`. What happen if `self` is directed ?\n \n> \n> I don't think that a directed graph can cause any problem. The algorithm should work for both directed and undirected graphs.\n\n\nYou should try and add appropriate doctests .",
    "created_at": "2019-06-13T15:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390479",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>Replying to [comment:4 gh-giorgosgiapis]:
> Both Lex BFS and Lex DFS can be implemented in O(n+m) time. In #27518 I implemented a function to return the adjacency list of a boost graph.

which method ?

> What we could do now is just convert our graph to a boost graph, get its adjacency list and then run the linear time algorithm for both Lex BFS and Lex DFS. Should I proceed to the creation of this method in `generic_graph_pyx`?


If you use boost, the best is certainly to add the method to `boost_graph.pyx`

> > - both methods are defined in `generic_graph.py`. What happen if `self` is directed ?
 
> 
> I don't think that a directed graph can cause any problem. The algorithm should work for both directed and undirected graphs.


You should try and add appropriate doctests .



---

archive/issue_comments_390480.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 dcoudert]:\n\n> which method ?\n\n\nMethod `edge_list()` in  `boost_interface.cpp`. It doesn't directly return the adjacency list but we can create it easily from the edge list. I  am not sure however whether or not it is more efficient to do this rather than building it directly from the sage graph.",
    "created_at": "2019-06-13T16:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390480",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:6'></a>Replying to [comment:5 dcoudert]:

> which method ?


Method `edge_list()` in  `boost_interface.cpp`. It doesn't directly return the adjacency list but we can create it easily from the edge list. I  am not sure however whether or not it is more efficient to do this rather than building it directly from the sage graph.



---

archive/issue_comments_390481.json:
```json
{
    "body": "<a id='comment:7'></a>From a Sage Graph, we already have access to the list of edges, the list of neighbors, the list of incident edges, etc. so I don't understand why you want to use `edge_list` from boost. Of course, if it helps getting a much faster code, then go for it.",
    "created_at": "2019-06-13T16:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390481",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>From a Sage Graph, we already have access to the list of edges, the list of neighbors, the list of incident edges, etc. so I don't understand why you want to use `edge_list` from boost. Of course, if it helps getting a much faster code, then go for it.



---

archive/issue_comments_390482.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 dcoudert]:\n> From a Sage Graph, we already have access to the list of edges, the list of neighbors, the list of incident edges, etc. so I don't understand why you want to use `edge_list` from boost. Of course, if it helps getting a much faster code, then go for it.\n\n\nI have implemented Lex BFS in Cython. Should I remove Lex BFS from `generic_graph.py` or leave it there and just call the Cython version from inside the method?",
    "created_at": "2019-06-13T18:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390482",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:8'></a>Replying to [comment:7 dcoudert]:
> From a Sage Graph, we already have access to the list of edges, the list of neighbors, the list of incident edges, etc. so I don't understand why you want to use `edge_list` from boost. Of course, if it helps getting a much faster code, then go for it.


I have implemented Lex BFS in Cython. Should I remove Lex BFS from `generic_graph.py` or leave it there and just call the Cython version from inside the method?



---

archive/issue_comments_390483.json:
```json
{
    "body": "<a id='comment:9'></a>It's better to call the cython version from the Python version. Add parameter `algorithm=...`. This way you can add a doctest to check that both methods return the same result.",
    "created_at": "2019-06-13T18:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390483",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:9'></a>It's better to call the cython version from the Python version. Add parameter `algorithm=...`. This way you can add a doctest to check that both methods return the same result.



---

archive/issue_comments_390484.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 dcoudert]:\n> It's better to call the cython version from the Python version. Add parameter `algorithm=...`. This way you can add a doctest to check that both methods return the same result.\n\n\nUnfortunately, the current lex BFS method does not work with DiGraphs, the reason being that to get the neighbors of a vertex `v` it examines the `v-th` **column** of the adjacency matrix whereas it should examine the `v-th` **row**. In undirected graphs this isn't a problem since this matrix is symmetric.",
    "created_at": "2019-06-13T18:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390484",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:10'></a>Replying to [comment:9 dcoudert]:
> It's better to call the cython version from the Python version. Add parameter `algorithm=...`. This way you can add a doctest to check that both methods return the same result.


Unfortunately, the current lex BFS method does not work with DiGraphs, the reason being that to get the neighbors of a vertex `v` it examines the `v-th` **column** of the adjacency matrix whereas it should examine the `v-th` **row**. In undirected graphs this isn't a problem since this matrix is symmetric.



---

archive/issue_comments_390485.json:
```json
{
    "body": "<a id='comment:11'></a>Also, I do not think it is needed to have two separate algorithms to perform Lex BFS since both do exactly the same thing and their only difference is the data structures used. Therefore I believe that it is better to just call the Cython method from the one in `generic_graph.py`.",
    "created_at": "2019-06-13T19:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390485",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:11'></a>Also, I do not think it is needed to have two separate algorithms to perform Lex BFS since both do exactly the same thing and their only difference is the data structures used. Therefore I believe that it is better to just call the Cython method from the one in `generic_graph.py`.



---

archive/issue_comments_390486.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-13T19:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390486",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390487.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-13T19:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390488.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:10 gh-giorgosgiapis]:\n> Unfortunately, the current lex BFS method does not work with DiGraphs, the reason being that to get the neighbors of a vertex `v` it examines the `v-th` **column** of the adjacency matrix whereas it should examine the `v-th` **row**. In undirected graphs this isn't a problem since this matrix is symmetric.\n\n\nThe code prior to this comment was not using the adjacency matrix, and we have iterators to get the neighbors, out neighbors, etc. So I don't understand this comment.\n \n> Also, I do not think it is needed to have two separate algorithms to perform Lex BFS since both do exactly the same thing and their only difference is the data structures used. Therefore I believe that it is better to just call the Cython method from the one in `generic_graph.py`. \n\n\nIt's never bas to have 2 methods, even if very similar, to check the correctness of the new one.\n\nIn the `Cython code`:\n- instead of creating `adjacency_list` with `vector`, you could use static sparse graphs. See for instance in `distances_all_pairs.pyx`\n- the test `if nV == 0:` should be done before feeding other data structures\n- `cdef dict int_to_v = dict(enumerate(G))` -> `cdef list int_to_v = list(G)`\n- `cdef u_int, v_int` -> `cdef int u_int, v_int`\n- for `pred`, why not using an integer array instead of a list ?\n\nMay be we should create a new file names `graph_traversals.pyx` to host lexBFS, lexDFS, lexM, etc.",
    "created_at": "2019-06-14T06:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390488",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:14'></a>Replying to [comment:10 gh-giorgosgiapis]:
> Unfortunately, the current lex BFS method does not work with DiGraphs, the reason being that to get the neighbors of a vertex `v` it examines the `v-th` **column** of the adjacency matrix whereas it should examine the `v-th` **row**. In undirected graphs this isn't a problem since this matrix is symmetric.


The code prior to this comment was not using the adjacency matrix, and we have iterators to get the neighbors, out neighbors, etc. So I don't understand this comment.
 
> Also, I do not think it is needed to have two separate algorithms to perform Lex BFS since both do exactly the same thing and their only difference is the data structures used. Therefore I believe that it is better to just call the Cython method from the one in `generic_graph.py`. 


It's never bas to have 2 methods, even if very similar, to check the correctness of the new one.

In the `Cython code`:
- instead of creating `adjacency_list` with `vector`, you could use static sparse graphs. See for instance in `distances_all_pairs.pyx`
- the test `if nV == 0:` should be done before feeding other data structures
- `cdef dict int_to_v = dict(enumerate(G))` -> `cdef list int_to_v = list(G)`
- `cdef u_int, v_int` -> `cdef int u_int, v_int`
- for `pred`, why not using an integer array instead of a list ?

May be we should create a new file names `graph_traversals.pyx` to host lexBFS, lexDFS, lexM, etc.



---

archive/issue_comments_390489.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 dcoudert]:\n> Replying to [comment:10 gh-giorgosgiapis]:\n> > Unfortunately, the current lex BFS method does not work with DiGraphs, the reason being that to get the neighbors of a vertex `v` it examines the `v-th` **column** of the adjacency matrix whereas it should examine the `v-th` **row**. In undirected graphs this isn't a problem since this matrix is symmetric.\n\n> \n> The code prior to this comment was not using the adjacency matrix, and we have iterators to get the neighbors, out neighbors, etc. So I don't understand this comment.\n\n\\\\\nThe original code I see uses the adjacency matrix I mentioned and does not work for directed graphs. The version I have is 8.8.beta4. Maybe the code was patched in a newer beta release?\\\\\n\\\\\n> In the `Cython code`:\n> - instead of creating `adjacency_list` with `vector`, you could use static sparse graphs. See for instance in `distances_all_pairs.pyx`\n> - the test `if nV == 0:` should be done before feeding other data structures\n> - `cdef dict int_to_v = dict(enumerate(G))` -> `cdef list int_to_v = list(G)`\n> - `cdef u_int, v_int` -> `cdef int u_int, v_int`\n> - for `pred`, why not using an integer array instead of a list ?\n \n\\\\\nWill do.\\\\\n\\\\\n\n> May be we should create a new file names `graph_traversals.pyx` to host lexBFS, lexDFS, lexM, etc.\n\n\\\\\nWhen all of these methods are created I will add them to this new file.",
    "created_at": "2019-06-14T09:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390489",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:15'></a>Replying to [comment:14 dcoudert]:
> Replying to [comment:10 gh-giorgosgiapis]:
> > Unfortunately, the current lex BFS method does not work with DiGraphs, the reason being that to get the neighbors of a vertex `v` it examines the `v-th` **column** of the adjacency matrix whereas it should examine the `v-th` **row**. In undirected graphs this isn't a problem since this matrix is symmetric.

> 
> The code prior to this comment was not using the adjacency matrix, and we have iterators to get the neighbors, out neighbors, etc. So I don't understand this comment.

\\
The original code I see uses the adjacency matrix I mentioned and does not work for directed graphs. The version I have is 8.8.beta4. Maybe the code was patched in a newer beta release?\\
\\
> In the `Cython code`:
> - instead of creating `adjacency_list` with `vector`, you could use static sparse graphs. See for instance in `distances_all_pairs.pyx`
> - the test `if nV == 0:` should be done before feeding other data structures
> - `cdef dict int_to_v = dict(enumerate(G))` -> `cdef list int_to_v = list(G)`
> - `cdef u_int, v_int` -> `cdef int u_int, v_int`
> - for `pred`, why not using an integer array instead of a list ?
 
\\
Will do.\\
\\

> May be we should create a new file names `graph_traversals.pyx` to host lexBFS, lexDFS, lexM, etc.

\\
When all of these methods are created I will add them to this new file.



---

archive/issue_comments_390490.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-14T12:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390490",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390491.json:
```json
{
    "body": "<a id='comment:17'></a>> The original code I see uses the adjacency matrix I mentioned and does not work for directed graphs. The version I have is 8.8.beta4. Maybe the code was patched in a newer beta release?\n\nOups, my fault. So yes, it's not good for digraphs.",
    "created_at": "2019-06-14T13:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390491",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:17'></a>> The original code I see uses the adjacency matrix I mentioned and does not work for directed graphs. The version I have is 8.8.beta4. Maybe the code was patched in a newer beta release?

Oups, my fault. So yes, it's not good for digraphs.



---

archive/issue_comments_390492.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-01T13:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390493.json:
```json
{
    "body": "<a id='comment:19'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390493",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_events_069209.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27928#event-69209"
}
```



---

archive/issue_comments_390494.json:
```json
{
    "body": "<a id='comment:20'></a>I'm adding both methods in a new file called `traversals.pyx`",
    "created_at": "2019-07-03T14:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390494",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:20'></a>I'm adding both methods in a new file called `traversals.pyx`



---

archive/issue_comments_390495.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-03T16:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390495",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390496.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-03T16:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390496",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390497.json:
```json
{
    "body": "<a id='comment:23'></a>I have edited the code and pushed to a new branch in `public/` so that we can both edit it.\n\nMore precisely, I did the following\n- rebase on `8.9.beta1`\n\n- in `generic_graph_pyx.pxd`, remove (no longer needed here)\n\n```diff\n+from libcpp.vector cimport vector\n+\n+\n```\n- in `generic_graph_pyx.pyx`, remove \n\n```diff\n+import collections\n```\n\n- in `generic_graph.py`: use alias to methods instead of extra frontend method. It's shorter and more efficient this way.\n\n- in `traversals.pyx`\n  - change file header, add table of methods and copyright\n  - extend one line description of methods\n  - put proper bibliographic reference\n  - add missing deallocation of short digraph\n  - make the graph simple if it allows loops or multiple edges.  In general, **DO NOT MODIFY INPUT GRAPH**. This is strictly forbidden ! Either we raise an error, or use `to_simple` to make a copy without loop/multiedges. Here, instead of checking if the graph effectively has loops or multiedges, I directly make a copy. I think it's more efficient like that, but may be not...\n\n\nWhat remains to be done:\n- add tests for corner case (empty (di)graph, etc.)\n- try other (di)graphs, in particular a symmetric digraph to check if it's working well\n- Check if further improvements are possible\n- BFS and DFS are iterators. Can't we turn LexBFS and LexDFS to iterators as well ? it might not be possible when `reverse=True`.\n\n---\nNew commits:",
    "created_at": "2019-07-06T13:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390497",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:23'></a>I have edited the code and pushed to a new branch in `public/` so that we can both edit it.

More precisely, I did the following
- rebase on `8.9.beta1`

- in `generic_graph_pyx.pxd`, remove (no longer needed here)

```diff
+from libcpp.vector cimport vector
+
+
```
- in `generic_graph_pyx.pyx`, remove 

```diff
+import collections
```

- in `generic_graph.py`: use alias to methods instead of extra frontend method. It's shorter and more efficient this way.

- in `traversals.pyx`
  - change file header, add table of methods and copyright
  - extend one line description of methods
  - put proper bibliographic reference
  - add missing deallocation of short digraph
  - make the graph simple if it allows loops or multiple edges.  In general, **DO NOT MODIFY INPUT GRAPH**. This is strictly forbidden ! Either we raise an error, or use `to_simple` to make a copy without loop/multiedges. Here, instead of checking if the graph effectively has loops or multiedges, I directly make a copy. I think it's more efficient like that, but may be not...


What remains to be done:
- add tests for corner case (empty (di)graph, etc.)
- try other (di)graphs, in particular a symmetric digraph to check if it's working well
- Check if further improvements are possible
- BFS and DFS are iterators. Can't we turn LexBFS and LexDFS to iterators as well ? it might not be possible when `reverse=True`.

---
New commits:



---

archive/issue_comments_390498.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-06T13:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390498",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390499.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-06T13:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390499",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390500.json:
```json
{
    "body": "<a id='comment:26'></a>Also, I'm currently unable to build the documentation of sagemath. Try to do it and check if the html code is nice.",
    "created_at": "2019-07-06T13:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390500",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:26'></a>Also, I'm currently unable to build the documentation of sagemath. Try to do it and check if the html code is nice.



---

archive/issue_comments_390501.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 dcoudert]:\n> Also, I'm currently unable to build the documentation of sagemath. Try to do it and check if the html code is nice.\n\n\nI'm now building the documentation. Once that is done I will create some tests.",
    "created_at": "2019-07-06T14:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390501",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:27'></a>Replying to [comment:26 dcoudert]:
> Also, I'm currently unable to build the documentation of sagemath. Try to do it and check if the html code is nice.


I'm now building the documentation. Once that is done I will create some tests.



---

archive/issue_comments_390502.json:
```json
{
    "body": "<a id='comment:28'></a>Also, I am unable to build the documentation in my Mac OS system (it works fine in Linux). Is this a known issue with sage?",
    "created_at": "2019-07-06T14:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390502",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:28'></a>Also, I am unable to build the documentation in my Mac OS system (it works fine in Linux). Is this a known issue with sage?



---

archive/issue_comments_390503.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 gh-giorgosgiapis]:\n> Also, I am unable to build the documentation in my Mac OS system (it works fine in Linux). Is this a known issue with sage?\n\nNot that I'm aware of. I also have issue on mac but my laptop is old and its system as well. I'm too lazy to update it because it's never a good time... I'm waiting for a new laptop.\n\nHave you done a `make doc-clean` before trying to build the doc ? what's the error message ? You can call for help on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel)",
    "created_at": "2019-07-06T14:23:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390503",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:29'></a>Replying to [comment:28 gh-giorgosgiapis]:
> Also, I am unable to build the documentation in my Mac OS system (it works fine in Linux). Is this a known issue with sage?

Not that I'm aware of. I also have issue on mac but my laptop is old and its system as well. I'm too lazy to update it because it's never a good time... I'm waiting for a new laptop.

Have you done a `make doc-clean` before trying to build the doc ? what's the error message ? You can call for help on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel)



---

archive/issue_comments_390504.json:
```json
{
    "body": "<a id='comment:30'></a>Documentation finished building but I can't seem to find the html files for the new file. What did I do wrong?\n\n(I can see the documentation for the methods in generic_graph's documentation only. Is this how it is supposed to be?)",
    "created_at": "2019-07-06T18:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390504",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:30'></a>Documentation finished building but I can't seem to find the html files for the new file. What did I do wrong?

(I can see the documentation for the methods in generic_graph's documentation only. Is this how it is supposed to be?)



---

archive/issue_comments_390505.json:
```json
{
    "body": "<a id='comment:31'></a>You must add `sage/graphs/traversals` to `src/doc/en/reference/graphs/index.rst`. See e.g., #25436.\n\nBut I'm pretty sure you can already see it. It's the same path than other files of the graph module, so `sage/local/share/doc/sage/...`",
    "created_at": "2019-07-06T20:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390505",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:31'></a>You must add `sage/graphs/traversals` to `src/doc/en/reference/graphs/index.rst`. See e.g., #25436.

But I'm pretty sure you can already see it. It's the same path than other files of the graph module, so `sage/local/share/doc/sage/...`



---

archive/issue_comments_390506.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-06T22:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390507.json:
```json
{
    "body": "<a id='comment:33'></a>Now everything seems ok with the display of the documentation.",
    "created_at": "2019-07-06T22:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390507",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:33'></a>Now everything seems ok with the display of the documentation.



---

archive/issue_comments_390508.json:
```json
{
    "body": "<a id='comment:34'></a>I have a doubt on the use of memset. I might be wrong, but I think you fill each byte of each integer of array pred with -1. A for loop might be safer here, no ?\n\nAlso:\n\n```diff\n-        for i in range (0, out_degree(sd, v)):\n+        for i in range(0, out_degree(sd, v)):\n```",
    "created_at": "2019-07-07T09:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390508",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:34'></a>I have a doubt on the use of memset. I might be wrong, but I think you fill each byte of each integer of array pred with -1. A for loop might be safer here, no ?

Also:

```diff
-        for i in range (0, out_degree(sd, v)):
+        for i in range(0, out_degree(sd, v)):
```



---

archive/issue_comments_390509.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-09T13:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390509",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390510.json:
```json
{
    "body": "<a id='comment:36'></a>I have added some tests for both methods to ensure they are working. As for memset, I don't think it will cause a problem. We can, however, initialize the array with a loop though I believe memset is a bit faster here.",
    "created_at": "2019-07-09T14:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390510",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:36'></a>I have added some tests for both methods to ensure they are working. As for memset, I don't think it will cause a problem. We can, however, initialize the array with a loop though I believe memset is a bit faster here.



---

archive/issue_comments_390511.json:
```json
{
    "body": "<a id='comment:37'></a>As `lex_BFS` is exposed in `Graph`, there is no need for this change\n\n```diff\n-        sage: Graph(1).lex_BFS(tree=True)\n+        sage: from sage.graphs.traversals import lex_BFS\n+        sage: lex_BFS(Graph(1), tree=True)\n```\nSo you should use `G.lex_BFS()` and `G.lex_DFS()` in all doctests.\n\nFor the test with symmetric digraph, you can do:\n\n```\nG = Graph([(1, 2), (1, 3), (2, 3), (2, 4), (2, 5), (3, 5), (3, 6), (4, 5), (5, 6)])\nD = DiGraph(G)\nG.lex_BFS() == D.lex_DFS()\n```",
    "created_at": "2019-07-10T08:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390511",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:37'></a>As `lex_BFS` is exposed in `Graph`, there is no need for this change

```diff
-        sage: Graph(1).lex_BFS(tree=True)
+        sage: from sage.graphs.traversals import lex_BFS
+        sage: lex_BFS(Graph(1), tree=True)
```
So you should use `G.lex_BFS()` and `G.lex_DFS()` in all doctests.

For the test with symmetric digraph, you can do:

```
G = Graph([(1, 2), (1, 3), (2, 3), (2, 4), (2, 5), (3, 5), (3, 6), (4, 5), (5, 6)])
D = DiGraph(G)
G.lex_BFS() == D.lex_DFS()
```



---

archive/issue_comments_390512.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T14:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390512",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_390513.json:
```json
{
    "body": "<a id='comment:39'></a>LGTM.",
    "created_at": "2019-07-12T07:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390513",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:39'></a>LGTM.



---

archive/issue_comments_390514.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-12T07:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390514",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_390515.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-14T08:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27928#issuecomment-390515",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069210.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-14T08:32:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27928",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27928#event-69210"
}
```
