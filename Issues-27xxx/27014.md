# Issue 27014: Deprecate sage.misc.misc.uniq

archive/issues_026777.json:
```json
{
    "body": "`uniq(X)` is just a shorthand for `sorted(set(X))`: I don't think that we need a separate function for that. More seriously, the sorting is problematic since arbitrary sets may not be sortable in general, especially in Python 3 or after applying #22029.\n\nCC:  @tscrim\n\nBranch/Commit: b4f67ca8620ffff6cf761abd44fe287a88c5bf13\n\nReviewer: Martin Rubey, Travis Scrimshaw\n\nAuthor: Jeroen Demeyer\n\nDependencies: #26933\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27014\n\n",
    "closed_at": "2019-01-22T12:40:05Z",
    "created_at": "2019-01-04T08:58:51Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Deprecate sage.misc.misc.uniq",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27014",
    "user": "https://github.com/jdemeyer"
}
```
`uniq(X)` is just a shorthand for `sorted(set(X))`: I don't think that we need a separate function for that. More seriously, the sorting is problematic since arbitrary sets may not be sortable in general, especially in Python 3 or after applying #22029.

CC:  @tscrim

Branch/Commit: b4f67ca8620ffff6cf761abd44fe287a88c5bf13

Reviewer: Martin Rubey, Travis Scrimshaw

Author: Jeroen Demeyer

Dependencies: #26933

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27014





---

archive/issue_comments_400984.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-04T10:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400984",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_400985.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2019-01-04T10:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400985",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_400986.json:
```json
{
    "body": "<a id='comment:4'></a>I am all for it!  (I ran the patchbot and looked at the code)",
    "created_at": "2019-01-04T17:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400986",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>I am all for it!  (I ran the patchbot and looked at the code)



---

archive/issue_comments_400987.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-04T17:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400987",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_400988.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2019-01-04T18:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400988",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_400989.json:
```json
{
    "body": "<a id='comment:5'></a>I am not so sure about actually deprecating it. The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is. Plus the message seems like it will not be there after the deprecation, and I believe this is a useful function from the (non-expert) user perspective. So I am somewhat inclined to also just do the `_stable_uniq -> uniq` now. Thoughts?",
    "created_at": "2019-01-04T18:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400989",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>I am not so sure about actually deprecating it. The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is. Plus the message seems like it will not be there after the deprecation, and I believe this is a useful function from the (non-expert) user perspective. So I am somewhat inclined to also just do the `_stable_uniq -> uniq` now. Thoughts?



---

archive/issue_comments_400990.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2019-01-04T19:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400990",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_400991.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 tscrim]:\n> The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is.\n\n\nNo. The existing `uniq()` sorts the list of objects, while `_stable_uniq()` keeps the existing order.",
    "created_at": "2019-01-04T19:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400991",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Replying to [comment:5 tscrim]:
> The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is.


No. The existing `uniq()` sorts the list of objects, while `_stable_uniq()` keeps the existing order.



---

archive/issue_comments_400992.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 jdemeyer]:\n> Replying to [comment:5 tscrim]:\n> > The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is.\n\n> \n> No. The existing `uniq()` sorts the list of objects, while `_stable_uniq()` keeps the existing order.\n\n\nAh, right, and the sorting of the output is documented. However, given the (eventual) goal, I think we should replace `uniq` with `_stable_uniq` and issue a deprecation warning about the sorting behavior change. Or at least in the current deprecation message say something like\n\n```\nthe output of uniq(X) being sorted is deprecated; use sorted(set(X)) instead\nif you want the output sorted\n```\nThe current deprecation message seems to indicate that the function will be removed altogether.",
    "created_at": "2019-01-04T19:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400992",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Replying to [comment:6 jdemeyer]:
> Replying to [comment:5 tscrim]:
> > The resulting behavior after `_stable_uniq -> uniq` is done will be the same is what it currently is.

> 
> No. The existing `uniq()` sorts the list of objects, while `_stable_uniq()` keeps the existing order.


Ah, right, and the sorting of the output is documented. However, given the (eventual) goal, I think we should replace `uniq` with `_stable_uniq` and issue a deprecation warning about the sorting behavior change. Or at least in the current deprecation message say something like

```
the output of uniq(X) being sorted is deprecated; use sorted(set(X)) instead
if you want the output sorted
```
The current deprecation message seems to indicate that the function will be removed altogether.



---

archive/issue_comments_400993.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-01-04T19:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400993",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_400994.json:
```json
{
    "body": "<a id='comment:8'></a>Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  \n\nIs there a good reason to call what's now `_stable_uniq` in a year's time `uniq`?",
    "created_at": "2019-01-04T22:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400994",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'></a>Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  

Is there a good reason to call what's now `_stable_uniq` in a year's time `uniq`?



---

archive/issue_comments_400995.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 mantepse]:\n> Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  \n\n\n`stable_uniq` does not sound discoverable or natural IMO. Also for those people who only want the `uniq` behavior, it means they would not have the change their code.\n\n> Is there a good reason to call what's now `_stable_uniq` in a year's time `uniq`?\n\n\nSomeone might be relying on this sorting behavior in the wild, so we need to deprecate it.",
    "created_at": "2019-01-05T05:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400995",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>Replying to [comment:8 mantepse]:
> Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  


`stable_uniq` does not sound discoverable or natural IMO. Also for those people who only want the `uniq` behavior, it means they would not have the change their code.

> Is there a good reason to call what's now `_stable_uniq` in a year's time `uniq`?


Someone might be relying on this sorting behavior in the wild, so we need to deprecate it.



---

archive/issue_comments_400996.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 tscrim]:\n> Replying to [comment:8 mantepse]:\n> > Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  \n\n> \n> `stable_uniq` does not sound discoverable or natural IMO.\n\n\nOK, although I wouldn't be looking for `uniq` either.  In fact, I was surprised by it's documentation, because the well known unix utility does something else.\n\nI was looking for `remove_duplicates` once, before it occurred to me that I want `set` :-)\n\n> Someone might be relying on this sorting behavior in the wild, so we need to deprecate it.\n\n\nI think that we all agree on that.",
    "created_at": "2019-01-05T08:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400996",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'></a>Replying to [comment:9 tscrim]:
> Replying to [comment:8 mantepse]:
> > Why not simply introduce the function `stable_uniq`, and remove `uniq` after deprecation?  

> 
> `stable_uniq` does not sound discoverable or natural IMO.


OK, although I wouldn't be looking for `uniq` either.  In fact, I was surprised by it's documentation, because the well known unix utility does something else.

I was looking for `remove_duplicates` once, before it occurred to me that I want `set` :-)

> Someone might be relying on this sorting behavior in the wild, so we need to deprecate it.


I think that we all agree on that.



---

archive/issue_comments_400997.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-05T09:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400997",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_400998.json:
```json
{
    "body": "<a id='comment:12'></a>Reworded deprecation message as Travis suggested.",
    "created_at": "2019-01-05T09:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400998",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Reworded deprecation message as Travis suggested.



---

archive/issue_comments_400999.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-05T09:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-400999",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_401000.json:
```json
{
    "body": "<a id='comment:13'></a>Thank you.",
    "created_at": "2019-01-05T17:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-401000",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>Thank you.



---

archive/issue_comments_401001.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-05T17:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-401001",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_401002.json:
```json
{
    "body": "<a id='comment:14'></a>Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-401002",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_067051.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27014#event-67051"
}
```



---

archive/issue_comments_401003.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-22T12:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27014#issuecomment-401003",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_067052.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-22T12:40:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27014",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27014#event-67052"
}
```
