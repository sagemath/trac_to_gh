# Issue 27384: Apply Cysignals fix for Cygwin exception handler on sigaltstack

archive/issues_027147.json:
```json
{
    "assignees": [],
    "body": "This adds a version of the patch from https://github.com/sagemath/cysignals/pull/108 modified to apply to cysignals 1.8.1.\n\nSince the issue only affects Cygwin I thought for now it would be easier (as in #27267) to apply the patch locally, rather than wait on Jeroen to approve the upstream PR, make a new release of cysignals, and make Sage depend on that release.\n\nThis fix certainly resolves the blocker issue well-enough for me for the time being. Fixing this is a prerequisite for fixing #27214.\n\nCC:  @jdemeyer\n\nBranch/Commit: **[u/embray/cygwin/patch-cysignals-altstack-exception-handler](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/cygwin/patch-cysignals-altstack-exception-handler) @ [f95dcff](https://github.com/sagemath/sagetrac-mirror/commit/f95dcff22000f525b3a114d89dd10b2e134589fa)**\n\nAuthor: **Erik Bray**\n\nComponent: **porting: Cygwin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27384_\n\n",
    "closed_at": "2019-03-10T21:37:25Z",
    "created_at": "2019-02-28T10:54:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20cygwin",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Apply Cysignals fix for Cygwin exception handler on sigaltstack",
    "type": "issue",
    "updated_at": "2019-03-11T12:12:01Z",
    "url": "https://github.com/sagemath/sage/issues/27384",
    "user": "https://github.com/embray"
}
```
This adds a version of the patch from https://github.com/sagemath/cysignals/pull/108 modified to apply to cysignals 1.8.1.

Since the issue only affects Cygwin I thought for now it would be easier (as in #27267) to apply the patch locally, rather than wait on Jeroen to approve the upstream PR, make a new release of cysignals, and make Sage depend on that release.

This fix certainly resolves the blocker issue well-enough for me for the time being. Fixing this is a prerequisite for fixing #27214.

CC:  @jdemeyer

Branch/Commit: **[u/embray/cygwin/patch-cysignals-altstack-exception-handler](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/cygwin/patch-cysignals-altstack-exception-handler) @ [f95dcff](https://github.com/sagemath/sagetrac-mirror/commit/f95dcff22000f525b3a114d89dd10b2e134589fa)**

Author: **Erik Bray**

Component: **porting: Cygwin**

_Issue created by migration from https://trac.sagemath.org/ticket/27384_





---

archive/issue_events_376159.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T10:54:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376159"
}
```



---

archive/issue_events_376160.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T10:54:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20cygwin",
    "label_color": "000080",
    "label_name": "c: porting: cygwin",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376160"
}
```



---

archive/issue_events_376161.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T10:54:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376161"
}
```



---

archive/issue_events_376162.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T10:54:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376162"
}
```



---

archive/issue_comments_423668.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f95dcff22000f525b3a114d89dd10b2e134589fa\">f95dcff</a></td><td><code>Trac #27384: Patch cysignals with fix for Cygwin's sigaltstack exception</code></td></tr></table>\n",
    "created_at": "2019-02-28T10:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423668",
    "user": "https://github.com/embray"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f95dcff22000f525b3a114d89dd10b2e134589fa">f95dcff</a></td><td><code>Trac #27384: Patch cysignals with fix for Cygwin's sigaltstack exception</code></td></tr></table>




---

archive/issue_comments_423669.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Since the issue only affects Cygwin I thought for now it would be easier (as in #27267) to apply the patch locally, rather than wait on Jeroen to approve the upstream PR, make a new release of cysignals, and make Sage depend on that release.\n \n-This fix certainly resolves the blocker issue well-enough for me for the time being.\n+This fix certainly resolves the blocker issue well-enough for me for the time being. Fixing this is a prerequisite for fixing #27214.\n``````\n",
    "created_at": "2019-02-28T10:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423669",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Since the issue only affects Cygwin I thought for now it would be easier (as in #27267) to apply the patch locally, rather than wait on Jeroen to approve the upstream PR, make a new release of cysignals, and make Sage depend on that release.
 
-This fix certainly resolves the blocker issue well-enough for me for the time being.
+This fix certainly resolves the blocker issue well-enough for me for the time being. Fixing this is a prerequisite for fixing #27214.
``````




---

archive/issue_comments_423670.json:
```json
{
    "body": "Branch: **[u/embray/cygwin/patch-cysignals-altstack-exception-handler](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/cygwin/patch-cysignals-altstack-exception-handler)**",
    "created_at": "2019-02-28T10:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423670",
    "user": "https://github.com/embray"
}
```

Branch: **[u/embray/cygwin/patch-cysignals-altstack-exception-handler](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/cygwin/patch-cysignals-altstack-exception-handler)**



---

archive/issue_events_376163.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-28T10:56:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376163"
}
```



---

archive/issue_comments_423671.json:
```json
{
    "body": "Commit: **[f95dcff](https://github.com/sagemath/sagetrac-mirror/commit/f95dcff22000f525b3a114d89dd10b2e134589fa)**",
    "created_at": "2019-02-28T10:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423671",
    "user": "https://github.com/embray"
}
```

Commit: **[f95dcff](https://github.com/sagemath/sagetrac-mirror/commit/f95dcff22000f525b3a114d89dd10b2e134589fa)**



---

archive/issue_comments_423672.json:
```json
{
    "body": "Author: **Erik Bray**",
    "created_at": "2019-02-28T10:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423672",
    "user": "https://github.com/embray"
}
```

Author: **Erik Bray**



---

archive/issue_comments_423673.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nDon't you need https://github.com/sagemath/cysignals/commit/8913e0b66a9acea11a5971868d748cde368ae29b also?\n\nIt's not a big deal to make a new cysignals release, just not right now.",
    "created_at": "2019-02-28T11:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423673",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Don't you need https://github.com/sagemath/cysignals/commit/8913e0b66a9acea11a5971868d748cde368ae29b also?

It's not a big deal to make a new cysignals release, just not right now.



---

archive/issue_comments_423674.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@jdemeyer](#comment:2):\n> Don't you need https://github.com/sagemath/cysignals/commit/8913e0b66a9acea11a5971868d748cde368ae29b also?\n\nI thought so at first too, but the change that that was fixing was after 1.8.1 so it's not relevant right now (I will need it for any future cysignals update in Sage)\n\n> It's not a big deal to make a new cysignals release, just not right now.\n\nI know it's not a big deal.  But as I explained (and I think you're agreeing) it's easier to just include the patch in the Sage SPKG for now.",
    "created_at": "2019-02-28T11:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423674",
    "user": "https://github.com/embray"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@jdemeyer](#comment:2):
> Don't you need https://github.com/sagemath/cysignals/commit/8913e0b66a9acea11a5971868d748cde368ae29b also?

I thought so at first too, but the change that that was fixing was after 1.8.1 so it's not relevant right now (I will need it for any future cysignals update in Sage)

> It's not a big deal to make a new cysignals release, just not right now.

I know it's not a big deal.  But as I explained (and I think you're agreeing) it's easier to just include the patch in the Sage SPKG for now.



---

archive/issue_events_376164.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-10T21:37:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376164"
}
```



---

archive/issue_events_376165.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-10T21:37:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376165"
}
```



---

archive/issue_events_376166.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-10T21:37:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376166"
}
```



---

archive/issue_events_376167.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-10T21:37:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376167"
}
```



---

archive/issue_events_376168.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-10T21:37:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376168"
}
```



---

archive/issue_comments_423675.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nCan this be closed in favour of #27070?",
    "created_at": "2019-03-10T21:37:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423675",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

Can this be closed in favour of #27070?



---

archive/issue_events_376169.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-10T21:37:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376169"
}
```



---

archive/issue_comments_423676.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nSure, as long as Cysignals 1.10 includes the fix (and doesn't break anything else).  I will review the changelog to make sure there isn't anything else suspect.",
    "created_at": "2019-03-11T12:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27384#issuecomment-423676",
    "user": "https://github.com/embray"
}
```

<div id="comment:5" align="right">comment:5</div>

Sure, as long as Cysignals 1.10 includes the fix (and doesn't break anything else).  I will review the changelog to make sure there isn't anything else suspect.



---

archive/issue_events_376170.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-11T12:12:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376170"
}
```



---

archive/issue_events_376171.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-11T12:12:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27384",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "a6a6a6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27384#event-376171"
}
```
