# Issue 27503: add a method "tan" for power series

archive/issues_027266.json:
```json
{
    "body": "using the existing sin and cos\n\nCC:  @tscrim\n\nBranch/Commit: c8a7303013e7c78592fbef10d9e2870fe49036c9\n\nReviewer: Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27503\n\n",
    "closed_at": "2019-03-25T19:43:03Z",
    "created_at": "2019-03-16T17:06:26Z",
    "labels": [
        "component: algebra",
        "trivial"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "add a method \"tan\" for power series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27503",
    "user": "https://github.com/fchapoton"
}
```
using the existing sin and cos

CC:  @tscrim

Branch/Commit: c8a7303013e7c78592fbef10d9e2870fe49036c9

Reviewer: Travis Scrimshaw

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27503





---

archive/issue_comments_383906.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-16T17:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383906",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_383907.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2019-03-16T17:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383907",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_events_068308.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-16T17:07:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27503#event-68308"
}
```



---

archive/issue_comments_383908.json:
```json
{
    "body": "<a id='comment:2'></a>green bot, please review",
    "created_at": "2019-03-17T08:09:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383908",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>green bot, please review



---

archive/issue_comments_383909.json:
```json
{
    "body": "<a id='comment:3'></a>A few comments/questions:\n\n- Are we sure that the result of the division has sufficient/correct precision? In other words, do we have to increase the precision of `sin` and/or `cos` to ensure that the `prec-1` term is computed correctly?\n- It would be better to make this change:\n  {{{#!diff\n-        val = self.valuation()\n-        assert(val >= 1)\n+        assert(self.valuation() >= 1)\n  }}}\n  That way the valuation is not computed if the assert statement is not run (as it is not needed other than a sanity check).\n- Could we change the error message to fit the formatting want for Sage (i.e., following Python with starting with a lower case and no full stop/period)? I know it is inconsistent, but I think it is better when adding code not to exacerbate the problem. (If you think uniformity is better, then feel free to ignore.)\n- You do not need `R = self.parent()`.",
    "created_at": "2019-03-18T10:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383909",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>A few comments/questions:

- Are we sure that the result of the division has sufficient/correct precision? In other words, do we have to increase the precision of `sin` and/or `cos` to ensure that the `prec-1` term is computed correctly?
- It would be better to make this change:
  {{{#!diff
-        val = self.valuation()
-        assert(val >= 1)
+        assert(self.valuation() >= 1)
  }}}
  That way the valuation is not computed if the assert statement is not run (as it is not needed other than a sanity check).
- Could we change the error message to fit the formatting want for Sage (i.e., following Python with starting with a lower case and no full stop/period)? I know it is inconsistent, but I think it is better when adding code not to exacerbate the problem. (If you think uniformity is better, then feel free to ignore.)
- You do not need `R = self.parent()`.



---

archive/issue_comments_383910.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-18T16:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383911.json:
```json
{
    "body": "<a id='comment:5'></a>Fixes made, thx.\n\nConcerning precision, I do not understand your concern. There is no reason to use more precision. Products and inverses of formal power series are well defined when truncated to a given precision.",
    "created_at": "2019-03-18T16:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383911",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>Fixes made, thx.

Concerning precision, I do not understand your concern. There is no reason to use more precision. Products and inverses of formal power series are well defined when truncated to a given precision.



---

archive/issue_comments_383912.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 chapoton]:\n> Concerning precision, I do not understand your concern. There is no reason to use more precision. Products and inverses of formal power series are well defined when truncated to a given precision.\n\n\nI agree that it is well-defined. What I am worried about is that the division could introduce some slight difference from the correct value (when done with higher precision). This would be similar to the effects when doing division in `RR`. Although I have played around with some FPS examples, and I cannot get this to occur. So I think my fears are unfounded.\n\nThanks. LGTM.",
    "created_at": "2019-03-18T23:12:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383912",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>Replying to [comment:5 chapoton]:
> Concerning precision, I do not understand your concern. There is no reason to use more precision. Products and inverses of formal power series are well defined when truncated to a given precision.


I agree that it is well-defined. What I am worried about is that the division could introduce some slight difference from the correct value (when done with higher precision). This would be similar to the effects when doing division in `RR`. Although I have played around with some FPS examples, and I cannot get this to occur. So I think my fears are unfounded.

Thanks. LGTM.



---

archive/issue_comments_383913.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-18T23:12:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383913",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_068309.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-25T19:43:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27503#event-68309"
}
```



---

archive/issue_comments_383914.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-25T19:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27503#issuecomment-383914",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
