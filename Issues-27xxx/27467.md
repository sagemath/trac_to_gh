# Issue 27467: weak order of permutations broken

archive/issues_027230.json:
```json
{
    "assignees": [],
    "body": "From https://groups.google.com/forum/#!topic/sage-support/6kuvliWzi84:\n\n```\nsage: for w in Permutations(3):\n....:     w, w.weak_covers()\n....:\n([1, 2, 3], [])\n([1, 3, 2], [[1, 2, 3]])\n([2, 1, 3], [[1, 2, 3]])\n([2, 3, 1], [[3, 2, 1]])\n([3, 1, 2], [[3, 2, 1]])\n([3, 2, 1], [[3, 1, 2], [2, 3, 1]])\n\nThe fourth and fifth lines of the output are incorrect.\nThe correct values should be\n\n([2, 3, 1], [[2, 1, 3]])\n([3, 1, 2], [[1, 3, 2]])\n```\n\nThis manifests also in creating the weak order poset:\n\n```\nsage: Permutations(3).weak_poset()\n...\nValueError: Hasse diagram contains cycles\n```\n\nThis is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.\n\nCC:  sage-combinat @nthiery @fchapoton @darijgr jeremy.l.martin\n\nKeywords: **Coxeter group**\n\nBranch/Commit: **[fa0450e](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Darij Grinberg**\n\nAuthor: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27467_\n\n",
    "closed_at": "2019-06-12T21:41:43Z",
    "created_at": "2019-03-11T23:43:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "weak order of permutations broken",
    "type": "issue",
    "updated_at": "2019-06-12T21:41:43Z",
    "url": "https://github.com/sagemath/sage/issues/27467",
    "user": "https://github.com/tscrim"
}
```
From https://groups.google.com/forum/#!topic/sage-support/6kuvliWzi84:

```
sage: for w in Permutations(3):
....:     w, w.weak_covers()
....:
([1, 2, 3], [])
([1, 3, 2], [[1, 2, 3]])
([2, 1, 3], [[1, 2, 3]])
([2, 3, 1], [[3, 2, 1]])
([3, 1, 2], [[3, 2, 1]])
([3, 2, 1], [[3, 1, 2], [2, 3, 1]])

The fourth and fifth lines of the output are incorrect.
The correct values should be

([2, 3, 1], [[2, 1, 3]])
([3, 1, 2], [[1, 3, 2]])
```

This manifests also in creating the weak order poset:

```
sage: Permutations(3).weak_poset()
...
ValueError: Hasse diagram contains cycles
```

This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.

CC:  sage-combinat @nthiery @fchapoton @darijgr jeremy.l.martin

Keywords: **Coxeter group**

Branch/Commit: **[fa0450e](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**

Reviewer: **Frédéric Chapoton, Darij Grinberg**

Author: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/27467_





---

archive/issue_events_359019.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359019"
}
```



---

archive/issue_events_359020.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359020"
}
```



---

archive/issue_events_359021.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359021"
}
```



---

archive/issue_events_359022.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359022"
}
```



---

archive/issue_comments_427944.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,8 @@\n ([3, 1, 2], [[3, 2, 1]])\n ([3, 2, 1], [[3, 1, 2], [2, 3, 1]])\n \n-The fourth and fifth lines of the output are incorrect.  The correct values should be\n+The fourth and fifth lines of the output are incorrect.\n+The correct values should be\n \n ([2, 3, 1], [[2, 1, 3]])\n ([3, 1, 2], [[1, 3, 2]])\n@@ -25,4 +26,4 @@\n ValueError: Hasse diagram contains cycles\n ```\n \n-Most likely a left-vs-right issue. Possibly related to #23299.\n+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.\n``````\n",
    "created_at": "2019-03-11T23:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427944",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,8 @@
 ([3, 1, 2], [[3, 2, 1]])
 ([3, 2, 1], [[3, 1, 2], [2, 3, 1]])
 
-The fourth and fifth lines of the output are incorrect.  The correct values should be
+The fourth and fifth lines of the output are incorrect.
+The correct values should be
 
 ([2, 3, 1], [[2, 1, 3]])
 ([3, 1, 2], [[1, 3, 2]])
@@ -25,4 +26,4 @@
 ValueError: Hasse diagram contains cycles
 ```
 
-Most likely a left-vs-right issue. Possibly related to #23299.
+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.
``````




---

archive/issue_comments_427945.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThe problem is the multiplication for a permutation seems to have the oppose effect (by default):\n\n```\nsage: W = Permutations(3)\nsage: w = W([2,3,1])\nsage: w.reduced_word()\n[1, 2]\nsage: w.descents(side='right')\n[2]\nsage: w.apply_simple_reflection_right(2)\n[3, 2, 1]\n```\nSo we need to override `apply_simple_reflection_*` for `Permutation`.",
    "created_at": "2019-03-11T23:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427945",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'>Comment 2:</a>
The problem is the multiplication for a permutation seems to have the oppose effect (by default):

```
sage: W = Permutations(3)
sage: w = W([2,3,1])
sage: w.reduced_word()
[1, 2]
sage: w.descents(side='right')
[2]
sage: w.apply_simple_reflection_right(2)
[3, 2, 1]
```
So we need to override `apply_simple_reflection_*` for `Permutation`.



---

archive/issue_comments_427946.json:
```json
{
    "body": "Branch: **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)**",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427946",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)**



---

archive/issue_events_359023.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-12T00:21:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359023"
}
```



---

archive/issue_comments_427947.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427947",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_comments_427948.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nSo the only way forward that I could see to make this work is to gut out the multiplication option for `has_*_descent`. With this, I do not think anything for Coxeter combiantorics now uses the multiplication convention.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee\">2273223</a></td><td><code>Making apply_simple_reflection_* and has_*_descent not use the permutation multiplication convention.</code></td></tr></table>\n",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427948",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'>Comment 3:</a>
So the only way forward that I could see to make this work is to gut out the multiplication option for `has_*_descent`. With this, I do not think anything for Coxeter combiantorics now uses the multiplication convention.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee">2273223</a></td><td><code>Making apply_simple_reflection_* and has_*_descent not use the permutation multiplication convention.</code></td></tr></table>




---

archive/issue_comments_427949.json:
```json
{
    "body": "Commit: **[2273223](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)**",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427949",
    "user": "https://github.com/tscrim"
}
```

Commit: **[2273223](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)**



---

archive/issue_comments_427950.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,4 +26,4 @@\n ValueError: Hasse diagram contains cycles\n ```\n \n-This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.\n+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.\n``````\n",
    "created_at": "2019-03-12T00:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427950",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,4 +26,4 @@
 ValueError: Hasse diagram contains cycles
 ```
 
-This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.
+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.
``````




---

archive/issue_comments_427951.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nMoving all blocker/critical issues from 8.7 to 8.8.",
    "created_at": "2019-03-25T10:41:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427951",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'>Comment 5:</a>
Moving all blocker/critical issues from 8.7 to 8.8.



---

archive/issue_events_359024.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:41:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359024"
}
```



---

archive/issue_events_359025.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:41:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359025"
}
```



---

archive/issue_comments_427952.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nCan someone review this?",
    "created_at": "2019-05-24T22:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427952",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'>Comment 6:</a>
Can someone review this?



---

archive/issue_comments_427953.json:
```json
{
    "body": "Changed commit from **[2273223](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)** to **[c54aef5](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)**",
    "created_at": "2019-05-24T23:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427953",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2273223](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)** to **[c54aef5](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)**



---

archive/issue_comments_427954.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c822b3f55993e2f8e769eb6ca72c872ee335a117\">c822b3f</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1\">c54aef5</a></td><td><code>Updating docstring based on comments by Darij.</code></td></tr></table>\n",
    "created_at": "2019-05-24T23:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427954",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c822b3f55993e2f8e769eb6ca72c872ee335a117">c822b3f</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1">c54aef5</a></td><td><code>Updating docstring based on comments by Darij.</code></td></tr></table>




---

archive/issue_comments_427955.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995\">295c517</a></td><td><code>Fixing Yokonuma-Hecke algebras.</code></td></tr></table>\n",
    "created_at": "2019-05-24T23:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427955",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'>Comment 8:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995">295c517</a></td><td><code>Fixing Yokonuma-Hecke algebras.</code></td></tr></table>




---

archive/issue_comments_427956.json:
```json
{
    "body": "Changed commit from **[c54aef5](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)** to **[295c517](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)**",
    "created_at": "2019-05-24T23:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427956",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c54aef5](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)** to **[295c517](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)**



---

archive/issue_comments_427957.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nGreen patchbot.",
    "created_at": "2019-05-25T23:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427957",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'>Comment 9:</a>
Green patchbot.



---

archive/issue_comments_427958.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\n* deprecation should appear in doctests, no ?\n\n* \"switching the entries i and i+1\" (remove \"equal\" ?) in the doc of apply_simple_reflection_right\n\n* I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?",
    "created_at": "2019-05-26T05:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427958",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'>Comment 10:</a>
* deprecation should appear in doctests, no ?

* "switching the entries i and i+1" (remove "equal" ?) in the doc of apply_simple_reflection_right

* I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?



---

archive/issue_comments_427959.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f\">0af471b</a></td><td><code>Adding deprecation doctest and fixing docstring.</code></td></tr></table>\n",
    "created_at": "2019-06-05T00:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427959",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f">0af471b</a></td><td><code>Adding deprecation doctest and fixing docstring.</code></td></tr></table>




---

archive/issue_comments_427960.json:
```json
{
    "body": "Changed commit from **[295c517](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)** to **[0af471b](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)**",
    "created_at": "2019-06-05T00:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427960",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[295c517](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)** to **[0af471b](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)**



---

archive/issue_comments_427961.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@fchapoton](#comment%3A10):\n> * deprecation should appear in doctests, no ?\n\nAdded.\n\n> * \"switching the entries i and i+1\" (remove \"equal\" ?) in the doc of apply_simple_reflection_right\n\nFixed.\n\n> * I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?\n\nIt is at least no worse than what it is currently, but I think this makes it more consistent overall. Plus it fixes a definite bug.",
    "created_at": "2019-06-05T00:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427961",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@fchapoton](#comment%3A10):
> * deprecation should appear in doctests, no ?

Added.

> * "switching the entries i and i+1" (remove "equal" ?) in the doc of apply_simple_reflection_right

Fixed.

> * I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?

It is at least no worse than what it is currently, but I think this makes it more consistent overall. Plus it fixes a definite bug.



---

archive/issue_comments_427962.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nok, then.\n\nOne should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.",
    "created_at": "2019-06-05T08:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427962",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'>Comment 13:</a>
ok, then.

One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.



---

archive/issue_events_359026.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359026"
}
```



---

archive/issue_events_359027.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359027"
}
```



---

archive/issue_comments_427963.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-06-05T08:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427963",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_427964.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@fchapoton](#comment%3A13):\n> ok, then.\n\nThank you.\n\n> One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.\n\nAlso referencing `CoxeterGroup` or `WeylGroup` as well. Another ticket.\n\nI am adding Darij as a reviewer since he gave me some comments on the ticket.",
    "created_at": "2019-06-05T09:04:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427964",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@fchapoton](#comment%3A13):
> ok, then.

Thank you.

> One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.

Also referencing `CoxeterGroup` or `WeylGroup` as well. Another ticket.

I am adding Darij as a reviewer since he gave me some comments on the ticket.



---

archive/issue_comments_427965.json:
```json
{
    "body": "Changed reviewer from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, Darij Grinberg**",
    "created_at": "2019-06-05T09:04:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427965",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Frédéric Chapoton** to **Frédéric Chapoton, Darij Grinberg**



---

archive/issue_comments_427966.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nPossibly due to #27899, I'm getting \n\n```\nsage -t --warn-long 57.2 src/sage/combinat/dyck_word.py\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 1997, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\nFailed example:\n    p = DyckWord([1,1,0,1,0,0,1,1,0,1,0,1,0,0]).to_312_avoiding_permutation(); p\nExpected:\n    [2, 3, 1, 5, 6, 7, 4]\nGot:\n    [3, 1, 2, 7, 4, 5, 6]\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 2007, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\nFailed example:\n    all(pi.avoids([3,1,2]) for pi in PD)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 2197, in sage.combinat.dyck_word.DyckWord_complete.to_permutation\nFailed example:\n    D.to_permutation(map=\"Bandlow-Killpatrick\")\nExpected:\n    [3, 4, 2, 1]\nGot:\n    [4, 3, 1, 2]\n**********************************************************************\n2 items had failures:\n   2 of   9 in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\n   1 of   7 in sage.combinat.dyck_word.DyckWord_complete.to_permutation\n    [581 tests, 3 failures, 1.27 s]\n----------------------------------------------------------------------\nsage -t --warn-long 57.2 src/sage/combinat/dyck_word.py  # 3 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-06-05T22:25:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427966",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'>Comment 15:</a>
Possibly due to #27899, I'm getting 

```
sage -t --warn-long 57.2 src/sage/combinat/dyck_word.py
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 1997, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
Failed example:
    p = DyckWord([1,1,0,1,0,0,1,1,0,1,0,1,0,0]).to_312_avoiding_permutation(); p
Expected:
    [2, 3, 1, 5, 6, 7, 4]
Got:
    [3, 1, 2, 7, 4, 5, 6]
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 2007, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
Failed example:
    all(pi.avoids([3,1,2]) for pi in PD)
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 2197, in sage.combinat.dyck_word.DyckWord_complete.to_permutation
Failed example:
    D.to_permutation(map="Bandlow-Killpatrick")
Expected:
    [3, 4, 2, 1]
Got:
    [4, 3, 1, 2]
**********************************************************************
2 items had failures:
   2 of   9 in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
   1 of   7 in sage.combinat.dyck_word.DyckWord_complete.to_permutation
    [581 tests, 3 failures, 1.27 s]
----------------------------------------------------------------------
sage -t --warn-long 57.2 src/sage/combinat/dyck_word.py  # 3 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_359028.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-05T22:25:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359028"
}
```



---

archive/issue_events_359029.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-05T22:25:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359029"
}
```



---

archive/issue_comments_427967.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nYes, probably correlated to this replacement in #27899 :\n\n```diff\n         n = self.semilength()\n         area = self.to_area_sequence()\n-        from sage.groups.perm_gps.permgroup_named import SymmetricGroup\n-        pi = SymmetricGroup(n).one()\n+        pi = Permutations(n).one()\n         for j in range(n):\n             for i in range(area[j]):\n-                pi = pi.apply_simple_reflection(j-i)\n-        return Permutation(~pi)\n+                pi = pi.apply_simple_reflection(j - i)\n+        return ~pi\n```",
    "created_at": "2019-06-06T05:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427967",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'>Comment 16:</a>
Yes, probably correlated to this replacement in #27899 :

```diff
         n = self.semilength()
         area = self.to_area_sequence()
-        from sage.groups.perm_gps.permgroup_named import SymmetricGroup
-        pi = SymmetricGroup(n).one()
+        pi = Permutations(n).one()
         for j in range(n):
             for i in range(area[j]):
-                pi = pi.apply_simple_reflection(j-i)
-        return Permutation(~pi)
+                pi = pi.apply_simple_reflection(j - i)
+        return ~pi
```



---

archive/issue_comments_427968.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nI concur, and it should just be a matter of swapping the left/right convention (which I guess should just mean returning `pi` instead of `~pi`). I can do this tomorrow.",
    "created_at": "2019-06-06T07:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427968",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'>Comment 17:</a>
I concur, and it should just be a matter of swapping the left/right convention (which I guess should just mean returning `pi` instead of `~pi`). I can do this tomorrow.



---

archive/issue_comments_427969.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9\">25f8655</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr></table>\n",
    "created_at": "2019-06-10T23:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427969",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'>Comment 18:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9">25f8655</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr></table>




---

archive/issue_comments_427970.json:
```json
{
    "body": "Changed commit from **[0af471b](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)** to **[25f8655](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)**",
    "created_at": "2019-06-10T23:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427970",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0af471b](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)** to **[25f8655](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)**



---

archive/issue_comments_427971.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7\">fa0450e</a></td><td><code>Fixing left-right convention difference.</code></td></tr></table>\n",
    "created_at": "2019-06-10T23:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427971",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7">fa0450e</a></td><td><code>Fixing left-right convention difference.</code></td></tr></table>




---

archive/issue_comments_427972.json:
```json
{
    "body": "Changed commit from **[25f8655](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)** to **[fa0450e](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**",
    "created_at": "2019-06-10T23:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427972",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[25f8655](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)** to **[fa0450e](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**



---

archive/issue_comments_427973.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nSorry, I got sidetracked from this and forgot to do this last week. This is now fixed (although unfortunately we might have missed the next release cutoff...). Volker, it would be really nice if this could slip in to 8.8 since this is a relatively big bug in the combinatorics code.",
    "created_at": "2019-06-10T23:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427973",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'>Comment 20:</a>
Sorry, I got sidetracked from this and forgot to do this last week. This is now fixed (although unfortunately we might have missed the next release cutoff...). Volker, it would be really nice if this could slip in to 8.8 since this is a relatively big bug in the combinatorics code.



---

archive/issue_events_359030.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-10T23:48:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359030"
}
```



---

archive/issue_events_359031.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-10T23:48:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359031"
}
```



---

archive/issue_events_359032.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-11T07:23:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359032"
}
```



---

archive/issue_events_359033.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-11T07:23:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359033"
}
```



---

archive/issue_comments_427974.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nset to positive again",
    "created_at": "2019-06-11T07:23:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427974",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'>Comment 21:</a>
set to positive again



---

archive/issue_events_359034.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-11T08:59:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359034"
}
```



---

archive/issue_events_359035.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-11T08:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359035"
}
```



---

archive/issue_comments_427975.json:
```json
{
    "body": "Changed branch from **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)** to **[fa0450e](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**",
    "created_at": "2019-06-12T21:41:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-427975",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)** to **[fa0450e](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**



---

archive/issue_events_359036.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-12T21:41:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359036"
}
```



---

archive/issue_events_359037.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8555a05c7d9d2825c5f65f2bb72a32c522211fd2",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-06-12T21:41:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-359037"
}
```
