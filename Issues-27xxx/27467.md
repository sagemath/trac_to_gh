# Issue 27467: weak order of permutations broken

archive/issues_027230.json:
```json
{
    "assignees": [],
    "body": "From https://groups.google.com/forum/#!topic/sage-support/6kuvliWzi84:\n\n```\nsage: for w in Permutations(3):\n....:     w, w.weak_covers()\n....:\n([1, 2, 3], [])\n([1, 3, 2], [[1, 2, 3]])\n([2, 1, 3], [[1, 2, 3]])\n([2, 3, 1], [[3, 2, 1]])\n([3, 1, 2], [[3, 2, 1]])\n([3, 2, 1], [[3, 1, 2], [2, 3, 1]])\n\nThe fourth and fifth lines of the output are incorrect.\nThe correct values should be\n\n([2, 3, 1], [[2, 1, 3]])\n([3, 1, 2], [[1, 3, 2]])\n```\n\nThis manifests also in creating the weak order poset:\n\n```\nsage: Permutations(3).weak_poset()\n...\nValueError: Hasse diagram contains cycles\n```\n\nThis is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.\n\nCC:  @sagetrac-sage-combinat @nthiery @fchapoton @darijgr @sagetrac-jeremy-l-martin\n\nKeywords: **Coxeter group**\n\nBranch/Commit: **[`fa0450e`](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Darij Grinberg**\n\nAuthor: **Travis Scrimshaw**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27467_\n\n",
    "closed_at": "2019-06-12T21:41:43Z",
    "created_at": "2019-03-11T23:43:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "weak order of permutations broken",
    "type": "issue",
    "updated_at": "2019-06-12T21:41:43Z",
    "url": "https://github.com/sagemath/sage/issues/27467",
    "user": "https://github.com/tscrim"
}
```
From https://groups.google.com/forum/#!topic/sage-support/6kuvliWzi84:

```
sage: for w in Permutations(3):
....:     w, w.weak_covers()
....:
([1, 2, 3], [])
([1, 3, 2], [[1, 2, 3]])
([2, 1, 3], [[1, 2, 3]])
([2, 3, 1], [[3, 2, 1]])
([3, 1, 2], [[3, 2, 1]])
([3, 2, 1], [[3, 1, 2], [2, 3, 1]])

The fourth and fifth lines of the output are incorrect.
The correct values should be

([2, 3, 1], [[2, 1, 3]])
([3, 1, 2], [[1, 3, 2]])
```

This manifests also in creating the weak order poset:

```
sage: Permutations(3).weak_poset()
...
ValueError: Hasse diagram contains cycles
```

This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.

CC:  @sagetrac-sage-combinat @nthiery @fchapoton @darijgr @sagetrac-jeremy-l-martin

Keywords: **Coxeter group**

Branch/Commit: **[`fa0450e`](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**

Reviewer: **Frédéric Chapoton, Darij Grinberg**

Author: **Travis Scrimshaw**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/27467_





---

archive/issue_events_374249.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374249"
}
```



---

archive/issue_events_374250.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374250"
}
```



---

archive/issue_events_374251.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374251"
}
```



---

archive/issue_events_374252.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-11T23:43:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374252"
}
```



---

archive/issue_comments_424995.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,8 @@\n ([3, 1, 2], [[3, 2, 1]])\n ([3, 2, 1], [[3, 1, 2], [2, 3, 1]])\n \n-The fourth and fifth lines of the output are incorrect.  The correct values should be\n+The fourth and fifth lines of the output are incorrect.\n+The correct values should be\n \n ([2, 3, 1], [[2, 1, 3]])\n ([3, 1, 2], [[1, 3, 2]])\n@@ -25,4 +26,4 @@\n ValueError: Hasse diagram contains cycles\n ```\n \n-Most likely a left-vs-right issue. Possibly related to #23299.\n+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.\n``````\n",
    "created_at": "2019-03-11T23:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-424995",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,8 @@
 ([3, 1, 2], [[3, 2, 1]])
 ([3, 2, 1], [[3, 1, 2], [2, 3, 1]])
 
-The fourth and fifth lines of the output are incorrect.  The correct values should be
+The fourth and fifth lines of the output are incorrect.
+The correct values should be
 
 ([2, 3, 1], [[2, 1, 3]])
 ([3, 1, 2], [[1, 3, 2]])
@@ -25,4 +26,4 @@
 ValueError: Hasse diagram contains cycles
 ```
 
-Most likely a left-vs-right issue. Possibly related to #23299.
+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.
``````




---

archive/issue_comments_424996.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe problem is the multiplication for a permutation seems to have the oppose effect (by default):\n\n```\nsage: W = Permutations(3)\nsage: w = W([2,3,1])\nsage: w.reduced_word()\n[1, 2]\nsage: w.descents(side='right')\n[2]\nsage: w.apply_simple_reflection_right(2)\n[3, 2, 1]\n```\nSo we need to override `apply_simple_reflection_*` for `Permutation`.",
    "created_at": "2019-03-11T23:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-424996",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:2" align="right">comment:2</div>

The problem is the multiplication for a permutation seems to have the oppose effect (by default):

```
sage: W = Permutations(3)
sage: w = W([2,3,1])
sage: w.reduced_word()
[1, 2]
sage: w.descents(side='right')
[2]
sage: w.apply_simple_reflection_right(2)
[3, 2, 1]
```
So we need to override `apply_simple_reflection_*` for `Permutation`.



---

archive/issue_comments_424997.json:
```json
{
    "body": "Branch: **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)**",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-424997",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)**



---

archive/issue_events_374253.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-12T00:21:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374253"
}
```



---

archive/issue_comments_424998.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-424998",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_comments_424999.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSo the only way forward that I could see to make this work is to gut out the multiplication option for `has_*_descent`. With this, I do not think anything for Coxeter combiantorics now uses the multiplication convention.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee\"><code>2273223</code></a></td><td><code>Making apply_simple_reflection_* and has_*_descent not use the permutation multiplication convention.</code></td></tr></table>\n",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-424999",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

So the only way forward that I could see to make this work is to gut out the multiplication option for `has_*_descent`. With this, I do not think anything for Coxeter combiantorics now uses the multiplication convention.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee"><code>2273223</code></a></td><td><code>Making apply_simple_reflection_* and has_*_descent not use the permutation multiplication convention.</code></td></tr></table>




---

archive/issue_comments_425000.json:
```json
{
    "body": "Commit: **[`2273223`](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)**",
    "created_at": "2019-03-12T00:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425000",
    "user": "https://github.com/tscrim"
}
```

Commit: **[`2273223`](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)**



---

archive/issue_comments_425001.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,4 +26,4 @@\n ValueError: Hasse diagram contains cycles\n ```\n \n-This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.\n+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.\n``````\n",
    "created_at": "2019-03-12T00:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425001",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,4 +26,4 @@
 ValueError: Hasse diagram contains cycles
 ```
 
-This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.
+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.
``````




---

archive/issue_comments_425002.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nMoving all blocker/critical issues from 8.7 to 8.8.",
    "created_at": "2019-03-25T10:41:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425002",
    "user": "https://github.com/embray"
}
```

<div id="comment:5" align="right">comment:5</div>

Moving all blocker/critical issues from 8.7 to 8.8.



---

archive/issue_events_374254.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:41:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374254"
}
```



---

archive/issue_events_374255.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:41:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374255"
}
```



---

archive/issue_comments_425003.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nCan someone review this?",
    "created_at": "2019-05-24T22:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425003",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

Can someone review this?



---

archive/issue_comments_425004.json:
```json
{
    "body": "Changed commit from **[`2273223`](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)** to **[`c54aef5`](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)**",
    "created_at": "2019-05-24T23:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425004",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2273223`](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)** to **[`c54aef5`](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)**



---

archive/issue_comments_425005.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c822b3f55993e2f8e769eb6ca72c872ee335a117\"><code>c822b3f</code></a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1\"><code>c54aef5</code></a></td><td><code>Updating docstring based on comments by Darij.</code></td></tr></table>\n",
    "created_at": "2019-05-24T23:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425005",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c822b3f55993e2f8e769eb6ca72c872ee335a117"><code>c822b3f</code></a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1"><code>c54aef5</code></a></td><td><code>Updating docstring based on comments by Darij.</code></td></tr></table>




---

archive/issue_comments_425006.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995\"><code>295c517</code></a></td><td><code>Fixing Yokonuma-Hecke algebras.</code></td></tr></table>\n",
    "created_at": "2019-05-24T23:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425006",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995"><code>295c517</code></a></td><td><code>Fixing Yokonuma-Hecke algebras.</code></td></tr></table>




---

archive/issue_comments_425007.json:
```json
{
    "body": "Changed commit from **[`c54aef5`](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)** to **[`295c517`](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)**",
    "created_at": "2019-05-24T23:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425007",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c54aef5`](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)** to **[`295c517`](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)**



---

archive/issue_comments_425008.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nGreen patchbot.",
    "created_at": "2019-05-25T23:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425008",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

Green patchbot.



---

archive/issue_comments_425009.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n* deprecation should appear in doctests, no ?\n\n* \"switching the entries i and i+1\" (remove \"equal\" ?) in the doc of apply_simple_reflection_right\n\n* I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?",
    "created_at": "2019-05-26T05:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425009",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

* deprecation should appear in doctests, no ?

* "switching the entries i and i+1" (remove "equal" ?) in the doc of apply_simple_reflection_right

* I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?



---

archive/issue_comments_425010.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f\"><code>0af471b</code></a></td><td><code>Adding deprecation doctest and fixing docstring.</code></td></tr></table>\n",
    "created_at": "2019-06-05T00:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425010",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f"><code>0af471b</code></a></td><td><code>Adding deprecation doctest and fixing docstring.</code></td></tr></table>




---

archive/issue_comments_425011.json:
```json
{
    "body": "Changed commit from **[`295c517`](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)** to **[`0af471b`](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)**",
    "created_at": "2019-06-05T00:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425011",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`295c517`](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)** to **[`0af471b`](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)**



---

archive/issue_comments_425012.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@fchapoton](#comment%3A10):\n> * deprecation should appear in doctests, no ?\n\nAdded.\n\n> * \"switching the entries i and i+1\" (remove \"equal\" ?) in the doc of apply_simple_reflection_right\n\nFixed.\n\n> * I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?\n\nIt is at least no worse than what it is currently, but I think this makes it more consistent overall. Plus it fixes a definite bug.",
    "created_at": "2019-06-05T00:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425012",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@fchapoton](#comment%3A10):
> * deprecation should appear in doctests, no ?

Added.

> * "switching the entries i and i+1" (remove "equal" ?) in the doc of apply_simple_reflection_right

Fixed.

> * I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?

It is at least no worse than what it is currently, but I think this makes it more consistent overall. Plus it fixes a definite bug.



---

archive/issue_comments_425013.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nok, then.\n\nOne should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.",
    "created_at": "2019-06-05T08:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425013",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

ok, then.

One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.



---

archive/issue_events_374256.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374256"
}
```



---

archive/issue_events_374257.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374257"
}
```



---

archive/issue_comments_425014.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-06-05T08:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425014",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_425015.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@fchapoton](#comment%3A13):\n> ok, then.\n\nThank you.\n\n> One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.\n\nAlso referencing `CoxeterGroup` or `WeylGroup` as well. Another ticket.\n\nI am adding Darij as a reviewer since he gave me some comments on the ticket.",
    "created_at": "2019-06-05T09:04:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425015",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@fchapoton](#comment%3A13):
> ok, then.

Thank you.

> One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.

Also referencing `CoxeterGroup` or `WeylGroup` as well. Another ticket.

I am adding Darij as a reviewer since he gave me some comments on the ticket.



---

archive/issue_comments_425016.json:
```json
{
    "body": "Changed reviewer from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, Darij Grinberg**",
    "created_at": "2019-06-05T09:04:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425016",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Frédéric Chapoton** to **Frédéric Chapoton, Darij Grinberg**



---

archive/issue_comments_425017.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nPossibly due to #27899, I'm getting \n\n```\nsage -t --warn-long 57.2 src/sage/combinat/dyck_word.py\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 1997, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\nFailed example:\n    p = DyckWord([1,1,0,1,0,0,1,1,0,1,0,1,0,0]).to_312_avoiding_permutation(); p\nExpected:\n    [2, 3, 1, 5, 6, 7, 4]\nGot:\n    [3, 1, 2, 7, 4, 5, 6]\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 2007, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\nFailed example:\n    all(pi.avoids([3,1,2]) for pi in PD)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 2197, in sage.combinat.dyck_word.DyckWord_complete.to_permutation\nFailed example:\n    D.to_permutation(map=\"Bandlow-Killpatrick\")\nExpected:\n    [3, 4, 2, 1]\nGot:\n    [4, 3, 1, 2]\n**********************************************************************\n2 items had failures:\n   2 of   9 in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\n   1 of   7 in sage.combinat.dyck_word.DyckWord_complete.to_permutation\n    [581 tests, 3 failures, 1.27 s]\n----------------------------------------------------------------------\nsage -t --warn-long 57.2 src/sage/combinat/dyck_word.py  # 3 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-06-05T22:25:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425017",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

Possibly due to #27899, I'm getting 

```
sage -t --warn-long 57.2 src/sage/combinat/dyck_word.py
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 1997, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
Failed example:
    p = DyckWord([1,1,0,1,0,0,1,1,0,1,0,1,0,0]).to_312_avoiding_permutation(); p
Expected:
    [2, 3, 1, 5, 6, 7, 4]
Got:
    [3, 1, 2, 7, 4, 5, 6]
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 2007, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
Failed example:
    all(pi.avoids([3,1,2]) for pi in PD)
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 2197, in sage.combinat.dyck_word.DyckWord_complete.to_permutation
Failed example:
    D.to_permutation(map="Bandlow-Killpatrick")
Expected:
    [3, 4, 2, 1]
Got:
    [4, 3, 1, 2]
**********************************************************************
2 items had failures:
   2 of   9 in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
   1 of   7 in sage.combinat.dyck_word.DyckWord_complete.to_permutation
    [581 tests, 3 failures, 1.27 s]
----------------------------------------------------------------------
sage -t --warn-long 57.2 src/sage/combinat/dyck_word.py  # 3 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_374258.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-05T22:25:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374258"
}
```



---

archive/issue_events_374259.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-05T22:25:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374259"
}
```



---

archive/issue_comments_425018.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nYes, probably correlated to this replacement in #27899 :\n\n```diff\n         n = self.semilength()\n         area = self.to_area_sequence()\n-        from sage.groups.perm_gps.permgroup_named import SymmetricGroup\n-        pi = SymmetricGroup(n).one()\n+        pi = Permutations(n).one()\n         for j in range(n):\n             for i in range(area[j]):\n-                pi = pi.apply_simple_reflection(j-i)\n-        return Permutation(~pi)\n+                pi = pi.apply_simple_reflection(j - i)\n+        return ~pi\n```",
    "created_at": "2019-06-06T05:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425018",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

Yes, probably correlated to this replacement in #27899 :

```diff
         n = self.semilength()
         area = self.to_area_sequence()
-        from sage.groups.perm_gps.permgroup_named import SymmetricGroup
-        pi = SymmetricGroup(n).one()
+        pi = Permutations(n).one()
         for j in range(n):
             for i in range(area[j]):
-                pi = pi.apply_simple_reflection(j-i)
-        return Permutation(~pi)
+                pi = pi.apply_simple_reflection(j - i)
+        return ~pi
```



---

archive/issue_comments_425019.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI concur, and it should just be a matter of swapping the left/right convention (which I guess should just mean returning `pi` instead of `~pi`). I can do this tomorrow.",
    "created_at": "2019-06-06T07:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425019",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

I concur, and it should just be a matter of swapping the left/right convention (which I guess should just mean returning `pi` instead of `~pi`). I can do this tomorrow.



---

archive/issue_comments_425020.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9\"><code>25f8655</code></a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr></table>\n",
    "created_at": "2019-06-10T23:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425020",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9"><code>25f8655</code></a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr></table>




---

archive/issue_comments_425021.json:
```json
{
    "body": "Changed commit from **[`0af471b`](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)** to **[`25f8655`](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)**",
    "created_at": "2019-06-10T23:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425021",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0af471b`](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)** to **[`25f8655`](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)**



---

archive/issue_comments_425022.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7\"><code>fa0450e</code></a></td><td><code>Fixing left-right convention difference.</code></td></tr></table>\n",
    "created_at": "2019-06-10T23:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425022",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7"><code>fa0450e</code></a></td><td><code>Fixing left-right convention difference.</code></td></tr></table>




---

archive/issue_comments_425023.json:
```json
{
    "body": "Changed commit from **[`25f8655`](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)** to **[`fa0450e`](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**",
    "created_at": "2019-06-10T23:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425023",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`25f8655`](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)** to **[`fa0450e`](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**



---

archive/issue_comments_425024.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSorry, I got sidetracked from this and forgot to do this last week. This is now fixed (although unfortunately we might have missed the next release cutoff...). Volker, it would be really nice if this could slip in to 8.8 since this is a relatively big bug in the combinatorics code.",
    "created_at": "2019-06-10T23:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425024",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Sorry, I got sidetracked from this and forgot to do this last week. This is now fixed (although unfortunately we might have missed the next release cutoff...). Volker, it would be really nice if this could slip in to 8.8 since this is a relatively big bug in the combinatorics code.



---

archive/issue_events_374260.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-10T23:48:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374260"
}
```



---

archive/issue_events_374261.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-10T23:48:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374261"
}
```



---

archive/issue_events_374262.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-11T07:23:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374262"
}
```



---

archive/issue_events_374263.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-11T07:23:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374263"
}
```



---

archive/issue_comments_425025.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nset to positive again",
    "created_at": "2019-06-11T07:23:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425025",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

set to positive again



---

archive/issue_events_374264.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-11T08:59:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374264"
}
```



---

archive/issue_events_374265.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-11T08:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374265"
}
```



---

archive/issue_comments_425026.json:
```json
{
    "body": "Changed branch from **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)** to **[`fa0450e`](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**",
    "created_at": "2019-06-12T21:41:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27467#issuecomment-425026",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)** to **[`fa0450e`](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)**



---

archive/issue_events_374266.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-12T21:41:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374266"
}
```



---

archive/issue_events_374267.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8555a05c7d9d2825c5f65f2bb72a32c522211fd2",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-06-12T21:41:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27467",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27467#event-374267"
}
```
