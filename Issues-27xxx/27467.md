# Issue 27467: weak order of permutations broken

archive/issues_027230.json:
```json
{
    "body": "From https://groups.google.com/forum/#!topic/sage-support/6kuvliWzi84:\n\n```\nsage: for w in Permutations(3):\n....:     w, w.weak_covers()\n....:\n([1, 2, 3], [])\n([1, 3, 2], [[1, 2, 3]])\n([2, 1, 3], [[1, 2, 3]])\n([2, 3, 1], [[3, 2, 1]])\n([3, 1, 2], [[3, 2, 1]])\n([3, 2, 1], [[3, 1, 2], [2, 3, 1]])\n\nThe fourth and fifth lines of the output are incorrect.\nThe correct values should be\n\n([2, 3, 1], [[2, 1, 3]])\n([3, 1, 2], [[1, 3, 2]])\n```\n\nThis manifests also in creating the weak order poset:\n\n```\nsage: Permutations(3).weak_poset()\n...\nValueError: Hasse diagram contains cycles\n```\n\nThis is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.\n\n**CC:**  sage-combinat @nthiery @fchapoton @darijgr jeremy.l.martin\n\n**Keywords:** Coxeter group\n\n**Branch/Commit:** [fa0450ecb592385c795af1e916ea18fca65608b7](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Darij Grinberg\n\n**Author:** Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/27467\n\n",
    "closed_at": "2019-06-12T21:41:43Z",
    "created_at": "2019-03-11T23:43:03Z",
    "labels": [
        "component: combinatorics",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "weak order of permutations broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27467",
    "user": "https://github.com/tscrim"
}
```
From https://groups.google.com/forum/#!topic/sage-support/6kuvliWzi84:

```
sage: for w in Permutations(3):
....:     w, w.weak_covers()
....:
([1, 2, 3], [])
([1, 3, 2], [[1, 2, 3]])
([2, 1, 3], [[1, 2, 3]])
([2, 3, 1], [[3, 2, 1]])
([3, 1, 2], [[3, 2, 1]])
([3, 2, 1], [[3, 1, 2], [2, 3, 1]])

The fourth and fifth lines of the output are incorrect.
The correct values should be

([2, 3, 1], [[2, 1, 3]])
([3, 1, 2], [[1, 3, 2]])
```

This manifests also in creating the weak order poset:

```
sage: Permutations(3).weak_poset()
...
ValueError: Hasse diagram contains cycles
```

This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.

**CC:**  sage-combinat @nthiery @fchapoton @darijgr jeremy.l.martin

**Keywords:** Coxeter group

**Branch/Commit:** [fa0450ecb592385c795af1e916ea18fca65608b7](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)

**Reviewer:** Frédéric Chapoton, Darij Grinberg

**Author:** Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/27467





---

archive/issue_comments_429349.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,7 +11,8 @@\n ([3, 1, 2], [[3, 2, 1]])\n ([3, 2, 1], [[3, 1, 2], [2, 3, 1]])\n \n-The fourth and fifth lines of the output are incorrect.  The correct values should be\n+The fourth and fifth lines of the output are incorrect.\n+The correct values should be\n \n ([2, 3, 1], [[2, 1, 3]])\n ([3, 1, 2], [[1, 3, 2]])\n@@ -25,4 +26,4 @@\n ValueError: Hasse diagram contains cycles\n ```\n \n-Most likely a left-vs-right issue. Possibly related to #23299.\n+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.\n``````\n",
    "created_at": "2019-03-11T23:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429349",
    "user": "https://github.com/tscrim"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,7 +11,8 @@
 ([3, 1, 2], [[3, 2, 1]])
 ([3, 2, 1], [[3, 1, 2], [2, 3, 1]])
 
-The fourth and fifth lines of the output are incorrect.  The correct values should be
+The fourth and fifth lines of the output are incorrect.
+The correct values should be
 
 ([2, 3, 1], [[2, 1, 3]])
 ([3, 1, 2], [[1, 3, 2]])
@@ -25,4 +26,4 @@
 ValueError: Hasse diagram contains cycles
 ```
 
-Most likely a left-vs-right issue. Possibly related to #23299.
+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.
``````




---

archive/issue_comments_429350.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe problem is the multiplication for a permutation seems to have the oppose effect (by default):\n\n```\nsage: W = Permutations(3)\nsage: w = W([2,3,1])\nsage: w.reduced_word()\n[1, 2]\nsage: w.descents(side='right')\n[2]\nsage: w.apply_simple_reflection_right(2)\n[3, 2, 1]\n```\nSo we need to override `apply_simple_reflection_*` for `Permutation`.",
    "created_at": "2019-03-11T23:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429350",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
The problem is the multiplication for a permutation seems to have the oppose effect (by default):

```
sage: W = Permutations(3)
sage: w = W([2,3,1])
sage: w.reduced_word()
[1, 2]
sage: w.descents(side='right')
[2]
sage: w.apply_simple_reflection_right(2)
[3, 2, 1]
```
So we need to override `apply_simple_reflection_*` for `Permutation`.



---

archive/issue_comments_429351.json:
```json
{
    "body": "**Branch:** [public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)",
    "created_at": "2019-03-12T00:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429351",
    "user": "https://github.com/tscrim"
}
```

**Branch:** [public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)



---

archive/issue_events_246869.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-03-12T00:21:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246869"
}
```



---

archive/issue_comments_429352.json:
```json
{
    "body": "**Author:** Travis Scrimshaw",
    "created_at": "2019-03-12T00:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429352",
    "user": "https://github.com/tscrim"
}
```

**Author:** Travis Scrimshaw



---

archive/issue_comments_429353.json:
```json
{
    "body": "<a id='comment:3'></a>\nSo the only way forward that I could see to make this work is to gut out the multiplication option for `has_*_descent`. With this, I do not think anything for Coxeter combiantorics now uses the multiplication convention.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee\">2273223</a></td><td><code>Making apply_simple_reflection_* and has_*_descent not use the permutation multiplication convention.</code></td></tr></table>\n",
    "created_at": "2019-03-12T00:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429353",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
So the only way forward that I could see to make this work is to gut out the multiplication option for `has_*_descent`. With this, I do not think anything for Coxeter combiantorics now uses the multiplication convention.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee">2273223</a></td><td><code>Making apply_simple_reflection_* and has_*_descent not use the permutation multiplication convention.</code></td></tr></table>




---

archive/issue_comments_429354.json:
```json
{
    "body": "**Commit:** [22732230664fc213b76e30da3d8c0988dc0139ee](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)",
    "created_at": "2019-03-12T00:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429354",
    "user": "https://github.com/tscrim"
}
```

**Commit:** [22732230664fc213b76e30da3d8c0988dc0139ee](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)



---

archive/issue_comments_429355.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -26,4 +26,4 @@\n ValueError: Hasse diagram contains cycles\n ```\n \n-This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.\n+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.\n``````\n",
    "created_at": "2019-03-12T00:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429355",
    "user": "https://github.com/tscrim"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -26,4 +26,4 @@
 ValueError: Hasse diagram contains cycles
 ```
 
-This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that.
+This is a left-vs-right issue and `Permutation` multiplication being a little strange with respect to that. We also remove the multiplication argument and convention effects from `has_*_descent`.
``````




---

archive/issue_comments_429356.json:
```json
{
    "body": "<a id='comment:5'></a>\nMoving all blocker/critical issues from 8.7 to 8.8.",
    "created_at": "2019-03-25T10:41:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429356",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
Moving all blocker/critical issues from 8.7 to 8.8.



---

archive/issue_events_246870.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:41:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246870"
}
```



---

archive/issue_events_246871.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:41:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246871"
}
```



---

archive/issue_comments_429357.json:
```json
{
    "body": "<a id='comment:6'></a>\nCan someone review this?",
    "created_at": "2019-05-24T22:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429357",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
Can someone review this?



---

archive/issue_comments_429358.json:
```json
{
    "body": "**Changing commit** from \"[22732230664fc213b76e30da3d8c0988dc0139ee](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)\" to \"[c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)\".",
    "created_at": "2019-05-24T23:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[22732230664fc213b76e30da3d8c0988dc0139ee](https://github.com/sagemath/sagetrac-mirror/commit/22732230664fc213b76e30da3d8c0988dc0139ee)" to "[c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)".



---

archive/issue_comments_429359.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c822b3f55993e2f8e769eb6ca72c872ee335a117\">c822b3f</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1\">c54aef5</a></td><td><code>Updating docstring based on comments by Darij.</code></td></tr></table>\n",
    "created_at": "2019-05-24T23:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429359",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c822b3f55993e2f8e769eb6ca72c872ee335a117">c822b3f</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1">c54aef5</a></td><td><code>Updating docstring based on comments by Darij.</code></td></tr></table>




---

archive/issue_comments_429360.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995\">295c517</a></td><td><code>Fixing Yokonuma-Hecke algebras.</code></td></tr></table>\n",
    "created_at": "2019-05-24T23:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995">295c517</a></td><td><code>Fixing Yokonuma-Hecke algebras.</code></td></tr></table>




---

archive/issue_comments_429361.json:
```json
{
    "body": "**Changing commit** from \"[c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)\" to \"[295c5178bb99e77b18961996fec91eed90e57995](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)\".",
    "created_at": "2019-05-24T23:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1](https://github.com/sagemath/sagetrac-mirror/commit/c54aef5f24af419293c8fe7c4d8b7d3c4dbabec1)" to "[295c5178bb99e77b18961996fec91eed90e57995](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)".



---

archive/issue_comments_429362.json:
```json
{
    "body": "<a id='comment:9'></a>\nGreen patchbot.",
    "created_at": "2019-05-25T23:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429362",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Green patchbot.



---

archive/issue_comments_429363.json:
```json
{
    "body": "<a id='comment:10'></a>\n* deprecation should appear in doctests, no ?\n\n* \"switching the entries i and i+1\" (remove \"equal\" ?) in the doc of apply_simple_reflection_right\n\n* I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?",
    "created_at": "2019-05-26T05:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429363",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
* deprecation should appear in doctests, no ?

* "switching the entries i and i+1" (remove "equal" ?) in the doc of apply_simple_reflection_right

* I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?



---

archive/issue_comments_429364.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f\">0af471b</a></td><td><code>Adding deprecation doctest and fixing docstring.</code></td></tr></table>\n",
    "created_at": "2019-06-05T00:36:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f">0af471b</a></td><td><code>Adding deprecation doctest and fixing docstring.</code></td></tr></table>




---

archive/issue_comments_429365.json:
```json
{
    "body": "**Changing commit** from \"[295c5178bb99e77b18961996fec91eed90e57995](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)\" to \"[0af471b6ae8b256a41045ad3a1be9dfdb056c61f](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)\".",
    "created_at": "2019-06-05T00:36:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429365",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[295c5178bb99e77b18961996fec91eed90e57995](https://github.com/sagemath/sagetrac-mirror/commit/295c5178bb99e77b18961996fec91eed90e57995)" to "[0af471b6ae8b256a41045ad3a1be9dfdb056c61f](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)".



---

archive/issue_comments_429366.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [chapoton](#comment%3A10):\n> * deprecation should appear in doctests, no ?\n\n\nAdded.\n\n> * \"switching the entries i and i+1\" (remove \"equal\" ?) in the doc of apply_simple_reflection_right\n\n\nFixed.\n\n> * I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?\n\n\nIt is at least no worse than what it is currently, but I think this makes it more consistent overall. Plus it fixes a definite bug.",
    "created_at": "2019-06-05T00:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429366",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Replying to [chapoton](#comment%3A10):
> * deprecation should appear in doctests, no ?


Added.

> * "switching the entries i and i+1" (remove "equal" ?) in the doc of apply_simple_reflection_right


Fixed.

> * I am worried that this seems to be a source of incoherence.. But maybe the situation gets no worse than what it is right now ?


It is at least no worse than what it is currently, but I think this makes it more consistent overall. Plus it fixes a definite bug.



---

archive/issue_comments_429367.json:
```json
{
    "body": "<a id='comment:13'></a>\nok, then.\n\nOne should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.",
    "created_at": "2019-06-05T08:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429367",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
ok, then.

One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.



---

archive/issue_events_246872.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246872"
}
```



---

archive/issue_events_246873.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246873"
}
```



---

archive/issue_comments_429368.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2019-06-05T08:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429368",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_429369.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [chapoton](#comment%3A13):\n> ok, then.\n\n\nThank you.\n\n> One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.\n\n\nAlso referencing `CoxeterGroup` or `WeylGroup` as well. Another ticket.\n\nI am adding Darij as a reviewer since he gave me some comments on the ticket.",
    "created_at": "2019-06-05T09:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429369",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Replying to [chapoton](#comment%3A13):
> ok, then.


Thank you.

> One should suggest somewhere loudly to use `SymmetricGroup(n)` instead of `Permutations(n)` when doing Coxeter-related work.


Also referencing `CoxeterGroup` or `WeylGroup` as well. Another ticket.

I am adding Darij as a reviewer since he gave me some comments on the ticket.



---

archive/issue_comments_429370.json:
```json
{
    "body": "**Changing reviewer** from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Darij Grinberg\".",
    "created_at": "2019-06-05T09:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429370",
    "user": "https://github.com/tscrim"
}
```

**Changing reviewer** from "Frédéric Chapoton" to "Frédéric Chapoton, Darij Grinberg".



---

archive/issue_comments_429371.json:
```json
{
    "body": "<a id='comment:15'></a>\nPossibly due to #27899, I'm getting \n\n```\nsage -t --warn-long 57.2 src/sage/combinat/dyck_word.py\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 1997, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\nFailed example:\n    p = DyckWord([1,1,0,1,0,0,1,1,0,1,0,1,0,0]).to_312_avoiding_permutation(); p\nExpected:\n    [2, 3, 1, 5, 6, 7, 4]\nGot:\n    [3, 1, 2, 7, 4, 5, 6]\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 2007, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\nFailed example:\n    all(pi.avoids([3,1,2]) for pi in PD)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 2197, in sage.combinat.dyck_word.DyckWord_complete.to_permutation\nFailed example:\n    D.to_permutation(map=\"Bandlow-Killpatrick\")\nExpected:\n    [3, 4, 2, 1]\nGot:\n    [4, 3, 1, 2]\n**********************************************************************\n2 items had failures:\n   2 of   9 in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation\n   1 of   7 in sage.combinat.dyck_word.DyckWord_complete.to_permutation\n    [581 tests, 3 failures, 1.27 s]\n----------------------------------------------------------------------\nsage -t --warn-long 57.2 src/sage/combinat/dyck_word.py  # 3 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-06-05T22:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429371",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
Possibly due to #27899, I'm getting 

```
sage -t --warn-long 57.2 src/sage/combinat/dyck_word.py
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 1997, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
Failed example:
    p = DyckWord([1,1,0,1,0,0,1,1,0,1,0,1,0,0]).to_312_avoiding_permutation(); p
Expected:
    [2, 3, 1, 5, 6, 7, 4]
Got:
    [3, 1, 2, 7, 4, 5, 6]
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 2007, in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
Failed example:
    all(pi.avoids([3,1,2]) for pi in PD)
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 2197, in sage.combinat.dyck_word.DyckWord_complete.to_permutation
Failed example:
    D.to_permutation(map="Bandlow-Killpatrick")
Expected:
    [3, 4, 2, 1]
Got:
    [4, 3, 1, 2]
**********************************************************************
2 items had failures:
   2 of   9 in sage.combinat.dyck_word.DyckWord_complete.to_312_avoiding_permutation
   1 of   7 in sage.combinat.dyck_word.DyckWord_complete.to_permutation
    [581 tests, 3 failures, 1.27 s]
----------------------------------------------------------------------
sage -t --warn-long 57.2 src/sage/combinat/dyck_word.py  # 3 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_246874.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-05T22:25:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246874"
}
```



---

archive/issue_events_246875.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-05T22:25:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246875"
}
```



---

archive/issue_comments_429372.json:
```json
{
    "body": "<a id='comment:16'></a>\nYes, probably correlated to this replacement in #27899 :\n\n```diff\n         n = self.semilength()\n         area = self.to_area_sequence()\n-        from sage.groups.perm_gps.permgroup_named import SymmetricGroup\n-        pi = SymmetricGroup(n).one()\n+        pi = Permutations(n).one()\n         for j in range(n):\n             for i in range(area[j]):\n-                pi = pi.apply_simple_reflection(j-i)\n-        return Permutation(~pi)\n+                pi = pi.apply_simple_reflection(j - i)\n+        return ~pi\n```",
    "created_at": "2019-06-06T05:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429372",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>
Yes, probably correlated to this replacement in #27899 :

```diff
         n = self.semilength()
         area = self.to_area_sequence()
-        from sage.groups.perm_gps.permgroup_named import SymmetricGroup
-        pi = SymmetricGroup(n).one()
+        pi = Permutations(n).one()
         for j in range(n):
             for i in range(area[j]):
-                pi = pi.apply_simple_reflection(j-i)
-        return Permutation(~pi)
+                pi = pi.apply_simple_reflection(j - i)
+        return ~pi
```



---

archive/issue_comments_429373.json:
```json
{
    "body": "<a id='comment:17'></a>\nI concur, and it should just be a matter of swapping the left/right convention (which I guess should just mean returning `pi` instead of `~pi`). I can do this tomorrow.",
    "created_at": "2019-06-06T07:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429373",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
I concur, and it should just be a matter of swapping the left/right convention (which I guess should just mean returning `pi` instead of `~pi`). I can do this tomorrow.



---

archive/issue_comments_429374.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9\">25f8655</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr></table>\n",
    "created_at": "2019-06-10T23:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9">25f8655</a></td><td><code>Merge branch 'public/combinat/fix_weak_order_permutations-27467' of git://trac.sagemath.org/sage into public/combinat/fix_weak_order_permutations-27467</code></td></tr></table>




---

archive/issue_comments_429375.json:
```json
{
    "body": "**Changing commit** from \"[0af471b6ae8b256a41045ad3a1be9dfdb056c61f](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)\" to \"[25f865556eed7f2afc420fa5d1b757c32d101fa9](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)\".",
    "created_at": "2019-06-10T23:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0af471b6ae8b256a41045ad3a1be9dfdb056c61f](https://github.com/sagemath/sagetrac-mirror/commit/0af471b6ae8b256a41045ad3a1be9dfdb056c61f)" to "[25f865556eed7f2afc420fa5d1b757c32d101fa9](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)".



---

archive/issue_comments_429376.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7\">fa0450e</a></td><td><code>Fixing left-right convention difference.</code></td></tr></table>\n",
    "created_at": "2019-06-10T23:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429376",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7">fa0450e</a></td><td><code>Fixing left-right convention difference.</code></td></tr></table>




---

archive/issue_comments_429377.json:
```json
{
    "body": "**Changing commit** from \"[25f865556eed7f2afc420fa5d1b757c32d101fa9](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)\" to \"[fa0450ecb592385c795af1e916ea18fca65608b7](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)\".",
    "created_at": "2019-06-10T23:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[25f865556eed7f2afc420fa5d1b757c32d101fa9](https://github.com/sagemath/sagetrac-mirror/commit/25f865556eed7f2afc420fa5d1b757c32d101fa9)" to "[fa0450ecb592385c795af1e916ea18fca65608b7](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)".



---

archive/issue_comments_429378.json:
```json
{
    "body": "<a id='comment:20'></a>\nSorry, I got sidetracked from this and forgot to do this last week. This is now fixed (although unfortunately we might have missed the next release cutoff...). Volker, it would be really nice if this could slip in to 8.8 since this is a relatively big bug in the combinatorics code.",
    "created_at": "2019-06-10T23:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429378",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>
Sorry, I got sidetracked from this and forgot to do this last week. This is now fixed (although unfortunately we might have missed the next release cutoff...). Volker, it would be really nice if this could slip in to 8.8 since this is a relatively big bug in the combinatorics code.



---

archive/issue_events_246876.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-10T23:48:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246876"
}
```



---

archive/issue_events_246877.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-06-10T23:48:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246877"
}
```



---

archive/issue_events_246878.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-11T07:23:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246878"
}
```



---

archive/issue_events_246879.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-11T07:23:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246879"
}
```



---

archive/issue_comments_429379.json:
```json
{
    "body": "<a id='comment:21'></a>\nset to positive again",
    "created_at": "2019-06-11T07:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429379",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
set to positive again



---

archive/issue_events_246880.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-11T08:59:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246880"
}
```



---

archive/issue_events_246881.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-11T08:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246881"
}
```



---

archive/issue_comments_429380.json:
```json
{
    "body": "**Changing branch** from \"[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)\" to \"[fa0450ecb592385c795af1e916ea18fca65608b7](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)\".",
    "created_at": "2019-06-12T21:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27467#issuecomment-429380",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/combinat/fix_weak_order_permutations-27467](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_weak_order_permutations-27467)" to "[fa0450ecb592385c795af1e916ea18fca65608b7](https://github.com/sagemath/sagetrac-mirror/commit/fa0450ecb592385c795af1e916ea18fca65608b7)".



---

archive/issue_events_246882.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-12T21:41:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246882"
}
```



---

archive/issue_events_246883.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-12T21:41:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27467",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27467#event-246883"
}
```
