# Issue 27390: Py3: test_class_pickling.py fix method resolution order error

archive/issues_027153.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nFix the\n\n```\nsage -t --long src/sage/misc/test_class_pickling.py\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 20, in sage.misc.test_class_pickling.metaclass\nFailed example:\n    c = metaclass(\"foo2\", (object, bar,))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.metaclass[1]>\", line 1, in <module>\n        c = metaclass(\"foo2\", (object, bar,))\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py\", line 31, in metaclass\n        result = Metaclass(name, bases, dict())\n    TypeError: Cannot create a consistent method resolution\n    order (MRO) for bases object, bar\n**********************************************************************\n```\nerrors in python3.\n\nAs `bar` inherit from `object` python3 is unable to define the method resolution order.\n\nAdd another test object and rewrite the doctests with this object.\n\nThis ticket fixes all python3 errors in `test_class_pickling.py`\n\nComponent: **python3**\n\nAuthor: **Vincent Klein**\n\nBranch/Commit: **[`6946310`](https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17)**\n\nReviewer: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27390_\n\n",
    "closed_at": "2019-03-03T22:38:02Z",
    "created_at": "2019-03-01T10:19:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Py3: test_class_pickling.py fix method resolution order error",
    "type": "issue",
    "updated_at": "2019-03-03T22:38:02Z",
    "url": "https://github.com/sagemath/sage/issues/27390",
    "user": "https://github.com/vinklein"
}
```
<div id="comment:0"></div>

Fix the

```
sage -t --long src/sage/misc/test_class_pickling.py
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 20, in sage.misc.test_class_pickling.metaclass
Failed example:
    c = metaclass("foo2", (object, bar,))
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.metaclass[1]>", line 1, in <module>
        c = metaclass("foo2", (object, bar,))
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py", line 31, in metaclass
        result = Metaclass(name, bases, dict())
    TypeError: Cannot create a consistent method resolution
    order (MRO) for bases object, bar
**********************************************************************
```
errors in python3.

As `bar` inherit from `object` python3 is unable to define the method resolution order.

Add another test object and rewrite the doctests with this object.

This ticket fixes all python3 errors in `test_class_pickling.py`

Component: **python3**

Author: **Vincent Klein**

Branch/Commit: **[`6946310`](https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17)**

Reviewer: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/27390_





---

archive/issue_events_373291.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T10:19:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373291"
}
```



---

archive/issue_events_373292.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T10:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373292"
}
```



---

archive/issue_events_373293.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T10:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373293"
}
```



---

archive/issue_events_373294.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T10:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373294"
}
```



---

archive/issue_comments_423633.json:
```json
{
    "body": "Branch: **[u/vklein/27390](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/27390)**",
    "created_at": "2019-03-01T10:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423633",
    "user": "https://github.com/vinklein"
}
```

Branch: **[u/vklein/27390](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/27390)**



---

archive/issue_comments_423634.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82f97c33db686d77a2dc0c8878151cafca380ce5\"><code>82f97c3</code></a></td><td><code>Trac #27390: Fix misc.test_class_pickling for py3</code></td></tr></table>\n",
    "created_at": "2019-03-01T10:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423634",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82f97c33db686d77a2dc0c8878151cafca380ce5"><code>82f97c3</code></a></td><td><code>Trac #27390: Fix misc.test_class_pickling for py3</code></td></tr></table>




---

archive/issue_comments_423635.json:
```json
{
    "body": "Commit: **[`82f97c3`](https://github.com/sagemath/sagetrac-mirror/commit/82f97c33db686d77a2dc0c8878151cafca380ce5)**",
    "created_at": "2019-03-01T10:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423635",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`82f97c3`](https://github.com/sagemath/sagetrac-mirror/commit/82f97c33db686d77a2dc0c8878151cafca380ce5)**



---

archive/issue_events_373295.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T10:42:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373295"
}
```



---

archive/issue_events_373296.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-01T14:35:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373296"
}
```



---

archive/issue_events_373297.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-01T14:35:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373297"
}
```



---

archive/issue_comments_423636.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIt would be useful if you could post the actual errors that this ticket is supposed to fix.",
    "created_at": "2019-03-01T14:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423636",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

It would be useful if you could post the actual errors that this ticket is supposed to fix.



---

archive/issue_comments_423637.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nSure : \n\n```\nsage -t --long src/sage/misc/test_class_pickling.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2019-03-01-15-36-28-4c28d334.\nGit branch: develop\nUsing --optional=dochtml,gmpy2,memlimit,mpir,python2,sage\nDoctesting 1 file.\nsage -t --long src/sage/misc/test_class_pickling.py\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 20, in sage.misc.test_class_pickling.metaclass\nFailed example:\n    c = metaclass(\"foo2\", (object, bar,))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.metaclass[1]>\", line 1, in <module>\n        c = metaclass(\"foo2\", (object, bar,))\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py\", line 31, in metaclass\n        result = Metaclass(name, bases, dict())\n    TypeError: Cannot create a consistent method resolution\n    order (MRO) for bases object, bar\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 22, in sage.misc.test_class_pickling.metaclass\nFailed example:\n    c\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.metaclass[2]>\", line 1, in <module>\n        c\n    NameError: name 'c' is not defined\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 24, in sage.misc.test_class_pickling.metaclass\nFailed example:\n    type(c)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.metaclass[3]>\", line 1, in <module>\n        type(c)\n    NameError: name 'c' is not defined\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 26, in sage.misc.test_class_pickling.metaclass\nFailed example:\n    c.__bases__\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.metaclass[4]>\", line 1, in <module>\n        c.__bases__\n    NameError: name 'c' is not defined\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 49, in sage.misc.test_class_pickling.Metaclass\nFailed example:\n    c = metaclass(\"foo\", (object, bar,))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.Metaclass[1]>\", line 1, in <module>\n        c = metaclass(\"foo\", (object, bar,))\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py\", line 31, in metaclass\n        result = Metaclass(name, bases, dict())\n    TypeError: Cannot create a consistent method resolution\n    order (MRO) for bases object, bar\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 52, in sage.misc.test_class_pickling.Metaclass\nFailed example:\n    s = cPickle.dumps(c)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.Metaclass[3]>\", line 1, in <module>\n        s = cPickle.dumps(c)\n    NameError: name 'c' is not defined\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 54, in sage.misc.test_class_pickling.Metaclass\nFailed example:\n    c2 = cPickle.loads(s)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.Metaclass[4]>\", line 1, in <module>\n        c2 = cPickle.loads(s)\n    NameError: name 's' is not defined\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 56, in sage.misc.test_class_pickling.Metaclass\nFailed example:\n    c == c2\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.Metaclass[5]>\", line 1, in <module>\n        c == c2\n    NameError: name 'c' is not defined\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 72, in sage.misc.test_class_pickling.Metaclass.__reduce__\nFailed example:\n    c = metaclass(\"foo3\", (object, bar,))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.Metaclass.__reduce__[1]>\", line 1, in <module>\n        c = metaclass(\"foo3\", (object, bar,))\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py\", line 31, in metaclass\n        result = Metaclass(name, bases, dict())\n    TypeError: Cannot create a consistent method resolution\n    order (MRO) for bases object, bar\n**********************************************************************\nFile \"src/sage/misc/test_class_pickling.py\", line 74, in sage.misc.test_class_pickling.Metaclass.__reduce__\nFailed example:\n    c.__class__.__reduce__(c)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.test_class_pickling.Metaclass.__reduce__[2]>\", line 1, in <module>\n        c.__class__.__reduce__(c)\n    NameError: name 'c' is not defined\n**********************************************************************\n3 items had failures:\n   4 of   7 in sage.misc.test_class_pickling.Metaclass\n   2 of   4 in sage.misc.test_class_pickling.Metaclass.__reduce__\n   4 of   6 in sage.misc.test_class_pickling.metaclass\n    [14 tests, 10 failures, 0.01 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/misc/test_class_pickling.py  # 10 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.0 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n\n```",
    "created_at": "2019-03-01T14:37:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423637",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:5" align="right">comment:5</div>

Sure : 

```
sage -t --long src/sage/misc/test_class_pickling.py
too many failed tests, not using stored timings
Running doctests with ID 2019-03-01-15-36-28-4c28d334.
Git branch: develop
Using --optional=dochtml,gmpy2,memlimit,mpir,python2,sage
Doctesting 1 file.
sage -t --long src/sage/misc/test_class_pickling.py
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 20, in sage.misc.test_class_pickling.metaclass
Failed example:
    c = metaclass("foo2", (object, bar,))
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.metaclass[1]>", line 1, in <module>
        c = metaclass("foo2", (object, bar,))
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py", line 31, in metaclass
        result = Metaclass(name, bases, dict())
    TypeError: Cannot create a consistent method resolution
    order (MRO) for bases object, bar
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 22, in sage.misc.test_class_pickling.metaclass
Failed example:
    c
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.metaclass[2]>", line 1, in <module>
        c
    NameError: name 'c' is not defined
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 24, in sage.misc.test_class_pickling.metaclass
Failed example:
    type(c)
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.metaclass[3]>", line 1, in <module>
        type(c)
    NameError: name 'c' is not defined
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 26, in sage.misc.test_class_pickling.metaclass
Failed example:
    c.__bases__
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.metaclass[4]>", line 1, in <module>
        c.__bases__
    NameError: name 'c' is not defined
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 49, in sage.misc.test_class_pickling.Metaclass
Failed example:
    c = metaclass("foo", (object, bar,))
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.Metaclass[1]>", line 1, in <module>
        c = metaclass("foo", (object, bar,))
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py", line 31, in metaclass
        result = Metaclass(name, bases, dict())
    TypeError: Cannot create a consistent method resolution
    order (MRO) for bases object, bar
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 52, in sage.misc.test_class_pickling.Metaclass
Failed example:
    s = cPickle.dumps(c)
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.Metaclass[3]>", line 1, in <module>
        s = cPickle.dumps(c)
    NameError: name 'c' is not defined
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 54, in sage.misc.test_class_pickling.Metaclass
Failed example:
    c2 = cPickle.loads(s)
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.Metaclass[4]>", line 1, in <module>
        c2 = cPickle.loads(s)
    NameError: name 's' is not defined
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 56, in sage.misc.test_class_pickling.Metaclass
Failed example:
    c == c2
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.Metaclass[5]>", line 1, in <module>
        c == c2
    NameError: name 'c' is not defined
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 72, in sage.misc.test_class_pickling.Metaclass.__reduce__
Failed example:
    c = metaclass("foo3", (object, bar,))
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.Metaclass.__reduce__[1]>", line 1, in <module>
        c = metaclass("foo3", (object, bar,))
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py", line 31, in metaclass
        result = Metaclass(name, bases, dict())
    TypeError: Cannot create a consistent method resolution
    order (MRO) for bases object, bar
**********************************************************************
File "src/sage/misc/test_class_pickling.py", line 74, in sage.misc.test_class_pickling.Metaclass.__reduce__
Failed example:
    c.__class__.__reduce__(c)
Exception raised:
    Traceback (most recent call last):
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.test_class_pickling.Metaclass.__reduce__[2]>", line 1, in <module>
        c.__class__.__reduce__(c)
    NameError: name 'c' is not defined
**********************************************************************
3 items had failures:
   4 of   7 in sage.misc.test_class_pickling.Metaclass
   2 of   4 in sage.misc.test_class_pickling.Metaclass.__reduce__
   4 of   6 in sage.misc.test_class_pickling.metaclass
    [14 tests, 10 failures, 0.01 s]
----------------------------------------------------------------------
sage -t --long src/sage/misc/test_class_pickling.py  # 10 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.0 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds

```



---

archive/issue_events_373298.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T14:37:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373298"
}
```



---

archive/issue_events_373299.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T14:37:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373299"
}
```



---

archive/issue_comments_423638.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI don't understand why adding the class `alpha` would fix anything.",
    "created_at": "2019-03-01T14:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423638",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I don't understand why adding the class `alpha` would fix anything.



---

archive/issue_comments_423639.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,25 @@\n Fix the\n \n ```\n-TypeError: Cannot create a consistent method resolution\n-order (MRO) for bases object, bar\n-``` \n+sage -t --long src/sage/misc/test_class_pickling.py\n+**********************************************************************\n+File \"src/sage/misc/test_class_pickling.py\", line 20, in sage.misc.test_class_pickling.metaclass\n+Failed example:\n+    c = metaclass(\"foo2\", (object, bar,))\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 671, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.misc.test_class_pickling.metaclass[1]>\", line 1, in <module>\n+        c = metaclass(\"foo2\", (object, bar,))\n+      File \"/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py\", line 31, in metaclass\n+        result = Metaclass(name, bases, dict())\n+    TypeError: Cannot create a consistent method resolution\n+    order (MRO) for bases object, bar\n+**********************************************************************\n+```\n errors in python3.\n \n As `bar` inherit from `object` python3 is unable to define the method resolution order.\n``````\n",
    "created_at": "2019-03-01T14:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423639",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,25 @@
 Fix the
 
 ```
-TypeError: Cannot create a consistent method resolution
-order (MRO) for bases object, bar
-``` 
+sage -t --long src/sage/misc/test_class_pickling.py
+**********************************************************************
+File "src/sage/misc/test_class_pickling.py", line 20, in sage.misc.test_class_pickling.metaclass
+Failed example:
+    c = metaclass("foo2", (object, bar,))
+Exception raised:
+    Traceback (most recent call last):
+      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 671, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.misc.test_class_pickling.metaclass[1]>", line 1, in <module>
+        c = metaclass("foo2", (object, bar,))
+      File "/home/vklein/odk/sage/local/lib/python3.6/site-packages/sage/misc/test_class_pickling.py", line 31, in metaclass
+        result = Metaclass(name, bases, dict())
+    TypeError: Cannot create a consistent method resolution
+    order (MRO) for bases object, bar
+**********************************************************************
+```
 errors in python3.
 
 As `bar` inherit from `object` python3 is unable to define the method resolution order.
``````




---

archive/issue_comments_423640.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt's not really about adding a class `alpha`. The goal is just to have two classes with no inheritance relationship in order to do a successful call to the `metaclass` function.",
    "created_at": "2019-03-01T14:58:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423640",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:7" align="right">comment:7</div>

It's not really about adding a class `alpha`. The goal is just to have two classes with no inheritance relationship in order to do a successful call to the `metaclass` function.



---

archive/issue_comments_423641.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBut why does it fail in Python 3 in the first place?",
    "created_at": "2019-03-01T15:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423641",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

But why does it fail in Python 3 in the first place?



---

archive/issue_comments_423642.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nFor me the question is more why it works in python2:\\\\\n\npy2\n\n```\n>>> class a:\n...     pass\n... \n>>> class b(object, a):\n...     pass\n... \n>>> class c(a,b):\n...     pass\n... \nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: Error when calling the metaclass bases\n    Cannot create a consistent method resolution\norder (MRO) for bases a, b\n```\n\npy3\n\n```\n>>> class a:\n...     pass\n... \n>>> class b(object, a):\n...     pass\n... \nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nTypeError: Cannot create a consistent method resolution\norder (MRO) for bases a, object\n```\n\nPython3 looks more consistent to me.",
    "created_at": "2019-03-01T15:09:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423642",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:9" align="right">comment:9</div>

For me the question is more why it works in python2:\\

py2

```
>>> class a:
...     pass
... 
>>> class b(object, a):
...     pass
... 
>>> class c(a,b):
...     pass
... 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: Error when calling the metaclass bases
    Cannot create a consistent method resolution
order (MRO) for bases a, b
```

py3

```
>>> class a:
...     pass
... 
>>> class b(object, a):
...     pass
... 
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: Cannot create a consistent method resolution
order (MRO) for bases a, object
```

Python3 looks more consistent to me.



---

archive/issue_comments_423643.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nYes of course, I was confusing MRO errors with metaclass errors because I saw the word `metaclass` in the code.",
    "created_at": "2019-03-01T15:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423643",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Yes of course, I was confusing MRO errors with metaclass errors because I saw the word `metaclass` in the code.



---

archive/issue_comments_423644.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSince this doctests isn't about MROs, I think that a better and simpler solution would be to change the bases `(object, bar)` to `(bar, object)`.",
    "created_at": "2019-03-01T15:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423644",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Since this doctests isn't about MROs, I think that a better and simpler solution would be to change the bases `(object, bar)` to `(bar, object)`.



---

archive/issue_events_373300.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-01T15:13:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373300"
}
```



---

archive/issue_events_373301.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-01T15:13:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373301"
}
```



---

archive/issue_comments_423645.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOk i will do that.",
    "created_at": "2019-03-01T15:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423645",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:12" align="right">comment:12</div>

Ok i will do that.



---

archive/issue_comments_423646.json:
```json
{
    "body": "Changed commit from **[`82f97c3`](https://github.com/sagemath/sagetrac-mirror/commit/82f97c33db686d77a2dc0c8878151cafca380ce5)** to **[`6946310`](https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17)**",
    "created_at": "2019-03-01T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423646",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`82f97c3`](https://github.com/sagemath/sagetrac-mirror/commit/82f97c33db686d77a2dc0c8878151cafca380ce5)** to **[`6946310`](https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17)**



---

archive/issue_comments_423647.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17\"><code>6946310</code></a></td><td><code>Trac #27390: Implement a simpler solution.</code></td></tr></table>\n",
    "created_at": "2019-03-01T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423647",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17"><code>6946310</code></a></td><td><code>Trac #27390: Implement a simpler solution.</code></td></tr></table>




---

archive/issue_events_373302.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T15:42:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373302"
}
```



---

archive/issue_events_373303.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-01T15:42:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373303"
}
```



---

archive/issue_events_373304.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-02T17:54:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373304"
}
```



---

archive/issue_events_373305.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-03-02T17:54:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373305"
}
```



---

archive/issue_comments_423648.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2019-03-02T17:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423648",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_373306.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-03T22:38:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373306"
}
```



---

archive/issue_events_373307.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a98d47a6d5689e8f7590cb82b1bafc67a5c5c30b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-03T22:38:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27390#event-373307"
}
```



---

archive/issue_comments_423649.json:
```json
{
    "body": "Changed branch from **[u/vklein/27390](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/27390)** to **[`6946310`](https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17)**",
    "created_at": "2019-03-03T22:38:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27390#issuecomment-423649",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vklein/27390](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/27390)** to **[`6946310`](https://github.com/sagemath/sagetrac-mirror/commit/6946310194a5407fa2e77a9241de5f51c3650b17)**
