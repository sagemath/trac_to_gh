# Issue 27129: py3: fix other doctests in graph.py

archive/issues_026892.json:
```json
{
    "assignees": [],
    "body": "We change some doctests in `cliques_containing_vertex` and `perfect_matchings` to support py3.\n\nKeywords: **py3, graph**\n\nBranch/Commit: **[40bcb34](https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **David Coudert**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27129_\n\n",
    "closed_at": "2019-02-04T23:02:17Z",
    "created_at": "2019-01-25T15:44:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: fix other doctests in graph.py",
    "type": "issue",
    "updated_at": "2019-02-04T23:02:17Z",
    "url": "https://github.com/sagemath/sage/issues/27129",
    "user": "https://github.com/dcoudert"
}
```
We change some doctests in `cliques_containing_vertex` and `perfect_matchings` to support py3.

Keywords: **py3, graph**

Branch/Commit: **[40bcb34](https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785)**

Reviewer: **Travis Scrimshaw**

Author: **David Coudert**

_Issue created by migration from https://trac.sagemath.org/ticket/27129_





---

archive/issue_events_354679.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-01-25T15:44:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354679"
}
```



---

archive/issue_events_354680.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-01-25T15:44:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "component: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354680"
}
```



---

archive/issue_events_354681.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-01-25T15:44:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354681"
}
```



---

archive/issue_events_354682.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-01-25T15:44:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354682"
}
```



---

archive/issue_comments_421528.json:
```json
{
    "body": "Branch: **[public/27129_more_doctests_in_graph](https://github.com/sagemath/sagetrac-mirror/tree/public/27129_more_doctests_in_graph)**",
    "created_at": "2019-01-25T15:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421528",
    "user": "https://github.com/dcoudert"
}
```

Branch: **[public/27129_more_doctests_in_graph](https://github.com/sagemath/sagetrac-mirror/tree/public/27129_more_doctests_in_graph)**



---

archive/issue_events_354683.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-01-25T15:47:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354683"
}
```



---

archive/issue_comments_421529.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nWith #27125 and #27127, this should fix all (currently) failing doctests with py3 in file `graph.py`.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f8e80ba0fc40c7faf3a7c3519feaec45639c83b8\">f8e80ba</a></td><td><code>trac #27129: fix some more doctests in graph.py</code></td></tr></table>\n",
    "created_at": "2019-01-25T15:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421529",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:1'>Comment 1:</a>
With #27125 and #27127, this should fix all (currently) failing doctests with py3 in file `graph.py`.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f8e80ba0fc40c7faf3a7c3519feaec45639c83b8">f8e80ba</a></td><td><code>trac #27129: fix some more doctests in graph.py</code></td></tr></table>




---

archive/issue_comments_421530.json:
```json
{
    "body": "Commit: **[f8e80ba](https://github.com/sagemath/sagetrac-mirror/commit/f8e80ba0fc40c7faf3a7c3519feaec45639c83b8)**",
    "created_at": "2019-01-25T15:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421530",
    "user": "https://github.com/dcoudert"
}
```

Commit: **[f8e80ba](https://github.com/sagemath/sagetrac-mirror/commit/f8e80ba0fc40c7faf3a7c3519feaec45639c83b8)**



---

archive/issue_comments_421531.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nCan you explain why this change is necessary?\n\n```diff\n-            sage: G = Graph([[1,-1,'a'], [2,-2, 'b'], [1,-2,'x'], [2,-1,'y']])\n+            sage: G = Graph([(0, 1, 'a'), (0, 3, 'b'), (1, 2, 'c'), (2, 3, 'd')])\n             sage: list(G.perfect_matchings(labels=True))\n-            [[(-2, 1, 'x'), (-1, 2, 'y')], [(-2, 2, 'b'), (-1, 1, 'a')]]\n+            [[(0, 1, 'a'), (2, 3, 'd')], [(0, 3, 'b'), (1, 2, 'c')]]\n```",
    "created_at": "2019-01-25T19:57:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421531",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'>Comment 2:</a>
Can you explain why this change is necessary?

```diff
-            sage: G = Graph([[1,-1,'a'], [2,-2, 'b'], [1,-2,'x'], [2,-1,'y']])
+            sage: G = Graph([(0, 1, 'a'), (0, 3, 'b'), (1, 2, 'c'), (2, 3, 'd')])
             sage: list(G.perfect_matchings(labels=True))
-            [[(-2, 1, 'x'), (-1, 2, 'y')], [(-2, 2, 'b'), (-1, 1, 'a')]]
+            [[(0, 1, 'a'), (2, 3, 'd')], [(0, 3, 'b'), (1, 2, 'c')]]
```



---

archive/issue_comments_421532.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nEssentially the same motivation as in [[#27127 comment:3](https://github.com/sagemath/sage/issues/27127#comment:3)]. The order in which vertices are visited is not always the same in py2 and py3, and so the order in which solutions are discovered may differ.\n\nHere, with py3, we get `[[(-1, 1, 'a'), (-2, 2, 'b')], [(-1, 2, 'y'), (-2, 1, 'x')]]`. So same set of solutions than with py2, but matchings are reported in a different order, and the order of edges of each matching is different.\n\nThe proposed change is more stable with py2 and py3.\n\nAn alternative is to do:\n\n```\nsage: def compare(A, B):\n....:     return Set(map(Set, A)) == Set(map(Set, B))\nsage: G = Graph([[1,-1,'a'], [2,-2, 'b'], [1,-2,'x'], [2,-1,'y']])\nsage: expected = [[(-2, 1, 'x'), (-1, 2, 'y')], [(-2, 2, 'b'), (-1, 1, 'a')]]\nsage: L = list(G.perfect_matchings(labels=True))\nsage: compare(L, expected)\nTrue\n```\nShould I do that ?",
    "created_at": "2019-01-26T09:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421532",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'>Comment 3:</a>
Essentially the same motivation as in [[#27127 comment:3](https://github.com/sagemath/sage/issues/27127#comment:3)]. The order in which vertices are visited is not always the same in py2 and py3, and so the order in which solutions are discovered may differ.

Here, with py3, we get `[[(-1, 1, 'a'), (-2, 2, 'b')], [(-1, 2, 'y'), (-2, 1, 'x')]]`. So same set of solutions than with py2, but matchings are reported in a different order, and the order of edges of each matching is different.

The proposed change is more stable with py2 and py3.

An alternative is to do:

```
sage: def compare(A, B):
....:     return Set(map(Set, A)) == Set(map(Set, B))
sage: G = Graph([[1,-1,'a'], [2,-2, 'b'], [1,-2,'x'], [2,-1,'y']])
sage: expected = [[(-2, 1, 'x'), (-1, 2, 'y')], [(-2, 2, 'b'), (-1, 1, 'a')]]
sage: L = list(G.perfect_matchings(labels=True))
sage: compare(L, expected)
True
```
Should I do that ?



---

archive/issue_comments_421533.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThat doesn't explain why this change is necessary. It just seems to replace a brittle test with another brittle test. Why not just run `sorted` on the output (since everything is a `(int, int, str)`, there should be no invalid comparisons)?",
    "created_at": "2019-01-26T20:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421533",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'>Comment 4:</a>
That doesn't explain why this change is necessary. It just seems to replace a brittle test with another brittle test. Why not just run `sorted` on the output (since everything is a `(int, int, str)`, there should be no invalid comparisons)?



---

archive/issue_comments_421534.json:
```json
{
    "body": "Changed commit from **[f8e80ba](https://github.com/sagemath/sagetrac-mirror/commit/f8e80ba0fc40c7faf3a7c3519feaec45639c83b8)** to **[40bcb34](https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785)**",
    "created_at": "2019-01-27T09:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421534",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f8e80ba](https://github.com/sagemath/sagetrac-mirror/commit/f8e80ba0fc40c7faf3a7c3519feaec45639c83b8)** to **[40bcb34](https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785)**



---

archive/issue_comments_421535.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5c60b931f219c959bbe5d5379414afad44c241d\">e5c60b9</a></td><td><code>trac #27129: Merged with 8.7.beta1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785\">40bcb34</a></td><td><code>trac #27129: fix doctest in perfect matching</code></td></tr></table>\n",
    "created_at": "2019-01-27T09:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421535",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5c60b931f219c959bbe5d5379414afad44c241d">e5c60b9</a></td><td><code>trac #27129: Merged with 8.7.beta1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785">40bcb34</a></td><td><code>trac #27129: fix doctest in perfect matching</code></td></tr></table>




---

archive/issue_comments_421536.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nI agree. I'm now using `sorted` twice. This doctest should be stable now.",
    "created_at": "2019-01-27T10:01:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421536",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'>Comment 6:</a>
I agree. I'm now using `sorted` twice. This doctest should be stable now.



---

archive/issue_events_354684.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-27T14:49:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354684"
}
```



---

archive/issue_events_354685.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-27T14:49:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354685"
}
```



---

archive/issue_comments_421537.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThank you.",
    "created_at": "2019-01-27T14:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421537",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'>Comment 7:</a>
Thank you.



---

archive/issue_comments_421538.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2019-01-27T14:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421538",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_421539.json:
```json
{
    "body": "Changed branch from **[public/27129_more_doctests_in_graph](https://github.com/sagemath/sagetrac-mirror/tree/public/27129_more_doctests_in_graph)** to **[40bcb34](https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785)**",
    "created_at": "2019-02-04T23:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27129#issuecomment-421539",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/27129_more_doctests_in_graph](https://github.com/sagemath/sagetrac-mirror/tree/public/27129_more_doctests_in_graph)** to **[40bcb34](https://github.com/sagemath/sagetrac-mirror/commit/40bcb34762133848f04d3098cef9ae08e1480785)**



---

archive/issue_events_354686.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-04T23:02:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354686"
}
```



---

archive/issue_events_354687.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "18a12b81a24f58bc040818446d50899304fb3a18",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-02-04T23:02:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27129",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27129#event-354687"
}
```
