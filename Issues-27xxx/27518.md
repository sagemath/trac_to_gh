# Issue 27518: Implementation of Floyd-Warshall for all pair shortest distance

archive/issues_027281.json:
```json
{
    "body": "Currently sage has implemented Floyd-Warshall algorithm only for graphs with constant edge weight of 1 in cython. Implementation of Floyd warshall algorithm in cython for finding all pair shortest distances(ASAD) can be done. This algorithm can be further improved to find all pair shortest paths(ASAP)(Later).\n\nWe can also improve all pair shortest distance algorithm using the technique described in the following paper:-\nhttps://pdfs.semanticscholar.org/568f/58737e752bf831a3e48036cf5205facce769.pdf\nUsually complexity for finding ASAD with matrix multiplication comes with large constants that results in slow running time, But the implementation that is described in the paper can faster the running time for algorithm.  \n\nAssignee: @giorgosgiapis\n\nCC:  @dcoudert\n\nBranch/Commit: dc082bb5e6bee3644615fb5cbc62a44d7a52ed6a\n\nReviewer: David Coudert\n\nAuthor: Georgios Giapitzakis Tzintanos\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27518\n\n",
    "closed_at": "2019-05-21T12:15:53Z",
    "created_at": "2019-03-20T19:28:37Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Implementation of Floyd-Warshall for all pair shortest distance",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27518",
    "user": "https://github.com/Hrishabh-yadav"
}
```
Currently sage has implemented Floyd-Warshall algorithm only for graphs with constant edge weight of 1 in cython. Implementation of Floyd warshall algorithm in cython for finding all pair shortest distances(ASAD) can be done. This algorithm can be further improved to find all pair shortest paths(ASAP)(Later).

We can also improve all pair shortest distance algorithm using the technique described in the following paper:-
https://pdfs.semanticscholar.org/568f/58737e752bf831a3e48036cf5205facce769.pdf
Usually complexity for finding ASAD with matrix multiplication comes with large constants that results in slow running time, But the implementation that is described in the paper can faster the running time for algorithm.  

Assignee: @giorgosgiapis

CC:  @dcoudert

Branch/Commit: dc082bb5e6bee3644615fb5cbc62a44d7a52ed6a

Reviewer: David Coudert

Author: Georgios Giapitzakis Tzintanos

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27518





---

archive/issue_comments_384104.json:
```json
{
    "body": "<a id='comment:1'></a>I am working on this. I think we should take care of the case when edge_label is not a number (Probably set weight to 1).",
    "created_at": "2019-03-21T12:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384104",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:1'></a>I am working on this. I think we should take care of the case when edge_label is not a number (Probably set weight to 1).



---

archive/issue_comments_384105.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-21T17:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384105",
    "user": "https://github.com/giorgosgiapis"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_384106.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2019-03-21T17:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384106",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_384107.json:
```json
{
    "body": "Set assignee to @giorgosgiapis.",
    "created_at": "2019-03-21T17:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384107",
    "user": "https://github.com/giorgosgiapis"
}
```

Set assignee to @giorgosgiapis.



---

archive/issue_comments_384108.json:
```json
{
    "body": "<a id='comment:5'></a>- The usage of edge weights is not fully unified in the graph module. However, many methods have as input parameter `wfunction`, a function that inputs an edge and outputs a number. You should consider adding this parameter as input of the method.\n\n- There is an implementation of Floyd-Warshall algorithm in `boost` https://www.boost.org/doc/libs/1_69_0/libs/graph/doc/floyd_warshall_shortest.html\n\n  and we have an interface with boost `src/sage/graphs/base/boost_*`.\n\n  So you should first expose the boost implementation in Sagemath.\n\n- Moreover, Johnson algorithm is considered faster for sparse graphs (and most of the graphs are sparse).\n  - we can use the implementation of boost: `'Johnson_Boost'`\n  - we can also use the implementation of `igraph` (an optional package), although not directly exposed. In fact method `shortest_paths` of `igraph` call Johnson algorithm and not Floyd-Warshall for the reason explained here: https://lists.nongnu.org/archive/html/igraph-help/2009-06/msg00029.html\n\n    when `igraph` is installed, we can do `H = G.igraph_graph()` and then `H.shortest_paths()` with appropriate parameters.",
    "created_at": "2019-03-21T17:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384108",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>- The usage of edge weights is not fully unified in the graph module. However, many methods have as input parameter `wfunction`, a function that inputs an edge and outputs a number. You should consider adding this parameter as input of the method.

- There is an implementation of Floyd-Warshall algorithm in `boost` https://www.boost.org/doc/libs/1_69_0/libs/graph/doc/floyd_warshall_shortest.html

  and we have an interface with boost `src/sage/graphs/base/boost_*`.

  So you should first expose the boost implementation in Sagemath.

- Moreover, Johnson algorithm is considered faster for sparse graphs (and most of the graphs are sparse).
  - we can use the implementation of boost: `'Johnson_Boost'`
  - we can also use the implementation of `igraph` (an optional package), although not directly exposed. In fact method `shortest_paths` of `igraph` call Johnson algorithm and not Floyd-Warshall for the reason explained here: https://lists.nongnu.org/archive/html/igraph-help/2009-06/msg00029.html

    when `igraph` is installed, we can do `H = G.igraph_graph()` and then `H.shortest_paths()` with appropriate parameters.



---

archive/issue_comments_384109.json:
```json
{
    "body": "<a id='comment:6'></a>Does the algorithm only work if given graph has all possible edges defined, Like if I input a Graph with 100 edges and 11 vertices :\n\n```\n sage: \n....: from sage.graphs.distances_all_pairs import floyd_warshall\n....: G= Graph()\n....: G.allow_multiple_edges(True)\n....: G.allow_loops(True)\n....: G.weighted(True)\n....: for i in range(100):\n....:     u=randint(0,10)\n....:     v=randint(0,10)\n....:     l=randint(0,1000)\n....:     G.add_edge(u,v,l)\n....:     G.add_edge(v,u,l)\n....:     \n....: print(floyd_warshall(G,paths=False,distances=True))\n....: \n....:     \n---------------------------------------------------------------------------\nLookupError                               Traceback (most recent call last)\n<ipython-input-13-c620edb96b9c> in <module>()\n     12     G.add_edge(v,u,l)\n     13 \n---> 14 print(floyd_warshall(G,paths=False,distances=True))\n     15 \n     16 \n\n/home/hrishabh/sage/local/lib/python2.7/site-packages/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.floyd_warshall (build/cythonized/sage/graphs/distances_all_pairs.c:15993)()\n   1623         for u_int in g.out_neighbors(v_int):\n   1624             if gg.weighted() == True:\n-> 1625                 label = str(gg.edge_label(v_int, u_int))\n   1626                 try:\n   1627                     weight = int(label)\n\n/home/hrishabh/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in edge_label(self, u, v)\n  11310             True\n  11311         \"\"\"\n> 11312         return self._backend.get_edge_label(u,v)\n  11313 \n  11314     def edge_labels(self):\n\n/home/hrishabh/sage/local/lib/python2.7/site-packages/sage/graphs/base/sparse_graph.pyx in sage.graphs.base.sparse_graph.SparseGraphBackend.get_edge_label (build/cythonized/sage/graphs/base/sparse_graph.c:19894)()\n   1643         cdef int v_int = self.get_vertex(v)\n   1644         if not (<SparseGraph>self._cg).has_arc_unsafe(u_int, v_int):\n-> 1645             raise LookupError(\"({0}, {1}) is not an edge of the graph.\".format(repr(u),repr(v)))\n   1646         if self.multiple_edges(None):\n   1647             return [self.edge_labels[l_int] if l_int != 0 else None\n\nLookupError: (1, 2) is not an edge of the graph.\n```\n\nBut the same algorithm works for 500 edges and 11 vertices:-\n\n```\n....: from sage.graphs.distances_all_pairs import floyd_warshall\n....: G= Graph()\n....: G.allow_multiple_edges(True)\n....: G.allow_loops(True)\n....: G.weighted(True)\n....: for i in range(500):\n....:     u=randint(0,10)\n....:     v=randint(0,10)\n....:     l=randint(0,1000)\n....:     G.add_edge(u,v,l)\n....:     G.add_edge(v,u,l)\n....:     \n....: print(floyd_warshall(G,paths=False,distances=True))\n....: \n....:     \n{0: {0: 0, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 1: {0: 1, 1: 0, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 2: {0: 1, 1: 1, 2: 0, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 3: {0: 1, 1: 1, 2: 1, 3: 0, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 4: {0: 1, 1: 1, 2: 1, 3: 1, 4: 0, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 5: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 0, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 6: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 0, 7: 1, 8: 1, 9: 1, 10: 1}, 7: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 0, 8: 1, 9: 1, 10: 1}, 8: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 0, 9: 1, 10: 1}, 9: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 0, 10: 1}, 10: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 0}}\n```\nAny particular reason?",
    "created_at": "2019-03-21T21:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384109",
    "user": "https://github.com/Hrishabh-yadav"
}
```

<a id='comment:6'></a>Does the algorithm only work if given graph has all possible edges defined, Like if I input a Graph with 100 edges and 11 vertices :

```
 sage: 
....: from sage.graphs.distances_all_pairs import floyd_warshall
....: G= Graph()
....: G.allow_multiple_edges(True)
....: G.allow_loops(True)
....: G.weighted(True)
....: for i in range(100):
....:     u=randint(0,10)
....:     v=randint(0,10)
....:     l=randint(0,1000)
....:     G.add_edge(u,v,l)
....:     G.add_edge(v,u,l)
....:     
....: print(floyd_warshall(G,paths=False,distances=True))
....: 
....:     
---------------------------------------------------------------------------
LookupError                               Traceback (most recent call last)
<ipython-input-13-c620edb96b9c> in <module>()
     12     G.add_edge(v,u,l)
     13 
---> 14 print(floyd_warshall(G,paths=False,distances=True))
     15 
     16 

/home/hrishabh/sage/local/lib/python2.7/site-packages/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.floyd_warshall (build/cythonized/sage/graphs/distances_all_pairs.c:15993)()
   1623         for u_int in g.out_neighbors(v_int):
   1624             if gg.weighted() == True:
-> 1625                 label = str(gg.edge_label(v_int, u_int))
   1626                 try:
   1627                     weight = int(label)

/home/hrishabh/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in edge_label(self, u, v)
  11310             True
  11311         """
> 11312         return self._backend.get_edge_label(u,v)
  11313 
  11314     def edge_labels(self):

/home/hrishabh/sage/local/lib/python2.7/site-packages/sage/graphs/base/sparse_graph.pyx in sage.graphs.base.sparse_graph.SparseGraphBackend.get_edge_label (build/cythonized/sage/graphs/base/sparse_graph.c:19894)()
   1643         cdef int v_int = self.get_vertex(v)
   1644         if not (<SparseGraph>self._cg).has_arc_unsafe(u_int, v_int):
-> 1645             raise LookupError("({0}, {1}) is not an edge of the graph.".format(repr(u),repr(v)))
   1646         if self.multiple_edges(None):
   1647             return [self.edge_labels[l_int] if l_int != 0 else None

LookupError: (1, 2) is not an edge of the graph.
```

But the same algorithm works for 500 edges and 11 vertices:-

```
....: from sage.graphs.distances_all_pairs import floyd_warshall
....: G= Graph()
....: G.allow_multiple_edges(True)
....: G.allow_loops(True)
....: G.weighted(True)
....: for i in range(500):
....:     u=randint(0,10)
....:     v=randint(0,10)
....:     l=randint(0,1000)
....:     G.add_edge(u,v,l)
....:     G.add_edge(v,u,l)
....:     
....: print(floyd_warshall(G,paths=False,distances=True))
....: 
....:     
{0: {0: 0, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 1: {0: 1, 1: 0, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 2: {0: 1, 1: 1, 2: 0, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 3: {0: 1, 1: 1, 2: 1, 3: 0, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 4: {0: 1, 1: 1, 2: 1, 3: 1, 4: 0, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 5: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 0, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}, 6: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 0, 7: 1, 8: 1, 9: 1, 10: 1}, 7: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 0, 8: 1, 9: 1, 10: 1}, 8: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 0, 9: 1, 10: 1}, 9: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 0, 10: 1}, 10: {0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 0}}
```
Any particular reason?



---

archive/issue_comments_384110.json:
```json
{
    "body": "<a id='comment:7'></a>Well, I think I figured it out. If we work on the original graph (gg) and not in the graph created in line \n\n\n```\ncdef CGraph g = <CGraph> gg._backend.c_graph()[0]\n```\n\nthe problem seems to get fixed. I don't really know what causes the issue in the first place but in general, the above line seems to add to the graph g some edges which are not present in gg.",
    "created_at": "2019-03-21T23:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384110",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:7'></a>Well, I think I figured it out. If we work on the original graph (gg) and not in the graph created in line 


```
cdef CGraph g = <CGraph> gg._backend.c_graph()[0]
```

the problem seems to get fixed. I don't really know what causes the issue in the first place but in general, the above line seems to add to the graph g some edges which are not present in gg.



---

archive/issue_comments_384111.json:
```json
{
    "body": "<a id='comment:8'></a>> {{{\n> cdef CGraph g = <CGraph> gg._backend.c_graph()[0]\n> }}}\n> \n> the problem seems to get fixed. I don't really know what causes the issue in the first place but in general, the above line seems to add to the graph g some edges which are not present in gg.\n\n\n`g` is in underlying backend graph format. This is a different format than `Graph` in which nodes and edges have different labels than in the `gg`. Although you can make much more efficient code using the backend directly, don't start playing with this if you are not an advanced user !",
    "created_at": "2019-03-22T14:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384111",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>> {{{
> cdef CGraph g = <CGraph> gg._backend.c_graph()[0]
> }}}
> 
> the problem seems to get fixed. I don't really know what causes the issue in the first place but in general, the above line seems to add to the graph g some edges which are not present in gg.


`g` is in underlying backend graph format. This is a different format than `Graph` in which nodes and edges have different labels than in the `gg`. Although you can make much more efficient code using the backend directly, don't start playing with this if you are not an advanced user !



---

archive/issue_comments_384112.json:
```json
{
    "body": "<a id='comment:9'></a>The boost implementation of Floyd-Warshall and Johnson algorithm returns only the distances and not the paths. Would it be a good idea to use it and retrieve the paths from the distance values? Personally, I can't think of a way to do this faster than O(V<sup>3</sup>).",
    "created_at": "2019-03-26T17:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384112",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:9'></a>The boost implementation of Floyd-Warshall and Johnson algorithm returns only the distances and not the paths. Would it be a good idea to use it and retrieve the paths from the distance values? Personally, I can't think of a way to do this faster than O(V<sup>3</sup>).



---

archive/issue_comments_384113.json:
```json
{
    "body": "<a id='comment:10'></a>What is your objective: get distances or get paths ? For distances, you can use boost. For paths, this is another story, and you will have to code a specific algorithm. However, I'm not convinced that using Floyd-Warshall is a good idea if you want paths.",
    "created_at": "2019-03-27T10:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384113",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:10'></a>What is your objective: get distances or get paths ? For distances, you can use boost. For paths, this is another story, and you will have to code a specific algorithm. However, I'm not convinced that using Floyd-Warshall is a good idea if you want paths.



---

archive/issue_comments_384114.json:
```json
{
    "body": "<a id='comment:11'></a>The current implementation has the option to also return the shortest paths between every two vertices. My objective is to preserve this feature. Would it be a good idea to reimplement Johnson's algorithm in Cython to be able to do this efficiently?",
    "created_at": "2019-03-27T10:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384114",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:11'></a>The current implementation has the option to also return the shortest paths between every two vertices. My objective is to preserve this feature. Would it be a good idea to reimplement Johnson's algorithm in Cython to be able to do this efficiently?



---

archive/issue_comments_384115.json:
```json
{
    "body": "<a id='comment:12'></a>Unless I'm mistaken, the methods don't return paths but the matrix of predecessors.\nGiven a matrix (or dict of dict) of distances, you can find the predecessors. For a source vertex s, for a vertex v, you find the neighbor u of v that is on a shortest s-v path by checking which vertex u is such that `d(s, u) + w(u, v) = d(s, v)`. So it should be easy to add the functionality to the method implemented with boost.",
    "created_at": "2019-03-27T16:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384115",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:12'></a>Unless I'm mistaken, the methods don't return paths but the matrix of predecessors.
Given a matrix (or dict of dict) of distances, you can find the predecessors. For a source vertex s, for a vertex v, you find the neighbor u of v that is on a shortest s-v path by checking which vertex u is such that `d(s, u) + w(u, v) = d(s, v)`. So it should be easy to add the functionality to the method implemented with boost.



---

archive/issue_comments_384116.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 dcoudert]:\n> Unless I'm mistaken, the methods don't return paths but the matrix of predecessors.\n> Given a matrix (or dict of dict) of distances, you can find the predecessors. For a source vertex s, for a vertex v, you find the neighbor u of v that is on a shortest s-v path by checking which vertex u is such that `d(s, u) + w(u, v) = d(s, v)`. So it should be easy to add the functionality to the method implemented with boost.\n\n\nBut isn't this going to be O(V<sup>3</sup>)?",
    "created_at": "2019-03-27T19:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384116",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:13'></a>Replying to [comment:12 dcoudert]:
> Unless I'm mistaken, the methods don't return paths but the matrix of predecessors.
> Given a matrix (or dict of dict) of distances, you can find the predecessors. For a source vertex s, for a vertex v, you find the neighbor u of v that is on a shortest s-v path by checking which vertex u is such that `d(s, u) + w(u, v) = d(s, v)`. So it should be easy to add the functionality to the method implemented with boost.


But isn't this going to be O(V<sup>3</sup>)?



---

archive/issue_comments_384117.json:
```json
{
    "body": "<a id='comment:14'></a>It will be O(N.M) with a small constants...",
    "created_at": "2019-03-27T22:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384117",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:14'></a>It will be O(N.M) with a small constants...



---

archive/issue_comments_384118.json:
```json
{
    "body": "<a id='comment:15'></a>Ok. Here is what I am planning to do in the next couple of days:\\\\\n\n1) Expose the boost implementation of Floyd-Warshall in Sagemath\\\\\n2) Modify johnson_shortest_paths() to return the predecessors matrix\\\\\n3) Create a new method for all pairs shortest paths where the user will be able to select the algorithm used (like in shortest_paths method in ` src/sage/graphs/base/boost_graph.pyx `).\\\\\n\nPlease let me know if there are any problems or pitfalls with what I proposed above.",
    "created_at": "2019-03-27T23:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384118",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:15'></a>Ok. Here is what I am planning to do in the next couple of days:\\

1) Expose the boost implementation of Floyd-Warshall in Sagemath\\
2) Modify johnson_shortest_paths() to return the predecessors matrix\\
3) Create a new method for all pairs shortest paths where the user will be able to select the algorithm used (like in shortest_paths method in ` src/sage/graphs/base/boost_graph.pyx `).\\

Please let me know if there are any problems or pitfalls with what I proposed above.



---

archive/issue_comments_384119.json:
```json
{
    "body": "<a id='comment:16'></a>> 1) Expose the boost implementation of Floyd-Warshall in Sagemath\\\\\n> 2) Modify johnson_shortest_paths() to return the predecessors matrix\\\\\n\nOK\n\n> 3) Create a new method for all pairs shortest paths where the user will be able to select the algorithm used (like in shortest_paths method in ` src/sage/graphs/base/boost_graph.pyx `).\\\\\n\nHave you checked the documentation of method `shortest_path_all_pairs` ? it already returns distances and predecessors matrix for different algorithms.",
    "created_at": "2019-03-28T07:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384119",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:16'></a>> 1) Expose the boost implementation of Floyd-Warshall in Sagemath\\
> 2) Modify johnson_shortest_paths() to return the predecessors matrix\\

OK

> 3) Create a new method for all pairs shortest paths where the user will be able to select the algorithm used (like in shortest_paths method in ` src/sage/graphs/base/boost_graph.pyx `).\\

Have you checked the documentation of method `shortest_path_all_pairs` ? it already returns distances and predecessors matrix for different algorithms.



---

archive/issue_comments_384120.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-30T17:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384120",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384121.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-30T23:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384121",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384122.json:
```json
{
    "body": "<a id='comment:19'></a>- please ensure that comments and documentation are in 80 column modes. See the developer manual\n\n- for building the distance dict, why not using the previous code ?\n\n```\n     dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])\n                     for w in range(N) if result[v][w] != sys.float_info.max}\n             for v in range(N)}\n```\n\n- for building the predecessor dict, it's a pitty not using the boost graph that has already been build and that contains the correct edge weights. I agree it's much more complicated and requires to extend `boost_interface.cpp` to expose other methods in order to iterate over weighted edges.\n\n  Also, the pseudo code I have in mind is more like\n\n```\nfor i, j, w in g.edges():\n    for k in range(N):\n        if result[k][j] == result[k][i] + w:\n            pred[k][j] = i\n        if not directed and result[k][i] == result[k][j] + w:\n            pred[k][i] = j\n```\n\n  It's only the pseudo-code and it must be improved, but it should give a simpler code.\n\nSo please check what can be done with boost graphs. It might not be so difficult to use, and should lead to much faster code.",
    "created_at": "2019-03-31T16:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384122",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:19'></a>- please ensure that comments and documentation are in 80 column modes. See the developer manual

- for building the distance dict, why not using the previous code ?

```
     dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])
                     for w in range(N) if result[v][w] != sys.float_info.max}
             for v in range(N)}
```

- for building the predecessor dict, it's a pitty not using the boost graph that has already been build and that contains the correct edge weights. I agree it's much more complicated and requires to extend `boost_interface.cpp` to expose other methods in order to iterate over weighted edges.

  Also, the pseudo code I have in mind is more like

```
for i, j, w in g.edges():
    for k in range(N):
        if result[k][j] == result[k][i] + w:
            pred[k][j] = i
        if not directed and result[k][i] == result[k][j] + w:
            pred[k][i] = j
```

  It's only the pseudo-code and it must be improved, but it should give a simpler code.

So please check what can be done with boost graphs. It might not be so difficult to use, and should lead to much faster code.



---

archive/issue_comments_384123.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-31T17:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384123",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384124.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:19 dcoudert]:\n> \n> - please ensure that comments and documentation are in 80 column modes. See the developer manual\n \n\\\\\nFixed all errors\n\n\\\\\n> - for building the distance dict, why not using the previous code ?\n> \n> ```\n>      dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])\n>                      for w in range(N) if result[v][w] != sys.float_info.max}\n>              for v in range(N)}\n> ```\n\n\\\\\nChanged back to the previous code\n\n\\\\\n>   Also, the pseudo code I have in mind is more like\n\n> {{{\n> for i, j, w in g.edges():\n>     for k in range(N):\n>         if result[k][j] == result[k][i] + w:\n>             pred[k][j] = i\n>         if not directed and result[k][i] == result[k][j] + w:\n>             pred[k][i] = j\n> }}}\n> \n>   It's only the pseudo-code and it must be improved, but it should give a simpler code.\n> \n\n\\\\\nI adapted the pseudocode to my implementation. I will do some research on boost graphs and try to come up with a faster implementation using boost interface.",
    "created_at": "2019-03-31T17:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384124",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:21'></a>Replying to [comment:19 dcoudert]:
> 
> - please ensure that comments and documentation are in 80 column modes. See the developer manual
 
\\
Fixed all errors

\\
> - for building the distance dict, why not using the previous code ?
> 
> ```
>      dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])
>                      for w in range(N) if result[v][w] != sys.float_info.max}
>              for v in range(N)}
> ```

\\
Changed back to the previous code

\\
>   Also, the pseudo code I have in mind is more like

> {{{
> for i, j, w in g.edges():
>     for k in range(N):
>         if result[k][j] == result[k][i] + w:
>             pred[k][j] = i
>         if not directed and result[k][i] == result[k][j] + w:
>             pred[k][i] = j
> }}}
> 
>   It's only the pseudo-code and it must be improved, but it should give a simpler code.
> 

\\
I adapted the pseudocode to my implementation. I will do some research on boost graphs and try to come up with a faster implementation using boost interface.



---

archive/issue_comments_384125.json:
```json
{
    "body": "<a id='comment:22'></a>Some comments on the current code. Of course, a version directly using boost could be better.\n\n- add an empty line between each input parameter, e.g., before\n\n```\n+    - ``predecessors`` -- boolean (default: ``False``); whether to return the\n```\n\n\n- you can type some variables. For instance\n\n```diff\n-    dist = {}\n-    pred = {}\n+    cdef dict dist = {}\n+    cdef dict pred = {}\n```\n\n- you can improve the alignment (although I'm not fully sure of the correct pep8 for this one)\n\n```diff\n-        dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])\n-                     for w in range(N) if result[v][w] != sys.float_info.max}\n-             for v in range(N)}\n+        dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])\n+                              for w in range(N) if result[v][w] != sys.float_info.max}\n+                for v in range(N)}\n```\n\n- you could define integer variables for `v_to_int[u]`, `v_to_int[v]`\n\n- add a space after `#` in `+            #dst is the weight of the edge (e[0], e[1])`\n\n- no `;` at the end of `+                    continue;`\n\n- use 2 lines for `+                if g.is_directed(): continue`",
    "created_at": "2019-04-01T21:47:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384125",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:22'></a>Some comments on the current code. Of course, a version directly using boost could be better.

- add an empty line between each input parameter, e.g., before

```
+    - ``predecessors`` -- boolean (default: ``False``); whether to return the
```


- you can type some variables. For instance

```diff
-    dist = {}
-    pred = {}
+    cdef dict dist = {}
+    cdef dict pred = {}
```

- you can improve the alignment (although I'm not fully sure of the correct pep8 for this one)

```diff
-        dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])
-                     for w in range(N) if result[v][w] != sys.float_info.max}
-             for v in range(N)}
+        dist = {int_to_v[v]: {int_to_v[w]: correct_type(result[v][w])
+                              for w in range(N) if result[v][w] != sys.float_info.max}
+                for v in range(N)}
```

- you could define integer variables for `v_to_int[u]`, `v_to_int[v]`

- add a space after `#` in `+            #dst is the weight of the edge (e[0], e[1])`

- no `;` at the end of `+                    continue;`

- use 2 lines for `+                if g.is_directed(): continue`



---

archive/issue_comments_384126.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-02T14:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384126",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384127.json:
```json
{
    "body": "<a id='comment:24'></a>Fixed. I will now expose boost Floyd Warshall algorithm implementation to [SageMath](SageMath) and then try to use boost to speed up both these methods.",
    "created_at": "2019-04-02T14:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384127",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:24'></a>Fixed. I will now expose boost Floyd Warshall algorithm implementation to [SageMath](SageMath) and then try to use boost to speed up both these methods.



---

archive/issue_comments_384128.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-02T16:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384128",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384129.json:
```json
{
    "body": "<a id='comment:26'></a>I think the main difficulty with boost is to understand how to iterate over weighted edges... and possibly also over vertices.",
    "created_at": "2019-04-02T16:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384129",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:26'></a>I think the main difficulty with boost is to understand how to iterate over weighted edges... and possibly also over vertices.



---

archive/issue_comments_384130.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 dcoudert]:\n> I think the main difficulty with boost is to understand how to iterate over weighted edges... and possibly also over vertices.\n\n\nThis is true. That's why I finished with everything else so as to spend some time working just on this one.",
    "created_at": "2019-04-02T16:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384130",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:27'></a>Replying to [comment:26 dcoudert]:
> I think the main difficulty with boost is to understand how to iterate over weighted edges... and possibly also over vertices.


This is true. That's why I finished with everything else so as to spend some time working just on this one.



---

archive/issue_comments_384131.json:
```json
{
    "body": "<a id='comment:28'></a>can you:\n- ensure that comments and documentaiton are aligned in 80 columns mode. Not the case in Floyd Warshall at least\n\n- avoid double empty lines when only 1 is sufficient\n\n- add `cdef int u_int, v_int` in both methods\n\n- either find a way to iterate over the edges of the boost graph as already discussed, or at least use `for e in g.edge_iterator():` instead of `for e in g.edges():`. Indeed, `.edges()` sorts edges by default and we don't need that here.",
    "created_at": "2019-04-09T12:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384131",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:28'></a>can you:
- ensure that comments and documentaiton are aligned in 80 columns mode. Not the case in Floyd Warshall at least

- avoid double empty lines when only 1 is sufficient

- add `cdef int u_int, v_int` in both methods

- either find a way to iterate over the edges of the boost graph as already discussed, or at least use `for e in g.edge_iterator():` instead of `for e in g.edges():`. Indeed, `.edges()` sorts edges by default and we don't need that here.



---

archive/issue_comments_384132.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-09T14:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384132",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384133.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-09T14:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384133",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384134.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:28 dcoudert]:\n> can you:\n> - ensure that comments and documentaiton are aligned in 80 columns mode. Not the case in Floyd Warshall at least\n> \n> - avoid double empty lines when only 1 is sufficient\n> \n> - add `cdef int u_int, v_int` in both methods\n> \n> - either find a way to iterate over the edges of the boost graph as already discussed, or at least use `for e in g.edge_iterator():` instead of `for e in g.edges():`. Indeed, `.edges()` sorts edges by default and we don't need that here.\n \n\\\\\nI think I fixed everything. If you find anything wrong please let me know.",
    "created_at": "2019-04-09T14:15:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384134",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:31'></a>Replying to [comment:28 dcoudert]:
> can you:
> - ensure that comments and documentaiton are aligned in 80 columns mode. Not the case in Floyd Warshall at least
> 
> - avoid double empty lines when only 1 is sufficient
> 
> - add `cdef int u_int, v_int` in both methods
> 
> - either find a way to iterate over the edges of the boost graph as already discussed, or at least use `for e in g.edge_iterator():` instead of `for e in g.edges():`. Indeed, `.edges()` sorts edges by default and we don't need that here.
 
\\
I think I fixed everything. If you find anything wrong please let me know.



---

archive/issue_comments_384135.json:
```json
{
    "body": "<a id='comment:32'></a>- this statement is incorrect as edge weights are not always 1. Better to say that `w` is a predecessor of `v` on a shortest path from `u` to `v`. \n\n```\n+    `v` and ``predecessors[u][v]`` denotes a neighbor `w` of `v` such that\n+    `dist(u,v) = 1 + dist(u,w)`.\n```\n\n- pep8\n\n```diff\n-        pred = {v : {v : None} for v in g}\n+        pred = {v: {v: None} for v in g}\n```\n\n- why are you using `cpdef`. Any particular reason for that ? `cdef` might be enough here, no ?\n\n- no need for `dst = 0` as you assign another value to dst just after\n\n- To avoid code ducplication, you could have a method that, given the graph, the `result`, and all needed parameters, return the predecessor matrix.",
    "created_at": "2019-04-10T09:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384135",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:32'></a>- this statement is incorrect as edge weights are not always 1. Better to say that `w` is a predecessor of `v` on a shortest path from `u` to `v`. 

```
+    `v` and ``predecessors[u][v]`` denotes a neighbor `w` of `v` such that
+    `dist(u,v) = 1 + dist(u,w)`.
```

- pep8

```diff
-        pred = {v : {v : None} for v in g}
+        pred = {v: {v: None} for v in g}
```

- why are you using `cpdef`. Any particular reason for that ? `cdef` might be enough here, no ?

- no need for `dst = 0` as you assign another value to dst just after

- To avoid code ducplication, you could have a method that, given the graph, the `result`, and all needed parameters, return the predecessor matrix.



---

archive/issue_comments_384136.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-10T11:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384136",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384137.json:
```json
{
    "body": "<a id='comment:34'></a>`get_predecessors`:\n- you can shorten the text like\n\n```diff\n-    Given the shortest distances between all pairs of vertices in a graph return\n-    the predecessors matrix.\n+    Return the predecessor matrix from the distance matrix of the graph.\n```\n\n- I propose to simplify the weight function definition and to force to give one. So for the text:\n\n```\n    - ``weight_function`` -- function; a function that takes as input an edge\n      ``(u, v, l)`` and outputs its weight. If ``weight_function`` is ``None``\n      and the graph is weighted, then use the edge weight. Otherwise all edges\n      have weight 1.\n```\n\n- output\n\n```\nA dictionary of dictionaries ``pred`` such that ``pred[u][v]`` indicates the predecessor  of `v` in the shortest path from `u` to `v`.\n```\n\n- don't do `import sys` inside the loop. If you need it, do that before the loop.\n\n\n`johnson_shortest_paths`:\n- improvement\n\n```diff\n-    `v` and ``predecessors[u][v]`` denotes a neighbor `w` of `v` such that\n-    it lies on the shortest path from `u` to `v`.\n+    `v` and ``predecessors[u][v]`` indicates the predecessor of `w` on a\n+    shortest path from `u` to `v`.\n```\n\n\n`floyd_warshall_shortest_paths`:\n- avoid double blank lines\n\n- output: same comment than above\n\n\nIn `generic_graph.py`, method `shortest_path_all_pairs`: you must update the output section by removing the note on Johnson algorithm.\n\n\nHave you tried to use the boost graph to iterate over edges, get edge weights, etc. ?\nIt's a pity to use the weight function in `get_predecessors` when all weights with correct value are recorded on the edges of the boost graph.",
    "created_at": "2019-04-12T09:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384137",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:34'></a>`get_predecessors`:
- you can shorten the text like

```diff
-    Given the shortest distances between all pairs of vertices in a graph return
-    the predecessors matrix.
+    Return the predecessor matrix from the distance matrix of the graph.
```

- I propose to simplify the weight function definition and to force to give one. So for the text:

```
    - ``weight_function`` -- function; a function that takes as input an edge
      ``(u, v, l)`` and outputs its weight. If ``weight_function`` is ``None``
      and the graph is weighted, then use the edge weight. Otherwise all edges
      have weight 1.
```

- output

```
A dictionary of dictionaries ``pred`` such that ``pred[u][v]`` indicates the predecessor  of `v` in the shortest path from `u` to `v`.
```

- don't do `import sys` inside the loop. If you need it, do that before the loop.


`johnson_shortest_paths`:
- improvement

```diff
-    `v` and ``predecessors[u][v]`` denotes a neighbor `w` of `v` such that
-    it lies on the shortest path from `u` to `v`.
+    `v` and ``predecessors[u][v]`` indicates the predecessor of `w` on a
+    shortest path from `u` to `v`.
```


`floyd_warshall_shortest_paths`:
- avoid double blank lines

- output: same comment than above


In `generic_graph.py`, method `shortest_path_all_pairs`: you must update the output section by removing the note on Johnson algorithm.


Have you tried to use the boost graph to iterate over edges, get edge weights, etc. ?
It's a pity to use the weight function in `get_predecessors` when all weights with correct value are recorded on the edges of the boost graph.



---

archive/issue_comments_384138.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-12T21:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384138",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384139.json:
```json
{
    "body": "<a id='comment:36'></a>Fixed everything. Tomorrow I will try to use boost edge iterator in `get_predecessors`.",
    "created_at": "2019-04-12T21:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384139",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:36'></a>Fixed everything. Tomorrow I will try to use boost edge iterator in `get_predecessors`.



---

archive/issue_comments_384140.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-12T22:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384140",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384141.json:
```json
{
    "body": "<a id='comment:38'></a>any progress on using boost edge iterator ?\n\nin your last commit, you remove the empty line before `.. NOTE::`. Please put it back.",
    "created_at": "2019-04-20T09:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384141",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:38'></a>any progress on using boost edge iterator ?

in your last commit, you remove the empty line before `.. NOTE::`. Please put it back.



---

archive/issue_comments_384142.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:38 dcoudert]:\n> any progress on using boost edge iterator ?\n> \n> in your last commit, you remove the empty line before `.. NOTE::`. Please put it back.\n>  \n\nI'm working on it. I will probably have it ready in the next 3-4 days.",
    "created_at": "2019-04-20T18:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384142",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:39'></a>Replying to [comment:38 dcoudert]:
> any progress on using boost edge iterator ?
> 
> in your last commit, you remove the empty line before `.. NOTE::`. Please put it back.
>  

I'm working on it. I will probably have it ready in the next 3-4 days.



---

archive/issue_comments_384143.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-30T16:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384143",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384144.json:
```json
{
    "body": "<a id='comment:41'></a>I am sorry for the delay but I think I fixed it. Now `get_predecessors` uses boost edge iterator. Please let me know if there is anything else that needs to be done.",
    "created_at": "2019-04-30T16:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384144",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:41'></a>I am sorry for the delay but I think I fixed it. Now `get_predecessors` uses boost edge iterator. Please let me know if there is anything else that needs to be done.



---

archive/issue_comments_384145.json:
```json
{
    "body": "<a id='comment:42'></a>Good news !\n\nPlease check that it's working well for directed and undirected graphs (add appropriate doctests). You might have a type problem when calling `get_predecessor`.",
    "created_at": "2019-04-30T16:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384145",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:42'></a>Good news !

Please check that it's working well for directed and undirected graphs (add appropriate doctests). You might have a type problem when calling `get_predecessor`.



---

archive/issue_comments_384146.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-30T16:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384146",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384147.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [comment:42 dcoudert]:\n> Good news !\n> \n> Please check that it's working well for directed and undirected graphs (add appropriate doctests). You might have a type problem when calling `get_predecessor`. \n\n\nRunning some tests seem to produce the right answer. I did, however, pass the correct edge type to `get_predecessors` and cast all edge weights to that type.\n\n---\nNew commits:",
    "created_at": "2019-04-30T16:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384147",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:44'></a>Replying to [comment:42 dcoudert]:
> Good news !
> 
> Please check that it's working well for directed and undirected graphs (add appropriate doctests). You might have a type problem when calling `get_predecessor`. 


Running some tests seem to produce the right answer. I did, however, pass the correct edge type to `get_predecessors` and cast all edge weights to that type.

---
New commits:



---

archive/issue_comments_384148.json:
```json
{
    "body": "<a id='comment:45'></a>in method `get_predecessors`:\n- `int_to_v` is a list, so please update the description of input parameters and do:\n\n```diff\n-    pred = {int_to_v[i]: {int_to_v[i]: None} for i in range(0, N)}\n+    cdef dict pred = {v: {v: None} for v in int_to_v}\n``` \n\nin `floyd_warshall_shortest_paths`\n- ensure that all comments are in 80 columns mode\n- in the call `pred = get_predecessors(g_boost_dir, result, int_to_v, directed=True, weight_type=correct_type)`, there is no need for `directed=` and `weight_type=` as these parameters are not optional",
    "created_at": "2019-05-01T17:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384148",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:45'></a>in method `get_predecessors`:
- `int_to_v` is a list, so please update the description of input parameters and do:

```diff
-    pred = {int_to_v[i]: {int_to_v[i]: None} for i in range(0, N)}
+    cdef dict pred = {v: {v: None} for v in int_to_v}
``` 

in `floyd_warshall_shortest_paths`
- ensure that all comments are in 80 columns mode
- in the call `pred = get_predecessors(g_boost_dir, result, int_to_v, directed=True, weight_type=correct_type)`, there is no need for `directed=` and `weight_type=` as these parameters are not optional



---

archive/issue_comments_384149.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-01T21:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384149",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384150.json:
```json
{
    "body": "<a id='comment:47'></a>don't forget to ensure that comments and documentation are in 80 columns mode. For instance, this is not\n\n```\n+    - ``distances`` -- boolean (default: ``True``); whether to return the dictionary\n```",
    "created_at": "2019-05-03T16:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384150",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:47'></a>don't forget to ensure that comments and documentation are in 80 columns mode. For instance, this is not

```
+    - ``distances`` -- boolean (default: ``True``); whether to return the dictionary
```



---

archive/issue_comments_384151.json:
```json
{
    "body": "<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-03T16:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384151",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384152.json:
```json
{
    "body": "<a id='comment:49'></a>in `johnson_shortest_paths` too ;)",
    "created_at": "2019-05-03T18:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384152",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:49'></a>in `johnson_shortest_paths` too ;)



---

archive/issue_comments_384153.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 dcoudert]:\n> in `johnson_shortest_paths` too ;)\n\n\nAre you sure there is a problem with `johnson_shortest_paths`? (I think I fixed everything in the previous commit)",
    "created_at": "2019-05-03T19:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384153",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:50'></a>Replying to [comment:49 dcoudert]:
> in `johnson_shortest_paths` too ;)


Are you sure there is a problem with `johnson_shortest_paths`? (I think I fixed everything in the previous commit)



---

archive/issue_comments_384154.json:
```json
{
    "body": "<a id='comment:51'></a>I think this line for instance has length more that 80 \n\n```\n+    ``(distances, predecessors)`` where ``distance[u][v]`` denotes the distance of \n```",
    "created_at": "2019-05-04T08:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384154",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:51'></a>I think this line for instance has length more that 80 

```
+    ``(distances, predecessors)`` where ``distance[u][v]`` denotes the distance of 
```



---

archive/issue_comments_384155.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-04T11:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384155",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384156.json:
```json
{
    "body": "<a id='comment:53'></a>Replying to [comment:51 dcoudert]:\n> I think this line for instance has length more that 80 \n> \n> ```\n> +    ``(distances, predecessors)`` where ``distance[u][v]`` denotes the distance of \n> ```\n\nYou are right. Everything should be ok now (I think).",
    "created_at": "2019-05-04T11:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384156",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:53'></a>Replying to [comment:51 dcoudert]:
> I think this line for instance has length more that 80 
> 
> ```
> +    ``(distances, predecessors)`` where ``distance[u][v]`` denotes the distance of 
> ```

You are right. Everything should be ok now (I think).



---

archive/issue_comments_384157.json:
```json
{
    "body": "<a id='comment:54'></a>You still have to expose methods `floyd_warshall_shortest_paths` and `johnson_shortest_paths` from method `shortest_path_all_pairs` of `generic_graph.py`. \n\nDon't forget to add required doctests.",
    "created_at": "2019-05-04T12:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384157",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:54'></a>You still have to expose methods `floyd_warshall_shortest_paths` and `johnson_shortest_paths` from method `shortest_path_all_pairs` of `generic_graph.py`. 

Don't forget to add required doctests.



---

archive/issue_comments_384158.json:
```json
{
    "body": "<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-04T13:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384158",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384159.json:
```json
{
    "body": "<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-04T13:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384159",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384160.json:
```json
{
    "body": "<a id='comment:57'></a>I have rebased the branch on the last beta version and fixed the merge conflicts.\nI pushed a new branch. It is in `public/`, so you can access and modify it.\n\nPlease check that it's working well.\n\n---\nNew commits:",
    "created_at": "2019-05-06T16:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384160",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:57'></a>I have rebased the branch on the last beta version and fixed the merge conflicts.
I pushed a new branch. It is in `public/`, so you can access and modify it.

Please check that it's working well.

---
New commits:



---

archive/issue_comments_384161.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-08T15:48:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384162.json:
```json
{
    "body": "<a id='comment:59'></a>For me this patch is good to go. I'm waiting confirmation from your side.",
    "created_at": "2019-05-08T15:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384162",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:59'></a>For me this patch is good to go. I'm waiting confirmation from your side.



---

archive/issue_comments_384163.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:59 dcoudert]:\n> For me this patch is good to go. I'm waiting confirmation from your side.\n\nAfter some testing everything seems to work as expected so it is indeed good to go.",
    "created_at": "2019-05-08T15:55:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384163",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:60'></a>Replying to [comment:59 dcoudert]:
> For me this patch is good to go. I'm waiting confirmation from your side.

After some testing everything seems to work as expected so it is indeed good to go.



---

archive/issue_comments_384164.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-09T07:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384164",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_384165.json:
```json
{
    "body": "<a id='comment:61'></a>Please add your real name in `Authors` field.\n\nLGTM.",
    "created_at": "2019-05-09T07:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384165",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:61'></a>Please add your real name in `Authors` field.

LGTM.



---

archive/issue_comments_384166.json:
```json
{
    "body": "<a id='comment:63'></a>Docbuild fails, see patchbot",
    "created_at": "2019-05-12T21:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384166",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:63'></a>Docbuild fails, see patchbot



---

archive/issue_comments_384167.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-05-12T21:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384167",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_384168.json:
```json
{
    "body": "<a id='comment:64'></a>Just to make things clear, that is the failure I see\n\n```\nError building the documentation.\nmultiprocessing.pool.RemoteTraceback:\n\"\"\"\nTraceback (most recent call last):\n  File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 121, in worker\n    result = (True, func(*args, **kwds))\n  File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 44, in mapstar\n    return list(map(*args))\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 79, in build_ref_doc\n    getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 761, in _wrapper\n    getattr(DocBuilder, build_type)(self, *args, **kwds)\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 133, in f\n    runsphinx()\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py\", line 317, in runsphinx\n    sys.stderr.raise_errors()\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py\", line 252, in raise_errors\n    raise OSError(self._error)\nOSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.\n\"\"\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"sage_setup/docbuild/__main__.py\", line 2, in <module>\n    main()\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 1730, in main\n    builder()\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 351, in _wrapper\n    getattr(get_builder(document), 'inventory')(*args, **kwds)\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 547, in _wrapper\n    build_many(build_ref_doc, L)\n  File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 288, in build_many\n    ret = x.get(99999)\n  File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 657, in get\n    raise self._value\nOSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.\n```\nit looks like a stray space at the start of line 1085 of `sage/graphs/base/boost_graph.pyx` [https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085) is the cause of the problem. Removing it makes the documentation build here.",
    "created_at": "2019-05-13T00:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384168",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'></a>Just to make things clear, that is the failure I see

```
Error building the documentation.
multiprocessing.pool.RemoteTraceback:
"""
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/pool.py", line 121, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.7/multiprocessing/pool.py", line 44, in mapstar
    return list(map(*args))
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 79, in build_ref_doc
    getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 761, in _wrapper
    getattr(DocBuilder, build_type)(self, *args, **kwds)
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 133, in f
    runsphinx()
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py", line 317, in runsphinx
    sys.stderr.raise_errors()
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py", line 252, in raise_errors
    raise OSError(self._error)
OSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "sage_setup/docbuild/__main__.py", line 2, in <module>
    main()
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 1730, in main
    builder()
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 351, in _wrapper
    getattr(get_builder(document), 'inventory')(*args, **kwds)
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 547, in _wrapper
    build_many(build_ref_doc, L)
  File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 288, in build_many
    ret = x.get(99999)
  File "/usr/lib/python3.7/multiprocessing/pool.py", line 657, in get
    raise self._value
OSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.
```
it looks like a stray space at the start of line 1085 of `sage/graphs/base/boost_graph.pyx` [https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085) is the cause of the problem. Removing it makes the documentation build here.



---

archive/issue_comments_384169.json:
```json
{
    "body": "<a id='comment:65'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-13T08:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_384170.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:64 fbissey]:\n> Just to make things clear, that is the failure I see\n> \n> ```\n> Error building the documentation.\n> multiprocessing.pool.RemoteTraceback:\n> \"\"\"\n> Traceback (most recent call last):\n>   File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 121, in worker\n>     result = (True, func(*args, **kwds))\n>   File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 44, in mapstar\n>     return list(map(*args))\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 79, in build_ref_doc\n>     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 761, in _wrapper\n>     getattr(DocBuilder, build_type)(self, *args, **kwds)\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 133, in f\n>     runsphinx()\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py\", line 317, in runsphinx\n>     sys.stderr.raise_errors()\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py\", line 252, in raise_errors\n>     raise OSError(self._error)\n> OSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.\n> \"\"\"\n> \n> The above exception was the direct cause of the following exception:\n> \n> Traceback (most recent call last):\n>   File \"sage_setup/docbuild/__main__.py\", line 2, in <module>\n>     main()\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 1730, in main\n>     builder()\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 351, in _wrapper\n>     getattr(get_builder(document), 'inventory')(*args, **kwds)\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 547, in _wrapper\n>     build_many(build_ref_doc, L)\n>   File \"/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py\", line 288, in build_many\n>     ret = x.get(99999)\n>   File \"/usr/lib/python3.7/multiprocessing/pool.py\", line 657, in get\n>     raise self._value\n> OSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.\n> ```\n> it looks like a stray space at the start of line 1085 of `sage/graphs/base/boost_graph.pyx` [https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085) is the cause of the problem. Removing it makes the documentation build here.\n\n\nThank you for the info. Fixed it!",
    "created_at": "2019-05-13T08:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384170",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:66'></a>Replying to [comment:64 fbissey]:
> Just to make things clear, that is the failure I see
> 
> ```
> Error building the documentation.
> multiprocessing.pool.RemoteTraceback:
> """
> Traceback (most recent call last):
>   File "/usr/lib/python3.7/multiprocessing/pool.py", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File "/usr/lib/python3.7/multiprocessing/pool.py", line 44, in mapstar
>     return list(map(*args))
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 79, in build_ref_doc
>     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 761, in _wrapper
>     getattr(DocBuilder, build_type)(self, *args, **kwds)
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 133, in f
>     runsphinx()
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py", line 317, in runsphinx
>     sys.stderr.raise_errors()
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/sphinxbuild.py", line 252, in raise_errors
>     raise OSError(self._error)
> OSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.
> """
> 
> The above exception was the direct cause of the following exception:
> 
> Traceback (most recent call last):
>   File "sage_setup/docbuild/__main__.py", line 2, in <module>
>     main()
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 1730, in main
>     builder()
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 351, in _wrapper
>     getattr(get_builder(document), 'inventory')(*args, **kwds)
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 547, in _wrapper
>     build_many(build_ref_doc, L)
>   File "/dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/sage_setup/docbuild/__init__.py", line 288, in build_many
>     ret = x.get(99999)
>   File "/usr/lib/python3.7/multiprocessing/pool.py", line 657, in get
>     raise self._value
> OSError: docstring of sage.graphs.base.boost_graph.johnson_shortest_paths:18: WARNING: Definition list ends without a blank line; unexpected unindent.
> ```
> it looks like a stray space at the start of line 1085 of `sage/graphs/base/boost_graph.pyx` [https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/graphs/base/boost_graph.pyx?id=136cae2e3fb5f6dec8173f427da3321d49b0a835#n1085) is the cause of the problem. Removing it makes the documentation build here.


Thank you for the info. Fixed it!



---

archive/issue_comments_384171.json:
```json
{
    "body": "<a id='comment:67'></a>`@`fbissey: can you check if it's ok ? I have an issue building the documentation that is not related to this ticket. Thank you.",
    "created_at": "2019-05-13T16:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384171",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:67'></a>`@`fbissey: can you check if it's ok ? I have an issue building the documentation that is not related to this ticket. Thank you.



---

archive/issue_comments_384172.json:
```json
{
    "body": "<a id='comment:68'></a>All tests seem to pass now!",
    "created_at": "2019-05-14T12:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384172",
    "user": "https://github.com/giorgosgiapis"
}
```

<a id='comment:68'></a>All tests seem to pass now!



---

archive/issue_comments_384173.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-05-16T13:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384173",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_384174.json:
```json
{
    "body": "<a id='comment:69'></a>LGTM.",
    "created_at": "2019-05-16T13:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384174",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:69'></a>LGTM.



---

archive/issue_events_068344.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-21T12:15:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27518#event-68344"
}
```



---

archive/issue_comments_384175.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-05-21T12:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27518#issuecomment-384175",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
