# Issue 27973: Implement wedge over a face of Polyhedron

archive/issues_027736.json:
```json
{
    "assignees": [],
    "body": "From \u200b\u200bhttps://www.csun.edu/~ctoth/Handbook/chap15.pdf:\n\nThe wedge over a facet `F` of a polytope `P` is defined as:\n\n`(P \\times \\mathbb{R}) \\cap \\{a^\\top x +|x_{d+1}| \\leq b\\}`\n\nwhere `F` is a facet defined by `a^\\top x leq b`.\n\nIt  has  dimension `d+1`, `m+1` facets, and `2n-n_F` vertices, if `F` has `n_F` vertices. More generally,  the wedge construction can be performed (defined by the same formula) for a face `F`.\n\nCC:  @jplab @LaisRast @kliem\n\nKeywords: **polytopes, days100, wedge, facet**\n\nBranch/Commit: **[38944ad](https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba)**\n\nReviewer: **Jean-Philippe Labb\u00e9**\n\nAuthor: **Laith Rastanawi, Jonathan Kliem**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27973_\n\n",
    "closed_at": "2019-09-05T21:33:25Z",
    "created_at": "2019-06-12T08:19:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement wedge over a face of Polyhedron",
    "type": "issue",
    "updated_at": "2019-09-05T21:33:25Z",
    "url": "https://github.com/sagemath/sage/issues/27973",
    "user": "https://github.com/jplab"
}
```
From ​​https://www.csun.edu/~ctoth/Handbook/chap15.pdf:

The wedge over a facet `F` of a polytope `P` is defined as:

`(P \times \mathbb{R}) \cap \{a^\top x +|x_{d+1}| \leq b\}`

where `F` is a facet defined by `a^\top x leq b`.

It  has  dimension `d+1`, `m+1` facets, and `2n-n_F` vertices, if `F` has `n_F` vertices. More generally,  the wedge construction can be performed (defined by the same formula) for a face `F`.

CC:  @jplab @LaisRast @kliem

Keywords: **polytopes, days100, wedge, facet**

Branch/Commit: **[38944ad](https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba)**

Reviewer: **Jean-Philippe Labbé**

Author: **Laith Rastanawi, Jonathan Kliem**

_Issue created by migration from https://trac.sagemath.org/ticket/27973_





---

archive/issue_events_365388.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-06-12T08:19:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365388"
}
```



---

archive/issue_events_365389.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-06-12T08:19:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365389"
}
```



---

archive/issue_events_365390.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-06-12T08:19:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365390"
}
```



---

archive/issue_events_365391.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-06-12T08:19:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365391"
}
```



---

archive/issue_comments_438036.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n The wedge over a facet `F` of a polytope `P` is defined as the product:\n \n-`P \\times \\mathbb{R}\\cap \\{a^\\top x +|x_{d+1} \\leq b|\\}`\n+`P \\times \\mathbb{R}\\cap \\{a^\\top x +|x_{d+1}| \\leq b\\}`\n \n where `F` is a facet defined by `a^\\top x leq b`.\n \n``````\n",
    "created_at": "2019-06-12T08:51:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438036",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 The wedge over a facet `F` of a polytope `P` is defined as the product:
 
-`P \times \mathbb{R}\cap \{a^\top x +|x_{d+1} \leq b|\}`
+`P \times \mathbb{R}\cap \{a^\top x +|x_{d+1}| \leq b\}`
 
 where `F` is a facet defined by `a^\top x leq b`.
 
``````




---

archive/issue_events_365392.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:55:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365392"
}
```



---

archive/issue_comments_438037.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438037",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'>Comment 2:</a>
As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_438038.json:
```json
{
    "body": "Changed keywords from **polytopes** to **polytopes, days100**",
    "created_at": "2019-07-22T16:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438038",
    "user": "https://github.com/jplab"
}
```

Changed keywords from **polytopes** to **polytopes, days100**



---

archive/issue_events_365393.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-23T13:49:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365393"
}
```



---

archive/issue_comments_438039.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0be5c632aec8c8c8164b73dcdbf66a4508a880b\">d0be5c6</a></td><td><code>add wedge method in Polyhedron class in base.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45bd3123afcafe3ef142e19bbb04f0d6ebda849e\">45bd312</a></td><td><code>NotImplementedError -> ValueError</code></td></tr></table>\n",
    "created_at": "2019-07-23T13:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438039",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:4'>Comment 4:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0be5c632aec8c8c8164b73dcdbf66a4508a880b">d0be5c6</a></td><td><code>add wedge method in Polyhedron class in base.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45bd3123afcafe3ef142e19bbb04f0d6ebda849e">45bd312</a></td><td><code>NotImplementedError -> ValueError</code></td></tr></table>




---

archive/issue_comments_438040.json:
```json
{
    "body": "Commit: **[45bd312](https://github.com/sagemath/sagetrac-mirror/commit/45bd3123afcafe3ef142e19bbb04f0d6ebda849e)**",
    "created_at": "2019-07-23T13:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438040",
    "user": "https://github.com/LaisRast"
}
```

Commit: **[45bd312](https://github.com/sagemath/sagetrac-mirror/commit/45bd3123afcafe3ef142e19bbb04f0d6ebda849e)**



---

archive/issue_comments_438041.json:
```json
{
    "body": "Author: **Laith Rastanawi**",
    "created_at": "2019-07-23T13:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438041",
    "user": "https://github.com/LaisRast"
}
```

Author: **Laith Rastanawi**



---

archive/issue_comments_438042.json:
```json
{
    "body": "Changed keywords from **polytopes, days100** to **polytopes, days100, wedge, facet**",
    "created_at": "2019-07-23T13:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438042",
    "user": "https://github.com/LaisRast"
}
```

Changed keywords from **polytopes, days100** to **polytopes, days100, wedge, facet**



---

archive/issue_comments_438043.json:
```json
{
    "body": "Branch: **[public/27973](https://github.com/sagemath/sagetrac-mirror/tree/public/27973)**",
    "created_at": "2019-07-23T13:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438043",
    "user": "https://github.com/LaisRast"
}
```

Branch: **[public/27973](https://github.com/sagemath/sagetrac-mirror/tree/public/27973)**



---

archive/issue_events_365394.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-23T13:51:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365394"
}
```



---

archive/issue_events_365395.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-23T13:51:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365395"
}
```



---

archive/issue_comments_438044.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nHi,\n\n* In the docstring, it usually starts with 1 sentence, and empty line and then further information about the method.\n\n* I would say that the width is a \"indication of how wide the wedge is taken around the face\". Said the current way, it makes it confusing about other potential notions around polytopes (lattice polytopes have widths...) So I would say: \"indication of how wide the resulted wedge should be\".\n\n* The doctests are not using the function as a method. \n\n* Replace the backtick by single quotes in the error messages.\n\n* `L = Polyhedron(rays=[[1],[-1]])` could be `Polyhedron(lines=[This is the Trac macro *1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1-macro))`\n\n* I would write `F_Hrep = list(F_Hrep)` after the for loop and replace in the creation of the polytope.\n\n* It would be good to test and show in examples combinatorial isomorphism type with a known polytope which is a wedge. For example the prism over a triangle is a wedge over a triangle. And the duals to cyclic 3-polytopes are wedges.",
    "created_at": "2019-07-23T14:23:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438044",
    "user": "https://github.com/jplab"
}
```

<a id='comment:6'>Comment 6:</a>
Hi,

* In the docstring, it usually starts with 1 sentence, and empty line and then further information about the method.

* I would say that the width is a "indication of how wide the wedge is taken around the face". Said the current way, it makes it confusing about other potential notions around polytopes (lattice polytopes have widths...) So I would say: "indication of how wide the resulted wedge should be".

* The doctests are not using the function as a method. 

* Replace the backtick by single quotes in the error messages.

* `L = Polyhedron(rays=[[1],[-1]])` could be `Polyhedron(lines=[This is the Trac macro *1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1-macro))`

* I would write `F_Hrep = list(F_Hrep)` after the for loop and replace in the creation of the polytope.

* It would be good to test and show in examples combinatorial isomorphism type with a known polytope which is a wedge. For example the prism over a triangle is a wedge over a triangle. And the duals to cyclic 3-polytopes are wedges.



---

archive/issue_events_365396.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-23T14:23:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365396"
}
```



---

archive/issue_events_365397.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-23T14:23:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365397"
}
```



---

archive/issue_comments_438045.json:
```json
{
    "body": "Changed commit from **[45bd312](https://github.com/sagemath/sagetrac-mirror/commit/45bd3123afcafe3ef142e19bbb04f0d6ebda849e)** to **[049e27d](https://github.com/sagemath/sagetrac-mirror/commit/049e27d49147ebf269a0d3267ae0dd32c1637e42)**",
    "created_at": "2019-07-23T15:07:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438045",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[45bd312](https://github.com/sagemath/sagetrac-mirror/commit/45bd3123afcafe3ef142e19bbb04f0d6ebda849e)** to **[049e27d](https://github.com/sagemath/sagetrac-mirror/commit/049e27d49147ebf269a0d3267ae0dd32c1637e42)**



---

archive/issue_comments_438046.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/049e27d49147ebf269a0d3267ae0dd32c1637e42\">049e27d</a></td><td><code>more examples and fix docstring</code></td></tr></table>\n",
    "created_at": "2019-07-23T15:07:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438046",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'>Comment 8:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/049e27d49147ebf269a0d3267ae0dd32c1637e42">049e27d</a></td><td><code>more examples and fix docstring</code></td></tr></table>




---

archive/issue_events_365398.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-23T15:09:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365398"
}
```



---

archive/issue_events_365399.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-23T15:09:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365399"
}
```



---

archive/issue_comments_438047.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@jplab](#comment%3A7):\n\nThanks. Done.",
    "created_at": "2019-07-23T15:09:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438047",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@jplab](#comment%3A7):

Thanks. Done.



---

archive/issue_comments_438048.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nSeems like there are tab character in reference/index.rst There seems to be many errors in the bot too...",
    "created_at": "2019-07-23T20:29:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438048",
    "user": "https://github.com/jplab"
}
```

<a id='comment:10'>Comment 10:</a>
Seems like there are tab character in reference/index.rst There seems to be many errors in the bot too...



---

archive/issue_comments_438049.json:
```json
{
    "body": "Changed commit from **[049e27d](https://github.com/sagemath/sagetrac-mirror/commit/049e27d49147ebf269a0d3267ae0dd32c1637e42)** to **[193e06b](https://github.com/sagemath/sagetrac-mirror/commit/193e06bd91b8cd16d8ec796fcae0ac91ee8b592a)**",
    "created_at": "2019-07-24T08:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438049",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[049e27d](https://github.com/sagemath/sagetrac-mirror/commit/049e27d49147ebf269a0d3267ae0dd32c1637e42)** to **[193e06b](https://github.com/sagemath/sagetrac-mirror/commit/193e06bd91b8cd16d8ec796fcae0ac91ee8b592a)**



---

archive/issue_comments_438050.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/193e06bd91b8cd16d8ec796fcae0ac91ee8b592a\">193e06b</a></td><td><code>tabs to spaces</code></td></tr></table>\n",
    "created_at": "2019-07-24T08:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438050",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/193e06bd91b8cd16d8ec796fcae0ac91ee8b592a">193e06b</a></td><td><code>tabs to spaces</code></td></tr></table>




---

archive/issue_comments_438051.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nThe description of the ticket is still only about facets.",
    "created_at": "2019-07-24T08:46:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438051",
    "user": "https://github.com/kliem"
}
```

<a id='comment:12'>Comment 12:</a>
The description of the ticket is still only about facets.



---

archive/issue_events_365400.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-07-24T08:54:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365400"
}
```



---

archive/issue_events_365401.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-07-24T08:54:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365401"
}
```



---

archive/issue_comments_438052.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nPlease preserve the backend and base ring as in #27926.",
    "created_at": "2019-07-24T08:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438052",
    "user": "https://github.com/kliem"
}
```

<a id='comment:13'>Comment 13:</a>
Please preserve the backend and base ring as in #27926.



---

archive/issue_comments_438053.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nActually, I think the backend might be preserved. (product and intersection might behave this way).\n\nCan you please check. Maybe add a doctest.\n\nHowever, in the intermediate steps you don't preserve the backend. This might cause issues with algebraic polyhedra.",
    "created_at": "2019-07-24T09:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438053",
    "user": "https://github.com/kliem"
}
```

<a id='comment:14'>Comment 14:</a>
Actually, I think the backend might be preserved. (product and intersection might behave this way).

Can you please check. Maybe add a doctest.

However, in the intermediate steps you don't preserve the backend. This might cause issues with algebraic polyhedra.



---

archive/issue_comments_438054.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@kliem](#comment%3A12):\n> The description of the ticket is still only about facets.\n\nNope. See last sentence of the description.",
    "created_at": "2019-07-24T10:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438054",
    "user": "https://github.com/jplab"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@kliem](#comment%3A12):
> The description of the ticket is still only about facets.

Nope. See last sentence of the description.



---

archive/issue_comments_438055.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@kliem](#comment%3A14):\n> Actually, I think the backend might be preserved. (product and intersection might behave this way).\n> \n> Can you please check. Maybe add a doctest.\n> \n> However, in the intermediate steps you don't preserve the backend. This might cause issues with algebraic polyhedra.\n\nThe backend and the basering are preserved as long as the value of `width` belongs to the basering of `self`. This is the case when `width` takes the default value. Otherwise, we have the following behavior\n\n```\nsage: P = polytopes.cyclic_polytope(3,7); P\nA 3-dimensional polyhedron in QQ^3 defined as the convex hull of 7 vertices\nsage: P.backend()\n'ppl'\nsage: P.wedge(P.faces(2)[0]).backend()\n'ppl'\nsage: P.wedge(P.faces(2)[0]).base_ring()\nRational Field\nsage: P.wedge(P.faces(2)[0], width=RDF(1)).backend()\ncdd\nsage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()\nReal Double Field\n```\nwhich I think is an acceptable behavior.",
    "created_at": "2019-07-24T13:32:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438055",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@kliem](#comment%3A14):
> Actually, I think the backend might be preserved. (product and intersection might behave this way).
> 
> Can you please check. Maybe add a doctest.
> 
> However, in the intermediate steps you don't preserve the backend. This might cause issues with algebraic polyhedra.

The backend and the basering are preserved as long as the value of `width` belongs to the basering of `self`. This is the case when `width` takes the default value. Otherwise, we have the following behavior

```
sage: P = polytopes.cyclic_polytope(3,7); P
A 3-dimensional polyhedron in QQ^3 defined as the convex hull of 7 vertices
sage: P.backend()
'ppl'
sage: P.wedge(P.faces(2)[0]).backend()
'ppl'
sage: P.wedge(P.faces(2)[0]).base_ring()
Rational Field
sage: P.wedge(P.faces(2)[0], width=RDF(1)).backend()
cdd
sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()
Real Double Field
```
which I think is an acceptable behavior.



---

archive/issue_comments_438056.json:
```json
{
    "body": "Changed commit from **[193e06b](https://github.com/sagemath/sagetrac-mirror/commit/193e06bd91b8cd16d8ec796fcae0ac91ee8b592a)** to **[417bfac](https://github.com/sagemath/sagetrac-mirror/commit/417bfac337f17e93494d8f31b9031f9311cee423)**",
    "created_at": "2019-07-24T13:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438056",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[193e06b](https://github.com/sagemath/sagetrac-mirror/commit/193e06bd91b8cd16d8ec796fcae0ac91ee8b592a)** to **[417bfac](https://github.com/sagemath/sagetrac-mirror/commit/417bfac337f17e93494d8f31b9031f9311cee423)**



---

archive/issue_comments_438057.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/417bfac337f17e93494d8f31b9031f9311cee423\">417bfac</a></td><td><code>add tests to check backend and basering</code></td></tr></table>\n",
    "created_at": "2019-07-24T13:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438057",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/417bfac337f17e93494d8f31b9031f9311cee423">417bfac</a></td><td><code>add tests to check backend and basering</code></td></tr></table>




---

archive/issue_comments_438058.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nThe examples you gave are not meaningful. ppl and cdd are the standard backends for the given ring.\n\nWhat about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).\n\nWhat about the examples of #25097. Do they work?\n\n(Sorry, still can't test it myself).\n\nReplying to [@LaisRast](#comment%3A16):\n> Replying to [@kliem](#comment%3A14):\n> > Actually, I think the backend might be preserved. (product and intersection might behave this way).\n> > \n> > Can you please check. Maybe add a doctest.\n> > \n> > However, in the intermediate steps you don't preserve the backend. This might cause issues with algebraic polyhedra.\n\n> \n> The backend and the basering are preserved as long as the value of `width` belongs to the basering of `self`. This is the case when `width` takes the default value. Otherwise, we have the following behavior\n> \n> ```\n> sage: P = polytopes.cyclic_polytope(3,7); P\n> A 3-dimensional polyhedron in QQ^3 defined as the convex hull of 7 vertices\n> sage: P.backend()\n> 'ppl'\n> sage: P.wedge(P.faces(2)[0]).backend()\n> 'ppl'\n> sage: P.wedge(P.faces(2)[0]).base_ring()\n> Rational Field\n> sage: P.wedge(P.faces(2)[0], width=RDF(1)).backend()\n> cdd\n> sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()\n> Real Double Field\n> ```\n> which I think is an acceptable behavior.",
    "created_at": "2019-07-24T14:21:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438058",
    "user": "https://github.com/kliem"
}
```

<a id='comment:18'>Comment 18:</a>
The examples you gave are not meaningful. ppl and cdd are the standard backends for the given ring.

What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).

What about the examples of #25097. Do they work?

(Sorry, still can't test it myself).

Replying to [@LaisRast](#comment%3A16):
> Replying to [@kliem](#comment%3A14):
> > Actually, I think the backend might be preserved. (product and intersection might behave this way).
> > 
> > Can you please check. Maybe add a doctest.
> > 
> > However, in the intermediate steps you don't preserve the backend. This might cause issues with algebraic polyhedra.

> 
> The backend and the basering are preserved as long as the value of `width` belongs to the basering of `self`. This is the case when `width` takes the default value. Otherwise, we have the following behavior
> 
> ```
> sage: P = polytopes.cyclic_polytope(3,7); P
> A 3-dimensional polyhedron in QQ^3 defined as the convex hull of 7 vertices
> sage: P.backend()
> 'ppl'
> sage: P.wedge(P.faces(2)[0]).backend()
> 'ppl'
> sage: P.wedge(P.faces(2)[0]).base_ring()
> Rational Field
> sage: P.wedge(P.faces(2)[0], width=RDF(1)).backend()
> cdd
> sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()
> Real Double Field
> ```
> which I think is an acceptable behavior.



---

archive/issue_comments_438059.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@kliem](#comment%3A18):\n> What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).\n> \n> What about the examples of #25097. Do they work?\n> \n> (Sorry, still can't test it myself).\n> \n\nThe polyhedron `H` is the responsible for changing the base ring and the backend. The following should fix the problem (up to change of base ring form ZZ to QQ, see `W2` below):\n\n```diff\n-    def wedge(self, face, width=1):\n+    def wedge(self, face, width=None):\n         r\"\"\"\n         Return the wedge over a ``face`` of the polytope ``self``.\n\n@@ -4205,6 +4205,10 @@ class Polyhedron_base(Element):\n             sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()\n             Real Double Field\n         \"\"\"\n+        if width is None:\n+            width = ZZ.one()\n+\n         if not self.is_compact():\n             raise ValueError(\"polyhedron 'self' must be a polytope\")\n\n@@ -4223,7 +4227,11 @@ class Polyhedron_base(Element):\n\n         L = Polyhedron(lines=[[1]])\n         Q = self.product(L)\n-        H = Polyhedron(ieqs=[F_Hrep + [width], F_Hrep + [-width]])\n+\n+        parent = self.parent().base_extend(width, ambient_dim=self.ambient_dim()+1)\n+        ieqs = [F_Hrep + [width], F_Hrep + [-width]]\n+        H = parent.element_class(parent, None, [ieqs, None])\n         return Q.intersection(H)\n\n```\n\nSome examples:\n\n```\nsage: P = polytopes.cyclic_polytope(3,7, base_ring=ZZ, backend='normaliz')\nsage: W1 = P.wedge(P.faces(2)[0]); W1.base_ring(); W1.backend()\nInteger Ring\n'normaliz'\nsage: W2 = P.wedge(P.faces(2)[0], width=5/2); W2.base_ring(); W2.backend()\nRational Field\n'normaliz'\nsage: W2 = P.wedge(P.faces(2)[0], width=4/2); W2.base_ring(); W2.backend()\nRational Field\n'normaliz'\nsage: W2.vertices()\n(A vertex at (0, 0, 0, 0),\n A vertex at (1, 1, 1, 0),\n A vertex at (2, 4, 8, 0),\n A vertex at (3, 9, 27, -3),\n A vertex at (3, 9, 27, 3),\n A vertex at (4, 16, 64, -12),\n A vertex at (4, 16, 64, 12),\n A vertex at (5, 25, 125, -30),\n A vertex at (5, 25, 125, 30),\n A vertex at (6, 36, 216, -60),\n A vertex at (6, 36, 216, 60))\n```\n\n`W2` has vertices with integer coordinates",
    "created_at": "2019-07-24T15:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438059",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@kliem](#comment%3A18):
> What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).
> 
> What about the examples of #25097. Do they work?
> 
> (Sorry, still can't test it myself).
> 

The polyhedron `H` is the responsible for changing the base ring and the backend. The following should fix the problem (up to change of base ring form ZZ to QQ, see `W2` below):

```diff
-    def wedge(self, face, width=1):
+    def wedge(self, face, width=None):
         r"""
         Return the wedge over a ``face`` of the polytope ``self``.

@@ -4205,6 +4205,10 @@ class Polyhedron_base(Element):
             sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()
             Real Double Field
         """
+        if width is None:
+            width = ZZ.one()
+
         if not self.is_compact():
             raise ValueError("polyhedron 'self' must be a polytope")

@@ -4223,7 +4227,11 @@ class Polyhedron_base(Element):

         L = Polyhedron(lines=[[1]])
         Q = self.product(L)
-        H = Polyhedron(ieqs=[F_Hrep + [width], F_Hrep + [-width]])
+
+        parent = self.parent().base_extend(width, ambient_dim=self.ambient_dim()+1)
+        ieqs = [F_Hrep + [width], F_Hrep + [-width]]
+        H = parent.element_class(parent, None, [ieqs, None])
         return Q.intersection(H)

```

Some examples:

```
sage: P = polytopes.cyclic_polytope(3,7, base_ring=ZZ, backend='normaliz')
sage: W1 = P.wedge(P.faces(2)[0]); W1.base_ring(); W1.backend()
Integer Ring
'normaliz'
sage: W2 = P.wedge(P.faces(2)[0], width=5/2); W2.base_ring(); W2.backend()
Rational Field
'normaliz'
sage: W2 = P.wedge(P.faces(2)[0], width=4/2); W2.base_ring(); W2.backend()
Rational Field
'normaliz'
sage: W2.vertices()
(A vertex at (0, 0, 0, 0),
 A vertex at (1, 1, 1, 0),
 A vertex at (2, 4, 8, 0),
 A vertex at (3, 9, 27, -3),
 A vertex at (3, 9, 27, 3),
 A vertex at (4, 16, 64, -12),
 A vertex at (4, 16, 64, 12),
 A vertex at (5, 25, 125, -30),
 A vertex at (5, 25, 125, 30),
 A vertex at (6, 36, 216, -60),
 A vertex at (6, 36, 216, 60))
```

`W2` has vertices with integer coordinates



---

archive/issue_comments_438060.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nIs this `ZZ.one()` really needed? Base extend should work recognize `1` as well.\n\nCan you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)\n\nReplying to [@LaisRast](#comment%3A19):\n> Replying to [@kliem](#comment%3A18):\n> > What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).\n> > \n> > What about the examples of #25097. Do they work?\n> > \n> > (Sorry, still can't test it myself).\n> > \n\n> \n> The polyhedron `H` is the responsible for changing the base ring and the backend. The following should fix the problem (up to change of base ring form ZZ to QQ, see `W2` below):\n> \n> ```diff\n> -    def wedge(self, face, width=1):\n> +    def wedge(self, face, width=None):\n>          r\"\"\"\n>          Return the wedge over a ``face`` of the polytope ``self``.\n> \n> @@ -4205,6 +4205,10 @@ class Polyhedron_base(Element):\n>              sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()\n>              Real Double Field\n>          \"\"\"\n> +        if width is None:\n> +            width = ZZ.one()\n> +\n>          if not self.is_compact():\n>              raise ValueError(\"polyhedron 'self' must be a polytope\")\n> \n> @@ -4223,7 +4227,11 @@ class Polyhedron_base(Element):\n> \n>          L = Polyhedron(lines=[[1]])\n>          Q = self.product(L)\n> -        H = Polyhedron(ieqs=[F_Hrep + [width], F_Hrep + [-width]])\n> +\n> +        parent = self.parent().base_extend(width, ambient_dim=self.ambient_dim()+1)\n> +        ieqs = [F_Hrep + [width], F_Hrep + [-width]]\n> +        H = parent.element_class(parent, None, [ieqs, None])\n>          return Q.intersection(H)\n> \n> ```\n> \n> Some examples:\n> \n> ```\n> sage: P = polytopes.cyclic_polytope(3,7, base_ring=ZZ, backend='normaliz')\n> sage: W1 = P.wedge(P.faces(2)[0]); W1.base_ring(); W1.backend()\n> Integer Ring\n> 'normaliz'\n> sage: W2 = P.wedge(P.faces(2)[0], width=5/2); W2.base_ring(); W2.backend()\n> Rational Field\n> 'normaliz'\n> sage: W2 = P.wedge(P.faces(2)[0], width=4/2); W2.base_ring(); W2.backend()\n> Rational Field\n> 'normaliz'\n> sage: W2.vertices()\n> (A vertex at (0, 0, 0, 0),\n>  A vertex at (1, 1, 1, 0),\n>  A vertex at (2, 4, 8, 0),\n>  A vertex at (3, 9, 27, -3),\n>  A vertex at (3, 9, 27, 3),\n>  A vertex at (4, 16, 64, -12),\n>  A vertex at (4, 16, 64, 12),\n>  A vertex at (5, 25, 125, -30),\n>  A vertex at (5, 25, 125, 30),\n>  A vertex at (6, 36, 216, -60),\n>  A vertex at (6, 36, 216, 60))\n> ```\n> \n> `W2` has vertices with integer coordinates",
    "created_at": "2019-07-24T21:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438060",
    "user": "https://github.com/kliem"
}
```

<a id='comment:20'>Comment 20:</a>
Is this `ZZ.one()` really needed? Base extend should work recognize `1` as well.

Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)

Replying to [@LaisRast](#comment%3A19):
> Replying to [@kliem](#comment%3A18):
> > What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).
> > 
> > What about the examples of #25097. Do they work?
> > 
> > (Sorry, still can't test it myself).
> > 

> 
> The polyhedron `H` is the responsible for changing the base ring and the backend. The following should fix the problem (up to change of base ring form ZZ to QQ, see `W2` below):
> 
> ```diff
> -    def wedge(self, face, width=1):
> +    def wedge(self, face, width=None):
>          r"""
>          Return the wedge over a ``face`` of the polytope ``self``.
> 
> @@ -4205,6 +4205,10 @@ class Polyhedron_base(Element):
>              sage: P.wedge(P.faces(2)[0], width=RDF(1)).base_ring()
>              Real Double Field
>          """
> +        if width is None:
> +            width = ZZ.one()
> +
>          if not self.is_compact():
>              raise ValueError("polyhedron 'self' must be a polytope")
> 
> @@ -4223,7 +4227,11 @@ class Polyhedron_base(Element):
> 
>          L = Polyhedron(lines=[[1]])
>          Q = self.product(L)
> -        H = Polyhedron(ieqs=[F_Hrep + [width], F_Hrep + [-width]])
> +
> +        parent = self.parent().base_extend(width, ambient_dim=self.ambient_dim()+1)
> +        ieqs = [F_Hrep + [width], F_Hrep + [-width]]
> +        H = parent.element_class(parent, None, [ieqs, None])
>          return Q.intersection(H)
> 
> ```
> 
> Some examples:
> 
> ```
> sage: P = polytopes.cyclic_polytope(3,7, base_ring=ZZ, backend='normaliz')
> sage: W1 = P.wedge(P.faces(2)[0]); W1.base_ring(); W1.backend()
> Integer Ring
> 'normaliz'
> sage: W2 = P.wedge(P.faces(2)[0], width=5/2); W2.base_ring(); W2.backend()
> Rational Field
> 'normaliz'
> sage: W2 = P.wedge(P.faces(2)[0], width=4/2); W2.base_ring(); W2.backend()
> Rational Field
> 'normaliz'
> sage: W2.vertices()
> (A vertex at (0, 0, 0, 0),
>  A vertex at (1, 1, 1, 0),
>  A vertex at (2, 4, 8, 0),
>  A vertex at (3, 9, 27, -3),
>  A vertex at (3, 9, 27, 3),
>  A vertex at (4, 16, 64, -12),
>  A vertex at (4, 16, 64, 12),
>  A vertex at (5, 25, 125, -30),
>  A vertex at (5, 25, 125, 30),
>  A vertex at (6, 36, 216, -60),
>  A vertex at (6, 36, 216, 60))
> ```
> 
> `W2` has vertices with integer coordinates



---

archive/issue_comments_438061.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@kliem](#comment%3A18):\n> What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).\n\nA note: in Sage `4/2` is rational:\n\n```\nsage: type(4/2)\n<class 'sage.rings.rational.Rational'>\n```\n\nand it should be like that, not to create nightmares.\n\nHence, taking `width=4/2`, the expected behavior is *really* to change the base ring to rational numbers.\n\nIn Sage dividing two `Integers` yields an element in the FractionField, i.e. the rationals. It is the users responsibility to know these things. Just like `2.0` is not an integer.\n\nThat said, it is completely fine to have `base_ring=QQ` but integral vertices. The goal of base ring is not to steadily represent the smallest ring in which the vertices lay in.",
    "created_at": "2019-07-25T07:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438061",
    "user": "https://github.com/jplab"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@kliem](#comment%3A18):
> What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).

A note: in Sage `4/2` is rational:

```
sage: type(4/2)
<class 'sage.rings.rational.Rational'>
```

and it should be like that, not to create nightmares.

Hence, taking `width=4/2`, the expected behavior is *really* to change the base ring to rational numbers.

In Sage dividing two `Integers` yields an element in the FractionField, i.e. the rationals. It is the users responsibility to know these things. Just like `2.0` is not an integer.

That said, it is completely fine to have `base_ring=QQ` but integral vertices. The goal of base ring is not to steadily represent the smallest ring in which the vertices lay in.



---

archive/issue_comments_438062.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI was aware of `4/2` being rational.\nI just find it awful to change the backend when you enter rational width.\nThe backend should never change unintentionally unless necessary (so if you enter `width=2.0` the backend will change to cdd, which I would consider the expected behavior.)\n\nIt's just annoying when you want to use `normaliz` and every operation ignores your preference and you have to change backend over and over (and even worse calculations might take longer time with `ppl`, which you decided not to use in the first place).\n\nReplying to [@jplab](#comment%3A21):\n> Replying to [@kliem](#comment%3A18):\n> > What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).\n\n> \n> A note: in Sage `4/2` is rational:\n> \n> \n> sage: type(4/2)\n> <class 'sage.rings.rational.Rational'>\n> }}}\n> \n> and it should be like that, not to create nightmares.\n> \n> Hence, taking `width=4/2`, the expected behavior is *really* to change the base ring to rational numbers.\n> \n> In Sage dividing two `Integers` yields an element in the FractionField, i.e. the rationals. It is the users responsibility to know these things. Just like `2.0` is not an integer.\n> \n> That said, it is completely fine to have `base_ring=QQ` but integral vertices. The goal of base ring is not to steadily represent the smallest ring in which the vertices lay in.",
    "created_at": "2019-07-25T07:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438062",
    "user": "https://github.com/kliem"
}
```

<a id='comment:22'>Comment 22:</a>
I was aware of `4/2` being rational.
I just find it awful to change the backend when you enter rational width.
The backend should never change unintentionally unless necessary (so if you enter `width=2.0` the backend will change to cdd, which I would consider the expected behavior.)

It's just annoying when you want to use `normaliz` and every operation ignores your preference and you have to change backend over and over (and even worse calculations might take longer time with `ppl`, which you decided not to use in the first place).

Replying to [@jplab](#comment%3A21):
> Replying to [@kliem](#comment%3A18):
> > What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).

> 
> A note: in Sage `4/2` is rational:
> 
> 
> sage: type(4/2)
> <class 'sage.rings.rational.Rational'>
> }}}
> 
> and it should be like that, not to create nightmares.
> 
> Hence, taking `width=4/2`, the expected behavior is *really* to change the base ring to rational numbers.
> 
> In Sage dividing two `Integers` yields an element in the FractionField, i.e. the rationals. It is the users responsibility to know these things. Just like `2.0` is not an integer.
> 
> That said, it is completely fine to have `base_ring=QQ` but integral vertices. The goal of base ring is not to steadily represent the smallest ring in which the vertices lay in.



---

archive/issue_comments_438063.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nReplying to [@kliem](#comment%3A22):\n> I was aware of `4/2` being rational.\n> I just find it awful to change the backend when you enter rational width.\n> The backend should never change unintentionally unless necessary (so if you enter `width=2.0` the backend will change to cdd, which I would consider the expected behavior.)\n> \n> It's just annoying when you want to use `normaliz` and every operation ignores your preference and you have to change backend over and over (and even worse calculations might take longer time with `ppl`, which you decided not to use in the first place).\n> \n> Replying to [@jplab](#comment%3A21):\n> > Replying to [@kliem](#comment%3A18):\n> > > What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).\n\n> > \n> > A note: in Sage `4/2` is rational:\n> > \n> > \n> > sage: type(4/2)\n> > <class 'sage.rings.rational.Rational'>\n> > }}}\n> > \n> > and it should be like that, not to create nightmares.\n> > \n> > Hence, taking `width=4/2`, the expected behavior is *really* to change the base ring to rational numbers.\n> > \n> > In Sage dividing two `Integers` yields an element in the FractionField, i.e. the rationals. It is the users responsibility to know these things. Just like `2.0` is not an integer.\n> > \n> > That said, it is completely fine to have `base_ring=QQ` but integral vertices. The goal of base ring is not to steadily represent the smallest ring in which the vertices lay in.\n\nOf course, of course. The only thing to do is to carry the backend to the wedge, no big deal...",
    "created_at": "2019-07-25T08:13:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438063",
    "user": "https://github.com/jplab"
}
```

<a id='comment:23'>Comment 23:</a>
Replying to [@kliem](#comment%3A22):
> I was aware of `4/2` being rational.
> I just find it awful to change the backend when you enter rational width.
> The backend should never change unintentionally unless necessary (so if you enter `width=2.0` the backend will change to cdd, which I would consider the expected behavior.)
> 
> It's just annoying when you want to use `normaliz` and every operation ignores your preference and you have to change backend over and over (and even worse calculations might take longer time with `ppl`, which you decided not to use in the first place).
> 
> Replying to [@jplab](#comment%3A21):
> > Replying to [@kliem](#comment%3A18):
> > > What about normaliz with base ring ZZ and width 5/2 (even worse 4/2)? (I suspect backend will not be preserved).

> > 
> > A note: in Sage `4/2` is rational:
> > 
> > 
> > sage: type(4/2)
> > <class 'sage.rings.rational.Rational'>
> > }}}
> > 
> > and it should be like that, not to create nightmares.
> > 
> > Hence, taking `width=4/2`, the expected behavior is *really* to change the base ring to rational numbers.
> > 
> > In Sage dividing two `Integers` yields an element in the FractionField, i.e. the rationals. It is the users responsibility to know these things. Just like `2.0` is not an integer.
> > 
> > That said, it is completely fine to have `base_ring=QQ` but integral vertices. The goal of base ring is not to steadily represent the smallest ring in which the vertices lay in.

Of course, of course. The only thing to do is to carry the backend to the wedge, no big deal...



---

archive/issue_comments_438064.json:
```json
{
    "body": "Changed commit from **[417bfac](https://github.com/sagemath/sagetrac-mirror/commit/417bfac337f17e93494d8f31b9031f9311cee423)** to **[7653fb8](https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9)**",
    "created_at": "2019-07-25T09:27:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438064",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[417bfac](https://github.com/sagemath/sagetrac-mirror/commit/417bfac337f17e93494d8f31b9031f9311cee423)** to **[7653fb8](https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9)**



---

archive/issue_comments_438065.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00f225333846d3559bcf9caefc62a35e0b8b918a\">00f2253</a></td><td><code>polyhedron H now preserves backend now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09597bdff5713b097959a839fc6f24f4134e0f90\">09597bd</a></td><td><code>backend should be preserved now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9\">7653fb8</a></td><td><code>Now should work if width is in RDF</code></td></tr></table>\n",
    "created_at": "2019-07-25T09:27:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438065",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00f225333846d3559bcf9caefc62a35e0b8b918a">00f2253</a></td><td><code>polyhedron H now preserves backend now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09597bdff5713b097959a839fc6f24f4134e0f90">09597bd</a></td><td><code>backend should be preserved now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9">7653fb8</a></td><td><code>Now should work if width is in RDF</code></td></tr></table>




---

archive/issue_comments_438066.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nReplying to [@kliem](#comment%3A20):\n> Base extend should work recognize `1` as well.\n\nNot anymore after the last commit I did. `ZZ.one()` is really needed now. The `width` should have a `base_ring`method in order for the wedge to work.\n\n> Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)\n\nThis might produce problems due to the following behavior:\n\n```\nsage: Polyhedron(lines=[[1]])\nA 1-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex and 1 line\nsage: Polyhedron(lines=[[1]], base_ring=AA)\nThe empty polyhedron in AA^1\nsage: Polyhedron(lines=[[1]], base_ring=AA, backend='normaliz')\nA 1-dimensional polyhedron in AA^1 defined as the convex hull of 1 vertex and 1 line\n```\n\n\nThe backend should now be preserved as long as this is possible. The base ring will change to the field of fractions of the current base ring, if width takes the default value 1. This is really needed because the base ring for the vertices is either the base ring for the ieqs or its field of fractions\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00f225333846d3559bcf9caefc62a35e0b8b918a\">00f2253</a></td><td><code>polyhedron H now preserves backend now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09597bdff5713b097959a839fc6f24f4134e0f90\">09597bd</a></td><td><code>backend should be preserved now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9\">7653fb8</a></td><td><code>Now should work if width is in RDF</code></td></tr></table>\n",
    "created_at": "2019-07-25T09:29:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438066",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:25'>Comment 25:</a>
Replying to [@kliem](#comment%3A20):
> Base extend should work recognize `1` as well.

Not anymore after the last commit I did. `ZZ.one()` is really needed now. The `width` should have a `base_ring`method in order for the wedge to work.

> Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)

This might produce problems due to the following behavior:

```
sage: Polyhedron(lines=[[1]])
A 1-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex and 1 line
sage: Polyhedron(lines=[[1]], base_ring=AA)
The empty polyhedron in AA^1
sage: Polyhedron(lines=[[1]], base_ring=AA, backend='normaliz')
A 1-dimensional polyhedron in AA^1 defined as the convex hull of 1 vertex and 1 line
```


The backend should now be preserved as long as this is possible. The base ring will change to the field of fractions of the current base ring, if width takes the default value 1. This is really needed because the base ring for the vertices is either the base ring for the ieqs or its field of fractions

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00f225333846d3559bcf9caefc62a35e0b8b918a">00f2253</a></td><td><code>polyhedron H now preserves backend now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09597bdff5713b097959a839fc6f24f4134e0f90">09597bd</a></td><td><code>backend should be preserved now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9">7653fb8</a></td><td><code>Now should work if width is in RDF</code></td></tr></table>




---

archive/issue_events_365402.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-25T09:45:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365402"
}
```



---

archive/issue_events_365403.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-25T09:45:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365403"
}
```



---

archive/issue_comments_438067.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nReplying to [@LaisRast](#comment%3A25):\n> Replying to [@kliem](#comment%3A20):\n> > Base extend should work recognize `1` as well.\n\n> Not anymore after the last commit I did. `ZZ.one()` is really needed now. The `width` should have a `base_ring`method in order for the wedge to work.\n> \n> > Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)\n\n> This might produce problems due to the following behavior:\n> \n> ```\n> sage: Polyhedron(lines=[[1]])\n> A 1-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex and 1 line\n> sage: Polyhedron(lines=[[1]], base_ring=AA)\n> The empty polyhedron in AA^1\n> sage: Polyhedron(lines=[[1]], base_ring=AA, backend='normaliz')\n> A 1-dimensional polyhedron in AA^1 defined as the convex hull of 1 vertex and 1 line\n> ```\n\nI think that's a bug.\n> \n> \n> The backend should now be preserved as long as this is possible. The base ring will change to the field of fractions of the current base ring, if width takes the default value 1. This is really needed because the base ring for the vertices is either the base ring for the ieqs or its field of fractions\n> \n> \n> ---\n> New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00f225333846d3559bcf9caefc62a35e0b8b918a\">00f2253</a></td><td><code>polyhedron H now preserves backend now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09597bdff5713b097959a839fc6f24f4134e0f90\">09597bd</a></td><td><code>backend should be preserved now</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9\">7653fb8</a></td><td><code>Now should work if width is in RDF</code></td></tr></table>\n",
    "created_at": "2019-07-25T11:15:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438067",
    "user": "https://github.com/kliem"
}
```

<a id='comment:27'>Comment 27:</a>
Replying to [@LaisRast](#comment%3A25):
> Replying to [@kliem](#comment%3A20):
> > Base extend should work recognize `1` as well.

> Not anymore after the last commit I did. `ZZ.one()` is really needed now. The `width` should have a `base_ring`method in order for the wedge to work.
> 
> > Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)

> This might produce problems due to the following behavior:
> 
> ```
> sage: Polyhedron(lines=[[1]])
> A 1-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex and 1 line
> sage: Polyhedron(lines=[[1]], base_ring=AA)
> The empty polyhedron in AA^1
> sage: Polyhedron(lines=[[1]], base_ring=AA, backend='normaliz')
> A 1-dimensional polyhedron in AA^1 defined as the convex hull of 1 vertex and 1 line
> ```

I think that's a bug.
> 
> 
> The backend should now be preserved as long as this is possible. The base ring will change to the field of fractions of the current base ring, if width takes the default value 1. This is really needed because the base ring for the vertices is either the base ring for the ieqs or its field of fractions
> 
> 
> ---
> New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00f225333846d3559bcf9caefc62a35e0b8b918a">00f2253</a></td><td><code>polyhedron H now preserves backend now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09597bdff5713b097959a839fc6f24f4134e0f90">09597bd</a></td><td><code>backend should be preserved now</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9">7653fb8</a></td><td><code>Now should work if width is in RDF</code></td></tr></table>




---

archive/issue_comments_438068.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nMost importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.\nAlternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.\n\nThe current code does not work with width a python integer ect.\nHow about `parent = self.parent().base_extend(width/1, \u2026`, I believe this works as well.\nThen a default `width=1` would be fine as well.\nAs of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.",
    "created_at": "2019-07-25T11:29:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438068",
    "user": "https://github.com/kliem"
}
```

<a id='comment:28'>Comment 28:</a>
Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.
Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.

The current code does not work with width a python integer ect.
How about `parent = self.parent().base_extend(width/1, …`, I believe this works as well.
Then a default `width=1` would be fine as well.
As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.



---

archive/issue_events_365404.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-07-25T11:29:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365404"
}
```



---

archive/issue_events_365405.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-07-25T11:29:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365405"
}
```



---

archive/issue_comments_438069.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@kliem](#comment%3A28):\n> Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.\n> Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.\n\nI switched to `field`.\n\n> The current code does not work with width a python integer ect.\n> How about `parent = self.parent().base_extend(width/1, \u2026`, I believe this works as well.\n> Then a default `width=1` would be fine as well.\n> As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.\n> \n\nIn python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.",
    "created_at": "2019-07-25T11:59:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438069",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@kliem](#comment%3A28):
> Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.
> Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.

I switched to `field`.

> The current code does not work with width a python integer ect.
> How about `parent = self.parent().base_extend(width/1, …`, I believe this works as well.
> Then a default `width=1` would be fine as well.
> As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.
> 

In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.



---

archive/issue_comments_438070.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c77c1af1ff8732512b3cd25fe6bdc4a138041c34\">c77c1af</a></td><td><code>normaliz -> field in tests</code></td></tr></table>\n",
    "created_at": "2019-07-25T12:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438070",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:30'>Comment 30:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c77c1af1ff8732512b3cd25fe6bdc4a138041c34">c77c1af</a></td><td><code>normaliz -> field in tests</code></td></tr></table>




---

archive/issue_comments_438071.json:
```json
{
    "body": "Changed commit from **[7653fb8](https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9)** to **[c77c1af](https://github.com/sagemath/sagetrac-mirror/commit/c77c1af1ff8732512b3cd25fe6bdc4a138041c34)**",
    "created_at": "2019-07-25T12:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438071",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7653fb8](https://github.com/sagemath/sagetrac-mirror/commit/7653fb8d21fc31d7ab34ff2c1c6da050934adef9)** to **[c77c1af](https://github.com/sagemath/sagetrac-mirror/commit/c77c1af1ff8732512b3cd25fe6bdc4a138041c34)**



---

archive/issue_events_365406.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-25T12:20:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365406"
}
```



---

archive/issue_events_365407.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-25T12:20:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365407"
}
```



---

archive/issue_comments_438072.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nReplying to [@LaisRast](#comment%3A29):\n> Replying to [@kliem](#comment%3A28):\n> > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.\n> > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.\n\n> I switched to `field`.\n> \n> > The current code does not work with width a python integer ect.\n> > How about `parent = self.parent().base_extend(width/1, \u2026`, I believe this works as well.\n> > Then a default `width=1` would be fine as well.\n> > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.\n> > \n\n> In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.\n\nHaving `ZZ.one()` as default instead of python `1` solves the problem for the default value. If the value of `width` is not the default value, then it is a sage ring element. This solves the problem for non-default values.",
    "created_at": "2019-07-25T12:20:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438072",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:31'>Comment 31:</a>
Replying to [@LaisRast](#comment%3A29):
> Replying to [@kliem](#comment%3A28):
> > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.
> > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.

> I switched to `field`.
> 
> > The current code does not work with width a python integer ect.
> > How about `parent = self.parent().base_extend(width/1, …`, I believe this works as well.
> > Then a default `width=1` would be fine as well.
> > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.
> > 

> In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.

Having `ZZ.one()` as default instead of python `1` solves the problem for the default value. If the value of `width` is not the default value, then it is a sage ring element. This solves the problem for non-default values.



---

archive/issue_comments_438073.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nReplying to [@LaisRast](#comment%3A29):\n> Replying to [@kliem](#comment%3A28):\n> > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.\n> > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.\n\n> I switched to `field`.\n> \n> > The current code does not work with width a python integer ect.\n> > How about `parent = self.parent().base_extend(width/1, \u2026`, I believe this works as well.\n> > Then a default `width=1` would be fine as well.\n> > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.\n> > \n\n> In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.\n\n`parent._coerce_base_ring(1/1)` gives rational field, which tells me that base extend works fine.\nDon't worry about passing a ring to `Polyhedra.base_extend`.\nProbably you should pass `1/width` as argument `base_ring`:\n\n```diff\n-        parent = self.parent().base_extend(width.base_ring().fraction_field(),\\\n+        parent = self.parent().base_extend(1/width,\\\n                                             ambient_dim=self.ambient_dim()+1)\n```\n\nThis extends the ring of parent, such that `1/width` is an element.\nThere is a number of occasions, where I used `base_extend` this way to have polyhedral operations respect the base ring.",
    "created_at": "2019-07-25T12:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438073",
    "user": "https://github.com/kliem"
}
```

<a id='comment:32'>Comment 32:</a>
Replying to [@LaisRast](#comment%3A29):
> Replying to [@kliem](#comment%3A28):
> > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.
> > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.

> I switched to `field`.
> 
> > The current code does not work with width a python integer ect.
> > How about `parent = self.parent().base_extend(width/1, …`, I believe this works as well.
> > Then a default `width=1` would be fine as well.
> > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.
> > 

> In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.

`parent._coerce_base_ring(1/1)` gives rational field, which tells me that base extend works fine.
Don't worry about passing a ring to `Polyhedra.base_extend`.
Probably you should pass `1/width` as argument `base_ring`:

```diff
-        parent = self.parent().base_extend(width.base_ring().fraction_field(),\
+        parent = self.parent().base_extend(1/width,\
                                             ambient_dim=self.ambient_dim()+1)
```

This extends the ring of parent, such that `1/width` is an element.
There is a number of occasions, where I used `base_extend` this way to have polyhedral operations respect the base ring.



---

archive/issue_comments_438074.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [@LaisRast](#comment%3A31):\n> Replying to [@LaisRast](#comment%3A29):\n> > Replying to [@kliem](#comment%3A28):\n> > > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.\n> > > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.\n\n> > I switched to `field`.\n> > \n> > > The current code does not work with width a python integer ect.\n> > > How about `parent = self.parent().base_extend(width/1, \u2026`, I believe this works as well.\n> > > Then a default `width=1` would be fine as well.\n> > > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.\n> > > \n\n> > In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.\n\n> \n> Having `ZZ.one()` as default instead of python `1` solves the problem for the default value. If the value of `width` is not the default value, then it is a sage ring element. This solves the problem for non-default values.\n\nNo. If you write a python script that uses this method, you will have to import `Integer` from sage as well to be able to pass `width`.\nSomething as `1l` or `1L` or `float(0.9)` should work as well.\n\nActually you need to use `ZZ.one()/width` (not `1/width`), which should do the trick. Sorry about the confusion.\nAlternatively, you find a method to map `width` to a sage ring element and then still do the fraction field.",
    "created_at": "2019-07-25T12:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438074",
    "user": "https://github.com/kliem"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [@LaisRast](#comment%3A31):
> Replying to [@LaisRast](#comment%3A29):
> > Replying to [@kliem](#comment%3A28):
> > > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.
> > > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.

> > I switched to `field`.
> > 
> > > The current code does not work with width a python integer ect.
> > > How about `parent = self.parent().base_extend(width/1, …`, I believe this works as well.
> > > Then a default `width=1` would be fine as well.
> > > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.
> > > 

> > In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.

> 
> Having `ZZ.one()` as default instead of python `1` solves the problem for the default value. If the value of `width` is not the default value, then it is a sage ring element. This solves the problem for non-default values.

No. If you write a python script that uses this method, you will have to import `Integer` from sage as well to be able to pass `width`.
Something as `1l` or `1L` or `float(0.9)` should work as well.

Actually you need to use `ZZ.one()/width` (not `1/width`), which should do the trick. Sorry about the confusion.
Alternatively, you find a method to map `width` to a sage ring element and then still do the fraction field.



---

archive/issue_comments_438075.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nPlease allow python integers (and floats) as input for width.",
    "created_at": "2019-07-25T12:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438075",
    "user": "https://github.com/kliem"
}
```

<a id='comment:34'>Comment 34:</a>
Please allow python integers (and floats) as input for width.



---

archive/issue_events_365408.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-07-25T12:42:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365408"
}
```



---

archive/issue_events_365409.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-07-25T12:42:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365409"
}
```



---

archive/issue_comments_438076.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccce5f2c2fc9c63d307e799572fcce581079a569\">ccce5f2</a></td><td><code>python ints and floats can be used for width</code></td></tr></table>\n",
    "created_at": "2019-07-25T12:48:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438076",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:35'>Comment 35:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccce5f2c2fc9c63d307e799572fcce581079a569">ccce5f2</a></td><td><code>python ints and floats can be used for width</code></td></tr></table>




---

archive/issue_comments_438077.json:
```json
{
    "body": "Changed commit from **[c77c1af](https://github.com/sagemath/sagetrac-mirror/commit/c77c1af1ff8732512b3cd25fe6bdc4a138041c34)** to **[ccce5f2](https://github.com/sagemath/sagetrac-mirror/commit/ccce5f2c2fc9c63d307e799572fcce581079a569)**",
    "created_at": "2019-07-25T12:48:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438077",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c77c1af](https://github.com/sagemath/sagetrac-mirror/commit/c77c1af1ff8732512b3cd25fe6bdc4a138041c34)** to **[ccce5f2](https://github.com/sagemath/sagetrac-mirror/commit/ccce5f2c2fc9c63d307e799572fcce581079a569)**



---

archive/issue_comments_438078.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nReplying to [@kliem](#comment%3A33):\n> Replying to [@LaisRast](#comment%3A31):\n> > Replying to [@LaisRast](#comment%3A29):\n> > > Replying to [@kliem](#comment%3A28):\n> > > > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.\n> > > > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.\n\n> > > I switched to `field`.\n> > > \n> > > > The current code does not work with width a python integer ect.\n> > > > How about `parent = self.parent().base_extend(width/1, \u2026`, I believe this works as well.\n> > > > Then a default `width=1` would be fine as well.\n> > > > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.\n> > > > \n\n> > > In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.\n\n> > \n> > Having `ZZ.one()` as default instead of python `1` solves the problem for the default value. If the value of `width` is not the default value, then it is a sage ring element. This solves the problem for non-default values.\n\n> \n> No. If you write a python script that uses this method, you will have to import `Integer` from sage as well to be able to pass `width`.\n> Something as `1l` or `1L` or `float(0.9)` should work as well.\n> \n> Actually you need to use `ZZ.one()/width` (not `1/width`), which should do the trick. Sorry about the confusion.\n> Alternatively, you find a method to map `width` to a sage ring element and then still do the fraction field.\n\nThis is actually a good trick to deal with python numbers.",
    "created_at": "2019-07-25T12:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438078",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:36'>Comment 36:</a>
Replying to [@kliem](#comment%3A33):
> Replying to [@LaisRast](#comment%3A31):
> > Replying to [@LaisRast](#comment%3A29):
> > > Replying to [@kliem](#comment%3A28):
> > > > Most importantly the `normaliz` tests should be marked optional as `pynormaliz` cannot be assumed to be installed.
> > > > Alternatively, you can switch to backend `field` for the tests, this demonstrates as well that the backend is preserved.

> > > I switched to `field`.
> > > 
> > > > The current code does not work with width a python integer ect.
> > > > How about `parent = self.parent().base_extend(width/1, …`, I believe this works as well.
> > > > Then a default `width=1` would be fine as well.
> > > > As of #27926 `parent.base_extend` works with elements of rings and numbers that can be interpreted as such.
> > > > 

> > > In python3 (resp. python2), `x = 1/1; type(x)` gives `<class 'float'>` (resp. `<type 'int'>`), which does not have a `.base_ring()`. I need `.base_ring()` so I can find its `.fraction_field()`.

> > 
> > Having `ZZ.one()` as default instead of python `1` solves the problem for the default value. If the value of `width` is not the default value, then it is a sage ring element. This solves the problem for non-default values.

> 
> No. If you write a python script that uses this method, you will have to import `Integer` from sage as well to be able to pass `width`.
> Something as `1l` or `1L` or `float(0.9)` should work as well.
> 
> Actually you need to use `ZZ.one()/width` (not `1/width`), which should do the trick. Sorry about the confusion.
> Alternatively, you find a method to map `width` to a sage ring element and then still do the fraction field.

This is actually a good trick to deal with python numbers.



---

archive/issue_events_365410.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-25T12:48:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365410"
}
```



---

archive/issue_events_365411.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-07-25T12:48:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365411"
}
```



---

archive/issue_comments_438079.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ba559456a3770c5517956db2d7ae1ed44a8d717\">6ba5594</a></td><td><code>width.base_ring().fraction_field() -> ZZ.one()/width</code></td></tr></table>\n",
    "created_at": "2019-07-25T12:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438079",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:37'>Comment 37:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ba559456a3770c5517956db2d7ae1ed44a8d717">6ba5594</a></td><td><code>width.base_ring().fraction_field() -> ZZ.one()/width</code></td></tr></table>




---

archive/issue_comments_438080.json:
```json
{
    "body": "Changed commit from **[ccce5f2](https://github.com/sagemath/sagetrac-mirror/commit/ccce5f2c2fc9c63d307e799572fcce581079a569)** to **[6ba5594](https://github.com/sagemath/sagetrac-mirror/commit/6ba559456a3770c5517956db2d7ae1ed44a8d717)**",
    "created_at": "2019-07-25T12:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438080",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ccce5f2](https://github.com/sagemath/sagetrac-mirror/commit/ccce5f2c2fc9c63d307e799572fcce581079a569)** to **[6ba5594](https://github.com/sagemath/sagetrac-mirror/commit/6ba559456a3770c5517956db2d7ae1ed44a8d717)**



---

archive/issue_comments_438081.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n From \u200b\u200bhttps://www.csun.edu/~ctoth/Handbook/chap15.pdf:\n \n-The wedge over a facet `F` of a polytope `P` is defined as the product:\n+The wedge over a facet `F` of a polytope `P` is defined as:\n \n-`P \\times \\mathbb{R}\\cap \\{a^\\top x +|x_{d+1}| \\leq b\\}`\n+`(P \\times \\mathbb{R}) \\cap \\{a^\\top x +|x_{d+1}| \\leq b\\}`\n \n where `F` is a facet defined by `a^\\top x leq b`.\n \n``````\n",
    "created_at": "2019-07-25T12:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438081",
    "user": "https://github.com/LaisRast"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 From ​​https://www.csun.edu/~ctoth/Handbook/chap15.pdf:
 
-The wedge over a facet `F` of a polytope `P` is defined as the product:
+The wedge over a facet `F` of a polytope `P` is defined as:
 
-`P \times \mathbb{R}\cap \{a^\top x +|x_{d+1}| \leq b\}`
+`(P \times \mathbb{R}) \cap \{a^\top x +|x_{d+1}| \leq b\}`
 
 where `F` is a facet defined by `a^\top x leq b`.
 
``````




---

archive/issue_events_365412.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-25T13:27:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365412"
}
```



---

archive/issue_comments_438082.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nReplying to [@kliem](#comment%3A27):\n> Replying to [@LaisRast](#comment%3A25):\n> > Replying to [@kliem](#comment%3A20):\n> > > Base extend should work recognize `1` as well.\n\n> > Not anymore after the last commit I did. `ZZ.one()` is really needed now. The `width` should have a `base_ring`method in order for the wedge to work.\n> > \n> > > Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)\n\n> > This might produce problems due to the following behavior:\n> > \n> > ```\n> > sage: Polyhedron(lines=[[1]])\n> > A 1-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex and 1 line\n> > sage: Polyhedron(lines=[[1]], base_ring=AA)\n> > The empty polyhedron in AA^1\n> > sage: Polyhedron(lines=[[1]], base_ring=AA, backend='normaliz')\n> > A 1-dimensional polyhedron in AA^1 defined as the convex hull of 1 vertex and 1 line\n> > ```\n\n> \n> I think that's a bug.\n\nThis is definitely a bug.",
    "created_at": "2019-07-25T13:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438082",
    "user": "https://github.com/jplab"
}
```

<a id='comment:40'>Comment 40:</a>
Replying to [@kliem](#comment%3A27):
> Replying to [@LaisRast](#comment%3A25):
> > Replying to [@kliem](#comment%3A20):
> > > Base extend should work recognize `1` as well.

> > Not anymore after the last commit I did. `ZZ.one()` is really needed now. The `width` should have a `base_ring`method in order for the wedge to work.
> > 
> > > Can you add `base_ring=self.base_ring()` and same for backend to initialization of L. (Setting up the correct base ring right away, avoids coercion for the product to my understanding.)

> > This might produce problems due to the following behavior:
> > 
> > ```
> > sage: Polyhedron(lines=[[1]])
> > A 1-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex and 1 line
> > sage: Polyhedron(lines=[[1]], base_ring=AA)
> > The empty polyhedron in AA^1
> > sage: Polyhedron(lines=[[1]], base_ring=AA, backend='normaliz')
> > A 1-dimensional polyhedron in AA^1 defined as the convex hull of 1 vertex and 1 line
> > ```

> 
> I think that's a bug.

This is definitely a bug.



---

archive/issue_comments_438083.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\n> Actually you need to use `ZZ.one()/width` (not `1/width`), which should do the trick. Sorry about the confusion.\n> Alternatively, you find a method to map `width` to a sage ring element and then still do the fraction field.\n\nI do not get at all all this fuss.\n\nThe default of `width` should be set to `None`. If no value is given, the algorithm will fetch the base ring of the object and take `.one()` of that base ring and continue with that value.\n\nIf the user gives a weird value for the width, that's the user's problem (the whole `Polyhedron` class is based on this principle). It is not at all expected that the base ring is preserved. Only if possible (which is handled by the intersection method...\n\nThe only thing that matters is the backend. Thus the returned polyhedron should have the right backend...\n\nI fail to see the issue here.",
    "created_at": "2019-07-25T13:51:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438083",
    "user": "https://github.com/jplab"
}
```

<a id='comment:41'>Comment 41:</a>
> Actually you need to use `ZZ.one()/width` (not `1/width`), which should do the trick. Sorry about the confusion.
> Alternatively, you find a method to map `width` to a sage ring element and then still do the fraction field.

I do not get at all all this fuss.

The default of `width` should be set to `None`. If no value is given, the algorithm will fetch the base ring of the object and take `.one()` of that base ring and continue with that value.

If the user gives a weird value for the width, that's the user's problem (the whole `Polyhedron` class is based on this principle). It is not at all expected that the base ring is preserved. Only if possible (which is handled by the intersection method...

The only thing that matters is the backend. Thus the returned polyhedron should have the right backend...

I fail to see the issue here.



---

archive/issue_comments_438084.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\n... in particular, I do not see at all why a `base_extend` would be necessary.",
    "created_at": "2019-07-25T13:56:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438084",
    "user": "https://github.com/jplab"
}
```

<a id='comment:42'>Comment 42:</a>
... in particular, I do not see at all why a `base_extend` would be necessary.



---

archive/issue_comments_438085.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\n`H` should be well-defined and with correct backend. This is what we need `base_extend` for.\nI didn't check if we really need the value `1/width`.\nI don't find a python integer to be a overly strange input.\nEspecially, since we already put in the effort to make our default work.\n\nUsing standard constructor for `H` with backend argument can result in an error, when the backend doesn't support `width`.\nStandard constructor without backend argument, will not preserve backend, e.g. with `self` being integral.\n\n`base_extend` does preserve backend whenever possible, which is exactly what we want.\n\nBtw, can't we just write down all equations and inequalities right away.\nThis saves the time of calculating double description for two (possibly large) intermediate polyhedra.",
    "created_at": "2019-07-25T14:41:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438085",
    "user": "https://github.com/kliem"
}
```

<a id='comment:43'>Comment 43:</a>
`H` should be well-defined and with correct backend. This is what we need `base_extend` for.
I didn't check if we really need the value `1/width`.
I don't find a python integer to be a overly strange input.
Especially, since we already put in the effort to make our default work.

Using standard constructor for `H` with backend argument can result in an error, when the backend doesn't support `width`.
Standard constructor without backend argument, will not preserve backend, e.g. with `self` being integral.

`base_extend` does preserve backend whenever possible, which is exactly what we want.

Btw, can't we just write down all equations and inequalities right away.
This saves the time of calculating double description for two (possibly large) intermediate polyhedra.



---

archive/issue_comments_438086.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nReplying to [@kliem](#comment%3A43):\n> `H` should be well-defined and with correct backend. This is what we need `base_extend` for.\n\n`H` is a totally well defined object on whatever reasonable given value of `width` that is given by the user. There is no such thing as correct backend at this stage. All you would do is try to do a good guess before `intersection` will proceed to do exactly the same, but with the help of coercion. So why try to do things twice?\n\nIf the user doesn't say a word, then for sure we should just take a width from the same base ring. Then, the story with backend is irrelevant since this should be taken care of in the intersection method, and not in this specific place.\n\n> I didn't check if we really need the value `1/width`.\n> I don't find a python integer to be a overly strange input.\n> Especially, since we already put in the effort to make our default work.\n\nThe code is barely 15 lines long... ;-)\n\n> Using standard constructor for `H` with backend argument can result in an error, when the backend doesn't support `width`.\n\nNow I see what you mean. But again that business should be taken care of by intersection, and not here.\n\n> Standard constructor without backend argument, will not preserve backend, e.g. with `self` being integral.\n> \n> `base_extend` does preserve backend whenever possible, which is exactly what we want.\n\nAgreed. But this is a hack, and I do not like that solution. Further, one line after `H` is defined it is passed right away to intersection.\n\n> Btw, can't we just write down all equations and inequalities right away.\n> This saves the time of calculating double description for two (possibly large) intermediate polyhedra.\n\nYes, and the long term idea is to have intersection do this kind of redundancy checks using `normaliz` tools. (long term...) Once adding inequalities dynamically will be readily available in Sage, we can talk about it again. For now, I don't think we have to deal with this in this ticket.\n\nIn the end, the wedge is the intersection of an infinite prism over the given polyhedron (trivial to keep base ring and backend) and an infinite `keil` defined by two inequalities. The base ring of this `keil` is decided by the type of `width`, and the backend should also be decided from the type of `width`.\n\nThen, the decision for the backend of the intersection should be delegated to `.intersection` method. Why all the fuss here in wedge? If the user gives a float width and had normaliz as a backend, why should it stay normaliz? It can't!\n\nThe coercion will just figure out the right object and backend... This is already taken care of in intersection.\n\nThe following illustrates exactly the behavior that I expect to happen in `wedge`:\n\n```\nsage: P = Polyhedron(rays=[[1,0],[0,1]],base_ring=RDF)\nsage: Q = Polyhedron(rays=[[-1,0],[0,1]],vertices=[[1,0]],backend='normaliz')\nsage: P & Q\nA 2-dimensional polyhedron in RDF^2 defined as the convex hull of 2 vertices and 1 ray\nsage: P.backend()\n'cdd'\nsage: Q.backend()\n'normaliz'\n```",
    "created_at": "2019-07-25T15:16:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438086",
    "user": "https://github.com/jplab"
}
```

<a id='comment:44'>Comment 44:</a>
Replying to [@kliem](#comment%3A43):
> `H` should be well-defined and with correct backend. This is what we need `base_extend` for.

`H` is a totally well defined object on whatever reasonable given value of `width` that is given by the user. There is no such thing as correct backend at this stage. All you would do is try to do a good guess before `intersection` will proceed to do exactly the same, but with the help of coercion. So why try to do things twice?

If the user doesn't say a word, then for sure we should just take a width from the same base ring. Then, the story with backend is irrelevant since this should be taken care of in the intersection method, and not in this specific place.

> I didn't check if we really need the value `1/width`.
> I don't find a python integer to be a overly strange input.
> Especially, since we already put in the effort to make our default work.

The code is barely 15 lines long... ;-)

> Using standard constructor for `H` with backend argument can result in an error, when the backend doesn't support `width`.

Now I see what you mean. But again that business should be taken care of by intersection, and not here.

> Standard constructor without backend argument, will not preserve backend, e.g. with `self` being integral.
> 
> `base_extend` does preserve backend whenever possible, which is exactly what we want.

Agreed. But this is a hack, and I do not like that solution. Further, one line after `H` is defined it is passed right away to intersection.

> Btw, can't we just write down all equations and inequalities right away.
> This saves the time of calculating double description for two (possibly large) intermediate polyhedra.

Yes, and the long term idea is to have intersection do this kind of redundancy checks using `normaliz` tools. (long term...) Once adding inequalities dynamically will be readily available in Sage, we can talk about it again. For now, I don't think we have to deal with this in this ticket.

In the end, the wedge is the intersection of an infinite prism over the given polyhedron (trivial to keep base ring and backend) and an infinite `keil` defined by two inequalities. The base ring of this `keil` is decided by the type of `width`, and the backend should also be decided from the type of `width`.

Then, the decision for the backend of the intersection should be delegated to `.intersection` method. Why all the fuss here in wedge? If the user gives a float width and had normaliz as a backend, why should it stay normaliz? It can't!

The coercion will just figure out the right object and backend... This is already taken care of in intersection.

The following illustrates exactly the behavior that I expect to happen in `wedge`:

```
sage: P = Polyhedron(rays=[[1,0],[0,1]],base_ring=RDF)
sage: Q = Polyhedron(rays=[[-1,0],[0,1]],vertices=[[1,0]],backend='normaliz')
sage: P & Q
A 2-dimensional polyhedron in RDF^2 defined as the convex hull of 2 vertices and 1 ray
sage: P.backend()
'cdd'
sage: Q.backend()
'normaliz'
```



---

archive/issue_comments_438087.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nThe problem is not float. A float is going to change backend to `cdd`, which is fine.\n\nLet `P` with parent `Polyhedra_normaliz_ZZ` and `Q` with parent `Polyhedra_ppl_QQ` then coercion will lead the intersection to be an element of `Polyhedra_ppl_QQ`, because there is a map in exactly one direction.\n\nHence, intersection might change the backend (it might prefer backend of `self` or `other` depending on the involved rings).\nHowever, I would expect a user to create all polyhedra with his preferred backend, so that shouldn't cause issues.\n\nNow, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.",
    "created_at": "2019-07-25T17:48:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438087",
    "user": "https://github.com/kliem"
}
```

<a id='comment:45'>Comment 45:</a>
The problem is not float. A float is going to change backend to `cdd`, which is fine.

Let `P` with parent `Polyhedra_normaliz_ZZ` and `Q` with parent `Polyhedra_ppl_QQ` then coercion will lead the intersection to be an element of `Polyhedra_ppl_QQ`, because there is a map in exactly one direction.

Hence, intersection might change the backend (it might prefer backend of `self` or `other` depending on the involved rings).
However, I would expect a user to create all polyhedra with his preferred backend, so that shouldn't cause issues.

Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.



---

archive/issue_comments_438088.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\n> Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.\n\nI thought that the solution since the beginning is to query the backend of `self`and apply it to `H`. If it fails, well this is a bad day for the user, because the backend will have to change whatsoever, due to the type of input, which we should trust is what the user wants.\n\nHence, try to create `H` with the backend of self, it is fails, just create `H` using the type of the given width.\n\nI would let `intersection` alone here and still trust it to do what is right when the time comes.\n\nIn the end, that the backend is not preserved by an operation which is not intended to, is not the end of the world. Is it?",
    "created_at": "2019-07-25T17:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438088",
    "user": "https://github.com/jplab"
}
```

<a id='comment:46'>Comment 46:</a>
> Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.

I thought that the solution since the beginning is to query the backend of `self`and apply it to `H`. If it fails, well this is a bad day for the user, because the backend will have to change whatsoever, due to the type of input, which we should trust is what the user wants.

Hence, try to create `H` with the backend of self, it is fails, just create `H` using the type of the given width.

I would let `intersection` alone here and still trust it to do what is right when the time comes.

In the end, that the backend is not preserved by an operation which is not intended to, is not the end of the world. Is it?



---

archive/issue_comments_438089.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nReplying to [@jplab](#comment%3A46):\n> \n> > Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.\n\n> \n> I thought that the solution since the beginning is to query the backend of `self`and apply it to `H`. If it fails, well this is a bad day for the user, because the backend will have to change whatsoever, due to the type of input, which we should trust is what the user wants.\n> \n> Hence, try to create `H` with the backend of self, it is fails, just create `H` using the type of the given width.\n\nThis is exactly what `base_extend` does. It changes the parent as little as possible. Of course you can also use the constructor with `try` and `except`, which is what `base_extend` does (but cached).\n> \n> I would let `intersection` alone here and still trust it to do what is right when the time comes.\n\nIt will always prefer the backend of the polyhedron with larger ring due to coercion.\n> \n> In the end, that the backend is not preserved by an operation which is not intended to, is not the end of the world. Is it?\n\nIt is a pain, if it could have been prevented. If working with large polyhedra, which are manageable with `normaliz` and take forever with `ppl` you don't want the backend to change.\n\nTo ask a user to to `base_extend` before wedge over face is very sudle.",
    "created_at": "2019-07-25T18:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438089",
    "user": "https://github.com/kliem"
}
```

<a id='comment:47'>Comment 47:</a>
Replying to [@jplab](#comment%3A46):
> 
> > Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.

> 
> I thought that the solution since the beginning is to query the backend of `self`and apply it to `H`. If it fails, well this is a bad day for the user, because the backend will have to change whatsoever, due to the type of input, which we should trust is what the user wants.
> 
> Hence, try to create `H` with the backend of self, it is fails, just create `H` using the type of the given width.

This is exactly what `base_extend` does. It changes the parent as little as possible. Of course you can also use the constructor with `try` and `except`, which is what `base_extend` does (but cached).
> 
> I would let `intersection` alone here and still trust it to do what is right when the time comes.

It will always prefer the backend of the polyhedron with larger ring due to coercion.
> 
> In the end, that the backend is not preserved by an operation which is not intended to, is not the end of the world. Is it?

It is a pain, if it could have been prevented. If working with large polyhedra, which are manageable with `normaliz` and take forever with `ppl` you don't want the backend to change.

To ask a user to to `base_extend` before wedge over face is very sudle.



---

archive/issue_comments_438090.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nBy the way, I don't really care how one initialized `H`. I just think it should have the backend of `self` if `width` admits it.",
    "created_at": "2019-07-25T20:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438090",
    "user": "https://github.com/kliem"
}
```

<a id='comment:48'>Comment 48:</a>
By the way, I don't really care how one initialized `H`. I just think it should have the backend of `self` if `width` admits it.



---

archive/issue_comments_438091.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nReplying to [@kliem](#comment%3A47):\n> Replying to [@jplab](#comment%3A46):\n> > \n> > > Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.\n\n> > \n> > I thought that the solution since the beginning is to query the backend of `self`and apply it to `H`. If it fails, well this is a bad day for the user, because the backend will have to change whatsoever, due to the type of input, which we should trust is what the user wants.\n> > \n> > Hence, try to create `H` with the backend of self, it is fails, just create `H` using the type of the given width.\n\n> \n> This is exactly what `base_extend` does. It changes the parent as little as possible. Of course you can also use the constructor with `try` and `except`, which is what `base_extend` does (but cached).\n\nOk, fine. But I would not do this business with `1/width`, etc.\n\n> > \n> > I would let `intersection` alone here and still trust it to do what is right when the time comes.\n\n> \n> It will always prefer the backend of the polyhedron with larger ring due to coercion.\n> > \n> > In the end, that the backend is not preserved by an operation which is not intended to, is not the end of the world. Is it?\n\n> \n> It is a pain, if it could have been prevented. If working with large polyhedra, which are manageable with `normaliz` and take forever with `ppl` you don't want the backend to change.\n\nObviously.\n\n> To ask a user to to `base_extend` before wedge over face is very sudle.\n\nSudle? I am not sure to understand what you mean. Do you have any concrete suggestion for the code now?",
    "created_at": "2019-07-28T10:21:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438091",
    "user": "https://github.com/jplab"
}
```

<a id='comment:49'>Comment 49:</a>
Replying to [@kliem](#comment%3A47):
> Replying to [@jplab](#comment%3A46):
> > 
> > > Now, if we create a polyhedron `H` with default backend (and not what the user chose as backend of `self`) this might cause the `backend` to change. I think one could only prevent this by not using coercion for intersection.

> > 
> > I thought that the solution since the beginning is to query the backend of `self`and apply it to `H`. If it fails, well this is a bad day for the user, because the backend will have to change whatsoever, due to the type of input, which we should trust is what the user wants.
> > 
> > Hence, try to create `H` with the backend of self, it is fails, just create `H` using the type of the given width.

> 
> This is exactly what `base_extend` does. It changes the parent as little as possible. Of course you can also use the constructor with `try` and `except`, which is what `base_extend` does (but cached).

Ok, fine. But I would not do this business with `1/width`, etc.

> > 
> > I would let `intersection` alone here and still trust it to do what is right when the time comes.

> 
> It will always prefer the backend of the polyhedron with larger ring due to coercion.
> > 
> > In the end, that the backend is not preserved by an operation which is not intended to, is not the end of the world. Is it?

> 
> It is a pain, if it could have been prevented. If working with large polyhedra, which are manageable with `normaliz` and take forever with `ppl` you don't want the backend to change.

Obviously.

> To ask a user to to `base_extend` before wedge over face is very sudle.

Sudle? I am not sure to understand what you mean. Do you have any concrete suggestion for the code now?



---

archive/issue_comments_438092.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nReplying to [@jplab](#comment%3A49):\n> Replying to [@kliem](#comment%3A47):\n> > Replying to [@jplab](#comment%3A46):\n> > To ask a user to to `base_extend` before wedge over face is very sudle.\n\n> \n> Sudle? I am not sure to understand what you mean. Do you have any concrete suggestion for the code now?\n\nIn many cases polyhedra will by default be set up with base ring `ZZ` like in\n\n```\nsage: P = polytopes.simplex(backend='normaliz'); type(P)\n<class 'sage.geometry.polyhedron.parent.Polyhedra_ZZ_normaliz_with_category.element_class'>\n```\n\nIf a user wants to keep his backend and we ask him to change the base ring to `QQ` before doing wedge over face, this is confusing.",
    "created_at": "2019-07-30T12:57:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438092",
    "user": "https://github.com/kliem"
}
```

<a id='comment:50'>Comment 50:</a>
Replying to [@jplab](#comment%3A49):
> Replying to [@kliem](#comment%3A47):
> > Replying to [@jplab](#comment%3A46):
> > To ask a user to to `base_extend` before wedge over face is very sudle.

> 
> Sudle? I am not sure to understand what you mean. Do you have any concrete suggestion for the code now?

In many cases polyhedra will by default be set up with base ring `ZZ` like in

```
sage: P = polytopes.simplex(backend='normaliz'); type(P)
<class 'sage.geometry.polyhedron.parent.Polyhedra_ZZ_normaliz_with_category.element_class'>
```

If a user wants to keep his backend and we ask him to change the base ring to `QQ` before doing wedge over face, this is confusing.



---

archive/issue_events_365413.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-08-21T14:03:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365413"
}
```



---

archive/issue_events_365414.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-08-21T14:03:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365414"
}
```



---

archive/issue_comments_438093.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nA few comments:\n\n* In the docstring `indicates how wide the resulted wedge should be`: I would say: `This parameter specifies how wide the wedge will be`.\n\n* `A (bounded) Polyhedron object` -> `A (bounded) polyhedron`\n\n* Please provide me a simple argument as to why the field of fraction of the base ring should be used \"by default\" (i.e. when the width is 1). I would say that the resulting base ring should be determined by the constructor. Yes, this will depend on the input polytope, which is fine. Further, yes, the backend should be preserved if possible, which simply means that one should pass it to the constructor. What do I see wrong?\n\nBecause we are using `Q.intersection(H)`, on top of what is done before, it is going to do a coercion to find the appropriate thing to do. I do not really understand why we force the parent of `H` to be the fraction field if it might not be necessary.\n\n* The text inside of the TEST is misleading since even if we give a different value to width, the base ring *will* change. ... so again, I am confused about how this is done. Further, the tests should provide a bit more demonstration as to how it preserves the backend (please show at least how it preserves 2 backends, with appropriate base rings).",
    "created_at": "2019-08-21T14:03:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438093",
    "user": "https://github.com/jplab"
}
```

<a id='comment:51'>Comment 51:</a>
A few comments:

* In the docstring `indicates how wide the resulted wedge should be`: I would say: `This parameter specifies how wide the wedge will be`.

* `A (bounded) Polyhedron object` -> `A (bounded) polyhedron`

* Please provide me a simple argument as to why the field of fraction of the base ring should be used "by default" (i.e. when the width is 1). I would say that the resulting base ring should be determined by the constructor. Yes, this will depend on the input polytope, which is fine. Further, yes, the backend should be preserved if possible, which simply means that one should pass it to the constructor. What do I see wrong?

Because we are using `Q.intersection(H)`, on top of what is done before, it is going to do a coercion to find the appropriate thing to do. I do not really understand why we force the parent of `H` to be the fraction field if it might not be necessary.

* The text inside of the TEST is misleading since even if we give a different value to width, the base ring *will* change. ... so again, I am confused about how this is done. Further, the tests should provide a bit more demonstration as to how it preserves the backend (please show at least how it preserves 2 backends, with appropriate base rings).



---

archive/issue_comments_438094.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nReplying to [@jplab](#comment%3A51):\n> A few comments:\n> \n> * In the docstring `indicates how wide the resulted wedge should be`: I would say: `This parameter specifies how wide the wedge will be`.\n> \n> * `A (bounded) Polyhedron object` -> `A (bounded) polyhedron`\n> \n> * Please provide me a simple argument as to why the field of fraction of the base ring should be used \"by default\" (i.e. when the width is 1). I would say that the resulting base ring should be determined by the constructor. Yes, this will depend on the input polytope, which is fine. Further, yes, the backend should be preserved if possible, which simply means that one should pass it to the constructor. What do I see wrong?\n\nI agree that is makes no sense to use the field of fractions, when `width` is 1. I guess we should use the field of fractions whenever `width` is not a unit.\n\nIf we just pass the `backend` to the constructor, we get an error if the value of `width` is not handled by the current backend. Is this the desired behavior? If you don't like the current setup, we can also just use `does_backend_handle_base_ring` from parent.py (its basically a cached version of doing `try ... except` for the constructor).",
    "created_at": "2019-08-23T21:21:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438094",
    "user": "https://github.com/kliem"
}
```

<a id='comment:52'>Comment 52:</a>
Replying to [@jplab](#comment%3A51):
> A few comments:
> 
> * In the docstring `indicates how wide the resulted wedge should be`: I would say: `This parameter specifies how wide the wedge will be`.
> 
> * `A (bounded) Polyhedron object` -> `A (bounded) polyhedron`
> 
> * Please provide me a simple argument as to why the field of fraction of the base ring should be used "by default" (i.e. when the width is 1). I would say that the resulting base ring should be determined by the constructor. Yes, this will depend on the input polytope, which is fine. Further, yes, the backend should be preserved if possible, which simply means that one should pass it to the constructor. What do I see wrong?

I agree that is makes no sense to use the field of fractions, when `width` is 1. I guess we should use the field of fractions whenever `width` is not a unit.

If we just pass the `backend` to the constructor, we get an error if the value of `width` is not handled by the current backend. Is this the desired behavior? If you don't like the current setup, we can also just use `does_backend_handle_base_ring` from parent.py (its basically a cached version of doing `try ... except` for the constructor).



---

archive/issue_comments_438095.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nReplying to [@kliem](#comment%3A52):\n> Replying to [@jplab](#comment%3A51):\n> > A few comments:\n> > \n> > * In the docstring `indicates how wide the resulted wedge should be`: I would say: `This parameter specifies how wide the wedge will be`.\n> > \n> > * `A (bounded) Polyhedron object` -> `A (bounded) polyhedron`\n> > \n> > * Please provide me a simple argument as to why the field of fraction of the base ring should be used \"by default\" (i.e. when the width is 1). I would say that the resulting base ring should be determined by the constructor. Yes, this will depend on the input polytope, which is fine. Further, yes, the backend should be preserved if possible, which simply means that one should pass it to the constructor. What do I see wrong?\n\n> \n> I agree that is makes no sense to use the field of fractions, when `width` is 1. I guess we should use the field of fractions whenever `width` is not a unit.\n> \n> If we just pass the `backend` to the constructor, we get an error if the value of `width` is not handled by the current backend. Is this the desired behavior? \n\nI guess not. \n\n> If you don't like the current setup, we can also just use `does_backend_handle_base_ring` from parent.py (its basically a cached version of doing `try ... except` for the constructor).\n\nYes, to me that's probably the best intermediate to proceed this way and let the intersection deal with the rest.",
    "created_at": "2019-08-26T10:23:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438095",
    "user": "https://github.com/jplab"
}
```

<a id='comment:53'>Comment 53:</a>
Replying to [@kliem](#comment%3A52):
> Replying to [@jplab](#comment%3A51):
> > A few comments:
> > 
> > * In the docstring `indicates how wide the resulted wedge should be`: I would say: `This parameter specifies how wide the wedge will be`.
> > 
> > * `A (bounded) Polyhedron object` -> `A (bounded) polyhedron`
> > 
> > * Please provide me a simple argument as to why the field of fraction of the base ring should be used "by default" (i.e. when the width is 1). I would say that the resulting base ring should be determined by the constructor. Yes, this will depend on the input polytope, which is fine. Further, yes, the backend should be preserved if possible, which simply means that one should pass it to the constructor. What do I see wrong?

> 
> I agree that is makes no sense to use the field of fractions, when `width` is 1. I guess we should use the field of fractions whenever `width` is not a unit.
> 
> If we just pass the `backend` to the constructor, we get an error if the value of `width` is not handled by the current backend. Is this the desired behavior? 

I guess not. 

> If you don't like the current setup, we can also just use `does_backend_handle_base_ring` from parent.py (its basically a cached version of doing `try ... except` for the constructor).

Yes, to me that's probably the best intermediate to proceed this way and let the intersection deal with the rest.



---

archive/issue_comments_438096.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nMerged with newest develop.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73dac038bb83c51824d02130c9d4f1930607b9f3\">73dac03</a></td><td><code>add wedge method in Polyhedron class in base.py</code></td></tr></table>\n",
    "created_at": "2019-08-26T11:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438096",
    "user": "https://github.com/kliem"
}
```

<a id='comment:54'>Comment 54:</a>
Merged with newest develop.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73dac038bb83c51824d02130c9d4f1930607b9f3">73dac03</a></td><td><code>add wedge method in Polyhedron class in base.py</code></td></tr></table>




---

archive/issue_comments_438097.json:
```json
{
    "body": "Changed branch from **[public/27973](https://github.com/sagemath/sagetrac-mirror/tree/public/27973)** to **[public/27973-new](https://github.com/sagemath/sagetrac-mirror/tree/public/27973-new)**",
    "created_at": "2019-08-26T11:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438097",
    "user": "https://github.com/kliem"
}
```

Changed branch from **[public/27973](https://github.com/sagemath/sagetrac-mirror/tree/public/27973)** to **[public/27973-new](https://github.com/sagemath/sagetrac-mirror/tree/public/27973-new)**



---

archive/issue_comments_438098.json:
```json
{
    "body": "Changed commit from **[6ba5594](https://github.com/sagemath/sagetrac-mirror/commit/6ba559456a3770c5517956db2d7ae1ed44a8d717)** to **[73dac03](https://github.com/sagemath/sagetrac-mirror/commit/73dac038bb83c51824d02130c9d4f1930607b9f3)**",
    "created_at": "2019-08-26T11:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438098",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[6ba5594](https://github.com/sagemath/sagetrac-mirror/commit/6ba559456a3770c5517956db2d7ae1ed44a8d717)** to **[73dac03](https://github.com/sagemath/sagetrac-mirror/commit/73dac038bb83c51824d02130c9d4f1930607b9f3)**



---

archive/issue_comments_438099.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba\">38944ad</a></td><td><code>simplified construction of H, small changes mostly in the documentation</code></td></tr></table>\n",
    "created_at": "2019-08-26T12:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438099",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:55'>Comment 55:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba">38944ad</a></td><td><code>simplified construction of H, small changes mostly in the documentation</code></td></tr></table>




---

archive/issue_comments_438100.json:
```json
{
    "body": "Changed commit from **[73dac03](https://github.com/sagemath/sagetrac-mirror/commit/73dac038bb83c51824d02130c9d4f1930607b9f3)** to **[38944ad](https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba)**",
    "created_at": "2019-08-26T12:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438100",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[73dac03](https://github.com/sagemath/sagetrac-mirror/commit/73dac038bb83c51824d02130c9d4f1930607b9f3)** to **[38944ad](https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba)**



---

archive/issue_events_365415.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-08-26T12:43:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365415"
}
```



---

archive/issue_events_365416.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2019-08-26T12:43:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365416"
}
```



---

archive/issue_comments_438101.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nTried to simplify construction of `H`.\n\nBtw, I also tried to preserve the `base_ring` (when width is 1), but this did not work for the test in line 4205.",
    "created_at": "2019-08-26T12:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438101",
    "user": "https://github.com/kliem"
}
```

<a id='comment:56'>Comment 56:</a>
Tried to simplify construction of `H`.

Btw, I also tried to preserve the `base_ring` (when width is 1), but this did not work for the test in line 4205.



---

archive/issue_comments_438102.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nThe sentence:\n\n```diff\n+        The base_ring will change to the field of fractions of the current\n+        base_ring, unless width forces a different ring.\n```\n\nis still confusing as it says that the base ring always will change to the field of fractions. What if it stays as ZZ? (which is possible). This should be fixed...\n\nThe rest seems to be good.",
    "created_at": "2019-08-26T13:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438102",
    "user": "https://github.com/jplab"
}
```

<a id='comment:57'>Comment 57:</a>
The sentence:

```diff
+        The base_ring will change to the field of fractions of the current
+        base_ring, unless width forces a different ring.
```

is still confusing as it says that the base ring always will change to the field of fractions. What if it stays as ZZ? (which is possible). This should be fixed...

The rest seems to be good.



---

archive/issue_comments_438103.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\nReplying to [@jplab](#comment%3A57):\n> The sentence:\n> \n> ```diff\n> +        The base_ring will change to the field of fractions of the current\n> +        base_ring, unless width forces a different ring.\n> ```\n> \n> is still confusing as it says that the base ring always will change to the field of fractions. What if it stays as ZZ? (which is \n\nI don't think so. `H` is constructed from inequalities without specifying the basering. In this case the constructor coerces the base rings of all values and then takes the fraction field. If you want `ZZ` as basering when constructing a polyhedron from inequalities, you need to specify it for the constructor.\n>This should be fixed...\n> \n> The rest seems to be good.",
    "created_at": "2019-08-26T13:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438103",
    "user": "https://github.com/kliem"
}
```

<a id='comment:58'>Comment 58:</a>
Replying to [@jplab](#comment%3A57):
> The sentence:
> 
> ```diff
> +        The base_ring will change to the field of fractions of the current
> +        base_ring, unless width forces a different ring.
> ```
> 
> is still confusing as it says that the base ring always will change to the field of fractions. What if it stays as ZZ? (which is 

I don't think so. `H` is constructed from inequalities without specifying the basering. In this case the constructor coerces the base rings of all values and then takes the fraction field. If you want `ZZ` as basering when constructing a polyhedron from inequalities, you need to specify it for the constructor.
>This should be fixed...
> 
> The rest seems to be good.



---

archive/issue_comments_438104.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nReplying to [@kliem](#comment%3A58):\n> Replying to [@jplab](#comment%3A57):\n> > The sentence:\n> > \n> > ```diff\n> > +        The base_ring will change to the field of fractions of the current\n> > +        base_ring, unless width forces a different ring.\n> > ```\n> > \n> > is still confusing as it says that the base ring always will change to the field of fractions. What if it stays as ZZ? (which is \n\n> \n> I don't think so. `H` is constructed from inequalities without specifying the basering. In this case the constructor coerces the base rings of all values and then takes the fraction field. If you want `ZZ` as basering when constructing a polyhedron from inequalities, you need to specify it for the constructor.\n\nOk... fine.",
    "created_at": "2019-08-26T14:48:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438104",
    "user": "https://github.com/jplab"
}
```

<a id='comment:59'>Comment 59:</a>
Replying to [@kliem](#comment%3A58):
> Replying to [@jplab](#comment%3A57):
> > The sentence:
> > 
> > ```diff
> > +        The base_ring will change to the field of fractions of the current
> > +        base_ring, unless width forces a different ring.
> > ```
> > 
> > is still confusing as it says that the base ring always will change to the field of fractions. What if it stays as ZZ? (which is 

> 
> I don't think so. `H` is constructed from inequalities without specifying the basering. In this case the constructor coerces the base rings of all values and then takes the fraction field. If you want `ZZ` as basering when constructing a polyhedron from inequalities, you need to specify it for the constructor.

Ok... fine.



---

archive/issue_comments_438105.json:
```json
{
    "body": "<a id='comment:60'>Comment 60:</a>\nIs this good to go now?",
    "created_at": "2019-08-29T18:51:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438105",
    "user": "https://github.com/kliem"
}
```

<a id='comment:60'>Comment 60:</a>
Is this good to go now?



---

archive/issue_comments_438106.json:
```json
{
    "body": "Changed author from **Laith Rastanawi** to **Laith Rastanawi, Jonathan Kliem**",
    "created_at": "2019-08-30T12:41:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438106",
    "user": "https://github.com/jplab"
}
```

Changed author from **Laith Rastanawi** to **Laith Rastanawi, Jonathan Kliem**



---

archive/issue_comments_438107.json:
```json
{
    "body": "Reviewer: **Jean-Philippe Labb\u00e9**",
    "created_at": "2019-08-30T12:41:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438107",
    "user": "https://github.com/jplab"
}
```

Reviewer: **Jean-Philippe Labbé**



---

archive/issue_events_365417.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-08-30T12:41:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365417"
}
```



---

archive/issue_events_365418.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-08-30T12:41:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365418"
}
```



---

archive/issue_comments_438108.json:
```json
{
    "body": "Changed branch from **[public/27973-new](https://github.com/sagemath/sagetrac-mirror/tree/public/27973-new)** to **[38944ad](https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba)**",
    "created_at": "2019-09-05T21:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27973#issuecomment-438108",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/27973-new](https://github.com/sagemath/sagetrac-mirror/tree/public/27973-new)** to **[38944ad](https://github.com/sagemath/sagetrac-mirror/commit/38944ad77e0a7ca760e97fcef85f2b957fe83eba)**



---

archive/issue_events_365419.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-09-05T21:33:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365419"
}
```



---

archive/issue_events_365420.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "c04ab097b13b46d4649548ebbb9e3edb0f3fa67c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-09-05T21:33:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27973",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27973#event-365420"
}
```
