# Issue 27993: Make outer normal fans readily available

archive/issues_027756.json:
```json
{
    "assignees": [],
    "body": "For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.\n\nAs an example, create the polytope on p.193 of Ziegler's \"Lectures on Polytopes\" with its normal fan:\n\n```\nsage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]\nsage: P=Polyhedron(V)\nsage: NormalFan(P)\n```\n\nThe result is the inner normal fan of `P`, which is the outer normal fan of `-P`.\n\nThis ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.\n\nAdditionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\nThis allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n\n\n**CC:**  @jplab\n\n**Keywords:** NormalFan, polytope, days100\n\n**Branch/Commit:** [440689c758f36b80c4dd0a9a88eee5c5d60f2b22](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)\n\n**Reviewer:** Jean-Philippe Labb\u00e9, Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Julian Ritter\n\nIssue created by migration from https://trac.sagemath.org/ticket/27993\n\n",
    "closed_at": "2019-07-29T21:54:56Z",
    "created_at": "2019-06-14T14:46:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make outer normal fans readily available",
    "type": "issue",
    "updated_at": "2019-07-29T21:54:56Z",
    "url": "https://github.com/sagemath/sage/issues/27993",
    "user": "https://github.com/sagetrac-nailuj"
}
```
For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.

As an example, create the polytope on p.193 of Ziegler's "Lectures on Polytopes" with its normal fan:

```
sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]
sage: P=Polyhedron(V)
sage: NormalFan(P)
```

The result is the inner normal fan of `P`, which is the outer normal fan of `-P`.

This ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.

Additionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.


**CC:**  @jplab

**Keywords:** NormalFan, polytope, days100

**Branch/Commit:** [440689c758f36b80c4dd0a9a88eee5c5d60f2b22](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)

**Reviewer:** Jean-Philippe Labbé, Frédéric Chapoton

**Author:** Julian Ritter

Issue created by migration from https://trac.sagemath.org/ticket/27993





---

archive/issue_comments_438276.json:
```json
{
    "body": "**Branch:** [u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)",
    "created_at": "2019-06-14T14:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438276",
    "user": "https://github.com/sagetrac-nailuj"
}
```

**Branch:** [u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)



---

archive/issue_comments_438277.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57d550854eea4adb1d51278479db75245473a5ed\">57d5508</a></td><td><code>added direction argument to NormalFan</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932\">484bf56</a></td><td><code>added outer_normal method</code></td></tr></table>\n",
    "created_at": "2019-06-14T14:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438277",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57d550854eea4adb1d51278479db75245473a5ed">57d5508</a></td><td><code>added direction argument to NormalFan</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932">484bf56</a></td><td><code>added outer_normal method</code></td></tr></table>




---

archive/issue_comments_438278.json:
```json
{
    "body": "**Commit:** [484bf563c383e0b0fc85fd3e2af991dfb41a9932](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)",
    "created_at": "2019-06-14T14:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438278",
    "user": "https://github.com/sagetrac-nailuj"
}
```

**Commit:** [484bf563c383e0b0fc85fd3e2af991dfb41a9932](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)



---

archive/issue_events_247064.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-06-14T14:49:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247064"
}
```



---

archive/issue_comments_438279.json:
```json
{
    "body": "<a id='comment:3'></a>\nSage 8.8 is to be released fairly soon so unless this is a blocker this should be moved to the next release.",
    "created_at": "2019-06-14T14:51:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438279",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>
Sage 8.8 is to be released fairly soon so unless this is a blocker this should be moved to the next release.



---

archive/issue_events_247065.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:51:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247065"
}
```



---

archive/issue_events_247066.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:51:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247066"
}
```



---

archive/issue_comments_438280.json:
```json
{
    "body": "<a id='comment:4'></a>\nI don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.",
    "created_at": "2019-06-14T16:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438280",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:4'></a>
I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.



---

archive/issue_comments_438281.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [@novoselt](#comment%3A4):\n> I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.\n\n+1\n\nI would leave the default as it is and add the `direction` argument to allow to get the variant.",
    "created_at": "2019-06-15T09:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438281",
    "user": "https://github.com/jplab"
}
```

<a id='comment:5'></a>
Replying to [@novoselt](#comment%3A4):
> I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.

+1

I would leave the default as it is and add the `direction` argument to allow to get the variant.



---

archive/issue_comments_438282.json:
```json
{
    "body": "<a id='comment:6'></a>\nActually, I think now it would be better to allow quick \"direction flip\" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.",
    "created_at": "2019-06-15T20:01:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438282",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:6'></a>
Actually, I think now it would be better to allow quick "direction flip" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.



---

archive/issue_comments_438283.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [@novoselt](#comment%3A6):\n> Actually, I think now it would be better to allow quick \"direction flip\" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.\n\nThis seems to already be possible for `Polyhedron` objects:\n\n```\nsage: p = polytopes.regular_polygon(5)\nsage: p.vertices()\n(A vertex at (0.5877852522924731?, -0.8090169943749474?),\n A vertex at (0.9510565162951536?, 0.3090169943749474?),\n A vertex at (0, 1),\n A vertex at (-0.5877852522924731?, -0.8090169943749474?),\n A vertex at (-0.9510565162951536?, 0.3090169943749474?))\nsage: (-p).vertices()\n(A vertex at (-0.5877852522924731?, 0.8090169943749474?),\n A vertex at (-0.9510565162951536?, -0.3090169943749474?),\n A vertex at (0, -1),\n A vertex at (0.587785252292474?, 0.8090169943749474?),\n A vertex at (0.9510565162951536?, -0.3090169943749474?))\n```\n\nOr you have something else in mind?\n\nYes, I would use `NormalFan(-P)`  or `NormalFan(P)` depending on whether one wants the inner or outer. This seems like the easiest thing to do. One does not need to go into the `Polyhedron` constructor...",
    "created_at": "2019-06-15T23:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438283",
    "user": "https://github.com/jplab"
}
```

<a id='comment:7'></a>
Replying to [@novoselt](#comment%3A6):
> Actually, I think now it would be better to allow quick "direction flip" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.

This seems to already be possible for `Polyhedron` objects:

```
sage: p = polytopes.regular_polygon(5)
sage: p.vertices()
(A vertex at (0.5877852522924731?, -0.8090169943749474?),
 A vertex at (0.9510565162951536?, 0.3090169943749474?),
 A vertex at (0, 1),
 A vertex at (-0.5877852522924731?, -0.8090169943749474?),
 A vertex at (-0.9510565162951536?, 0.3090169943749474?))
sage: (-p).vertices()
(A vertex at (-0.5877852522924731?, 0.8090169943749474?),
 A vertex at (-0.9510565162951536?, -0.3090169943749474?),
 A vertex at (0, -1),
 A vertex at (0.587785252292474?, 0.8090169943749474?),
 A vertex at (0.9510565162951536?, -0.3090169943749474?))
```

Or you have something else in mind?

Yes, I would use `NormalFan(-P)`  or `NormalFan(P)` depending on whether one wants the inner or outer. This seems like the easiest thing to do. One does not need to go into the `Polyhedron` constructor...



---

archive/issue_comments_438284.json:
```json
{
    "body": "<a id='comment:8'></a>\nThat's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.",
    "created_at": "2019-06-15T23:21:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438284",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>
That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.



---

archive/issue_events_247067.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-17T11:27:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247067"
}
```



---

archive/issue_events_247068.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-17T11:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247068"
}
```



---

archive/issue_comments_438285.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [@novoselt](#comment%3A8):\n> That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.\n\nI believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.\n\nThat said, I would change the description of the ticket as follows:\n\n> I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.\n\nAbove I would keep the current default.\n\n> Additionally, I propose to add in sage.geometry.polyhedron.representation a method Inequality.outer_normal. This allows to obtain the outer normal vector without having to think about the appropriate sign of Inequality.A() whenever dealing with the facet inequalities of a polyhedron. \n\nThis is good to me.\n\nFurther, I would suggest to add \n\n> Use `NormalFan(-P)` to get the outer normal fan.\n\nin the documentation of `NormalFan`.",
    "created_at": "2019-07-17T11:27:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438285",
    "user": "https://github.com/jplab"
}
```

<a id='comment:9'></a>
Replying to [@novoselt](#comment%3A8):
> That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.

I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.

That said, I would change the description of the ticket as follows:

> I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.

Above I would keep the current default.

> Additionally, I propose to add in sage.geometry.polyhedron.representation a method Inequality.outer_normal. This allows to obtain the outer normal vector without having to think about the appropriate sign of Inequality.A() whenever dealing with the facet inequalities of a polyhedron. 

This is good to me.

Further, I would suggest to add 

> Use `NormalFan(-P)` to get the outer normal fan.

in the documentation of `NormalFan`.



---

archive/issue_comments_438286.json:
```json
{
    "body": "**Changing commit** from \"[484bf563c383e0b0fc85fd3e2af991dfb41a9932](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)\" to \"[b41def5d69156640996e4a6e60d29d17b36bd435](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)\".",
    "created_at": "2019-07-22T12:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438286",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[484bf563c383e0b0fc85fd3e2af991dfb41a9932](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)" to "[b41def5d69156640996e4a6e60d29d17b36bd435](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)".



---

archive/issue_comments_438287.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8763cfb599939cd609099f9ab0705a861a79c9c\">d8763cf</a></td><td><code>Revert \"added direction argument to NormalFan\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bfda6e46213d20d94dbaa4b87bb71e1d1f7389a\">7bfda6e</a></td><td><code>added hint to NormalFan(-P)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c653c97785a52d9a19c147e0a9bb686408120e1\">0c653c9</a></td><td><code>added direction argument to Polyhedron.normal_fan</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435\">b41def5</a></td><td><code>Merge branch 'develop' into normalfan_outer</code></td></tr></table>\n",
    "created_at": "2019-07-22T12:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438287",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8763cfb599939cd609099f9ab0705a861a79c9c">d8763cf</a></td><td><code>Revert "added direction argument to NormalFan"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bfda6e46213d20d94dbaa4b87bb71e1d1f7389a">7bfda6e</a></td><td><code>added hint to NormalFan(-P)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c653c97785a52d9a19c147e0a9bb686408120e1">0c653c9</a></td><td><code>added direction argument to Polyhedron.normal_fan</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435">b41def5</a></td><td><code>Merge branch 'develop' into normalfan_outer</code></td></tr></table>




---

archive/issue_comments_438288.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1\">fd3e899</a></td><td><code>Fixed typo</code></td></tr></table>\n",
    "created_at": "2019-07-22T12:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438288",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1">fd3e899</a></td><td><code>Fixed typo</code></td></tr></table>




---

archive/issue_comments_438289.json:
```json
{
    "body": "**Changing commit** from \"[b41def5d69156640996e4a6e60d29d17b36bd435](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)\" to \"[fd3e89926e9648fb36bb2c087deb24b0c3938ef1](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)\".",
    "created_at": "2019-07-22T12:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438289",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b41def5d69156640996e4a6e60d29d17b36bd435](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)" to "[fd3e89926e9648fb36bb2c087deb24b0c3938ef1](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)".



---

archive/issue_comments_438290.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [@jplab](#comment%3A9):\n> Replying to [@novoselt](#comment%3A8):\n> > That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.\n\n> \n> I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.\n\nYes. I stumbled upon this inner-outer issue through `Polyhedron.normal_fan()`. This is why I added jipilab in CC in the first place, and this is where I should have proposed to make `'outer'` the default \u2013 my bad. I'm fine with `'inner'` as default in both files. My main goal was easier access to outer normal fans, which is now available and explained in the docstrings.\n\n> That said, I would change the description of the ticket as follows:\n> \n> > I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.\n\nDone.\n \n> Further, I would suggest to add \n> \n> > Use `NormalFan(-P)` to get the outer normal fan.\n\n> \n> in the documentation of `NormalFan`.\n\nDone.",
    "created_at": "2019-07-22T13:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438290",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<a id='comment:12'></a>
Replying to [@jplab](#comment%3A9):
> Replying to [@novoselt](#comment%3A8):
> > That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.

> 
> I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.

Yes. I stumbled upon this inner-outer issue through `Polyhedron.normal_fan()`. This is why I added jipilab in CC in the first place, and this is where I should have proposed to make `'outer'` the default – my bad. I'm fine with `'inner'` as default in both files. My main goal was easier access to outer normal fans, which is now available and explained in the docstrings.

> That said, I would change the description of the ticket as follows:
> 
> > I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.

Done.
 
> Further, I would suggest to add 
> 
> > Use `NormalFan(-P)` to get the outer normal fan.

> 
> in the documentation of `NormalFan`.

Done.



---

archive/issue_comments_438291.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -19,8 +19,9 @@\n In both cases, the normal vectors obtained are directed towards the interior of the polytope. \n Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.\n \n-I propose to add to `NormalFan` an argument `direction` set to either `'outer'` or `'inner'` to determine which of the directions to use. \n-In line with the definition in Ziegler's book, I would prefer to make `'outer'` the default choice.\n+\n+I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.\n+\n \n Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\n This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n``````\n",
    "created_at": "2019-07-22T13:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438291",
    "user": "https://github.com/sagetrac-nailuj"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -19,8 +19,9 @@
 In both cases, the normal vectors obtained are directed towards the interior of the polytope. 
 Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.
 
-I propose to add to `NormalFan` an argument `direction` set to either `'outer'` or `'inner'` to determine which of the directions to use. 
-In line with the definition in Ziegler's book, I would prefer to make `'outer'` the default choice.
+
+I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.
+
 
 Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
 This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.
``````




---

archive/issue_events_247069.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-22T13:15:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247069"
}
```



---

archive/issue_events_247070.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-22T13:15:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247070"
}
```



---

archive/issue_comments_438292.json:
```json
{
    "body": "**Reviewer:** Jean-Philippe Labb\u00e9",
    "created_at": "2019-07-22T15:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438292",
    "user": "https://github.com/jplab"
}
```

**Reviewer:** Jean-Philippe Labbé



---

archive/issue_events_247071.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-22T15:58:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247071"
}
```



---

archive/issue_events_247072.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-22T15:58:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247072"
}
```



---

archive/issue_comments_438293.json:
```json
{
    "body": "**Changing keywords** from \"NormalFan, polytope\" to \"NormalFan, polytope, days100\".",
    "created_at": "2019-07-22T15:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438293",
    "user": "https://github.com/jplab"
}
```

**Changing keywords** from "NormalFan, polytope" to "NormalFan, polytope, days100".



---

archive/issue_comments_438294.json:
```json
{
    "body": "<a id='comment:13'></a>\n- The optional parameters should receive an appropriate doctest. For example:\n\n   ```\n   sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()\n   sage: inner_nf = p.normal_fan()\n   sage: inner_nf.rays()\n   N( 1,  0,  0),\n   N(-1,  1,  1),\n   N(-1,  1, -1),\n   N(-1, -1, -1),\n   N(-1, -1,  1)\n   in 3-d lattice N\n   \n   sage: outer_nf = p.normal_fan(direction='outer')\n   sage: outer_nf.rays()\n   N(-1,  0,  0),\n   N( 1,  1, -1),\n   N( 1,  1,  1),\n   N( 1, -1,  1),\n   N( 1, -1, -1)\n   in 3-d lattice N\n```\n\n- Further, it would be nice to disallow such things:\n\n```\nsage: outer_nf = p.normal_fan(direction='blabla')\n```\n   by checking that direction is one of the two allowed things (see the volume function for a similar handling).\n\n- Remove the space before the semi-colon in the docstring of `normal_fan`.",
    "created_at": "2019-07-22T15:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438294",
    "user": "https://github.com/jplab"
}
```

<a id='comment:13'></a>
- The optional parameters should receive an appropriate doctest. For example:

   ```
   sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()
   sage: inner_nf = p.normal_fan()
   sage: inner_nf.rays()
   N( 1,  0,  0),
   N(-1,  1,  1),
   N(-1,  1, -1),
   N(-1, -1, -1),
   N(-1, -1,  1)
   in 3-d lattice N
   
   sage: outer_nf = p.normal_fan(direction='outer')
   sage: outer_nf.rays()
   N(-1,  0,  0),
   N( 1,  1, -1),
   N( 1,  1,  1),
   N( 1, -1,  1),
   N( 1, -1, -1)
   in 3-d lattice N
```

- Further, it would be nice to disallow such things:

```
sage: outer_nf = p.normal_fan(direction='blabla')
```
   by checking that direction is one of the two allowed things (see the volume function for a similar handling).

- Remove the space before the semi-colon in the docstring of `normal_fan`.



---

archive/issue_comments_438295.json:
```json
{
    "body": "**Changing commit** from \"[fd3e89926e9648fb36bb2c087deb24b0c3938ef1](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)\" to \"[308dada78b84d1436dca28bd970e768d6ea6c42b](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)\".",
    "created_at": "2019-07-23T07:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438295",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[fd3e89926e9648fb36bb2c087deb24b0c3938ef1](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)" to "[308dada78b84d1436dca28bd970e768d6ea6c42b](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)".



---

archive/issue_comments_438296.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/257d367898ae768446fecfae495b4c549078e369\">257d367</a></td><td><code>Added check that the direction is inner or outer</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ae5e6832ca58278bff15d33d20bbddb3cf36268\">5ae5e68</a></td><td><code>pyflakes fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/691046ad277f0a4bb30606cbbc3b3add0cb83f6e\">691046a</a></td><td><code>fixed typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b\">308dada</a></td><td><code>added examples</code></td></tr></table>\n",
    "created_at": "2019-07-23T07:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438296",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/257d367898ae768446fecfae495b4c549078e369">257d367</a></td><td><code>Added check that the direction is inner or outer</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ae5e6832ca58278bff15d33d20bbddb3cf36268">5ae5e68</a></td><td><code>pyflakes fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/691046ad277f0a4bb30606cbbc3b3add0cb83f6e">691046a</a></td><td><code>fixed typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b">308dada</a></td><td><code>added examples</code></td></tr></table>




---

archive/issue_events_247073.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-23T08:06:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247073"
}
```



---

archive/issue_events_247074.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-23T08:06:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247074"
}
```



---

archive/issue_comments_438297.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [@jplab](#comment%3A13):\n> The optional parameters should receive an appropriate doctest. For example:\n> \n>    ```\n>    sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()\n>    sage: inner_nf = p.normal_fan()\n>    sage: inner_nf.rays()\n>    N( 1,  0,  0),\n>    N(-1,  1,  1),\n>    N(-1,  1, -1),\n>    N(-1, -1, -1),\n>    N(-1, -1,  1)\n>    in 3-d lattice N\n>    \n>    sage: outer_nf = p.normal_fan(direction='outer')\n>    sage: outer_nf.rays()\n>    N(-1,  0,  0),\n>    N( 1,  1, -1),\n>    N( 1,  1,  1),\n>    N( 1, -1,  1),\n>    N( 1, -1, -1)\n>    in 3-d lattice N\n> ```\n\nI added a 2-d example testing inner, outer, and an invalid direction.\n\n> Further, it would be nice to disallow such things:\n> \n> ```\n> sage: outer_nf = p.normal_fan(direction='blabla')\n> ```\n> by checking that direction is one of the two allowed things (see the volume function for a similar handling).\n\nDone.\n \n> Remove the space before the semi-colon in the docstring of `normal_fan`.\n\nDone.",
    "created_at": "2019-07-23T08:06:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438297",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<a id='comment:15'></a>
Replying to [@jplab](#comment%3A13):
> The optional parameters should receive an appropriate doctest. For example:
> 
>    ```
>    sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()
>    sage: inner_nf = p.normal_fan()
>    sage: inner_nf.rays()
>    N( 1,  0,  0),
>    N(-1,  1,  1),
>    N(-1,  1, -1),
>    N(-1, -1, -1),
>    N(-1, -1,  1)
>    in 3-d lattice N
>    
>    sage: outer_nf = p.normal_fan(direction='outer')
>    sage: outer_nf.rays()
>    N(-1,  0,  0),
>    N( 1,  1, -1),
>    N( 1,  1,  1),
>    N( 1, -1,  1),
>    N( 1, -1, -1)
>    in 3-d lattice N
> ```

I added a 2-d example testing inner, outer, and an invalid direction.

> Further, it would be nice to disallow such things:
> 
> ```
> sage: outer_nf = p.normal_fan(direction='blabla')
> ```
> by checking that direction is one of the two allowed things (see the volume function for a similar handling).

Done.
 
> Remove the space before the semi-colon in the docstring of `normal_fan`.

Done.



---

archive/issue_comments_438298.json:
```json
{
    "body": "<a id='comment:16'></a>\nGreat!\n\nCould you do one change: the backtick in the error message should be a single quote.\n\nI would also fix the title of the ticket and the description to reflect the actual changes involved.",
    "created_at": "2019-07-23T08:44:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438298",
    "user": "https://github.com/jplab"
}
```

<a id='comment:16'></a>
Great!

Could you do one change: the backtick in the error message should be a single quote.

I would also fix the title of the ticket and the description to reflect the actual changes involved.



---

archive/issue_comments_438299.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd\">9d20a1d</a></td><td><code>replaced backtick by single quote</code></td></tr></table>\n",
    "created_at": "2019-07-23T13:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438299",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd">9d20a1d</a></td><td><code>replaced backtick by single quote</code></td></tr></table>




---

archive/issue_comments_438300.json:
```json
{
    "body": "**Changing commit** from \"[308dada78b84d1436dca28bd970e768d6ea6c42b](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)\" to \"[9d20a1d2ef73c9fa4e89dc0657033191d22793fd](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)\".",
    "created_at": "2019-07-23T13:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438300",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[308dada78b84d1436dca28bd970e768d6ea6c42b](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)" to "[9d20a1d2ef73c9fa4e89dc0657033191d22793fd](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)".



---

archive/issue_comments_438301.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [@jplab](#comment%3A16):\n> Could you do one change: the backtick in the error message should be a single quote.\n\nDone.\n\n> I would also fix the title of the ticket and the description to reflect the actual changes involved.\n\nDone.",
    "created_at": "2019-07-23T13:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438301",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<a id='comment:18'></a>
Replying to [@jplab](#comment%3A16):
> Could you do one change: the backtick in the error message should be a single quote.

Done.

> I would also fix the title of the ticket and the description to reflect the actual changes involved.

Done.



---

archive/issue_comments_438302.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,28 +1,17 @@\n-\n+For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.\n \n As an example, create the polytope on p.193 of Ziegler's \"Lectures on Polytopes\" with its normal fan:\n \n ```\n sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]\n sage: P=Polyhedron(V)\n-sage: L=LatticePolytope(V)\n-sage: FanP, FanL = NormalFan(P), NormalFan(L)\n-sage: FanP == FanL\n-True\n+sage: NormalFan(P)\n ```\n \n-The two fans are equal, but they are not the same as the one presented in Ziegler's book.\n-In fact, following to the definition there, `FanP` and `FanL` give the normal fan of `-P`.\n+The result is the inner normal fan of `P`, which is the outer normal fan of `-P`.\n \n-The construction of `NormalFan(polytope)` uses the normal vectors of the facets, given by `polytope.facet_normals()` for a `LatticePolytope` \n-or given by `ieq.A() for ieq in polytope.inequalities()` for a `Polyhedron`.\n-In both cases, the normal vectors obtained are directed towards the interior of the polytope. \n-Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.\n+This ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.\n \n-\n-I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.\n-\n-\n-Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\n+Additionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\n This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n \n``````\n",
    "created_at": "2019-07-23T13:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438302",
    "user": "https://github.com/sagetrac-nailuj"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,28 +1,17 @@
-
+For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.
 
 As an example, create the polytope on p.193 of Ziegler's "Lectures on Polytopes" with its normal fan:
 
 ```
 sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]
 sage: P=Polyhedron(V)
-sage: L=LatticePolytope(V)
-sage: FanP, FanL = NormalFan(P), NormalFan(L)
-sage: FanP == FanL
-True
+sage: NormalFan(P)
 ```
 
-The two fans are equal, but they are not the same as the one presented in Ziegler's book.
-In fact, following to the definition there, `FanP` and `FanL` give the normal fan of `-P`.
+The result is the inner normal fan of `P`, which is the outer normal fan of `-P`.
 
-The construction of `NormalFan(polytope)` uses the normal vectors of the facets, given by `polytope.facet_normals()` for a `LatticePolytope` 
-or given by `ieq.A() for ieq in polytope.inequalities()` for a `Polyhedron`.
-In both cases, the normal vectors obtained are directed towards the interior of the polytope. 
-Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.
+This ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.
 
-
-I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.
-
-
-Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
+Additionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
 This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.
 
``````




---

archive/issue_events_247075.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-23T13:59:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "rename": {
        "from": "NormalFan: issue with inner and outer normal vectors",
        "to": "Make outer normal fans readily available"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247075"
}
```



---

archive/issue_comments_438303.json:
```json
{
    "body": "<a id='comment:19'></a>\nThe doctest still has backticks.",
    "created_at": "2019-07-23T20:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438303",
    "user": "https://github.com/jplab"
}
```

<a id='comment:19'></a>
The doctest still has backticks.



---

archive/issue_comments_438304.json:
```json
{
    "body": "**Changing commit** from \"[9d20a1d2ef73c9fa4e89dc0657033191d22793fd](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)\" to \"[440689c758f36b80c4dd0a9a88eee5c5d60f2b22](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)\".",
    "created_at": "2019-07-24T06:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438304",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[9d20a1d2ef73c9fa4e89dc0657033191d22793fd](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)" to "[440689c758f36b80c4dd0a9a88eee5c5d60f2b22](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)".



---

archive/issue_comments_438305.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22\">440689c</a></td><td><code>replaced backticks in doctest</code></td></tr></table>\n",
    "created_at": "2019-07-24T06:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438305",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22">440689c</a></td><td><code>replaced backticks in doctest</code></td></tr></table>




---

archive/issue_events_247076.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-24T09:53:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247076"
}
```



---

archive/issue_events_247077.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-24T09:53:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247077"
}
```



---

archive/issue_comments_438306.json:
```json
{
    "body": "<a id='comment:21'></a>\nok, c'est correct",
    "created_at": "2019-07-24T09:53:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438306",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
ok, c'est correct



---

archive/issue_comments_438307.json:
```json
{
    "body": "**Changing reviewer** from \"Jean-Philippe Labb\u00e9\" to \"Jean-Philippe Labb\u00e9, Fr\u00e9d\u00e9ric Chapoton\".",
    "created_at": "2019-07-24T09:53:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438307",
    "user": "https://github.com/fchapoton"
}
```

**Changing reviewer** from "Jean-Philippe Labbé" to "Jean-Philippe Labbé, Frédéric Chapoton".



---

archive/issue_events_247078.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-29T21:54:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247078"
}
```



---

archive/issue_events_247079.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d9e505667792ce0468dbbbcaf02a290f12da074d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-07-29T21:54:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-247079"
}
```



---

archive/issue_comments_438308.json:
```json
{
    "body": "**Changing branch** from \"[u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)\" to \"[440689c758f36b80c4dd0a9a88eee5c5d60f2b22](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)\".",
    "created_at": "2019-07-29T21:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-438308",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)" to "[440689c758f36b80c4dd0a9a88eee5c5d60f2b22](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)".
