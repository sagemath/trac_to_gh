# Issue 27993: Make outer normal fans readily available

archive/issues_027756.json:
```json
{
    "assignees": [],
    "body": "For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.\n\nAs an example, create the polytope on p.193 of Ziegler's \"Lectures on Polytopes\" with its normal fan:\n\n```\nsage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]\nsage: P=Polyhedron(V)\nsage: NormalFan(P)\n```\n\nThe result is the inner normal fan of `P`, which is the outer normal fan of `-P`.\n\nThis ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.\n\nAdditionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\nThis allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n\n\nCC:  @jplab\n\nKeywords: **NormalFan, polytope, days100**\n\nBranch/Commit: **[`440689c`](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)**\n\nReviewer: **Jean-Philippe Labb\u00e9, Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Julian Ritter**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27993_\n\n",
    "closed_at": "2019-07-29T21:54:56Z",
    "created_at": "2019-06-14T14:46:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make outer normal fans readily available",
    "type": "issue",
    "updated_at": "2019-07-29T21:54:56Z",
    "url": "https://github.com/sagemath/sage/issues/27993",
    "user": "https://github.com/sagetrac-nailuj"
}
```
For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.

As an example, create the polytope on p.193 of Ziegler's "Lectures on Polytopes" with its normal fan:

```
sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]
sage: P=Polyhedron(V)
sage: NormalFan(P)
```

The result is the inner normal fan of `P`, which is the outer normal fan of `-P`.

This ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.

Additionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.


CC:  @jplab

Keywords: **NormalFan, polytope, days100**

Branch/Commit: **[`440689c`](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)**

Reviewer: **Jean-Philippe Labbé, Frédéric Chapoton**

Author: **Julian Ritter**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/27993_





---

archive/issue_events_380932.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-06-14T14:46:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380932"
}
```



---

archive/issue_events_380933.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-06-14T14:46:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380933"
}
```



---

archive/issue_events_380934.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-06-14T14:46:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380934"
}
```



---

archive/issue_events_380935.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-06-14T14:46:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380935"
}
```



---

archive/issue_comments_435466.json:
```json
{
    "body": "Branch: **[u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)**",
    "created_at": "2019-06-14T14:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435466",
    "user": "https://github.com/sagetrac-nailuj"
}
```

Branch: **[u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)**



---

archive/issue_comments_435467.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57d550854eea4adb1d51278479db75245473a5ed\"><code>57d5508</code></a></td><td><code>added direction argument to NormalFan</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932\"><code>484bf56</code></a></td><td><code>added outer_normal method</code></td></tr></table>\n",
    "created_at": "2019-06-14T14:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435467",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57d550854eea4adb1d51278479db75245473a5ed"><code>57d5508</code></a></td><td><code>added direction argument to NormalFan</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932"><code>484bf56</code></a></td><td><code>added outer_normal method</code></td></tr></table>




---

archive/issue_comments_435468.json:
```json
{
    "body": "Commit: **[`484bf56`](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)**",
    "created_at": "2019-06-14T14:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435468",
    "user": "https://github.com/sagetrac-nailuj"
}
```

Commit: **[`484bf56`](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)**



---

archive/issue_events_380936.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-06-14T14:49:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380936"
}
```



---

archive/issue_comments_435469.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSage 8.8 is to be released fairly soon so unless this is a blocker this should be moved to the next release.",
    "created_at": "2019-06-14T14:51:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435469",
    "user": "https://github.com/embray"
}
```

<div id="comment:3" align="right">comment:3</div>

Sage 8.8 is to be released fairly soon so unless this is a blocker this should be moved to the next release.



---

archive/issue_events_380937.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:51:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380937"
}
```



---

archive/issue_events_380938.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:51:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380938"
}
```



---

archive/issue_comments_435470.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.",
    "created_at": "2019-06-14T16:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435470",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:4" align="right">comment:4</div>

I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.



---

archive/issue_comments_435471.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@novoselt](#comment:4):\n> I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.\n\n+1\n\nI would leave the default as it is and add the `direction` argument to allow to get the variant.",
    "created_at": "2019-06-15T09:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435471",
    "user": "https://github.com/jplab"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@novoselt](#comment:4):
> I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.

+1

I would leave the default as it is and add the `direction` argument to allow to get the variant.



---

archive/issue_comments_435472.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nActually, I think now it would be better to allow quick \"direction flip\" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.",
    "created_at": "2019-06-15T20:01:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435472",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:6" align="right">comment:6</div>

Actually, I think now it would be better to allow quick "direction flip" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.



---

archive/issue_comments_435473.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@novoselt](#comment:6):\n> Actually, I think now it would be better to allow quick \"direction flip\" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.\n\nThis seems to already be possible for `Polyhedron` objects:\n\n```\nsage: p = polytopes.regular_polygon(5)\nsage: p.vertices()\n(A vertex at (0.5877852522924731?, -0.8090169943749474?),\n A vertex at (0.9510565162951536?, 0.3090169943749474?),\n A vertex at (0, 1),\n A vertex at (-0.5877852522924731?, -0.8090169943749474?),\n A vertex at (-0.9510565162951536?, 0.3090169943749474?))\nsage: (-p).vertices()\n(A vertex at (-0.5877852522924731?, 0.8090169943749474?),\n A vertex at (-0.9510565162951536?, -0.3090169943749474?),\n A vertex at (0, -1),\n A vertex at (0.587785252292474?, 0.8090169943749474?),\n A vertex at (0.9510565162951536?, -0.3090169943749474?))\n```\n\nOr you have something else in mind?\n\nYes, I would use `NormalFan(-P)`  or `NormalFan(P)` depending on whether one wants the inner or outer. This seems like the easiest thing to do. One does not need to go into the `Polyhedron` constructor...",
    "created_at": "2019-06-15T23:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435473",
    "user": "https://github.com/jplab"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@novoselt](#comment:6):
> Actually, I think now it would be better to allow quick "direction flip" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.

This seems to already be possible for `Polyhedron` objects:

```
sage: p = polytopes.regular_polygon(5)
sage: p.vertices()
(A vertex at (0.5877852522924731?, -0.8090169943749474?),
 A vertex at (0.9510565162951536?, 0.3090169943749474?),
 A vertex at (0, 1),
 A vertex at (-0.5877852522924731?, -0.8090169943749474?),
 A vertex at (-0.9510565162951536?, 0.3090169943749474?))
sage: (-p).vertices()
(A vertex at (-0.5877852522924731?, 0.8090169943749474?),
 A vertex at (-0.9510565162951536?, -0.3090169943749474?),
 A vertex at (0, -1),
 A vertex at (0.587785252292474?, 0.8090169943749474?),
 A vertex at (0.9510565162951536?, -0.3090169943749474?))
```

Or you have something else in mind?

Yes, I would use `NormalFan(-P)`  or `NormalFan(P)` depending on whether one wants the inner or outer. This seems like the easiest thing to do. One does not need to go into the `Polyhedron` constructor...



---

archive/issue_comments_435474.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThat's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.",
    "created_at": "2019-06-15T23:21:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435474",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:8" align="right">comment:8</div>

That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.



---

archive/issue_events_380939.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-17T11:27:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380939"
}
```



---

archive/issue_events_380940.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-17T11:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380940"
}
```



---

archive/issue_comments_435475.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@novoselt](#comment:8):\n> That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.\n\nI believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.\n\nThat said, I would change the description of the ticket as follows:\n\n> I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.\n\nAbove I would keep the current default.\n\n> Additionally, I propose to add in sage.geometry.polyhedron.representation a method Inequality.outer_normal. This allows to obtain the outer normal vector without having to think about the appropriate sign of Inequality.A() whenever dealing with the facet inequalities of a polyhedron. \n\nThis is good to me.\n\nFurther, I would suggest to add \n\n> Use `NormalFan(-P)` to get the outer normal fan.\n\nin the documentation of `NormalFan`.",
    "created_at": "2019-07-17T11:27:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435475",
    "user": "https://github.com/jplab"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@novoselt](#comment:8):
> That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.

I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.

That said, I would change the description of the ticket as follows:

> I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.

Above I would keep the current default.

> Additionally, I propose to add in sage.geometry.polyhedron.representation a method Inequality.outer_normal. This allows to obtain the outer normal vector without having to think about the appropriate sign of Inequality.A() whenever dealing with the facet inequalities of a polyhedron. 

This is good to me.

Further, I would suggest to add 

> Use `NormalFan(-P)` to get the outer normal fan.

in the documentation of `NormalFan`.



---

archive/issue_comments_435476.json:
```json
{
    "body": "Changed commit from **[`484bf56`](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)** to **[`b41def5`](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)**",
    "created_at": "2019-07-22T12:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435476",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`484bf56`](https://github.com/sagemath/sagetrac-mirror/commit/484bf563c383e0b0fc85fd3e2af991dfb41a9932)** to **[`b41def5`](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)**



---

archive/issue_comments_435477.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8763cfb599939cd609099f9ab0705a861a79c9c\"><code>d8763cf</code></a></td><td><code>Revert \"added direction argument to NormalFan\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bfda6e46213d20d94dbaa4b87bb71e1d1f7389a\"><code>7bfda6e</code></a></td><td><code>added hint to NormalFan(-P)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c653c97785a52d9a19c147e0a9bb686408120e1\"><code>0c653c9</code></a></td><td><code>added direction argument to Polyhedron.normal_fan</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435\"><code>b41def5</code></a></td><td><code>Merge branch 'develop' into normalfan_outer</code></td></tr></table>\n",
    "created_at": "2019-07-22T12:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435477",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8763cfb599939cd609099f9ab0705a861a79c9c"><code>d8763cf</code></a></td><td><code>Revert "added direction argument to NormalFan"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bfda6e46213d20d94dbaa4b87bb71e1d1f7389a"><code>7bfda6e</code></a></td><td><code>added hint to NormalFan(-P)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c653c97785a52d9a19c147e0a9bb686408120e1"><code>0c653c9</code></a></td><td><code>added direction argument to Polyhedron.normal_fan</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435"><code>b41def5</code></a></td><td><code>Merge branch 'develop' into normalfan_outer</code></td></tr></table>




---

archive/issue_comments_435478.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1\"><code>fd3e899</code></a></td><td><code>Fixed typo</code></td></tr></table>\n",
    "created_at": "2019-07-22T12:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435478",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1"><code>fd3e899</code></a></td><td><code>Fixed typo</code></td></tr></table>




---

archive/issue_comments_435479.json:
```json
{
    "body": "Changed commit from **[`b41def5`](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)** to **[`fd3e899`](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)**",
    "created_at": "2019-07-22T12:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435479",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b41def5`](https://github.com/sagemath/sagetrac-mirror/commit/b41def5d69156640996e4a6e60d29d17b36bd435)** to **[`fd3e899`](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)**



---

archive/issue_comments_435480.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@jplab](#comment:9):\n> Replying to [@novoselt](#comment:8):\n> > That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.\n\n> \n> I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.\n\nYes. I stumbled upon this inner-outer issue through `Polyhedron.normal_fan()`. This is why I added jipilab in CC in the first place, and this is where I should have proposed to make `'outer'` the default \u2013 my bad. I'm fine with `'inner'` as default in both files. My main goal was easier access to outer normal fans, which is now available and explained in the docstrings.\n\n> That said, I would change the description of the ticket as follows:\n> \n> > I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.\n\nDone.\n \n> Further, I would suggest to add \n> \n> > Use `NormalFan(-P)` to get the outer normal fan.\n\n> \n> in the documentation of `NormalFan`.\n\nDone.",
    "created_at": "2019-07-22T13:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435480",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@jplab](#comment:9):
> Replying to [@novoselt](#comment:8):
> > That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.

> 
> I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.

Yes. I stumbled upon this inner-outer issue through `Polyhedron.normal_fan()`. This is why I added jipilab in CC in the first place, and this is where I should have proposed to make `'outer'` the default – my bad. I'm fine with `'inner'` as default in both files. My main goal was easier access to outer normal fans, which is now available and explained in the docstrings.

> That said, I would change the description of the ticket as follows:
> 
> > I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.

Done.
 
> Further, I would suggest to add 
> 
> > Use `NormalFan(-P)` to get the outer normal fan.

> 
> in the documentation of `NormalFan`.

Done.



---

archive/issue_comments_435481.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,8 +19,9 @@\n In both cases, the normal vectors obtained are directed towards the interior of the polytope. \n Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.\n \n-I propose to add to `NormalFan` an argument `direction` set to either `'outer'` or `'inner'` to determine which of the directions to use. \n-In line with the definition in Ziegler's book, I would prefer to make `'outer'` the default choice.\n+\n+I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.\n+\n \n Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\n This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n``````\n",
    "created_at": "2019-07-22T13:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435481",
    "user": "https://github.com/sagetrac-nailuj"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,8 +19,9 @@
 In both cases, the normal vectors obtained are directed towards the interior of the polytope. 
 Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.
 
-I propose to add to `NormalFan` an argument `direction` set to either `'outer'` or `'inner'` to determine which of the directions to use. 
-In line with the definition in Ziegler's book, I would prefer to make `'outer'` the default choice.
+
+I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.
+
 
 Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
 This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.
``````




---

archive/issue_events_380941.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-22T13:15:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380941"
}
```



---

archive/issue_events_380942.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-22T13:15:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380942"
}
```



---

archive/issue_comments_435482.json:
```json
{
    "body": "Reviewer: **Jean-Philippe Labb\u00e9**",
    "created_at": "2019-07-22T15:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435482",
    "user": "https://github.com/jplab"
}
```

Reviewer: **Jean-Philippe Labbé**



---

archive/issue_events_380943.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-22T15:58:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380943"
}
```



---

archive/issue_events_380944.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-07-22T15:58:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380944"
}
```



---

archive/issue_comments_435483.json:
```json
{
    "body": "Changed keywords from **NormalFan, polytope** to **NormalFan, polytope, days100**",
    "created_at": "2019-07-22T15:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435483",
    "user": "https://github.com/jplab"
}
```

Changed keywords from **NormalFan, polytope** to **NormalFan, polytope, days100**



---

archive/issue_comments_435484.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n- The optional parameters should receive an appropriate doctest. For example:\n\n   ```\n   sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()\n   sage: inner_nf = p.normal_fan()\n   sage: inner_nf.rays()\n   N( 1,  0,  0),\n   N(-1,  1,  1),\n   N(-1,  1, -1),\n   N(-1, -1, -1),\n   N(-1, -1,  1)\n   in 3-d lattice N\n   \n   sage: outer_nf = p.normal_fan(direction='outer')\n   sage: outer_nf.rays()\n   N(-1,  0,  0),\n   N( 1,  1, -1),\n   N( 1,  1,  1),\n   N( 1, -1,  1),\n   N( 1, -1, -1)\n   in 3-d lattice N\n```\n\n- Further, it would be nice to disallow such things:\n\n```\nsage: outer_nf = p.normal_fan(direction='blabla')\n```\n   by checking that direction is one of the two allowed things (see the volume function for a similar handling).\n\n- Remove the space before the semi-colon in the docstring of `normal_fan`.",
    "created_at": "2019-07-22T15:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435484",
    "user": "https://github.com/jplab"
}
```

<div id="comment:13" align="right">comment:13</div>

- The optional parameters should receive an appropriate doctest. For example:

   ```
   sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()
   sage: inner_nf = p.normal_fan()
   sage: inner_nf.rays()
   N( 1,  0,  0),
   N(-1,  1,  1),
   N(-1,  1, -1),
   N(-1, -1, -1),
   N(-1, -1,  1)
   in 3-d lattice N
   
   sage: outer_nf = p.normal_fan(direction='outer')
   sage: outer_nf.rays()
   N(-1,  0,  0),
   N( 1,  1, -1),
   N( 1,  1,  1),
   N( 1, -1,  1),
   N( 1, -1, -1)
   in 3-d lattice N
```

- Further, it would be nice to disallow such things:

```
sage: outer_nf = p.normal_fan(direction='blabla')
```
   by checking that direction is one of the two allowed things (see the volume function for a similar handling).

- Remove the space before the semi-colon in the docstring of `normal_fan`.



---

archive/issue_comments_435485.json:
```json
{
    "body": "Changed commit from **[`fd3e899`](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)** to **[`308dada`](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)**",
    "created_at": "2019-07-23T07:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435485",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fd3e899`](https://github.com/sagemath/sagetrac-mirror/commit/fd3e89926e9648fb36bb2c087deb24b0c3938ef1)** to **[`308dada`](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)**



---

archive/issue_comments_435486.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/257d367898ae768446fecfae495b4c549078e369\"><code>257d367</code></a></td><td><code>Added check that the direction is inner or outer</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ae5e6832ca58278bff15d33d20bbddb3cf36268\"><code>5ae5e68</code></a></td><td><code>pyflakes fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/691046ad277f0a4bb30606cbbc3b3add0cb83f6e\"><code>691046a</code></a></td><td><code>fixed typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b\"><code>308dada</code></a></td><td><code>added examples</code></td></tr></table>\n",
    "created_at": "2019-07-23T07:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435486",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/257d367898ae768446fecfae495b4c549078e369"><code>257d367</code></a></td><td><code>Added check that the direction is inner or outer</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ae5e6832ca58278bff15d33d20bbddb3cf36268"><code>5ae5e68</code></a></td><td><code>pyflakes fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/691046ad277f0a4bb30606cbbc3b3add0cb83f6e"><code>691046a</code></a></td><td><code>fixed typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b"><code>308dada</code></a></td><td><code>added examples</code></td></tr></table>




---

archive/issue_events_380945.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-23T08:06:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380945"
}
```



---

archive/issue_events_380946.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-23T08:06:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380946"
}
```



---

archive/issue_comments_435487.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@jplab](#comment:13):\n> The optional parameters should receive an appropriate doctest. For example:\n> \n>    ```\n>    sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()\n>    sage: inner_nf = p.normal_fan()\n>    sage: inner_nf.rays()\n>    N( 1,  0,  0),\n>    N(-1,  1,  1),\n>    N(-1,  1, -1),\n>    N(-1, -1, -1),\n>    N(-1, -1,  1)\n>    in 3-d lattice N\n>    \n>    sage: outer_nf = p.normal_fan(direction='outer')\n>    sage: outer_nf.rays()\n>    N(-1,  0,  0),\n>    N( 1,  1, -1),\n>    N( 1,  1,  1),\n>    N( 1, -1,  1),\n>    N( 1, -1, -1)\n>    in 3-d lattice N\n> ```\n\nI added a 2-d example testing inner, outer, and an invalid direction.\n\n> Further, it would be nice to disallow such things:\n> \n> ```\n> sage: outer_nf = p.normal_fan(direction='blabla')\n> ```\n> by checking that direction is one of the two allowed things (see the volume function for a similar handling).\n\nDone.\n \n> Remove the space before the semi-colon in the docstring of `normal_fan`.\n\nDone.",
    "created_at": "2019-07-23T08:06:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435487",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@jplab](#comment:13):
> The optional parameters should receive an appropriate doctest. For example:
> 
>    ```
>    sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()
>    sage: inner_nf = p.normal_fan()
>    sage: inner_nf.rays()
>    N( 1,  0,  0),
>    N(-1,  1,  1),
>    N(-1,  1, -1),
>    N(-1, -1, -1),
>    N(-1, -1,  1)
>    in 3-d lattice N
>    
>    sage: outer_nf = p.normal_fan(direction='outer')
>    sage: outer_nf.rays()
>    N(-1,  0,  0),
>    N( 1,  1, -1),
>    N( 1,  1,  1),
>    N( 1, -1,  1),
>    N( 1, -1, -1)
>    in 3-d lattice N
> ```

I added a 2-d example testing inner, outer, and an invalid direction.

> Further, it would be nice to disallow such things:
> 
> ```
> sage: outer_nf = p.normal_fan(direction='blabla')
> ```
> by checking that direction is one of the two allowed things (see the volume function for a similar handling).

Done.
 
> Remove the space before the semi-colon in the docstring of `normal_fan`.

Done.



---

archive/issue_comments_435488.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nGreat!\n\nCould you do one change: the backtick in the error message should be a single quote.\n\nI would also fix the title of the ticket and the description to reflect the actual changes involved.",
    "created_at": "2019-07-23T08:44:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435488",
    "user": "https://github.com/jplab"
}
```

<div id="comment:16" align="right">comment:16</div>

Great!

Could you do one change: the backtick in the error message should be a single quote.

I would also fix the title of the ticket and the description to reflect the actual changes involved.



---

archive/issue_comments_435489.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd\"><code>9d20a1d</code></a></td><td><code>replaced backtick by single quote</code></td></tr></table>\n",
    "created_at": "2019-07-23T13:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435489",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd"><code>9d20a1d</code></a></td><td><code>replaced backtick by single quote</code></td></tr></table>




---

archive/issue_comments_435490.json:
```json
{
    "body": "Changed commit from **[`308dada`](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)** to **[`9d20a1d`](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)**",
    "created_at": "2019-07-23T13:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435490",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`308dada`](https://github.com/sagemath/sagetrac-mirror/commit/308dada78b84d1436dca28bd970e768d6ea6c42b)** to **[`9d20a1d`](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)**



---

archive/issue_comments_435491.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jplab](#comment:16):\n> Could you do one change: the backtick in the error message should be a single quote.\n\nDone.\n\n> I would also fix the title of the ticket and the description to reflect the actual changes involved.\n\nDone.",
    "created_at": "2019-07-23T13:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435491",
    "user": "https://github.com/sagetrac-nailuj"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jplab](#comment:16):
> Could you do one change: the backtick in the error message should be a single quote.

Done.

> I would also fix the title of the ticket and the description to reflect the actual changes involved.

Done.



---

archive/issue_comments_435492.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,28 +1,17 @@\n-\n+For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.\n \n As an example, create the polytope on p.193 of Ziegler's \"Lectures on Polytopes\" with its normal fan:\n \n ```\n sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]\n sage: P=Polyhedron(V)\n-sage: L=LatticePolytope(V)\n-sage: FanP, FanL = NormalFan(P), NormalFan(L)\n-sage: FanP == FanL\n-True\n+sage: NormalFan(P)\n ```\n \n-The two fans are equal, but they are not the same as the one presented in Ziegler's book.\n-In fact, following to the definition there, `FanP` and `FanL` give the normal fan of `-P`.\n+The result is the inner normal fan of `P`, which is the outer normal fan of `-P`.\n \n-The construction of `NormalFan(polytope)` uses the normal vectors of the facets, given by `polytope.facet_normals()` for a `LatticePolytope` \n-or given by `ieq.A() for ieq in polytope.inequalities()` for a `Polyhedron`.\n-In both cases, the normal vectors obtained are directed towards the interior of the polytope. \n-Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.\n+This ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.\n \n-\n-I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.\n-\n-\n-Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\n+Additionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\n This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n \n``````\n",
    "created_at": "2019-07-23T13:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435492",
    "user": "https://github.com/sagetrac-nailuj"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,28 +1,17 @@
-
+For a polytope `P`, both `NormalFan(P)` and `P.normal_fan()` return the inner normal fan having the inner facet normals as rays. The outer normal fan, using the outer facet normals, is well-known, but not as easy to find in Sage.
 
 As an example, create the polytope on p.193 of Ziegler's "Lectures on Polytopes" with its normal fan:
 
 ```
 sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]
 sage: P=Polyhedron(V)
-sage: L=LatticePolytope(V)
-sage: FanP, FanL = NormalFan(P), NormalFan(L)
-sage: FanP == FanL
-True
+sage: NormalFan(P)
 ```
 
-The two fans are equal, but they are not the same as the one presented in Ziegler's book.
-In fact, following to the definition there, `FanP` and `FanL` give the normal fan of `-P`.
+The result is the inner normal fan of `P`, which is the outer normal fan of `-P`.
 
-The construction of `NormalFan(polytope)` uses the normal vectors of the facets, given by `polytope.facet_normals()` for a `LatticePolytope` 
-or given by `ieq.A() for ieq in polytope.inequalities()` for a `Polyhedron`.
-In both cases, the normal vectors obtained are directed towards the interior of the polytope. 
-Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.
+This ticket adds to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`. The description of `NormalFan` is extended by a hint to use `NormalFan(-P)` for the outer normal fan.
 
-
-I propose to add to `Polyhedron.normal_fan` an argument `direction` set to either `'inner'` or `'outer'` to determine which of the directions to use. The default will stay `'inner'` in order to match the default of `NormalFan`.
-
-
-Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
+Additionally, this ticket adds in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
 This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.
 
``````




---

archive/issue_events_380947.json:
```json
{
    "actor": "https://github.com/sagetrac-nailuj",
    "created_at": "2019-07-23T13:59:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "title_is": "Make outer normal fans readily available",
    "title_was": "NormalFan: issue with inner and outer normal vectors",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380947"
}
```



---

archive/issue_comments_435493.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe doctest still has backticks.",
    "created_at": "2019-07-23T20:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435493",
    "user": "https://github.com/jplab"
}
```

<div id="comment:19" align="right">comment:19</div>

The doctest still has backticks.



---

archive/issue_comments_435494.json:
```json
{
    "body": "Changed commit from **[`9d20a1d`](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)** to **[`440689c`](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)**",
    "created_at": "2019-07-24T06:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435494",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9d20a1d`](https://github.com/sagemath/sagetrac-mirror/commit/9d20a1d2ef73c9fa4e89dc0657033191d22793fd)** to **[`440689c`](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)**



---

archive/issue_comments_435495.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22\"><code>440689c</code></a></td><td><code>replaced backticks in doctest</code></td></tr></table>\n",
    "created_at": "2019-07-24T06:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435495",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22"><code>440689c</code></a></td><td><code>replaced backticks in doctest</code></td></tr></table>




---

archive/issue_events_380948.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-24T09:53:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380948"
}
```



---

archive/issue_events_380949.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-24T09:53:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380949"
}
```



---

archive/issue_comments_435496.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nok, c'est correct",
    "created_at": "2019-07-24T09:53:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435496",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

ok, c'est correct



---

archive/issue_comments_435497.json:
```json
{
    "body": "Changed reviewer from **Jean-Philippe Labb\u00e9** to **Jean-Philippe Labb\u00e9, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-07-24T09:53:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435497",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Jean-Philippe Labbé** to **Jean-Philippe Labbé, Frédéric Chapoton**



---

archive/issue_events_380950.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-29T21:54:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380950"
}
```



---

archive/issue_events_380951.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d9e505667792ce0468dbbbcaf02a290f12da074d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-07-29T21:54:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27993#event-380951"
}
```



---

archive/issue_comments_435498.json:
```json
{
    "body": "Changed branch from **[u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)** to **[`440689c`](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)**",
    "created_at": "2019-07-29T21:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27993#issuecomment-435498",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/nailuj/normalfan_outer](https://github.com/sagemath/sagetrac-mirror/tree/u/nailuj/normalfan_outer)** to **[`440689c`](https://github.com/sagemath/sagetrac-mirror/commit/440689c758f36b80c4dd0a9a88eee5c5d60f2b22)**
