# Issue 27065: py3: handle the explain_pickle problem

archive/issues_026828.json:
```json
{
    "assignees": [],
    "body": "The file explain_pickle has currently 70 failing doctests with python3. It seems to be very difficult to fix them all.\n\nProposal:\n\n* either (1) remove this file completely\n* or (2) tag all doctests with `#py2`\n\nThis ticket implements option (2): tag all doctests with `#py2`.\n\nFurther work on `explain_pickle` is tracked at #27350.\n\nCC:  @embray @jdemeyer @kiwifb @tscrim @vinklein\n\nBranch: **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27065_\n\n",
    "closed_at": "2019-02-26T23:36:52Z",
    "created_at": "2019-01-15T19:04:33Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: handle the explain_pickle problem",
    "type": "issue",
    "updated_at": "2019-03-06T13:34:38Z",
    "url": "https://github.com/sagemath/sage/issues/27065",
    "user": "https://github.com/fchapoton"
}
```
The file explain_pickle has currently 70 failing doctests with python3. It seems to be very difficult to fix them all.

Proposal:

* either (1) remove this file completely
* or (2) tag all doctests with `#py2`

This ticket implements option (2): tag all doctests with `#py2`.

Further work on `explain_pickle` is tracked at #27350.

CC:  @embray @jdemeyer @kiwifb @tscrim @vinklein

Branch: **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)**

Reviewer: **Jeroen Demeyer**

Author: **Frédéric Chapoton**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/27065_





---

archive/issue_events_372010.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-15T19:04:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372010"
}
```



---

archive/issue_events_372011.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-15T19:04:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "000080",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372011"
}
```



---

archive/issue_events_372012.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-15T19:04:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372012"
}
```



---

archive/issue_events_372013.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-15T19:05:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372013"
}
```



---

archive/issue_comments_417551.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n The file explain_pickle has currently 70 failing doctests with python3. It seems to be very difficult to fix them all.\n \n Proposal:\n-(1) remove this file completely\n-(2) tag all doctests with `#py2`\n \n-I suggest\n+* either (1) remove this file completely\n+\n+* or (2) tag all doctests with `#py2`\n+\n``````\n",
    "created_at": "2019-01-15T19:05:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417551",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,8 @@
 The file explain_pickle has currently 70 failing doctests with python3. It seems to be very difficult to fix them all.
 
 Proposal:
-(1) remove this file completely
-(2) tag all doctests with `#py2`
 
-I suggest
+* either (1) remove this file completely
+
+* or (2) tag all doctests with `#py2`
+
``````




---

archive/issue_comments_417552.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI brought this up on the mailing list some months ago, and consensus of most people who participated in the discussion was to remove this module from Sage, but publish it as a stand-alone package: https://groups.google.com/d/msg/sage-devel/94kP0_Xbx04/x7St89zwCgAJ\n\nI can work on that.  My feeling about it is to make two completely separate Python 2 and Python 3 versions.  Maintenance-wise I don't see that being much of a burden since this module won't likely be maintained much anyways, and after 2020 the Python 2 version can be removed entirely.",
    "created_at": "2019-01-16T10:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417552",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">comment:2</div>

I brought this up on the mailing list some months ago, and consensus of most people who participated in the discussion was to remove this module from Sage, but publish it as a stand-alone package: https://groups.google.com/d/msg/sage-devel/94kP0_Xbx04/x7St89zwCgAJ

I can work on that.  My feeling about it is to make two completely separate Python 2 and Python 3 versions.  Maintenance-wise I don't see that being much of a burden since this module won't likely be maintained much anyways, and after 2020 the Python 2 version can be removed entirely.



---

archive/issue_comments_417553.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nGood. Should we deprecate or can we just remove (given our python3 objective) ?",
    "created_at": "2019-01-16T12:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417553",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

Good. Should we deprecate or can we just remove (given our python3 objective) ?



---

archive/issue_comments_417554.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHere is branch that removes `explain_pickle` from sage.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18bfcb98444219141f0fe2296059faa5cebffeef\">18bfcb9</a></td><td><code>full removal of explain_pickle (turned into an external python package)</code></td></tr></table>\n",
    "created_at": "2019-01-16T12:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417554",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

Here is branch that removes `explain_pickle` from sage.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18bfcb98444219141f0fe2296059faa5cebffeef">18bfcb9</a></td><td><code>full removal of explain_pickle (turned into an external python package)</code></td></tr></table>




---

archive/issue_comments_417555.json:
```json
{
    "body": "Commit: **[18bfcb9](https://github.com/sagemath/sagetrac-mirror/commit/18bfcb98444219141f0fe2296059faa5cebffeef)**",
    "created_at": "2019-01-16T12:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417555",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[18bfcb9](https://github.com/sagemath/sagetrac-mirror/commit/18bfcb98444219141f0fe2296059faa5cebffeef)**



---

archive/issue_comments_417556.json:
```json
{
    "body": "Branch: **[public/ticket/27065](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/27065)**",
    "created_at": "2019-01-16T12:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417556",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[public/ticket/27065](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/27065)**



---

archive/issue_events_372014.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-16T13:29:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "milestone_number": null,
    "milestone_title": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372014"
}
```



---

archive/issue_events_372015.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-16T13:29:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372015"
}
```



---

archive/issue_comments_417557.json:
```json
{
    "body": "Changed commit from **[18bfcb9](https://github.com/sagemath/sagetrac-mirror/commit/18bfcb98444219141f0fe2296059faa5cebffeef)** to **[25afb28](https://github.com/sagemath/sagetrac-mirror/commit/25afb287e294d59341ff4647f128178be227d83b)**",
    "created_at": "2019-01-16T16:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417557",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[18bfcb9](https://github.com/sagemath/sagetrac-mirror/commit/18bfcb98444219141f0fe2296059faa5cebffeef)** to **[25afb28](https://github.com/sagemath/sagetrac-mirror/commit/25afb287e294d59341ff4647f128178be227d83b)**



---

archive/issue_comments_417558.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ead257cf654f607df0ce6d92f16292629b275e9e\">ead257c</a></td><td><code>Merge branch 'public/ticket/27065' in 8.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25afb287e294d59341ff4647f128178be227d83b\">25afb28</a></td><td><code>trac 27065 fixing some doctests</code></td></tr></table>\n",
    "created_at": "2019-01-16T16:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417558",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ead257cf654f607df0ce6d92f16292629b275e9e">ead257c</a></td><td><code>Merge branch 'public/ticket/27065' in 8.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25afb287e294d59341ff4647f128178be227d83b">25afb28</a></td><td><code>trac 27065 fixing some doctests</code></td></tr></table>




---

archive/issue_comments_417559.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWhat to do with the few doctests using `unpickle_newobj` and `unpickle_build` ? Just remove them ?",
    "created_at": "2019-01-16T16:20:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417559",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

What to do with the few doctests using `unpickle_newobj` and `unpickle_build` ? Just remove them ?



---

archive/issue_events_372016.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-16T17:41:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372016"
}
```



---

archive/issue_events_372017.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-16T17:41:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372017"
}
```



---

archive/issue_comments_417560.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI had assumed keep `sage.misc.explain_pickle` but just have it do `from explain_pickle import *` and also raise a deprecation warning if imported.\n\nThis will have to wait, of course, until I make `explain_pickle`, and we can add it either as a standard package, or an optional package (in which case `sage.misc.explain_pickle` should catch `ImportError` and provide some explanation).",
    "created_at": "2019-01-16T17:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417560",
    "user": "https://github.com/embray"
}
```

<div id="comment:8" align="right">comment:8</div>

I had assumed keep `sage.misc.explain_pickle` but just have it do `from explain_pickle import *` and also raise a deprecation warning if imported.

This will have to wait, of course, until I make `explain_pickle`, and we can add it either as a standard package, or an optional package (in which case `sage.misc.explain_pickle` should catch `ImportError` and provide some explanation).



---

archive/issue_comments_417561.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI would recommend making it straight to standard, but this will need a (quick) sage-devel vote.",
    "created_at": "2019-01-16T17:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417561",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

I would recommend making it straight to standard, but this will need a (quick) sage-devel vote.



---

archive/issue_comments_417562.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI'm fine with either way, but point is there should still be some sort of regression for the old module (even if probably very few people use it outside of development--but clearly some do!)",
    "created_at": "2019-01-18T09:52:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417562",
    "user": "https://github.com/embray"
}
```

<div id="comment:10" align="right">comment:10</div>

I'm fine with either way, but point is there should still be some sort of regression for the old module (even if probably very few people use it outside of development--but clearly some do!)



---

archive/issue_comments_417563.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd63b0c05631198a35d8680cde0e18e639dd6692\">cd63b0c</a></td><td><code>trac 27065 mark the doctests as \"optional - explain_pickle\"</code></td></tr></table>\n",
    "created_at": "2019-01-21T10:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417563",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd63b0c05631198a35d8680cde0e18e639dd6692">cd63b0c</a></td><td><code>trac 27065 mark the doctests as "optional - explain_pickle"</code></td></tr></table>




---

archive/issue_comments_417564.json:
```json
{
    "body": "Changed commit from **[25afb28](https://github.com/sagemath/sagetrac-mirror/commit/25afb287e294d59341ff4647f128178be227d83b)** to **[cd63b0c](https://github.com/sagemath/sagetrac-mirror/commit/cd63b0c05631198a35d8680cde0e18e639dd6692)**",
    "created_at": "2019-01-21T10:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417564",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[25afb28](https://github.com/sagemath/sagetrac-mirror/commit/25afb287e294d59341ff4647f128178be227d83b)** to **[cd63b0c](https://github.com/sagemath/sagetrac-mirror/commit/cd63b0c05631198a35d8680cde0e18e639dd6692)**



---

archive/issue_events_372018.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-21T10:37:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372018"
}
```



---

archive/issue_events_372019.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-21T10:37:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372019"
}
```



---

archive/issue_comments_417565.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nNow ready. All failing doctests have been marked as depending on the non-existing pip package \"explain_pickle\".",
    "created_at": "2019-01-21T10:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417565",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

Now ready. All failing doctests have been marked as depending on the non-existing pip package "explain_pickle".



---

archive/issue_comments_417566.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nPlease just let me take care of it.  I promise I will soon (although I don't consider it high priority even for the Python 3 port, but I know you want to get those failures down--though this would be a good use case for known-failures :)\n\nI fear you did some work here that was ultimately unnecessary.  In particular, I believe the `unpickle_newobj` utility doesn't even belong in explain_pickle in the first place; it should be moved elsewhere.\n\nSecond of all, I had still planned to keep the `sage.misc.explain_pickle` module as a wrapper--possibly with parts of it deprecated, but also possibly not; it depends on exactly how the third-party `explain_pickle` module ends up being structured.  For example, there's lots of use currently of Sage-specific stuff like `SageInputExpression` and `SageInputBuilder` that doesn't necessarily make sense to use (at least directly) in a more generic implementation.  But it will definitely have an API that will allow using them, but that might involve extensions that would still belong somewhere in sage, such as in the existing explain_pickle module.\n\nSo it's not just a simple matter of removing that module and declaring tests that happened to use it as optional, and there's not much point in doing work on this until I have that third-party module ready to work with.",
    "created_at": "2019-01-21T11:00:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417566",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">comment:13</div>

Please just let me take care of it.  I promise I will soon (although I don't consider it high priority even for the Python 3 port, but I know you want to get those failures down--though this would be a good use case for known-failures :)

I fear you did some work here that was ultimately unnecessary.  In particular, I believe the `unpickle_newobj` utility doesn't even belong in explain_pickle in the first place; it should be moved elsewhere.

Second of all, I had still planned to keep the `sage.misc.explain_pickle` module as a wrapper--possibly with parts of it deprecated, but also possibly not; it depends on exactly how the third-party `explain_pickle` module ends up being structured.  For example, there's lots of use currently of Sage-specific stuff like `SageInputExpression` and `SageInputBuilder` that doesn't necessarily make sense to use (at least directly) in a more generic implementation.  But it will definitely have an API that will allow using them, but that might involve extensions that would still belong somewhere in sage, such as in the existing explain_pickle module.

So it's not just a simple matter of removing that module and declaring tests that happened to use it as optional, and there's not much point in doing work on this until I have that third-party module ready to work with.



---

archive/issue_events_372020.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-21T11:00:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372020"
}
```



---

archive/issue_events_372021.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-21T11:00:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372021"
}
```



---

archive/issue_comments_417567.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIn fact, now that I've done a bit more research into how this works, I'm almost certain that `sage.misc.explain_pickle` won't go away at all.  However, most of its current contents will be gone, and replaced with a few Sage-specific wrappers and some tests for cases that are of particular interest for Sage (e.g. testing that `register_unpickle_override` is handled properly when explaining pickles that load globals).",
    "created_at": "2019-01-21T13:49:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417567",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

In fact, now that I've done a bit more research into how this works, I'm almost certain that `sage.misc.explain_pickle` won't go away at all.  However, most of its current contents will be gone, and replaced with a few Sage-specific wrappers and some tests for cases that are of particular interest for Sage (e.g. testing that `register_unpickle_override` is handled properly when explaining pickles that load globals).



---

archive/issue_events_372022.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-21T16:51:20Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "subject": "https://github.com/embray",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372022"
}
```



---

archive/issue_comments_417568.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI've spent some time better understanding exactly how explain_pickle works, and believe I have a strategy now for implementing the \"generic\" version, and possibly deprecating parts of the existing code.",
    "created_at": "2019-01-21T16:51:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417568",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

I've spent some time better understanding exactly how explain_pickle works, and believe I have a strategy now for implementing the "generic" version, and possibly deprecating parts of the existing code.



---

archive/issue_comments_417569.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nMaking progress on this, though I still need to do a lot of testing, and the integration back into Sage isn't even started yet.",
    "created_at": "2019-01-25T13:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417569",
    "user": "https://github.com/embray"
}
```

<div id="comment:16" align="right">comment:16</div>

Making progress on this, though I still need to do a lot of testing, and the integration back into Sage isn't even started yet.



---

archive/issue_comments_417570.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nErik, any news on this front ? I am tempted to just put `# py2` everywhere in this file..",
    "created_at": "2019-02-18T19:04:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417570",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

Erik, any news on this front ? I am tempted to just put `# py2` everywhere in this file..



---

archive/issue_comments_417571.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI have had other priorities come up since I last worked on this (see e.g. https://trac.sagemath.org/query?priority=blocker&status=needs_info&status=needs_review&status=needs_work&status=new&status=positive_review&milestone=sage-8.7&col=id&col=summary&col=priority&col=status&col=type&col=milestone&col=component&order=priority)\n\nIf I have updates I won't just sit silently on them.",
    "created_at": "2019-02-19T15:32:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417571",
    "user": "https://github.com/embray"
}
```

<div id="comment:18" align="right">comment:18</div>

I have had other priorities come up since I last worked on this (see e.g. https://trac.sagemath.org/query?priority=blocker&status=needs_info&status=needs_review&status=needs_work&status=new&status=positive_review&milestone=sage-8.7&col=id&col=summary&col=priority&col=status&col=type&col=milestone&col=component&order=priority)

If I have updates I won't just sit silently on them.



---

archive/issue_events_372023.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-02-22T19:24:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372023"
}
```



---

archive/issue_events_372024.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-02-22T19:24:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372024"
}
```



---

archive/issue_comments_417572.json:
```json
{
    "body": "Changed commit from **[cd63b0c](https://github.com/sagemath/sagetrac-mirror/commit/cd63b0c05631198a35d8680cde0e18e639dd6692)** to **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)**",
    "created_at": "2019-02-22T19:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417572",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[cd63b0c](https://github.com/sagemath/sagetrac-mirror/commit/cd63b0c05631198a35d8680cde0e18e639dd6692)** to **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)**



---

archive/issue_comments_417573.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThanks, Erik. I understand very well the existence of \"other priorities\".\n\nI am proposing now a simple branch, where I just tag `#py2` the failing doctests. This will allow to put this aside, and it will no longer stand in the middle of the way to python3-full-tests-pass.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497\">aa3173c</a></td><td><code>py3: decorate most doctests in explain_pickle with tag py2</code></td></tr></table>\n",
    "created_at": "2019-02-22T19:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417573",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:19" align="right">comment:19</div>

Thanks, Erik. I understand very well the existence of "other priorities".

I am proposing now a simple branch, where I just tag `#py2` the failing doctests. This will allow to put this aside, and it will no longer stand in the middle of the way to python3-full-tests-pass.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497">aa3173c</a></td><td><code>py3: decorate most doctests in explain_pickle with tag py2</code></td></tr></table>




---

archive/issue_comments_417574.json:
```json
{
    "body": "Changed branch from **[public/ticket/27065](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/27065)** to **[u/chapoton/py2_tag_explain_pickle](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/py2_tag_explain_pickle)**",
    "created_at": "2019-02-22T19:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417574",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[public/ticket/27065](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/27065)** to **[u/chapoton/py2_tag_explain_pickle](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/py2_tag_explain_pickle)**



---

archive/issue_comments_417575.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\ngreen bot, please review",
    "created_at": "2019-02-23T07:23:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417575",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

green bot, please review



---

archive/issue_comments_417576.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-02-23T20:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417576",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_372025.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-25T08:56:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372025"
}
```



---

archive/issue_events_372026.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-25T08:56:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372026"
}
```



---

archive/issue_comments_417577.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI agree, this is better than nothing.",
    "created_at": "2019-02-25T08:56:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417577",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

I agree, this is better than nothing.



---

archive/issue_comments_417578.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2019-02-25T08:56:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417578",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_372027.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-25T12:37:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372027"
}
```



---

archive/issue_events_372028.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-25T12:37:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372028"
}
```



---

archive/issue_comments_417579.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI don't really see the urgency of this.  It's really easy to ignore these failures as they're completely localized to this module, which can easily be skipped entirely.\n\nFeel free to set back to positive_review if you disagree, but please open a new ticket for the continued work and assign me or else I will probably forget to work on it at all (I want to though; last I worked on it it was about 80% complete--it was just surprisingly hard to get some things working on Python 3).",
    "created_at": "2019-02-25T12:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417579",
    "user": "https://github.com/embray"
}
```

<div id="comment:23" align="right">comment:23</div>

I don't really see the urgency of this.  It's really easy to ignore these failures as they're completely localized to this module, which can easily be skipped entirely.

Feel free to set back to positive_review if you disagree, but please open a new ticket for the continued work and assign me or else I will probably forget to work on it at all (I want to though; last I worked on it it was about 80% complete--it was just surprisingly hard to get some things working on Python 3).



---

archive/issue_events_372029.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-02-25T12:47:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372029"
}
```



---

archive/issue_events_372030.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-02-25T12:47:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372030"
}
```



---

archive/issue_comments_417580.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI have created #27350 for the task you want to do.\n\nI am now setting back the present trivial ticket to positive.",
    "created_at": "2019-02-25T12:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417580",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:24" align="right">comment:24</div>

I have created #27350 for the task you want to do.

I am now setting back the present trivial ticket to positive.



---

archive/issue_events_372031.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-25T12:57:33Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "subject": "https://github.com/embray",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372031"
}
```



---

archive/issue_comments_417581.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nOkay, thank you.  This is fine with me if it will make you happy.  However, though it's not a big deal, in the future I would prefer that on tickets where the \"owner\" field is set to me where I am in the process of working on a solution, that the ticket not be essentially hijacked, and instead that a new ticket be created for your temporary workaround.",
    "created_at": "2019-02-25T13:01:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417581",
    "user": "https://github.com/embray"
}
```

<div id="comment:26" align="right">comment:26</div>

Okay, thank you.  This is fine with me if it will make you happy.  However, though it's not a big deal, in the future I would prefer that on tickets where the "owner" field is set to me where I am in the process of working on a solution, that the ticket not be essentially hijacked, and instead that a new ticket be created for your temporary workaround.



---

archive/issue_comments_417582.json:
```json
{
    "body": "Changed branch from **[u/chapoton/py2_tag_explain_pickle](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/py2_tag_explain_pickle)** to **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)**",
    "created_at": "2019-02-26T23:36:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417582",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/py2_tag_explain_pickle](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/py2_tag_explain_pickle)** to **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)**



---

archive/issue_events_372032.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-26T23:36:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372032"
}
```



---

archive/issue_events_372033.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "613a3698404e9c93bdd23776dc190146b8e83b91",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-02-26T23:36:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27065#event-372033"
}
```



---

archive/issue_comments_417583.json:
```json
{
    "body": "Changed commit from **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)** to none",
    "created_at": "2019-03-06T13:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417583",
    "user": "https://github.com/slel"
}
```

Changed commit from **[aa3173c](https://github.com/sagemath/sagetrac-mirror/commit/aa3173c15e55cd6f372382888a956d34178f4497)** to none



---

archive/issue_comments_417584.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,8 @@\n Proposal:\n \n * either (1) remove this file completely\n-\n * or (2) tag all doctests with `#py2`\n \n+This ticket implements option (2): tag all doctests with `#py2`.\n+\n+Further work on `explain_pickle` is tracked at #27350.\n``````\n",
    "created_at": "2019-03-06T13:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27065#issuecomment-417584",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,8 @@
 Proposal:
 
 * either (1) remove this file completely
-
 * or (2) tag all doctests with `#py2`
 
+This ticket implements option (2): tag all doctests with `#py2`.
+
+Further work on `explain_pickle` is tracked at #27350.
``````

