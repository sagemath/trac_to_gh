# Issue 27642: Re-run configure+make after installing an SPKG with sage -i

archive/issues_027405.json:
```json
{
    "body": "This is an idea for fixing #27373.\n\nAs explained in [comment:73:ticket:27373 comment#73] on that ticket, after installing a new package it is really necessary to re-run `configure` after installing a new package, whether it was an optional package that was not previously installed, or a standard package that was not previously installed (due to a configure-time check determining that it was not needed).\n\nThis is to ensure that files generated by `configure` reflect the new system configuration, in terms of what SPKGs are installed.\n\nFurther, it is advisable to re-run `make all-build` in case the `sage -i` installed packages whose dependents need to be rebuilt.\n\nThis also needs to ensure that if an SPKG is installed for some standard package, that we account for that when re-running `configure`: It must not try again to check the system for that dependency, and just reflect that the SPKG is installed.  For example, from #27373, if Sage is first built using GMP/MPIR from the system, then we run `sage -i mpir`, the system configuration must be updated to reflect that we are now using the mpir SPKG instead of GMP/MPIR from the system.  It's also necessary to rebuilt any of its dependent packages.\n\nCC:  @dimpase\n\nBranch: [public/build/ticket-27642](https://github.com/sagemath/sagetrac-mirror/tree/public/build/ticket-27642)\n\nReviewer: Dima Pasechnik\n\nAuthor: Erik Bray\n\nDependencies: #27641\n\nCommit: e16873284b5cec5c813bcf38861e0aa42ff2b93e\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27642\n\n",
    "closed_at": "2019-05-12T21:31:11Z",
    "created_at": "2019-04-11T10:49:22Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Re-run configure+make after installing an SPKG with sage -i",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27642",
    "user": "https://github.com/embray"
}
```
This is an idea for fixing #27373.

As explained in [comment:73:ticket:27373 comment#73] on that ticket, after installing a new package it is really necessary to re-run `configure` after installing a new package, whether it was an optional package that was not previously installed, or a standard package that was not previously installed (due to a configure-time check determining that it was not needed).

This is to ensure that files generated by `configure` reflect the new system configuration, in terms of what SPKGs are installed.

Further, it is advisable to re-run `make all-build` in case the `sage -i` installed packages whose dependents need to be rebuilt.

This also needs to ensure that if an SPKG is installed for some standard package, that we account for that when re-running `configure`: It must not try again to check the system for that dependency, and just reflect that the SPKG is installed.  For example, from #27373, if Sage is first built using GMP/MPIR from the system, then we run `sage -i mpir`, the system configuration must be updated to reflect that we are now using the mpir SPKG instead of GMP/MPIR from the system.  It's also necessary to rebuilt any of its dependent packages.

CC:  @dimpase

Branch: [public/build/ticket-27642](https://github.com/sagemath/sagetrac-mirror/tree/public/build/ticket-27642)

Reviewer: Dima Pasechnik

Author: Erik Bray

Dependencies: #27641

Commit: e16873284b5cec5c813bcf38861e0aa42ff2b93e

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27642





---

archive/issue_comments_535200.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis branch mostly fixes the bug in #27373 for me.\n\nAs noted in the commit message this does not yet preserve arguments previously passed to `configure`.  I think we can fix that by running `./config.status --config` but I need to test that a bit more.\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n|[687cdf0](https://github.com/sagemath/sagetrac-mirror/commit/687cdf07061f4410b072a4ccd7d371e3a6fbe315)|`Replace various --with-gmp=$SAGE_LOCAL flags in spkg-installs with a`|\n|[6de961d](https://github.com/sagemath/sagetrac-mirror/commit/6de961d90d9e06756579f0be85a8b74b7ca04360)|`Reworked this a bit more`|\n|[f76d6d5](https://github.com/sagemath/sagetrac-mirror/commit/f76d6d57b3166af20da2f36299f97c2db6ec0907)|`fix typo`|\n|[5f90ff7](https://github.com/sagemath/sagetrac-mirror/commit/5f90ff72d2ea8f48e893d9b0bfa6fb5d3f1a7fe7)|`added a bit more explanation`|\n|[3dee97c](https://github.com/sagemath/sagetrac-mirror/commit/3dee97c228e0a4bf16ecd43877e93fc3e79d5610)|`correct logic for SAGE_GMP_PREFIX etc`|\n|[0308142](https://github.com/sagemath/sagetrac-mirror/commit/0308142fc8342c91b83b7744c47c1c3b9ae3d54e)|`add the AX_ABSOLUTE_HEADER macro`|\n|[eea0685](https://github.com/sagemath/sagetrac-mirror/commit/eea06854a43e37c893c9fa9e26866d7e4cce1da5)|`iml in particular is very picky about being given an absolute path to the`|\n|[6f29e86](https://github.com/sagemath/sagetrac-mirror/commit/6f29e86037306cd31422e10ab2b9c4d9963ed486)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|\n|[a2bab81](https://github.com/sagemath/sagetrac-mirror/commit/a2bab81a11e70bdb303ab54799516a6ae948c398)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|\n|[a29056a](https://github.com/sagemath/sagetrac-mirror/commit/a29056a29dbd0ec6188457c06d1e797644913c15)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|",
    "created_at": "2019-04-11T10:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535200",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>
This branch mostly fixes the bug in #27373 for me.

As noted in the commit message this does not yet preserve arguments previously passed to `configure`.  I think we can fix that by running `./config.status --config` but I need to test that a bit more.

---
Last 10 new commits:
|                                                                                                                                          |                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|[687cdf0](https://github.com/sagemath/sagetrac-mirror/commit/687cdf07061f4410b072a4ccd7d371e3a6fbe315)|`Replace various --with-gmp=$SAGE_LOCAL flags in spkg-installs with a`|
|[6de961d](https://github.com/sagemath/sagetrac-mirror/commit/6de961d90d9e06756579f0be85a8b74b7ca04360)|`Reworked this a bit more`|
|[f76d6d5](https://github.com/sagemath/sagetrac-mirror/commit/f76d6d57b3166af20da2f36299f97c2db6ec0907)|`fix typo`|
|[5f90ff7](https://github.com/sagemath/sagetrac-mirror/commit/5f90ff72d2ea8f48e893d9b0bfa6fb5d3f1a7fe7)|`added a bit more explanation`|
|[3dee97c](https://github.com/sagemath/sagetrac-mirror/commit/3dee97c228e0a4bf16ecd43877e93fc3e79d5610)|`correct logic for SAGE_GMP_PREFIX etc`|
|[0308142](https://github.com/sagemath/sagetrac-mirror/commit/0308142fc8342c91b83b7744c47c1c3b9ae3d54e)|`add the AX_ABSOLUTE_HEADER macro`|
|[eea0685](https://github.com/sagemath/sagetrac-mirror/commit/eea06854a43e37c893c9fa9e26866d7e4cce1da5)|`iml in particular is very picky about being given an absolute path to the`|
|[6f29e86](https://github.com/sagemath/sagetrac-mirror/commit/6f29e86037306cd31422e10ab2b9c4d9963ed486)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|
|[a2bab81](https://github.com/sagemath/sagetrac-mirror/commit/a2bab81a11e70bdb303ab54799516a6ae948c398)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|
|[a29056a](https://github.com/sagemath/sagetrac-mirror/commit/a29056a29dbd0ec6188457c06d1e797644913c15)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|



---

archive/issue_comments_535201.json:
```json
{
    "body": "Changing author from \"\" to \"Erik Bray\"",
    "created_at": "2019-04-11T10:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535201",
    "user": "https://github.com/embray"
}
```

Changing author from "" to "Erik Bray"



---

archive/issue_comments_535202.json:
```json
{
    "body": "Changing commit from \"\" to \"a29056a29dbd0ec6188457c06d1e797644913c15\"",
    "created_at": "2019-04-11T10:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535202",
    "user": "https://github.com/embray"
}
```

Changing commit from "" to "a29056a29dbd0ec6188457c06d1e797644913c15"



---

archive/issue_comments_535203.json:
```json
{
    "body": "Changing branch from \"\" to \"u/embray/build/ticket-27642\"",
    "created_at": "2019-04-11T10:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535203",
    "user": "https://github.com/embray"
}
```

Changing branch from "" to "u/embray/build/ticket-27642"



---

archive/issue_comments_535204.json:
```json
{
    "body": "<a id='comment:2'></a>\ncould you rebase it?",
    "created_at": "2019-04-24T13:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535204",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
could you rebase it?



---

archive/issue_comments_535205.json:
```json
{
    "body": "Changing branch from \"u/embray/build/ticket-27642\" to \"public/build/ticket-27642\"",
    "created_at": "2019-05-03T14:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535205",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "u/embray/build/ticket-27642" to "public/build/ticket-27642"



---

archive/issue_comments_535206.json:
```json
{
    "body": "Changing commit from \"a29056a29dbd0ec6188457c06d1e797644913c15\" to \"248c071fa16ce48c0c2635b28e84db151d008da0\"",
    "created_at": "2019-05-03T14:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535206",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "a29056a29dbd0ec6188457c06d1e797644913c15" to "248c071fa16ce48c0c2635b28e84db151d008da0"



---

archive/issue_comments_535207.json:
```json
{
    "body": "<a id='comment:3'></a>\nNew commits:\n|                                                                                                                                          |                                                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|\n|[191269e](https://github.com/sagemath/sagetrac-mirror/commit/191269eb7eabf2a6f26bf97a99eacc19b2c9b409)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|\n|[f9c9a91](https://github.com/sagemath/sagetrac-mirror/commit/f9c9a91dd0b142da16409f28ddb1bc476d052b15)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|\n|[248c071](https://github.com/sagemath/sagetrac-mirror/commit/248c071fa16ce48c0c2635b28e84db151d008da0)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|",
    "created_at": "2019-05-03T14:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535207",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
New commits:
|                                                                                                                                          |                                                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
|[191269e](https://github.com/sagemath/sagetrac-mirror/commit/191269eb7eabf2a6f26bf97a99eacc19b2c9b409)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|
|[f9c9a91](https://github.com/sagemath/sagetrac-mirror/commit/f9c9a91dd0b142da16409f28ddb1bc476d052b15)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|
|[248c071](https://github.com/sagemath/sagetrac-mirror/commit/248c071fa16ce48c0c2635b28e84db151d008da0)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|



---

archive/issue_comments_535208.json:
```json
{
    "body": "<a id='comment:4'></a>\nTrying this with `./configure` leaves gmp not marked as an not to be installed, while mpir is marked as not to be installed. (to be fixed on #27641).",
    "created_at": "2019-05-03T14:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535208",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
Trying this with `./configure` leaves gmp not marked as an not to be installed, while mpir is marked as not to be installed. (to be fixed on #27641).



---

archive/issue_comments_535209.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-05-03T14:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535209",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_535210.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|\n|[191269e](https://github.com/sagemath/sagetrac-mirror/commit/191269eb7eabf2a6f26bf97a99eacc19b2c9b409)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|\n|[1c24df1](https://github.com/sagemath/sagetrac-mirror/commit/1c24df14e480b860f83e7bbe1d4f1b86f6d42398)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|\n|[dc8fd7f](https://github.com/sagemath/sagetrac-mirror/commit/dc8fd7fab0f43c40a8c3f693bc32976af0462960)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|\n|[4bce1a3](https://github.com/sagemath/sagetrac-mirror/commit/4bce1a36e95a6b18ed5ade3e4267df4045aa6bc9)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|",
    "created_at": "2019-05-03T17:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
|[191269e](https://github.com/sagemath/sagetrac-mirror/commit/191269eb7eabf2a6f26bf97a99eacc19b2c9b409)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|
|[1c24df1](https://github.com/sagemath/sagetrac-mirror/commit/1c24df14e480b860f83e7bbe1d4f1b86f6d42398)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|
|[dc8fd7f](https://github.com/sagemath/sagetrac-mirror/commit/dc8fd7fab0f43c40a8c3f693bc32976af0462960)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|
|[4bce1a3](https://github.com/sagemath/sagetrac-mirror/commit/4bce1a36e95a6b18ed5ade3e4267df4045aa6bc9)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|



---

archive/issue_comments_535211.json:
```json
{
    "body": "Changing commit from \"248c071fa16ce48c0c2635b28e84db151d008da0\" to \"4bce1a36e95a6b18ed5ade3e4267df4045aa6bc9\"",
    "created_at": "2019-05-03T17:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535211",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "248c071fa16ce48c0c2635b28e84db151d008da0" to "4bce1a36e95a6b18ed5ade3e4267df4045aa6bc9"



---

archive/issue_comments_535212.json:
```json
{
    "body": "<a id='comment:6'></a>\nrebased over updated  #27641",
    "created_at": "2019-05-03T17:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535212",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
rebased over updated  #27641



---

archive/issue_comments_535213.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2019-05-03T17:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535213",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_535214.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-05-03T17:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535214",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_535215.json:
```json
{
    "body": "<a id='comment:7'></a>\nnow this branch leaves gmp not marked as an not to be installed, while mpir is marked as not to be installed, despite being fixed on #27641...",
    "created_at": "2019-05-03T17:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535215",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
now this branch leaves gmp not marked as an not to be installed, while mpir is marked as not to be installed, despite being fixed on #27641...



---

archive/issue_comments_535216.json:
```json
{
    "body": "<a id='comment:8'></a>\nYour rebasing did not apparently include the fixes I made to #27641 (compare gmp/spkg-configure.m4)",
    "created_at": "2019-05-06T16:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535216",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
Your rebasing did not apparently include the fixes I made to #27641 (compare gmp/spkg-configure.m4)



---

archive/issue_comments_535217.json:
```json
{
    "body": "<a id='comment:9'></a>\n`gmp/spkg-configure.m4` was not touched on #27641, have a look at `git show 1c24df1`.\n`",
    "created_at": "2019-05-06T17:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535217",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
`gmp/spkg-configure.m4` was not touched on #27641, have a look at `git show 1c24df1`.
`



---

archive/issue_comments_535218.json:
```json
{
    "body": "<a id='comment:10'></a>\nMore precisely, you overwrote this change in #27641#comment:15",
    "created_at": "2019-05-06T17:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535218",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
More precisely, you overwrote this change in #27641#comment:15



---

archive/issue_comments_535219.json:
```json
{
    "body": "<a id='comment:11'></a>\nRight. That was intentional.  It should *not* be changed.",
    "created_at": "2019-05-07T16:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535219",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
Right. That was intentional.  It should *not* be changed.



---

archive/issue_comments_535220.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [embray](#comment%3A11):\n> Right. That was intentional.  It should *not* be changed.\n\n\nShould I re-create the un-rebased branch and try again, or it's simply removing the changes to `gmp/spkg-configure.m4` that would do?",
    "created_at": "2019-05-07T16:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535220",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>
Replying to [embray](#comment%3A11):
> Right. That was intentional.  It should *not* be changed.


Should I re-create the un-rebased branch and try again, or it's simply removing the changes to `gmp/spkg-configure.m4` that would do?



---

archive/issue_comments_535221.json:
```json
{
    "body": "Changing commit from \"4bce1a36e95a6b18ed5ade3e4267df4045aa6bc9\" to \"18d612df2b6d24200d6910924241c1694cf97267\"",
    "created_at": "2019-05-08T10:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4bce1a36e95a6b18ed5ade3e4267df4045aa6bc9" to "18d612df2b6d24200d6910924241c1694cf97267"



---

archive/issue_comments_535222.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[18d612d](https://github.com/sagemath/sagetrac-mirror/commit/18d612df2b6d24200d6910924241c1694cf97267)|`leave GMP's spkg-configure.m4 as it was`|",
    "created_at": "2019-05-08T10:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[18d612d](https://github.com/sagemath/sagetrac-mirror/commit/18d612df2b6d24200d6910924241c1694cf97267)|`leave GMP's spkg-configure.m4 as it was`|



---

archive/issue_comments_535223.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-05-08T10:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535223",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_535224.json:
```json
{
    "body": "<a id='comment:15'></a>\nThis is a bit of a mess.  I just need to rebase on top of the final version of #27641, not add spurious new commits.",
    "created_at": "2019-05-10T11:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535224",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
This is a bit of a mess.  I just need to rebase on top of the final version of #27641, not add spurious new commits.



---

archive/issue_comments_535225.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-05-10T11:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535225",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_535226.json:
```json
{
    "body": "Changing commit from \"18d612df2b6d24200d6910924241c1694cf97267\" to \"e16873284b5cec5c813bcf38861e0aa42ff2b93e\"",
    "created_at": "2019-05-10T11:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535226",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "18d612df2b6d24200d6910924241c1694cf97267" to "e16873284b5cec5c813bcf38861e0aa42ff2b93e"



---

archive/issue_comments_535227.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|\n|[d9bbdd4](https://github.com/sagemath/sagetrac-mirror/commit/d9bbdd48eb4a73bcc913c2f3d2ac5eecd15adf52)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|\n|[a360518](https://github.com/sagemath/sagetrac-mirror/commit/a3605187face93bd02a16089ce1121a7348ed2a3)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|\n|[e168732](https://github.com/sagemath/sagetrac-mirror/commit/e16873284b5cec5c813bcf38861e0aa42ff2b93e)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|",
    "created_at": "2019-05-10T11:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535227",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
|[d9bbdd4](https://github.com/sagemath/sagetrac-mirror/commit/d9bbdd48eb4a73bcc913c2f3d2ac5eecd15adf52)|`Add support for unconditional pre- and post-check actions in spkg-configure.m4`|
|[a360518](https://github.com/sagemath/sagetrac-mirror/commit/a3605187face93bd02a16089ce1121a7348ed2a3)|`Refactor the mpir/spkg-configure.m4 (and to a lesser extent the one for gmp) to use the new pre and post arguments to SAGE_SPKG_CONFIGURE`|
|[e168732](https://github.com/sagemath/sagetrac-mirror/commit/e16873284b5cec5c813bcf38861e0aa42ff2b93e)|`Trac #27642: Initial attempt at fix: re-run `configure` and `make all-build` after`|



---

archive/issue_comments_535228.json:
```json
{
    "body": "<a id='comment:17'></a>\nUpdated to the final version of #27641.  Still need to kick around a bit with making sure it can preserve previous configure flags.",
    "created_at": "2019-05-10T11:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535228",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
Updated to the final version of #27641.  Still need to kick around a bit with making sure it can preserve previous configure flags.



---

archive/issue_events_077778.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-12T21:31:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27642#event-77778"
}
```



---

archive/issue_comments_535229.json:
```json
{
    "body": "<a id='comment:18'></a>\nToo late, a previous version of this branch was released in 8.8.beta5",
    "created_at": "2019-05-12T21:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535229",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>
Too late, a previous version of this branch was released in 8.8.beta5



---

archive/issue_comments_535230.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-05-12T21:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535230",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_535231.json:
```json
{
    "body": "<a id='comment:19'></a>\nI am afraid it has to be reverted. It's not good as it is now.",
    "created_at": "2019-05-12T21:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535231",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>
I am afraid it has to be reverted. It's not good as it is now.



---

archive/issue_comments_535232.json:
```json
{
    "body": "<a id='comment:20'></a>\nSee #27820",
    "created_at": "2019-05-13T09:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535232",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
See #27820



---

archive/issue_comments_535233.json:
```json
{
    "body": "<a id='comment:21'></a>\nI'm confused.  How was it merged?  It was not set to positive review, and you never replaced the branch with the merge commit as in your usual process?",
    "created_at": "2019-05-13T09:53:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535233",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'></a>
I'm confused.  How was it merged?  It was not set to positive review, and you never replaced the branch with the merge commit as in your usual process?



---

archive/issue_comments_535234.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [embray](#comment%3A21):\n> I'm confused.  How was it merged?  It was not set to positive review,\n\n\nit was, see[comment:14](#comment%3A14) \n\nI gather it wasn't merged in the usual way as it didn't come with a (formally) needed configure bump",
    "created_at": "2019-05-13T10:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535234",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>
Replying to [embray](#comment%3A21):
> I'm confused.  How was it merged?  It was not set to positive review,


it was, see[comment:14](#comment%3A14) 

I gather it wasn't merged in the usual way as it didn't come with a (formally) needed configure bump



---

archive/issue_comments_535235.json:
```json
{
    "body": "<a id='comment:23'></a>\nI can confirm that this branch is merged in 8.8.rc0.\nSo this is done and dusted.",
    "created_at": "2019-06-11T10:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27642#issuecomment-535235",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
I can confirm that this branch is merged in 8.8.rc0.
So this is done and dusted.
