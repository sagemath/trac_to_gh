# Issue 27699: configure: Exit with error if an Anaconda environment without compilers is active

archive/issues_027462.json:
```json
{
    "assignees": [],
    "body": "This ticket makes it an error at `configure` time if an Anaconda environment is active \nthat does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages (or equivalent).\n\nMany support requests come from the failure of Sage to build or\nto run in the presence of Anaconda.\n\nCC:  @dimpase @saraedum @isuruf @jhpalmieri @embray @tscrim @kiwifb\n\nKeywords: **conda**\n\nBranch/Commit: **[`4ac6aaf`](https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6)**\n\nReviewer: **Isuru Fernando**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27699_\n\n",
    "closed_at": "2020-05-02T21:58:39Z",
    "created_at": "2019-04-18T13:48:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "configure: Exit with error if an Anaconda environment without compilers is active",
    "type": "issue",
    "updated_at": "2020-05-02T21:58:39Z",
    "url": "https://github.com/sagemath/sage/issues/27699",
    "user": "https://github.com/slel"
}
```
This ticket makes it an error at `configure` time if an Anaconda environment is active 
that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages (or equivalent).

Many support requests come from the failure of Sage to build or
to run in the presence of Anaconda.

CC:  @dimpase @saraedum @isuruf @jhpalmieri @embray @tscrim @kiwifb

Keywords: **conda**

Branch/Commit: **[`4ac6aaf`](https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6)**

Reviewer: **Isuru Fernando**

Author: **Matthias Koeppe**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/27699_





---

archive/issue_events_377108.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-04-18T13:48:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377108"
}
```



---

archive/issue_events_377109.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-04-18T13:48:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377109"
}
```



---

archive/issue_events_377110.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-04-18T13:48:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377110"
}
```



---

archive/issue_comments_429321.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI think it would be best to just make it possible to build sage in an anaconda env (at least given the right dependencies).",
    "created_at": "2019-05-10T11:14:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429321",
    "user": "https://github.com/embray"
}
```

<div id="comment:1" align="right">comment:1</div>

I think it would be best to just make it possible to build sage in an anaconda env (at least given the right dependencies).



---

archive/issue_comments_429322.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nReplying to [@embray](#comment%3A1):\n> I think it would be best to just make it possible to build sage in an anaconda env (at least given the right dependencies).\n\n+1",
    "created_at": "2019-06-04T01:31:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429322",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Replying to [@embray](#comment%3A1):
> I think it would be best to just make it possible to build sage in an anaconda env (at least given the right dependencies).

+1



---

archive/issue_comments_429323.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFirst ticket: #27941",
    "created_at": "2019-06-06T20:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429323",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

First ticket: #27941



---

archive/issue_comments_429324.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAs the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429324",
    "user": "https://github.com/embray"
}
```

<div id="comment:4" align="right">comment:4</div>

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_events_377111.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:55:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377111"
}
```



---

archive/issue_comments_429325.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAs discussed in #27941, if Anaconda is detected, it may suffice to add an `-rpath` directive to our `LDFLAGS` to enable linking against the libraries provided by Anaconda.",
    "created_at": "2019-06-21T03:08:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429325",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

As discussed in #27941, if Anaconda is detected, it may suffice to add an `-rpath` directive to our `LDFLAGS` to enable linking against the libraries provided by Anaconda.



---

archive/issue_comments_429326.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIt suffices to install the following conda packages:\n- c-compiler\n- cxx-compiler\n- fortran-compiler\nThey take care of adding the necessary flags. See https://docs.conda.io/projects/conda-build/en/latest/resources/compiler-tools.html (end) and also #28745.",
    "created_at": "2019-11-17T19:14:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429326",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

It suffices to install the following conda packages:
- c-compiler
- cxx-compiler
- fortran-compiler
They take care of adding the necessary flags. See https://docs.conda.io/projects/conda-build/en/latest/resources/compiler-tools.html (end) and also #28745.



---

archive/issue_events_377112.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-11T00:34:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377112"
}
```



---

archive/issue_comments_429327.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-01-11T00:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429327",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_429328.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,5 @@\n-This ticket is to detect the presence of Anaconda when building or\n-starting Sage, and output a helpful warning or error message in\n-cases where it is likely to cause, or when it causes, trouble.\n+This ticket makes it an error at `configure` time if an Anaconda environment is active \n+that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages.\n \n Many support requests come from the failure of Sage to build or\n to run in the presence of Anaconda.\n``````\n",
    "created_at": "2020-01-11T00:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429328",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,5 @@
-This ticket is to detect the presence of Anaconda when building or
-starting Sage, and output a helpful warning or error message in
-cases where it is likely to cause, or when it causes, trouble.
+This ticket makes it an error at `configure` time if an Anaconda environment is active 
+that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages.
 
 Many support requests come from the failure of Sage to build or
 to run in the presence of Anaconda.
``````




---

archive/issue_events_377113.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-11T00:34:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377113"
}
```



---

archive/issue_comments_429329.json:
```json
{
    "body": "Branch: **[public/27699-detect-anaconda](https://github.com/sagemath/sagetrac-mirror/tree/public/27699-detect-anaconda)**",
    "created_at": "2020-01-11T01:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429329",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[public/27699-detect-anaconda](https://github.com/sagemath/sagetrac-mirror/tree/public/27699-detect-anaconda)**



---

archive/issue_comments_429330.json:
```json
{
    "body": "Commit: **[`f75a807`](https://github.com/sagemath/sagetrac-mirror/commit/f75a807db54b3d602332a5927c73317bfd6bffd6)**",
    "created_at": "2020-01-11T01:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429330",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`f75a807`](https://github.com/sagemath/sagetrac-mirror/commit/f75a807db54b3d602332a5927c73317bfd6bffd6)**



---

archive/issue_comments_429331.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f75a807db54b3d602332a5927c73317bfd6bffd6\"><code>f75a807</code></a></td><td><code>configure.ac, m4/sage_check_conda_compilers.m4: Check for conda</code></td></tr></table>\n",
    "created_at": "2020-01-11T01:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429331",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f75a807db54b3d602332a5927c73317bfd6bffd6"><code>f75a807</code></a></td><td><code>configure.ac, m4/sage_check_conda_compilers.m4: Check for conda</code></td></tr></table>




---

archive/issue_events_377114.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-11T01:50:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377114"
}
```



---

archive/issue_comments_429332.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nNice, but does it always do the job? E.g. I noticed that I must comment out everything in the following block inserted by conda into my `.bashrc`:\n\n```\n# >>> conda initialize >>>\n# !! Contents within this block are managed by 'conda init' !!\n__conda_setup=\"$('/home/scratch2/dimpase/miniconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)\"\n if [ $? -eq 0 ]; then\n    eval \"$__conda_setup\"\n else\n    if [ -f \"/home/scratch2/dimpase/miniconda3/etc/profile.d/conda.sh\" ]; then\n        . \"/home/scratch2/dimpase/miniconda3/etc/profile.d/conda.sh\"\n    else\n        export PATH=\"/home/scratch2/dimpase/miniconda3/bin:$PATH\"\n    fi\nfi\n```\n- deactivating conda is not enough to let a conda-less build of Sage complete on Fedora.",
    "created_at": "2020-01-13T11:02:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429332",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Nice, but does it always do the job? E.g. I noticed that I must comment out everything in the following block inserted by conda into my `.bashrc`:

```
# >>> conda initialize >>>
# !! Contents within this block are managed by 'conda init' !!
__conda_setup="$('/home/scratch2/dimpase/miniconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"
 if [ $? -eq 0 ]; then
    eval "$__conda_setup"
 else
    if [ -f "/home/scratch2/dimpase/miniconda3/etc/profile.d/conda.sh" ]; then
        . "/home/scratch2/dimpase/miniconda3/etc/profile.d/conda.sh"
    else
        export PATH="/home/scratch2/dimpase/miniconda3/bin:$PATH"
    fi
fi
```
- deactivating conda is not enough to let a conda-less build of Sage complete on Fedora.



---

archive/issue_comments_429333.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@dimpase](#comment%3A12):\n> Nice, but does it always do the job? E.g. I noticed that I must comment out everything in the following block inserted by conda into my `.bashrc`:\n> \n> ```\n> # >>> conda initialize >>>\n> # !! Contents within this block are managed by 'conda init' !! ...\n> ```\n> - deactivating conda is not enough to let a conda-less build of Sage complete on Fedora.\n\nThat would be a conda bug.\nWhat is the environment on that system after `conda deactivate`?",
    "created_at": "2020-01-13T14:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429333",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@dimpase](#comment%3A12):
> Nice, but does it always do the job? E.g. I noticed that I must comment out everything in the following block inserted by conda into my `.bashrc`:
> 
> ```
> # >>> conda initialize >>>
> # !! Contents within this block are managed by 'conda init' !! ...
> ```
> - deactivating conda is not enough to let a conda-less build of Sage complete on Fedora.

That would be a conda bug.
What is the environment on that system after `conda deactivate`?



---

archive/issue_comments_429334.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIf I leave these things uncommented, and ssh into the box, I land in conda's `(base)`.\nThen\n\n```\n(base) clpc171[~]$ conda deactivate  \nclpc171[~]$ \nclpc171[~]$ logout\nConnection to clpc171.cs.ox.ac.uk closed.\ncoml0531@raven:~$ ssh cs\nLast login: Mon Jan 13 14:07:02 2020 from raven.linux.ox.ac.uk\n(base) clpc171[~]$ \n```\nand I land back into conda, as you see...",
    "created_at": "2020-01-13T14:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429334",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

If I leave these things uncommented, and ssh into the box, I land in conda's `(base)`.
Then

```
(base) clpc171[~]$ conda deactivate  
clpc171[~]$ 
clpc171[~]$ logout
Connection to clpc171.cs.ox.ac.uk closed.
coml0531@raven:~$ ssh cs
Last login: Mon Jan 13 14:07:02 2020 from raven.linux.ox.ac.uk
(base) clpc171[~]$ 
```
and I land back into conda, as you see...



---

archive/issue_comments_429335.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThat's normal.\n`conda deactivate` and `conda activate` manipulate the environment of the current shell.",
    "created_at": "2020-01-13T14:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429335",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

That's normal.
`conda deactivate` and `conda activate` manipulate the environment of the current shell.



---

archive/issue_comments_429336.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nbut then every `sh` call in a build that happens to source `~/.bashrc` activates conda, resulting in broken builds.",
    "created_at": "2020-01-13T14:27:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429336",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

but then every `sh` call in a build that happens to source `~/.bashrc` activates conda, resulting in broken builds.



---

archive/issue_comments_429337.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nE.g.:\n\n```\nclpc171[~]$ bash\n(base) clpc171[~]$ \n```\n\nGiven that `bash` is called in a lot of places in `build/` we obviously have a problem.",
    "created_at": "2020-01-13T14:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429337",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

E.g.:

```
clpc171[~]$ bash
(base) clpc171[~]$ 
```

Given that `bash` is called in a lot of places in `build/` we obviously have a problem.



---

archive/issue_comments_429338.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe conda initialization code belongs into `~/.bash_profile`, not `~/.bashrc`. This is where `conda init` puts it. It is supposed to be invoked for login shells only.",
    "created_at": "2020-01-13T15:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429338",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

The conda initialization code belongs into `~/.bash_profile`, not `~/.bashrc`. This is where `conda init` puts it. It is supposed to be invoked for login shells only.



---

archive/issue_comments_429339.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI have not done anything special to install conda on that box. Perhaps it just has no .bash_profile\n\nI will check as soon as I am back to keyboard. Feels like a conda bug to me.",
    "created_at": "2020-01-13T15:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429339",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

I have not done anything special to install conda on that box. Perhaps it just has no .bash_profile

I will check as soon as I am back to keyboard. Feels like a conda bug to me.



---

archive/issue_comments_429340.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nIt may be behavior of older versions of conda. In any case, also `~/.bashrc` is only run by **interactive** bash invocations. If one of our build scripts calls it, that's a bug on our side.",
    "created_at": "2020-01-13T15:31:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429340",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

It may be behavior of older versions of conda. In any case, also `~/.bashrc` is only run by **interactive** bash invocations. If one of our build scripts calls it, that's a bug on our side.



---

archive/issue_comments_429341.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@mkoeppe](#comment%3A18):\n> The conda initialization code belongs into `~/.bash_profile`, not `~/.bashrc`. This is where `conda init` puts it. It is supposed to be invoked for login shells only.\n\nI think it may be a difference in `conda init` behavior between mac and linux.",
    "created_at": "2020-01-13T15:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429341",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@mkoeppe](#comment%3A18):
> The conda initialization code belongs into `~/.bash_profile`, not `~/.bashrc`. This is where `conda init` puts it. It is supposed to be invoked for login shells only.

I think it may be a difference in `conda init` behavior between mac and linux.



---

archive/issue_comments_429342.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI do have `~/.bash_profile` - but it was not used by `conda init` (which I did last month, so it's a pretty recent install).\n\nI'll move that chunk to `~/.bash_profile` and verify whether it allows to build.\n\nIsuru, is this not a conda bug, installing that stuff into `~/.bashrc` ?",
    "created_at": "2020-01-13T16:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429342",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

I do have `~/.bash_profile` - but it was not used by `conda init` (which I did last month, so it's a pretty recent install).

I'll move that chunk to `~/.bash_profile` and verify whether it allows to build.

Isuru, is this not a conda bug, installing that stuff into `~/.bashrc` ?



---

archive/issue_comments_429343.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n> Isuru, is this not a conda bug, installing that stuff into `~/.bashrc` ?\n\nYou could do,\n\n```\nconda config --set auto_activate_base false\n```\n\nto make it not initialize by default.",
    "created_at": "2020-01-13T16:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429343",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:23" align="right">comment:23</div>

> Isuru, is this not a conda bug, installing that stuff into `~/.bashrc` ?

You could do,

```
conda config --set auto_activate_base false
```

to make it not initialize by default.



---

archive/issue_comments_429344.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nSee also, https://stackoverflow.com/a/57974390/4768820",
    "created_at": "2020-01-13T16:52:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429344",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:24" align="right">comment:24</div>

See also, https://stackoverflow.com/a/57974390/4768820



---

archive/issue_comments_429345.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nok, so this stuff has to be in Sage's docs.\n\none way or another, why would anyone want automatic activation of conda in non-login shell?",
    "created_at": "2020-01-13T17:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429345",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

ok, so this stuff has to be in Sage's docs.

one way or another, why would anyone want automatic activation of conda in non-login shell?



---

archive/issue_comments_429346.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nFor what it's worth, I very recently installed anaconda on a Mac, and the installation wrote to `.bash_profile`, not `.bashrc`.",
    "created_at": "2020-01-13T18:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429346",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">comment:26</div>

For what it's worth, I very recently installed anaconda on a Mac, and the installation wrote to `.bash_profile`, not `.bashrc`.



---

archive/issue_comments_429347.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nFWIW, I successfully built sage from scratch after `conda deactivate`. But this is with a miniconda installation with a clean `base` environment.\n\nI'll test again on Linux with a dirty `base` environment that has lots of `bin/*-config` executables - this was the problem in #27941.",
    "created_at": "2020-01-13T18:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429347",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

FWIW, I successfully built sage from scratch after `conda deactivate`. But this is with a miniconda installation with a clean `base` environment.

I'll test again on Linux with a dirty `base` environment that has lots of `bin/*-config` executables - this was the problem in #27941.



---

archive/issue_comments_429348.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@dimpase](#comment%3A25):\n> one way or another, why would anyone want automatic activation of conda in non-login shell?\n\nI don't know but it does not matter as long as it's not also done in noninteractive shells (which it isn't).",
    "created_at": "2020-01-13T18:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429348",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@dimpase](#comment%3A25):
> one way or another, why would anyone want automatic activation of conda in non-login shell?

I don't know but it does not matter as long as it's not also done in noninteractive shells (which it isn't).



---

archive/issue_comments_429349.json:
```json
{
    "body": "Changed keywords from **Anaconda** to **Anaconda, conda**",
    "created_at": "2020-01-13T18:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429349",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from **Anaconda** to **Anaconda, conda**



---

archive/issue_comments_429350.json:
```json
{
    "body": "Changed keywords from **Anaconda, conda** to **conda**",
    "created_at": "2020-01-13T18:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429350",
    "user": "https://github.com/mkoeppe"
}
```

Changed keywords from **Anaconda, conda** to **conda**



---

archive/issue_comments_429351.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@dimpase](#comment%3A25):\n> ok, so this stuff has to be in Sage's docs.\n\nI'll update the doc in this ticket.",
    "created_at": "2020-01-13T18:19:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429351",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@dimpase](#comment%3A25):
> ok, so this stuff has to be in Sage's docs.

I'll update the doc in this ticket.



---

archive/issue_comments_429352.json:
```json
{
    "body": "Changed commit from **[`f75a807`](https://github.com/sagemath/sagetrac-mirror/commit/f75a807db54b3d602332a5927c73317bfd6bffd6)** to **[`d5f5e9a`](https://github.com/sagemath/sagetrac-mirror/commit/d5f5e9aa2cf58debe727d3867719b1ab65a575a8)**",
    "created_at": "2020-01-13T18:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429352",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f75a807`](https://github.com/sagemath/sagetrac-mirror/commit/f75a807db54b3d602332a5927c73317bfd6bffd6)** to **[`d5f5e9a`](https://github.com/sagemath/sagetrac-mirror/commit/d5f5e9aa2cf58debe727d3867719b1ab65a575a8)**



---

archive/issue_comments_429353.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5f5e9aa2cf58debe727d3867719b1ab65a575a8\"><code>d5f5e9a</code></a></td><td><code>src/doc/en/installation/source.rst: Add notes on using Anaconda/Miniconda</code></td></tr></table>\n",
    "created_at": "2020-01-13T18:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429353",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5f5e9aa2cf58debe727d3867719b1ab65a575a8"><code>d5f5e9a</code></a></td><td><code>src/doc/en/installation/source.rst: Add notes on using Anaconda/Miniconda</code></td></tr></table>




---

archive/issue_comments_429354.json:
```json
{
    "body": "Attachment: **[Dockerfile-build-within-conda.gz](https://github.com/sagemath/sage/files/ticket27699/Dockerfile-build-within-conda.gz)**",
    "created_at": "2020-01-14T03:25:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429354",
    "user": "https://github.com/mkoeppe"
}
```

Attachment: **[Dockerfile-build-within-conda.gz](https://github.com/sagemath/sage/files/ticket27699/Dockerfile-build-within-conda.gz)**



---

archive/issue_comments_429355.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@mkoeppe](#comment%3A27):\n> I'll test again on Linux with a dirty `base` environment that has lots of `bin/*-config` executables - this was the problem in #27941.\n\nSee the attached Dockerfile for this setup.",
    "created_at": "2020-01-14T03:54:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429355",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@mkoeppe](#comment%3A27):
> I'll test again on Linux with a dirty `base` environment that has lots of `bin/*-config` executables - this was the problem in #27941.

See the attached Dockerfile for this setup.



---

archive/issue_comments_429356.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@mkoeppe](#comment%3A28):\n> Replying to [@dimpase](#comment%3A25):\n> > one way or another, why would anyone want automatic activation of conda in non-login shell?\n\n> \n> I don't know but it does not matter as long as it's not also done in noninteractive shells (which it isn't).\n\nWell, I can imagine a Sage test invoking an interactive shell, and then, well, all the bets are off. Can we test that Conda has `auto_activate_base=false` - if we are outside conda?\n\nAs well, the docs ought to mention [comment:23](#comment%3A23) (atm they only tell how to use conda, but they also ought to tell how not to)",
    "created_at": "2020-01-14T11:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429356",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@mkoeppe](#comment%3A28):
> Replying to [@dimpase](#comment%3A25):
> > one way or another, why would anyone want automatic activation of conda in non-login shell?

> 
> I don't know but it does not matter as long as it's not also done in noninteractive shells (which it isn't).

Well, I can imagine a Sage test invoking an interactive shell, and then, well, all the bets are off. Can we test that Conda has `auto_activate_base=false` - if we are outside conda?

As well, the docs ought to mention [comment:23](#comment%3A23) (atm they only tell how to use conda, but they also ought to tell how not to)



---

archive/issue_comments_429357.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@dimpase](#comment%3A34):\n> Replying to [@mkoeppe](#comment%3A28):\n> > Replying to [@dimpase](#comment%3A25):\n> > > one way or another, why would anyone want automatic activation of conda in non-login shell?\n\n> > \n> > I don't know but it does not matter as long as it's not also done in noninteractive shells (which it isn't).\n\n> \n> Well, I can imagine a Sage test invoking an interactive shell, and then, well, all the bets are off.\n\nIf there is such a bug in the testsuite, we'll fix it. \n\nThis really isn't specific to conda. Users' interactive shell configuration in  ~/.bashrc could also define all kinds of incompatible `alias`es or print arbitrary output etc. that could confuse a doctest.\n\n> Can we test that Conda has `auto_activate_base=false` - if we are outside conda?\n\nI don't know what you mean by that.\n\n> As well, the docs ought to mention [comment:23](#comment%3A23) (atm they only tell how to use conda, but they also ought to tell how not to)\n\nThe added docs already mention `conda deactivate`. And that is sufficient. \n\nTelling the user that they have to disable conda by editing their init scripts, or uninstall conda, or change their conda configuration --- all of this is going in the wrong direction for Sage.",
    "created_at": "2020-01-14T14:06:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429357",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@dimpase](#comment%3A34):
> Replying to [@mkoeppe](#comment%3A28):
> > Replying to [@dimpase](#comment%3A25):
> > > one way or another, why would anyone want automatic activation of conda in non-login shell?

> > 
> > I don't know but it does not matter as long as it's not also done in noninteractive shells (which it isn't).

> 
> Well, I can imagine a Sage test invoking an interactive shell, and then, well, all the bets are off.

If there is such a bug in the testsuite, we'll fix it. 

This really isn't specific to conda. Users' interactive shell configuration in  ~/.bashrc could also define all kinds of incompatible `alias`es or print arbitrary output etc. that could confuse a doctest.

> Can we test that Conda has `auto_activate_base=false` - if we are outside conda?

I don't know what you mean by that.

> As well, the docs ought to mention [comment:23](#comment%3A23) (atm they only tell how to use conda, but they also ought to tell how not to)

The added docs already mention `conda deactivate`. And that is sufficient. 

Telling the user that they have to disable conda by editing their init scripts, or uninstall conda, or change their conda configuration --- all of this is going in the wrong direction for Sage.



---

archive/issue_comments_429358.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@mkoeppe](#comment%3A33):\n> Replying to [@mkoeppe](#comment%3A27):\n> > I'll test again on Linux with a dirty `base` environment that has lots of `bin/*-config` executables - this was the problem in #27941.\n\n> \n> See the attached Dockerfile for this setup.\n\nWith #29026 (which fixes a compile error in the conda environment reported in #29005), this works fine.",
    "created_at": "2020-01-18T02:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429358",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@mkoeppe](#comment%3A33):
> Replying to [@mkoeppe](#comment%3A27):
> > I'll test again on Linux with a dirty `base` environment that has lots of `bin/*-config` executables - this was the problem in #27941.

> 
> See the attached Dockerfile for this setup.

With #29026 (which fixes a compile error in the conda environment reported in #29005), this works fine.



---

archive/issue_comments_429359.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI will not add #29026 as a dependency because the main purpose of the present ticket is to prevent broken builds in the situation described in the ticket.\n\nNeeds review.",
    "created_at": "2020-01-18T02:06:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429359",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

I will not add #29026 as a dependency because the main purpose of the present ticket is to prevent broken builds in the situation described in the ticket.

Needs review.



---

archive/issue_events_377115.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-01-27T20:16:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377115"
}
```



---

archive/issue_events_377116.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-01-27T20:16:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377116"
}
```



---

archive/issue_comments_429360.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThis would break building the conda package.",
    "created_at": "2020-01-27T20:16:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429360",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:41" align="right">comment:41</div>

This would break building the conda package.



---

archive/issue_comments_429361.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nWhen building the conda package, are the c-compiler, cxx-compiler, and fortran-compiler packages not installed?",
    "created_at": "2020-01-27T22:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429361",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:42" align="right">comment:42</div>

When building the conda package, are the c-compiler, cxx-compiler, and fortran-compiler packages not installed?



---

archive/issue_comments_429362.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nNope. Individual packages like `gcc_linux-64` (or `clang_osx-64`) are installed.",
    "created_at": "2020-01-27T22:16:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429362",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:43" align="right">comment:43</div>

Nope. Individual packages like `gcc_linux-64` (or `clang_osx-64`) are installed.



---

archive/issue_comments_429363.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nWould you have a suggestion how we should test this more generally?",
    "created_at": "2020-01-27T22:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429363",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">comment:44</div>

Would you have a suggestion how we should test this more generally?



---

archive/issue_comments_429364.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@isuruf](#comment%3A43):\n> Individual packages like `gcc_linux-64` (or `clang_osx-64`) are installed.\n\nIn that case, are the environment variables CC and CXX guaranteed to be set?",
    "created_at": "2020-04-23T03:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429364",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@isuruf](#comment%3A43):
> Individual packages like `gcc_linux-64` (or `clang_osx-64`) are installed.

In that case, are the environment variables CC and CXX guaranteed to be set?



---

archive/issue_comments_429365.json:
```json
{
    "body": "Changed commit from **[`d5f5e9a`](https://github.com/sagemath/sagetrac-mirror/commit/d5f5e9aa2cf58debe727d3867719b1ab65a575a8)** to **[`d566fdd`](https://github.com/sagemath/sagetrac-mirror/commit/d566fdd8d24012d41872ec654c05b2d926f31c5c)**",
    "created_at": "2020-04-23T04:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429365",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d5f5e9a`](https://github.com/sagemath/sagetrac-mirror/commit/d5f5e9aa2cf58debe727d3867719b1ab65a575a8)** to **[`d566fdd`](https://github.com/sagemath/sagetrac-mirror/commit/d566fdd8d24012d41872ec654c05b2d926f31c5c)**



---

archive/issue_comments_429366.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f854dd27a9b10fe61fdda716ada2be1416035ea8\"><code>f854dd2</code></a></td><td><code>configure.ac, m4/sage_check_conda_compilers.m4: Check for conda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d566fdd8d24012d41872ec654c05b2d926f31c5c\"><code>d566fdd</code></a></td><td><code>src/doc/en/installation/source.rst: Add notes on using Anaconda/Miniconda</code></td></tr></table>\n",
    "created_at": "2020-04-23T04:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429366",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f854dd27a9b10fe61fdda716ada2be1416035ea8"><code>f854dd2</code></a></td><td><code>configure.ac, m4/sage_check_conda_compilers.m4: Check for conda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d566fdd8d24012d41872ec654c05b2d926f31c5c"><code>d566fdd</code></a></td><td><code>src/doc/en/installation/source.rst: Add notes on using Anaconda/Miniconda</code></td></tr></table>




---

archive/issue_comments_429367.json:
```json
{
    "body": "Changed commit from **[`d566fdd`](https://github.com/sagemath/sagetrac-mirror/commit/d566fdd8d24012d41872ec654c05b2d926f31c5c)** to **[`193593a`](https://github.com/sagemath/sagetrac-mirror/commit/193593a858ab42500d7095e17fe140a5810296f1)**",
    "created_at": "2020-04-23T04:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429367",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d566fdd`](https://github.com/sagemath/sagetrac-mirror/commit/d566fdd8d24012d41872ec654c05b2d926f31c5c)** to **[`193593a`](https://github.com/sagemath/sagetrac-mirror/commit/193593a858ab42500d7095e17fe140a5810296f1)**



---

archive/issue_comments_429368.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/193593a858ab42500d7095e17fe140a5810296f1\"><code>193593a</code></a></td><td><code>m4/sage_check_conda_compilers.m4: Check environment variables CC, CXX, FC</code></td></tr></table>\n",
    "created_at": "2020-04-23T04:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429368",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/193593a858ab42500d7095e17fe140a5810296f1"><code>193593a</code></a></td><td><code>m4/sage_check_conda_compilers.m4: Check environment variables CC, CXX, FC</code></td></tr></table>




---

archive/issue_comments_429369.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n This ticket makes it an error at `configure` time if an Anaconda environment is active \n-that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages.\n+that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages (or equivalent).\n \n Many support requests come from the failure of Sage to build or\n to run in the presence of Anaconda.\n``````\n",
    "created_at": "2020-04-23T04:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429369",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 This ticket makes it an error at `configure` time if an Anaconda environment is active 
-that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages.
+that does not have the `c-compiler`, `cxx-compiler`, and `fortran-compiler` packages (or equivalent).
 
 Many support requests come from the failure of Sage to build or
 to run in the presence of Anaconda.
``````




---

archive/issue_events_377117.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-23T04:13:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377117"
}
```



---

archive/issue_events_377118.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-23T04:13:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377118"
}
```



---

archive/issue_comments_429370.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@mkoeppe](#comment%3A45):\n> Replying to [@isuruf](#comment%3A43):\n> > Individual packages like `gcc_linux-64` (or `clang_osx-64`) are installed.\n\n> In that case, are the environment variables CC and CXX guaranteed to be set?\n\nYes.",
    "created_at": "2020-04-23T04:19:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429370",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@mkoeppe](#comment%3A45):
> Replying to [@isuruf](#comment%3A43):
> > Individual packages like `gcc_linux-64` (or `clang_osx-64`) are installed.

> In that case, are the environment variables CC and CXX guaranteed to be set?

Yes.



---

archive/issue_comments_429371.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nThen is the updated branch OK for building the conda package?",
    "created_at": "2020-04-23T06:54:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429371",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:50" align="right">comment:50</div>

Then is the updated branch OK for building the conda package?



---

archive/issue_events_377119.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-23T17:57:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377119"
}
```



---

archive/issue_events_377120.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-23T17:57:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377120"
}
```



---

archive/issue_events_377121.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-25T03:39:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "title_is": "configure: Exit with error if an Anaconda environment without compilers is active",
    "title_was": "Detect Anaconda",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377121"
}
```



---

archive/issue_comments_429372.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\n@isuruf Any objections?",
    "created_at": "2020-04-25T05:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429372",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

@isuruf Any objections?



---

archive/issue_events_377122.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-04-25T06:16:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377122"
}
```



---

archive/issue_events_377123.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2020-04-25T06:16:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377123"
}
```



---

archive/issue_comments_429373.json:
```json
{
    "body": "Reviewer: **Isuru Fernando**",
    "created_at": "2020-04-25T06:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429373",
    "user": "https://github.com/isuruf"
}
```

Reviewer: **Isuru Fernando**



---

archive/issue_comments_429374.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThank you!",
    "created_at": "2020-04-25T06:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429374",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:55" align="right">comment:55</div>

Thank you!



---

archive/issue_events_377124.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-25T22:16:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377124"
}
```



---

archive/issue_events_377125.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-25T22:16:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377125"
}
```



---

archive/issue_comments_429375.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nMerge conflict",
    "created_at": "2020-04-25T22:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429375",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:56" align="right">comment:56</div>

Merge conflict



---

archive/issue_comments_429376.json:
```json
{
    "body": "Changed commit from **[`193593a`](https://github.com/sagemath/sagetrac-mirror/commit/193593a858ab42500d7095e17fe140a5810296f1)** to **[`4ac6aaf`](https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6)**",
    "created_at": "2020-04-25T22:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429376",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`193593a`](https://github.com/sagemath/sagetrac-mirror/commit/193593a858ab42500d7095e17fe140a5810296f1)** to **[`4ac6aaf`](https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6)**



---

archive/issue_comments_429377.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/234d23c8e1a1e288f14692c15a5166be5b60fa85\"><code>234d23c</code></a></td><td><code>configure.ac, m4/sage_check_conda_compilers.m4: Check for conda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be7b4467173e87c8a42bd937826c5cad4e91e4bc\"><code>be7b446</code></a></td><td><code>src/doc/en/installation/source.rst: Add notes on using Anaconda/Miniconda</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6\"><code>4ac6aaf</code></a></td><td><code>m4/sage_check_conda_compilers.m4: Check environment variables CC, CXX, FC</code></td></tr></table>\n",
    "created_at": "2020-04-25T22:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429377",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:57"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/234d23c8e1a1e288f14692c15a5166be5b60fa85"><code>234d23c</code></a></td><td><code>configure.ac, m4/sage_check_conda_compilers.m4: Check for conda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be7b4467173e87c8a42bd937826c5cad4e91e4bc"><code>be7b446</code></a></td><td><code>src/doc/en/installation/source.rst: Add notes on using Anaconda/Miniconda</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6"><code>4ac6aaf</code></a></td><td><code>m4/sage_check_conda_compilers.m4: Check environment variables CC, CXX, FC</code></td></tr></table>




---

archive/issue_comments_429378.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nrebased on 9.1.rc2",
    "created_at": "2020-04-25T22:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429378",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

rebased on 9.1.rc2



---

archive/issue_events_377126.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-25T22:44:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377126"
}
```



---

archive/issue_events_377127.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-25T22:44:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377127"
}
```



---

archive/issue_comments_429379.json:
```json
{
    "body": "Changed branch from **[public/27699-detect-anaconda](https://github.com/sagemath/sagetrac-mirror/tree/public/27699-detect-anaconda)** to **[`4ac6aaf`](https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6)**",
    "created_at": "2020-05-02T21:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27699#issuecomment-429379",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/27699-detect-anaconda](https://github.com/sagemath/sagetrac-mirror/tree/public/27699-detect-anaconda)** to **[`4ac6aaf`](https://github.com/sagemath/sagetrac-mirror/commit/4ac6aaf4cc0f91300ee31d31401631a6f4fc60e6)**



---

archive/issue_events_377128.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-05-02T21:58:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377128"
}
```



---

archive/issue_events_377129.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "790f4237bc83cd2607d14ded2dcedcfebc2ef0ec",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-05-02T21:58:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27699",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27699#event-377129"
}
```
