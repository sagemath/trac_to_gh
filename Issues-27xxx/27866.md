# Issue 27866: Introduce graphics insets

archive/issues_027629.json:
```json
{
    "assignees": [],
    "body": "This ticket introduces graphics insets, i.e. it allows to have various `Graphics` objects at arbitrary locations and sizes on a single figure. Previously, only graphics arrays, i.e. `Graphics` objects arranged in a regular array, were possible. \n\nThis is made possible thanks to the generic class `MultiGraphics` introduced in #27865.\nThe user interface is constituted of three new functions:\n- the method `Graphics.inset()`, which adds an inset to a given graphics; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.inset)\n- the method `MultiGraphics.inset()`, which adds an inset to a multi-graphics (e.g. a `GraphicsArray`); see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/multigraphics.html#sage.plot.multigraphics.MultiGraphics.inset)\n- the function `multi_graphics()` , which creates a figure from a list of `Graphics` objects at user-specified locations; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/plot.html#sage.plot.plot.multi_graphics)\n\n\nDepends on #27865\n\n**CC:**  @kcrisman @fchapoton @dkrenn @jdemeyer @embray\n\n**Keywords:** graphics inset\n\n**Branch:** [ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)\n\n**Reviewer:** Markus Wageringel\n\n**Author:** Eric Gourgoulhon\n\nIssue created by migration from https://trac.sagemath.org/ticket/27866\n\n",
    "closed_at": "2019-10-27T10:28:29Z",
    "created_at": "2019-05-24T12:13:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graphics",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Introduce graphics insets",
    "type": "issue",
    "updated_at": "2020-04-22T02:07:41Z",
    "url": "https://github.com/sagemath/sage/issues/27866",
    "user": "https://github.com/egourgoulhon"
}
```
This ticket introduces graphics insets, i.e. it allows to have various `Graphics` objects at arbitrary locations and sizes on a single figure. Previously, only graphics arrays, i.e. `Graphics` objects arranged in a regular array, were possible. 

This is made possible thanks to the generic class `MultiGraphics` introduced in #27865.
The user interface is constituted of three new functions:
- the method `Graphics.inset()`, which adds an inset to a given graphics; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.inset)
- the method `MultiGraphics.inset()`, which adds an inset to a multi-graphics (e.g. a `GraphicsArray`); see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/multigraphics.html#sage.plot.multigraphics.MultiGraphics.inset)
- the function `multi_graphics()` , which creates a figure from a list of `Graphics` objects at user-specified locations; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/plot.html#sage.plot.plot.multi_graphics)


Depends on #27865

**CC:**  @kcrisman @fchapoton @dkrenn @jdemeyer @embray

**Keywords:** graphics inset

**Branch:** [ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)

**Reviewer:** Markus Wageringel

**Author:** Eric Gourgoulhon

Issue created by migration from https://trac.sagemath.org/ticket/27866





---

archive/issue_comments_435518.json:
```json
{
    "body": "**Author:** Eric Gourgoulhon",
    "created_at": "2019-05-24T12:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435518",
    "user": "https://github.com/egourgoulhon"
}
```

**Author:** Eric Gourgoulhon



---

archive/issue_comments_435519.json:
```json
{
    "body": "**Branch:** [public/graphics/graphics_insets](https://github.com/sagemath/sagetrac-mirror/tree/public/graphics/graphics_insets)",
    "created_at": "2019-05-24T12:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435519",
    "user": "https://github.com/egourgoulhon"
}
```

**Branch:** [public/graphics/graphics_insets](https://github.com/sagemath/sagetrac-mirror/tree/public/graphics/graphics_insets)



---

archive/issue_comments_435520.json:
```json
{
    "body": "**Commit:** [e1776462164bf01ed857eccb06513c276986e633](https://github.com/sagemath/sagetrac-mirror/commit/e1776462164bf01ed857eccb06513c276986e633)",
    "created_at": "2019-05-24T12:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435520",
    "user": "https://github.com/egourgoulhon"
}
```

**Commit:** [e1776462164bf01ed857eccb06513c276986e633](https://github.com/sagemath/sagetrac-mirror/commit/e1776462164bf01ed857eccb06513c276986e633)



---

archive/issue_comments_435521.json:
```json
{
    "body": "**Dependencies:** #27865",
    "created_at": "2019-05-24T12:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435521",
    "user": "https://github.com/egourgoulhon"
}
```

**Dependencies:** #27865



---

archive/issue_comments_435522.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bf8ad16bd29211742090e1c1b7c54bb309abd2e\">1bf8ad1</a></td><td><code>Small cleaning in MultiGraphics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccff60c7fb3b4aaf554fea1b924407dd9161d84d\">ccff60c</a></td><td><code>Fix some doctests after the improved computation of nrows and ncols in graphics_array</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/26180ab93d915320eba64be8edd53b53b61dc10f\">26180ab</a></td><td><code>Some cleaning in MultiGraphics.matplotlib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3bd6a56484edb3782c828d490246f546e3e5e7c7\">3bd6a56</a></td><td><code>Minor cleaning in GraphicsArray</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a5ef55af4d104c840107f46abbcba90fa401a18\">3a5ef55</a></td><td><code>Change index range in GraphicsArray._add_subplot()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/60ede56f5338b16542bd7777b77a0f2f718a9bdf\">60ede56</a></td><td><code>First draft of multi_graphics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e58adf3d61e034fa5af14bd49fa28f8e9fd31ed8\">e58adf3</a></td><td><code>Add method inset() to Graphics and MultiGraphics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/26a8eb58d829f9edc31d76dceb461bb2fda58634\">26a8eb5</a></td><td><code>Add method position in MultiGraphics and GraphicsArray</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ce0db3ac2635e791f6de4febd6346000733bbd3\">8ce0db3</a></td><td><code>Add transparency of individual graphics in MultiGraphics + more doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1776462164bf01ed857eccb06513c276986e633\">e177646</a></td><td><code>Add documentation to MultiGraphics</code></td></tr></table>\n",
    "created_at": "2019-05-24T12:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435522",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:1'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bf8ad16bd29211742090e1c1b7c54bb309abd2e">1bf8ad1</a></td><td><code>Small cleaning in MultiGraphics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccff60c7fb3b4aaf554fea1b924407dd9161d84d">ccff60c</a></td><td><code>Fix some doctests after the improved computation of nrows and ncols in graphics_array</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/26180ab93d915320eba64be8edd53b53b61dc10f">26180ab</a></td><td><code>Some cleaning in MultiGraphics.matplotlib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3bd6a56484edb3782c828d490246f546e3e5e7c7">3bd6a56</a></td><td><code>Minor cleaning in GraphicsArray</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a5ef55af4d104c840107f46abbcba90fa401a18">3a5ef55</a></td><td><code>Change index range in GraphicsArray._add_subplot()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/60ede56f5338b16542bd7777b77a0f2f718a9bdf">60ede56</a></td><td><code>First draft of multi_graphics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e58adf3d61e034fa5af14bd49fa28f8e9fd31ed8">e58adf3</a></td><td><code>Add method inset() to Graphics and MultiGraphics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/26a8eb58d829f9edc31d76dceb461bb2fda58634">26a8eb5</a></td><td><code>Add method position in MultiGraphics and GraphicsArray</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ce0db3ac2635e791f6de4febd6346000733bbd3">8ce0db3</a></td><td><code>Add transparency of individual graphics in MultiGraphics + more doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1776462164bf01ed857eccb06513c276986e633">e177646</a></td><td><code>Add documentation to MultiGraphics</code></td></tr></table>




---

archive/issue_events_245879.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-05-24T12:39:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245879"
}
```



---

archive/issue_comments_435523.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n This ticket introduces graphics insets, i.e. it allows to have various `Graphics` objects at arbitrary locations and sizes on a single figure. Previously, only graphics arrays, i.e. `Graphics` objects arranged in a regular array, were possible. \n \n This is made possible thanks to the generic class `MultiGraphics` introduced in #27865.\n-The user interface is constituted of two new functions:\n-- the method `Graphics.inset()`, which attaches an inset to a given graphics; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.inset)\n-- the function `multi_graphics()` , which allows to create a figure from a list of `Graphics` objects at user-specified locations; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/plot.html#sage.plot.plot.multi_graphics)\n+The user interface is constituted of three new functions:\n+- the method `Graphics.inset()`, which adds an inset to a given graphics; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.inset)\n+- the method `MultiGraphics.inset()`, which adds an inset to a multi-graphics (e.g. a `GraphicsArray`); see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/multigraphics.html#sage.plot.multigraphics.MultiGraphics.inset)\n+- the function `multi_graphics()` , which creates a figure from a list of `Graphics` objects at user-specified locations; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/plot.html#sage.plot.plot.multi_graphics)\n \n``````\n",
    "created_at": "2019-05-24T15:09:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435523",
    "user": "https://github.com/egourgoulhon"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,8 @@
 This ticket introduces graphics insets, i.e. it allows to have various `Graphics` objects at arbitrary locations and sizes on a single figure. Previously, only graphics arrays, i.e. `Graphics` objects arranged in a regular array, were possible. 
 
 This is made possible thanks to the generic class `MultiGraphics` introduced in #27865.
-The user interface is constituted of two new functions:
-- the method `Graphics.inset()`, which attaches an inset to a given graphics; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.inset)
-- the function `multi_graphics()` , which allows to create a figure from a list of `Graphics` objects at user-specified locations; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/plot.html#sage.plot.plot.multi_graphics)
+The user interface is constituted of three new functions:
+- the method `Graphics.inset()`, which adds an inset to a given graphics; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/graphics.html#sage.plot.graphics.Graphics.inset)
+- the method `MultiGraphics.inset()`, which adds an inset to a multi-graphics (e.g. a `GraphicsArray`); see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/multigraphics.html#sage.plot.multigraphics.MultiGraphics.inset)
+- the function `multi_graphics()` , which creates a figure from a list of `Graphics` objects at user-specified locations; see this [preview example](https://sagemanifolds.obspm.fr/preview/graphics_inset/reference/plotting/sage/plot/plot.html#sage.plot.plot.multi_graphics)
 
``````




---

archive/issue_comments_435524.json:
```json
{
    "body": "<a id='comment:5'></a>\nMoving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435524",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_events_245880.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245880"
}
```



---

archive/issue_events_245881.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245881"
}
```



---

archive/issue_comments_435525.json:
```json
{
    "body": "**Changing commit** from \"[e1776462164bf01ed857eccb06513c276986e633](https://github.com/sagemath/sagetrac-mirror/commit/e1776462164bf01ed857eccb06513c276986e633)\" to \"[f504d7a7b5e155a419cc590445a54342ac9b439b](https://github.com/sagemath/sagetrac-mirror/commit/f504d7a7b5e155a419cc590445a54342ac9b439b)\".",
    "created_at": "2019-08-06T13:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435525",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e1776462164bf01ed857eccb06513c276986e633](https://github.com/sagemath/sagetrac-mirror/commit/e1776462164bf01ed857eccb06513c276986e633)" to "[f504d7a7b5e155a419cc590445a54342ac9b439b](https://github.com/sagemath/sagetrac-mirror/commit/f504d7a7b5e155a419cc590445a54342ac9b439b)".



---

archive/issue_comments_435526.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cfb4c359bbc47a508d1cd79d84005e7237bfbb69\">cfb4c35</a></td><td><code>Merge branch 'public/graphics/graphics_insets' of git://trac.sagemath.org/sage into Sage 8.9.beta5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f504d7a7b5e155a419cc590445a54342ac9b439b\">f504d7a</a></td><td><code>Correct a typo in plot.py</code></td></tr></table>\n",
    "created_at": "2019-08-06T13:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435526",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cfb4c359bbc47a508d1cd79d84005e7237bfbb69">cfb4c35</a></td><td><code>Merge branch 'public/graphics/graphics_insets' of git://trac.sagemath.org/sage into Sage 8.9.beta5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f504d7a7b5e155a419cc590445a54342ac9b439b">f504d7a</a></td><td><code>Correct a typo in plot.py</code></td></tr></table>




---

archive/issue_comments_435527.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe two pyflakes errors reported by the patchbot are spurious ones: these imports are really necessary.",
    "created_at": "2019-08-08T10:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435527",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:7'></a>
The two pyflakes errors reported by the patchbot are spurious ones: these imports are really necessary.



---

archive/issue_comments_435528.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3099f48c2560a6d2131def1b830d032e1941419b\">3099f48</a></td><td><code>27866: fix typos</code></td></tr></table>\n",
    "created_at": "2019-08-25T10:57:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435528",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3099f48c2560a6d2131def1b830d032e1941419b">3099f48</a></td><td><code>27866: fix typos</code></td></tr></table>




---

archive/issue_comments_435529.json:
```json
{
    "body": "**Changing commit** from \"[f504d7a7b5e155a419cc590445a54342ac9b439b](https://github.com/sagemath/sagetrac-mirror/commit/f504d7a7b5e155a419cc590445a54342ac9b439b)\" to \"[3099f48c2560a6d2131def1b830d032e1941419b](https://github.com/sagemath/sagetrac-mirror/commit/3099f48c2560a6d2131def1b830d032e1941419b)\".",
    "created_at": "2019-08-25T10:57:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435529",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[f504d7a7b5e155a419cc590445a54342ac9b439b](https://github.com/sagemath/sagetrac-mirror/commit/f504d7a7b5e155a419cc590445a54342ac9b439b)" to "[3099f48c2560a6d2131def1b830d032e1941419b](https://github.com/sagemath/sagetrac-mirror/commit/3099f48c2560a6d2131def1b830d032e1941419b)".



---

archive/issue_comments_435530.json:
```json
{
    "body": "<a id='comment:9'></a>\nI was wondering what happens if the graphics inset requires a particular aspect ratio, and apparently the aspect ratio is preserved, which is good. However, in the cases I tested I obtained an inset that is much larger than expected. Could you explain the output for `g2` and `g3`?\n\n```\nsage: g1 = plot(x^3, x, -1, 1, aspect_ratio=1)\nsage: g2 = g1.inset(circle((0,1000), 1, frame=True, aspect_ratio=1), (.5,.5,.5,.5))\nsage: g3 = g1.inset(circle((0,1000), 1, frame=True, aspect_ratio='automatic'), (.5,.5,.5,.5))\n```\n\n**Edit:** To be more precise, the inset has the correct size relative to the final image, but not in relation to the main graphics.",
    "created_at": "2019-08-25T11:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435530",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:9'></a>
I was wondering what happens if the graphics inset requires a particular aspect ratio, and apparently the aspect ratio is preserved, which is good. However, in the cases I tested I obtained an inset that is much larger than expected. Could you explain the output for `g2` and `g3`?

```
sage: g1 = plot(x^3, x, -1, 1, aspect_ratio=1)
sage: g2 = g1.inset(circle((0,1000), 1, frame=True, aspect_ratio=1), (.5,.5,.5,.5))
sage: g3 = g1.inset(circle((0,1000), 1, frame=True, aspect_ratio='automatic'), (.5,.5,.5,.5))
```

**Edit:** To be more precise, the inset has the correct size relative to the final image, but not in relation to the main graphics.



---

archive/issue_comments_435531.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Attachment:** [g2.png.gz](https://github.com/sagemath/sage/files/ticket27866/g2.png.gz)\n\nReplying to [@mwageringel](#comment%3A9):\n> \n> **Edit:** To be more precise, the inset has the correct size relative to the final image, but not in relation to the main graphics.\n\nActually, this is a feature, not a bug. From the documentation returned by `g1.inset?`:\n\n```\nSignature:      g1.inset(graphics, pos=None, fontsize=None)\nDocstring:     \n   Add a graphics object as an inset.\n\n   INPUT:\n\n   * \"graphics\" -- the graphics object (instance of \"Graphics\") to\n     be added as an inset to the current graphics\n\n   * \"pos\" -- (default: \"None\") 4-tuple \"(left, bottom, width,\n     height)\" specifying the location and size of the inset on the\n     figure, all quantities being in fractions of the figure width and\n     height; if \"None\", the value \"(0.70, 0.68, 0.2, 0.2)\" is used\n\n   * \"fontsize\" -- (default: \"None\")  integer, font size (in points)\n     for the inset; if \"None\", the value of 6 points is used, unless\n     \"fontsize\" has been explicitely set in the construction of\n     \"graphics\" (in this case, it is not overwritten here)\n\n   OUTPUT:\n\n   * instance of \"MultiGraphics\"\n\n```\nAs you can see, the argument `pos` specifies the position and size of the inset relative to the figure size. So, with `pos=(0.5, 0.5, 0.5, 0.5)`, as in your example `g2`, one obtains an inset that has half the figure width and half the figure height. Do you think that the documentation should be improved about this?",
    "created_at": "2019-08-25T20:30:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435531",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:10'></a>
**Attachment:** [g2.png.gz](https://github.com/sagemath/sage/files/ticket27866/g2.png.gz)

Replying to [@mwageringel](#comment%3A9):
> 
> **Edit:** To be more precise, the inset has the correct size relative to the final image, but not in relation to the main graphics.

Actually, this is a feature, not a bug. From the documentation returned by `g1.inset?`:

```
Signature:      g1.inset(graphics, pos=None, fontsize=None)
Docstring:     
   Add a graphics object as an inset.

   INPUT:

   * "graphics" -- the graphics object (instance of "Graphics") to
     be added as an inset to the current graphics

   * "pos" -- (default: "None") 4-tuple "(left, bottom, width,
     height)" specifying the location and size of the inset on the
     figure, all quantities being in fractions of the figure width and
     height; if "None", the value "(0.70, 0.68, 0.2, 0.2)" is used

   * "fontsize" -- (default: "None")  integer, font size (in points)
     for the inset; if "None", the value of 6 points is used, unless
     "fontsize" has been explicitely set in the construction of
     "graphics" (in this case, it is not overwritten here)

   OUTPUT:

   * instance of "MultiGraphics"

```
As you can see, the argument `pos` specifies the position and size of the inset relative to the figure size. So, with `pos=(0.5, 0.5, 0.5, 0.5)`, as in your example `g2`, one obtains an inset that has half the figure width and half the figure height. Do you think that the documentation should be improved about this?



---

archive/issue_comments_435532.json:
```json
{
    "body": "<a id='comment:11'></a>\nShould it be half the width and height of the figure `g1` or the figure `g2`? It seems to be half the size of `g2`, but I would have expected it to be half the size of `g1` as well. In other words, `g1` appears too small in `g2` \u2013 I would have expected `g1` to fill out the figure `g2`.\n\nAs far as I understand, the position is computed in terms of the figure size, not the plotting area, so I should not expect the inset to cover the top right quadrant of the plot precisely, but in `g2` the positioning of the inset seems a bit too far off. In particular, I would like to understand whether the tick labels count towards the width and height given in `pos` or whether these parameters just determine the size of the frame of the inset. From the looks of it, horizontal labels do not count towards the height, while vertical ones seem to add to the width?",
    "created_at": "2019-08-25T21:24:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435532",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:11'></a>
Should it be half the width and height of the figure `g1` or the figure `g2`? It seems to be half the size of `g2`, but I would have expected it to be half the size of `g1` as well. In other words, `g1` appears too small in `g2` – I would have expected `g1` to fill out the figure `g2`.

As far as I understand, the position is computed in terms of the figure size, not the plotting area, so I should not expect the inset to cover the top right quadrant of the plot precisely, but in `g2` the positioning of the inset seems a bit too far off. In particular, I would like to understand whether the tick labels count towards the width and height given in `pos` or whether these parameters just determine the size of the frame of the inset. From the looks of it, horizontal labels do not count towards the height, while vertical ones seem to add to the width?



---

archive/issue_comments_435533.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d68ced475a1fe3e39cf46a21e680901508ccd8b\">3d68ced</a></td><td><code>Merge branch 'public/graphics/graphics_insets' of git://trac.sagemath.org/sage into Sage 8.9.beta8</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6\">71dc5c8</a></td><td><code>Improve size adjustment in graphics insets</code></td></tr></table>\n",
    "created_at": "2019-08-28T16:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435533",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d68ced475a1fe3e39cf46a21e680901508ccd8b">3d68ced</a></td><td><code>Merge branch 'public/graphics/graphics_insets' of git://trac.sagemath.org/sage into Sage 8.9.beta8</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6">71dc5c8</a></td><td><code>Improve size adjustment in graphics insets</code></td></tr></table>




---

archive/issue_comments_435534.json:
```json
{
    "body": "**Changing commit** from \"[3099f48c2560a6d2131def1b830d032e1941419b](https://github.com/sagemath/sagetrac-mirror/commit/3099f48c2560a6d2131def1b830d032e1941419b)\" to \"[71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6](https://github.com/sagemath/sagetrac-mirror/commit/71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6)\".",
    "created_at": "2019-08-28T16:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435534",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3099f48c2560a6d2131def1b830d032e1941419b](https://github.com/sagemath/sagetrac-mirror/commit/3099f48c2560a6d2131def1b830d032e1941419b)" to "[71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6](https://github.com/sagemath/sagetrac-mirror/commit/71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6)".



---

archive/issue_comments_435535.json:
```json
{
    "body": "**Attachment:** [g2_new.png.gz](https://github.com/sagemath/sage/files/ticket27866/g2_new.png.gz)",
    "created_at": "2019-08-28T16:07:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435535",
    "user": "https://github.com/egourgoulhon"
}
```

**Attachment:** [g2_new.png.gz](https://github.com/sagemath/sage/files/ticket27866/g2_new.png.gz)



---

archive/issue_comments_435536.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [@mwageringel](#comment%3A11):\n> Should it be half the width and height of the figure `g1` or the figure `g2`? It seems to be half the size of `g2`, but I would have expected it to be half the size of `g1` as well. In other words, `g1` appears too small in `g2` \u2013 I would have expected `g1` to fill out the figure `g2`.\n> \n\nI've changed the rescaling of the base plot when generating the `MultiGraphics` object, the previous values were indeed shrinking `g1` too much. The new output is in the attached figure `g2_new.png`. \n\n> As far as I understand, the position is computed in terms of the figure size, not the plotting area, so I should not expect the inset to cover the top right quadrant of the plot precisely, but in `g2` the positioning of the inset seems a bit too far off. In particular, I would like to understand whether the tick labels count towards the width and height given in `pos` or whether these parameters just determine the size of the frame of the inset. From the looks of it, horizontal labels do not count towards the height, while vertical ones seem to add to the width?\n\nThe position/size given in the argument `pos` regard the position/size of the frame box of the inset with respect to the final plotting area (canvas), not with respect to `g1`. This is a feature we should keep IMHO, since it matches with Matplotlib conventions, cf. the argument `rect` in the method `Figure.add_axes` at https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html.",
    "created_at": "2019-08-28T16:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435536",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:13'></a>
Replying to [@mwageringel](#comment%3A11):
> Should it be half the width and height of the figure `g1` or the figure `g2`? It seems to be half the size of `g2`, but I would have expected it to be half the size of `g1` as well. In other words, `g1` appears too small in `g2` – I would have expected `g1` to fill out the figure `g2`.
> 

I've changed the rescaling of the base plot when generating the `MultiGraphics` object, the previous values were indeed shrinking `g1` too much. The new output is in the attached figure `g2_new.png`. 

> As far as I understand, the position is computed in terms of the figure size, not the plotting area, so I should not expect the inset to cover the top right quadrant of the plot precisely, but in `g2` the positioning of the inset seems a bit too far off. In particular, I would like to understand whether the tick labels count towards the width and height given in `pos` or whether these parameters just determine the size of the frame of the inset. From the looks of it, horizontal labels do not count towards the height, while vertical ones seem to add to the width?

The position/size given in the argument `pos` regard the position/size of the frame box of the inset with respect to the final plotting area (canvas), not with respect to `g1`. This is a feature we should keep IMHO, since it matches with Matplotlib conventions, cf. the argument `rect` in the method `Figure.add_axes` at https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html.



---

archive/issue_comments_435537.json:
```json
{
    "body": "**Changing commit** from \"[71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6](https://github.com/sagemath/sagetrac-mirror/commit/71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6)\" to \"[d34b69fafa50c3b879b189fd413a4867321f919c](https://github.com/sagemath/sagetrac-mirror/commit/d34b69fafa50c3b879b189fd413a4867321f919c)\".",
    "created_at": "2019-08-29T12:44:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435537",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6](https://github.com/sagemath/sagetrac-mirror/commit/71dc5c8501a8129816d0ee5ec4768bf3f60b8fc6)" to "[d34b69fafa50c3b879b189fd413a4867321f919c](https://github.com/sagemath/sagetrac-mirror/commit/d34b69fafa50c3b879b189fd413a4867321f919c)".



---

archive/issue_comments_435538.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d34b69fafa50c3b879b189fd413a4867321f919c\">d34b69f</a></td><td><code>Restore file permissions on build/pkgs/flint/spkg-check</code></td></tr></table>\n",
    "created_at": "2019-08-29T12:44:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435538",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d34b69fafa50c3b879b189fd413a4867321f919c">d34b69f</a></td><td><code>Restore file permissions on build/pkgs/flint/spkg-check</code></td></tr></table>




---

archive/issue_comments_435539.json:
```json
{
    "body": "<a id='comment:15'></a>\nFor some reason, yesterday's commit (comment:12) contained a spurious change of permissions on the file `build/pkgs/flint/spkg-check`. The above commit (comment:14) corrects this.",
    "created_at": "2019-08-29T12:49:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435539",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:15'></a>
For some reason, yesterday's commit (comment:12) contained a spurious change of permissions on the file `build/pkgs/flint/spkg-check`. The above commit (comment:14) corrects this.



---

archive/issue_comments_435540.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Attachment:** [g4.png.gz](https://github.com/sagemath/sage/files/ticket27866/g4.png.gz)\n\nThere still seems to be an inconsistency between vertical and horizontal positioning. For example, in `g4` the blue squares touch each other in one direction, but not the other. I am not sure what the preferred behaviour is in this case, but it should be the same in both directions.\n\n```\ng1 = plot(x^3, x, -1, 1, aspect_ratio=1, color='red', frame=True)\ng1.axes_color('red')\nc = circle((0,1000), 1, frame=True, aspect_ratio=1, transparent=True)\nc.axes_color('blue')\ng4 = g1.inset(c, (0,0,.5,.5)).inset(c, (0,.5,.5,.5)).inset(c, (.5,0,.5,.5)).inset(c, (.5,.5,.5,.5))\n```\n\n![](g4.png)\n\n---\n\nMoreover, some of the type checks testing for lists and tuples seem a bit restrictive. Especially this one is not necessary, as the implementation will work for any iterable and iterator, so the type check should just be removed:\n\n```\n        if not isinstance(graphics_list, (list, tuple)):\n            raise TypeError(\"graphics_list must be a list or a tuple, \"\n                            \"not {}\".format(graphics_list))\n```\n\n---\n\nI am not sure why the following change is needed. Would it be better to test for the converse, i.e. `if not isinstance...` of the types you want to exclude? Or are `Graphics` and `GraphicsArray` the only types that support `tight_layout`? Also, there is a similar change in multigraphics.py that only tests for `isinstance(self, GraphicsArray)`. If you think it is preferable to keep this as is, that would also be fine be me.\n\n```diff\n-            # tight_layout adjusts the *subplot* parameters so ticks aren't\n-            # cut off, etc.\n-            figure.tight_layout()\n+            if isinstance(graphics, (sage.plot.graphics.Graphics,\n+                                     sage.plot.multigraphics.GraphicsArray)):\n+                # for Graphics and GraphicsArray, tight_layout adjusts the\n+                # *subplot* parameters so ticks aren't cut off, etc.\n+                figure.tight_layout()\n```\n\nOther than that, everything looks good to me.",
    "created_at": "2019-09-28T11:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435540",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:16'></a>
**Attachment:** [g4.png.gz](https://github.com/sagemath/sage/files/ticket27866/g4.png.gz)

There still seems to be an inconsistency between vertical and horizontal positioning. For example, in `g4` the blue squares touch each other in one direction, but not the other. I am not sure what the preferred behaviour is in this case, but it should be the same in both directions.

```
g1 = plot(x^3, x, -1, 1, aspect_ratio=1, color='red', frame=True)
g1.axes_color('red')
c = circle((0,1000), 1, frame=True, aspect_ratio=1, transparent=True)
c.axes_color('blue')
g4 = g1.inset(c, (0,0,.5,.5)).inset(c, (0,.5,.5,.5)).inset(c, (.5,0,.5,.5)).inset(c, (.5,.5,.5,.5))
```

![](g4.png)

---

Moreover, some of the type checks testing for lists and tuples seem a bit restrictive. Especially this one is not necessary, as the implementation will work for any iterable and iterator, so the type check should just be removed:

```
        if not isinstance(graphics_list, (list, tuple)):
            raise TypeError("graphics_list must be a list or a tuple, "
                            "not {}".format(graphics_list))
```

---

I am not sure why the following change is needed. Would it be better to test for the converse, i.e. `if not isinstance...` of the types you want to exclude? Or are `Graphics` and `GraphicsArray` the only types that support `tight_layout`? Also, there is a similar change in multigraphics.py that only tests for `isinstance(self, GraphicsArray)`. If you think it is preferable to keep this as is, that would also be fine be me.

```diff
-            # tight_layout adjusts the *subplot* parameters so ticks aren't
-            # cut off, etc.
-            figure.tight_layout()
+            if isinstance(graphics, (sage.plot.graphics.Graphics,
+                                     sage.plot.multigraphics.GraphicsArray)):
+                # for Graphics and GraphicsArray, tight_layout adjusts the
+                # *subplot* parameters so ticks aren't cut off, etc.
+                figure.tight_layout()
```

Other than that, everything looks good to me.



---

archive/issue_events_245882.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-09-28T11:50:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245882"
}
```



---

archive/issue_events_245883.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-09-28T11:50:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245883"
}
```



---

archive/issue_comments_435541.json:
```json
{
    "body": "**Reviewer:** Markus Wageringel",
    "created_at": "2019-09-28T11:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435541",
    "user": "https://github.com/mwageringel"
}
```

**Reviewer:** Markus Wageringel



---

archive/issue_comments_435542.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2600bd730cca8d0f61bbe063a0b6562149e0100a\">2600bd7</a></td><td><code>Fix merge conflict of graphics insets branch with Sage 9.0.beta2</code></td></tr></table>\n",
    "created_at": "2019-10-24T12:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435542",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2600bd730cca8d0f61bbe063a0b6562149e0100a">2600bd7</a></td><td><code>Fix merge conflict of graphics insets branch with Sage 9.0.beta2</code></td></tr></table>




---

archive/issue_comments_435543.json:
```json
{
    "body": "**Changing commit** from \"[d34b69fafa50c3b879b189fd413a4867321f919c](https://github.com/sagemath/sagetrac-mirror/commit/d34b69fafa50c3b879b189fd413a4867321f919c)\" to \"[2600bd730cca8d0f61bbe063a0b6562149e0100a](https://github.com/sagemath/sagetrac-mirror/commit/2600bd730cca8d0f61bbe063a0b6562149e0100a)\".",
    "created_at": "2019-10-24T12:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435543",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d34b69fafa50c3b879b189fd413a4867321f919c](https://github.com/sagemath/sagetrac-mirror/commit/d34b69fafa50c3b879b189fd413a4867321f919c)" to "[2600bd730cca8d0f61bbe063a0b6562149e0100a](https://github.com/sagemath/sagetrac-mirror/commit/2600bd730cca8d0f61bbe063a0b6562149e0100a)".



---

archive/issue_comments_435544.json:
```json
{
    "body": "**Changing commit** from \"[2600bd730cca8d0f61bbe063a0b6562149e0100a](https://github.com/sagemath/sagetrac-mirror/commit/2600bd730cca8d0f61bbe063a0b6562149e0100a)\" to \"[ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)\".",
    "created_at": "2019-10-25T08:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435544",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[2600bd730cca8d0f61bbe063a0b6562149e0100a](https://github.com/sagemath/sagetrac-mirror/commit/2600bd730cca8d0f61bbe063a0b6562149e0100a)" to "[ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)".



---

archive/issue_comments_435545.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8\">ed586d3</a></td><td><code>Remove restrictive type check in MultiGraphics</code></td></tr></table>\n",
    "created_at": "2019-10-25T08:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435545",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8">ed586d3</a></td><td><code>Remove restrictive type check in MultiGraphics</code></td></tr></table>




---

archive/issue_comments_435546.json:
```json
{
    "body": "**Attachment:** [g4_aspect_ratio1.png.gz](https://github.com/sagemath/sage/files/ticket27866/g4_aspect_ratio1.png.gz)",
    "created_at": "2019-10-25T08:46:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435546",
    "user": "https://github.com/egourgoulhon"
}
```

**Attachment:** [g4_aspect_ratio1.png.gz](https://github.com/sagemath/sage/files/ticket27866/g4_aspect_ratio1.png.gz)



---

archive/issue_comments_435547.json:
```json
{
    "body": "<a id='comment:19'></a>\nSorry for the delay in replying...\n\nReplying to [@mwageringel](#comment%3A16):\n> There still seems to be an inconsistency between vertical and horizontal positioning. For example, in `g4` the blue squares touch each other in one direction, but not the other. I am not sure what the preferred behaviour is in this case, but it should be the same in both directions.\n\nActually this is not a bug but results from a clash between the default aspect ratio of the whole figure, which is 4/3, and the aspect ratio 1 of the subplots. If you ask for an aspect ratio of 1 for the whole figure, then everything is OK: \n\n```\nshow(g4, figsize=(5, 5))\n```\nleads to\n\n![](g4_aspect_ratio1.png)\n\n> \n> Moreover, some of the type checks testing for lists and tuples seem a bit restrictive. Especially this one is not necessary, as the implementation will work for any iterable and iterator, so the type check should just be removed:\n\nIndeed! Thanks for pointing this. The type check has been removed in the above commit. \n\n> \n> I am not sure why the following change is needed. Would it be better to test for the converse, i.e. `if not isinstance...` of the types you want to exclude? Or are `Graphics` and `GraphicsArray` the only types that support `tight_layout`? \n\nYes, I think so. \n\n>Also, there is a similar change in multigraphics.py that only tests for `isinstance(self, GraphicsArray)`. If you think it is preferable to keep this as is, that would also be fine be me.\n\nYes I think it is preferable to keep the tests as they are, since only `GraphicsArray` requires the tight layout.",
    "created_at": "2019-10-25T08:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435547",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:19'></a>
Sorry for the delay in replying...

Replying to [@mwageringel](#comment%3A16):
> There still seems to be an inconsistency between vertical and horizontal positioning. For example, in `g4` the blue squares touch each other in one direction, but not the other. I am not sure what the preferred behaviour is in this case, but it should be the same in both directions.

Actually this is not a bug but results from a clash between the default aspect ratio of the whole figure, which is 4/3, and the aspect ratio 1 of the subplots. If you ask for an aspect ratio of 1 for the whole figure, then everything is OK: 

```
show(g4, figsize=(5, 5))
```
leads to

![](g4_aspect_ratio1.png)

> 
> Moreover, some of the type checks testing for lists and tuples seem a bit restrictive. Especially this one is not necessary, as the implementation will work for any iterable and iterator, so the type check should just be removed:

Indeed! Thanks for pointing this. The type check has been removed in the above commit. 

> 
> I am not sure why the following change is needed. Would it be better to test for the converse, i.e. `if not isinstance...` of the types you want to exclude? Or are `Graphics` and `GraphicsArray` the only types that support `tight_layout`? 

Yes, I think so. 

>Also, there is a similar change in multigraphics.py that only tests for `isinstance(self, GraphicsArray)`. If you think it is preferable to keep this as is, that would also be fine be me.

Yes I think it is preferable to keep the tests as they are, since only `GraphicsArray` requires the tight layout.



---

archive/issue_events_245884.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-25T08:57:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245884"
}
```



---

archive/issue_events_245885.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2019-10-25T08:57:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245885"
}
```



---

archive/issue_events_245886.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-10-25T10:22:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245886"
}
```



---

archive/issue_events_245887.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-10-25T10:22:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245887"
}
```



---

archive/issue_comments_435548.json:
```json
{
    "body": "<a id='comment:21'></a>\nOk, thanks for the explanations. I am setting this to positive then.",
    "created_at": "2019-10-25T10:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435548",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:21'></a>
Ok, thanks for the explanations. I am setting this to positive then.



---

archive/issue_events_245888.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-10-25T13:41:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245888"
}
```



---

archive/issue_events_245889.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2019-10-25T13:41:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245889"
}
```



---

archive/issue_comments_435549.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [@mwageringel](#comment%3A21):\n> Ok, thanks for the explanations. I am setting this to positive then.\n\nThanks for the review!",
    "created_at": "2019-10-25T18:32:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435549",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:23'></a>
Replying to [@mwageringel](#comment%3A21):
> Ok, thanks for the explanations. I am setting this to positive then.

Thanks for the review!



---

archive/issue_events_245890.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-27T10:28:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245890"
}
```



---

archive/issue_events_245891.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "73e16ef2813613fb0dbb64bf20bfada2831bbbb7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-10-27T10:28:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27866#event-245891"
}
```



---

archive/issue_comments_435550.json:
```json
{
    "body": "**Changing branch** from \"[public/graphics/graphics_insets](https://github.com/sagemath/sagetrac-mirror/tree/public/graphics/graphics_insets)\" to \"[ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)\".",
    "created_at": "2019-10-27T10:28:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435550",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/graphics/graphics_insets](https://github.com/sagemath/sagetrac-mirror/tree/public/graphics/graphics_insets)" to "[ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)".



---

archive/issue_comments_435551.json:
```json
{
    "body": "<a id='comment:25'></a>\nThis is causing two test failures on Arch when compiling against system libraries (haven't tried on sage-the-distro)\n\n```\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/plot/multigraphics.py\", line 1297, in sage.plot.multigraphics.GraphicsArray.position\nFailed example:\n    G.position(0)  # tol 1.0e-13\nExpected:\n    (0.028906249999999998,\n     0.038541666666666696,\n     0.45390624999999996,\n     0.9229166666666667)\nGot:\n    (0.023437500000000003,\n     0.03415488992713045,\n     0.4627803348994754,\n     0.9345951100728696)\nTolerance exceeded in 4 of 4:\n    0.028906249999999998 vs 0.023437500000000003, tolerance 2e-1 > 1e-13\n    0.038541666666666696 vs 0.03415488992713045, tolerance 2e-1 > 1e-13\n    0.45390624999999996 vs 0.4627803348994754, tolerance 2e-2 > 1e-13\n    0.9229166666666667 vs 0.9345951100728696, tolerance 2e-2 > 1e-13\n**********************************************************************\nFile \"/usr/lib/python3.7/site-packages/sage/plot/multigraphics.py\", line 1302, in sage.plot.multigraphics.GraphicsArray.position\nFailed example:\n    G.position(1)  # tol 1.0e-13\nExpected:\n    (0.5171874999999999,\n     0.038541666666666696,\n     0.45390624999999996,\n     0.9229166666666667)\nGot:\n    (0.5136230468749999,\n     0.19293222169724827,\n     0.46278033489947534,\n     0.617040446532634)\nTolerance exceeded in 4 of 4:\n    0.5171874999999999 vs 0.5136230468749999, tolerance 7e-3 > 1e-13\n    0.038541666666666696 vs 0.19293222169724827, tolerance 5e0 > 1e-13\n    0.45390624999999996 vs 0.46278033489947534, tolerance 2e-2 > 1e-13\n    0.9229166666666667 vs 0.617040446532634, tolerance 4e-1 > 1e-13\n**********************************************************************\n1 item had failures:\n   2 of   6 in sage.plot.multigraphics.GraphicsArray.position\n    [192 tests, 2 failures, 15.63 s]\n```",
    "created_at": "2019-11-03T12:34:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435551",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:25'></a>
This is causing two test failures on Arch when compiling against system libraries (haven't tried on sage-the-distro)

```
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/plot/multigraphics.py", line 1297, in sage.plot.multigraphics.GraphicsArray.position
Failed example:
    G.position(0)  # tol 1.0e-13
Expected:
    (0.028906249999999998,
     0.038541666666666696,
     0.45390624999999996,
     0.9229166666666667)
Got:
    (0.023437500000000003,
     0.03415488992713045,
     0.4627803348994754,
     0.9345951100728696)
Tolerance exceeded in 4 of 4:
    0.028906249999999998 vs 0.023437500000000003, tolerance 2e-1 > 1e-13
    0.038541666666666696 vs 0.03415488992713045, tolerance 2e-1 > 1e-13
    0.45390624999999996 vs 0.4627803348994754, tolerance 2e-2 > 1e-13
    0.9229166666666667 vs 0.9345951100728696, tolerance 2e-2 > 1e-13
**********************************************************************
File "/usr/lib/python3.7/site-packages/sage/plot/multigraphics.py", line 1302, in sage.plot.multigraphics.GraphicsArray.position
Failed example:
    G.position(1)  # tol 1.0e-13
Expected:
    (0.5171874999999999,
     0.038541666666666696,
     0.45390624999999996,
     0.9229166666666667)
Got:
    (0.5136230468749999,
     0.19293222169724827,
     0.46278033489947534,
     0.617040446532634)
Tolerance exceeded in 4 of 4:
    0.5171874999999999 vs 0.5136230468749999, tolerance 7e-3 > 1e-13
    0.038541666666666696 vs 0.19293222169724827, tolerance 5e0 > 1e-13
    0.45390624999999996 vs 0.46278033489947534, tolerance 2e-2 > 1e-13
    0.9229166666666667 vs 0.617040446532634, tolerance 4e-1 > 1e-13
**********************************************************************
1 item had failures:
   2 of   6 in sage.plot.multigraphics.GraphicsArray.position
    [192 tests, 2 failures, 15.63 s]
```



---

archive/issue_comments_435552.json:
```json
{
    "body": "**Changing commit** from \"[ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)\" to \"\".",
    "created_at": "2019-11-03T12:34:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435552",
    "user": "https://github.com/antonio-rojas"
}
```

**Changing commit** from "[ed586d3135daa95881bcac5c55766c77fc5bddc8](https://github.com/sagemath/sagetrac-mirror/commit/ed586d3135daa95881bcac5c55766c77fc5bddc8)" to "".



---

archive/issue_comments_435553.json:
```json
{
    "body": "<a id='comment:26'></a>\nNew ticket please!",
    "created_at": "2019-11-03T12:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435553",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>
New ticket please!



---

archive/issue_comments_435554.json:
```json
{
    "body": "<a id='comment:27'></a>\nSee #29547.",
    "created_at": "2020-04-22T02:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27866#issuecomment-435554",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>
See #29547.
