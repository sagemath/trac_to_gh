# Issue 27141: Fix for conversion of Gamma function in Mathematica interface

archive/issues_026904.json:
```json
{
    "body": "Converting expressions involving Gamma functions from Mathematica to Sage currently fails:\n\n```python\nsage: mathematica('Gamma[4/3]').sage()\n...\nNotImplementedError: Unable to parse Mathematica                 output: Gamma(4/3)\n\nsage: mathematica('Gamma[4/3, 1]').sage()  # This should be the upper incomplete Gamma function `gamma(4/3, 1)` in Sage.\ngamma_inc_lower(4/3, 1)\n\nsage: mathematica('Gamma[4/3, 0, 1]').sage()\n...\nNotImplementedError: Unable to parse Mathematica                 output: Gamma(4/3, 0, 1)\n```\n\nMoreover, this should convert to `Gamma[4/3, 0, 1]` in Mathematica:\n\n```python\nsage: gamma_inc_lower(4/3, 1)._mathematica_()\nGamma[4/3, 1]\n```\n\nThe reason for this is that all three kinds of Gamma functions (the (complete) Gamma, the upper incomplete Gamma `gamma_inc` and the lower incomplete `gamma_inc_lower`) all convert to `Gamma` in Mathematica, but the conversion does not properly take into account that the arguments to those functions are different. Conversely, `Gamma` is currently registered to convert to `gamma_inc_lower`, which is always wrong and fails as shown above.\n\nMore precisely, there are the following correspondences:\n- `gamma(x)` and `Gamma[x]`,\n- `gamma(x, y)` and `Gamma[x, y]`,\n- `gamma_inc_lower(x, z)` and `Gamma[x, 0, z]`,\n- `gamma(x, y) - gamma(x, z)` and `Gamma[x, y, z]`.\n\nThe Mathematica documentation for this can be found here: https://reference.wolfram.com/language/ref/Gamma.html.\n\nThis was tested with Sage 8.6 and Mathematica 11.3.\n\nCC:  @dimpase @etn40ff\n\nKeywords: Mathematica\n\nBranch/Commit: 4d8f85aada8a67432827f8079250e6fabb3010f9\n\nReviewer: Dima Pasechnik, Salvatore Stella\n\nAuthor: Markus Wageringel\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27141\n\n",
    "closed_at": "2019-02-04T23:02:14Z",
    "created_at": "2019-01-27T11:08:02Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Fix for conversion of Gamma function in Mathematica interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27141",
    "user": "https://github.com/mwageringel"
}
```
Converting expressions involving Gamma functions from Mathematica to Sage currently fails:

```python
sage: mathematica('Gamma[4/3]').sage()
...
NotImplementedError: Unable to parse Mathematica                 output: Gamma(4/3)

sage: mathematica('Gamma[4/3, 1]').sage()  # This should be the upper incomplete Gamma function `gamma(4/3, 1)` in Sage.
gamma_inc_lower(4/3, 1)

sage: mathematica('Gamma[4/3, 0, 1]').sage()
...
NotImplementedError: Unable to parse Mathematica                 output: Gamma(4/3, 0, 1)
```

Moreover, this should convert to `Gamma[4/3, 0, 1]` in Mathematica:

```python
sage: gamma_inc_lower(4/3, 1)._mathematica_()
Gamma[4/3, 1]
```

The reason for this is that all three kinds of Gamma functions (the (complete) Gamma, the upper incomplete Gamma `gamma_inc` and the lower incomplete `gamma_inc_lower`) all convert to `Gamma` in Mathematica, but the conversion does not properly take into account that the arguments to those functions are different. Conversely, `Gamma` is currently registered to convert to `gamma_inc_lower`, which is always wrong and fails as shown above.

More precisely, there are the following correspondences:
- `gamma(x)` and `Gamma[x]`,
- `gamma(x, y)` and `Gamma[x, y]`,
- `gamma_inc_lower(x, z)` and `Gamma[x, 0, z]`,
- `gamma(x, y) - gamma(x, z)` and `Gamma[x, y, z]`.

The Mathematica documentation for this can be found here: https://reference.wolfram.com/language/ref/Gamma.html.

This was tested with Sage 8.6 and Mathematica 11.3.

CC:  @dimpase @etn40ff

Keywords: Mathematica

Branch/Commit: 4d8f85aada8a67432827f8079250e6fabb3010f9

Reviewer: Dima Pasechnik, Salvatore Stella

Author: Markus Wageringel

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27141





---

archive/issue_comments_378079.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2019-01-27T11:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378079",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_378080.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-27T11:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378080",
    "user": "https://github.com/mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_378081.json:
```json
{
    "body": "<a id='comment:2'></a>Dima, Salvatore, could one of you test this? Otherwise I can test it when I get back to Australia next month.",
    "created_at": "2019-01-27T15:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378081",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>Dima, Salvatore, could one of you test this? Otherwise I can test it when I get back to Australia next month.



---

archive/issue_comments_378082.json:
```json
{
    "body": "<a id='comment:3'></a>It works as advertised and all the tests pass on my machine. My knowledge of the\nGamma function is too limited to spot any mathematical issue. \n\nFeel free to set this to positive review if you are confident on the math side.",
    "created_at": "2019-01-28T11:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378082",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:3'></a>It works as advertised and all the tests pass on my machine. My knowledge of the
Gamma function is too limited to spot any mathematical issue. 

Feel free to set this to positive review if you are confident on the math side.



---

archive/issue_comments_378083.json:
```json
{
    "body": "<a id='comment:4'></a>It'd help to know what Mathematica version you tested it with, thanks.",
    "created_at": "2019-01-28T11:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378083",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>It'd help to know what Mathematica version you tested it with, thanks.



---

archive/issue_comments_378084.json:
```json
{
    "body": "<a id='comment:5'></a>Mathematica 11.3.0 Kernel for Linux x86 (64-bit)",
    "created_at": "2019-01-28T11:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378084",
    "user": "https://github.com/etn40ff"
}
```

<a id='comment:5'></a>Mathematica 11.3.0 Kernel for Linux x86 (64-bit)



---

archive/issue_comments_378085.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-28T13:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378085",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_378086.json:
```json
{
    "body": "<a id='comment:6'></a>Looks good to me. Tested with Mathematica 11.2 on Linux",
    "created_at": "2019-01-28T13:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378086",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>Looks good to me. Tested with Mathematica 11.2 on Linux



---

archive/issue_comments_378087.json:
```json
{
    "body": "<a id='comment:7'></a>Thank you.",
    "created_at": "2019-01-28T18:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378087",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:7'></a>Thank you.



---

archive/issue_comments_378088.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-04T23:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27141#issuecomment-378088",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_067397.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-04T23:02:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27141",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27141#event-67397"
}
```
