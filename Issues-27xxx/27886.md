# Issue 27886: Misc pip upgrades again

archive/issues_027649.json:
```json
{
    "assignees": [],
    "body": "This ticket (similar to #26969) upgrades the following packages:\n\n```\npackage         before      after\n----------------------------------\nbleach          3.0.2       3.1.0\ncertifi         2018.11.29  2019.3.9\nconfigparser    3.5.0       3.7.4\ncypari          2.1.0.p0    2.1.1\ncython          0.29.5.p0   0.29.10\ndecorator       4.3.0       4.4.0\ndefusedxml      0.5.0       0.6.0\nentrypoints     0.2.3       0.3\n```\nTarballs:\n\n- https://files.pythonhosted.org/packages/78/5a/0df03e8735cd9c75167528299c738702437589b9c71a849489d00ffa82e8/bleach-3.1.0.tar.gz\n- https://files.pythonhosted.org/packages/06/b8/d1ea38513c22e8c906275d135818fee16ad8495985956a9b7e2bb21942a1/certifi-2019.3.9.tar.gz\n- https://files.pythonhosted.org/packages/e2/1c/83fd53748d8245cb9a3399f705c251d3fc0ce7df04450aac1cfc49dd6a0f/configparser-3.7.4.tar.gz\n- https://files.pythonhosted.org/packages/0c/d0/8b868cedd991bbb2098bbc10a0788c7d3ea6bc9dee946e1eb8424cd4b9f6/cypari2-2.1.1.tar.gz\n- https://files.pythonhosted.org/packages/e7/2e/aee8dfff93c7f5d20461ddcefd1da3d43bab18e1666a7777f4d9dbe94065/Cython-0.29.10.tar.gz\n- https://files.pythonhosted.org/packages/ba/19/1119fe7b1e49b9c8a9f154c930060f37074ea2e8f9f6558efc2eeaa417a2/decorator-4.4.0.tar.gz\n- https://files.pythonhosted.org/packages/a4/5f/f8aa58ca0cf01cbcee728abc9d88bfeb74e95e6cb4334cfd5bed5673ea77/defusedxml-0.6.0.tar.gz\n- https://files.pythonhosted.org/packages/b4/ef/063484f1f9ba3081e920ec9972c96664e2edb9fdc3d8669b0e3b8fc0ad7c/entrypoints-0.3.tar.gz\n\nCC:  @slel @vbraun @embray @jdemeyer @kiwifb\n\nKeywords: **upgrade**\n\nBranch/Commit: **[`34aba48`](https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95)**\n\nReviewer: **John Palmieri**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27886_\n\n",
    "closed_at": "2019-06-27T20:13:28Z",
    "created_at": "2019-05-28T18:41:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/c%3A%20cython"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Misc pip upgrades again",
    "type": "issue",
    "updated_at": "2019-06-27T20:13:28Z",
    "url": "https://github.com/sagemath/sage/issues/27886",
    "user": "https://github.com/fchapoton"
}
```
This ticket (similar to #26969) upgrades the following packages:

```
package         before      after
----------------------------------
bleach          3.0.2       3.1.0
certifi         2018.11.29  2019.3.9
configparser    3.5.0       3.7.4
cypari          2.1.0.p0    2.1.1
cython          0.29.5.p0   0.29.10
decorator       4.3.0       4.4.0
defusedxml      0.5.0       0.6.0
entrypoints     0.2.3       0.3
```
Tarballs:

- https://files.pythonhosted.org/packages/78/5a/0df03e8735cd9c75167528299c738702437589b9c71a849489d00ffa82e8/bleach-3.1.0.tar.gz
- https://files.pythonhosted.org/packages/06/b8/d1ea38513c22e8c906275d135818fee16ad8495985956a9b7e2bb21942a1/certifi-2019.3.9.tar.gz
- https://files.pythonhosted.org/packages/e2/1c/83fd53748d8245cb9a3399f705c251d3fc0ce7df04450aac1cfc49dd6a0f/configparser-3.7.4.tar.gz
- https://files.pythonhosted.org/packages/0c/d0/8b868cedd991bbb2098bbc10a0788c7d3ea6bc9dee946e1eb8424cd4b9f6/cypari2-2.1.1.tar.gz
- https://files.pythonhosted.org/packages/e7/2e/aee8dfff93c7f5d20461ddcefd1da3d43bab18e1666a7777f4d9dbe94065/Cython-0.29.10.tar.gz
- https://files.pythonhosted.org/packages/ba/19/1119fe7b1e49b9c8a9f154c930060f37074ea2e8f9f6558efc2eeaa417a2/decorator-4.4.0.tar.gz
- https://files.pythonhosted.org/packages/a4/5f/f8aa58ca0cf01cbcee728abc9d88bfeb74e95e6cb4334cfd5bed5673ea77/defusedxml-0.6.0.tar.gz
- https://files.pythonhosted.org/packages/b4/ef/063484f1f9ba3081e920ec9972c96664e2edb9fdc3d8669b0e3b8fc0ad7c/entrypoints-0.3.tar.gz

CC:  @slel @vbraun @embray @jdemeyer @kiwifb

Keywords: **upgrade**

Branch/Commit: **[`34aba48`](https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95)**

Reviewer: **John Palmieri**

Author: **Frédéric Chapoton**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/27886_





---

archive/issue_events_379521.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-28T18:41:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379521"
}
```



---

archive/issue_events_379522.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-28T18:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379522"
}
```



---

archive/issue_events_379523.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-28T18:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379523"
}
```



---

archive/issue_comments_433268.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSome of these are only for Python 3: `ipython`, `ipykernel`, `matplotlib`, `Sphinx`, `rpy2` (?), possibly others. In some cases (`matplotlib`, `rpy2`) we may be able to upgrade one or two minor versions and still maintain compatibility with Python 2, but we can't upgrade to the latest version yet.",
    "created_at": "2019-05-28T20:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433268",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:1" align="right">comment:1</div>

Some of these are only for Python 3: `ipython`, `ipykernel`, `matplotlib`, `Sphinx`, `rpy2` (?), possibly others. In some cases (`matplotlib`, `rpy2`) we may be able to upgrade one or two minor versions and still maintain compatibility with Python 2, but we can't upgrade to the latest version yet.



---

archive/issue_comments_433269.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nTo take into account py2 / py3, upgrade this:\n\n```\npackage upstream             version    latest   wheel  py3     spkg name in Sage\nofficial name                in Sage    py2-ok   sdist  only    if different\n-------------------------------------------------------------------------------\nBabel                        2.6.0      2.7.0    wheel          babel\nbackports.ssl-match-hostname 3.5.0.1    3.7.0.1  sdist          backports_ssl_match_hostname\nbleach                       3.0.2      3.1.0    wheel\ncertifi                      2018.11.29 2019.3.9 wheel\nconfigparser                 3.5.0      3.7.4    wheel\ncvxopt                       1.1.8      1.2.3    wheel\ncypari2                      2.1.0      2.1.1    sdist\nCython                       0.29.5     0.29.8   wheel          cython\ndecorator                    4.3.0      4.4.0    wheel\ndefusedxml                   0.5.0      0.6.0    wheel\nentrypoints                  0.2.3      0.3      wheel\nFlask                        0.10.1     1.0.3    wheel          flask\nFlask-AutoIndex              0.6        0.6.2    sdist          flask_autoindex\nFlask-Babel                  0.9        0.12.2   sdist          flask_babel\nipykernel                    4.8.2      4.10.0   wheel  5+\nJinja2                       2.10       2.10.1   wheel          jinja2\njsonschema                   2.6.0      3.0.1    wheel\nkiwisolver                   1.0.1      1.1.0    wheel\nMarkupSafe                   1.1.0      1.1.1    wheel          markupsafe\nnbconvert                    5.4.0      5.5.0    wheel\nnetworkx                     2.2        2.3      sdist\nnotebook                     5.7.6      5.7.8    wheel\nnumpy                        1.16.1     1.16.3   wheel\npackaging                    18.0       19.0     wheel\npath.py                      7.1        11.5.2   wheel  12+     pathpy\npexpect                      4.6.0      4.7.0    wheel\nPillow                       5.3.0      6.0.0    wheel          pillow\npip                          18.1       19.1.1   wheel\npkgconfig                    1.4.0      1.5.1    wheel\nprometheus-client            0.5.0      0.6.0    sdist          prometheus_client\nprompt-toolkit               1.0.15     2.0.9    wheel          prompt_toolkit\npsutil                       5.2.0      5.6.2    sdist\nptyprocess                   0.5.1      0.6.0    wheel\nPygments                     2.3.1      2.4.2    wheel          pygments\npyparsing                    2.3.0      2.4.0    wheel\npython-dateutil              2.5.3      2.8.0    wheel          dateutil\npytz                         2018.7     2019.1   wheel\npyzmq                        17.1.2     18.0.1   wheel\nrequests                     2.13.0     2.22.0   wheel\nrpy2                         2.8.2      2.8.6    sdist  2.9+\nscandir                      1.9.0      1.10.0   sdist\nscipy                        1.2.0      1.2.1    wheel  1.3+\nsetuptools                   40.6.3     41.0.1   wheel\nsetuptools-scm               3.1.0      3.3.3    wheel          setuptools_scm\nsphinxcontrib-websupport     1.1.0      1.1.2    wheel          sphinxcontrib_websupport\nterminado                    0.8.1      0.8.2    wheel\ntornado                      4.5.2      5.1.1    sdist  6+\nTwisted                      16.3.0     19.2.0   sdist          twisted\nWerkzeug                     0.14.1     0.15.4   wheel          werkzeug\n```\n\nCannot upgrade this until we drop Python 2:\n\n```\nipython                      5.8.0      5.8.0    wheel  6+\nmatplotlib                   2.2.3      2.2.3    wheel  3+\nSphinx                       1.8.5      1.8.5    wheel  2+     sphinx\n```\n\nAdditional possible PyPI upgrades:\n\n```\nreadline 6.3.008.p0 --> gnureadline 6.3.8\npyx 0.12.1.p0 --> 0.14.1\nscons 1.2.0 --> 3.0.5\n```",
    "created_at": "2019-05-28T22:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433269",
    "user": "https://github.com/slel"
}
```

<div id="comment:2" align="right">comment:2</div>

To take into account py2 / py3, upgrade this:

```
package upstream             version    latest   wheel  py3     spkg name in Sage
official name                in Sage    py2-ok   sdist  only    if different
-------------------------------------------------------------------------------
Babel                        2.6.0      2.7.0    wheel          babel
backports.ssl-match-hostname 3.5.0.1    3.7.0.1  sdist          backports_ssl_match_hostname
bleach                       3.0.2      3.1.0    wheel
certifi                      2018.11.29 2019.3.9 wheel
configparser                 3.5.0      3.7.4    wheel
cvxopt                       1.1.8      1.2.3    wheel
cypari2                      2.1.0      2.1.1    sdist
Cython                       0.29.5     0.29.8   wheel          cython
decorator                    4.3.0      4.4.0    wheel
defusedxml                   0.5.0      0.6.0    wheel
entrypoints                  0.2.3      0.3      wheel
Flask                        0.10.1     1.0.3    wheel          flask
Flask-AutoIndex              0.6        0.6.2    sdist          flask_autoindex
Flask-Babel                  0.9        0.12.2   sdist          flask_babel
ipykernel                    4.8.2      4.10.0   wheel  5+
Jinja2                       2.10       2.10.1   wheel          jinja2
jsonschema                   2.6.0      3.0.1    wheel
kiwisolver                   1.0.1      1.1.0    wheel
MarkupSafe                   1.1.0      1.1.1    wheel          markupsafe
nbconvert                    5.4.0      5.5.0    wheel
networkx                     2.2        2.3      sdist
notebook                     5.7.6      5.7.8    wheel
numpy                        1.16.1     1.16.3   wheel
packaging                    18.0       19.0     wheel
path.py                      7.1        11.5.2   wheel  12+     pathpy
pexpect                      4.6.0      4.7.0    wheel
Pillow                       5.3.0      6.0.0    wheel          pillow
pip                          18.1       19.1.1   wheel
pkgconfig                    1.4.0      1.5.1    wheel
prometheus-client            0.5.0      0.6.0    sdist          prometheus_client
prompt-toolkit               1.0.15     2.0.9    wheel          prompt_toolkit
psutil                       5.2.0      5.6.2    sdist
ptyprocess                   0.5.1      0.6.0    wheel
Pygments                     2.3.1      2.4.2    wheel          pygments
pyparsing                    2.3.0      2.4.0    wheel
python-dateutil              2.5.3      2.8.0    wheel          dateutil
pytz                         2018.7     2019.1   wheel
pyzmq                        17.1.2     18.0.1   wheel
requests                     2.13.0     2.22.0   wheel
rpy2                         2.8.2      2.8.6    sdist  2.9+
scandir                      1.9.0      1.10.0   sdist
scipy                        1.2.0      1.2.1    wheel  1.3+
setuptools                   40.6.3     41.0.1   wheel
setuptools-scm               3.1.0      3.3.3    wheel          setuptools_scm
sphinxcontrib-websupport     1.1.0      1.1.2    wheel          sphinxcontrib_websupport
terminado                    0.8.1      0.8.2    wheel
tornado                      4.5.2      5.1.1    sdist  6+
Twisted                      16.3.0     19.2.0   sdist          twisted
Werkzeug                     0.14.1     0.15.4   wheel          werkzeug
```

Cannot upgrade this until we drop Python 2:

```
ipython                      5.8.0      5.8.0    wheel  6+
matplotlib                   2.2.3      2.2.3    wheel  3+
Sphinx                       1.8.5      1.8.5    wheel  2+     sphinx
```

Additional possible PyPI upgrades:

```
readline 6.3.008.p0 --> gnureadline 6.3.8
pyx 0.12.1.p0 --> 0.14.1
scons 1.2.0 --> 3.0.5
```



---

archive/issue_events_379524.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-05-28T22:30:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379524"
}
```



---

archive/issue_comments_433270.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIt looks to me as though matplotlib 2.2.4 would be okay for Python 2, but nothing beyond that.",
    "created_at": "2019-05-28T22:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433270",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

It looks to me as though matplotlib 2.2.4 would be okay for Python 2, but nothing beyond that.



---

archive/issue_comments_433271.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@jhpalmieri](#comment%3A4):\n> It looks to me as though matplotlib 2.2.4 would be okay for Python 2, but nothing beyond that.\n\nUsing it in sage-on-gentoo.",
    "created_at": "2019-05-28T23:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433271",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@jhpalmieri](#comment%3A4):
> It looks to me as though matplotlib 2.2.4 would be okay for Python 2, but nothing beyond that.

Using it in sage-on-gentoo.



---

archive/issue_comments_433272.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nas in #26969, we may need to exclude \"ptyprocess\" and \"tornado\"\n\nVolker, do you have an easy way to do this kind of batch upgrade, as you did it before ?",
    "created_at": "2019-05-31T13:49:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433272",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

as in #26969, we may need to exclude "ptyprocess" and "tornado"

Volker, do you have an easy way to do this kind of batch upgrade, as you did it before ?



---

archive/issue_comments_433273.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f1ec27c3a35d4c62e825a47567d67cb0e291431\"><code>1f1ec27</code></a></td><td><code>some packages upgrade</code></td></tr></table>\n",
    "created_at": "2019-06-05T10:01:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433273",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f1ec27c3a35d4c62e825a47567d67cb0e291431"><code>1f1ec27</code></a></td><td><code>some packages upgrade</code></td></tr></table>




---

archive/issue_comments_433274.json:
```json
{
    "body": "Branch: **[public/27886](https://github.com/sagemath/sagetrac-mirror/tree/public/27886)**",
    "created_at": "2019-06-05T10:01:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433274",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[public/27886](https://github.com/sagemath/sagetrac-mirror/tree/public/27886)**



---

archive/issue_comments_433275.json:
```json
{
    "body": "Commit: **[`1f1ec27`](https://github.com/sagemath/sagetrac-mirror/commit/1f1ec27c3a35d4c62e825a47567d67cb0e291431)**",
    "created_at": "2019-06-05T10:01:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433275",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`1f1ec27`](https://github.com/sagemath/sagetrac-mirror/commit/1f1ec27c3a35d4c62e825a47567d67cb0e291431)**



---

archive/issue_comments_433276.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d825c350afc01515a67b9827c628567c5c057f8\"><code>7d825c3</code></a></td><td><code>some packages upgrade</code></td></tr></table>\n",
    "created_at": "2019-06-07T07:21:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433276",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d825c350afc01515a67b9827c628567c5c057f8"><code>7d825c3</code></a></td><td><code>some packages upgrade</code></td></tr></table>




---

archive/issue_comments_433277.json:
```json
{
    "body": "Changed commit from **[`1f1ec27`](https://github.com/sagemath/sagetrac-mirror/commit/1f1ec27c3a35d4c62e825a47567d67cb0e291431)** to **[`7d825c3`](https://github.com/sagemath/sagetrac-mirror/commit/7d825c350afc01515a67b9827c628567c5c057f8)**",
    "created_at": "2019-06-07T07:21:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433277",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1f1ec27`](https://github.com/sagemath/sagetrac-mirror/commit/1f1ec27c3a35d4c62e825a47567d67cb0e291431)** to **[`7d825c3`](https://github.com/sagemath/sagetrac-mirror/commit/7d825c350afc01515a67b9827c628567c5c057f8)**



---

archive/issue_comments_433278.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nok, maybe this is a good first step. Includes an update of cython.",
    "created_at": "2019-06-07T07:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433278",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

ok, maybe this is a good first step. Includes an update of cython.



---

archive/issue_comments_433279.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-06-07T07:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433279",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_379525.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-07T07:22:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379525"
}
```



---

archive/issue_comments_433280.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\ncypari does not build. Should I add back the cython trashcan patch ?",
    "created_at": "2019-06-07T07:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433280",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

cypari does not build. Should I add back the cython trashcan patch ?



---

archive/issue_events_379526.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-07T07:31:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379526"
}
```



---

archive/issue_events_379527.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-07T07:31:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379527"
}
```



---

archive/issue_comments_433281.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e226ab8649d4bd3686acb8ed5919e3eaf9ab50ff\"><code>e226ab8</code></a></td><td><code>some packages upgrade, including cython</code></td></tr></table>\n",
    "created_at": "2019-06-07T08:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433281",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e226ab8649d4bd3686acb8ed5919e3eaf9ab50ff"><code>e226ab8</code></a></td><td><code>some packages upgrade, including cython</code></td></tr></table>




---

archive/issue_comments_433282.json:
```json
{
    "body": "Changed commit from **[`7d825c3`](https://github.com/sagemath/sagetrac-mirror/commit/7d825c350afc01515a67b9827c628567c5c057f8)** to **[`e226ab8`](https://github.com/sagemath/sagetrac-mirror/commit/e226ab8649d4bd3686acb8ed5919e3eaf9ab50ff)**",
    "created_at": "2019-06-07T08:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433282",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7d825c3`](https://github.com/sagemath/sagetrac-mirror/commit/7d825c350afc01515a67b9827c628567c5c057f8)** to **[`e226ab8`](https://github.com/sagemath/sagetrac-mirror/commit/e226ab8649d4bd3686acb8ed5919e3eaf9ab50ff)**



---

archive/issue_comments_433283.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nok, I have added back the cython patch. Back to needs review.",
    "created_at": "2019-06-07T08:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433283",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

ok, I have added back the cython patch. Back to needs review.



---

archive/issue_events_379528.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-07T08:10:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379528"
}
```



---

archive/issue_events_379529.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-07T08:10:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379529"
}
```



---

archive/issue_comments_433284.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nUpdating the ticket description to reflect the actual changes.",
    "created_at": "2019-06-07T08:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433284",
    "user": "https://github.com/slel"
}
```

<div id="comment:13" align="right">comment:13</div>

Updating the ticket description to reflect the actual changes.



---

archive/issue_comments_433285.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,58 +1,15 @@\n-similar to #26969\n-\n-What could be updated:\n+This ticket (similar to #26969) upgrades the following packages:\n \n ```\n-Babel                        2.6.0      2.7.0    wheel\n-backports.ssl-match-hostname 3.5.0.1    3.7.0.1  sdist\n-bleach                       3.0.2      3.1.0    wheel\n-certifi                      2018.11.29 2019.3.9 wheel\n-configparser                 3.5.0      3.7.4    wheel\n-cvxopt                       1.1.8      1.2.3    wheel\n-cypari2                      2.1.0      2.1.1    sdist\n-Cython                       0.29.5     0.29.8   wheel\n-decorator                    4.3.0      4.4.0    wheel\n-defusedxml                   0.5.0      0.6.0    wheel\n-entrypoints                  0.2.3      0.3      wheel\n-Flask                        0.10.1     1.0.3    wheel\n-Flask-AutoIndex              0.6        0.6.2    sdist\n-Flask-Babel                  0.9        0.12.2   sdist\n-ipykernel                    4.8.2      5.1.1    wheel\n-ipython                      5.8.0      7.5.0    wheel\n-Jinja2                       2.10       2.10.1   wheel\n-jsonschema                   2.6.0      3.0.1    wheel\n-kiwisolver                   1.0.1      1.1.0    wheel\n-MarkupSafe                   1.1.0      1.1.1    wheel\n-matplotlib                   2.2.3      3.1.0    wheel\n-nbconvert                    5.4.0      5.5.0    wheel\n-networkx                     2.2        2.3      sdist\n-notebook                     5.7.6      5.7.8    wheel\n-numpy                        1.16.1     1.16.3   wheel\n-packaging                    18.0       19.0     wheel\n-path.py                      7.1        12.0.1   wheel\n-pexpect                      4.6.0      4.7.0    wheel\n-Pillow                       5.3.0      6.0.0    wheel\n-pip                          18.1       19.1.1   wheel\n-pkgconfig                    1.4.0      1.5.1    wheel\n-prometheus-client            0.5.0      0.6.0    sdist\n-prompt-toolkit               1.0.15     2.0.9    wheel\n-psutil                       5.2.0      5.6.2    sdist\n-ptyprocess                   0.5.1      0.6.0    wheel\n-Pygments                     2.3.1      2.4.2    wheel\n-pyparsing                    2.3.0      2.4.0    wheel\n-python-dateutil              2.5.3      2.8.0    wheel\n-pytz                         2018.7     2019.1   wheel\n-pyzmq                        17.1.2     18.0.1   wheel\n-requests                     2.13.0     2.22.0   wheel\n-rpy2                         2.8.2      3.0.4    sdist\n-scandir                      1.9.0      1.10.0   sdist\n-scipy                        1.2.0      1.3.0    wheel\n-setuptools                   40.6.3     41.0.1   wheel\n-setuptools-scm               3.1.0      3.3.3    wheel\n-Sphinx                       1.8.5      2.0.1    wheel\n-sphinxcontrib-websupport     1.1.0      1.1.2    wheel\n-terminado                    0.8.1      0.8.2    wheel\n-tornado                      4.5.2      6.0.2    sdist\n-Twisted                      16.3.0     19.2.0   sdist\n-Werkzeug                     0.14.1     0.15.4   wheel\n+package         before      after\n+----------------------------------\n+bleach          3.0.2       3.1.0\n+certifi         2018.11.29  2019.3.9\n+configparser    3.5.0       3.7.4\n+cypari          2.1.0.p0    2.1.1\n+cython          0.29.5.p0   0.29.10\n+decorator       4.3.0       4.4.0\n+defusedxml      0.5.0       0.6.0\n+entrypoints     0.2.3       0.3\n ```\n+\n``````\n",
    "created_at": "2019-06-07T08:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433285",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,58 +1,15 @@
-similar to #26969
-
-What could be updated:
+This ticket (similar to #26969) upgrades the following packages:
 
 ```
-Babel                        2.6.0      2.7.0    wheel
-backports.ssl-match-hostname 3.5.0.1    3.7.0.1  sdist
-bleach                       3.0.2      3.1.0    wheel
-certifi                      2018.11.29 2019.3.9 wheel
-configparser                 3.5.0      3.7.4    wheel
-cvxopt                       1.1.8      1.2.3    wheel
-cypari2                      2.1.0      2.1.1    sdist
-Cython                       0.29.5     0.29.8   wheel
-decorator                    4.3.0      4.4.0    wheel
-defusedxml                   0.5.0      0.6.0    wheel
-entrypoints                  0.2.3      0.3      wheel
-Flask                        0.10.1     1.0.3    wheel
-Flask-AutoIndex              0.6        0.6.2    sdist
-Flask-Babel                  0.9        0.12.2   sdist
-ipykernel                    4.8.2      5.1.1    wheel
-ipython                      5.8.0      7.5.0    wheel
-Jinja2                       2.10       2.10.1   wheel
-jsonschema                   2.6.0      3.0.1    wheel
-kiwisolver                   1.0.1      1.1.0    wheel
-MarkupSafe                   1.1.0      1.1.1    wheel
-matplotlib                   2.2.3      3.1.0    wheel
-nbconvert                    5.4.0      5.5.0    wheel
-networkx                     2.2        2.3      sdist
-notebook                     5.7.6      5.7.8    wheel
-numpy                        1.16.1     1.16.3   wheel
-packaging                    18.0       19.0     wheel
-path.py                      7.1        12.0.1   wheel
-pexpect                      4.6.0      4.7.0    wheel
-Pillow                       5.3.0      6.0.0    wheel
-pip                          18.1       19.1.1   wheel
-pkgconfig                    1.4.0      1.5.1    wheel
-prometheus-client            0.5.0      0.6.0    sdist
-prompt-toolkit               1.0.15     2.0.9    wheel
-psutil                       5.2.0      5.6.2    sdist
-ptyprocess                   0.5.1      0.6.0    wheel
-Pygments                     2.3.1      2.4.2    wheel
-pyparsing                    2.3.0      2.4.0    wheel
-python-dateutil              2.5.3      2.8.0    wheel
-pytz                         2018.7     2019.1   wheel
-pyzmq                        17.1.2     18.0.1   wheel
-requests                     2.13.0     2.22.0   wheel
-rpy2                         2.8.2      3.0.4    sdist
-scandir                      1.9.0      1.10.0   sdist
-scipy                        1.2.0      1.3.0    wheel
-setuptools                   40.6.3     41.0.1   wheel
-setuptools-scm               3.1.0      3.3.3    wheel
-Sphinx                       1.8.5      2.0.1    wheel
-sphinxcontrib-websupport     1.1.0      1.1.2    wheel
-terminado                    0.8.1      0.8.2    wheel
-tornado                      4.5.2      6.0.2    sdist
-Twisted                      16.3.0     19.2.0   sdist
-Werkzeug                     0.14.1     0.15.4   wheel
+package         before      after
+----------------------------------
+bleach          3.0.2       3.1.0
+certifi         2018.11.29  2019.3.9
+configparser    3.5.0       3.7.4
+cypari          2.1.0.p0    2.1.1
+cython          0.29.5.p0   0.29.10
+decorator       4.3.0       4.4.0
+defusedxml      0.5.0       0.6.0
+entrypoints     0.2.3       0.3
 ```
+
``````




---

archive/issue_comments_433286.json:
```json
{
    "body": "Changed keywords from none to **upgrade**",
    "created_at": "2019-06-07T08:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433286",
    "user": "https://github.com/slel"
}
```

Changed keywords from none to **upgrade**



---

archive/issue_events_379530.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-06-07T08:39:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20cython",
    "label_color": "0000b0",
    "label_name": "c: cython",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379530"
}
```



---

archive/issue_comments_433287.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2019-06-07T20:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433287",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_comments_433288.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,13 @@\n defusedxml      0.5.0       0.6.0\n entrypoints     0.2.3       0.3\n ```\n+Tarballs:\n \n+- https://files.pythonhosted.org/packages/78/5a/0df03e8735cd9c75167528299c738702437589b9c71a849489d00ffa82e8/bleach-3.1.0.tar.gz\n+- https://files.pythonhosted.org/packages/06/b8/d1ea38513c22e8c906275d135818fee16ad8495985956a9b7e2bb21942a1/certifi-2019.3.9.tar.gz\n+- https://files.pythonhosted.org/packages/e2/1c/83fd53748d8245cb9a3399f705c251d3fc0ce7df04450aac1cfc49dd6a0f/configparser-3.7.4.tar.gz\n+- https://files.pythonhosted.org/packages/0c/d0/8b868cedd991bbb2098bbc10a0788c7d3ea6bc9dee946e1eb8424cd4b9f6/cypari2-2.1.1.tar.gz\n+- https://files.pythonhosted.org/packages/e7/2e/aee8dfff93c7f5d20461ddcefd1da3d43bab18e1666a7777f4d9dbe94065/Cython-0.29.10.tar.gz\n+- https://files.pythonhosted.org/packages/ba/19/1119fe7b1e49b9c8a9f154c930060f37074ea2e8f9f6558efc2eeaa417a2/decorator-4.4.0.tar.gz\n+- https://files.pythonhosted.org/packages/a4/5f/f8aa58ca0cf01cbcee728abc9d88bfeb74e95e6cb4334cfd5bed5673ea77/defusedxml-0.6.0.tar.gz\n+- https://files.pythonhosted.org/packages/b4/ef/063484f1f9ba3081e920ec9972c96664e2edb9fdc3d8669b0e3b8fc0ad7c/entrypoints-0.3.tar.gz\n``````\n",
    "created_at": "2019-06-07T20:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433288",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,13 @@
 defusedxml      0.5.0       0.6.0
 entrypoints     0.2.3       0.3
 ```
+Tarballs:
 
+- https://files.pythonhosted.org/packages/78/5a/0df03e8735cd9c75167528299c738702437589b9c71a849489d00ffa82e8/bleach-3.1.0.tar.gz
+- https://files.pythonhosted.org/packages/06/b8/d1ea38513c22e8c906275d135818fee16ad8495985956a9b7e2bb21942a1/certifi-2019.3.9.tar.gz
+- https://files.pythonhosted.org/packages/e2/1c/83fd53748d8245cb9a3399f705c251d3fc0ce7df04450aac1cfc49dd6a0f/configparser-3.7.4.tar.gz
+- https://files.pythonhosted.org/packages/0c/d0/8b868cedd991bbb2098bbc10a0788c7d3ea6bc9dee946e1eb8424cd4b9f6/cypari2-2.1.1.tar.gz
+- https://files.pythonhosted.org/packages/e7/2e/aee8dfff93c7f5d20461ddcefd1da3d43bab18e1666a7777f4d9dbe94065/Cython-0.29.10.tar.gz
+- https://files.pythonhosted.org/packages/ba/19/1119fe7b1e49b9c8a9f154c930060f37074ea2e8f9f6558efc2eeaa417a2/decorator-4.4.0.tar.gz
+- https://files.pythonhosted.org/packages/a4/5f/f8aa58ca0cf01cbcee728abc9d88bfeb74e95e6cb4334cfd5bed5673ea77/defusedxml-0.6.0.tar.gz
+- https://files.pythonhosted.org/packages/b4/ef/063484f1f9ba3081e920ec9972c96664e2edb9fdc3d8669b0e3b8fc0ad7c/entrypoints-0.3.tar.gz
``````




---

archive/issue_comments_433289.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWorks for me on OS X, both Python 2 and 3. Others should try on other platforms.\n\nUnfortunately it doesn't fix the Python 3 doctest failure in `cpython`.",
    "created_at": "2019-06-07T20:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433289",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">comment:14</div>

Works for me on OS X, both Python 2 and 3. Others should try on other platforms.

Unfortunately it doesn't fix the Python 3 doctest failure in `cpython`.



---

archive/issue_comments_433290.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nWhich failure remains in the cpython folder under python3 ? Both of these :\n\n```\n\u2523 debug.pyx  # 1\n\u2517 dict_del_by_value.pyx  # 2\n```\nor just one ? The upgrade is supposed only to fix the second file. For the first one, see #27964",
    "created_at": "2019-06-10T16:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433290",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

Which failure remains in the cpython folder under python3 ? Both of these :

```
┣ debug.pyx  # 1
┗ dict_del_by_value.pyx  # 2
```
or just one ? The upgrade is supposed only to fix the second file. For the first one, see #27964



---

archive/issue_comments_433291.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI still get both failures. I'll try `make distclean` and then rebuild to see if that helps.",
    "created_at": "2019-06-10T18:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433291",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

I still get both failures. I'll try `make distclean` and then rebuild to see if that helps.



---

archive/issue_comments_433292.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAfter `make distclean`, same result: both files have failures.",
    "created_at": "2019-06-10T19:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433292",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

After `make distclean`, same result: both files have failures.



---

archive/issue_comments_433293.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAnd Jeroen, who knows about cython and prevented me to fix that in a naive way, seems not to be very active here at the moment.",
    "created_at": "2019-06-10T19:59:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433293",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:18" align="right">comment:18</div>

And Jeroen, who knows about cython and prevented me to fix that in a naive way, seems not to be very active here at the moment.



---

archive/issue_comments_433294.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI see:\n\n```\ntest_del_dictitem_by_exact_value(D, ZZ, 2)\n```\nfails, but\n\n```\ntest_del_dictitem_by_exact_value(D, ZZ, int(2))\n```\nworks. What was your naive fix? I would be tempted to use\n\n```\ntest_del_dictitem_by_exact_value(D, ZZ, hash(2))\n```\nThis is more robust, since it works in this kind of case:\n\n```\nsage: D = {1230981308409180310928308123: ZZ}\nsage: test_del_dictitem_by_exact_value(D, ZZ, hash(1230981308409180310928308123))\n```\nwhile\n\n```\nsage: D = {1230981308409180310928308123: ZZ}\nsage: test_del_dictitem_by_exact_value(D, ZZ, 1230981308409180310928308123)\n```\nfails with both Python 2 and 3. The current doctest relies on the fact that the hash of the Sage integer 2 is equal to 2, and this doesn't generalize to integers that are too large.",
    "created_at": "2019-06-10T20:48:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433294",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">comment:19</div>

I see:

```
test_del_dictitem_by_exact_value(D, ZZ, 2)
```
fails, but

```
test_del_dictitem_by_exact_value(D, ZZ, int(2))
```
works. What was your naive fix? I would be tempted to use

```
test_del_dictitem_by_exact_value(D, ZZ, hash(2))
```
This is more robust, since it works in this kind of case:

```
sage: D = {1230981308409180310928308123: ZZ}
sage: test_del_dictitem_by_exact_value(D, ZZ, hash(1230981308409180310928308123))
```
while

```
sage: D = {1230981308409180310928308123: ZZ}
sage: test_del_dictitem_by_exact_value(D, ZZ, 1230981308409180310928308123)
```
fails with both Python 2 and 3. The current doctest relies on the fact that the hash of the Sage integer 2 is equal to 2, and this doesn't generalize to integers that are too large.



---

archive/issue_comments_433295.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nok, I will do that in another ticket, thanks for the suggestion.\n\nsee #27972",
    "created_at": "2019-06-12T07:56:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433295",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

ok, I will do that in another ticket, thanks for the suggestion.

see #27972



---

archive/issue_comments_433296.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThe `test_del_dictitem_by_exact_value` failure is fixed upstream at https://github.com/cython/cython/commit/28251032f86c266065e4976080230481b1a1bb29\n\nI suggest to just apply that patch instead of \"fixing\" the doctest.",
    "created_at": "2019-06-12T09:29:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433296",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

The `test_del_dictitem_by_exact_value` failure is fixed upstream at https://github.com/cython/cython/commit/28251032f86c266065e4976080230481b1a1bb29

I suggest to just apply that patch instead of "fixing" the doctest.



---

archive/issue_comments_433297.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nBut this is supposed to be in cython 0.29.3 ??\n\n6 months ago, in #26855 you said : Fixed upstream, but not in a stable release",
    "created_at": "2019-06-12T11:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433297",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

But this is supposed to be in cython 0.29.3 ??

6 months ago, in #26855 you said : Fixed upstream, but not in a stable release



---

archive/issue_comments_433298.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIt's not fixed in a Cython bugfix release it seems, but only in the next major release.",
    "created_at": "2019-06-12T12:15:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433298",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

It's not fixed in a Cython bugfix release it seems, but only in the next major release.



---

archive/issue_comments_433299.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n...or maybe it was meant to be fixed in 0.29.x but forgotten.",
    "created_at": "2019-06-12T12:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433299",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

...or maybe it was meant to be fixed in 0.29.x but forgotten.



---

archive/issue_comments_433300.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95\"><code>34aba48</code></a></td><td><code>Add Cython patch to fix Py_hash_t conversion</code></td></tr></table>\n",
    "created_at": "2019-06-12T12:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433300",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95"><code>34aba48</code></a></td><td><code>Add Cython patch to fix Py_hash_t conversion</code></td></tr></table>




---

archive/issue_comments_433301.json:
```json
{
    "body": "Changed commit from **[`e226ab8`](https://github.com/sagemath/sagetrac-mirror/commit/e226ab8649d4bd3686acb8ed5919e3eaf9ab50ff)** to **[`34aba48`](https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95)**",
    "created_at": "2019-06-12T12:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433301",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e226ab8`](https://github.com/sagemath/sagetrac-mirror/commit/e226ab8649d4bd3686acb8ed5919e3eaf9ab50ff)** to **[`34aba48`](https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95)**



---

archive/issue_comments_433302.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThis change does fix the py3 doctest failures in `cpython/dict_del_by_value.pyx`. I was hoping it would fix some of the doctests in integer.pyx, but it doesn't seem to have done that.",
    "created_at": "2019-06-12T15:59:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433302",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">comment:26</div>

This change does fix the py3 doctest failures in `cpython/dict_del_by_value.pyx`. I was hoping it would fix some of the doctests in integer.pyx, but it doesn't seem to have done that.



---

archive/issue_comments_433303.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nLet's merge this into an early 8.9 beta.",
    "created_at": "2019-06-18T04:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433303",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:27" align="right">comment:27</div>

Let's merge this into an early 8.9 beta.



---

archive/issue_events_379531.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-06-18T04:27:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379531"
}
```



---

archive/issue_events_379532.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-06-18T04:27:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379532"
}
```



---

archive/issue_events_379533.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-06-18T04:27:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379533"
}
```



---

archive/issue_events_379534.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2019-06-18T04:27:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379534"
}
```



---

archive/issue_events_379535.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-27T20:13:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379535"
}
```



---

archive/issue_events_379536.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "60e3eb188573d11036c31f42e3c927a57afc2dfe",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-06-27T20:13:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27886#event-379536"
}
```



---

archive/issue_comments_433304.json:
```json
{
    "body": "Changed branch from **[public/27886](https://github.com/sagemath/sagetrac-mirror/tree/public/27886)** to **[`34aba48`](https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95)**",
    "created_at": "2019-06-27T20:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27886",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27886#issuecomment-433304",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/27886](https://github.com/sagemath/sagetrac-mirror/tree/public/27886)** to **[`34aba48`](https://github.com/sagemath/sagetrac-mirror/commit/34aba4806942cd2478530faeaac4c36a18085f95)**
