# Issue 27538: Cycle_basis giving wrong results in case of multiedges()

archive/issues_027301.json:
```json
{
    "assignees": [
        "https://github.com/rajat1433"
    ],
    "body": "\n```\nsage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)\n\nsage: G.cycle_basis()\n\ngetting \n\n[[1, 4], [1, 4]]\n\n```\n\nIt should be \n\n```\n[[5, 6, 4], [2, 3, 4, 1]]\n```\n\n\nCC:  @dcoudert\n\nComponent: **graph theory**\n\nKeywords: **cycle**\n\nAuthor: **Abhay Pratap Singh**\n\nBranch/Commit: **[`5928a72`](https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841)**\n\nReviewer: **David Coudert, Rajat Mittal**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27538_\n\n",
    "closed_at": "2019-03-31T22:43:35Z",
    "created_at": "2019-03-23T11:48:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Cycle_basis giving wrong results in case of multiedges()",
    "type": "issue",
    "updated_at": "2019-03-31T22:43:35Z",
    "url": "https://github.com/sagemath/sage/issues/27538",
    "user": "https://github.com/rajat1433"
}
```

```
sage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)

sage: G.cycle_basis()

getting 

[[1, 4], [1, 4]]

```

It should be 

```
[[5, 6, 4], [2, 3, 4, 1]]
```


CC:  @dcoudert

Component: **graph theory**

Keywords: **cycle**

Author: **Abhay Pratap Singh**

Branch/Commit: **[`5928a72`](https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841)**

Reviewer: **David Coudert, Rajat Mittal**

_Issue created by migration from https://trac.sagemath.org/ticket/27538_





---

archive/issue_events_375164.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-23T11:48:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375164"
}
```



---

archive/issue_events_375165.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-23T11:48:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375165"
}
```



---

archive/issue_events_375166.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-23T11:48:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375166"
}
```



---

archive/issue_events_375167.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-23T11:48:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375167"
}
```



---

archive/issue_comments_426533.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI think this discrepency is due to the is_forest function which in turn is calling is_tree function and in it following lines of code is written to return the found cycle:\n\n\n```\n            if self.has_multiple_edges():\n                if output == 'vertex':\n                    return (False, list(self.multiple_edges(sort=True)[0][:2]))\n                edge1, edge2 = self.multiple_edges(sort=True)[:2]\n                if edge1[0] != edge2[0]:\n                    return (False, [edge1, edge2])\n                return (False, [edge1, (edge2[1], edge2[0], edge2[2])])\n```",
    "created_at": "2019-03-23T11:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426533",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:1" align="right">comment:1</div>

I think this discrepency is due to the is_forest function which in turn is calling is_tree function and in it following lines of code is written to return the found cycle:


```
            if self.has_multiple_edges():
                if output == 'vertex':
                    return (False, list(self.multiple_edges(sort=True)[0][:2]))
                edge1, edge2 = self.multiple_edges(sort=True)[:2]
                if edge1[0] != edge2[0]:
                    return (False, [edge1, edge2])
                return (False, [edge1, (edge2[1], edge2[0], edge2[2])])
```



---

archive/issue_events_375168.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-23T11:51:02Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "subject": "https://github.com/rajat1433",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375168"
}
```



---

archive/issue_comments_426534.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nProblem is due to\n\n\n```\nsage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)\n\nsage: w=G.subgraph(edges=[(1,4,None)])\nsage: w\nSubgraph of (): Multi-graph on 7 vertices\nsage: w.edges()\n[(1, 4, None), (1, 4, None)]\n\n```\n\nSubgraph is returning with multiple edges instead it should have an edge 1 time(maybe).\n\nAlso I am not sure of the definition should the answer for this graph be \n\n```\n[[5, 6, 4], [2, 3, 4, 1]]\n```\n\nOR\n\n```\n[[5, 6, 4], [2, 3, 4, 1],[1,4],[2,3]]\n```",
    "created_at": "2019-03-23T12:16:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426534",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:2" align="right">comment:2</div>

Problem is due to


```
sage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)

sage: w=G.subgraph(edges=[(1,4,None)])
sage: w
Subgraph of (): Multi-graph on 7 vertices
sage: w.edges()
[(1, 4, None), (1, 4, None)]

```

Subgraph is returning with multiple edges instead it should have an edge 1 time(maybe).

Also I am not sure of the definition should the answer for this graph be 

```
[[5, 6, 4], [2, 3, 4, 1]]
```

OR

```
[[5, 6, 4], [2, 3, 4, 1],[1,4],[2,3]]
```



---

archive/issue_comments_426535.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nGraphs should be simple and unweighted :P\n\nConcerning `.subgraph`, the result you get is what is documented\n\n```\n        - ``vertices`` -- a single vertex or an iterable container of vertices,\n          e.g. a list, set, graph, file or numeric array. If not passed (i.e.,\n          ``None``), defaults to the entire graph.\n\n        - ``edges`` -- as with ``vertices``, edges can be a single edge or an\n          iterable container of edges (e.g., a list, set, file, numeric array,\n          etc.). By default (``edges=None``), all edges are assumed and the\n          returned graph is an induced subgraph. In the case of multiple edges,\n          specifying an edge as `(u,v)` means to keep all edges `(u,v)`,\n          regardless of the label.\n```\n\nThere is a mistake in the documentation. It is documented that `output` can be `'vertex'` or `'edges'`, but\n\n```\nsage: G.cycle_basis(output='edges')\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-19-c82db06774e5> in <module>()\n----> 1 G.cycle_basis(output='edges')\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in cycle_basis(self, output)\n   4556         \"\"\"\n   4557         if not output in ['vertex', 'edge']:\n-> 4558             raise ValueError('output must be either vertex or edge')\n   4559 \n   4560         if self.allows_multiple_edges():\n\nValueError: output must be either vertex or edge\nsage: G.cycle_basis(output='edge')\n[[(1, 4, None), (4, 1, None)], [(1, 4, None), (4, 1, None)]]\n```\n\nI don't know how to fix the issue.",
    "created_at": "2019-03-24T18:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426535",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:3" align="right">comment:3</div>

Graphs should be simple and unweighted :P

Concerning `.subgraph`, the result you get is what is documented

```
        - ``vertices`` -- a single vertex or an iterable container of vertices,
          e.g. a list, set, graph, file or numeric array. If not passed (i.e.,
          ``None``), defaults to the entire graph.

        - ``edges`` -- as with ``vertices``, edges can be a single edge or an
          iterable container of edges (e.g., a list, set, file, numeric array,
          etc.). By default (``edges=None``), all edges are assumed and the
          returned graph is an induced subgraph. In the case of multiple edges,
          specifying an edge as `(u,v)` means to keep all edges `(u,v)`,
          regardless of the label.
```

There is a mistake in the documentation. It is documented that `output` can be `'vertex'` or `'edges'`, but

```
sage: G.cycle_basis(output='edges')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-19-c82db06774e5> in <module>()
----> 1 G.cycle_basis(output='edges')

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in cycle_basis(self, output)
   4556         """
   4557         if not output in ['vertex', 'edge']:
-> 4558             raise ValueError('output must be either vertex or edge')
   4559 
   4560         if self.allows_multiple_edges():

ValueError: output must be either vertex or edge
sage: G.cycle_basis(output='edge')
[[(1, 4, None), (4, 1, None)], [(1, 4, None), (4, 1, None)]]
```

I don't know how to fix the issue.



---

archive/issue_comments_426536.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@dcoudert](#comment%3A3):\n> Graphs should be simple and unweighted :P\n\nbut in the examples of cycle_basis following is given:\nhere G is non simple \n\n```\nFor undirected graphs with multiple edges:\n\nsage: G = Graph([(0, 2, 'a'), (0, 2, 'b'), (0, 1, 'c'), (1, 2, 'd')], multiedges=True)\nsage: G.cycle_basis()\n[[0, 2], [2, 1, 0]]\nsage: G.cycle_basis(output='edge')\n[[(0, 2, 'a'), (2, 0, 'b')], [(2, 1, 'd'), (1, 0, 'c'), (0, 2, 'a')]]\n\n```",
    "created_at": "2019-03-25T04:21:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426536",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@dcoudert](#comment%3A3):
> Graphs should be simple and unweighted :P

but in the examples of cycle_basis following is given:
here G is non simple 

```
For undirected graphs with multiple edges:

sage: G = Graph([(0, 2, 'a'), (0, 2, 'b'), (0, 1, 'c'), (1, 2, 'd')], multiedges=True)
sage: G.cycle_basis()
[[0, 2], [2, 1, 0]]
sage: G.cycle_basis(output='edge')
[[(0, 2, 'a'), (2, 0, 'b')], [(2, 1, 'd'), (1, 0, 'c'), (0, 2, 'a')]]

```



---

archive/issue_comments_426537.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt was a joke. Our life would be much easier without multiedges...",
    "created_at": "2019-03-25T07:24:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426537",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:5" align="right">comment:5</div>

It was a joke. Our life would be much easier without multiedges...



---

archive/issue_comments_426538.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHaha it really would be...",
    "created_at": "2019-03-25T09:46:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426538",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:6" align="right">comment:6</div>

Haha it really would be...



---

archive/issue_comments_426539.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt will work fine if instead of this line in cycle_basis()\n\n```\nreturn [self.subgraph(edges=T + [e]).is_forest(certificate=True,\n                                                           output=output)[1]\n                    for e in self.edge_iterator() if not e in T]\n```\nwe use\n\n```\nreturn [Graph(edges=T + [e]).is_forest(certificate=True,\n                                                           output=output)[1]\n                    for e in self.edge_iterator() if not e in T]\n```\nSince self.subgraph(e) includes multiple existing copies of e as mentioned above in comment and, if two copies of e = (x,y) are in graph and suppose e got included in T, then there is a cycle including (x,y) always in subgraph(T+[e]), which is returned.\nSo, to avoid that we should use the above method.\nBut it will require extra overhead of creating Graph multiple times, maybe we can use this method only when G has parameter multiedges=True.",
    "created_at": "2019-03-28T18:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426539",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:7" align="right">comment:7</div>

It will work fine if instead of this line in cycle_basis()

```
return [self.subgraph(edges=T + [e]).is_forest(certificate=True,
                                                           output=output)[1]
                    for e in self.edge_iterator() if not e in T]
```
we use

```
return [Graph(edges=T + [e]).is_forest(certificate=True,
                                                           output=output)[1]
                    for e in self.edge_iterator() if not e in T]
```
Since self.subgraph(e) includes multiple existing copies of e as mentioned above in comment and, if two copies of e = (x,y) are in graph and suppose e got included in T, then there is a cycle including (x,y) always in subgraph(T+[e]), which is returned.
So, to avoid that we should use the above method.
But it will require extra overhead of creating Graph multiple times, maybe we can use this method only when G has parameter multiedges=True.



---

archive/issue_comments_426540.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFor, example this works right.\n\n```\nsage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)\nsage: T = G.min_spanning_tree()\nsage: [Graph(T + [e],  multiedges=True).is_forest(certificate=True, output='vertex')[1] for e in G.edge_iterator() if not e in T]\n[[4, 3, 2, 1], [6, 5, 4]]\n\n```\nThough, it will not return some cycle of length 2(resulting from multiple edges between two vertices) when multiple edges e gets included in T because 'if not e in T' evaluates to False then.",
    "created_at": "2019-03-28T18:53:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426540",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:8" align="right">comment:8</div>

For, example this works right.

```
sage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)
sage: T = G.min_spanning_tree()
sage: [Graph(T + [e],  multiedges=True).is_forest(certificate=True, output='vertex')[1] for e in G.edge_iterator() if not e in T]
[[4, 3, 2, 1], [6, 5, 4]]

```
Though, it will not return some cycle of length 2(resulting from multiple edges between two vertices) when multiple edges e gets included in T because 'if not e in T' evaluates to False then.



---

archive/issue_comments_426541.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI think the answer should be \n\n```\n[[5, 6, 4], [2, 3, 4, 1],[1,4],[2,3]]\n```\n\naccording to definition of cycle_basis.\nhttps://en.wikipedia.org/wiki/Cycle_basis",
    "created_at": "2019-03-28T19:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426541",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:9" align="right">comment:9</div>

I think the answer should be 

```
[[5, 6, 4], [2, 3, 4, 1],[1,4],[2,3]]
```

according to definition of cycle_basis.
https://en.wikipedia.org/wiki/Cycle_basis



---

archive/issue_comments_426542.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nYes.\nI think it fixes this.\n\n```\nsage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)\nsage: T = G.min_spanning_tree()\nsage: H = G.copy()\nsage: H.delete_edges(T)\nsage: [Graph(T + [e],  multiedges=True).is_forest(certificate=True, output='vertex')[1] for e in H.edge_iterator()]\n[[1, 4], [2, 3], [4, 3, 2, 1], [6, 5, 4]]\n```",
    "created_at": "2019-03-28T19:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426542",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:10" align="right">comment:10</div>

Yes.
I think it fixes this.

```
sage: G = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)
sage: T = G.min_spanning_tree()
sage: H = G.copy()
sage: H.delete_edges(T)
sage: [Graph(T + [e],  multiedges=True).is_forest(certificate=True, output='vertex')[1] for e in H.edge_iterator()]
[[1, 4], [2, 3], [4, 3, 2, 1], [6, 5, 4]]
```



---

archive/issue_comments_426543.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI have sent diff #27563 for it by mistake instead of sending diff on this ticket.\nPlease review it.\\\\\nI have imported Graph from sage.graphs.graph in cycle_basis() function to create instance of Graph.",
    "created_at": "2019-03-28T22:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426543",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:11" align="right">comment:11</div>

I have sent diff #27563 for it by mistake instead of sending diff on this ticket.
Please review it.\\
I have imported Graph from sage.graphs.graph in cycle_basis() function to create instance of Graph.



---

archive/issue_comments_426544.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI suggest to move the branch from #27563 to this ticket and mark #27563 as duplicate. The motivation for that is that the discussion is in this ticket.\n\nSome comments on the branch:\n- instead of calling `is_forest`, you should call `is_tree`. Indeed, at this point of the code, you know that the graph is connected, so there is no need to check that again in `is_forest`. Actually, method `is_tree` will also check if the graph is connected.\n- align `output=output` below `certificate=True`\n- add a doctest with the example of this ticket",
    "created_at": "2019-03-29T10:07:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426544",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:12" align="right">comment:12</div>

I suggest to move the branch from #27563 to this ticket and mark #27563 as duplicate. The motivation for that is that the discussion is in this ticket.

Some comments on the branch:
- instead of calling `is_forest`, you should call `is_tree`. Indeed, at this point of the code, you know that the graph is connected, so there is no need to check that again in `is_forest`. Actually, method `is_tree` will also check if the graph is connected.
- align `output=output` below `certificate=True`
- add a doctest with the example of this ticket



---

archive/issue_comments_426545.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n@abhayptp can you make the requested changes, then we can move that branch to here. If you require any help let me know.",
    "created_at": "2019-03-29T11:05:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426545",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:13" align="right">comment:13</div>

@abhayptp can you make the requested changes, then we can move that branch to here. If you require any help let me know.



---

archive/issue_comments_426546.json:
```json
{
    "body": "Branch: **[u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__)**",
    "created_at": "2019-03-29T13:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426546",
    "user": "https://github.com/abhayptp"
}
```

Branch: **[u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__)**



---

archive/issue_comments_426547.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAdded doctests and made the required changes.\\\\\nThere were some extra whitespaces at 4 places in the file which have also been removed. My editor automatically did that :p \\\\\nI can undo that change if anyone wants.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2c82eca89e7ea2c88d2ce94f8904e12b969ccac\"><code>b2c82ec</code></a></td><td><code>Fixes cycle basis for multiedges</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a68ce1d896929e27b7dbd2a99dee810bc318dda\"><code>1a68ce1</code></a></td><td><code>Add doctests</code></td></tr></table>\n",
    "created_at": "2019-03-29T13:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426547",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:15" align="right">comment:15</div>

Added doctests and made the required changes.\\
There were some extra whitespaces at 4 places in the file which have also been removed. My editor automatically did that :p \\
I can undo that change if anyone wants.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2c82eca89e7ea2c88d2ce94f8904e12b969ccac"><code>b2c82ec</code></a></td><td><code>Fixes cycle basis for multiedges</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a68ce1d896929e27b7dbd2a99dee810bc318dda"><code>1a68ce1</code></a></td><td><code>Add doctests</code></td></tr></table>




---

archive/issue_comments_426548.json:
```json
{
    "body": "Commit: **[`1a68ce1`](https://github.com/sagemath/sagetrac-mirror/commit/1a68ce1d896929e27b7dbd2a99dee810bc318dda)**",
    "created_at": "2019-03-29T13:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426548",
    "user": "https://github.com/abhayptp"
}
```

Commit: **[`1a68ce1`](https://github.com/sagemath/sagetrac-mirror/commit/1a68ce1d896929e27b7dbd2a99dee810bc318dda)**



---

archive/issue_comments_426549.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nPlease add your real name in the Author field.\n\n`@`Rajat: I move your name in the reviewers field. So please double check the proposed solution ;) It passes all tests on my computer.",
    "created_at": "2019-03-29T15:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426549",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:16" align="right">comment:16</div>

Please add your real name in the Author field.

`@`Rajat: I move your name in the reviewers field. So please double check the proposed solution ;) It passes all tests on my computer.



---

archive/issue_comments_426550.json:
```json
{
    "body": "Changed reviewer from **David Coudert** to **David Coudert, Rajat Mittal**",
    "created_at": "2019-03-29T15:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426550",
    "user": "https://github.com/dcoudert"
}
```

Changed reviewer from **David Coudert** to **David Coudert, Rajat Mittal**



---

archive/issue_comments_426551.json:
```json
{
    "body": "Changed author from **Rajat Mittal** to none",
    "created_at": "2019-03-29T15:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426551",
    "user": "https://github.com/dcoudert"
}
```

Changed author from **Rajat Mittal** to none



---

archive/issue_comments_426552.json:
```json
{
    "body": "Author: **Abhay Pratap Singh**",
    "created_at": "2019-03-29T15:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426552",
    "user": "https://github.com/abhayptp"
}
```

Author: **Abhay Pratap Singh**



---

archive/issue_comments_426553.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIn sage we follow pep8 style:\nhttps://www.python.org/dev/peps/pep-0008/\n\n```diff\n-            sage: H = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)\n-            sage: H.cycle_basis()\n-            [[1, 4], [2, 3], [4, 3, 2, 1], [6, 5, 4]]\n+            sage: H = Graph([(1, 2), (2, 3), (2, 3), (3, 4), (1, 4), (1, 4), (4, 5), (5, 6), (4, 6), (6, 7)], multiedges=True)\n+            sage: H.cycle_basis()\n+            [[1, 4], [2, 3], [4, 3, 2, 1], [6, 5, 4]]\n```\n\nAlso you can add a Wikipedia reference explaining cycle_basis just after its definition\n\n```diff\n+        See the :wikipedia:`Cycle_basis` for more information.\n```",
    "created_at": "2019-03-29T15:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426553",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:18" align="right">comment:18</div>

In sage we follow pep8 style:
https://www.python.org/dev/peps/pep-0008/

```diff
-            sage: H = Graph([(1,2),(2,3),(2,3),(3,4),(1,4),(1,4),(4,5),(5,6),(4,6),(6,7)],multiedges=True)
-            sage: H.cycle_basis()
-            [[1, 4], [2, 3], [4, 3, 2, 1], [6, 5, 4]]
+            sage: H = Graph([(1, 2), (2, 3), (2, 3), (3, 4), (1, 4), (1, 4), (4, 5), (5, 6), (4, 6), (6, 7)], multiedges=True)
+            sage: H.cycle_basis()
+            [[1, 4], [2, 3], [4, 3, 2, 1], [6, 5, 4]]
```

Also you can add a Wikipedia reference explaining cycle_basis just after its definition

```diff
+        See the :wikipedia:`Cycle_basis` for more information.
```



---

archive/issue_comments_426554.json:
```json
{
    "body": "Changed commit from **[`1a68ce1`](https://github.com/sagemath/sagetrac-mirror/commit/1a68ce1d896929e27b7dbd2a99dee810bc318dda)** to **[`bcc34f9`](https://github.com/sagemath/sagetrac-mirror/commit/bcc34f96705c6fe06da61bb4a4d21c59f99e87c2)**",
    "created_at": "2019-03-29T15:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426554",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1a68ce1`](https://github.com/sagemath/sagetrac-mirror/commit/1a68ce1d896929e27b7dbd2a99dee810bc318dda)** to **[`bcc34f9`](https://github.com/sagemath/sagetrac-mirror/commit/bcc34f96705c6fe06da61bb4a4d21c59f99e87c2)**



---

archive/issue_comments_426555.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bcc34f96705c6fe06da61bb4a4d21c59f99e87c2\"><code>bcc34f9</code></a></td><td><code>Make code pep8 compliant</code></td></tr></table>\n",
    "created_at": "2019-03-29T15:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426555",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bcc34f96705c6fe06da61bb4a4d21c59f99e87c2"><code>bcc34f9</code></a></td><td><code>Make code pep8 compliant</code></td></tr></table>




---

archive/issue_comments_426556.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReference added and code made pep8 compliant.",
    "created_at": "2019-03-29T16:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426556",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:20" align="right">comment:20</div>

Reference added and code made pep8 compliant.



---

archive/issue_comments_426557.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n\n```\n            return [Graph(T + [e], multiedges=True).is_tree(certificate=True,\n                                                            output=output)[1]\n                    for e in H.edge_iterator()]\n```\n\ninstead of creating a new graph again and again you can create a single graph from T and then you may add and delete edge e in H.edge_iterator to that graph.",
    "created_at": "2019-03-29T16:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426557",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:21" align="right">comment:21</div>


```
            return [Graph(T + [e], multiedges=True).is_tree(certificate=True,
                                                            output=output)[1]
                    for e in H.edge_iterator()]
```

instead of creating a new graph again and again you can create a single graph from T and then you may add and delete edge e in H.edge_iterator to that graph.



---

archive/issue_comments_426558.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThat's right, you can do something like:\n\n```\nfrom sage.graphs.graph import Graph\nT = Graph(self.min_spanning_tree(), multiedges=True, format='list_of_edges')\nH = self.copy()\nH.delete_edges(T.edge_iterator())\nL = []\nfor e in H.edge_iterator():\n    T.add_edge(e)\n    L.append(T.is_tree(certificate=True, output=output)[1])\n    T.delete_edge(e)\nreturn L\n```",
    "created_at": "2019-03-29T16:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426558",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:22" align="right">comment:22</div>

That's right, you can do something like:

```
from sage.graphs.graph import Graph
T = Graph(self.min_spanning_tree(), multiedges=True, format='list_of_edges')
H = self.copy()
H.delete_edges(T.edge_iterator())
L = []
for e in H.edge_iterator():
    T.add_edge(e)
    L.append(T.is_tree(certificate=True, output=output)[1])
    T.delete_edge(e)
return L
```



---

archive/issue_comments_426559.json:
```json
{
    "body": "Changed commit from **[`bcc34f9`](https://github.com/sagemath/sagetrac-mirror/commit/bcc34f96705c6fe06da61bb4a4d21c59f99e87c2)** to **[`adaa2b9`](https://github.com/sagemath/sagetrac-mirror/commit/adaa2b9fa5885c20e3a31b205fa014174ce2611c)**",
    "created_at": "2019-03-29T16:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426559",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bcc34f9`](https://github.com/sagemath/sagetrac-mirror/commit/bcc34f96705c6fe06da61bb4a4d21c59f99e87c2)** to **[`adaa2b9`](https://github.com/sagemath/sagetrac-mirror/commit/adaa2b9fa5885c20e3a31b205fa014174ce2611c)**



---

archive/issue_comments_426560.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adaa2b9fa5885c20e3a31b205fa014174ce2611c\"><code>adaa2b9</code></a></td><td><code>Better implementation</code></td></tr></table>\n",
    "created_at": "2019-03-29T16:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426560",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adaa2b9fa5885c20e3a31b205fa014174ce2611c"><code>adaa2b9</code></a></td><td><code>Better implementation</code></td></tr></table>




---

archive/issue_comments_426561.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nNote that T is a list. So you can't use add_edge in that. You need to construct a graph from T first \n\n```\nT = Graph(self.min_spanning_tree(), multiedges=True, format='list_of_edges')\n```",
    "created_at": "2019-03-29T17:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426561",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:24" align="right">comment:24</div>

Note that T is a list. So you can't use add_edge in that. You need to construct a graph from T first 

```
T = Graph(self.min_spanning_tree(), multiedges=True, format='list_of_edges')
```



---

archive/issue_comments_426562.json:
```json
{
    "body": "Changed commit from **[`adaa2b9`](https://github.com/sagemath/sagetrac-mirror/commit/adaa2b9fa5885c20e3a31b205fa014174ce2611c)** to **[`2a80f15`](https://github.com/sagemath/sagetrac-mirror/commit/2a80f15e77c93f7bb9cd63fd9bff31ba23051f82)**",
    "created_at": "2019-03-29T17:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426562",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`adaa2b9`](https://github.com/sagemath/sagetrac-mirror/commit/adaa2b9fa5885c20e3a31b205fa014174ce2611c)** to **[`2a80f15`](https://github.com/sagemath/sagetrac-mirror/commit/2a80f15e77c93f7bb9cd63fd9bff31ba23051f82)**



---

archive/issue_comments_426563.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a80f15e77c93f7bb9cd63fd9bff31ba23051f82\"><code>2a80f15</code></a></td><td><code>Better implementation-2</code></td></tr></table>\n",
    "created_at": "2019-03-29T17:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426563",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a80f15e77c93f7bb9cd63fd9bff31ba23051f82"><code>2a80f15</code></a></td><td><code>Better implementation-2</code></td></tr></table>




---

archive/issue_comments_426564.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nYeah. I missed that. I don't get why tests went silent. Maybe, I didn't do ./sage -br?",
    "created_at": "2019-03-29T17:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426564",
    "user": "https://github.com/abhayptp"
}
```

<div id="comment:26" align="right">comment:26</div>

Yeah. I missed that. I don't get why tests went silent. Maybe, I didn't do ./sage -br?



---

archive/issue_comments_426565.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI usually do `./sage -btp --long src/sage/graphs/generic_graph.py`.\n\nFor me this patch is now good to go. Thanks.\n\n`@`Rajat: if you have no further comments, you can set the ticket to positive review.",
    "created_at": "2019-03-29T17:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426565",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:27" align="right">comment:27</div>

I usually do `./sage -btp --long src/sage/graphs/generic_graph.py`.

For me this patch is now good to go. Thanks.

`@`Rajat: if you have no further comments, you can set the ticket to positive review.



---

archive/issue_comments_426566.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nA few improvements:\n\n- Note that Networkx implementation of cycle_basis also does not work for directed graphs so we can check that at the start of the code and return the appropriate error there only.\n\n- A small grammatical error ;)\n\n```diff\n-        a dictionary associating an unique vector to each undirected edge::\n+        a dictionary associating a unique vector to each undirected edge::\n```\n\n- Since the copy parameter of Networkx graph has been deprecated(ticket:27491) you may remove it:\n\n```diff\n-        cycle_basis_v = networkx.cycle_basis(self.networkx_graph(copy=False))\n+        cycle_basis_v = networkx.cycle_basis(self.networkx_graph())\n```",
    "created_at": "2019-03-29T17:51:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426566",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:28" align="right">comment:28</div>

A few improvements:

- Note that Networkx implementation of cycle_basis also does not work for directed graphs so we can check that at the start of the code and return the appropriate error there only.

- A small grammatical error ;)

```diff
-        a dictionary associating an unique vector to each undirected edge::
+        a dictionary associating a unique vector to each undirected edge::
```

- Since the copy parameter of Networkx graph has been deprecated(ticket:27491) you may remove it:

```diff
-        cycle_basis_v = networkx.cycle_basis(self.networkx_graph(copy=False))
+        cycle_basis_v = networkx.cycle_basis(self.networkx_graph())
```



---

archive/issue_comments_426567.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5956849f9fe9121a63a1936136afd51245bd22f6\"><code>5956849</code></a></td><td><code>Minor changes</code></td></tr></table>\n",
    "created_at": "2019-03-29T18:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426567",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5956849f9fe9121a63a1936136afd51245bd22f6"><code>5956849</code></a></td><td><code>Minor changes</code></td></tr></table>




---

archive/issue_comments_426568.json:
```json
{
    "body": "Changed commit from **[`2a80f15`](https://github.com/sagemath/sagetrac-mirror/commit/2a80f15e77c93f7bb9cd63fd9bff31ba23051f82)** to **[`5956849`](https://github.com/sagemath/sagetrac-mirror/commit/5956849f9fe9121a63a1936136afd51245bd22f6)**",
    "created_at": "2019-03-29T18:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426568",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2a80f15`](https://github.com/sagemath/sagetrac-mirror/commit/2a80f15e77c93f7bb9cd63fd9bff31ba23051f82)** to **[`5956849`](https://github.com/sagemath/sagetrac-mirror/commit/5956849f9fe9121a63a1936136afd51245bd22f6)**



---

archive/issue_comments_426569.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nJust last one \ud83d\ude42\n\nYou may consider adding a test mentioning this ticket:\n\n```diff\n+        TESTS:\n+\n+        :trac:`27538`::\n+\n+            sage: G= Graph([(1, 2, 'a'),(2, 3, 'b'),(2, 3, 'c'),(3, 4, 'd'),(3, 4, 'e'),(4, 1, 'f')], multiedges=True)\n+            sage: G.cycle_basis()\n+            [[2, 3], [4, 3, 2, 1], [4, 3, 2, 1]]\n+            sage: G.cycle_basis(output='edge')\n+            [[(2, 3, 'b'), (3, 2, 'c')],\n+             [(4, 3, 'd'), (3, 2, 'b'), (2, 1, 'a'), (1, 4, 'f')],\n+             [(4, 3, 'e'), (3, 2, 'b'), (2, 1, 'a'), (1, 4, 'f')]]\n```",
    "created_at": "2019-03-29T18:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426569",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:30" align="right">comment:30</div>

Just last one ðŸ™‚

You may consider adding a test mentioning this ticket:

```diff
+        TESTS:
+
+        :trac:`27538`::
+
+            sage: G= Graph([(1, 2, 'a'),(2, 3, 'b'),(2, 3, 'c'),(3, 4, 'd'),(3, 4, 'e'),(4, 1, 'f')], multiedges=True)
+            sage: G.cycle_basis()
+            [[2, 3], [4, 3, 2, 1], [4, 3, 2, 1]]
+            sage: G.cycle_basis(output='edge')
+            [[(2, 3, 'b'), (3, 2, 'c')],
+             [(4, 3, 'd'), (3, 2, 'b'), (2, 1, 'a'), (1, 4, 'f')],
+             [(4, 3, 'e'), (3, 2, 'b'), (2, 1, 'a'), (1, 4, 'f')]]
```



---

archive/issue_comments_426570.json:
```json
{
    "body": "Changed commit from **[`5956849`](https://github.com/sagemath/sagetrac-mirror/commit/5956849f9fe9121a63a1936136afd51245bd22f6)** to **[`efb6b0c`](https://github.com/sagemath/sagetrac-mirror/commit/efb6b0caec3a7340759526decb1443aaa51561a5)**",
    "created_at": "2019-03-29T19:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426570",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5956849`](https://github.com/sagemath/sagetrac-mirror/commit/5956849f9fe9121a63a1936136afd51245bd22f6)** to **[`efb6b0c`](https://github.com/sagemath/sagetrac-mirror/commit/efb6b0caec3a7340759526decb1443aaa51561a5)**



---

archive/issue_comments_426571.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efb6b0caec3a7340759526decb1443aaa51561a5\"><code>efb6b0c</code></a></td><td><code>Minor changes-2</code></td></tr></table>\n",
    "created_at": "2019-03-29T19:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426571",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efb6b0caec3a7340759526decb1443aaa51561a5"><code>efb6b0c</code></a></td><td><code>Minor changes-2</code></td></tr></table>




---

archive/issue_comments_426572.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nadd a line after the definition of cycle_basis:\n\n```diff\n-        See the :wikipedia:`Cycle_basis` for more information.\n+\n+        See the :wikipedia:`Cycle_basis` for more information.\n```\n\nNotice the changes:\n\n```diff\n-            sage: G = DiGraph([(0, 2, 'a'), (0, 1, 'c'), (1, 2, 'd')], multiedges=True)\n+            sage: G = DiGraph([(0, 2, 'a'), (0, 1, 'b'), (1, 2, 'c')])\n```",
    "created_at": "2019-03-29T19:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426572",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:32" align="right">comment:32</div>

add a line after the definition of cycle_basis:

```diff
-        See the :wikipedia:`Cycle_basis` for more information.
+
+        See the :wikipedia:`Cycle_basis` for more information.
```

Notice the changes:

```diff
-            sage: G = DiGraph([(0, 2, 'a'), (0, 1, 'c'), (1, 2, 'd')], multiedges=True)
+            sage: G = DiGraph([(0, 2, 'a'), (0, 1, 'b'), (1, 2, 'c')])
```



---

archive/issue_comments_426573.json:
```json
{
    "body": "Changed commit from **[`efb6b0c`](https://github.com/sagemath/sagetrac-mirror/commit/efb6b0caec3a7340759526decb1443aaa51561a5)** to **[`5928a72`](https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841)**",
    "created_at": "2019-03-29T20:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426573",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`efb6b0c`](https://github.com/sagemath/sagetrac-mirror/commit/efb6b0caec3a7340759526decb1443aaa51561a5)** to **[`5928a72`](https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841)**



---

archive/issue_comments_426574.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841\"><code>5928a72</code></a></td><td><code>Minor changes-3</code></td></tr></table>\n",
    "created_at": "2019-03-29T20:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426574",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841"><code>5928a72</code></a></td><td><code>Minor changes-3</code></td></tr></table>




---

archive/issue_events_375169.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-03-29T21:24:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375169"
}
```



---

archive/issue_comments_426575.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThis patch is very good now. Thanks to both of you.\n\nI'm now waiting for the patchbot, just in case.",
    "created_at": "2019-03-29T21:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426575",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:35" align="right">comment:35</div>

This patch is very good now. Thanks to both of you.

I'm now waiting for the patchbot, just in case.



---

archive/issue_comments_426576.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nLGTM\n\n`@`David: if you have no further comments, we can set the ticket to positive review.",
    "created_at": "2019-03-30T05:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426576",
    "user": "https://github.com/rajat1433"
}
```

<div id="comment:36" align="right">comment:36</div>

LGTM

`@`David: if you have no further comments, we can set the ticket to positive review.



---

archive/issue_events_375170.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-03-30T07:58:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375170"
}
```



---

archive/issue_events_375171.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-03-30T07:58:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375171"
}
```



---

archive/issue_comments_426577.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nLGTM.",
    "created_at": "2019-03-30T07:58:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426577",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:37" align="right">comment:37</div>

LGTM.



---

archive/issue_events_375172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-31T22:43:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375172"
}
```



---

archive/issue_events_375173.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "caabdbacc3f762938b58b39d6750892a11ed5188",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-31T22:43:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27538#event-375173"
}
```



---

archive/issue_comments_426578.json:
```json
{
    "body": "Changed branch from **[u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__)** to **[`5928a72`](https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841)**",
    "created_at": "2019-03-31T22:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27538",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27538#issuecomment-426578",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-abhayptp/cycle_basis_giving_wrong_results_in_case_of_multiedges__)** to **[`5928a72`](https://github.com/sagemath/sagetrac-mirror/commit/5928a728f6f5ff437f01aa383db55e64c6127841)**
