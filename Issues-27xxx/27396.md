# Issue 27396: Redesign of the constructor for Hyperelliptic curves

archive/issues_027396.json:
```json
{
    "body": "CC:  @JRSijsling @mstreng @videlec @slel\n\nKeywords: days98, hyperelliptic curves\n\nAs discussed in #22173, the current the design of the hyperelliptic curves classes was not good.\n\nThis changes create the (genus, ring) subclasses dynamically, removing the need for a class/file per case.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27633\n\n",
    "closed_at": "2019-04-27T17:44:14Z",
    "created_at": "2019-04-10T08:28:48Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Redesign of the constructor for Hyperelliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27396",
    "user": "https://github.com/anna-somoza"
}
```
CC:  @JRSijsling @mstreng @videlec @slel

Keywords: days98, hyperelliptic curves

As discussed in #22173, the current the design of the hyperelliptic curves classes was not good.

This changes create the (genus, ring) subclasses dynamically, removing the need for a class/file per case.

Issue created by migration from https://trac.sagemath.org/ticket/27633





---

archive/issue_comments_385664.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-11T08:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385664",
    "user": "https://github.com/anna-somoza"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_385665.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to number theory.",
    "created_at": "2019-04-11T08:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385665",
    "user": "https://github.com/anna-somoza"
}
```

Changing component from PLEASE CHANGE to number theory.



---

archive/issue_comments_385666.json:
```json
{
    "body": "Changing keywords from \"\" to \"days98, hyperelliptic curves\".",
    "created_at": "2019-04-11T08:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385666",
    "user": "https://github.com/anna-somoza"
}
```

Changing keywords from "" to "days98, hyperelliptic curves".



---

archive/issue_comments_385667.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-04-11T08:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385667",
    "user": "https://github.com/anna-somoza"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_385668.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-04-11T08:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385668",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_385669.json:
```json
{
    "body": "This is a good move.\n\nThe logic in the following is weird\n\n```\nfld = map(lambda fnc : fnc(R), [is_FiniteField, is_RationalField, is_pAdicField])\nfld_type = fld.index(True)\n```\nYou would rather do something like\n\n```\nfields = [\n   (\"FiniteField\", is_FiniteField, HyperellipticCurve_finite_field),\n   (\"RationalField\", is_RationalField, HyperellipticCurve_rational_field),\n   (\"pAdicField\", is_pAdicField, HyperellipticCurve_padic_field)]\nfor name, test, cls in fields:\n    if test(R):\n        ....    # treat the class\n        break   # the tests are exclusive, no need to run through all cases\n```",
    "created_at": "2019-04-11T08:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385669",
    "user": "https://github.com/videlec"
}
```

This is a good move.

The logic in the following is weird

```
fld = map(lambda fnc : fnc(R), [is_FiniteField, is_RationalField, is_pAdicField])
fld_type = fld.index(True)
```
You would rather do something like

```
fields = [
   ("FiniteField", is_FiniteField, HyperellipticCurve_finite_field),
   ("RationalField", is_RationalField, HyperellipticCurve_rational_field),
   ("pAdicField", is_pAdicField, HyperellipticCurve_padic_field)]
for name, test, cls in fields:
    if test(R):
        ....    # treat the class
        break   # the tests are exclusive, no need to run through all cases
```



---

archive/issue_comments_385670.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-11T09:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385670",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385671.json:
```json
{
    "body": "Agreed, with your approach the code is easier to understand.",
    "created_at": "2019-04-11T09:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385671",
    "user": "https://github.com/anna-somoza"
}
```

Agreed, with your approach the code is easier to understand.



---

archive/issue_comments_385672.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-11T09:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385672",
    "user": "https://github.com/anna-somoza"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_385673.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-11T12:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385674.json:
```json
{
    "body": "Similarly, why do you construct a dictionary in the following\n\n```\n+    genus_class = {2:HyperellipticCurve_g2}\n+    if g in genus_class.keys():\n+        supercls.append(genus_class[g])\n```\nThis is simpler as\n\n```\nif g == 2:\n    supercls.append(HyperellipticCurve_g2)\n```",
    "created_at": "2019-04-11T12:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385674",
    "user": "https://github.com/videlec"
}
```

Similarly, why do you construct a dictionary in the following

```
+    genus_class = {2:HyperellipticCurve_g2}
+    if g in genus_class.keys():
+        supercls.append(genus_class[g])
```
This is simpler as

```
if g == 2:
    supercls.append(HyperellipticCurve_g2)
```



---

archive/issue_comments_385675.json:
```json
{
    "body": "This I did with #22173 in mind, where I will add the class for genus 3 to the dictionary (I am working on it right now). In general, if more genus are added, then using the dictionary leads to a cleaner code than a list of ifs.",
    "created_at": "2019-04-11T13:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385675",
    "user": "https://github.com/anna-somoza"
}
```

This I did with #22173 in mind, where I will add the class for genus 3 to the dictionary (I am working on it right now). In general, if more genus are added, then using the dictionary leads to a cleaner code than a list of ifs.



---

archive/issue_comments_385676.json:
```json
{
    "body": "I see. What about?\n\n```\nif g == 2:\n    supercls.append(HyperellipticCurve_g2)\n# elif g == 3:\n#     supercls.append(HyperellipticCurve_g3)\n```",
    "created_at": "2019-04-11T13:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385676",
    "user": "https://github.com/videlec"
}
```

I see. What about?

```
if g == 2:
    supercls.append(HyperellipticCurve_g2)
# elif g == 3:
#     supercls.append(HyperellipticCurve_g3)
```



---

archive/issue_comments_385677.json:
```json
{
    "body": "What do you think about removing the inheritance from `HyperellipticCurve_generic`\nin `HyperellipticCurve_rational_field`, `HyperellipticCurve_padic_field`, etc? All the inheritance is handled by this new function anyway.\n\nIn this case, the function would be\n\n```\ncls = [HyperellipticCurve_generic]\n\n...\n\nif len(cls) > 1:   # contains more than just HyperellipticCurve_generic\n    cls = type(\"HyperellipticCurve_\" + \"_\".join(cls_name), tuple(cls), {})\n\nreturn cls(PP, f, h, names=names, genus=g)\n```",
    "created_at": "2019-04-11T13:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385677",
    "user": "https://github.com/videlec"
}
```

What do you think about removing the inheritance from `HyperellipticCurve_generic`
in `HyperellipticCurve_rational_field`, `HyperellipticCurve_padic_field`, etc? All the inheritance is handled by this new function anyway.

In this case, the function would be

```
cls = [HyperellipticCurve_generic]

...

if len(cls) > 1:   # contains more than just HyperellipticCurve_generic
    cls = type("HyperellipticCurve_" + "_".join(cls_name), tuple(cls), {})

return cls(PP, f, h, names=names, genus=g)
```



---

archive/issue_comments_385678.json:
```json
{
    "body": "And last but not the least, you definitely don't to create twice the same class. The first reason for this is that if you construct twice a hyperelliptic curves over rational you want the type to be the same. But the type function will recreate a new class each time (even if it has the same name).\n\nAlso, you don't want to create classes that are not necessary. Creating a class for each genus is a waste of time.",
    "created_at": "2019-04-11T13:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385678",
    "user": "https://github.com/videlec"
}
```

And last but not the least, you definitely don't to create twice the same class. The first reason for this is that if you construct twice a hyperelliptic curves over rational you want the type to be the same. But the type function will recreate a new class each time (even if it has the same name).

Also, you don't want to create classes that are not necessary. Creating a class for each genus is a waste of time.



---

archive/issue_comments_385679.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-11T14:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385679",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385680.json:
```json
{
    "body": "Replying to [comment:9 vdelecroix]:\n> I see. What about?\n> \n> ```\n> if g == 2:\n>     supercls.append(HyperellipticCurve_g2)\n> # elif g == 3:\n> #     supercls.append(HyperellipticCurve_g3)\n> ```\n\n\nHow about this new version? There I just use the information of the classes that are imported in the module. \n\nReplying to [comment:10 vdelecroix]:\n> What do you think about removing the inheritance from `HyperellipticCurve_generic`\n> in `HyperellipticCurve_rational_field`, `HyperellipticCurve_padic_field`, etc? All the inheritance is handled by this new function anyway.\n> \n> In this case, the function would be\n> \n> ```\n> cls = [HyperellipticCurve_generic]\n> \n> ...\n> \n> if len(cls) > 1:   # contains more than just HyperellipticCurve_generic\n>     cls = type(\"HyperellipticCurve_\" + \"_\".join(cls_name), tuple(cls), {})\n> \n> return cls(PP, f, h, names=names, genus=g)\n> ```\n\n\nThe methods in `HyperellipticCurve_rational_field` and others use methods from `HyperellipticCurve_generic`, so I don't think that it is a good idea.\n\nReplying to [comment:11 vdelecroix]:\n> And last but not the least, you definitely don't to create twice the same class. The first reason for this is that if you construct twice a hyperelliptic curves over rational you want the type to be the same. But the type function will recreate a new class each time (even if it has the same name).\n> \n> Also, you don't want to create classes that are not necessary. Creating a class for each genus is a waste of time.\n\n\nAgreed, I included the functionality and added a test for it.",
    "created_at": "2019-04-11T14:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385680",
    "user": "https://github.com/anna-somoza"
}
```

Replying to [comment:9 vdelecroix]:
> I see. What about?
> 
> ```
> if g == 2:
>     supercls.append(HyperellipticCurve_g2)
> # elif g == 3:
> #     supercls.append(HyperellipticCurve_g3)
> ```


How about this new version? There I just use the information of the classes that are imported in the module. 

Replying to [comment:10 vdelecroix]:
> What do you think about removing the inheritance from `HyperellipticCurve_generic`
> in `HyperellipticCurve_rational_field`, `HyperellipticCurve_padic_field`, etc? All the inheritance is handled by this new function anyway.
> 
> In this case, the function would be
> 
> ```
> cls = [HyperellipticCurve_generic]
> 
> ...
> 
> if len(cls) > 1:   # contains more than just HyperellipticCurve_generic
>     cls = type("HyperellipticCurve_" + "_".join(cls_name), tuple(cls), {})
> 
> return cls(PP, f, h, names=names, genus=g)
> ```


The methods in `HyperellipticCurve_rational_field` and others use methods from `HyperellipticCurve_generic`, so I don't think that it is a good idea.

Replying to [comment:11 vdelecroix]:
> And last but not the least, you definitely don't to create twice the same class. The first reason for this is that if you construct twice a hyperelliptic curves over rational you want the type to be the same. But the type function will recreate a new class each time (even if it has the same name).
> 
> Also, you don't want to create classes that are not necessary. Creating a class for each genus is a waste of time.


Agreed, I included the functionality and added a test for it.



---

archive/issue_comments_385681.json:
```json
{
    "body": "Replying to [comment:13 annasomoza]:\n> Replying to [comment:9 vdelecroix]:\n> > I see. What about?\n> > \n> > ```\n> > if g == 2:\n> >     supercls.append(HyperellipticCurve_g2)\n> > # elif g == 3:\n> > #     supercls.append(HyperellipticCurve_g3)\n> > ```\n\n> \n> How about this new version? There I just use the information of the classes that are imported in the module. \n\n\nThis is terrible. Explicit code is to my mind much better. With the current version, a curious person looking at the code would have no clue about how it works.",
    "created_at": "2019-04-12T06:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385681",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:13 annasomoza]:
> Replying to [comment:9 vdelecroix]:
> > I see. What about?
> > 
> > ```
> > if g == 2:
> >     supercls.append(HyperellipticCurve_g2)
> > # elif g == 3:
> > #     supercls.append(HyperellipticCurve_g3)
> > ```

> 
> How about this new version? There I just use the information of the classes that are imported in the module. 


This is terrible. Explicit code is to my mind much better. With the current version, a curious person looking at the code would have no clue about how it works.



---

archive/issue_comments_385682.json:
```json
{
    "body": "Otherwise, the caching with the dictionary is ok.",
    "created_at": "2019-04-12T06:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385682",
    "user": "https://github.com/videlec"
}
```

Otherwise, the caching with the dictionary is ok.



---

archive/issue_comments_385683.json:
```json
{
    "body": "The new version is good as it forces new contributions to follow the same name pattern and only requires to add the new class without changing the source code of the main function. \n\nSo I don't think \"terrible\" is an appropriate adjective! (Unless you have an other way to catch the existing classes?) A list of ifs might just get very long and unpractical. \n\nI do agree that it is not very reader-friendly as it is. This could easily be fixed with more comments/documentation.",
    "created_at": "2019-04-12T07:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385683",
    "user": "https://github.com/VivianePons"
}
```

The new version is good as it forces new contributions to follow the same name pattern and only requires to add the new class without changing the source code of the main function. 

So I don't think "terrible" is an appropriate adjective! (Unless you have an other way to catch the existing classes?) A list of ifs might just get very long and unpractical. 

I do agree that it is not very reader-friendly as it is. This could easily be fixed with more comments/documentation.



---

archive/issue_comments_385684.json:
```json
{
    "body": "Replying to [comment:16 VivianePons]:\n> The new version is good as it forces new contributions to follow the same name pattern and only requires to add the new class without changing the source code of the main function. \n> \n> So I don't think \"terrible\" is an appropriate adjective! (Unless you have an other way to catch the existing classes?) A list of ifs might just get very long and unpractical. \n\n\nThe list has length one and after #22173 it will have length two. I don't understand this objection.\n\n> I do agree that it is not very reader-friendly as it is. This could easily be fixed with more comments/documentation.\n\n\n\"Terrible design\" is appropriate.\n\n1. As I said it is unreadable.\n\n2. The code is sensitive to code injection\n\n```\nsage: import sage.schemes.hyperelliptic_curves.constructor as constructor\nsage: constructor.HyperellipticCurve_g3 = int\n```\nYou might consider this as a super feature, but it is very much error prone.\n\n3. The way it is written goes through several dictionary accesses and a try/except each time a hyperelliptic curve is created. This is a waste of time as you want constructors to be as light as possible.",
    "created_at": "2019-04-12T08:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385684",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:16 VivianePons]:
> The new version is good as it forces new contributions to follow the same name pattern and only requires to add the new class without changing the source code of the main function. 
> 
> So I don't think "terrible" is an appropriate adjective! (Unless you have an other way to catch the existing classes?) A list of ifs might just get very long and unpractical. 


The list has length one and after #22173 it will have length two. I don't understand this objection.

> I do agree that it is not very reader-friendly as it is. This could easily be fixed with more comments/documentation.


"Terrible design" is appropriate.

1. As I said it is unreadable.

2. The code is sensitive to code injection

```
sage: import sage.schemes.hyperelliptic_curves.constructor as constructor
sage: constructor.HyperellipticCurve_g3 = int
```
You might consider this as a super feature, but it is very much error prone.

3. The way it is written goes through several dictionary accesses and a try/except each time a hyperelliptic curve is created. This is a waste of time as you want constructors to be as light as possible.



---

archive/issue_comments_385685.json:
```json
{
    "body": "I understand the objection about security and efficiency. The argument that the list will be of length 2 is not very convincing though: the very purpose of this ticket is to write an architecture which allows for easy extensions. \n\nI would suggest we go back to the initial solution that was proposed: use a dictionary associating the class name to the actual class. I find it much more readable than the list of ifs and easier to extend.",
    "created_at": "2019-04-12T08:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385685",
    "user": "https://github.com/VivianePons"
}
```

I understand the objection about security and efficiency. The argument that the list will be of length 2 is not very convincing though: the very purpose of this ticket is to write an architecture which allows for easy extensions. 

I would suggest we go back to the initial solution that was proposed: use a dictionary associating the class name to the actual class. I find it much more readable than the list of ifs and easier to extend.



---

archive/issue_comments_385686.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-16T13:34:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385687.json:
```json
{
    "body": "Following Viviane's comment, I went back to using a dictionary.\n\nI am not sure of the meaning of the error that the bot gives, I think it comes from the fact that some files where removed and is otherwise green.",
    "created_at": "2019-04-16T13:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385687",
    "user": "https://github.com/anna-somoza"
}
```

Following Viviane's comment, I went back to using a dictionary.

I am not sure of the meaning of the error that the bot gives, I think it comes from the fact that some files where removed and is otherwise green.



---

archive/issue_comments_385688.json:
```json
{
    "body": "You might want to test that inheritance is actually correct in the doctests\n\n```\nsage: R.<t> = PolynomialRing(GF(next_prime(10^9)))\nsage: C = HyperellipticCurve(t^5 + t + 1)\nsage: import inspect\nsage: inspect.getmro(type(C))\n(<class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_g2_FiniteField_with_category'>,\n <class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_g2_FiniteField'>,\n <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_g2.HyperellipticCurve_g2'>,\n <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field'>,\n <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_generic.HyperellipticCurve_generic'>,\n ...)\n```",
    "created_at": "2019-04-16T13:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385688",
    "user": "https://github.com/videlec"
}
```

You might want to test that inheritance is actually correct in the doctests

```
sage: R.<t> = PolynomialRing(GF(next_prime(10^9)))
sage: C = HyperellipticCurve(t^5 + t + 1)
sage: import inspect
sage: inspect.getmro(type(C))
(<class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_g2_FiniteField_with_category'>,
 <class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_g2_FiniteField'>,
 <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_g2.HyperellipticCurve_g2'>,
 <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field'>,
 <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_generic.HyperellipticCurve_generic'>,
 ...)
```



---

archive/issue_comments_385689.json:
```json
{
    "body": "Is it better to add a test for every case or with the one you gave it's enough?\n\nAlso, while looking into this I realized that I am duplicating the classes with only one superclass.\n\n```\nsage: R.<t> = PolynomialRing(GF(next_prime(10^9)))\nsage: C = HyperellipticCurve(t^7 + t + 1)\nsage: import inspect\nsage: inspect.getmro(type(C))\n(<class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_FiniteField_with_category'>,\n <class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_FiniteField'>,\n <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field'>,\n <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_generic.HyperellipticCurve_generic'>,\n...)\n```\n\nWould it be preferable to initiate the `created_classes` dictionary with the classes `HyperellipticCurve_g2`, `HyperellipticCurve_FiniteField`, etc to avoid that? That could also simplify the last part of the code if `HyperellipticCurve_generic` was added too.",
    "created_at": "2019-04-16T14:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385689",
    "user": "https://github.com/anna-somoza"
}
```

Is it better to add a test for every case or with the one you gave it's enough?

Also, while looking into this I realized that I am duplicating the classes with only one superclass.

```
sage: R.<t> = PolynomialRing(GF(next_prime(10^9)))
sage: C = HyperellipticCurve(t^7 + t + 1)
sage: import inspect
sage: inspect.getmro(type(C))
(<class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_FiniteField_with_category'>,
 <class 'sage.schemes.hyperelliptic_curves.constructor.HyperellipticCurve_FiniteField'>,
 <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_finite_field.HyperellipticCurve_finite_field'>,
 <class 'sage.schemes.hyperelliptic_curves.hyperelliptic_generic.HyperellipticCurve_generic'>,
...)
```

Would it be preferable to initiate the `created_classes` dictionary with the classes `HyperellipticCurve_g2`, `HyperellipticCurve_FiniteField`, etc to avoid that? That could also simplify the last part of the code if `HyperellipticCurve_generic` was added too.



---

archive/issue_comments_385690.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-18T11:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385691.json:
```json
{
    "body": "Even nicer.\n\nOne last little thing. In the documentation, you need a linebreak after `::`.",
    "created_at": "2019-04-18T11:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385691",
    "user": "https://github.com/videlec"
}
```

Even nicer.

One last little thing. In the documentation, you need a linebreak after `::`.



---

archive/issue_comments_385692.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-18T12:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385692",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385693.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-18T12:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385693",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_385694.json:
```json
{
    "body": "Perfect! Thanks for your patience.",
    "created_at": "2019-04-18T12:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385694",
    "user": "https://github.com/videlec"
}
```

Perfect! Thanks for your patience.



---

archive/issue_comments_385695.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-27T17:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27396#issuecomment-385695",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_068584.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-27T17:44:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27396",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27396#event-68584"
}
```
