# Issue 27050: speed up Schur to fundamental

archive/issues_026813.json:
```json
{
    "body": "Old:\n\n```\nsage: s = SymmetricFunctions(QQ).schur()\nsage: F = QuasiSymmetricFunctions(QQ).Fundamental()\nsage: %timeit [F(s(la)) for la in Partitions(7)]\n1 loop, best of 3: 2.04 s per loop\nsage: %timeit [F(s(la)) for la in Partitions(8)]\n1 loop, best of 3: 8.8 s per loop\n```\n\nNew:\n\n```\nsage: s = SymmetricFunctions(QQ).schur()\nsage: F = QuasiSymmetricFunctions(QQ).Fundamental()\nsage: %timeit [F(s(la)) for la in Partitions(7)]\n10 loops, best of 3: 97.9 ms per loop\nsage: %timeit [F(s(la)) for la in Partitions(8)]\n1 loop, best of 3: 331 ms per loop\n```\n\nCC:  @zabrocki @tscrim @darijgr\n\nBranch/Commit: 891a1f020725e494ccde9dfc3c9a70de6479d083\n\nReviewer: Travis Scrimshaw\n\nAuthor: Martin Rubey\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27050\n\n",
    "closed_at": "2019-01-24T18:17:28Z",
    "created_at": "2019-01-14T11:34:14Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "speed up Schur to fundamental",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27050",
    "user": "https://github.com/mantepse"
}
```
Old:

```
sage: s = SymmetricFunctions(QQ).schur()
sage: F = QuasiSymmetricFunctions(QQ).Fundamental()
sage: %timeit [F(s(la)) for la in Partitions(7)]
1 loop, best of 3: 2.04 s per loop
sage: %timeit [F(s(la)) for la in Partitions(8)]
1 loop, best of 3: 8.8 s per loop
```

New:

```
sage: s = SymmetricFunctions(QQ).schur()
sage: F = QuasiSymmetricFunctions(QQ).Fundamental()
sage: %timeit [F(s(la)) for la in Partitions(7)]
10 loops, best of 3: 97.9 ms per loop
sage: %timeit [F(s(la)) for la in Partitions(8)]
1 loop, best of 3: 331 ms per loop
```

CC:  @zabrocki @tscrim @darijgr

Branch/Commit: 891a1f020725e494ccde9dfc3c9a70de6479d083

Reviewer: Travis Scrimshaw

Author: Martin Rubey

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27050





---

archive/issue_comments_520159.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mantepse/speed_up_schur_to_fundamental\"",
    "created_at": "2019-01-14T11:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520159",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "" to "u/mantepse/speed_up_schur_to_fundamental"



---

archive/issue_comments_520160.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520160",
    "user": "https://github.com/mantepse"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_520161.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520161",
    "user": "https://github.com/mantepse"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_520162.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520162",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_520163.json:
```json
{
    "body": "Changing author from \"\" to \"Martin Rubey\"",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520163",
    "user": "https://github.com/mantepse"
}
```

Changing author from "" to "Martin Rubey"



---

archive/issue_comments_520164.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,21 @@\n+Old:\n \n+```\n+sage: s = SymmetricFunctions(QQ).schur()\n+sage: F = QuasiSymmetricFunctions(QQ).Fundamental()\n+sage: %timeit [F(s(la)) for la in Partitions(7)]\n+1 loop, best of 3: 2.04 s per loop\n+sage: %timeit [F(s(la)) for la in Partitions(8)]\n+1 loop, best of 3: 8.8 s per loop\n+```\n+\n+New:\n+\n+```\n+sage: s = SymmetricFunctions(QQ).schur()\n+sage: F = QuasiSymmetricFunctions(QQ).Fundamental()\n+sage: %timeit [F(s(la)) for la in Partitions(7)]\n+10 loops, best of 3: 97.9 ms per loop\n+sage: %timeit [F(s(la)) for la in Partitions(8)]\n+1 loop, best of 3: 331 ms per loop\n+```\n``````\n",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520164",
    "user": "https://github.com/mantepse"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,21 @@
+Old:
 
+```
+sage: s = SymmetricFunctions(QQ).schur()
+sage: F = QuasiSymmetricFunctions(QQ).Fundamental()
+sage: %timeit [F(s(la)) for la in Partitions(7)]
+1 loop, best of 3: 2.04 s per loop
+sage: %timeit [F(s(la)) for la in Partitions(8)]
+1 loop, best of 3: 8.8 s per loop
+```
+
+New:
+
+```
+sage: s = SymmetricFunctions(QQ).schur()
+sage: F = QuasiSymmetricFunctions(QQ).Fundamental()
+sage: %timeit [F(s(la)) for la in Partitions(7)]
+10 loops, best of 3: 97.9 ms per loop
+sage: %timeit [F(s(la)) for la in Partitions(8)]
+1 loop, best of 3: 331 ms per loop
+```
``````




---

archive/issue_comments_520165.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n|[dc41651](https://git.sagemath.org/sage.git/commit?id=dc41651a32d48ab376ef6671d16ad5fc6c4d6b1e)|`add dedicated coercion from the Schur basis to the Fundamental basis`|",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520165",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|[dc41651](https://git.sagemath.org/sage.git/commit?id=dc41651a32d48ab376ef6671d16ad5fc6c4d6b1e)|`add dedicated coercion from the Schur basis to the Fundamental basis`|



---

archive/issue_comments_520166.json:
```json
{
    "body": "Changing commit from \"\" to \"dc41651a32d48ab376ef6671d16ad5fc6c4d6b1e\"",
    "created_at": "2019-01-14T12:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520166",
    "user": "https://github.com/mantepse"
}
```

Changing commit from "" to "dc41651a32d48ab376ef6671d16ad5fc6c4d6b1e"



---

archive/issue_comments_520167.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[068d937](https://git.sagemath.org/sage.git/commit/?id=068d937fc441ca4bfe28636afb507fe766f8d868)|`fix wrong replacements`|",
    "created_at": "2019-01-14T16:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520167",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[068d937](https://git.sagemath.org/sage.git/commit/?id=068d937fc441ca4bfe28636afb507fe766f8d868)|`fix wrong replacements`|



---

archive/issue_comments_520168.json:
```json
{
    "body": "Changing commit from \"dc41651a32d48ab376ef6671d16ad5fc6c4d6b1e\" to \"068d937fc441ca4bfe28636afb507fe766f8d868\"",
    "created_at": "2019-01-14T16:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dc41651a32d48ab376ef6671d16ad5fc6c4d6b1e" to "068d937fc441ca4bfe28636afb507fe766f8d868"



---

archive/issue_comments_520169.json:
```json
{
    "body": "<a id='comment:4'></a>\nWith `_Partitions`/`Partitions()`, we decided to make that a global object permanently fixed in memory because it appears in so many different contexts within combinatorics and could appear in tighter loops (e.g., the cycle type of a permutation). So I am not sure about doing the same for `_Combinations`/`Combinations()`. Moreover, it should not have such a significant impact on timings because of the `UniqueRepresentation` behavior. Thus, I think this is something we need to take into more careful consideration. Nevertheless, it should be something on an independent ticket because it is a bigger change.\n\nIn `_from_schur_on_basis`, you can (I would probably even say should) use `self._indices` instead of `Compositions()` as `self._indices` has a little more context.",
    "created_at": "2019-01-14T17:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520169",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
With `_Partitions`/`Partitions()`, we decided to make that a global object permanently fixed in memory because it appears in so many different contexts within combinatorics and could appear in tighter loops (e.g., the cycle type of a permutation). So I am not sure about doing the same for `_Combinations`/`Combinations()`. Moreover, it should not have such a significant impact on timings because of the `UniqueRepresentation` behavior. Thus, I think this is something we need to take into more careful consideration. Nevertheless, it should be something on an independent ticket because it is a bigger change.

In `_from_schur_on_basis`, you can (I would probably even say should) use `self._indices` instead of `Compositions()` as `self._indices` has a little more context.



---

archive/issue_comments_520170.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-14T17:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520170",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_520171.json:
```json
{
    "body": "<a id='comment:5'></a>\nHowever, this is a good change to do and is quite a speedup.",
    "created_at": "2019-01-14T17:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520171",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
However, this is a good change to do and is quite a speedup.



---

archive/issue_comments_520172.json:
```json
{
    "body": "Changing commit from \"068d937fc441ca4bfe28636afb507fe766f8d868\" to \"891a1f020725e494ccde9dfc3c9a70de6479d083\"",
    "created_at": "2019-01-14T18:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520172",
    "user": "https://github.com/mantepse"
}
```

Changing commit from "068d937fc441ca4bfe28636afb507fe766f8d868" to "891a1f020725e494ccde9dfc3c9a70de6479d083"



---

archive/issue_comments_520173.json:
```json
{
    "body": "Changing branch from \"u/mantepse/speed_up_schur_to_fundamental\" to \"u/mantepse/speedup_schur_to_fundamental\"",
    "created_at": "2019-01-14T18:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520173",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "u/mantepse/speed_up_schur_to_fundamental" to "u/mantepse/speedup_schur_to_fundamental"



---

archive/issue_comments_520174.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-14T18:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520174",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_520175.json:
```json
{
    "body": "<a id='comment:7'></a>\ndone, and yes indeed, the `_Compositions` was nonsense, thanks!",
    "created_at": "2019-01-14T18:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520175",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:7'></a>
done, and yes indeed, the `_Compositions` was nonsense, thanks!



---

archive/issue_comments_520176.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-14T19:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520176",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_520177.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2019-01-14T19:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520177",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_520178.json:
```json
{
    "body": "<a id='comment:8'></a>\nI wouldn't say it was nonsense, but just something that would warrant a little more consideration.\n\nAnyways, LGTM. Thanks.",
    "created_at": "2019-01-14T19:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520178",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
I wouldn't say it was nonsense, but just something that would warrant a little more consideration.

Anyways, LGTM. Thanks.



---

archive/issue_comments_520179.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks.  Nonsense, because it did not give any speedup with respect to the topic of this ticket.",
    "created_at": "2019-01-14T19:19:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520179",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>
Thanks.  Nonsense, because it did not give any speedup with respect to the topic of this ticket.



---

archive/issue_events_067181.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:16:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27050#event-67181"
}
```



---

archive/issue_comments_520180.json:
```json
{
    "body": "<a id='comment:10'></a>\nRetarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520180",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>
Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_events_067182.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:17:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27050#event-67182"
}
```



---

archive/issue_comments_520181.json:
```json
{
    "body": "Changing branch from \"u/mantepse/speedup_schur_to_fundamental\" to \"891a1f020725e494ccde9dfc3c9a70de6479d083\"",
    "created_at": "2019-01-24T18:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520181",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mantepse/speedup_schur_to_fundamental" to "891a1f020725e494ccde9dfc3c9a70de6479d083"



---

archive/issue_comments_520182.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-24T18:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27050#issuecomment-520182",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
