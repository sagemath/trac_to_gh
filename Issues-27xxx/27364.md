# Issue 27364: cannot multiply multivariate polynomial ring and vector

archive/issues_027127.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: R = PolynomialRing(QQ, 't', 1); t = R.gen()\nsage: (t/2) * vector([1,2])\n```\nresults in a\n\n```\nTypeError: unsupported operand parent(s) for *: 'Multivariate Polynomial Ring in t over Rational Field' and 'Ambient free module of rank 2 over the principal ideal domain Integer Ring'\n```\n\nInterestingly, for a \"true\" univariate polynomial ring it works:\n\n```\nsage: R = PolynomialRing(QQ, 't'); t = R.gen()\nsage: (t/2) * vector([1,2])\n(1/2*t, t)\n```\nAlso for a multivariate polynomial ring in more than one variable it works:\n\n```\nsage: sage: R = PolynomialRing(QQ, 't', 2); t = R.gen()\n....: sage: (t/2) * vector([1,2])\n```\n\nThis issue was raised by the following doctest in sage.geometry.polyhedron.base, method `integrate`, ticket #27365:\n\n```\n        Integral over a non full-dimensional polytope::\n\n            sage: x, y = polygens(QQ, 'x, y')\n            sage: P = Polyhedron(vertices=[[0,0],[1,1]])\n            sage: P.integrate(x*y)    # optional - latte_int\n            0\n            sage: P.integrate(x*y, measure='induced')    # optional - latte_int  # not tested (see :trac:`27364`)\n```\n\n\nCC:  @tscrim @yuan-zhou @kliem\n\nBranch/Commit: **[u/mkoeppe/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/poly-times-vector) @ [`a5fd62d`](https://github.com/sagemath/sagetrac-mirror/commit/a5fd62d63024e6fecb1f6836a52ff894e8de7a92)**\n\nReviewer: **Matthias Koeppe, ...**\n\nAuthor: **Daniel Krenn**\n\nComponent: **coercion**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27364_\n\n",
    "created_at": "2019-02-26T14:14:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20coercion",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "cannot multiply multivariate polynomial ring and vector",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/27364",
    "user": "https://github.com/dkrenn"
}
```

```
sage: R = PolynomialRing(QQ, 't', 1); t = R.gen()
sage: (t/2) * vector([1,2])
```
results in a

```
TypeError: unsupported operand parent(s) for *: 'Multivariate Polynomial Ring in t over Rational Field' and 'Ambient free module of rank 2 over the principal ideal domain Integer Ring'
```

Interestingly, for a "true" univariate polynomial ring it works:

```
sage: R = PolynomialRing(QQ, 't'); t = R.gen()
sage: (t/2) * vector([1,2])
(1/2*t, t)
```
Also for a multivariate polynomial ring in more than one variable it works:

```
sage: sage: R = PolynomialRing(QQ, 't', 2); t = R.gen()
....: sage: (t/2) * vector([1,2])
```

This issue was raised by the following doctest in sage.geometry.polyhedron.base, method `integrate`, ticket #27365:

```
        Integral over a non full-dimensional polytope::

            sage: x, y = polygens(QQ, 'x, y')
            sage: P = Polyhedron(vertices=[[0,0],[1,1]])
            sage: P.integrate(x*y)    # optional - latte_int
            0
            sage: P.integrate(x*y, measure='induced')    # optional - latte_int  # not tested (see :trac:`27364`)
```


CC:  @tscrim @yuan-zhou @kliem

Branch/Commit: **[u/mkoeppe/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/poly-times-vector) @ [`a5fd62d`](https://github.com/sagemath/sagetrac-mirror/commit/a5fd62d63024e6fecb1f6836a52ff894e8de7a92)**

Reviewer: **Matthias Koeppe, ...**

Author: **Daniel Krenn**

Component: **coercion**

_Issue created by migration from https://trac.sagemath.org/ticket/27364_





---

archive/issue_events_375871.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-02-26T14:14:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375871"
}
```



---

archive/issue_events_375872.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-02-26T14:14:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20coercion",
    "label_color": "0000ff",
    "label_name": "c: coercion",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375872"
}
```



---

archive/issue_events_375873.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-02-26T14:14:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375873"
}
```



---

archive/issue_events_375874.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-02-26T14:14:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375874"
}
```



---

archive/issue_comments_423251.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,6 +12,7 @@\n Interestingly, for a \"true\" univariate polynomial ring it works:\n \n ```\n+sage: R = PolynomialRing(QQ, 't'); t = R.gen()\n sage: (t/2) * vector([1,2])\n (1/2*t, t)\n ```\n``````\n",
    "created_at": "2019-02-26T14:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423251",
    "user": "https://github.com/dkrenn"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,6 +12,7 @@
 Interestingly, for a "true" univariate polynomial ring it works:
 
 ```
+sage: R = PolynomialRing(QQ, 't'); t = R.gen()
 sage: (t/2) * vector([1,2])
 (1/2*t, t)
 ```
``````




---

archive/issue_comments_423252.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,9 @@\n sage: (t/2) * vector([1,2])\n (1/2*t, t)\n ```\n+Also for a multivariate polynomial ring in more than one variable it works:\n \n+```\n+sage: sage: R = PolynomialRing(QQ, 't', 2); t = R.gen()\n+....: sage: (t/2) * vector([1,2])\n+```\n``````\n",
    "created_at": "2019-02-26T14:17:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423252",
    "user": "https://github.com/dkrenn"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,9 @@
 sage: (t/2) * vector([1,2])
 (1/2*t, t)
 ```
+Also for a multivariate polynomial ring in more than one variable it works:
 
+```
+sage: sage: R = PolynomialRing(QQ, 't', 2); t = R.gen()
+....: sage: (t/2) * vector([1,2])
+```
``````




---

archive/issue_comments_423253.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,3 +22,16 @@\n sage: sage: R = PolynomialRing(QQ, 't', 2); t = R.gen()\n ....: sage: (t/2) * vector([1,2])\n ```\n+\n+This issue was raised by the following doctest in sage.geometry.polyhedron.base, method `integrate`, ticket #27365:\n+\n+```\n+        Integral over a non full-dimensional polytope::\n+\n+            sage: x, y = polygens(QQ, 'x, y')\n+            sage: P = Polyhedron(vertices=[[0,0],[1,1]])\n+            sage: P.integrate(x*y)    # optional - latte_int\n+            0\n+            sage: P.integrate(x*y, measure='induced')    # optional - latte_int  # not tested (see :trac:`27364`)\n+```\n+\n``````\n",
    "created_at": "2019-02-26T14:20:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423253",
    "user": "https://github.com/dkrenn"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,3 +22,16 @@
 sage: sage: R = PolynomialRing(QQ, 't', 2); t = R.gen()
 ....: sage: (t/2) * vector([1,2])
 ```
+
+This issue was raised by the following doctest in sage.geometry.polyhedron.base, method `integrate`, ticket #27365:
+
+```
+        Integral over a non full-dimensional polytope::
+
+            sage: x, y = polygens(QQ, 'x, y')
+            sage: P = Polyhedron(vertices=[[0,0],[1,1]])
+            sage: P.integrate(x*y)    # optional - latte_int
+            0
+            sage: P.integrate(x*y, measure='induced')    # optional - latte_int  # not tested (see :trac:`27364`)
+```
+
``````




---

archive/issue_comments_423254.json:
```json
{
    "body": "Branch: **[u/dkrenn/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/poly-times-vector)**",
    "created_at": "2019-02-28T12:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423254",
    "user": "https://github.com/dkrenn"
}
```

Branch: **[u/dkrenn/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/poly-times-vector)**



---

archive/issue_events_375875.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-02-28T12:39:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375875"
}
```



---

archive/issue_comments_423255.json:
```json
{
    "body": "Commit: **[`54a350e`](https://github.com/sagemath/sagetrac-mirror/commit/54a350e1f95faa40b3b069bb3c3c3baea0e93a8b)**",
    "created_at": "2019-02-28T12:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423255",
    "user": "https://github.com/dkrenn"
}
```

Commit: **[`54a350e`](https://github.com/sagemath/sagetrac-mirror/commit/54a350e1f95faa40b3b069bb3c3c3baea0e93a8b)**



---

archive/issue_comments_423256.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nCurrent fix indeed fixes the problem but introduces new problems:\n\n```\nsage: R = PolynomialRing(ZZ, 'x', 500)\nsage: S = PolynomialRing(GF(5), 'x', 200)\nsage: R.gen(0) + S.gen(0)\n```\nThe last line takes a second or so without patch, but ages (I've\ninterrupted after two minutes) with the change above. RunSnakeRun says\nthat most of the time is spent in\n\n```\nmethod '_coerce_' of 'sage.structure.parent_old.Parent'\n```\nThis is also not what we'd like. So what should we do now?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54a350e1f95faa40b3b069bb3c3c3baea0e93a8b\"><code>54a350e</code></a></td><td><code>Trac #27364: MPoly functor always returns MultiPolynomialRing</code></td></tr></table>\n",
    "created_at": "2019-02-28T12:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423256",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:5" align="right">comment:5</div>

Current fix indeed fixes the problem but introduces new problems:

```
sage: R = PolynomialRing(ZZ, 'x', 500)
sage: S = PolynomialRing(GF(5), 'x', 200)
sage: R.gen(0) + S.gen(0)
```
The last line takes a second or so without patch, but ages (I've
interrupted after two minutes) with the change above. RunSnakeRun says
that most of the time is spent in

```
method '_coerce_' of 'sage.structure.parent_old.Parent'
```
This is also not what we'd like. So what should we do now?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54a350e1f95faa40b3b069bb3c3c3baea0e93a8b"><code>54a350e</code></a></td><td><code>Trac #27364: MPoly functor always returns MultiPolynomialRing</code></td></tr></table>




---

archive/issue_comments_423257.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423257",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_375876.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375876"
}
```



---

archive/issue_events_375877.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375877"
}
```



---

archive/issue_comments_423258.json:
```json
{
    "body": "Changed commit from **[`54a350e`](https://github.com/sagemath/sagetrac-mirror/commit/54a350e1f95faa40b3b069bb3c3c3baea0e93a8b)** to **[`0249494`](https://github.com/sagemath/sagetrac-mirror/commit/02494942c70b6d26032d4eade470d2ebe475ff7a)**",
    "created_at": "2019-03-28T13:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423258",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`54a350e`](https://github.com/sagemath/sagetrac-mirror/commit/54a350e1f95faa40b3b069bb3c3c3baea0e93a8b)** to **[`0249494`](https://github.com/sagemath/sagetrac-mirror/commit/02494942c70b6d26032d4eade470d2ebe475ff7a)**



---

archive/issue_comments_423259.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2661f6520cd717605318dc8ecd3c225fa61ea8d1\"><code>2661f65</code></a></td><td><code>Trac #27364: speedup multivariate polynomial construction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02494942c70b6d26032d4eade470d2ebe475ff7a\"><code>0249494</code></a></td><td><code>Trac #27364: change doctest (due to timing)</code></td></tr></table>\n",
    "created_at": "2019-03-28T13:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423259",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2661f6520cd717605318dc8ecd3c225fa61ea8d1"><code>2661f65</code></a></td><td><code>Trac #27364: speedup multivariate polynomial construction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02494942c70b6d26032d4eade470d2ebe475ff7a"><code>0249494</code></a></td><td><code>Trac #27364: change doctest (due to timing)</code></td></tr></table>




---

archive/issue_comments_423260.json:
```json
{
    "body": "Author: **Daniel Krenn**",
    "created_at": "2019-03-28T13:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423260",
    "user": "https://github.com/dkrenn"
}
```

Author: **Daniel Krenn**



---

archive/issue_events_375878.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-03-28T13:58:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375878"
}
```



---

archive/issue_events_375879.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2019-03-28T13:58:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375879"
}
```



---

archive/issue_comments_423261.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@dkrenn](#comment:5):\n> RunSnakeRun says\n> that most of the time is spent in\n> \n> ```\n> method '_coerce_' of 'sage.structure.parent_old.Parent'\n> ```\n> This is also not what we'd like. So what should we do now?\n\nThe current branch patches `__call__` so that `_coerce_` is not called that often. #25558 might change everything, but this seems somehow more out of reach.",
    "created_at": "2019-03-28T13:59:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423261",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@dkrenn](#comment:5):
> RunSnakeRun says
> that most of the time is spent in
> 
> ```
> method '_coerce_' of 'sage.structure.parent_old.Parent'
> ```
> This is also not what we'd like. So what should we do now?

The current branch patches `__call__` so that `_coerce_` is not called that often. #25558 might change everything, but this seems somehow more out of reach.



---

archive/issue_comments_423262.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n\n```\n+            #from sage.structure.element import parent\n+            #print(self, '__call__')\n+            #print('    ', x, parent(x))\n```",
    "created_at": "2019-04-18T20:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423262",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>


```
+            #from sage.structure.element import parent
+            #print(self, '__call__')
+            #print('    ', x, parent(x))
```



---

archive/issue_comments_423263.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAs far as I understand, zero and one are already cached from `sage/rings/rings.py`\n\n```\nsage: R = QQ['x','y']\nsage: R.zero() is R.zero()\nTrue\nsage: R.one() is R.one()\nTrue\n```",
    "created_at": "2019-04-18T20:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423263",
    "user": "https://github.com/videlec"
}
```

<div id="comment:11" align="right">comment:11</div>

As far as I understand, zero and one are already cached from `sage/rings/rings.py`

```
sage: R = QQ['x','y']
sage: R.zero() is R.zero()
True
sage: R.one() is R.one()
True
```



---

archive/issue_events_375880.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-04-18T20:25:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375880"
}
```



---

archive/issue_events_375881.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-04-18T20:25:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375881"
}
```



---

archive/issue_events_375882.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375882"
}
```



---

archive/issue_events_375883.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375883"
}
```



---

archive/issue_comments_423264.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nTickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423264",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">comment:13</div>

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_comments_423265.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423265",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Ticket retargeted after milestone closed



---

archive/issue_events_375884.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375884"
}
```



---

archive/issue_events_375885.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375885"
}
```



---

archive/issue_events_375886.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375886"
}
```



---

archive/issue_events_375887.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375887"
}
```



---

archive/issue_comments_423266.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423266",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_423267.json:
```json
{
    "body": "Dependencies: **#25558**",
    "created_at": "2020-08-27T04:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423267",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#25558**



---

archive/issue_events_375888.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-27T04:44:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375888"
}
```



---

archive/issue_events_375889.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-27T04:44:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375889"
}
```



---

archive/issue_events_375890.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375890"
}
```



---

archive/issue_events_375891.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375891"
}
```



---

archive/issue_comments_423268.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423268",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_423269.json:
```json
{
    "body": "Changed branch from **[u/dkrenn/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/poly-times-vector)** to **[u/mkoeppe/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/poly-times-vector)**",
    "created_at": "2021-04-13T17:25:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423269",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/dkrenn/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/poly-times-vector)** to **[u/mkoeppe/poly-times-vector](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/poly-times-vector)**



---

archive/issue_comments_423270.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nClean merge with current develop\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec7977bf22d30aea6531d0d32ba01661a16f9f29\"><code>ec7977b</code></a></td><td><code>Merge tag '9.3.rc3' into t/27364/poly-times-vector</code></td></tr></table>\n",
    "created_at": "2021-04-13T17:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423270",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Clean merge with current develop

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec7977bf22d30aea6531d0d32ba01661a16f9f29"><code>ec7977b</code></a></td><td><code>Merge tag '9.3.rc3' into t/27364/poly-times-vector</code></td></tr></table>




---

archive/issue_comments_423271.json:
```json
{
    "body": "Changed commit from **[`0249494`](https://github.com/sagemath/sagetrac-mirror/commit/02494942c70b6d26032d4eade470d2ebe475ff7a)** to **[`ec7977b`](https://github.com/sagemath/sagetrac-mirror/commit/ec7977bf22d30aea6531d0d32ba01661a16f9f29)**",
    "created_at": "2021-04-13T17:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423271",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`0249494`](https://github.com/sagemath/sagetrac-mirror/commit/02494942c70b6d26032d4eade470d2ebe475ff7a)** to **[`ec7977b`](https://github.com/sagemath/sagetrac-mirror/commit/ec7977bf22d30aea6531d0d32ba01661a16f9f29)**



---

archive/issue_comments_423272.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5fd62d63024e6fecb1f6836a52ff894e8de7a92\"><code>a5fd62d</code></a></td><td><code>src/sage/rings/polynomial/multi_polynomial_ring.py: Remove commented-out code</code></td></tr></table>\n",
    "created_at": "2021-04-13T17:29:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423272",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5fd62d63024e6fecb1f6836a52ff894e8de7a92"><code>a5fd62d</code></a></td><td><code>src/sage/rings/polynomial/multi_polynomial_ring.py: Remove commented-out code</code></td></tr></table>




---

archive/issue_comments_423273.json:
```json
{
    "body": "Changed commit from **[`ec7977b`](https://github.com/sagemath/sagetrac-mirror/commit/ec7977bf22d30aea6531d0d32ba01661a16f9f29)** to **[`a5fd62d`](https://github.com/sagemath/sagetrac-mirror/commit/a5fd62d63024e6fecb1f6836a52ff894e8de7a92)**",
    "created_at": "2021-04-13T17:29:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423273",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ec7977b`](https://github.com/sagemath/sagetrac-mirror/commit/ec7977bf22d30aea6531d0d32ba01661a16f9f29)** to **[`a5fd62d`](https://github.com/sagemath/sagetrac-mirror/commit/a5fd62d63024e6fecb1f6836a52ff894e8de7a92)**



---

archive/issue_events_375892.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-13T18:01:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375892"
}
```



---

archive/issue_events_375893.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-13T18:01:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375893"
}
```



---

archive/issue_comments_423274.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@videlec](#comment:11):\n> As far as I understand, zero and one are already cached from `sage/rings/rings.py`\n> \n> ```\n> sage: R = QQ['x','y']\n> sage: R.zero() is R.zero()\n> True\n> sage: R.one() is R.one()\n> True\n> ```\n\nNevertheless, this code for caching 0 and 1 does make things a bit faster.\nOn my machine, `%time R.gen(0) + S.gen(0)` gives 9.6 s, but taking out the caching it's 12.6 s.",
    "created_at": "2021-04-13T18:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423274",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@videlec](#comment:11):
> As far as I understand, zero and one are already cached from `sage/rings/rings.py`
> 
> ```
> sage: R = QQ['x','y']
> sage: R.zero() is R.zero()
> True
> sage: R.one() is R.one()
> True
> ```

Nevertheless, this code for caching 0 and 1 does make things a bit faster.
On my machine, `%time R.gen(0) + S.gen(0)` gives 9.6 s, but taking out the caching it's 12.6 s.



---

archive/issue_comments_423275.json:
```json
{
    "body": "Changed dependencies from **#25558** to none",
    "created_at": "2021-04-13T18:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423275",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#25558** to none



---

archive/issue_comments_423276.json:
```json
{
    "body": "Reviewer: **Matthias Koeppe, ...**",
    "created_at": "2021-04-13T18:36:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423276",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Matthias Koeppe, ...**



---

archive/issue_events_375894.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-15T07:41:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375894"
}
```



---

archive/issue_events_375895.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-15T07:41:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375895"
}
```



---

archive/issue_comments_423277.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThere are several doctest failures. Among them we see that the pushout **wrongly** changes some `Univariate` to `Multivariate`.\n\n```\nFile \"src/sage/categories/pushout.py\", line 3772, in sage.categories.pushout.pushout\nFailed example:\n    pushout(ZZ['x,y,z'], Frac(ZZ['x'])['y'])\nExpected:\n    Multivariate Polynomial Ring in y, z over Fraction Field of Univariate Polynomial Ring in x over Integer Ring\nGot:\n    Multivariate Polynomial Ring in y, z over Fraction Field of Multivariate Polynomial Ring in x over Integer Ring\n```\nAbove the action of `ZZ[x,y,z]` on `ZZ(x)[y]` is `ZZ(x)[y,z]` in both situations. However, I think that the `ZZ(x)` **must not** change. It would be good to test this pushout with `ZZ(x)` in different forms\n- univariate `PolynomialRing(ZZ, 'x')`\n- univariate NTL `PolynomialRing(ZZ, 'x', implementation='NTL')`\n- multivariate `PolynomialRing(ZZ, ['x'], 1))`.\n\nIn this second example it is unclear what is best.\n\n```\nFile \"src/sage/categories/pushout.py\", line 3778, in sage.categories.pushout.pushout\nFailed example:\n    pushout(QQ['x,y'], ZZ[['x']])\nExpected:\n    Univariate Polynomial Ring in y over Power Series Ring in x over Rational Field\nGot:\n    Multivariate Polynomial Ring in y over Power Series Ring in x over Rational Field\n```\nThe action of `QQ[x,y]` on `ZZ[This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)` does correctly produce `QQ[y][This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)` in both situations. Since `QQ[x,y] -> QQ[y]` drops a variable it is unclear to me if there is a best answer.",
    "created_at": "2021-04-15T07:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423277",
    "user": "https://github.com/videlec"
}
```

<div id="comment:25" align="right">comment:25</div>

There are several doctest failures. Among them we see that the pushout **wrongly** changes some `Univariate` to `Multivariate`.

```
File "src/sage/categories/pushout.py", line 3772, in sage.categories.pushout.pushout
Failed example:
    pushout(ZZ['x,y,z'], Frac(ZZ['x'])['y'])
Expected:
    Multivariate Polynomial Ring in y, z over Fraction Field of Univariate Polynomial Ring in x over Integer Ring
Got:
    Multivariate Polynomial Ring in y, z over Fraction Field of Multivariate Polynomial Ring in x over Integer Ring
```
Above the action of `ZZ[x,y,z]` on `ZZ(x)[y]` is `ZZ(x)[y,z]` in both situations. However, I think that the `ZZ(x)` **must not** change. It would be good to test this pushout with `ZZ(x)` in different forms
- univariate `PolynomialRing(ZZ, 'x')`
- univariate NTL `PolynomialRing(ZZ, 'x', implementation='NTL')`
- multivariate `PolynomialRing(ZZ, ['x'], 1))`.

In this second example it is unclear what is best.

```
File "src/sage/categories/pushout.py", line 3778, in sage.categories.pushout.pushout
Failed example:
    pushout(QQ['x,y'], ZZ[['x']])
Expected:
    Univariate Polynomial Ring in y over Power Series Ring in x over Rational Field
Got:
    Multivariate Polynomial Ring in y over Power Series Ring in x over Rational Field
```
The action of `QQ[x,y]` on `ZZ[This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)` does correctly produce `QQ[y][This is the Trac macro *x* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#x-macro)` in both situations. Since `QQ[x,y] -> QQ[y]` drops a variable it is unclear to me if there is a best answer.



---

archive/issue_comments_423278.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nRelated: it is desirable that the string representation of multivariate polynomial rings make visible the implementation. Currently we have\n\n```\nsage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='generic')\nMultivariate Polynomial Ring in x, y over Integer Ring\nsage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='singular')\nMultivariate Polynomial Ring in x, y over Integer Ring\n```\nBut it would be better as\n\n```\nsage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='generic')\nMultivariate Polynomial Ring in x, y over Integer Ring (using generic implementation)\nsage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='singular')\nMultivariate Polynomial Ring in x, y over Integer Ring\n```\nIdeally (as for univariate polynomials and matrices) the default implementation would show nothing.",
    "created_at": "2021-04-15T07:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423278",
    "user": "https://github.com/videlec"
}
```

<div id="comment:26" align="right">comment:26</div>

Related: it is desirable that the string representation of multivariate polynomial rings make visible the implementation. Currently we have

```
sage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='generic')
Multivariate Polynomial Ring in x, y over Integer Ring
sage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='singular')
Multivariate Polynomial Ring in x, y over Integer Ring
```
But it would be better as

```
sage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='generic')
Multivariate Polynomial Ring in x, y over Integer Ring (using generic implementation)
sage: PolynomialRing(ZZ, ['x', 'y'], 2, implementation='singular')
Multivariate Polynomial Ring in x, y over Integer Ring
```
Ideally (as for univariate polynomials and matrices) the default implementation would show nothing.



---

archive/issue_comments_423279.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThe construction functor should take into account the implementation. Please fix and add the doctest\n\n```\nsage: TT = PolynomialRing(QQ, 't', 2, implementation='generic')\nsage: F, R = TT.construction()\nsage: F(R) is TT  # bug: returns False\nTrue\n```",
    "created_at": "2021-04-15T07:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423279",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">comment:27</div>

The construction functor should take into account the implementation. Please fix and add the doctest

```
sage: TT = PolynomialRing(QQ, 't', 2, implementation='generic')
sage: F, R = TT.construction()
sage: F(R) is TT  # bug: returns False
True
```



---

archive/issue_comments_423280.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThe construction is similarly broken on univariate polynomials\n\n```\nsage: T = PolynomialRing(ZZ, 'x')\nsage: F, R = T.construction()\nsage: F(R) is T\nTrue\nsage: T = PolynomialRing(ZZ, 'x', implementation='NTL')\nsage: F, R = T.construction()\nsage: F(R) is T  # bug: returns False\nTrue\n```",
    "created_at": "2021-04-15T07:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423280",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

The construction is similarly broken on univariate polynomials

```
sage: T = PolynomialRing(ZZ, 'x')
sage: F, R = T.construction()
sage: F(R) is T
True
sage: T = PolynomialRing(ZZ, 'x', implementation='NTL')
sage: F, R = T.construction()
sage: F(R) is T  # bug: returns False
True
```



---

archive/issue_comments_423281.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n#31668 is adding lots of these tests via the `_test_construction` method.",
    "created_at": "2021-04-15T15:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423281",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

#31668 is adding lots of these tests via the `_test_construction` method.



---

archive/issue_comments_423282.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@mkoeppe](#comment:29):\n> #31668 is adding lots of these tests via the `_test_construction` method.\n\nnice!",
    "created_at": "2021-04-15T15:32:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423282",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@mkoeppe](#comment:29):
> #31668 is adding lots of these tests via the `_test_construction` method.

nice!



---

archive/issue_events_375896.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375896"
}
```



---

archive/issue_events_375897.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375897"
}
```



---

archive/issue_comments_423283.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27364#issuecomment-423283",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_375898.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375898"
}
```



---

archive/issue_events_375899.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375899"
}
```



---

archive/issue_events_375900.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375900"
}
```



---

archive/issue_events_375901.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375901"
}
```



---

archive/issue_events_375902.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375902"
}
```



---

archive/issue_events_375903.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27364",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27364#event-375903"
}
```
