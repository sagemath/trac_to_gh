# Issue 27171: Move file src/bin/sage-maxima.lisp, used by sage at import time, to live inside the package

archive/issues_026934.json:
```json
{
    "body": "Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48\n\nCC:  @kiwifb @timokau @jhpalmieri @fchapoton\n\nBranch/Commit: da05b3c2df4f2c98cef3ba392187505abd763dd4\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Matthias Koeppe\n\nDependencies: #21559\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27171\n\n",
    "closed_at": "2020-07-10T19:34:10Z",
    "created_at": "2019-01-29T18:15:11Z",
    "labels": [
        "component: refactoring",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Move file src/bin/sage-maxima.lisp, used by sage at import time, to live inside the package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27171",
    "user": "https://github.com/embray"
}
```
Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48

CC:  @kiwifb @timokau @jhpalmieri @fchapoton

Branch/Commit: da05b3c2df4f2c98cef3ba392187505abd763dd4

Reviewer: Fran√ßois Bissey

Author: Matthias Koeppe

Dependencies: #21559

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27171





---

archive/issue_comments_524448.json:
```json
{
    "body": "<a id='comment:3'></a>\n(edit: never mind)",
    "created_at": "2019-01-29T19:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524448",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
(edit: never mind)



---

archive/issue_comments_524449.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [ticket:27040#comment:48 embray]:\n> If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)\n\n\nWhy *should* it be installed like that?\n\nI'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).",
    "created_at": "2019-01-30T09:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524449",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Replying to [ticket:27040#comment:48 embray]:
> If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)


Why *should* it be installed like that?

I'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).



---

archive/issue_comments_524450.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-See e.g. Non-binary files that are part of the sage sources and needed by the sage package at import time should live in the package.  See e.g. #27040#comment:48\n+Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48\n``````\n",
    "created_at": "2019-01-30T09:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524450",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-See e.g. Non-binary files that are part of the sage sources and needed by the sage package at import time should live in the package.  See e.g. #27040#comment:48
+Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48
``````




---

archive/issue_comments_524451.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [jdemeyer](#comment%3A4):\n> Replying to [ticket:27040#comment:48 embray]:\n> > If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)\n\n> \n> Why *should* it be installed like that?\n> \n> I'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).\n\n\nThat's definitely not what I'm saying, though I can see where you get the implication.\n\nThis is definitely not a rule in case of files that are not part of Sage, which may come from other packages or be overridden in some way by downstream packagers or by users.  In those cases we want an option, with some reasonable default, for where to find that file.\n\nIn this case, if I understand correctly, it's just Maxima startup code very specific to Sage's Maxima interface.  So there's no reason for it to live anywhere else outside the sage package, and that also makes the question of \"where to find it\" much simpler, because it's just relative to the package's installation path.  And it *certainly* doesn't belong in any `bin/`.\n\nDid the same with `sage.gaprc` in `sage.libs.gap`.",
    "created_at": "2019-01-31T13:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524451",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>
Replying to [jdemeyer](#comment%3A4):
> Replying to [ticket:27040#comment:48 embray]:
> > If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)

> 
> Why *should* it be installed like that?
> 
> I'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).


That's definitely not what I'm saying, though I can see where you get the implication.

This is definitely not a rule in case of files that are not part of Sage, which may come from other packages or be overridden in some way by downstream packagers or by users.  In those cases we want an option, with some reasonable default, for where to find that file.

In this case, if I understand correctly, it's just Maxima startup code very specific to Sage's Maxima interface.  So there's no reason for it to live anywhere else outside the sage package, and that also makes the question of "where to find it" much simpler, because it's just relative to the package's installation path.  And it *certainly* doesn't belong in any `bin/`.

Did the same with `sage.gaprc` in `sage.libs.gap`.



---

archive/issue_events_076545.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:44:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-76545"
}
```



---

archive/issue_comments_524452.json:
```json
{
    "body": "<a id='comment:7'></a>\nRemoving most of the rest of my open tickets out of the 8.7 milestone, which should be closed.",
    "created_at": "2019-03-25T10:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524452",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
Removing most of the rest of my open tickets out of the 8.7 milestone, which should be closed.



---

archive/issue_events_076546.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "rename": {
        "from": "Move files used by sage at import time to live inside the package",
        "to": "Move file src/bin/sage-maxima.lisp, used by sage at import time, to live inside the package"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-76546"
}
```



---

archive/issue_events_076547.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T19:13:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-76547"
}
```



---

archive/issue_events_076548.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T19:13:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-76548"
}
```



---

archive/issue_comments_524453.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#21559\"",
    "created_at": "2020-07-04T05:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524453",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#21559"



---

archive/issue_comments_524454.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-07-04T05:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524454",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_524455.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/move_file_src_bin_sage_maxima_lisp__used_by_sage_at_import_time__to_live_inside_the_package\"",
    "created_at": "2020-07-04T06:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524455",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/move_file_src_bin_sage_maxima_lisp__used_by_sage_at_import_time__to_live_inside_the_package"



---

archive/issue_comments_524456.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-04T06:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524456",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_524457.json:
```json
{
    "body": "<a id='comment:12'></a>\n1 commit on top of #21559.\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[4a3d36e](https://github.com/sagemath/sagetrac-mirror/commit/4a3d36eb78976d31d9d27623712b2af7b6b74006)|`Move 'sage -app' back to src/bin/sage`|\n|[3a0193c](https://github.com/sagemath/sagetrac-mirror/commit/3a0193c9f0a12407ac3708fea6d70c9b72d4f864)|`src/bin/sage: Remove handling of 'sage -axiom'`|\n|[6b04075](https://github.com/sagemath/sagetrac-mirror/commit/6b04075aca84249a2418a365f31ea4a0978461a8)|`Merge branch 't/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution' into t/21559/change-src-bin-installation`|\n|[9c7116b](https://github.com/sagemath/sagetrac-mirror/commit/9c7116b5cb5bb36cfa4834719d7cd4220fae0d91)|`src/bin/sage-list-optional, sage-list-experimental, sage-list-standard: Remove deprecated scripts`|\n|[831cc09](https://github.com/sagemath/sagetrac-mirror/commit/831cc09d32828144a27f7bc8c8b2f70150ed0047)|`Merge branch 't/29920/remove_deprecated_scripts_sage_list_optional__sage_list_experimental__sage_list_standard' into t/21559/change-src-bin-installation`|\n|[a56dc35](https://github.com/sagemath/sagetrac-mirror/commit/a56dc35031486df9378f17c2d2ae6405946fac25)|`Merge tag '9.2.beta1' into t/29702/public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup`|\n|[e3eca85](https://github.com/sagemath/sagetrac-mirror/commit/e3eca857db71b602cf2c7c16755ab2cdeaca1773)|`Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/21559/change-src-bin-installation`|\n|[7d29141](https://github.com/sagemath/sagetrac-mirror/commit/7d29141662fe9ffd80c61e8867153244004d0a37)|`src/setup.py: Do not install removed script sage-rsyncdist`|\n|[39cb52a](https://github.com/sagemath/sagetrac-mirror/commit/39cb52aaf9c9bdbc83e053a8ac8854093e07e244)|`Merge branch 't/21559/change-src-bin-installation' into t/27171/move_file_src_bin_sage_maxima_lisp__used_by_sage_at_import_time__to_live_inside_the_package`|\n|[da05b3c](https://github.com/sagemath/sagetrac-mirror/commit/da05b3c2df4f2c98cef3ba392187505abd763dd4)|`src/bin/sage-maxima.lisp: Move inside package, install as package_data`|",
    "created_at": "2020-07-04T06:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524457",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
1 commit on top of #21559.

---
Last 10 new commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[4a3d36e](https://github.com/sagemath/sagetrac-mirror/commit/4a3d36eb78976d31d9d27623712b2af7b6b74006)|`Move 'sage -app' back to src/bin/sage`|
|[3a0193c](https://github.com/sagemath/sagetrac-mirror/commit/3a0193c9f0a12407ac3708fea6d70c9b72d4f864)|`src/bin/sage: Remove handling of 'sage -axiom'`|
|[6b04075](https://github.com/sagemath/sagetrac-mirror/commit/6b04075aca84249a2418a365f31ea4a0978461a8)|`Merge branch 't/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution' into t/21559/change-src-bin-installation`|
|[9c7116b](https://github.com/sagemath/sagetrac-mirror/commit/9c7116b5cb5bb36cfa4834719d7cd4220fae0d91)|`src/bin/sage-list-optional, sage-list-experimental, sage-list-standard: Remove deprecated scripts`|
|[831cc09](https://github.com/sagemath/sagetrac-mirror/commit/831cc09d32828144a27f7bc8c8b2f70150ed0047)|`Merge branch 't/29920/remove_deprecated_scripts_sage_list_optional__sage_list_experimental__sage_list_standard' into t/21559/change-src-bin-installation`|
|[a56dc35](https://github.com/sagemath/sagetrac-mirror/commit/a56dc35031486df9378f17c2d2ae6405946fac25)|`Merge tag '9.2.beta1' into t/29702/public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup`|
|[e3eca85](https://github.com/sagemath/sagetrac-mirror/commit/e3eca857db71b602cf2c7c16755ab2cdeaca1773)|`Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/21559/change-src-bin-installation`|
|[7d29141](https://github.com/sagemath/sagetrac-mirror/commit/7d29141662fe9ffd80c61e8867153244004d0a37)|`src/setup.py: Do not install removed script sage-rsyncdist`|
|[39cb52a](https://github.com/sagemath/sagetrac-mirror/commit/39cb52aaf9c9bdbc83e053a8ac8854093e07e244)|`Merge branch 't/21559/change-src-bin-installation' into t/27171/move_file_src_bin_sage_maxima_lisp__used_by_sage_at_import_time__to_live_inside_the_package`|
|[da05b3c](https://github.com/sagemath/sagetrac-mirror/commit/da05b3c2df4f2c98cef3ba392187505abd763dd4)|`src/bin/sage-maxima.lisp: Move inside package, install as package_data`|



---

archive/issue_comments_524458.json:
```json
{
    "body": "Changing commit from \"\" to \"da05b3c2df4f2c98cef3ba392187505abd763dd4\"",
    "created_at": "2020-07-04T06:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524458",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "da05b3c2df4f2c98cef3ba392187505abd763dd4"



---

archive/issue_comments_524459.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-04T06:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524459",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_524460.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2020-07-04T06:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524460",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "Fran√ßois Bissey"



---

archive/issue_comments_524461.json:
```json
{
    "body": "<a id='comment:13'></a>\nThis is sorely needed. I follows the model of other packages for which it was already done. I want this in. LGTM.",
    "created_at": "2020-07-04T06:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524461",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>
This is sorely needed. I follows the model of other packages for which it was already done. I want this in. LGTM.



---

archive/issue_comments_524462.json:
```json
{
    "body": "<a id='comment:14'></a>\nThanks!",
    "created_at": "2020-07-04T20:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524462",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Thanks!



---

archive/issue_comments_524463.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/move_file_src_bin_sage_maxima_lisp__used_by_sage_at_import_time__to_live_inside_the_package\" to \"da05b3c2df4f2c98cef3ba392187505abd763dd4\"",
    "created_at": "2020-07-10T19:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524463",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/move_file_src_bin_sage_maxima_lisp__used_by_sage_at_import_time__to_live_inside_the_package" to "da05b3c2df4f2c98cef3ba392187505abd763dd4"



---

archive/issue_events_076549.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-10T19:34:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-76549"
}
```



---

archive/issue_comments_524464.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-10T19:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-524464",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
