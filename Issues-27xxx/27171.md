# Issue 27171: Move file src/bin/sage-maxima.lisp, used by sage at import time, to live inside the package

archive/issues_026934.json:
```json
{
    "body": "Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48\n\nCC:  @kiwifb @timokau @jhpalmieri @fchapoton\n\nBranch/Commit: da05b3c2df4f2c98cef3ba392187505abd763dd4\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Matthias Koeppe\n\nDependencies: #21559\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/27171\n\n",
    "closed_at": "2020-07-10T19:34:10Z",
    "created_at": "2019-01-29T18:15:11Z",
    "labels": [
        "component: refactoring",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Move file src/bin/sage-maxima.lisp, used by sage at import time, to live inside the package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27171",
    "user": "https://github.com/embray"
}
```
Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48

CC:  @kiwifb @timokau @jhpalmieri @fchapoton

Branch/Commit: da05b3c2df4f2c98cef3ba392187505abd763dd4

Reviewer: Fran√ßois Bissey

Author: Matthias Koeppe

Dependencies: #21559

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/27171





---

archive/issue_comments_403550.json:
```json
{
    "body": "<a id='comment:3'></a>(edit: never mind)",
    "created_at": "2019-01-29T19:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403550",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>(edit: never mind)



---

archive/issue_comments_403551.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [ticket:27040#comment:48 embray]:\n> If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)\n\n\nWhy *should* it be installed like that?\n\nI'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).",
    "created_at": "2019-01-30T09:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403551",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Replying to [ticket:27040#comment:48 embray]:
> If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)


Why *should* it be installed like that?

I'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).



---

archive/issue_comments_403552.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-See e.g. Non-binary files that are part of the sage sources and needed by the sage package at import time should live in the package.  See e.g. #27040#comment:48\n+Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48\n \n Comment: 1\n \n```\n",
    "created_at": "2019-01-30T09:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403552",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-See e.g. Non-binary files that are part of the sage sources and needed by the sage package at import time should live in the package.  See e.g. #27040#comment:48
+Non-binary files that are part of the sage sources and needed by the sage package at import time should be installed in the package, using `package_data` in `setup.py`.  See e.g. #27040#comment:48
 
 Comment: 1
 
```




---

archive/issue_comments_403553.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:4 jdemeyer]:\n> Replying to [ticket:27040#comment:48 embray]:\n> > If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)\n\n> \n> Why *should* it be installed like that?\n> \n> I'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).\n\n\nThat's definitely not what I'm saying, though I can see where you get the implication.\n\nThis is definitely not a rule in case of files that are not part of Sage, which may come from other packages or be overridden in some way by downstream packagers or by users.  In those cases we want an option, with some reasonable default, for where to find that file.\n\nIn this case, if I understand correctly, it's just Maxima startup code very specific to Sage's Maxima interface.  So there's no reason for it to live anywhere else outside the sage package, and that also makes the question of \"where to find it\" much simpler, because it's just relative to the package's installation path.  And it *certainly* doesn't belong in any `bin/`.\n\nDid the same with `sage.gaprc` in `sage.libs.gap`.",
    "created_at": "2019-01-31T13:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403553",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>Replying to [comment:4 jdemeyer]:
> Replying to [ticket:27040#comment:48 embray]:
> > If it's needed by the sage Python package to work then it should just be installed inside the package (e.g. as `package_data` in `setup.py`)

> 
> Why *should* it be installed like that?
> 
> I'm not against moving the specific file `sage-maxima.lisp`, but you seem to imply a more general rule here that Python packages should never access files outside of their own package (or something like that?).


That's definitely not what I'm saying, though I can see where you get the implication.

This is definitely not a rule in case of files that are not part of Sage, which may come from other packages or be overridden in some way by downstream packagers or by users.  In those cases we want an option, with some reasonable default, for where to find that file.

In this case, if I understand correctly, it's just Maxima startup code very specific to Sage's Maxima interface.  So there's no reason for it to live anywhere else outside the sage package, and that also makes the question of "where to find it" much simpler, because it's just relative to the package's installation path.  And it *certainly* doesn't belong in any `bin/`.

Did the same with `sage.gaprc` in `sage.libs.gap`.



---

archive/issue_events_067469.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:44:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-67469"
}
```



---

archive/issue_comments_403554.json:
```json
{
    "body": "<a id='comment:7'></a>Removing most of the rest of my open tickets out of the 8.7 milestone, which should be closed.",
    "created_at": "2019-03-25T10:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403554",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>Removing most of the rest of my open tickets out of the 8.7 milestone, which should be closed.



---

archive/issue_events_067470.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T19:13:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-67470"
}
```



---

archive/issue_events_067471.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T19:13:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-67471"
}
```



---

archive/issue_comments_403555.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-04T06:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403555",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_403556.json:
```json
{
    "body": "<a id='comment:12'></a>1 commit on top of #21559.\n\n---\nLast 10 new commits:",
    "created_at": "2020-07-04T06:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403556",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>1 commit on top of #21559.

---
Last 10 new commits:



---

archive/issue_comments_403557.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-04T06:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403557",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_403558.json:
```json
{
    "body": "<a id='comment:13'></a>This is sorely needed. I follows the model of other packages for which it was already done. I want this in. LGTM.",
    "created_at": "2020-07-04T06:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403558",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>This is sorely needed. I follows the model of other packages for which it was already done. I want this in. LGTM.



---

archive/issue_comments_403559.json:
```json
{
    "body": "<a id='comment:14'></a>Thanks!",
    "created_at": "2020-07-04T20:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403559",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Thanks!



---

archive/issue_events_067472.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-10T19:34:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27171#event-67472"
}
```



---

archive/issue_comments_403560.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-10T19:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27171",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27171#issuecomment-403560",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
