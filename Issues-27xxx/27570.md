# Issue 27570: Minimal weight cycle basis Implementation

archive/issues_027333.json:
```json
{
    "assignees": [],
    "body": "Minimal weight cycle basis is a cycle basis for which the total weight of all the cycles is minimum.\n\nIts applications are as follows:\n- The minimum weight cycle basis of a nearest neighbor graph of points sampled from a three-dimensional surface can be used to obtain a reconstruction of the surface.\n\n- In cheminformatics, the minimal cycle basis of a molecular graph is referred to as the Smallest Set of Smallest Rings (SSSR).\n\nThis ticket will aim at implementing this algorithm.\n\nAssignee: **@rajat1433**\n\nCC:  @dcoudert\n\nKeywords: **cycle_basis, shortest_paths**\n\nBranch/Commit: **[66fe52d](https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8)**\n\nReviewer: **David Coudert**\n\nAuthor: **Rajat Mittal**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27570_\n\n",
    "closed_at": "2019-04-27T17:44:19Z",
    "created_at": "2019-03-30T13:03:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Minimal weight cycle basis Implementation",
    "type": "issue",
    "updated_at": "2019-04-27T17:44:19Z",
    "url": "https://github.com/sagemath/sage/issues/27570",
    "user": "https://github.com/rajat1433"
}
```
Minimal weight cycle basis is a cycle basis for which the total weight of all the cycles is minimum.

Its applications are as follows:
- The minimum weight cycle basis of a nearest neighbor graph of points sampled from a three-dimensional surface can be used to obtain a reconstruction of the surface.

- In cheminformatics, the minimal cycle basis of a molecular graph is referred to as the Smallest Set of Smallest Rings (SSSR).

This ticket will aim at implementing this algorithm.

Assignee: **@rajat1433**

CC:  @dcoudert

Keywords: **cycle_basis, shortest_paths**

Branch/Commit: **[66fe52d](https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8)**

Reviewer: **David Coudert**

Author: **Rajat Mittal**

_Issue created by migration from https://trac.sagemath.org/ticket/27570_





---

archive/issue_events_347563.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-30T13:03:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347563"
}
```



---

archive/issue_events_347564.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-30T13:03:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "component: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347564"
}
```



---

archive/issue_events_347565.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-03-30T13:03:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347565"
}
```



---

archive/issue_comments_429992.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nminimum weight cycle basis in a graph with m edges and n vertices can be found in polynomial time using https://link.springer.com/article/10.1007/s00453-007-9064-z. \n\nhttps://arxiv.org/pdf/0912.1208.pdf\n\nI am going through these algorithms before implementing it.\n\nThese work for undirected(weighted/non-weighted) graphs without multiedges.",
    "created_at": "2019-03-30T13:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429992",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:1'>Comment 1:</a>
minimum weight cycle basis in a graph with m edges and n vertices can be found in polynomial time using https://link.springer.com/article/10.1007/s00453-007-9064-z. 

https://arxiv.org/pdf/0912.1208.pdf

I am going through these algorithms before implementing it.

These work for undirected(weighted/non-weighted) graphs without multiedges.



---

archive/issue_comments_429993.json:
```json
{
    "body": "Branch: **[u/gh-rajat1433/27570_min_weight_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-rajat1433/27570_min_weight_cycle_basis)**",
    "created_at": "2019-04-05T03:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429993",
    "user": "https://github.com/rajat1433"
}
```

Branch: **[u/gh-rajat1433/27570_min_weight_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-rajat1433/27570_min_weight_cycle_basis)**



---

archive/issue_comments_429994.json:
```json
{
    "body": "Assignee: **@rajat1433**",
    "created_at": "2019-04-05T03:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429994",
    "user": "https://github.com/rajat1433"
}
```

Assignee: **@rajat1433**



---

archive/issue_comments_429995.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nI had a doubt regarding what should we add in examples when getting deprecation warning from external package. like below:\n\n```\nsage: g.minimum_cycle_basis(by_weight=True, algorithm=\"NetworkX\")\n\nDeprecationWarning: connected_component_subgraphs is deprecated and will be removedin 2.2. Use (G.subgraph(c).copy() for c in connected_components(G))\n            [[1, 2, 3, 4], [1, 2, 3], [5, 6, 7]]\n```\n should we skip these examples in examples section?",
    "created_at": "2019-04-07T15:15:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429995",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:3'>Comment 3:</a>
I had a doubt regarding what should we add in examples when getting deprecation warning from external package. like below:

```
sage: g.minimum_cycle_basis(by_weight=True, algorithm="NetworkX")

DeprecationWarning: connected_component_subgraphs is deprecated and will be removedin 2.2. Use (G.subgraph(c).copy() for c in connected_components(G))
            [[1, 2, 3, 4], [1, 2, 3], [5, 6, 7]]
```
 should we skip these examples in examples section?



---

archive/issue_comments_429996.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nSkip this example. This is an upstream issue as we use networkx 2.2.",
    "created_at": "2019-04-07T16:56:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429996",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'>Comment 4:</a>
Skip this example. This is an upstream issue as we use networkx 2.2.



---

archive/issue_comments_429997.json:
```json
{
    "body": "Commit: **[464c00c](https://github.com/sagemath/sagetrac-mirror/commit/464c00c8b9caaba024f8c4587ed6586a0fe0b959)**",
    "created_at": "2019-04-09T14:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429997",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[464c00c](https://github.com/sagemath/sagetrac-mirror/commit/464c00c8b9caaba024f8c4587ed6586a0fe0b959)**



---

archive/issue_comments_429998.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d6c7ddfc29e5e7af009fa2a8b2e4c504d2c0a17\">7d6c7dd</a></td><td><code>code for min_cycle_basis</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a07df04eeb0860b2f78db8d693a3cdf25376ac9\">0a07df0</a></td><td><code>checkpt1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c97070b20d15c6dc43a0711a92e07bc59e9ced51\">c97070b</a></td><td><code>checkpt2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e2a47e5ae3c10096b09e317d168c0808e7c34cb\">9e2a47e</a></td><td><code>checkpt3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c24873a8d20dfe20bb0895384efdd21f6ee6fcf\">8c24873</a></td><td><code>checkpt3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73adfd5ee6fee276f11d49a57551853a0d01734a\">73adfd5</a></td><td><code>code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c5eed094eecdf33ae31a7833484bb0770c933f2\">2c5eed0</a></td><td><code>improved code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f439305eed4a74e0513321dfa94ff51d14b91dd9\">f439305</a></td><td><code>added examaples</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/972624f2642e1c3d50e9a97ef9df8a4cc24a502e\">972624f</a></td><td><code>optimising</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/464c00c8b9caaba024f8c4587ed6586a0fe0b959\">464c00c</a></td><td><code>Merged with 8.8beta1</code></td></tr></table>\n",
    "created_at": "2019-04-09T14:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429998",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d6c7ddfc29e5e7af009fa2a8b2e4c504d2c0a17">7d6c7dd</a></td><td><code>code for min_cycle_basis</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a07df04eeb0860b2f78db8d693a3cdf25376ac9">0a07df0</a></td><td><code>checkpt1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c97070b20d15c6dc43a0711a92e07bc59e9ced51">c97070b</a></td><td><code>checkpt2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e2a47e5ae3c10096b09e317d168c0808e7c34cb">9e2a47e</a></td><td><code>checkpt3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c24873a8d20dfe20bb0895384efdd21f6ee6fcf">8c24873</a></td><td><code>checkpt3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73adfd5ee6fee276f11d49a57551853a0d01734a">73adfd5</a></td><td><code>code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c5eed094eecdf33ae31a7833484bb0770c933f2">2c5eed0</a></td><td><code>improved code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f439305eed4a74e0513321dfa94ff51d14b91dd9">f439305</a></td><td><code>added examaples</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/972624f2642e1c3d50e9a97ef9df8a4cc24a502e">972624f</a></td><td><code>optimising</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/464c00c8b9caaba024f8c4587ed6586a0fe0b959">464c00c</a></td><td><code>Merged with 8.8beta1</code></td></tr></table>




---

archive/issue_comments_429999.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nI have added minimum cycle basis cython implementation and for python implementation used networkx's min_cycle_basis method. The algorithm's complexity is O(m<sup>2</sup>)n and cython implementation is quite faster than NetwrokX's python as I have tested.",
    "created_at": "2019-04-09T14:31:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-429999",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:6'>Comment 6:</a>
I have added minimum cycle basis cython implementation and for python implementation used networkx's min_cycle_basis method. The algorithm's complexity is O(m<sup>2</sup>)n and cython implementation is quite faster than NetwrokX's python as I have tested.



---

archive/issue_comments_430000.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5512e26447bceb185cefe12a22893c6c31c5662c\">5512e26</a></td><td><code>remove xtra spaces</code></td></tr></table>\n",
    "created_at": "2019-04-09T14:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430000",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5512e26447bceb185cefe12a22893c6c31c5662c">5512e26</a></td><td><code>remove xtra spaces</code></td></tr></table>




---

archive/issue_comments_430001.json:
```json
{
    "body": "Changed commit from **[464c00c](https://github.com/sagemath/sagetrac-mirror/commit/464c00c8b9caaba024f8c4587ed6586a0fe0b959)** to **[5512e26](https://github.com/sagemath/sagetrac-mirror/commit/5512e26447bceb185cefe12a22893c6c31c5662c)**",
    "created_at": "2019-04-09T14:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430001",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[464c00c](https://github.com/sagemath/sagetrac-mirror/commit/464c00c8b9caaba024f8c4587ed6586a0fe0b959)** to **[5512e26](https://github.com/sagemath/sagetrac-mirror/commit/5512e26447bceb185cefe12a22893c6c31c5662c)**



---

archive/issue_events_347566.json:
```json
{
    "actor": "https://github.com/rajat1433",
    "created_at": "2019-04-09T18:46:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347566"
}
```



---

archive/issue_comments_430002.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f37b331169586323739a203dfc4427bbaaaadfe9\">f37b331</a></td><td><code>removed unnecessary import</code></td></tr></table>\n",
    "created_at": "2019-04-10T03:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430002",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f37b331169586323739a203dfc4427bbaaaadfe9">f37b331</a></td><td><code>removed unnecessary import</code></td></tr></table>




---

archive/issue_comments_430003.json:
```json
{
    "body": "Changed commit from **[5512e26](https://github.com/sagemath/sagetrac-mirror/commit/5512e26447bceb185cefe12a22893c6c31c5662c)** to **[f37b331](https://github.com/sagemath/sagetrac-mirror/commit/f37b331169586323739a203dfc4427bbaaaadfe9)**",
    "created_at": "2019-04-10T03:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430003",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5512e26](https://github.com/sagemath/sagetrac-mirror/commit/5512e26447bceb185cefe12a22893c6c31c5662c)** to **[f37b331](https://github.com/sagemath/sagetrac-mirror/commit/f37b331169586323739a203dfc4427bbaaaadfe9)**



---

archive/issue_comments_430004.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nA first round of comments. \n\n`min_cycle_basis`:\n- remove input parameter \"algorithm\"\n\n- in many methods, we are using a mapping from integers to vertices. This is simply `cdef list int_to_vertex = list(G)`. The reverse mapping is then `cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}`.\n\n- To simplify and speed up your code, you should either make a copy of `self` in which vertices are relabeled in `0..n-1`, or at least relabel the edges in `edgelist` using integers. The only step were you need the real vertex ids is before returning the result.\n\n- You could work with edges as frozenset directly\n\n- don't import `from sage.graphs.base.boost_graph import johnson_shortest_paths` inside a loop\n\n\n\n`minimum_cycle_basis`:\n- I don't see the need for creating a new method here. You could add parameters to `cycle_basis` to make it return a minimum cycle basis when the user asked for it ?",
    "created_at": "2019-04-10T09:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430004",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:10'>Comment 10:</a>
A first round of comments. 

`min_cycle_basis`:
- remove input parameter "algorithm"

- in many methods, we are using a mapping from integers to vertices. This is simply `cdef list int_to_vertex = list(G)`. The reverse mapping is then `cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}`.

- To simplify and speed up your code, you should either make a copy of `self` in which vertices are relabeled in `0..n-1`, or at least relabel the edges in `edgelist` using integers. The only step were you need the real vertex ids is before returning the result.

- You could work with edges as frozenset directly

- don't import `from sage.graphs.base.boost_graph import johnson_shortest_paths` inside a loop



`minimum_cycle_basis`:
- I don't see the need for creating a new method here. You could add parameters to `cycle_basis` to make it return a minimum cycle basis when the user asked for it ?



---

archive/issue_comments_430005.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@dcoudert](#comment%3A10):\n\n> - in many methods, we are using a mapping from integers to vertices. This is simply `cdef list int_to_vertex = list(G)`. The reverse mapping is then `cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}`.\n\nIt seems SparseGraphBackend object is not iterable so we cant do list(self)\n\n[UPDATE]\nSo I did this\n\n```\n        cdef list int_to_vertex = list(self.iterator_verts(None))\n        cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}\n```\n\n```\n/home/rajat/new_version/sage-8.7.beta6/local/lib/python2.7/site-packages/sage/graphs/base/c_graph.pyx in sage.graphs.base.c_graph.CGraphBackend.min_cycle_basis (build/cythonized/sage/graphs/base/c_graph.cpp:21478)()\n   2457         l = len(edges_complement)\n   2458         cdef list orth_set = [set([e]) for e in edges_complement]\n-> 2459         cdef list int_to_vertex = list(self)\n   2460         cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}\n   2461         if not by_weight:\n\nTypeError: 'sage.graphs.base.sparse_graph.SparseGraphBackend' object is not iterable\n\n```\n\n\n\n\n> - You could work with edges as frozenset directly\n> \n\nCan you elaborate on it? I didn't understand.",
    "created_at": "2019-04-11T04:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430005",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@dcoudert](#comment%3A10):

> - in many methods, we are using a mapping from integers to vertices. This is simply `cdef list int_to_vertex = list(G)`. The reverse mapping is then `cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}`.

It seems SparseGraphBackend object is not iterable so we cant do list(self)

[UPDATE]
So I did this

```
        cdef list int_to_vertex = list(self.iterator_verts(None))
        cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}
```

```
/home/rajat/new_version/sage-8.7.beta6/local/lib/python2.7/site-packages/sage/graphs/base/c_graph.pyx in sage.graphs.base.c_graph.CGraphBackend.min_cycle_basis (build/cythonized/sage/graphs/base/c_graph.cpp:21478)()
   2457         l = len(edges_complement)
   2458         cdef list orth_set = [set([e]) for e in edges_complement]
-> 2459         cdef list int_to_vertex = list(self)
   2460         cdef dict vertex_to_int = {u: i for i, u in enumerate(int_to_vertex)}
   2461         if not by_weight:

TypeError: 'sage.graphs.base.sparse_graph.SparseGraphBackend' object is not iterable

```




> - You could work with edges as frozenset directly
> 

Can you elaborate on it? I didn't understand.



---

archive/issue_comments_430006.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@dcoudert](#comment%3A10):\n\n> \n> - To simplify and speed up your code, you should either make a copy of `self` in which vertices are relabeled in `0..n-1`, or at least relabel the edges in `edgelist` using integers. The only step were you need the real vertex ids is before returning the result.\n\nI think this can be done and will improve dictionary look up time.",
    "created_at": "2019-04-11T05:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430006",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@dcoudert](#comment%3A10):

> 
> - To simplify and speed up your code, you should either make a copy of `self` in which vertices are relabeled in `0..n-1`, or at least relabel the edges in `edgelist` using integers. The only step were you need the real vertex ids is before returning the result.

I think this can be done and will improve dictionary look up time.



---

archive/issue_comments_430007.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nThe parameters of cycle_basis and minimum_cycle_basis are quite different as in cyclebasis we just specify the output as vertices or edges but in min_cycle_basis we have algorithm parameter and weight parameters too. If they are merged it will mess a bit.(just my opinion). But if it seems better than I can do it.",
    "created_at": "2019-04-12T04:40:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430007",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:13'>Comment 13:</a>
The parameters of cycle_basis and minimum_cycle_basis are quite different as in cyclebasis we just specify the output as vertices or edges but in min_cycle_basis we have algorithm parameter and weight parameters too. If they are merged it will mess a bit.(just my opinion). But if it seems better than I can do it.



---

archive/issue_comments_430008.json:
```json
{
    "body": "Changed commit from **[f37b331](https://github.com/sagemath/sagetrac-mirror/commit/f37b331169586323739a203dfc4427bbaaaadfe9)** to **[cc4ba48](https://github.com/sagemath/sagetrac-mirror/commit/cc4ba48619594fd125413296e2d7d1413cc0376d)**",
    "created_at": "2019-04-12T04:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430008",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f37b331](https://github.com/sagemath/sagetrac-mirror/commit/f37b331169586323739a203dfc4427bbaaaadfe9)** to **[cc4ba48](https://github.com/sagemath/sagetrac-mirror/commit/cc4ba48619594fd125413296e2d7d1413cc0376d)**



---

archive/issue_comments_430009.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc4ba48619594fd125413296e2d7d1413cc0376d\">cc4ba48</a></td><td><code>improved the code</code></td></tr></table>\n",
    "created_at": "2019-04-12T04:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430009",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>Comment 14:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc4ba48619594fd125413296e2d7d1413cc0376d">cc4ba48</a></td><td><code>improved the code</code></td></tr></table>




---

archive/issue_comments_430010.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI agree with your arguments.\n\nIn your code, you code document a bit the type of graph you build, and so why you use `n+j` or `n + vidx`.\n\nI'm a bit worried about the following lines because I don't know what you expect\n\n```\n+            new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}\n+            cycle_basis.append(list(set().union(*new_cycle)))\n```\nWith such operation, you loose the order of the vertices, so I don't see how you get a cycle.\n\nI think the following is better, but it is only because I'm not sure how list manipulation is really done for sure instructions.\n\n```diff\n-            orth_set[i + 1:] = [o ^ base if len(o & new_cycle) % 2 else o for o in orth_set[i + 1:]]\n+            for j in range(i + 1, len(orth_set)):\n+                orth_set[j] = o ^ base if len(o & new_cycle) % 2 else o\n```\n\nalso\n\n```diff\n+                edges_c = [frozenset(e) for e in comp.edges(labels=False) if e not in edges_s]\n+                edges_c = [frozenset(e) for e in comp.edge_iterator(labels=False) if e not in edges_s]\n```\n\nWhat if the input graph has loops ? If not accepted, then use `self._scream_if_not_simple()`.",
    "created_at": "2019-04-12T11:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430010",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:15'>Comment 15:</a>
I agree with your arguments.

In your code, you code document a bit the type of graph you build, and so why you use `n+j` or `n + vidx`.

I'm a bit worried about the following lines because I don't know what you expect

```
+            new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}
+            cycle_basis.append(list(set().union(*new_cycle)))
```
With such operation, you loose the order of the vertices, so I don't see how you get a cycle.

I think the following is better, but it is only because I'm not sure how list manipulation is really done for sure instructions.

```diff
-            orth_set[i + 1:] = [o ^ base if len(o & new_cycle) % 2 else o for o in orth_set[i + 1:]]
+            for j in range(i + 1, len(orth_set)):
+                orth_set[j] = o ^ base if len(o & new_cycle) % 2 else o
```

also

```diff
+                edges_c = [frozenset(e) for e in comp.edges(labels=False) if e not in edges_s]
+                edges_c = [frozenset(e) for e in comp.edge_iterator(labels=False) if e not in edges_s]
```

What if the input graph has loops ? If not accepted, then use `self._scream_if_not_simple()`.



---

archive/issue_comments_430011.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nI forgot to tell/add that our algorithm returns only vertices in the cycle not necessarily in the order of cycle. This is a kind of limitation of the algorithm as given in https://link.springer.com/article/10.1007/s00453-007-9064-z. But the time complexity we get is good. I have added the following text now:\n\n```\nA list of cycle lists is returned. Each cycle list is a list of vertices\nwhich forms a cycle in G. Note that the vertices are not necessarily\nreturned in the order by which they appear in the cycle\n```\n\nSo now \n\n```\n+            new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}\n+            cycle_basis.append(list(set().union(*new_cycle)))\n```\nthis should not be our worry :) as the vertices are returned here in sorted order.",
    "created_at": "2019-04-12T14:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430011",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:16'>Comment 16:</a>
I forgot to tell/add that our algorithm returns only vertices in the cycle not necessarily in the order of cycle. This is a kind of limitation of the algorithm as given in https://link.springer.com/article/10.1007/s00453-007-9064-z. But the time complexity we get is good. I have added the following text now:

```
A list of cycle lists is returned. Each cycle list is a list of vertices
which forms a cycle in G. Note that the vertices are not necessarily
returned in the order by which they appear in the cycle
```

So now 

```
+            new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}
+            cycle_basis.append(list(set().union(*new_cycle)))
```
this should not be our worry :) as the vertices are returned here in sorted order.



---

archive/issue_comments_430012.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7038d4283e2a96696e20fc0864f308c2fc7fd7dc\">7038d42</a></td><td><code>improved code and doc</code></td></tr></table>\n",
    "created_at": "2019-04-12T14:32:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430012",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7038d4283e2a96696e20fc0864f308c2fc7fd7dc">7038d42</a></td><td><code>improved code and doc</code></td></tr></table>




---

archive/issue_comments_430013.json:
```json
{
    "body": "Changed commit from **[cc4ba48](https://github.com/sagemath/sagetrac-mirror/commit/cc4ba48619594fd125413296e2d7d1413cc0376d)** to **[7038d42](https://github.com/sagemath/sagetrac-mirror/commit/7038d4283e2a96696e20fc0864f308c2fc7fd7dc)**",
    "created_at": "2019-04-12T14:32:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430013",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cc4ba48](https://github.com/sagemath/sagetrac-mirror/commit/cc4ba48619594fd125413296e2d7d1413cc0376d)** to **[7038d42](https://github.com/sagemath/sagetrac-mirror/commit/7038d4283e2a96696e20fc0864f308c2fc7fd7dc)**



---

archive/issue_comments_430014.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\n**min_cycle_basis**\n\n```diff\n-        A list of cycle lists is returned. Each cycle list is a list of vertices\n-        which forms a cycle in G. Note that the vertices are not necessarily\n-        returned in the order by which they appear in the cycle\n+        A cycle basis is a list of cycles (list of vertices forming a cycle) of\n+        `G`. Note that the vertices are not necessarily returned in the order\n+        in which they appear in the cycle.\n```\n\n```diff\n-        Minimum weight cycle basis is the cycle basis for which the total weight\n-        (length for unweighted graphs) of all the cycles is minimum.\n+        A minimum weight cycle basis is a cycle basis that minimizes the sum of\n+        the weights (length for unweighted graphs) of its cycles.\n```\n\n```diff\n-        - ``edges_complement`` -- list (default: ``None``); a list of edges\n-          present in the ``self`` but not in present in a particular spanning\n-          tree.\n+        - ``edges_complement`` -- list (default: ``None``); list of edges of\n+          ``self`` without the edges of a particular spanning tree.\n```\n\n```diff\n-            # Add 2 copies of each edge in self to T. Cross edge is added if\n-            # edge is in orth otherwise in-plane edge is added\n+            # For each edge in self, add 2 edges to G: \"cross\" edges if\n+            # edge is in orth otherwise \"in-plane\" edges\n```\n\n\nNo need for `list(..)`\n\n```diff\n-            for edge in list(zip(min_path_nodes[:-1], min_path_nodes[1:])):\n+            for edge in zip(min_path_nodes[:-1], min_path_nodes[1:]):\n```\n\nHere an alternative is to use `chain`. You need to add before the loop `from itertools import chain`. I don't know if it's faster...\n\n```diff\n             new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}\n-            cycle_basis.append(list(set().union(*new_cycle)))\n+            cycle_basis.append(list(set(chain(*new_cycle))))\n```\n\n\n**minimum_cycle_basis**\n- same comments than above for improving the text\n- don't use this as plain text `minimum_cycle_basis` in documentation.\n\n```diff\n-          * If ``algorithm = \"NetworkX\"``, a networkx implementation of the\n-            minimum_cycle_basis algorithm is used\n-\n-          * If ``algorithm = None``, then cython implementation of the\n-            minimum_cycle_basis algorithm is used\n+          * If ``algorithm = \"NetworkX\"``, use networkx implementation\n+\n+          * If ``algorithm = None``, use Sage Cython implementation\n```\n- make `edge_s` a set to speed up construction of `edges_c`\n\n```diff\n+                edges_s = [(a, b) for a, b, c in sp_edges]\n+                edges_s = set((a, b) for a, b, c in sp_edges)\n```\n- `compliment` -> `complement`\n- In fact, this is better\n\n```diff\n-                # compliment of the edges of the spanning tree with respect\n-                # to self\n+                # Edges of self that are not in the spanning tree\n```",
    "created_at": "2019-04-14T16:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430014",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:18'>Comment 18:</a>
**min_cycle_basis**

```diff
-        A list of cycle lists is returned. Each cycle list is a list of vertices
-        which forms a cycle in G. Note that the vertices are not necessarily
-        returned in the order by which they appear in the cycle
+        A cycle basis is a list of cycles (list of vertices forming a cycle) of
+        `G`. Note that the vertices are not necessarily returned in the order
+        in which they appear in the cycle.
```

```diff
-        Minimum weight cycle basis is the cycle basis for which the total weight
-        (length for unweighted graphs) of all the cycles is minimum.
+        A minimum weight cycle basis is a cycle basis that minimizes the sum of
+        the weights (length for unweighted graphs) of its cycles.
```

```diff
-        - ``edges_complement`` -- list (default: ``None``); a list of edges
-          present in the ``self`` but not in present in a particular spanning
-          tree.
+        - ``edges_complement`` -- list (default: ``None``); list of edges of
+          ``self`` without the edges of a particular spanning tree.
```

```diff
-            # Add 2 copies of each edge in self to T. Cross edge is added if
-            # edge is in orth otherwise in-plane edge is added
+            # For each edge in self, add 2 edges to G: "cross" edges if
+            # edge is in orth otherwise "in-plane" edges
```


No need for `list(..)`

```diff
-            for edge in list(zip(min_path_nodes[:-1], min_path_nodes[1:])):
+            for edge in zip(min_path_nodes[:-1], min_path_nodes[1:]):
```

Here an alternative is to use `chain`. You need to add before the loop `from itertools import chain`. I don't know if it's faster...

```diff
             new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}
-            cycle_basis.append(list(set().union(*new_cycle)))
+            cycle_basis.append(list(set(chain(*new_cycle))))
```


**minimum_cycle_basis**
- same comments than above for improving the text
- don't use this as plain text `minimum_cycle_basis` in documentation.

```diff
-          * If ``algorithm = "NetworkX"``, a networkx implementation of the
-            minimum_cycle_basis algorithm is used
-
-          * If ``algorithm = None``, then cython implementation of the
-            minimum_cycle_basis algorithm is used
+          * If ``algorithm = "NetworkX"``, use networkx implementation
+
+          * If ``algorithm = None``, use Sage Cython implementation
```
- make `edge_s` a set to speed up construction of `edges_c`

```diff
+                edges_s = [(a, b) for a, b, c in sp_edges]
+                edges_s = set((a, b) for a, b, c in sp_edges)
```
- `compliment` -> `complement`
- In fact, this is better

```diff
-                # compliment of the edges of the spanning tree with respect
-                # to self
+                # Edges of self that are not in the spanning tree
```



---

archive/issue_comments_430015.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/734a300d512e85b60d3acbd2f5702912bb9389c4\">734a300</a></td><td><code>improved</code></td></tr></table>\n",
    "created_at": "2019-04-15T08:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430015",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/734a300d512e85b60d3acbd2f5702912bb9389c4">734a300</a></td><td><code>improved</code></td></tr></table>




---

archive/issue_comments_430016.json:
```json
{
    "body": "Changed commit from **[7038d42](https://github.com/sagemath/sagetrac-mirror/commit/7038d4283e2a96696e20fc0864f308c2fc7fd7dc)** to **[734a300](https://github.com/sagemath/sagetrac-mirror/commit/734a300d512e85b60d3acbd2f5702912bb9389c4)**",
    "created_at": "2019-04-15T08:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430016",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7038d42](https://github.com/sagemath/sagetrac-mirror/commit/7038d4283e2a96696e20fc0864f308c2fc7fd7dc)** to **[734a300](https://github.com/sagemath/sagetrac-mirror/commit/734a300d512e85b60d3acbd2f5702912bb9389c4)**



---

archive/issue_comments_430017.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nI think union and chain works differently and in the present case union seems correct as it collects all the vertices of different edges. chain might result in repetition of vertices.",
    "created_at": "2019-04-15T08:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430017",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:20'>Comment 20:</a>
I think union and chain works differently and in the present case union seems correct as it collects all the vertices of different edges. chain might result in repetition of vertices.



---

archive/issue_comments_430018.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@rajat1433](#comment%3A20):\n> I think union and chain works differently and in the present case union seems correct as it collects all the vertices of different edges. chain might result in repetition of vertices.\n\nno, the behavior is the same here, but as I wrote, I'm not sure it's better here, so let it as is.",
    "created_at": "2019-04-15T09:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430018",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@rajat1433](#comment%3A20):
> I think union and chain works differently and in the present case union seems correct as it collects all the vertices of different edges. chain might result in repetition of vertices.

no, the behavior is the same here, but as I wrote, I'm not sure it's better here, so let it as is.



---

archive/issue_comments_430019.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nYes you are right I was misunderstanding the definition of chain.\n\n\n```\nsage: n = {(1,2),(3,4),(1,4),(5,6),(6,8),(6,4)}\nsage: %timeit list(set().union(*n))\nThe slowest run took 11.81 times longer than the fastest. This could mean that an intermediate result is being cached.\n1000000 loops, best of 3: 1.53 \u00b5s per loop\nsage: %timeit list(set(chain(*n)))\nThe slowest run took 6.35 times longer than the fastest. This could mean that an intermediate result is being cached.\n1000000 loops, best of 3: 1.58 \u00b5s per loop\n\n```\n\nAlthough not much difference but union is slightly more better than chain here.",
    "created_at": "2019-04-15T09:13:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430019",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:22'>Comment 22:</a>
Yes you are right I was misunderstanding the definition of chain.


```
sage: n = {(1,2),(3,4),(1,4),(5,6),(6,8),(6,4)}
sage: %timeit list(set().union(*n))
The slowest run took 11.81 times longer than the fastest. This could mean that an intermediate result is being cached.
1000000 loops, best of 3: 1.53 µs per loop
sage: %timeit list(set(chain(*n)))
The slowest run took 6.35 times longer than the fastest. This could mean that an intermediate result is being cached.
1000000 loops, best of 3: 1.58 µs per loop

```

Although not much difference but union is slightly more better than chain here.



---

archive/issue_comments_430020.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\n- <code>\\`self\\`</code> -> <code>\\`\\`self\\`\\`</code>  (twice)\n\n- what happen when `edges_complement` is None ?\n\n- you should document the fact that in `edges_complement`, edges are pairs without labels, and in fact frozensets. In fact, it might be better to compute `edges_complement` inside `min_cycle_basis` to avoid errors in the input.\n\n- a possible improvement could be to do\n\n```\ncdef list edgelist = list(self.iterator_unsorted_edges(list(self.iterator_verts(None)), True))\ncdef list edgelist_int = [(vertex_to_int[e[0]], vertex_to_int[e[1], weight_function(e)) for e in edgelist]\ncdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]\n```\n  this way, inside the main loops you work only with integers and precomputed weights. Finally, you reconstruct the correct cycle basis before returning it.\n\n  You can then do `for e in edgelist:` -> `for uidx, vidx, edge_w in edgelist_int:`\n\n  Think about it.",
    "created_at": "2019-04-15T09:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430020",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:23'>Comment 23:</a>
- <code>\`self\`</code> -> <code>\`\`self\`\`</code>  (twice)

- what happen when `edges_complement` is None ?

- you should document the fact that in `edges_complement`, edges are pairs without labels, and in fact frozensets. In fact, it might be better to compute `edges_complement` inside `min_cycle_basis` to avoid errors in the input.

- a possible improvement could be to do

```
cdef list edgelist = list(self.iterator_unsorted_edges(list(self.iterator_verts(None)), True))
cdef list edgelist_int = [(vertex_to_int[e[0]], vertex_to_int[e[1], weight_function(e)) for e in edgelist]
cdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]
```
  this way, inside the main loops you work only with integers and precomputed weights. Finally, you reconstruct the correct cycle basis before returning it.

  You can then do `for e in edgelist:` -> `for uidx, vidx, edge_w in edgelist_int:`

  Think about it.



---

archive/issue_comments_430021.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66e9c46ef456314a0b0ae3dbf964ea52639af0fd\">66e9c46</a></td><td><code>improved</code></td></tr></table>\n",
    "created_at": "2019-04-15T12:10:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430021",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66e9c46ef456314a0b0ae3dbf964ea52639af0fd">66e9c46</a></td><td><code>improved</code></td></tr></table>




---

archive/issue_comments_430022.json:
```json
{
    "body": "Changed commit from **[734a300](https://github.com/sagemath/sagetrac-mirror/commit/734a300d512e85b60d3acbd2f5702912bb9389c4)** to **[66e9c46](https://github.com/sagemath/sagetrac-mirror/commit/66e9c46ef456314a0b0ae3dbf964ea52639af0fd)**",
    "created_at": "2019-04-15T12:10:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430022",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[734a300](https://github.com/sagemath/sagetrac-mirror/commit/734a300d512e85b60d3acbd2f5702912bb9389c4)** to **[66e9c46](https://github.com/sagemath/sagetrac-mirror/commit/66e9c46ef456314a0b0ae3dbf964ea52639af0fd)**



---

archive/issue_comments_430023.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\n\n```\ncdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]\n```\nthis will throw an error as edges_complement being a frozenset can't be indexed.\n\n**\nwhat happen when edges_complement is None ?** \n\nIt should return an empty list. I added it in this commit to avoid process further.\n\nI tried doing \n\n```\ncdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]\n```\n\nbefore converting to frozenset but got some unexpected errors. Will see if it can be added.",
    "created_at": "2019-04-15T12:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430023",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:25'>Comment 25:</a>

```
cdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]
```
this will throw an error as edges_complement being a frozenset can't be indexed.

**
what happen when edges_complement is None ?** 

It should return an empty list. I added it in this commit to avoid process further.

I tried doing 

```
cdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]
```

before converting to frozenset but got some unexpected errors. Will see if it can be added.



---

archive/issue_comments_430024.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nReplying to [@rajat1433](#comment%3A25):\n> \n> ```\n> cdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]\n> ```\n> this will throw an error as edges_complement being a frozenset can't be indexed.\n\nThen \n\n```\ncdef list orth_set = [set([(vertex_to_int[u], vertex_to_int[v])]) for u, v in edges_complement]\n```",
    "created_at": "2019-04-15T13:58:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430024",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:26'>Comment 26:</a>
Replying to [@rajat1433](#comment%3A25):
> 
> ```
> cdef list orth_set = [set([(vertex_to_int[e[0]], vertex_to_int[e[1])]) for e in edges_complement]
> ```
> this will throw an error as edges_complement being a frozenset can't be indexed.

Then 

```
cdef list orth_set = [set([(vertex_to_int[u], vertex_to_int[v])]) for u, v in edges_complement]
```



---

archive/issue_comments_430025.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09246cbd3dd71b2a30aef045f6a13dcd109c6c23\">09246cb</a></td><td><code>merged with beta8.8.2</code></td></tr></table>\n",
    "created_at": "2019-04-17T19:17:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430025",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>Comment 27:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09246cbd3dd71b2a30aef045f6a13dcd109c6c23">09246cb</a></td><td><code>merged with beta8.8.2</code></td></tr></table>




---

archive/issue_comments_430026.json:
```json
{
    "body": "Changed commit from **[66e9c46](https://github.com/sagemath/sagetrac-mirror/commit/66e9c46ef456314a0b0ae3dbf964ea52639af0fd)** to **[09246cb](https://github.com/sagemath/sagetrac-mirror/commit/09246cbd3dd71b2a30aef045f6a13dcd109c6c23)**",
    "created_at": "2019-04-17T19:17:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430026",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[66e9c46](https://github.com/sagemath/sagetrac-mirror/commit/66e9c46ef456314a0b0ae3dbf964ea52639af0fd)** to **[09246cb](https://github.com/sagemath/sagetrac-mirror/commit/09246cbd3dd71b2a30aef045f6a13dcd109c6c23)**



---

archive/issue_comments_430027.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nReplying to [@dcoudert](#comment%3A26):\n\n> Then \n> \n> ```\n> cdef list orth_set = [set([(vertex_to_int[u], vertex_to_int[v])]) for u, v in edges_complement]\n> ```\n> \n\nWe have \n\n```\n            new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}\n            cycle_basis.append(list(set().union(*new_cycle)))\n            # updating orth_set so that i+1, i+2, ...th elements are orthogonal\n            # to the newly found cycle\n            base = orth_set[i]\n            for j in range(i + 1, len(orth_set)):\n                if len(**orth_set[j] & new_cycle**) % 2:\n                    orth_set[j] = orth_set[j] ^ base\n```\n\nIn new_cycle we have original vertices so we can't convert vertex to int in orth_set before as they have to be bitwise and with new_cycle as indicated above.",
    "created_at": "2019-04-18T05:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430027",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:28'>Comment 28:</a>
Replying to [@dcoudert](#comment%3A26):

> Then 
> 
> ```
> cdef list orth_set = [set([(vertex_to_int[u], vertex_to_int[v])]) for u, v in edges_complement]
> ```
> 

We have 

```
            new_cycle = {frozenset((int_to_vertex[u], int_to_vertex[v])) for u, v in edges}
            cycle_basis.append(list(set().union(*new_cycle)))
            # updating orth_set so that i+1, i+2, ...th elements are orthogonal
            # to the newly found cycle
            base = orth_set[i]
            for j in range(i + 1, len(orth_set)):
                if len(**orth_set[j] & new_cycle**) % 2:
                    orth_set[j] = orth_set[j] ^ base
```

In new_cycle we have original vertices so we can't convert vertex to int in orth_set before as they have to be bitwise and with new_cycle as indicated above.



---

archive/issue_comments_430028.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nconsider this code\n\n```\n        if not edges_complement:\n            return []\n        if not by_weight:\n            def weight_function(e):\n                return 1\n        from sage.graphs.base.boost_graph import johnson_shortest_paths\n        from sage.graphs.graph import Graph\n\n        cdef int u_int, v_int, i, j\n        cdef object u, v\n        cdef list int_to_vertex = list(self.iterator_verts(None))\n        cdef dict vertex_to_int = {u: u_int for u_int, u in enumerate(int_to_vertex)}\n        cdef list edgelist = [(vertex_to_int[e[0]], vertex_to_int[e[1]], weight_function(e))\n                                  for e in self.iterator_unsorted_edges(int_to_vertex, True)]\n        edges_complement = [frozenset((vertex_to_int[u], vertex_to_int[v])) for u, v in edges_complement]\n        cdef int l = len(edges_complement)\n        cdef list orth_set = [set([e]) for e in edges_complement]\n        cdef int n = self.num_verts()\n        cdef list min_path_nodes\n        cdef list min_path\n        cdef dict all_pair_shortest_pathlens\n        cdef dict cross_paths_lens\n        cdef list cycle_basis = []\n        cdef set base\n\n        for i in range(l):\n            base = orth_set[i]\n            G = Graph(weighted=True)\n            # For each edge in self, add 2 edges to G: \"cross\" edges if edge is\n            # in base, otherwise \"in-plane\" edges\n            for u_int, v_int, edge_w in edgelist:\n                # mapping the nodes in self from 0 to n-1\n                if frozenset((u_int, v_int)) in base:\n                    G.add_edge(u_int, n + v_int, edge_w)\n                    G.add_edge(n + u_int, v_int, edge_w)\n                else:\n                    G.add_edge(u_int, v_int, edge_w)\n                    G.add_edge(n + u_int, n + v_int, edge_w)\n\n            all_pair_shortest_pathlens = johnson_shortest_paths(G)\n            cross_paths_lens = {j: all_pair_shortest_pathlens[j][n + j] for j in range(n)}\n            u_int = min(cross_paths_lens, key=cross_paths_lens.get)\n            v_int = n + u_int\n            min_path = G._backend.bidirectional_dijkstra(u_int, v_int, distance_flag=False)\n\n            # Mapping the nodes in G to nodes in self\n            min_path_nodes = [u_int if u_int < n else u_int - n for u_int in min_path]\n\n            # removal of edges occuring even number of times\n            edges = set()\n            for edge in zip(min_path_nodes[:-1], min_path_nodes[1:]):\n                edges ^= {edge}\n            new_cycle = {frozenset(e) for e in edges}\n            cycle_basis.append([int_to_vertex[u_int] for u_int in set().union(*new_cycle)])\n            # updating orth_set so that i+1, i+2, ...th elements are orthogonal\n            # to the newly found cycle\n            for j in range(i + 1, l):\n                if len(orth_set[j] & new_cycle) % 2:\n                    orth_set[j] = orth_set[j] ^ base\n        return cycle_basis\n```\n\nNow, is `c_graph.pyx` the best place for this code ? Somehow, instead of building a `Graph`, you could directly build a boost graph and call corresponding methods on it. Plus, with #27518, we will be able to get the predecessor matrix, thus avoiding an extra call to Dijkstra.",
    "created_at": "2019-04-20T08:58:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430028",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:29'>Comment 29:</a>
consider this code

```
        if not edges_complement:
            return []
        if not by_weight:
            def weight_function(e):
                return 1
        from sage.graphs.base.boost_graph import johnson_shortest_paths
        from sage.graphs.graph import Graph

        cdef int u_int, v_int, i, j
        cdef object u, v
        cdef list int_to_vertex = list(self.iterator_verts(None))
        cdef dict vertex_to_int = {u: u_int for u_int, u in enumerate(int_to_vertex)}
        cdef list edgelist = [(vertex_to_int[e[0]], vertex_to_int[e[1]], weight_function(e))
                                  for e in self.iterator_unsorted_edges(int_to_vertex, True)]
        edges_complement = [frozenset((vertex_to_int[u], vertex_to_int[v])) for u, v in edges_complement]
        cdef int l = len(edges_complement)
        cdef list orth_set = [set([e]) for e in edges_complement]
        cdef int n = self.num_verts()
        cdef list min_path_nodes
        cdef list min_path
        cdef dict all_pair_shortest_pathlens
        cdef dict cross_paths_lens
        cdef list cycle_basis = []
        cdef set base

        for i in range(l):
            base = orth_set[i]
            G = Graph(weighted=True)
            # For each edge in self, add 2 edges to G: "cross" edges if edge is
            # in base, otherwise "in-plane" edges
            for u_int, v_int, edge_w in edgelist:
                # mapping the nodes in self from 0 to n-1
                if frozenset((u_int, v_int)) in base:
                    G.add_edge(u_int, n + v_int, edge_w)
                    G.add_edge(n + u_int, v_int, edge_w)
                else:
                    G.add_edge(u_int, v_int, edge_w)
                    G.add_edge(n + u_int, n + v_int, edge_w)

            all_pair_shortest_pathlens = johnson_shortest_paths(G)
            cross_paths_lens = {j: all_pair_shortest_pathlens[j][n + j] for j in range(n)}
            u_int = min(cross_paths_lens, key=cross_paths_lens.get)
            v_int = n + u_int
            min_path = G._backend.bidirectional_dijkstra(u_int, v_int, distance_flag=False)

            # Mapping the nodes in G to nodes in self
            min_path_nodes = [u_int if u_int < n else u_int - n for u_int in min_path]

            # removal of edges occuring even number of times
            edges = set()
            for edge in zip(min_path_nodes[:-1], min_path_nodes[1:]):
                edges ^= {edge}
            new_cycle = {frozenset(e) for e in edges}
            cycle_basis.append([int_to_vertex[u_int] for u_int in set().union(*new_cycle)])
            # updating orth_set so that i+1, i+2, ...th elements are orthogonal
            # to the newly found cycle
            for j in range(i + 1, l):
                if len(orth_set[j] & new_cycle) % 2:
                    orth_set[j] = orth_set[j] ^ base
        return cycle_basis
```

Now, is `c_graph.pyx` the best place for this code ? Somehow, instead of building a `Graph`, you could directly build a boost graph and call corresponding methods on it. Plus, with #27518, we will be able to get the predecessor matrix, thus avoiding an extra call to Dijkstra.



---

archive/issue_comments_430029.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\n- Now, is c_graph.pyx the best place for this code ? Somehow, instead of building a Graph, you could directly build a boost graph and call corresponding methods on it. Plus, with #27518, we will be able to get the predecessor matrix, thus avoiding an extra call to Dijkstra. \n\nBut when we call any method in boost graph it takes in sage graph and converts it into a boost graph like in Johnson's algorithm for all_paths. So if we want to use directly boost graph we may have to write a new function/ modify the existing function in boost_graph.pyx for using the algorithm of boost graph on boost graph directly without expecting a sage graph. \nIf you have any other idea let me know.",
    "created_at": "2019-04-20T15:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430029",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:30'>Comment 30:</a>
- Now, is c_graph.pyx the best place for this code ? Somehow, instead of building a Graph, you could directly build a boost graph and call corresponding methods on it. Plus, with #27518, we will be able to get the predecessor matrix, thus avoiding an extra call to Dijkstra. 

But when we call any method in boost graph it takes in sage graph and converts it into a boost graph like in Johnson's algorithm for all_paths. So if we want to use directly boost graph we may have to write a new function/ modify the existing function in boost_graph.pyx for using the algorithm of boost graph on boost graph directly without expecting a sage graph. 
If you have any other idea let me know.



---

archive/issue_comments_430030.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31457ee71044481c7c647e8bef5ff0a129647707\">31457ee</a></td><td><code>improved the code</code></td></tr></table>\n",
    "created_at": "2019-04-20T15:01:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430030",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>Comment 31:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31457ee71044481c7c647e8bef5ff0a129647707">31457ee</a></td><td><code>improved the code</code></td></tr></table>




---

archive/issue_comments_430031.json:
```json
{
    "body": "Changed commit from **[09246cb](https://github.com/sagemath/sagetrac-mirror/commit/09246cbd3dd71b2a30aef045f6a13dcd109c6c23)** to **[31457ee](https://github.com/sagemath/sagetrac-mirror/commit/31457ee71044481c7c647e8bef5ff0a129647707)**",
    "created_at": "2019-04-20T15:01:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430031",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[09246cb](https://github.com/sagemath/sagetrac-mirror/commit/09246cbd3dd71b2a30aef045f6a13dcd109c6c23)** to **[31457ee](https://github.com/sagemath/sagetrac-mirror/commit/31457ee71044481c7c647e8bef5ff0a129647707)**



---

archive/issue_comments_430032.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nNew branch with an implementation using boost. The main advantage is to avoid conversion between sage graph and boost graph as we create directly the boost graph.\n\nPlease try it, test it, etc. to check if it's working correctly and also if it is better than previous version.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd99eb017c0f103973708ab4733611eb8a8aeaa4\">fd99eb0</a></td><td><code>trac #27570: Merged with 8.8.beta3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d9c34e42ec0970b67b8f6bf09f39a55dbfdecd3\">8d9c34e</a></td><td><code>trac #27570: min_cycle_basis with boost</code></td></tr></table>\n",
    "created_at": "2019-04-20T18:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430032",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:32'>Comment 32:</a>
New branch with an implementation using boost. The main advantage is to avoid conversion between sage graph and boost graph as we create directly the boost graph.

Please try it, test it, etc. to check if it's working correctly and also if it is better than previous version.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd99eb017c0f103973708ab4733611eb8a8aeaa4">fd99eb0</a></td><td><code>trac #27570: Merged with 8.8.beta3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d9c34e42ec0970b67b8f6bf09f39a55dbfdecd3">8d9c34e</a></td><td><code>trac #27570: min_cycle_basis with boost</code></td></tr></table>




---

archive/issue_comments_430033.json:
```json
{
    "body": "Changed branch from **[u/gh-rajat1433/27570_min_weight_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-rajat1433/27570_min_weight_cycle_basis)** to **[public/graphs/27570_min_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/27570_min_cycle_basis)**",
    "created_at": "2019-04-20T18:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430033",
    "user": "https://github.com/dcoudert"
}
```

Changed branch from **[u/gh-rajat1433/27570_min_weight_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-rajat1433/27570_min_weight_cycle_basis)** to **[public/graphs/27570_min_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/27570_min_cycle_basis)**



---

archive/issue_comments_430034.json:
```json
{
    "body": "Changed commit from **[31457ee](https://github.com/sagemath/sagetrac-mirror/commit/31457ee71044481c7c647e8bef5ff0a129647707)** to **[8d9c34e](https://github.com/sagemath/sagetrac-mirror/commit/8d9c34e42ec0970b67b8f6bf09f39a55dbfdecd3)**",
    "created_at": "2019-04-20T18:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430034",
    "user": "https://github.com/dcoudert"
}
```

Changed commit from **[31457ee](https://github.com/sagemath/sagetrac-mirror/commit/31457ee71044481c7c647e8bef5ff0a129647707)** to **[8d9c34e](https://github.com/sagemath/sagetrac-mirror/commit/8d9c34e42ec0970b67b8f6bf09f39a55dbfdecd3)**



---

archive/issue_comments_430035.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nSince the branch is in `public/`, you can modify it.",
    "created_at": "2019-04-20T18:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430035",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:33'>Comment 33:</a>
Since the branch is in `public/`, you can modify it.



---

archive/issue_comments_430036.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nThank You @dcoudert for helping me with the boost graph code. I have tested it on my system and its timing is improved as well as it is passing all the tests. So its certainly better and appropriate then the previous version.\n\nFor me it is good to go.",
    "created_at": "2019-04-21T10:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430036",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:34'>Comment 34:</a>
Thank You @dcoudert for helping me with the boost graph code. I have tested it on my system and its timing is improved as well as it is passing all the tests. So its certainly better and appropriate then the previous version.

For me it is good to go.



---

archive/issue_comments_430037.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/805ef5c10252df220b1b08ccceaa469a8a9d207a\">805ef5c</a></td><td><code>added min_cycle_basis</code></td></tr></table>\n",
    "created_at": "2019-04-21T10:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430037",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:35'>Comment 35:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/805ef5c10252df220b1b08ccceaa469a8a9d207a">805ef5c</a></td><td><code>added min_cycle_basis</code></td></tr></table>




---

archive/issue_comments_430038.json:
```json
{
    "body": "Changed commit from **[8d9c34e](https://github.com/sagemath/sagetrac-mirror/commit/8d9c34e42ec0970b67b8f6bf09f39a55dbfdecd3)** to **[805ef5c](https://github.com/sagemath/sagetrac-mirror/commit/805ef5c10252df220b1b08ccceaa469a8a9d207a)**",
    "created_at": "2019-04-21T10:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430038",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8d9c34e](https://github.com/sagemath/sagetrac-mirror/commit/8d9c34e42ec0970b67b8f6bf09f39a55dbfdecd3)** to **[805ef5c](https://github.com/sagemath/sagetrac-mirror/commit/805ef5c10252df220b1b08ccceaa469a8a9d207a)**



---

archive/issue_comments_430039.json:
```json
{
    "body": "Changed commit from **[805ef5c](https://github.com/sagemath/sagetrac-mirror/commit/805ef5c10252df220b1b08ccceaa469a8a9d207a)** to **[3e717c3](https://github.com/sagemath/sagetrac-mirror/commit/3e717c3e3217a8865283fcb1ff7675c9f0369d1f)**",
    "created_at": "2019-04-21T13:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430039",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[805ef5c](https://github.com/sagemath/sagetrac-mirror/commit/805ef5c10252df220b1b08ccceaa469a8a9d207a)** to **[3e717c3](https://github.com/sagemath/sagetrac-mirror/commit/3e717c3e3217a8865283fcb1ff7675c9f0369d1f)**



---

archive/issue_comments_430040.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e717c3e3217a8865283fcb1ff7675c9f0369d1f\">3e717c3</a></td><td><code>trac #27570: reviewer improvement</code></td></tr></table>\n",
    "created_at": "2019-04-21T13:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430040",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:36'>Comment 36:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e717c3e3217a8865283fcb1ff7675c9f0369d1f">3e717c3</a></td><td><code>trac #27570: reviewer improvement</code></td></tr></table>




---

archive/issue_comments_430041.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nI added some examples with networkx plus a few corrections.\n\nIn `min_cycle_basis`, can we avoid input parameter `edges_complement` and so compute a spanning tree inside the method. Is it important to have this input parameter ?",
    "created_at": "2019-04-21T13:49:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430041",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:37'>Comment 37:</a>
I added some examples with networkx plus a few corrections.

In `min_cycle_basis`, can we avoid input parameter `edges_complement` and so compute a spanning tree inside the method. Is it important to have this input parameter ?



---

archive/issue_comments_430042.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nReplying to [@dcoudert](#comment%3A37):\n> I added some examples with networkx plus a few corrections.\n> \n> In `min_cycle_basis`, can we avoid input parameter `edges_complement` and so compute a spanning tree inside the method. Is it important to have this input parameter ?\n\nSince we now have sage graph inside min_cycle_basis , edges_complement can now be computed inside our method , no need to pass it as a parameter.\nI will do the required change.",
    "created_at": "2019-04-21T13:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430042",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:38'>Comment 38:</a>
Replying to [@dcoudert](#comment%3A37):
> I added some examples with networkx plus a few corrections.
> 
> In `min_cycle_basis`, can we avoid input parameter `edges_complement` and so compute a spanning tree inside the method. Is it important to have this input parameter ?

Since we now have sage graph inside min_cycle_basis , edges_complement can now be computed inside our method , no need to pass it as a parameter.
I will do the required change.



---

archive/issue_comments_430043.json:
```json
{
    "body": "Changed commit from **[3e717c3](https://github.com/sagemath/sagetrac-mirror/commit/3e717c3e3217a8865283fcb1ff7675c9f0369d1f)** to **[ca55582](https://github.com/sagemath/sagetrac-mirror/commit/ca55582d2a6f320d856090657b6ea1ded9c2b258)**",
    "created_at": "2019-04-23T17:12:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430043",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3e717c3](https://github.com/sagemath/sagetrac-mirror/commit/3e717c3e3217a8865283fcb1ff7675c9f0369d1f)** to **[ca55582](https://github.com/sagemath/sagetrac-mirror/commit/ca55582d2a6f320d856090657b6ea1ded9c2b258)**



---

archive/issue_comments_430044.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d727aec489a03e7100fc4c0570a4aba1238f9fb9\">d727aec</a></td><td><code>removed edge_compliment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca55582d2a6f320d856090657b6ea1ded9c2b258\">ca55582</a></td><td><code>removed edge_complemetn parameter</code></td></tr></table>\n",
    "created_at": "2019-04-23T17:12:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430044",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>Comment 39:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d727aec489a03e7100fc4c0570a4aba1238f9fb9">d727aec</a></td><td><code>removed edge_compliment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca55582d2a6f320d856090657b6ea1ded9c2b258">ca55582</a></td><td><code>removed edge_complemetn parameter</code></td></tr></table>




---

archive/issue_comments_430045.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nI have removed the edges_complement parameter.\nNote that I have added\n> \n> ```diff\n> ```\n\n>+    return 1\n\n}}}\nin boost_graph as required to get an unweighted spanning tree as cython doesn't allow lambda expressions.\nCouldn't find a better way to do it. \nIf you have any other way in mind let me know.",
    "created_at": "2019-04-23T17:16:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430045",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:40'>Comment 40:</a>
I have removed the edges_complement parameter.
Note that I have added
> 
> ```diff
> ```

>+    return 1

}}}
in boost_graph as required to get an unweighted spanning tree as cython doesn't allow lambda expressions.
Couldn't find a better way to do it. 
If you have any other way in mind let me know.



---

archive/issue_comments_430046.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nSince any spanning tree is valid, you can simply avoid adding the weight function. So we don't need to define `w_f`.",
    "created_at": "2019-04-23T18:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430046",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:41'>Comment 41:</a>
Since any spanning tree is valid, you can simply avoid adding the weight function. So we don't need to define `w_f`.



---

archive/issue_comments_430047.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ca454e30ce50c3f3049f26d69266943264a3d44\">4ca454e</a></td><td><code>removed w_f</code></td></tr></table>\n",
    "created_at": "2019-04-24T07:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430047",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:42'>Comment 42:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ca454e30ce50c3f3049f26d69266943264a3d44">4ca454e</a></td><td><code>removed w_f</code></td></tr></table>




---

archive/issue_comments_430048.json:
```json
{
    "body": "Changed commit from **[ca55582](https://github.com/sagemath/sagetrac-mirror/commit/ca55582d2a6f320d856090657b6ea1ded9c2b258)** to **[4ca454e](https://github.com/sagemath/sagetrac-mirror/commit/4ca454e30ce50c3f3049f26d69266943264a3d44)**",
    "created_at": "2019-04-24T07:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430048",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ca55582](https://github.com/sagemath/sagetrac-mirror/commit/ca55582d2a6f320d856090657b6ea1ded9c2b258)** to **[4ca454e](https://github.com/sagemath/sagetrac-mirror/commit/4ca454e30ce50c3f3049f26d69266943264a3d44)**



---

archive/issue_comments_430049.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nI just tried the the patch with Python3 and we have some issues to fix. This is mostly ordering issues as for instance the order of the keys of a dictionary is not always the same in Python 2 and Python 3.\n\nFor instance, I get:\n\n```\nFile \"src/sage/graphs/generic_graph.py\", line 4679, in sage.graphs.generic_graph.GenericGraph.minimum_cycle_basis\nFailed example:\n    g.minimum_cycle_basis(by_weight=True)\nExpected:\n    [[1, 2, 3], [1, 2, 3, 4], [5, 6, 7]]\nGot:\n    [[1, 2, 3, 4], [1, 2, 3], [5, 6, 7]]\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 4681, in sage.graphs.generic_graph.GenericGraph.minimum_cycle_basis\nFailed example:\n    g.minimum_cycle_basis(by_weight=False)\nExpected:\n    [[1, 2, 3], [1, 3, 4], [5, 6, 7]]\nGot:\n    [[1, 3, 4], [1, 2, 3], [5, 6, 7]]\n```\n\n\nSo, I suggest to use `sorted(g.minimum_cycle_basis(...))` in all examples, and possibly\n`sorted(sorted(c) for c in g.minimum_cycle_basis(...))`. This last one might be too much, but...",
    "created_at": "2019-04-24T09:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430049",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:43'>Comment 43:</a>
I just tried the the patch with Python3 and we have some issues to fix. This is mostly ordering issues as for instance the order of the keys of a dictionary is not always the same in Python 2 and Python 3.

For instance, I get:

```
File "src/sage/graphs/generic_graph.py", line 4679, in sage.graphs.generic_graph.GenericGraph.minimum_cycle_basis
Failed example:
    g.minimum_cycle_basis(by_weight=True)
Expected:
    [[1, 2, 3], [1, 2, 3, 4], [5, 6, 7]]
Got:
    [[1, 2, 3, 4], [1, 2, 3], [5, 6, 7]]
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 4681, in sage.graphs.generic_graph.GenericGraph.minimum_cycle_basis
Failed example:
    g.minimum_cycle_basis(by_weight=False)
Expected:
    [[1, 2, 3], [1, 3, 4], [5, 6, 7]]
Got:
    [[1, 3, 4], [1, 2, 3], [5, 6, 7]]
```


So, I suggest to use `sorted(g.minimum_cycle_basis(...))` in all examples, and possibly
`sorted(sorted(c) for c in g.minimum_cycle_basis(...))`. This last one might be too much, but...



---

archive/issue_comments_430050.json:
```json
{
    "body": "Changed commit from **[4ca454e](https://github.com/sagemath/sagetrac-mirror/commit/4ca454e30ce50c3f3049f26d69266943264a3d44)** to **[66fe52d](https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8)**",
    "created_at": "2019-04-24T11:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430050",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4ca454e](https://github.com/sagemath/sagetrac-mirror/commit/4ca454e30ce50c3f3049f26d69266943264a3d44)** to **[66fe52d](https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8)**



---

archive/issue_comments_430051.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8\">66fe52d</a></td><td><code>sorted examples</code></td></tr></table>\n",
    "created_at": "2019-04-24T11:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430051",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:44'>Comment 44:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8">66fe52d</a></td><td><code>sorted examples</code></td></tr></table>




---

archive/issue_comments_430052.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nIn our examples we do not have disconnected components except in 1 in which sorted and unsorted are same, so sorted(g.minimum_cycle_basis(...)) will work",
    "created_at": "2019-04-24T11:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430052",
    "user": "https://github.com/rajat1433"
}
```

<a id='comment:45'>Comment 45:</a>
In our examples we do not have disconnected components except in 1 in which sorted and unsorted are same, so sorted(g.minimum_cycle_basis(...)) will work



---

archive/issue_comments_430053.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nThis has nothing to do with being connected or not. In all our example, we always get the vertices of a cycle sorted by label, although this is not a requirement in the code.\nInstead of `[[1, 2, 3], [1, 3, 4], [5, 6, 7]]`, we could get `[[1, 3, 2], [3, 4, 1], [5, 7, 6]]`. If we had that, then `sorted(sorted(c)...` would be necessary.\n\nWe could certainly improve further the code, but this is already quite good.",
    "created_at": "2019-04-24T11:40:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430053",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:46'>Comment 46:</a>
This has nothing to do with being connected or not. In all our example, we always get the vertices of a cycle sorted by label, although this is not a requirement in the code.
Instead of `[[1, 2, 3], [1, 3, 4], [5, 6, 7]]`, we could get `[[1, 3, 2], [3, 4, 1], [5, 7, 6]]`. If we had that, then `sorted(sorted(c)...` would be necessary.

We could certainly improve further the code, but this is already quite good.



---

archive/issue_comments_430054.json:
```json
{
    "body": "Reviewer: **David Coudert**",
    "created_at": "2019-04-24T11:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430054",
    "user": "https://github.com/dcoudert"
}
```

Reviewer: **David Coudert**



---

archive/issue_events_347567.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-04-24T11:40:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347567"
}
```



---

archive/issue_events_347568.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2019-04-24T11:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347568"
}
```



---

archive/issue_comments_430055.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nLGTM.",
    "created_at": "2019-04-24T11:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430055",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:47'>Comment 47:</a>
LGTM.



---

archive/issue_events_347569.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-27T17:44:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347569"
}
```



---

archive/issue_events_347570.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3e5acef10a1e016feab43a5d41fe317f31aaf16c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-04-27T17:44:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27570#event-347570"
}
```



---

archive/issue_comments_430056.json:
```json
{
    "body": "Changed branch from **[public/graphs/27570_min_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/27570_min_cycle_basis)** to **[66fe52d](https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8)**",
    "created_at": "2019-04-27T17:44:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27570",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27570#issuecomment-430056",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/graphs/27570_min_cycle_basis](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/27570_min_cycle_basis)** to **[66fe52d](https://github.com/sagemath/sagetrac-mirror/commit/66fe52d1c0c21b2cf4d02e8085a439dbe54cb6e8)**
