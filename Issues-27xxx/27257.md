# Issue 27257: Fix sagenb build

archive/issues_027020.json:
```json
{
    "assignees": [],
    "body": "\n\nCC:  @Konrad127123 @zimmermann6\n\nBranch/Commit: **[u/jdemeyer/fix_sagenb_build](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/fix_sagenb_build) @ [`3e48fd4`](https://github.com/sagemath/sagetrac-mirror/commit/3e48fd48f688f68e1eef2889fde3eff818d3f8b2)**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27257_\n\n",
    "closed_at": "2019-02-20T17:40:35Z",
    "created_at": "2019-02-11T21:42:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/worksforme"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix sagenb build",
    "type": "issue",
    "updated_at": "2019-02-20T17:40:35Z",
    "url": "https://github.com/sagemath/sage/issues/27257",
    "user": "https://github.com/jdemeyer"
}
```


CC:  @Konrad127123 @zimmermann6

Branch/Commit: **[u/jdemeyer/fix_sagenb_build](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/fix_sagenb_build) @ [`3e48fd4`](https://github.com/sagemath/sagetrac-mirror/commit/3e48fd48f688f68e1eef2889fde3eff818d3f8b2)**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/27257_





---

archive/issue_events_371524.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-11T21:42:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371524"
}
```



---

archive/issue_events_371525.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-11T21:42:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371525"
}
```



---

archive/issue_events_371526.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-11T21:42:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371526"
}
```



---

archive/issue_events_371527.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-02-11T21:42:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371527"
}
```



---

archive/issue_comments_420898.json:
```json
{
    "body": "Branch: **[u/jdemeyer/fix_sagenb_build](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/fix_sagenb_build)**",
    "created_at": "2019-02-11T21:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420898",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/fix_sagenb_build](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/fix_sagenb_build)**



---

archive/issue_comments_420899.json:
```json
{
    "body": "Commit: **[`3e48fd4`](https://github.com/sagemath/sagetrac-mirror/commit/3e48fd48f688f68e1eef2889fde3eff818d3f8b2)**",
    "created_at": "2019-02-11T22:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420899",
    "user": "https://github.com/Konrad127123"
}
```

Commit: **[`3e48fd4`](https://github.com/sagemath/sagetrac-mirror/commit/3e48fd48f688f68e1eef2889fde3eff818d3f8b2)**



---

archive/issue_comments_420900.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e48fd48f688f68e1eef2889fde3eff818d3f8b2\"><code>3e48fd4</code></a></td><td><code>Get rid of all \"except ImportError\" for sage</code></td></tr></table>\n",
    "created_at": "2019-02-11T22:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420900",
    "user": "https://github.com/Konrad127123"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e48fd48f688f68e1eef2889fde3eff818d3f8b2"><code>3e48fd4</code></a></td><td><code>Get rid of all "except ImportError" for sage</code></td></tr></table>




---

archive/issue_comments_420901.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nCan you please try to reproduce the problem from #26686 with this branch?",
    "created_at": "2019-02-11T23:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420901",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Can you please try to reproduce the problem from #26686 with this branch?



---

archive/issue_comments_420902.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@jdemeyer](#comment%3A3):\n> Can you please try to reproduce the problem from #26686 with this branch?\n\nsorry I cannot. I only build Sage **releases** on my laptop (this takes ages and I have to make sure it does not heat too much).",
    "created_at": "2019-02-12T07:02:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420902",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@jdemeyer](#comment%3A3):
> Can you please try to reproduce the problem from #26686 with this branch?

sorry I cannot. I only build Sage **releases** on my laptop (this takes ages and I have to make sure it does not heat too much).



---

archive/issue_comments_420903.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nafter trying comment 18 in #26686, I can build Sage with `make sagenb`, but `make -j1` still does not want to build the documentation:\n\n```\n$ make -j1\n...\n[dochtml] [tutorial ] Merging js index files...\n[dochtml] [tutorial ] ... done (2115 js index entries)\n[dochtml] [tutorial ] The HTML pages are in local/share/doc/sage/html/de/tutorial.\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n[dochtml]     \"__main__\", fname, loader, pkg_name)\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/runpy.py\", line 72, in _run_code\n[dochtml]     exec code in run_globals\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 1715, in main\n[dochtml]     builder()\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 342, in _wrapper\n[dochtml]     build_many(build_other_doc, L)\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 283, in build_many\n[dochtml]     ret = x.get(99999)\n[dochtml]   File \"/usr/local/sage-8.6/local/lib/python2.7/multiprocessing/pool.py\", line 572, in get\n[dochtml]     raise self._value\n[dochtml] OSError: WARNING: search index couldn't be loaded, but not all documents will be built: the index will be incomplete.\n[dochtml] \n[dochtml]     Note: incremental documentation builds sometimes cause spurious\n[dochtml]     error messages. To be certain that these are real errors, run\n[dochtml]     \"make doc-clean\" first and try again.\nMakefile:1993: recipe for target 'doc-html' failed\nmake[3]: *** [doc-html] Error 1\nmake[3]: Leaving directory '/usr/local/sage-8.6/build/make'\nMakefile:1803: recipe for target 'all-start' failed\nmake[2]: *** [all-start] Error 2\nmake[2]: Leaving directory '/usr/local/sage-8.6/build/make'\n```",
    "created_at": "2019-02-12T07:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420903",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:5" align="right">comment:5</div>

after trying comment 18 in #26686, I can build Sage with `make sagenb`, but `make -j1` still does not want to build the documentation:

```
$ make -j1
...
[dochtml] [tutorial ] Merging js index files...
[dochtml] [tutorial ] ... done (2115 js index entries)
[dochtml] [tutorial ] The HTML pages are in local/share/doc/sage/html/de/tutorial.
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/runpy.py", line 174, in _run_module_as_main
[dochtml]     "__main__", fname, loader, pkg_name)
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/runpy.py", line 72, in _run_code
[dochtml]     exec code in run_globals
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 1715, in main
[dochtml]     builder()
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 342, in _wrapper
[dochtml]     build_many(build_other_doc, L)
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 283, in build_many
[dochtml]     ret = x.get(99999)
[dochtml]   File "/usr/local/sage-8.6/local/lib/python2.7/multiprocessing/pool.py", line 572, in get
[dochtml]     raise self._value
[dochtml] OSError: WARNING: search index couldn't be loaded, but not all documents will be built: the index will be incomplete.
[dochtml] 
[dochtml]     Note: incremental documentation builds sometimes cause spurious
[dochtml]     error messages. To be certain that these are real errors, run
[dochtml]     "make doc-clean" first and try again.
Makefile:1993: recipe for target 'doc-html' failed
make[3]: *** [doc-html] Error 1
make[3]: Leaving directory '/usr/local/sage-8.6/build/make'
Makefile:1803: recipe for target 'all-start' failed
make[2]: *** [all-start] Error 2
make[2]: Leaving directory '/usr/local/sage-8.6/build/make'
```



---

archive/issue_comments_420904.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nDoes `make doc-clean` fix that latter error?",
    "created_at": "2019-02-12T08:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420904",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Does `make doc-clean` fix that latter error?



---

archive/issue_comments_420905.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jdemeyer](#comment%3A6):\n> Does `make doc-clean` fix that latter error?\n\nyes it does. Thank you. But it was the first time since years that building Sage from source does not work.",
    "created_at": "2019-02-13T20:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420905",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jdemeyer](#comment%3A6):
> Does `make doc-clean` fix that latter error?

yes it does. Thank you. But it was the first time since years that building Sage from source does not work.



---

archive/issue_comments_420906.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSo is there anybody that can actually reproduce the problem from #26686? If not, this should be closed as \"worksforme\".",
    "created_at": "2019-02-13T21:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420906",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

So is there anybody that can actually reproduce the problem from #26686? If not, this should be closed as "worksforme".



---

archive/issue_comments_420907.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@jdemeyer](#comment%3A8):\n> So is there anybody that can actually reproduce the problem from #26686? If not, this should be closed as \"worksforme\".\n\nI will try to rebuild Sage 8.6 from scratch, to see if the problem is reproducible.\n\nBy the way, while creating this ticket, you should have copied the description of the problem I had, since the description of this ticket is not very informative...",
    "created_at": "2019-02-15T09:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420907",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@jdemeyer](#comment%3A8):
> So is there anybody that can actually reproduce the problem from #26686? If not, this should be closed as "worksforme".

I will try to rebuild Sage 8.6 from scratch, to see if the problem is reproducible.

By the way, while creating this ticket, you should have copied the description of the problem I had, since the description of this ticket is not very informative...



---

archive/issue_events_371528.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-02-20T17:40:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371528"
}
```



---

archive/issue_events_371529.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-02-20T17:40:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "label": "https://github.com/sagemath/sage/labels/worksforme",
    "label_color": "c6c6c6",
    "label_name": "worksforme",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371529"
}
```



---

archive/issue_comments_420908.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI tried again building Sage 8.6 from scratch and it worked fine. Since I'm unable to reproduce the problem, we can close that ticket.",
    "created_at": "2019-02-20T17:40:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27257#issuecomment-420908",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:10" align="right">comment:10</div>

I tried again building Sage 8.6 from scratch and it worked fine. Since I'm unable to reproduce the problem, we can close that ticket.



---

archive/issue_events_371530.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2019-02-20T17:40:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27257",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27257#event-371530"
}
```
