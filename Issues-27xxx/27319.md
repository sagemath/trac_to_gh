# Issue 27319: Upgrade to Cryptominisat 5.6.8

archive/issues_027082.json:
```json
{
    "assignees": [],
    "body": "This ticket is to upgrade to Cryptominisat 5.6.8.\n\n**Tarball** (to be renamed cryptominisat-5.6.8.tar.gz):\n\n- \u200bhttps://github.com/msoos/cryptominisat/archive/5.6.8.tar.gz\n\nOur last upgrade was to Cryptominisat 5.6.6 in #25480.\n\n**Release notes** (from the\n[Cryptominisat releases](https://github.com/msoos/cryptominisat/releases)\npage on GitHub):\n\n- Cryptominisat 5.6.7\n    > Some fixes and misc improvements. Also, a slightly changed naming\n    > for the independent variables. They are really sampling variables and\n    > so the interface has been renamed accordingly.\n- Cryptominisat 5.6.8\n    > Fixing Windows build\n\n\nCC:  @embray @jdemeyer @saraedum @slel @sagetrac-tmonteil @videlec @orlitzky\n\nComponent: **packages: optional**\n\nKeywords: **upgrade, cryptominisat**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nBranch/Commit: **[`d219646`](https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3)**\n\nReviewer: **Thierry Monteil**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/27319_\n\n",
    "closed_at": "2019-07-10T01:31:26Z",
    "created_at": "2019-02-19T08:44:20Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade to Cryptominisat 5.6.8",
    "type": "issue",
    "updated_at": "2019-07-10T01:31:26Z",
    "url": "https://github.com/sagemath/sage/issues/27319",
    "user": "https://github.com/slel"
}
```
This ticket is to upgrade to Cryptominisat 5.6.8.

**Tarball** (to be renamed cryptominisat-5.6.8.tar.gz):

- ​https://github.com/msoos/cryptominisat/archive/5.6.8.tar.gz

Our last upgrade was to Cryptominisat 5.6.6 in #25480.

**Release notes** (from the
[Cryptominisat releases](https://github.com/msoos/cryptominisat/releases)
page on GitHub):

- Cryptominisat 5.6.7
    > Some fixes and misc improvements. Also, a slightly changed naming
    > for the independent variables. They are really sampling variables and
    > so the interface has been renamed accordingly.
- Cryptominisat 5.6.8
    > Fixing Windows build


CC:  @embray @jdemeyer @saraedum @slel @sagetrac-tmonteil @videlec @orlitzky

Component: **packages: optional**

Keywords: **upgrade, cryptominisat**

Author: **Frédéric Chapoton**

Branch/Commit: **[`d219646`](https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3)**

Reviewer: **Thierry Monteil**

_Issue created by migration from https://trac.sagemath.org/ticket/27319_





---

archive/issue_events_372432.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-02-19T08:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372432"
}
```



---

archive/issue_events_372433.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-02-19T08:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372433"
}
```



---

archive/issue_events_372434.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-19T15:38:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372434"
}
```



---

archive/issue_events_372435.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-02-19T21:03:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "title_is": "Upgrade to Cryptominisat 5.6.8",
    "title_was": "Upgrade to cryptominisat 5.6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372435"
}
```



---

archive/issue_comments_422265.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,19 @@\n-This ticket is to upgrade to cryptominisat 5.6.7.\n+This ticket is to upgrade to Cryptominisat 5.6.8.\n \n-- **Tarball**: \u200bhttps://github.com/msoos/cryptominisat/archive/5.6.7.tar.gz\n+**Tarball** (to be renamed cryptominisat-5.6.8.tar.gz):\n \n-(to be renamed cryptominisat-5.6.7.tar.gz)\n+- \u200bhttps://github.com/msoos/cryptominisat/archive/5.6.8.tar.gz\n+\n+Our last upgrade was to Cryptominisat 5.6.6 in #25480.\n+\n+**Release notes** (from the\n+[Cryptominisat releases](https://github.com/msoos/cryptominisat/releases)\n+page on GitHub):\n+\n+- Cryptominisat 5.6.7\n+    > Some fixes and misc improvements. Also, a slightly changed naming\n+    > for the independent variables. They are really sampling variables and\n+    > so the interface has been renamed accordingly.\n+- Cryptominisat 5.6.8\n+    > Fixing Windows build\n+\n``````\n",
    "created_at": "2019-02-19T21:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422265",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,19 @@
-This ticket is to upgrade to cryptominisat 5.6.7.
+This ticket is to upgrade to Cryptominisat 5.6.8.
 
-- **Tarball**: ​https://github.com/msoos/cryptominisat/archive/5.6.7.tar.gz
+**Tarball** (to be renamed cryptominisat-5.6.8.tar.gz):
 
-(to be renamed cryptominisat-5.6.7.tar.gz)
+- ​https://github.com/msoos/cryptominisat/archive/5.6.8.tar.gz
+
+Our last upgrade was to Cryptominisat 5.6.6 in #25480.
+
+**Release notes** (from the
+[Cryptominisat releases](https://github.com/msoos/cryptominisat/releases)
+page on GitHub):
+
+- Cryptominisat 5.6.7
+    > Some fixes and misc improvements. Also, a slightly changed naming
+    > for the independent variables. They are really sampling variables and
+    > so the interface has been renamed accordingly.
+- Cryptominisat 5.6.8
+    > Fixing Windows build
+
``````




---

archive/issue_events_372436.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372436"
}
```



---

archive/issue_events_372437.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372437"
}
```



---

archive/issue_comments_422266.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422266",
    "user": "https://github.com/embray"
}
```

<div id="comment:3" align="right">comment:3</div>

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_422267.json:
```json
{
    "body": "Branch: **[u/chapoton/27319](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27319)**",
    "created_at": "2019-05-25T05:57:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422267",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/27319](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27319)**



---

archive/issue_comments_422268.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-05-25T05:57:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422268",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_372438.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-05-25T05:57:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372438"
}
```



---

archive/issue_comments_422269.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a89fb243abcb77535ca5966944e0492739866e2\"><code>3a89fb2</code></a></td><td><code>update cryptominisat to 5.6.8</code></td></tr></table>\n",
    "created_at": "2019-05-25T05:57:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422269",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a89fb243abcb77535ca5966944e0492739866e2"><code>3a89fb2</code></a></td><td><code>update cryptominisat to 5.6.8</code></td></tr></table>




---

archive/issue_comments_422270.json:
```json
{
    "body": "Commit: **[`3a89fb2`](https://github.com/sagemath/sagetrac-mirror/commit/3a89fb243abcb77535ca5966944e0492739866e2)**",
    "created_at": "2019-05-25T05:57:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422270",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`3a89fb2`](https://github.com/sagemath/sagetrac-mirror/commit/3a89fb243abcb77535ca5966944e0492739866e2)**



---

archive/issue_comments_422271.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHere is a branch.",
    "created_at": "2019-05-25T05:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422271",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

Here is a branch.



---

archive/issue_comments_422272.json:
```json
{
    "body": "Reviewer: **Thierry Monteil**",
    "created_at": "2019-05-27T13:40:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422272",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Reviewer: **Thierry Monteil**



---

archive/issue_comments_422273.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nby the way, any idea on the following failure of the arando patchbot ?\n\n```\nsage -t --long src/sage/sat/boolean_polynomials.py\n**********************************************************************\nFile \"src/sage/sat/boolean_polynomials.py\", line 146, in sage.sat.boolean_polynomials.solve\nFailed example:\n    len(sls_aes)                                                                      # optional - cryptominisat, long time\nExpected:\n    256\nGot:\n    18\n**********************************************************************\n1 item had failures:\n   1 of  41 in sage.sat.boolean_polynomials.solve\n    [46 tests, 1 failure, 186.16 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed\n```",
    "created_at": "2019-05-27T14:40:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422273",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

by the way, any idea on the following failure of the arando patchbot ?

```
sage -t --long src/sage/sat/boolean_polynomials.py
**********************************************************************
File "src/sage/sat/boolean_polynomials.py", line 146, in sage.sat.boolean_polynomials.solve
Failed example:
    len(sls_aes)                                                                      # optional - cryptominisat, long time
Expected:
    256
Got:
    18
**********************************************************************
1 item had failures:
   1 of  41 in sage.sat.boolean_polynomials.solve
    [46 tests, 1 failure, 186.16 s]
----------------------------------------------------------------------
sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed
```



---

archive/issue_comments_422274.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@fchapoton](#comment%3A7):\n> by the way, any idea on the following failure of the arando patchbot ?\n> \n> ```\n> sage -t --long src/sage/sat/boolean_polynomials.py\n> **********************************************************************\n> File \"src/sage/sat/boolean_polynomials.py\", line 146, in sage.sat.boolean_polynomials.solve\n> Failed example:\n>     len(sls_aes)                                                                      # optional - cryptominisat, long time\n> Expected:\n>     256\n> Got:\n>     18\n> **********************************************************************\n> 1 item had failures:\n>    1 of  41 in sage.sat.boolean_polynomials.solve\n>     [46 tests, 1 failure, 186.16 s]\n> ----------------------------------------------------------------------\n> sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed\n> ```\n\nI have a similar issue on a 32-bit VM. We should inspect further.",
    "created_at": "2019-05-28T19:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422274",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@fchapoton](#comment%3A7):
> by the way, any idea on the following failure of the arando patchbot ?
> 
> ```
> sage -t --long src/sage/sat/boolean_polynomials.py
> **********************************************************************
> File "src/sage/sat/boolean_polynomials.py", line 146, in sage.sat.boolean_polynomials.solve
> Failed example:
>     len(sls_aes)                                                                      # optional - cryptominisat, long time
> Expected:
>     256
> Got:
>     18
> **********************************************************************
> 1 item had failures:
>    1 of  41 in sage.sat.boolean_polynomials.solve
>     [46 tests, 1 failure, 186.16 s]
> ----------------------------------------------------------------------
> sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed
> ```

I have a similar issue on a 32-bit VM. We should inspect further.



---

archive/issue_events_372439.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2019-05-28T19:57:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372439"
}
```



---

archive/issue_events_372440.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2019-05-28T19:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372440"
}
```



---

archive/issue_comments_422275.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI re-checked: the problem was already here on 5.6.6, but not on 5.0.1.",
    "created_at": "2019-05-28T20:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422275",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:9" align="right">comment:9</div>

I re-checked: the problem was already here on 5.6.6, but not on 5.0.1.



---

archive/issue_comments_422276.json:
```json
{
    "body": "Changed commit from **[`3a89fb2`](https://github.com/sagemath/sagetrac-mirror/commit/3a89fb243abcb77535ca5966944e0492739866e2)** to **[`d219646`](https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3)**",
    "created_at": "2019-06-14T09:21:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422276",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3a89fb2`](https://github.com/sagemath/sagetrac-mirror/commit/3a89fb243abcb77535ca5966944e0492739866e2)** to **[`d219646`](https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3)**



---

archive/issue_comments_422277.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3\"><code>d219646</code></a></td><td><code>update cryptominisat to 5.6.8</code></td></tr></table>\n",
    "created_at": "2019-06-14T09:21:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422277",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3"><code>d219646</code></a></td><td><code>update cryptominisat to 5.6.8</code></td></tr></table>




---

archive/issue_comments_422278.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI have made the necessary changes for python3-compatible doctests (because one cannot compare dicts in python3)\n\nI have also replaced `eqs = map(R, eqs)` by list comprehension in the line before the failing doctest in `src/sage/sat/boolean_polynomials.py`.",
    "created_at": "2019-06-14T09:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422278",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">comment:11</div>

I have made the necessary changes for python3-compatible doctests (because one cannot compare dicts in python3)

I have also replaced `eqs = map(R, eqs)` by list comprehension in the line before the failing doctest in `src/sage/sat/boolean_polynomials.py`.



---

archive/issue_comments_422279.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422279",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_events_372441.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372441"
}
```



---

archive/issue_events_372442.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372442"
}
```



---

archive/issue_comments_422280.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThe result of the failing doctest on arando seems to be random, varying from 16 to 25.",
    "created_at": "2019-06-17T09:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422280",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

The result of the failing doctest on arando seems to be random, varying from 16 to 25.



---

archive/issue_comments_422281.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThierry, or somebody else, please have a look. This contains some changes that are required for py3-compatibility !\n\nMaybe we can still update, even if this does not fix the 32-bit doctest. But maybe it does ?",
    "created_at": "2019-06-27T09:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422281",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:14" align="right">comment:14</div>

Thierry, or somebody else, please have a look. This contains some changes that are required for py3-compatibility !

Maybe we can still update, even if this does not fix the 32-bit doctest. But maybe it does ?



---

archive/issue_events_372443.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-27T09:44:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372443"
}
```



---

archive/issue_events_372444.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-06-27T09:44:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372444"
}
```



---

archive/issue_comments_422282.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nDamn, now i have an issue building cryptominisat on 64 standard machine:\n\n```\n[ 94%] Linking CXX executable ../cryptominisat5\ncd /opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src/cmsat5-src && /opt/sagemath/sage-source/local/bin/cmake -E cmake_link_script CMakeFiles/cryptominisat5-bin.dir/link.txt --verbose=ON\n/usr/bin/g++  -std=gnu++11   -mtune=native -Wall -Wextra -Wunused -Wsign-compare -fno-omit-frame-pointer -Wtype-limits -Wuninitialized -Wno-deprecated -Wstrict-aliasing -Wpointer-arith -Wpointer-arith -Wformat-nonliteral -Winit-self -Wparentheses -Wunreachable-code -ggdb3 -Wlogical-op -Wnull-dereference -Wdouble-promotion -Wshadow -Wformat=2 -pedantic   -L/opt/sagemath/sage-source/local/lib -Wl,-rpath,/opt/sagemath/sage-source/local/lib -O2 -Wl,--discard-all -Wl,--build-id=sha1 -rdynamic CMakeFiles/cryptominisat5-bin.dir/main.cpp.o CMakeFiles/cryptominisat5-bin.dir/main_exe.cpp.o CMakeFiles/cryptominisat5-bin.dir/signalcode.cpp.o  -o ../cryptominisat5 -Wl,-rpath,/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src/lib: ../lib/libcryptominisat5.so.5.6 /usr/lib/x86_64-linux-gnu/libz.so /usr/lib/x86_64-linux-gnu/libboost_program_options.so /opt/sagemath/sage-source/local/lib/libm4ri.so -pthread \n/opt/sagemath/sage-source/local/lib/libpng16.so.16: undefined reference to `inflateValidate@ZLIB_1.2.9'\ncollect2: error: ld returned 1 exit status\ncmsat5-src/CMakeFiles/cryptominisat5-bin.dir/build.make:117: recipe for target 'cryptominisat5' failed\nmake[4]: *** [cryptominisat5] Error 1\nmake[4]: Leaving directory '/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src'\nCMakeFiles/Makefile2:197: recipe for target 'cmsat5-src/CMakeFiles/cryptominisat5-bin.dir/all' failed\nmake[3]: *** [cmsat5-src/CMakeFiles/cryptominisat5-bin.dir/all] Error 2\nmake[3]: Leaving directory '/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src'\nMakefile:129: recipe for target 'all' failed\nmake[2]: *** [all] Error 2\nmake[2]: Leaving directory '/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src'\n********************************************************************************\nError building cryptominisat-5.6.8\n```\n\nLet me rebuild `libpng` in case.",
    "created_at": "2019-06-28T11:42:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422282",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:15" align="right">comment:15</div>

Damn, now i have an issue building cryptominisat on 64 standard machine:

```
[ 94%] Linking CXX executable ../cryptominisat5
cd /opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src/cmsat5-src && /opt/sagemath/sage-source/local/bin/cmake -E cmake_link_script CMakeFiles/cryptominisat5-bin.dir/link.txt --verbose=ON
/usr/bin/g++  -std=gnu++11   -mtune=native -Wall -Wextra -Wunused -Wsign-compare -fno-omit-frame-pointer -Wtype-limits -Wuninitialized -Wno-deprecated -Wstrict-aliasing -Wpointer-arith -Wpointer-arith -Wformat-nonliteral -Winit-self -Wparentheses -Wunreachable-code -ggdb3 -Wlogical-op -Wnull-dereference -Wdouble-promotion -Wshadow -Wformat=2 -pedantic   -L/opt/sagemath/sage-source/local/lib -Wl,-rpath,/opt/sagemath/sage-source/local/lib -O2 -Wl,--discard-all -Wl,--build-id=sha1 -rdynamic CMakeFiles/cryptominisat5-bin.dir/main.cpp.o CMakeFiles/cryptominisat5-bin.dir/main_exe.cpp.o CMakeFiles/cryptominisat5-bin.dir/signalcode.cpp.o  -o ../cryptominisat5 -Wl,-rpath,/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src/lib: ../lib/libcryptominisat5.so.5.6 /usr/lib/x86_64-linux-gnu/libz.so /usr/lib/x86_64-linux-gnu/libboost_program_options.so /opt/sagemath/sage-source/local/lib/libm4ri.so -pthread 
/opt/sagemath/sage-source/local/lib/libpng16.so.16: undefined reference to `inflateValidate@ZLIB_1.2.9'
collect2: error: ld returned 1 exit status
cmsat5-src/CMakeFiles/cryptominisat5-bin.dir/build.make:117: recipe for target 'cryptominisat5' failed
make[4]: *** [cryptominisat5] Error 1
make[4]: Leaving directory '/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src'
CMakeFiles/Makefile2:197: recipe for target 'cmsat5-src/CMakeFiles/cryptominisat5-bin.dir/all' failed
make[3]: *** [cmsat5-src/CMakeFiles/cryptominisat5-bin.dir/all] Error 2
make[3]: Leaving directory '/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src'
Makefile:129: recipe for target 'all' failed
make[2]: *** [all] Error 2
make[2]: Leaving directory '/opt/sagemath/sage-source/local/var/tmp/sage/build/cryptominisat-5.6.8/src'
********************************************************************************
Error building cryptominisat-5.6.8
```

Let me rebuild `libpng` in case.



---

archive/issue_comments_422283.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI still have the issue after rebuilding `libpng` (and a large part of Sage). Note that i merged with Sage 8.8, could the problem be related to #27186 ?",
    "created_at": "2019-07-05T07:50:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422283",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:16" align="right">comment:16</div>

I still have the issue after rebuilding `libpng` (and a large part of Sage). Note that i merged with Sage 8.8, could the problem be related to #27186 ?



---

archive/issue_comments_422284.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThis looks like an attempt to update, rather than a full re-build after `make distclean`.\n\nNow Sage will try using libpng from your system. Blindly doing `./sage -f libpng` might actually be breaking your build, if it is not followed by `./configure`.\nIn any event, this is one of significant changes to configure, and all bets are off whether `make distclean` is needed. \n\nCould you try uninstalling `libpng` ? (`make libpng-clean`), then `./configure`\nand see whether `libpng` is picked from the system or not?",
    "created_at": "2019-07-05T08:42:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422284",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

This looks like an attempt to update, rather than a full re-build after `make distclean`.

Now Sage will try using libpng from your system. Blindly doing `./sage -f libpng` might actually be breaking your build, if it is not followed by `./configure`.
In any event, this is one of significant changes to configure, and all bets are off whether `make distclean` is needed. 

Could you try uninstalling `libpng` ? (`make libpng-clean`), then `./configure`
and see whether `libpng` is picked from the system or not?



---

archive/issue_comments_422285.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nthe update works for me on the 8.8.bera1, on Gentoo Linux",
    "created_at": "2019-07-05T10:13:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422285",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

the update works for me on the 8.8.bera1, on Gentoo Linux



---

archive/issue_comments_422286.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@dimpase](#comment%3A17):\n> This looks like an attempt to update, rather than a full re-build after `make distclean`.\n> \n> Now Sage will try using libpng from your system. Blindly doing `./sage -f libpng` might actually be breaking your build, if it is not followed by `./configure`.\n> In any event, this is one of significant changes to configure, and all bets are off whether `make distclean` is needed. \n> \n> Could you try uninstalling `libpng` ? (`make libpng-clean`), then `./configure`\n> and see whether `libpng` is picked from the system or not?\n\nI will give a try, but it should also work with the `libpng` provided by Sage.",
    "created_at": "2019-07-05T13:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422286",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@dimpase](#comment%3A17):
> This looks like an attempt to update, rather than a full re-build after `make distclean`.
> 
> Now Sage will try using libpng from your system. Blindly doing `./sage -f libpng` might actually be breaking your build, if it is not followed by `./configure`.
> In any event, this is one of significant changes to configure, and all bets are off whether `make distclean` is needed. 
> 
> Could you try uninstalling `libpng` ? (`make libpng-clean`), then `./configure`
> and see whether `libpng` is picked from the system or not?

I will give a try, but it should also work with the `libpng` provided by Sage.



---

archive/issue_comments_422287.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThierry, I have troubles with the patchbot server. Could you please phone me ?\n\nReplying to [@sagetrac-tmonteil](#comment%3A19):\n\n> Replying to [@dimpase](#comment%3A17):\n> > This looks like an attempt to update, rather than a full re-build after `make distclean`.\n> > \n> > Now Sage will try using libpng from your system. Blindly doing `./sage -f libpng` might actually be breaking your build, if it is not followed by `./configure`.\n> > In any event, this is one of significant changes to configure, and all bets are off whether `make distclean` is needed. \n> > \n> > Could you try uninstalling `libpng` ? (`make libpng-clean`), then `./configure`\n> > and see whether `libpng` is picked from the system or not?\n\n> \n> I will give a try, but it should also work with the `libpng` provided by Sage.",
    "created_at": "2019-07-05T13:14:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422287",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

Thierry, I have troubles with the patchbot server. Could you please phone me ?

Replying to [@sagetrac-tmonteil](#comment%3A19):

> Replying to [@dimpase](#comment%3A17):
> > This looks like an attempt to update, rather than a full re-build after `make distclean`.
> > 
> > Now Sage will try using libpng from your system. Blindly doing `./sage -f libpng` might actually be breaking your build, if it is not followed by `./configure`.
> > In any event, this is one of significant changes to configure, and all bets are off whether `make distclean` is needed. 
> > 
> > Could you try uninstalling `libpng` ? (`make libpng-clean`), then `./configure`
> > and see whether `libpng` is picked from the system or not?

> 
> I will give a try, but it should also work with the `libpng` provided by Sage.



---

archive/issue_comments_422288.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nwell, I can guess what happens with libpng. We have now a check that if system libpng is available then system zlib is used, and it need not be compatible with Sage's libpng.\n\nIf you override this and force-install libpng in Sage then for some reason a compatible zlib doesn't get installed, and we see this error (which should be fixable by manually installing Sage's zlib)",
    "created_at": "2019-07-05T14:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422288",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

well, I can guess what happens with libpng. We have now a check that if system libpng is available then system zlib is used, and it need not be compatible with Sage's libpng.

If you override this and force-install libpng in Sage then for some reason a compatible zlib doesn't get installed, and we see this error (which should be fixable by manually installing Sage's zlib)



---

archive/issue_comments_422289.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAs I noted over in #27186, libpng won't even use `inflateValidate` unless the zlib headers are new enough to have it. Note that Sage's zlib does have `inflateValidate`. If I had to guess, this error,\n\n```\n/opt/sagemath/sage-source/local/lib/libpng16.so.16: undefined reference to `inflateValidate@ZLIB_1.2.9'\n```\n\nsuggests to me that (Sage's) libpng was built against new headers that do have `inflateValidate`, and then linked against an older (system) copy of zlib that doesn't have `inflateValidate`.\n\nWe'll need the gory details of your libpng build, including the header/library search path used during the build. (If I knew how to get those off the top of my head I'd be telling you how to do it; I'll need to come back to this when I have some free time.)",
    "created_at": "2019-07-05T15:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422289",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:22" align="right">comment:22</div>

As I noted over in #27186, libpng won't even use `inflateValidate` unless the zlib headers are new enough to have it. Note that Sage's zlib does have `inflateValidate`. If I had to guess, this error,

```
/opt/sagemath/sage-source/local/lib/libpng16.so.16: undefined reference to `inflateValidate@ZLIB_1.2.9'
```

suggests to me that (Sage's) libpng was built against new headers that do have `inflateValidate`, and then linked against an older (system) copy of zlib that doesn't have `inflateValidate`.

We'll need the gory details of your libpng build, including the header/library search path used during the build. (If I knew how to get those off the top of my head I'd be telling you how to do it; I'll need to come back to this when I have some free time.)



---

archive/issue_events_372445.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2019-07-09T00:37:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372445"
}
```



---

archive/issue_events_372446.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2019-07-09T00:37:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372446"
}
```



---

archive/issue_events_372447.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-10T01:31:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372447"
}
```



---

archive/issue_events_372448.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a0cc8896b06c3303ca86b113b7e1786432eea4ae",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-07-10T01:31:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/27319#event-372448"
}
```



---

archive/issue_comments_422290.json:
```json
{
    "body": "Changed branch from **[u/chapoton/27319](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27319)** to **[`d219646`](https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3)**",
    "created_at": "2019-07-10T01:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/27319",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/27319#issuecomment-422290",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/27319](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/27319)** to **[`d219646`](https://github.com/sagemath/sagetrac-mirror/commit/d219646cd4dec96a1b4e53cce1f14aa9905377c3)**
