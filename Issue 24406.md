# Issue 24406: fix linking of Flint on Solaris

Issue created by migration from Trac.

Original creator: dimpase

Original creation time: 2018-02-02 11:38:35

On #24596, we see (on SPARC Solaris 11)

```
ImportError: ld.so.1: python2.7: fatal: libflint.so.13: open failed: No such file or directory
```



---

Comment by jdemeyer created at 2018-02-02 15:09:07

So FLINT doesn't use libtool? This is yet another good example of why writing your own build system is doomed to fail.


---

Comment by dimpase created at 2018-02-02 16:32:04

indeed.


---

Comment by dimpase created at 2018-02-05 12:29:34

New commits:


---

Comment by dimpase created at 2018-02-05 12:29:34

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2018-02-05 19:21:42

Has this been reported upstream? The upstream bug report is not the same as the patch that you are adding here. By the way, why special case `FreeBSD` and `SunOS`? The patch seems written under the assumption that `ldconfig` will never on those systems. I think it's better to check anyway. So in other words, I have some doubts about this change:

```diff
+diff --git a/configure b/configure
+index 424ab0a..959a650 100755
+--- a/configure
++++ b/configure
+`@``@` -450,7 +450,7 `@``@` fi
+ 
+ # sometimes LDCONFIG is not to be found in the path. Look at some common places.
+ case "$OS" in
+-   MINGW*|CYGWIN*|Darwin)
++   MINGW*|CYGWIN*|Darwin|FreeBSD|SunOS)
+       LDCONFIG="true";;
+    *)
+       if [ -z "$LDCONFIG" ]; then
```

The rest of the patch looks reasonable.


---

Comment by dimpase created at 2018-02-05 19:53:33

The extended commit message explains:

```
backported from https://github.com/wbhart/flint2/commit/6a9fb5340828918707ab9aadb5f842fb1a1e5952
with adding SunOS to the list of OSes needing special treatment in
line 506 (on upstream branch) of configure.
```


I have not yet proposed to upstream adding SunOS


---

Comment by jdemeyer created at 2018-02-05 21:02:56

I would like to try the exact upstream commit without special-casing for SunOS.


---

Comment by jdemeyer created at 2018-02-05 21:04:02

Replying to [comment:6 dimpase]:
> The extended commit message

That information belongs in the patch, not the commit message.


---

Comment by dimpase created at 2018-02-05 21:41:27

Replying to [comment:7 jdemeyer]:
> I would like to try the exact upstream commit without special-casing for SunOS.

The exact upstream commit does not apply, as it is few dozens commits later than our MPIR. So it needs rebasing. 
The difference between the rebased upstream commit and this patch is as follows:

```
+-   MINGW*|CYGWIN*|Darwin|FreeBSD)
++   MINGW*|CYGWIN*|Darwin|FreeBSD|SunOS)
```


So you may try removing this chunk, if you must...

In turn, the upstream commit is merging my pull request:
https://github.com/wbhart/flint2/pull/347
which was addressing the same sort of issue on FreeBSD.
And indeed it was needed to go from `MINGW*|CYGWIN*|Darwin)` to
`MINGW*|CYGWIN*|Darwin|FreeBSD)` in the very same place.


---

Comment by dimpase created at 2018-02-05 21:42:07

Replying to [comment:8 jdemeyer]:
> Replying to [comment:6 dimpase]:
> > The extended commit message
> 
> That information belongs in the patch, not the commit message.
the commit message is a part of the patch/branch, isn't it?
(just click on the commit hyperlink in comment 4, and you see it here)


---

Comment by jdemeyer created at 2018-02-05 22:07:05

Replying to [comment:10 dimpase]:
> the commit message is a part of the patch/branch, isn't it?

Yes but it serves a different purpose. The commit message is only relevant at the time of merging the commit for example. It doesn't reflect possible future insights.


---

Comment by jdemeyer created at 2018-02-05 22:07:05

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2018-02-05 22:07:19

Replying to [comment:9 dimpase]:
> So you may try removing this chunk, if you must...
I will (to be precise: not without that complete hunk, just adding only `FreeBSD` like the upstream patch)


---

Comment by jdemeyer created at 2018-02-05 22:08:39

Also, the version of FLINT should be increased.


---

Comment by dimpase created at 2018-02-05 23:55:32

Replying to [comment:5 jdemeyer]:
> Has this been reported upstream? The upstream bug report is not the same as the patch that you are adding here. By the way, why special case `FreeBSD` and `SunOS`?

On FreeBSD ldconfig does not accept the option `-n`, it needs `-m` or something like this. 
That's why it's necessary to special-case FreeBSD.


---

Comment by git created at 2018-02-06 00:02:44

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2018-02-06 00:03:33

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2018-02-07 10:56:00

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-02-09 23:47:23

Resolution: fixed
