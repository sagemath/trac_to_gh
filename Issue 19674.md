# Issue 19674: Update to gap-4.8.1

Issue created by migration from https://trac.sagemath.org/ticket/19911

Original creator: vbraun

Original creation time: 2016-01-18 17:12:39

CC:  dimpase fbissey




---

Comment by jdemeyer created at 2016-01-18 17:25:34

Duplicate of #19900?


---

Comment by git created at 2016-01-18 17:51:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-01-18 17:57:36

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2016-01-18 17:58:02

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2016-01-19 00:50:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2016-01-19 00:51:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-01-19 01:16:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-01-19 01:22:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-01-19 01:25:50

Changing type from PLEASE CHANGE to defect.


---

Comment by vbraun created at 2016-01-19 01:25:50

Changing component from PLEASE CHANGE to group theory.


---

Comment by vbraun created at 2016-01-19 01:26:58

Changing status from new to needs_review.


---

Comment by dimpase created at 2016-01-19 07:04:58

lib gap does not build on OSX

```
...
duplicate symbol _libGAP_RealExecStatFuncs in:
    .libs/libgap_la-stats.o
    .libs/libgap_la-profile.o
ld: 1 duplicate symbol for architecture x86_64
collect2: error: ld returned 1 exit status
make[4]: *** [libgap.la] Error 1
make[3]: *** [all] Error 2
make[2]: *** [all-recursive] Error 1
Error building libGAP.
```



---

Comment by dimpase created at 2016-01-19 07:04:58

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2016-01-19 07:24:03

In fact, it's not that we turn something `static` into public.
These two things are duly present in the GAP source. 

```
$ grep RealExecStatFuncs *
profile.c:UInt (* RealExecStatFuncs[256]) ( Stat stat );
profile.c:  RealExecStatFuncs[pos] = stat;
profile.c:  return RealExecStatFuncs[TNUM_STAT(stat)](stat);
profile.c:    ExecStatFuncs[i] = RealExecStatFuncs[i];
stats.c:UInt (* RealExecStatFuncs[256]) ( Stat stat );
stats.c:    ExecStatFuncs[i] = RealExecStatFuncs[i];
stats.c:            RealExecStatFuncs[i] = ExecStatFuncs[i];
```



---

Comment by dimpase created at 2016-01-19 07:42:49

I just opened https://github.com/gap-system/gap/issues/495 about it.


---

Comment by git created at 2016-01-19 10:46:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2016-01-19 12:55:26

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2016-03-07 15:01:06

FYI - GAP is at 4.8.2 http://www.gap-system.org/Releases/4.8.2.html


---

Comment by dimpase created at 2016-03-07 15:06:14

Sure, and there will be 4.8.3 very soon (this month). I'd wait for it...


---

Comment by vbraun created at 2016-03-26 15:45:37

Changing status from positive_review to needs_info.


---

Comment by vbraun created at 2016-03-26 15:45:37

Do you have a branch for 4.8.3?


---

Comment by dimpase created at 2016-03-26 16:09:39

Replying to [comment:22 vbraun]:
> Do you have a branch for 4.8.3?
no


---

Comment by git created at 2016-03-27 12:23:46

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2016-03-27 13:05:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-03-27 14:12:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-03-27 14:12:42

Changing status from needs_info to needs_review.


---

Comment by dimpase created at 2016-03-27 20:40:41

do you have the tarballs somewhere?


---

Comment by vbraun created at 2016-03-27 21:49:02

They are on the mirrors now


---

Comment by dimpase created at 2016-03-29 10:03:39

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2016-03-29 10:03:39

`gap_packages` does not build, as  guava version is now 3.13, its patches fail, probably need a review, etc.


---

Comment by dimpase created at 2016-03-29 18:53:23

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2016-03-29 18:53:23

here is the guava fix. works now, it seems
----
New commits:


---

Comment by dimpase created at 2016-03-29 21:35:15

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2016-03-29 21:35:15

ran ptestlong: got

```
sage -t --long --warn-long 71.3 src/sage/tests/gap_packages.py
**********************************************************************
File "src/sage/tests/gap_packages.py", line 8, in sage.tests.gap_packages
Failed example:
    test_packages(pkgs, only_failures=True)    # optional - gap_packages
Expected:
      Status    Package    GAP Output
    +---------+----------+------------+
      Failure   HAPcryst   fail
Got:
      Status    Package    GAP Output
    +---------+----------+------------+
      Failure   HAPcryst   fail
      Failure   Hap        fail
**********************************************************************
```

and 

```
sage -t --long --warn-long 71.3 src/sage/groups/perm_gps/permgroup.py  # 19 doctests failed
```

all seemingly due to borked Hap.


---

Comment by dimpase created at 2016-03-29 21:47:49

The reason for Hap failing is that it depends on `CrystCat` in this release, and the latter in turn depends on `Cryst`.

These two are GAP-code only, thus trivial to add. Let me do this...


---

Comment by vbraun created at 2016-03-29 22:26:28

Oops hadn't realized you fixed it


---

Comment by dimpase created at 2016-03-29 22:28:24

and now gap_packages/spkg-src does not quite work, as cryst is prefix of crystcat :-)
----
New commits:


---

Comment by dimpase created at 2016-03-29 22:57:57

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2016-03-29 22:57:57

fixed tarball:

http://users.ox.ac.uk/~coml0531/sage/gap_packages-4.8.3.tar.bz2
----
New commits:


---

Comment by git created at 2016-03-29 23:01:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-03-30 07:18:01

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-03-30 14:05:34

Resolution: fixed


---

Comment by fbissey created at 2016-03-31 23:06:23

Note for a follow up: `atlasrep` is in both `database_gap` and `gap_packages` may be we should decide one way or another which one it belongs too.


---

Comment by fbissey created at 2016-03-31 23:23:00

Oups, `atlasrep` is in `database_gap`'s `spkg-src` but is not installed by its `spkg-install`. Definitely a follow up ticket.
