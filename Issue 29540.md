# Issue 29540: xgcd correct for padic polynomials

archive/issues_029540.json:
```json
{
    "body": "CC:  bhutz paulfili saraedum roed\n\nKeywords: gsoc20\n\nTicket #13439 states that xgcd is incorrect for padic polynomials. However, it appears that the issues in #13439 have been solved:\n\n\n```\nsage: R.<x> = Qp(3,3)[]\nsage: f = 3*x + 7\nsage: g = 5*x + 9\nsage: f.xgcd(f*g)[0].is_one()\nFalse\n\n\nsage: R.<x> = Qp(3)[]\nsage: f = 490473657*x + 257392844/729\nsage: g = 225227399/59049*x - 8669753175\nsage: f.xgcd(f*g)[0].is_one()\nFalse\n```\n\n\nTesting on 100,000 random polynomials gives the same results if the gcd is computed over QQ or Qp(5), see attached.\n\nWe therefore remove the warning.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29777\n\n",
    "created_at": "2020-06-01T16:15:12Z",
    "labels": [
        "padics",
        "minor",
        "enhancement"
    ],
    "title": "xgcd correct for padic polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29540",
    "user": "@EnderWannabe"
}
```
CC:  bhutz paulfili saraedum roed

Keywords: gsoc20

Ticket #13439 states that xgcd is incorrect for padic polynomials. However, it appears that the issues in #13439 have been solved:


```
sage: R.<x> = Qp(3,3)[]
sage: f = 3*x + 7
sage: g = 5*x + 9
sage: f.xgcd(f*g)[0].is_one()
False


sage: R.<x> = Qp(3)[]
sage: f = 490473657*x + 257392844/729
sage: g = 225227399/59049*x - 8669753175
sage: f.xgcd(f*g)[0].is_one()
False
```


Testing on 100,000 random polynomials gives the same results if the gcd is computed over QQ or Qp(5), see attached.

We therefore remove the warning.

Issue created by migration from https://trac.sagemath.org/ticket/29777





---

archive/issue_comments_419547.json:
```json
{
    "body": "Attachment [Untitled.ipynb](tarball://root/attachments/some-uuid/ticket29777/Untitled.ipynb) by @EnderWannabe created at 2020-06-01 16:15:52",
    "created_at": "2020-06-01T16:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419547",
    "user": "@EnderWannabe"
}
```

Attachment [Untitled.ipynb](tarball://root/attachments/some-uuid/ticket29777/Untitled.ipynb) by @EnderWannabe created at 2020-06-01 16:15:52



---

archive/issue_comments_419548.json:
```json
{
    "body": "if it's ready, you need to change the status to \"needs review\" and to fill the Authors field (above here) to your full name\n----\nNew commits:",
    "created_at": "2020-06-01T19:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419548",
    "user": "chapoton"
}
```

if it's ready, you need to change the status to "needs review" and to fill the Authors field (above here) to your full name
----
New commits:



---

archive/issue_comments_419549.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-01T19:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419549",
    "user": "@EnderWannabe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_419550.json:
```json
{
    "body": "I would check that the precision behavior works as expected, and make sure that it works over `Zp` not just `Qp`.",
    "created_at": "2020-06-01T19:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419550",
    "user": "roed"
}
```

I would check that the precision behavior works as expected, and make sure that it works over `Zp` not just `Qp`.



---

archive/issue_comments_419551.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-02T23:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419551",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419552.json:
```json
{
    "body": "Replying to [comment:4 roed]:\n> I would check that the precision behavior works as expected, and make sure that it works over `Zp` not just `Qp`.\n\nPrecision behavior works as expect, however low precision computations break over `Zp`:\n\n\n```\nsage: R.<x> = Zp(3,1)[]\nsage: f = 3*x + 7\nsage: g = 2*x + 3\nsage: f.gcd(f*g).is_one()\nTrue\n```\n\n\nTo fix this, we pass to Qp to do the computation and then clear denominators. This is done in the _xgcd_univariate_polynomial function under pAdicRingGeneric. Incidentally, this also implements xgcd for pAdic rings.\n\nAlso, the old gcd function in polynomial_padic_capped_relative_dense is removed, as it is no longer needed.",
    "created_at": "2020-06-02T23:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419552",
    "user": "@EnderWannabe"
}
```

Replying to [comment:4 roed]:
> I would check that the precision behavior works as expected, and make sure that it works over `Zp` not just `Qp`.

Precision behavior works as expect, however low precision computations break over `Zp`:


```
sage: R.<x> = Zp(3,1)[]
sage: f = 3*x + 7
sage: g = 2*x + 3
sage: f.gcd(f*g).is_one()
True
```


To fix this, we pass to Qp to do the computation and then clear denominators. This is done in the _xgcd_univariate_polynomial function under pAdicRingGeneric. Incidentally, this also implements xgcd for pAdic rings.

Also, the old gcd function in polynomial_padic_capped_relative_dense is removed, as it is no longer needed.



---

archive/issue_comments_419553.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-16T16:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419553",
    "user": "bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_419554.json:
```json
{
    "body": "I've been running of few of the examples in 13439 to see if those work now. For the most part I'm getting the correct answers. However, this seems weird\n\n\n```\nsage: R.<t> = ZpCA(7,20)[]\nsage: (t^3).gcd( t^5 )\n(1 + O(7^20))*t^3 + O(7^20)*t^2 + O(7^20)*t + O(7^20)\n```\n\n\n\n```\nsage: R.<t> = Zp(7,20)[]\nsage: (t^3).gcd( t^5 )\n(1 + O(7^20))*t^3\n```\n\n\n\nA few other minor things\n\n- you need INPUT and OUTPUT blocks\n\n- why do you need args and kwds   (also note the standard spelling of kwds)\n\n- you can use self instead of arg[0]\n\n- first line description of function should end in a period.",
    "created_at": "2020-06-16T16:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419554",
    "user": "bhutz"
}
```

I've been running of few of the examples in 13439 to see if those work now. For the most part I'm getting the correct answers. However, this seems weird


```
sage: R.<t> = ZpCA(7,20)[]
sage: (t^3).gcd( t^5 )
(1 + O(7^20))*t^3 + O(7^20)*t^2 + O(7^20)*t + O(7^20)
```



```
sage: R.<t> = Zp(7,20)[]
sage: (t^3).gcd( t^5 )
(1 + O(7^20))*t^3
```



A few other minor things

- you need INPUT and OUTPUT blocks

- why do you need args and kwds   (also note the standard spelling of kwds)

- you can use self instead of arg[0]

- first line description of function should end in a period.



---

archive/issue_comments_419555.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-17T19:13:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419555",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419556.json:
```json
{
    "body": "Replying to [comment:8 bhutz]:\n>However, this seems weird\n> \n> {{{\n> sage: R.<t> = ZpCA(7,20)[]\n> sage: (t^3).gcd( t^5 )\n> (1 + O(7<sup>20))*t</sup>3 + O(7<sup>20)*t</sup>2 + O(7^20)*t + O(7^20)\n> }}}\n\nApparently that is t^3:\n\n\n```\nsage: (t^3).gcd( t^5 ) == t^3\nTrue\n```\n\n\n> - you need INPUT and OUTPUT blocks\n\nDone!\n\n> - why do you need args and kwds   (also note the standard spelling of kwds)\n\nRemoved!\n\n> - first line description of function should end in a period.\n\nDone!",
    "created_at": "2020-06-17T19:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419556",
    "user": "@EnderWannabe"
}
```

Replying to [comment:8 bhutz]:
>However, this seems weird
> 
> {{{
> sage: R.<t> = ZpCA(7,20)[]
> sage: (t^3).gcd( t^5 )
> (1 + O(7<sup>20))*t</sup>3 + O(7<sup>20)*t</sup>2 + O(7^20)*t + O(7^20)
> }}}

Apparently that is t^3:


```
sage: (t^3).gcd( t^5 ) == t^3
True
```


> - you need INPUT and OUTPUT blocks

Done!

> - why do you need args and kwds   (also note the standard spelling of kwds)

Removed!

> - first line description of function should end in a period.

Done!



---

archive/issue_comments_419557.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-19T19:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419557",
    "user": "@EnderWannabe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_419558.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-22T18:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419558",
    "user": "bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_419559.json:
```json
{
    "body": "I've pushed a branch with two minor doc fixes. However, I'm getting some doctest errors\n\n\n```\nFile \"src/sage/rings/padics/generic_nodes.py\", line 776, in sage.rings.padics.generic_nodes.pAdicRingGeneric._xgcd_univariate_polynomial\nFailed example:\n    f.xgcd(f*g)\nExpected:\n    ((3 + O(3^4))*x + 1 + 2*3 + O(3^3), 0, 1 + O(3^3))\nGot:\n    ((3 + O(3^4))*x + 1 + 2*3 + O(3^3), 1 + O(3^3), 0)\n```\n\n\n\n```\nFile \"src/sage/rings/padics/generic_nodes.py\", line 782, in sage.rings.padics.generic_nodes.pAdicRingGeneric._xgcd_univariate_polynomial\nFailed example:\n    f.xgcd(f*g)\nExpected:\n    ((3^9 + O(3^29))*x + 2 + 2*3 + 3^2 + 2*3^5 + 3^6 + 3^7 + 3^8 + 3^10 + 3^11 + 2*3^13 + 3^14 + 3^16 + 2*3^19 + O(3^20), 0, 1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 3^7 + 2*3^8 + 2*3^10 + 2*3^12 + 3^13 + 3^14 + 3^15 + 2*3^17 + 3^18 + O(3^20))\nGot:\n    ((3^9 + O(3^29))*x + 2 + 2*3 + 3^2 + 2*3^5 + 3^6 + 3^7 + 3^8 + 3^10 + 3^11 + 2*3^13 + 3^14 + 3^16 + 2*3^19 + O(3^20),\n     1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 3^7 + 2*3^8 + 2*3^10 + 2*3^12 + 3^13 + 3^14 + 3^15 + 2*3^17 + 3^18 + O(3^20),\n     0)\n```\n\n----\nNew commits:",
    "created_at": "2020-06-22T18:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419559",
    "user": "bhutz"
}
```

I've pushed a branch with two minor doc fixes. However, I'm getting some doctest errors


```
File "src/sage/rings/padics/generic_nodes.py", line 776, in sage.rings.padics.generic_nodes.pAdicRingGeneric._xgcd_univariate_polynomial
Failed example:
    f.xgcd(f*g)
Expected:
    ((3 + O(3^4))*x + 1 + 2*3 + O(3^3), 0, 1 + O(3^3))
Got:
    ((3 + O(3^4))*x + 1 + 2*3 + O(3^3), 1 + O(3^3), 0)
```



```
File "src/sage/rings/padics/generic_nodes.py", line 782, in sage.rings.padics.generic_nodes.pAdicRingGeneric._xgcd_univariate_polynomial
Failed example:
    f.xgcd(f*g)
Expected:
    ((3^9 + O(3^29))*x + 2 + 2*3 + 3^2 + 2*3^5 + 3^6 + 3^7 + 3^8 + 3^10 + 3^11 + 2*3^13 + 3^14 + 3^16 + 2*3^19 + O(3^20), 0, 1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 3^7 + 2*3^8 + 2*3^10 + 2*3^12 + 3^13 + 3^14 + 3^15 + 2*3^17 + 3^18 + O(3^20))
Got:
    ((3^9 + O(3^29))*x + 2 + 2*3 + 3^2 + 2*3^5 + 3^6 + 3^7 + 3^8 + 3^10 + 3^11 + 2*3^13 + 3^14 + 3^16 + 2*3^19 + O(3^20),
     1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 3^7 + 2*3^8 + 2*3^10 + 2*3^12 + 3^13 + 3^14 + 3^15 + 2*3^17 + 3^18 + O(3^20),
     0)
```

----
New commits:



---

archive/issue_comments_419560.json:
```json
{
    "body": "As saraedum has kindly pointed out, xgcd is still broken. So, we change the scope of the ticket to implementing the (broken) xgcd for padic rings, and re add the warning.\n----\nNew commits:",
    "created_at": "2020-06-26T20:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419560",
    "user": "@EnderWannabe"
}
```

As saraedum has kindly pointed out, xgcd is still broken. So, we change the scope of the ticket to implementing the (broken) xgcd for padic rings, and re add the warning.
----
New commits:



---

archive/issue_comments_419561.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-07-01T18:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419561",
    "user": "@EnderWannabe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_419562.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-07-08T17:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419562",
    "user": "bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_419563.json:
```json
{
    "body": "Functionality wise, this ticket is fine with the adjusted scope.\n\nI'm marking it as needs-works just to have you update the title/description to match the new scope.",
    "created_at": "2020-07-08T17:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419563",
    "user": "bhutz"
}
```

Functionality wise, this ticket is fine with the adjusted scope.

I'm marking it as needs-works just to have you update the title/description to match the new scope.



---

archive/issue_comments_419564.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-07-13T20:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419564",
    "user": "@EnderWannabe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_419565.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-14T18:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419565",
    "user": "bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_419566.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-28T22:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29540#issuecomment-419566",
    "user": "vbraun"
}
```

Resolution: fixed
