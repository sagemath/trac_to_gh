# Issue 23876: Add test for cactus graph

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2017-10-26 12:49:01

CC:  dcoudert

This patch adds a function to check if a graph is cactus graph.



---

Comment by jmantysalo created at 2017-10-26 12:49:50

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2017-10-26 12:49:50

New commits:


---

Comment by dcoudert created at 2017-10-26 13:12:09

Why are you testing if the graph is circular planar ? This is much more expensive than the other tests.

Make `cutverts` a set to speed up the test `v not in cutverts`.

In the examples/tests, you could take a 2 x 3 grid graph. Removing any edge, you get a cactus.

The empty graph is a cactus.

Loops are of course allowed here, but what about multiple edges ?


---

Comment by git created at 2017-10-26 13:15:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2017-10-26 13:19:19

Replying to [comment:3 dcoudert]:
> Why are you testing if the graph is circular planar ? This is much more expensive than the other tests.

See the last test `Graph('Fli`@`?')`, it will fail if you remove the test for circular planarity.

> Make `cutverts` a set to speed up the test `v not in cutverts`.

Good point, done.

> In the examples/tests, you could take a 2 x 3 grid graph. Removing any edge, you get a cactus.

Hmm... At least some example with "tail" would be good.

> The empty graph is a cactus.

?? By this function, yes. Should it be? It is tested.

> Loops are of course allowed here, but what about multiple edges ?

I don't know. Maybe just `_scream_if_not_simple()`?


---

Comment by dcoudert created at 2017-10-26 13:27:32

> > Why are you testing if the graph is circular planar ? This is much more expensive than the other tests.
> 
> See the last test `Graph('Fli`@`?')`, it will fail if you remove the test for circular planarity.

Right, but can we think to a faster test ?

> > The empty graph is a cactus.
> 
> ?? By this function, yes. Should it be? It is tested.

I don't know if it should be, but it is what your method answers.

> > Loops are of course allowed here, but what about multiple edges ?
> I don't know. Maybe just `_scream_if_not_simple()`?
that would ease the stuff


---

Comment by git created at 2017-10-27 08:35:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2017-10-27 08:49:43

Changing status from needs_review to needs_work.


---

Comment by jmantysalo created at 2017-10-27 08:49:43

First, this does not work. See `Graph('Gx?HxC')`. My bad.

I added an example and check for being simple.

As the empty graph already is, say, planar, I see no reason not to define it as cactus too.

Then, about the speed... Testing for planarity is `O(n)`, as is adding the universal vertex to check being outer planar. We can assume that the graph is very sparse, as we can first check if there are so many edges that the graph can not be cactus. We should start from a vertex of degree at least three, make a circuit and remove edges in the circuit. Then... duh, back to the drawing board.


---

Comment by dcoudert created at 2017-10-27 16:24:42

OK.

Could you add in file `isgci.py` the line

```
graph_classes.Cactus = GraphClass("Cactus", "gc_108", recognition_function = lambda x:x.is_cactus())
```

[http://www.graphclasses.org/classes/gc_108.html](http://www.graphclasses.org/classes/gc_108.html)


---

Comment by git created at 2017-10-27 17:56:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2017-10-27 20:59:30

Perfect.


---

Comment by dcoudert created at 2017-10-27 20:59:30

Changing status from needs_work to positive_review.


---

Comment by jmantysalo created at 2017-10-28 05:32:13

No no! It still does not work, I just added the entry to isgsi that should be added in any case.


---

Comment by jmantysalo created at 2017-10-28 05:32:13

Changing status from positive_review to needs_work.


---

Comment by dcoudert created at 2017-10-28 08:44:25

OK, let's go back to the definitions.

In a cactus graph, a biconnected component is either a cycle or a bridge.
Now, consider the faces of the graph (`self.faces()`). We must have one face containing all vertices, and then each block that is not a bridge must be a face. So the number of faces must be 1 plus the number of blocks of order > 2 (blocks that are not bridges). So we get:

```
    self._scream_if_not_simple()
    if not self.order():
        return True
    if not self.is_connected():
        return False
    B,C = self.blocks_and_cut_vertices()
    # the number of faces is 1 plus the number of blocks of order > 2
    return len(self.faces()) == sum(1 for b in B if len(b) > 2) + 1
```

Here I consider that a graph made of two cycles connected by a path is a cactus. If this is compatible with the definition (i.e., considering that a bridge is a C2), then above code do the job.


---

Comment by git created at 2017-10-28 16:22:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2017-10-28 16:26:43

Changing status from needs_work to needs_review.


---

Comment by jmantysalo created at 2017-10-28 16:26:43

I also did a test code with `blocks_and_cut_vertices`, checking that all blocks are cycles or single points. Here I used your code slightly modified.

Ready for review now.


---

Comment by dcoudert created at 2017-10-28 17:11:22

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2017-10-28 17:11:22

It's true that we can also check that each block is isomorphic to a cycle of the same order, but it's not needed. The current implementation do perfectly the job.

Good to go.


---

Comment by jmantysalo created at 2017-10-28 17:55:29

Replying to [comment:16 dcoudert]:

> Good to go.

So do we.

Would be nice exercise to make a faster function. If the function searching blocks founds just one block that is not cycle nor a single vertex, it could instantly return `False`.


---

Comment by dcoudert created at 2017-10-29 00:03:25

sure, but much more complex to code for a not so critical method.... would be better to speed up the `blocks_and_cut_vertices` and the `faces` methods.


---

Comment by vbraun created at 2017-11-01 18:07:25

Resolution: fixed
