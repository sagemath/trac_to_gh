# Issue 16890: Better format for %timeit

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2014-10-10 05:19:41

CC:  chapoton

After longer calculation instead of "CPU time: 12345.67 s" it would be nice to have "CPU time: 3:25:45 (12345.67 s)" or something similar.



---

Comment by kcrisman created at 2014-12-11 15:33:40

Changing priority from trivial to minor.


---

Comment by kcrisman created at 2014-12-11 15:33:40

Changing component from notebook to interfaces.


---

Comment by kcrisman created at 2014-12-11 15:33:40

This is either an upstream IPython request (for `%timeit`) or a request for the `timeit()` Sage command to improve, perhaps both.  I do agree the format could be better (perhaps it is already?).


---

Comment by jmantysalo created at 2014-12-12 07:13:49

Replying to [comment:1 kcrisman]:
> This is either an upstream IPython request (for `%timeit`) - -

What about sagenb? Isn't it still used?


---

Comment by kcrisman created at 2014-12-12 14:15:52

Sure it is, but the point is that the formatting comes from IPython, not sagenb.


---

Comment by jmantysalo created at 2015-06-02 08:33:08

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2015-06-02 08:33:08

Replying to [comment:3 kcrisman]:
> Sure it is, but the point is that the formatting comes from IPython, not sagenb.

OK, then I think that this can be closed from sage-trac. Change to positiv_review if you agree.


---

Comment by kcrisman created at 2015-06-02 13:48:56

Well, would you like to turn this into a request that upstream have format options?  You don't necessarily have to submit the upstream request yourself, though that would be good.  Then this becomes a place to track that response, and eventually to merge a new Ipython package.


---

Comment by jmantysalo created at 2015-06-03 08:06:45

Hmm... Where? I did not see trac or something similar in IPython. (But I may be blind.)

This is somewhat complicated. SageNB uses IPython, but the user can choose to use IPython (directly?) instead? Confused am I.


---

Comment by kcrisman created at 2015-06-03 13:51:00

I guess maybe I'm confused too.  Can you give _exactly_ the use case that you are currently doing?


---

Comment by kcrisman created at 2015-06-03 13:51:00

Changing status from needs_review to needs_info.


---

Comment by jmantysalo created at 2015-06-03 17:49:00

Replying to [comment:7 kcrisman]:
> Can you give _exactly_ the use case that you are currently doing?

?? Just run sage, run `notebook()` (at least on my machines it does not use ipython interface as default, but good old sagenb) and run any computation that takes few hours.


---

Comment by kcrisman created at 2015-06-03 18:08:37

I see what you mean now.  I wasn't thinking about the IPython notebook, just IPython proper.

And now I see also that https://github.com/sagemath/sagenb/issues/316 is (partly) about this (see also #15418).  I was mistaken that this uses IPython.  In https://github.com/sagemath/sagenb/blob/master/sagenb/notebook/worksheet.py we have

```
        if C.time() and not C.introspect():
            input += '; print "CPU time: %.2f s,  Wall time: %.2f s"%(cputime(__SAGE_t__), walltime(__SAGE_w__))\n'
```



---

Comment by jmantysalo created at 2015-06-07 08:26:42

Here is one suggestion for timeit format:


```
def human_readable(t):
    if t <= 100:
        print t, "seconds"
        return
    d = t//(24*60*60)
    h = (t-d*24*60*60)//(60*60)
    m = t%(60*60)//60
    s = t%60
    o=""
    if d >= 2:
        o += str(d)+" days "
    if d == 1:
        o += "1 day "
    if h >= 2:
        o += str(h)+" hours "
    if h == 1:
        o += "1 hour "
    if m >= 2:
        o += str(m)+" minutes "
    if m == 1:
        o += "1 minute "
    if s >= 2:
        o += str(s)+" seconds "
    if s == 1:
        o += "1 second "
    o += "("+str(t)+" seconds)"
    print o
```


For sure there are smarter way to do this. But first, what is "right" way to show time here?


---

Comment by kcrisman created at 2015-06-08 13:01:21

Changing component from interfaces to notebook.


---

Comment by kcrisman created at 2015-06-08 13:02:09

https://github.com/sagemath/sagenb/issues/344


---

Comment by mkoeppe created at 2020-08-18 00:36:52

Proposing to close all sagenb tickets as outdated, so that all remaining open tickets in the notebook component are about the Jupyter notebook.


---

Comment by mkoeppe created at 2020-08-18 00:36:52

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2020-09-01 15:48:04

Resolution: invalid
