# Issue 16230: Unhiding in a fully hidden Doubly-Linked List

Issue created by migration from https://trac.sagemath.org/ticket/16467

Original creator: foosterhof

Original creation time: 2014-06-11 09:30:15

CC:  rudi jakobkroeker

Keywords: doubly linked list unhide empty

An error occurs when in a fully hidden Doubly-Linked List an element is unhidden. All elements that come after it will also be unhidden.


```
l = sage.combinat.misc.DoublyLinkedList(xrange(5))
l.hide(0)
l.hide(1)
l.hide(2)
l.hide(3)
l.hide(4)
print l
l.unhide(1)
print l
l.hide(1)
print l
```



---

Comment by foosterhof created at 2014-06-11 12:55:58

This proposal is a revamp of the internal storage, to become an actual doubly linked list, in which elements that have not been defined at initialization can also be inserted and removed. A side effect that occurs, but that in my opinion should not be a problem, is that the order of the elements may change upon removal and re-insertion now.

I do not see this as a problem, as the Doubly Linked List abstract data type has no concept of maintenance of order.

New commits:


---

Comment by foosterhof created at 2014-06-11 12:55:58

Changing status from new to needs_review.


---

Comment by git created at 2014-06-11 15:31:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Rudi created at 2014-06-27 09:03:28

The following hangs:

```
l = sage.combinat.misc.DoublyLinkedList(xrange(5))
l.insert(0)
l
```



---

Comment by foosterhof created at 2014-06-27 18:04:04

This poses a useful question:
 - Should an object be able to be in the list multiple times?

If so, the data storage plan used now will not work, and a structure using actual Node objects should be used. However, this will either break compatibility, as remove() now takes the object to remove, while then it would require the node containing the object, or it will increase the complexity of remove() from O(1) to O(n) by searching for the node to be removed. Both cases seem highly undesirable to me.

If objects cannot be represented multiple times, this can quite easily be fixed by creating some sort of 'has' dictionary, checking whether an element is already in the list.

What would be most desirable for Sage?


---

Comment by Rudi created at 2014-06-27 18:53:15

I'd say double entries should be possible, a DLL should really be able to store any sequence. 

How is `remove' currently implemented? I really do not see how it can take O(1) time right now. To remove in O(1) time you must take away the trouble of finding the node (or at least the pointers to next\previous object). Just passing the object still leaves you with that work.

This doubly linked list has hide/unhide, which in my book means that there should be two doubly linked lists in there, one storing a subsequence of the other.

But perhaps it's not all cast in stone and there are more schools of thought on this. I was brought up with the c++ STL implementation of a list, as here http://www.cplusplus.com/reference/list/list/


---

Comment by Rudi created at 2014-06-28 07:43:41

I forgot for a moment that I could simply take a look at the code :) . Anyway, the implementation of remove() takes O(log n) time, not O(1) as advertised in the docstring, since next_value and prev_value are dictionaries.


---

Comment by chapoton created at 2015-08-09 12:30:03

tests do not pass


---

Comment by chapoton created at 2015-08-09 12:30:03

Changing status from needs_review to needs_work.
