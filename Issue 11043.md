# Issue 11043: Various Pairings for Modular Forms

Issue created by migration from Trac.

Original creator: tdupu

Original creation time: 2011-04-18 21:52:15

Assignee: craigcitro

CC:  cremona

We should have a functions/functions which allow for pairing of the following

-cuspidal modular symbols for Gamma0(N) with cusp forms for Gamma0(N)

-cusp forms for Gamma0(N) with cusp forms Gamma0(N) (petersson inner product)

-group elements of Gamma0(N) with cusp forms for Gamma0(N)

Once this is done what works for cusp forms should be extended to Meromorphic Differentials of the second kind. 
They should be implemented so that things like

```
sage: f = CuspForm(15,2).basis()[0]
sage: g = Gamma0(15).random_element()
sage: f.pair(g)
--some number--
```

should work. Observe that Gamma0(15).random_element() is not implemented. A reference for this is chapter 2 of Cremona. 

I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???


---

Attachment

pairing for S2(Gamma0(N)) and Gamma0(N)


---

Attachment

here is a clean version of the previous patch

for the bot: apply only trac_11215_pairing_redone.patchâ€‹


---

Comment by cremona created at 2013-08-08 11:11:23

As you suggest, it would be alot better to use the fact that f will be an eigenform for the Fricke involution, since that replaces the N in the denominator of the negative exponential with sqrt(N).  The necessary formulas are in the same place....!

Another improvement would be ta take the precision as in put rather than the number of terms, and compute the necessary number of terms.

All this is implemented in eclib, for forms of weight 2, trivial character *and rational Fourier coefficients only* so (not for the first time) I am wishing for an interface to all that additional functionality.  Anyway, here we can be more general since there need be no requirement of rationality.


---

Attachment


---

Comment by chapoton created at 2013-08-08 13:26:33

here is a version using the Atkin-Lehner eigenvalue and the faster converging series

for the bot: apply only trac_11215_pairing_with_atkin_lehner.patch


---

Comment by chapoton created at 2014-01-05 10:05:35

New commits:


---

Comment by chapoton created at 2014-01-05 10:05:35

Changing status from new to needs_review.


---

Comment by aly.deines created at 2014-01-07 04:43:58

Changing status from needs_review to needs_work.


---

Comment by aly.deines created at 2014-01-07 04:43:58

It looks good, works, tests pass, but the last line could be broken into an extra line or two that would make this more readable.  If you do that I'll give you a positive review.  Also, could you add comments to explain what M.a(), M.b() and M.c() are?


---

Comment by git created at 2014-01-07 08:57:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-01-07 08:59:55

Here is a new commit, where I tried to make it more readable.

I have also changed the ValueError test, that looked wrong

I have added a comment about M.a() etc


---

Comment by chapoton created at 2014-01-08 08:48:11

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2014-01-08 08:48:11

I have made the suggested changes, hopefully. Is there something else to do ?


---

Comment by chapoton created at 2014-02-11 17:46:27

Ping ? Could somebody please have a look ?


---

Comment by chapoton created at 2014-03-11 20:24:55

Ping again. This needs review, anybody out there to have a look ?


---

Comment by git created at 2014-05-09 20:12:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-05-09 20:42:24

I think this needs to be improved a bit.  In particular the new code is only really useful if we can specify the desired precision (of the output), see comment:3.  I'm trying to do this now.


---

Comment by pbruin created at 2014-05-09 20:42:24

Changing status from needs_review to needs_work.


---

Comment by pbruin created at 2014-05-09 21:07:40

Also, it seems to me that the name `pair` for this method is too generic.  Since this pairing is commonly known as the period pairing, would anyone object to renaming the method to `period`?


---

Comment by pbruin created at 2014-05-09 23:52:59

Changing status from needs_work to needs_review.


---

Comment by pbruin created at 2014-05-09 23:52:59

The new commit renames the method to `period`, and adds a `prec` argument and a line of code to deduce a bound on the number of terms of the series from that.  I don't have a reference for this bound; I just computed a slightly rough but hopefully correct one and put the basic idea in a comment.

There are various other changes.  All computations are now done in `RealField(prec)` and the associated `ComplexField`.  The method now also checks its input more carefully.

I guess this does not really qualify as a reviewer patch anymore, but it is probably still OK if one of the existing authors reviews these changes instead of a "disinterested third party".


---

Comment by chapoton created at 2014-05-10 06:30:26

you should add doctests for the new raise statements


---

Comment by cremona created at 2014-05-10 08:33:26

I think period is a good name for this.  Can the docstring cross-reference the fact that for f associated to an elliptic curve E there is also the method E.modular_symbol() which gives exact rational output, namely the coordinates of the complex period with respect to the real and imaginary periods?


---

Comment by git created at 2014-05-10 13:28:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cremona created at 2014-05-10 13:32:14

Thanks, Peter -- great example!


---

Comment by pbruin created at 2014-05-10 13:32:45

OK, I made some small corrections and added documentation and examples.


---

Comment by git created at 2014-05-10 17:41:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-06-04 19:21:16

ok, this looks good to me and the bot is happy. positive review


---

Comment by chapoton created at 2014-06-04 19:21:16

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2014-06-04 19:21:16

Changing keywords from "" to "modular form".


---

Comment by vbraun created at 2014-06-05 12:30:23

Conflicts, please merge in the latest beta


---

Comment by vbraun created at 2014-06-05 12:30:31

Changing status from positive_review to needs_work.


---

Comment by git created at 2014-06-05 15:35:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-06-05 15:36:37

Changing status from needs_work to positive_review.


---

Comment by pbruin created at 2014-06-05 15:36:37

Merged development branch, all tests pass.


---

Comment by vbraun created at 2014-06-06 18:07:58

Resolution: fixed
