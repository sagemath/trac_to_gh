# Issue 30223: Star-Insertion

Issue created by migration from https://trac.sagemath.org/ticket/30460

Original creator: wpoh

Original creation time: 2020-08-28 22:57:50

CC:  aschilling jppan tscrim

Keywords: RSK-type insertion

Implementation of the *-insertion from fully-commutative decreasing factorizations in the 0-Hecke monoid to pairs of tableaux of the same shape. See https://arxiv.org/abs/1911.08732. 


---

Comment by wpoh created at 2020-08-31 20:01:39

New commits:


---

Comment by git created at 2020-09-02 06:20:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-03 04:12:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-06 21:13:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-07 01:11:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-10 03:14:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-11 21:43:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-12 05:01:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-09-12 06:37:55

I have added a missing # in dependencies


---

Comment by git created at 2020-09-28 06:53:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-28 22:29:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-29 01:45:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-29 01:55:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-29 17:32:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 01:36:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 06:30:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 16:14:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 17:13:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 18:36:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 20:07:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-30 21:50:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jppan created at 2020-09-30 21:52:09

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-10-02 00:19:55

Here are my comments:

This sentence should be revised since it is defining *-insertion as *-insertion:

```
The `\star`-insertion is similar to the classical RSK algorithm,
but it is defined using the `\star`-insertion in [MPPS2020]_.
```


In `forward_rule()`:

```diff
         - ``obj1, obj2`` -- can be one of the following ways to represent a
           biword (or, equivalently, an increasing 0-Hecke factorization) that
           is fully commutative:
 
-            - two lists ``obj1`` and ``obj2`` of equal length, to be
-              interpreted as the top row and the bottom row of the biword.
+          - two lists ``obj1`` and ``obj2`` of equal length, to be
+            interpreted as the top row and the bottom row of the biword
```

and similar for that documentation.

I think this can be simplified:

```diff
-                obj1 = sum([[h.factors-i]*len(h.value[i]) for i in range(h.factors)],[])
-                obj1.reverse()
-                obj2 = [i for f in h.value for i in f]
-                obj2.reverse()
+                obj1 = sum([[h.factors-i]*len(h.value[i]) for i in reversed(range(h.factors))],[])
+                obj2 = [i for f in reversed(h.value) for i in reversed(f)]
```

although I am not sure that changes the readability/speed of the code. So you might want to ignore this.


```diff
-for j in sorted(row_dict.keys(), reverse=True):
+for j in sorted(row_dict, reverse=True):
```


Can you also include tests for the backwards rule for the empty case (with perhaps the different output types)?

I think there should be at least one systematic test that the round trip is the identity, but both loops would also be good.

This error message is misleading because it is suggests that the conjugate is the input of `p.conjugate()`. I would suggest

```diff
-raise ValueError("p.conjugate(=%s) must be a semistandard tableau" % p.conjugate())
raise ValueError("the conjugate of p(=%s) must be a semistandard tableau" % p.conjugate())
```


Python convention for error messages is they start with a lower case letter:

```
raise ValueError(f"The row reading word of the insertion tableau {p} is not fully-commutative")
```


Nitpick, but since there will be changes: `y -=1` -> `y -= 1`.


---

Comment by git created at 2020-10-02 03:55:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-10-05 22:16:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by wpoh created at 2020-10-05 22:25:57

Thanks for the comments. Jianping and I have addressed them in the last two commits.

Replying to [comment:24 tscrim]:
> Can you also include tests for the backwards rule for the empty case (with perhaps the different output types)?
Yes, the tests have been included for both `forward_rule` and `backward_rule`. This flags an undetected error for `fully_commutative_stable_grothendieck.py` but that has been rectified.

 
> I think there should be at least one systematic test that the round trip is the identity, but both loops would also be good.
The tests are included for both loops, but there is no test for output `DecreasingHeckeFactorization` under the composition `RSK_inverse` after `RSK` using `RuleStar`. 
The default is to return the number of factors according to the largest entry in the recording tableau; a warning has been written to highlight this behavior.


---

Comment by git created at 2020-10-06 02:11:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-10-09 22:09:49

Thank you. One last thing (in addition to a merge conflict to address): This block is over-indented:

```
     TESTS:
 
-        Check that :func:`RSK` is the inverse of :func:`RSK_inverse` for various
-        outputs/inputs::
+    Check that :func:`RSK` is the inverse of :func:`RSK_inverse` for various
+    outputs/inputs::
```

and similar.


---

Comment by git created at 2020-10-10 05:22:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-10-10 07:59:37

If the patchbot comes back green, then positive review.


---

Comment by tscrim created at 2020-10-12 00:39:51

Thank you.


---

Comment by tscrim created at 2020-10-12 00:39:51

Changing status from needs_review to positive_review.


---

Comment by aschilling created at 2020-10-12 00:42:15

Thank you, Travis, for the review!


---

Comment by vbraun created at 2020-10-31 18:07:36

Resolution: fixed
