# Issue 30223: Star-Insertion

archive/issues_030223.json:
```json
{
    "body": "CC:  @anneschilling jppan @tscrim\n\nKeywords: RSK-type insertion\n\nImplementation of the *-insertion from fully-commutative decreasing factorizations in the 0-Hecke monoid to pairs of tableaux of the same shape. See https://arxiv.org/abs/1911.08732. \n\nIssue created by migration from https://trac.sagemath.org/ticket/30460\n\n",
    "created_at": "2020-08-28T22:57:50Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Star-Insertion",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30223",
    "user": "wpoh"
}
```
CC:  @anneschilling jppan @tscrim

Keywords: RSK-type insertion

Implementation of the *-insertion from fully-commutative decreasing factorizations in the 0-Hecke monoid to pairs of tableaux of the same shape. See https://arxiv.org/abs/1911.08732. 

Issue created by migration from https://trac.sagemath.org/ticket/30460





---

archive/issue_comments_430802.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-08-31T20:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430802",
    "user": "wpoh"
}
```

New commits:



---

archive/issue_comments_430803.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-02T06:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430803",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430804.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-03T04:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430804",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430805.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-06T21:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430805",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430806.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-07T01:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430806",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430807.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-10T03:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430807",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430808.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-11T21:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430808",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430809.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-12T05:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430809",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430810.json:
```json
{
    "body": "I have added a missing # in dependencies",
    "created_at": "2020-09-12T06:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430810",
    "user": "@fchapoton"
}
```

I have added a missing # in dependencies



---

archive/issue_comments_430811.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-28T06:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430811",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-28T22:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430812",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430813.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-29T01:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430813",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430814.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-29T01:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430814",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430815.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-29T17:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430815",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430816.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T01:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430816",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430817.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T06:30:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430817",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430818.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T16:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430818",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430819.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T17:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430819",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430820.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T18:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430820",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430821.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T20:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430821",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430822.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-30T21:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430822",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430823.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-30T21:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430823",
    "user": "jppan"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_430824.json:
```json
{
    "body": "Here are my comments:\n\nThis sentence should be revised since it is defining *-insertion as *-insertion:\n\n```\nThe `\\star`-insertion is similar to the classical RSK algorithm,\nbut it is defined using the `\\star`-insertion in [MPPS2020]_.\n```\n\n\nIn `forward_rule()`:\n\n```diff\n         - ``obj1, obj2`` -- can be one of the following ways to represent a\n           biword (or, equivalently, an increasing 0-Hecke factorization) that\n           is fully commutative:\n \n-            - two lists ``obj1`` and ``obj2`` of equal length, to be\n-              interpreted as the top row and the bottom row of the biword.\n+          - two lists ``obj1`` and ``obj2`` of equal length, to be\n+            interpreted as the top row and the bottom row of the biword\n```\n\nand similar for that documentation.\n\nI think this can be simplified:\n\n```diff\n-                obj1 = sum([[h.factors-i]*len(h.value[i]) for i in range(h.factors)],[])\n-                obj1.reverse()\n-                obj2 = [i for f in h.value for i in f]\n-                obj2.reverse()\n+                obj1 = sum([[h.factors-i]*len(h.value[i]) for i in reversed(range(h.factors))],[])\n+                obj2 = [i for f in reversed(h.value) for i in reversed(f)]\n```\n\nalthough I am not sure that changes the readability/speed of the code. So you might want to ignore this.\n\n\n```diff\n-for j in sorted(row_dict.keys(), reverse=True):\n+for j in sorted(row_dict, reverse=True):\n```\n\n\nCan you also include tests for the backwards rule for the empty case (with perhaps the different output types)?\n\nI think there should be at least one systematic test that the round trip is the identity, but both loops would also be good.\n\nThis error message is misleading because it is suggests that the conjugate is the input of `p.conjugate()`. I would suggest\n\n```diff\n-raise ValueError(\"p.conjugate(=%s) must be a semistandard tableau\" % p.conjugate())\nraise ValueError(\"the conjugate of p(=%s) must be a semistandard tableau\" % p.conjugate())\n```\n\n\nPython convention for error messages is they start with a lower case letter:\n\n```\nraise ValueError(f\"The row reading word of the insertion tableau {p} is not fully-commutative\")\n```\n\n\nNitpick, but since there will be changes: `y -=1` -> `y -= 1`.",
    "created_at": "2020-10-02T00:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430824",
    "user": "@tscrim"
}
```

Here are my comments:

This sentence should be revised since it is defining *-insertion as *-insertion:

```
The `\star`-insertion is similar to the classical RSK algorithm,
but it is defined using the `\star`-insertion in [MPPS2020]_.
```


In `forward_rule()`:

```diff
         - ``obj1, obj2`` -- can be one of the following ways to represent a
           biword (or, equivalently, an increasing 0-Hecke factorization) that
           is fully commutative:
 
-            - two lists ``obj1`` and ``obj2`` of equal length, to be
-              interpreted as the top row and the bottom row of the biword.
+          - two lists ``obj1`` and ``obj2`` of equal length, to be
+            interpreted as the top row and the bottom row of the biword
```

and similar for that documentation.

I think this can be simplified:

```diff
-                obj1 = sum([[h.factors-i]*len(h.value[i]) for i in range(h.factors)],[])
-                obj1.reverse()
-                obj2 = [i for f in h.value for i in f]
-                obj2.reverse()
+                obj1 = sum([[h.factors-i]*len(h.value[i]) for i in reversed(range(h.factors))],[])
+                obj2 = [i for f in reversed(h.value) for i in reversed(f)]
```

although I am not sure that changes the readability/speed of the code. So you might want to ignore this.


```diff
-for j in sorted(row_dict.keys(), reverse=True):
+for j in sorted(row_dict, reverse=True):
```


Can you also include tests for the backwards rule for the empty case (with perhaps the different output types)?

I think there should be at least one systematic test that the round trip is the identity, but both loops would also be good.

This error message is misleading because it is suggests that the conjugate is the input of `p.conjugate()`. I would suggest

```diff
-raise ValueError("p.conjugate(=%s) must be a semistandard tableau" % p.conjugate())
raise ValueError("the conjugate of p(=%s) must be a semistandard tableau" % p.conjugate())
```


Python convention for error messages is they start with a lower case letter:

```
raise ValueError(f"The row reading word of the insertion tableau {p} is not fully-commutative")
```


Nitpick, but since there will be changes: `y -=1` -> `y -= 1`.



---

archive/issue_comments_430825.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-02T03:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430825",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430826.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-05T22:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430826",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430827.json:
```json
{
    "body": "Thanks for the comments. Jianping and I have addressed them in the last two commits.\n\nReplying to [comment:24 tscrim]:\n> Can you also include tests for the backwards rule for the empty case (with perhaps the different output types)?\nYes, the tests have been included for both `forward_rule` and `backward_rule`. This flags an undetected error for `fully_commutative_stable_grothendieck.py` but that has been rectified.\n\n \n> I think there should be at least one systematic test that the round trip is the identity, but both loops would also be good.\nThe tests are included for both loops, but there is no test for output `DecreasingHeckeFactorization` under the composition `RSK_inverse` after `RSK` using `RuleStar`. \nThe default is to return the number of factors according to the largest entry in the recording tableau; a warning has been written to highlight this behavior.",
    "created_at": "2020-10-05T22:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430827",
    "user": "wpoh"
}
```

Thanks for the comments. Jianping and I have addressed them in the last two commits.

Replying to [comment:24 tscrim]:
> Can you also include tests for the backwards rule for the empty case (with perhaps the different output types)?
Yes, the tests have been included for both `forward_rule` and `backward_rule`. This flags an undetected error for `fully_commutative_stable_grothendieck.py` but that has been rectified.

 
> I think there should be at least one systematic test that the round trip is the identity, but both loops would also be good.
The tests are included for both loops, but there is no test for output `DecreasingHeckeFactorization` under the composition `RSK_inverse` after `RSK` using `RuleStar`. 
The default is to return the number of factors according to the largest entry in the recording tableau; a warning has been written to highlight this behavior.



---

archive/issue_comments_430828.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-06T02:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430828",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430829.json:
```json
{
    "body": "Thank you. One last thing (in addition to a merge conflict to address): This block is over-indented:\n\n```\n     TESTS:\n \n-        Check that :func:`RSK` is the inverse of :func:`RSK_inverse` for various\n-        outputs/inputs::\n+    Check that :func:`RSK` is the inverse of :func:`RSK_inverse` for various\n+    outputs/inputs::\n```\n\nand similar.",
    "created_at": "2020-10-09T22:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430829",
    "user": "@tscrim"
}
```

Thank you. One last thing (in addition to a merge conflict to address): This block is over-indented:

```
     TESTS:
 
-        Check that :func:`RSK` is the inverse of :func:`RSK_inverse` for various
-        outputs/inputs::
+    Check that :func:`RSK` is the inverse of :func:`RSK_inverse` for various
+    outputs/inputs::
```

and similar.



---

archive/issue_comments_430830.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-10T05:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430830",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_430831.json:
```json
{
    "body": "If the patchbot comes back green, then positive review.",
    "created_at": "2020-10-10T07:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430831",
    "user": "@tscrim"
}
```

If the patchbot comes back green, then positive review.



---

archive/issue_comments_430832.json:
```json
{
    "body": "Thank you.",
    "created_at": "2020-10-12T00:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430832",
    "user": "@tscrim"
}
```

Thank you.



---

archive/issue_comments_430833.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-12T00:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430833",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_430834.json:
```json
{
    "body": "Thank you, Travis, for the review!",
    "created_at": "2020-10-12T00:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430834",
    "user": "@anneschilling"
}
```

Thank you, Travis, for the review!



---

archive/issue_comments_430835.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-10-31T18:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30223#issuecomment-430835",
    "user": "@vbraun"
}
```

Resolution: fixed
