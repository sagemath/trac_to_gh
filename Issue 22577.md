# Issue 22577: Update cmake to 3.8.0

archive/issues_022577.json:
```json
{
    "body": "CC:  isuruf fbissey\n\nTarball available at https://cmake.org/files/v3.8/cmake-3.8.0.tar.gz\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22814\n\n",
    "created_at": "2017-04-15T04:34:33Z",
    "labels": [
        "packages: experimental",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Update cmake to 3.8.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22577",
    "user": "tmonteil"
}
```
CC:  isuruf fbissey

Tarball available at https://cmake.org/files/v3.8/cmake-3.8.0.tar.gz


Issue created by migration from https://trac.sagemath.org/ticket/22814





---

archive/issue_comments_314913.json:
```json
{
    "body": "With 3.2.3:\n- on 64bit, the build was OK and self-tests lead to 1 error (CTestTestUpload)\n- on 32bit, the build failed at configure time\n\nWith 3.8.0:\n- on 64bit, the build is OK and self-tests lead to 2 errors (CTestTestUpload and RunCMake.ctest_submit), but the second test did not exist on 3.2.3.\n- on 32bit, the build is OK and 7 self-tests failed out of 442 (98% tests passed)\n\nSo, regarding GNU/Linux, the state of this package is strictly better than before.\n\nHowever, i had to remove the `osx10.10.patch` patch since it does not apply anymore. So, if you have access to such machines, please have a look to OSX builds.\n----\nNew commits:",
    "created_at": "2017-04-15T16:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314913",
    "user": "tmonteil"
}
```

With 3.2.3:
- on 64bit, the build was OK and self-tests lead to 1 error (CTestTestUpload)
- on 32bit, the build failed at configure time

With 3.8.0:
- on 64bit, the build is OK and self-tests lead to 2 errors (CTestTestUpload and RunCMake.ctest_submit), but the second test did not exist on 3.2.3.
- on 32bit, the build is OK and 7 self-tests failed out of 442 (98% tests passed)

So, regarding GNU/Linux, the state of this package is strictly better than before.

However, i had to remove the `osx10.10.patch` patch since it does not apply anymore. So, if you have access to such machines, please have a look to OSX builds.
----
New commits:



---

archive/issue_comments_314914.json:
```json
{
    "body": "Changing keywords from \"\" to \"days86\".",
    "created_at": "2017-04-15T16:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314914",
    "user": "tmonteil"
}
```

Changing keywords from "" to "days86".



---

archive/issue_comments_314915.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-15T16:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314915",
    "user": "tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_314916.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-15T19:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314916",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314917.json:
```json
{
    "body": "LGTM.",
    "created_at": "2017-04-15T19:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314917",
    "user": "tscrim"
}
```

LGTM.



---

archive/issue_comments_314918.json:
```json
{
    "body": "Replying to [comment:3 tscrim]:\n> LGTM.\n\nDoes it compile/test well on OSX ?",
    "created_at": "2017-04-15T21:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314918",
    "user": "tmonteil"
}
```

Replying to [comment:3 tscrim]:
> LGTM.

Does it compile/test well on OSX ?



---

archive/issue_comments_314919.json:
```json
{
    "body": "Tested on OS X on top of #12426, tests returned 3 errors:\n\n```\n        Start 190: CTestTestUpload\n190/445 Test #190: CTestTestUpload ......................................***Failed  Required regular expression not found.Regex=[Upload\\.xml\n] 78.11 sec\n        Start 349: RunCMake.ctest_submit\n349/445 Test #349: RunCMake.ctest_submit ................................***Failed  388.42 sec\n        Start 383: RunCMake.Framework\n383/445 Test #383: RunCMake.Framework ...................................***Failed   11.32 sec\n```\n\nDetails\n[CTestTestUpload]\n\n```\n[ERROR_MESSAGE]\n   Error when uploading file: /Users/fbissey/build/sage-clang/local/var/tmp/sage/build/cmake-3.8.0/src/Tests/CTestTestUpload/Testing/20170415-2318/Build.xml\n\n   Error message was: Failed to connect to 192.0.2.0 port 5187: Operation timed out\n   Problems when submitting via HTTP\n```\n\n[RunCMake.ctest_submit]\n\n```\n[ERROR_MESSAGE]\n   Error when uploading file: /Users/fbissey/build/sage-clang/local/var/tmp/sage/build/cmake-3.8.0/src/Tests/RunCMake/ctest_submit/FailDrop-https-build/Testing/20170415-2$\n\n   Error message was: Failed to connect to 192.0.2.0 port 5187: Operation timed out\n   Problems when submitting via HTTP\n```\n\nLooks like a pattern...\n[RunCMake.Framework]: OS X specific, it looks like multiple errors trying to build stuff for iDevices...",
    "created_at": "2017-04-16T00:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314919",
    "user": "fbissey"
}
```

Tested on OS X on top of #12426, tests returned 3 errors:

```
        Start 190: CTestTestUpload
190/445 Test #190: CTestTestUpload ......................................***Failed  Required regular expression not found.Regex=[Upload\.xml
] 78.11 sec
        Start 349: RunCMake.ctest_submit
349/445 Test #349: RunCMake.ctest_submit ................................***Failed  388.42 sec
        Start 383: RunCMake.Framework
383/445 Test #383: RunCMake.Framework ...................................***Failed   11.32 sec
```

Details
[CTestTestUpload]

```
[ERROR_MESSAGE]
   Error when uploading file: /Users/fbissey/build/sage-clang/local/var/tmp/sage/build/cmake-3.8.0/src/Tests/CTestTestUpload/Testing/20170415-2318/Build.xml

   Error message was: Failed to connect to 192.0.2.0 port 5187: Operation timed out
   Problems when submitting via HTTP
```

[RunCMake.ctest_submit]

```
[ERROR_MESSAGE]
   Error when uploading file: /Users/fbissey/build/sage-clang/local/var/tmp/sage/build/cmake-3.8.0/src/Tests/RunCMake/ctest_submit/FailDrop-https-build/Testing/20170415-2$

   Error message was: Failed to connect to 192.0.2.0 port 5187: Operation timed out
   Problems when submitting via HTTP
```

Looks like a pattern...
[RunCMake.Framework]: OS X specific, it looks like multiple errors trying to build stuff for iDevices...



---

archive/issue_comments_314920.json:
```json
{
    "body": "I'd say the OS X failure in framework is because we set `MACOSX_DEPLOYMENT_TARGET` in `sage-env`. When cmake tries to build executable for iOS there is an option on the command line that tells it to produce OS X stuff (x86_64) instead. Boom when you try to link.",
    "created_at": "2017-04-16T01:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314920",
    "user": "fbissey"
}
```

I'd say the OS X failure in framework is because we set `MACOSX_DEPLOYMENT_TARGET` in `sage-env`. When cmake tries to build executable for iOS there is an option on the command line that tells it to produce OS X stuff (x86_64) instead. Boom when you try to link.



---

archive/issue_comments_314921.json:
```json
{
    "body": "Yup, confirmed. Unsetting `MACOSX_DEPLOYMENT_TARGET` make the framework test pass. Only those two tests that probably try to contact to an internal kitware server are now failing.",
    "created_at": "2017-04-16T03:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314921",
    "user": "fbissey"
}
```

Yup, confirmed. Unsetting `MACOSX_DEPLOYMENT_TARGET` make the framework test pass. Only those two tests that probably try to contact to an internal kitware server are now failing.



---

archive/issue_comments_314922.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-04-16T03:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314922",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_314923.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-04-16T03:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314923",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_314924.json:
```json
{
    "body": "Replying to [comment:7 fbissey]:\n> Yup, confirmed. Unsetting `MACOSX_DEPLOYMENT_TARGET` make the framework test pass. Only those two tests that probably try to contact to an internal kitware server are now failing.\n\nThanks fot the investigation, does the last commit fixes that issue ?",
    "created_at": "2017-04-16T03:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314924",
    "user": "tmonteil"
}
```

Replying to [comment:7 fbissey]:
> Yup, confirmed. Unsetting `MACOSX_DEPLOYMENT_TARGET` make the framework test pass. Only those two tests that probably try to contact to an internal kitware server are now failing.

Thanks fot the investigation, does the last commit fixes that issue ?



---

archive/issue_comments_314925.json:
```json
{
    "body": "Not what I have done or my recommendation. I am also working on silencing the other two tests. I am acting only on `spkg-check`\n\n```/usr/bin/env bash\n\ncd src\nunset MACOSX_DEPLOYMENT_TARGET\nctest -E \"(CTestTestStopTime|TestUpload)\"\n```\n\nThat made the framework test pass and silenced the `TestUpload` one. Gentoo silence the `TestUpload` one too amongst other. I still have to do something about `ctest_submit`. Have to find the right command.",
    "created_at": "2017-04-16T04:11:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314925",
    "user": "fbissey"
}
```

Not what I have done or my recommendation. I am also working on silencing the other two tests. I am acting only on `spkg-check`

```/usr/bin/env bash

cd src
unset MACOSX_DEPLOYMENT_TARGET
ctest -E "(CTestTestStopTime|TestUpload)"
```

That made the framework test pass and silenced the `TestUpload` one. Gentoo silence the `TestUpload` one too amongst other. I still have to do something about `ctest_submit`. Have to find the right command.



---

archive/issue_comments_314926.json:
```json
{
    "body": "That should take care of everything on 64bit. Cannot do anything about the 32bit tests without knowing more about them\n\n```/usr/bin/env bash\n\ncd src\nunset MACOSX_DEPLOYMENT_TARGET\nctest --extra-verbose --output-on-failure -E \"(CTestTestStopTime|TestUpload|ctest_submit)\"\n```\n\nAnd I like things to be verbose, that makes debugging so much easier.",
    "created_at": "2017-04-16T06:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314926",
    "user": "fbissey"
}
```

That should take care of everything on 64bit. Cannot do anything about the 32bit tests without knowing more about them

```/usr/bin/env bash

cd src
unset MACOSX_DEPLOYMENT_TARGET
ctest --extra-verbose --output-on-failure -E "(CTestTestStopTime|TestUpload|ctest_submit)"
```

And I like things to be verbose, that makes debugging so much easier.



---

archive/issue_comments_314927.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-04-17T04:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314927",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_314928.json:
```json
{
    "body": "Thanks for the hints, the tests now pass on 64bit arch. I took the opportunity to add a missing `dependencies` file. Regarding the 32bit issues, i might have some problems with my current VM  (see #22782 that i seem to be the only one to produce), so i will rebuild a fresh one to only get the meaningful errors.",
    "created_at": "2017-04-17T04:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314928",
    "user": "tmonteil"
}
```

Thanks for the hints, the tests now pass on 64bit arch. I took the opportunity to add a missing `dependencies` file. Regarding the 32bit issues, i might have some problems with my current VM  (see #22782 that i seem to be the only one to produce), so i will rebuild a fresh one to only get the meaningful errors.



---

archive/issue_comments_314929.json:
```json
{
    "body": "Replying to [comment:2 tmonteil]:\n> However, i had to remove the `osx10.10.patch` patch since it does not apply anymore. So, if you have access to such machines, please have a look to OSX builds.\n\nSince sage is changing the compiler to clang on OSX, the patch is not needed at all.\n\nReplying to [comment:13 tmonteil]:\n> Thanks for the hints, the tests now pass on 64bit arch. I took the opportunity to add a missing `dependencies` file.\n\nI see that `curl` is a sage package now. Since it was not when the previous `cmake` version was added, I added logic such that `curl` was used from OSX system and it was built from source on Linux (`cmake` has a bundled `curl`). Can you change the `spkg-install` such that `cmake` finds sage's `curl` package?",
    "created_at": "2017-04-17T05:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314929",
    "user": "isuruf"
}
```

Replying to [comment:2 tmonteil]:
> However, i had to remove the `osx10.10.patch` patch since it does not apply anymore. So, if you have access to such machines, please have a look to OSX builds.

Since sage is changing the compiler to clang on OSX, the patch is not needed at all.

Replying to [comment:13 tmonteil]:
> Thanks for the hints, the tests now pass on 64bit arch. I took the opportunity to add a missing `dependencies` file.

I see that `curl` is a sage package now. Since it was not when the previous `cmake` version was added, I added logic such that `curl` was used from OSX system and it was built from source on Linux (`cmake` has a bundled `curl`). Can you change the `spkg-install` such that `cmake` finds sage's `curl` package?



---

archive/issue_comments_314930.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-17T05:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314930",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314931.json:
```json
{
    "body": "Replying to [comment:14 isuruf]:\n> Replying to [comment:2 tmonteil]:\n> > However, i had to remove the `osx10.10.patch` patch since it does not apply anymore. So, if you have access to such machines, please have a look to OSX builds.\n> \n> Since sage is changing the compiler to clang on OSX, the patch is not needed at all.\n> \n> Replying to [comment:13 tmonteil]:\n> > Thanks for the hints, the tests now pass on 64bit arch. I took the opportunity to add a missing `dependencies` file.\n> \n> I see that `curl` is a sage package now. Since it was not when the previous `cmake` version was added, I added logic such that `curl` was used from OSX system and it was built from source on Linux (`cmake` has a bundled `curl`). Can you change the `spkg-install` such that `cmake` finds sage's `curl` package?\n\nThierry did put `curl` in the dependencies, so it is taken care of. I am adding myself as a reviewer and put it back to positive review.",
    "created_at": "2017-04-17T05:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314931",
    "user": "fbissey"
}
```

Replying to [comment:14 isuruf]:
> Replying to [comment:2 tmonteil]:
> > However, i had to remove the `osx10.10.patch` patch since it does not apply anymore. So, if you have access to such machines, please have a look to OSX builds.
> 
> Since sage is changing the compiler to clang on OSX, the patch is not needed at all.
> 
> Replying to [comment:13 tmonteil]:
> > Thanks for the hints, the tests now pass on 64bit arch. I took the opportunity to add a missing `dependencies` file.
> 
> I see that `curl` is a sage package now. Since it was not when the previous `cmake` version was added, I added logic such that `curl` was used from OSX system and it was built from source on Linux (`cmake` has a bundled `curl`). Can you change the `spkg-install` such that `cmake` finds sage's `curl` package?

Thierry did put `curl` in the dependencies, so it is taken care of. I am adding myself as a reviewer and put it back to positive review.



---

archive/issue_comments_314932.json:
```json
{
    "body": "Replying to [comment:15 fbissey]:\n> Thierry did put `curl` in the dependencies, so it is taken care of. I am adding myself as a reviewer and put it back to positive review.\n\nYes, but on Linux, `cmake` builds the bundled `curl` right?",
    "created_at": "2017-04-17T05:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314932",
    "user": "isuruf"
}
```

Replying to [comment:15 fbissey]:
> Thierry did put `curl` in the dependencies, so it is taken care of. I am adding myself as a reviewer and put it back to positive review.

Yes, but on Linux, `cmake` builds the bundled `curl` right?



---

archive/issue_comments_314933.json:
```json
{
    "body": "You are right `spkg-install` needs cleaning up. The whole section for using or not system curl needs updating, most of it will have to go and be simplified. Back to `need_works`.",
    "created_at": "2017-04-17T05:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314933",
    "user": "fbissey"
}
```

You are right `spkg-install` needs cleaning up. The whole section for using or not system curl needs updating, most of it will have to go and be simplified. Back to `need_works`.



---

archive/issue_comments_314934.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-17T05:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314934",
    "user": "fbissey"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_314935.json:
```json
{
    "body": "I was trying to find the origin of the `192.0.2.0` address in the cmake test suite. It is not in the source code. cmake does something weird with its test suite. At some point it links one of the sub-folders in the `Tests` to the `Applications` folder on the mac. In my case one of the App in `Applications` is libreoffice. That weird address is found inside libreoffice's python code....\n\nThis is just bizarre. \n\nI'll clean `spkg-install` there is other stuff in there like `MACOSX_DEPLOYMENT_TARGET` that may have been an early attempt at fixing some stuff (or needed to be used with the patch) that has no business here.",
    "created_at": "2017-04-18T22:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314935",
    "user": "fbissey"
}
```

I was trying to find the origin of the `192.0.2.0` address in the cmake test suite. It is not in the source code. cmake does something weird with its test suite. At some point it links one of the sub-folders in the `Tests` to the `Applications` folder on the mac. In my case one of the App in `Applications` is libreoffice. That weird address is found inside libreoffice's python code....

This is just bizarre. 

I'll clean `spkg-install` there is other stuff in there like `MACOSX_DEPLOYMENT_TARGET` that may have been an early attempt at fixing some stuff (or needed to be used with the patch) that has no business here.



---

archive/issue_comments_314936.json:
```json
{
    "body": "Isuru, can you double check my changes, add your name to the reviewers and put it to positive review?\n----\nNew commits:",
    "created_at": "2017-04-19T00:16:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314936",
    "user": "fbissey"
}
```

Isuru, can you double check my changes, add your name to the reviewers and put it to positive review?
----
New commits:



---

archive/issue_comments_314937.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-04-19T00:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314937",
    "user": "fbissey"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_314938.json:
```json
{
    "body": "Sorry for the delay, i had the exact same commit, so it is fine for me, except that i let the `unset MACOSX_DEPLOYMENT_TARGET`, since i am not sure whether it is still useful.\n\nAlso, looking at the `bootstrap` script, i was wondering whether we should add `xz` as a dependency and add the `--system-liblzma` option. Does this makes sense ?",
    "created_at": "2017-04-19T01:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314938",
    "user": "tmonteil"
}
```

Sorry for the delay, i had the exact same commit, so it is fine for me, except that i let the `unset MACOSX_DEPLOYMENT_TARGET`, since i am not sure whether it is still useful.

Also, looking at the `bootstrap` script, i was wondering whether we should add `xz` as a dependency and add the `--system-liblzma` option. Does this makes sense ?



---

archive/issue_comments_314939.json:
```json
{
    "body": "If we have it (and I guess it is a requirement for R nowadays) then yes go ahead. \n\nI tested the removal of `unset MACOSX_DEPLOYMENT_TARGET` and I didn't observe any problem nor did I expect any. Further if we want to take cmake from experimental to optional and may be even standard in time, then it has to go. We cannot make portable binaries if it is unset.",
    "created_at": "2017-04-19T01:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314939",
    "user": "fbissey"
}
```

If we have it (and I guess it is a requirement for R nowadays) then yes go ahead. 

I tested the removal of `unset MACOSX_DEPLOYMENT_TARGET` and I didn't observe any problem nor did I expect any. Further if we want to take cmake from experimental to optional and may be even standard in time, then it has to go. We cannot make portable binaries if it is unset.



---

archive/issue_comments_314940.json:
```json
{
    "body": "Replying to [comment:22 fbissey]:\n> If we have it (and I guess it is a requirement for R nowadays) then yes go ahead. \n\nOK, `xz` is standard spkg, i am trying this right now.\n\n> I tested the removal of `unset MACOSX_DEPLOYMENT_TARGET` and I didn't observe any problem nor did I expect any. Further if we want to take cmake from experimental to optional and may be even standard in time, then it has to go. We cannot make portable binaries if it is unset.\n\nOK, great, iirc cgal (still to be packaged) and csympy rely on cmake, so it might be interesting in a near future.",
    "created_at": "2017-04-19T01:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314940",
    "user": "tmonteil"
}
```

Replying to [comment:22 fbissey]:
> If we have it (and I guess it is a requirement for R nowadays) then yes go ahead. 

OK, `xz` is standard spkg, i am trying this right now.

> I tested the removal of `unset MACOSX_DEPLOYMENT_TARGET` and I didn't observe any problem nor did I expect any. Further if we want to take cmake from experimental to optional and may be even standard in time, then it has to go. We cannot make portable binaries if it is unset.

OK, great, iirc cgal (still to be packaged) and csympy rely on cmake, so it might be interesting in a near future.



---

archive/issue_comments_314941.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-04-19T02:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314941",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_314942.json:
```json
{
    "body": "Tests still pass with Sage's xz.",
    "created_at": "2017-04-19T02:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314942",
    "user": "tmonteil"
}
```

Tests still pass with Sage's xz.



---

archive/issue_comments_314943.json:
```json
{
    "body": "Good, and presumably\n\n```\n./sage -sh\nldd -r local/bin/cmake\n```\n\nDoesn't report anything out of place.",
    "created_at": "2017-04-19T02:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314943",
    "user": "fbissey"
}
```

Good, and presumably

```
./sage -sh
ldd -r local/bin/cmake
```

Doesn't report anything out of place.



---

archive/issue_comments_314944.json:
```json
{
    "body": "I got:\n\n\n```\n\tlinux-vdso.so.1 (0x00007ffddb538000)\n\tlibz.so.1 => /opt/sagemath/sage-source/local/lib/libz.so.1 (0x00007f814f4e4000)\n\tliblzma.so.5 => /opt/sagemath/sage-source/local/lib/liblzma.so.5 (0x00007f814f2bf000)\n\tlibbz2.so.1 => /opt/sagemath/sage-source/local/lib/libbz2.so.1 (0x00007f814f0af000)\n\tlibcurl.so.4 => /opt/sagemath/sage-source/local/lib/libcurl.so.4 (0x00007f814ee48000)\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f814ec2b000)\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f814ea27000)\n\tlibrt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f814e81f000)\n\tlibstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f814e514000)\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f814e213000)\n\tlibgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f814dffd000)\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f814dc52000)\n\tlibssl.so.1.0.0 => /usr/lib/x86_64-linux-gnu/libssl.so.1.0.0 (0x00007f814d9f1000)\n\tlibcrypto.so.1.0.0 => /usr/lib/x86_64-linux-gnu/libcrypto.so.1.0.0 (0x00007f814d5f5000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00007f814f6fe000)\n```\n",
    "created_at": "2017-04-19T02:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314944",
    "user": "tmonteil"
}
```

I got:


```
	linux-vdso.so.1 (0x00007ffddb538000)
	libz.so.1 => /opt/sagemath/sage-source/local/lib/libz.so.1 (0x00007f814f4e4000)
	liblzma.so.5 => /opt/sagemath/sage-source/local/lib/liblzma.so.5 (0x00007f814f2bf000)
	libbz2.so.1 => /opt/sagemath/sage-source/local/lib/libbz2.so.1 (0x00007f814f0af000)
	libcurl.so.4 => /opt/sagemath/sage-source/local/lib/libcurl.so.4 (0x00007f814ee48000)
	libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f814ec2b000)
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f814ea27000)
	librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f814e81f000)
	libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f814e514000)
	libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f814e213000)
	libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f814dffd000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f814dc52000)
	libssl.so.1.0.0 => /usr/lib/x86_64-linux-gnu/libssl.so.1.0.0 (0x00007f814d9f1000)
	libcrypto.so.1.0.0 => /usr/lib/x86_64-linux-gnu/libcrypto.so.1.0.0 (0x00007f814d5f5000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f814f6fe000)
```




---

archive/issue_comments_314945.json:
```json
{
    "body": "Looks all right to me. Let's move to the next stage.",
    "created_at": "2017-04-19T02:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314945",
    "user": "fbissey"
}
```

Looks all right to me. Let's move to the next stage.



---

archive/issue_comments_314946.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-19T02:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314946",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314947.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-23T12:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314947",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_314948.json:
```json
{
    "body": "It perhaps makes sense to immediately go to cmake 3.8.1, released 2 weeks ago.",
    "created_at": "2017-05-14T22:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314948",
    "user": "dimpase"
}
```

It perhaps makes sense to immediately go to cmake 3.8.1, released 2 weeks ago.



---

archive/issue_comments_314949.json:
```json
{
    "body": "Well this ticket is already merged (8.0.beta5) so it would have to go in a new ticket. But sure let's do that if you also want to push it optional.",
    "created_at": "2017-05-14T22:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314949",
    "user": "fbissey"
}
```

Well this ticket is already merged (8.0.beta5) so it would have to go in a new ticket. But sure let's do that if you also want to push it optional.



---

archive/issue_comments_314950.json:
```json
{
    "body": "Replying to [comment:32 fbissey]:\n> Well this ticket is already merged (8.0.beta5) so it would have to go in a new ticket. But sure let's do that if you also want to push it optional.\n\nOK, this is now #22999, and yes, let us make it optional package, indeed.",
    "created_at": "2017-05-14T22:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314950",
    "user": "dimpase"
}
```

Replying to [comment:32 fbissey]:
> Well this ticket is already merged (8.0.beta5) so it would have to go in a new ticket. But sure let's do that if you also want to push it optional.

OK, this is now #22999, and yes, let us make it optional package, indeed.



---

archive/issue_comments_314951.json:
```json
{
    "body": "Changing keywords from \"days86\" to \"days86, sdl\".",
    "created_at": "2019-08-27T19:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22577#issuecomment-314951",
    "user": "tmonteil"
}
```

Changing keywords from "days86" to "days86, sdl".
