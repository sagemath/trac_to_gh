# Issue 11134: Upgrade unitary check for RDF/CDF matrices

Issue created by migration from Trac.

Original creator: rbeezer

Original creation time: 2011-05-06 13:26:00

Assignee: jason, was

CC:  jason

This is an upgrade of the `is_unitary()` method, based on experience building `is_normal()`, `is_hermitian()`.  (#10848, #11104)

One test is discovering a bug elsewhere (#11248), so needs to be adjusted slightly to preserve that discovery, though at this writing, the test is disabled (#11277).

(a)  Adds a "orthonormal" variant, which is now the default, based on the Schur decomposition, an idea used in the other two methods, but not considered here previously.

(b)  Makes the existing naive algorithm a bit more efficent by using the break command twice.

(c)  Fixes an ommission in the naive algorithm where the loop on `i` previously did not start at zero.

(d) Upgraded error-checking on tolerance parameter.

(e) Docstring upgraded to reflect changes above.

*Depends on:*
  1. #11027
  1. #10848
  1. #11277


---

Attachment

For the patchbot:

Depends on 11027, 10848, 11277


---

Comment by rbeezer created at 2011-05-06 13:33:22

Changing status from new to needs_review.


---

Comment by saliola created at 2011-05-08 18:28:10

Changing keywords from "" to "days30".


---

Comment by davidloeffler created at 2012-03-12 20:17:48

Looks good and passes doctests


---

Comment by davidloeffler created at 2012-03-12 20:17:48

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-03-14 15:48:33

There is some misformatting of the documentation (check [http://sagemath.org/doc/developer/conventions.html#documentation-strings](http://sagemath.org/doc/developer/conventions.html#documentation-strings) for a template):

```
dochtml.log:docstring of sage.matrix.matrix_double_dense.Matrix_double_dense.is_normal:29: WARNING: Literal block expected; none found.
dochtml.log:docstring of sage.matrix.matrix_double_dense.Matrix_double_dense.is_normal:46: WARNING: Literal block expected; none found.
dochtml.log:docstring of sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary:32: WARNING: Literal block expected; none found.
```



---

Comment by jdemeyer created at 2012-03-14 15:48:33

Changing status from positive_review to needs_work.


---

Attachment

Two of these aren't related to this ticket (I guess you were testing this and #11104 at the same time). The other one is fixed by the single-character patch above.


---

Comment by davidloeffler created at 2012-03-14 22:11:31

Changing status from needs_work to needs_review.


---

Comment by rbeezer created at 2012-03-15 00:00:46

Dear David,

Gotta love those one-character patches.  I'll get this reviewed as well.

Thanks for plowing though the "needs_rewview" backlog.

Rob


---

Comment by rbeezer created at 2012-03-15 01:51:47

Positive review.  I'm inclined to just leave the author/reviewer fields as-is, but if David wants to double them up, that's fine too.

Thanks for the review, David.


---

Comment by rbeezer created at 2012-03-15 01:51:47

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-03-21 22:04:26

Resolution: fixed
