# Issue 24220: rename sage.rings.real_mpfr.RealField

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2018-01-01 18:37:04

After #24456, `sage.rings.real_field.RealField` will be the parent for the set of real numbers. As a consequence, it would be wise to change the name of `sage.rings.real_mpfr.RealField` to `RealFloatingPointField`.


---

Comment by rws created at 2018-01-02 14:31:23

In `real_mpfr.pyx` do you mean to rename `cpdef RealField(int prec=53,...)` or `cdef class RealField_class`?


---

Comment by rws created at 2018-01-03 08:31:40

Changing status from new to needs_review.


---

Comment by rws created at 2018-01-03 08:31:40

This commit changes 164 files. Preliminary testing passes in rings and src/doc. There might be subtle errors introduced in the documentation. Let's try the patchbots.
----
New commits:


---

Comment by rws created at 2018-01-03 08:32:40

Ah I forgot the string representation part.


---

Comment by rws created at 2018-01-03 08:40:56

Changing status from needs_review to needs_work.


---

Comment by rws created at 2018-01-03 08:40:56

Sorry, I was pretty sure I excluded `real_field.py`.


---

Comment by rws created at 2018-01-03 14:21:19

After changing the string representation as well:
` 223 files changed, 1493 insertions(+), 1493 deletions(-)`. I don't have hopes this gets through, except maybe in a beta of its own.
----
New commits:


---

Comment by rws created at 2018-01-03 14:21:19

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2018-01-03 14:45:52

Replying to [ticket:24457 vdelecroix]:
> - change the name of `RealField`/`RealField_class` to `RealFloatingPointField`/`RealFloatingPointField_class`

Do we still need the old `RealField` given that it's no longer used after #24456?


---

Comment by rws created at 2018-01-03 14:57:41

Changing status from needs_review to needs_work.


---

Comment by rws created at 2018-01-03 15:30:35

Changing status from needs_work to needs_review.


---

Comment by rws created at 2018-01-03 15:30:35

New commits:


---

Comment by vdelecroix created at 2018-01-03 15:38:01

Replying to [comment:11 jdemeyer]:
> Replying to [ticket:24457 vdelecroix]:
> > - change the name of `RealField`/`RealField_class` to `RealFloatingPointField`/`RealFloatingPointField_class`
> 
> Do we still need the old `RealField` given that it's no longer used after #24456?

It is. The old real field is the field of floating point numbers that is intensively used (and renamed in this ticket). The new real field is the field of real numbers (the real one).


---

Comment by jdemeyer created at 2018-01-03 15:58:29

Replying to [comment:15 vdelecroix]:
> The old real field is the field of floating point numbers that is intensively used (and renamed in this ticket).

I was talking about the `RealField()` *function*. Is that still used?

If so, I would rather rename it to `create_RealFloatingPointField`.


---

Comment by vdelecroix created at 2018-01-03 16:05:20

Replying to [comment:16 jdemeyer]:
> Replying to [comment:15 vdelecroix]:
> > The old real field is the field of floating point numbers that is intensively used (and renamed in this ticket).
> 
> I was talking about the `RealField()` *function*. Is that still used?
> 
> If so, I would rather rename it to `create_RealFloatingPointField`.

I think that we should get rid of this function and the hand made cache. The caching would better be handled by `UniqueRepresentation` by appropriately writing `__classcall__`/`__init__`. This class is very old.


---

Comment by vdelecroix created at 2018-01-03 16:05:34

Replying to [comment:17 vdelecroix]:
> Replying to [comment:16 jdemeyer]:
> > Replying to [comment:15 vdelecroix]:
> > > The old real field is the field of floating point numbers that is intensively used (and renamed in this ticket).
> > 
> > I was talking about the `RealField()` *function*. Is that still used?
> > 
> > If so, I would rather rename it to `create_RealFloatingPointField`.
> 
> I think that we should get rid of this function and the hand made cache. The caching would better be handled by `UniqueRepresentation` by appropriately writing `__classcall__`/`__init__`. This class is very old.

But this is rather disjoint from this ticket.


---

Comment by vdelecroix created at 2018-01-03 16:06:17

Replying to [comment:16 jdemeyer]:
> Replying to [comment:15 vdelecroix]:
> > The old real field is the field of floating point numbers that is intensively used (and renamed in this ticket).
> 
> I was talking about the `RealField()` *function*. Is that still used?
> 
> If so, I would rather rename it to `create_RealFloatingPointField`.

For the sake of this ticket +1.


---

Comment by rws created at 2018-01-03 16:10:50

Replying to [comment:19 vdelecroix]:
> Replying to [comment:16 jdemeyer]:
> > If so, I would rather rename it to `create_RealFloatingPointField`.
> 
> For the sake of this ticket +1.

You mean "in this ticket"?


---

Comment by vdelecroix created at 2018-01-03 16:11:57

Replying to [comment:20 rws]:
> Replying to [comment:19 vdelecroix]:
> > Replying to [comment:16 jdemeyer]:
> > > If so, I would rather rename it to `create_RealFloatingPointField`.
> > 
> > For the sake of this ticket +1.
> 
> You mean "in this ticket"?

Sorry for my english. Yes, this is what I meant.


---

Comment by rws created at 2018-01-03 16:22:47

> > > Replying to [comment:16 jdemeyer]:
> > > > If so, I would rather rename it to `create_RealFloatingPointField`.

Ah I see, in `rings/all.py`: `import create_RealFloatingPointField as RealFloatingPointField`.


---

Comment by git created at 2018-01-04 14:31:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tmonteil created at 2018-01-05 01:33:34

Some quick comments:

- why renaming `RealField` and not `RR` at the same time ?
- i am not sure that completely changing the behaviour of `RealField` without any kind of deprecation period is wise, how will the user's code survive to this change ?
- do you really plan to change a behaviour that implies modifying 164 files without even an email to sage-devel ?
- Regarding the naming, i would personally prefer `Floating-point` over `Floating Point` (as it is usually), moreover, it has the advantage that the shortcut will be `RFF` (not `RFPF`), consistently with other representations of real numbers.
- where is the doc ?


---

Comment by rws created at 2018-01-05 07:09:50

It's in the experimental phase. I will need an IDE with refactoring capabilities to do this reliably and quickly, or develop scripts. Also, I think it will need its own beta.


---

Comment by rws created at 2018-01-05 07:09:50

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2018-01-05 08:59:38

Replying to [comment:26 tmonteil]:
> Some quick comments:
> 
> - why renaming `RealField` and not `RR` at the same time ?

why not. But it will
- be a much more delicate backward incompatibility.
- make the ticket even bigger
The 2 steps transition seems simpler to me.

> - i am not sure that completely changing the behaviour of `RealField` without any kind of deprecation period is wise, how will the user's code survive to this change ?

There *must* be deprecation about the name changes (which is not the case in the current branch). `RealField` shoud still point to the `FloatingPointField` (with deprecation) and `RR` should still point to `RFF` (with deprecation).

I don't think there is a need for deprecation about the change of printing.

> - do you really plan to change a behaviour that implies modifying 164 files without even an email to sage-devel ?
> - Regarding the naming, i would personally prefer `Floating-point` over `Floating Point` (as it is usually), moreover, it has the advantage that the shortcut will be `RFF` (not `RFPF`), consistently with other representations of real numbers.

+1 for Floating-point.

> - where is the doc ?


---

Comment by rws created at 2018-01-08 15:26:58

I'm confused. You deleted the description item that renames `RealField/RealField_class` in comment:29. Does that mean those refactorings are not planned in this ticket? On the other hand you write `isinstance(x, RealFloatingPointField)` so the new name is used?

As to automating this and other big refactorings in Python Sage I just learned that 1. Pycharm refactoring apparently cannot be scripted (not to be expected anyway in an IDE), and 2. the rope tool is not up to the task.


---

Comment by rws created at 2018-01-11 09:44:59

The deprecation of `is_RealNumber(x)`/`is_RealField(x)` in favor of `isinstance` can be done independently of the renaming. Separate ticket to come.


---

Comment by vdelecroix created at 2018-01-11 09:56:49

Replying to [comment:36 rws]:
> The deprecation of `is_RealNumber(x)`/`is_RealField(x)` in favor of `isinstance` can be done independently of the renaming. Separate ticket to come.

Good idea!


---

Comment by rws created at 2018-01-11 16:27:04

Note that `is_RealField(X)` then becomes `isinstance(X, RealField_class)`.


---

Comment by vdelecroix created at 2018-01-11 18:24:24

Changing type from enhancement to task.


---

Comment by vdelecroix created at 2018-01-11 18:26:25

Let us do that incrementally (ie each subtask in ticket). It will simplify review and merging. Though I would feel much more confortable if the whole task would be actually closed within the next stable release.


---

Comment by vdelecroix created at 2018-01-11 18:41:49

Replying to [comment:37 vdelecroix]:
> Replying to [comment:36 rws]:
> > The deprecation of `is_RealNumber(x)`/`is_RealField(x)` in favor of `isinstance` can be done independently of the renaming. Separate ticket to come.
> 
> Good idea!

Though it would be better to first change the names:
 - `RealField` -> `RealFloatingPointField_factory`
 - `RealField_class` -> `RealFloatingPointField`
 - `RealNumber` -> `RealFloatingPoint`
to avoid passing twice on the same lines.


---

Comment by rws created at 2018-02-23 16:56:44

Rebased on the remaining dependency.


---

Comment by rws created at 2018-02-23 16:56:44

Changing status from needs_work to needs_review.


---

Comment by rws created at 2018-02-23 16:58:33

Changing status from needs_review to needs_work.


---

Comment by rws created at 2018-02-23 16:58:33

OOps wrong ticket.


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4
