# Issue 33017: Unhandled SIGSEGV: A segmentation fault occurred.

Issue created by migration from https://trac.sagemath.org/ticket/33254

Original creator: @umedoblock

Original creation time: 2022-01-31 05:02:16

CC:  slelievre

# sagemath-9-5
Sage Logo Sage 9.4 Reference Manual: 2D Graphics » 2D Plotting

[We exclude all points where PrimePi makes a jump:](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/plot.html)

SEGV occurred after run below EXAMPLES:


```
sage: jumps = [n for n in [1..100] if prime_pi(n) != prime_pi(n-1)]
sage: plot(lambda x: prime_pi(x), (x, 1, 100), exclude=jumps)
```


## Command line, Terminal.app

```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.5.rc2, Release Date: 2022-01-16                 │
│ Using Python 3.9.9. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```




```
sage: sage: jumps = [n for n in [1..100] if prime_pi(n) != prime_pi(n-1)] 
....: sage: plot(lambda x: prime_pi(x), (x, 1, 100), exclude=jumps)             
------------------------------------------------------------------------
(no backtrace available)
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------
zsh: segmentation fault  

Saving session...completed.
```


## Jupyter notebook from folder:

```
Kernel Restarting
The kernel appears to have died. It will restart automatically.
```



---

Comment by @umedoblock created at 2022-01-31 05:08:43

# environment


```
macOS Monterey
Version 12.1
```



---

Comment by @umedoblock created at 2022-01-31 05:40:31

I tried to run all of the 
[EXAMPLES](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/plot.html).

And I found only one SEVG.


---

Comment by slelievre created at 2022-01-31 09:35:38

Changing type from PLEASE CHANGE to defect.


---

Comment by slelievre created at 2022-01-31 09:35:38

Changing keywords from "" to "crash, segfault".


---

Comment by slelievre created at 2022-01-31 09:35:38

Changing component from PLEASE CHANGE to graphics.


---

Comment by @umedoblock created at 2022-02-02 17:56:24

I tried to run some EXAMPLEs in [Step function plots](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/step.html)

## environment

```
macOS Monterey
Version 12.1
```



```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.5.rc2, Release Date: 2022-01-16                 │
│ Using Python 3.9.9. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```


# cause of prime_pi(i)?

## EXAMPLE


```
sage: plot_step_function([(i,prime_pi(i)) for i in range(20)]) 
....:                                                                           
------------------------------------------------------------------------
(no backtrace available)
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------
zsh: segmentation fault  

Saving session...completed.
```



---

Comment by @DaveWitteMorris created at 2022-07-08 04:59:00

This may be a duplicate of #34117 (Segfault for prime_pi on macOS).


---

Comment by mkoeppe created at 2022-07-08 18:05:04

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2022-07-08 20:32:16

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2022-07-14 13:43:33

Resolution: invalid
