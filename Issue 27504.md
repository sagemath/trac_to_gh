# Issue 27504: bug in sympy conversion of hypergeometric with tuple arg of length 1

archive/issues_027504.json:
```json
{
    "body": "CC:  @rwst @tscrim\n\nThis fails, because the argument [1] is converted to (1) by the symbolic ring, and then to 1 by sympy itself. Sigh.\n\n```\nsage: from sage.symbolic.expression_conversions import sympy_converter\nsage: F=hypergeometric([1/3,2/3],[1,1],x)\nsage: F._sympy_()\nhyper((1/3, 2/3), (1, 1), x)\nsage: F=hypergeometric([1/3,2/3],[1],x)\nsage: F._sympy_()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-61-3877d08c877a> in <module>()\n----> 1 F._sympy_()\n\n/home/chapoton/sage3/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._sympy_ (build/cythonized/sage/symbolic/expression.cpp:11351)()\n   1456         \"\"\"\n   1457         from sage.symbolic.expression_conversions import sympy_converter\n-> 1458         return sympy_converter(self)\n   1459 \n   1460     def _fricas_init_(self):\n\n/home/chapoton/sage3/local/lib/python3.7/site-packages/sage/symbolic/expression_conversions.py in __call__(self, ex)\n    223             return self.tuple(ex)\n    224         else:\n--> 225             return self.composition(ex, operator)\n    226 \n    227     def get_fake_div(self, ex):\n\n/home/chapoton/sage3/local/lib/python3.7/site-packages/sage/symbolic/expression_conversions.py in composition(self, ex, operator)\n    791         f_sympy = getattr(sympy, f, None)\n    792         if f_sympy:\n--> 793             return f_sympy(*sympy.sympify(g, evaluate=False))\n    794         else:\n    795             return sympy.Function(str(f))(*g, evaluate=False)\n\n/home/chapoton/sage3/local/lib/python3.7/site-packages/sympy/functions/special/hyper.py in __new__(cls, ap, bq, z)\n    181     def __new__(cls, ap, bq, z):\n    182         # TODO should we check convergence conditions?\n--> 183         return Function.__new__(cls, _prep_tuple(ap), _prep_tuple(bq), z)\n    184 \n    185     @classmethod\n\n/home/chapoton/sage3/local/lib/python3.7/site-packages/sympy/functions/special/hyper.py in _prep_tuple(v)\n     43     \"\"\"\n     44     from sympy import unpolarify\n---> 45     return TupleArg(*[unpolarify(x) for x in v])\n     46 \n     47 \n\nTypeError: 'One' object is not iterable\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/27741\n\n",
    "closed_at": "2019-05-06T11:56:14Z",
    "created_at": "2019-04-28T09:09:59Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "bug in sympy conversion of hypergeometric with tuple arg of length 1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27504",
    "user": "https://github.com/fchapoton"
}
```
CC:  @rwst @tscrim

This fails, because the argument [1] is converted to (1) by the symbolic ring, and then to 1 by sympy itself. Sigh.

```
sage: from sage.symbolic.expression_conversions import sympy_converter
sage: F=hypergeometric([1/3,2/3],[1,1],x)
sage: F._sympy_()
hyper((1/3, 2/3), (1, 1), x)
sage: F=hypergeometric([1/3,2/3],[1],x)
sage: F._sympy_()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-61-3877d08c877a> in <module>()
----> 1 F._sympy_()

/home/chapoton/sage3/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._sympy_ (build/cythonized/sage/symbolic/expression.cpp:11351)()
   1456         """
   1457         from sage.symbolic.expression_conversions import sympy_converter
-> 1458         return sympy_converter(self)
   1459 
   1460     def _fricas_init_(self):

/home/chapoton/sage3/local/lib/python3.7/site-packages/sage/symbolic/expression_conversions.py in __call__(self, ex)
    223             return self.tuple(ex)
    224         else:
--> 225             return self.composition(ex, operator)
    226 
    227     def get_fake_div(self, ex):

/home/chapoton/sage3/local/lib/python3.7/site-packages/sage/symbolic/expression_conversions.py in composition(self, ex, operator)
    791         f_sympy = getattr(sympy, f, None)
    792         if f_sympy:
--> 793             return f_sympy(*sympy.sympify(g, evaluate=False))
    794         else:
    795             return sympy.Function(str(f))(*g, evaluate=False)

/home/chapoton/sage3/local/lib/python3.7/site-packages/sympy/functions/special/hyper.py in __new__(cls, ap, bq, z)
    181     def __new__(cls, ap, bq, z):
    182         # TODO should we check convergence conditions?
--> 183         return Function.__new__(cls, _prep_tuple(ap), _prep_tuple(bq), z)
    184 
    185     @classmethod

/home/chapoton/sage3/local/lib/python3.7/site-packages/sympy/functions/special/hyper.py in _prep_tuple(v)
     43     """
     44     from sympy import unpolarify
---> 45     return TupleArg(*[unpolarify(x) for x in v])
     46 
     47 

TypeError: 'One' object is not iterable
```

Issue created by migration from https://trac.sagemath.org/ticket/27741





---

archive/issue_comments_387329.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-04-28T09:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387329",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_387330.json:
```json
{
    "body": "green bot, please review",
    "created_at": "2019-04-28T11:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387330",
    "user": "https://github.com/fchapoton"
}
```

green bot, please review



---

archive/issue_comments_387331.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-28T12:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387331",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_387332.json:
```json
{
    "body": "Makes sense and LGTM. By comment:2, I am assuming this is ready for review.",
    "created_at": "2019-04-28T12:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387332",
    "user": "https://github.com/tscrim"
}
```

Makes sense and LGTM. By comment:2, I am assuming this is ready for review.



---

archive/issue_comments_387333.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-28T12:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387333",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_387334.json:
```json
{
    "body": "If not, please revert.",
    "created_at": "2019-04-28T12:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387334",
    "user": "https://github.com/tscrim"
}
```

If not, please revert.



---

archive/issue_comments_387335.json:
```json
{
    "body": "yes, thanks a lot for the super-fast review!",
    "created_at": "2019-04-28T12:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387335",
    "user": "https://github.com/fchapoton"
}
```

yes, thanks a lot for the super-fast review!



---

archive/issue_comments_387336.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-05-06T11:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27504#issuecomment-387336",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_068780.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-06T11:56:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27504",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27504#event-68780"
}
```
