# Issue 25621: mpir build failures with some Haswell CPUs

archive/issues_025621.json:
```json
{
    "body": "See https://github.com/wbhart/mpir/pull/252\n\nIssue created by migration from https://trac.sagemath.org/ticket/25858\n\n",
    "created_at": "2018-07-13T13:12:43Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "mpir build failures with some Haswell CPUs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25621",
    "user": "https://github.com/embray"
}
```
See https://github.com/wbhart/mpir/pull/252

Issue created by migration from https://trac.sagemath.org/ticket/25858





---

archive/issue_comments_360931.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360931",
    "user": "https://github.com/embray"
}
```

New commits:



---

archive/issue_comments_360932.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360932",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_360933.json:
```json
{
    "body": "You can set this to a positive review if upstream accepts the PR.",
    "created_at": "2018-07-13T14:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360933",
    "user": "https://github.com/tscrim"
}
```

You can set this to a positive review if upstream accepts the PR.



---

archive/issue_comments_360934.json:
```json
{
    "body": "I believe this issue can reasonably be addressed for Sage 8.4.",
    "created_at": "2018-07-18T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360934",
    "user": "https://github.com/embray"
}
```

I believe this issue can reasonably be addressed for Sage 8.4.



---

archive/issue_comments_360935.json:
```json
{
    "body": "Got confirmation from Odile that this patch works.\n\nIf possible I'd like to get this in 8.3 actually, but admittedly adding a patch to MPIR is a big rebuild, and it also affects only a few rare machines and has an easy workaround e.g. building MPIR with `--build=skylake` or some other earlier architecture.",
    "created_at": "2018-07-23T10:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360935",
    "user": "https://github.com/embray"
}
```

Got confirmation from Odile that this patch works.

If possible I'd like to get this in 8.3 actually, but admittedly adding a patch to MPIR is a big rebuild, and it also affects only a few rare machines and has an easy workaround e.g. building MPIR with `--build=skylake` or some other earlier architecture.



---

archive/issue_comments_360936.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-23T10:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360936",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_360937.json:
```json
{
    "body": "I am much more split on this ticket (than the one that only affects Cygwin) as it could have more unintended side-effects. I am slightly on the side of waiting until 8.4 and having this go through beta cycles. If we get posts on sage-devel, you have at least seen the error and know the workaround. Plus this will only affect people building it from source on these rare machines, so the chances of someone being afflicted are marginal.",
    "created_at": "2018-07-23T10:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360937",
    "user": "https://github.com/tscrim"
}
```

I am much more split on this ticket (than the one that only affects Cygwin) as it could have more unintended side-effects. I am slightly on the side of waiting until 8.4 and having this go through beta cycles. If we get posts on sage-devel, you have at least seen the error and know the workaround. Plus this will only affect people building it from source on these rare machines, so the chances of someone being afflicted are marginal.



---

archive/issue_comments_360938.json:
```json
{
    "body": "I agree, it's pretty marginal.",
    "created_at": "2018-07-23T13:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360938",
    "user": "https://github.com/embray"
}
```

I agree, it's pretty marginal.



---

archive/issue_comments_360939.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25621#issuecomment-360939",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_023848.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2018-08-05T08:16:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25621",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25621#event-23848"
}
```
