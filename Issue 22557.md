# Issue 22557: OSX Xcode 8.3 breaks openblas

Issue created by migration from https://trac.sagemath.org/ticket/22794

Original creator: vbraun

Original creation time: 2017-04-10 22:17:47

See discussion at https://groups.google.com/d/msg/sage-devel/l8cjpVwQcGc/y25zvHsMDgAJ

The most recent Xcode update seems to have broken openblas on the OSX buildbot. Build log errors start at:


gcc -c -O2 -DMAX_STACK_ALLOC=2048 -DEXPRECISION -m128bit-long-double -Wall -m64 -DF_INTERFACE_GFORT -fPIC -DNO_WARMUP -DMAX_CPU_NUMBER=8 -DASMNAME=_ -DASMFNAME=__ -DNAME=_ -DCNAME= -DCHAR_NAME="_" -DCHAR_CNAME="" -DNO_AFFINITY -I. -DHAVE_LAPACK_CONFIG_H -I ../include -o lapacke_make_complex_double.o lapacke_make_complex_double.c
ar -ru ../../../libopenblas_sandybridge-r0.2.19.a lapacke_cgb_nancheck.o lapacke_cgb_trans.o lapacke_cge_nancheck.o lapacke_cge_trans.o lapacke_cgg_nancheck.o lapacke_cgg_trans.o lapacke_cgt_nancheck.o lapacke_chb_nancheck.o lapacke_chb_trans.o lapacke_che_nancheck.o lapacke_che_trans.o lapacke_chp_nancheck.o lapacke_chp_trans.o lapacke_chs_nancheck.o lapacke_chs_trans.o lapacke_c_nancheck.o lapacke_cpb_nancheck.o lapacke_cpb_trans.o lapacke_cpf_nancheck.o lapacke_cpf_trans.o lapacke_cpo_nancheck.o lapacke_cpo_trans.o lapacke_cpp_nancheck.o lapacke_cpp_trans.o lapacke_cpt_nancheck.o lapacke_csp_nancheck.o lapacke_csp_trans.o lapacke_cst_nancheck.o lapacke_csy_nancheck.o lapacke_csy_trans.o lapacke_ctb_nancheck.o lapacke_ctb_trans.o lapacke_ctf_nancheck.o lapacke_ctf_trans.o lapacke_ctp_nancheck.o lapacke_ctp_trans.o lapacke_ctr_nancheck.o lapacke_ctr_trans.o lapacke_dgb_nancheck.o lapacke_dgb_trans.o lapacke_dge_nancheck.o lapacke_dge_trans.o lapacke_dgg_nancheck.o lapacke_dgg_trans.o lapacke_dgt_nancheck.o lapacke_dhs_nancheck.o lapacke_dhs_trans.o lapacke_d_nancheck.o lapacke_dpb_nancheck.o lapacke_dpb_trans.o lapacke_dpf_nancheck.o lapacke_dpf_trans.o lapacke_dpo_nancheck.o lapacke_dpo_trans.o lapacke_dpp_nancheck.o lapacke_dpp_trans.o lapacke_dpt_nancheck.o lapacke_dsb_nancheck.o lapacke_dsb_trans.o lapacke_dsp_nancheck.o lapacke_dsp_trans.o lapacke_dst_nancheck.o lapacke_dsy_nancheck.o lapacke_dsy_trans.o lapacke_dtb_nancheck.o lapacke_dtb_trans.o lapacke_dtf_nancheck.o lapacke_dtf_trans.o lapacke_dtp_nancheck.o lapacke_dtp_trans.o lapacke_dtr_nancheck.o lapacke_dtr_trans.o lapacke_lsame.o lapacke_sgb_nancheck.o lapacke_sgb_trans.o lapacke_sge_nancheck.o lapacke_sge_trans.o lapacke_sgg_nancheck.o lapacke_sgg_trans.o lapacke_sgt_nancheck.o lapacke_shs_nancheck.o lapacke_shs_trans.o lapacke_s_nancheck.o lapacke_spb_nancheck.o lapacke_spb_trans.o lapacke_spf_nancheck.o lapacke_spf_trans.o lapacke_spo_nancheck.o lapacke_spo_trans.o lapacke_spp_nancheck.o lapacke_spp_trans.o lapacke_spt_nancheck.o lapacke_ssb_nancheck.o lapacke_ssb_trans.o lapacke_ssp_nancheck.o lapacke_ssp_trans.o lapacke_sst_nancheck.o lapacke_ssy_nancheck.o lapacke_ssy_trans.o lapacke_stb_nancheck.o lapacke_stb_trans.o lapacke_stf_nancheck.o lapacke_stf_trans.o lapacke_stp_nancheck.o lapacke_stp_trans.o lapacke_str_nancheck.o lapacke_str_trans.o lapacke_xerbla.o lapacke_zgb_nancheck.o lapacke_zgb_trans.o lapacke_zge_nancheck.o lapacke_zge_trans.o lapacke_zgg_nancheck.o lapacke_zgg_trans.o lapacke_zgt_nancheck.o lapacke_zhb_nancheck.o lapacke_zhb_trans.o lapacke_zhe_nancheck.o lapacke_zhe_trans.o lapacke_zhp_nancheck.o lapacke_zhp_trans.o lapacke_zhs_nancheck.o lapacke_zhs_trans.o lapacke_z_nancheck.o lapacke_zpb_nancheck.o lapacke_zpb_trans.o lapacke_zpf_nancheck.o lapacke_zpf_trans.o lapacke_zpo_nancheck.o lapacke_zpo_trans.o lapacke_zpp_nancheck.o lapacke_zpp_trans.o lapacke_zpt_nancheck.o lapacke_zsp_nancheck.o lapacke_zsp_trans.o lapacke_zst_nancheck.o lapacke_zsy_nancheck.o lapacke_zsy_trans.o lapacke_ztb_nancheck.o lapacke_ztb_trans.o lapacke_ztf_nancheck.o lapacke_ztf_trans.o lapacke_ztp_nancheck.o lapacke_ztp_trans.o lapacke_ztr_nancheck.o lapacke_ztr_trans.o lapacke_make_complex_float.o lapacke_make_complex_double.o
ranlib ../../../libopenblas_sandybridge-r0.2.19.a
make[4]: warning: -jN forced in submake: disabling jobserver mode.
perl ./gensymbol osx x86_64 _ 1 0  0 0 0 0 "" "" 1 > osx.def
gcc -O2 -DMAX_STACK_ALLOC=2048 -DEXPRECISION -m128bit-long-double -Wall -m64 -DF_INTERFACE_GFORT -fPIC -DNO_WARMUP -DMAX_CPU_NUMBER=8 -DASMNAME=_ -DASMFNAME=__ -DNAME=_ -DCNAME= -DCHAR_NAME=\"_\" -DCHAR_CNAME=\"\" -DNO_AFFINITY -I.. -all_load -headerpad_max_install_names -install_name "/Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/openblas-0.2.19.p0/src/exports/../libopenblas_sandybridge-r0.2.19.dylib" -dynamiclib -o ../libopenblas_sandybridge-r0.2.19.dylib ../libopenblas_sandybridge-r0.2.19.a -Wl,-exported_symbols_list,osx.def  -L/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib/gcc/x86_64-apple-darwin16.5.0/5.4.0 -L/Users/buildslave-sage/slave/sage_git/build/local/lib/gcc/x86_64-apple-darwin16.5.0/5.4.0/../../.. -L/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib/gcc/x86_64-apple-darwin16.5.0/5.4.0 -L/Users/buildslave-sage/slave/sage_git/build/local/lib/gcc/x86_64-apple-darwin16.5.0/5.4.0/../../..  -lgfortran -lSystem -lquadmath -lm -lSystem -lgfortran -lSystem -lquadmath -lm -lSystem  
Undefined symbols for architecture x86_64:
  "_camax_k", referenced from:
      _scamax_ in libopenblas_sandybridge-r0.2.19.a(scamax.o)
  "_camin_k", referenced from:
      _scamin_ in libopenblas_sandybridge-r0.2.19.a(scamin.o)
      _ctrtri_ in libopenblas_sandybridge-r0.2.19.a(ctrtri.o)
  "_casum_k", referenced from:
      _scasum_ in libopenblas_sandybridge-r0.2.19.a(scasum.o)
      _cblas_scasum in libopenblas_sandybridge-r0.2.19.a(cblas_scasum.o)
  "_caxpby_k", referenced from:
      _caxpby_ in libopenblas_sandybridge-r0.2.19.a(caxpby.o)
      _cblas_caxpby in libopenblas_sandybridge-r0.2.19.a(cblas_caxpby.o)
  "_caxpy_k", referenced from:
      _caxpy_ in libopenblas_sandybridge-r0.2.19.a(caxpy.o)
      _cblas_caxpy in libopenblas_sandybridge-r0.2.19.a(cblas_caxpy.o)
      _cgbmv_n in libopenblas_sandybridge-r0.2.19.a(cgbmv_n.o)
      _cgbmv_o in libopenblas_sandybridge-r0.2.19.a(cgbmv_o.o)
      _chbmv_U in libopenblas_sandybridge-r0.2.19.a(chbmv_U.o)
      _chbmv_L in libopenblas_sandybridge-r0.2.19.a(chbmv_L.o)
      _cher_U in libopenblas_sandybridge-r0.2.19.a(cher_U.o)



---

Comment by vbraun created at 2017-04-10 22:24:00

Changing status from new to needs_review.


---

Comment by vbraun created at 2017-04-10 22:24:00

New commits:


---

Comment by fbissey created at 2017-04-11 21:13:40

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2017-04-11 21:13:40

You are the only person who has shown a sandybridge mac so far. But I am ready to give a positive review on the ground that upstream merged it.


---

Comment by vbraun created at 2017-04-12 20:13:00

Resolution: fixed
