# Issue 13414: Doctest coverage to rings

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2012-10-19 00:40:18

Assignee: tscrim

CC:  kini

Keywords: doctests

Adding doctests to

* `rings/complex*`
* `rings/homset.py`
* `rings/ideal.py`
* `rings/rational*`

as part of #12024 and cleaning up documentation.


---

Comment by tscrim created at 2012-10-21 06:05:40

The dependency on #13634 is for the output of scientific notation of complex interval field.


---

Comment by tscrim created at 2012-10-22 01:46:32

Changing status from new to needs_review.


---

Comment by tscrim created at 2012-10-22 01:46:32

If someone is willing to review this, please also review the smaller #13634. Thank you.


---

Comment by tscrim created at 2012-11-03 01:28:45

Adding #12802 as a dependency since it modifies `ideal.py`. I will upload a rebased patch in the near future once I finish `rings/real*`.


---

Comment by tscrim created at 2012-11-03 19:14:06

Ready for review.


---

Comment by tscrim created at 2012-11-05 03:11:18

<edit>Removed patchbot message</edit>


---

Comment by vbraun created at 2012-11-06 02:29:09

The doctests fail, you need separate # 32bit  / # 64bit cases for the `__hash__`'es


---

Comment by tscrim created at 2012-11-06 21:00:03

Replying to [comment:6 vbraun]:
> The doctests fail, you need separate # 32bit  / # 64bit cases for the `__hash__`'es

What's the best way to do so? Thanks.


---

Comment by vbraun created at 2012-11-06 21:04:37

Here is an example from sage/rings/polynomial/infinite_polynomial_element.py

```
    def _hash_(self):
        """
        TESTS::

            sage: X.<x> = InfinitePolynomialRing(QQ)
            sage: a = x[0] + x[1]
            sage: hash(a) # indirect doctest
            -6172640511012239345   # 64-bit
            -957478897             # 32-bit

        """
        return hash(self._p)
```



---

Comment by tscrim created at 2012-11-06 22:33:49

Changed. Thank you.

Edit:

For patchbot:

Apply: trac_13618-rings_doc-ts.patch


---

Comment by jdemeyer created at 2013-02-05 19:17:17

It would be a pity to lose all this work, any chance it can be rebased and fixed?


---

Comment by jdemeyer created at 2013-02-05 19:17:17

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2013-02-05 19:32:26

I'll upgrade my version of sage tonight and rebase it.


---

Comment by tscrim created at 2013-02-06 15:16:31

I've rebased and split it into 3 more manageable files.

For patchbot:

Apply: attachment:trac_13618-rings_doc_real-ts.patch, trac_13618-rings_doc_complex-ts.patch, trac_13618-rings_doc_others-ts.patch


---

Comment by tscrim created at 2013-02-06 15:16:31

Changing status from needs_work to needs_review.


---

Comment by knsam created at 2013-02-10 11:54:50

I hereby intend to review a part of this ticket: the `real*` bit. I will come up with comments, if any in a few hours. ~KnS


---

Comment by knsam created at 2013-02-10 13:16:45

Oops!! I applied the `real*` patch but tests fail! sage -t real* spits out a whole bunch of error on Sage 5.7.beta4 (I am on a ubuntu 12.04 64 bit box). 

Could you point me the mistake I am making?


---

Comment by tscrim created at 2013-02-10 14:00:21

Hmmm...did the patch apply cleanly? What are the errors?

Also, you should apply the complex* part since that adds a few of the real* files to the doc.

Best,

Travis


---

Comment by tscrim created at 2013-02-16 03:20:08

For the record, this also takes care of #13383.


---

Comment by vbraun created at 2013-02-17 13:06:49

I've looked through the other two patches and they look good to me except that there is lots of unnecessary whitespace change. This does nothing but break other patches on trac. We'll programmatically remove trailing whitespace when we change to git. Can you go through them and at least remove the patch hunks that do nothing but whitespace change? Like this

```
[...]
`@``@` -359,9 +422,9 `@``@` class Ideal_generic(MonoidElement):
     def base_ring(self):
         r"""
         Returns the base ring of this ideal.
-        
+
         EXAMPLES::
-        
+
             sage: R = ZZ
             sage: I = 3*R; I
             Principal ideal (3) of Integer Ring
`@``@` -370,16 +433,16 `@``@` class Ideal_generic(MonoidElement):
[...]
```

Kannappan, are you still reviewing the "real" patch?


---

Comment by knsam created at 2013-02-17 17:30:01

Oops! Sorry for the delay!! I had to look through, because reviewing doctests is new to me. But, I have just finished it! 

Here are some trivial comments, rectifying these as necessary should give this positive review: 

1. In `real_double`, `real_mpfr`: It might be nice if we codify the PARI commands too. For instance, the algorithm for `algebraic_dependence()` and `algdep()`, we refer to the PARI command `algdep`. 
2. In `real_mpfi`: In the documentation for the method `str()`, could you please use `\cdot` instead of `*`? 
3. In `real_interval_absolute`: Some docstrings are too short to be useful; we'd also would have to look into the grammar and codify appropriate things like self. The example for `upper()` is not formatted properly. (I'd be totally OK if this goes into another ticket.) 

Else, as I said, this is fantastic! 

~KnS


---

Attachment

Everything else


---

Comment by tscrim created at 2013-02-17 19:19:21

Alright, I've removed all the whitespace hunks I could find and addressed all of Kannappan's comments as much as I could. Thank you both for reviewing this!

Thank you,

Travis

PS - Also incase anyone is feeling extra generous (or wants me to owe them another favor) there's also the followup #13685.


---

Comment by vbraun created at 2013-02-17 20:59:20

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-19 10:51:56

This needs to be rebased to #6495.


---

Comment by jdemeyer created at 2013-02-19 10:51:56

Changing status from positive_review to needs_work.


---

Attachment

Rebased


---

Comment by tscrim created at 2013-02-19 15:56:30

Rebased


---

Comment by tscrim created at 2013-02-19 15:57:31

Changing status from needs_work to positive_review.


---

Attachment

Rebased.


---

Comment by jdemeyer created at 2013-02-20 10:25:39

Congratulations!


```
Overall weighted coverage score:  90.6%
Total number of functions:  31495
We need 1397 more functions to get to 95% coverage.
We need 2657 more functions to get to 99% coverage.
```



---

Comment by tscrim created at 2013-02-21 17:21:32

Replying to [comment:26 jdemeyer]:
> Congratulations!
> 
> {{{
> Overall weighted coverage score:  90.6%
> Total number of functions:  31495
> We need 1397 more functions to get to 95% coverage.
> We need 2657 more functions to get to 99% coverage.
> }}}

Yay! So what should we do about #12024? Set it to positive review?


---

Comment by knsam created at 2013-02-21 17:29:20

Replying to [comment:27 tscrim]: 
> Yay! So what should we do about #12024? Set it to positive review?

IMHO, that could still serve as a meta ticket, so that all we can track all the work proposed to be undertaken by various developers and those unclaimed still remain. Perhaps, we should change the title to something else. But, not close it. Just my feeling, but feel free to ignore. ~KnS


---

Comment by jdemeyer created at 2013-02-22 19:11:17

Resolution: fixed


---

Comment by jdemeyer created at 2013-02-27 18:35:17

Since this patch is already merged, the following advise can only serve as a warning for the future: *you should not make needless whitespace changes*. Changing whitespace all over the place makes rebasing more difficult than it should be.
