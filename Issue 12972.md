# Issue 12972: Fix Sympow on FreeBSD

archive/issues_012972.json:
```json
{
    "body": "Assignee: pjeremy\n\nCC:  pjeremy\n\nFor the current FreeBSD [port](http://www.freebsd.org/cgi/cvsweb.cgi/ports/math/sage/), the following patch is necessary.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/CJPzhaaNmGI) where it was first reported.\n\n\n```diff\n--- sympow-1.018.1.p11/src/disk.c-orig\t2012-04-19 02:33:51.000000000 +0000\n+++ sympow-1.018.1.p11/src/disk.c\t2012-04-19 02:34:22.000000000 +0000\n@@ -39,7 +39,7 @@\n  else if (((sp&3)==0) && CM_CASE) {if (2*ep==sp) S[3]='l'; else S[3]='h';}\n  else {if (2*ep==sp) S[3]='L'; else S[3]='H';}\n  if (HECKE && dv) {TACKS[which]=malloc(dv*sizeof(QD)); TACKON[which]=dv;}\n- else if (dv<=sp/2) TACKON[which]=0;\n+ else if (dv<=sp/2) {TACKS[which]=NULL; TACKON[which]=0;}\n  else {TACKS[which]=malloc((dv-sp/2)*sizeof(QD)); TACKON[which]=dv-sp/2;}\n  S[4]=0; F=fopen(\"datafiles/param_data\",\"r\"); strcpy(U,S);\n  if (ANAL_RANK) {if (dv>0) U[0]='A'; else U[0]='m';}\n```\n\n\nPresumably we would want to only apply this on FreeBSD for now.  Needs an spkg.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13144\n\n",
    "created_at": "2012-06-20T19:29:42Z",
    "labels": [
        "porting: BSD",
        "major",
        "bug"
    ],
    "title": "Fix Sympow on FreeBSD",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12972",
    "user": "kcrisman"
}
```
Assignee: pjeremy

CC:  pjeremy

For the current FreeBSD [port](http://www.freebsd.org/cgi/cvsweb.cgi/ports/math/sage/), the following patch is necessary.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/CJPzhaaNmGI) where it was first reported.


```diff
--- sympow-1.018.1.p11/src/disk.c-orig	2012-04-19 02:33:51.000000000 +0000
+++ sympow-1.018.1.p11/src/disk.c	2012-04-19 02:34:22.000000000 +0000
@@ -39,7 +39,7 @@
  else if (((sp&3)==0) && CM_CASE) {if (2*ep==sp) S[3]='l'; else S[3]='h';}
  else {if (2*ep==sp) S[3]='L'; else S[3]='H';}
  if (HECKE && dv) {TACKS[which]=malloc(dv*sizeof(QD)); TACKON[which]=dv;}
- else if (dv<=sp/2) TACKON[which]=0;
+ else if (dv<=sp/2) {TACKS[which]=NULL; TACKON[which]=0;}
  else {TACKS[which]=malloc((dv-sp/2)*sizeof(QD)); TACKON[which]=dv-sp/2;}
  S[4]=0; F=fopen("datafiles/param_data","r"); strcpy(U,S);
  if (ANAL_RANK) {if (dv>0) U[0]='A'; else U[0]='m';}
```


Presumably we would want to only apply this on FreeBSD for now.  Needs an spkg.

Issue created by migration from https://trac.sagemath.org/ticket/13144





---

archive/issue_comments_156734.json:
```json
{
    "body": "It is a duplicate of\n\nhttp://trac.sagemath.org/sage_trac/ticket/12858\n\nI think this patch should be applied to all operating systems.  I think it is just a matter of luck that other operating systems were not hit by this bug.",
    "created_at": "2012-06-20T19:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12972",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12972#issuecomment-156734",
    "user": "stephen"
}
```

It is a duplicate of

http://trac.sagemath.org/sage_trac/ticket/12858

I think this patch should be applied to all operating systems.  I think it is just a matter of luck that other operating systems were not hit by this bug.



---

archive/issue_comments_156735.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-06-20T20:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12972",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12972#issuecomment-156735",
    "user": "kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_156736.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-20T20:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12972",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12972#issuecomment-156736",
    "user": "kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_156737.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2012-07-04T07:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12972",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12972#issuecomment-156737",
    "user": "jdemeyer"
}
```

Resolution: duplicate
