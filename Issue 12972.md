# Issue 12972: Fix Sympow on FreeBSD

Issue created by migration from https://trac.sagemath.org/ticket/13144

Original creator: kcrisman

Original creation time: 2012-06-20 19:29:42

Assignee: pjeremy

CC:  pjeremy

For the current FreeBSD [port](http://www.freebsd.org/cgi/cvsweb.cgi/ports/math/sage/), the following patch is necessary.  See [this sage-devel thread](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/CJPzhaaNmGI) where it was first reported.


```diff
--- sympow-1.018.1.p11/src/disk.c-orig	2012-04-19 02:33:51.000000000 +0000
+++ sympow-1.018.1.p11/src/disk.c	2012-04-19 02:34:22.000000000 +0000
@@ -39,7 +39,7 @@
  else if (((sp&3)==0) && CM_CASE) {if (2*ep==sp) S[3]='l'; else S[3]='h';}
  else {if (2*ep==sp) S[3]='L'; else S[3]='H';}
  if (HECKE && dv) {TACKS[which]=malloc(dv*sizeof(QD)); TACKON[which]=dv;}
- else if (dv<=sp/2) TACKON[which]=0;
+ else if (dv<=sp/2) {TACKS[which]=NULL; TACKON[which]=0;}
  else {TACKS[which]=malloc((dv-sp/2)*sizeof(QD)); TACKON[which]=dv-sp/2;}
  S[4]=0; F=fopen("datafiles/param_data","r"); strcpy(U,S);
  if (ANAL_RANK) {if (dv>0) U[0]='A'; else U[0]='m';}
```


Presumably we would want to only apply this on FreeBSD for now.  Needs an spkg.


---

Comment by stephen created at 2012-06-20 19:42:11

It is a duplicate of

http://trac.sagemath.org/sage_trac/ticket/12858

I think this patch should be applied to all operating systems.  I think it is just a matter of luck that other operating systems were not hit by this bug.


---

Comment by kcrisman created at 2012-06-20 20:12:41

Changing status from new to needs_review.


---

Comment by kcrisman created at 2012-06-20 20:15:52

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-07-04 07:12:17

Resolution: duplicate
