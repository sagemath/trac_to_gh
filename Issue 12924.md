# Issue 12924: find_maximum_on_interval fails when used with a sage function

archive/issues_012924.json:
```json
{
    "body": "Assignee: jason, jkantor\n\nThe function find_maximum_on_interval fails when used with a sage function that is passed as an argument:\n\n\n```\nsage: f(x) = sin(x)\nsage: find_maximum_on_interval(f, 0, 2*pi)\nTraceback (click to the left of this block for traceback)\n...\nRuntimeError: ECL says: THROW: The catch MACSYMA-QUIT is undefined.\n```\n\nwhile all of:\n\n```\nsage: find_minimum_on_interval(f, 0, 2*pi)\n(-1.0, 4.7123889815323858)\nsage: f.find_minimum_on_interval(0, 2*pi)\n(-1.0, 4.7123889815323858)\nsage: f.find_maximum_on_interval(0, 2*pi)\n(1.0, 1.570796325647202)\n```\n\nworks. This was kind of unexpected, esp that documentation says about providing a function as an argument.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13096\n\n",
    "created_at": "2012-06-08T11:52:02Z",
    "labels": [
        "numerical",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "find_maximum_on_interval fails when used with a sage function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12924",
    "user": "aginiewicz"
}
```
Assignee: jason, jkantor

The function find_maximum_on_interval fails when used with a sage function that is passed as an argument:


```
sage: f(x) = sin(x)
sage: find_maximum_on_interval(f, 0, 2*pi)
Traceback (click to the left of this block for traceback)
...
RuntimeError: ECL says: THROW: The catch MACSYMA-QUIT is undefined.
```

while all of:

```
sage: find_minimum_on_interval(f, 0, 2*pi)
(-1.0, 4.7123889815323858)
sage: f.find_minimum_on_interval(0, 2*pi)
(-1.0, 4.7123889815323858)
sage: f.find_maximum_on_interval(0, 2*pi)
(1.0, 1.570796325647202)
```

works. This was kind of unexpected, esp that documentation says about providing a function as an argument.

Issue created by migration from https://trac.sagemath.org/ticket/13096





---

archive/issue_comments_155636.json:
```json
{
    "body": "I believe this is because find_maximum_on_interval is calling find_minimum_on_interval with lambda z: -f(z) as argument (sage/numerical/optimize.py:127) and doing\n\n```\n     try:\n         return f.find_maximum_on_interval(a=a, b=b, tol=tol,maxfun=maxfun)\n     except AttributeError:\n         pass\n```\n\njust before that should work. Am I right? This might be also related to #3955 (quite old ticket but looks like it proposes a better solution, were there some issues with it, or just no one got into it yet?). If I find enough time to make patch I will post it, but I have to recreate my build environment first (since sage 5.0 does not work with my version of gcc I switched to distribution provided package that is already patched).",
    "created_at": "2012-06-08T11:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155636",
    "user": "aginiewicz"
}
```

I believe this is because find_maximum_on_interval is calling find_minimum_on_interval with lambda z: -f(z) as argument (sage/numerical/optimize.py:127) and doing

```
     try:
         return f.find_maximum_on_interval(a=a, b=b, tol=tol,maxfun=maxfun)
     except AttributeError:
         pass
```

just before that should work. Am I right? This might be also related to #3955 (quite old ticket but looks like it proposes a better solution, were there some issues with it, or just no one got into it yet?). If I find enough time to make patch I will post it, but I have to recreate my build environment first (since sage 5.0 does not work with my version of gcc I switched to distribution provided package that is already patched).



---

archive/issue_comments_155637.json:
```json
{
    "body": "Dup of #12032",
    "created_at": "2012-06-08T18:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155637",
    "user": "nbruin"
}
```

Dup of #12032



---

archive/issue_comments_155638.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-06-08T18:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155638",
    "user": "nbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_155639.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-09T07:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155639",
    "user": "novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_155640.json:
```json
{
    "body": "See #2607 also.",
    "created_at": "2012-06-09T07:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155640",
    "user": "novoselt"
}
```

See #2607 also.



---

archive/issue_comments_155641.json:
```json
{
    "body": "I looked at both of those before openning this ticket, but though #12032 is more general and not that easily fixed, and #2607 is about name/docs instead of working vs non-working. Anyway, I agree that this ticket is a duplicate (of #3955). I uploaded patch based on comment:1 there.",
    "created_at": "2012-06-09T10:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155641",
    "user": "aginiewicz"
}
```

I looked at both of those before openning this ticket, but though #12032 is more general and not that easily fixed, and #2607 is about name/docs instead of working vs non-working. Anyway, I agree that this ticket is a duplicate (of #3955). I uploaded patch based on comment:1 there.



---

archive/issue_comments_155642.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2012-06-19T13:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12924#issuecomment-155642",
    "user": "jdemeyer"
}
```

Resolution: duplicate
