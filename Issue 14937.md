# Issue 14937: Permutations and symmetric group algebra: Stopgap for #14885 and noninversions

archive/issues_014937.json:
```json
{
    "body": "CC:  tscrim sage-combinat nthiery hivert zabrocki ncohen saliola\n\nKeywords: permutation, permutation group, symmetric group, sage-combinat, groups\n\nThis patch does the following:\n\n* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutation is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras dependent on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).\n\n* Improve doc at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor, but constitude most of the size of the patch.\n\n* Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15174\n\n",
    "created_at": "2013-09-08T05:04:34Z",
    "labels": [
        "combinatorics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "Permutations and symmetric group algebra: Stopgap for #14885 and noninversions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14937",
    "user": "darij"
}
```
CC:  tscrim sage-combinat nthiery hivert zabrocki ncohen saliola

Keywords: permutation, permutation group, symmetric group, sage-combinat, groups

This patch does the following:

* Open up a way to circumvent the (in the opinion of several people) broken multiplication of permutations (see #14885 and https://groups.google.com/forum/#!searchin/sage-devel/permutations/sage-devel/tAAb42Edh9o/T-htA50IOZEJ ). To remind, the issue is twofold: first, the default order in which Sage multiplies permutation is rather unusual to anyone not from the English school of notation; second, the order depends on a global variable which can be changed at runtime, which makes it unpredictable and a pain to rely on. I don't address the first of these issues in my patch, but I ameliorate the second one: There are now global-independent methods `left_action_product` and `right_action_product` on permutations (these are just aliases for the already existing methods `_left_to_right_multiply_on_left` and `_left_to_right_multiply_on_right`, but are now documented and non-underscored; besides I hope that my names are clearer), and more importantly on symmetric group algebras (these are not just aliases anymore; the only multiplication method which we used to have on symmetric group algebras dependent on the global). These can be used instead of the badly predictable `*` operator (they're even a bit faster by virtue of not branching on the global variable).

* Improve doc at a few places in `combinat/permutation.py` and `combinat/symmetric_group_algebra.py`. These are minor, but constitude most of the size of the patch.

* Add methods related to the Reiner-Saliola-Welker conjectures: The number of noninversions of a permutation; the antipode of the symmetric group algebra; the Reiner-Saliola-Welker shuffling operators (as elements of symmetric group algebras); and some elements which can be used to factor the latter.

Issue created by migration from https://trac.sagemath.org/ticket/15174





---

archive/issue_comments_190776.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-09-08T05:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190776",
    "user": "darij"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_190777.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-09-09T00:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190777",
    "user": "darij"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_190778.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-09-09T00:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190778",
    "user": "darij"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_190779.json:
```json
{
    "body": "New version up (sorry!). Not planning any further edits until this is reviewed.",
    "created_at": "2013-09-09T00:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190779",
    "user": "darij"
}
```

New version up (sorry!). Not planning any further edits until this is reviewed.



---

archive/issue_comments_190780.json:
```json
{
    "body": "Rebased over #15309; added docstring to the (ancient) `pi_ik` function.",
    "created_at": "2013-10-27T15:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190780",
    "user": "darij"
}
```

Rebased over #15309; added docstring to the (ancient) `pi_ik` function.



---

archive/issue_comments_190781.json:
```json
{
    "body": "Attachment [trac_15174-symmetric_group_algebra_again-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-symmetric_group_algebra_again-dg.patch) by darij created at 2013-10-27 15:57:03\n\nrebased again",
    "created_at": "2013-10-27T15:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190781",
    "user": "darij"
}
```

Attachment [trac_15174-symmetric_group_algebra_again-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-symmetric_group_algebra_again-dg.patch) by darij created at 2013-10-27 15:57:03

rebased again



---

archive/issue_comments_190782.json:
```json
{
    "body": "New attachment improves the docstrings around the strong Bruhat order (fixing an error and preventing its confusion with the weak Bruhat order) and slightly optimizes the test for Bruhat less-or-equal.\n\nfor the **patchbot**:\n\napply trac_15174-symmetric_group_algebra_again-dg.patch\u200b trac_15174-bruhat-dg.patch\u200b",
    "created_at": "2013-11-15T06:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190782",
    "user": "darij"
}
```

New attachment improves the docstrings around the strong Bruhat order (fixing an error and preventing its confusion with the weak Bruhat order) and slightly optimizes the test for Bruhat less-or-equal.

for the **patchbot**:

apply trac_15174-symmetric_group_algebra_again-dg.patch​ trac_15174-bruhat-dg.patch​



---

archive/issue_comments_190783.json:
```json
{
    "body": "Attachment [trac_15174-bruhat-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-bruhat-dg.patch) by darij created at 2013-11-16 01:11:49\n\nadditional (mostly doc) improvements",
    "created_at": "2013-11-16T01:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190783",
    "user": "darij"
}
```

Attachment [trac_15174-bruhat-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-bruhat-dg.patch) by darij created at 2013-11-16 01:11:49

additional (mostly doc) improvements



---

archive/issue_comments_190784.json:
```json
{
    "body": "More work done, mostly on the permutohedron order docstrings. I was surprised to learn that \"permutohedron order\" is the French name for the weak order; this answers my question why the weak order isn't in Sage (it is, under this name...).\n\nThe patch is ready for review.",
    "created_at": "2013-11-16T01:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190784",
    "user": "darij"
}
```

More work done, mostly on the permutohedron order docstrings. I was surprised to learn that "permutohedron order" is the French name for the weak order; this answers my question why the weak order isn't in Sage (it is, under this name...).

The patch is ready for review.



---

archive/issue_comments_190785.json:
```json
{
    "body": "Hey Darij,\n\nHere's a review patch which does a few changes and docstring touchups. More specifically:\n\n* I reworked the documentation for `left/right_action_product`,\n* added a `noninversions()` methods, and\n* changed `noninv()` to `number_of_noninversions()` since it is ambiguous (to me).\n\nIf you agree with my changes, you can go ahead and set this to a positive review.\n\nBest,\n\nTravis",
    "created_at": "2013-11-19T19:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190785",
    "user": "tscrim"
}
```

Hey Darij,

Here's a review patch which does a few changes and docstring touchups. More specifically:

* I reworked the documentation for `left/right_action_product`,
* added a `noninversions()` methods, and
* changed `noninv()` to `number_of_noninversions()` since it is ambiguous (to me).

If you agree with my changes, you can go ahead and set this to a positive review.

Best,

Travis



---

archive/issue_comments_190786.json:
```json
{
    "body": "Hi Travis,\n\nthanks a lot for reviewing this!\n\nI'm unsure about this:\n\n```\n         This is usually denoted by either ``self * lp`` or ``lp * self``\n         depending on the conventions used by the author. If permutations\n         are to act on numbers from the left in an associative way, the\n-        correct notation for this is ``self * lp``. If permutations are\n-        to act on numbers from the right in an associatve way, the\n-        correct notation for this is ``lp * self``.\n+        correct notation for this is ``self * lp``. If permutations are to\n+        act on positions from the left in an associative way, the correct\n+        notation for this is ``lp * self``.\n```\n\nWhat do you mean by \"act on positions\"? Something like \"pi sends psi to pi \\circ psi^(-1)\"? But then we would have to add an ^{-1}... IMHO my original docstring was clearer. I don't understand the \"More specifically\" explanation either...\n\nAlso, the docstring of `noninversions` might use an `r\"\"\"`. I'm not near a functioning hg installation right now, or I'd do that myself.\n\n  Best regards,\\\\\n  Darij",
    "created_at": "2013-11-19T19:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190786",
    "user": "darij"
}
```

Hi Travis,

thanks a lot for reviewing this!

I'm unsure about this:

```
         This is usually denoted by either ``self * lp`` or ``lp * self``
         depending on the conventions used by the author. If permutations
         are to act on numbers from the left in an associative way, the
-        correct notation for this is ``self * lp``. If permutations are
-        to act on numbers from the right in an associatve way, the
-        correct notation for this is ``lp * self``.
+        correct notation for this is ``self * lp``. If permutations are to
+        act on positions from the left in an associative way, the correct
+        notation for this is ``lp * self``.
```

What do you mean by "act on positions"? Something like "pi sends psi to pi \circ psi^(-1)"? But then we would have to add an ^{-1}... IMHO my original docstring was clearer. I don't understand the "More specifically" explanation either...

Also, the docstring of `noninversions` might use an `r"""`. I'm not near a functioning hg installation right now, or I'd do that myself.

  Best regards,\\
  Darij



---

archive/issue_comments_190787.json:
```json
{
    "body": "PS. The reason why I killed the \"invalid state\" ValueErrors is that `state` is not a user-defined variable but an output of `_icondition`, and the existing code already handles all possible values it can have. The ValueError would appear only if cosmic radiation corrupted the internal state of the sage process. IMHO that's not something we should actively be testing for at runtime...",
    "created_at": "2013-11-19T19:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190787",
    "user": "darij"
}
```

PS. The reason why I killed the "invalid state" ValueErrors is that `state` is not a user-defined variable but an output of `_icondition`, and the existing code already handles all possible values it can have. The ValueError would appear only if cosmic radiation corrupted the internal state of the sage process. IMHO that's not something we should actively be testing for at runtime...



---

archive/issue_comments_190788.json:
```json
{
    "body": "Hey Darij,\n\nThere are two ways one permutation can act on another, by position  (or by index) and by value (or by number as you put it). Acting on the right by one is equal to acting on the left by the other and can be seen from the permutation matrix multiplication (see Section 1.4 in Artin's *Algebra* for example). My \"More specifically\" block was trying to explain these two different approaches and could likely use improvement. (I'm used to my permutations acting by position.)\n\nYour docstring ended up confusing me since the name of the method is (for example) `left_action_multiply` and it's talking about left and right actions by number. I think we should do the mantra: \"Here is how we define the left action\". Additionally what I was trying to change was to give justification as to why the other notation would be used and get the same result.\n\nI'll change the docstring of `noninversions` once we settle on the above.\n\nAlso since the \"invalid state\" errors are in an `else:` block, they never get called unless there is an internal error. In other terms, it's not actively testing for anything. I'd be fine changing them to `assert` statements, but that would be a cosmetic change.\n\nBest,\n\nTravis",
    "created_at": "2013-11-19T20:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190788",
    "user": "tscrim"
}
```

Hey Darij,

There are two ways one permutation can act on another, by position  (or by index) and by value (or by number as you put it). Acting on the right by one is equal to acting on the left by the other and can be seen from the permutation matrix multiplication (see Section 1.4 in Artin's *Algebra* for example). My "More specifically" block was trying to explain these two different approaches and could likely use improvement. (I'm used to my permutations acting by position.)

Your docstring ended up confusing me since the name of the method is (for example) `left_action_multiply` and it's talking about left and right actions by number. I think we should do the mantra: "Here is how we define the left action". Additionally what I was trying to change was to give justification as to why the other notation would be used and get the same result.

I'll change the docstring of `noninversions` once we settle on the above.

Also since the "invalid state" errors are in an `else:` block, they never get called unless there is an internal error. In other terms, it's not actively testing for anything. I'd be fine changing them to `assert` statements, but that would be a cosmetic change.

Best,

Travis



---

archive/issue_comments_190789.json:
```json
{
    "body": "I was talking about the action of `S_n` on `[n]`, not about an action-by-multiplication of `S_n` on itself. I'll rewrite the docstring to make this maximally explicit, since I see that what I wrote didn't clear up the confusion particularly well.",
    "created_at": "2013-11-19T23:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190789",
    "user": "darij"
}
```

I was talking about the action of `S_n` on `[n]`, not about an action-by-multiplication of `S_n` on itself. I'll rewrite the docstring to make this maximally explicit, since I see that what I wrote didn't clear up the confusion particularly well.



---

archive/issue_comments_190790.json:
```json
{
    "body": "Attachment [trac_15174-response-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-response-dg.patch) by darij created at 2013-11-20 03:42:33\n\nresponse to Travis' review + more edits",
    "created_at": "2013-11-20T03:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190790",
    "user": "darij"
}
```

Attachment [trac_15174-response-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-response-dg.patch) by darij created at 2013-11-20 03:42:33

response to Travis' review + more edits



---

archive/issue_comments_190791.json:
```json
{
    "body": "Hi Travis,\n\nwhat do you think about this? Note that I have removed the \"More specifically\" paragraphs because I couldn't really understand them, but I think I'm as specific as possible now.\n\nI couldn't resist adding a docstring to the Hecke algebra class after noticing that it, too, would break if a nonstandard order of multiplication was chosen (this, too, is fixed now). Sorry for the feature creep! In other news, this patch probably kills all but 2-3 spots in the source where the `mult` global option on `Permutations` is inappropriately used. I'll open further tickets for the rest.\n\nThe change of \"integral\" to \"integers\" is due to the fact that \"integral\" means \"integral over ZZ\" for some people. I was probably over-careful here.\n\nfor the **patchbot**:\n\napply trac_15174-symmetric_group_algebra_again-dg.patch\u200b trac_15174-bruhat-dg.patch\u200b trac_15174-review-ts.patch trac_15174-response-dg.patch\u200b",
    "created_at": "2013-11-20T03:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190791",
    "user": "darij"
}
```

Hi Travis,

what do you think about this? Note that I have removed the "More specifically" paragraphs because I couldn't really understand them, but I think I'm as specific as possible now.

I couldn't resist adding a docstring to the Hecke algebra class after noticing that it, too, would break if a nonstandard order of multiplication was chosen (this, too, is fixed now). Sorry for the feature creep! In other news, this patch probably kills all but 2-3 spots in the source where the `mult` global option on `Permutations` is inappropriately used. I'll open further tickets for the rest.

The change of "integral" to "integers" is due to the fact that "integral" means "integral over ZZ" for some people. I was probably over-careful here.

for the **patchbot**:

apply trac_15174-symmetric_group_algebra_again-dg.patch​ trac_15174-bruhat-dg.patch​ trac_15174-review-ts.patch trac_15174-response-dg.patch​



---

archive/issue_comments_190792.json:
```json
{
    "body": "Hey Darij,\n\nAh, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?\n\nAdditionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).\n\nBest,\n\nTravis",
    "created_at": "2013-11-21T15:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190792",
    "user": "tscrim"
}
```

Hey Darij,

Ah, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?

Additionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).

Best,

Travis



---

archive/issue_comments_190793.json:
```json
{
    "body": "Hi Travis,\n\nReplying to [comment:13 tscrim]:\n> Ah, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?\n\nI didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?\n\n> Additionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).\n\nGood point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)\n\nBest regards,\\\\\nDarij",
    "created_at": "2013-11-21T17:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190793",
    "user": "darij"
}
```

Hi Travis,

Replying to [comment:13 tscrim]:
> Ah, now I understand what you were trying to say. However I do think we should include somewhere about if we want to think of permutations acting on positions instead of on numbers, as well as explicitly describing what these actions are. Perhaps at the class level or in the global variables section?

I didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?

> Additionally if there are only a few other spots where the multiplication relies on the global variable being a particular value, I am fine with doing that here (since #14885 is about changing the global option itself).

Good point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)

Best regards,\\
Darij



---

archive/issue_comments_190794.json:
```json
{
    "body": "Hey Darij,\n\nReplying to [comment:14 darij]:\n> I didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?\n\nSure.\n\n> Good point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)\n\nYes, everything looked good in it. Please fold it all together.\n\nBest,\n\nTravis",
    "created_at": "2013-11-22T02:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190794",
    "user": "tscrim"
}
```

Hey Darij,

Replying to [comment:14 darij]:
> I didn't want to talk of the multiplication as being an action itself (I talked of the multiplication playing nicely with the action on integers, which is a simpler thing), since IMHO that would only add to the confusion. But if you can explain it nicely, I think it would be a good addition. Can you make a little review patch for this?

Sure.

> Good point; I'll do it later today (I hope). Meanwhile do you agree with my last patch? (I'd like to qfold everything we have done so far on the ticket.)

Yes, everything looked good in it. Please fold it all together.

Best,

Travis



---

archive/issue_comments_190795.json:
```json
{
    "body": "Attachment [trac_15174-qfold1.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-qfold1.patch) by darij created at 2013-11-22 03:01:55\n\nqfold of the patches so far; more to come!",
    "created_at": "2013-11-22T03:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190795",
    "user": "darij"
}
```

Attachment [trac_15174-qfold1.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-qfold1.patch) by darij created at 2013-11-22 03:01:55

qfold of the patches so far; more to come!



---

archive/issue_comments_190796.json:
```json
{
    "body": "Attachment [trac_15174-final-touches-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-final-touches-dg.patch) by darij created at 2013-11-22 04:59:40\n\nI've tried fixing some of the other places where the global is used, but the work is going overboard: there's way too much to fix in `sage/groups/braid.py`; I don't understand much of `sage/groups/semimonomial_transformations/*`; I don't know the seminormal form well enough for what remains to be done in `sage/combinat/symmetric_group_algebra.py` (this will probably change soon); I have left `sage/combinat/matrices/latin.py` to Nathann in #15439; I had no time left for `sage/graphs/comparability.pyx`, `sage/graphs/generators/intersection.py` and `sage/categories/magmas.py`. This is, I think, a complete list of places where dependence on `mult` should be removed. I'll open up separate tickets for them. Sorry...\n\nTravis, could you perhaps have a look at the last patch I uploaded here and give green (or whatever) light? It's mainly docstrings now. Many thanks again for reviewing this mess.\n\nfor the **patchbot**:\napply trac_15174-qfold1.patch\u200b trac_15174-final-touches-dg.patch\u200b",
    "created_at": "2013-11-22T04:59:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190796",
    "user": "darij"
}
```

Attachment [trac_15174-final-touches-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-final-touches-dg.patch) by darij created at 2013-11-22 04:59:40

I've tried fixing some of the other places where the global is used, but the work is going overboard: there's way too much to fix in `sage/groups/braid.py`; I don't understand much of `sage/groups/semimonomial_transformations/*`; I don't know the seminormal form well enough for what remains to be done in `sage/combinat/symmetric_group_algebra.py` (this will probably change soon); I have left `sage/combinat/matrices/latin.py` to Nathann in #15439; I had no time left for `sage/graphs/comparability.pyx`, `sage/graphs/generators/intersection.py` and `sage/categories/magmas.py`. This is, I think, a complete list of places where dependence on `mult` should be removed. I'll open up separate tickets for them. Sorry...

Travis, could you perhaps have a look at the last patch I uploaded here and give green (or whatever) light? It's mainly docstrings now. Many thanks again for reviewing this mess.

for the **patchbot**:
apply trac_15174-qfold1.patch​ trac_15174-final-touches-dg.patch​



---

archive/issue_comments_190797.json:
```json
{
    "body": "Attachment [trac_15174-review-ts.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-review-ts.patch) by tscrim created at 2013-11-23 06:50:04",
    "created_at": "2013-11-23T06:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190797",
    "user": "tscrim"
}
```

Attachment [trac_15174-review-ts.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-review-ts.patch) by tscrim created at 2013-11-23 06:50:04



---

archive/issue_comments_190798.json:
```json
{
    "body": "Hey Darij,\n\nHere's the latest little review patch. I'm happy with the patch right now, so if you're happy with my note, then you can set it to positive review.\n\nThanks,\n\nTravis\n\nFor patchbot:\n\nApply: trac_15174-qfold1.patch\u200b, trac_15174-final-touches-dg.patch\u200b, trac_15174-review-ts.patch",
    "created_at": "2013-11-23T06:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190798",
    "user": "tscrim"
}
```

Hey Darij,

Here's the latest little review patch. I'm happy with the patch right now, so if you're happy with my note, then you can set it to positive review.

Thanks,

Travis

For patchbot:

Apply: trac_15174-qfold1.patch​, trac_15174-final-touches-dg.patch​, trac_15174-review-ts.patch



---

archive/issue_comments_190799.json:
```json
{
    "body": "I still don't get your note about products of permutations. Particularly the second paragraph:\n\n\n```\n \t382\t        In more detail using one-line notation, if we have two permutations \n \t383\t        `p \\cdot q` and multiplying on the right by numbers, then the \n \t384\t        resulting permutation is determined for any fixed `j` by sending \n \t385\t        `p_j = q_i \\mapsto q_{i+1}` for some (unique) `i` where we take the \n \t386\t        indices cyclicly (i.e. `n + 1 \\equiv 1`). If we consider this as \n \t387\t        multiplying on the left by position, we determine the resulting \n \t388\t        permutation by `q_{p_i} \\mapsto q_{p_{i+1}}` over all `i` (again \n \t389\t        taking the indices cyclically).\n```\n\n\nSorry, but I don't have much of a clue what you mean here :/ What is the `q_i \\mapsto q_{i+1}` thing about? Are your permutations supposed to be cycles written in cycle form?\n\nAlso, \"surpressed\" should be \"suppressed\". The rest of the edits is definitely good.",
    "created_at": "2013-11-23T07:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190799",
    "user": "darij"
}
```

I still don't get your note about products of permutations. Particularly the second paragraph:


```
 	382	        In more detail using one-line notation, if we have two permutations 
 	383	        `p \cdot q` and multiplying on the right by numbers, then the 
 	384	        resulting permutation is determined for any fixed `j` by sending 
 	385	        `p_j = q_i \mapsto q_{i+1}` for some (unique) `i` where we take the 
 	386	        indices cyclicly (i.e. `n + 1 \equiv 1`). If we consider this as 
 	387	        multiplying on the left by position, we determine the resulting 
 	388	        permutation by `q_{p_i} \mapsto q_{p_{i+1}}` over all `i` (again 
 	389	        taking the indices cyclically).
```


Sorry, but I don't have much of a clue what you mean here :/ What is the `q_i \mapsto q_{i+1}` thing about? Are your permutations supposed to be cycles written in cycle form?

Also, "surpressed" should be "suppressed". The rest of the edits is definitely good.



---

archive/issue_comments_190800.json:
```json
{
    "body": "My permutations are \"using one-line notation\". And the by-value is sending the value `p_j` which equals `q_i` for some `i` to the value `q_{i+1}` as we range over `j`. The by-position is sending the value `q_{p_i}` to the resulting value `q_{p_{i+1}}`. Would it be better if I put primes on the image or called it `r`? Or the notation `r_j = q_{i+1}` where `p_j = q_i` (for by-value) and `r_{p_{i+1}} = q_{p_i}` (for by-position)?\n\nI'll fix the typo when we clarify the above.",
    "created_at": "2013-11-23T07:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190800",
    "user": "tscrim"
}
```

My permutations are "using one-line notation". And the by-value is sending the value `p_j` which equals `q_i` for some `i` to the value `q_{i+1}` as we range over `j`. The by-position is sending the value `q_{p_i}` to the resulting value `q_{p_{i+1}}`. Would it be better if I put primes on the image or called it `r`? Or the notation `r_j = q_{i+1}` where `p_j = q_i` (for by-value) and `r_{p_{i+1}} = q_{p_i}` (for by-position)?

I'll fix the typo when we clarify the above.



---

archive/issue_comments_190801.json:
```json
{
    "body": "additional patch for another piece of code that uses the product of permutations (for no reason)",
    "created_at": "2013-11-23T23:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190801",
    "user": "darij"
}
```

additional patch for another piece of code that uses the product of permutations (for no reason)



---

archive/issue_comments_190802.json:
```json
{
    "body": "Attachment [trac_15174-fix-intersection-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-fix-intersection-dg.patch) by darij created at 2013-11-23 23:42:54\n\nI still don't see why (by-value) `p_j = q_i` gets sent to `q_{i+1}`. Shouldn't rather `p_j = i` get sent to `q_i`? Either way, I'm not convinced that viewing multiplication as action is really helpful to get rid of ambiguity. There are only two reasonable ways to multiply permutations, but there are at least six reasonable ways to act on permutations (counting left and right actions), so I fear the whole note does more harm than help.\n\nIn other news, here's one more little patch to get rid of the dependency in `sage/graphs/comparability.pyx` and `sage/graphs/generators/intersection.py`. It turns out that `sage/categories/magmas.py` is a non-issue (the dependency exists only in the doctest). This leaves only braids, semimonomial transformations, Latin square isotopisms and the seminormal form to deal with.\n\nfor the **patchbot**:\n\napply trac_15174-qfold1.patch\u200b, trac_15174-final-touches-dg.patch\u200b, trac_15174-review-ts.patch trac_15174-fix-intersection-dg.patch",
    "created_at": "2013-11-23T23:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190802",
    "user": "darij"
}
```

Attachment [trac_15174-fix-intersection-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-fix-intersection-dg.patch) by darij created at 2013-11-23 23:42:54

I still don't see why (by-value) `p_j = q_i` gets sent to `q_{i+1}`. Shouldn't rather `p_j = i` get sent to `q_i`? Either way, I'm not convinced that viewing multiplication as action is really helpful to get rid of ambiguity. There are only two reasonable ways to multiply permutations, but there are at least six reasonable ways to act on permutations (counting left and right actions), so I fear the whole note does more harm than help.

In other news, here's one more little patch to get rid of the dependency in `sage/graphs/comparability.pyx` and `sage/graphs/generators/intersection.py`. It turns out that `sage/categories/magmas.py` is a non-issue (the dependency exists only in the doctest). This leaves only braids, semimonomial transformations, Latin square isotopisms and the seminormal form to deal with.

for the **patchbot**:

apply trac_15174-qfold1.patch​, trac_15174-final-touches-dg.patch​, trac_15174-review-ts.patch trac_15174-fix-intersection-dg.patch



---

archive/issue_comments_190803.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-11-29T20:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190803",
    "user": "darij"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_190804.json:
```json
{
    "body": "Travis?",
    "created_at": "2013-11-29T20:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190804",
    "user": "darij"
}
```

Travis?



---

archive/issue_comments_190805.json:
```json
{
    "body": "Attachment [trac_15174-classlvl-doc-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-classlvl-doc-dg.patch) by darij created at 2013-11-29 22:56:26",
    "created_at": "2013-11-29T22:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190805",
    "user": "darij"
}
```

Attachment [trac_15174-classlvl-doc-dg.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-classlvl-doc-dg.patch) by darij created at 2013-11-29 22:56:26



---

archive/issue_comments_190806.json:
```json
{
    "body": "all qfolded",
    "created_at": "2013-11-29T23:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190806",
    "user": "darij"
}
```

all qfolded



---

archive/issue_comments_190807.json:
```json
{
    "body": "Attachment [trac_15174-full-qfold.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-full-qfold.patch) by tscrim created at 2013-11-29 23:08:36\n\nLooks good to me. Thanks Darij.\n\nFor patchbot:\n\nApply: trac_15174-full-qfold.patch\u200b",
    "created_at": "2013-11-29T23:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190807",
    "user": "tscrim"
}
```

Attachment [trac_15174-full-qfold.patch](tarball://root/attachments/some-uuid/ticket15174/trac_15174-full-qfold.patch) by tscrim created at 2013-11-29 23:08:36

Looks good to me. Thanks Darij.

For patchbot:

Apply: trac_15174-full-qfold.patch​



---

archive/issue_comments_190808.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2013-11-29T23:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190808",
    "user": "tscrim"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_190809.json:
```json
{
    "body": "\n```\n\\     /\n \\   /\n  \\o/\n```\n\n\nThank you, Travis!",
    "created_at": "2013-11-29T23:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190809",
    "user": "darij"
}
```


```
\     /
 \   /
  \o/
```


Thank you, Travis!



---

archive/issue_comments_190810.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-12-05T08:01:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14937#issuecomment-190810",
    "user": "jdemeyer"
}
```

Resolution: fixed
