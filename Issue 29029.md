# Issue 29029: Bugfix concerning ticket #26421

Issue created by migration from https://trac.sagemath.org/ticket/29266

Original creator: soehms

Original creation time: 2020-03-01 20:24:57

CC:  tscrim

Keywords: factorization, integral domain

In #26421 factorization of polynomials has been extended to previously untreated cases in which the polynomial's base ring is an integral domain.
The factorization is done over the field of fraction and excepted if it can be coerced into the base ring itself. Since the method `base_change` of the class `Factorzation` doesn't check if the unit of the factorization is coerced to a unit again, this implementation is too vastly:


```
sage: R.<t> = LaurentPolynomialRing(ZZ)
sage: P.<x> = R[]
sage: f = 2*x + 4
sage: f.is_irreducible()
True
sage: F = f.factor(); F
(2) * (x + 2)
sage: F.unit()
2
```




---

Comment by soehms created at 2020-03-01 20:31:14

Maybe a better place for the fix would be the method `base_change` of the class `Factorization`. But since this leads to the failure of previous doctests (in cases `is_unit` is not implemented), I preferred the implementation in method `factor`.
----
New commits:


---

Comment by soehms created at 2020-03-01 20:31:14

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-03-02 00:09:48

One little change: "coerce" to "convert". If it was a coercion map, then the fact it was a unit must be preserved (as coercions must be morphisms). Once you change that, you can set a positive review.


---

Comment by git created at 2020-03-02 06:29:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by soehms created at 2020-03-02 06:31:18

Thanks!


---

Comment by soehms created at 2020-03-02 06:31:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-03-03 23:21:33

Resolution: fixed
