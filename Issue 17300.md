# Issue 17300: The geodetic closure of a graph

Issue created by migration from Trac.

Original creator: azi

Original creation time: 2014-12-21 17:11:58

CC:  ncohen

Hello!

The plan is to ship the algorithm for the minimal geodetic set of a graph but first let me try to sell this simple method for computing the geodetic closure of a (di) graph.

Let me know if there are any bugs/suggestions for this contribution.




---

Comment by git created at 2014-12-21 17:16:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-12-21 17:18:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by azi created at 2014-12-21 17:19:27

Changing status from new to needs_review.


---

Comment by ncohen created at 2014-12-21 17:23:23

Changing status from needs_review to needs_info.


---

Comment by ncohen created at 2014-12-21 17:23:23

Hmmm... Calling "distances_all_pairs" in a function like that is a suicide. You cannot re-compute all distances every time you want to compute a closure. Actually, the information that you need is precisely the one that is stored in `convexity_properties`.

The "convexity properties" object associates to every pair of vertices `u,v` the bitset of all z such that z is on a shortest uv path. Thus if you need to find the closure of a set of points, all you have to do is compute the union (with 'or' processor operations) of the bitsets associated to all pairs of vertices.

My point is that the code is already there, but of course the name 'convexity properties' is very ill-chosen in this case. We will probably have to change the terminology... What do you think about all this ?

By the way, is the terminology 'closure' used anywhere ? Because formally it is not a closure function. One of the property of closure functions is that `f(f(X))` should be equal to `f(x)`.

Nathann


---

Comment by azi created at 2014-12-21 17:41:41

Replying to [comment:5 ncohen]:
> Hmmm... Calling "distances_all_pairs" in a function like that is a suicide. You cannot re-compute all distances every time you want to compute a closure. Actually, the information that you need is precisely the one that is stored in `convexity_properties`.
That's true, though we can make for an optional argument DP that lets you pass the distance dictionary in case *anyone* really needs to compute this often.


> 
> The "convexity properties" object associates to every pair of vertices `u,v` the bitset of all z such that z is on a shortest uv path. Thus if you need to find the closure of a set of points, all you have to do is compute the union (with 'or' processor operations) of the bitsets associated to all pairs of vertices.
I see. 

> 
> My point is that the code is already there, but of course the name 'convexity properties' is very ill-chosen in this case. We will probably have to change the terminology... What do you think about all this ?
Fine to me. As far as my preferences go I'd like convexity properties to be part of the graph/generic graph family and cache this stuff in some other way. Having a module like that for just a few functions seems a bit unnatural to me?

> 
> By the way, is the terminology 'closure' used anywhere ? Because formally it is not a closure function. One of the property of closure functions is that `f(f(X))` should be equal to `f(x)`.
Yes it appears that this is the standard way to call it. See for example the paper "On pitfalls in computing the geodetic number of a graph" by Hansen and van Omme.

> 
> Nathann


---

Comment by ncohen created at 2014-12-21 17:43:53

Yo !

> Fine to me. As far as my preferences go I'd like convexity properties to be part of the graph/generic graph family and cache this stuff in some other way. Having a module like that for just a few functions seems a bit unnatural to me?

Yes, it is a bad implementation. I can say it, it's mine. It is ugly. I needed someplace to store this bitset, and I did not know where.

> Yes it appears that this is the standard way to call it. See for example the paper "On pitfalls in computing the geodetic number of a graph" by Hansen and van Omme.

Weird `O_o`

Nathann


---

Comment by azi created at 2014-12-21 17:46:40

Replying to [comment:7 ncohen]:
> Yo !
Hiiii
> 
> > Fine to me. As far as my preferences go I'd like convexity properties to be part of the graph/generic graph family and cache this stuff in some other way. Having a module like that for just a few functions seems a bit unnatural to me?
> 
> Yes, it is a bad implementation. I can say it, it's mine. It is ugly. I needed someplace to store this bitset, and I did not know where.
So what do you suggest that we do?


> 
> > Yes it appears that this is the standard way to call it. See for example the paper "On pitfalls in computing the geodetic number of a graph" by Hansen and van Omme.
> 
> Weird `O_o`
:-)


> 
> Nathann


---

Comment by ncohen created at 2014-12-21 17:53:03

> So what do you suggest that we do?

We rename `convexity_properties` to `geodetic_properties` and you add your `geodetic_closure` function there ? `:-P`

It is a bad design, but I still don't know how to implement it otherwise `^^;`

Nathann


---

Comment by ncohen created at 2014-12-21 18:12:45

http://en.wikipedia.org/wiki/Closure_%28mathematics%29

They also agree that a closure operator should be idempotent. Cursed wrong terminology. If we have a `geodetic_closure` function we must remember to add a big warning saying that this operation is NOT a closure, and blame those guys while citing the reference `:-P`

Nathann


---

Comment by azi created at 2014-12-22 09:54:15

Replying to [comment:9 ncohen]:
> > So what do you suggest that we do?
> 
> We rename `convexity_properties` to `geodetic_properties` and you add your `geodetic_closure` function there ? `:-P`
Okay. Do you also want to do it your way with the bitfields present there or use the thing I pushed here? In the former case I suppose its much better if you just put it in as you already know the code?


> 
> It is a bad design, but I still don't know how to implement it otherwise `^^;`
:-P

> 
> Nathann


---

Comment by ncohen created at 2014-12-22 10:05:34

Yo !

> Okay. Do you also want to do it your way with the bitfields present there or use the thing I pushed here? In the former case I suppose its much better if you just put it in as you already know the code?

Sorry I can't do that now... Juggling with many computers at once and a slideshow to get ready for tomorrow. Can you do it ? Really it is nothing very complicated, and you should find inside some very similar function that computes the hull of a set of vertices. The geodetic is even simpler.

Nathann


---

Comment by azi created at 2014-12-22 10:10:37

yoo,

Okay hopefully I manage to do it by today.

Good luck with presentation :-)

Jernej


---

Comment by dcoudert created at 2021-09-05 10:08:24

Changing status from needs_info to needs_review.


---

Comment by dcoudert created at 2021-09-05 10:08:24

I pushed a new branch with a more efficient implementation (in Cython). In particular, it does not require to compute and store the full distance matrix, and so can be used on quite large graphs. It is so far for undirected graphs only.
----
New commits:


---

Comment by git created at 2021-09-05 10:17:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2021-09-05 10:18:52

Add not implemented error when calling this method on digraphs.


---

Comment by slelievre created at 2021-09-18 20:58:37

Geodesic or geodetic?


---

Comment by dcoudert created at 2021-09-18 21:09:25

The term used in the field is geodetic https://doi.org/10.1016/0895-7177(93)90259-2. Don't know why...


---

Comment by tscrim created at 2021-10-03 08:49:20

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2021-10-03 08:49:20

LGTM.

If you care enough, I believe there is a typo in this comment:

```
# Copy the graph has a short digraph
```



---

Comment by git created at 2021-10-03 08:53:04

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2021-10-03 08:53:04

Changing status from positive_review to needs_review.


---

Comment by dcoudert created at 2021-10-03 08:54:12

I fixed the typo. Let me know if I should set the ticket back to needs review.

Thank you for the review.


---

Comment by tscrim created at 2021-10-03 08:55:36

Trac does it automatically with the push.


---

Comment by tscrim created at 2021-10-03 08:55:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-10-19 20:31:05

Resolution: fixed
