# Issue 25703: Python 3: Chain complex fixes

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2018-07-26 18:49:40

CC:  chapoton

This implements a hash function for chain complexes, and it also fixes a sorting issue in the `_latex_` method. Combined with #25935, this makes tests pass for `src/sage/homology/chain_*` with Python 3.



---

Comment by jhpalmieri created at 2018-07-26 18:54:02

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2018-07-26 18:54:02

Regarding `_latex_`: there used to be an `if...else` block, depending on whether the chain complex was graded over *Z* or over some other group. First, there was a bug in the code, so it was printing the wrong thing, and also printing incomplete information, in the non *Z* case. Second, the special case is not needed: the *Z* code works just as well for other cases, I think. There may be problems if the grading group is not free abelian, I'm not sure. In any case, this is an improvement over the previous situation.
----
New commits:


---

Comment by tscrim created at 2018-07-26 23:15:35

LGTM modulo one probably extremely unlikely corner case if `deg` is in `SR`:

```
sage: SR(-1) < 0
-1 < 0
sage: sorted([1,2,3,4], reverse=(SR(-1) < 0))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-600718e2dfaa> in <module>()
----> 1 sorted([Integer(1),Integer(2),Integer(3),Integer(4)], reverse=(SR(-Integer(1)) < Integer(0)))

/home/travis/sage-build/local/lib/python2.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__int__ (build/cythonized/sage/symbolic/expression.cpp:9460)()
   1112             rif_self = sage.rings.all.RIF(self)
   1113         except TypeError:
-> 1114             raise ValueError("cannot convert %s to int" % self)
   1115         if rif_self > 0 or (rif_self.contains_zero() and self > 0):
   1116             result = floor(self)

ValueError: cannot convert -1 < 0 to int
```

The fix would be `bool(deg < 0)`:

```
sage: sorted([1,2,3,4], reverse=bool(SR(-1) < 0))
[4, 3, 2, 1]
```



---

Comment by tscrim created at 2018-07-26 23:15:35

Changing keywords from "" to "sagedays@icerm".


---

Comment by git created at 2018-07-26 23:28:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2018-07-26 23:28:59

Good idea.


---

Comment by tscrim created at 2018-07-26 23:37:32

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-07-26 23:37:32

LGTM. Thanks.


---

Comment by vbraun created at 2018-08-07 20:40:18

Resolution: fixed
