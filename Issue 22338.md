# Issue 22338: Fix Polyhedron.base_extend so it does not ignore the backend parameter

archive/issues_022338.json:
```json
{
    "body": "CC:  @mkoeppe @jplab @tscrim\n\nKeywords: days84, polytope\n\nPolyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).\n\n\n\nPossible follow-up: Also a new method `change_backend` could be implemented as an alias. (Once done, add it to tutorial, too.)\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22575\n\n",
    "closed_at": "2018-10-01T22:35:49Z",
    "created_at": "2017-03-10T15:21:14Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Fix Polyhedron.base_extend so it does not ignore the backend parameter",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22338",
    "user": "https://github.com/mforets"
}
```
CC:  @mkoeppe @jplab @tscrim

Keywords: days84, polytope

Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).



Possible follow-up: Also a new method `change_backend` could be implemented as an alias. (Once done, add it to tutorial, too.)


Issue created by migration from https://trac.sagemath.org/ticket/22575





---

archive/issue_comments_310175.json:
```json
{
    "body": "`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!\n\n```\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P\nA 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray\nsage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')\nsage: type(P_cdd)\n<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>\n```\n\nThis is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...\n\n```\nsage: par = P.parent()\nsage: par.base_extend??     # this is worth looking at...\n```\n\nI guess one could simply correct that...\n\nNow the question is whether there is a smart way to go from one to another?",
    "created_at": "2017-03-15T15:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310175",
    "user": "https://github.com/jplab"
}
```

`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!

```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')
sage: type(P_cdd)
<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>
```

This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...

```
sage: par = P.parent()
sage: par.base_extend??     # this is worth looking at...
```

I guess one could simply correct that...

Now the question is whether there is a smart way to go from one to another?



---

archive/issue_comments_310176.json:
```json
{
    "body": "See also #22701.",
    "created_at": "2017-03-28T18:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310176",
    "user": "https://github.com/mkoeppe"
}
```

See also #22701.



---

archive/issue_comments_310177.json:
```json
{
    "body": "Replying to [comment:1 jipilab]:\n> ...\n> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...\n> \n> \n> ```\n> sage: par = P.parent()\n> sage: par.base_extend??     # this is worth looking at...\n> ```\n> \n\n\ngood finding, maybe this was a feature that didn't get in at the time. \n\nalso, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. \n\n> I guess one could simply correct that...\n> \n> Now the question is whether there is a smart way to go from one to another?\n\n\ni suggest to just start with the naive way and see how it behaves.",
    "created_at": "2017-04-11T15:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310177",
    "user": "https://github.com/mforets"
}
```

Replying to [comment:1 jipilab]:
> ...
> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...
> 
> 
> ```
> sage: par = P.parent()
> sage: par.base_extend??     # this is worth looking at...
> ```
> 


good finding, maybe this was a feature that didn't get in at the time. 

also, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. 

> I guess one could simply correct that...
> 
> Now the question is whether there is a smart way to go from one to another?


i suggest to just start with the naive way and see how it behaves.



---

archive/issue_events_058943.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2018-09-29T22:11:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22338#event-58943"
}
```



---

archive/issue_comments_310178.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310178",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_310179.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310179",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_310180.json:
```json
{
    "body": "So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:\n\n```\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)\nsage: P.backend()\n'ppl'\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')\nsage: P.backend()\n'normaliz'\nsage: P.base_extend(QQ).backend()\n'ppl'\n```\nSo if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.",
    "created_at": "2018-09-30T07:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310180",
    "user": "https://github.com/tscrim"
}
```

So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:

```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)
sage: P.backend()
'ppl'
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')
sage: P.backend()
'normaliz'
sage: P.base_extend(QQ).backend()
'ppl'
```
So if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.



---

archive/issue_comments_310181.json:
```json
{
    "body": "Replying to [comment:8 tscrim]:\n> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:\n\n\nOne might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. \n\nI'll add some documentation.",
    "created_at": "2018-09-30T08:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310181",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:8 tscrim]:
> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:


One might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. 

I'll add some documentation.



---

archive/issue_comments_310182.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-30T08:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_310183.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310183",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_310184.json:
```json
{
    "body": "Thanks. LGTM.",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310184",
    "user": "https://github.com/tscrim"
}
```

Thanks. LGTM.



---

archive/issue_comments_310185.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-01T22:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310185",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_058944.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-01T22:35:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22338#event-58944"
}
```
