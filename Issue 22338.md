# Issue 22338: Add .change_backend() method for polyhedra

archive/issues_022338.json:
```json
{
    "body": "CC:  @mkoeppe @jplab @tscrim\n\nKeywords: days84, polytope\n\nPolyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22575\n\n",
    "created_at": "2017-03-10T15:21:14Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Add .change_backend() method for polyhedra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22338",
    "user": "@mforets"
}
```
CC:  @mkoeppe @jplab @tscrim

Keywords: days84, polytope

Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.

Issue created by migration from https://trac.sagemath.org/ticket/22575





---

archive/issue_comments_310523.json:
```json
{
    "body": "`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!\n\n\n```\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P\nA 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray\nsage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')\nsage: type(P_cdd)\n<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>\n```\n\n\nThis is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...\n\n\n```\nsage: par = P.parent()\nsage: par.base_extend??     # this is worth looking at...\n```\n\n\nI guess one could simply correct that...\n\nNow the question is whether there is a smart way to go from one to another?",
    "created_at": "2017-03-15T15:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310523",
    "user": "@jplab"
}
```

`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!


```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')
sage: type(P_cdd)
<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>
```


This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...


```
sage: par = P.parent()
sage: par.base_extend??     # this is worth looking at...
```


I guess one could simply correct that...

Now the question is whether there is a smart way to go from one to another?



---

archive/issue_comments_310524.json:
```json
{
    "body": "See also #22701.",
    "created_at": "2017-03-28T18:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310524",
    "user": "@mkoeppe"
}
```

See also #22701.



---

archive/issue_comments_310525.json:
```json
{
    "body": "Replying to [comment:1 jipilab]:\n> ...\n> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...\n> \n> {{{\n> sage: par = P.parent()\n> sage: par.base_extend??     # this is worth looking at...\n> }}}\n> \n\ngood finding, maybe this was a feature that didn't get in at the time. \n\nalso, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. \n\n> I guess one could simply correct that...\n> \n> Now the question is whether there is a smart way to go from one to another?\n\ni suggest to just start with the naive way and see how it behaves.",
    "created_at": "2017-04-11T15:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310525",
    "user": "@mforets"
}
```

Replying to [comment:1 jipilab]:
> ...
> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...
> 
> {{{
> sage: par = P.parent()
> sage: par.base_extend??     # this is worth looking at...
> }}}
> 

good finding, maybe this was a feature that didn't get in at the time. 

also, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. 

> I guess one could simply correct that...
> 
> Now the question is whether there is a smart way to go from one to another?

i suggest to just start with the naive way and see how it behaves.



---

archive/issue_comments_310526.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310526",
    "user": "@mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_310527.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310527",
    "user": "@mkoeppe"
}
```

New commits:



---

archive/issue_comments_310528.json:
```json
{
    "body": "So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:\n\n```\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)\nsage: P.backend()\n'ppl'\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')\nsage: P.backend()\n'normaliz'\nsage: P.base_extend(QQ).backend()\n'ppl'\n```\n\nSo if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.",
    "created_at": "2018-09-30T07:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310528",
    "user": "@tscrim"
}
```

So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:

```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)
sage: P.backend()
'ppl'
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')
sage: P.backend()
'normaliz'
sage: P.base_extend(QQ).backend()
'ppl'
```

So if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.



---

archive/issue_comments_310529.json:
```json
{
    "body": "Replying to [comment:8 tscrim]:\n> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:\n\nOne might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. \n\nI'll add some documentation.",
    "created_at": "2018-09-30T08:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310529",
    "user": "@mkoeppe"
}
```

Replying to [comment:8 tscrim]:
> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:

One might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. 

I'll add some documentation.



---

archive/issue_comments_310530.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-30T08:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310530",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_310531.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310531",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_310532.json:
```json
{
    "body": "Thanks. LGTM.",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310532",
    "user": "@tscrim"
}
```

Thanks. LGTM.



---

archive/issue_comments_310533.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-01T22:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22338#issuecomment-310533",
    "user": "@vbraun"
}
```

Resolution: fixed
