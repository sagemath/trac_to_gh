# Issue 22338: Add .change_backend() method for polyhedra

Issue created by migration from Trac.

Original creator: mforets

Original creation time: 2017-03-10 15:21:14

CC:  mkoeppe jipilab tscrim

Keywords: days84, polytope

Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.


---

Comment by jipilab created at 2017-03-15 15:42:33

`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!


```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')
sage: type(P_cdd)
<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>
```


This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...


```
sage: par = P.parent()
sage: par.base_extend??     # this is worth looking at...
```


I guess one could simply correct that...

Now the question is whether there is a smart way to go from one to another?


---

Comment by mkoeppe created at 2017-03-28 18:26:01

See also #22701.


---

Comment by mforets created at 2017-04-11 15:08:40

Replying to [comment:1 jipilab]:
> ...
> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...
> 
> {{{
> sage: par = P.parent()
> sage: par.base_extend??     # this is worth looking at...
> }}}
> 

good finding, maybe this was a feature that didn't get in at the time. 

also, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. 

> I guess one could simply correct that...
> 
> Now the question is whether there is a smart way to go from one to another?

i suggest to just start with the naive way and see how it behaves.


---

Comment by mkoeppe created at 2018-09-30 06:14:03

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2018-09-30 06:14:03

New commits:


---

Comment by tscrim created at 2018-09-30 07:47:56

So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:

```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)
sage: P.backend()
'ppl'
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')
sage: P.backend()
'normaliz'
sage: P.base_extend(QQ).backend()
'ppl'
```

So if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.


---

Comment by mkoeppe created at 2018-09-30 08:34:11

Replying to [comment:8 tscrim]:
> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:

One might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. 

I'll add some documentation.


---

Comment by git created at 2018-09-30 08:39:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-09-30 13:08:50

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-09-30 13:08:50

Thanks. LGTM.


---

Comment by vbraun created at 2018-10-01 22:35:49

Resolution: fixed
