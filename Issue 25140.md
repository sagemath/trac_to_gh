# Issue 25140: Let number_field_elements_from_algebraics() return result using same field as input

Issue created by migration from https://trac.sagemath.org/ticket/25377

Original creator: @BrentBaccala

Original creation time: 2018-05-17 00:08:59

I often want `number_field_elements_from_algebraics()` to return a morphism that goes back to the same field as the elements that I passed in.

For example:


```
sage: number_field_elements_from_algebraics(QQbar(2))
(Rational Field, 2, Ring morphism:
   From: Rational Field
   To:   Algebraic Real Field
   Defn: 1 |--> 1)
```


Notice that the morphism comes back to `AA`, not `QQbar`.

I've added an option to get the behavior that I want:


```
sage: number_field_elements_from_algebraics(QQbar(2), same_field=True)
(Rational Field, 2, Ring morphism:
   From: Rational Field
   To:   Algebraic Field
   Defn: 1 |--> 1)
```


Perhaps this should be the default, but it broke enough regression tests that I left it as an option.



---

Comment by @BrentBaccala created at 2018-05-17 00:11:53

Changing status from new to needs_review.


---

Comment by @BrentBaccala created at 2018-05-17 00:11:53

New commits:


---

Comment by vdelecroix created at 2018-05-17 06:50:21

I also think that this would better be the default. Where the failures are?


---

Comment by vdelecroix created at 2018-05-17 06:55:20

Note: this ticket is likely to create conflicts #20181


---

Comment by @BrentBaccala created at 2018-05-18 04:33:49

Replying to [comment:2 vdelecroix]:
> I also think that this would better be the default. Where the failures are?

This is the only troublesome one:


```
sage: a = QQbar((-1)^(1/4)); b = AA(a^3-a); t = b.as_number_field_element()
```


It raises an exception with the new code (if `same_field=True` is the default).

The problem is that without `minimal=True`, the generated number field might be complex, and thus unable to map back to `AA`.

So, if the elements are from `AA`, `same_field=True` might not work without  `minimal=True`, and I wasn't inclined to change that default.


---

Comment by mmezzarobba created at 2018-05-23 14:18:44

Replying to [comment:4 gh-BrentBaccala]:
> The problem is that without `minimal=True`, the generated number field might be complex, and thus unable to map back to `AA`.
> 
> So, if the elements are from `AA`, `same_field=True` might not work without  `minimal=True`, and I wasn't inclined to change that default.

Sounds sensible. And the code looks good to me. One minor nitpick (not worth delaying the ticket IMO): I personally don't like the use of `_` to store a value that you are going to access again (as opposed to cases like `a, _, b = foo` where you need to provide a variable but don't care about the value).


---

Comment by mmezzarobba created at 2018-05-23 14:18:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-05-27 17:01:29

Resolution: fixed
