# Issue 14578: empty ticks result in empty axes in log scale

archive/issues_014578.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @kcrisman\n\nThe axes do not get plotted in this\n\n```\nplot_loglog(x^2,(x,1,100),base=10,ticks=[[],[]])\n```\n\nwhereas they do get plotted in linear scale\n\n```\nplot(x^2,(x,1,100),base=10,ticks=[[],[]])\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/14782\n\n",
    "created_at": "2013-06-20T01:14:07Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "empty ticks result in empty axes in log scale",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14578",
    "user": "https://github.com/ppurka"
}
```
Assignee: jason, was

CC:  @kcrisman

The axes do not get plotted in this

```
plot_loglog(x^2,(x,1,100),base=10,ticks=[[],[]])
```

whereas they do get plotted in linear scale

```
plot(x^2,(x,1,100),base=10,ticks=[[],[]])
```


Issue created by migration from https://trac.sagemath.org/ticket/14782





---

archive/issue_events_042402.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14578#event-42402"
}
```



---

archive/issue_events_042403.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14578#event-42403"
}
```



---

archive/issue_events_042404.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14578#event-42404"
}
```



---

archive/issue_events_042405.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14578#event-42405"
}
```



---

archive/issue_events_042406.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14578#event-42406"
}
```



---

archive/issue_comments_184955.json:
```json
{
    "body": "This patch should fix empty axes in log scale.\n----\nNew commits:",
    "created_at": "2014-07-07T12:22:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184955",
    "user": "https://github.com/ppurka"
}
```

This patch should fix empty axes in log scale.
----
New commits:



---

archive/issue_comments_184956.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-07T12:22:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184956",
    "user": "https://github.com/ppurka"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_184957.json:
```json
{
    "body": "Dumb question - is this because `bbox_extra_artists=self._bbox_extra_artists` wasn't added when `fig_tight` wasn't `True`?   (Where those extra artists are presumably the axes and `fig_tight` wasn't set in log scale or something?)  Just want to know why this works before I test that it does work :)",
    "created_at": "2014-07-07T13:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184957",
    "user": "https://github.com/kcrisman"
}
```

Dumb question - is this because `bbox_extra_artists=self._bbox_extra_artists` wasn't added when `fig_tight` wasn't `True`?   (Where those extra artists are presumably the axes and `fig_tight` wasn't set in log scale or something?)  Just want to know why this works before I test that it does work :)



---

archive/issue_comments_184958.json:
```json
{
    "body": "The problem seems to stem from the `bbox_extra_artists` being an empty list. Having `fig_tight` true or false is not the main point here.\n\n\nIt seems quite hard to reproduce this problem directly in `matplotlib.pyplot`. One really needs to use the internal commands in mpl and save figure via `FigureCanvasAgg` to see this bug. Actually, I do not know if it is a problem with the way sage calls the mpl commands, or if it is a real bug in mpl. If it is a bug in mpl, then it is a very subtle bug because the following command gives us back the axes:\n\n```\nplot_loglog(x^2,(x,1,100), ticks=[[],[]], axes_labels=['x','y'])\n```\n",
    "created_at": "2014-07-08T05:44:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184958",
    "user": "https://github.com/ppurka"
}
```

The problem seems to stem from the `bbox_extra_artists` being an empty list. Having `fig_tight` true or false is not the main point here.


It seems quite hard to reproduce this problem directly in `matplotlib.pyplot`. One really needs to use the internal commands in mpl and save figure via `FigureCanvasAgg` to see this bug. Actually, I do not know if it is a problem with the way sage calls the mpl commands, or if it is a real bug in mpl. If it is a bug in mpl, then it is a very subtle bug because the following command gives us back the axes:

```
plot_loglog(x^2,(x,1,100), ticks=[[],[]], axes_labels=['x','y'])
```




---

archive/issue_comments_184959.json:
```json
{
    "body": "To add to/clarify my previous post.. it is a combination of both `fig_tight` and `bbox_extra_artists`, i.e., `fig_tight=True` and `bbox_extra_artists=[]` triggers the bug. `fig_tight=True` seems to be the default in Sage.",
    "created_at": "2014-07-08T05:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184959",
    "user": "https://github.com/ppurka"
}
```

To add to/clarify my previous post.. it is a combination of both `fig_tight` and `bbox_extra_artists`, i.e., `fig_tight=True` and `bbox_extra_artists=[]` triggers the bug. `fig_tight=True` seems to be the default in Sage.



---

archive/issue_comments_184960.json:
```json
{
    "body": "Here is a \"minimal\" (really???!!!) code to reproduce it in matplotlib\n\n```\nfrom matplotlib.figure import Figure\nfrom matplotlib.ticker import NullLocator\nfrom matplotlib.backends.backend_agg import FigureCanvasAgg\nimport matplotlib.lines as lines\nfigure=Figure()\nsubplot = figure.add_subplot(111)\nsubplot.add_line(lines.Line2D(range(10), range(10)))\n\nsubplot.spines['right'].set_visible(False)\nsubplot.spines['left'].set_position(('outward',10))\nsubplot.spines['top'].set_visible(False)\nsubplot.spines['bottom'].set_position(('outward',10))\n\nsubplot.xaxis.set_major_locator(NullLocator())\nsubplot.yaxis.set_major_locator(NullLocator())\n\nfigure.set_canvas(FigureCanvasAgg(figure))\nfigure.savefig('a.png', bbox_inches='tight', bbox_extra_artists=[])\n```\n\n\nThings which bring back the axes:\n1. Set the `outward` parameter a bit less\n\n```\nsubplot.spines['bottom'].set_position(('outward',7)) # just barely\nsubplot.spines['left'].set_position(('outward',7))\n```\n\n2. Either remove `bbox_inches='tight'` or `bbox_extra_artists=[]` from the `savefig` command.\n\n**Edit**: Note that the above is *not* in log scale!",
    "created_at": "2014-07-09T12:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184960",
    "user": "https://github.com/ppurka"
}
```

Here is a "minimal" (really???!!!) code to reproduce it in matplotlib

```
from matplotlib.figure import Figure
from matplotlib.ticker import NullLocator
from matplotlib.backends.backend_agg import FigureCanvasAgg
import matplotlib.lines as lines
figure=Figure()
subplot = figure.add_subplot(111)
subplot.add_line(lines.Line2D(range(10), range(10)))

subplot.spines['right'].set_visible(False)
subplot.spines['left'].set_position(('outward',10))
subplot.spines['top'].set_visible(False)
subplot.spines['bottom'].set_position(('outward',10))

subplot.xaxis.set_major_locator(NullLocator())
subplot.yaxis.set_major_locator(NullLocator())

figure.set_canvas(FigureCanvasAgg(figure))
figure.savefig('a.png', bbox_inches='tight', bbox_extra_artists=[])
```


Things which bring back the axes:
1. Set the `outward` parameter a bit less

```
subplot.spines['bottom'].set_position(('outward',7)) # just barely
subplot.spines['left'].set_position(('outward',7))
```

2. Either remove `bbox_inches='tight'` or `bbox_extra_artists=[]` from the `savefig` command.

**Edit**: Note that the above is *not* in log scale!



---

archive/issue_comments_184961.json:
```json
{
    "body": "Weird, though I believe this probably is minimal, after reading the graphics code for the axes again.  I'll let you decide whether this is a mpl bug and whether to report it upstream; it may be intended behavior.\n\n\nIn fact, what this also fixes is the following, which was missed before because the axes were so big they were drawn to touch.\n\n```\nsage: plot(x^2,(x,1,2),ticks=[[],[]])\n```\n\nwhile\n\n```\nsage: plot(x^2,(x,1,2),ticks=[[],[3,4]])\n```\n\nwas only missing one axis.  So it is really tight, no extra artists, and no (or few) ticks that does it!  Quite a combination.\n\nSo positive review to your fix!  Do you want to include a doctest?  I don't know that we could automatically check for this - I poked around with `P.matplotlib()` for a while trying to get access to this but couldn't find something telling me it was invisible, and in fact it still seems to have all the attributes that would automatically accrue to it.",
    "created_at": "2014-07-10T14:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184961",
    "user": "https://github.com/kcrisman"
}
```

Weird, though I believe this probably is minimal, after reading the graphics code for the axes again.  I'll let you decide whether this is a mpl bug and whether to report it upstream; it may be intended behavior.


In fact, what this also fixes is the following, which was missed before because the axes were so big they were drawn to touch.

```
sage: plot(x^2,(x,1,2),ticks=[[],[]])
```

while

```
sage: plot(x^2,(x,1,2),ticks=[[],[3,4]])
```

was only missing one axis.  So it is really tight, no extra artists, and no (or few) ticks that does it!  Quite a combination.

So positive review to your fix!  Do you want to include a doctest?  I don't know that we could automatically check for this - I poked around with `P.matplotlib()` for a while trying to get access to this but couldn't find something telling me it was invisible, and in fact it still seems to have all the attributes that would automatically accrue to it.



---

archive/issue_comments_184962.json:
```json
{
    "body": "I do not know how to doctest this. That's why there is no doctest included.\n\nAs for whether it is an mpl bug or not, I am quite divided. It is the Sage code which sets `(outward,10)` for the axis. I am not sure if this is intended behavior. It is definitely not default behavior for mpl.",
    "created_at": "2014-07-10T14:51:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184962",
    "user": "https://github.com/ppurka"
}
```

I do not know how to doctest this. That's why there is no doctest included.

As for whether it is an mpl bug or not, I am quite divided. It is the Sage code which sets `(outward,10)` for the axis. I am not sure if this is intended behavior. It is definitely not default behavior for mpl.



---

archive/issue_comments_184963.json:
```json
{
    "body": "> I do not know how to doctest this. That's why there is no doctest included.\nI suppose one could just include a plot like `plot(x^2,(x,1,2),ticks=[[],[]])` as a doctest, with a comment pointing out \"fixes :trac:`14782`\" or something.  We do that occasionally when there is no other way to do so.  If it's not too much trouble, I think that would be good - could certainly go in an obscure part of `TESTS:` or something.",
    "created_at": "2014-07-10T15:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184963",
    "user": "https://github.com/kcrisman"
}
```

> I do not know how to doctest this. That's why there is no doctest included.
I suppose one could just include a plot like `plot(x^2,(x,1,2),ticks=[[],[]])` as a doctest, with a comment pointing out "fixes :trac:`14782`" or something.  We do that occasionally when there is no other way to do so.  If it's not too much trouble, I think that would be good - could certainly go in an obscure part of `TESTS:` or something.



---

archive/issue_comments_184964.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-11T13:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_184965.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-11T14:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184965",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_184966.json:
```json
{
    "body": "Thanks, glad you concur.",
    "created_at": "2014-07-11T14:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184966",
    "user": "https://github.com/kcrisman"
}
```

Thanks, glad you concur.



---

archive/issue_events_042407.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-12T05:12:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14578#event-42407"
}
```



---

archive/issue_comments_184967.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-12T05:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14578#issuecomment-184967",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
