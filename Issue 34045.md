# Issue 34045: Make feature TeXFile check latex first

archive/issues_034045.json:
```json
{
    "body": "CC:  @seblabbe\n\nKeywords: latex texfile feature\n\nCurrently, as observed in [comment 7](https://trac.sagemath.org/ticket/34185#comment:7) of #34185, the method `is_present` of instances of class `TeXFile` runs into an exception if latex is not installed. For example:\n\n```\nsage: from sage.features.latex import LaTeXPackage\nsage: LaTeXPackage(\"tkz-graph\").is_present()\nTraceback (most recent call last):\n...\nFileNotFoundError: [Errno 2] No such file or directory: 'kpsewhich'\n```\n\nThe aim of the ticket is to fix this.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34282\n\n",
    "closed_at": "2022-09-22T22:35:37Z",
    "created_at": "2022-08-05T06:39:37Z",
    "labels": [
        "component: doctest framework",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Make feature TeXFile check latex first",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34045",
    "user": "https://github.com/soehms"
}
```
CC:  @seblabbe

Keywords: latex texfile feature

Currently, as observed in [comment 7](https://trac.sagemath.org/ticket/34185#comment:7) of #34185, the method `is_present` of instances of class `TeXFile` runs into an exception if latex is not installed. For example:

```
sage: from sage.features.latex import LaTeXPackage
sage: LaTeXPackage("tkz-graph").is_present()
Traceback (most recent call last):
...
FileNotFoundError: [Errno 2] No such file or directory: 'kpsewhich'
```

The aim of the ticket is to fix this.


Issue created by migration from https://trac.sagemath.org/ticket/34282





---

archive/issue_comments_482613.json:
```json
{
    "body": "Changing component from packages: optional to doctest framework.",
    "created_at": "2022-08-05T06:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482613",
    "user": "https://github.com/soehms"
}
```

Changing component from packages: optional to doctest framework.



---

archive/issue_comments_482614.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-08-05T06:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482614",
    "user": "https://github.com/soehms"
}
```

New commits:



---

archive/issue_comments_482615.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-05T06:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482615",
    "user": "https://github.com/soehms"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_482616.json:
```json
{
    "body": "I think it would also make sense to add `spkg='texlive'` to these features",
    "created_at": "2022-08-05T18:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482616",
    "user": "https://github.com/mkoeppe"
}
```

I think it would also make sense to add `spkg='texlive'` to these features



---

archive/issue_comments_482617.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-08T17:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482618.json:
```json
{
    "body": "Replying to [comment:3 mkoeppe]:\n> I think it would also make sense to add `spkg='texlive'` to these features\n\n\nDone! Furthermore, I refactor the executable features not only to avoid duplicated code, but also since in my point of view it is not reasonable that just the `latex` feature has a stronger `is_functional` check.",
    "created_at": "2022-08-08T17:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482618",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:3 mkoeppe]:
> I think it would also make sense to add `spkg='texlive'` to these features


Done! Furthermore, I refactor the executable features not only to avoid duplicated code, but also since in my point of view it is not reasonable that just the `latex` feature has a stronger `is_functional` check.



---

archive/issue_comments_482619.json:
```json
{
    "body": "```diff\ndiff --git a/src/sage/features/latex.py b/src/sage/features/latex.py\nindex cf65aea6af..7db89f6190 100644\n--- a/src/sage/features/latex.py\n+++ b/src/sage/features/latex.py\n@@ -37,7 +37,7 @@ class LaTeX(Executable):\n             sage: isinstance(latex(), latex)\n             True\n         \"\"\"\n-        Executable.__init__(self, name, executable=name, spkg=latex_spkg, url=latex_url)\n+        super().__init__(name, executable=name, spkg=latex_spkg, url=latex_url)\n \n     def is_functional(self):\n         r\"\"\"\n@@ -217,13 +217,10 @@ class TeXFile(StaticFile, JoinFeature):\n             sage: from sage.features.latex import LaTeXPackage, pdflatex\n             sage: f = LaTeXPackage(\"tkz-graph\")\n             sage: g = pdflatex()\n-            sage: bool(f.is_present()) == bool(g.is_present())  # indirect doctest\n+            sage: not f.is_present() or bool(g.is_present())  # indirect doctest\n             True\n         \"\"\"\n-        test = JoinFeature._is_present(self)\n-        if not test:\n-            return test\n-        return super(TeXFile, self)._is_present()\n+        return JoinFeature._is_present(self) and StaticFile._is_present(self)\n \n```",
    "created_at": "2022-08-20T01:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482619",
    "user": "https://github.com/kwankyu"
}
```

```diff
diff --git a/src/sage/features/latex.py b/src/sage/features/latex.py
index cf65aea6af..7db89f6190 100644
--- a/src/sage/features/latex.py
+++ b/src/sage/features/latex.py
@@ -37,7 +37,7 @@ class LaTeX(Executable):
             sage: isinstance(latex(), latex)
             True
         """
-        Executable.__init__(self, name, executable=name, spkg=latex_spkg, url=latex_url)
+        super().__init__(name, executable=name, spkg=latex_spkg, url=latex_url)
 
     def is_functional(self):
         r"""
@@ -217,13 +217,10 @@ class TeXFile(StaticFile, JoinFeature):
             sage: from sage.features.latex import LaTeXPackage, pdflatex
             sage: f = LaTeXPackage("tkz-graph")
             sage: g = pdflatex()
-            sage: bool(f.is_present()) == bool(g.is_present())  # indirect doctest
+            sage: not f.is_present() or bool(g.is_present())  # indirect doctest
             True
         """
-        test = JoinFeature._is_present(self)
-        if not test:
-            return test
-        return super(TeXFile, self)._is_present()
+        return JoinFeature._is_present(self) and StaticFile._is_present(self)
 
```



---

archive/issue_comments_482620.json:
```json
{
    "body": "By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?",
    "created_at": "2022-08-20T01:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482620",
    "user": "https://github.com/kwankyu"
}
```

By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?



---

archive/issue_comments_482621.json:
```json
{
    "body": "Replying to [comment:6 klee]:\n> {{{#!diff\n> diff --git a/src/sage/features/latex.py b/src/sage/features/latex.py\n> index cf65aea6af..7db89f6190 100644\n> --- a/src/sage/features/latex.py\n> +++ b/src/sage/features/latex.py\n> `@``@` -37,7 +37,7 `@``@` class LaTeX(Executable):\n>              sage: isinstance(latex(), latex)\n>              True\n>          \"\"\"\n> -        Executable.__init__(self, name, executable=name, spkg=latex_spkg, url=latex_url)\n> +        super().__init__(name, executable=name, spkg=latex_spkg, url=latex_url)\n>  \n>      def is_functional(self):\n>          r\"\"\"\n> `@``@` -217,13 +217,10 `@``@` class TeXFile(StaticFile, JoinFeature):\n>              sage: from sage.features.latex import LaTeXPackage, pdflatex\n>              sage: f = LaTeXPackage(\"tkz-graph\")\n>              sage: g = pdflatex()\n> -            sage: bool(f.is_present()) == bool(g.is_present())  # indirect doctest\n> +            sage: not f.is_present() or bool(g.is_present())  # indirect doctest\n>              True\n>          \"\"\"\n> -        test = JoinFeature._is_present(self)\n> -        if not test:\n> -            return test\n> -        return super(TeXFile, self)._is_present()\n> +        return JoinFeature._is_present(self) and StaticFile._is_present(self)\n>  \n> }}}\n\n\nI'm fine with your first suggestion. Concerning the second, the advantage is not clear to me. \n\nWith your third suggestion I have a problem since in general I prefer to serialise condition checks if they only work in a certain order. I know that it is no problem any more with modern languages and compilers, since they implicitly serialise in the order they are written. But the syntax using `and` / `or` pretends a parallelism which is not given in such a situation.",
    "created_at": "2022-08-20T14:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482621",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:6 klee]:
> {{{#!diff
> diff --git a/src/sage/features/latex.py b/src/sage/features/latex.py
> index cf65aea6af..7db89f6190 100644
> --- a/src/sage/features/latex.py
> +++ b/src/sage/features/latex.py
> `@``@` -37,7 +37,7 `@``@` class LaTeX(Executable):
>              sage: isinstance(latex(), latex)
>              True
>          """
> -        Executable.__init__(self, name, executable=name, spkg=latex_spkg, url=latex_url)
> +        super().__init__(name, executable=name, spkg=latex_spkg, url=latex_url)
>  
>      def is_functional(self):
>          r"""
> `@``@` -217,13 +217,10 `@``@` class TeXFile(StaticFile, JoinFeature):
>              sage: from sage.features.latex import LaTeXPackage, pdflatex
>              sage: f = LaTeXPackage("tkz-graph")
>              sage: g = pdflatex()
> -            sage: bool(f.is_present()) == bool(g.is_present())  # indirect doctest
> +            sage: not f.is_present() or bool(g.is_present())  # indirect doctest
>              True
>          """
> -        test = JoinFeature._is_present(self)
> -        if not test:
> -            return test
> -        return super(TeXFile, self)._is_present()
> +        return JoinFeature._is_present(self) and StaticFile._is_present(self)
>  
> }}}


I'm fine with your first suggestion. Concerning the second, the advantage is not clear to me. 

With your third suggestion I have a problem since in general I prefer to serialise condition checks if they only work in a certain order. I know that it is no problem any more with modern languages and compilers, since they implicitly serialise in the order they are written. But the syntax using `and` / `or` pretends a parallelism which is not given in such a situation.



---

archive/issue_comments_482622.json:
```json
{
    "body": "Replying to [comment:7 klee]:\n> By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?\n\n\nAFAIK there is no feature that checks if `texlive` is just installed, no? Do you want to create a new feature or just replace the join with `pdflatex` by `latex`?",
    "created_at": "2022-08-20T14:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482622",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:7 klee]:
> By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?


AFAIK there is no feature that checks if `texlive` is just installed, no? Do you want to create a new feature or just replace the join with `pdflatex` by `latex`?



---

archive/issue_comments_482623.json:
```json
{
    "body": "Replying to [comment:8 soehms]:\n> Concerning the second, the advantage is not clear to me. \n\n\nHere you want to check that \"if f.is_present, then g.is_present\". Right? My test just does that expressly.\n\n> With your third suggestion I have a problem since in general I prefer to serialise condition checks if they only work in a certain order. I know that it is no problem any more with modern languages and compilers, since they implicitly serialise in the order they are written. But the syntax using `and` / `or` pretends a parallelism which is not given in such a situation.\n\n\nThere is no parallelism here. My simple code exactly does what your code does. Note that\n\n```\nsage: 0 and 1\n0\nsage: 1 and 2\n2\n```\nIn `A and B`, `B` is never evaluated if `A` is false.",
    "created_at": "2022-08-20T16:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482623",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:8 soehms]:
> Concerning the second, the advantage is not clear to me. 


Here you want to check that "if f.is_present, then g.is_present". Right? My test just does that expressly.

> With your third suggestion I have a problem since in general I prefer to serialise condition checks if they only work in a certain order. I know that it is no problem any more with modern languages and compilers, since they implicitly serialise in the order they are written. But the syntax using `and` / `or` pretends a parallelism which is not given in such a situation.


There is no parallelism here. My simple code exactly does what your code does. Note that

```
sage: 0 and 1
0
sage: 1 and 2
2
```
In `A and B`, `B` is never evaluated if `A` is false.



---

archive/issue_comments_482624.json:
```json
{
    "body": "Replying to [comment:10 klee]:\n> Replying to [comment:8 soehms]:\n> > Concerning the second, the advantage is not clear to me. \n\n> \n> Here you want to check that \"if f.is_present, then g.is_present\". Right? My test just does that expressly.\n\n\nConvinced! I had *if and only if* in mind since AFAIK in reallity `f` is always present if `g` is.\n\n> \n> > With your third suggestion I have a problem since in general I prefer to serialise condition checks if they only work in a certain order. I know that it is no problem any more with modern languages and compilers, since they implicitly serialise in the order they are written. But the syntax using `and` / `or` pretends a parallelism which is not given in such a situation.\n\n> \n> There is no parallelism here.\n\n\nI was saying *pretends a parallelism*. \n\n> My simple code exactly does what your code does. \n\n\nSo what is the advantage?\n\n> Note that\n> \n> ```\n> sage: 0 and 1\n> 0\n> sage: 1 and 2\n> 2\n> ```\n> In `A and B`, `B` is never evaluated if `A` is false.\n\n>\n\nMaybe I'm old fashioned, but I know a time where you could not be sure that *`B` is never evaluated if `A` is false* (at least in `C`).",
    "created_at": "2022-08-20T16:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482624",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:10 klee]:
> Replying to [comment:8 soehms]:
> > Concerning the second, the advantage is not clear to me. 

> 
> Here you want to check that "if f.is_present, then g.is_present". Right? My test just does that expressly.


Convinced! I had *if and only if* in mind since AFAIK in reallity `f` is always present if `g` is.

> 
> > With your third suggestion I have a problem since in general I prefer to serialise condition checks if they only work in a certain order. I know that it is no problem any more with modern languages and compilers, since they implicitly serialise in the order they are written. But the syntax using `and` / `or` pretends a parallelism which is not given in such a situation.

> 
> There is no parallelism here.


I was saying *pretends a parallelism*. 

> My simple code exactly does what your code does. 


So what is the advantage?

> Note that
> 
> ```
> sage: 0 and 1
> 0
> sage: 1 and 2
> 2
> ```
> In `A and B`, `B` is never evaluated if `A` is false.

>

Maybe I'm old fashioned, but I know a time where you could not be sure that *`B` is never evaluated if `A` is false* (at least in `C`).



---

archive/issue_comments_482625.json:
```json
{
    "body": "Replying to [comment:11 soehms]:\n> > My simple code exactly does what your code does. \n\n> \n> So what is the advantage?\n\n\nIt took me some time to understand the purpose of your code. My code expresses the purpose.\n\n> > In `A and B`, `B` is never evaluated if `A` is false.\n\n> >\n> \n> Maybe I'm old fashioned, but I know a time where you could not be sure that *`B` is never evaluated if `A` is false* (at least in `C`).\n\n\nYeah, this is just Python:\n\nhttps://docs.python.org/3/reference/expressions.html#boolean-operations",
    "created_at": "2022-08-20T21:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482625",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:11 soehms]:
> > My simple code exactly does what your code does. 

> 
> So what is the advantage?


It took me some time to understand the purpose of your code. My code expresses the purpose.

> > In `A and B`, `B` is never evaluated if `A` is false.

> >
> 
> Maybe I'm old fashioned, but I know a time where you could not be sure that *`B` is never evaluated if `A` is false* (at least in `C`).


Yeah, this is just Python:

https://docs.python.org/3/reference/expressions.html#boolean-operations



---

archive/issue_comments_482626.json:
```json
{
    "body": "Replying to [comment:9 soehms]:\n> Replying to [comment:7 klee]:\n> > By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?\n\n> \n> ...or just replace the join with `pdflatex` by `latex`?\n\n\nYes. I know that they are practically the same, but the name `latex` can be understood as the latex system(texlive) but `pdflatex` refers to the program.",
    "created_at": "2022-08-20T22:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482626",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:9 soehms]:
> Replying to [comment:7 klee]:
> > By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?

> 
> ...or just replace the join with `pdflatex` by `latex`?


Yes. I know that they are practically the same, but the name `latex` can be understood as the latex system(texlive) but `pdflatex` refers to the program.



---

archive/issue_comments_482627.json:
```json
{
    "body": "Replying to [comment:12 klee]:\n> Replying to [comment:11 soehms]:\n> > > My simple code exactly does what your code does. \n\n> > \n> > So what is the advantage?\n\n> \n> It took me some time to understand the purpose of your code. My code expresses the purpose.\n> \n\n\nBut it might be misleading for people who think `and` is a commutative binary operator which is not very unusual for mathematicians :)",
    "created_at": "2022-08-21T06:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482627",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:12 klee]:
> Replying to [comment:11 soehms]:
> > > My simple code exactly does what your code does. 

> > 
> > So what is the advantage?

> 
> It took me some time to understand the purpose of your code. My code expresses the purpose.
> 


But it might be misleading for people who think `and` is a commutative binary operator which is not very unusual for mathematicians :)



---

archive/issue_comments_482628.json:
```json
{
    "body": "Replying to [comment:13 klee]:\n> Replying to [comment:9 soehms]:\n> > Replying to [comment:7 klee]:\n> > > By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?\n\n> > \n> > ...or just replace the join with `pdflatex` by `latex`?\n\n> \n> Yes. I know that they are practically the same, but the name `latex` can be understood as the latex system(texlive) but `pdflatex` refers to the program.\n\n\nAgreed!\n\nI'm on vaccation the next two week. If you don't want to wait that long, feel free to do all of the changes you suggested by yourself.",
    "created_at": "2022-08-21T06:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482628",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:13 klee]:
> Replying to [comment:9 soehms]:
> > Replying to [comment:7 klee]:
> > > By the way, why presence of `kpsewhich` is checked by the presence of `pdflatex`? `kpsewhich` is a component of tex installation. Checking if `texlive` is present isn't enough?

> > 
> > ...or just replace the join with `pdflatex` by `latex`?

> 
> Yes. I know that they are practically the same, but the name `latex` can be understood as the latex system(texlive) but `pdflatex` refers to the program.


Agreed!

I'm on vaccation the next two week. If you don't want to wait that long, feel free to do all of the changes you suggested by yourself.



---

archive/issue_comments_482629.json:
```json
{
    "body": "Replying to [comment:14 soehms]:\n> But it might be misleading for people who think `and` is a commutative binary operator which is not very unusual for mathematicians :)\n\n\nBut for python programmers, the above use of `and` is a common idiom. Don't worry.",
    "created_at": "2022-08-21T06:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482629",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:14 soehms]:
> But it might be misleading for people who think `and` is a commutative binary operator which is not very unusual for mathematicians :)


But for python programmers, the above use of `and` is a common idiom. Don't worry.



---

archive/issue_comments_482630.json:
```json
{
    "body": "Replying to [comment:15 soehms]:\n> I'm on vaccation the next two week. If you don't want to wait that long, feel free to do all of the changes you suggested by yourself.\n\n\nOkay. Happy vacation!",
    "created_at": "2022-08-21T06:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482630",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:15 soehms]:
> I'm on vaccation the next two week. If you don't want to wait that long, feel free to do all of the changes you suggested by yourself.


Okay. Happy vacation!



---

archive/issue_comments_482631.json:
```json
{
    "body": "Replying to [comment:17 klee]:\n> Replying to [comment:15 soehms]:\n> > I'm on vaccation the next two week. If you don't want to wait that long, feel free to do all of the changes you suggested by yourself.\n\n> \n> Okay. Happy vacation!\n\n\nThanks!",
    "created_at": "2022-08-21T07:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482631",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:17 klee]:
> Replying to [comment:15 soehms]:
> > I'm on vaccation the next two week. If you don't want to wait that long, feel free to do all of the changes you suggested by yourself.

> 
> Okay. Happy vacation!


Thanks!



---

archive/issue_comments_482632.json:
```json
{
    "body": "While fixing things, I could not resist from doing more than I intended. Sorry...\n\nIt seemed that TeXFile doesn't need to be a subclass of JoinFeature.\n\nInstead, TeXFile now simply checks latex presence first. \n\n---\nNew commits:",
    "created_at": "2022-08-21T12:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482632",
    "user": "https://github.com/kwankyu"
}
```

While fixing things, I could not resist from doing more than I intended. Sorry...

It seemed that TeXFile doesn't need to be a subclass of JoinFeature.

Instead, TeXFile now simply checks latex presence first. 

---
New commits:



---

archive/issue_comments_482633.json:
```json
{
    "body": "Changing keywords from \"latex texfile feature join\" to \"latex texfile feature\".",
    "created_at": "2022-08-21T12:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482633",
    "user": "https://github.com/kwankyu"
}
```

Changing keywords from "latex texfile feature join" to "latex texfile feature".



---

archive/issue_comments_482634.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-21T12:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482634",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482635.json:
```json
{
    "body": "Replying to [comment:20 klee]:\n> While fixing things, I could not resist from doing more than I intended. Sorry...\n> \n> It seemed that TeXFile doesn't need to be a subclass of JoinFeature.\n> \n> Instead, TeXFile now simply checks latex presence first. \n\n\nNote that #34185 has a dependency on this ticket and I think this would break things there. More precisely, the method `joined_features` defined in class `Feature` will not work correctly for `TeX` files. So at least you should find another solution for that.",
    "created_at": "2022-08-21T13:14:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482635",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:20 klee]:
> While fixing things, I could not resist from doing more than I intended. Sorry...
> 
> It seemed that TeXFile doesn't need to be a subclass of JoinFeature.
> 
> Instead, TeXFile now simply checks latex presence first. 


Note that #34185 has a dependency on this ticket and I think this would break things there. More precisely, the method `joined_features` defined in class `Feature` will not work correctly for `TeX` files. So at least you should find another solution for that.



---

archive/issue_comments_482636.json:
```json
{
    "body": "Replying to [comment:23 soehms]:\n> Note that #34185 has a dependency on this ticket and I think this would break things there.\n\n\nProbably.\n\n> More precisely, the method `joined_features` defined in class `Feature` will not work correctly for `TeX` files. So at least you should find another solution for that.\n\n\nThe purpose of this ticket as in description (but not as in old title) is to fix a **bug** in TeXFile feature, which did not check latex system in place before it check the presence of a TeX file (such as a latex package). This has nothing to do with #34185. \n\nHence I think that any changes to TeXFile feature related with #34185 should be made in #34185 itself.\n\nMoreover, as far as I understand #34185, the goal of #34185 is not clear to me and I doubt if the goal is reasonable. So the present ticket is better to be independent from #34185.",
    "created_at": "2022-08-22T01:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482636",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:23 soehms]:
> Note that #34185 has a dependency on this ticket and I think this would break things there.


Probably.

> More precisely, the method `joined_features` defined in class `Feature` will not work correctly for `TeX` files. So at least you should find another solution for that.


The purpose of this ticket as in description (but not as in old title) is to fix a **bug** in TeXFile feature, which did not check latex system in place before it check the presence of a TeX file (such as a latex package). This has nothing to do with #34185. 

Hence I think that any changes to TeXFile feature related with #34185 should be made in #34185 itself.

Moreover, as far as I understand #34185, the goal of #34185 is not clear to me and I doubt if the goal is reasonable. So the present ticket is better to be independent from #34185.



---

archive/issue_comments_482637.json:
```json
{
    "body": "By the way, I am positive with this ticket.",
    "created_at": "2022-08-22T01:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482637",
    "user": "https://github.com/kwankyu"
}
```

By the way, I am positive with this ticket.



---

archive/issue_comments_482638.json:
```json
{
    "body": "Replying to [comment:25 klee]:\n> By the way, I am positive with this ticket.\n\nI will not be able to look at your additional changes before I will be back home again.\n\nAt the moment I am still not convinced to remove the inheritance of JoinFeature (independently of #34185), since as fas as I understand this is the conceptual way to indicate dependencies between features.",
    "created_at": "2022-08-24T11:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482638",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:25 klee]:
> By the way, I am positive with this ticket.

I will not be able to look at your additional changes before I will be back home again.

At the moment I am still not convinced to remove the inheritance of JoinFeature (independently of #34185), since as fas as I understand this is the conceptual way to indicate dependencies between features.



---

archive/issue_comments_482639.json:
```json
{
    "body": "Replying to [comment:27 soehms]:\n> Replying to [comment:25 klee]:\n> > By the way, I am positive with this ticket.\n\n> I will not be able to look at your additional changes before I will be back home again.\n\nNo hurry. Enjoy vacation!\n \n> At the moment I am still not convinced to remove the inheritance of JoinFeature (independently of #34185), since as fas as I understand this is the conceptual way to indicate dependencies between features.\n\n\nI think JoinFeature is not relevant for the bug. A joined feature is conceptually a new feature \"A and B\" combining A and B. TeXFile is a feature A that requires feature B. Conceptually it is \"A => B\".",
    "created_at": "2022-08-24T20:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482639",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:27 soehms]:
> Replying to [comment:25 klee]:
> > By the way, I am positive with this ticket.

> I will not be able to look at your additional changes before I will be back home again.

No hurry. Enjoy vacation!
 
> At the moment I am still not convinced to remove the inheritance of JoinFeature (independently of #34185), since as fas as I understand this is the conceptual way to indicate dependencies between features.


I think JoinFeature is not relevant for the bug. A joined feature is conceptually a new feature "A and B" combining A and B. TeXFile is a feature A that requires feature B. Conceptually it is "A => B".



---

archive/issue_comments_482640.json:
```json
{
    "body": "Replying to [comment:28 Kwankyu Lee]:\n> I think JoinFeature is not relevant for the bug. A joined feature is conceptually a new feature \"A and B\" combining A and B. TeXFile is a feature A that requires feature B. Conceptually it is \"A => B\".   \n\n\nIndeed, according to the examples given in the docstring of the class you are right. But it is at least misleading that most examples of joined features consist of just one:\n\n```sage\nsage: from sage.features.all import all_features\nsage: from sage.features.join_feature import JoinFeature\nsage: J = [F for F in all_features() if isinstance(F, JoinFeature)]\nsage: len([F for F in J if len(F._features) == 1])\n16\nsage: len([F for F in J if len(F._features) > 1])\n7\n```\n\nIn these cases the instance of `JoinFeature` usually refers to a `SPKG` (for example `meataxe`) which is combined with a Python module (in the example `meataxe` this is `sage.matrix.matrix_gfpn_dense`) implementing the integration of the new functionality into Sage. Since the Python module requires the `SPKG` the construction describes a dependency here, as well. But I confess that it is reverse on how I used it.\n\nFinally, I agree with your changes, but I observed two little things that I have corrected. If you agree and the patchbot comes green again, you may set to positive review.",
    "created_at": "2022-09-06T07:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482640",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:28 Kwankyu Lee]:
> I think JoinFeature is not relevant for the bug. A joined feature is conceptually a new feature "A and B" combining A and B. TeXFile is a feature A that requires feature B. Conceptually it is "A => B".   


Indeed, according to the examples given in the docstring of the class you are right. But it is at least misleading that most examples of joined features consist of just one:

```sage
sage: from sage.features.all import all_features
sage: from sage.features.join_feature import JoinFeature
sage: J = [F for F in all_features() if isinstance(F, JoinFeature)]
sage: len([F for F in J if len(F._features) == 1])
16
sage: len([F for F in J if len(F._features) > 1])
7
```

In these cases the instance of `JoinFeature` usually refers to a `SPKG` (for example `meataxe`) which is combined with a Python module (in the example `meataxe` this is `sage.matrix.matrix_gfpn_dense`) implementing the integration of the new functionality into Sage. Since the Python module requires the `SPKG` the construction describes a dependency here, as well. But I confess that it is reverse on how I used it.

Finally, I agree with your changes, but I observed two little things that I have corrected. If you agree and the patchbot comes green again, you may set to positive review.



---

archive/issue_comments_482641.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-07T04:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482641",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_482642.json:
```json
{
    "body": "Replying to [comment:30 Sebastian Oehms]:\n> In these cases the instance of `JoinFeature` usually refers to a `SPKG` (for example `meataxe`) which is combined with a Python module (in the example `meataxe` this is `sage.matrix.matrix_gfpn_dense`) implementing the integration of the new functionality into Sage. Since the Python module requires the `SPKG` the construction describes a dependency here, as well. But I confess that it is reverse on how I used it.\n\n\nIt seems `JoinFeature` is also used as unary. In your example, the feature `Meataxe` is a `JoinFeature` of the Python module `sage.matrix.matrix_gfpn_dense` only. Any feature is provided by an `SPKG`. In this example, the presence of the Python module implies the presence of the SPKG meataxe. Hence I think the feature `Meataxe` uses the unary `JoinFeature` to check the presence of the SPKG meataxe.  In general, unary `JoinFeature` seems to be used to check the presence of an SPKG.\n\nIn our case, we don't need the trick since we can check the presence of the latex feature.\n \n> Finally, I agree with your changes, but I observed two little things that I have corrected. If you agree and the patchbot comes green again, you may set to positive review.\n\n\nThanks. I am positive too!",
    "created_at": "2022-09-07T04:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482642",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:30 Sebastian Oehms]:
> In these cases the instance of `JoinFeature` usually refers to a `SPKG` (for example `meataxe`) which is combined with a Python module (in the example `meataxe` this is `sage.matrix.matrix_gfpn_dense`) implementing the integration of the new functionality into Sage. Since the Python module requires the `SPKG` the construction describes a dependency here, as well. But I confess that it is reverse on how I used it.


It seems `JoinFeature` is also used as unary. In your example, the feature `Meataxe` is a `JoinFeature` of the Python module `sage.matrix.matrix_gfpn_dense` only. Any feature is provided by an `SPKG`. In this example, the presence of the Python module implies the presence of the SPKG meataxe. Hence I think the feature `Meataxe` uses the unary `JoinFeature` to check the presence of the SPKG meataxe.  In general, unary `JoinFeature` seems to be used to check the presence of an SPKG.

In our case, we don't need the trick since we can check the presence of the latex feature.
 
> Finally, I agree with your changes, but I observed two little things that I have corrected. If you agree and the patchbot comes green again, you may set to positive review.


Thanks. I am positive too!



---

archive/issue_comments_482643.json:
```json
{
    "body": "Replying to [comment:32 Kwankyu Lee]:\n> Replying to [comment:30 Sebastian Oehms]:\n> It seems `JoinFeature` is also used as unary. In your example, the feature `Meataxe` is a `JoinFeature` of the Python module `sage.matrix.matrix_gfpn_dense` only. Any feature is provided by an `SPKG`. In this example, the presence of the Python module implies the presence of the SPKG meataxe. Hence I think the feature `Meataxe` uses the unary `JoinFeature` to check the presence of the SPKG meataxe.  In general, unary `JoinFeature` seems to be used to check the presence of an SPKG.\n> \n\nExactly! I think `JoinFeature` is missing some documentation to make these things clear. Shall I open a ticket?\n\n\n> Thanks. I am positive too!\n\n\nThanks, as well!",
    "created_at": "2022-09-07T17:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482643",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:32 Kwankyu Lee]:
> Replying to [comment:30 Sebastian Oehms]:
> It seems `JoinFeature` is also used as unary. In your example, the feature `Meataxe` is a `JoinFeature` of the Python module `sage.matrix.matrix_gfpn_dense` only. Any feature is provided by an `SPKG`. In this example, the presence of the Python module implies the presence of the SPKG meataxe. Hence I think the feature `Meataxe` uses the unary `JoinFeature` to check the presence of the SPKG meataxe.  In general, unary `JoinFeature` seems to be used to check the presence of an SPKG.
> 

Exactly! I think `JoinFeature` is missing some documentation to make these things clear. Shall I open a ticket?


> Thanks. I am positive too!


Thanks, as well!



---

archive/issue_comments_482644.json:
```json
{
    "body": "Replying to [comment:32 Kwankyu Lee]:\n> It seems `JoinFeature` is also used as unary. In your example, the feature `Meataxe` is a `JoinFeature` of the Python module `sage.matrix.matrix_gfpn_dense` only. Any feature is provided by an `SPKG`. In this example, the presence of the Python module implies the presence of the SPKG meataxe. Hence I think the feature `Meataxe` uses the unary `JoinFeature` to check the presence of the SPKG meataxe.  In general, unary `JoinFeature` seems to be used to check the presence of an SPKG.\n\n\nThe name of a feature gives the `# optional` tag. I have used unary `JoinFeature`s to equip features such as `PythonModule` features with a tag name that differs from the systematic tag name.",
    "created_at": "2022-09-07T19:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482644",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:32 Kwankyu Lee]:
> It seems `JoinFeature` is also used as unary. In your example, the feature `Meataxe` is a `JoinFeature` of the Python module `sage.matrix.matrix_gfpn_dense` only. Any feature is provided by an `SPKG`. In this example, the presence of the Python module implies the presence of the SPKG meataxe. Hence I think the feature `Meataxe` uses the unary `JoinFeature` to check the presence of the SPKG meataxe.  In general, unary `JoinFeature` seems to be used to check the presence of an SPKG.


The name of a feature gives the `# optional` tag. I have used unary `JoinFeature`s to equip features such as `PythonModule` features with a tag name that differs from the systematic tag name.



---

archive/issue_comments_482645.json:
```json
{
    "body": "Replying to [comment:33 Sebastian Oehms]:\n> I think `JoinFeature` is missing some documentation to make these things clear. Shall I open a ticket?\n\n\nThat would be nice. Matthias explains clearly how unary `JoinFeature` can be used.",
    "created_at": "2022-09-07T22:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482645",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:33 Sebastian Oehms]:
> I think `JoinFeature` is missing some documentation to make these things clear. Shall I open a ticket?


That would be nice. Matthias explains clearly how unary `JoinFeature` can be used.



---

archive/issue_comments_482646.json:
```json
{
    "body": "Replying to [comment:35 Kwankyu Lee]:\n> Replying to [comment:33 Sebastian Oehms]:\n> > I think `JoinFeature` is missing some documentation to make these things clear. Shall I open a ticket?\n\n> \n> That would be nice. Matthias explains clearly how unary `JoinFeature` can be used.\n\n\nThis is now #34508!",
    "created_at": "2022-09-08T19:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482646",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:35 Kwankyu Lee]:
> Replying to [comment:33 Sebastian Oehms]:
> > I think `JoinFeature` is missing some documentation to make these things clear. Shall I open a ticket?

> 
> That would be nice. Matthias explains clearly how unary `JoinFeature` can be used.


This is now #34508!



---

archive/issue_events_089329.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34045#event-89329"
}
```



---

archive/issue_events_089330.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-22T22:35:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34045#event-89330"
}
```



---

archive/issue_comments_482647.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-22T22:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34045#issuecomment-482647",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
