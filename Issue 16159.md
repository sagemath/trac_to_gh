# Issue 16159: upgrade Sphinx to 1.2

archive/issues_016159.json:
```json
{
    "body": "CC:  @strogdon snark\n\nKeywords: speed, slow, build, rst\n\nAccording to https://groups.google.com/forum/#!topic/sphinx-users/EC7_wNtE5To Sphinx-1.2 is 25% faster than 1.1.2, and this matters with doc-clean Sage builds.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16396\n\n",
    "created_at": "2014-05-25T15:21:26Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "upgrade Sphinx to 1.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16159",
    "user": "https://github.com/rwst"
}
```
CC:  @strogdon snark

Keywords: speed, slow, build, rst

According to https://groups.google.com/forum/#!topic/sphinx-users/EC7_wNtE5To Sphinx-1.2 is 25% faster than 1.1.2, and this matters with doc-clean Sage builds.

Issue created by migration from https://trac.sagemath.org/ticket/16396





---

archive/issue_comments_210685.json:
```json
{
    "body": "The sage-on-gentoo experience with this is that we need to clean up a number of things before upgrading. It of course can be done at the same time.",
    "created_at": "2014-05-27T22:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210685",
    "user": "https://github.com/kiwifb"
}
```

The sage-on-gentoo experience with this is that we need to clean up a number of things before upgrading. It of course can be done at the same time.



---

archive/issue_comments_210686.json:
```json
{
    "body": "New commits:\n|                                                                                                                                          |                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[cd12a2b](http://git.sagemath.org/sage.git/commit/?id=cd12a2bfbea0cb98f48d69b009e7d3c8ccdae885)|`16396: sphinx-1.2.2 install: fix grammar script; bump version`|\n---\nLots of `SEEALSO` problems apparently.",
    "created_at": "2014-05-28T07:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210686",
    "user": "https://github.com/rwst"
}
```

New commits:
|                                                                                                                                          |                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[cd12a2b](http://git.sagemath.org/sage.git/commit/?id=cd12a2bfbea0cb98f48d69b009e7d3c8ccdae885)|`16396: sphinx-1.2.2 install: fix grammar script; bump version`|
---
Lots of `SEEALSO` problems apparently.



---

archive/issue_comments_210687.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-28T08:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210687",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210688.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2014-05-28T08:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210688",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_210689.json:
```json
{
    "body": "Further, I get a crash which is reported at https://bitbucket.org/birkenfeld/sphinx/issue/1475/typeerror-in-get_js_index",
    "created_at": "2014-05-28T08:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210689",
    "user": "https://github.com/rwst"
}
```

Further, I get a crash which is reported at https://bitbucket.org/birkenfeld/sphinx/issue/1475/typeerror-in-get_js_index



---

archive/issue_comments_210690.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2014-05-28T09:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210690",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_210691.json:
```json
{
    "body": "Upstream says:\n\n```\nSphinx-1.2 has changed the signature of sphinx.search.IndexBuilder class (e5bd5a84b5fd) and Sage extension has used the IndexBuilder directly without a appended argument.\n\nI think you can build the document with Sphinx-1.1.3. Alternatively, please contact to sage documentation maintainer.\n```",
    "created_at": "2014-05-28T09:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210691",
    "user": "https://github.com/rwst"
}
```

Upstream says:

```
Sphinx-1.2 has changed the signature of sphinx.search.IndexBuilder class (e5bd5a84b5fd) and Sage extension has used the IndexBuilder directly without a appended argument.

I think you can build the document with Sphinx-1.1.3. Alternatively, please contact to sage documentation maintainer.
```



---

archive/issue_comments_210692.json:
```json
{
    "body": "I will have a look. I have a number of patches for sphinx 1.2 in sage-on-gentoo. We have success at building the html doc with sphinx 1.2. However there is a mystery on whether or not we can build the pdf documentation at the moment.",
    "created_at": "2014-05-28T10:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210692",
    "user": "https://github.com/kiwifb"
}
```

I will have a look. I have a number of patches for sphinx 1.2 in sage-on-gentoo. We have success at building the html doc with sphinx 1.2. However there is a mystery on whether or not we can build the pdf documentation at the moment.



---

archive/issue_comments_210693.json:
```json
{
    "body": "OK, you did the right thing for SEEALSO what you are missing can be found here [https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage-doc/files/sage-doc-6.2-sphinx.patch](https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage-doc/files/sage-doc-6.2-sphinx.patch) that should solve the crash you reported. Not that because you are not sage-on-gentoo you do not have to bother with testing the sphinx version. However we would appreciate if you did.",
    "created_at": "2014-05-28T10:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210693",
    "user": "https://github.com/kiwifb"
}
```

OK, you did the right thing for SEEALSO what you are missing can be found here [https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage-doc/files/sage-doc-6.2-sphinx.patch](https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage-doc/files/sage-doc-6.2-sphinx.patch) that should solve the crash you reported. Not that because you are not sage-on-gentoo you do not have to bother with testing the sphinx version. However we would appreciate if you did.



---

archive/issue_comments_210694.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-28T15:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210695.json:
```json
{
    "body": "I did a `sage -tp --long src/doc/` if you meant that. Except for pdf it's ready for review now. Not sure if we should wait for it.",
    "created_at": "2014-05-28T16:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210695",
    "user": "https://github.com/rwst"
}
```

I did a `sage -tp --long src/doc/` if you meant that. Except for pdf it's ready for review now. Not sure if we should wait for it.



---

archive/issue_comments_210696.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-28T16:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210696",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_210697.json:
```json
{
    "body": "Can you provide a link to the new tarball?",
    "created_at": "2014-05-28T16:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210697",
    "user": "https://github.com/jhpalmieri"
}
```

Can you provide a link to the new tarball?



---

archive/issue_comments_210698.json:
```json
{
    "body": "In sage-on-gentoo pdf generation is officially broken with sphinx 1.2.2. Some math is generated in pure tex rather than latex (\"\\(...\\)\" rather than \"$...$\") and it breaks the pdf engine. We are investigating at this stage.",
    "created_at": "2014-05-28T23:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210698",
    "user": "https://github.com/kiwifb"
}
```

In sage-on-gentoo pdf generation is officially broken with sphinx 1.2.2. Some math is generated in pure tex rather than latex ("\(...\)" rather than "$...$") and it breaks the pdf engine. We are investigating at this stage.



---

archive/issue_comments_210699.json:
```json
{
    "body": "If the pdf issue is an upstream issue, is there a ticket? Can you please add it to this ticket description and set the resp. field? Any other links with information?\n\nTarball link is added.",
    "created_at": "2014-05-29T07:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210699",
    "user": "https://github.com/rwst"
}
```

If the pdf issue is an upstream issue, is there a ticket? Can you please add it to this ticket description and set the resp. field? Any other links with information?

Tarball link is added.



---

archive/issue_comments_210700.json:
```json
{
    "body": "I should say that I manually untarred, renamed the `Sphinx` directory to `sphinx` and re`bzip`ped. There must be a better way of doing this, as there is no difference in names to  the previous version.",
    "created_at": "2014-05-29T07:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210700",
    "user": "https://github.com/rwst"
}
```

I should say that I manually untarred, renamed the `Sphinx` directory to `sphinx` and re`bzip`ped. There must be a better way of doing this, as there is no difference in names to  the previous version.



---

archive/issue_comments_210701.json:
```json
{
    "body": "Replying to [comment:13 rws]:\n> If the pdf issue is an upstream issue, is there a ticket? Can you please add it to this ticket description and set the resp. field? Any other links with information?\n> \n> Tarball link is added.\n\n\nWe don't know yet if it is an upstream issue or something that sage's doc need to be adapted to. sage-on-gentoo is technically downstream from you not upstream.",
    "created_at": "2014-05-29T07:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210701",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:13 rws]:
> If the pdf issue is an upstream issue, is there a ticket? Can you please add it to this ticket description and set the resp. field? Any other links with information?
> 
> Tarball link is added.


We don't know yet if it is an upstream issue or something that sage's doc need to be adapted to. sage-on-gentoo is technically downstream from you not upstream.



---

archive/issue_comments_210702.json:
```json
{
    "body": "For what it's worth, I did several iterations of `make doc-clean` followed by `make`. Docbuilding did not speed up with the new version of Sphinx:\n\n- old version: 219.8 seconds, 217.3 seconds, 224.7 seconds\n- new version: 227.5 seconds, 218.3 seconds, 219.5 seconds\n\n(This was with 4 threads.) Given the problems with PDF building, maybe there isn't much hurry with this? Or are other people seeing a speed improvement with the new version?",
    "created_at": "2014-05-29T19:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210702",
    "user": "https://github.com/jhpalmieri"
}
```

For what it's worth, I did several iterations of `make doc-clean` followed by `make`. Docbuilding did not speed up with the new version of Sphinx:

- old version: 219.8 seconds, 217.3 seconds, 224.7 seconds
- new version: 227.5 seconds, 218.3 seconds, 219.5 seconds

(This was with 4 threads.) Given the problems with PDF building, maybe there isn't much hurry with this? Or are other people seeing a speed improvement with the new version?



---

archive/issue_comments_210703.json:
```json
{
    "body": "OK Steve has found the commit of sphinx that break things for pdflatex and I have left a comment of the corresponding issue [https://bitbucket.org/birkenfeld/sphinx/issue/929/parsed-literal-creates-bad-latex-math](https://bitbucket.org/birkenfeld/sphinx/issue/929/parsed-literal-creates-bad-latex-math).\nIf they don't pick up the comment in a couple of day I'll open an issue proper with them.",
    "created_at": "2014-05-29T21:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210703",
    "user": "https://github.com/kiwifb"
}
```

OK Steve has found the commit of sphinx that break things for pdflatex and I have left a comment of the corresponding issue [https://bitbucket.org/birkenfeld/sphinx/issue/929/parsed-literal-creates-bad-latex-math](https://bitbucket.org/birkenfeld/sphinx/issue/929/parsed-literal-creates-bad-latex-math).
If they don't pick up the comment in a couple of day I'll open an issue proper with them.



---

archive/issue_comments_210704.json:
```json
{
    "body": "Replying to [comment:16 jhpalmieri]:\n> For what it's worth, I did several iterations of `make doc-clean` followed by `make`. Docbuilding did not speed up with the new version of Sphinx:\n> \n> - old version: 219.8 seconds, 217.3 seconds, 224.7 seconds\n> - new version: 227.5 seconds, 218.3 seconds, 219.5 seconds\n> \n> (This was with 4 threads.) Given the problems with PDF building, maybe there isn't much hurry with this? Or are other people seeing a speed improvement with the new version?\n\nNo, it confirms my impression. There is no hurry. I thought it might somehow fix the docbuild issue discussed in sage-releases but I cannot reproduce that at the moment, so I cannot even look if Sphinx-1.2 makes a difference there.",
    "created_at": "2014-05-30T05:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210704",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:16 jhpalmieri]:
> For what it's worth, I did several iterations of `make doc-clean` followed by `make`. Docbuilding did not speed up with the new version of Sphinx:
> 
> - old version: 219.8 seconds, 217.3 seconds, 224.7 seconds
> - new version: 227.5 seconds, 218.3 seconds, 219.5 seconds
> 
> (This was with 4 threads.) Given the problems with PDF building, maybe there isn't much hurry with this? Or are other people seeing a speed improvement with the new version?

No, it confirms my impression. There is no hurry. I thought it might somehow fix the docbuild issue discussed in sage-releases but I cannot reproduce that at the moment, so I cannot even look if Sphinx-1.2 makes a difference there.



---

archive/issue_comments_210705.json:
```json
{
    "body": "Given the lack of answer to my first comment on the commit that breaks pdf generation I opened a brand new issue for the problem: [https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline](https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline)",
    "created_at": "2014-06-04T02:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210705",
    "user": "https://github.com/kiwifb"
}
```

Given the lack of answer to my first comment on the commit that breaks pdf generation I opened a brand new issue for the problem: [https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline](https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline)



---

archive/issue_comments_210706.json:
```json
{
    "body": "Upstream is quite unresponsive. If anyone has a direct line they can try that. I think it is time to patch on our side.",
    "created_at": "2014-06-10T21:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210706",
    "user": "https://github.com/kiwifb"
}
```

Upstream is quite unresponsive. If anyone has a direct line they can try that. I think it is time to patch on our side.



---

archive/issue_comments_210707.json:
```json
{
    "body": "I believe I have a patch that's not to invasive, i.e. it basically reverts to the old behavior when using inline math and doesn't disrupt (hopefully) the need to use pure tex in a verbatim (alltt) environment. I'll post here since it will take me time to remember how to commit\n\n```\n--- sphinx/writers/latex.py.orig        2014-06-05 23:38:03.808669401 -0500\n+++ sphinx/writers/latex.py     2014-06-05 23:27:22.752376713 -0500\n@@ -264,6 +264,7 @@\n         self.next_figure_ids = set()\n         self.next_table_ids = set()\n         # flags\n+        self.verbatim = False\n         self.in_title = 0\n         self.in_production_list = 0\n         self.in_footnote = 0\n@@ -1319,6 +1320,7 @@\n                                    (self.curfilestack[-1], node.line))\n         if node.rawsource != node.astext():\n             # most probably a parsed-literal block -- don't highlight\n+            self.verbatim = True\n             self.body.append('\\\\begin{alltt}\\n')\n         else:\n             code = node.astext().rstrip('\\n')\n@@ -1351,6 +1353,7 @@\n             raise nodes.SkipNode\n     def depart_literal_block(self, node):\n         self.body.append('\\n\\\\end{alltt}\\n')\n+        self.verbatim = False\n     visit_doctest_block = visit_literal_block\n     depart_doctest_block = depart_literal_block\n \n--- sphinx/ext/mathbase.py.orig 2014-06-05 23:39:36.773293241 -0500\n+++ sphinx/ext/mathbase.py      2014-06-05 23:18:53.949020605 -0500\n@@ -88,7 +88,10 @@\n \n \n def latex_visit_math(self, node):\n-    self.body.append('\\\\(' + node['latex'] + '\\\\)')\n+    if self.verbatim:\n+        self.body.append('\\\\(' + node['latex'] + '\\\\)')\n+    else:\n+        self.body.append('$' + node['latex'] + '$')\n     raise nodes.SkipNode\n \n def latex_visit_displaymath(self, node):\n```",
    "created_at": "2014-06-10T22:36:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210707",
    "user": "https://github.com/strogdon"
}
```

I believe I have a patch that's not to invasive, i.e. it basically reverts to the old behavior when using inline math and doesn't disrupt (hopefully) the need to use pure tex in a verbatim (alltt) environment. I'll post here since it will take me time to remember how to commit

```
--- sphinx/writers/latex.py.orig        2014-06-05 23:38:03.808669401 -0500
+++ sphinx/writers/latex.py     2014-06-05 23:27:22.752376713 -0500
@@ -264,6 +264,7 @@
         self.next_figure_ids = set()
         self.next_table_ids = set()
         # flags
+        self.verbatim = False
         self.in_title = 0
         self.in_production_list = 0
         self.in_footnote = 0
@@ -1319,6 +1320,7 @@
                                    (self.curfilestack[-1], node.line))
         if node.rawsource != node.astext():
             # most probably a parsed-literal block -- don't highlight
+            self.verbatim = True
             self.body.append('\\begin{alltt}\n')
         else:
             code = node.astext().rstrip('\n')
@@ -1351,6 +1353,7 @@
             raise nodes.SkipNode
     def depart_literal_block(self, node):
         self.body.append('\n\\end{alltt}\n')
+        self.verbatim = False
     visit_doctest_block = visit_literal_block
     depart_doctest_block = depart_literal_block
 
--- sphinx/ext/mathbase.py.orig 2014-06-05 23:39:36.773293241 -0500
+++ sphinx/ext/mathbase.py      2014-06-05 23:18:53.949020605 -0500
@@ -88,7 +88,10 @@
 
 
 def latex_visit_math(self, node):
-    self.body.append('\\(' + node['latex'] + '\\)')
+    if self.verbatim:
+        self.body.append('\\(' + node['latex'] + '\\)')
+    else:
+        self.body.append('$' + node['latex'] + '$')
     raise nodes.SkipNode
 
 def latex_visit_displaymath(self, node):
```



---

archive/issue_comments_210708.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-28T13:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210709.json:
```json
{
    "body": "Replying to [comment:22 strogdon]:\n> I believe I have a patch that's not to invasive, i.e. it basically reverts to the old behavior when using inline math and doesn't disrupt (hopefully) the need to use pure tex in a verbatim (alltt) environment. I'll post here since it will take me time to remember how to commit\n\nThanks, I have added your patch with you as author.",
    "created_at": "2014-07-28T13:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210709",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:22 strogdon]:
> I believe I have a patch that's not to invasive, i.e. it basically reverts to the old behavior when using inline math and doesn't disrupt (hopefully) the need to use pure tex in a verbatim (alltt) environment. I'll post here since it will take me time to remember how to commit

Thanks, I have added your patch with you as author.



---

archive/issue_events_048256.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16159#event-48256"
}
```



---

archive/issue_comments_210710.json:
```json
{
    "body": "Anything left to do with this ticket?",
    "created_at": "2014-08-11T22:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210710",
    "user": "https://github.com/kiwifb"
}
```

Anything left to do with this ticket?



---

archive/issue_comments_210711.json:
```json
{
    "body": "I wanted to give it a try, but it failed to download the tarball from sagemath.org ; when I took the tarball from the link in the ticket description the sums didn't match.",
    "created_at": "2014-08-22T17:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210711",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

I wanted to give it a try, but it failed to download the tarball from sagemath.org ; when I took the tarball from the link in the ticket description the sums didn't match.



---

archive/issue_comments_210712.json:
```json
{
    "body": "There are several wrong things. checksums.ini looks for \n\n```\ntarball=sphinx-VERSION.tar.bz2\n```\nthe linked tarball is Sphinx-1.2.2.tar.gz so of course the checksum won't match. We need to recommit that with \n\n```\ntarball=Sphinx-VERSION.tar.gz\n```\nand new checksum to be sure. Once checksum.ini is corrected for the right filename run\n\n```\n./sage -sh sage-fix-pkg-checksums\n```\nAs detailed in [http://sagemath.org/doc/developer/packaging.html#checksums](http://sagemath.org/doc/developer/packaging.html#checksums).",
    "created_at": "2014-08-24T02:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210712",
    "user": "https://github.com/kiwifb"
}
```

There are several wrong things. checksums.ini looks for 

```
tarball=sphinx-VERSION.tar.bz2
```
the linked tarball is Sphinx-1.2.2.tar.gz so of course the checksum won't match. We need to recommit that with 

```
tarball=Sphinx-VERSION.tar.gz
```
and new checksum to be sure. Once checksum.ini is corrected for the right filename run

```
./sage -sh sage-fix-pkg-checksums
```
As detailed in [http://sagemath.org/doc/developer/packaging.html#checksums](http://sagemath.org/doc/developer/packaging.html#checksums).



---

archive/issue_comments_210713.json:
```json
{
    "body": "Changing the filename doesn't modify the checksum as far as I know, so I just renamed the tarball. The fact that it was wrong was enough to see the ticket wasn't ready for review.",
    "created_at": "2014-08-24T06:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210713",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Changing the filename doesn't modify the checksum as far as I know, so I just renamed the tarball. The fact that it was wrong was enough to see the ticket wasn't ready for review.



---

archive/issue_comments_210714.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-24T07:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210714",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_210715.json:
```json
{
    "body": "Replying to [comment:30 Snark]:\n> Changing the filename doesn't modify the checksum as far as I know, so I just renamed the tarball. The fact that it was wrong was enough to see the ticket wasn't ready for review.\n\n\nIt is indeed not ready to review. Switching to French Julien. \n\nIl est vrai que changer le nom de fichier ne suffit pas. Mon commentaire a deux instructions:\n* changer le nom\n* executer le script \"./sage -sh sage-fix-pkg-checksums\" qui va recalculer les checksums d'apres les fichiers que tu as deja telecharge.\n\nRenommer un tar.gz en tar.bz2 n'est pas une bonne idee, decompresser et recompresser ne donneras pas la meme checksum, si la version de bzip2 n'est pas completement identique le bzip2 serat legerement different.",
    "created_at": "2014-08-24T07:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210715",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:30 Snark]:
> Changing the filename doesn't modify the checksum as far as I know, so I just renamed the tarball. The fact that it was wrong was enough to see the ticket wasn't ready for review.


It is indeed not ready to review. Switching to French Julien. 

Il est vrai que changer le nom de fichier ne suffit pas. Mon commentaire a deux instructions:
* changer le nom
* executer le script "./sage -sh sage-fix-pkg-checksums" qui va recalculer les checksums d'apres les fichiers que tu as deja telecharge.

Renommer un tar.gz en tar.bz2 n'est pas une bonne idee, decompresser et recompresser ne donneras pas la meme checksum, si la version de bzip2 n'est pas completement identique le bzip2 serat legerement different.



---

archive/issue_comments_210716.json:
```json
{
    "body": "Ooooooooh, I hadn't noticed the original was a .gz and not a .bz2! Indeed, no wonder that didn't work... I had only seen the Sphinx vs sphinx.\n\nI'll probably give it a try later today, to see exactly how much work is involved in fixing that ticket. I'm quite interested in getting docutils upgraded, and this is a prerequisite!",
    "created_at": "2014-08-24T07:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210716",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Ooooooooh, I hadn't noticed the original was a .gz and not a .bz2! Indeed, no wonder that didn't work... I had only seen the Sphinx vs sphinx.

I'll probably give it a try later today, to see exactly how much work is involved in fixing that ticket. I'm quite interested in getting docutils upgraded, and this is a prerequisite!



---

archive/issue_comments_210717.json:
```json
{
    "body": "Ok, doing things less stupidly does make things better (who would have thought?! ;-P ) : it builds and there are three failing doctests, which are trivial to fix: those doctests expect a newline before a div, and there are none now:\n\n```\nsage -t --long local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 69, in sagenb.misc.sphinxify.sphinxify\nFailed example:\n    sphinxify('A test')\nExpected:\n    '\\n<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\nGot:\n    '<div class=\"docstring\">\\n    \\n  <p>A test</p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 71, in sagenb.misc.sphinxify.sphinxify\nFailed example:\n    sphinxify('**Testing**\\n`monospace`')\nExpected:\n    '\\n<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div>'\nGot:\n    '<div class=\"docstring\">\\n    \\n  <p><strong>Testing</strong>\\n<span class=\"math\">monospace</span></p>\\n\\n\\n</div>'\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py\", line 73, in sagenb.misc.sphinxify.sphinxify\nFailed example:\n    sphinxify('`x=y`')\nExpected:\n    '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\nGot:\n    '<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n**********************************************************************\n1 item had failures:\n   3 of  10 in sagenb.misc.sphinxify.sphinxify\n    [14 tests, 3 failures, 0.44 s]\n```\n\nI also had a look at the branch to see how the patches looked like : there is a strange chunk on src/doc/common/multidocs.py with a test on whether the sphinx version is less or above 1.2... which makes no sense if we're upgrading to 1.2.2!\n\nSo I would say : rebase the branch, fix the tarball issues (name, checksum), remove the chunk mentioned above, fix the doctests and it will be good to review and close!\n\nPS: in fact, I may give git-trac a try and push a patch fixing the doctests this evening... if I manage to.",
    "created_at": "2014-08-24T18:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210717",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Ok, doing things less stupidly does make things better (who would have thought?! ;-P ) : it builds and there are three failing doctests, which are trivial to fix: those doctests expect a newline before a div, and there are none now:

```
sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py", line 69, in sagenb.misc.sphinxify.sphinxify
Failed example:
    sphinxify('A test')
Expected:
    '\n<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
Got:
    '<div class="docstring">\n    \n  <p>A test</p>\n\n\n</div>'
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py", line 71, in sagenb.misc.sphinxify.sphinxify
Failed example:
    sphinxify('**Testing**\n`monospace`')
Expected:
    '\n<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div>'
Got:
    '<div class="docstring">\n    \n  <p><strong>Testing</strong>\n<span class="math">monospace</span></p>\n\n\n</div>'
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/misc/sphinxify.py", line 73, in sagenb.misc.sphinxify.sphinxify
Failed example:
    sphinxify('`x=y`')
Expected:
    '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
Got:
    '<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
**********************************************************************
1 item had failures:
   3 of  10 in sagenb.misc.sphinxify.sphinxify
    [14 tests, 3 failures, 0.44 s]
```

I also had a look at the branch to see how the patches looked like : there is a strange chunk on src/doc/common/multidocs.py with a test on whether the sphinx version is less or above 1.2... which makes no sense if we're upgrading to 1.2.2!

So I would say : rebase the branch, fix the tarball issues (name, checksum), remove the chunk mentioned above, fix the doctests and it will be good to review and close!

PS: in fact, I may give git-trac a try and push a patch fixing the doctests this evening... if I manage to.



---

archive/issue_comments_210718.json:
```json
{
    "body": "Hmmmmmm... it's in sagenb... how does one proceed in such a case? Ask sagenb to make a new release with patched doctests, then push a ticket to upgrade to that, making this one depend on that new ticket, etc?",
    "created_at": "2014-08-24T18:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210718",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Hmmmmmm... it's in sagenb... how does one proceed in such a case? Ask sagenb to make a new release with patched doctests, then push a ticket to upgrade to that, making this one depend on that new ticket, etc?



---

archive/issue_comments_210719.json:
```json
{
    "body": "Replying to [comment:33 Snark]:\n> Ok, doing things less stupidly does make things better (who would have thought?! ;-P ) > I also had a look at the branch to see how the patches looked like : there is a strange chunk on src/doc/common/multidocs.py with a test on whether the sphinx version is less or above 1.2... which makes no sense if we're upgrading to 1.2.2!\n\n\nSee http://trac.sagemath.org/ticket/16396#comment:8 but like I said we are not strongly attached to it.\n\nFor sagenb you can open a ticket on their github [https://github.com/sagemath/sagenb](https://github.com/sagemath/sagenb) and yes we'll need a new release.",
    "created_at": "2014-08-25T22:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210719",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:33 Snark]:
> Ok, doing things less stupidly does make things better (who would have thought?! ;-P ) > I also had a look at the branch to see how the patches looked like : there is a strange chunk on src/doc/common/multidocs.py with a test on whether the sphinx version is less or above 1.2... which makes no sense if we're upgrading to 1.2.2!


See http://trac.sagemath.org/ticket/16396#comment:8 but like I said we are not strongly attached to it.

For sagenb you can open a ticket on their github [https://github.com/sagemath/sagenb](https://github.com/sagemath/sagenb) and yes we'll need a new release.



---

archive/issue_comments_210720.json:
```json
{
    "body": "Do you want to open an issue for sagenb and make a pull request or would you prefer I do it Julien?",
    "created_at": "2014-08-29T10:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210720",
    "user": "https://github.com/kiwifb"
}
```

Do you want to open an issue for sagenb and make a pull request or would you prefer I do it Julien?



---

archive/issue_comments_210721.json:
```json
{
    "body": "First eclib and its detection of NTL, now sagenb and its sphinx doctests... you're late to the [party](https://github.com/sagemath/sagenb/pull/215) again! ;-P",
    "created_at": "2014-08-29T18:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210721",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

First eclib and its detection of NTL, now sagenb and its sphinx doctests... you're late to the [party](https://github.com/sagemath/sagenb/pull/215) again! ;-P



---

archive/issue_comments_210722.json:
```json
{
    "body": "Replying to [comment:37 Snark]:\n> First eclib and its detection of NTL, now sagenb and its sphinx doctests... you're late to the [party](https://github.com/sagemath/sagenb/pull/215) again! ;-P\n\n\nYes you work while I sleep. I cannot really complain about that ;)",
    "created_at": "2014-08-30T10:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210722",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:37 Snark]:
> First eclib and its detection of NTL, now sagenb and its sphinx doctests... you're late to the [party](https://github.com/sagemath/sagenb/pull/215) again! ;-P


Yes you work while I sleep. I cannot really complain about that ;)



---

archive/issue_comments_210723.json:
```json
{
    "body": "Something is wrong with your patches. First, `checksums.ini` contains the patch:\n\n```diff\ndiff --git a/build/pkgs/sphinx/checksums.ini b/build/pkgs/sphinx/checksums.ini\nindex a9fda75..5befdc5 100644\n--- a/build/pkgs/sphinx/checksums.ini\n+++ b/build/pkgs/sphinx/checksums.ini\n@@ -1,4 +1,4 @@\n tarball=sphinx-VERSION.tar.bz2\n-sha1=2a6f238185a58cbb5c597c985d715ab9653e0fbe\n-md5=9ea0a6f218779ddbe3222c5ef8c0f6e6\n-cksum=1040528499\n+sha1=deb2a9308d50a508ed9c26b02373a3965c2a5500\n+md5=a81ab4ca80eec8fa1cc72cb5858f7f5a\n+cksum=2539330004\n```\nwhich neither matches the filename of the actual download, the extension, nor the md5sum of the download when converted to the correct extension using\n\n```\ngunzip -c Sphinx-1.2.2.tar.gz | bzip2 > sphinx-1.2.2.tar.bz2\n```",
    "created_at": "2014-09-07T12:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210723",
    "user": "https://github.com/ppurka"
}
```

Something is wrong with your patches. First, `checksums.ini` contains the patch:

```diff
diff --git a/build/pkgs/sphinx/checksums.ini b/build/pkgs/sphinx/checksums.ini
index a9fda75..5befdc5 100644
--- a/build/pkgs/sphinx/checksums.ini
+++ b/build/pkgs/sphinx/checksums.ini
@@ -1,4 +1,4 @@
 tarball=sphinx-VERSION.tar.bz2
-sha1=2a6f238185a58cbb5c597c985d715ab9653e0fbe
-md5=9ea0a6f218779ddbe3222c5ef8c0f6e6
-cksum=1040528499
+sha1=deb2a9308d50a508ed9c26b02373a3965c2a5500
+md5=a81ab4ca80eec8fa1cc72cb5858f7f5a
+cksum=2539330004
```
which neither matches the filename of the actual download, the extension, nor the md5sum of the download when converted to the correct extension using

```
gunzip -c Sphinx-1.2.2.tar.gz | bzip2 > sphinx-1.2.2.tar.bz2
```



---

archive/issue_comments_210724.json:
```json
{
    "body": "I checked that when the sagenb upgrade #16911 will be done, this ticket will go well.",
    "created_at": "2014-09-08T14:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210724",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

I checked that when the sagenb upgrade #16911 will be done, this ticket will go well.



---

archive/issue_comments_210725.json:
```json
{
    "body": "What's the status?",
    "created_at": "2014-10-09T07:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210725",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

What's the status?



---

archive/issue_comments_210726.json:
```json
{
    "body": "Are we getting a new sagenb in that can take this and a new docutils?",
    "created_at": "2014-10-09T08:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210726",
    "user": "https://github.com/kiwifb"
}
```

Are we getting a new sagenb in that can take this and a new docutils?



---

archive/issue_comments_210727.json:
```json
{
    "body": "From what I know, we need a new sagenb(#16911) so we can get a new sphinx(here) so we can get a new docutils(#16733) (in that order). And Volker has added a reverse dep from the new sphinx to the new sagenb to the mix, see #16911.",
    "created_at": "2014-10-09T08:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210727",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

From what I know, we need a new sagenb(#16911) so we can get a new sphinx(here) so we can get a new docutils(#16733) (in that order). And Volker has added a reverse dep from the new sphinx to the new sagenb to the mix, see #16911.



---

archive/issue_comments_210728.json:
```json
{
    "body": "OK so #16911 is positively reviewed, it looks like we need to check everything here, ppurka said the checksum is wrong so it has to be checked and given a last test. After we put on a positive review and hope that it get in the next beta/rc. Can you do the work on the checksum I have a couple of other issues I am dealing with.",
    "created_at": "2014-10-09T08:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210728",
    "user": "https://github.com/kiwifb"
}
```

OK so #16911 is positively reviewed, it looks like we need to check everything here, ppurka said the checksum is wrong so it has to be checked and given a last test. After we put on a positive review and hope that it get in the next beta/rc. Can you do the work on the checksum I have a couple of other issues I am dealing with.



---

archive/issue_comments_210729.json:
```json
{
    "body": "Ok, I started from ppurka's update_sagenb branch, merged the t/16396/upgrade_sphinx_to_1_2 branch, got the upstream tarball and fixed the checksums as in the ticket description, reinstalled sagenb, reinstalled sphinx, rebuilt sage, then \"make ptestlong\".\n\nAll tests passed.",
    "created_at": "2014-10-15T07:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210729",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Ok, I started from ppurka's update_sagenb branch, merged the t/16396/upgrade_sphinx_to_1_2 branch, got the upstream tarball and fixed the checksums as in the ticket description, reinstalled sagenb, reinstalled sphinx, rebuilt sage, then "make ptestlong".

All tests passed.



---

archive/issue_comments_210730.json:
```json
{
    "body": "You also need to submit the updated checksums to the ticket. Then,  you can set this to needs review so that `@`fbissey can confirm the changes.",
    "created_at": "2014-10-15T10:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210730",
    "user": "https://github.com/ppurka"
}
```

You also need to submit the updated checksums to the ticket. Then,  you can set this to needs review so that `@`fbissey can confirm the changes.



---

archive/issue_comments_210731.json:
```json
{
    "body": "I'm actually reviewing the ticket...",
    "created_at": "2014-10-15T12:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210731",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

I'm actually reviewing the ticket...



---

archive/issue_comments_210732.json:
```json
{
    "body": "If there isn't too much left to do here other than this checksum/tarball issue, it would be wonderful to get this and #16911 in the next beta.",
    "created_at": "2014-10-17T14:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210732",
    "user": "https://github.com/kcrisman"
}
```

If there isn't too much left to do here other than this checksum/tarball issue, it would be wonderful to get this and #16911 in the next beta.



---

archive/issue_comments_210733.json:
```json
{
    "body": "I am working on updating the branch (package name, checksums and patch refresh to eliminate fuzz). I'll also update the description once I am finished. It will then be up to Julien to push the button.\nI am not doing anything new, just clean up.",
    "created_at": "2014-10-19T09:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210733",
    "user": "https://github.com/kiwifb"
}
```

I am working on updating the branch (package name, checksums and patch refresh to eliminate fuzz). I'll also update the description once I am finished. It will then be up to Julien to push the button.
I am not doing anything new, just clean up.



---

archive/issue_comments_210734.json:
```json
{
    "body": "Here it comes....\n\n---\nNew commits:",
    "created_at": "2014-10-19T10:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210734",
    "user": "https://github.com/kiwifb"
}
```

Here it comes....

---
New commits:



---

archive/issue_comments_210735.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-19T10:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210735",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_210736.json:
```json
{
    "body": "Is the change from `sphinx` to `Sphinx` going to cause any upgrading troubles?",
    "created_at": "2014-10-21T17:13:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210736",
    "user": "https://github.com/kcrisman"
}
```

Is the change from `sphinx` to `Sphinx` going to cause any upgrading troubles?



---

archive/issue_comments_210737.json:
```json
{
    "body": "Replying to [comment:52 kcrisman]:\n> Is the change from `sphinx` to `Sphinx` going to cause any upgrading troubles?\n\n\nI've tried this and I didn't see an issue. But Fran\u00e7ois may see something.",
    "created_at": "2014-10-21T17:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210737",
    "user": "https://github.com/strogdon"
}
```

Replying to [comment:52 kcrisman]:
> Is the change from `sphinx` to `Sphinx` going to cause any upgrading troubles?


I've tried this and I didn't see an issue. But Franois may see something.



---

archive/issue_comments_210738.json:
```json
{
    "body": "We've been there before with another package. The answer is not anymore. Since Julien is not around and Steve tried it I am pushing the button to get on with this. We waited long enough.",
    "created_at": "2014-10-21T19:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210738",
    "user": "https://github.com/kiwifb"
}
```

We've been there before with another package. The answer is not anymore. Since Julien is not around and Steve tried it I am pushing the button to get on with this. We waited long enough.



---

archive/issue_comments_210739.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-21T19:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210739",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_210740.json:
```json
{
    "body": "And now to get the sphinx patches out of #16733 so hopefully #16736 can be resolved.",
    "created_at": "2014-10-21T19:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210740",
    "user": "https://github.com/strogdon"
}
```

And now to get the sphinx patches out of #16733 so hopefully #16736 can be resolved.



---

archive/issue_comments_210741.json:
```json
{
    "body": "Breaks pdf docs for me with\n\n```\n! LATEX ERROR: BAD MATH ENVIRONMENT DELIMITER.\n\nSEE THE LATEX MANUAL OR LATEX COMPANION FOR EXPLANATION.\nType  H <return>  for immediate help.\n ...                                              \n                                                  \nl.222 ... index subgroups of \\({\\rm SL}_2(\\ZZ)\\))}\n                                                  \n? \n! Emergency stop.\n ...                                              \n                                                  \nl.222 ... index subgroups of \\({\\rm SL}_2(\\ZZ)\\))}\n                                                  \n!  ==> Fatal error occurred, no output PDF file produced!\nTranscript written on arithgroup.log.\nMakefile:55: recipe for target 'arithgroup.pdf' failed\nmake[1]: *** [arithgroup.pdf] Error 1\n```\nI think the tex code has been around for a while, but the new sphinx doesn't allow these math delimiters. I would just change them to the usual dollar sign or backtick.",
    "created_at": "2014-10-22T23:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210741",
    "user": "https://github.com/vbraun"
}
```

Breaks pdf docs for me with

```
! LATEX ERROR: BAD MATH ENVIRONMENT DELIMITER.

SEE THE LATEX MANUAL OR LATEX COMPANION FOR EXPLANATION.
Type  H <return>  for immediate help.
 ...                                              
                                                  
l.222 ... index subgroups of \({\rm SL}_2(\ZZ)\))}
                                                  
? 
! Emergency stop.
 ...                                              
                                                  
l.222 ... index subgroups of \({\rm SL}_2(\ZZ)\))}
                                                  
!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on arithgroup.log.
Makefile:55: recipe for target 'arithgroup.pdf' failed
make[1]: *** [arithgroup.pdf] Error 1
```
I think the tex code has been around for a while, but the new sphinx doesn't allow these math delimiters. I would just change them to the usual dollar sign or backtick.



---

archive/issue_comments_210742.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-22T23:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210742",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_210743.json:
```json
{
    "body": "This should have been taken care of with this commit:\n\nhttp://git.sagemath.org/sage.git/commit/?id=761be309a895a85c91ec24af8acc69eca0126faf\n\nHowever the name of the patch file, `inline-latex` doesn't have a `.patch` extension and thus it is never applied.",
    "created_at": "2014-10-23T00:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210743",
    "user": "https://github.com/strogdon"
}
```

This should have been taken care of with this commit:

http://git.sagemath.org/sage.git/commit/?id=761be309a895a85c91ec24af8acc69eca0126faf

However the name of the patch file, `inline-latex` doesn't have a `.patch` extension and thus it is never applied.



---

archive/issue_comments_210744.json:
```json
{
    "body": "Darn I missed that. I will take care of this shortly.",
    "created_at": "2014-10-23T00:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210744",
    "user": "https://github.com/kiwifb"
}
```

Darn I missed that. I will take care of this shortly.



---

archive/issue_comments_210745.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-23T00:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210745",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210746.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-10-23T00:26:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210746",
    "user": "https://github.com/kcrisman"
}
```

New commits:



---

archive/issue_comments_210747.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-23T00:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210747",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_210748.json:
```json
{
    "body": "Fixed.",
    "created_at": "2014-10-23T00:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210748",
    "user": "https://github.com/kiwifb"
}
```

Fixed.



---

archive/issue_comments_210749.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-23T03:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210749",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_210750.json:
```json
{
    "body": "This works for me.",
    "created_at": "2014-10-23T03:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210750",
    "user": "https://github.com/jhpalmieri"
}
```

This works for me.



---

archive/issue_comments_210751.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-24T10:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210751",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048257.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-24T10:14:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16159#event-48257"
}
```



---

archive/issue_comments_210752.json:
```json
{
    "body": "The upstream [sphinx ticket](https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline) has a question from 2014-07-13, can someone add a comment there?",
    "created_at": "2014-10-28T08:12:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210752",
    "user": "https://github.com/slel"
}
```

The upstream [sphinx ticket](https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline) has a question from 2014-07-13, can someone add a comment there?



---

archive/issue_comments_210753.json:
```json
{
    "body": "Replying to [comment:65 slelievre]:\n> The upstream [sphinx ticket](https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline) has a question from 2014-07-13, can someone add a comment there?\n\nI'm the one that commented there. And the suggested patch is included in this ticket. What were you thinking of in terms of comment?",
    "created_at": "2014-10-29T15:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210753",
    "user": "https://github.com/strogdon"
}
```

Replying to [comment:65 slelievre]:
> The upstream [sphinx ticket](https://bitbucket.org/birkenfeld/sphinx/issue/1480/latex-math-output-is-broken-for-inline) has a question from 2014-07-13, can someone add a comment there?

I'm the one that commented there. And the suggested patch is included in this ticket. What were you thinking of in terms of comment?



---

archive/issue_comments_210754.json:
```json
{
    "body": "Replying to [comment:50 fbissey]:\n> I am working on updating the branch (package name, checksums and patch refresh to eliminate fuzz). I'll also update the description once I am finished. It will then be up to Julien to push the button.\n> I am not doing anything new, just clean up.\n\n\nSorry, I've been away for two weeks, then my browser didn't let me connect to trac (I just found the time to dig and behead the beast). Great work, thanks!",
    "created_at": "2014-11-06T07:45:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210754",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

Replying to [comment:50 fbissey]:
> I am working on updating the branch (package name, checksums and patch refresh to eliminate fuzz). I'll also update the description once I am finished. It will then be up to Julien to push the button.
> I am not doing anything new, just clean up.


Sorry, I've been away for two weeks, then my browser didn't let me connect to trac (I just found the time to dig and behead the beast). Great work, thanks!



---

archive/issue_comments_210755.json:
```json
{
    "body": "<psa>For future reference, folks, please do use/read SPKG.txt.  This caused some annoyance in #17265 because of #17369.</psa>",
    "created_at": "2014-11-19T16:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16159#issuecomment-210755",
    "user": "https://github.com/kcrisman"
}
```

<psa>For future reference, folks, please do use/read SPKG.txt.  This caused some annoyance in #17265 because of #17369.</psa>
