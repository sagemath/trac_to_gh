# Issue 23492: py3: some care for division in graphs + various improvements

archive/issues_023492.json:
```json
{
    "body": "CC:  @tscrim @jdemeyer @jhpalmieri\n\nas another step to py3\n\nIssue created by migration from https://trac.sagemath.org/ticket/23729\n\n",
    "created_at": "2017-08-26T18:31:39Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "py3: some care for division in graphs + various improvements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23492",
    "user": "https://github.com/fchapoton"
}
```
CC:  @tscrim @jdemeyer @jhpalmieri

as another step to py3

Issue created by migration from https://trac.sagemath.org/ticket/23729





---

archive/issue_comments_328849.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-26T18:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328849",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_328850.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-08-26T18:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328850",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_328851.json:
```json
{
    "body": "Why this change?\n\n```diff\n-class CoercionException(TypeError):\n+class CoercionException(TypeError, BaseException):\n```\n\n`TypeError` is a subclass of `BaseException`, so I don't understand why it is needed/wanted.",
    "created_at": "2017-08-27T05:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328851",
    "user": "https://github.com/tscrim"
}
```

Why this change?

```diff
-class CoercionException(TypeError):
+class CoercionException(TypeError, BaseException):
```

`TypeError` is a subclass of `BaseException`, so I don't understand why it is needed/wanted.



---

archive/issue_comments_328852.json:
```json
{
    "body": "because this line triggers the warning\n\n```\ncatching classes that don't inherit from BaseException is not allowed in  3.x\n```\n\nwhen the tests are run with \"python -3 sage-runtests\"\n\nare you sure of what you say ?\n\n```\nsage: isinstance(TypeError,Exception)\nFalse\nsage: isinstance(TypeError,BaseException)\nFalse\n```\n",
    "created_at": "2017-08-27T06:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328852",
    "user": "https://github.com/fchapoton"
}
```

because this line triggers the warning

```
catching classes that don't inherit from BaseException is not allowed in  3.x
```

when the tests are run with "python -3 sage-runtests"

are you sure of what you say ?

```
sage: isinstance(TypeError,Exception)
False
sage: isinstance(TypeError,BaseException)
False
```




---

archive/issue_comments_328853.json:
```json
{
    "body": "Your tests are incorrect because `TypeError` is a class, not an instance of a class:\n\n```\nsage: type(TypeError)\n<type 'type'>\n```\n\nCompare with\n\n```\nsage: TypeError.__mro__\n(<type 'exceptions.TypeError'>,\n <type 'exceptions.StandardError'>,\n <type 'exceptions.Exception'>,\n <type 'exceptions.BaseException'>,\n <type 'object'>)\nsage: e = TypeError(\"foo\")\nsage: isinstance(e, BaseException)\nTrue\nsage: isinstance(e, Exception)\nTrue\n```\n",
    "created_at": "2017-08-27T06:12:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328853",
    "user": "https://github.com/tscrim"
}
```

Your tests are incorrect because `TypeError` is a class, not an instance of a class:

```
sage: type(TypeError)
<type 'type'>
```

Compare with

```
sage: TypeError.__mro__
(<type 'exceptions.TypeError'>,
 <type 'exceptions.StandardError'>,
 <type 'exceptions.Exception'>,
 <type 'exceptions.BaseException'>,
 <type 'object'>)
sage: e = TypeError("foo")
sage: isinstance(e, BaseException)
True
sage: isinstance(e, Exception)
True
```




---

archive/issue_comments_328854.json:
```json
{
    "body": "Ok, I stand corrected. But there is a warning:\n\n```\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/categories/pushout.py\", line 3992, in pushout\n        except CoercionException:\n    :\n    DeprecationWarning: catching classes that don't inherit from BaseException is not allowed in 3.x\n```\n\nSo, why ?",
    "created_at": "2017-08-27T06:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328854",
    "user": "https://github.com/fchapoton"
}
```

Ok, I stand corrected. But there is a warning:

```
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/categories/pushout.py", line 3992, in pushout
        except CoercionException:
    :
    DeprecationWarning: catching classes that don't inherit from BaseException is not allowed in 3.x
```

So, why ?



---

archive/issue_comments_328855.json:
```json
{
    "body": "indeed\n\n```\nsage: CoercionException.__mro__\n\n(<class 'sage.structure.coerce_exceptions.CoercionException'>,\n <type 'exceptions.TypeError'>,\n <type 'exceptions.StandardError'>,\n <type 'exceptions.Exception'>,\n <type 'exceptions.BaseException'>,\n <type 'object'>)\n```\n\nThe only difference is that it is a class and not a type.",
    "created_at": "2017-08-27T06:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328855",
    "user": "https://github.com/fchapoton"
}
```

indeed

```
sage: CoercionException.__mro__

(<class 'sage.structure.coerce_exceptions.CoercionException'>,
 <type 'exceptions.TypeError'>,
 <type 'exceptions.StandardError'>,
 <type 'exceptions.Exception'>,
 <type 'exceptions.BaseException'>,
 <type 'object'>)
```

The only difference is that it is a class and not a type.



---

archive/issue_comments_328856.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-08-27T06:25:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328856",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328857.json:
```json
{
    "body": "Ah, that is a good observation and is likely the difference. I think they just were not quite smart enough with how they raise the warnings. IIRC, your Python3 branch is not far enough to check that this works in Python3, correct?",
    "created_at": "2017-08-27T06:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328857",
    "user": "https://github.com/tscrim"
}
```

Ah, that is a good observation and is likely the difference. I think they just were not quite smart enough with how they raise the warnings. IIRC, your Python3 branch is not far enough to check that this works in Python3, correct?



---

archive/issue_comments_328858.json:
```json
{
    "body": "yes, yes. Anyway, I have undone this modification now.",
    "created_at": "2017-08-27T06:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328858",
    "user": "https://github.com/fchapoton"
}
```

yes, yes. Anyway, I have undone this modification now.



---

archive/issue_comments_328859.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-27T06:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328859",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_328860.json:
```json
{
    "body": "Thanks. LGTM.",
    "created_at": "2017-08-27T06:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328860",
    "user": "https://github.com/tscrim"
}
```

Thanks. LGTM.



---

archive/issue_comments_328861.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-10T11:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328861",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_328862.json:
```json
{
    "body": "Changing keywords from \"\" to \"division\".",
    "created_at": "2018-02-23T13:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23492",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23492#issuecomment-328862",
    "user": "https://github.com/embray"
}
```

Changing keywords from "" to "division".
