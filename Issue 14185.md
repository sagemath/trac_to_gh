# Issue 14185: Multithreaded multiplication for algebras with basis

archive/issues_014185.json:
```json
{
    "body": "Assignee: @nthiery\n\nCC:  @nthiery\n\nKeywords: product multiplication multithread\n\nI purpose a simple patch to improve the multiplication method in Algebras_with_basis category\n\nIssue created by migration from https://trac.sagemath.org/ticket/14389\n\n",
    "created_at": "2013-03-30T16:48:57Z",
    "labels": [
        "categories",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Multithreaded multiplication for algebras with basis",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14185",
    "user": "elixyre"
}
```
Assignee: @nthiery

CC:  @nthiery

Keywords: product multiplication multithread

I purpose a simple patch to improve the multiplication method in Algebras_with_basis category

Issue created by migration from https://trac.sagemath.org/ticket/14389





---

archive/issue_comments_178303.json:
```json
{
    "body": "Attachment [trac14389_multithreaded_multiplication-EliX-jbp.patch](tarball://root/attachments/some-uuid/ticket14389/trac14389_multithreaded_multiplication-EliX-jbp.patch) by @nthiery created at 2013-04-01 02:41:33\n\nSalut!\n\nGreat idea. And very natural once you think about it.\n\nI don't think this should be activated by default though. For simple\nproduct rules, or when there is a cache on the product on basis, this\nmost likely induces a regression. On the other hand, this suggests\nthat it should be possible to easily configure at least to options for\nproducts in an algebra with basis:\n\n- Whether to cache the product on the basis\n- Whether to use parallelism\n\nThere just remains to find and implement a good idiom :-)\n\nOn a technical note: it might be better to move the implementation of\nthe `@`parallel-decorated method outside of the body of the methods to\navoid recreating them each time. I am not sure as well of the logic to\nhandle _multiply_on_basis (but that could be an occasion to finally\ndeprecate it).\n\nCheers,\n                           Nicolas",
    "created_at": "2013-04-01T02:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14185#issuecomment-178303",
    "user": "@nthiery"
}
```

Attachment [trac14389_multithreaded_multiplication-EliX-jbp.patch](tarball://root/attachments/some-uuid/ticket14389/trac14389_multithreaded_multiplication-EliX-jbp.patch) by @nthiery created at 2013-04-01 02:41:33

Salut!

Great idea. And very natural once you think about it.

I don't think this should be activated by default though. For simple
product rules, or when there is a cache on the product on basis, this
most likely induces a regression. On the other hand, this suggests
that it should be possible to easily configure at least to options for
products in an algebra with basis:

- Whether to cache the product on the basis
- Whether to use parallelism

There just remains to find and implement a good idiom :-)

On a technical note: it might be better to move the implementation of
the `@`parallel-decorated method outside of the body of the methods to
avoid recreating them each time. I am not sure as well of the logic to
handle _multiply_on_basis (but that could be an occasion to finally
deprecate it).

Cheers,
                           Nicolas
