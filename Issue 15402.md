# Issue 15402: Random failure in integer_vector

archive/issues_015402.json:
```json
{
    "body": "CC:  f.poloni ncohen wdj\n\nGot this once on skynet/eno:\n\n```\nsage -t --long src/sage/combinat/integer_vector.py\n**********************************************************************\nFile \"src/sage/combinat/integer_vector.py\", line 347, in sage.combinat.integer_vector._slider01.range.gale_ryser_theorem\nFailed example:\n    for algorithm in [\"gale\", \"ryser\"]:                            # long time\n         for i in range(50):                                         # long time\n            if not test_algorithm(algorithm, 3, 10):                 # long time\n                print \"Something wrong with algorithm \", algorithm   # long time\n                break                                                # long time\nExpected nothing\nGot:\n    Something wrong with algorithm  ryser\n```\n\nLikely due to #15609.\n\nCommon Python pitfalls are that the sort order of sets / dict entries can be dependent on memory locations.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15639\n\n",
    "created_at": "2014-01-07T02:39:50Z",
    "labels": [
        "combinatorics",
        "major",
        "bug"
    ],
    "title": "Random failure in integer_vector",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15402",
    "user": "vbraun"
}
```
CC:  f.poloni ncohen wdj

Got this once on skynet/eno:

```
sage -t --long src/sage/combinat/integer_vector.py
**********************************************************************
File "src/sage/combinat/integer_vector.py", line 347, in sage.combinat.integer_vector._slider01.range.gale_ryser_theorem
Failed example:
    for algorithm in ["gale", "ryser"]:                            # long time
         for i in range(50):                                         # long time
            if not test_algorithm(algorithm, 3, 10):                 # long time
                print "Something wrong with algorithm ", algorithm   # long time
                break                                                # long time
Expected nothing
Got:
    Something wrong with algorithm  ryser
```

Likely due to #15609.

Common Python pitfalls are that the sort order of sets / dict entries can be dependent on memory locations.

Issue created by migration from https://trac.sagemath.org/ticket/15639





---

archive/issue_comments_198800.json:
```json
{
    "body": "I don't think that the two bugs are related. #15609 only adds a function `IntegerVectors_nk.rank()` which is never called by the test that fails (I checked by adding a `print` in it and seeing if it appears in the output --- not the most elegant way, but it works).\n\nI might be biased as I am the author of the patch that closed #15609, but my guess is that the bug was present before. It is difficult to tell because the test that fails is randomized and so it generates different matrices every time it is run.",
    "created_at": "2014-01-07T13:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198800",
    "user": "f.poloni"
}
```

I don't think that the two bugs are related. #15609 only adds a function `IntegerVectors_nk.rank()` which is never called by the test that fails (I checked by adding a `print` in it and seeing if it appears in the output --- not the most elegant way, but it works).

I might be biased as I am the author of the patch that closed #15609, but my guess is that the bug was present before. It is difficult to tell because the test that fails is randomized and so it generates different matrices every time it is run.



---

archive/issue_comments_198801.json:
```json
{
    "body": "I would also find it weird that the two tickets may be related `^^;`\n\nNathann",
    "created_at": "2014-01-07T13:26:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198801",
    "user": "ncohen"
}
```

I would also find it weird that the two tickets may be related `^^;`

Nathann



---

archive/issue_comments_198802.json:
```json
{
    "body": "I have changed the output of the test so that when it fails again we get the (random) input values that caused failure. In this way, when it fails again it will be much easier to debug.\n\nThis does not fix the issue, there must still be a bug in the `ryser` algorithm, but I think that we can close the bug nevertheless until a new test failure report comes.",
    "created_at": "2014-06-15T08:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198802",
    "user": "f.poloni"
}
```

I have changed the output of the test so that when it fails again we get the (random) input values that caused failure. In this way, when it fails again it will be much easier to debug.

This does not fix the issue, there must still be a bug in the `ryser` algorithm, but I think that we can close the bug nevertheless until a new test failure report comes.



---

archive/issue_comments_198803.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-06-15T08:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198803",
    "user": "f.poloni"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_198804.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-15T09:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198804",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198805.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-15T12:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198805",
    "user": "vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_198806.json:
```json
{
    "body": "lgtm",
    "created_at": "2014-06-15T12:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198806",
    "user": "vbraun"
}
```

lgtm



---

archive/issue_comments_198807.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-18T12:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15402#issuecomment-198807",
    "user": "vbraun"
}
```

Resolution: fixed
