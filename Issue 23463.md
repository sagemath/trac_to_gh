# Issue 23463: update gc to version 7.6

archive/issues_023463.json:
```json
{
    "body": "CC:  @kiwifb @embray\n\nAn update to gc is needed to support arm64/aarch64, see #23687.\n\nThe source is here: http://www.hboehm.info/gc/gc_source/gc-7.6.0.tar.gz\n\nOn some platforms this new version also needs libatomic_ops.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23700\n\n",
    "created_at": "2017-08-24T13:58:07Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "update gc to version 7.6",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23463",
    "user": "@dimpase"
}
```
CC:  @kiwifb @embray

An update to gc is needed to support arm64/aarch64, see #23687.

The source is here: http://www.hboehm.info/gc/gc_source/gc-7.6.0.tar.gz

On some platforms this new version also needs libatomic_ops.

Issue created by migration from https://trac.sagemath.org/ticket/23700





---

archive/issue_comments_328625.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-24T15:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328625",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328626.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-24T15:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328626",
    "user": "@dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_328627.json:
```json
{
    "body": "Erik, could you please check whether this works on Cygwin without your patch?\n\n(one need #23701 first, and re-running `./configure` to register the new package)",
    "created_at": "2017-08-24T15:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328627",
    "user": "@dimpase"
}
```

Erik, could you please check whether this works on Cygwin without your patch?

(one need #23701 first, and re-running `./configure` to register the new package)



---

archive/issue_comments_328628.json:
```json
{
    "body": "Ah, yes. I remember this.  I'll give it a go.",
    "created_at": "2017-08-25T15:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328628",
    "user": "@embray"
}
```

Ah, yes. I remember this.  I'll give it a go.



---

archive/issue_comments_328629.json:
```json
{
    "body": "I think this branch needs to be updated on the latest version of #23701 since it's using 7.4.6 and this branch is using 7.4.4.",
    "created_at": "2017-08-25T15:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328629",
    "user": "@embray"
}
```

I think this branch needs to be updated on the latest version of #23701 since it's using 7.4.6 and this branch is using 7.4.4.



---

archive/issue_comments_328630.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T15:46:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328630",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328631.json:
```json
{
    "body": "You're right - done now.",
    "created_at": "2017-08-25T15:47:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328631",
    "user": "@dimpase"
}
```

You're right - done now.



---

archive/issue_comments_328632.json:
```json
{
    "body": "Thanks--now it's working. Or at least, it's building.  Can't say anything about tests right now.",
    "created_at": "2017-08-25T15:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328632",
    "user": "@embray"
}
```

Thanks--now it's working. Or at least, it's building.  Can't say anything about tests right now.



---

archive/issue_comments_328633.json:
```json
{
    "body": "on FreeBSD this needs the patch fixing https://github.com/ivmai/bdwgc/issues/132",
    "created_at": "2017-08-30T12:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328633",
    "user": "@dimpase"
}
```

on FreeBSD this needs the patch fixing https://github.com/ivmai/bdwgc/issues/132



---

archive/issue_comments_328634.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-30T14:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328634",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328635.json:
```json
{
    "body": "On Linux tests pass, but I can trigger a nasty crash interactively:\n\n```\nsage: from sage.libs.ecl import *\nsage: from sage.interfaces.maxima_lib import <TAB>\n```\n\nDebian [experimental uses gc 7.4.4](https://people.debian.org/~thansen/debian-sage-status.html), so this would be one to test for this regression, too.",
    "created_at": "2017-09-28T03:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328635",
    "user": "@dimpase"
}
```

On Linux tests pass, but I can trigger a nasty crash interactively:

```
sage: from sage.libs.ecl import *
sage: from sage.interfaces.maxima_lib import <TAB>
```

Debian [experimental uses gc 7.4.4](https://people.debian.org/~thansen/debian-sage-status.html), so this would be one to test for this regression, too.



---

archive/issue_comments_328636.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-28T03:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328636",
    "user": "@dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328637.json:
```json
{
    "body": "With GC included in ECL (tagged version 7.5.0 in ECL source, although I haven't checked how canonical this is) I do get the crash in comment 11.",
    "created_at": "2017-09-28T08:59:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328637",
    "user": "@dimpase"
}
```

With GC included in ECL (tagged version 7.5.0 in ECL source, although I haven't checked how canonical this is) I do get the crash in comment 11.



---

archive/issue_comments_328638.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-03T10:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328638",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328639.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-03T10:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328639",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328640.json:
```json
{
    "body": "Turns out this is still not building properly on Cygwin.  It fails to produce a shared lib at link time:\n\n\n```\n/bin/sh ./libtool  --tag=CC   --mode=link gcc   -fexceptions -Wall -Wextra -O2 -g  -fno-strict-aliasing  -version-info 1:3:0 -no-undefined -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib  -o libgc.la -rpath /home/embray/src/sagemath/sage/local/lib allchblk.lo alloc.lo blacklst.lo checksums.lo dbg_mlc.lo dyn_load.lo finalize.lo gc_dlopen.lo gcj_mlc.lo headers.lo mach_dep.lo malloc.lo mallocx.lo mark.lo mark_rts.lo misc.lo new_hblk.lo obj_map.lo os_dep.lo pcr_interface.lo ptr_chck.lo real_malloc.lo reclaim.lo specific.lo stubborn.lo thread_local_alloc.lo typd_mlc.lo win32_threads.lo     fnlz_mlc.lo    -L/home/embray/src/sagemath/sage/local/lib -latomic_ops\nmv -f cord/.deps/libcord_la-cordxtra.Tpo cord/.deps/libcord_la-cordxtra.Plo\n\n*** Warning: linker path does not have real file for library -latomic_ops.\n*** I have the capability to make that library automatically link in when\n*** you link to this library.  But I can only do this if you have a\n*** shared version of the library, which you do not appear to have\n*** because I did check the linker path looking for a file starting\n*** with libatomic_ops and none of the candidates passed a file format test\n*** using a file magic. Last file checked: /home/embray/src/sagemath/sage/local/lib/libatomic_ops.a\n*** The inter-library dependencies that have been dropped here will be\n*** automatically added whenever a program is linked with this library\n*** or is declared to -dlopen it.\n\n*** Since this library must not contain undefined symbols,\n*** because either the platform does not support them or\n*** it was explicitly requested with -no-undefined,\n*** libtool will only create a static version of it.\nlibtool: link: ar cru .libs/libgc.a  allchblk.o alloc.o blacklst.o checksums.o dbg_mlc.o dyn_load.o finalize.o gc_dlopen.o gcj_mlc.o headers.o mach_dep.o malloc.o mallocx.o mark.o mark_rts.o misc.o new_hblk.o obj_map.o os_dep.o pcr_interface.o ptr_chck.o real_malloc.o reclaim.o specific.o stubborn.o thread_local_alloc.o typd_mlc.o win32_threads.o fnlz_mlc.o\nlibtool: link: ranlib .libs/libgc.a\nlibtool: link: ( cd \".libs\" && rm -f \"libgc.la\" && ln -s \"../libgc.la\" \"libgc.la\" )\n/bin/sh ./libtool  --tag=CC   --mode=link gcc   -fexceptions -Wall -Wextra -O2 -g  -fno-strict-aliasing -version-info 1:3:0 -no-undefined -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib  -o libcord.la -rpath /home/embray/src/sagemath/sage/local/lib cord/libcord_la-cordbscs.lo cord/libcord_la-cordprnt.lo cord/libcord_la-cordxtra.lo ./libgc.la\n\n*** Warning: This system cannot link to static lib archive ./libgc.la.\n*** I have the capability to make that library automatically link in when\n*** you link to this library.  But I can only do this if you have a\n*** shared version of the library, which you do not appear to have.\n\n*** Warning: linker path does not have real file for library -latomic_ops.\n*** I have the capability to make that library automatically link in when\n*** you link to this library.  But I can only do this if you have a\n*** shared version of the library, which you do not appear to have\n*** because I did check the linker path looking for a file starting\n*** with libatomic_ops and none of the candidates passed a file format test\n*** using a file magic. Last file checked: /home/embray/src/sagemath/sage/local/lib/libatomic_ops.a\n*** The inter-library dependencies that have been dropped here will be\n*** automatically added whenever a program is linked with this library\n*** or is declared to -dlopen it.\n\n*** Since this library must not contain undefined symbols,\n*** because either the platform does not support them or\n*** it was explicitly requested with -no-undefined,\n*** libtool will only create a static version of it.\nlibtool: link: ar cru .libs/libcord.a  cord/libcord_la-cordbscs.o cord/libcord_la-cordprnt.o cord/libcord_la-cordxtra.o\nlibtool: link: ranlib .libs/libcord.a\nlibtool: link: ( cd \".libs\" && rm -f \"libcord.la\" && ln -s \"../libcord.la\" \"libcord.la\" )\n```\n\n\nIt's probably a minor issue with link flag ordering.  I will investigate and provide a solution.",
    "created_at": "2017-10-09T12:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328640",
    "user": "@embray"
}
```

Turns out this is still not building properly on Cygwin.  It fails to produce a shared lib at link time:


```
/bin/sh ./libtool  --tag=CC   --mode=link gcc   -fexceptions -Wall -Wextra -O2 -g  -fno-strict-aliasing  -version-info 1:3:0 -no-undefined -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib  -o libgc.la -rpath /home/embray/src/sagemath/sage/local/lib allchblk.lo alloc.lo blacklst.lo checksums.lo dbg_mlc.lo dyn_load.lo finalize.lo gc_dlopen.lo gcj_mlc.lo headers.lo mach_dep.lo malloc.lo mallocx.lo mark.lo mark_rts.lo misc.lo new_hblk.lo obj_map.lo os_dep.lo pcr_interface.lo ptr_chck.lo real_malloc.lo reclaim.lo specific.lo stubborn.lo thread_local_alloc.lo typd_mlc.lo win32_threads.lo     fnlz_mlc.lo    -L/home/embray/src/sagemath/sage/local/lib -latomic_ops
mv -f cord/.deps/libcord_la-cordxtra.Tpo cord/.deps/libcord_la-cordxtra.Plo

*** Warning: linker path does not have real file for library -latomic_ops.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have
*** because I did check the linker path looking for a file starting
*** with libatomic_ops and none of the candidates passed a file format test
*** using a file magic. Last file checked: /home/embray/src/sagemath/sage/local/lib/libatomic_ops.a
*** The inter-library dependencies that have been dropped here will be
*** automatically added whenever a program is linked with this library
*** or is declared to -dlopen it.

*** Since this library must not contain undefined symbols,
*** because either the platform does not support them or
*** it was explicitly requested with -no-undefined,
*** libtool will only create a static version of it.
libtool: link: ar cru .libs/libgc.a  allchblk.o alloc.o blacklst.o checksums.o dbg_mlc.o dyn_load.o finalize.o gc_dlopen.o gcj_mlc.o headers.o mach_dep.o malloc.o mallocx.o mark.o mark_rts.o misc.o new_hblk.o obj_map.o os_dep.o pcr_interface.o ptr_chck.o real_malloc.o reclaim.o specific.o stubborn.o thread_local_alloc.o typd_mlc.o win32_threads.o fnlz_mlc.o
libtool: link: ranlib .libs/libgc.a
libtool: link: ( cd ".libs" && rm -f "libgc.la" && ln -s "../libgc.la" "libgc.la" )
/bin/sh ./libtool  --tag=CC   --mode=link gcc   -fexceptions -Wall -Wextra -O2 -g  -fno-strict-aliasing -version-info 1:3:0 -no-undefined -L/home/embray/src/sagemath/sage/local/lib -Wl,-rpath,/home/embray/src/sagemath/sage/local/lib  -o libcord.la -rpath /home/embray/src/sagemath/sage/local/lib cord/libcord_la-cordbscs.lo cord/libcord_la-cordprnt.lo cord/libcord_la-cordxtra.lo ./libgc.la

*** Warning: This system cannot link to static lib archive ./libgc.la.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have.

*** Warning: linker path does not have real file for library -latomic_ops.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have
*** because I did check the linker path looking for a file starting
*** with libatomic_ops and none of the candidates passed a file format test
*** using a file magic. Last file checked: /home/embray/src/sagemath/sage/local/lib/libatomic_ops.a
*** The inter-library dependencies that have been dropped here will be
*** automatically added whenever a program is linked with this library
*** or is declared to -dlopen it.

*** Since this library must not contain undefined symbols,
*** because either the platform does not support them or
*** it was explicitly requested with -no-undefined,
*** libtool will only create a static version of it.
libtool: link: ar cru .libs/libcord.a  cord/libcord_la-cordbscs.o cord/libcord_la-cordprnt.o cord/libcord_la-cordxtra.o
libtool: link: ranlib .libs/libcord.a
libtool: link: ( cd ".libs" && rm -f "libcord.la" && ln -s "../libcord.la" "libcord.la" )
```


It's probably a minor issue with link flag ordering.  I will investigate and provide a solution.



---

archive/issue_comments_328641.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-09T12:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328641",
    "user": "@embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328642.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-09T14:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328642",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328643.json:
```json
{
    "body": "updated the branch to take into account update on #23701",
    "created_at": "2017-10-09T14:10:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328643",
    "user": "@dimpase"
}
```

updated the branch to take into account update on #23701



---

archive/issue_comments_328644.json:
```json
{
    "body": "Ah, I should have warned you, I'm about to propose another needed change for #23701.",
    "created_at": "2017-10-09T14:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328644",
    "user": "@embray"
}
```

Ah, I should have warned you, I'm about to propose another needed change for #23701.



---

archive/issue_comments_328645.json:
```json
{
    "body": "We should go for 7.6.2:\nhttps://github.com/ivmai/bdwgc/releases/tag/v7.6.2\nIn particular, this includes the patches needed by the FreeBSD port.\nI will update this accordingly.",
    "created_at": "2018-01-06T00:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328645",
    "user": "@dimpase"
}
```

We should go for 7.6.2:
https://github.com/ivmai/bdwgc/releases/tag/v7.6.2
In particular, this includes the patches needed by the FreeBSD port.
I will update this accordingly.



---

archive/issue_comments_328646.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-06T01:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328646",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328647.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-06T01:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328647",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328648.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-01-08T14:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328648",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328649.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-08T14:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328649",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328650.json:
```json
{
    "body": "OK, another advantage is that all our patches are now upstream!",
    "created_at": "2018-01-08T14:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328650",
    "user": "@dimpase"
}
```

OK, another advantage is that all our patches are now upstream!



---

archive/issue_comments_328651.json:
```json
{
    "body": "I'm trying to get this built on Cygwin--will report back with any findings.",
    "created_at": "2018-01-10T11:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328651",
    "user": "@embray"
}
```

I'm trying to get this built on Cygwin--will report back with any findings.



---

archive/issue_comments_328652.json:
```json
{
    "body": "IIRC I had some trouble with this on Cygwin (specifically with libatomic_ops), but that was a while ago and I got distracted.  Going to give it another try.",
    "created_at": "2018-02-02T14:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328652",
    "user": "@embray"
}
```

IIRC I had some trouble with this on Cygwin (specifically with libatomic_ops), but that was a while ago and I got distracted.  Going to give it another try.



---

archive/issue_comments_328653.json:
```json
{
    "body": "Likewise with ticket:23701#comment:15 would you accept a small update to this for Cygwin?",
    "created_at": "2018-02-02T16:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328653",
    "user": "@embray"
}
```

Likewise with ticket:23701#comment:15 would you accept a small update to this for Cygwin?



---

archive/issue_comments_328654.json:
```json
{
    "body": "sure",
    "created_at": "2018-02-02T16:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328654",
    "user": "@dimpase"
}
```

sure



---

archive/issue_comments_328655.json:
```json
{
    "body": "Rebased on top of my updates to #23701 and incorporated a minor change for Cygwin.\n----\nNew commits:",
    "created_at": "2018-02-05T09:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328655",
    "user": "@embray"
}
```

Rebased on top of my updates to #23701 and incorporated a minor change for Cygwin.
----
New commits:



---

archive/issue_comments_328656.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-20T16:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328656",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_328657.json:
```json
{
    "body": "\n```\nFound local metadata for gc-7.6.2\nUsing cached file /mnt/disk/home/release/Sage/upstream/gc-7.6.2.tar.gz\ngc-7.6.2\n====================================================\nSetting up build directory for gc-7.6.2\nFinished extraction\nApplying patches from ../patches...\nApplying ../patches/0001-On-Cygwin-use-mprotect-instead-of-mmap-to-set-PROT_N.patch\npatching file os_dep.c\nHunk #1 FAILED at 698.\nHunk #2 FAILED at 2404.\nHunk #3 FAILED at 2515.\n3 out of 3 hunks FAILED -- saving rejects to file os_dep.c.rej\nError applying '../patches/0001-On-Cygwin-use-mprotect-instead-of-mmap-to-set-PROT_N.patch'\n************************************************************************\nError applying patches\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the log file\n  /mnt/disk/home/release/Sage/logs/pkgs/gc-7.6.2.log\nDescribe your computer, operating system, etc.\n************************************************************************\n```\n",
    "created_at": "2018-02-21T19:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328657",
    "user": "@vbraun"
}
```


```
Found local metadata for gc-7.6.2
Using cached file /mnt/disk/home/release/Sage/upstream/gc-7.6.2.tar.gz
gc-7.6.2
====================================================
Setting up build directory for gc-7.6.2
Finished extraction
Applying patches from ../patches...
Applying ../patches/0001-On-Cygwin-use-mprotect-instead-of-mmap-to-set-PROT_N.patch
patching file os_dep.c
Hunk #1 FAILED at 698.
Hunk #2 FAILED at 2404.
Hunk #3 FAILED at 2515.
3 out of 3 hunks FAILED -- saving rejects to file os_dep.c.rej
Error applying '../patches/0001-On-Cygwin-use-mprotect-instead-of-mmap-to-set-PROT_N.patch'
************************************************************************
Error applying patches
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log file
  /mnt/disk/home/release/Sage/logs/pkgs/gc-7.6.2.log
Describe your computer, operating system, etc.
************************************************************************
```




---

archive/issue_comments_328658.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-02-21T19:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328658",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_328659.json:
```json
{
    "body": "facepalm...\nwe should bump it up to 7.6.4 anyway.",
    "created_at": "2018-02-21T20:19:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328659",
    "user": "@dimpase"
}
```

facepalm...
we should bump it up to 7.6.4 anyway.



---

archive/issue_comments_328660.json:
```json
{
    "body": "I believe that the failing patch is already in 7.6.4, see\nhttps://github.com/ivmai/bdwgc/commit/be148f4141ab5d6812928a7bceeb2617384e7fe7",
    "created_at": "2018-02-21T23:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328660",
    "user": "@dimpase"
}
```

I believe that the failing patch is already in 7.6.4, see
https://github.com/ivmai/bdwgc/commit/be148f4141ab5d6812928a7bceeb2617384e7fe7



---

archive/issue_comments_328661.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2018-02-21T23:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328661",
    "user": "@dimpase"
}
```

Last 10 new commits:



---

archive/issue_comments_328662.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-21T23:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328662",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328663.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-27T09:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328663",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328664.json:
```json
{
    "body": "1. `build/pkgs/libatomic_ops/spkg-install`: you are wrongly using \"BoehmGC\".\n\n2. `build/pkgs/libatomic_ops/spkg-install`: instead of a generic variable like `CONFIGURE_FLAGS`, please use `LIBATOMIC_OPS_CONFIGURE` to be more consistent with other packages.\n\n3. `build/pkgs/libatomic_ops/spkg-check`: there is no longer need for the `if [ -z \"$SAGE_LOCAL\" ]; then` boilerplate.",
    "created_at": "2018-02-27T09:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328664",
    "user": "@jdemeyer"
}
```

1. `build/pkgs/libatomic_ops/spkg-install`: you are wrongly using "BoehmGC".

2. `build/pkgs/libatomic_ops/spkg-install`: instead of a generic variable like `CONFIGURE_FLAGS`, please use `LIBATOMIC_OPS_CONFIGURE` to be more consistent with other packages.

3. `build/pkgs/libatomic_ops/spkg-check`: there is no longer need for the `if [ -z "$SAGE_LOCAL" ]; then` boilerplate.



---

archive/issue_comments_328665.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-27T09:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328665",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328666.json:
```json
{
    "body": "Jeroen, `libatomic_ops` has nothing to do with this ticket. It was #23701.\nIf you think #23701 needs an improvement please open another ticket.",
    "created_at": "2018-02-27T09:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328666",
    "user": "@dimpase"
}
```

Jeroen, `libatomic_ops` has nothing to do with this ticket. It was #23701.
If you think #23701 needs an improvement please open another ticket.



---

archive/issue_comments_328667.json:
```json
{
    "body": "They were just minor comments, nothing serious.",
    "created_at": "2018-02-27T09:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328667",
    "user": "@jdemeyer"
}
```

They were just minor comments, nothing serious.



---

archive/issue_comments_328668.json:
```json
{
    "body": "Replying to [comment:38 dimpase]:\n> Jeroen, `libatomic_ops` has nothing to do with this ticket. It was #23701.\n> If you think #23701 needs an improvement please open another ticket.\n\nTo be very precise, the commits which are supposedly from #23701 do not actually appear on the branch at #23701. So this ticket needs to be rebased.",
    "created_at": "2018-02-27T10:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328668",
    "user": "@jdemeyer"
}
```

Replying to [comment:38 dimpase]:
> Jeroen, `libatomic_ops` has nothing to do with this ticket. It was #23701.
> If you think #23701 needs an improvement please open another ticket.

To be very precise, the commits which are supposedly from #23701 do not actually appear on the branch at #23701. So this ticket needs to be rebased.



---

archive/issue_comments_328669.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-27T10:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328669",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328670.json:
```json
{
    "body": "There is also the obvious missing dependency\n\n```\n[gc-7.6.4] checking for atomic_ops... no\n[gc-7.6.4] checking atomic_ops.h usability... no\n[gc-7.6.4] checking atomic_ops.h presence... no\n[gc-7.6.4] checking for atomic_ops.h... no\n[gc-7.6.4] configure: error: libatomic_ops is required.  You can either install it on\n[gc-7.6.4]                   your system, or fetch and unpack a recent version into the\n[gc-7.6.4]                   source directory and link or rename it to libatomic_ops.\n[gc-7.6.4] Error configuring BoehmGC.\n```\n",
    "created_at": "2018-02-27T10:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328670",
    "user": "@jdemeyer"
}
```

There is also the obvious missing dependency

```
[gc-7.6.4] checking for atomic_ops... no
[gc-7.6.4] checking atomic_ops.h usability... no
[gc-7.6.4] checking atomic_ops.h presence... no
[gc-7.6.4] checking for atomic_ops.h... no
[gc-7.6.4] configure: error: libatomic_ops is required.  You can either install it on
[gc-7.6.4]                   your system, or fetch and unpack a recent version into the
[gc-7.6.4]                   source directory and link or rename it to libatomic_ops.
[gc-7.6.4] Error configuring BoehmGC.
```




---

archive/issue_comments_328671.json:
```json
{
    "body": "Replying to [comment:41 jdemeyer]:\n> There is also the obvious missing dependency\n> {{{\n> [gc-7.6.4] checking for atomic_ops... no\n> [gc-7.6.4] checking atomic_ops.h usability... no\n> [gc-7.6.4] checking atomic_ops.h presence... no\n> [gc-7.6.4] checking for atomic_ops.h... no\n> [gc-7.6.4] configure: error: libatomic_ops is required.  You can either install it on\n> [gc-7.6.4]                   your system, or fetch and unpack a recent version into the\n> [gc-7.6.4]                   source directory and link or rename it to libatomic_ops.\n> [gc-7.6.4] Error configuring BoehmGC.\n> }}}\n\ngood catch, but how do you get this? OS/compiler?",
    "created_at": "2018-02-27T11:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328671",
    "user": "@dimpase"
}
```

Replying to [comment:41 jdemeyer]:
> There is also the obvious missing dependency
> {{{
> [gc-7.6.4] checking for atomic_ops... no
> [gc-7.6.4] checking atomic_ops.h usability... no
> [gc-7.6.4] checking atomic_ops.h presence... no
> [gc-7.6.4] checking for atomic_ops.h... no
> [gc-7.6.4] configure: error: libatomic_ops is required.  You can either install it on
> [gc-7.6.4]                   your system, or fetch and unpack a recent version into the
> [gc-7.6.4]                   source directory and link or rename it to libatomic_ops.
> [gc-7.6.4] Error configuring BoehmGC.
> }}}

good catch, but how do you get this? OS/compiler?



---

archive/issue_comments_328672.json:
```json
{
    "body": "Replying to [comment:42 dimpase]:\n> OS/compiler?\n\nDoesn't matter. Any OS, any compiler.",
    "created_at": "2018-02-27T11:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328672",
    "user": "@jdemeyer"
}
```

Replying to [comment:42 dimpase]:
> OS/compiler?

Doesn't matter. Any OS, any compiler.



---

archive/issue_comments_328673.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-27T11:57:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328673",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328674.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-27T11:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328674",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328675.json:
```json
{
    "body": "all fixed, hopefully.",
    "created_at": "2018-02-27T11:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328675",
    "user": "@dimpase"
}
```

all fixed, hopefully.



---

archive/issue_comments_328676.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-27T14:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328676",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328677.json:
```json
{
    "body": "1. This branch still needs to be rebased to the branch at #23701.\n\n2. You should replace `CONFIGURE_FLAGS` -> `LIBATOMIC_OPS_CONFIGURE` everywhere in `build/pkgs/libatomic_ops/spkg-install`",
    "created_at": "2018-02-27T14:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328677",
    "user": "@jdemeyer"
}
```

1. This branch still needs to be rebased to the branch at #23701.

2. You should replace `CONFIGURE_FLAGS` -> `LIBATOMIC_OPS_CONFIGURE` everywhere in `build/pkgs/libatomic_ops/spkg-install`



---

archive/issue_comments_328678.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-27T18:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328678",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328679.json:
```json
{
    "body": "I've addressed the comment 46.",
    "created_at": "2018-02-27T18:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328679",
    "user": "@dimpase"
}
```

I've addressed the comment 46.



---

archive/issue_comments_328680.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-27T18:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328680",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328681.json:
```json
{
    "body": "The git history is a total mess now... at least messy enough that I'd like to see it merged with the next beta before considering to review it.",
    "created_at": "2018-02-27T19:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328681",
    "user": "@jdemeyer"
}
```

The git history is a total mess now... at least messy enough that I'd like to see it merged with the next beta before considering to review it.



---

archive/issue_comments_328682.json:
```json
{
    "body": "well, yes, I tried to rebase, and it was really doing weird stuff, such as creating `LICENSE` file and changing `.gitignore`, so I merged instead.",
    "created_at": "2018-02-27T19:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328682",
    "user": "@dimpase"
}
```

well, yes, I tried to rebase, and it was really doing weird stuff, such as creating `LICENSE` file and changing `.gitignore`, so I merged instead.



---

archive/issue_comments_328683.json:
```json
{
    "body": "Perhaps I could try to clean it up?",
    "created_at": "2018-03-02T10:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328683",
    "user": "@embray"
}
```

Perhaps I could try to clean it up?



---

archive/issue_comments_328684.json:
```json
{
    "body": "Hopefully it is clean enough now, as the merge of #23701 has happened.",
    "created_at": "2018-03-05T05:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328684",
    "user": "@dimpase"
}
```

Hopefully it is clean enough now, as the merge of #23701 has happened.



---

archive/issue_comments_328685.json:
```json
{
    "body": "Replying to [comment:52 dimpase]:\n> Hopefully it is clean enough now\n\nIt's not cleaner than before since the branch didn't change. The fact that #23701 was merged does mean that the diff is easier to read on Trac.",
    "created_at": "2018-03-06T16:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328685",
    "user": "@jdemeyer"
}
```

Replying to [comment:52 dimpase]:
> Hopefully it is clean enough now

It's not cleaner than before since the branch didn't change. The fact that #23701 was merged does mean that the diff is easier to read on Trac.



---

archive/issue_comments_328686.json:
```json
{
    "body": "The diff is pretty small now: there are largish patches removed, and the rest it really \"admin\".\n\nErik, does the branch work on Cygwin for you now? (You never answered comment 34 above).\nThe commit in the upstream repo seems to do the same job and is authored by you, but it looks differently---hopefully it does the same thing.",
    "created_at": "2018-03-06T17:45:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328686",
    "user": "@dimpase"
}
```

The diff is pretty small now: there are largish patches removed, and the rest it really "admin".

Erik, does the branch work on Cygwin for you now? (You never answered comment 34 above).
The commit in the upstream repo seems to do the same job and is authored by you, but it looks differently---hopefully it does the same thing.



---

archive/issue_comments_328687.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-06T19:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328687",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_328688.json:
```json
{
    "body": "Replying to [comment:54 dimpase]:\n> The diff is pretty small now\n\nYes, the diff is small but the history remains ugly: there are several commits on this branch which are really duplicates of commits from #23701.\n\nNow, all that doesn't really matter.",
    "created_at": "2018-03-06T19:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328688",
    "user": "@jdemeyer"
}
```

Replying to [comment:54 dimpase]:
> The diff is pretty small now

Yes, the diff is small but the history remains ugly: there are several commits on this branch which are really duplicates of commits from #23701.

Now, all that doesn't really matter.



---

archive/issue_comments_328689.json:
```json
{
    "body": "LGTM. My offer still stands to clean up the commit history if desired, but otherwise I'll let it be.",
    "created_at": "2018-03-07T09:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328689",
    "user": "@embray"
}
```

LGTM. My offer still stands to clean up the commit history if desired, but otherwise I'll let it be.



---

archive/issue_comments_328690.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-08T00:02:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23463#issuecomment-328690",
    "user": "@vbraun"
}
```

Resolution: fixed
