# Issue 24296: Factorization of polynomials over function fields over towers of finite fields

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2018-01-12 15:43:22

CC:  swewers

With #24510 this still fails:

```
sage: k = GF(4)
sage: k.<a> = GF(4)
sage: R.<b> = k[]
sage: l.<b> = k.extension(a^2 + a + b)
sage: K.<x> = FunctionField(l)
sage: R.<t> = K[]
sage: F = t*x
sage: F.factor(proof=False)
TypeError: no conversion of this ring to a Singular ring defined
```



---

Comment by saraedum created at 2018-01-13 09:12:54

Changing status from new to needs_review.


---

Comment by git created at 2018-01-13 09:14:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-01-13 09:15:14

Note that I also fix a bug in the old factorization code that would introduce units as actual factors. With the old code xt would factor as `(x) * 1 * t`.


---

Comment by roed created at 2018-01-16 18:21:03

In

```
if a.is_unit():
    unit*=a
```

shouldn't it be `unit*=a**e`?  Also, you should have spaces around `*=`.


---

Comment by git created at 2018-01-16 19:12:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-01-16 19:12:52

Replying to [comment:11 roed]:
> In
> {{{
> if a.is_unit():
>     unit*=a
> }}}
> shouldn't it be `unit*=a**e`?  Also, you should have spaces around `*=`.

Oops, thanks for catching that one.


---

Comment by roed created at 2018-01-16 20:34:20

Two more comments:

* You have

```
sage: k = GF(4)
sage: k.<a> = GF(4)
```

in two places.  The first `k` is superfluous.
* You remove an example of factorization over `CC`.  I glanced at that file and didn't see it elsewhere; why remove the test?


---

Comment by git created at 2018-01-16 20:41:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-01-16 20:46:34

I fixed the first issue.

As for the second, the example is not related to that method, so it should certainly not be the first example there. The correct `factor()`/`_factor_univariate_polynomial()` methods already have a few examples about complex factorization and I don't think that this one was added because it is interesting or tracking a bugfix. I could add it to the univariate `factor()` if you think it should not be lost for unittests.
----
New commits:


---

Comment by roed created at 2018-01-16 20:57:48

Replying to [comment:16 saraedum]:
> I fixed the first issue.
> 
> As for the second, the example is not related to that method, so it should certainly not be the first example there. The correct `factor()`/`_factor_univariate_polynomial()` methods already have a few examples about complex factorization and I don't think that this one was added because it is interesting or tracking a bugfix. I could add it to the univariate `factor()` if you think it should not be lost for unittests.

I agree that it's a bit weird to be the first example, but it is testing something that's probably not tested in the `_factor_univariate_polynomial()` since the polynomial ring there is multivariate (according to Sage, since it's constructed as `PolynomialRing(CC, 1)`, but of course univariate methods will work because mathematically it's a univariate polynomial.  So I don't think the example should be removed, and in fact I think this is the best place for this test, since it's checking a corner case for the multivariate `factor` method.


---

Comment by saraedum created at 2018-01-16 21:51:31

Oh, I did not realize that. I thought that `PolynomialRing(CC, 1)` would actually be backed by the univariate code right away. Thanks for pointing that out.


---

Comment by git created at 2018-01-16 21:54:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2018-01-16 23:05:05

There was an error in your pasting: it cuts off after 1.05.  Also, it should be `is factored` rather than `are factored`.


---

Comment by git created at 2018-01-17 03:11:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-01-17 03:12:36

Sorry, I'll try to review my own commits better next timeâ€¦


---

Comment by roed created at 2018-01-17 03:30:43

There's one more instance of

```
sage: k = GF(4)
sage: k.<a> = GF(4)
```

After that, positive review once tests pass.


---

Comment by git created at 2018-05-14 12:27:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-05-24 22:26:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-05-28 12:02:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-05-28 13:27:26

doctests pass.


---

Comment by saraedum created at 2018-05-28 13:27:26

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-05-29 20:39:40

Resolution: fixed
