# Issue 29590: Upgrade gcc to 9.3

Issue created by migration from https://trac.sagemath.org/ticket/29827

Original creator: mkoeppe

Original creation time: 2020-06-08 15:20:11

CC:  jhpalmieri @zlscherr

We upgrade gcc from 9.2 to 9.3

https://gcc.gnu.org/bugzilla/buglist.cgi?bug_status=RESOLVED&resolution=FIXED&target_milestone=9.3

part of #29703


---

Comment by mkoeppe created at 2020-06-08 23:20:14

New commits:


---

Comment by git created at 2021-03-02 23:08:10

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2021-03-02 23:18:53

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-03-03 01:10:31

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-03-03 01:10:31

Patches need updating

```
gfortran-9.3.0]   Applying patches from ../patches...
  [gfortran-9.3.0]   Applying ../patches/gcc-multilib-multiarch.patch
  [gfortran-9.3.0]   patching file gcc/config/i386/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/mips/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/rs6000/t-linux
  [gfortran-9.3.0]   Hunk #1 succeeded at 2 with fuzz 2.
  [gfortran-9.3.0]   patching file gcc/config/rs6000/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/s390/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/sparc/t-linux64
  [gfortran-9.3.0]   Applying ../patches/homebrew-9.2.0-catalina.patch
  [gfortran-9.3.0]   patching file fixincludes/fixincl.x
  [gfortran-9.3.0]   Hunk #1 FAILED at 2.
  [gfortran-9.3.0]   Hunk #2 FAILED at 15.
  [gfortran-9.3.0]   Hunk #3 succeeded at 2686 (offset 50 lines).
  [gfortran-9.3.0]   Hunk #4 FAILED at 10388.
  [gfortran-9.3.0]   Hunk #5 succeeded at 10558 (offset 100 lines).
  [gfortran-9.3.0]   Hunk #6 succeeded at 11071 (offset 106 lines).
  [gfortran-9.3.0]   3 out of 6 hunks FAILED -- saving rejects to file fixincludes/fixincl.x.rej
  [gfortran-9.3.0]   patching file fixincludes/inclhack.def
  [gfortran-9.3.0]   Hunk #1 succeeded at 1325 (offset 27 lines).
  [gfortran-9.3.0]   Error applying '../patches/homebrew-9.2.0-catalina.patch'
```

https://github.com/mkoeppe/sage/runs/2017617134?check_suite_focus=true


---

Comment by git created at 2021-03-03 19:06:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-03-16 03:42:15

As `@`gh-zlscherr reports in #31326, upgrading to gcc 9.3 does NOT fix the issues on macOS Big Sur.

homebrew:
- uses this patch for GCC 10.2: https://raw.githubusercontent.com/Homebrew/formula-patches/6a83f36d/gcc/bigsur_2.patch
- notes in https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L53: "Patch for Big Sur, remove with GCC 10.3 - https://gcc.gnu.org/bugzilla/show_bug.cgi?id=98805"

Not sure if anyone has a backport to the GCC 9.x series


---

Comment by mkoeppe created at 2021-03-16 04:00:09

I had thought that staying for a while on the GCC 9.x series would be useful - given how many fixes were necessary in packages for the 10.x series, there may still be optional/experimental/user packages that cannot be built with GCC 10.

But it looks like this is not going anywhere, so let's move on and continue in #29703 with an upgrade to 10.x


---

Comment by mkoeppe created at 2021-03-16 04:00:09

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2021-03-16 21:11:23

Sounds okay.


---

Comment by jhpalmieri created at 2021-03-16 21:11:23

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2021-05-28 16:47:30

Resolution: invalid
