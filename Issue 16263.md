# Issue 16263: New recursive constructions of Orthogonal Arrays

Issue created by migration from https://trac.sagemath.org/ticket/16500

Original creator: ncohen

Original creation time: 2014-06-19 15:04:25

CC:  vdelecroix knsam

Here they are ! They have been sitting on my HD for a long time `:-P`

Nathann


---

Comment by ncohen created at 2014-06-19 15:22:41

Changing status from new to needs_review.


---

Comment by git created at 2014-06-19 15:34:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-19 21:20:52

Changing status from needs_review to needs_info.


---

Comment by vdelecroix created at 2014-06-19 21:20:52

EDIT: deleted comment as I messed up ticket numbers...


---

Comment by vdelecroix created at 2014-06-19 21:29:43

(Replying to comment:4) sorry, this comment was for #16430. Not this one!!


---

Comment by vdelecroix created at 2014-06-19 21:29:58

Changing status from needs_info to needs_review.


---

Comment by ncohen created at 2014-06-25 13:58:18

Rebased on top of #16499. But.... 


```
sage -t --long latin_squares.py
    [40 tests, 35.08 s]
```


`T_T`

Nathann


---

Comment by git created at 2014-06-25 13:58:34

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by vdelecroix created at 2014-06-25 14:40:45

Hi Nathann,

Stupid questions to start:
- It would be nice to have references! You provide `[AC07]_` for `construction_3_4` but that's all.
- Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?
- Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)

Vicent


---

Comment by ncohen created at 2014-06-25 14:49:15

Yo !

I updated the "find" functions a bit. Nothing smart, just common sense, and the `MOLS_table` function is fast again. Yeepeeeeeeeeee !!! `:-P`

> - It would be nice to have references! You provide `[AC07]_` for `construction_3_4` but that's all.

Ahahahah. I had nothing else `:-P`

I tried to reverse-engineer the construction from the theorem's claim, and when I was not able too I asked Julian R. Abel for a hint. This being said, the explanations I give in the docstring are more or less like a proof.

> - Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?

Because I thought that it would be abusing your kindness. I waste my health implementing those things, but I still try to makes patches somehow readable so that reviewing them will not be hell for you. I can add a commit for that if you don't mind. As I told you by email, "this is in the plan" `:-P`

> - Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)

Because this function returns both OA and !True/False answers. The `find_*` functions I cached only return immutable stuff.

Nathann


---

Comment by git created at 2014-06-25 14:51:22

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2014-06-25 15:13:22

Replying to [comment:10 ncohen]:
 
> > - Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?
> 
> Because I thought that it would be abusing your kindness. I waste my health implementing those things, but I still try to makes patches somehow readable so that reviewing them will not be hell for you. I can add a commit for that if you don't mind. As I told you by email, "this is in the plan" `:-P`

Ok. Will see that later. I postponed to #16535 if you agree.

> > - Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)
> 
> Because this function returns both OA and !True/False answers. The `find_*` functions I cached only return immutable stuff.

But why not having `orthogonal_array` implements the three lines that are right now in `find_recursive_construction`? My main concern is about readability. I would prefer

```
@cached_method
def find_recursive_construction(k,n):
    for find_c in [find_construction_3_3,
                   find_construction_3_4,
                   find_construction_3_5,
                   find_construction_3_6]:
        res = find_c(k,n)
        if res: return res
```

That way:
- you still have the freedom to update `find_recursive_construction` without touching `orthogonal_array`
- you keep an eye on who did what with the cache
- you perform the work of adapting your answer only in `orthogonal_array`
- if you changed your mind about the syntax `existence=True` and such you will not have to touch to `find_recursive_construction`
- the file `orthogonal_array_recursive.py` will look like a "dynamical" database in the very same way that `database.py` is a static one

Vincent


---

Comment by ncohen created at 2014-06-25 15:25:17

Yo !

> Ok. Will see that later. I postponed to #16535 if you agree.

I will have to rebase what is currently above this patch, then.

Well.... does not matter...

> But why not having `orthogonal_array` implements the three lines that are right now in `find_recursive_construction`? 

Oh, you mean only the part that actually creates the design ? Yeah, why not !...

I will add a commit for that in a second.

Nathann


---

Comment by git created at 2014-06-25 15:32:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-26 09:31:17

Hi,

small commit at `u/vdelecroix/16500`

Be careful that a truncated OA is *not* an incomplete OA. In truncated OA you removed points in columns whereas in incomplete OA you have less blocks than an OA (but columns are not changed)... it is very confusing to read your doc. And moreover you use block or column indifferently but it would be better to have a unique name for that.

In the doc of the construction 3.4 there is

```
- If there exists an `OA(k,m+r+1)` the column of size `s` is truncated in
  order to intersect `B_0`.

- If there exists an `OA(k,m+r+1)`, the last column must not intersect `B_0`
```

which is contradictory!

The rest is fine except that there is no need to use linear programming to build an oval, see #16552.

Vincent


---

Comment by vdelecroix created at 2014-06-26 09:32:29

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2014-06-26 09:58:34

Yo !

> small commit at `u/vdelecroix/16500`

Looks good !

> Be careful that a truncated OA is *not* an incomplete OA. 

Arg yes yes, I always mix the two words `^^;`

And moreover you use block or column indifferently but it would be better to have a unique name for that.

Do you mean "column or group" ? There are `n^2` blocks in an `OA(k,n)` but `k` columns.

> In the doc of the construction 3.4 there is
> {{{
> - If there exists an `OA(k,m+r+1)` the column of size `s` is truncated in
>   order to intersect `B_0`.
> 
> - If there exists an `OA(k,m+r+1)`, the last column must not intersect `B_0`
> }}}
> which is contradictory!

I don't se how `O_o`

> The rest is fine except that there is no need to use linear programming to build an oval, see #16552.

Oh ? Cool. Free ovals ! `:-D`

Nathann


---

Comment by git created at 2014-06-26 09:59:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-06-26 09:59:23

What exactly needs work ?

Nathann


---

Comment by vdelecroix created at 2014-06-26 10:03:03

Replying to [comment:19 ncohen]:
> What exactly needs work ?

the doc of construction 3.4


---

Comment by ncohen created at 2014-06-26 10:04:50

Then please answer my question above : what is wrong in those sentences ?

Nathann


---

Comment by ncohen created at 2014-06-26 10:05:25

Oh. Right.


---

Comment by git created at 2014-06-26 10:08:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-06-26 10:11:49

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2014-06-26 10:21:56

This one was much easier once the Wilson construction is understood!

Do you already did the even more general construction from Brouwer-Rees 1982 (they consider generalization of truncated OA where the extra columns are partitioned in possibly more than two parts)?

Vincent


---

Comment by vdelecroix created at 2014-06-26 10:21:56

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-06-26 10:24:28

Yo !
> This one was much easier once the Wilson construction is understood!

Yep yep. That's what I will remember of design theory. Deadly scary stuff that becomes totally straightforward once you pay attention to it.

Still, a lot of stuff remains deadly scary in the field `:-P`

> Do you already did the even more general construction from Brouwer-Rees 1982 (they consider generalization of truncated OA where the extra columns are partitioned in possibly more than two parts)?

Now yet, but I will have to. What scares me is not the implementation of the construction, but how to properly write the input part of the function `T_T`

Nathann


---

Comment by ncohen created at 2014-06-26 10:30:52

> > This one was much easier once the Wilson construction is understood!

Some smarter comment: I believe that it is thanks to work like the one we do that we can get to understand such things. That's how it happened to me with LP : I had to implement very basic things 1000 times for Sage, and in the end I find myself understanding the basics properly, which would have NEVER happened if I had just had a book in front of me. Or even if it was in Sage's code.

When you implement Sage stuff you are forced to spend time on things you would quickly look at otherwise.

Nathann


---

Comment by vbraun created at 2014-06-26 19:37:07

Resolution: fixed
