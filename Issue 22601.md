# Issue 22601: Upgrade to Pynac-0.7.6

Issue created by migration from https://trac.sagemath.org/ticket/22838

Original creator: rws

Original creation time: 2017-04-20 06:50:22

The Changelog:
* fix test failure with debug version of Singular
* `heaviside` and `unit_step` equivalent to Sage's versions (#10070)
* always return unsigned infinity with `zeta(1.0)` (#19439)
* return symbolic `NaN` in `asin`/`acos` (#22823)
* unconditionally use Singular for resultants (#22364)
* add `ex::free_symbols()` and interface it (#20179)
* Appell F1 improvements

https://github.com/pynac/pynac/releases/download/pynac-0.7.6/pynac-0.7.6.tar.bz2


---

Comment by rws created at 2017-04-20 08:15:37

Changing status from new to needs_review.


---

Comment by rws created at 2017-04-20 08:15:37

New commits:


---

Comment by mforets created at 2017-04-20 09:30:08

i'm getting that it cannot find `pynac-0.7.6.tar.bz2` from mirrors. 

maybe just delay in servers? 

i did `$ git trac checkout 22838 && make="MAKE -j4" make`. 


```
sage-logger -p 'sage-spkg pynac-0.7.6' '/Users/forets/sage-src/sage/logs/pkgs/pynac-0.7.6.log'
[pynac-0.7.6] Found local metadata for pynac-0.7.6
[pynac-0.7.6] Attempting to download package pynac-0.7.6.tar.bz2 from mirrors
[pynac-0.7.6] http://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirrors.fe.up.pt/pub/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.fe.up.pt/pub/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirrors.mit.edu/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.mit.edu/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirror.yandex.ru/mirrors/sage.math.washington.edu/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirror.yandex.ru/mirrors/sage.math.washington.edu/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://sage.mirror.garr.it/mirrors/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sage.mirror.garr.it/mirrors/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://files.sagemath.org/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//files.sagemath.org/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirrors.xmission.com/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://sagemath.mirror.ac.za/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagemath.mirror.ac.za/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirror.ufs.ac.za/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirror.ufs.ac.za/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://www-ftp.lip6.fr/pub/math/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www-ftp.lip6.fr/pub/math/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://ftp.yz.yamagata-u.ac.jp/pub/math/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//ftp.yz.yamagata-u.ac.jp/pub/math/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirror.switch.ch/mirror/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirror.switch.ch/mirror/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://sunsite.rediris.es/mirror/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sunsite.rediris.es/mirror/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://ftp.kaist.ac.kr/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//ftp.kaist.ac.kr/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://linorg.usp.br/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//linorg.usp.br/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://ftp.riken.jp/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//ftp.riken.jp/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://ftp.ntua.gr/pub/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//ftp.ntua.gr/pub/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://ftp.tsukuba.wide.ad.jp/software/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//ftp.tsukuba.wide.ad.jp/software/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirror.aarnet.edu.au/pub/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirror.aarnet.edu.au/pub/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://www.cecm.sfu.ca/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www.cecm.sfu.ca/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://sagemath.polytechnic.edu.na/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagemath.polytechnic.edu.na/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://ftp.leg.uct.ac.za/pub/packages/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//ftp.leg.uct.ac.za/pub/packages/sage/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://sagemath.c3sl.ufpr.br/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagemath.c3sl.ufpr.br/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirrors.ustc.edu.cn/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.ustc.edu.cn/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirrors.tuna.tsinghua.edu.cn/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.tuna.tsinghua.edu.cn/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://mirror.hust.edu.cn/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirror.hust.edu.cn/sagemath/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] http://sagepad.org/spkg/upstream/pynac/pynac-0.7.6.tar.bz2
[pynac-0.7.6] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[pynac-0.7.6] ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/pynac/pynac-0.7.6.tar.bz2'
[pynac-0.7.6] Traceback (most recent call last):
[pynac-0.7.6]   File "/Users/forets/sage-src/sage/build/bin/sage-download-file", line 28, in <module>
[pynac-0.7.6]     run_safe()
[pynac-0.7.6]   File "/Users/forets/sage-src/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 118, in run_safe
[pynac-0.7.6]     run()
[pynac-0.7.6]   File "/Users/forets/sage-src/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 100, in run
[pynac-0.7.6]     app.download_tarball(args.url_or_tarball, args.destination)
[pynac-0.7.6]   File "/Users/forets/sage-src/sage/build/bin/../sage_bootstrap/download/app.py", line 43, in download_tarball
[pynac-0.7.6]     tarball.download()
[pynac-0.7.6]   File "/Users/forets/sage-src/sage/build/bin/../sage_bootstrap/tarball.py", line 161, in download
[pynac-0.7.6]     raise FileNotMirroredError('tarball does not exist on mirror network')
[pynac-0.7.6] sage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network
[pynac-0.7.6] ************************************************************************
[pynac-0.7.6] Error downloading pynac-0.7.6.tar.bz2
[pynac-0.7.6] ************************************************************************
```



---

Comment by rws created at 2017-04-20 10:52:04

The servers get it only after merge and a new Sage release. Download from github into your upstream directory.


---

Comment by tscrim created at 2017-04-20 13:33:08

I did some fixes. The most important is the documentation for `step` was wrong since `SR(0).step() == 1`. I also changed a little nitpick with alignments. If my changes are good, then positive review.
----
New commits:


---

Comment by rws created at 2017-04-20 13:46:49

Thanks!


---

Comment by rws created at 2017-04-20 13:46:49

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-04-22 12:17:03

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-04-22 12:17:03


```
sage -t --long src/sage/tests/gosper-sum.py
**********************************************************************
File "src/sage/tests/gosper-sum.py", line 133, in sage.tests.gosper-sum
Failed example:
    check((4*(1-n) * (n^2-2*n-1) / n^2 / (n+1)^2 / (n-2)^2 / (n-3)^2), n, 4, 10, 20)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.gosper-sum[53]>", line 1, in <module>
        check((Integer(4)*(Integer(1)-n) * (n**Integer(2)-Integer(2)*n-Integer(1)) / n**Integer(2) / (n+Integer(1))**Integer(2) / (n-Integer(2))**Integer(2) / (n-Integer(3))**Integer(2)), n, Integer(4), Integer(10), Integer(20))
      File "<doctest sage.tests.gosper-sum[18]>", line 4, in check
        s1 = ex.gosper_sum(var, val1, symb)
      File "sage/symbolic/expression.pyx", line 6714, in sage.symbolic.expression.Expression.gosper_sum (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/symbolic/expression.cpp:39839)
        x = g_gosper_sum_definite(self._gobj, s._gobj,
    RuntimeError: can't happen in coeff_to_ex
**********************************************************************
File "src/sage/tests/gosper-sum.py", line 134, in sage.tests.gosper-sum
Failed example:
    check(((n^4-14*n^2-24*n-9) * 2^n / n^2 / (n+1)^2 / (n+2)^2 / (n+3)^2), n, 1, 10, 20)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.gosper-sum[54]>", line 1, in <module>
        check(((n**Integer(4)-Integer(14)*n**Integer(2)-Integer(24)*n-Integer(9)) * Integer(2)**n / n**Integer(2) / (n+Integer(1))**Integer(2) / (n+Integer(2))**Integer(2) / (n+Integer(3))**Integer(2)), n, Integer(1), Integer(10), Integer(20))
      File "<doctest sage.tests.gosper-sum[18]>", line 4, in check
        s1 = ex.gosper_sum(var, val1, symb)
      File "sage/symbolic/expression.pyx", line 6714, in sage.symbolic.expression.Expression.gosper_sum (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/symbolic/expression.cpp:39839)
        x = g_gosper_sum_definite(self._gobj, s._gobj,
    RuntimeError: can't happen in coeff_to_ex
**********************************************************************
1 item had failures:
   2 of 101 in sage.tests.gosper-sum
    [100 tests, 2 failures, 23.48 s]
```



---

Comment by rws created at 2017-04-23 06:34:31

This is conflicting with #22090. I'd rather if you hold back #22090 instead of this. Is it possible?


---

Comment by tscrim created at 2017-04-23 06:38:24

It seems like Volker has already merged #22090 into his develop branch. So I wouldn't touch #22090. Also, doesn't #22090 expose a regression in pynac?


---

Comment by rws created at 2017-04-23 06:40:10

Replying to [comment:11 tscrim]:
> Also, doesn't #22090 expose a regression in pynac?

Of course. But I would have liked to be not under time pressure with the fix.


---

Comment by tscrim created at 2017-04-23 06:42:44

You could mark those failing tests as `# known bug` for now.


---

Comment by rws created at 2017-04-23 07:12:55

I can do that only in #22090 because only there the new file with the test case is introduced. But instead of a new release I'll add a patch here.


---

Comment by rws created at 2017-04-23 07:20:33

New commits:


---

Comment by rws created at 2017-04-23 07:20:33

Changing status from needs_work to needs_review.


---

Comment by rws created at 2017-04-23 07:21:46

Changing status from needs_review to needs_work.


---

Comment by rws created at 2017-04-23 07:23:39

New commits:


---

Comment by rws created at 2017-04-23 07:26:46

Changing status from needs_work to needs_review.


---

Comment by rws created at 2017-04-23 07:26:46

New commits:


---

Comment by tscrim created at 2017-04-23 23:59:49

New patch fixes the regression. Thank you.


---

Comment by tscrim created at 2017-04-23 23:59:49

Changing status from needs_review to positive_review.


---

Comment by rws created at 2017-04-24 06:03:53

Thanks again for the review.


---

Comment by vbraun created at 2017-04-27 20:11:50

Resolution: fixed
