# Issue 34366: Fix singular spkg-configure

Issue created by migration from https://trac.sagemath.org/ticket/34603

Original creator: mkoeppe

Original creation time: 2022-09-28 20:54:53

CC:  dimpase mjo

Seen on `archlinux-latest`, https://github.com/FFY00/meson-python/actions/runs/3146686714/jobs/5115498470

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/sbin/Singular
checking for SINGULAR... yes
checking that Singular's help is working... grep: warning: stray \ before white space
./configure: line 43759: test: too many arguments
no
configure: no suitable system package found for SPKG singular

```




---

Comment by dimpase created at 2022-10-01 10:00:07

Does archlinux-latest use some sort of weird `grep` (3.8, the latest version from last month)? The error comes from


```
AS_IF([test x`printf "system(\"--browser\", \"builtin\"); \n help;" | Singular 2>&1 | grep "error\ occurred"` = x], [
```

i.e. `grep` does not understand `"error\ occurred"`.


---

Comment by dimpase created at 2022-10-01 10:09:22

I've built grep 3.8, and indeed, I get a warning:

```
$ /tmp/bin/grep "bla\ baz" t # this is grep 3.8
/tmp/bin/grep: warning: stray \ before white space
bla baz
$ cat t
bla foo
bla baz
$ grep "bla\ baz" t # this is grep 3.6
bla baz
```



---

Comment by dimpase created at 2022-10-01 10:22:11

we can eiher just remove `\` in the pattern, or send the warning to `dev/null`. Not sure what's the best, so I asked:

https://unix.stackexchange.com/questions/719384/the-correct-way-to-deal-with-spaces-in-a-pattern-for-grep


---

Comment by dimpase created at 2022-10-01 10:54:20

It seems we can just remove that `\`. I'll make a branch


---

Comment by dimpase created at 2022-10-01 11:26:55

Changing status from new to needs_review.


---

Comment by dimpase created at 2022-10-01 11:26:55

New commits:


---

Comment by mkoeppe created at 2022-10-01 16:20:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-10-11 09:12:57

Resolution: fixed
