# Issue 34366: Fix singular spkg-configure

archive/issues_034366.json:
```json
{
    "body": "CC:  @dimpase @orlitzky\n\nSeen on `archlinux-latest`, https://github.com/FFY00/meson-python/actions/runs/3146686714/jobs/5115498470\n\n```\nChecking whether SageMath should install SPKG singular...\nchecking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\nchecking for Singular... /usr/sbin/Singular\nchecking for SINGULAR... yes\nchecking that Singular's help is working... grep: warning: stray \\ before white space\n./configure: line 43759: test: too many arguments\nno\nconfigure: no suitable system package found for SPKG singular\n\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34603\n\n",
    "created_at": "2022-09-28T20:54:53Z",
    "labels": [
        "component: build: configure",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Fix singular spkg-configure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34366",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase @orlitzky

Seen on `archlinux-latest`, https://github.com/FFY00/meson-python/actions/runs/3146686714/jobs/5115498470

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/sbin/Singular
checking for SINGULAR... yes
checking that Singular's help is working... grep: warning: stray \ before white space
./configure: line 43759: test: too many arguments
no
configure: no suitable system package found for SPKG singular

```



Issue created by migration from https://trac.sagemath.org/ticket/34603





---

archive/issue_comments_486625.json:
```json
{
    "body": "Does archlinux-latest use some sort of weird `grep` (3.8, the latest version from last month)? The error comes from\n\n\n```\nAS_IF([test x`printf \"system(\\\"--browser\\\", \\\"builtin\\\"); \\n help;\" | Singular 2>&1 | grep \"error\\ occurred\"` = x], [\n```\n\ni.e. `grep` does not understand `\"error\\ occurred\"`.",
    "created_at": "2022-10-01T10:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486625",
    "user": "https://github.com/dimpase"
}
```

Does archlinux-latest use some sort of weird `grep` (3.8, the latest version from last month)? The error comes from


```
AS_IF([test x`printf "system(\"--browser\", \"builtin\"); \n help;" | Singular 2>&1 | grep "error\ occurred"` = x], [
```

i.e. `grep` does not understand `"error\ occurred"`.



---

archive/issue_comments_486626.json:
```json
{
    "body": "I've built grep 3.8, and indeed, I get a warning:\n\n```\n$ /tmp/bin/grep \"bla\\ baz\" t # this is grep 3.8\n/tmp/bin/grep: warning: stray \\ before white space\nbla baz\n$ cat t\nbla foo\nbla baz\n$ grep \"bla\\ baz\" t # this is grep 3.6\nbla baz\n```\n",
    "created_at": "2022-10-01T10:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486626",
    "user": "https://github.com/dimpase"
}
```

I've built grep 3.8, and indeed, I get a warning:

```
$ /tmp/bin/grep "bla\ baz" t # this is grep 3.8
/tmp/bin/grep: warning: stray \ before white space
bla baz
$ cat t
bla foo
bla baz
$ grep "bla\ baz" t # this is grep 3.6
bla baz
```




---

archive/issue_comments_486627.json:
```json
{
    "body": "we can eiher just remove `\\` in the pattern, or send the warning to `dev/null`. Not sure what's the best, so I asked:\n\nhttps://unix.stackexchange.com/questions/719384/the-correct-way-to-deal-with-spaces-in-a-pattern-for-grep",
    "created_at": "2022-10-01T10:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486627",
    "user": "https://github.com/dimpase"
}
```

we can eiher just remove `\` in the pattern, or send the warning to `dev/null`. Not sure what's the best, so I asked:

https://unix.stackexchange.com/questions/719384/the-correct-way-to-deal-with-spaces-in-a-pattern-for-grep



---

archive/issue_comments_486628.json:
```json
{
    "body": "It seems we can just remove that `\\`. I'll make a branch",
    "created_at": "2022-10-01T10:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486628",
    "user": "https://github.com/dimpase"
}
```

It seems we can just remove that `\`. I'll make a branch



---

archive/issue_comments_486629.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486629",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_486630.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486630",
    "user": "https://github.com/dimpase"
}
```

New commits:



---

archive/issue_comments_486631.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-01T16:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486631",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_486632.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-10-11T09:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34366#issuecomment-486632",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_030856.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2022-10-11T09:12:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34366",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34366#event-30856"
}
```
