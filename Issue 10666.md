# Issue 10666: IPython.CrashHandler import error upon starting sage

Issue created by migration from https://trac.sagemath.org/ticket/10729

Original creator: jorges

Original creation time: 2011-02-02 15:22:30

CC:  vbraun

Local modules located in $HOME/.local/lib/pythonX.Y/site-packages appear in sys.path _before_ IPython/Extensions and thus, a local version of IPython (lacking CrahsHandler module) replaces sage's own version.

Issue discussed in sage-support, see https://groups.google.com/d/topic/sage-support/mjRgMERg02Y/discussion



---

Attachment

Example sys.path where local modules come before than sage's own modules


---

Comment by jorges created at 2011-02-03 11:20:34

I just found a workaround to this issue. It doesn't actually solve the bug, but it might be usefull to someone experiencing this:

Citing [1]_: "In addition to the global site-packages paths, site is responsible for adding the user-specific locations to the import path. The user-specific paths are all based on the USER_BASE directory, which usually located in a part of the filesystem owned (and writable) by the current user. Inside the USER_BASE is a site-packages directory, with the path accessible as USER_SITE. The USER_SITE path name is created using the same platform-specific values..."
"The user base directory can be set through the PYTHONUSERBASE environment variable, and has platform-specific defaults (~/Python$version/site-packages for Windows and ~/.local for non-Windows)."

Setting PYTHONUSERBASE to a "dummy" location, i.e. an empty directory, prevents python from loading the modules from, say, ~/.local/... which conflict with sage's own.

.. [1] http://www.doughellmann.com/PyMOTW/site/#user-directories


The user base directory can be set through the PYTHONUSERBASE environment variable, and has platform-specific defaults (~/Python$version/site-packages for Windows and ~/.local for non-Windows).


---

Comment by mkoeppe created at 2021-12-02 00:42:51

outdated, should close


---

Comment by mkoeppe created at 2021-12-02 00:42:51

Changing status from new to needs_review.


---

Comment by dimpase created at 2021-12-03 09:35:23

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-12-03 18:41:01

Resolution: invalid
