# Issue 17199: fix bug with leading zeros in Necklaces

Issue created by migration from Trac.

Original creator: zabrocki

Original creation time: 2014-12-03 02:06:35

CC:  tscrim

Keywords: necklace, Lyndon words

Leading zeros in the input are not currently handled properly in `Necklaces`.  This was already corrected in `LyndonWords` in #12997 which calls the code in necklace.py and removes leading zeros.

The documentation in necklace.py should also be cleaned up to current standards.


---

Comment by zabrocki created at 2014-12-03 02:34:07

There seem to be minor bugs that one would not necessarily pick up on except by reading the code closely.  For example:

```
sage: Necklaces([1,0,1]).list()[0]
[1, 3]
sage: Necklaces([1,1]).list()[0] in Necklaces([1,1])
True
sage: Necklaces([1,0,1]).list()[0] in Necklaces([1,0,1])
False
```

The reason is that implicitly the code is assuming that there are no zeros in the content/evaluation vector and it checks if the value of the entries in the necklace smaller or equal to the size of the necklace.  If that check fails it returns False.


---

Comment by zabrocki created at 2014-12-03 15:33:27

New commits:


---

Comment by zabrocki created at 2014-12-03 15:37:18

Changing status from new to needs_review.


---

Comment by git created at 2014-12-03 15:46:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-12-04 00:29:59

Looks good overall. I made some additional doc tweaks and some (micro-)optimizations:

```
sage: x = 0
sage: %timeit if not x: pass
10000000 loops, best of 3: 105 ns per loop
sage: %timeit if x: pass
10000000 loops, best of 3: 89.7 ns per loop
sage: %timeit if x == 0: pass
1000000 loops, best of 3: 429 ns per loop
sage: %timeit if x != 0: pass
1000000 loops, best of 3: 418 ns per loop
sage: x = int(0)
sage: %timeit if not x: pass
10000000 loops, best of 3: 105 ns per loop
sage: %timeit if x: pass
10000000 loops, best of 3: 89.7 ns per loop
sage: y = int(0)
sage: %timeit if x != y: pass
10000000 loops, best of 3: 141 ns per loop
sage: %timeit if x == y: pass
10000000 loops, best of 3: 158 ns per loop
```

(similar timings for the list comparisons). Most importantly, I deprecated the `e` attribute and changed `content` into a method calling `_content` attribute (since it is suppose to be immutable). If you're happy with my changes, then positive review.
----
New commits:


---

Comment by zabrocki created at 2014-12-04 00:48:27

I didn't even think of deprecating `e`.  Thats covering your bases.  I think your changes look great.  Thanks for the review/cleanup.


---

Comment by zabrocki created at 2014-12-04 00:48:27

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-12-04 16:12:04

Resolution: fixed
