# Issue 20067: More error checking in MixedIntegerLinearProgram

Issue created by migration from https://trac.sagemath.org/ticket/20304

Original creator: mkoeppe

Original creation time: 2016-03-27 01:37:38

CC:  dimpase ncohen




---

Comment by mkoeppe created at 2016-03-27 01:59:23

The `get_values` method silently ignored non-variables.
----
New commits:


---

Comment by mkoeppe created at 2016-03-27 01:59:23

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2016-03-27 01:59:23

Changing type from PLEASE CHANGE to defect.


---

Comment by mkoeppe created at 2016-03-27 01:59:23

Changing keywords from "" to "lp".


---

Comment by mkoeppe created at 2016-03-27 01:59:23

Changing component from PLEASE CHANGE to numerical.


---

Comment by vdelecroix created at 2016-03-29 02:14:44

Please use new style error `ValueError(msg)` instead of `ValueError, msg` (Python 3 compatibility).

Would be better to use repr rather than str. The output of `"{!r}".format(l)` is nicer than `str(l)`. As you can see

```
sage: l = 1
sage: str(l)
'1'
sage: "{!r}".format(l)
'1'
sage: l = '1'
sage: str(l)
'1'
sage: "{!r}".format(l)
"'1'"
```


The following are not caught correctly

```
sage: M1 = MixedIntegerLinearProgram()
sage: M2 = MixedIntegerLinearProgram()
sage: x = M1.new_variable()
sage: y = M1.new_variable()
sage: z = M2.new_variable()
sage: M2.add_constraint(z[0] <= 5)
sage: M2.solve()
0.0
sage: M2.get_values(x)              # should be a ValueError
Traceback (most recent call last):
...
KeyError: x_0
sage: M2.get_values(y)              # should be a ValueError
{}
```



---

Comment by vdelecroix created at 2016-03-29 02:14:44

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2016-03-29 02:15:16

And if the input is not a variable it would be better to raise a `TypeError` rather than a `ValueError`.


---

Comment by git created at 2016-03-29 02:35:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-03-29 02:51:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-03-29 02:52:38

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2016-03-29 03:09:29

Nice.

Last thing: the first error should be a `ValueError`. The type is indeed the good one!


---

Comment by mkoeppe created at 2016-03-29 03:11:31

Should I then make it a `ValueError` also when it's a string, but not one that names a variable?
(If so, what's the right way to test if it is a string?)


---

Comment by vdelecroix created at 2016-03-29 03:15:36

Replying to [comment:10 mkoeppe]:
> Should I then make it a `ValueError` also when it's a string, but not one that names a variable?
> (If so, what's the right way to test if it is a string?)

Not necessarily (one can assume that the "good" way of calling this function is with a MIP variable). Though, to test if the object `x` is a string you can use `isinstance(x, str)` (which returns a boolean).


---

Comment by mkoeppe created at 2016-03-29 03:39:29

I was confused, it actually does not accept strings -- only MIPVariable objects.


---

Comment by git created at 2016-03-29 03:40:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-03-29 12:57:10

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2016-03-30 04:04:03

Thanks for reviewing!


---

Comment by vbraun created at 2016-03-30 14:05:43

Resolution: fixed
