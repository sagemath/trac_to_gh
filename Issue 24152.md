# Issue 24152: Upgrade IPython

Issue created by migration from https://trac.sagemath.org/ticket/24389

Original creator: vbraun

Original creation time: 2017-12-16 13:43:34

CC:  â€‹slelievre fbissey




---

Comment by vbraun created at 2017-12-16 15:49:35

Changing component from PLEASE CHANGE to notebook.


---

Comment by vbraun created at 2017-12-16 15:49:35

Changing type from PLEASE CHANGE to defect.


---

Comment by fbissey created at 2017-12-16 19:21:00

Related because it will supercede it: #23125. There are things that will probably still be relevant in that issue.


---

Comment by vbraun created at 2017-12-17 14:18:10

Changing status from new to needs_review.


---

Comment by vbraun created at 2017-12-17 14:18:10

New commits:


---

Comment by vbraun created at 2017-12-17 14:20:00

Attached branch fixes the issue from #24389


---

Comment by jdemeyer created at 2017-12-17 18:01:44

Does this _require_ an upgrade of widgetsnbextension or did you just upgrade for the sake of upgrading? I'm asking because widgetsnbextension might need to be synchronized with ipywidgets.


---

Comment by git created at 2017-12-17 19:42:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2017-12-17 19:44:01

I guess we should also update ipywidgets to the latests release. I was trying to update all ipy/jupyter stuff, I haven't really tried to figure out whether anything breaks if we don't update it together. At least the widgets that I tried did still work...


---

Comment by fbissey created at 2017-12-17 20:05:10

Replying to [comment:8 vbraun]:
> I guess we should also update ipywidgets to the latests release. I was trying to update all ipy/jupyter stuff, I haven't really tried to figure out whether anything breaks if we don't update it together. At least the widgets that I tried did still work...

Well there is #23177 about `ipywidgets` and Jeroen and I haven't done anything about the problems it triggers so far.


---

Comment by fbissey created at 2017-12-17 20:24:07

Other than that, I am happy with the fix to `forker.py`, it fixes my doctest.


---

Comment by vbraun created at 2017-12-17 21:36:56

You could have told me about #23177 straight away... I'll try to leave widgetsnbextension/ipywidgets at the old version, then.


---

Comment by git created at 2017-12-17 22:03:34

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vbraun created at 2017-12-17 23:19:07

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2017-12-21 00:59:17

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2017-12-21 01:11:12

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2017-12-21 01:11:12

I was not sure why it did go back to "needs work". Looks good to me.


---

Comment by vbraun created at 2017-12-25 18:21:32

Resolution: fixed


---

Comment by embray created at 2018-01-02 14:14:46

This caused build failures on Cygwin, but was merged anyways: https://patchbot.sagemath.org/log/24389/CYGWIN_NT-10.0/2017-04-01%2020:47/x86_64/2.8.0(0.309/5/3)/windows-10-prof/2017-12-17%2022:15:15


---

Comment by embray created at 2018-01-04 16:30:56

Replying to [comment:17 embray]:
> This caused build failures on Cygwin, but was merged anyways: https://patchbot.sagemath.org/log/24389/CYGWIN_NT-10.0/2017-04-01%2020:47/x86_64/2.8.0(0.309/5/3)/windows-10-prof/2017-12-17%2022:15:15

That said, I can't seem to reproduce this problem locally.  It's _only_ happening on the patchbot, which is very strange.  Though it's definitely this ticket where it started breaking.  I'm not sure what's different between the Sage checkout on the patchbot versus the one I have locally.


---

Comment by embray created at 2018-01-04 16:33:27

I see now; it was an issue with permissions.


---

Comment by embray created at 2018-01-04 16:46:08

There's still kind of a bug here, though not really originating from this ticket (it only started here because the `entrypoints` package was upgraded).

The problem is that our entrypoints package has a custom `setup.py` that imports from the package itself at build/install time.  This fails if the build directory's permissions are not proper due to Jeroen's patch to Python that disallows `''` to be in `sys.path`.  Since not having correct permissions effectively kills the Sage build I'd suggest that's a bug, even if the solution is still some kind of permissions enforcement, but earlier in the build process.  I'll open a new ticket.


---

Comment by slelievre created at 2018-01-05 18:14:14

(Adding list of updates to ticket description.)
