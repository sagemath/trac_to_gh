# Issue 10864: Fan morphism fails on not full-dimensional fans

Issue created by migration from https://trac.sagemath.org/ticket/10943

Original creator: novoselt

Original creation time: 2011-03-16 02:28:07

Assignee: mhampton

CC:  vbraun

For example:

```
sage: Sigma = Fan(rays=[(1,1,0), (1,-1,0)], cones=[(0,1)])
sage: Sigma_prime = FaceFan(lattice_polytope.octahedron(3))
sage: FanMorphism(identity_matrix(3), Sigma, Sigma_prime, subdivide=True, verbose=True)
Placing ray images... 0.841 ms
Computing chambers... 0.806 ms
Subdividing cone 1 of 1... 0.172 ms
Checking for missing pieces... 
Traceback (most recent call last):
...
IndexError: list assignment index out of range
```

The problem is that the source cone intersects four target ones, but there are only two different intersections. I will post a fix soon.


---

Attachment


---

Comment by novoselt created at 2011-03-16 04:46:27

OK, I rewrote related code to make it a little more clear, but basically I just added check for repeated intersections.


---

Comment by novoselt created at 2011-03-16 04:46:27

Changing status from new to needs_review.


---

Comment by novoselt created at 2011-03-20 19:14:00

Changing assignee from mhampton to novoselt.


---

Attachment

Apply this patch only


---

Comment by vbraun created at 2011-05-05 11:31:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2011-05-05 11:31:51

Looks good!


---

Comment by jdemeyer created at 2011-05-27 12:01:58

Resolution: fixed
