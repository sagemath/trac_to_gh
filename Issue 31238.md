# Issue 31238: 1 internet doctest failing in src/sage/tests/cmdline.py

Issue created by migration from https://trac.sagemath.org/ticket/31475

Original creator: slabbe

Original creation time: 2021-03-09 16:22:47

CC:  slelievre tmonteil mkauers mmezzarobba

On Ubuntu 18.04, running `SageMath version 9.3.beta8, Release Date: 2021-03-07`, the command


```
sage -t --optional=sage,internet src/sage/tests/cmdline.py
```

gives

```
sage -t --warn-long 74.8 --random-seed=0 src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 606, in sage.tests.cmdline.test_executable
Failed example:
    err  # optional - internet
Expected:
    ''
Got:
    '/home/slabbe/GitBox/sage/local/lib/python3.8/site-packages/sage/misc/package.py:114: UserWarning: failed to fetch the version of pkg=\'ore_algebra\' at https://pypi.org/pypi/ore_algebra/json\n  warnings.warn("failed to fetch the version of pkg={!r} at {}".format(pkg, url))\n'
**********************************************************************
1 item had failures:
   1 of 229 in sage.tests.cmdline.test_executable
    [228 tests, 1 failure, 28.69 s]
----------------------------------------------------------------------
sage -t --warn-long 74.8 --random-seed=0 src/sage/tests/cmdline.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

Comment by slabbe created at 2021-03-09 16:30:20

Salut Samuel, ça ressemble à du code qu'on avait changé dans un autre ticket. Ça te dit quelque chose?


---

Comment by mkoeppe created at 2021-03-09 17:55:24

This can be fixed by convincing the author of the `ore_algebra` package to make a proper release on PyPI and then updating `build/pkgs/ore_algebra/requirements.txt`


---

Comment by tmonteil created at 2021-03-09 18:28:16

Replying to [comment:5 mkoeppe]:
> This can be fixed by convincing the author of the `ore_algebra` package to make a proper release on PyPI and then updating `build/pkgs/ore_algebra/requirements.txt`

Let me add them in CC.

We could also stop assuming that pip installed package come from PyPI, which offers more flexibility to downstream.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.
