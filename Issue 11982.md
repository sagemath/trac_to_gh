# Issue 11982: broken doctests in magma.py for integers in QQ and conversion of number field elements

Issue created by migration from https://trac.sagemath.org/ticket/12154

Original creator: mstreng

Original creation time: 2011-12-14 13:45:24

Assignee: was

In 4.7.2, I get

```
        sage -t -only-optional=magma devel/sage/sage/schemes/elliptic_curves/ell_generic.py # 1 doctests failed
        sage -t -only-optional=magma devel/sage/sage/schemes/plane_conics/con_field.py # 1 doctests failed
        sage -t -only-optional=magma devel/sage/sage/interfaces/magma.py # 11 doctests failed
        sage -t -only-optional=magma devel/sage/sage/rings/polynomial/multi_polynomial.pyx # 1 doctests failed
```


Most of these are because 1 in QQ is now converted to Magma as "1/1" instead of "1". The other one is a simple Sage error introduced in #11580 (x is redefined as a variable in a multivariate polynomial ring and then used again as if this never happened).


---

Comment by mstreng created at 2011-12-14 13:46:29

See also [http://groups.google.com/group/sage-release/browse_thread/thread/dea19a0a4a154740](http://groups.google.com/group/sage-release/browse_thread/thread/dea19a0a4a154740)


---

Comment by mstreng created at 2011-12-14 15:19:24

I'm writing a patch.

Apparently some breaking of magma doctests went unnoticed in both #6329 and #11580.


---

Comment by mstreng created at 2011-12-14 15:50:44

Another cause of failures is conversion via `_repr_`, which is the default, but is quite unstable, as variable names are sometimes already initialized in Magma, so I will remove that from relative number field elements.


---

Attachment


---

Comment by mstreng created at 2011-12-14 20:53:28

Changing status from new to needs_review.


---

Comment by mstreng created at 2011-12-14 20:53:28

Changing keywords from "" to "magma interface, doctest, rational, relative number field".


---

Comment by mstreng created at 2012-02-09 10:19:19

Changing status from needs_review to needs_work.


---

Comment by mstreng created at 2012-02-09 10:19:19

The new `_magma_init_` in `number_field_element.pyx` gives me "1 out of 1 hunks FAILED"


---

Comment by mstreng created at 2012-02-14 14:25:37

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2012-02-27 11:29:49

Resolution: duplicate
