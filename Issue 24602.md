# Issue 24602: detail in weight space

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2018-02-26 14:08:20

CC:  jdemeyer embray

changing some sums that cause issue when using python3


---

Comment by chapoton created at 2018-02-26 14:09:21

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-02-26 14:09:21

New commits:


---

Comment by chapoton created at 2018-02-26 14:10:32

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-02-26 14:10:32

this is not fixing the issue..


---

Comment by chapoton created at 2018-02-26 14:12:38


```


---

Comment by chapoton created at 2018-03-14 16:33:42

Changing status from needs_work to needs_info.


---

Comment by chapoton created at 2018-03-14 16:33:42

Similar issue here under python3:

```
sage: d = DisjointSet(4)
sage: list(d)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-d0c0da2e41ad> in <module>()
----> 1 list(d)

TypeError: iter() returned non-iterator of type 'dict_values'
```

where the code is

```
return (<dict?>self.root_to_elements_dict()).itervalues()
```

that under python2 returns

```
sage: d = DisjointSet(4)
sage: iter(d)
<dictionary-valueiterator object at 0x7f0306d3f578>
```



---

Comment by chapoton created at 2018-03-14 16:36:19

Changing component from combinatorics to python3.


---

Comment by jdemeyer created at 2018-03-14 19:20:24

Sigh... I guess it has to be `iter(dict.itervalues())` or `yield from dict.itervalues()` but I guess that the former will be faster.


---

Comment by chapoton created at 2018-03-14 19:45:16

Eurk. Ugly enough, indeed. No hope that Cython could do that for us ?

How to find all instances of this problem ? Maybe by looking for pyx files containing both `__iter__` and `.iter[a-z]` ?


---

Comment by chapoton created at 2018-03-14 19:57:14

Potential list

```
crypto/boolean_function.pyx (✓)
libs/gap/element.pyx
algebras/letterplace/free_algebra_element_letterplace.pyx
algebras/lie_algebras/lie_algebra_element.pyx
plot/plot3d/index_face_set.pyx
ext/fast_eval.pyx
numerical/linear_functions.pyx
misc/weak_dict.pyx
rings/polynomial/polydict.pyx
rings/polynomial/laurent_polynomial.pyx
rings/polynomial/pbori.pyx
rings/polynomial/multi_polynomial.pyx
rings/polynomial/polynomial_element.pyx
rings/power_series_mpoly.pyx
sets/disjoint_set.pyx (todo)
quivers/algebra_elements.pyx (✓)
modules/with_basis/indexed_element.pyx
symbolic/expression.pyx
```


found using

```
grep -l "def.*__iter__" $(grep -l -R "\.iter[ivk]" --include=*.pyx)
```



---

Comment by jdemeyer created at 2018-03-14 20:01:44

There is no need to fix everything on one ticket. In any case, doctests will show what is broken.


---

Comment by git created at 2018-03-14 20:15:41

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2018-03-14 20:16:25

ok, let us content ourselves here with 3 changes


---

Comment by chapoton created at 2018-03-14 20:16:25

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2018-03-15 08:06:52

bot is green


---

Comment by chapoton created at 2018-03-28 13:32:22

ping ?


---

Comment by embray created at 2018-03-28 14:15:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-05-09 09:49:51

Resolution: fixed
