# Issue 24602: detail in weight space

archive/issues_024602.json:
```json
{
    "body": "CC:  jdemeyer embray\n\nchanging some sums that cause issue when using python3\n\nIssue created by migration from https://trac.sagemath.org/ticket/24839\n\n",
    "created_at": "2018-02-26T14:08:20Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "detail in weight space",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24602",
    "user": "chapoton"
}
```
CC:  jdemeyer embray

changing some sums that cause issue when using python3

Issue created by migration from https://trac.sagemath.org/ticket/24839





---

archive/issue_comments_345128.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-26T14:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345128",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_345129.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-02-26T14:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345129",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_345130.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-26T14:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345130",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_345131.json:
```json
{
    "body": "this is not fixing the issue..",
    "created_at": "2018-02-26T14:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345131",
    "user": "chapoton"
}
```

this is not fixing the issue..



---

archive/issue_comments_345132.json:
```json
{
    "body": "\n```",
    "created_at": "2018-02-26T14:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345132",
    "user": "chapoton"
}
```


```



---

archive/issue_comments_345133.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2018-03-14T16:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345133",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_345134.json:
```json
{
    "body": "Similar issue here under python3:\n\n```\nsage: d = DisjointSet(4)\nsage: list(d)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-d0c0da2e41ad> in <module>()\n----> 1 list(d)\n\nTypeError: iter() returned non-iterator of type 'dict_values'\n```\n\nwhere the code is\n\n```\nreturn (<dict?>self.root_to_elements_dict()).itervalues()\n```\n\nthat under python2 returns\n\n```\nsage: d = DisjointSet(4)\nsage: iter(d)\n<dictionary-valueiterator object at 0x7f0306d3f578>\n```\n",
    "created_at": "2018-03-14T16:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345134",
    "user": "chapoton"
}
```

Similar issue here under python3:

```
sage: d = DisjointSet(4)
sage: list(d)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-d0c0da2e41ad> in <module>()
----> 1 list(d)

TypeError: iter() returned non-iterator of type 'dict_values'
```

where the code is

```
return (<dict?>self.root_to_elements_dict()).itervalues()
```

that under python2 returns

```
sage: d = DisjointSet(4)
sage: iter(d)
<dictionary-valueiterator object at 0x7f0306d3f578>
```




---

archive/issue_comments_345135.json:
```json
{
    "body": "Changing component from combinatorics to python3.",
    "created_at": "2018-03-14T16:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345135",
    "user": "chapoton"
}
```

Changing component from combinatorics to python3.



---

archive/issue_comments_345136.json:
```json
{
    "body": "Sigh... I guess it has to be `iter(dict.itervalues())` or `yield from dict.itervalues()` but I guess that the former will be faster.",
    "created_at": "2018-03-14T19:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345136",
    "user": "jdemeyer"
}
```

Sigh... I guess it has to be `iter(dict.itervalues())` or `yield from dict.itervalues()` but I guess that the former will be faster.



---

archive/issue_comments_345137.json:
```json
{
    "body": "Eurk. Ugly enough, indeed. No hope that Cython could do that for us ?\n\nHow to find all instances of this problem ? Maybe by looking for pyx files containing both `__iter__` and `.iter[a-z]` ?",
    "created_at": "2018-03-14T19:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345137",
    "user": "chapoton"
}
```

Eurk. Ugly enough, indeed. No hope that Cython could do that for us ?

How to find all instances of this problem ? Maybe by looking for pyx files containing both `__iter__` and `.iter[a-z]` ?



---

archive/issue_comments_345138.json:
```json
{
    "body": "Potential list\n\n```\ncrypto/boolean_function.pyx (\u2713)\nlibs/gap/element.pyx\nalgebras/letterplace/free_algebra_element_letterplace.pyx\nalgebras/lie_algebras/lie_algebra_element.pyx\nplot/plot3d/index_face_set.pyx\next/fast_eval.pyx\nnumerical/linear_functions.pyx\nmisc/weak_dict.pyx\nrings/polynomial/polydict.pyx\nrings/polynomial/laurent_polynomial.pyx\nrings/polynomial/pbori.pyx\nrings/polynomial/multi_polynomial.pyx\nrings/polynomial/polynomial_element.pyx\nrings/power_series_mpoly.pyx\nsets/disjoint_set.pyx (todo)\nquivers/algebra_elements.pyx (\u2713)\nmodules/with_basis/indexed_element.pyx\nsymbolic/expression.pyx\n```\n\n\nfound using\n\n```\ngrep -l \"def.*__iter__\" $(grep -l -R \"\\.iter[ivk]\" --include=*.pyx)\n```\n",
    "created_at": "2018-03-14T19:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345138",
    "user": "chapoton"
}
```

Potential list

```
crypto/boolean_function.pyx (✓)
libs/gap/element.pyx
algebras/letterplace/free_algebra_element_letterplace.pyx
algebras/lie_algebras/lie_algebra_element.pyx
plot/plot3d/index_face_set.pyx
ext/fast_eval.pyx
numerical/linear_functions.pyx
misc/weak_dict.pyx
rings/polynomial/polydict.pyx
rings/polynomial/laurent_polynomial.pyx
rings/polynomial/pbori.pyx
rings/polynomial/multi_polynomial.pyx
rings/polynomial/polynomial_element.pyx
rings/power_series_mpoly.pyx
sets/disjoint_set.pyx (todo)
quivers/algebra_elements.pyx (✓)
modules/with_basis/indexed_element.pyx
symbolic/expression.pyx
```


found using

```
grep -l "def.*__iter__" $(grep -l -R "\.iter[ivk]" --include=*.pyx)
```




---

archive/issue_comments_345139.json:
```json
{
    "body": "There is no need to fix everything on one ticket. In any case, doctests will show what is broken.",
    "created_at": "2018-03-14T20:01:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345139",
    "user": "jdemeyer"
}
```

There is no need to fix everything on one ticket. In any case, doctests will show what is broken.



---

archive/issue_comments_345140.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-14T20:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345140",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_345141.json:
```json
{
    "body": "ok, let us content ourselves here with 3 changes",
    "created_at": "2018-03-14T20:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345141",
    "user": "chapoton"
}
```

ok, let us content ourselves here with 3 changes



---

archive/issue_comments_345142.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-03-14T20:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345142",
    "user": "chapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_345143.json:
```json
{
    "body": "bot is green",
    "created_at": "2018-03-15T08:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345143",
    "user": "chapoton"
}
```

bot is green



---

archive/issue_comments_345144.json:
```json
{
    "body": "ping ?",
    "created_at": "2018-03-28T13:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345144",
    "user": "chapoton"
}
```

ping ?



---

archive/issue_comments_345145.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-28T14:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345145",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_345146.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-09T09:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24602#issuecomment-345146",
    "user": "vbraun"
}
```

Resolution: fixed
