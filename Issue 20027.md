# Issue 20027: Hasse-Weil Zeta function of a superelliptic curve over finite fields.

archive/issues_020027.json:
```json
{
    "body": "CC:  @alexjbest\n\nKeywords: days71\n\nWe plan to add code to compute the Hasse-Weil Zeta function of a superelliptic curve over finite fields using p-adic methods.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20264\n\n",
    "created_at": "2016-03-23T17:58:29Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Hasse-Weil Zeta function of a superelliptic curve over finite fields.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20027",
    "user": "https://github.com/edgarcosta"
}
```
CC:  @alexjbest

Keywords: days71

We plan to add code to compute the Hasse-Weil Zeta function of a superelliptic curve over finite fields using p-adic methods.

Issue created by migration from https://trac.sagemath.org/ticket/20264





---

archive/issue_comments_275604.json:
```json
{
    "body": "Changing keywords from \"days71\" to \"days71, sd87\".",
    "created_at": "2017-07-17T17:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275604",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "days71" to "days71, sd87".



---

archive/issue_comments_275605.json:
```json
{
    "body": "Changing keywords from \"days71, sd87\" to \"days71, sd87, days88\".",
    "created_at": "2017-08-22T21:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275605",
    "user": "https://github.com/edgarcosta"
}
```

Changing keywords from "days71, sd87" to "days71, sd87, days88".



---

archive/issue_events_055012.json:
```json
{
    "actor": "https://github.com/edgarcosta",
    "created_at": "2018-05-30T00:43:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55012"
}
```



---

archive/issue_comments_275606.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-01T20:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275606",
    "user": "https://github.com/edgarcosta"
}
```

New commits:



---

archive/issue_comments_275607.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2018-06-01T20:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275607",
    "user": "https://github.com/edgarcosta"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_275608.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-01T20:46:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275608",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275609.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-06-01T20:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275609",
    "user": "https://github.com/edgarcosta"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_events_055013.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55013"
}
```



---

archive/issue_events_055014.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55014"
}
```



---

archive/issue_comments_275610.json:
```json
{
    "body": "update milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275610",
    "user": "https://github.com/videlec"
}
```

update milestone 8.3 -> 8.4



---

archive/issue_comments_275611.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2018-11-26T14:54:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275611",
    "user": "https://github.com/alexjbest"
}
```

Last 10 new commits:



---

archive/issue_events_055015.json:
```json
{
    "actor": "https://github.com/alexjbest",
    "created_at": "2018-11-26T14:56:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55015"
}
```



---

archive/issue_events_055016.json:
```json
{
    "actor": "https://github.com/alexjbest",
    "created_at": "2018-11-26T14:56:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55016"
}
```



---

archive/issue_comments_275612.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2018-12-12T22:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275612",
    "user": "https://github.com/edgarcosta"
}
```

Last 10 new commits:



---

archive/issue_comments_275613.json:
```json
{
    "body": "This is looking pretty good now to me, so I intend to mark this as positive review once #25366 is reviewed.",
    "created_at": "2018-12-13T02:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275613",
    "user": "https://github.com/alexjbest"
}
```

This is looking pretty good now to me, so I intend to mark this as positive review once #25366 is reviewed.



---

archive/issue_comments_275614.json:
```json
{
    "body": "Vishal Arul spotted some bugs.\n\n```\nsage: %time CyclicCover(11, PolynomialRing(GF(1129), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial()\nCPU times: user 16.1 s, sys: 124 ms, total: 16.3 s\nWall time: 16.5 s\nx^40 + 7337188909826596*x^30 + 3818873571673594702967652840943135*x^20 + 24687045654725446027864774006541463602997309796*x^10 + 11320844849639649951608809973589776933203136765026963553258401\n```\nSo the discrepancy is in the `t^20` coefficient -- Minzlaff's code says it is\n\n```\n20187877911930897108199045855206 = 6 * 1129^10\n```\nwhile the current code says it is\n\n```\n3818873571673594702967652840943135 = 6 * 1129^10 + 1129^11.\n```\nthe difference is exactly 1129^11. So it does look like some kind of precision error...\n\nMy bet is that error is either in working precision or the code to lift characteristic polynomial to ZZ\n\n\nAnother bug, that seems to be related with precision when using the slow method\n\n```\nsage: CyclicCover(3, PolynomialRing(GF(1009), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial()\nx^8 + 266*x^6 - 1474149*x^4 + 270809546*x^2 + 1036488922561\nsage: CyclicCover(3, PolynomialRing(GF(1009**2), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial()\nx^8 + 1045817316825941*x^7 + 546866930086505850133464526551*x^6 + 190640968494636702312197540239024924597536618*x^5 + 49843906537040069873392691186784704861320520036908736885312*x^4 + 194087947845988228526704383964086734259184677590058*x^3 + 566821515149604163130057985174959967417111*x^2 + 1103577471286158480607964750564981*x + 1074309286591662654798721\n```\n\nIt looks like the frobenius polynomial for GF(1009) is correct, but it is not correct for `GF(1009**2)`. Comparing with Minzlaff's code, the right frobenius polynomial for `GF(1009**2)` should be \n\n```\nx^8 + 532*x^7 - 2877542*x^6 - 242628176*x^5 + 4390163797795*x^4 - 247015136050256*x^3 - 2982540407204025062*x^2 + 561382189105547134612*x + 1074309286591662654798721\n```",
    "created_at": "2019-06-03T20:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275614",
    "user": "https://github.com/edgarcosta"
}
```

Vishal Arul spotted some bugs.

```
sage: %time CyclicCover(11, PolynomialRing(GF(1129), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial()
CPU times: user 16.1 s, sys: 124 ms, total: 16.3 s
Wall time: 16.5 s
x^40 + 7337188909826596*x^30 + 3818873571673594702967652840943135*x^20 + 24687045654725446027864774006541463602997309796*x^10 + 11320844849639649951608809973589776933203136765026963553258401
```
So the discrepancy is in the `t^20` coefficient -- Minzlaff's code says it is

```
20187877911930897108199045855206 = 6 * 1129^10
```
while the current code says it is

```
3818873571673594702967652840943135 = 6 * 1129^10 + 1129^11.
```
the difference is exactly 1129^11. So it does look like some kind of precision error...

My bet is that error is either in working precision or the code to lift characteristic polynomial to ZZ


Another bug, that seems to be related with precision when using the slow method

```
sage: CyclicCover(3, PolynomialRing(GF(1009), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial()
x^8 + 266*x^6 - 1474149*x^4 + 270809546*x^2 + 1036488922561
sage: CyclicCover(3, PolynomialRing(GF(1009**2), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial()
x^8 + 1045817316825941*x^7 + 546866930086505850133464526551*x^6 + 190640968494636702312197540239024924597536618*x^5 + 49843906537040069873392691186784704861320520036908736885312*x^4 + 194087947845988228526704383964086734259184677590058*x^3 + 566821515149604163130057985174959967417111*x^2 + 1103577471286158480607964750564981*x + 1074309286591662654798721
```

It looks like the frobenius polynomial for GF(1009) is correct, but it is not correct for `GF(1009**2)`. Comparing with Minzlaff's code, the right frobenius polynomial for `GF(1009**2)` should be 

```
x^8 + 532*x^7 - 2877542*x^6 - 242628176*x^5 + 4390163797795*x^4 - 247015136050256*x^3 - 2982540407204025062*x^2 + 561382189105547134612*x + 1074309286591662654798721
```



---

archive/issue_comments_275615.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-06-03T20:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275615",
    "user": "https://github.com/edgarcosta"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_275616.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-11T15:20:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275617.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-11T17:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275618.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-11T20:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275619.json:
```json
{
    "body": "The bugs mentioned before have been fixed",
    "created_at": "2019-10-11T20:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275619",
    "user": "https://github.com/edgarcosta"
}
```

The bugs mentioned before have been fixed



---

archive/issue_comments_275620.json:
```json
{
    "body": "* Use \"Return\" and not \"Returns\" in the first line of documentations ; same for \"Computes\", etc\n\n* Do not end the lines by `\\` when using `....:`, they are not needed\n\n* the `\\` is also not needed to wrap lines inside the text of an Error, just write something like\n\n```\nraise BeautifulError(\"all the carrots \"\n                     \"belong to the rabbits\")\n```\n\n* Use `https://www.gnu.org/licenses/` in the headers (with https instead of http)\n\n* Capital F to Frobenius in the documentation\n\n* Is the change to `src/sage/schemes/hyperelliptic_curves/hypellfrob.pyx` needed ?\n\n* The file `src/sage/schemes/cyclic_covers/__init__.py` should rather be empty\n\n* src/sage/schemes/cyclic_covers/charpoly_frobenius.py:8: 'sage.matrix.constructor.matrix' imported but unused\n\n* When testing that something mod 2 is not zero, you can write `if k % 2:`\n\nok, enough for the moment",
    "created_at": "2019-10-12T07:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275620",
    "user": "https://github.com/fchapoton"
}
```

* Use "Return" and not "Returns" in the first line of documentations ; same for "Computes", etc

* Do not end the lines by `\` when using `....:`, they are not needed

* the `\` is also not needed to wrap lines inside the text of an Error, just write something like

```
raise BeautifulError("all the carrots "
                     "belong to the rabbits")
```

* Use `https://www.gnu.org/licenses/` in the headers (with https instead of http)

* Capital F to Frobenius in the documentation

* Is the change to `src/sage/schemes/hyperelliptic_curves/hypellfrob.pyx` needed ?

* The file `src/sage/schemes/cyclic_covers/__init__.py` should rather be empty

* src/sage/schemes/cyclic_covers/charpoly_frobenius.py:8: 'sage.matrix.constructor.matrix' imported but unused

* When testing that something mod 2 is not zero, you can write `if k % 2:`

ok, enough for the moment



---

archive/issue_comments_275621.json:
```json
{
    "body": "and many more tests should be tagged as #long\n\nthe longest one takes too long and should remain `# not tested, very long`",
    "created_at": "2019-10-12T07:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275621",
    "user": "https://github.com/fchapoton"
}
```

and many more tests should be tagged as #long

the longest one takes too long and should remain `# not tested, very long`



---

archive/issue_events_055017.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-12T11:43:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55017"
}
```



---

archive/issue_events_055018.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-12T11:43:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55018"
}
```



---

archive/issue_comments_275622.json:
```json
{
    "body": "Replying to [comment:20 chapoton]:\n> * Use \"Return\" and not \"Returns\" in the first line of documentations ; same for \"Computes\", etc\n> \n> * Do not end the lines by `\\` when using `....:`, they are not needed\n> \n> * the `\\` is also not needed to wrap lines inside the text of an Error, just write something like\n> \n> \n> ```\n> raise BeautifulError(\"all the carrots \"\n>                      \"belong to the rabbits\")\n> ```\n> \n> * Use `https://www.gnu.org/licenses/` in the headers (with https instead of http)\n> \n> * Capital F to Frobenius in the documentation\n> \n> * Is the change to `src/sage/schemes/hyperelliptic_curves/hypellfrob.pyx` needed ?\n> \n> * The file `src/sage/schemes/cyclic_covers/__init__.py` should rather be empty\n> \n> * src/sage/schemes/cyclic_covers/charpoly_frobenius.py:8: 'sage.matrix.constructor.matrix' imported but unused\n> \n> * When testing that something mod 2 is not zero, you can write `if k % 2:`\n> \n> ok, enough for the moment\n\n\nMost of these are fine and I am happy to do, but I wonder if you know an automatic tool to fix these things, if not perhaps we should make one, it would save time fixing annoying single character changes.\nAs for ` k %2 ` I don't know why I would do that, to save keystrokes? It makes it less readable IMO and doesn't seem to have benefit.\n\nAs for the change to `src/sage/schemes/hyperelliptic_curves/hypellfrob.pyx` I'm not sure how that appeared there, maybe a merge issue, if they don't break anything I'll remove them I suppose.",
    "created_at": "2019-10-12T12:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275622",
    "user": "https://github.com/alexjbest"
}
```

Replying to [comment:20 chapoton]:
> * Use "Return" and not "Returns" in the first line of documentations ; same for "Computes", etc
> 
> * Do not end the lines by `\` when using `....:`, they are not needed
> 
> * the `\` is also not needed to wrap lines inside the text of an Error, just write something like
> 
> 
> ```
> raise BeautifulError("all the carrots "
>                      "belong to the rabbits")
> ```
> 
> * Use `https://www.gnu.org/licenses/` in the headers (with https instead of http)
> 
> * Capital F to Frobenius in the documentation
> 
> * Is the change to `src/sage/schemes/hyperelliptic_curves/hypellfrob.pyx` needed ?
> 
> * The file `src/sage/schemes/cyclic_covers/__init__.py` should rather be empty
> 
> * src/sage/schemes/cyclic_covers/charpoly_frobenius.py:8: 'sage.matrix.constructor.matrix' imported but unused
> 
> * When testing that something mod 2 is not zero, you can write `if k % 2:`
> 
> ok, enough for the moment


Most of these are fine and I am happy to do, but I wonder if you know an automatic tool to fix these things, if not perhaps we should make one, it would save time fixing annoying single character changes.
As for ` k %2 ` I don't know why I would do that, to save keystrokes? It makes it less readable IMO and doesn't seem to have benefit.

As for the change to `src/sage/schemes/hyperelliptic_curves/hypellfrob.pyx` I'm not sure how that appeared there, maybe a merge issue, if they don't break anything I'll remove them I suppose.



---

archive/issue_comments_275623.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T14:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275624.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T14:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275625.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T14:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275626.json:
```json
{
    "body": "Humm. not sure what you are doing, But I did not suggest anything about white space.\n\nAnd you can write the Errors on two lines (not 4), exactly as I suggested before.",
    "created_at": "2019-10-12T14:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275626",
    "user": "https://github.com/fchapoton"
}
```

Humm. not sure what you are doing, But I did not suggest anything about white space.

And you can write the Errors on two lines (not 4), exactly as I suggested before.



---

archive/issue_comments_275627.json:
```json
{
    "body": "Usually, one does not put spaces around powers, so `x**n` is fine.\n\nIf you want to know how you are supposed to write code exactly, you should use pycodestyle to check for pep8 correctness. This is not strongly required.",
    "created_at": "2019-10-12T14:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275627",
    "user": "https://github.com/fchapoton"
}
```

Usually, one does not put spaces around powers, so `x**n` is fine.

If you want to know how you are supposed to write code exactly, you should use pycodestyle to check for pep8 correctness. This is not strongly required.



---

archive/issue_comments_275628.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T17:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275628",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275629.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T19:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275630.json:
```json
{
    "body": "I think we got all your suggestions now, thanks!\n\nI'm still not sure which tests are too long now, `sage -t` already includes warn long and shows nothing on my laptop, is there a good way to determine this?",
    "created_at": "2019-10-12T19:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275630",
    "user": "https://github.com/alexjbest"
}
```

I think we got all your suggestions now, thanks!

I'm still not sure which tests are too long now, `sage -t` already includes warn long and shows nothing on my laptop, is there a good way to determine this?



---

archive/issue_comments_275631.json:
```json
{
    "body": "Not so amused by your commit titles, sorry to say. Your code has to meet Sage's standards, that's just the way it goes. I am really trying to help.\n\nMore fixes:\n\n* Typo \"instegral\"\n\n* Is there some reference article, either as preprint or published ? If yes, should be added.\n\n* One spurious empty line here\n\n```\n+        r\"\"\"\n+\n+        Return if this curve is singular or not.\n```\n\n* INPUT: and OUTPUT: must be followed by empty lines\n\n* Typo in the sentence `Return the polynomial of defining the cyclic cover.` : remove \"of\"\n\n* Remain some traces of copy-paste:\n\n```\nReturn this HyperellipticCurve over a new base ring R.\n```\nand\n\n```\nString representation of hyperelliptic curves.\n```\n\n* you should probably use the existing \"is_squarefree\" method of polynomials and not re-invent it in \"check_squarefree\":\n\n```\nsage: g=(x-1)^2\nsage: g.is_squarefree()\nFalse\nsage: x = polygen(QQ)\nsage: g=(x-1)^2\nsage: g.is_squarefree()\nFalse\nsage: x = polygen(Qp(5))\nsage: g = x^2 + 5\nsage: g.is_squarefree()\nTrue\nsage: x = polygen(GF(2))\nsage: g = x^2 + x + 1\nsage: g.is_squarefree()\nTrue\n```",
    "created_at": "2019-10-12T19:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275631",
    "user": "https://github.com/fchapoton"
}
```

Not so amused by your commit titles, sorry to say. Your code has to meet Sage's standards, that's just the way it goes. I am really trying to help.

More fixes:

* Typo "instegral"

* Is there some reference article, either as preprint or published ? If yes, should be added.

* One spurious empty line here

```
+        r"""
+
+        Return if this curve is singular or not.
```

* INPUT: and OUTPUT: must be followed by empty lines

* Typo in the sentence `Return the polynomial of defining the cyclic cover.` : remove "of"

* Remain some traces of copy-paste:

```
Return this HyperellipticCurve over a new base ring R.
```
and

```
String representation of hyperelliptic curves.
```

* you should probably use the existing "is_squarefree" method of polynomials and not re-invent it in "check_squarefree":

```
sage: g=(x-1)^2
sage: g.is_squarefree()
False
sage: x = polygen(QQ)
sage: g=(x-1)^2
sage: g.is_squarefree()
False
sage: x = polygen(Qp(5))
sage: g = x^2 + 5
sage: g.is_squarefree()
True
sage: x = polygen(GF(2))
sage: g = x^2 + x + 1
sage: g.is_squarefree()
True
```



---

archive/issue_comments_275632.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T19:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275633.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T19:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275633",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275634.json:
```json
{
    "body": "> Not so amused by your commit titles, sorry to say. Your code has to meet Sage's standards, that's just the way it goes. I am really trying to help.\n\nSorry that's more me being lazy than making a point! I appreciate the comments.\n\n---",
    "created_at": "2019-10-12T19:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275634",
    "user": "https://github.com/alexjbest"
}
```

> Not so amused by your commit titles, sorry to say. Your code has to meet Sage's standards, that's just the way it goes. I am really trying to help.

Sorry that's more me being lazy than making a point! I appreciate the comments.

---



---

archive/issue_comments_275635.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-12T20:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275636.json:
```json
{
    "body": "Thanks for your comments.\nI think I have addressed most of your comments, with the exception: \n> * When testing that something mod 2 is not zero, you can write `if k % 2:`\n \nwhich I disagree with\n\nok. That would be slightly faster.\n\n> * Is there some reference article, either as preprint or published ? If yes, should be added. \n\n\nas the answer is yes, and I need to figure out how to add the reference properly.\n\nThe reference itself should be added in the master reference file:\n\nsrc/doc/en/reference/references/index.rst\n\nand called in your files somewhere using the usual syntax `[Who2019]_ `\n\n* long tests\nHow do we determine what is long?\n\nusing\n\n```\n./sage -bt --long --warn-long src/sage/schemes/cyclic_covers/\n```\n\nWell, your machine may be too quick. Mine is slow. I will launch this command and report.\n\nI also have an honest question, do you know the reason for not using the 3rd person in the documentation, e.g., return instead of returns? I know it is pep8 stuff, but I am confused about how should I be reading docstrings for this to make sense grammatically, as I always read them as the function F does something...\n\nThis is not pep8 stuff, but sage's own decision. The first line of the documentation is supposed to be in imperative mode (like when giving an order) as explained here:\n\nhttp://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings",
    "created_at": "2019-10-12T20:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275636",
    "user": "https://github.com/edgarcosta"
}
```

Thanks for your comments.
I think I have addressed most of your comments, with the exception: 
> * When testing that something mod 2 is not zero, you can write `if k % 2:`
 
which I disagree with

ok. That would be slightly faster.

> * Is there some reference article, either as preprint or published ? If yes, should be added. 


as the answer is yes, and I need to figure out how to add the reference properly.

The reference itself should be added in the master reference file:

src/doc/en/reference/references/index.rst

and called in your files somewhere using the usual syntax `[Who2019]_ `

* long tests
How do we determine what is long?

using

```
./sage -bt --long --warn-long src/sage/schemes/cyclic_covers/
```

Well, your machine may be too quick. Mine is slow. I will launch this command and report.

I also have an honest question, do you know the reason for not using the 3rd person in the documentation, e.g., return instead of returns? I know it is pep8 stuff, but I am confused about how should I be reading docstrings for this to make sense grammatically, as I always read them as the function F does something...

This is not pep8 stuff, but sage's own decision. The first line of the documentation is supposed to be in imperative mode (like when giving an order) as explained here:

http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings



---

archive/issue_comments_275637.json:
```json
{
    "body": "Here are some timings\n\n```\n sage.schemes.cyclic_covers.cycliccover_finite_field.CyclicCover_finite_field.frobenius_polynomial\nWarning, slow doctest:\n    CyclicCover(11, PolynomialRing(GF(1129), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial() # long time\nTest ran for 27.69 s\n**********************************************************************\nFile \"src/sage/schemes/cyclic_covers/cycliccover_finite_field.py\", line 1122, in sage.schemes.cyclic_covers.cycliccover_finite_field.CyclicCover_finite_field.frobenius_polynomial\nWarning, slow doctest:\n    CyclicCover(3, PolynomialRing(GF(1009^2), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial() # long time\nTest ran for 135.69 s\n**********************************************************************\nFile \"src/sage/schemes/cyclic_covers/cycliccover_finite_field.py\", line 1131, in sage.schemes.cyclic_covers.cycliccover_finite_field.CyclicCover_finite_field.frobenius_polynomial\nWarning, slow doctest:\n    C.frobenius_polynomial()\nTest ran for 26.42 s\n```\nI sugggest that at least the worst one become `# not tested`",
    "created_at": "2019-10-13T07:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275637",
    "user": "https://github.com/fchapoton"
}
```

Here are some timings

```
 sage.schemes.cyclic_covers.cycliccover_finite_field.CyclicCover_finite_field.frobenius_polynomial
Warning, slow doctest:
    CyclicCover(11, PolynomialRing(GF(1129), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial() # long time
Test ran for 27.69 s
**********************************************************************
File "src/sage/schemes/cyclic_covers/cycliccover_finite_field.py", line 1122, in sage.schemes.cyclic_covers.cycliccover_finite_field.CyclicCover_finite_field.frobenius_polynomial
Warning, slow doctest:
    CyclicCover(3, PolynomialRing(GF(1009^2), 'x')([-1] + [0]*(5-1) + [1])).frobenius_polynomial() # long time
Test ran for 135.69 s
**********************************************************************
File "src/sage/schemes/cyclic_covers/cycliccover_finite_field.py", line 1131, in sage.schemes.cyclic_covers.cycliccover_finite_field.CyclicCover_finite_field.frobenius_polynomial
Warning, slow doctest:
    C.frobenius_polynomial()
Test ran for 26.42 s
```
I sugggest that at least the worst one become `# not tested`



---

archive/issue_comments_275638.json:
```json
{
    "body": "There is a line\n\n```\n....:)\n```\nthat is missing a white space after `:`",
    "created_at": "2019-10-13T19:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275638",
    "user": "https://github.com/fchapoton"
}
```

There is a line

```
....:)
```
that is missing a white space after `:`



---

archive/issue_comments_275639.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-14T12:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275639",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275640.json:
```json
{
    "body": "* The following\n\n```\n+            min_val = min(\n+                [min([self._Qq(elt).valuation() for elt in row]) for row in F.rows()]\n+            )\n```\ncould be done in one loop\n\n```\nmin_val = min(self._Qq(elt).valuation() for row in F.rows() for elt in row)\n```\n\n* In this\n\n```\n+        Compute p-adic Frobenius matrix to precision p^N. If N not\n+        supplied, a default value is selected, which is the minimum needed\n+        to recover the charpoly unambiguously.\n```\nthe first sentence should be followed by an empty line.\n\n* In all.py, do not use assert\n\n* In this sentence\n\n```\n+    - ``charpoly_prec`` -- a vector ai, such that, `frob_matrix.change_ring(ZZ).charpoly()[i]`\n+        will be correct mod `p^ai`, this can be easily deduced from the hodge numbers and\n+        knowing the q-adic precision of `frob_matrix`\n```\nHodge take a capital H, and the final frob_matrix should be between double backticks\n* You could replace\n\n```\nimport sage.schemes.curves.affine_curve as plane_curve\n```\nby\n\n```\nfrom sage.schemes.curves.affine_curve import AffinePlaneCurve\n```\nand then use that directly\n\n* In src/sage/schemes/cyclic_covers/charpoly_frobenius.py, there are many divisions by 2. I would suggest to add `from __future__ import division` in order to make sure that the python3  behaviour will remain the same.\n\n* this sentence does not make sense\n\n```\n+    - ``f`` - univariate polynomial\n+      is not given, then it defaults to 0.\n```\n\n* do not use range(0, something) but range(something)\n\n* still an empty line to be removed here:\n\n```\n+    def _horizontal_matrix_reduction(self, s):\n+        r\"\"\"\n+\n```\n\n* this should not be indented\n\n```\n+        OUTPUT:\n+\n+            A tuple of tuples ``( (D0, D1), (M0, M1) )``\n+            where MV_t  = M0 + t * M1 and DV_t = D0 + t * D1\n+\n```\n\nok, enough for today",
    "created_at": "2019-10-15T07:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275640",
    "user": "https://github.com/fchapoton"
}
```

* The following

```
+            min_val = min(
+                [min([self._Qq(elt).valuation() for elt in row]) for row in F.rows()]
+            )
```
could be done in one loop

```
min_val = min(self._Qq(elt).valuation() for row in F.rows() for elt in row)
```

* In this

```
+        Compute p-adic Frobenius matrix to precision p^N. If N not
+        supplied, a default value is selected, which is the minimum needed
+        to recover the charpoly unambiguously.
```
the first sentence should be followed by an empty line.

* In all.py, do not use assert

* In this sentence

```
+    - ``charpoly_prec`` -- a vector ai, such that, `frob_matrix.change_ring(ZZ).charpoly()[i]`
+        will be correct mod `p^ai`, this can be easily deduced from the hodge numbers and
+        knowing the q-adic precision of `frob_matrix`
```
Hodge take a capital H, and the final frob_matrix should be between double backticks
* You could replace

```
import sage.schemes.curves.affine_curve as plane_curve
```
by

```
from sage.schemes.curves.affine_curve import AffinePlaneCurve
```
and then use that directly

* In src/sage/schemes/cyclic_covers/charpoly_frobenius.py, there are many divisions by 2. I would suggest to add `from __future__ import division` in order to make sure that the python3  behaviour will remain the same.

* this sentence does not make sense

```
+    - ``f`` - univariate polynomial
+      is not given, then it defaults to 0.
```

* do not use range(0, something) but range(something)

* still an empty line to be removed here:

```
+    def _horizontal_matrix_reduction(self, s):
+        r"""
+
```

* this should not be indented

```
+        OUTPUT:
+
+            A tuple of tuples ``( (D0, D1), (M0, M1) )``
+            where MV_t  = M0 + t * M1 and DV_t = D0 + t * D1
+
```

ok, enough for today



---

archive/issue_comments_275641.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-17T00:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275641",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275642.json:
```json
{
    "body": "Changing component from padics to algebraic geometry.",
    "created_at": "2019-10-17T00:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275642",
    "user": "https://github.com/alexjbest"
}
```

Changing component from padics to algebraic geometry.



---

archive/issue_comments_275643.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-17T00:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275644.json:
```json
{
    "body": "You should call the added reference somewhere using `[ABCMT2019]_`, say in charpoly_frobenius",
    "created_at": "2019-10-18T09:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275644",
    "user": "https://github.com/fchapoton"
}
```

You should call the added reference somewhere using `[ABCMT2019]_`, say in charpoly_frobenius



---

archive/issue_comments_275645.json:
```json
{
    "body": "This is wrong\n\n```\nimport sage.schemes.curves.affine_curve import AffinePlaneCurve\n```\nThe first \"import\" should be \"from\" instead.",
    "created_at": "2019-10-18T11:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275645",
    "user": "https://github.com/fchapoton"
}
```

This is wrong

```
import sage.schemes.curves.affine_curve import AffinePlaneCurve
```
The first "import" should be "from" instead.



---

archive/issue_comments_275646.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-21T10:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275646",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275647.json:
```json
{
    "body": "```\n+REFERENCES::\n```\nshould end with a single colon, and be followed by an empty line.\n\nOnce done, I will give a positive review, if you set to \"needs_review\". It is better to make further changes in later tickets.",
    "created_at": "2019-10-21T17:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275647",
    "user": "https://github.com/fchapoton"
}
```

```
+REFERENCES::
```
should end with a single colon, and be followed by an empty line.

Once done, I will give a positive review, if you set to "needs_review". It is better to make further changes in later tickets.



---

archive/issue_comments_275648.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-21T18:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275648",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275649.json:
```json
{
    "body": "Thank you!",
    "created_at": "2019-10-21T18:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275649",
    "user": "https://github.com/edgarcosta"
}
```

Thank you!



---

archive/issue_comments_275650.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-21T18:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275650",
    "user": "https://github.com/edgarcosta"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_275651.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-21T19:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275651",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_275652.json:
```json
{
    "body": "my pleasure",
    "created_at": "2019-10-21T19:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275652",
    "user": "https://github.com/fchapoton"
}
```

my pleasure



---

archive/issue_events_055019.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-23T22:58:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20027#event-55019"
}
```



---

archive/issue_comments_275653.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-23T22:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20027#issuecomment-275653",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
