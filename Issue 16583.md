# Issue 16583: Implement ABCs for Lie algebras and finite dimensional given by structure cofficients

archive/issues_016583.json:
```json
{
    "body": "Assignee: tscrim\n\nPart of #14901. This will also implement the basic hierarchy of base classes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16820\n\n",
    "created_at": "2014-08-14T10:45:42Z",
    "labels": [
        "algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Implement ABCs for Lie algebras and finite dimensional given by structure cofficients",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16583",
    "user": "tscrim"
}
```
Assignee: tscrim

Part of #14901. This will also implement the basic hierarchy of base classes.

Issue created by migration from https://trac.sagemath.org/ticket/16820





---

archive/issue_comments_218474.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-29T04:52:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218474",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218475.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2014-11-29T04:52:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218475",
    "user": "tscrim"
}
```

Last 10 new commits:



---

archive/issue_comments_218476.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-25T06:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218476",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218477.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-18T00:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218477",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218478.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-03-13T01:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218478",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_218479.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-17T18:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218479",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218480.json:
```json
{
    "body": "Changing keywords from \"\" to \"lie algebras, days64\".",
    "created_at": "2015-03-17T18:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218480",
    "user": "tscrim"
}
```

Changing keywords from "" to "lie algebras, days64".



---

archive/issue_comments_218481.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-03-24T23:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218481",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_218482.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-04-15T21:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218482",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_218483.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T05:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218483",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218484.json:
```json
{
    "body": "Just had a quick look at some of the examples. Please check my last commit and revert if necessary (I cannot test right now since Sage is compiling again).",
    "created_at": "2015-04-16T05:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218484",
    "user": "darij"
}
```

Just had a quick look at some of the examples. Please check my last commit and revert if necessary (I cannot test right now since Sage is compiling again).



---

archive/issue_comments_218485.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T14:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218485",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218486.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T15:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218486",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218487.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T15:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218487",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218488.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T15:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218488",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218489.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218489",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218490.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T16:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218490",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218491.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T19:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218491",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218492.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T19:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218492",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218493.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T19:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218493",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218494.json:
```json
{
    "body": "See my last commit. Errors:\n\n```\n**********************************************************************\nFile \"src/sage/algebras/lie_algebras/lie_algebra_element.py\", line 179, in sage.algebras.lie_algebras.lie_algebra_element.LieAlgebraElementWrapper.__ne__\nFailed example:\n    L.zero() == 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/algebras/lie_algebras/lie_algebra_element.py\", line 181, in sage.algebras.lie_algebras.lie_algebra_element.LieAlgebraElementWrapper.__ne__\nFailed example:\n    L.zero() != 0\nExpected:\n    False\nGot:\n    True\n**********************************************************************\n\n```\n\n\nAlso, are you sure you meant to keep the dot in `sage/algebras/lie_algebras/examples.`?",
    "created_at": "2015-04-16T19:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218494",
    "user": "darij"
}
```

See my last commit. Errors:

```
**********************************************************************
File "src/sage/algebras/lie_algebras/lie_algebra_element.py", line 179, in sage.algebras.lie_algebras.lie_algebra_element.LieAlgebraElementWrapper.__ne__
Failed example:
    L.zero() == 0
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/algebras/lie_algebras/lie_algebra_element.py", line 181, in sage.algebras.lie_algebras.lie_algebra_element.LieAlgebraElementWrapper.__ne__
Failed example:
    L.zero() != 0
Expected:
    False
Got:
    True
**********************************************************************

```


Also, are you sure you meant to keep the dot in `sage/algebras/lie_algebras/examples.`?



---

archive/issue_comments_218495.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T19:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218495",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218496.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T19:45:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218496",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218497.json:
```json
{
    "body": "It at least covers all 3-dim Lie algebras over char 0 fields (up to isomorphism); I will check when I get home what generality they meant (and put a reference if you think it's necessary).\n\nAlso for this change:\n\n```diff\n+        if hasattr(self, \"module\") and x in self.module():\n+            return self.from_vector(x)\n```\n\nI think you should do\n\n```python\ntry:\n    if x in self.module():\n        return self.from_vector(x)\nexcept AttributeError:\n    pass\n```\n\nFor the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.\n\nFor the tested methods, it was originally returning an element from a matrix Lie algebra, but through refactoring this had changed. This can be remedied by changing the 3 to 1, i.e.: `L = lie_algebras.three_dimensional_by_rank(QQ, 1)`.\n\nI'm also not happy with the corner cases being allowed as all properties become vacuous.\n\nAnyways, I'll make changes tomorrow as I will let Sage compile tonight when I get back home.",
    "created_at": "2015-04-16T19:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218497",
    "user": "tscrim"
}
```

It at least covers all 3-dim Lie algebras over char 0 fields (up to isomorphism); I will check when I get home what generality they meant (and put a reference if you think it's necessary).

Also for this change:

```diff
+        if hasattr(self, "module") and x in self.module():
+            return self.from_vector(x)
```

I think you should do

```python
try:
    if x in self.module():
        return self.from_vector(x)
except AttributeError:
    pass
```

For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.

For the tested methods, it was originally returning an element from a matrix Lie algebra, but through refactoring this had changed. This can be remedied by changing the 3 to 1, i.e.: `L = lie_algebras.three_dimensional_by_rank(QQ, 1)`.

I'm also not happy with the corner cases being allowed as all properties become vacuous.

Anyways, I'll make changes tomorrow as I will let Sage compile tonight when I get back home.



---

archive/issue_comments_218498.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T19:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218498",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218499.json:
```json
{
    "body": "Replying to [comment:23 tscrim]:\n> It at least covers all 3-dim Lie algebras over char 0 fields (up to isomorphism); I will check when I get home what generality they meant (and put a reference if you think it's necessary).\n\nAh, please add the reference. That's quite an interesting result.\n\n> Also for this change:\n> {{{#!diff\n> +        if hasattr(self, \"module\") and x in self.module():\n> +            return self.from_vector(x)\n> }}}\n> I think you should do\n> {{{#!python\n> try:\n>     if x in self.module():\n>         return self.from_vector(x)\n> except AttributeError:\n>     pass\n> }}}\n\nDoes this do something different or is it just more pythonic?\nI am worried about this try-except game as I can't tell whether the AttributeError comes from self.module() or from the self.from_vector(x).\n\n> For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.\n\nI am in favor of renaming it then. The abstract `lift` lazy_attribute in `sage/categories/lie_algebras.py` explicitly speaks of the UEA in its doc. A `lift` that can go anywhere depending on the concrete algebra will be rather useless.\n\n> For the tested methods, it was originally returning an element from a matrix Lie algebra, but through refactoring this had changed. This can be remedied by changing the 3 to 1, i.e.: `L = lie_algebras.three_dimensional_by_rank(QQ, 1)`.\n\nNope, they are still not wrappers.\n\n> I'm also not happy with the corner cases being allowed as all properties become vacuous.\n\nThe corner cases need to be allowed, and I've already caught at least 2 bugs by inserting tests for them.",
    "created_at": "2015-04-16T19:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218499",
    "user": "darij"
}
```

Replying to [comment:23 tscrim]:
> It at least covers all 3-dim Lie algebras over char 0 fields (up to isomorphism); I will check when I get home what generality they meant (and put a reference if you think it's necessary).

Ah, please add the reference. That's quite an interesting result.

> Also for this change:
> {{{#!diff
> +        if hasattr(self, "module") and x in self.module():
> +            return self.from_vector(x)
> }}}
> I think you should do
> {{{#!python
> try:
>     if x in self.module():
>         return self.from_vector(x)
> except AttributeError:
>     pass
> }}}

Does this do something different or is it just more pythonic?
I am worried about this try-except game as I can't tell whether the AttributeError comes from self.module() or from the self.from_vector(x).

> For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.

I am in favor of renaming it then. The abstract `lift` lazy_attribute in `sage/categories/lie_algebras.py` explicitly speaks of the UEA in its doc. A `lift` that can go anywhere depending on the concrete algebra will be rather useless.

> For the tested methods, it was originally returning an element from a matrix Lie algebra, but through refactoring this had changed. This can be remedied by changing the 3 to 1, i.e.: `L = lie_algebras.three_dimensional_by_rank(QQ, 1)`.

Nope, they are still not wrappers.

> I'm also not happy with the corner cases being allowed as all properties become vacuous.

The corner cases need to be allowed, and I've already caught at least 2 bugs by inserting tests for them.



---

archive/issue_comments_218500.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T20:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218500",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218501.json:
```json
{
    "body": "Replying to [comment:25 darij]:\n> Replying to [comment:23 tscrim]:\n> > It at least covers all 3-dim Lie algebras over char 0 fields (up to isomorphism); I will check when I get home what generality they meant (and put a reference if you think it's necessary).\n> \n> Ah, please add the reference. That's quite an interesting result.\n\nIIRC, it's mostly just doing some linear algebra, going rank by rank, and using the constraint by the Jacobi identity. However I will add it.\n\n> > Also for this change:\n> > {{{#!diff\n> > +        if hasattr(self, \"module\") and x in self.module():\n> > +            return self.from_vector(x)\n> > }}}\n> > I think you should do\n> > {{{#!python\n> > try:\n> >     if x in self.module():\n> >         return self.from_vector(x)\n> > except AttributeError:\n> >     pass\n> > }}}\n> \n> Does this do something different or is it just more pythonic?\n> I am worried about this try-except game as I can't tell whether the AttributeError comes from self.module() or from the self.from_vector(x).\n\nIt is more pythonic (and faster, but not noticably). You are the one who wanted the rule of 3s contract, and because of the category almost every Lie algebra which has a module attribute also has a `from_vector`. Also I'd say the failure is more graceful this way as if either one is not implemented, then it results in an unable to do the coercion/conversion type error.\n\n> > For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.\n> \n> I am in favor of renaming it then. The abstract `lift` lazy_attribute in `sage/categories/lie_algebras.py` explicitly speaks of the UEA in its doc. A `lift` that can go anywhere depending on the concrete algebra will be rather useless.\n\nRenaming which one? Also it's far from useless to lift to some enveloping algebra as you would want to convert between say, SGA and the Lie algebra.\n\n> > For the tested methods, it was originally returning an element from a matrix Lie algebra, but through refactoring this had changed. This can be remedied by changing the 3 to 1, i.e.: `L = lie_algebras.three_dimensional_by_rank(QQ, 1)`.\n> \n> Nope, they are still not wrappers.\n\nWhoops, yes. Do `sl(QQ, 2, representation='matrix')` or one of the upper triangular matrix Lie algebras.\n\n> > I'm also not happy with the corner cases being allowed as all properties become vacuous.\n> \n> The corner cases need to be allowed, and I've already caught at least 2 bugs by inserting tests for them.\n\nNo, they don't have to be allowed. In fact, because they are the empty set, they aren't really well-defined to me.",
    "created_at": "2015-04-16T20:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218501",
    "user": "tscrim"
}
```

Replying to [comment:25 darij]:
> Replying to [comment:23 tscrim]:
> > It at least covers all 3-dim Lie algebras over char 0 fields (up to isomorphism); I will check when I get home what generality they meant (and put a reference if you think it's necessary).
> 
> Ah, please add the reference. That's quite an interesting result.

IIRC, it's mostly just doing some linear algebra, going rank by rank, and using the constraint by the Jacobi identity. However I will add it.

> > Also for this change:
> > {{{#!diff
> > +        if hasattr(self, "module") and x in self.module():
> > +            return self.from_vector(x)
> > }}}
> > I think you should do
> > {{{#!python
> > try:
> >     if x in self.module():
> >         return self.from_vector(x)
> > except AttributeError:
> >     pass
> > }}}
> 
> Does this do something different or is it just more pythonic?
> I am worried about this try-except game as I can't tell whether the AttributeError comes from self.module() or from the self.from_vector(x).

It is more pythonic (and faster, but not noticably). You are the one who wanted the rule of 3s contract, and because of the category almost every Lie algebra which has a module attribute also has a `from_vector`. Also I'd say the failure is more graceful this way as if either one is not implemented, then it results in an unable to do the coercion/conversion type error.

> > For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.
> 
> I am in favor of renaming it then. The abstract `lift` lazy_attribute in `sage/categories/lie_algebras.py` explicitly speaks of the UEA in its doc. A `lift` that can go anywhere depending on the concrete algebra will be rather useless.

Renaming which one? Also it's far from useless to lift to some enveloping algebra as you would want to convert between say, SGA and the Lie algebra.

> > For the tested methods, it was originally returning an element from a matrix Lie algebra, but through refactoring this had changed. This can be remedied by changing the 3 to 1, i.e.: `L = lie_algebras.three_dimensional_by_rank(QQ, 1)`.
> 
> Nope, they are still not wrappers.

Whoops, yes. Do `sl(QQ, 2, representation='matrix')` or one of the upper triangular matrix Lie algebras.

> > I'm also not happy with the corner cases being allowed as all properties become vacuous.
> 
> The corner cases need to be allowed, and I've already caught at least 2 bugs by inserting tests for them.

No, they don't have to be allowed. In fact, because they are the empty set, they aren't really well-defined to me.



---

archive/issue_comments_218502.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T20:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218502",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218503.json:
```json
{
    "body": "Replying to [comment:27 tscrim]:\n> IIRC, it's mostly just doing some linear algebra, going rank by rank, and using the constraint by the Jacobi identity. However I will add it.\n\nA lot of Lie theory is just doing some linear algebra... Linear algebra does a lot.\n\n\n> It is more pythonic (and faster, but not noticably). You are the one who wanted the rule of 3s contract, and because of the category almost every Lie algebra which has a module attribute also has a `from_vector`. Also I'd say the failure is more graceful this way as if either one is not implemented, then it results in an unable to do the coercion/conversion type error.\n\nYou're right -- fixed!\n\n> > > For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.\n\nSo you have 3 different meanings of lift now:\n\n- lift from g to U(g);\n\n- lift from g to *some* associative algebra containing g;\n\n- lift from g to a bigger Lie algebra.\n\nI have no idea how I am to rely on a method which can do either of these three things depending on the implementation (and possibly on the MRO?). These warrant distinct names.\n\n> Renaming which one?\n\nEither.\n\n> Whoops, yes. Do `sl(QQ, 2, representation='matrix')` or one of the upper triangular matrix Lie algebras.\n\nThanks. And you know what's funny? The try/except change actually fixed the == 0 tests...\n\nbut caused some new crap:\n\n\n```\nsage: L = lie_algebras.sl(QQ, 2, representation='matrix')\nsage: L(2)\n[2 0]\n[0 2]\n```\n\n\nThis is not in sl(2)!\n\nAlthough, this is tolerable due to how this version of sl(2) is defined (as a generate of E, F and H).\n\n> No, they don't have to be allowed. In fact, because they are the empty set, they aren't really well-defined to me.\n\n0-dimensional Lie algebras exist and sometimes you get them by quotienting or restricting. It isn't mathematically reasonable to exclude them.\n----\nNew commits:",
    "created_at": "2015-04-16T20:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218503",
    "user": "darij"
}
```

Replying to [comment:27 tscrim]:
> IIRC, it's mostly just doing some linear algebra, going rank by rank, and using the constraint by the Jacobi identity. However I will add it.

A lot of Lie theory is just doing some linear algebra... Linear algebra does a lot.


> It is more pythonic (and faster, but not noticably). You are the one who wanted the rule of 3s contract, and because of the category almost every Lie algebra which has a module attribute also has a `from_vector`. Also I'd say the failure is more graceful this way as if either one is not implemented, then it results in an unable to do the coercion/conversion type error.

You're right -- fixed!

> > > For the `FromAssociative.lift`...well there's some ambiguity there as to whether we want to lift to the UEA or just some enveloping algebra. I opted to lift just to the defining algebra (which I forgot to change in the docs) as this seemed the most natural. We will also have to deal with subalgebras and a `lift` there.

So you have 3 different meanings of lift now:

- lift from g to U(g);

- lift from g to *some* associative algebra containing g;

- lift from g to a bigger Lie algebra.

I have no idea how I am to rely on a method which can do either of these three things depending on the implementation (and possibly on the MRO?). These warrant distinct names.

> Renaming which one?

Either.

> Whoops, yes. Do `sl(QQ, 2, representation='matrix')` or one of the upper triangular matrix Lie algebras.

Thanks. And you know what's funny? The try/except change actually fixed the == 0 tests...

but caused some new crap:


```
sage: L = lie_algebras.sl(QQ, 2, representation='matrix')
sage: L(2)
[2 0]
[0 2]
```


This is not in sl(2)!

Although, this is tolerable due to how this version of sl(2) is defined (as a generate of E, F and H).

> No, they don't have to be allowed. In fact, because they are the empty set, they aren't really well-defined to me.

0-dimensional Lie algebras exist and sometimes you get them by quotienting or restricting. It isn't mathematically reasonable to exclude them.
----
New commits:



---

archive/issue_comments_218504.json:
```json
{
    "body": "IIRC, how I got around the subalgebra lifting was calling it `lift_ambient`. Perhaps what we should do is have it take an optional argument which calls the respective coercion and has some default. Maybe ask Nicolas?\n\nYou're right, but it's the one consisting of `{0}`. However this is not the empty set like the set of `0x0` matrices the corner cases construct.\n\nI'm getting on my flight now. Talk to you when I'm back in California.",
    "created_at": "2015-04-16T20:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218504",
    "user": "tscrim"
}
```

IIRC, how I got around the subalgebra lifting was calling it `lift_ambient`. Perhaps what we should do is have it take an optional argument which calls the respective coercion and has some default. Maybe ask Nicolas?

You're right, but it's the one consisting of `{0}`. However this is not the empty set like the set of `0x0` matrices the corner cases construct.

I'm getting on my flight now. Talk to you when I'm back in California.



---

archive/issue_comments_218505.json:
```json
{
    "body": "Changing keywords from \"lie algebras, days64\" to \"lie algebras, days64, sd67\".",
    "created_at": "2015-04-16T20:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218505",
    "user": "darij"
}
```

Changing keywords from "lie algebras, days64" to "lie algebras, days64, sd67".



---

archive/issue_comments_218506.json:
```json
{
    "body": "`lift_ambient` sounds good -- now I'd just wish the other two lifts would have different names.\n\nWhat do you mean by \"not the empty set like the set of 0x0 matrices\"? There is a unique 0x0 matrix, and it is strictly upper-triangular.\n\nYes, talk to you later, and thanks for all the quick responses so far -- they're very helpful.\n\nMeanwhile, here is an enigma for other people to solve:\n\n\n```\nsage: L = lie_algebras.three_dimensional_by_rank(QQ, 3)\nsage: L in Modules(QQ)\nTrue\nsage: L.zero() == 0\nTrue\nsage: L.zero() == QQ(0)\nFalse\n```\n",
    "created_at": "2015-04-16T20:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218506",
    "user": "darij"
}
```

`lift_ambient` sounds good -- now I'd just wish the other two lifts would have different names.

What do you mean by "not the empty set like the set of 0x0 matrices"? There is a unique 0x0 matrix, and it is strictly upper-triangular.

Yes, talk to you later, and thanks for all the quick responses so far -- they're very helpful.

Meanwhile, here is an enigma for other people to solve:


```
sage: L = lie_algebras.three_dimensional_by_rank(QQ, 3)
sage: L in Modules(QQ)
True
sage: L.zero() == 0
True
sage: L.zero() == QQ(0)
False
```




---

archive/issue_comments_218507.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T22:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218507",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218508.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T22:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218508",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218509.json:
```json
{
    "body": "Here is a problem with using `lift` for any kind of lift:\n\n```\nsage: L = lie_algebras.sl(QQ, 2, representation='matrix')\nsage: E, F, H = L.gens()\nsage: E\n[0 1]\n[0 0]\nsage: F\n[0 0]\n[1 0]\nsage: H\n[ 1  0]\n[ 0 -1]\nsage: E * H\n[ 0 -1]\n[ 0  0]\n```\n\nBut E * H should not be -E if it's really to mean the element E * H of the universal envelope.\n\nAlso, it's black on white (green on black?) here:\n\n```\n        def universal_enveloping_algebra(self):\n            \"\"\"\n            Return the universal enveloping algebra of ``self``.\n\n            EXAMPLES::\n\n                sage: L = LieAlgebras(QQ).FiniteDimensional().WithBasis().example()\n                sage: L.universal_enveloping_algebra()\n                Noncommutative Multivariate Polynomial Ring in b0, b1, b2\n                 over Rational Field, nc-relations: {}\n\n            ::\n\n                sage: L = LieAlgebra(QQ, 3, 'x', abelian=True)\n                sage: L.universal_enveloping_algebra()\n                Multivariate Polynomial Ring in x0, x1, x2 over Rational Field\n\n            .. SEEALSO::\n\n                :meth:`lift`\n            \"\"\"\n            return self.lift.codomain()\n```\n\nThe codomain of the lift has to be the UEA.",
    "created_at": "2015-04-16T22:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218509",
    "user": "darij"
}
```

Here is a problem with using `lift` for any kind of lift:

```
sage: L = lie_algebras.sl(QQ, 2, representation='matrix')
sage: E, F, H = L.gens()
sage: E
[0 1]
[0 0]
sage: F
[0 0]
[1 0]
sage: H
[ 1  0]
[ 0 -1]
sage: E * H
[ 0 -1]
[ 0  0]
```

But E * H should not be -E if it's really to mean the element E * H of the universal envelope.

Also, it's black on white (green on black?) here:

```
        def universal_enveloping_algebra(self):
            """
            Return the universal enveloping algebra of ``self``.

            EXAMPLES::

                sage: L = LieAlgebras(QQ).FiniteDimensional().WithBasis().example()
                sage: L.universal_enveloping_algebra()
                Noncommutative Multivariate Polynomial Ring in b0, b1, b2
                 over Rational Field, nc-relations: {}

            ::

                sage: L = LieAlgebra(QQ, 3, 'x', abelian=True)
                sage: L.universal_enveloping_algebra()
                Multivariate Polynomial Ring in x0, x1, x2 over Rational Field

            .. SEEALSO::

                :meth:`lift`
            """
            return self.lift.codomain()
```

The codomain of the lift has to be the UEA.



---

archive/issue_comments_218510.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T22:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218510",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218511.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T23:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218511",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218512.json:
```json
{
    "body": "Sorry for the delay in getting back to you; traveling plus clearing off my built up work.\n\ncomment:29\nI think the issue is that there isn't enough checking of coefficients and maybe a default assumption somewhere that algebras are unital? Perhaps it's also lifting up in some fashion? I'll take a look at that this week.\n\ncomment:31\nI would say the set of 0x0 matrices is the empty set, not the set containing a unique element, the empty matrix. As for the oddity, I think we need a better/more uniform system for equality for things that behave like 0. At the very least, this is an issue with `CombinatorialFreeModuleElement` that deserves a separate ticket:\n\n```\nsage: C = CombinatorialFreeModule(ZZ, ['a','b'])\nsage: C.zero() == 0\nTrue\nsage: C.zero() == QQ(0)\nFalse\n```\n\n\ncomment:34\nYes, that is definitely bad. I'm thinking we should have `lift` always return an element of the UEA and state that explicitly. For the lifting to the defining associative algebra, perhaps call that `lift_associative`?",
    "created_at": "2015-04-19T17:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218512",
    "user": "tscrim"
}
```

Sorry for the delay in getting back to you; traveling plus clearing off my built up work.

comment:29
I think the issue is that there isn't enough checking of coefficients and maybe a default assumption somewhere that algebras are unital? Perhaps it's also lifting up in some fashion? I'll take a look at that this week.

comment:31
I would say the set of 0x0 matrices is the empty set, not the set containing a unique element, the empty matrix. As for the oddity, I think we need a better/more uniform system for equality for things that behave like 0. At the very least, this is an issue with `CombinatorialFreeModuleElement` that deserves a separate ticket:

```
sage: C = CombinatorialFreeModule(ZZ, ['a','b'])
sage: C.zero() == 0
True
sage: C.zero() == QQ(0)
False
```


comment:34
Yes, that is definitely bad. I'm thinking we should have `lift` always return an element of the UEA and state that explicitly. For the lifting to the defining associative algebra, perhaps call that `lift_associative`?



---

archive/issue_comments_218513.json:
```json
{
    "body": "> Sorry for the delay in getting back to you; traveling plus clearing off my built up work.\n\nDon't worry. I'm again swamped in work, so the sorriness is mutual.\n\nReplying to [comment:37 tscrim]:\n> comment:29\n> I think the issue is that there isn't enough checking of coefficients and maybe a default assumption somewhere that algebras are unital? Perhaps it's also lifting up in some fashion? I'll take a look at that this week.\n\nForget about this part -- I've since noticed that you define sl(2) as a Lie subalgebra of an associative algebra generated by a subset, and since you don't have methods which compute such a thing exactly, there is no surprise that it accepts input too liberally.\n\n> comment:31\n> I would say the set of 0x0 matrices is the empty set, not the set containing a unique element, the empty matrix.\n\nThere are very good reasons for considering it a one-element set. Matrices of size m \\times n correspond to morphisms `R^n \\to R^m`. How many morphisms are there from `R^0` to `R^0` (that is, from 0 to 0) ? One -- the zero morphism.\n\n> As for the oddity, I think we need a better/more uniform system for equality for things that behave like 0. At the very least, this is an issue with `CombinatorialFreeModuleElement` that deserves a separate ticket:\n> {{{\n> sage: C = CombinatorialFreeModule(ZZ, ['a','b'])\n> sage: C.zero() == 0\n> True\n> sage: C.zero() == QQ(0)\n> False\n> }}}\n\n+1.\n\n> comment:34\n> Yes, that is definitely bad. I'm thinking we should have `lift` always return an element of the UEA and state that explicitly. For the lifting to the defining associative algebra, perhaps call that `lift_associative`?\n\nThat's a good idea.\n\nThe Lie subalgebra of an associative algebra generated by a subset will, so far, have no UEA, since we don't compute its full ground set. But now you made me wonder if we really need the Lie subalgebra of an associative algebra generated by a subset... If we don't compute its ground set, and only let the user compute \"inside\" it, then why don't we just use the whole associative algebra as a Lie algebra? The generators seem to be useless...",
    "created_at": "2015-04-19T17:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218513",
    "user": "darij"
}
```

> Sorry for the delay in getting back to you; traveling plus clearing off my built up work.

Don't worry. I'm again swamped in work, so the sorriness is mutual.

Replying to [comment:37 tscrim]:
> comment:29
> I think the issue is that there isn't enough checking of coefficients and maybe a default assumption somewhere that algebras are unital? Perhaps it's also lifting up in some fashion? I'll take a look at that this week.

Forget about this part -- I've since noticed that you define sl(2) as a Lie subalgebra of an associative algebra generated by a subset, and since you don't have methods which compute such a thing exactly, there is no surprise that it accepts input too liberally.

> comment:31
> I would say the set of 0x0 matrices is the empty set, not the set containing a unique element, the empty matrix.

There are very good reasons for considering it a one-element set. Matrices of size m \times n correspond to morphisms `R^n \to R^m`. How many morphisms are there from `R^0` to `R^0` (that is, from 0 to 0) ? One -- the zero morphism.

> As for the oddity, I think we need a better/more uniform system for equality for things that behave like 0. At the very least, this is an issue with `CombinatorialFreeModuleElement` that deserves a separate ticket:
> {{{
> sage: C = CombinatorialFreeModule(ZZ, ['a','b'])
> sage: C.zero() == 0
> True
> sage: C.zero() == QQ(0)
> False
> }}}

+1.

> comment:34
> Yes, that is definitely bad. I'm thinking we should have `lift` always return an element of the UEA and state that explicitly. For the lifting to the defining associative algebra, perhaps call that `lift_associative`?

That's a good idea.

The Lie subalgebra of an associative algebra generated by a subset will, so far, have no UEA, since we don't compute its full ground set. But now you made me wonder if we really need the Lie subalgebra of an associative algebra generated by a subset... If we don't compute its ground set, and only let the user compute "inside" it, then why don't we just use the whole associative algebra as a Lie algebra? The generators seem to be useless...



---

archive/issue_comments_218514.json:
```json
{
    "body": "Replying to [comment:38 darij]:\n> Replying to [comment:37 tscrim]:\n> > comment:31\n> > I would say the set of 0x0 matrices is the empty set, not the set containing a unique element, the empty matrix.\n> \n> There are very good reasons for considering it a one-element set. Matrices of size m \\times n correspond to morphisms `R^n \\to R^m`. How many morphisms are there from `R^0` to `R^0` (that is, from 0 to 0) ? One -- the zero morphism.\n\nI would say that this is a degenerate case of the general equality, but fair enough. More fun with corner cases that no one will likely construct except for corner case testing... Will fix. \n\n> > As for the oddity, I think we need a better/more uniform system for equality for things that behave like 0. At the very least, this is an issue with `CombinatorialFreeModuleElement` that deserves a separate ticket:\n> > {{{\n> > sage: C = CombinatorialFreeModule(ZZ, ['a','b'])\n> > sage: C.zero() == 0\n> > True\n> > sage: C.zero() == QQ(0)\n> > False\n> > }}}\n> \n> +1.\n\nThis is #18251.\n\n> > comment:34\n> > Yes, that is definitely bad. I'm thinking we should have `lift` always return an element of the UEA and state that explicitly. For the lifting to the defining associative algebra, perhaps call that `lift_associative`?\n> \n> That's a good idea.\n> \n> The Lie subalgebra of an associative algebra generated by a subset will, so far, have no UEA, since we don't compute its full ground set. But now you made me wonder if we really need the Lie subalgebra of an associative algebra generated by a subset... If we don't compute its ground set, and only let the user compute \"inside\" it, then why don't we just use the whole associative algebra as a Lie algebra? The generators seem to be useless...\n\nThen you'd have gl<sub>n</sub> = sl<sub>n</sub> and there will be Lie subalgebras eventually implemented. More generally, the UEA of the (Lie) subalgebra will be a (assoc) subalgebra of the UEA of the ambient Lie algebra. However, we will need general support for subalgebras, which I don't think #11111 provides...",
    "created_at": "2015-04-19T18:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218514",
    "user": "tscrim"
}
```

Replying to [comment:38 darij]:
> Replying to [comment:37 tscrim]:
> > comment:31
> > I would say the set of 0x0 matrices is the empty set, not the set containing a unique element, the empty matrix.
> 
> There are very good reasons for considering it a one-element set. Matrices of size m \times n correspond to morphisms `R^n \to R^m`. How many morphisms are there from `R^0` to `R^0` (that is, from 0 to 0) ? One -- the zero morphism.

I would say that this is a degenerate case of the general equality, but fair enough. More fun with corner cases that no one will likely construct except for corner case testing... Will fix. 

> > As for the oddity, I think we need a better/more uniform system for equality for things that behave like 0. At the very least, this is an issue with `CombinatorialFreeModuleElement` that deserves a separate ticket:
> > {{{
> > sage: C = CombinatorialFreeModule(ZZ, ['a','b'])
> > sage: C.zero() == 0
> > True
> > sage: C.zero() == QQ(0)
> > False
> > }}}
> 
> +1.

This is #18251.

> > comment:34
> > Yes, that is definitely bad. I'm thinking we should have `lift` always return an element of the UEA and state that explicitly. For the lifting to the defining associative algebra, perhaps call that `lift_associative`?
> 
> That's a good idea.
> 
> The Lie subalgebra of an associative algebra generated by a subset will, so far, have no UEA, since we don't compute its full ground set. But now you made me wonder if we really need the Lie subalgebra of an associative algebra generated by a subset... If we don't compute its ground set, and only let the user compute "inside" it, then why don't we just use the whole associative algebra as a Lie algebra? The generators seem to be useless...

Then you'd have gl<sub>n</sub> = sl<sub>n</sub> and there will be Lie subalgebras eventually implemented. More generally, the UEA of the (Lie) subalgebra will be a (assoc) subalgebra of the UEA of the ambient Lie algebra. However, we will need general support for subalgebras, which I don't think #11111 provides...



---

archive/issue_comments_218515.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-22T03:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218515",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218516.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-27T06:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218516",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218517.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-05T07:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218517",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218518.json:
```json
{
    "body": "one failing doctest, see patchbot report",
    "created_at": "2015-08-05T07:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218518",
    "user": "chapoton"
}
```

one failing doctest, see patchbot report



---

archive/issue_comments_218519.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-24T23:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218519",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218520.json:
```json
{
    "body": "I've fixed the issues with `lift` and the universal enveloping algebra for `LieAlgebraFromAssociative`.\n\nRight now I'm going to leave the option to specify the generators when constructing a Lie algebra from an associative algebra. Once #17416 (subalgebras) is done, it will directly create the corresponding Lie subalgebra.",
    "created_at": "2015-08-25T00:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218520",
    "user": "tscrim"
}
```

I've fixed the issues with `lift` and the universal enveloping algebra for `LieAlgebraFromAssociative`.

Right now I'm going to leave the option to specify the generators when constructing a Lie algebra from an associative algebra. Once #17416 (subalgebras) is done, it will directly create the corresponding Lie subalgebra.



---

archive/issue_comments_218521.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-25T00:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218521",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218522.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-31T15:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218522",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218523.json:
```json
{
    "body": "Whoops `:p`, thanks Frederic.",
    "created_at": "2015-08-31T15:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218523",
    "user": "tscrim"
}
```

Whoops `:p`, thanks Frederic.



---

archive/issue_comments_218524.json:
```json
{
    "body": "two failing doctests",
    "created_at": "2015-10-17T07:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218524",
    "user": "chapoton"
}
```

two failing doctests



---

archive/issue_comments_218525.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-17T07:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218525",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218526.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-23T16:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218526",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218527.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-23T16:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218527",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218528.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-24T01:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218528",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218529.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-24T01:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218529",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218530.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-24T17:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218530",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218531.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-10-25T05:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218531",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_218532.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-25T05:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218532",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218533.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-25T05:22:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218533",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218534.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-25T16:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218534",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218535.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-25T17:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218535",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218536.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-25T17:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218536",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218537.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-25T17:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218537",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218538.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-10-25T17:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218538",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_218539.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-25T17:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218539",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218540.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-26T20:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218540",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218541.json:
```json
{
    "body": "doc does not build",
    "created_at": "2015-10-26T20:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218541",
    "user": "chapoton"
}
```

doc does not build



---

archive/issue_comments_218542.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-26T22:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218542",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218543.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-26T22:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218543",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218544.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-27T18:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218544",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218545.json:
```json
{
    "body": "I feel I don't understand the correct meaning of the arguments in a `LieAlgebra` call very well. What is going wrong here: user error?\n\n\n```\nsage: L = LieAlgebra(QQ, 'x,y,z', {('x','y'):{'z':1}, ('y','z'):{'x':1}, ('z','x'):{'y':1}}, index_set=range(3))\nsage: (x,y,z) = L.gens()\nsage: L.is_abelian()\nFalse\nsage: L[x,y]\n0\nsage: L[y,z]\n0\nsage: L[z,x]\n0\nsage: L[x,y] == L.zero() == L[y,z] == L[x,y]\nTrue\n```\n",
    "created_at": "2015-10-27T18:20:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218545",
    "user": "darij"
}
```

I feel I don't understand the correct meaning of the arguments in a `LieAlgebra` call very well. What is going wrong here: user error?


```
sage: L = LieAlgebra(QQ, 'x,y,z', {('x','y'):{'z':1}, ('y','z'):{'x':1}, ('z','x'):{'y':1}}, index_set=range(3))
sage: (x,y,z) = L.gens()
sage: L.is_abelian()
False
sage: L[x,y]
0
sage: L[y,z]
0
sage: L[z,x]
0
sage: L[x,y] == L.zero() == L[y,z] == L[x,y]
True
```




---

archive/issue_comments_218546.json:
```json
{
    "body": "It is user error as the keys for the structure coefficients should be the index set. However, I could (should) change things so that it doesn't matter which you use.",
    "created_at": "2015-10-27T18:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218546",
    "user": "tscrim"
}
```

It is user error as the keys for the structure coefficients should be the index set. However, I could (should) change things so that it doesn't matter which you use.



---

archive/issue_comments_218547.json:
```json
{
    "body": "Ah! You're right, this is user error. I got confused by the fact that the names come before the index_set.",
    "created_at": "2015-10-27T18:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218547",
    "user": "darij"
}
```

Ah! You're right, this is user error. I got confused by the fact that the names come before the index_set.



---

archive/issue_comments_218548.json:
```json
{
    "body": "However I'm fixing the input so that it mends the input to use the indexing set.",
    "created_at": "2015-10-27T18:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218548",
    "user": "tscrim"
}
```

However I'm fixing the input so that it mends the input to use the indexing set.



---

archive/issue_comments_218549.json:
```json
{
    "body": "...in `structure_coefficients.py`.",
    "created_at": "2015-10-27T18:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218549",
    "user": "tscrim"
}
```

...in `structure_coefficients.py`.



---

archive/issue_comments_218550.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-27T18:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218550",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218551.json:
```json
{
    "body": "With this last commit, we have:\n\n```\nsage: sage: L = LieAlgebra(QQ, 'x,y,z', {('x','y'):{'z':1}, ('y','z'):{'x':1}, ('z','x'):{'y':1}}, index_set=range(3))\nsage: sage: (x,y,z) = L.gens()\nsage: sage: L[x,y]\nL[2]\n```\n",
    "created_at": "2015-10-27T19:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218551",
    "user": "tscrim"
}
```

With this last commit, we have:

```
sage: sage: L = LieAlgebra(QQ, 'x,y,z', {('x','y'):{'z':1}, ('y','z'):{'x':1}, ('z','x'):{'y':1}}, index_set=range(3))
sage: sage: (x,y,z) = L.gens()
sage: sage: L[x,y]
L[2]
```




---

archive/issue_comments_218552.json:
```json
{
    "body": "two failing doctests, see patchbot report",
    "created_at": "2016-01-08T10:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218552",
    "user": "chapoton"
}
```

two failing doctests, see patchbot report



---

archive/issue_comments_218553.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-19T08:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218553",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218554.json:
```json
{
    "body": "It seems that one doctest in Virasoro is fragile, namely the order of the terms\nis not always the same. I have tried to correct this doctest according to a previous\npatchbot report, and now it is failing again.",
    "created_at": "2016-01-20T08:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218554",
    "user": "chapoton"
}
```

It seems that one doctest in Virasoro is fragile, namely the order of the terms
is not always the same. I have tried to correct this doctest according to a previous
patchbot report, and now it is failing again.



---

archive/issue_comments_218555.json:
```json
{
    "body": "Minor comment: when adding new files, please use the standard copyright template from [http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files](http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files).",
    "created_at": "2016-01-20T09:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218555",
    "user": "jdemeyer"
}
```

Minor comment: when adding new files, please use the standard copyright template from [http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files](http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files).



---

archive/issue_comments_218556.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-01-20T09:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218556",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218557.json:
```json
{
    "body": "Removing my name from the reviewer field, since I'm afraid it creates a false impression that this ticket is being taken care of. I currently don't believe that I will find the time necessary for this until Summer :/",
    "created_at": "2016-01-22T03:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218557",
    "user": "darij"
}
```

Removing my name from the reviewer field, since I'm afraid it creates a false impression that this ticket is being taken care of. I currently don't believe that I will find the time necessary for this until Summer :/



---

archive/issue_comments_218558.json:
```json
{
    "body": "However you have done a fair amount of review of this ticket and deserve to be put on as a reviewer. I think your message saying you won't likely be able to get to this until summer is sufficient for anyone following this.",
    "created_at": "2016-01-22T03:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218558",
    "user": "tscrim"
}
```

However you have done a fair amount of review of this ticket and deserve to be put on as a reviewer. I think your message saying you won't likely be able to get to this until summer is sufficient for anyone following this.



---

archive/issue_comments_218559.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-29T15:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218559",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218560.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-02T15:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218560",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218561.json:
```json
{
    "body": "Changing keywords from \"lie algebras, days64, sd67\" to \"lie algebras, days64, sd67, days74\".",
    "created_at": "2016-06-02T15:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218561",
    "user": "tscrim"
}
```

Changing keywords from "lie algebras, days64, sd67" to "lie algebras, days64, sd67, days74".



---

archive/issue_comments_218562.json:
```json
{
    "body": "apparently, doc does not build.",
    "created_at": "2016-06-03T18:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218562",
    "user": "chapoton"
}
```

apparently, doc does not build.



---

archive/issue_comments_218563.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-01T17:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218563",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218564.json:
```json
{
    "body": "I did some basic looking over things and everything seems to work. Still needs to have the mathematics looked at and then the code further tested.",
    "created_at": "2016-07-01T17:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218564",
    "user": "aram.dermenjian"
}
```

I did some basic looking over things and everything seems to work. Still needs to have the mathematics looked at and then the code further tested.



---

archive/issue_comments_218565.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-01T17:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218565",
    "user": "aram.dermenjian"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218566.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-11T07:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218566",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218567.json:
```json
{
    "body": "one doctest complains about deprecation of generator_cmp",
    "created_at": "2016-07-11T15:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218567",
    "user": "chapoton"
}
```

one doctest complains about deprecation of generator_cmp



---

archive/issue_comments_218568.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-12T17:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218568",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218569.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-28T07:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218569",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218570.json:
```json
{
    "body": "Travis and Darij, do you think that this still needs a lot of work ? That would be great to have in sage !",
    "created_at": "2016-08-06T19:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218570",
    "user": "chapoton"
}
```

Travis and Darij, do you think that this still needs a lot of work ? That would be great to have in sage !



---

archive/issue_comments_218571.json:
```json
{
    "body": "I am in the process of doing a rewrite of the underlying implementation from using CFM to wrapping the usual free modules since all of the algorithms rely on linear algebra. However, this doesn't need much work beyond that; just more of a check of the doc and basic math. So I can postpone by rewrite to a followup ticket if you want to finish the review now.",
    "created_at": "2016-08-06T19:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218571",
    "user": "tscrim"
}
```

I am in the process of doing a rewrite of the underlying implementation from using CFM to wrapping the usual free modules since all of the algorithms rely on linear algebra. However, this doesn't need much work beyond that; just more of a check of the doc and basic math. So I can postpone by rewrite to a followup ticket if you want to finish the review now.



---

archive/issue_comments_218572.json:
```json
{
    "body": "I don't know how much work this needs :/ truth be told, I've only reviewed some of the more mathematical parts of it. I was planning to do the rest of it when I'm in Minneapolis (it is so much easier when the author is nearby), but if you (Frederic, or whoever else) beat me to it, I'd certainly be thankful :)",
    "created_at": "2016-08-06T19:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218572",
    "user": "darij"
}
```

I don't know how much work this needs :/ truth be told, I've only reviewed some of the more mathematical parts of it. I was planning to do the rest of it when I'm in Minneapolis (it is so much easier when the author is nearby), but if you (Frederic, or whoever else) beat me to it, I'd certainly be thankful :)



---

archive/issue_comments_218573.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-09T00:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218573",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218574.json:
```json
{
    "body": "Here's my work so far. There's still a few things that need to be fixed, but by far, the refactoring seems to be working. I hope to finish the rest over the next week or so.",
    "created_at": "2016-08-09T00:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218574",
    "user": "tscrim"
}
```

Here's my work so far. There's still a few things that need to be fixed, but by far, the refactoring seems to be working. I hope to finish the rest over the next week or so.



---

archive/issue_comments_218575.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-09T14:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218575",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218576.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-09T14:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218576",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218577.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-09T14:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218577",
    "user": "tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218578.json:
```json
{
    "body": "Okay, that should fix all of the outstanding problems with my rebase. The only thing left is to add doctests, fix the docbuild, change the failing doctests (which are caused by those tests being for a different class), and remove any cruft that might have built up.\n\nI think I will also add a class for infinite-dimensional Lie algebras that uses `LieAlgebraElement` (which should be renamed) that behaves somewhat like a `CombinatorialFreeModule`, but inherits from `LieAlgebra`. This will serve as another common ABC for the Heisenberg and Virasoro Lie algebras, loop algebras, etc.\n\nI also Cythonized the element class (for Lie algebras w/ structure coefficients) and tried to make it so those are as fast as can be.",
    "created_at": "2016-08-09T14:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218578",
    "user": "tscrim"
}
```

Okay, that should fix all of the outstanding problems with my rebase. The only thing left is to add doctests, fix the docbuild, change the failing doctests (which are caused by those tests being for a different class), and remove any cruft that might have built up.

I think I will also add a class for infinite-dimensional Lie algebras that uses `LieAlgebraElement` (which should be renamed) that behaves somewhat like a `CombinatorialFreeModule`, but inherits from `LieAlgebra`. This will serve as another common ABC for the Heisenberg and Virasoro Lie algebras, loop algebras, etc.

I also Cythonized the element class (for Lie algebras w/ structure coefficients) and tried to make it so those are as fast as can be.



---

archive/issue_comments_218579.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T10:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218579",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218580.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T10:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218580",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218581.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-23T10:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218581",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218582.json:
```json
{
    "body": "Okay, back and fully ready for review.",
    "created_at": "2016-11-23T10:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218582",
    "user": "tscrim"
}
```

Okay, back and fully ready for review.



---

archive/issue_comments_218583.json:
```json
{
    "body": "Changing keywords from \"lie algebras, days64, sd67, days74\" to \"lie algebras, days64, sd67, days74, days79\".",
    "created_at": "2016-11-23T10:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218583",
    "user": "tscrim"
}
```

Changing keywords from "lie algebras, days64, sd67, days74" to "lie algebras, days64, sd67, days74, days79".



---

archive/issue_comments_218584.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T14:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218584",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218585.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-24T09:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218585",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218586.json:
```json
{
    "body": "In comment:103 and comment:104 I reviewed the `src/sage/structure/indexed_generators.py` and `src/sage/algebras/lie_algebras/abelian.py` files, and corrected the minor errors I have found there.\n\nReviewing the entire ticket might be too much for me, but it would be great to have Lie algebras in Sage.",
    "created_at": "2016-11-24T09:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218586",
    "user": "mathzeta2"
}
```

In comment:103 and comment:104 I reviewed the `src/sage/structure/indexed_generators.py` and `src/sage/algebras/lie_algebras/abelian.py` files, and corrected the minor errors I have found there.

Reviewing the entire ticket might be too much for me, but it would be great to have Lie algebras in Sage.



---

archive/issue_comments_218587.json:
```json
{
    "body": "there is an xrange, and many .iteritems (not good for py3)",
    "created_at": "2016-11-25T09:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218587",
    "user": "chapoton"
}
```

there is an xrange, and many .iteritems (not good for py3)



---

archive/issue_comments_218588.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-12-11T14:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218588",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218589.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-03T19:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218589",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218590.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-02T16:33:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218590",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218591.json:
```json
{
    "body": "This ticket looks in good shape to me, with clear maths (as far as I can tell) and very high quality code. \nI've just a few comments:\n\n- The documentation of classes `MatrixLieAlgebraFromAssociative` and `LieAlgebraMatrixWrapper` is reduced to \"Initialize self.\", which certainly could be improved, even if the class names are quite explicit. \n\n- There is a typo in the reference [deGraaf2000]: \"Mathemtaical\" --> \"Mathematical\"\n\n- Some infinite-dimensional Lie algebras lack of a `dimension` method:\n\n```\nsage: R = FreeAlgebra(QQ, 3)\nsage: dim(R)\n+Infinity\nsage: L = LieAlgebra(associative=R)\nsage: dim(L)\nAttributeError: 'LieAlgebraFromAssociative_with_category' object has no attribute 'dimension'\n```\n\n  Btw, shouldn't `dimension` be added to `ParentMethods` in the Lie algebra category?\n- Regarding Heisenberg Lie algebras:\n\n```\nsage: L = lie_algebras.Heisenberg(QQ, 2)\nsage: L.lie_algebra_generators()\nFinite family {'p2': p2, 'q1': q1, 'p1': p1, 'q2': q2, 'z': z}\nsage: L.gens()\n(p1, p2, q1, q2)\n```\n\n  Shouldn't z be part of the tuple of generators returned by `gens`?\n\n- The patchbot is complaining about \"Python 3 incompatible code\" in `lie_algebra_element.pyx`, namely the use of `iteritems`. Has this not been fixed by `from six import iteritems` because it is a Cython file?\n\n- Just for curiosity: why are you constructing all Lie algebras by invoking the base class `LieAlgebra`, relying on `LieAlgebra.__classcall_private__` to dispatch to the actual subclass corresponding to the input? Couldn't you use a *function* `LieAlgebra` to do this, as we did for manifolds (cf. the function `Manifold`)? (possibly renaming the class `LieAlgebra` to e.g. `LieAlgebraBase` to avoid any confusion). A drawback of the current setting is that the inline documentation obtained from `LieAlgebra?` returns the `__init__` docstring: \n\n```\n   INPUT:\n\n   * \"R\" -- the base ring\n\n   * \"names\" -- (optional) the names of the generators\n\n   * \"category\" -- the category of the Lie algebra; the default is\n     the category of Lie algebras over \"R\"\n```\n\n  which does not correspond to the actual arguments to be passed to `LieAlgebra` (because of the `__classcall_private__` mechanism) and therefore may confuse the user. If you want to keep `LieAlgebra.__classcall_private__`, a solution could be to set the `INPUT` section in the docstring of the `LieAlgebra` class.",
    "created_at": "2017-03-27T20:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218591",
    "user": "egourgoulhon"
}
```

This ticket looks in good shape to me, with clear maths (as far as I can tell) and very high quality code. 
I've just a few comments:

- The documentation of classes `MatrixLieAlgebraFromAssociative` and `LieAlgebraMatrixWrapper` is reduced to "Initialize self.", which certainly could be improved, even if the class names are quite explicit. 

- There is a typo in the reference [deGraaf2000]: "Mathemtaical" --> "Mathematical"

- Some infinite-dimensional Lie algebras lack of a `dimension` method:

```
sage: R = FreeAlgebra(QQ, 3)
sage: dim(R)
+Infinity
sage: L = LieAlgebra(associative=R)
sage: dim(L)
AttributeError: 'LieAlgebraFromAssociative_with_category' object has no attribute 'dimension'
```

  Btw, shouldn't `dimension` be added to `ParentMethods` in the Lie algebra category?
- Regarding Heisenberg Lie algebras:

```
sage: L = lie_algebras.Heisenberg(QQ, 2)
sage: L.lie_algebra_generators()
Finite family {'p2': p2, 'q1': q1, 'p1': p1, 'q2': q2, 'z': z}
sage: L.gens()
(p1, p2, q1, q2)
```

  Shouldn't z be part of the tuple of generators returned by `gens`?

- The patchbot is complaining about "Python 3 incompatible code" in `lie_algebra_element.pyx`, namely the use of `iteritems`. Has this not been fixed by `from six import iteritems` because it is a Cython file?

- Just for curiosity: why are you constructing all Lie algebras by invoking the base class `LieAlgebra`, relying on `LieAlgebra.__classcall_private__` to dispatch to the actual subclass corresponding to the input? Couldn't you use a *function* `LieAlgebra` to do this, as we did for manifolds (cf. the function `Manifold`)? (possibly renaming the class `LieAlgebra` to e.g. `LieAlgebraBase` to avoid any confusion). A drawback of the current setting is that the inline documentation obtained from `LieAlgebra?` returns the `__init__` docstring: 

```
   INPUT:

   * "R" -- the base ring

   * "names" -- (optional) the names of the generators

   * "category" -- the category of the Lie algebra; the default is
     the category of Lie algebras over "R"
```

  which does not correspond to the actual arguments to be passed to `LieAlgebra` (because of the `__classcall_private__` mechanism) and therefore may confuse the user. If you want to keep `LieAlgebra.__classcall_private__`, a solution could be to set the `INPUT` section in the docstring of the `LieAlgebra` class.



---

archive/issue_comments_218592.json:
```json
{
    "body": "Another minor remark: the ticket title looks strange to me: shouldn't a name (\"Lie algebras\", I guess) be inserted behind \"finite dimensional\"?",
    "created_at": "2017-03-27T20:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218592",
    "user": "egourgoulhon"
}
```

Another minor remark: the ticket title looks strange to me: shouldn't a name ("Lie algebras", I guess) be inserted behind "finite dimensional"?



---

archive/issue_comments_218593.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-27T22:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218593",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218594.json:
```json
{
    "body": "Replying to [comment:110 egourgoulhon]:\n> This ticket looks in good shape to me, with clear maths (as far as I can tell) and very high quality code. \n\nThank you for doing the review.\n\n> - The documentation of classes `MatrixLieAlgebraFromAssociative` and `LieAlgebraMatrixWrapper` is reduced to \"Initialize self.\", which certainly could be improved, even if the class names are quite explicit. \n\nFixed by adding a docstring stub.\n\n> - There is a typo in the reference [deGraaf2000]: \"Mathemtaical\" --> \"Mathematical\"\n\nFixed.\n\n> - Some infinite-dimensional Lie algebras lack of a `dimension` method:\n> {{{\n> sage: R = FreeAlgebra(QQ, 3)\n> sage: dim(R)\n> +Infinity\n> sage: L = LieAlgebra(associative=R)\n> sage: dim(L)\n> AttributeError: 'LieAlgebraFromAssociative_with_category' object has no attribute 'dimension'\n> }}}\n>   Btw, shouldn't `dimension` be added to `ParentMethods` in the Lie algebra category?\n\nFixed. Really it should belong to the `ModulesWithBasis` category (see #22629), but I moved it up to `LieAlgebrasWithBasis` category for now.\n\n> - Regarding Heisenberg Lie algebras:\n> {{{\n> sage: L = lie_algebras.Heisenberg(QQ, 2)\n> sage: L.lie_algebra_generators()\n> Finite family {'p2': p2, 'q1': q1, 'p1': p1, 'q2': q2, 'z': z}\n> sage: L.gens()\n> (p1, p2, q1, q2)\n> }}}\n>   Shouldn't z be part of the tuple of generators returned by `gens`?\n\nI went the other way and dropped `z` from `lie_algebra_generators` since I wanted a more minimal generating set.\n\n> - The patchbot is complaining about \"Python 3 incompatible code\" in `lie_algebra_element.pyx`, namely the use of `iteritems`. Has this not been fixed by `from six import iteritems` because it is a Cython file?\n\nYes, that is correct. I did some other small improvements from things I've learned about Cython recently.\n\n> - Just for curiosity: why are you constructing all Lie algebras by invoking the base class `LieAlgebra`, relying on `LieAlgebra.__classcall_private__` to dispatch to the actual subclass corresponding to the input? Couldn't you use a *function* `LieAlgebra` to do this, as we did for manifolds (cf. the function `Manifold`)? (possibly renaming the class `LieAlgebra` to e.g. `LieAlgebraBase` to avoid any confusion). A drawback of the current setting is that the inline documentation obtained from `LieAlgebra?` returns the `__init__` docstring:\n>\n>   [snip]\n>\n>   which does not correspond to the actual arguments to be passed to `LieAlgebra` (because of the `__classcall_private__` mechanism) and therefore may confuse the user. If you want to keep `LieAlgebra.__classcall_private__`, a solution could be to set the `INPUT` section in the docstring of the `LieAlgebra` class. \n\nBecause this is both the main entry point and the common base class, so there is no reason to separate the two IMO. It also avoids documentation duplication. Additionally the main docstring is (or at least should be) the class-level docstring, which has lots of different possible inputs first as examples. I agree it is a minor drawback that the `__init__` does get included, but it is way at the bottom. However, the possible inputs are quite varied, so writing an `INPUT` block complicated.",
    "created_at": "2017-03-27T23:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218594",
    "user": "tscrim"
}
```

Replying to [comment:110 egourgoulhon]:
> This ticket looks in good shape to me, with clear maths (as far as I can tell) and very high quality code. 

Thank you for doing the review.

> - The documentation of classes `MatrixLieAlgebraFromAssociative` and `LieAlgebraMatrixWrapper` is reduced to "Initialize self.", which certainly could be improved, even if the class names are quite explicit. 

Fixed by adding a docstring stub.

> - There is a typo in the reference [deGraaf2000]: "Mathemtaical" --> "Mathematical"

Fixed.

> - Some infinite-dimensional Lie algebras lack of a `dimension` method:
> {{{
> sage: R = FreeAlgebra(QQ, 3)
> sage: dim(R)
> +Infinity
> sage: L = LieAlgebra(associative=R)
> sage: dim(L)
> AttributeError: 'LieAlgebraFromAssociative_with_category' object has no attribute 'dimension'
> }}}
>   Btw, shouldn't `dimension` be added to `ParentMethods` in the Lie algebra category?

Fixed. Really it should belong to the `ModulesWithBasis` category (see #22629), but I moved it up to `LieAlgebrasWithBasis` category for now.

> - Regarding Heisenberg Lie algebras:
> {{{
> sage: L = lie_algebras.Heisenberg(QQ, 2)
> sage: L.lie_algebra_generators()
> Finite family {'p2': p2, 'q1': q1, 'p1': p1, 'q2': q2, 'z': z}
> sage: L.gens()
> (p1, p2, q1, q2)
> }}}
>   Shouldn't z be part of the tuple of generators returned by `gens`?

I went the other way and dropped `z` from `lie_algebra_generators` since I wanted a more minimal generating set.

> - The patchbot is complaining about "Python 3 incompatible code" in `lie_algebra_element.pyx`, namely the use of `iteritems`. Has this not been fixed by `from six import iteritems` because it is a Cython file?

Yes, that is correct. I did some other small improvements from things I've learned about Cython recently.

> - Just for curiosity: why are you constructing all Lie algebras by invoking the base class `LieAlgebra`, relying on `LieAlgebra.__classcall_private__` to dispatch to the actual subclass corresponding to the input? Couldn't you use a *function* `LieAlgebra` to do this, as we did for manifolds (cf. the function `Manifold`)? (possibly renaming the class `LieAlgebra` to e.g. `LieAlgebraBase` to avoid any confusion). A drawback of the current setting is that the inline documentation obtained from `LieAlgebra?` returns the `__init__` docstring:
>
>   [snip]
>
>   which does not correspond to the actual arguments to be passed to `LieAlgebra` (because of the `__classcall_private__` mechanism) and therefore may confuse the user. If you want to keep `LieAlgebra.__classcall_private__`, a solution could be to set the `INPUT` section in the docstring of the `LieAlgebra` class. 

Because this is both the main entry point and the common base class, so there is no reason to separate the two IMO. It also avoids documentation duplication. Additionally the main docstring is (or at least should be) the class-level docstring, which has lots of different possible inputs first as examples. I agree it is a minor drawback that the `__init__` does get included, but it is way at the bottom. However, the possible inputs are quite varied, so writing an `INPUT` block complicated.



---

archive/issue_comments_218595.json:
```json
{
    "body": "Replying to [comment:113 tscrim]:\n> Replying to [comment:110 egourgoulhon]:\n> > - Regarding Heisenberg Lie algebras:\n> >   Shouldn't z be part of the tuple of generators returned by `gens`?\n> \n> I went the other way and dropped `z` from `lie_algebra_generators` since I wanted a more minimal generating set.\n\nI agree. Accordingly, it may be worth to change the documentation of `HeisenbergAlgebra.z()` to something like \"the basis element z\".\n\nStill with Heisenberg algebras, we have\n\n```\nsage: L = lie_algebras.Heisenberg(QQ, 2)\nsage: L.center()\nAttributeError: 'HeisenbergAlgebra_with_category' object has no attribute 'basis_matrix'\n```\n\n\nAnother issue arises because of the `m[1]` in line 136 of `heisenberg.py`::\n\n```\nsage: H = lie_algebras.Heisenberg(QQ, 10)\nsage: p10 = H.gen(9); p10\np10\nsage: latex(p10)\np_{1}\n```\n\n> > A drawback of the current setting is that the inline documentation obtained from `LieAlgebra?` returns the `__init__` docstring, which does not correspond to the actual arguments to be passed to `LieAlgebra` (because of the `__classcall_private__` mechanism) and therefore may confuse the user. If you want to keep `LieAlgebra.__classcall_private__`, a solution could be to set the `INPUT` section in the docstring of the `LieAlgebra` class. \n> \n> Because this is both the main entry point and the common base class, so there is no reason to separate the two IMO. It also avoids documentation duplication. Additionally the main docstring is (or at least should be) the class-level docstring, which has lots of different possible inputs first as examples. I agree it is a minor drawback that the `__init__` does get included, but it is way at the bottom. \n\nThanks for these explanations.  \n\n> However, the possible inputs are quite varied, so writing an `INPUT` block complicated.\n\nBut isn't it the point of a reference manual to provide an exhaustive list of all possible inputs? Maybe it is too much in this case; if you think that the provided examples perform a sufficient coverage, then it is fine for me.",
    "created_at": "2017-03-28T14:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218595",
    "user": "egourgoulhon"
}
```

Replying to [comment:113 tscrim]:
> Replying to [comment:110 egourgoulhon]:
> > - Regarding Heisenberg Lie algebras:
> >   Shouldn't z be part of the tuple of generators returned by `gens`?
> 
> I went the other way and dropped `z` from `lie_algebra_generators` since I wanted a more minimal generating set.

I agree. Accordingly, it may be worth to change the documentation of `HeisenbergAlgebra.z()` to something like "the basis element z".

Still with Heisenberg algebras, we have

```
sage: L = lie_algebras.Heisenberg(QQ, 2)
sage: L.center()
AttributeError: 'HeisenbergAlgebra_with_category' object has no attribute 'basis_matrix'
```


Another issue arises because of the `m[1]` in line 136 of `heisenberg.py`::

```
sage: H = lie_algebras.Heisenberg(QQ, 10)
sage: p10 = H.gen(9); p10
p10
sage: latex(p10)
p_{1}
```

> > A drawback of the current setting is that the inline documentation obtained from `LieAlgebra?` returns the `__init__` docstring, which does not correspond to the actual arguments to be passed to `LieAlgebra` (because of the `__classcall_private__` mechanism) and therefore may confuse the user. If you want to keep `LieAlgebra.__classcall_private__`, a solution could be to set the `INPUT` section in the docstring of the `LieAlgebra` class. 
> 
> Because this is both the main entry point and the common base class, so there is no reason to separate the two IMO. It also avoids documentation duplication. Additionally the main docstring is (or at least should be) the class-level docstring, which has lots of different possible inputs first as examples. I agree it is a minor drawback that the `__init__` does get included, but it is way at the bottom. 

Thanks for these explanations.  

> However, the possible inputs are quite varied, so writing an `INPUT` block complicated.

But isn't it the point of a reference manual to provide an exhaustive list of all possible inputs? Maybe it is too much in this case; if you think that the provided examples perform a sufficient coverage, then it is fine for me.



---

archive/issue_comments_218596.json:
```json
{
    "body": "Returning for a little bit of bikeshedding:\n\n- \"cosnstructed\" in heisenberg.py.\n\n- There is a bunch of TODOs in lie_algebra_element.pyx. Are they all still up-to-date?\n\n- In lie_algebra_element.pyx, is `self == 0 or y == 0` really the right thing? I thought we had `is_zero()` for testing zero without triggering a rube goldberg machine of coercions.\n\n- In lie_algebra_element.pyx, in class `StructureCoefficientsElement` method `cpdef _bracket_(self, right)`, why not switch the next two statements:\n\n```\n+                prod_c1_c2 = c1 * c2\n+                if not c2:\n+                    pass\n```\n\nActually, is `pass` the right thing here, rather than `continue`? I thought `pass` is just a nop; or is this a Cython oddity? (Same for the `if not c1` a few lines earlier.)",
    "created_at": "2017-03-28T19:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218596",
    "user": "darij"
}
```

Returning for a little bit of bikeshedding:

- "cosnstructed" in heisenberg.py.

- There is a bunch of TODOs in lie_algebra_element.pyx. Are they all still up-to-date?

- In lie_algebra_element.pyx, is `self == 0 or y == 0` really the right thing? I thought we had `is_zero()` for testing zero without triggering a rube goldberg machine of coercions.

- In lie_algebra_element.pyx, in class `StructureCoefficientsElement` method `cpdef _bracket_(self, right)`, why not switch the next two statements:

```
+                prod_c1_c2 = c1 * c2
+                if not c2:
+                    pass
```

Actually, is `pass` the right thing here, rather than `continue`? I thought `pass` is just a nop; or is this a Cython oddity? (Same for the `if not c1` a few lines earlier.)



---

archive/issue_comments_218597.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-29T04:52:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218597",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218598.json:
```json
{
    "body": "Fixes all of comment:114 and comment:115 (the only bikeshedding could be in the `is_zero`, but that might be a better approach, IDK exactly). Currently `center` will not work until `subalgebra` is implemented in generality, you can at least use `L.centralizer_basis(L)`. The remaining TODO comments are the relevant ones.",
    "created_at": "2017-03-29T04:56:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218598",
    "user": "tscrim"
}
```

Fixes all of comment:114 and comment:115 (the only bikeshedding could be in the `is_zero`, but that might be a better approach, IDK exactly). Currently `center` will not work until `subalgebra` is implemented in generality, you can at least use `L.centralizer_basis(L)`. The remaining TODO comments are the relevant ones.



---

archive/issue_comments_218599.json:
```json
{
    "body": "Thanks for the changes. \nIMO the ticket is ready for a positive review. \nDarij, do you agree?",
    "created_at": "2017-03-29T11:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218599",
    "user": "egourgoulhon"
}
```

Thanks for the changes. 
IMO the ticket is ready for a positive review. 
Darij, do you agree?



---

archive/issue_comments_218600.json:
```json
{
    "body": "Building the pdf ref. manual with `./sage -docbuild reference/categories pdf` ends with:\n\n```\n! Extra }, or forgotten $.\nl.29077 and recall that \\(\\mathfrak{g}_k}\n                                          \\supseteq \\mathfrak{g}_{k+1}\\).\n```\n\nApparently, a `{` is missing at the left of the first `k` in line 560 of `src/sage/categories/finite_dimensional_lie_algebras_with_basis.py`.\n \n(sorry I haven't tried this sooner; on its side, `./sage -docbuild reference/algebras pdf` is successfull).",
    "created_at": "2017-03-29T13:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218600",
    "user": "egourgoulhon"
}
```

Building the pdf ref. manual with `./sage -docbuild reference/categories pdf` ends with:

```
! Extra }, or forgotten $.
l.29077 and recall that \(\mathfrak{g}_k}
                                          \supseteq \mathfrak{g}_{k+1}\).
```

Apparently, a `{` is missing at the left of the first `k` in line 560 of `src/sage/categories/finite_dimensional_lie_algebras_with_basis.py`.
 
(sorry I haven't tried this sooner; on its side, `./sage -docbuild reference/algebras pdf` is successfull).



---

archive/issue_comments_218601.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-29T13:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218601",
    "user": "egourgoulhon"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218602.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-29T13:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218602",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218603.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-29T13:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218603",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218604.json:
```json
{
    "body": "Fixed the pdf docbuild.",
    "created_at": "2017-03-29T13:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218604",
    "user": "tscrim"
}
```

Fixed the pdf docbuild.



---

archive/issue_comments_218605.json:
```json
{
    "body": "Replying to [comment:121 tscrim]:\n> Fixed the pdf docbuild.\nThanks. \nI'm back in the positive review mood then.",
    "created_at": "2017-03-29T14:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218605",
    "user": "egourgoulhon"
}
```

Replying to [comment:121 tscrim]:
> Fixed the pdf docbuild.
Thanks. 
I'm back in the positive review mood then.



---

archive/issue_comments_218606.json:
```json
{
    "body": "Thanks for the fixes, Travis!\n\n\n```\n+        def product_space(self, L):\n+            r\"\"\"\n+            Return the product space ``[self, L]``.\n+\n+            EXAMPLES::\n+\n+                sage: L = LieAlgebras(QQ).FiniteDimensional().WithBasis().example()\n+                sage: a,b,c = L.lie_algebra_generators()\n+                sage: X = L.subalgebra([a, b+c])\n+                sage: L.product_space(X)\n+                An example of a finite dimensional Lie algebra with basis:\n+                 the 0-dimensional abelian Lie algebra over Rational Field\n+                 with basis matrix:\n+                []\n+                sage: Y = L.subalgebra([a, 2*b-c])\n+                sage: X.product_space(Y)\n+                An example of a finite dimensional Lie algebra with basis:\n+                 the 0-dimensional abelian Lie algebra over Rational\n+                 Field with basis matrix:\n+                []\n+\n+            ::\n+\n+                sage: L.<x,y> = LieAlgebra(QQ, {('x','y'):{'x':1}})\n+                sage: Lp = L.product_space(L) # todo: not implemented - #17416\n+                sage: Lp # todo: not implemented - #17416\n+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:\n+                (x,)\n+                sage: Lp.product_space(L) # todo: not implemented - #17416\n+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:\n+                (x,)\n+                sage: L.product_space(Lp) # todo: not implemented - #17416\n+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:\n+                (x,)\n+                sage: Lp.product_space(Lp) # todo: not implemented - #17416\n+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:\n+                ()\n+            \"\"\"\n+            # Make sure we lift everything to the ambient space\n+            try:\n+                A = self._ambient\n+            except AttributeError:\n+                try:\n+                    A = L._ambient\n+                except AttributeError:\n+                    A = self\n+\n+            B = self.basis()\n+            LB = L.basis()\n+            K = B.keys()\n+            LK = LB.keys()\n+            # We echelonize the matrix here\n+            # TODO: Do we want to?\n+            b_mat = matrix(A.base_ring(), [A.bracket(B[a], LB[b]).to_vector()\n+                                           for a in K for b in LK])\n+            b_mat.echelonize()\n+            r = b_mat.rank()\n+            I = A._basis_ordering\n+            gens = [A.from_vector(row) for row in b_mat.rows()[:r]]\n+            return A.subalgebra(gens)\n```\n\nI don't see why this should be a subalgebra (it is just a vector subspace). Counterexamples can easily be obtained if self (e.g.) is a free Lie algbera and L is the span of a single generator. (And that's just for the case when self and L both are Lie subalgebras; but the method is probably useful in higher generality.)\n\nWhy define `I` if you don't use it? And why define `K` and `LK` if you could just iterate over `B` and `LB`?\n\nAs for echelonization... It will, of course, break over non-fields. But I'm not sure if this function is supposed to apply to non-fields.",
    "created_at": "2017-03-30T16:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218606",
    "user": "darij"
}
```

Thanks for the fixes, Travis!


```
+        def product_space(self, L):
+            r"""
+            Return the product space ``[self, L]``.
+
+            EXAMPLES::
+
+                sage: L = LieAlgebras(QQ).FiniteDimensional().WithBasis().example()
+                sage: a,b,c = L.lie_algebra_generators()
+                sage: X = L.subalgebra([a, b+c])
+                sage: L.product_space(X)
+                An example of a finite dimensional Lie algebra with basis:
+                 the 0-dimensional abelian Lie algebra over Rational Field
+                 with basis matrix:
+                []
+                sage: Y = L.subalgebra([a, 2*b-c])
+                sage: X.product_space(Y)
+                An example of a finite dimensional Lie algebra with basis:
+                 the 0-dimensional abelian Lie algebra over Rational
+                 Field with basis matrix:
+                []
+
+            ::
+
+                sage: L.<x,y> = LieAlgebra(QQ, {('x','y'):{'x':1}})
+                sage: Lp = L.product_space(L) # todo: not implemented - #17416
+                sage: Lp # todo: not implemented - #17416
+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:
+                (x,)
+                sage: Lp.product_space(L) # todo: not implemented - #17416
+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:
+                (x,)
+                sage: L.product_space(Lp) # todo: not implemented - #17416
+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:
+                (x,)
+                sage: Lp.product_space(Lp) # todo: not implemented - #17416
+                Subalgebra generated of Lie algebra on 2 generators (x, y) over Rational Field with basis:
+                ()
+            """
+            # Make sure we lift everything to the ambient space
+            try:
+                A = self._ambient
+            except AttributeError:
+                try:
+                    A = L._ambient
+                except AttributeError:
+                    A = self
+
+            B = self.basis()
+            LB = L.basis()
+            K = B.keys()
+            LK = LB.keys()
+            # We echelonize the matrix here
+            # TODO: Do we want to?
+            b_mat = matrix(A.base_ring(), [A.bracket(B[a], LB[b]).to_vector()
+                                           for a in K for b in LK])
+            b_mat.echelonize()
+            r = b_mat.rank()
+            I = A._basis_ordering
+            gens = [A.from_vector(row) for row in b_mat.rows()[:r]]
+            return A.subalgebra(gens)
```

I don't see why this should be a subalgebra (it is just a vector subspace). Counterexamples can easily be obtained if self (e.g.) is a free Lie algbera and L is the span of a single generator. (And that's just for the case when self and L both are Lie subalgebras; but the method is probably useful in higher generality.)

Why define `I` if you don't use it? And why define `K` and `LK` if you could just iterate over `B` and `LB`?

As for echelonization... It will, of course, break over non-fields. But I'm not sure if this function is supposed to apply to non-fields.



---

archive/issue_comments_218607.json:
```json
{
    "body": "So the current implementation is based upon returning the subalgebra generated by `gens`, but indeed, this is not the right thing to do. So I should add something to check if `L` (and `self`) is an ideal or not. If it is, then the result is again an ideal.\n\nAs for non-fields, it should work (at least over nice enough rings):\n\n```\nsage: M = matrix([[1,2,5,2,3],[4,1,2,3,2],[6,2,3,1,2]])\nsage: M.echelonize()\nsage: M\n[ 1  0  5 16  7]\n[ 0  1  0 -7 -2]\n[ 0  0  9 27 12]\nsage: M.base_ring()\nInteger Ring\n```\n",
    "created_at": "2017-03-30T16:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218607",
    "user": "tscrim"
}
```

So the current implementation is based upon returning the subalgebra generated by `gens`, but indeed, this is not the right thing to do. So I should add something to check if `L` (and `self`) is an ideal or not. If it is, then the result is again an ideal.

As for non-fields, it should work (at least over nice enough rings):

```
sage: M = matrix([[1,2,5,2,3],[4,1,2,3,2],[6,2,3,1,2]])
sage: M.echelonize()
sage: M
[ 1  0  5 16  7]
[ 0  1  0 -7 -2]
[ 0  0  9 27 12]
sage: M.base_ring()
Integer Ring
```




---

archive/issue_comments_218608.json:
```json
{
    "body": "Ah yes, it does work over the integers, though not over an arbitrary ring. Speaks in favor of an optional parameter.\n\nI think there are good use cases for considering [U, V] when it is not a Lie ideal (let alone U and V). So maybe the result should really be just a subspace.",
    "created_at": "2017-03-30T16:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218608",
    "user": "darij"
}
```

Ah yes, it does work over the integers, though not over an arbitrary ring. Speaks in favor of an optional parameter.

I think there are good use cases for considering [U, V] when it is not a Lie ideal (let alone U and V). So maybe the result should really be just a subspace.



---

archive/issue_comments_218609.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-30T17:18:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218609",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218610.json:
```json
{
    "body": "I'm not sure about an optional parameter as that starts making things tricky because I think anything you would do likely has a call to `echelonize` somewhere.\n\nI agree completely that we should allow [U, V] to not just be a Lie ideal, and I have implemented that in the last commit.",
    "created_at": "2017-03-30T17:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218610",
    "user": "tscrim"
}
```

I'm not sure about an optional parameter as that starts making things tricky because I think anything you would do likely has a call to `echelonize` somewhere.

I agree completely that we should allow [U, V] to not just be a Lie ideal, and I have implemented that in the last commit.



---

archive/issue_comments_218611.json:
```json
{
    "body": "Okay. Maybe worth explaining that thing with the base ring in the doc, though.\n\nSomething else:\n\n```\n+        # Do not override this. Instead implement :meth:`_construct_UEA`;\n+        #   then, :meth:`lift` and :meth:`universal_enveloping_algebra`\n+        #   will automatically setup the coercion\n```\n\nI might have already been nagging you about contracts and \"what should I do if I want to set up a UEA for my own handmade Lie algebra\" documentation. The above comment appears to explain it, but I'm not sure if it's enough. Literally it says I should just define `_construct_UEA` and the rest will happen automatically. But don't I also need to define `lift`, as it's otherwise just an abstract method in the base class? And is there a requirement that the base keys for the Lie algebra are a subset of the base keys for the UEA, or can a properly defined `lift` method work around this?",
    "created_at": "2017-03-30T23:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218611",
    "user": "darij"
}
```

Okay. Maybe worth explaining that thing with the base ring in the doc, though.

Something else:

```
+        # Do not override this. Instead implement :meth:`_construct_UEA`;
+        #   then, :meth:`lift` and :meth:`universal_enveloping_algebra`
+        #   will automatically setup the coercion
```

I might have already been nagging you about contracts and "what should I do if I want to set up a UEA for my own handmade Lie algebra" documentation. The above comment appears to explain it, but I'm not sure if it's enough. Literally it says I should just define `_construct_UEA` and the rest will happen automatically. But don't I also need to define `lift`, as it's otherwise just an abstract method in the base class? And is there a requirement that the base keys for the Lie algebra are a subset of the base keys for the UEA, or can a properly defined `lift` method work around this?



---

archive/issue_comments_218612.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-01T18:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218612",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218613.json:
```json
{
    "body": "Replying to [comment:128 darij]:\n> Okay. Maybe worth explaining that thing with the base ring in the doc, though.\n\nIt's better and easier to let it fail in the appropriate way and place. Errors do serve a useful purpose and going crazy in the doc doesn't help, especially when the base code is subject to change without notice.\n\n> Something else:\n> {{{\n> +        # Do not override this. Instead implement :meth:`_construct_UEA`;\n> +        #   then, :meth:`lift` and :meth:`universal_enveloping_algebra`\n> +        #   will automatically setup the coercion\n> }}}\n> I might have already been nagging you about contracts and \"what should I do if I want to set up a UEA for my own handmade Lie algebra\" documentation. The above comment appears to explain it, but I'm not sure if it's enough. Literally it says I should just define `_construct_UEA` and the rest will happen automatically. But don't I also need to define `lift`, as it's otherwise just an abstract method in the base class? And is there a requirement that the base keys for the Lie algebra are a subset of the base keys for the UEA, or can a properly defined `lift` method work around this?\n\nAnswers to all of the above is no. It is actually more generic currently than I mentioned when we talked yesterday. It is clear from the code that one would need to define both `_construct_UEA` and the `lift` method for the elements (again, errors should result in the proper place(s)). However, I added a little more detail about this.",
    "created_at": "2017-04-01T18:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218613",
    "user": "tscrim"
}
```

Replying to [comment:128 darij]:
> Okay. Maybe worth explaining that thing with the base ring in the doc, though.

It's better and easier to let it fail in the appropriate way and place. Errors do serve a useful purpose and going crazy in the doc doesn't help, especially when the base code is subject to change without notice.

> Something else:
> {{{
> +        # Do not override this. Instead implement :meth:`_construct_UEA`;
> +        #   then, :meth:`lift` and :meth:`universal_enveloping_algebra`
> +        #   will automatically setup the coercion
> }}}
> I might have already been nagging you about contracts and "what should I do if I want to set up a UEA for my own handmade Lie algebra" documentation. The above comment appears to explain it, but I'm not sure if it's enough. Literally it says I should just define `_construct_UEA` and the rest will happen automatically. But don't I also need to define `lift`, as it's otherwise just an abstract method in the base class? And is there a requirement that the base keys for the Lie algebra are a subset of the base keys for the UEA, or can a properly defined `lift` method work around this?

Answers to all of the above is no. It is actually more generic currently than I mentioned when we talked yesterday. It is clear from the code that one would need to define both `_construct_UEA` and the `lift` method for the elements (again, errors should result in the proper place(s)). However, I added a little more detail about this.



---

archive/issue_comments_218614.json:
```json
{
    "body": "That clears things up, thanks!\n\nThere's a \"the the\" in the doc you just added. Aaaand no more nitpicking from me on this particular ticket :)",
    "created_at": "2017-04-01T21:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218614",
    "user": "darij"
}
```

That clears things up, thanks!

There's a "the the" in the doc you just added. Aaaand no more nitpicking from me on this particular ticket :)



---

archive/issue_comments_218615.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-01T21:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218615",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218616.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-01T21:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218616",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218617.json:
```json
{
    "body": "I am going to interpret that as a positive review (since I fixed the \"the the\"). Thank you very much to both of you!!!",
    "created_at": "2017-04-01T21:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218617",
    "user": "tscrim"
}
```

I am going to interpret that as a positive review (since I fixed the "the the"). Thank you very much to both of you!!!



---

archive/issue_comments_218618.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-04-01T23:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218618",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_218619.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-04-01T23:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218619",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_218620.json:
```json
{
    "body": "Trivial change due to failing doctest from patchbot.",
    "created_at": "2017-04-01T23:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218620",
    "user": "tscrim"
}
```

Trivial change due to failing doctest from patchbot.



---

archive/issue_comments_218621.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-01T23:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218621",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218622.json:
```json
{
    "body": "Replying to [comment:133 tscrim]:\n> I am going to interpret that as a positive review (since I fixed the \"the the\"). Thank you very much to both of you!!!\n\nThanks and congratulations for your work. This is a great enhancement arriving in Sage!",
    "created_at": "2017-04-02T17:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218622",
    "user": "egourgoulhon"
}
```

Replying to [comment:133 tscrim]:
> I am going to interpret that as a positive review (since I fixed the "the the"). Thank you very much to both of you!!!

Thanks and congratulations for your work. This is a great enhancement arriving in Sage!



---

archive/issue_comments_218623.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-05T19:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218623",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_218624.json:
```json
{
    "body": "Print order doesn't seem to be fixed, on OSX:\n\n```\nsage -t --long src/sage/algebras/lie_algebras/virasoro.py\n**********************************************************************\nFile \"src/sage/algebras/lie_algebras/virasoro.py\", line 418, in sage.algebras.lie_algebras.virasoro.VirasoroAlgebra.bracket_on_basis\nFailed example:\n    d.bracket_on_basis(2, -2)\nExpected:\n    -4*d[0] - 1/2*c\nGot:\n    -1/2*c - 4*d[0]\n**********************************************************************\n1 item had failures:\n   1 of   4 in sage.algebras.lie_algebras.virasoro.VirasoroAlgebra.bracket_on_basis\n    [59 tests, 1 failure, 1.51 s]\n```\n",
    "created_at": "2017-04-05T19:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218624",
    "user": "vbraun"
}
```

Print order doesn't seem to be fixed, on OSX:

```
sage -t --long src/sage/algebras/lie_algebras/virasoro.py
**********************************************************************
File "src/sage/algebras/lie_algebras/virasoro.py", line 418, in sage.algebras.lie_algebras.virasoro.VirasoroAlgebra.bracket_on_basis
Failed example:
    d.bracket_on_basis(2, -2)
Expected:
    -4*d[0] - 1/2*c
Got:
    -1/2*c - 4*d[0]
**********************************************************************
1 item had failures:
   1 of   4 in sage.algebras.lie_algebras.virasoro.VirasoroAlgebra.bracket_on_basis
    [59 tests, 1 failure, 1.51 s]
```




---

archive/issue_comments_218625.json:
```json
{
    "body": "Could this be a general issue with the repr of combinatorial free modules whose basis is a `DisjointUnionEnumeratedSets`?\n\nIn other news, it just caught my eye that the overridden `is_ideal` on abelian Lie algebras tacitly assumes that the ambient Lie algebra of `self` is abelian, too (otherwise, `self` is not automatically a Lie ideal just by virtue of being abelian). I don't think this is clear to the user! I should have noticed this earlier :/ Travis, can you fix this or clarify my misunderstanding? Thank you!",
    "created_at": "2017-04-05T20:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218625",
    "user": "darij"
}
```

Could this be a general issue with the repr of combinatorial free modules whose basis is a `DisjointUnionEnumeratedSets`?

In other news, it just caught my eye that the overridden `is_ideal` on abelian Lie algebras tacitly assumes that the ambient Lie algebra of `self` is abelian, too (otherwise, `self` is not automatically a Lie ideal just by virtue of being abelian). I don't think this is clear to the user! I should have noticed this earlier :/ Travis, can you fix this or clarify my misunderstanding? Thank you!



---

archive/issue_comments_218626.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-05T21:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218626",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218627.json:
```json
{
    "body": "It is an issue of comparing a string to an integer. I added a key function that fixes the problem.\n\nThe abelian Lie algebra in the category examples folder, where it is just a toy implementation showing basis features? It is not meant to be a full implementation, just to provide an example of a basic implementation.",
    "created_at": "2017-04-05T21:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218627",
    "user": "tscrim"
}
```

It is an issue of comparing a string to an integer. I added a key function that fixes the problem.

The abelian Lie algebra in the category examples folder, where it is just a toy implementation showing basis features? It is not meant to be a full implementation, just to provide an example of a basic implementation.



---

archive/issue_comments_218628.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-04-05T21:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218628",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218629.json:
```json
{
    "body": "Ah yes, that one. Still would be better if it would raise a NotImplementedError instead.",
    "created_at": "2017-04-05T21:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218629",
    "user": "darij"
}
```

Ah yes, that one. Still would be better if it would raise a NotImplementedError instead.



---

archive/issue_comments_218630.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-05T21:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218630",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218631.json:
```json
{
    "body": "For the record, I disagree as it should be a minimal implementation. However, I have changed it so it punts it up to the category code (which is technically unnecessary now because afterwards I implemented it at the category level). This made me realize we needed to be more restrictive with the `is_ideal` as it would run forever if given an infinite dimensional Lie algebra.",
    "created_at": "2017-04-05T21:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218631",
    "user": "tscrim"
}
```

For the record, I disagree as it should be a minimal implementation. However, I have changed it so it punts it up to the category code (which is technically unnecessary now because afterwards I implemented it at the category level). This made me realize we needed to be more restrictive with the `is_ideal` as it would run forever if given an infinite dimensional Lie algebra.



---

archive/issue_comments_218632.json:
```json
{
    "body": "Nice job with the basis keys -- back to positive review then!",
    "created_at": "2017-04-05T21:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218632",
    "user": "darij"
}
```

Nice job with the basis keys -- back to positive review then!



---

archive/issue_comments_218633.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-05T21:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218633",
    "user": "darij"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218634.json:
```json
{
    "body": "Thank you!",
    "created_at": "2017-04-05T21:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218634",
    "user": "tscrim"
}
```

Thank you!



---

archive/issue_comments_218635.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-07T22:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16583#issuecomment-218635",
    "user": "vbraun"
}
```

Resolution: fixed
