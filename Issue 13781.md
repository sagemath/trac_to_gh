# Issue 13781: Fix doctests that want write access to $HOME

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2013-01-22 14:05:23

Assignee: tbd

CC:  fbissey

In order to make Sage as self-contained as possible, it would be good if Sage would run assuming write access only to $TMPDIR (`/tmp` by default) and $DOT_SAGE (`~/.sage` by default).

In #5155 we already fixed write access to `$SAGE_ROOT`, the only remaining problem is SciPy which wants to write to `$HOME/.python27_compiled`.


---

Comment by jdemeyer created at 2013-01-22 14:11:56

Diff for the SciPy spkg, for review only


---

Attachment


---

Comment by jdemeyer created at 2013-01-22 19:41:37

Changing status from new to needs_review.


---

Comment by fbissey created at 2013-01-22 20:18:29

Not using sage_fortran anymore is good. i am asuming that we have set all the fortran variables either in prereq or the gcc spkg, correct? This is very important for scipy (which will test for any fortran compiler that it knows off including the ones broken because they don't have a license).  Is weave the only file to want access to .pythonxx_compiled? Sounds like an upstream bug to me in any case. I'll give this a closer look from something else than an iPad before approving.


---

Comment by jdemeyer created at 2013-01-22 20:42:30

Replying to [comment:4 fbissey]:
> Is weave the only file to want access to .pythonxx_compiled?
Yes.

> Sounds like an upstream bug to me in any case.
Agreed.


---

Comment by jdemeyer created at 2013-01-22 20:46:38

Replying to [comment:4 fbissey]:
> I am asuming that we have set all the fortran variables either in prereq or the gcc spkg, correct?
Not quite.  If the GCC spkg is installed, then yes, we force the use of Sage's `gfortran`.  If it's not installed, we don't set any variables and let `scipy` figure it out.  That sounds reasonable and in any case seems to work fine for the `R` spkg.


---

Comment by jdemeyer created at 2013-01-23 07:34:38

The Fortran stuff has problems indeed, it seems that SCons does The Wrong Thing on OpenSolaris (which just proves my point again that SCons is utter crap compared to an autotools-based system, R for example compiles Fortran code just fine).


---

Comment by fbissey created at 2013-01-23 08:21:47

It would be easy to make this ticket  a !SCons bashing exercise (I am sure your expressed opinion is watered down compared to your real one and I would be agreeing to the non-watered down too).


---

Comment by jdemeyer created at 2013-01-25 15:29:07

Fran√ßois: any chance you can review this, now that the Fortran problem is solved?


---

Comment by fbissey created at 2013-01-25 19:12:04

Since upstream has approved the patch and all the other issues have been dealt with, I am reviewing this positive. I was going to do test builds but you do more of these than me :)


---

Comment by fbissey created at 2013-01-25 19:12:04

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-01-25 21:20:14

Resolution: fixed
