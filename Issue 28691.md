# Issue 28691: Fix failure in sageinspect.py

archive/issues_028691.json:
```json
{
    "body": "CC:  simonking strogdon\n\nSee report at\n\nhttps://groups.google.com/d/msg/sage-release/B8dQGh5-Zz8/Kh2Gxj5HBgAJ\n\nIssue created by migration from https://trac.sagemath.org/ticket/28928\n\n",
    "created_at": "2019-12-30T17:07:52Z",
    "labels": [
        "cython",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Fix failure in sageinspect.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28691",
    "user": "slelievre"
}
```
CC:  simonking strogdon

See report at

https://groups.google.com/d/msg/sage-release/B8dQGh5-Zz8/Kh2Gxj5HBgAJ

Issue created by migration from https://trac.sagemath.org/ticket/28928





---

archive/issue_comments_405308.json:
```json
{
    "body": "Samuel, I'm puzzled. On the one hand, you say that your Sage is build with Python 2. On the other hand, I see this:\n> {{{\n>       File \"/Users/lelievre/s/sage2gcc/local/lib/python3.7/site-packages/sage/misc/cython.py\",\n> line 524, in cython_import_all\n>         m = cython_import(filename, **kwds)\n>       File \"/Users/lelievre/s/sage2gcc/local/lib/python3.7/site-packages/sage/misc/cython.py\",\n> }}}\n\nSo, it is `$SAGE_LOCAL/lib/python3.7`, not `python2.7`. Is it perhaps the case that you upgraded from an old python-2 version to a python-3 version and didn't do `make distclean`?",
    "created_at": "2020-01-03T10:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405308",
    "user": "SimonKing"
}
```

Samuel, I'm puzzled. On the one hand, you say that your Sage is build with Python 2. On the other hand, I see this:
> {{{
>       File "/Users/lelievre/s/sage2gcc/local/lib/python3.7/site-packages/sage/misc/cython.py",
> line 524, in cython_import_all
>         m = cython_import(filename, **kwds)
>       File "/Users/lelievre/s/sage2gcc/local/lib/python3.7/site-packages/sage/misc/cython.py",
> }}}

So, it is `$SAGE_LOCAL/lib/python3.7`, not `python2.7`. Is it perhaps the case that you upgraded from an old python-2 version to a python-3 version and didn't do `make distclean`?



---

archive/issue_comments_405309.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405309",
    "user": "embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_405310.json:
```json
{
    "body": "Changing type from enhancement to defect.",
    "created_at": "2020-01-06T14:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405310",
    "user": "embray"
}
```

Changing type from enhancement to defect.



---

archive/issue_comments_405311.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2020-01-06T14:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405311",
    "user": "embray"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_405312.json:
```json
{
    "body": "This isn't anything to do with sageinspect.py.  It's a failure with the `cython()` function which happens to be used in a few of the doctests in sageinspect.py.  The problem occurs when trying to import the compiled Python module from the tempfile, which is either not found, or is not compiled or linked properly.  The problem does not have to do with introspection.  As I wrote on the mailing list, is it possible to reproduce this failure outside the doctests? \n\nDitto's Simon's confusion about the build.",
    "created_at": "2020-01-06T14:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405312",
    "user": "embray"
}
```

This isn't anything to do with sageinspect.py.  It's a failure with the `cython()` function which happens to be used in a few of the doctests in sageinspect.py.  The problem occurs when trying to import the compiled Python module from the tempfile, which is either not found, or is not compiled or linked properly.  The problem does not have to do with introspection.  As I wrote on the mailing list, is it possible to reproduce this failure outside the doctests? 

Ditto's Simon's confusion about the build.



---

archive/issue_comments_405313.json:
```json
{
    "body": "Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405313",
    "user": "mkoeppe"
}
```

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_comments_405314.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2021-04-10T22:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405314",
    "user": "mkoeppe"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_405315.json:
```json
{
    "body": "We can close this ticket as outdated. An almost identical failure has been reported in #31626",
    "created_at": "2021-04-10T22:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405315",
    "user": "mkoeppe"
}
```

We can close this ticket as outdated. An almost identical failure has been reported in #31626



---

archive/issue_comments_405316.json:
```json
{
    "body": "Good, I'm glad this was found.",
    "created_at": "2021-04-11T03:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405316",
    "user": "strogdon"
}
```

Good, I'm glad this was found.



---

archive/issue_comments_405317.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-11T03:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405317",
    "user": "strogdon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_405318.json:
```json
{
    "body": "Sorry for a confusing ticket description mentioning Python 2\nbut including a Python 3 traceback.\n\nLet's close this and focus on #31626.",
    "created_at": "2021-04-14T17:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405318",
    "user": "slelievre"
}
```

Sorry for a confusing ticket description mentioning Python 2
but including a Python 3 traceback.

Let's close this and focus on #31626.



---

archive/issue_comments_405319.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2021-04-14T17:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28691#issuecomment-405319",
    "user": "slelievre"
}
```

Resolution: duplicate
