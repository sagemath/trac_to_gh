# Issue 29313: Upgrade to pari 2.11.4

archive/issues_029076.json:
```json
{
    "body": "Unfortunately the update is not trivial. Here are some doctest failures:\n\n```\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 3253, in sage.rings.number_field.number_field.NumberField_generic.ideals_of_bdd_norm\nFailed example:\n    for n in d:\n        print(n)\n        for I in d[n]:\n            print(I)\nExpected:\n    1\n    Fractional ideal (1)\n    2\n    Fractional ideal (2, 1/2*a - 1/2)\n    Fractional ideal (2, 1/2*a + 1/2)\n    3\n    Fractional ideal (3, 1/2*a - 1/2)\n    Fractional ideal (3, 1/2*a + 1/2)\n    4\n    Fractional ideal (4, 1/2*a + 3/2)\n    Fractional ideal (2)\n    Fractional ideal (4, 1/2*a + 5/2)\n    5\n    6\n    Fractional ideal (1/2*a - 1/2)\n    Fractional ideal (6, 1/2*a + 5/2)\n    Fractional ideal (6, 1/2*a + 7/2)\n    Fractional ideal (1/2*a + 1/2)\n    7\n    8\n    Fractional ideal (1/2*a + 3/2)\n    Fractional ideal (4, a - 1)\n    Fractional ideal (4, a + 1)\n    Fractional ideal (1/2*a - 3/2)\n    9\n    Fractional ideal (9, 1/2*a + 11/2)\n    Fractional ideal (3)\n    Fractional ideal (9, 1/2*a + 7/2)\n    10\nGot:\n    1\n    Fractional ideal (1)\n    2\n    Fractional ideal (2, 1/2*a - 1/2)\n    Fractional ideal (2, 1/2*a + 1/2)\n    3\n    Fractional ideal (3, 1/2*a + 1/2)\n    Fractional ideal (3, 1/2*a - 1/2)\n    4\n    Fractional ideal (4, 1/2*a + 3/2)\n    Fractional ideal (2)\n    Fractional ideal (4, 1/2*a + 5/2)\n    5\n    6\n    Fractional ideal (6, 1/2*a + 7/2)\n    Fractional ideal (1/2*a + 1/2)\n    Fractional ideal (1/2*a - 1/2)\n    Fractional ideal (6, 1/2*a + 5/2)\n    7\n    8\n    Fractional ideal (1/2*a + 3/2)\n    Fractional ideal (4, a - 1)\n    Fractional ideal (4, a + 1)\n    Fractional ideal (1/2*a - 3/2)\n    9\n    Fractional ideal (9, 1/2*a + 7/2)\n    Fractional ideal (3)\n    Fractional ideal (9, 1/2*a + 11/2)\n    10\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 4369, in sage.rings.number_field.number_field.NumberField_generic._S_class_group_and_units\nFailed example:\n    K._S_class_group_and_units(tuple(K.primes_above(13)))\nExpected:\n    ([2/13*a^2 + 1/13*a - 677/13,\n      1/13*a^2 + 7/13*a - 332/13,\n      -1/13*a^2 + 6/13*a + 345/13,\n      -1,\n      2/13*a^2 + 1/13*a - 755/13,\n      1/13*a^2 - 19/13*a - 7/13],\n     [(Fractional ideal (11, a - 2), 2), (Fractional ideal (19, a + 7), 2)])\nGot:\n    ([2/13*a^2 + 1/13*a - 677/13,\n      1/13*a^2 + 7/13*a - 332/13,\n      -1/13*a^2 + 6/13*a + 345/13,\n      -1,\n      2/13*a^2 + 1/13*a - 755/13,\n      1/13*a^2 + 20/13*a - 7/13],\n     [(Fractional ideal (11, a - 2), 2), (Fractional ideal (19, a + 7), 2)])\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 4527, in sage.rings.number_field.number_field.NumberField_generic.selmer_group\nFailed example:\n    K.selmer_group(K.primes_above(13), 2)\nExpected:\n    [2/13*a^2 + 1/13*a - 677/13,\n     1/13*a^2 + 7/13*a - 332/13,\n     -1/13*a^2 + 6/13*a + 345/13,\n     -1,\n     2/13*a^2 + 1/13*a - 755/13,\n     1/13*a^2 - 19/13*a - 7/13,\n     -1/13*a^2 + 45/13*a - 97/13,\n     2/13*a^2 + 40/13*a - 27/13]\nGot:\n    [2/13*a^2 + 1/13*a - 677/13,\n     1/13*a^2 + 7/13*a - 332/13,\n     -1/13*a^2 + 6/13*a + 345/13,\n     -1,\n     2/13*a^2 + 1/13*a - 755/13,\n     1/13*a^2 + 20/13*a - 7/13,\n     1/13*a^2 - 45/13*a + 97/13,\n     -2/13*a^2 - 40/13*a + 27/13]\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 5179, in sage.rings.number_field.number_field.NumberField_generic.elements_of_norm\nFailed example:\n    K.elements_of_norm(7)\nExpected:\n    [7/225*a^2 - 7/75*a - 42/25]\nGot:\n    [28/225*a^2 + 77/75*a - 133/25]\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 5282, in sage.rings.number_field.number_field.NumberField_generic.factor\nFailed example:\n    f = L.factor(a + 1); f\nExpected:\n    (Fractional ideal (1/2*a*b - a + 1/2)) * (Fractional ideal (-1/2*a*b - a + 1/2))\nGot:\n    (Fractional ideal (-1/2*b + 1/2*a + 1)) * (Fractional ideal (-1/2*a*b - a + 1/2))\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 6359, in sage.rings.number_field.number_field.NumberField_generic.uniformizer\nFailed example:\n    [K.uniformizer(P) for P,e in factor(K.ideal(7))]\nExpected:\n    [t^2 + 3*t + 1]\nGot:\n    [t^2 - 4*t + 1]\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 6615, in sage.rings.number_field.number_field.NumberField_generic.S_unit_group\nFailed example:\n    U.log(u)\nExpected:\n    (1, 1, 4, 1, 5)\nGot:\n    (0, 1, 4, 1, 5)\n**********************************************************************\nFile \"/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 7599, in sage.rings.number_field.number_field.NumberField_absolute.optimized_representation\nFailed example:\n    K.optimized_representation()\nExpected:\n    (Number Field in a1 with defining polynomial x^3 - 7*x - 7,\n     Ring morphism:\n       From: Number Field in a1 with defining polynomial x^3 - 7*x - 7\n       To:   Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123\n       Defn: a1 |--> 7/225*a^2 - 7/75*a - 42/25,\n     Ring morphism:\n       From: Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123\n       To:   Number Field in a1 with defining polynomial x^3 - 7*x - 7\n       Defn: a |--> -15/7*a1^2 + 9)\nGot:\n    (Number Field in a1 with defining polynomial x^3 - 7*x - 7, Ring morphism:\n       From: Number Field in a1 with defining polynomial x^3 - 7*x - 7\n       To:   Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123\n       Defn: a1 |--> 28/225*a^2 + 77/75*a - 133/25, Ring morphism:\n       From: Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123\n       To:   Number Field in a1 with defining polynomial x^3 - 7*x - 7\n       Defn: a |--> -60/7*a1^2 + 15*a1 + 39)\n**********************************************************************\n8 items had failures:\n   1 of  10 in sage.rings.number_field.number_field.NumberField_absolute.optimized_representation\n   1 of  27 in sage.rings.number_field.number_field.NumberField_generic.S_unit_group\n   1 of   9 in sage.rings.number_field.number_field.NumberField_generic._S_class_group_and_units\n   1 of   6 in sage.rings.number_field.number_field.NumberField_generic.elements_of_norm\n   1 of  15 in sage.rings.number_field.number_field.NumberField_generic.factor\n   1 of   4 in sage.rings.number_field.number_field.NumberField_generic.ideals_of_bdd_norm\n   1 of  32 in sage.rings.number_field.number_field.NumberField_generic.selmer_group\n   1 of  20 in sage.rings.number_field.number_field.NumberField_generic.uniformizer\n    [2076 tests, 8 failures, 52.52 s]\n----------------------------------------------------------------------\nsage -t --long /nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py  # 8 doctests failed\n```\n\nI will not do the update myself in this ticket, I only opened it to notify people of the issues.\n\nTarfile: see checksums_ini [upstream_url]\n\n**CC:**  @antonio-rojas @kiwifb @saraedum @tobihan @fchapoton @embray @jdemeyer @dimpase\n\n**Branch/Commit:** [549e094174b9fb0b2fc5b7462d034f118e3fd1f3](https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3)\n\n**Reviewer:** Dima Pasechnik, Fran\u00e7ois Bissey\n\n**Author:** Antonio Rojas\n\n**Dependencies:** #29472\n\nIssue created by migration from https://trac.sagemath.org/ticket/29313\n\n",
    "closed_at": "2020-07-28T22:34:31Z",
    "created_at": "2020-03-11T10:38:29Z",
    "labels": [
        "component: packages: standard",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "title": "Upgrade to pari 2.11.4",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/29313",
    "user": "https://github.com/timokau"
}
```
Unfortunately the update is not trivial. Here are some doctest failures:

```
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 3253, in sage.rings.number_field.number_field.NumberField_generic.ideals_of_bdd_norm
Failed example:
    for n in d:
        print(n)
        for I in d[n]:
            print(I)
Expected:
    1
    Fractional ideal (1)
    2
    Fractional ideal (2, 1/2*a - 1/2)
    Fractional ideal (2, 1/2*a + 1/2)
    3
    Fractional ideal (3, 1/2*a - 1/2)
    Fractional ideal (3, 1/2*a + 1/2)
    4
    Fractional ideal (4, 1/2*a + 3/2)
    Fractional ideal (2)
    Fractional ideal (4, 1/2*a + 5/2)
    5
    6
    Fractional ideal (1/2*a - 1/2)
    Fractional ideal (6, 1/2*a + 5/2)
    Fractional ideal (6, 1/2*a + 7/2)
    Fractional ideal (1/2*a + 1/2)
    7
    8
    Fractional ideal (1/2*a + 3/2)
    Fractional ideal (4, a - 1)
    Fractional ideal (4, a + 1)
    Fractional ideal (1/2*a - 3/2)
    9
    Fractional ideal (9, 1/2*a + 11/2)
    Fractional ideal (3)
    Fractional ideal (9, 1/2*a + 7/2)
    10
Got:
    1
    Fractional ideal (1)
    2
    Fractional ideal (2, 1/2*a - 1/2)
    Fractional ideal (2, 1/2*a + 1/2)
    3
    Fractional ideal (3, 1/2*a + 1/2)
    Fractional ideal (3, 1/2*a - 1/2)
    4
    Fractional ideal (4, 1/2*a + 3/2)
    Fractional ideal (2)
    Fractional ideal (4, 1/2*a + 5/2)
    5
    6
    Fractional ideal (6, 1/2*a + 7/2)
    Fractional ideal (1/2*a + 1/2)
    Fractional ideal (1/2*a - 1/2)
    Fractional ideal (6, 1/2*a + 5/2)
    7
    8
    Fractional ideal (1/2*a + 3/2)
    Fractional ideal (4, a - 1)
    Fractional ideal (4, a + 1)
    Fractional ideal (1/2*a - 3/2)
    9
    Fractional ideal (9, 1/2*a + 7/2)
    Fractional ideal (3)
    Fractional ideal (9, 1/2*a + 11/2)
    10
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 4369, in sage.rings.number_field.number_field.NumberField_generic._S_class_group_and_units
Failed example:
    K._S_class_group_and_units(tuple(K.primes_above(13)))
Expected:
    ([2/13*a^2 + 1/13*a - 677/13,
      1/13*a^2 + 7/13*a - 332/13,
      -1/13*a^2 + 6/13*a + 345/13,
      -1,
      2/13*a^2 + 1/13*a - 755/13,
      1/13*a^2 - 19/13*a - 7/13],
     [(Fractional ideal (11, a - 2), 2), (Fractional ideal (19, a + 7), 2)])
Got:
    ([2/13*a^2 + 1/13*a - 677/13,
      1/13*a^2 + 7/13*a - 332/13,
      -1/13*a^2 + 6/13*a + 345/13,
      -1,
      2/13*a^2 + 1/13*a - 755/13,
      1/13*a^2 + 20/13*a - 7/13],
     [(Fractional ideal (11, a - 2), 2), (Fractional ideal (19, a + 7), 2)])
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 4527, in sage.rings.number_field.number_field.NumberField_generic.selmer_group
Failed example:
    K.selmer_group(K.primes_above(13), 2)
Expected:
    [2/13*a^2 + 1/13*a - 677/13,
     1/13*a^2 + 7/13*a - 332/13,
     -1/13*a^2 + 6/13*a + 345/13,
     -1,
     2/13*a^2 + 1/13*a - 755/13,
     1/13*a^2 - 19/13*a - 7/13,
     -1/13*a^2 + 45/13*a - 97/13,
     2/13*a^2 + 40/13*a - 27/13]
Got:
    [2/13*a^2 + 1/13*a - 677/13,
     1/13*a^2 + 7/13*a - 332/13,
     -1/13*a^2 + 6/13*a + 345/13,
     -1,
     2/13*a^2 + 1/13*a - 755/13,
     1/13*a^2 + 20/13*a - 7/13,
     1/13*a^2 - 45/13*a + 97/13,
     -2/13*a^2 - 40/13*a + 27/13]
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 5179, in sage.rings.number_field.number_field.NumberField_generic.elements_of_norm
Failed example:
    K.elements_of_norm(7)
Expected:
    [7/225*a^2 - 7/75*a - 42/25]
Got:
    [28/225*a^2 + 77/75*a - 133/25]
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 5282, in sage.rings.number_field.number_field.NumberField_generic.factor
Failed example:
    f = L.factor(a + 1); f
Expected:
    (Fractional ideal (1/2*a*b - a + 1/2)) * (Fractional ideal (-1/2*a*b - a + 1/2))
Got:
    (Fractional ideal (-1/2*b + 1/2*a + 1)) * (Fractional ideal (-1/2*a*b - a + 1/2))
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 6359, in sage.rings.number_field.number_field.NumberField_generic.uniformizer
Failed example:
    [K.uniformizer(P) for P,e in factor(K.ideal(7))]
Expected:
    [t^2 + 3*t + 1]
Got:
    [t^2 - 4*t + 1]
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 6615, in sage.rings.number_field.number_field.NumberField_generic.S_unit_group
Failed example:
    U.log(u)
Expected:
    (1, 1, 4, 1, 5)
Got:
    (0, 1, 4, 1, 5)
**********************************************************************
File "/nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 7599, in sage.rings.number_field.number_field.NumberField_absolute.optimized_representation
Failed example:
    K.optimized_representation()
Expected:
    (Number Field in a1 with defining polynomial x^3 - 7*x - 7,
     Ring morphism:
       From: Number Field in a1 with defining polynomial x^3 - 7*x - 7
       To:   Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123
       Defn: a1 |--> 7/225*a^2 - 7/75*a - 42/25,
     Ring morphism:
       From: Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123
       To:   Number Field in a1 with defining polynomial x^3 - 7*x - 7
       Defn: a |--> -15/7*a1^2 + 9)
Got:
    (Number Field in a1 with defining polynomial x^3 - 7*x - 7, Ring morphism:
       From: Number Field in a1 with defining polynomial x^3 - 7*x - 7
       To:   Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123
       Defn: a1 |--> 28/225*a^2 + 77/75*a - 133/25, Ring morphism:
       From: Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123
       To:   Number Field in a1 with defining polynomial x^3 - 7*x - 7
       Defn: a |--> -60/7*a1^2 + 15*a1 + 39)
**********************************************************************
8 items had failures:
   1 of  10 in sage.rings.number_field.number_field.NumberField_absolute.optimized_representation
   1 of  27 in sage.rings.number_field.number_field.NumberField_generic.S_unit_group
   1 of   9 in sage.rings.number_field.number_field.NumberField_generic._S_class_group_and_units
   1 of   6 in sage.rings.number_field.number_field.NumberField_generic.elements_of_norm
   1 of  15 in sage.rings.number_field.number_field.NumberField_generic.factor
   1 of   4 in sage.rings.number_field.number_field.NumberField_generic.ideals_of_bdd_norm
   1 of  32 in sage.rings.number_field.number_field.NumberField_generic.selmer_group
   1 of  20 in sage.rings.number_field.number_field.NumberField_generic.uniformizer
    [2076 tests, 8 failures, 52.52 s]
----------------------------------------------------------------------
sage -t --long /nix/store/vqiiwb9rzmzh97gzx1wmvqyiy9d5qhxj-sage-src-8.9/src/sage/rings/number_field/number_field.py  # 8 doctests failed
```

I will not do the update myself in this ticket, I only opened it to notify people of the issues.

Tarfile: see checksums_ini [upstream_url]

**CC:**  @antonio-rojas @kiwifb @saraedum @tobihan @fchapoton @embray @jdemeyer @dimpase

**Branch/Commit:** [549e094174b9fb0b2fc5b7462d034f118e3fd1f3](https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3)

**Reviewer:** Dima Pasechnik, Fran√ßois Bissey

**Author:** Antonio Rojas

**Dependencies:** #29472

Issue created by migration from https://trac.sagemath.org/ticket/29313





---

archive/issue_comments_462453.json:
```json
{
    "body": "<a id='comment:1'></a>\nAlready updated on Arch. Some of the failures are actual incorrect results which are due to a pari bug fixed in [1]. The remaining ones are due to changes in chosen ideal generators, and in computation precision. Those just need the doctests to be updated.\n\n[1] https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=c7a1d35f382e96ddf14694be27a0ca5746880700\n\nWill post a branch when I have some free time unless someone beats me to it.",
    "created_at": "2020-03-11T10:51:24Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462453",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:1'></a>
Already updated on Arch. Some of the failures are actual incorrect results which are due to a pari bug fixed in [1]. The remaining ones are due to changes in chosen ideal generators, and in computation precision. Those just need the doctests to be updated.

[1] https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=c7a1d35f382e96ddf14694be27a0ca5746880700

Will post a branch when I have some free time unless someone beats me to it.



---

archive/issue_comments_462454.json:
```json
{
    "body": "<a id='comment:2'></a>\nI just now noticed #28424 (missed it initially because I searched for pari 2.11.3 in particular). That ticket proposes an update to 2.12 though, which is still in beta and probably harder to do. So I think we can keep this open.",
    "created_at": "2020-03-11T10:53:09Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462454",
    "user": "https://github.com/timokau"
}
```

<a id='comment:2'></a>
I just now noticed #28424 (missed it initially because I searched for pari 2.11.3 in particular). That ticket proposes an update to 2.12 though, which is still in beta and probably harder to do. So I think we can keep this open.



---

archive/issue_comments_462455.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [arojas](#comment%3A1):\n> Already updated on Arch. Some of the failures are actual incorrect results which are due to a pari bug fixed in [1]. The remaining ones are due to changes in chosen ideal generators, and in computation precision. Those just need the doctests to be updated.\n> \n> [1] https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=c7a1d35f382e96ddf14694be27a0ca5746880700\n> \n> Will post a branch when I have some free time unless someone beats me to it.\n\n\nThats great news, amazing how fast you always come up with those fixes :) For anyone else wondering, [here](https://aur.archlinux.org/cgit/aur.git/plain/sagemath-pari-2.11.3.patch?h=sagemath-git&id=02e1d58bd1cd70935d69a4990469d18be6bd2c43) is Antonio's patch.",
    "created_at": "2020-03-11T10:56:40Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462455",
    "user": "https://github.com/timokau"
}
```

<a id='comment:3'></a>
Replying to [arojas](#comment%3A1):
> Already updated on Arch. Some of the failures are actual incorrect results which are due to a pari bug fixed in [1]. The remaining ones are due to changes in chosen ideal generators, and in computation precision. Those just need the doctests to be updated.
> 
> [1] https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=c7a1d35f382e96ddf14694be27a0ca5746880700
> 
> Will post a branch when I have some free time unless someone beats me to it.


Thats great news, amazing how fast you always come up with those fixes :) For anyone else wondering, [here](https://aur.archlinux.org/cgit/aur.git/plain/sagemath-pari-2.11.3.patch?h=sagemath-git&id=02e1d58bd1cd70935d69a4990469d18be6bd2c43) is Antonio's patch.



---

archive/issue_comments_462456.json:
```json
{
    "body": "<a id='comment:4'></a>\nSince Sage can now use system pari, perhaps 2.11.3 should be blacklisted until this is merged. Ideally, distros shipping 2.11.3 should backport the patch as it is quite a serious bug.",
    "created_at": "2020-03-11T10:57:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462456",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:4'></a>
Since Sage can now use system pari, perhaps 2.11.3 should be blacklisted until this is merged. Ideally, distros shipping 2.11.3 should backport the patch as it is quite a serious bug.



---

archive/issue_comments_462457.json:
```json
{
    "body": "<a id='comment:5'></a>\nOh, I misread your original comment and I thought that you meant the tests were wrong before and 2.11.3 *fixes* the bug. I'll backport the pari fix for nix.",
    "created_at": "2020-03-11T11:23:24Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462457",
    "user": "https://github.com/timokau"
}
```

<a id='comment:5'></a>
Oh, I misread your original comment and I thought that you meant the tests were wrong before and 2.11.3 *fixes* the bug. I'll backport the pari fix for nix.



---

archive/issue_comments_462458.json:
```json
{
    "body": "<a id='comment:6'></a>\nPari 2.11.3 has been released just few days ago, and that bug was fixed last year. Could it be that upstream forgot to include the fix? \n\nWhat's an example of incorrect maths output without that patch?",
    "created_at": "2020-03-11T11:39:41Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462458",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Pari 2.11.3 has been released just few days ago, and that bug was fixed last year. Could it be that upstream forgot to include the fix? 

What's an example of incorrect maths output without that patch?



---

archive/issue_comments_462459.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [dimpase](#comment%3A6):\n> Pari 2.11.3 has been released just few days ago, and that bug was fixed last year. Could it be that upstream forgot to include the fix? \n\n\nYes, they forgot to backport the fix to stable. See [1]\n\n> What's an example of incorrect maths output without that patch?\n\n\nYou have some examples in [1] and [2]\n\n[1] https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2208\n\n[2] https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2164\n\nThis causes a few failures in Sage. Among other things, simon's scripts are totally broken.",
    "created_at": "2020-03-11T11:43:23Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462459",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:7'></a>
Replying to [dimpase](#comment%3A6):
> Pari 2.11.3 has been released just few days ago, and that bug was fixed last year. Could it be that upstream forgot to include the fix? 


Yes, they forgot to backport the fix to stable. See [1]

> What's an example of incorrect maths output without that patch?


You have some examples in [1] and [2]

[1] https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2208

[2] https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2164

This causes a few failures in Sage. Among other things, simon's scripts are totally broken.



---

archive/issue_comments_462460.json:
```json
{
    "body": "<a id='comment:8'></a>\nWhen patching pari with [1] and sage with [2] I still get at least one doctest failure (I only tested the number_fields.py file for now):\n\n```\nsage -t --long /nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py\n**********************************************************************\nFile \"/nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 6615, in sage.rings.number_field.number_field.NumberField_generic.S_unit_group\nFailed example:\n    U.log(u)\nExpected:\n    (1, 1, 4, 1, 5)\nGot:\n    (0, 1, 4, 1, 5)\n**********************************************************************\n1 item had failures:\n   1 of  27 in sage.rings.number_field.number_field.NumberField_generic.S_unit_group\n    [2076 tests, 1 failure, 54.23 s]\n```\n\nAm I missing something?\n\n\n[1] https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=patch;h=c7a1d35f382e96ddf14694be27a0ca5746880700\n\n[2] https://aur.archlinux.org/cgit/aur.git/plain/sagemath-pari-2.11.3.patch?h=sagemath-git&id=02e1d58bd1cd70935d69a4990469d18be6bd2c43",
    "created_at": "2020-03-11T17:36:40Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462460",
    "user": "https://github.com/timokau"
}
```

<a id='comment:8'></a>
When patching pari with [1] and sage with [2] I still get at least one doctest failure (I only tested the number_fields.py file for now):

```
sage -t --long /nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py
**********************************************************************
File "/nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 6615, in sage.rings.number_field.number_field.NumberField_generic.S_unit_group
Failed example:
    U.log(u)
Expected:
    (1, 1, 4, 1, 5)
Got:
    (0, 1, 4, 1, 5)
**********************************************************************
1 item had failures:
   1 of  27 in sage.rings.number_field.number_field.NumberField_generic.S_unit_group
    [2076 tests, 1 failure, 54.23 s]
```

Am I missing something?


[1] https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=patch;h=c7a1d35f382e96ddf14694be27a0ca5746880700

[2] https://aur.archlinux.org/cgit/aur.git/plain/sagemath-pari-2.11.3.patch?h=sagemath-git&id=02e1d58bd1cd70935d69a4990469d18be6bd2c43



---

archive/issue_comments_462461.json:
```json
{
    "body": "<a id='comment:9'></a>\nGiven that this seem to be a serious bug, can we expect upstream to release 2.11.4 shortly to fix it?",
    "created_at": "2020-03-11T19:58:46Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462461",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Given that this seem to be a serious bug, can we expect upstream to release 2.11.4 shortly to fix it?



---

archive/issue_comments_462462.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [gh-timokau](#comment%3A8):\n> When patching pari with [1] and sage with [2] I still get at least one doctest failure (I only tested the number_fields.py file for now):\n> \n> ```\n> sage -t --long /nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py\n> **********************************************************************\n> File \"/nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py\", line 6615, in sage.rings.number_field.number_field.NumberField_generic.S_unit_group\n> Failed example:\n>     U.log(u)\n> Expected:\n>     (1, 1, 4, 1, 5)\n> Got:\n>     (0, 1, 4, 1, 5)\n> **********************************************************************\n> 1 item had failures:\n>    1 of  27 in sage.rings.number_field.number_field.NumberField_generic.S_unit_group\n>     [2076 tests, 1 failure, 54.23 s]\n> ```\n> \n> Am I missing something?\n\n\nThat's one of the failures that should be fixed with pari's patch, are you sure you're running the patched version?",
    "created_at": "2020-03-12T08:24:15Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462462",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:10'></a>
Replying to [gh-timokau](#comment%3A8):
> When patching pari with [1] and sage with [2] I still get at least one doctest failure (I only tested the number_fields.py file for now):
> 
> ```
> sage -t --long /nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py
> **********************************************************************
> File "/nix/store/nsvlj78rfc0s8077drna9xw54xw2z50v-sage-src-8.9/src/sage/rings/number_field/number_field.py", line 6615, in sage.rings.number_field.number_field.NumberField_generic.S_unit_group
> Failed example:
>     U.log(u)
> Expected:
>     (1, 1, 4, 1, 5)
> Got:
>     (0, 1, 4, 1, 5)
> **********************************************************************
> 1 item had failures:
>    1 of  27 in sage.rings.number_field.number_field.NumberField_generic.S_unit_group
>     [2076 tests, 1 failure, 54.23 s]
> ```
> 
> Am I missing something?


That's one of the failures that should be fixed with pari's patch, are you sure you're running the patched version?



---

archive/issue_comments_462463.json:
```json
{
    "body": "<a id='comment:11'></a>\nNo, I wasn't. I had a typo (\"patch\" instead of \"patches\") that resulted in the patch silently being ignored. Sorry for the noise.\n\nAs an aside, the upstream patch doesn't quite apply cleanly but the arch patch [1] is rebased. Thanks!\n\n[1] https://git.archlinux.org/svntogit/community.git/plain/repos/community-x86_64/c7a1d35f.patch?h=packages/pari&id=27893d227290dc3821d68aa25877d9765c204dad",
    "created_at": "2020-03-12T10:26:21Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462463",
    "user": "https://github.com/timokau"
}
```

<a id='comment:11'></a>
No, I wasn't. I had a typo ("patch" instead of "patches") that resulted in the patch silently being ignored. Sorry for the noise.

As an aside, the upstream patch doesn't quite apply cleanly but the arch patch [1] is rebased. Thanks!

[1] https://git.archlinux.org/svntogit/community.git/plain/repos/community-x86_64/c7a1d35f.patch?h=packages/pari&id=27893d227290dc3821d68aa25877d9765c204dad



---

archive/issue_comments_462464.json:
```json
{
    "body": "**Branch:** [u/arojas/upgrade_to_pari_2_11_3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_to_pari_2_11_3)",
    "created_at": "2020-03-13T23:37:23Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462464",
    "user": "https://github.com/antonio-rojas"
}
```

**Branch:** [u/arojas/upgrade_to_pari_2_11_3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_to_pari_2_11_3)



---

archive/issue_comments_462465.json:
```json
{
    "body": "**Commit:** [ce42f11db5d1d31fee916013492d69d56a6572c5](https://github.com/sagemath/sagetrac-mirror/commit/ce42f11db5d1d31fee916013492d69d56a6572c5)",
    "created_at": "2020-03-13T23:41:08Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462465",
    "user": "https://github.com/antonio-rojas"
}
```

**Commit:** [ce42f11db5d1d31fee916013492d69d56a6572c5](https://github.com/sagemath/sagetrac-mirror/commit/ce42f11db5d1d31fee916013492d69d56a6572c5)



---

archive/issue_comments_462466.json:
```json
{
    "body": "<a id='comment:13'></a>\nNeeds testing for the check_functional_equation() output on 32 bits, i've only checked 64 bits. Also, some elliptic curves expert should check if the changes in elliptic_curves/ell_number_field.py are mathematically correct. All other ones seem OK to me.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ba1ea86fe58d0123f240f5cd68694d619e0d184\">4ba1ea8</a></td><td><code>Update pari to 2.11.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d934a82f2d9c46f0afedd84487be1721b3466850\">d934a82</a></td><td><code>Remove wrong patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce42f11db5d1d31fee916013492d69d56a6572c5\">ce42f11</a></td><td><code>Adjust doctests for new output with pari 2.11.3</code></td></tr></table>\n",
    "created_at": "2020-03-13T23:41:08Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462466",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:13'></a>
Needs testing for the check_functional_equation() output on 32 bits, i've only checked 64 bits. Also, some elliptic curves expert should check if the changes in elliptic_curves/ell_number_field.py are mathematically correct. All other ones seem OK to me.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ba1ea86fe58d0123f240f5cd68694d619e0d184">4ba1ea8</a></td><td><code>Update pari to 2.11.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d934a82f2d9c46f0afedd84487be1721b3466850">d934a82</a></td><td><code>Remove wrong patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce42f11db5d1d31fee916013492d69d56a6572c5">ce42f11</a></td><td><code>Adjust doctests for new output with pari 2.11.3</code></td></tr></table>




---

archive/issue_comments_462467.json:
```json
{
    "body": "**Author:** Antonio Rojas",
    "created_at": "2020-03-13T23:41:08Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462467",
    "user": "https://github.com/antonio-rojas"
}
```

**Author:** Antonio Rojas



---

archive/issue_events_260751.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2020-03-13T23:41:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260751"
}
```



---

archive/issue_comments_462468.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe way I understand the configuration, once this ticket is through, it will reject a system pari unless it is at least version 2.11.3. Is this correct?",
    "created_at": "2020-04-03T18:18:04Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462468",
    "user": "https://github.com/kliem"
}
```

<a id='comment:14'></a>
The way I understand the configuration, once this ticket is through, it will reject a system pari unless it is at least version 2.11.3. Is this correct?



---

archive/issue_comments_462469.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [gh-kliem](#comment%3A14):\n> The way I understand the configuration, once this ticket is through, it will reject a system pari unless it is at least version 2.11.3. Is this correct?\n\n\nNo, the minimum pari system version is defined in spkg-configure and is independent of the version bundled in sage",
    "created_at": "2020-04-03T20:02:17Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462469",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:15'></a>
Replying to [gh-kliem](#comment%3A14):
> The way I understand the configuration, once this ticket is through, it will reject a system pari unless it is at least version 2.11.3. Is this correct?


No, the minimum pari system version is defined in spkg-configure and is independent of the version bundled in sage



---

archive/issue_comments_462470.json:
```json
{
    "body": "<a id='comment:16'></a>\nOk, then I get why you want sage's test to be work with pari 2.11.3 and previous versions.\n\nDo you want this to be done in this ticket or in a seperate ticket?",
    "created_at": "2020-04-03T20:10:05Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462470",
    "user": "https://github.com/kliem"
}
```

<a id='comment:16'></a>
Ok, then I get why you want sage's test to be work with pari 2.11.3 and previous versions.

Do you want this to be done in this ticket or in a seperate ticket?



---

archive/issue_comments_462471.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [gh-kliem](#comment%3A16):\n> Ok, then I get why you want sage's test to be work with pari 2.11.3 and previous versions.\n> \n> Do you want this to be done in this ticket or in a seperate ticket?\n\n\nI don't really mind as long as I can get rid of my downstream patch. Feel free to take over this branch and modify the test results so they pass with both versions.",
    "created_at": "2020-04-04T12:00:40Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462471",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:17'></a>
Replying to [gh-kliem](#comment%3A16):
> Ok, then I get why you want sage's test to be work with pari 2.11.3 and previous versions.
> 
> Do you want this to be done in this ticket or in a seperate ticket?


I don't really mind as long as I can get rid of my downstream patch. Feel free to take over this branch and modify the test results so they pass with both versions.



---

archive/issue_comments_462472.json:
```json
{
    "body": "**Dependencies:** #29472",
    "created_at": "2020-04-06T16:25:40Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462472",
    "user": "https://github.com/kliem"
}
```

**Dependencies:** #29472



---

archive/issue_comments_462473.json:
```json
{
    "body": "**Changing commit** from \"[ce42f11db5d1d31fee916013492d69d56a6572c5](https://github.com/sagemath/sagetrac-mirror/commit/ce42f11db5d1d31fee916013492d69d56a6572c5)\" to \"[507576f492419feff2c567988c11fb1abddc648f](https://github.com/sagemath/sagetrac-mirror/commit/507576f492419feff2c567988c11fb1abddc648f)\".",
    "created_at": "2020-04-18T12:12:18Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ce42f11db5d1d31fee916013492d69d56a6572c5](https://github.com/sagemath/sagetrac-mirror/commit/ce42f11db5d1d31fee916013492d69d56a6572c5)" to "[507576f492419feff2c567988c11fb1abddc648f](https://github.com/sagemath/sagetrac-mirror/commit/507576f492419feff2c567988c11fb1abddc648f)".



---

archive/issue_comments_462474.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/507576f492419feff2c567988c11fb1abddc648f\">507576f</a></td><td><code>Update to 2.11.4</code></td></tr></table>\n",
    "created_at": "2020-04-18T12:12:18Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462474",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/507576f492419feff2c567988c11fb1abddc648f">507576f</a></td><td><code>Update to 2.11.4</code></td></tr></table>




---

archive/issue_events_260752.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2020-04-18T12:13:16Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "rename": {
        "from": "Upgrade to pari 2.11.3",
        "to": "Upgrade to pari 2.11.4"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260752"
}
```



---

archive/issue_events_260753.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-04T20:06:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260753"
}
```



---

archive/issue_events_260754.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-04T20:06:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260754"
}
```



---

archive/issue_comments_462475.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2020-06-19T11:37:44Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462475",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_comments_462476.json:
```json
{
    "body": "<a id='comment:22'></a>\nplease rebase this over the branch of #29472, as we have a conflict.\n(perhaps, better, rebase both over the recent beta, too)",
    "created_at": "2020-06-19T11:37:44Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462476",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>
please rebase this over the branch of #29472, as we have a conflict.
(perhaps, better, rebase both over the recent beta, too)



---

archive/issue_events_260755.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-19T11:37:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260755"
}
```



---

archive/issue_events_260756.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-19T11:37:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260756"
}
```



---

archive/issue_comments_462477.json:
```json
{
    "body": "**Changing commit** from \"[507576f492419feff2c567988c11fb1abddc648f](https://github.com/sagemath/sagetrac-mirror/commit/507576f492419feff2c567988c11fb1abddc648f)\" to \"[4a23a123580410bca14cfd89d1a22ac21bd094ab](https://github.com/sagemath/sagetrac-mirror/commit/4a23a123580410bca14cfd89d1a22ac21bd094ab)\".",
    "created_at": "2020-06-19T11:58:17Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[507576f492419feff2c567988c11fb1abddc648f](https://github.com/sagemath/sagetrac-mirror/commit/507576f492419feff2c567988c11fb1abddc648f)" to "[4a23a123580410bca14cfd89d1a22ac21bd094ab](https://github.com/sagemath/sagetrac-mirror/commit/4a23a123580410bca14cfd89d1a22ac21bd094ab)".



---

archive/issue_comments_462478.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a23a123580410bca14cfd89d1a22ac21bd094ab\">4a23a12</a></td><td><code>Merge branch 'develop' of git://git.sagemath.org/sage into t/29313/upgrade_to_pari_2_11_3</code></td></tr></table>\n",
    "created_at": "2020-06-19T11:58:17Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462478",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a23a123580410bca14cfd89d1a22ac21bd094ab">4a23a12</a></td><td><code>Merge branch 'develop' of git://git.sagemath.org/sage into t/29313/upgrade_to_pari_2_11_3</code></td></tr></table>




---

archive/issue_comments_462479.json:
```json
{
    "body": "**Changing commit** from \"[4a23a123580410bca14cfd89d1a22ac21bd094ab](https://github.com/sagemath/sagetrac-mirror/commit/4a23a123580410bca14cfd89d1a22ac21bd094ab)\" to \"[dfcdcb0fab6173ab598745e72706b0efa43f2e86](https://github.com/sagemath/sagetrac-mirror/commit/dfcdcb0fab6173ab598745e72706b0efa43f2e86)\".",
    "created_at": "2020-06-19T12:00:10Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462479",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4a23a123580410bca14cfd89d1a22ac21bd094ab](https://github.com/sagemath/sagetrac-mirror/commit/4a23a123580410bca14cfd89d1a22ac21bd094ab)" to "[dfcdcb0fab6173ab598745e72706b0efa43f2e86](https://github.com/sagemath/sagetrac-mirror/commit/dfcdcb0fab6173ab598745e72706b0efa43f2e86)".



---

archive/issue_comments_462480.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dfcdcb0fab6173ab598745e72706b0efa43f2e86\">dfcdcb0</a></td><td><code>Drop test fixes, handled in #29472</code></td></tr></table>\n",
    "created_at": "2020-06-19T12:00:10Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dfcdcb0fab6173ab598745e72706b0efa43f2e86">dfcdcb0</a></td><td><code>Drop test fixes, handled in #29472</code></td></tr></table>




---

archive/issue_comments_462481.json:
```json
{
    "body": "<a id='comment:25'></a>\nplease also apply\n\n```diff\n--- a/build/pkgs/pari/checksums.ini\n+++ b/build/pkgs/pari/checksums.ini\n@@ -2,3 +2,4 @@ tarball=pari-VERSION.tar.gz\n sha1=2b9ff51feb388664b834dc346a44867546c78618\n md5=fb2968d7805424518fe44a59a2024afd\n cksum=1247903778\n+upstream_url=https://pari.math.u-bordeaux.fr/pub/pari/unix/pari-2.11.4.tar.gz\n```",
    "created_at": "2020-06-19T13:07:11Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462481",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>
please also apply

```diff
--- a/build/pkgs/pari/checksums.ini
+++ b/build/pkgs/pari/checksums.ini
@@ -2,3 +2,4 @@ tarball=pari-VERSION.tar.gz
 sha1=2b9ff51feb388664b834dc346a44867546c78618
 md5=fb2968d7805424518fe44a59a2024afd
 cksum=1247903778
+upstream_url=https://pari.math.u-bordeaux.fr/pub/pari/unix/pari-2.11.4.tar.gz
```



---

archive/issue_comments_462482.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3\">549e094</a></td><td><code>Add upstream url</code></td></tr></table>\n",
    "created_at": "2020-06-19T13:16:37Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462482",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3">549e094</a></td><td><code>Add upstream url</code></td></tr></table>




---

archive/issue_comments_462483.json:
```json
{
    "body": "**Changing commit** from \"[dfcdcb0fab6173ab598745e72706b0efa43f2e86](https://github.com/sagemath/sagetrac-mirror/commit/dfcdcb0fab6173ab598745e72706b0efa43f2e86)\" to \"[549e094174b9fb0b2fc5b7462d034f118e3fd1f3](https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3)\".",
    "created_at": "2020-06-19T13:16:37Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462483",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dfcdcb0fab6173ab598745e72706b0efa43f2e86](https://github.com/sagemath/sagetrac-mirror/commit/dfcdcb0fab6173ab598745e72706b0efa43f2e86)" to "[549e094174b9fb0b2fc5b7462d034f118e3fd1f3](https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3)".



---

archive/issue_comments_462484.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -179,3 +179,5 @@\n ```\n \n I will not do the update myself in this ticket, I only opened it to notify people of the issues.\n+\n+Tarfile: see checksums_ini [upstream_url]\n``````\n",
    "created_at": "2020-06-19T13:17:54Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462484",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -179,3 +179,5 @@
 ```
 
 I will not do the update myself in this ticket, I only opened it to notify people of the issues.
+
+Tarfile: see checksums_ini [upstream_url]
``````




---

archive/issue_events_260757.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-19T19:06:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260757"
}
```



---

archive/issue_events_260758.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-19T19:06:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260758"
}
```



---

archive/issue_comments_462485.json:
```json
{
    "body": "<a id='comment:28'></a>\nsome tests on macOS and Cygwin would be great. Perhaps adapting GH Actions to restrict platforms...",
    "created_at": "2020-06-19T19:06:52Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462485",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>
some tests on macOS and Cygwin would be great. Perhaps adapting GH Actions to restrict platforms...



---

archive/issue_comments_462486.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [dimpase](#comment%3A28):\n> Perhaps adapting GH Actions to restrict platforms...\n\nThere's a ticket for that (#29535 - Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names)",
    "created_at": "2020-06-19T19:55:33Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462486",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Replying to [dimpase](#comment%3A28):
> Perhaps adapting GH Actions to restrict platforms...

There's a ticket for that (#29535 - Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names)



---

archive/issue_comments_462487.json:
```json
{
    "body": "<a id='comment:30'></a>\nfor some reason I don't get macOS runs on GH Actions any more. Is it by design, or GH pulled them?",
    "created_at": "2020-06-19T21:38:51Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462487",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>
for some reason I don't get macOS runs on GH Actions any more. Is it by design, or GH pulled them?



---

archive/issue_comments_462488.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [dimpase](#comment%3A30):\n> for some reason I don't get macOS runs on GH Actions any more. Is it by design, or GH pulled them?\n\nNo, works just fine for me -- for example here: https://github.com/mkoeppe/sage/actions/runs/141135018",
    "created_at": "2020-06-19T22:52:47Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462488",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
Replying to [dimpase](#comment%3A30):
> for some reason I don't get macOS runs on GH Actions any more. Is it by design, or GH pulled them?

No, works just fine for me -- for example here: https://github.com/mkoeppe/sage/actions/runs/141135018



---

archive/issue_comments_462489.json:
```json
{
    "body": "<a id='comment:32'></a>\nYou probably need to cancel some of your old queued workflows such as this one: https://github.com/dimpase/sage/runs/784000040?check_suite_focus=true",
    "created_at": "2020-06-19T22:54:37Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462489",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
You probably need to cancel some of your old queued workflows such as this one: https://github.com/dimpase/sage/runs/784000040?check_suite_focus=true



---

archive/issue_comments_462490.json:
```json
{
    "body": "<a id='comment:33'></a>\nWhat's missing on this ticket?",
    "created_at": "2020-07-19T05:44:44Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462490",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
What's missing on this ticket?



---

archive/issue_comments_462491.json:
```json
{
    "body": "<a id='comment:34'></a>\nbasically, someone should bite the bullet and make pari-related doctests less rigid (cf. e.g. the 1st example in the ticket description - it assumes an output order which is not really fixed),so that different versions of pari would still pass.",
    "created_at": "2020-07-19T07:51:04Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462491",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>
basically, someone should bite the bullet and make pari-related doctests less rigid (cf. e.g. the 1st example in the ticket description - it assumes an output order which is not really fixed),so that different versions of pari would still pass.



---

archive/issue_comments_462492.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [dimpase](#comment%3A34):\n> basically, someone should bite the bullet and make pari-related doctests less rigid (cf. e.g. the 1st example in the ticket description - it assumes an output order which is not really fixed),so that different versions of pari would still pass.\n\n\nThat's done in #29472 already",
    "created_at": "2020-07-19T08:32:02Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462492",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:35'></a>
Replying to [dimpase](#comment%3A34):
> basically, someone should bite the bullet and make pari-related doctests less rigid (cf. e.g. the 1st example in the ticket description - it assumes an output order which is not really fixed),so that different versions of pari would still pass.


That's done in #29472 already



---

archive/issue_comments_462493.json:
```json
{
    "body": "<a id='comment:36'></a>\nah, ok, then in principle it should be good to go.",
    "created_at": "2020-07-19T08:35:27Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462493",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>
ah, ok, then in principle it should be good to go.



---

archive/issue_events_260759.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2020-07-19T08:49:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260759"
}
```



---

archive/issue_events_260760.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2020-07-19T08:49:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260760"
}
```



---

archive/issue_comments_462494.json:
```json
{
    "body": "<a id='comment:37'></a>\nBeen using it for a little while in sage-on-gentoo and I don't need any patches for doctests anymore for some time now. So, I am putting this to positive.",
    "created_at": "2020-07-19T08:49:28Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462494",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:37'></a>
Been using it for a little while in sage-on-gentoo and I don't need any patches for doctests anymore for some time now. So, I am putting this to positive.



---

archive/issue_comments_462495.json:
```json
{
    "body": "**Changing reviewer** from \"Dima Pasechnik\" to \"Dima Pasechnik, Fran\u00e7ois Bissey\".",
    "created_at": "2020-07-19T08:49:28Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462495",
    "user": "https://github.com/kiwifb"
}
```

**Changing reviewer** from "Dima Pasechnik" to "Dima Pasechnik, Fran√ßois Bissey".



---

archive/issue_events_260761.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-28T22:34:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260761"
}
```



---

archive/issue_events_260762.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-28T22:34:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29313#event-260762"
}
```



---

archive/issue_comments_462496.json:
```json
{
    "body": "**Changing branch** from \"[u/arojas/upgrade_to_pari_2_11_3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_to_pari_2_11_3)\" to \"[549e094174b9fb0b2fc5b7462d034f118e3fd1f3](https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3)\".",
    "created_at": "2020-07-28T22:34:31Z",
    "issue": "https://github.com/sagemath/sage/issues/29313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29313#issuecomment-462496",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/arojas/upgrade_to_pari_2_11_3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_to_pari_2_11_3)" to "[549e094174b9fb0b2fc5b7462d034f118e3fd1f3](https://github.com/sagemath/sagetrac-mirror/commit/549e094174b9fb0b2fc5b7462d034f118e3fd1f3)".
