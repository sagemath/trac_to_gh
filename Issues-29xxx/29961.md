# Issue 29961: random symbolic expression is completely unstable

archive/issues_029724.json:
```json
{
    "assignees": [],
    "body": "`sage.symbolic.random_tests.random_expr` is completely unstable.\n\nThis breaks a doctest in `sage.symbolic.expression_conversions.ExpressionTreeWalker.__init__` when fuzzing the doctests.\n\nTraceback below.\n\nComponent: **symbolics**\n\nKeywords: **random expression**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29961_\n\n",
    "created_at": "2020-06-24T18:54:16Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "random symbolic expression is completely unstable",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/29961",
    "user": "https://github.com/kliem"
}
```
`sage.symbolic.random_tests.random_expr` is completely unstable.

This breaks a doctest in `sage.symbolic.expression_conversions.ExpressionTreeWalker.__init__` when fuzzing the doctests.

Traceback below.

Component: **symbolics**

Keywords: **random expression**

_Issue created by migration from https://trac.sagemath.org/ticket/29961_





---

archive/issue_events_409413.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-06-24T18:54:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409413"
}
```



---

archive/issue_events_409414.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-06-24T18:54:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409414"
}
```



---

archive/issue_events_409415.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-06-24T18:54:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409415"
}
```



---

archive/issue_events_409416.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-06-24T18:54:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409416"
}
```



---

archive/issue_comments_473942.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n\n```\nsage: from sage.symbolic.random_tests import random_expr\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: set_random_seed(151058820726654196682836430928254760259)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/interface.py in __init__(self, parent, value, is_name, name)\n    717             try:\n--> 718                 self._name = parent._create(value, name=name)\n    719             except (TypeError, RuntimeError, ValueError) as x:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/maxima_lib.py in _create(self, value, name)\n    604             else:\n--> 605                 self.set(name, value)\n    606         except RuntimeError as error:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/maxima_lib.py in set(self, var, value)\n    513         cmd = '%s : %s$'%(var, value.rstrip(';'))\n--> 514         self.eval(cmd)\n    515 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/maxima_lib.py in _eval_line(self, line, locals, reformat, **kwds)\n    459                 if statement:\n--> 460                     maxima_eval(\"#$%s$\" % statement)\n    461         if not reformat:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7791)()\n    804         lispargs = EclObject(list(args))\n--> 805         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))\n    806 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5453)()\n    376         s = si_coerce_to_base_string(ecl_values(1))\n--> 377         raise RuntimeError(\"ECL says: {}\".format(\n    378             char_to_str(ecl_base_string_pointer_safe(s))))\n\nRuntimeError: ECL says: Error executing code in Maxima: \n\nDuring handling of the above exception, another exception occurred:\n\nTypeError                                 Traceback (most recent call last)\n<ipython-input-9-d588645d6f2a> in <module>()\n----> 1 foo = random_expr(Integer(20), nvars=Integer(2))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr(size, nvars, ncoeffs, var_frac, internal, nullary, nullary_frac, coeff_generator, verbose)\n    286     internal = normalize_prob_list(internal)\n    287 \n--> 288     return random_expr_helper(size, internal, leaves, verbose)\n    289 \n    290 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n--> 233         return r[1](*children)\n    234 \n    235 def random_expr(size, nvars=1, ncoeffs=None, var_frac=0.5,\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.cpp:12269)()\n   1136             res = self._evalf_try_(*args)\n   1137             if res is None:\n-> 1138                 res = super(BuiltinFunction, self).__call__(\n   1139                         *args, coerce=coerce, hold=hold)\n   1140 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.cpp:7046)()\n    600                     (<Expression>args[0])._gobj, hold)\n    601         elif self._nargs == 2:\n--> 602             res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,\n    603                     (<Expression>args[1])._gobj, hold)\n    604         elif self._nargs == 3:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction._evalf_or_eval_ (build/cythonized/sage/symbolic/function.cpp:13419)()\n   1224         res = self._evalf_try_(*args)\n   1225         if res is None:\n-> 1226             return self._eval0_(*args)\n   1227         else:\n   1228             return res\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/functions/orthogonal_polys.py in _eval_(self, n, x, *args, **kwds)\n   1241             Infinity\n   1242         \"\"\"\n-> 1243         ret = self._eval_special_values_(n, x)\n   1244         if ret is not None:\n   1245             return ret\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/functions/orthogonal_polys.py in _eval_special_values_(self, n, x)\n   1269             return elliptic_kc((x+1)/2)\n   1270 \n-> 1271         if x == 1:\n   1272             from sage.rings.infinity import unsigned_infinity\n   1273             return SR(unsigned_infinity)\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:19537)()\n   3126             # lot of basic Sage objects can't be put into maxima.\n   3127             from sage.symbolic.relation import test_relation_maxima\n-> 3128             return test_relation_maxima(self)\n   3129 \n   3130         self_is_zero = self._gobj.is_zero()\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/relation.py in test_relation_maxima(relation)\n    489         [k is noninteger]\n    490     \"\"\"\n--> 491     m = relation._maxima_()\n    492 \n    493     #Handle some basic cases first\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._maxima_ (build/cythonized/sage/symbolic/expression.cpp:7813)()\n   1004             # Maybe not such a great idea because the \"default\" interface is another one\n   1005             from sage.calculus.calculus import maxima\n-> 1006             return super(Expression, self)._interface_(maxima)\n   1007         else:\n   1008             return super(Expression, self)._interface_(session)\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/sage_object.pyx in sage.structure.sage_object.SageObject._interface_ (build/cythonized/sage/structure/sage_object.c:5600)()\n    682             except Exception:\n    683                 raise NotImplementedError(\"coercion of object %s to %s not implemented:\\n%s\\n%s\" % (repr(self), I))\n--> 684         X = I(s)\n    685         if c:\n    686             try:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3681)()\n    351             True\n    352         \"\"\"\n--> 353         return self.get_object()(*args, **kwds)\n    354 \n    355     def __repr__(self):\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/interface.py in __call__(self, x, name)\n    294 \n    295         if isinstance(x, str):\n--> 296             return cls(self, x, name=name)\n    297         try:\n    298             # Special methods do not and should not have an option to\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/interface.py in __init__(self, parent, value, is_name, name)\n    718                 self._name = parent._create(value, name=name)\n    719             except (TypeError, RuntimeError, ValueError) as x:\n--> 720                 raise TypeError(x)\n    721 \n    722     def _latex_(self):\n\nTypeError: ECL says: Error executing code in Maxima: \nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-16-d588645d6f2a> in <module>()\n----> 1 foo = random_expr(Integer(20), nvars=Integer(2))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr(size, nvars, ncoeffs, var_frac, internal, nullary, nullary_frac, coeff_generator, verbose)\n    286     internal = normalize_prob_list(internal)\n    287 \n--> 288     return random_expr_helper(size, internal, leaves, verbose)\n    289 \n    290 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n--> 233         return r[1](*children)\n    234 \n    235 def random_expr(size, nvars=1, ncoeffs=None, var_frac=0.5,\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.cpp:12269)()\n   1136             res = self._evalf_try_(*args)\n   1137             if res is None:\n-> 1138                 res = super(BuiltinFunction, self).__call__(\n   1139                         *args, coerce=coerce, hold=hold)\n   1140 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.cpp:7046)()\n    600                     (<Expression>args[0])._gobj, hold)\n    601         elif self._nargs == 2:\n--> 602             res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,\n    603                     (<Expression>args[1])._gobj, hold)\n    604         elif self._nargs == 3:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction._evalf_or_eval_ (build/cythonized/sage/symbolic/function.cpp:13419)()\n   1224         res = self._evalf_try_(*args)\n   1225         if res is None:\n-> 1226             return self._eval0_(*args)\n   1227         else:\n   1228             return res\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/functions/other.py in _eval_(self, poly, index)\n   2086             raise ValueError('polynomial in one variable required')\n   2087         if len(vars) != 1 or not poly.is_polynomial(vars[0]):\n-> 2088             raise ValueError('polynomial in one variable required')\n   2089 \n   2090     def _evalf_(self, poly, index, parent=None, algorithm=None):\n\nValueError: polynomial in one variable required\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\nsage: foo = random_expr(20, nvars=2)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._div_ (build/cythonized/sage/symbolic/expression.cpp:24413)()\n   3802             else:\n-> 3803                 x = left._gobj / _right._gobj\n   3804             return new_Expression_from_GEx(left._parent, x)\n\nValueError: power::eval(): division by zero\n\nDuring handling of the above exception, another exception occurred:\n\nZeroDivisionError                         Traceback (most recent call last)\n<ipython-input-36-d588645d6f2a> in <module>()\n----> 1 foo = random_expr(Integer(20), nvars=Integer(2))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr(size, nvars, ncoeffs, var_frac, internal, nullary, nullary_frac, coeff_generator, verbose)\n    286     internal = normalize_prob_list(internal)\n    287 \n--> 288     return random_expr_helper(size, internal, leaves, verbose)\n    289 \n    290 \n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)\n    228             n_spare_nodes = 0\n    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)\n--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)\n    231         if verbose:\n    232             print(\"About to apply %r to %r\" % (r[1], children))\n--> 233         return r[1](*children)\n    234 \n    235 def random_expr(size, nvars=1, ncoeffs=None, var_frac=0.5,\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:13028)()\n   1736             return (<Element>left)._div_(right)\n   1737         if BOTH_ARE_ELEMENT(cl):\n-> 1738             return coercion_model.bin_op(left, right, truediv)\n   1739 \n   1740         try:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:10139)()\n   1209             self._record_exception()\n   1210         else:\n-> 1211             return PyObject_CallObject(op, xy)\n   1212 \n   1213         if op is mul:\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:12993)()\n   1734         cdef int cl = classify_elements(left, right)\n   1735         if HAVE_SAME_PARENT(cl):\n-> 1736             return (<Element>left)._div_(right)\n   1737         if BOTH_ARE_ELEMENT(cl):\n   1738             return coercion_model.bin_op(left, right, truediv)\n\n/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._div_ (build/cythonized/sage/symbolic/expression.cpp:24493)()\n   3807             # See http://docs.cython.org/docs/wrapping_CPlusPlus.html\n   3808             if 'division by zero' in str(msg):\n-> 3809                 raise ZeroDivisionError(\"symbolic division by zero\")\n   3810             else:\n   3811                 raise\n\nZeroDivisionError: symbolic division by zero\n```",
    "created_at": "2020-06-24T18:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29961#issuecomment-473942",
    "user": "https://github.com/kliem"
}
```

<div id="comment:1" align="right">comment:1</div>


```
sage: from sage.symbolic.random_tests import random_expr
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: set_random_seed(151058820726654196682836430928254760259)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/interface.py in __init__(self, parent, value, is_name, name)
    717             try:
--> 718                 self._name = parent._create(value, name=name)
    719             except (TypeError, RuntimeError, ValueError) as x:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/maxima_lib.py in _create(self, value, name)
    604             else:
--> 605                 self.set(name, value)
    606         except RuntimeError as error:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/maxima_lib.py in set(self, var, value)
    513         cmd = '%s : %s$'%(var, value.rstrip(';'))
--> 514         self.eval(cmd)
    515 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/maxima_lib.py in _eval_line(self, line, locals, reformat, **kwds)
    459                 if statement:
--> 460                     maxima_eval("#$%s$" % statement)
    461         if not reformat:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7791)()
    804         lispargs = EclObject(list(args))
--> 805         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))
    806 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5453)()
    376         s = si_coerce_to_base_string(ecl_values(1))
--> 377         raise RuntimeError("ECL says: {}".format(
    378             char_to_str(ecl_base_string_pointer_safe(s))))

RuntimeError: ECL says: Error executing code in Maxima: 

During handling of the above exception, another exception occurred:

TypeError                                 Traceback (most recent call last)
<ipython-input-9-d588645d6f2a> in <module>()
----> 1 foo = random_expr(Integer(20), nvars=Integer(2))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr(size, nvars, ncoeffs, var_frac, internal, nullary, nullary_frac, coeff_generator, verbose)
    286     internal = normalize_prob_list(internal)
    287 
--> 288     return random_expr_helper(size, internal, leaves, verbose)
    289 
    290 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))
--> 233         return r[1](*children)
    234 
    235 def random_expr(size, nvars=1, ncoeffs=None, var_frac=0.5,

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.cpp:12269)()
   1136             res = self._evalf_try_(*args)
   1137             if res is None:
-> 1138                 res = super(BuiltinFunction, self).__call__(
   1139                         *args, coerce=coerce, hold=hold)
   1140 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.cpp:7046)()
    600                     (<Expression>args[0])._gobj, hold)
    601         elif self._nargs == 2:
--> 602             res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,
    603                     (<Expression>args[1])._gobj, hold)
    604         elif self._nargs == 3:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction._evalf_or_eval_ (build/cythonized/sage/symbolic/function.cpp:13419)()
   1224         res = self._evalf_try_(*args)
   1225         if res is None:
-> 1226             return self._eval0_(*args)
   1227         else:
   1228             return res

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/functions/orthogonal_polys.py in _eval_(self, n, x, *args, **kwds)
   1241             Infinity
   1242         """
-> 1243         ret = self._eval_special_values_(n, x)
   1244         if ret is not None:
   1245             return ret

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/functions/orthogonal_polys.py in _eval_special_values_(self, n, x)
   1269             return elliptic_kc((x+1)/2)
   1270 
-> 1271         if x == 1:
   1272             from sage.rings.infinity import unsigned_infinity
   1273             return SR(unsigned_infinity)

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:19537)()
   3126             # lot of basic Sage objects can't be put into maxima.
   3127             from sage.symbolic.relation import test_relation_maxima
-> 3128             return test_relation_maxima(self)
   3129 
   3130         self_is_zero = self._gobj.is_zero()

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/relation.py in test_relation_maxima(relation)
    489         [k is noninteger]
    490     """
--> 491     m = relation._maxima_()
    492 
    493     #Handle some basic cases first

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._maxima_ (build/cythonized/sage/symbolic/expression.cpp:7813)()
   1004             # Maybe not such a great idea because the "default" interface is another one
   1005             from sage.calculus.calculus import maxima
-> 1006             return super(Expression, self)._interface_(maxima)
   1007         else:
   1008             return super(Expression, self)._interface_(session)

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/sage_object.pyx in sage.structure.sage_object.SageObject._interface_ (build/cythonized/sage/structure/sage_object.c:5600)()
    682             except Exception:
    683                 raise NotImplementedError("coercion of object %s to %s not implemented:\n%s\n%s" % (repr(self), I))
--> 684         X = I(s)
    685         if c:
    686             try:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3681)()
    351             True
    352         """
--> 353         return self.get_object()(*args, **kwds)
    354 
    355     def __repr__(self):

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/interface.py in __call__(self, x, name)
    294 
    295         if isinstance(x, str):
--> 296             return cls(self, x, name=name)
    297         try:
    298             # Special methods do not and should not have an option to

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/interfaces/interface.py in __init__(self, parent, value, is_name, name)
    718                 self._name = parent._create(value, name=name)
    719             except (TypeError, RuntimeError, ValueError) as x:
--> 720                 raise TypeError(x)
    721 
    722     def _latex_(self):

TypeError: ECL says: Error executing code in Maxima: 
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-16-d588645d6f2a> in <module>()
----> 1 foo = random_expr(Integer(20), nvars=Integer(2))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr(size, nvars, ncoeffs, var_frac, internal, nullary, nullary_frac, coeff_generator, verbose)
    286     internal = normalize_prob_list(internal)
    287 
--> 288     return random_expr_helper(size, internal, leaves, verbose)
    289 
    290 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))
--> 233         return r[1](*children)
    234 
    235 def random_expr(size, nvars=1, ncoeffs=None, var_frac=0.5,

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.cpp:12269)()
   1136             res = self._evalf_try_(*args)
   1137             if res is None:
-> 1138                 res = super(BuiltinFunction, self).__call__(
   1139                         *args, coerce=coerce, hold=hold)
   1140 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.cpp:7046)()
    600                     (<Expression>args[0])._gobj, hold)
    601         elif self._nargs == 2:
--> 602             res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,
    603                     (<Expression>args[1])._gobj, hold)
    604         elif self._nargs == 3:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/function.pyx in sage.symbolic.function.BuiltinFunction._evalf_or_eval_ (build/cythonized/sage/symbolic/function.cpp:13419)()
   1224         res = self._evalf_try_(*args)
   1225         if res is None:
-> 1226             return self._eval0_(*args)
   1227         else:
   1228             return res

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/functions/other.py in _eval_(self, poly, index)
   2086             raise ValueError('polynomial in one variable required')
   2087         if len(vars) != 1 or not poly.is_polynomial(vars[0]):
-> 2088             raise ValueError('polynomial in one variable required')
   2089 
   2090     def _evalf_(self, poly, index, parent=None, algorithm=None):

ValueError: polynomial in one variable required
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
sage: foo = random_expr(20, nvars=2)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._div_ (build/cythonized/sage/symbolic/expression.cpp:24413)()
   3802             else:
-> 3803                 x = left._gobj / _right._gobj
   3804             return new_Expression_from_GEx(left._parent, x)

ValueError: power::eval(): division by zero

During handling of the above exception, another exception occurred:

ZeroDivisionError                         Traceback (most recent call last)
<ipython-input-36-d588645d6f2a> in <module>()
----> 1 foo = random_expr(Integer(20), nvars=Integer(2))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr(size, nvars, ncoeffs, var_frac, internal, nullary, nullary_frac, coeff_generator, verbose)
    286     internal = normalize_prob_list(internal)
    287 
--> 288     return random_expr_helper(size, internal, leaves, verbose)
    289 
    290 

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in <listcomp>(.0)
    228             n_spare_nodes = 0
    229         nodes_per_child = random_integer_vector(n_spare_nodes, n_children)
--> 230         children = [random_expr_helper(n+1, internal, leaves, verbose) for n in nodes_per_child]
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/random_tests.py in random_expr_helper(n_nodes, internal, leaves, verbose)
    231         if verbose:
    232             print("About to apply %r to %r" % (r[1], children))
--> 233         return r[1](*children)
    234 
    235 def random_expr(size, nvars=1, ncoeffs=None, var_frac=0.5,

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:13028)()
   1736             return (<Element>left)._div_(right)
   1737         if BOTH_ARE_ELEMENT(cl):
-> 1738             return coercion_model.bin_op(left, right, truediv)
   1739 
   1740         try:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:10139)()
   1209             self._record_exception()
   1210         else:
-> 1211             return PyObject_CallObject(op, xy)
   1212 
   1213         if op is mul:

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/structure/element.pyx in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:12993)()
   1734         cdef int cl = classify_elements(left, right)
   1735         if HAVE_SAME_PARENT(cl):
-> 1736             return (<Element>left)._div_(right)
   1737         if BOTH_ARE_ELEMENT(cl):
   1738             return coercion_model.bin_op(left, right, truediv)

/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._div_ (build/cythonized/sage/symbolic/expression.cpp:24493)()
   3807             # See http://docs.cython.org/docs/wrapping_CPlusPlus.html
   3808             if 'division by zero' in str(msg):
-> 3809                 raise ZeroDivisionError("symbolic division by zero")
   3810             else:
   3811                 raise

ZeroDivisionError: symbolic division by zero
```



---

archive/issue_events_409417.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409417"
}
```



---

archive/issue_events_409418.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409418"
}
```



---

archive/issue_events_409419.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409419"
}
```



---

archive/issue_events_409420.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409420"
}
```



---

archive/issue_comments_473943.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nMoving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29961#issuecomment-473943",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Moving to 9.4, as 9.3 has been released.



---

archive/issue_comments_473944.json:
```json
{
    "body": "Attachment: **[crash_kvq1b27w.log](https://github.com/sagemath/sage/files/ticket29961/crash_kvq1b27w.log)**\n\nrandom_expr crashing",
    "created_at": "2021-06-01T06:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29961#issuecomment-473944",
    "user": "https://github.com/kliem"
}
```

Attachment: **[crash_kvq1b27w.log](https://github.com/sagemath/sage/files/ticket29961/crash_kvq1b27w.log)**

random_expr crashing



---

archive/issue_comments_473945.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAs a bonus, `GiNac` apparently crashes sometimes, when running:\n\n```\nsage: from sage.symbolic.random_tests import *\nsage: some_functions = [arcsinh, arctan, arctan2, arctanh,\n....: arg, beta, binomial, ceil, conjugate, cos, cosh, cot, coth,\n....: elliptic_pi, erf, exp, factorial, floor, heaviside, imag_part,\n....: sech, sgn, sin, sinh, tan, tanh, unit_step, zeta, zetaderiv]\nsage: my_internal = [(0.6, full_binary, 2), (0.2, full_unary, 1),\n....: (0.2, [(1.0,f,f.number_of_arguments()) for f in some_functions])]\nsage: set_random_seed(1)\nsage: random_expr(50, nvars=3, internal=my_internal,\n....:   coeff_generator=CDF.random_element)\n```\n\nThis is from a doctest in `src/sage/symbollic/random_tests.py`. Crash log is attached, but it is rather easy to reproduce, but running the test maybe 20 times.",
    "created_at": "2021-06-01T07:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29961#issuecomment-473945",
    "user": "https://github.com/kliem"
}
```

<div id="comment:4" align="right">comment:4</div>

As a bonus, `GiNac` apparently crashes sometimes, when running:

```
sage: from sage.symbolic.random_tests import *
sage: some_functions = [arcsinh, arctan, arctan2, arctanh,
....: arg, beta, binomial, ceil, conjugate, cos, cosh, cot, coth,
....: elliptic_pi, erf, exp, factorial, floor, heaviside, imag_part,
....: sech, sgn, sin, sinh, tan, tanh, unit_step, zeta, zetaderiv]
sage: my_internal = [(0.6, full_binary, 2), (0.2, full_unary, 1),
....: (0.2, [(1.0,f,f.number_of_arguments()) for f in some_functions])]
sage: set_random_seed(1)
sage: random_expr(50, nvars=3, internal=my_internal,
....:   coeff_generator=CDF.random_element)
```

This is from a doctest in `src/sage/symbollic/random_tests.py`. Crash log is attached, but it is rather easy to reproduce, but running the test maybe 20 times.



---

archive/issue_events_409421.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-06-01T07:05:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409421"
}
```



---

archive/issue_events_409422.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-06-01T07:05:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409422"
}
```



---

archive/issue_events_409423.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409423"
}
```



---

archive/issue_events_409424.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409424"
}
```



---

archive/issue_events_409425.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409425"
}
```



---

archive/issue_events_409426.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409426"
}
```



---

archive/issue_events_409427.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409427"
}
```



---

archive/issue_events_409428.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409428"
}
```



---

archive/issue_events_409429.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409429"
}
```



---

archive/issue_events_409430.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29961",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29961#event-409430"
}
```
