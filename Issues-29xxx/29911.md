# Issue 29911: sage.rings.integer, integer_ring: Remove dependencies on sage.libs.ntl

archive/issues_029674.json:
```json
{
    "body": "The two Cython modules depend on NTL in a very minor way that could be eliminated:\n\n- `sage.rings.integer.Integer` depends on `sage.libs.ntl` to provide method `_to_ZZ`. \n\n- `sage.rings.integer_ring._coerce_ZZ` depends on `sage.libs.ntl` to provide the method `_coerce_ZZ`.\n\nThese methods are only used in `sage.libs.ntl` and in `sage.rings.number_field.number_field_element` and `rings.polynomial.polynomial_zz_pex`.\n\n\nIn this ticket, we remove these two methods and replace all uses by their definition (= 1 or 2 lines).\n\n\n\nCC:  @videlec @fchapoton @alexjbest @mezzarobba @kliem @mwageringel @tscrim\n\nBranch/Commit: [62e2aa907afd05b2e848522b974c07316fadb49f](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)\n\nReviewer: Travis Scrimshaw\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29911\n\n",
    "closed_at": "2020-08-14T22:23:43Z",
    "created_at": "2020-06-20T04:09:41Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "sage.rings.integer, integer_ring: Remove dependencies on sage.libs.ntl",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29911",
    "user": "https://github.com/mkoeppe"
}
```
The two Cython modules depend on NTL in a very minor way that could be eliminated:

- `sage.rings.integer.Integer` depends on `sage.libs.ntl` to provide method `_to_ZZ`. 

- `sage.rings.integer_ring._coerce_ZZ` depends on `sage.libs.ntl` to provide the method `_coerce_ZZ`.

These methods are only used in `sage.libs.ntl` and in `sage.rings.number_field.number_field_element` and `rings.polynomial.polynomial_zz_pex`.


In this ticket, we remove these two methods and replace all uses by their definition (= 1 or 2 lines).



CC:  @videlec @fchapoton @alexjbest @mezzarobba @kliem @mwageringel @tscrim

Branch/Commit: [62e2aa907afd05b2e848522b974c07316fadb49f](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)

Reviewer: Travis Scrimshaw

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29911





---

archive/issue_comments_587902.json:
```json
{
    "body": "<a id='comment:1'></a>\nHum, `sage.rings.integer.integer` and `sage.rings.integer_ring` don't link to `ntl` directly at least.\n\n```\nreadelf -d /usr/lib/python3.7/site-packages/sage/rings/integer_ring.cpython-37m-x86_64-linux-gnu.so \n\nDynamic section at offset 0x35ca0 contains 26 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0x7000\n```\nand \n\n```\nreadelf -d /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so \n\nDynamic section at offset 0x4db78 contains 30 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.9]\n 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0xd000\n```\non Gentoo compiled with `--as-needed`. Some headers may still be used though.",
    "created_at": "2020-06-20T05:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587902",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Hum, `sage.rings.integer.integer` and `sage.rings.integer_ring` don't link to `ntl` directly at least.

```
readelf -d /usr/lib/python3.7/site-packages/sage/rings/integer_ring.cpython-37m-x86_64-linux-gnu.so 

Dynamic section at offset 0x35ca0 contains 26 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0x7000
```
and 

```
readelf -d /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so 

Dynamic section at offset 0x4db78 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.9]
 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0xd000
```
on Gentoo compiled with `--as-needed`. Some headers may still be used though.



---

archive/issue_comments_587903.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt's a compile time dependency. It's possible that it is all macros or inlined functions.",
    "created_at": "2020-06-20T05:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587903",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
It's a compile time dependency. It's possible that it is all macros or inlined functions.



---

archive/issue_comments_587904.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,6 @@\n These methods are only used in `sage.libs.ntl` and in `sage.rings.number_field.number_field_element` and `rings.polynomial.polynomial_zz_pex`.\n \n \n+In this ticket, we change these two methods to ordinary functions somewhere in `sage.libs.ntl`, which already imports `sage.rings.integer*` (and a lot more from `sage.rings`).\n+\n+\n``````\n",
    "created_at": "2020-06-22T23:28:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587904",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,6 @@
 These methods are only used in `sage.libs.ntl` and in `sage.rings.number_field.number_field_element` and `rings.polynomial.polynomial_zz_pex`.
 
 
+In this ticket, we change these two methods to ordinary functions somewhere in `sage.libs.ntl`, which already imports `sage.rings.integer*` (and a lot more from `sage.rings`).
+
+
``````




---

archive/issue_comments_587905.json:
```json
{
    "body": "<a id='comment:5'></a>\nWould it make sense to make these two methods functions in `sage.libs.ntl.conversion`?",
    "created_at": "2020-06-23T00:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587905",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Would it make sense to make these two methods functions in `sage.libs.ntl.conversion`?



---

archive/issue_comments_587906.json:
```json
{
    "body": "Branch: [u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl)",
    "created_at": "2020-06-27T04:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587906",
    "user": "https://github.com/mkoeppe"
}
```

Branch: [u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl)



---

archive/issue_comments_587907.json:
```json
{
    "body": "Commit: [cef22080262a3346ef1253b9dcaac23f3bbcc98f](https://github.com/sagemath/sagetrac-mirror/commit/cef22080262a3346ef1253b9dcaac23f3bbcc98f)",
    "created_at": "2020-06-27T05:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587907",
    "user": "https://github.com/mkoeppe"
}
```

Commit: [cef22080262a3346ef1253b9dcaac23f3bbcc98f](https://github.com/sagemath/sagetrac-mirror/commit/cef22080262a3346ef1253b9dcaac23f3bbcc98f)



---

archive/issue_comments_587908.json:
```json
{
    "body": "<a id='comment:8'></a>\nNew commits:\n|                                                                                                                                          |                                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|\n|[cef2208](https://github.com/sagemath/sagetrac-mirror/commit/cef22080262a3346ef1253b9dcaac23f3bbcc98f)|`sage.rings.integer.Integer._to_ZZ: Remove, replace uses by calls to mpz_to_ZZ`|",
    "created_at": "2020-06-27T05:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587908",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
New commits:
|                                                                                                                                          |                                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
|[cef2208](https://github.com/sagemath/sagetrac-mirror/commit/cef22080262a3346ef1253b9dcaac23f3bbcc98f)|`sage.rings.integer.Integer._to_ZZ: Remove, replace uses by calls to mpz_to_ZZ`|



---

archive/issue_comments_587909.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,6 +7,6 @@\n These methods are only used in `sage.libs.ntl` and in `sage.rings.number_field.number_field_element` and `rings.polynomial.polynomial_zz_pex`.\n \n \n-In this ticket, we change these two methods to ordinary functions somewhere in `sage.libs.ntl`, which already imports `sage.rings.integer*` (and a lot more from `sage.rings`).\n+In this ticket, we remove these two methods and replace all uses by their definition (= 1 or 2 lines).\n \n \n``````\n",
    "created_at": "2020-06-27T05:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587909",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,6 +7,6 @@
 These methods are only used in `sage.libs.ntl` and in `sage.rings.number_field.number_field_element` and `rings.polynomial.polynomial_zz_pex`.
 
 
-In this ticket, we change these two methods to ordinary functions somewhere in `sage.libs.ntl`, which already imports `sage.rings.integer*` (and a lot more from `sage.rings`).
+In this ticket, we remove these two methods and replace all uses by their definition (= 1 or 2 lines).
 
 
``````




---

archive/issue_comments_587910.json:
```json
{
    "body": "Changing commit from \"[cef22080262a3346ef1253b9dcaac23f3bbcc98f](https://github.com/sagemath/sagetrac-mirror/commit/cef22080262a3346ef1253b9dcaac23f3bbcc98f)\" to \"[15c4ccf113b70889b8043ce3524db78827f278f0](https://github.com/sagemath/sagetrac-mirror/commit/15c4ccf113b70889b8043ce3524db78827f278f0)\"",
    "created_at": "2020-06-27T05:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[cef22080262a3346ef1253b9dcaac23f3bbcc98f](https://github.com/sagemath/sagetrac-mirror/commit/cef22080262a3346ef1253b9dcaac23f3bbcc98f)" to "[15c4ccf113b70889b8043ce3524db78827f278f0](https://github.com/sagemath/sagetrac-mirror/commit/15c4ccf113b70889b8043ce3524db78827f278f0)"



---

archive/issue_comments_587911.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|\n|[15c4ccf](https://github.com/sagemath/sagetrac-mirror/commit/15c4ccf113b70889b8043ce3524db78827f278f0)|`sage.rings.integer_ring.IntegerRing_class._coerce_ZZ: Remove, replaces uses by calls to ZZ_to_mpz`|",
    "created_at": "2020-06-27T05:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587911",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
|[15c4ccf](https://github.com/sagemath/sagetrac-mirror/commit/15c4ccf113b70889b8043ce3524db78827f278f0)|`sage.rings.integer_ring.IntegerRing_class._coerce_ZZ: Remove, replaces uses by calls to ZZ_to_mpz`|



---

archive/issue_comments_587912.json:
```json
{
    "body": "Author: Matthias Koeppe",
    "created_at": "2020-06-27T05:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587912",
    "user": "https://github.com/mkoeppe"
}
```

Author: Matthias Koeppe



---

archive/issue_comments_587913.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-27T05:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587913",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_587914.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-27T05:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587914",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_587915.json:
```json
{
    "body": "Dependencies: #29786",
    "created_at": "2020-06-27T05:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587915",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: #29786



---

archive/issue_comments_587916.json:
```json
{
    "body": "Changing commit from \"[15c4ccf113b70889b8043ce3524db78827f278f0](https://github.com/sagemath/sagetrac-mirror/commit/15c4ccf113b70889b8043ce3524db78827f278f0)\" to \"[5e9f00cc53047e300af0054a8d7979ac588a9930](https://github.com/sagemath/sagetrac-mirror/commit/5e9f00cc53047e300af0054a8d7979ac588a9930)\"",
    "created_at": "2020-06-27T05:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[15c4ccf113b70889b8043ce3524db78827f278f0](https://github.com/sagemath/sagetrac-mirror/commit/15c4ccf113b70889b8043ce3524db78827f278f0)" to "[5e9f00cc53047e300af0054a8d7979ac588a9930](https://github.com/sagemath/sagetrac-mirror/commit/5e9f00cc53047e300af0054a8d7979ac588a9930)"



---

archive/issue_comments_587917.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|\n|[aa75810](https://github.com/sagemath/sagetrac-mirror/commit/aa7581059a44bf380614967bfb279f2c88969b74)|`src/module_list.py: Move options for most Extensions in sage.rings to distutils directives`|\n|[43a9b16](https://github.com/sagemath/sagetrac-mirror/commit/43a9b169f4030b9a036f3c0e3f94214dbc4f6ab7)|`src/sage/misc/sageinspect.py: Fix up doctest that depends on a modified source file`|\n|[a5bc828](https://github.com/sagemath/sagetrac-mirror/commit/a5bc828338393e248e1d9e9e9719f9ba22aa7b4e)|`src/sage/misc/sageinspect.py: Fixup fixup`|\n|[1baaa68](https://github.com/sagemath/sagetrac-mirror/commit/1baaa68a0fde79d25081c463fed8657c44a43762)|`src/sage/misc/sageinspect.py: Remove unused import`|\n|[6734969](https://github.com/sagemath/sagetrac-mirror/commit/6734969468b63f00e481dfe9e73c4f952719cd54)|`Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29911/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl`|\n|[5e9f00c](https://github.com/sagemath/sagetrac-mirror/commit/5e9f00cc53047e300af0054a8d7979ac588a9930)|`src/sage/rings/integer*.pyx: Remove 'libraries = ntl'`|",
    "created_at": "2020-06-27T05:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587917",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
|[aa75810](https://github.com/sagemath/sagetrac-mirror/commit/aa7581059a44bf380614967bfb279f2c88969b74)|`src/module_list.py: Move options for most Extensions in sage.rings to distutils directives`|
|[43a9b16](https://github.com/sagemath/sagetrac-mirror/commit/43a9b169f4030b9a036f3c0e3f94214dbc4f6ab7)|`src/sage/misc/sageinspect.py: Fix up doctest that depends on a modified source file`|
|[a5bc828](https://github.com/sagemath/sagetrac-mirror/commit/a5bc828338393e248e1d9e9e9719f9ba22aa7b4e)|`src/sage/misc/sageinspect.py: Fixup fixup`|
|[1baaa68](https://github.com/sagemath/sagetrac-mirror/commit/1baaa68a0fde79d25081c463fed8657c44a43762)|`src/sage/misc/sageinspect.py: Remove unused import`|
|[6734969](https://github.com/sagemath/sagetrac-mirror/commit/6734969468b63f00e481dfe9e73c4f952719cd54)|`Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29911/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl`|
|[5e9f00c](https://github.com/sagemath/sagetrac-mirror/commit/5e9f00cc53047e300af0054a8d7979ac588a9930)|`src/sage/rings/integer*.pyx: Remove 'libraries = ntl'`|



---

archive/issue_comments_587918.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-27T05:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587918",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_587919.json:
```json
{
    "body": "Changing dependencies from \"#29786\" to \"\"",
    "created_at": "2020-07-08T15:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587919",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29786" to ""



---

archive/issue_comments_587920.json:
```json
{
    "body": "<a id='comment:15'></a>\nThe dependency has been merged in 9.2.beta3. Needs review",
    "created_at": "2020-07-08T15:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587920",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
The dependency has been merged in 9.2.beta3. Needs review



---

archive/issue_comments_587921.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [mkoeppe](#comment%3A5):\n> Would it make sense to make these two methods functions in `sage.libs.ntl.conversion`?\n\n\nThis sounds like a good idea to me. Why do you remove the calls to `sig_on`/`sig_off`?",
    "created_at": "2020-07-10T19:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587921",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:16'></a>
Replying to [mkoeppe](#comment%3A5):
> Would it make sense to make these two methods functions in `sage.libs.ntl.conversion`?


This sounds like a good idea to me. Why do you remove the calls to `sig_on`/`sig_off`?



---

archive/issue_comments_587922.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|\n|[95cf15c](https://github.com/sagemath/sagetrac-mirror/commit/95cf15cbdf1bc70164ae11456ed1f32e8661797e)|`sage.rings.integer.Integer._to_ZZ: Remove, replace uses by calls to mpz_to_ZZ`|\n|[0915137](https://github.com/sagemath/sagetrac-mirror/commit/09151370dfad704a26b8abf623bb95b018651328)|`sage.rings.integer_ring.IntegerRing_class._coerce_ZZ: Remove, replaces uses by calls to ZZ_to_mpz`|\n|[8468ad1](https://github.com/sagemath/sagetrac-mirror/commit/8468ad19e4d7371343cd45b1e2f32b19b20d7a41)|`src/sage/rings/integer*.pyx: Remove 'libraries = ntl'`|",
    "created_at": "2020-07-13T00:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
|[95cf15c](https://github.com/sagemath/sagetrac-mirror/commit/95cf15cbdf1bc70164ae11456ed1f32e8661797e)|`sage.rings.integer.Integer._to_ZZ: Remove, replace uses by calls to mpz_to_ZZ`|
|[0915137](https://github.com/sagemath/sagetrac-mirror/commit/09151370dfad704a26b8abf623bb95b018651328)|`sage.rings.integer_ring.IntegerRing_class._coerce_ZZ: Remove, replaces uses by calls to ZZ_to_mpz`|
|[8468ad1](https://github.com/sagemath/sagetrac-mirror/commit/8468ad19e4d7371343cd45b1e2f32b19b20d7a41)|`src/sage/rings/integer*.pyx: Remove 'libraries = ntl'`|



---

archive/issue_comments_587923.json:
```json
{
    "body": "Changing commit from \"[5e9f00cc53047e300af0054a8d7979ac588a9930](https://github.com/sagemath/sagetrac-mirror/commit/5e9f00cc53047e300af0054a8d7979ac588a9930)\" to \"[8468ad19e4d7371343cd45b1e2f32b19b20d7a41](https://github.com/sagemath/sagetrac-mirror/commit/8468ad19e4d7371343cd45b1e2f32b19b20d7a41)\"",
    "created_at": "2020-07-13T00:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[5e9f00cc53047e300af0054a8d7979ac588a9930](https://github.com/sagemath/sagetrac-mirror/commit/5e9f00cc53047e300af0054a8d7979ac588a9930)" to "[8468ad19e4d7371343cd45b1e2f32b19b20d7a41](https://github.com/sagemath/sagetrac-mirror/commit/8468ad19e4d7371343cd45b1e2f32b19b20d7a41)"



---

archive/issue_comments_587924.json:
```json
{
    "body": "<a id='comment:18'></a>\nRebased on 9.2.beta5",
    "created_at": "2020-07-13T00:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587924",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Rebased on 9.2.beta5



---

archive/issue_comments_587925.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [gh-mwageringel](#comment%3A16):\n> Why do you remove the calls to `sig_on`/`sig_off`?\n\n\nGood question. I am not sure against what kind of errors these calls were supposed to be guarding.",
    "created_at": "2020-07-13T00:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587925",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Replying to [gh-mwageringel](#comment%3A16):
> Why do you remove the calls to `sig_on`/`sig_off`?


Good question. I am not sure against what kind of errors these calls were supposed to be guarding.



---

archive/issue_comments_587926.json:
```json
{
    "body": "<a id='comment:21'></a>\nHoping for a Cython expert to take a look...",
    "created_at": "2020-07-26T00:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587926",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Hoping for a Cython expert to take a look...



---

archive/issue_comments_587927.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|\n|[62e2aa9](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)|`Merge tag '9.2.beta6' into t/29911/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl`|",
    "created_at": "2020-07-26T05:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587927",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
|[62e2aa9](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)|`Merge tag '9.2.beta6' into t/29911/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl`|



---

archive/issue_comments_587928.json:
```json
{
    "body": "Changing commit from \"[8468ad19e4d7371343cd45b1e2f32b19b20d7a41](https://github.com/sagemath/sagetrac-mirror/commit/8468ad19e4d7371343cd45b1e2f32b19b20d7a41)\" to \"[62e2aa907afd05b2e848522b974c07316fadb49f](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)\"",
    "created_at": "2020-07-26T05:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587928",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[8468ad19e4d7371343cd45b1e2f32b19b20d7a41](https://github.com/sagemath/sagetrac-mirror/commit/8468ad19e4d7371343cd45b1e2f32b19b20d7a41)" to "[62e2aa907afd05b2e848522b974c07316fadb49f](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)"



---

archive/issue_comments_587929.json:
```json
{
    "body": "<a id='comment:23'></a>\nWhile I would not count myself as a Cython expert, my guess would be if the denominator was somehow not something that could be handled? Perhaps some kind of overflow or unable to allocate memory? I am really unsure.",
    "created_at": "2020-07-27T06:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587929",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'></a>
While I would not count myself as a Cython expert, my guess would be if the denominator was somehow not something that could be handled? Perhaps some kind of overflow or unable to allocate memory? I am really unsure.



---

archive/issue_comments_587930.json:
```json
{
    "body": "Reviewer: Travis Scrimshaw",
    "created_at": "2020-08-10T22:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587930",
    "user": "https://github.com/tscrim"
}
```

Reviewer: Travis Scrimshaw



---

archive/issue_comments_587931.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-10T22:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587931",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_587932.json:
```json
{
    "body": "<a id='comment:24'></a>\nWell, let's put this into practice as I cannot find a reason for it. Well, perhaps we should just put it into Sage to get some broader testing as it seems safe enough to me.",
    "created_at": "2020-08-10T22:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587932",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:24'></a>
Well, let's put this into practice as I cannot find a reason for it. Well, perhaps we should just put it into Sage to get some broader testing as it seems safe enough to me.



---

archive/issue_comments_587933.json:
```json
{
    "body": "<a id='comment:25'></a>\nThanks!",
    "created_at": "2020-08-10T23:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587933",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
Thanks!



---

archive/issue_comments_587934.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-14T22:23:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587934",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_587935.json:
```json
{
    "body": "Changing branch from \"[u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl)\" to \"[62e2aa907afd05b2e848522b974c07316fadb49f](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)\"",
    "created_at": "2020-08-14T22:23:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29911#issuecomment-587935",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_integer__integer_ring__remove_dependencies_on_sage_libs_ntl)" to "[62e2aa907afd05b2e848522b974c07316fadb49f](https://github.com/sagemath/sagetrac-mirror/commit/62e2aa907afd05b2e848522b974c07316fadb49f)"



---

archive/issue_events_086528.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-14T22:23:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29911",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29911#event-86528"
}
```
