# Issue 29514: implement formatting of elements in RDF/CDF

archive/issues_029277.json:
```json
{
    "body": "This ticket implements `__format__` for elements in `RDF` and `CDF`. See also #29212 for a related discussion.\n\nThe real number format immediately delegates to `float`, whereas the complex format matches the usual `repr` of elements in `CDF` as closely as possible (unlike Python's type `complex`).\n\n```\nsage: '{:.4e}'.format(RDF(2/3))\n'6.6667e-01'\n\nsage: format(CDF(32/3, 0), ' .4f')\n' 10.6667 + 0.0000*I'\n\nsage: format(CDF(-2/3, -2/3), '.4e')\n'-6.6667e-01 - 6.6667e-01*I'\n\nsage: format(CDF(0, 2/3), '.4')\n'0.6667*I'\n\nsage: format(CDF(2, 0), '.4')\n'2.0'\n```\n\nFor reference: the [format specification](https://docs.python.org/3/library/string.html#formatspec) in Python.\n\n\nBranch/Commit: 51a9736237f27229e5c9624c7fbb6d53ec898725\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Markus Wageringel\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29514\n\n",
    "closed_at": "2020-07-08T19:32:40Z",
    "created_at": "2020-04-15T19:55:27Z",
    "labels": [
        "component: misc",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "implement formatting of elements in RDF/CDF",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29514",
    "user": "https://github.com/mwageringel"
}
```
This ticket implements `__format__` for elements in `RDF` and `CDF`. See also #29212 for a related discussion.

The real number format immediately delegates to `float`, whereas the complex format matches the usual `repr` of elements in `CDF` as closely as possible (unlike Python's type `complex`).

```
sage: '{:.4e}'.format(RDF(2/3))
'6.6667e-01'

sage: format(CDF(32/3, 0), ' .4f')
' 10.6667 + 0.0000*I'

sage: format(CDF(-2/3, -2/3), '.4e')
'-6.6667e-01 - 6.6667e-01*I'

sage: format(CDF(0, 2/3), '.4')
'0.6667*I'

sage: format(CDF(2, 0), '.4')
'2.0'
```

For reference: the [format specification](https://docs.python.org/3/library/string.html#formatspec) in Python.


Branch/Commit: 51a9736237f27229e5c9624c7fbb6d53ec898725

Reviewer: Eric Gourgoulhon

Author: Markus Wageringel

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29514





---

archive/issue_comments_441943.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-15T19:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441943",
    "user": "https://github.com/mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_441944.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2020-04-15T19:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441944",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_441945.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-04-15T20:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_441946.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-16T19:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441946",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_441947.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,15 +1,26 @@\n-This ticket implements \\`__format__\\` for elements in \\`RDF\\` and \\`CDF\\` by delegating to the builtin types \\`float\\` and \\`complex\\`. See also #29212 for a related discussion.\n+This ticket implements \\`__format__\\` for elements in \\`RDF\\` and \\`CDF\\`. See also #29212 for a related discussion.\n+\n+The real number format immediately delegates to \\`float\\`, whereas the complex format matches the usual \\`repr\\` of elements in \\`CDF\\` as closely as possible (unlike Python's type \\`complex\\`).\n \n \\`\\`\\`\n sage: '{:.4e}'.format(RDF(2/3))\n '6.6667e-01'\n+\n sage: format(CDF(32/3, 0), ' .4f')\n-' 10.6667+0.0000j'\n+' 10.6667 + 0.0000*I'\n+\n+sage: format(CDF(-2/3, -2/3), '.4e')\n+'-6.6667e-01 - 6.6667e-01*I'\n+\n+sage: format(CDF(0, 2/3), '.4')\n+'0.6667*I'\n+\n+sage: format(CDF(2, 0), '.4')\n+'2.0'\n \\`\\`\\`\n \n For reference: the [format specification](https://docs.python.org/3/library/string.html#formatspec) in Python.\n \n-Note that the imaginary unit is represented as a \\`j\\` by the type \\`complex\\`, but that is part of Python.\n \n Comment: 1\n \n```\n",
    "created_at": "2020-04-16T19:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441947",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,15 +1,26 @@
-This ticket implements \`__format__\` for elements in \`RDF\` and \`CDF\` by delegating to the builtin types \`float\` and \`complex\`. See also #29212 for a related discussion.
+This ticket implements \`__format__\` for elements in \`RDF\` and \`CDF\`. See also #29212 for a related discussion.
+
+The real number format immediately delegates to \`float\`, whereas the complex format matches the usual \`repr\` of elements in \`CDF\` as closely as possible (unlike Python's type \`complex\`).
 
 \`\`\`
 sage: '{:.4e}'.format(RDF(2/3))
 '6.6667e-01'
+
 sage: format(CDF(32/3, 0), ' .4f')
-' 10.6667+0.0000j'
+' 10.6667 + 0.0000*I'
+
+sage: format(CDF(-2/3, -2/3), '.4e')
+'-6.6667e-01 - 6.6667e-01*I'
+
+sage: format(CDF(0, 2/3), '.4')
+'0.6667*I'
+
+sage: format(CDF(2, 0), '.4')
+'2.0'
 \`\`\`
 
 For reference: the [format specification](https://docs.python.org/3/library/string.html#formatspec) in Python.
 
-Note that the imaginary unit is represented as a \`j\` by the type \`complex\`, but that is part of Python.
 
 Comment: 1
 
```




---

archive/issue_comments_441948.json:
```json
{
    "body": "<a id='comment:4'></a>Actually, here is a much better version that very closely matches the usual representation of elements in `CDF`.",
    "created_at": "2020-04-16T19:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441948",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:4'></a>Actually, here is a much better version that very closely matches the usual representation of elements in `CDF`.



---

archive/issue_comments_441949.json:
```json
{
    "body": "<a id='comment:5'></a>A possible use case is reducing the number of digits in matrices:\n\n```\nsage: print(matrix.random(CDF, 4).str(' {:.4f}'.format))\n[ -0.6482 + 0.4684*I   0.7523 + 0.9738*I   0.0076 - 0.5470*I   0.4949 + 0.5821*I]\n[  0.6205 + 0.5834*I  -0.0394 + 0.3852*I  -0.3764 - 0.9199*I   0.3162 - 0.2032*I]\n[ -0.0436 + 0.5112*I  -0.3949 + 0.2829*I   0.2733 + 0.4865*I   0.3938 - 0.0825*I]\n[  0.0763 + 0.6577*I  -0.9444 + 0.4760*I   0.0951 + 0.6043*I  -0.4464 + 0.4081*I]\n```",
    "created_at": "2020-04-16T19:40:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441949",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:5'></a>A possible use case is reducing the number of digits in matrices:

```
sage: print(matrix.random(CDF, 4).str(' {:.4f}'.format))
[ -0.6482 + 0.4684*I   0.7523 + 0.9738*I   0.0076 - 0.5470*I   0.4949 + 0.5821*I]
[  0.6205 + 0.5834*I  -0.0394 + 0.3852*I  -0.3764 - 0.9199*I   0.3162 - 0.2032*I]
[ -0.0436 + 0.5112*I  -0.3949 + 0.2829*I   0.2733 + 0.4865*I   0.3938 - 0.0825*I]
[  0.0763 + 0.6577*I  -0.9444 + 0.4760*I   0.0951 + 0.6043*I  -0.4464 + 0.4081*I]
```



---

archive/issue_comments_441950.json:
```json
{
    "body": "<a id='comment:6'></a>LGTM. Thank you!",
    "created_at": "2020-06-13T18:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441950",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:6'></a>LGTM. Thank you!



---

archive/issue_comments_441951.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-13T18:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441951",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_441952.json:
```json
{
    "body": "<a id='comment:7'></a>Thank you for the review.",
    "created_at": "2020-06-13T18:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441952",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:7'></a>Thank you for the review.



---

archive/issue_comments_441953.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29514#issuecomment-441953",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_075265.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:32:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29514",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29514#event-75265"
}
```
