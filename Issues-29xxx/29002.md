# Issue 29002: spkg-configure.m4 for sqlite

archive/issues_028765.json:
```json
{
    "assignees": [],
    "body": "SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). \n\nlibsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the lower bound slightly lower than the current version available on XCode.\n\nWe detect it using `AC_RUN_IFELSE` because on macOS without homebrew, there is no pkgconfig file.\n\n\n\n\n**CC:**  @embray @dimpase @isuruf\n\n**Branch:** [b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)\n\n**Reviewer:** Dima Pasechnik, Matthias Koeppe\n\n**Author:** Michael Orlitzky, Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/29002\n\n",
    "closed_at": "2020-01-22T20:43:53Z",
    "created_at": "2020-01-13T15:14:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "spkg-configure.m4 for sqlite",
    "type": "issue",
    "updated_at": "2020-01-30T16:13:34Z",
    "url": "https://github.com/sagemath/sage/issues/29002",
    "user": "https://github.com/orlitzky"
}
```
SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). 

libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the lower bound slightly lower than the current version available on XCode.

We detect it using `AC_RUN_IFELSE` because on macOS without homebrew, there is no pkgconfig file.




**CC:**  @embray @dimpase @isuruf

**Branch:** [b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)

**Reviewer:** Dima Pasechnik, Matthias Koeppe

**Author:** Michael Orlitzky, Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/29002





---

archive/issue_events_349369.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-01-13T15:14:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349369"
}
```



---

archive/issue_events_349370.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-01-13T15:14:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
    "label_color": "08517b",
    "label_name": "component: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349370"
}
```



---

archive/issue_events_349371.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-01-13T15:14:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349371"
}
```



---

archive/issue_comments_455714.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nI don't think we need such a new version, but 3.29.0 (from 2019-07-10) is the oldest one in Gentoo that I can test against. Should we accept versions back to 3.27 or 3.16 (or further) for Debian?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5e79c9396db02a5fa5de3f3990afb25f6f1420d\">e5e79c9</a></td><td><code>Trac #29002: new spkg-configure.m4 for sqlite.</code></td></tr></table>\n",
    "created_at": "2020-01-13T15:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455714",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:1'>**Comment 1:**</a>
I don't think we need such a new version, but 3.29.0 (from 2019-07-10) is the oldest one in Gentoo that I can test against. Should we accept versions back to 3.27 or 3.16 (or further) for Debian?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5e79c9396db02a5fa5de3f3990afb25f6f1420d">e5e79c9</a></td><td><code>Trac #29002: new spkg-configure.m4 for sqlite.</code></td></tr></table>




---

archive/issue_comments_455715.json:
```json
{
    "body": "**Branch:** [u/mjo/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/29002)",
    "created_at": "2020-01-13T15:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455715",
    "user": "https://github.com/orlitzky"
}
```

**Branch:** [u/mjo/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/29002)



---

archive/issue_events_349372.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-01-13T15:20:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349372"
}
```



---

archive/issue_comments_455716.json:
```json
{
    "body": "**Commit:** [e5e79c9396db02a5fa5de3f3990afb25f6f1420d](https://github.com/sagemath/sagetrac-mirror/commit/e5e79c9396db02a5fa5de3f3990afb25f6f1420d)",
    "created_at": "2020-01-13T15:20:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455716",
    "user": "https://github.com/orlitzky"
}
```

**Commit:** [e5e79c9396db02a5fa5de3f3990afb25f6f1420d](https://github.com/sagemath/sagetrac-mirror/commit/e5e79c9396db02a5fa5de3f3990afb25f6f1420d)



---

archive/issue_comments_455717.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nI'm testing this with sqlite 3.20 on Fedora 26 now. (My Debian system has 3.27).",
    "created_at": "2020-01-14T12:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455717",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'>**Comment 2:**</a>
I'm testing this with sqlite 3.20 on Fedora 26 now. (My Debian system has 3.27).



---

archive/issue_comments_455718.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\ncould you make the minimal version 3.20? Otherwise, all good. (I modified the version being 3.20 and tested with such sqlite)\n\nOn Fedora the packages are named `sqlite` and `sqlite-devel` - these ought to be listed in the corresponding docs - perhaps on another ticket.",
    "created_at": "2020-01-14T14:41:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455718",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'>**Comment 3:**</a>
could you make the minimal version 3.20? Otherwise, all good. (I modified the version being 3.20 and tested with such sqlite)

On Fedora the packages are named `sqlite` and `sqlite-devel` - these ought to be listed in the corresponding docs - perhaps on another ticket.



---

archive/issue_events_349373.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-14T14:41:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349373"
}
```



---

archive/issue_events_349374.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-14T14:41:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349374"
}
```



---

archive/issue_comments_455719.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2020-01-14T14:41:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455719",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_comments_455720.json:
```json
{
    "body": "**Changing commit** from \"[e5e79c9396db02a5fa5de3f3990afb25f6f1420d](https://github.com/sagemath/sagetrac-mirror/commit/e5e79c9396db02a5fa5de3f3990afb25f6f1420d)\" to \"[61d78220089040d4c91ee5b52df63d29107e80aa](https://github.com/sagemath/sagetrac-mirror/commit/61d78220089040d4c91ee5b52df63d29107e80aa)\".",
    "created_at": "2020-01-14T15:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455720",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e5e79c9396db02a5fa5de3f3990afb25f6f1420d](https://github.com/sagemath/sagetrac-mirror/commit/e5e79c9396db02a5fa5de3f3990afb25f6f1420d)" to "[61d78220089040d4c91ee5b52df63d29107e80aa](https://github.com/sagemath/sagetrac-mirror/commit/61d78220089040d4c91ee5b52df63d29107e80aa)".



---

archive/issue_comments_455721.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61d78220089040d4c91ee5b52df63d29107e80aa\">61d7822</a></td><td><code>Trac #29002: lower the version bound on the system sqlite check.</code></td></tr></table>\n",
    "created_at": "2020-01-14T15:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455721",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>**Comment 5:**</a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61d78220089040d4c91ee5b52df63d29107e80aa">61d7822</a></td><td><code>Trac #29002: lower the version bound on the system sqlite check.</code></td></tr></table>




---

archive/issue_events_349375.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-01-14T15:15:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349375"
}
```



---

archive/issue_events_349376.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-01-14T15:15:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349376"
}
```



---

archive/issue_comments_455722.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nDone, but the commit hook set this back to needs_review.",
    "created_at": "2020-01-14T15:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455722",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:6'>**Comment 6:**</a>
Done, but the commit hook set this back to needs_review.



---

archive/issue_events_349377.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-14T15:32:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349377"
}
```



---

archive/issue_events_349378.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-14T15:32:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349378"
}
```



---

archive/issue_comments_455723.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nmissing author full name please",
    "created_at": "2020-01-14T20:04:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455723",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'>**Comment 8:**</a>
missing author full name please



---

archive/issue_comments_455724.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nSorry, I'm new at this.",
    "created_at": "2020-01-14T21:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455724",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:9'>**Comment 9:**</a>
Sorry, I'm new at this.



---

archive/issue_comments_455725.json:
```json
{
    "body": "**Author:** Michael Orlitzky",
    "created_at": "2020-01-14T21:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455725",
    "user": "https://github.com/orlitzky"
}
```

**Author:** Michael Orlitzky



---

archive/issue_comments_455726.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nThis does not accept the system sqlite3 on macOS because we are installing readline -- but that is irrelevant because the system sqlite3 is linked against libedit, not readline.",
    "created_at": "2020-01-15T16:57:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455726",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'>**Comment 10:**</a>
This does not accept the system sqlite3 on macOS because we are installing readline -- but that is irrelevant because the system sqlite3 is linked against libedit, not readline.



---

archive/issue_events_349379.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-15T16:57:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349379"
}
```



---

archive/issue_events_349380.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-15T16:57:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349380"
}
```



---

archive/issue_comments_455727.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\n\n```\negret:~/s/sage/sage-rebasing/worktree-venv (t/27824/public/27824-python3-spkg-configure *$)$ otool -L /usr/lib/libsqlite3.dylib \n/usr/lib/libsqlite3.dylib:\n\t/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 308.4.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1281.0.0)\negret:~/s/sage/sage-rebasing/worktree-venv (t/27824/public/27824-python3-spkg-configure *$)$ otool -L /usr/bin/sqlite3 \n/usr/bin/sqlite3:\n\t/usr/lib/libncurses.5.4.dylib (compatibility version 5.4.0, current version 5.4.0)\n\t/usr/lib/libedit.3.dylib (compatibility version 2.0.0, current version 3.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1281.0.0)\n```",
    "created_at": "2020-01-15T17:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455727",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'>**Comment 11:**</a>

```
egret:~/s/sage/sage-rebasing/worktree-venv (t/27824/public/27824-python3-spkg-configure *$)$ otool -L /usr/lib/libsqlite3.dylib 
/usr/lib/libsqlite3.dylib:
	/usr/lib/libsqlite3.dylib (compatibility version 9.0.0, current version 308.4.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1281.0.0)
egret:~/s/sage/sage-rebasing/worktree-venv (t/27824/public/27824-python3-spkg-configure *$)$ otool -L /usr/bin/sqlite3 
/usr/bin/sqlite3:
	/usr/lib/libncurses.5.4.dylib (compatibility version 5.4.0, current version 5.4.0)
	/usr/lib/libedit.3.dylib (compatibility version 2.0.0, current version 3.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1281.0.0)
```



---

archive/issue_comments_455728.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nIs the executable `sqlite3` used at all in Sage? That is the only thing that depends on readline on Linux.\nOn Debian, `libsqlite3.so` and `/usr/bin/sqlite3` are provided by different packages.",
    "created_at": "2020-01-15T17:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455728",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'>**Comment 12:**</a>
Is the executable `sqlite3` used at all in Sage? That is the only thing that depends on readline on Linux.
On Debian, `libsqlite3.so` and `/usr/bin/sqlite3` are provided by different packages.



---

archive/issue_comments_455729.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nhow does pkg-config even know about MacOS's sqlite3?",
    "created_at": "2020-01-15T17:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455729",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'>**Comment 13:**</a>
how does pkg-config even know about MacOS's sqlite3?



---

archive/issue_comments_455730.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nReplying to [@mkoeppe](#comment%3A12):\n> Is the executable `sqlite3` used at all in Sage? \n\nApart from providing the shortcut `sage -sqlite`, apparently not.\n\nShould the spkg-configure check for the availability of the binary?",
    "created_at": "2020-01-15T17:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455730",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'>**Comment 14:**</a>
Replying to [@mkoeppe](#comment%3A12):
> Is the executable `sqlite3` used at all in Sage? 

Apart from providing the shortcut `sage -sqlite`, apparently not.

Should the spkg-configure check for the availability of the binary?



---

archive/issue_comments_455731.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@dimpase](#comment%3A13):\n> how does pkg-config even know about MacOS's sqlite3? \n\nhomebrew's pkg-config knows it.",
    "created_at": "2020-01-15T17:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455731",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@dimpase](#comment%3A13):
> how does pkg-config even know about MacOS's sqlite3? 

homebrew's pkg-config knows it.



---

archive/issue_comments_455732.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nthen what does prevent one from having a homebrew-installed readline?",
    "created_at": "2020-01-15T17:23:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455732",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'>**Comment 16:**</a>
then what does prevent one from having a homebrew-installed readline?



---

archive/issue_comments_455733.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nAnything regarding readline is irrelevant for macOS's sqlite.",
    "created_at": "2020-01-15T17:27:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455733",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'>**Comment 17:**</a>
Anything regarding readline is irrelevant for macOS's sqlite.



---

archive/issue_comments_455734.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nBy the way, I don't quite get the point of SAGE_SPKG_DEPCHECK here at all. If we install our own readline, how is that relevant for the functioning of the system's sqlite3 package?",
    "created_at": "2020-01-15T17:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455734",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'>**Comment 18:**</a>
By the way, I don't quite get the point of SAGE_SPKG_DEPCHECK here at all. If we install our own readline, how is that relevant for the functioning of the system's sqlite3 package?



---

archive/issue_comments_455735.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nFor now, the sage sqlite package depends on readline, so the dep check is the right thing to do.\n\nBut, if sage doesn't care whether or not sqlite was built with readline support, then why don't we build it without readline support and remove the dependency from the spkg? Afterwards we would drop the dep check here, too, and everything would work out.\n\nPersonally, I would say that's a good idea, but I know there's a dissenting opinion that sage should install an independently-usable sqlite package, and that we should insist that the version on the system is comparable to the spkg.",
    "created_at": "2020-01-15T17:46:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455735",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:19'>**Comment 19:**</a>
For now, the sage sqlite package depends on readline, so the dep check is the right thing to do.

But, if sage doesn't care whether or not sqlite was built with readline support, then why don't we build it without readline support and remove the dependency from the spkg? Afterwards we would drop the dep check here, too, and everything would work out.

Personally, I would say that's a good idea, but I know there's a dissenting opinion that sage should install an independently-usable sqlite package, and that we should insist that the version on the system is comparable to the spkg.



---

archive/issue_comments_455736.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nReplying to [@orlitzky](#comment%3A19):\n> For now, the sage sqlite package depends on readline, so the dep check is the right thing to do.\n\nTo my understanding, PKG_CHECK_MODULES is used to guard specifically against link-time confusion of libraries and their dependencies. \n\n> But, if sage doesn't care whether or not sqlite was built with readline support, then why don't we build it without readline support and remove the dependency from the spkg? Afterwards we would drop the dep check here, too, and everything would work out.\n\nActually, the `sqlite3` on macOS is fully functional - it just provides command line editing through `libedit`, not `libreadline`.",
    "created_at": "2020-01-15T17:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455736",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'>**Comment 20:**</a>
Replying to [@orlitzky](#comment%3A19):
> For now, the sage sqlite package depends on readline, so the dep check is the right thing to do.

To my understanding, PKG_CHECK_MODULES is used to guard specifically against link-time confusion of libraries and their dependencies. 

> But, if sage doesn't care whether or not sqlite was built with readline support, then why don't we build it without readline support and remove the dependency from the spkg? Afterwards we would drop the dep check here, too, and everything would work out.

Actually, the `sqlite3` on macOS is fully functional - it just provides command line editing through `libedit`, not `libreadline`.



---

archive/issue_comments_455737.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nBy the way, on macOS, I get \n\n```\npkg-config --modversion sqlite3\n3.8.10.2\n```\nIs that too old?",
    "created_at": "2020-01-15T17:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455737",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'>**Comment 21:**</a>
By the way, on macOS, I get 

```
pkg-config --modversion sqlite3
3.8.10.2
```
Is that too old?



---

archive/issue_comments_455738.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nI would propose the following change (updated):\n\n```diff\ndiff --git a/build/pkgs/sqlite/spkg-configure.m4 b/build/pkgs/sqlite/spkg-configure.m4\nindex 00bf6cb14a..44c37e57cb 100644\n--- a/build/pkgs/sqlite/spkg-configure.m4\n+++ b/build/pkgs/sqlite/spkg-configure.m4\n@@ -1,8 +1,7 @@\n SAGE_SPKG_CONFIGURE([sqlite], [\n-  SAGE_SPKG_DEPCHECK([readline], [\n     PKG_CHECK_MODULES([SQLITE],\n-                      [sqlite3 >= 3.20.0],\n-                      [],\n+                      [sqlite3 >= 3.8.10],\n+                      [AC_CHECK_PROG([SQLITE3], sqlite3, [],\n+                        [AC_MSG_WARN([libsqlite3 is found, so we do not install the sqlite spkg, but sqlite3 is not found, so \"sage -sqlite3\" will not work])])],\n                       [sage_spkg_install_sqlite=yes])\n-  ])\n ])\n\n```",
    "created_at": "2020-01-15T18:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455738",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'>**Comment 22:**</a>
I would propose the following change (updated):

```diff
diff --git a/build/pkgs/sqlite/spkg-configure.m4 b/build/pkgs/sqlite/spkg-configure.m4
index 00bf6cb14a..44c37e57cb 100644
--- a/build/pkgs/sqlite/spkg-configure.m4
+++ b/build/pkgs/sqlite/spkg-configure.m4
@@ -1,8 +1,7 @@
 SAGE_SPKG_CONFIGURE([sqlite], [
-  SAGE_SPKG_DEPCHECK([readline], [
     PKG_CHECK_MODULES([SQLITE],
-                      [sqlite3 >= 3.20.0],
-                      [],
+                      [sqlite3 >= 3.8.10],
+                      [AC_CHECK_PROG([SQLITE3], sqlite3, [],
+                        [AC_MSG_WARN([libsqlite3 is found, so we do not install the sqlite spkg, but sqlite3 is not found, so "sage -sqlite3" will not work])])],
                       [sage_spkg_install_sqlite=yes])
-  ])
 ])

```



---

archive/issue_comments_455739.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nI note that the previous update tickets for the sqlite spkg were only motivated by build system issues, or because \"it's time to upgrade\". So I don't think the version has to be very new to work for any of our code. For example:\n- #27303 - Upgrade sqlite3 to 3.27.1\n- #22687- update sqlite to version 3.17\n- #16098 - Update sqlite to 3.8.4.3",
    "created_at": "2020-01-15T18:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455739",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'>**Comment 23:**</a>
I note that the previous update tickets for the sqlite spkg were only motivated by build system issues, or because "it's time to upgrade". So I don't think the version has to be very new to work for any of our code. For example:
- #27303 - Upgrade sqlite3 to 3.27.1
- #22687- update sqlite to version 3.17
- #16098 - Update sqlite to 3.8.4.3



---

archive/issue_comments_455740.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nAC_CHECK_PROG is not used correctly in [comment:22](#comment%3A22) - 3rd and 4rd parameters of it are values to be assigned to the variable from the 1st parameter, not actions to be performed...",
    "created_at": "2020-01-15T18:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455740",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'>**Comment 24:**</a>
AC_CHECK_PROG is not used correctly in [comment:22](#comment%3A22) - 3rd and 4rd parameters of it are values to be assigned to the variable from the 1st parameter, not actions to be performed...



---

archive/issue_comments_455741.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nReplying to [@mkoeppe](#comment%3A21):\n> By the way, on macOS, I get \n> \n> ```\n> pkg-config --modversion sqlite3\n> 3.8.10.2\n> ```\n> Is that too old?\n\nYeah, the lower bound is at 3.20 right now.\n\n\n>I would propose the following change (updated)\n\nOk, I agree. The dependency on readline *replaces* a dependency on editline (you have to pick one), so simply dropping the dependency from the sqlite package is not the option I thought it was. Moreover, readline/editline accomplish the same thing, so the dep check is counterproductive here.\n\nI don't think we even need to check for the sqlite3 executable. Zero people will run the system sqlite using sage -sqlite3, and even fewer than zero people read the ./configure output.",
    "created_at": "2020-01-15T18:38:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455741",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:25'>**Comment 25:**</a>
Replying to [@mkoeppe](#comment%3A21):
> By the way, on macOS, I get 
> 
> ```
> pkg-config --modversion sqlite3
> 3.8.10.2
> ```
> Is that too old?

Yeah, the lower bound is at 3.20 right now.


>I would propose the following change (updated)

Ok, I agree. The dependency on readline *replaces* a dependency on editline (you have to pick one), so simply dropping the dependency from the sqlite package is not the option I thought it was. Moreover, readline/editline accomplish the same thing, so the dep check is counterproductive here.

I don't think we even need to check for the sqlite3 executable. Zero people will run the system sqlite using sage -sqlite3, and even fewer than zero people read the ./configure output.



---

archive/issue_comments_455742.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\ncryptominisat package plays with SQL, in fact it can generate some SQL data, and sqlite3 is listed as its dependency.",
    "created_at": "2020-01-15T18:43:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455742",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'>**Comment 26:**</a>
cryptominisat package plays with SQL, in fact it can generate some SQL data, and sqlite3 is listed as its dependency.



---

archive/issue_comments_455743.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nReplying to [@dimpase](#comment%3A26):\n> cryptominisat package plays with SQL, in fact it can generate some SQL data, and sqlite3 is listed as its dependency.\n> \n\nRight, and we still have the pkg-config check to ensure that sqlite3 is installed. Are there any distros that install it *without* the CLI? I doubt it... and that's the only reason we would need an extra check for it.",
    "created_at": "2020-01-15T18:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455743",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:27'>**Comment 27:**</a>
Replying to [@dimpase](#comment%3A26):
> cryptominisat package plays with SQL, in fact it can generate some SQL data, and sqlite3 is listed as its dependency.
> 

Right, and we still have the pkg-config check to ensure that sqlite3 is installed. Are there any distros that install it *without* the CLI? I doubt it... and that's the only reason we would need an extra check for it.



---

archive/issue_comments_455744.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nReplying to [@orlitzky](#comment%3A25):\n> Replying to [@mkoeppe](#comment%3A21):\n> > \n> > ```\n> > pkg-config --modversion sqlite3\n> > 3.8.10.2\n> > ```\n> > Is that too old?\n\n> \n> Yeah, the lower bound is at 3.20 right now.\n\nI can see that - but my question is why.",
    "created_at": "2020-01-15T18:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455744",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'>**Comment 28:**</a>
Replying to [@orlitzky](#comment%3A25):
> Replying to [@mkoeppe](#comment%3A21):
> > 
> > ```
> > pkg-config --modversion sqlite3
> > 3.8.10.2
> > ```
> > Is that too old?

> 
> Yeah, the lower bound is at 3.20 right now.

I can see that - but my question is why.



---

archive/issue_comments_455745.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nReplying to [@mkoeppe](#comment%3A28):\n> \n> I can see that - but my question is why.\n\nMainly just because the further back in time we go, the less valid my testing with v3.29 becomes. New commits incoming.",
    "created_at": "2020-01-15T18:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455745",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:29'>**Comment 29:**</a>
Replying to [@mkoeppe](#comment%3A28):
> 
> I can see that - but my question is why.

Mainly just because the further back in time we go, the less valid my testing with v3.29 becomes. New commits incoming.



---

archive/issue_comments_455746.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nReplying to [@orlitzky](#comment%3A27):\n>  Are there any distros that install it *without* the CLI? I doubt it... and that's the only reason we would need an extra check for it.\n\nYes, if one installs `libsqlite3-dev` on Debian, the CLI is not installed.",
    "created_at": "2020-01-15T18:52:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455746",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'>**Comment 30:**</a>
Replying to [@orlitzky](#comment%3A27):
>  Are there any distros that install it *without* the CLI? I doubt it... and that's the only reason we would need an extra check for it.

Yes, if one installs `libsqlite3-dev` on Debian, the CLI is not installed.



---

archive/issue_comments_455747.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nReplying to [@orlitzky](#comment%3A29):\n> Replying to [@mkoeppe](#comment%3A28):\n> > \n> > I can see that - but my question is why.\n\n> \n> Mainly just because the further back in time we go, the less valid my testing with v3.29 becomes. New commits incoming.\n\nTests of what? I can test on macOS if necessary. I think we should support the default libsqlite that is shipped with the current XCode on macOS.",
    "created_at": "2020-01-15T18:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455747",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'>**Comment 31:**</a>
Replying to [@orlitzky](#comment%3A29):
> Replying to [@mkoeppe](#comment%3A28):
> > 
> > I can see that - but my question is why.

> 
> Mainly just because the further back in time we go, the less valid my testing with v3.29 becomes. New commits incoming.

Tests of what? I can test on macOS if necessary. I think we should support the default libsqlite that is shipped with the current XCode on macOS.



---

archive/issue_comments_455748.json:
```json
{
    "body": "**Changing commit** from \"[61d78220089040d4c91ee5b52df63d29107e80aa](https://github.com/sagemath/sagetrac-mirror/commit/61d78220089040d4c91ee5b52df63d29107e80aa)\" to \"[d32194842f5f7f83c2d50d020267838176a666f3](https://github.com/sagemath/sagetrac-mirror/commit/d32194842f5f7f83c2d50d020267838176a666f3)\".",
    "created_at": "2020-01-15T18:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455748",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[61d78220089040d4c91ee5b52df63d29107e80aa](https://github.com/sagemath/sagetrac-mirror/commit/61d78220089040d4c91ee5b52df63d29107e80aa)" to "[d32194842f5f7f83c2d50d020267838176a666f3](https://github.com/sagemath/sagetrac-mirror/commit/d32194842f5f7f83c2d50d020267838176a666f3)".



---

archive/issue_comments_455749.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/961f850b915e4d267262d4a67129a031eb0cc48e\">961f850</a></td><td><code>Trac #29002: lower the version bound on the system sqlite check (again).</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d32194842f5f7f83c2d50d020267838176a666f3\">d321948</a></td><td><code>Trac #29002: drop the readline dependency check for system sqlite.</code></td></tr></table>\n",
    "created_at": "2020-01-15T18:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455749",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:32'>**Comment 32:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/961f850b915e4d267262d4a67129a031eb0cc48e">961f850</a></td><td><code>Trac #29002: lower the version bound on the system sqlite check (again).</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d32194842f5f7f83c2d50d020267838176a666f3">d321948</a></td><td><code>Trac #29002: drop the readline dependency check for system sqlite.</code></td></tr></table>




---

archive/issue_comments_455750.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nReplying to [@dimpase](#comment%3A26):\n> cryptominisat package plays with SQL, in fact it can generate some SQL data, and sqlite3 is listed as its dependency.\n> \n\nBut no specific version of sqlite is tested for in cryptominisat's build system, as far as I can see.",
    "created_at": "2020-01-15T18:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455750",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'>**Comment 33:**</a>
Replying to [@dimpase](#comment%3A26):
> cryptominisat package plays with SQL, in fact it can generate some SQL data, and sqlite3 is listed as its dependency.
> 

But no specific version of sqlite is tested for in cryptominisat's build system, as far as I can see.



---

archive/issue_comments_455751.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nReplying to [@mkoeppe](#comment%3A30):\n> Yes, if one installs `libsqlite3-dev` on Debian, the CLI is not installed.\n\nJFC. Should we fall back to the spkg if no CLI is found, then? I think Dima's point is that people will want to run the sqlite CLI in one way or another, to e.g. look at the cryptominisat data.",
    "created_at": "2020-01-15T18:58:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455751",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:34'>**Comment 34:**</a>
Replying to [@mkoeppe](#comment%3A30):
> Yes, if one installs `libsqlite3-dev` on Debian, the CLI is not installed.

JFC. Should we fall back to the spkg if no CLI is found, then? I think Dima's point is that people will want to run the sqlite CLI in one way or another, to e.g. look at the cryptominisat data.



---

archive/issue_comments_455752.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nReplying to [@orlitzky](#comment%3A34):\n> Should we fall back to the spkg if no CLI is found, then? I think Dima's point is that people will want to run the sqlite CLI in one way or another, to e.g. look at the cryptominisat data.\n\nFine with me.",
    "created_at": "2020-01-15T19:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455752",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'>**Comment 35:**</a>
Replying to [@orlitzky](#comment%3A34):
> Should we fall back to the spkg if no CLI is found, then? I think Dima's point is that people will want to run the sqlite CLI in one way or another, to e.g. look at the cryptominisat data.

Fine with me.



---

archive/issue_comments_455753.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nHmmm, can you try a full build on macOS against the system sqlite now? Since the spkg python also links against readline, I'm not 100% sure there won't be collisions between the readline symbols from python and the editline symbols from sqlite. Hopefully the linkage is isolated to the CLI and it won't matter.",
    "created_at": "2020-01-15T19:11:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455753",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:36'>**Comment 36:**</a>
Hmmm, can you try a full build on macOS against the system sqlite now? Since the spkg python also links against readline, I'm not 100% sure there won't be collisions between the readline symbols from python and the editline symbols from sqlite. Hopefully the linkage is isolated to the CLI and it won't matter.



---

archive/issue_comments_455754.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nAs you can see in comment 11, the library is not linked against `libedit`, only the executable is.",
    "created_at": "2020-01-15T19:28:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455754",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'>**Comment 37:**</a>
As you can see in comment 11, the library is not linked against `libedit`, only the executable is.



---

archive/issue_comments_455755.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nI think I'm fine with not checking for existence of sqlite3 executable at all.",
    "created_at": "2020-01-15T19:57:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455755",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:38'>**Comment 38:**</a>
I think I'm fine with not checking for existence of sqlite3 executable at all.



---

archive/issue_events_349381.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-15T19:58:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349381"
}
```



---

archive/issue_events_349382.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-15T19:58:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349382"
}
```



---

archive/issue_comments_455756.json:
```json
{
    "body": "**Changing reviewer** from \"Dima Pasechnik\" to \"Dima Pasechnik, Matthias Koeppe\".",
    "created_at": "2020-01-15T20:01:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455756",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Dima Pasechnik" to "Dima Pasechnik, Matthias Koeppe".



---

archive/issue_comments_455757.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nOk, I think it's safe too. If anyone shows up to complain later, the leg work is already done. We just have to add an additional AC_CHECK_PROG for sqlite3 and install the spkg if not found.",
    "created_at": "2020-01-16T02:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455757",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:41'>**Comment 41:**</a>
Ok, I think it's safe too. If anyone shows up to complain later, the leg work is already done. We just have to add an additional AC_CHECK_PROG for sqlite3 and install the spkg if not found.



---

archive/issue_events_349383.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-17T14:34:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349383"
}
```



---

archive/issue_events_349384.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-17T14:34:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349384"
}
```



---

archive/issue_comments_455758.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nI agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?",
    "created_at": "2020-01-17T14:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455758",
    "user": "https://github.com/embray"
}
```

<a id='comment:42'>**Comment 42:**</a>
I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?



---

archive/issue_comments_455759.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\nErik, isn't your Ubuntu past EOL?",
    "created_at": "2020-01-17T14:35:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455759",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'>**Comment 43:**</a>
Erik, isn't your Ubuntu past EOL?



---

archive/issue_comments_455760.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\nReplying to [@embray](#comment%3A42):\n> I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?\n\nWhich Ubuntu is that?",
    "created_at": "2020-01-17T14:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455760",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'>**Comment 44:**</a>
Replying to [@embray](#comment%3A42):
> I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?

Which Ubuntu is that?



---

archive/issue_comments_455761.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nBut I think I would also be in favor of falling back to AC_CHECK_LIB, in fact. MacOS (without homebrew) has sqlite3 but no sqlite.pc.",
    "created_at": "2020-01-17T14:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455761",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'>**Comment 45:**</a>
But I think I would also be in favor of falling back to AC_CHECK_LIB, in fact. MacOS (without homebrew) has sqlite3 but no sqlite.pc.



---

archive/issue_comments_455762.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\nUnfortunately AX_LIB_SQLITE3 from autoconf-archive is not good, it tries to parse header files to find out the version.",
    "created_at": "2020-01-17T15:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455762",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'>**Comment 46:**</a>
Unfortunately AX_LIB_SQLITE3 from autoconf-archive is not good, it tries to parse header files to find out the version.



---

archive/issue_comments_455763.json:
```json
{
    "body": "<a id='comment:47'>**Comment 47:**</a>\nWhat's wrong with that?  In any case, I'd be okay for a fallback to not check the version.  Having pkgconfig and a version check is definitely preferable as a first pass...",
    "created_at": "2020-01-17T16:01:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455763",
    "user": "https://github.com/embray"
}
```

<a id='comment:47'>**Comment 47:**</a>
What's wrong with that?  In any case, I'd be okay for a fallback to not check the version.  Having pkgconfig and a version check is definitely preferable as a first pass...



---

archive/issue_comments_455764.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\nReplying to [@mkoeppe](#comment%3A44):\n> Replying to [@embray](#comment%3A42):\n> > I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?\n\n> Which Ubuntu is that?\n\nI'm testing this on bionic (18.04).",
    "created_at": "2020-01-17T16:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455764",
    "user": "https://github.com/embray"
}
```

<a id='comment:48'>**Comment 48:**</a>
Replying to [@mkoeppe](#comment%3A44):
> Replying to [@embray](#comment%3A42):
> > I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?

> Which Ubuntu is that?

I'm testing this on bionic (18.04).



---

archive/issue_comments_455765.json:
```json
{
    "body": "<a id='comment:49'>**Comment 49:**</a>\nReplying to [@embray](#comment%3A48):\n> Replying to [@mkoeppe](#comment%3A44):\n> > Replying to [@embray](#comment%3A42):\n> > > I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?\n\n> > Which Ubuntu is that?\n\n> \n> I'm testing this on bionic (18.04).\n\nMy bad, it turns out I didn't have libsqlite3-dev installed (thought I did).  After that I have the .pc file.  Still would be nice to have a fallback though if possible.",
    "created_at": "2020-01-17T16:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455765",
    "user": "https://github.com/embray"
}
```

<a id='comment:49'>**Comment 49:**</a>
Replying to [@embray](#comment%3A48):
> Replying to [@mkoeppe](#comment%3A44):
> > Replying to [@embray](#comment%3A42):
> > > I agree that the sqlite3 CLI should not be required.  But this doesn't seem to work for me; my Ubuntu doesn't install a sqlite.pc?  Couldn't we also fall back on a AC_CHECK_LIB?

> > Which Ubuntu is that?

> 
> I'm testing this on bionic (18.04).

My bad, it turns out I didn't have libsqlite3-dev installed (thought I did).  After that I have the .pc file.  Still would be nice to have a fallback though if possible.



---

archive/issue_comments_455766.json:
```json
{
    "body": "<a id='comment:50'>**Comment 50:**</a>\nOne can write an `AC_RUN_IFELSE` test that calls `sqlite3_libversion_number()`.",
    "created_at": "2020-01-17T16:05:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455766",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:50'>**Comment 50:**</a>
One can write an `AC_RUN_IFELSE` test that calls `sqlite3_libversion_number()`.



---

archive/issue_comments_455767.json:
```json
{
    "body": "<a id='comment:51'>**Comment 51:**</a>\nalthough it's probably an overkill.",
    "created_at": "2020-01-17T16:06:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455767",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'>**Comment 51:**</a>
although it's probably an overkill.



---

archive/issue_comments_455768.json:
```json
{
    "body": "<a id='comment:52'>**Comment 52:**</a>\nReplying to [@embray](#comment%3A47):\n> What's wrong with that? \n\nEverything. It cannot reliably succeed to parse the correct file that would be used by the compiler.\nAnd it did fail on macOS for exactly that reason.",
    "created_at": "2020-01-17T16:09:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455768",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:52'>**Comment 52:**</a>
Replying to [@embray](#comment%3A47):
> What's wrong with that? 

Everything. It cannot reliably succeed to parse the correct file that would be used by the compiler.
And it did fail on macOS for exactly that reason.



---

archive/issue_comments_455769.json:
```json
{
    "body": "<a id='comment:53'>**Comment 53:**</a>\nReplying to [@dimpase](#comment%3A50):\n> One can write an `AC_RUN_IFELSE` test that calls `sqlite3_libversion_number()`.\n\nThat's the correct solution, I can work on this if you're not faster.",
    "created_at": "2020-01-17T16:09:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455769",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'>**Comment 53:**</a>
Replying to [@dimpase](#comment%3A50):
> One can write an `AC_RUN_IFELSE` test that calls `sqlite3_libversion_number()`.

That's the correct solution, I can work on this if you're not faster.



---

archive/issue_comments_455770.json:
```json
{
    "body": "<a id='comment:54'>**Comment 54:**</a>\nReplying to [@mkoeppe](#comment%3A52):\n> Replying to [@embray](#comment%3A47):\n> > What's wrong with that? \n\n> Everything. It cannot reliably succeed to parse the correct file that would be used by the compiler.\n> And it did fail on macOS for exactly that reason.\n\nAh, of course.  My brain went completely past literally parsing the header file directly to parsing the output of a test program that prints the value of a macro sqlite3.h or something :)",
    "created_at": "2020-01-17T16:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455770",
    "user": "https://github.com/embray"
}
```

<a id='comment:54'>**Comment 54:**</a>
Replying to [@mkoeppe](#comment%3A52):
> Replying to [@embray](#comment%3A47):
> > What's wrong with that? 

> Everything. It cannot reliably succeed to parse the correct file that would be used by the compiler.
> And it did fail on macOS for exactly that reason.

Ah, of course.  My brain went completely past literally parsing the header file directly to parsing the output of a test program that prints the value of a macro sqlite3.h or something :)



---

archive/issue_comments_455771.json:
```json
{
    "body": "<a id='comment:55'>**Comment 55:**</a>\nDoes the MacOS version (without homebrew) also install the library and development headers? Otherwise we'd be adding a fallback for nobody.\n\nIf we wind up digging through headers and libraries anyway, the pkg-config check becomes redundant.",
    "created_at": "2020-01-17T16:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455771",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:55'>**Comment 55:**</a>
Does the MacOS version (without homebrew) also install the library and development headers? Otherwise we'd be adding a fallback for nobody.

If we wind up digging through headers and libraries anyway, the pkg-config check becomes redundant.



---

archive/issue_comments_455772.json:
```json
{
    "body": "<a id='comment:56'>**Comment 56:**</a>\nReplying to [@mkoeppe](#comment%3A53):\n> Replying to [@dimpase](#comment%3A50):\n> > One can write an `AC_RUN_IFELSE` test that calls `sqlite3_libversion_number()`.\n\n> That's the correct solution, I can work on this if you're not faster.\n\nplease go ahead, I have to write a paper and presentations now :-)\n\nWe certainly already have examples of using `AC_RUN_IFELSE`, e.g. in\n`build/pkgs/ntl/spkg-configure.m4`",
    "created_at": "2020-01-17T16:16:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455772",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:56'>**Comment 56:**</a>
Replying to [@mkoeppe](#comment%3A53):
> Replying to [@dimpase](#comment%3A50):
> > One can write an `AC_RUN_IFELSE` test that calls `sqlite3_libversion_number()`.

> That's the correct solution, I can work on this if you're not faster.

please go ahead, I have to write a paper and presentations now :-)

We certainly already have examples of using `AC_RUN_IFELSE`, e.g. in
`build/pkgs/ntl/spkg-configure.m4`



---

archive/issue_comments_455773.json:
```json
{
    "body": "<a id='comment:57'>**Comment 57:**</a>\nReplying to [@orlitzky](#comment%3A55):\n> Does the MacOS version (without homebrew) also install the library and development headers? \n\nYes. Part of XCode.",
    "created_at": "2020-01-17T16:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455773",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'>**Comment 57:**</a>
Replying to [@orlitzky](#comment%3A55):
> Does the MacOS version (without homebrew) also install the library and development headers? 

Yes. Part of XCode.



---

archive/issue_comments_455774.json:
```json
{
    "body": "**Changing branch** from \"[u/mjo/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/29002)\" to \"[u/mkoeppe/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/ticket/29002)\".",
    "created_at": "2020-01-17T22:35:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455774",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/mjo/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/29002)" to "[u/mkoeppe/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/ticket/29002)".



---

archive/issue_comments_455775.json:
```json
{
    "body": "**Changing commit** from \"[d32194842f5f7f83c2d50d020267838176a666f3](https://github.com/sagemath/sagetrac-mirror/commit/d32194842f5f7f83c2d50d020267838176a666f3)\" to \"[5f0e680bf2e675f67761107d97e0512f9675a1a0](https://github.com/sagemath/sagetrac-mirror/commit/5f0e680bf2e675f67761107d97e0512f9675a1a0)\".",
    "created_at": "2020-01-17T22:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455775",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[d32194842f5f7f83c2d50d020267838176a666f3](https://github.com/sagemath/sagetrac-mirror/commit/d32194842f5f7f83c2d50d020267838176a666f3)" to "[5f0e680bf2e675f67761107d97e0512f9675a1a0](https://github.com/sagemath/sagetrac-mirror/commit/5f0e680bf2e675f67761107d97e0512f9675a1a0)".



---

archive/issue_comments_455776.json:
```json
{
    "body": "<a id='comment:59'>**Comment 59:**</a>\nThis now works on macOS with current XCode even if no homebrew is in PATH.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f0e680bf2e675f67761107d97e0512f9675a1a0\">5f0e680</a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Fall back to checking with AC_RUN_IFELSE</code></td></tr></table>\n",
    "created_at": "2020-01-17T22:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455776",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:59'>**Comment 59:**</a>
This now works on macOS with current XCode even if no homebrew is in PATH.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f0e680bf2e675f67761107d97e0512f9675a1a0">5f0e680</a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Fall back to checking with AC_RUN_IFELSE</code></td></tr></table>




---

archive/issue_comments_455777.json:
```json
{
    "body": "**Changing author** from \"Michael Orlitzky\" to \"Michael Orlitzky, Matthias Koeppe\".",
    "created_at": "2020-01-17T22:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455777",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "Michael Orlitzky" to "Michael Orlitzky, Matthias Koeppe".



---

archive/issue_events_349385.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-17T22:44:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349385"
}
```



---

archive/issue_events_349386.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-17T22:44:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349386"
}
```



---

archive/issue_comments_455778.json:
```json
{
    "body": "<a id='comment:60'>**Comment 60:**</a>\nBy the way, the check using pkgconfig is a bit questionable because Python, as far as I can see, does not actually use pkgconfig to find the library, and the results obtained by `PKG_CHECK_MODULES`, the variables `SQLITE_CFLAGS` and `SQLITE_LIBS`, are not passed to Python's build system.",
    "created_at": "2020-01-17T22:48:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455778",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'>**Comment 60:**</a>
By the way, the check using pkgconfig is a bit questionable because Python, as far as I can see, does not actually use pkgconfig to find the library, and the results obtained by `PKG_CHECK_MODULES`, the variables `SQLITE_CFLAGS` and `SQLITE_LIBS`, are not passed to Python's build system.



---

archive/issue_comments_455779.json:
```json
{
    "body": "<a id='comment:61'>**Comment 61:**</a>\nBut that is not a problem at least on macOS with homebrew. By default it provides the pc for the system-installed library, `/usr/local/Homebrew/Library/Homebrew/os/mac/pkgconfig/10.15/sqlite3.pc`, which is 3.8.10.2. The homebrew-provided library is installed \"keg-only\" and informs at installation that \"For pkg-config to find sqlite you may need to set:`export PKG_CONFIG_PATH=\"/usr/local/opt/sqlite/lib/pkgconfig\"`. That provides 3.30.1.",
    "created_at": "2020-01-17T22:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455779",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:61'>**Comment 61:**</a>
But that is not a problem at least on macOS with homebrew. By default it provides the pc for the system-installed library, `/usr/local/Homebrew/Library/Homebrew/os/mac/pkgconfig/10.15/sqlite3.pc`, which is 3.8.10.2. The homebrew-provided library is installed "keg-only" and informs at installation that "For pkg-config to find sqlite you may need to set:`export PKG_CONFIG_PATH="/usr/local/opt/sqlite/lib/pkgconfig"`. That provides 3.30.1.



---

archive/issue_comments_455780.json:
```json
{
    "body": "<a id='comment:62'>**Comment 62:**</a>\nwhy are you using sqlite3_libversion() rather than sqlite3_libversion_number() ?\nthe latter returns `int` you are assembling by hand from the output of sqlite3_libversion()...",
    "created_at": "2020-01-17T23:27:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455780",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:62'>**Comment 62:**</a>
why are you using sqlite3_libversion() rather than sqlite3_libversion_number() ?
the latter returns `int` you are assembling by hand from the output of sqlite3_libversion()...



---

archive/issue_comments_455781.json:
```json
{
    "body": "<a id='comment:63'>**Comment 63:**</a>\nNo, I'm converting the required version from its components.",
    "created_at": "2020-01-17T23:35:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455781",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'>**Comment 63:**</a>
No, I'm converting the required version from its components.



---

archive/issue_comments_455782.json:
```json
{
    "body": "<a id='comment:64'>**Comment 64:**</a>\nReplying to [@mkoeppe](#comment%3A60):\n> By the way, the check using pkgconfig is a bit questionable because Python, as far as I can see, does not actually use pkgconfig to find the library, ...\n\nEverything we do in these spkg-configure files is a bit questionable =)\n\nBasically we're trying to fake the checks that already (or should already) take place in the upstream packages, but as simply and with as little code as possible. A \"perfect\" implementation of spkg-configure for libfoo would copy/paste every upstream check for libfoo. But that's crazy, so we try to get away with something less than perfect, but still functional. If it works in 95% of cases and is harmless in the others, that's a win.\n\n...which brings me to your custom version check. I believe that it works, but it's way too complicated for what we need to do. Keep in mind that we don't really care about the version of sqlite3. I only bothered to check it with pkg-config because it's trivial to do with pkg-config. As far as I can tell, you can cover the known cases with a combination of `AC_CHECK_HEADER([sqlite3.h],...)` and `AC_SEARCH_LIBS([(sqlite3_libversion],[sqlite3],...)`. That's still not perfect, because it doesn't check for every function that python uses, but if it works for the people CC'ed on this ticket it will probably work for everyone.\n\nThere's no reason to keep the PKG_CHECK_MODULES around at that point. If the first test works sometimes and the second test works all the time, why try both?",
    "created_at": "2020-01-18T00:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455782",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:64'>**Comment 64:**</a>
Replying to [@mkoeppe](#comment%3A60):
> By the way, the check using pkgconfig is a bit questionable because Python, as far as I can see, does not actually use pkgconfig to find the library, ...

Everything we do in these spkg-configure files is a bit questionable =)

Basically we're trying to fake the checks that already (or should already) take place in the upstream packages, but as simply and with as little code as possible. A "perfect" implementation of spkg-configure for libfoo would copy/paste every upstream check for libfoo. But that's crazy, so we try to get away with something less than perfect, but still functional. If it works in 95% of cases and is harmless in the others, that's a win.

...which brings me to your custom version check. I believe that it works, but it's way too complicated for what we need to do. Keep in mind that we don't really care about the version of sqlite3. I only bothered to check it with pkg-config because it's trivial to do with pkg-config. As far as I can tell, you can cover the known cases with a combination of `AC_CHECK_HEADER([sqlite3.h],...)` and `AC_SEARCH_LIBS([(sqlite3_libversion],[sqlite3],...)`. That's still not perfect, because it doesn't check for every function that python uses, but if it works for the people CC'ed on this ticket it will probably work for everyone.

There's no reason to keep the PKG_CHECK_MODULES around at that point. If the first test works sometimes and the second test works all the time, why try both?



---

archive/issue_comments_455783.json:
```json
{
    "body": "**Changing commit** from \"[5f0e680bf2e675f67761107d97e0512f9675a1a0](https://github.com/sagemath/sagetrac-mirror/commit/5f0e680bf2e675f67761107d97e0512f9675a1a0)\" to \"[18f32a927b44f886e2ba599ba2a2db5947e05e2e](https://github.com/sagemath/sagetrac-mirror/commit/18f32a927b44f886e2ba599ba2a2db5947e05e2e)\".",
    "created_at": "2020-01-18T01:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455783",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[5f0e680bf2e675f67761107d97e0512f9675a1a0](https://github.com/sagemath/sagetrac-mirror/commit/5f0e680bf2e675f67761107d97e0512f9675a1a0)" to "[18f32a927b44f886e2ba599ba2a2db5947e05e2e](https://github.com/sagemath/sagetrac-mirror/commit/18f32a927b44f886e2ba599ba2a2db5947e05e2e)".



---

archive/issue_comments_455784.json:
```json
{
    "body": "<a id='comment:65'>**Comment 65:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18f32a927b44f886e2ba599ba2a2db5947e05e2e\">18f32a9</a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Remove the test with PKG_CHECK_MODULES</code></td></tr></table>\n",
    "created_at": "2020-01-18T01:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455784",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:65'>**Comment 65:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18f32a927b44f886e2ba599ba2a2db5947e05e2e">18f32a9</a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Remove the test with PKG_CHECK_MODULES</code></td></tr></table>




---

archive/issue_comments_455785.json:
```json
{
    "body": "<a id='comment:66'>**Comment 66:**</a>\nThanks for the discussion. I have removed the PKG_CHECK_MODULES.\n\nRegarding the version check, I am following the recommendations of upstream: https://www.sqlite.org/c3ref/libversion.html",
    "created_at": "2020-01-18T01:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455785",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:66'>**Comment 66:**</a>
Thanks for the discussion. I have removed the PKG_CHECK_MODULES.

Regarding the version check, I am following the recommendations of upstream: https://www.sqlite.org/c3ref/libversion.html



---

archive/issue_comments_455786.json:
```json
{
    "body": "<a id='comment:67'>**Comment 67:**</a>\nMy point about the version check is that your program is currently doing four things:\n\n1. Ensuring that sqlite3.h is in the include path.\n2. Ensuring that the `sqlite3_libversion()` function is in the `sqlite3` library.\n3. Doing some math to see if the version of sqlite3 is newer than 3.8.7.\n4. Setting `LIBS+=\" -lsqlite3\"` if everything worked out, or setting `sage_spkg_install_sqlite=yes` if it didn't.\n\nThat's all good, but the third item is superfluous since we don't really care what version of sqlite3 you have (so long as it works). And if you remove the version check, then items 1, 2, and 4 can all be accomplished with AC_CHECK_HEADER and AC_SEARCH_LIBS in three or four lines.",
    "created_at": "2020-01-18T01:47:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455786",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:67'>**Comment 67:**</a>
My point about the version check is that your program is currently doing four things:

1. Ensuring that sqlite3.h is in the include path.
2. Ensuring that the `sqlite3_libversion()` function is in the `sqlite3` library.
3. Doing some math to see if the version of sqlite3 is newer than 3.8.7.
4. Setting `LIBS+=" -lsqlite3"` if everything worked out, or setting `sage_spkg_install_sqlite=yes` if it didn't.

That's all good, but the third item is superfluous since we don't really care what version of sqlite3 you have (so long as it works). And if you remove the version check, then items 1, 2, and 4 can all be accomplished with AC_CHECK_HEADER and AC_SEARCH_LIBS in three or four lines.



---

archive/issue_comments_455787.json:
```json
{
    "body": "<a id='comment:68'>**Comment 68:**</a>\nReplying to [@orlitzky](#comment%3A67):\n> ... we don't really care what version of sqlite3 you have (so long as it works)\n\nThe version of sqlite3 for a python build was an issue as recently as 2017 here:\nhttps://bugs.python.org/issue29098\n\nI don't have time to determine a more precise bound. But we do need to check *some* lower bound for the version (or test features of sqlite3).",
    "created_at": "2020-01-18T02:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455787",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:68'>**Comment 68:**</a>
Replying to [@orlitzky](#comment%3A67):
> ... we don't really care what version of sqlite3 you have (so long as it works)

The version of sqlite3 for a python build was an issue as recently as 2017 here:
https://bugs.python.org/issue29098

I don't have time to determine a more precise bound. But we do need to check *some* lower bound for the version (or test features of sqlite3).



---

archive/issue_comments_455788.json:
```json
{
    "body": "<a id='comment:69'>**Comment 69:**</a>\nReplying to [@mkoeppe](#comment%3A68):\n> Replying to [@orlitzky](#comment%3A67):\n> > ... we don't really care what version of sqlite3 you have (so long as it works)\n\n> \n> The version of sqlite3 for a python build was an issue as recently as 2017 here:\n> https://bugs.python.org/issue29098\n\nThey changed that code so that older versions of sqlite will work.\n\n> I don't have time to determine a more precise bound. But we do need to check *some* lower bound for the version (or test features of sqlite3).\n\nWhy? Python itself doesn't even bother.",
    "created_at": "2020-01-18T02:41:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455788",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:69'>**Comment 69:**</a>
Replying to [@mkoeppe](#comment%3A68):
> Replying to [@orlitzky](#comment%3A67):
> > ... we don't really care what version of sqlite3 you have (so long as it works)

> 
> The version of sqlite3 for a python build was an issue as recently as 2017 here:
> https://bugs.python.org/issue29098

They changed that code so that older versions of sqlite will work.

> I don't have time to determine a more precise bound. But we do need to check *some* lower bound for the version (or test features of sqlite3).

Why? Python itself doesn't even bother.



---

archive/issue_comments_455789.json:
```json
{
    "body": "<a id='comment:70'>**Comment 70:**</a>\nReplying to [@orlitzky](#comment%3A69):\n> Replying to [@mkoeppe](#comment%3A68):\n> > Replying to [@orlitzky](#comment%3A67):\n> > > ... we don't really care what version of sqlite3 you have (so long as it works)\n\n> > \n> > The version of sqlite3 for a python build was an issue as recently as 2017 here:\n> > https://bugs.python.org/issue29098\n\n> \n> They changed that code so that older versions of sqlite will work.\n\nWhich versions do?",
    "created_at": "2020-01-18T02:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455789",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:70'>**Comment 70:**</a>
Replying to [@orlitzky](#comment%3A69):
> Replying to [@mkoeppe](#comment%3A68):
> > Replying to [@orlitzky](#comment%3A67):
> > > ... we don't really care what version of sqlite3 you have (so long as it works)

> > 
> > The version of sqlite3 for a python build was an issue as recently as 2017 here:
> > https://bugs.python.org/issue29098

> 
> They changed that code so that older versions of sqlite will work.

Which versions do?



---

archive/issue_comments_455790.json:
```json
{
    "body": "<a id='comment:71'>**Comment 71:**</a>\nReplying to [@mkoeppe](#comment%3A70):\n> > \n> > They changed that code so that older versions of sqlite will work.\n\n> \n> Which versions do?\n\nPython doesn't do a version check, and doesn't document any version bounds, so presumably all of them.\n\nPut another way: if we find a version that makes it past *our* version-less check but that breaks python... then that's a python bug.",
    "created_at": "2020-01-18T02:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455790",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:71'>**Comment 71:**</a>
Replying to [@mkoeppe](#comment%3A70):
> > 
> > They changed that code so that older versions of sqlite will work.

> 
> Which versions do?

Python doesn't do a version check, and doesn't document any version bounds, so presumably all of them.

Put another way: if we find a version that makes it past *our* version-less check but that breaks python... then that's a python bug.



---

archive/issue_comments_455791.json:
```json
{
    "body": "<a id='comment:72'>**Comment 72:**</a>\nBut it is not the goal of sage-the-distribution to provoke python bugs.\n\nWe vendor a version of sqlite so that the vendored python can build.",
    "created_at": "2020-01-18T02:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455791",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:72'>**Comment 72:**</a>
But it is not the goal of sage-the-distribution to provoke python bugs.

We vendor a version of sqlite so that the vendored python can build.



---

archive/issue_comments_455792.json:
```json
{
    "body": "<a id='comment:73'>**Comment 73:**</a>\nReplying to [@mkoeppe](#comment%3A72):\n> But it is not the goal of sage-the-distribution to provoke python bugs.\n> \n\n\nYou make it sound so negative =)\n\n**If** there's a version of sqlite that doesn't work with python, and **if** someone tries to build sage with it (both unlikely), then we report the bug upstream. At that point -- depending on the upstream fix -- we either do nothing or amend this spkg-configure with a lower bound.\n\nOtherwise, we're just making things complicated for no ostensible reason. Since nobody is going to test every 3.x version of sqlite, we're still ultimately guessing at the lower version bound. My guess just happens to be 3.0.0.\n\nIf it's wrong, we can change it, but 3.0.0 is more likely to be correct than any other untested bound, and simplifies this check as a bonus.",
    "created_at": "2020-01-18T03:16:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455792",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:73'>**Comment 73:**</a>
Replying to [@mkoeppe](#comment%3A72):
> But it is not the goal of sage-the-distribution to provoke python bugs.
> 


You make it sound so negative =)

**If** there's a version of sqlite that doesn't work with python, and **if** someone tries to build sage with it (both unlikely), then we report the bug upstream. At that point -- depending on the upstream fix -- we either do nothing or amend this spkg-configure with a lower bound.

Otherwise, we're just making things complicated for no ostensible reason. Since nobody is going to test every 3.x version of sqlite, we're still ultimately guessing at the lower version bound. My guess just happens to be 3.0.0.

If it's wrong, we can change it, but 3.0.0 is more likely to be correct than any other untested bound, and simplifies this check as a bonus.



---

archive/issue_comments_455793.json:
```json
{
    "body": "<a id='comment:74'>**Comment 74:**</a>\nI think one reason for these checks is to make supporting sage(lib) a bearable job. We don't want to bog down in corner cases on museum-grade OSes, just cause they might carry a museum-grade version of sqlite3.\n\nSo I am for keeping a version check. \n\nOne other thing - for better of worse, spkg-configure.m4 in other packages undefine local m4 variables they happen to define, whereas here it does not happen.\nThey use `m4_pushdef/m4_popdef` pair of macros for these purposes.\nCan we keep to the same style here?",
    "created_at": "2020-01-18T09:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455793",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:74'>**Comment 74:**</a>
I think one reason for these checks is to make supporting sage(lib) a bearable job. We don't want to bog down in corner cases on museum-grade OSes, just cause they might carry a museum-grade version of sqlite3.

So I am for keeping a version check. 

One other thing - for better of worse, spkg-configure.m4 in other packages undefine local m4 variables they happen to define, whereas here it does not happen.
They use `m4_pushdef/m4_popdef` pair of macros for these purposes.
Can we keep to the same style here?



---

archive/issue_comments_455794.json:
```json
{
    "body": "<a id='comment:75'>**Comment 75:**</a>\nReplying to [@dimpase](#comment%3A74):\n> I think one reason for these checks is to make supporting sage(lib) a bearable job. We don't want to bog down in corner cases on museum-grade OSes, just cause they might carry a museum-grade version of sqlite3.\n> \n> So I am for keeping a version check. \n> \n\nThat's a bit ironic considering that four people have wasted hours replacing\n\n```\nSAGE_SPKG_CONFIGURE([sqlite], [\n  PKG_CHECK_MODULES([SQLITE],\n                    [sqlite3 >= 3.8.7],\n                    [],\n                    [sage_spkg_install_sqlite=yes])\n])\n```\n\nwith\n\n```\nSAGE_SPKG_CONFIGURE([sqlite], [\n  m4_define([sqlite3_min_version_major], [3])\n  m4_define([sqlite3_min_version_minor], [8])\n  m4_define([sqlite3_min_version_micro], [7])\n  m4_define([sqlite3_min_version], [sqlite3_min_version_major.sqlite3_min_version_minor.sqlite3_min_version_micro])\n  AC_MSG_CHECKING([libsqlite3 >= sqlite3_min_version])\n                     dnl https://www.sqlite.org/c3ref/libversion.html\n                     dnl https://www.sqlite.org/c3ref/c_source_id.html\n                     SQLITE_SAVED_LIBS=\"$LIBS\"\n                     LIBS=\"$LIBS -lsqlite3\"\n                     AC_RUN_IFELSE([\n                       AC_LANG_PROGRAM([[\n                                         #include <sqlite3.h>\n                                         #include <assert.h>\n                                         #include <stdlib.h>\n                                         #include <string.h>\n                                       ]],\n                                       [[\n                                         assert( strcmp(sqlite3_libversion(),SQLITE_VERSION)==0 );\n                                         if (SQLITE_VERSION_NUMBER < ]]sqlite3_min_version_major[[*1000000 + ]]sqlite3_min_version_minor[[*1000 + ]]sqlite3_min_version_micro[[)\n                                           exit(1);\n                                         else\n                                           exit(0);\n                                       ]])\n                       ],\n                       [AC_MSG_RESULT([yes])],\n                       [AC_MSG_RESULT([no])\n                        LIBS=\"$SQLITE_SAVED_LIBS\"\n                        sage_spkg_install_sqlite=yes])\n])\n```\n\nto support one version of sqlite on one proprietary OS whose maintainers went out of their way to delete an important file from the package.\n\nsagelib doesn't even use sqlite, it's a dependency of a dependency",
    "created_at": "2020-01-18T15:40:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455794",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:75'>**Comment 75:**</a>
Replying to [@dimpase](#comment%3A74):
> I think one reason for these checks is to make supporting sage(lib) a bearable job. We don't want to bog down in corner cases on museum-grade OSes, just cause they might carry a museum-grade version of sqlite3.
> 
> So I am for keeping a version check. 
> 

That's a bit ironic considering that four people have wasted hours replacing

```
SAGE_SPKG_CONFIGURE([sqlite], [
  PKG_CHECK_MODULES([SQLITE],
                    [sqlite3 >= 3.8.7],
                    [],
                    [sage_spkg_install_sqlite=yes])
])
```

with

```
SAGE_SPKG_CONFIGURE([sqlite], [
  m4_define([sqlite3_min_version_major], [3])
  m4_define([sqlite3_min_version_minor], [8])
  m4_define([sqlite3_min_version_micro], [7])
  m4_define([sqlite3_min_version], [sqlite3_min_version_major.sqlite3_min_version_minor.sqlite3_min_version_micro])
  AC_MSG_CHECKING([libsqlite3 >= sqlite3_min_version])
                     dnl https://www.sqlite.org/c3ref/libversion.html
                     dnl https://www.sqlite.org/c3ref/c_source_id.html
                     SQLITE_SAVED_LIBS="$LIBS"
                     LIBS="$LIBS -lsqlite3"
                     AC_RUN_IFELSE([
                       AC_LANG_PROGRAM([[
                                         #include <sqlite3.h>
                                         #include <assert.h>
                                         #include <stdlib.h>
                                         #include <string.h>
                                       ]],
                                       [[
                                         assert( strcmp(sqlite3_libversion(),SQLITE_VERSION)==0 );
                                         if (SQLITE_VERSION_NUMBER < ]]sqlite3_min_version_major[[*1000000 + ]]sqlite3_min_version_minor[[*1000 + ]]sqlite3_min_version_micro[[)
                                           exit(1);
                                         else
                                           exit(0);
                                       ]])
                       ],
                       [AC_MSG_RESULT([yes])],
                       [AC_MSG_RESULT([no])
                        LIBS="$SQLITE_SAVED_LIBS"
                        sage_spkg_install_sqlite=yes])
])
```

to support one version of sqlite on one proprietary OS whose maintainers went out of their way to delete an important file from the package.

sagelib doesn't even use sqlite, it's a dependency of a dependency



---

archive/issue_comments_455795.json:
```json
{
    "body": "<a id='comment:76'>**Comment 76:**</a>\nReplying to [@orlitzky](#comment%3A75):\n>  considering that four people have wasted hours \n\nExcuse me, m4 and autotools are my hobby.",
    "created_at": "2020-01-18T18:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455795",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:76'>**Comment 76:**</a>
Replying to [@orlitzky](#comment%3A75):
>  considering that four people have wasted hours 

Excuse me, m4 and autotools are my hobby.



---

archive/issue_comments_455796.json:
```json
{
    "body": "<a id='comment:77'>**Comment 77:**</a>\nReplying to [@dimpase](#comment%3A74):\n> spkg-configure.m4 in other packages undefine local m4 variables they happen to define, whereas here it does not happen.\n> They use `m4_pushdef/m4_popdef` pair of macros for these purposes.\n> Can we keep to the same style here?\n\nGood idea, will do.",
    "created_at": "2020-01-18T18:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455796",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:77'>**Comment 77:**</a>
Replying to [@dimpase](#comment%3A74):
> spkg-configure.m4 in other packages undefine local m4 variables they happen to define, whereas here it does not happen.
> They use `m4_pushdef/m4_popdef` pair of macros for these purposes.
> Can we keep to the same style here?

Good idea, will do.



---

archive/issue_comments_455797.json:
```json
{
    "body": "<a id='comment:78'>**Comment 78:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705\">b261b31</a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Use m4_push/popdef and match style of other spkg-configure.m4</code></td></tr></table>\n",
    "created_at": "2020-01-18T18:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455797",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:78'>**Comment 78:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705">b261b31</a></td><td><code>build/pkgs/sqlite/spkg-configure.m4: Use m4_push/popdef and match style of other spkg-configure.m4</code></td></tr></table>




---

archive/issue_comments_455798.json:
```json
{
    "body": "**Changing commit** from \"[18f32a927b44f886e2ba599ba2a2db5947e05e2e](https://github.com/sagemath/sagetrac-mirror/commit/18f32a927b44f886e2ba599ba2a2db5947e05e2e)\" to \"[b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)\".",
    "created_at": "2020-01-18T18:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455798",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[18f32a927b44f886e2ba599ba2a2db5947e05e2e](https://github.com/sagemath/sagetrac-mirror/commit/18f32a927b44f886e2ba599ba2a2db5947e05e2e)" to "[b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)".



---

archive/issue_comments_455799.json:
```json
{
    "body": "<a id='comment:79'>**Comment 79:**</a>\nReady for review.",
    "created_at": "2020-01-18T18:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455799",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:79'>**Comment 79:**</a>
Ready for review.



---

archive/issue_comments_455800.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1,8 @@\n-SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). It also provides a pkgconfig file in the versions I checked, so it should be pretty easy to detect.\n+SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). \n \n+libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the current version available on XCode as the lower bound.\n+\n+We detect it using `AC_RUN_IFELSE` because on macOS without homebrew, there is no pkgconfig file.\n+\n+\n+\n``````\n",
    "created_at": "2020-01-18T18:38:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455800",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1,8 @@
-SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). It also provides a pkgconfig file in the versions I checked, so it should be pretty easy to detect.
+SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). 
 
+libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the current version available on XCode as the lower bound.
+
+We detect it using `AC_RUN_IFELSE` because on macOS without homebrew, there is no pkgconfig file.
+
+
+
``````




---

archive/issue_comments_455801.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). \n \n-libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the current version available on XCode as the lower bound.\n+libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the lower bound slightly lower than the current version available on XCode.\n \n We detect it using `AC_RUN_IFELSE` because on macOS without homebrew, there is no pkgconfig file.\n \n``````\n",
    "created_at": "2020-01-18T19:09:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455801",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 SQLite is another package that many people will have installed (firefox uses it, for example) and that has few dependencies in Sage (only readline). 
 
-libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the current version available on XCode as the lower bound.
+libsqlite3 is used by Python during its build. Some Python packages need sufficiently new versions. We set the lower bound slightly lower than the current version available on XCode.
 
 We detect it using `AC_RUN_IFELSE` because on macOS without homebrew, there is no pkgconfig file.
 
``````




---

archive/issue_events_349387.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-19T20:40:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349387"
}
```



---

archive/issue_events_349388.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-19T20:40:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349388"
}
```



---

archive/issue_comments_455802.json:
```json
{
    "body": "<a id='comment:82'>**Comment 82:**</a>\nlgtm",
    "created_at": "2020-01-19T20:40:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455802",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:82'>**Comment 82:**</a>
lgtm



---

archive/issue_comments_455803.json:
```json
{
    "body": "<a id='comment:83'>**Comment 83:**</a>\nThank you!",
    "created_at": "2020-01-19T21:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455803",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:83'>**Comment 83:**</a>
Thank you!



---

archive/issue_comments_455804.json:
```json
{
    "body": "<a id='comment:84'>**Comment 84:**</a>\nReplying to [@mkoeppe](#comment%3A76):\n> Replying to [@orlitzky](#comment%3A75):\n> >  considering that four people have wasted hours \n\n> \n> Excuse me, m4 and autotools are my hobby.\n\nHAHA :)\n\nI'm also +1 for keeping the version check; personally I would lower the minimum version 3.0.0 until/unless a stronger minimum is actually determined.  But 3.8.7 is still old-enough that it should be satisfied on most system so I'm okay with it.",
    "created_at": "2020-01-22T12:34:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455804",
    "user": "https://github.com/embray"
}
```

<a id='comment:84'>**Comment 84:**</a>
Replying to [@mkoeppe](#comment%3A76):
> Replying to [@orlitzky](#comment%3A75):
> >  considering that four people have wasted hours 

> 
> Excuse me, m4 and autotools are my hobby.

HAHA :)

I'm also +1 for keeping the version check; personally I would lower the minimum version 3.0.0 until/unless a stronger minimum is actually determined.  But 3.8.7 is still old-enough that it should be satisfied on most system so I'm okay with it.



---

archive/issue_comments_455805.json:
```json
{
    "body": "<a id='comment:85'>**Comment 85:**</a>\nReplying to [@embray](#comment%3A84):\n>  I would lower the minimum version 3.0.0 until/unless a stronger minimum is actually determined.  But 3.8.7 is still old-enough that it should be satisfied on most system so I'm okay with it.\n\n3.0.0 was released in 2004. https://www.sqlite.org/chronology.html",
    "created_at": "2020-01-22T15:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455805",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:85'>**Comment 85:**</a>
Replying to [@embray](#comment%3A84):
>  I would lower the minimum version 3.0.0 until/unless a stronger minimum is actually determined.  But 3.8.7 is still old-enough that it should be satisfied on most system so I'm okay with it.

3.0.0 was released in 2004. https://www.sqlite.org/chronology.html



---

archive/issue_comments_455806.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/ticket/29002)\" to \"[b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)\".",
    "created_at": "2020-01-22T20:43:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455806",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/ticket/29002](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/ticket/29002)" to "[b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)".



---

archive/issue_events_349389.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-22T20:43:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349389"
}
```



---

archive/issue_events_349390.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3f9ef468a2a708f7c3607ed4200c912bba50f93d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-01-22T20:43:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29002#event-349390"
}
```



---

archive/issue_comments_455807.json:
```json
{
    "body": "<a id='comment:87'>**Comment 87:**</a>\nIt turns out there are some tests that fail if the sqlite3 executable is not installed:\n\n```\nsage -t --long --warn-long 78.2 src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 608, in sage.tests.cmdline.test_executable\nFailed example:\n    out.startswith(\"3.\")\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 610, in sage.tests.cmdline.test_executable\nFailed example:\n    err\nExpected:\n    ''\nGot:\n    '/home/sage/sage/src/bin/sage: line 546: exec: sqlite3: not found\\n'\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 612, in sage.tests.cmdline.test_executable\nFailed example:\n    ret\nExpected:\n    0\nGot:\n    127\n**********************************************************************\n1 item had failures:\n   3 of 236 in sage.tests.cmdline.test_executable\n    [235 tests, 3 failures, 45.53 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 78.2 src/sage/tests/cmdline.py  # 3 doctests failed\n----------------------------------------------------------------------\n```\n\nSo, technically it is a regression of `sage -sqlite3` does not work.  I don't think this is very important functionality and it would probably be better if it were slowly deprecated (I think the same should be the case for most `sage -<program name>`--rather, that most of those should be undocumented, and that there should be a generic interface for running executables that might be installed in the Sage distribution).\n\nIn the meantime, I'm leaning towards we need to check for it...",
    "created_at": "2020-01-28T11:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455807",
    "user": "https://github.com/embray"
}
```

<a id='comment:87'>**Comment 87:**</a>
It turns out there are some tests that fail if the sqlite3 executable is not installed:

```
sage -t --long --warn-long 78.2 src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 608, in sage.tests.cmdline.test_executable
Failed example:
    out.startswith("3.")
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/tests/cmdline.py", line 610, in sage.tests.cmdline.test_executable
Failed example:
    err
Expected:
    ''
Got:
    '/home/sage/sage/src/bin/sage: line 546: exec: sqlite3: not found\n'
**********************************************************************
File "src/sage/tests/cmdline.py", line 612, in sage.tests.cmdline.test_executable
Failed example:
    ret
Expected:
    0
Got:
    127
**********************************************************************
1 item had failures:
   3 of 236 in sage.tests.cmdline.test_executable
    [235 tests, 3 failures, 45.53 s]
----------------------------------------------------------------------
sage -t --long --warn-long 78.2 src/sage/tests/cmdline.py  # 3 doctests failed
----------------------------------------------------------------------
```

So, technically it is a regression of `sage -sqlite3` does not work.  I don't think this is very important functionality and it would probably be better if it were slowly deprecated (I think the same should be the case for most `sage -<program name>`--rather, that most of those should be undocumented, and that there should be a generic interface for running executables that might be installed in the Sage distribution).

In the meantime, I'm leaning towards we need to check for it...



---

archive/issue_comments_455808.json:
```json
{
    "body": "**Changing commit** from \"[b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)\" to \"\".",
    "created_at": "2020-01-28T11:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455808",
    "user": "https://github.com/embray"
}
```

**Changing commit** from "[b261b315c3866a3fc178626431df1089e9059705](https://github.com/sagemath/sagetrac-mirror/commit/b261b315c3866a3fc178626431df1089e9059705)" to "".



---

archive/issue_comments_455809.json:
```json
{
    "body": "<a id='comment:88'>**Comment 88:**</a>\nReplying to [@embray](#comment%3A87):\n> It turns out there are some tests that fail if the sqlite3 executable is not installed:\n\n[ Snip... ]\n\n> So, technically it is a regression of `sage -sqlite3` does not work.\n\nIndeed. I just got bitten by this (trying to ebuild 9.1.beta2 from scratch rather than upgrading).\n\n>    I don't think this is very important functionality and it would probably be better if it were slowly deprecated (I think the same should be the case for most `sage -<program name>`--rather, that most of those should be undocumented, and that there should be a generic interface for running executables that might be installed in the Sage distribution).\n\nI tend to disagree : an unsuspecting user might have a hard time to understand why \"our\" version replaces the one he/she installed in his/her system if he/she runs out utility that installs system shortcuts for Sage-installed programs  ...\n\n> \n> In the meantime, I'm leaning towards we need to check for it...\n\nIndeed. But since `sqlite` is so widely used, we might alsoi depend on the relevant packages (easy for Unices, possibly not so easy for Windows (Madison ?), and possible Apple shenanigans...).\n\nBTW, our move to reduce the size of Sage-the-distribution should reopen the question of what are our minimal dependencies. I would have no problem to depend on `sqlite`, more on `Maxima` (Lisp interpreters !) and even more on `R` (size, dependencies on OpenSSL, etc...)\n\nShould that be disciussed on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel) ?\n\nIn the meantime, should we open a new ticket ?",
    "created_at": "2020-01-30T11:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455809",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:88'>**Comment 88:**</a>
Replying to [@embray](#comment%3A87):
> It turns out there are some tests that fail if the sqlite3 executable is not installed:

[ Snip... ]

> So, technically it is a regression of `sage -sqlite3` does not work.

Indeed. I just got bitten by this (trying to ebuild 9.1.beta2 from scratch rather than upgrading).

>    I don't think this is very important functionality and it would probably be better if it were slowly deprecated (I think the same should be the case for most `sage -<program name>`--rather, that most of those should be undocumented, and that there should be a generic interface for running executables that might be installed in the Sage distribution).

I tend to disagree : an unsuspecting user might have a hard time to understand why "our" version replaces the one he/she installed in his/her system if he/she runs out utility that installs system shortcuts for Sage-installed programs  ...

> 
> In the meantime, I'm leaning towards we need to check for it...

Indeed. But since `sqlite` is so widely used, we might alsoi depend on the relevant packages (easy for Unices, possibly not so easy for Windows (Madison ?), and possible Apple shenanigans...).

BTW, our move to reduce the size of Sage-the-distribution should reopen the question of what are our minimal dependencies. I would have no problem to depend on `sqlite`, more on `Maxima` (Lisp interpreters !) and even more on `R` (size, dependencies on OpenSSL, etc...)

Should that be disciussed on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel) ?

In the meantime, should we open a new ticket ?



---

archive/issue_comments_455810.json:
```json
{
    "body": "<a id='comment:89'>**Comment 89:**</a>\nReplying to [@EmmanuelCharpentier](#comment%3A88):\n> Replying to [@embray](#comment%3A87):\n> > It turns out there are some tests that fail if the sqlite3 executable is not installed:\n\n> \n> [ Snip... ]\n> \n> > So, technically it is a regression of `sage -sqlite3` does not work.\n\n> \n> Indeed. I just got bitten by this (trying to ebuild 9.1.beta2 from scratch rather than upgrading).\n> \n> >    I don't think this is very important functionality and it would probably be better if it were slowly deprecated (I think the same should be the case for most `sage -<program name>`--rather, that most of those should be undocumented, and that there should be a generic interface for running executables that might be installed in the Sage distribution).\n\n> \n> I tend to disagree : an unsuspecting user might have a hard time to understand why \"our\" version replaces the one he/she installed in his/her system if he/she runs out utility that installs system shortcuts for Sage-installed programs  ...\n> \n\nIn the long run there should be no sqlite or libsqlite bundled into Sage.\n\n\n> > \n> > In the meantime, I'm leaning towards we need to check for it...\n\n> \n> Indeed. But since `sqlite` is so widely used, we might alsoi depend on the relevant packages (easy for Unices, possibly not so easy for Windows (Madison ?), and possible Apple shenanigans...).\n> \n> BTW, our move to reduce the size of Sage-the-distribution should reopen the question of what are our minimal dependencies. I would have no problem to depend on `sqlite`, more on `Maxima` (Lisp interpreters !) and even more on `R` (size, dependencies on OpenSSL, etc...)\n> \n\nI won't worry too much about R, as it's already more or less sorted.\nMaxima/ECL is harder, as it's tigher integrated into Sage, and as ECL is moving very slowly nowadays (and with significant changes to come).\n\n\n\n\n> Should that be disciussed on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel) ?\n> \n> In the meantime, should we open a new ticket ?\n\nyes, please, for deprecating/removing `sage -FOO` functionality for `FOO=sqlite` and other values like this, right?\n\n>",
    "created_at": "2020-01-30T11:45:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455810",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:89'>**Comment 89:**</a>
Replying to [@EmmanuelCharpentier](#comment%3A88):
> Replying to [@embray](#comment%3A87):
> > It turns out there are some tests that fail if the sqlite3 executable is not installed:

> 
> [ Snip... ]
> 
> > So, technically it is a regression of `sage -sqlite3` does not work.

> 
> Indeed. I just got bitten by this (trying to ebuild 9.1.beta2 from scratch rather than upgrading).
> 
> >    I don't think this is very important functionality and it would probably be better if it were slowly deprecated (I think the same should be the case for most `sage -<program name>`--rather, that most of those should be undocumented, and that there should be a generic interface for running executables that might be installed in the Sage distribution).

> 
> I tend to disagree : an unsuspecting user might have a hard time to understand why "our" version replaces the one he/she installed in his/her system if he/she runs out utility that installs system shortcuts for Sage-installed programs  ...
> 

In the long run there should be no sqlite or libsqlite bundled into Sage.


> > 
> > In the meantime, I'm leaning towards we need to check for it...

> 
> Indeed. But since `sqlite` is so widely used, we might alsoi depend on the relevant packages (easy for Unices, possibly not so easy for Windows (Madison ?), and possible Apple shenanigans...).
> 
> BTW, our move to reduce the size of Sage-the-distribution should reopen the question of what are our minimal dependencies. I would have no problem to depend on `sqlite`, more on `Maxima` (Lisp interpreters !) and even more on `R` (size, dependencies on OpenSSL, etc...)
> 

I won't worry too much about R, as it's already more or less sorted.
Maxima/ECL is harder, as it's tigher integrated into Sage, and as ECL is moving very slowly nowadays (and with significant changes to come).




> Should that be disciussed on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel) ?
> 
> In the meantime, should we open a new ticket ?

yes, please, for deprecating/removing `sage -FOO` functionality for `FOO=sqlite` and other values like this, right?

>



---

archive/issue_comments_455811.json:
```json
{
    "body": "<a id='comment:90'>**Comment 90:**</a>\n@embray Thanks for spotting this and for opening the follow-up ticket:\n- #29092 sqlite3 CLI executable should be checked for at configure time\nI agree that this needs to be fixed.",
    "created_at": "2020-01-30T16:02:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455811",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:90'>**Comment 90:**</a>
@embray Thanks for spotting this and for opening the follow-up ticket:
- #29092 sqlite3 CLI executable should be checked for at configure time
I agree that this needs to be fixed.



---

archive/issue_comments_455812.json:
```json
{
    "body": "<a id='comment:91'>**Comment 91:**</a>\nI have opened:\n- #29111 Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution",
    "created_at": "2020-01-30T16:13:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29002",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29002#issuecomment-455812",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:91'>**Comment 91:**</a>
I have opened:
- #29111 Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution
