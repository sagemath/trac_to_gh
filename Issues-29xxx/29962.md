# Issue 29962: Introduce random-seed option to allow fuzzing of doctests

archive/issues_029725.json:
```json
{
    "body": "This is the first step towards #29935.\n\nWe introduce an option for doctests: `--random-seed`.\n\nThis allows specifying which seed to use for tests\ninvolving randomness.\n\nThe seed is displayed in the test log:\n\n```\nsage -t --long --random-seed=9876543210 src/sage/all.py \n...\nDoctesting 1 file.\nsage -t --long --random-seed=9876543210 src/sage/all.py\n    [16 tests, 0.73 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.8 seconds\n    cpu time: 0.7 seconds\n    cumulative wall time: 0.7 seconds\n```\n\nwhich makes it easy to re-run tests with the same seed.\n\nThe seed defaults to `0` for now:\n\n```\nsage -t --long src/sage/all.py \n...\nDoctesting 1 file.\nsage -t --long --random-seed=0 src/sage/all.py\n    [16 tests, 0.73 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.8 seconds\n    cpu time: 0.7 seconds\n    cumulative wall time: 0.7 seconds\n```\n\nbut the plan in #29935 is to eventually have\nthe random seed itself picked at random by default.\n\n**CC:**  @slel\n\n**Keywords:** doctests, random\n\n**Branch:** [1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)\n\n**Reviewer:** Markus Wageringel, Matthias Koeppe\n\n**Author:** Jonathan Kliem\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29962\n\n",
    "closed_at": "2020-07-19T07:24:18Z",
    "created_at": "2020-06-24T19:06:29Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Introduce random-seed option to allow fuzzing of doctests",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29962",
    "user": "https://github.com/kliem"
}
```
This is the first step towards #29935.

We introduce an option for doctests: `--random-seed`.

This allows specifying which seed to use for tests
involving randomness.

The seed is displayed in the test log:

```
sage -t --long --random-seed=9876543210 src/sage/all.py 
...
Doctesting 1 file.
sage -t --long --random-seed=9876543210 src/sage/all.py
    [16 tests, 0.73 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.8 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
```

which makes it easy to re-run tests with the same seed.

The seed defaults to `0` for now:

```
sage -t --long src/sage/all.py 
...
Doctesting 1 file.
sage -t --long --random-seed=0 src/sage/all.py
    [16 tests, 0.73 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.8 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
```

but the plan in #29935 is to eventually have
the random seed itself picked at random by default.

**CC:**  @slel

**Keywords:** doctests, random

**Branch:** [1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)

**Reviewer:** Markus Wageringel, Matthias Koeppe

**Author:** Jonathan Kliem

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/29962





---

archive/issue_comments_589326.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2020-06-24T19:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589326",
    "user": "https://github.com/kliem"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_589327.json:
```json
{
    "body": "**Branch:** [public/29962](https://github.com/sagemath/sagetrac-mirror/tree/public/29962)",
    "created_at": "2020-06-24T19:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589327",
    "user": "https://github.com/kliem"
}
```

**Branch:** [public/29962](https://github.com/sagemath/sagetrac-mirror/tree/public/29962)



---

archive/issue_comments_589328.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da1c6beec7d0bb6b972d88ecf9fb4eccbdf285a5\">da1c6be</a></td><td><code>start from a \"random\" random seed for doctesting</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7b836d789e034433d62f331f33fbc1821c0deaa\">b7b836d</a></td><td><code>make random seed reproducible</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eedbe5ebea9c2b9da79404013c566fe17d0a3e20\">eedbe5e</a></td><td><code>document random_seed</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a\">998b1b9</a></td><td><code>default random seed 0 for now</code></td></tr></table>\n",
    "created_at": "2020-06-24T19:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589328",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da1c6beec7d0bb6b972d88ecf9fb4eccbdf285a5">da1c6be</a></td><td><code>start from a "random" random seed for doctesting</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7b836d789e034433d62f331f33fbc1821c0deaa">b7b836d</a></td><td><code>make random seed reproducible</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eedbe5ebea9c2b9da79404013c566fe17d0a3e20">eedbe5e</a></td><td><code>document random_seed</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a">998b1b9</a></td><td><code>default random seed 0 for now</code></td></tr></table>




---

archive/issue_comments_589329.json:
```json
{
    "body": "**Commit:** [998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)",
    "created_at": "2020-06-24T19:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589329",
    "user": "https://github.com/kliem"
}
```

**Commit:** [998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)



---

archive/issue_comments_589330.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23ed583462cad48b1c0cf47dbfc77752d3dd3be1\">23ed583</a></td><td><code>fix doctest in hyperbolic_space/hyperbolic_point</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5283dc49042f5bfd45e2cfa92c567e6843b22f6d\">5283dc4</a></td><td><code>use abs tol flag</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b244c03bb763bde8a3b95fa2ce5c129562c3260\">7b244c0</a></td><td><code>modify doctests to the extend that they hold with fuzz</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/228f37973f5abf380feab366f931c8c4f3c85563\">228f379</a></td><td><code>Merge branch 'public/29936' of git://trac.sagemath.org/sage into public/29962</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c7e5620e9f8d66f0d131a6bda9da3b923f8330d\">5c7e562</a></td><td><code>fix double description of hypercube</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1bf211177ee3b734a314493c9474d9cd7eec661\">e1bf211</a></td><td><code>remove set_random_seed</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e7a998ff4281ba3911cc84c4b060d177e2931ec\">0e7a998</a></td><td><code>Merge branch 'public/29904' of git://trac.sagemath.org/sage into public/29962</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6a5dc7c96125b6140e56feafb82dd13599998e7\">b6a5dc7</a></td><td><code>fix random test in geometry/linear_expression</code></td></tr></table>\n",
    "created_at": "2020-06-24T19:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589330",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23ed583462cad48b1c0cf47dbfc77752d3dd3be1">23ed583</a></td><td><code>fix doctest in hyperbolic_space/hyperbolic_point</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5283dc49042f5bfd45e2cfa92c567e6843b22f6d">5283dc4</a></td><td><code>use abs tol flag</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b244c03bb763bde8a3b95fa2ce5c129562c3260">7b244c0</a></td><td><code>modify doctests to the extend that they hold with fuzz</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/228f37973f5abf380feab366f931c8c4f3c85563">228f379</a></td><td><code>Merge branch 'public/29936' of git://trac.sagemath.org/sage into public/29962</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c7e5620e9f8d66f0d131a6bda9da3b923f8330d">5c7e562</a></td><td><code>fix double description of hypercube</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1bf211177ee3b734a314493c9474d9cd7eec661">e1bf211</a></td><td><code>remove set_random_seed</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e7a998ff4281ba3911cc84c4b060d177e2931ec">0e7a998</a></td><td><code>Merge branch 'public/29904' of git://trac.sagemath.org/sage into public/29962</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6a5dc7c96125b6140e56feafb82dd13599998e7">b6a5dc7</a></td><td><code>fix random test in geometry/linear_expression</code></td></tr></table>




---

archive/issue_comments_589331.json:
```json
{
    "body": "**Changing commit** from \"[998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)\" to \"[b6a5dc7c96125b6140e56feafb82dd13599998e7](https://github.com/sagemath/sagetrac-mirror/commit/b6a5dc7c96125b6140e56feafb82dd13599998e7)\".",
    "created_at": "2020-06-24T19:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)" to "[b6a5dc7c96125b6140e56feafb82dd13599998e7](https://github.com/sagemath/sagetrac-mirror/commit/b6a5dc7c96125b6140e56feafb82dd13599998e7)".



---

archive/issue_comments_589332.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:",
    "created_at": "2020-06-24T19:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589332",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:



---

archive/issue_comments_589333.json:
```json
{
    "body": "**Changing commit** from \"[b6a5dc7c96125b6140e56feafb82dd13599998e7](https://github.com/sagemath/sagetrac-mirror/commit/b6a5dc7c96125b6140e56feafb82dd13599998e7)\" to \"[998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)\".",
    "created_at": "2020-06-24T19:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589333",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b6a5dc7c96125b6140e56feafb82dd13599998e7](https://github.com/sagemath/sagetrac-mirror/commit/b6a5dc7c96125b6140e56feafb82dd13599998e7)" to "[998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)".



---

archive/issue_comments_589334.json:
```json
{
    "body": "**Changing commit** from \"[998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)\" to \"[1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432](https://github.com/sagemath/sagetrac-mirror/commit/1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432)\".",
    "created_at": "2020-06-24T19:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589334",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[998b1b94ce1289ea92451a86e5f6191c37eaeb5a](https://github.com/sagemath/sagetrac-mirror/commit/998b1b94ce1289ea92451a86e5f6191c37eaeb5a)" to "[1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432](https://github.com/sagemath/sagetrac-mirror/commit/1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432)".



---

archive/issue_comments_589335.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432\">1d7b00e</a></td><td><code>dash instead of underscore for command line options</code></td></tr></table>\n",
    "created_at": "2020-06-24T19:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589335",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432">1d7b00e</a></td><td><code>dash instead of underscore for command line options</code></td></tr></table>




---

archive/issue_comments_589336.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n-We introduce an option for doctests `--random_seed` that defaults to `0` for now:\n+We introduce an option for doctests `--random-seed` that defaults to `0` for now:\n \n ```\n sage -t --long src/sage/all.py \n ...\n Doctesting 1 file.\n-sage -t --long --random_seed=0 src/sage/all.py\n+sage -t --long --random-seed=0 src/sage/all.py\n     [16 tests, 0.73 s]\n ----------------------------------------------------------------------\n All tests passed!\n``````\n",
    "created_at": "2020-06-24T19:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589336",
    "user": "https://github.com/kliem"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
-We introduce an option for doctests `--random_seed` that defaults to `0` for now:
+We introduce an option for doctests `--random-seed` that defaults to `0` for now:
 
 ```
 sage -t --long src/sage/all.py 
 ...
 Doctesting 1 file.
-sage -t --long --random_seed=0 src/sage/all.py
+sage -t --long --random-seed=0 src/sage/all.py
     [16 tests, 0.73 s]
 ----------------------------------------------------------------------
 All tests passed!
``````




---

archive/issue_comments_589337.json:
```json
{
    "body": "<a id='comment:6'></a>\nOverall, this looks good to me. The following changes seem to be needed:\n\n```diff\n-    sage: subprocess.call([\"sage\", \"-t\", \"--warn-long\", \"0\", \"--random-seed=0\", -random_seed.rst\"], **kwds)  # long time\n+    sage: subprocess.call([\"sage\", \"-t\", \"--warn-long\", \"0\", \"--random-seed=0\", \"random_seed.rst\"], **kwds)  # long time\n```\n\n```diff\n-  - ``--random_seed[=seed]`` -- random seed for fuzzing doctests\n+  - ``--random-seed[=seed]`` -- random seed for fuzzing doctests\n```",
    "created_at": "2020-07-10T22:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589337",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:6'></a>
Overall, this looks good to me. The following changes seem to be needed:

```diff
-    sage: subprocess.call(["sage", "-t", "--warn-long", "0", "--random-seed=0", -random_seed.rst"], **kwds)  # long time
+    sage: subprocess.call(["sage", "-t", "--warn-long", "0", "--random-seed=0", "random_seed.rst"], **kwds)  # long time
```

```diff
-  - ``--random_seed[=seed]`` -- random seed for fuzzing doctests
+  - ``--random-seed[=seed]`` -- random seed for fuzzing doctests
```



---

archive/issue_comments_589338.json:
```json
{
    "body": "**Reviewer:** Markus Wageringel",
    "created_at": "2020-07-10T22:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589338",
    "user": "https://github.com/mwageringel"
}
```

**Reviewer:** Markus Wageringel



---

archive/issue_comments_589339.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe branch adds this to the documentation, which is not true for this ticket:\n\n```\n--- a/src/doc/en/developer/doctesting.rst\n+++ b/src/doc/en/developer/doctesting.rst\n...\n+Doctests start from a random seed::\n+\n+    [kliem@sage sage-9.2]$ sage -t src/sage/doctest/tests/random_seed.rst\n...\n+    sage -t --warn-long 89.5 --random-seed=112986622569797306072457879734474628454 src/sage/doctest/tests/random_seed.rst\n+    **********************************************************************\n```",
    "created_at": "2020-07-10T23:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589339",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
The branch adds this to the documentation, which is not true for this ticket:

```
--- a/src/doc/en/developer/doctesting.rst
+++ b/src/doc/en/developer/doctesting.rst
...
+Doctests start from a random seed::
+
+    [kliem@sage sage-9.2]$ sage -t src/sage/doctest/tests/random_seed.rst
...
+    sage -t --warn-long 89.5 --random-seed=112986622569797306072457879734474628454 src/sage/doctest/tests/random_seed.rst
+    **********************************************************************
```



---

archive/issue_comments_589340.json:
```json
{
    "body": "<a id='comment:8'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b31e2d5dba166fdb4d8f9f6730df8cdb065ccae7\">b31e2d5</a></td><td><code>Merge branch 'public/29962' of git://trac.sagemath.org/sage into public/29962-reb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f30dd9b9e13cb8134b85a1165375ac8bdd1f683\">2f30dd9</a></td><td><code>small fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b62f781647851a3f27ecc95ea4b98b53838da112\">b62f781</a></td><td><code>doctests do not start from a random seed by default yet</code></td></tr></table>\n",
    "created_at": "2020-07-11T05:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589340",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b31e2d5dba166fdb4d8f9f6730df8cdb065ccae7">b31e2d5</a></td><td><code>Merge branch 'public/29962' of git://trac.sagemath.org/sage into public/29962-reb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f30dd9b9e13cb8134b85a1165375ac8bdd1f683">2f30dd9</a></td><td><code>small fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b62f781647851a3f27ecc95ea4b98b53838da112">b62f781</a></td><td><code>doctests do not start from a random seed by default yet</code></td></tr></table>




---

archive/issue_comments_589341.json:
```json
{
    "body": "**Changing commit** from \"[1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432](https://github.com/sagemath/sagetrac-mirror/commit/1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432)\" to \"[b62f781647851a3f27ecc95ea4b98b53838da112](https://github.com/sagemath/sagetrac-mirror/commit/b62f781647851a3f27ecc95ea4b98b53838da112)\".",
    "created_at": "2020-07-11T05:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589341",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432](https://github.com/sagemath/sagetrac-mirror/commit/1d7b00e3fc2ebc1dc9982a2df91d15e3f12e9432)" to "[b62f781647851a3f27ecc95ea4b98b53838da112](https://github.com/sagemath/sagetrac-mirror/commit/b62f781647851a3f27ecc95ea4b98b53838da112)".



---

archive/issue_comments_589342.json:
```json
{
    "body": "**Changing branch** from \"[public/29962](https://github.com/sagemath/sagetrac-mirror/tree/public/29962)\" to \"[public/29962-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb)\".",
    "created_at": "2020-07-11T05:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589342",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[public/29962](https://github.com/sagemath/sagetrac-mirror/tree/public/29962)" to "[public/29962-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb)".



---

archive/issue_comments_589343.json:
```json
{
    "body": "**Changing reviewer** from \"Markus Wageringel\" to \"Markus Wageringel, Matthias Koeppe\".",
    "created_at": "2020-07-11T06:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589343",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Markus Wageringel" to "Markus Wageringel, Matthias Koeppe".



---

archive/issue_comments_589344.json:
```json
{
    "body": "<a id='comment:9'></a>\nFrom my side this is a positive review - if patchbot is green",
    "created_at": "2020-07-11T06:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589344",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
From my side this is a positive review - if patchbot is green



---

archive/issue_comments_589345.json:
```json
{
    "body": "<a id='comment:10'></a>\nThanks. This successfully passes ptestlong.",
    "created_at": "2020-07-11T09:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589345",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:10'></a>
Thanks. This successfully passes ptestlong.



---

archive/issue_comments_589346.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-07-11T09:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589346",
    "user": "https://github.com/mwageringel"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_589347.json:
```json
{
    "body": "<a id='comment:11'></a>\nThank you.",
    "created_at": "2020-07-11T09:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589347",
    "user": "https://github.com/kliem"
}
```

<a id='comment:11'></a>
Thank you.



---

archive/issue_comments_589348.json:
```json
{
    "body": "<a id='comment:12'></a>\nMerge conflict",
    "created_at": "2020-07-11T23:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589348",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
Merge conflict



---

archive/issue_comments_589349.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2020-07-11T23:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589349",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_589350.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2020-07-12T17:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589350",
    "user": "https://github.com/kliem"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_589351.json:
```json
{
    "body": "**Changing commit** from \"[b62f781647851a3f27ecc95ea4b98b53838da112](https://github.com/sagemath/sagetrac-mirror/commit/b62f781647851a3f27ecc95ea4b98b53838da112)\" to \"[1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)\".",
    "created_at": "2020-07-12T17:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589351",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[b62f781647851a3f27ecc95ea4b98b53838da112](https://github.com/sagemath/sagetrac-mirror/commit/b62f781647851a3f27ecc95ea4b98b53838da112)" to "[1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)".



---

archive/issue_comments_589352.json:
```json
{
    "body": "<a id='comment:13'></a>\n`sage -t --long --all` passes for me.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f\">1d99129</a></td><td><code>fix merge conflict</code></td></tr></table>\n",
    "created_at": "2020-07-12T17:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589352",
    "user": "https://github.com/kliem"
}
```

<a id='comment:13'></a>
`sage -t --long --all` passes for me.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f">1d99129</a></td><td><code>fix merge conflict</code></td></tr></table>




---

archive/issue_comments_589353.json:
```json
{
    "body": "**Changing branch** from \"[public/29962-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb)\" to \"[public/29962-reb2](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb2)\".",
    "created_at": "2020-07-12T17:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589353",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[public/29962-reb](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb)" to "[public/29962-reb2](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb2)".



---

archive/issue_comments_589354.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-07-12T17:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589354",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_589355.json:
```json
{
    "body": "<a id='comment:15'></a>\nThank you.",
    "created_at": "2020-07-12T18:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589355",
    "user": "https://github.com/kliem"
}
```

<a id='comment:15'></a>
Thank you.



---

archive/issue_comments_589356.json:
```json
{
    "body": "**Changing branch** from \"[public/29962-reb2](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb2)\" to \"[1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)\".",
    "created_at": "2020-07-19T07:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589356",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/29962-reb2](https://github.com/sagemath/sagetrac-mirror/tree/public/29962-reb2)" to "[1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)".



---

archive/issue_comments_589357.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2020-07-19T07:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589357",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_086803.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-19T07:24:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29962#event-86803"
}
```



---

archive/issue_comments_589358.json:
```json
{
    "body": "**Changing commit** from \"[1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)\" to \"\".",
    "created_at": "2020-08-23T15:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589358",
    "user": "https://github.com/slel"
}
```

**Changing commit** from "[1d99129f26f4a065f9f9e5e13c3d5120a029e89f](https://github.com/sagemath/sagetrac-mirror/commit/1d99129f26f4a065f9f9e5e13c3d5120a029e89f)" to "".



---

archive/issue_comments_589359.json:
```json
{
    "body": "<a id='comment:17'></a>\nWhat random seeds are allowed? Any integer?\nOf any sign? Arbitrarily large?",
    "created_at": "2020-08-23T15:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589359",
    "user": "https://github.com/slel"
}
```

<a id='comment:17'></a>
What random seeds are allowed? Any integer?
Of any sign? Arbitrarily large?



---

archive/issue_comments_589360.json:
```json
{
    "body": "<a id='comment:18'></a>\nThis is how we will eventually get the random seeds.\n\n```\nsage: import sage.misc.randstate as randstate                                   \nsage: randstate.set_random_seed()                                               \nsage: randstate.initial_seed()                                                  \n11032378495085541661748859066830408537\n```\n\nAt least that's the plan for now. Any random seed that you can feed into `set_random_seed` should work.\n\n(Edit: But I wouldn't be surprised if there are bugs somewhere with some strange random seed. There is no way, you can avoid all of them. But at least you can prepare for rather probable cases.)",
    "created_at": "2020-08-23T16:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589360",
    "user": "https://github.com/kliem"
}
```

<a id='comment:18'></a>
This is how we will eventually get the random seeds.

```
sage: import sage.misc.randstate as randstate                                   
sage: randstate.set_random_seed()                                               
sage: randstate.initial_seed()                                                  
11032378495085541661748859066830408537
```

At least that's the plan for now. Any random seed that you can feed into `set_random_seed` should work.

(Edit: But I wouldn't be surprised if there are bugs somewhere with some strange random seed. There is no way, you can avoid all of them. But at least you can prepare for rather probable cases.)



---

archive/issue_comments_589361.json:
```json
{
    "body": "<a id='comment:19'></a>\nThe `random_seed` docstring says seed \"must be coercible to a Python long\".\n\nIs that from `-2**127` to `2**127 - 1`?\nOr are 32-bit and 64-bit systems different there?\n\nAlso isn't \"long\" a Python 2 concept,\nwith only \"int\" existing in Python 3?\n\nCould we document the admissible range in a follow-up ticket, for non-experts like me?",
    "created_at": "2020-08-23T22:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589361",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>
The `random_seed` docstring says seed "must be coercible to a Python long".

Is that from `-2**127` to `2**127 - 1`?
Or are 32-bit and 64-bit systems different there?

Also isn't "long" a Python 2 concept,
with only "int" existing in Python 3?

Could we document the admissible range in a follow-up ticket, for non-experts like me?



---

archive/issue_comments_589362.json:
```json
{
    "body": "<a id='comment:20'></a>\nAnd thanks for the work on varying random seeds when testing!",
    "created_at": "2020-08-23T22:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589362",
    "user": "https://github.com/slel"
}
```

<a id='comment:20'></a>
And thanks for the work on varying random seeds when testing!



---

archive/issue_comments_589363.json:
```json
{
    "body": "<a id='comment:21'></a>\nI added this issue to #29935.\n\nThe idea was that once all parts of Sage are ready for it, the default would be to select a \"random\" random seed.",
    "created_at": "2020-08-24T06:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589363",
    "user": "https://github.com/kliem"
}
```

<a id='comment:21'></a>
I added this issue to #29935.

The idea was that once all parts of Sage are ready for it, the default would be to select a "random" random seed.



---

archive/issue_comments_589364.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n-We introduce an option for doctests `--random-seed` that defaults to `0` for now:\n+Part of #29935.\n+\n+We introduce an option for doctests: `--random-seed`,\n+that defaults to `0` for now:\n \n ```\n sage -t --long src/sage/all.py \n@@ -14,4 +17,4 @@\n     cumulative wall time: 0.7 seconds\n ```\n \n-This allows specifying, which random seed shall be used for the doctests.\n+This allows specifying which random seed to use for the doctests.\n``````\n",
    "created_at": "2021-04-29T22:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589364",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,7 @@
-We introduce an option for doctests `--random-seed` that defaults to `0` for now:
+Part of #29935.
+
+We introduce an option for doctests: `--random-seed`,
+that defaults to `0` for now:
 
 ```
 sage -t --long src/sage/all.py 
@@ -14,4 +17,4 @@
     cumulative wall time: 0.7 seconds
 ```
 
-This allows specifying, which random seed shall be used for the doctests.
+This allows specifying which random seed to use for the doctests.
``````




---

archive/issue_comments_589365.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,29 @@\n-Part of #29935.\n+This is the first step towards #29935.\n \n-We introduce an option for doctests: `--random-seed`,\n-that defaults to `0` for now:\n+We introduce an option for doctests: `--random-seed`.\n+\n+This allows specifying which seed to use for tests\n+involving randomness.\n+\n+The seed is displayed in the test log:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/all.py \n+...\n+Doctesting 1 file.\n+sage -t --long --random-seed=9876543210 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+which makes it easy to re-run tests with the same seed.\n+\n+The seed defaults to `0` for now:\n \n ```\n sage -t --long src/sage/all.py \n@@ -17,4 +39,5 @@\n     cumulative wall time: 0.7 seconds\n ```\n \n-This allows specifying which random seed to use for the doctests.\n+but the plan in #29935 is to eventually have\n+the random seed itself picked at random by default.\n``````\n",
    "created_at": "2021-06-08T14:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29962#issuecomment-589365",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,29 @@
-Part of #29935.
+This is the first step towards #29935.
 
-We introduce an option for doctests: `--random-seed`,
-that defaults to `0` for now:
+We introduce an option for doctests: `--random-seed`.
+
+This allows specifying which seed to use for tests
+involving randomness.
+
+The seed is displayed in the test log:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/all.py 
+...
+Doctesting 1 file.
+sage -t --long --random-seed=9876543210 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+which makes it easy to re-run tests with the same seed.
+
+The seed defaults to `0` for now:
 
 ```
 sage -t --long src/sage/all.py 
@@ -17,4 +39,5 @@
     cumulative wall time: 0.7 seconds
 ```
 
-This allows specifying which random seed to use for the doctests.
+but the plan in #29935 is to eventually have
+the random seed itself picked at random by default.
``````




---

archive/issue_events_086804.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/29962",
    "rename": {
        "from": "Allow fuzzing of doctests",
        "to": "Introduce random-seed option to allow fuzzing of doctests"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29962#event-86804"
}
```
