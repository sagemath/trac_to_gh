# Issue 29082: Do not stage .pc files in src/lib/, clean old generated *.pc files at 'make distclean', fix 'permission denied' errors

archive/issues_028845.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\n#29003 introduced 2-stage installation of generated *.pc files, \nvia `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).\n \nAlso, in some installations, repeated installations this code leads to 'permission denied' errors when trying to overwrite read-only files:\n\n```\n  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/blas.pc\n  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/cblas.pc\n  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/lapack.pc\n  [openblas-0.3.6.p0]   \n  [openblas-0.3.6.p0]   real\t8m40.259s\n  [openblas-0.3.6.p0]   user\t45m2.739s\n  [openblas-0.3.6.p0]   sys\t5m48.754s\n  [openblas-0.3.6.p0]   Copying package files from temporary location /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local\n  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/cblas.pc: Permission denied\n  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/blas.pc: Permission denied\n  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/lapack.pc: Permission denied\n```\n\nThis ticket revises the installation as follows:\n\n- `configure` no longer creates .pc files in the build tree\n- Instead it creates rules in `make/Makefile` that create the .pc files in `SAGE_LOCAL`.\n- Before pc files are installed into `SAGE_LOCAL`, the targets are removed, to avoid permission problems\n\nThis ticket does not solve everything. There may still be problems when switching from a system library to an spkg-provided library. We will use the follow-up ticket #29387 (Complete solution for installing the generated *.pc files) to address this problem.\n\n\n\nCC:  @embray @mkoeppe @jhpalmieri @vbraun @kiwifb\n\nComponent: **build: configure**\n\nAuthor: **Matthias Koeppe**\n\nBranch/Commit: **[`329843b`](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)**\n\nReviewer: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29082_\n\n",
    "closed_at": "2020-03-29T00:24:26Z",
    "created_at": "2020-01-26T12:40:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Do not stage .pc files in src/lib/, clean old generated *.pc files at 'make distclean', fix 'permission denied' errors",
    "type": "issue",
    "updated_at": "2020-03-29T00:24:26Z",
    "url": "https://github.com/sagemath/sage/issues/29082",
    "user": "https://github.com/dimpase"
}
```
<div id="comment:0"></div>

#29003 introduced 2-stage installation of generated *.pc files, 
via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).
 
Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to overwrite read-only files:

```
  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/blas.pc
  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/cblas.pc
  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/lapack.pc
  [openblas-0.3.6.p0]   
  [openblas-0.3.6.p0]   real	8m40.259s
  [openblas-0.3.6.p0]   user	45m2.739s
  [openblas-0.3.6.p0]   sys	5m48.754s
  [openblas-0.3.6.p0]   Copying package files from temporary location /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local
  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/cblas.pc: Permission denied
  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/blas.pc: Permission denied
  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/lapack.pc: Permission denied
```

This ticket revises the installation as follows:

- `configure` no longer creates .pc files in the build tree
- Instead it creates rules in `make/Makefile` that create the .pc files in `SAGE_LOCAL`.
- Before pc files are installed into `SAGE_LOCAL`, the targets are removed, to avoid permission problems

This ticket does not solve everything. There may still be problems when switching from a system library to an spkg-provided library. We will use the follow-up ticket #29387 (Complete solution for installing the generated *.pc files) to address this problem.



CC:  @embray @mkoeppe @jhpalmieri @vbraun @kiwifb

Component: **build: configure**

Author: **Matthias Koeppe**

Branch/Commit: **[`329843b`](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)**

Reviewer: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/29082_





---

archive/issue_events_396635.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-26T12:40:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396635"
}
```



---

archive/issue_events_396636.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-26T12:40:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "0000b0",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396636"
}
```



---

archive/issue_events_396637.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-26T12:40:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396637"
}
```



---

archive/issue_events_396638.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-26T12:40:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396638"
}
```



---

archive/issue_events_396639.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-26T12:43:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396639"
}
```



---

archive/issue_comments_454995.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nMy suggestion would be to rewrite this as a script package instead of putting things into `src/`. This stuff really does not belong into `src/`.",
    "created_at": "2020-01-28T00:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-454995",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

My suggestion would be to rewrite this as a script package instead of putting things into `src/`. This stuff really does not belong into `src/`.



---

archive/issue_comments_454996.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAdded #29071 as a dependency as it touches the same files.",
    "created_at": "2020-01-28T01:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-454996",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Added #29071 as a dependency as it touches the same files.



---

archive/issue_comments_454997.json:
```json
{
    "body": "Dependencies: **#29071**",
    "created_at": "2020-01-28T01:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-454997",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29071**



---

archive/issue_events_396640.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-28T01:00:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "title_is": "Move .pc file from src/ to build/, clean generated *.pc files at 'make distclean'",
    "title_was": "clean generated *.pc files",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396640"
}
```



---

archive/issue_comments_454998.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,7 @@\n #29003 introduced 2-stage installation of generated *.pc files, \n via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).\n  \n-At least `make distclean` should clean them, possibly even `make clean`, not sure about this.\n+The generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.\n \n+Because `configure` (`config.status`) creates them, `make distclean` should clean them, but not `make clean`.\n+\n``````\n",
    "created_at": "2020-01-28T01:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-454998",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,7 @@
 #29003 introduced 2-stage installation of generated *.pc files, 
 via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).
  
-At least `make distclean` should clean them, possibly even `make clean`, not sure about this.
+The generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.
 
+Because `configure` (`config.status`) creates them, `make distclean` should clean them, but not `make clean`.
+
``````




---

archive/issue_events_396641.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-28T01:01:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396641"
}
```



---

archive/issue_events_396642.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-28T01:01:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396642"
}
```



---

archive/issue_comments_454999.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n(deleted a comment that was intended for #29071.)",
    "created_at": "2020-01-28T01:06:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-454999",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

(deleted a comment that was intended for #29071.)



---

archive/issue_comments_455000.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n(deleted a comment that was intended for #29071.)",
    "created_at": "2020-01-28T01:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455000",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

(deleted a comment that was intended for #29071.)



---

archive/issue_comments_455001.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@mkoeppe](#comment%3A2):\n> My suggestion would be to rewrite this as a script package instead of putting things into `src/`. This stuff really does not belong into `src/`.\n\nPerhaps we should just create `var/` next to `src/` and put these things there?",
    "created_at": "2020-01-28T09:03:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455001",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@mkoeppe](#comment%3A2):
> My suggestion would be to rewrite this as a script package instead of putting things into `src/`. This stuff really does not belong into `src/`.

Perhaps we should just create `var/` next to `src/` and put these things there?



---

archive/issue_comments_455002.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n  \n The generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.\n \n-Because `configure` (`config.status`) creates them, `make distclean` should clean them, but not `make clean`.\n+Because `configure` (`config.status`) creates them, `make distclean` should clean them, if not `make clean`.\n \n``````\n",
    "created_at": "2020-01-28T09:03:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455002",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
  
 The generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.
 
-Because `configure` (`config.status`) creates them, `make distclean` should clean them, but not `make clean`.
+Because `configure` (`config.status`) creates them, `make distclean` should clean them, if not `make clean`.
 
``````




---

archive/issue_comments_455003.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nNo, I don't think so. These are configure-generated files of sage-the-distribution - like `build/make/Makefile`. There's no need for a new top level.\n\nLet me take care of this ticket after #29071 is done.",
    "created_at": "2020-01-28T12:22:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455003",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

No, I don't think so. These are configure-generated files of sage-the-distribution - like `build/make/Makefile`. There's no need for a new top level.

Let me take care of this ticket after #29071 is done.



---

archive/issue_comments_455004.json:
```json
{
    "body": "Changed dependencies from **#29071** to **#29051, #29071, #29084**",
    "created_at": "2020-01-29T00:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455004",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29071** to **#29051, #29071, #29084**



---

archive/issue_comments_455005.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-01-29T02:02:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455005",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_455006.json:
```json
{
    "body": "Branch: **[u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_)**",
    "created_at": "2020-01-29T04:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455006",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_)**



---

archive/issue_comments_455007.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,9 @@\n #29003 introduced 2-stage installation of generated *.pc files, \n via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).\n  \n-The generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.\n+This ticket revises the 2-stage installation as follows:\n+- Because the generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.\n+- Because `configure` (`config.status`) creates them, `make distclean` cleans them.\n+- Special-purpose code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n+- `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.\n \n-Because `configure` (`config.status`) creates them, `make distclean` should clean them, if not `make clean`.\n-\n``````\n",
    "created_at": "2020-01-29T04:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455007",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,9 @@
 #29003 introduced 2-stage installation of generated *.pc files, 
 via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).
  
-The generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.
+This ticket revises the 2-stage installation as follows:
+- Because the generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.
+- Because `configure` (`config.status`) creates them, `make distclean` cleans them.
+- Special-purpose code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.
+- `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.
 
-Because `configure` (`config.status`) creates them, `make distclean` should clean them, if not `make clean`.
-
``````




---

archive/issue_comments_455008.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/683a926bb67d90832711ba64be1446dbe0463ea0\"><code>683a926</code></a></td><td><code>make installing *.pc files conditional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0acbcb1a199e5b9795dd126756288869e86e09a\"><code>a0acbcb</code></a></td><td><code>correct quoting of m4 index variable</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ee6844ebc67fa43f4a1d6a502e90ed8751b0889\"><code>5ee6844</code></a></td><td><code>ensure gfortran is available</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/56541ae443c5cffaf5d943694c37f3b4afb5bca2\"><code>56541ae</code></a></td><td><code>wrap AC_FC_FUNC so that it does not throw an error without Fortran</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d1770a3ae75526fab19cff91dba6aeba1e04d97\"><code>9d1770a</code></a></td><td><code>revert #29025, remove useless [ALL] section</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dba7aefc4d6678210c796aaea4edf17867be216d\"><code>dba7aef</code></a></td><td><code>revert from \"libraries=\" back to section-specific \"BLAH_libs=\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a4524e4c82840fb023a0fd2af83d0a1c65292cd\"><code>3a4524e</code></a></td><td><code>Merge remote-tracking branch 'trac/public/packages/numpy/no_DEFAULT_and_ALL_numpy_site_cfg' into openblaspcfix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06f46ebaa41a620016d8e04c8c27045acbcd3ae0\"><code>06f46eb</code></a></td><td><code>Add blas to fflas_ffpack linked libraries so that openblas is picked up on Arch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f16988d3545fb08f52ea3bd3362ae70f9c83b9b\"><code>5f16988</code></a></td><td><code>Merge branch 'u/arojas/make_fflas_ffpack_detect_and_use_system_openblas_on_arch' of git://trac.sagemath.org/sage into t/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a01db11ef106d00217d3176a794850524467bcd\"><code>2a01db1</code></a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr></table>\n",
    "created_at": "2020-01-29T04:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455008",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12"></div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/683a926bb67d90832711ba64be1446dbe0463ea0"><code>683a926</code></a></td><td><code>make installing *.pc files conditional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0acbcb1a199e5b9795dd126756288869e86e09a"><code>a0acbcb</code></a></td><td><code>correct quoting of m4 index variable</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ee6844ebc67fa43f4a1d6a502e90ed8751b0889"><code>5ee6844</code></a></td><td><code>ensure gfortran is available</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/56541ae443c5cffaf5d943694c37f3b4afb5bca2"><code>56541ae</code></a></td><td><code>wrap AC_FC_FUNC so that it does not throw an error without Fortran</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d1770a3ae75526fab19cff91dba6aeba1e04d97"><code>9d1770a</code></a></td><td><code>revert #29025, remove useless [ALL] section</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dba7aefc4d6678210c796aaea4edf17867be216d"><code>dba7aef</code></a></td><td><code>revert from "libraries=" back to section-specific "BLAH_libs="</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a4524e4c82840fb023a0fd2af83d0a1c65292cd"><code>3a4524e</code></a></td><td><code>Merge remote-tracking branch 'trac/public/packages/numpy/no_DEFAULT_and_ALL_numpy_site_cfg' into openblaspcfix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06f46ebaa41a620016d8e04c8c27045acbcd3ae0"><code>06f46eb</code></a></td><td><code>Add blas to fflas_ffpack linked libraries so that openblas is picked up on Arch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f16988d3545fb08f52ea3bd3362ae70f9c83b9b"><code>5f16988</code></a></td><td><code>Merge branch 'u/arojas/make_fflas_ffpack_detect_and_use_system_openblas_on_arch' of git://trac.sagemath.org/sage into t/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a01db11ef106d00217d3176a794850524467bcd"><code>2a01db1</code></a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr></table>




---

archive/issue_comments_455009.json:
```json
{
    "body": "Commit: **[`2a01db1`](https://github.com/sagemath/sagetrac-mirror/commit/2a01db11ef106d00217d3176a794850524467bcd)**",
    "created_at": "2020-01-29T04:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455009",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`2a01db1`](https://github.com/sagemath/sagetrac-mirror/commit/2a01db11ef106d00217d3176a794850524467bcd)**



---

archive/issue_comments_455010.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nBranch is on top of #29051, #29071, #29084.\nThis is a first version, haven't tested much yet.",
    "created_at": "2020-01-29T04:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455010",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Branch is on top of #29051, #29071, #29084.
This is a first version, haven't tested much yet.



---

archive/issue_comments_455011.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nTests run at https://github.com/mkoeppe/sage/actions/runs/32449719",
    "created_at": "2020-01-29T04:31:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455011",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Tests run at https://github.com/mkoeppe/sage/actions/runs/32449719



---

archive/issue_comments_455012.json:
```json
{
    "body": "Changed dependencies from **#29051, #29071, #29084** to **#29051, #29071, #29084, #26130, #29056**",
    "created_at": "2020-01-30T01:37:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455012",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29051, #29071, #29084** to **#29051, #29071, #29084, #26130, #29056**



---

archive/issue_events_396643.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-31T15:59:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396643"
}
```



---

archive/issue_events_396644.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-31T15:59:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396644"
}
```



---

archive/issue_comments_455013.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI will redo this on top of the hot fix - #29121.",
    "created_at": "2020-01-31T15:59:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455013",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

I will redo this on top of the hot fix - #29121.



---

archive/issue_comments_455014.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).\n  \n This ticket revises the 2-stage installation as follows:\n-- Because the generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.\n+- Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.\n - Because `configure` (`config.status`) creates them, `make distclean` cleans them.\n - Special-purpose code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n - `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.\n``````\n",
    "created_at": "2020-02-16T20:32:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455014",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).
  
 This ticket revises the 2-stage installation as follows:
-- Because the generated files are for sage-the-distribution, not sagelib, so they belong into `build`, not `src`.
+- Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.
 - Because `configure` (`config.status`) creates them, `make distclean` cleans them.
 - Special-purpose code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.
 - `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.
``````




---

archive/issue_comments_455015.json:
```json
{
    "body": "Changed commit from **[`2a01db1`](https://github.com/sagemath/sagetrac-mirror/commit/2a01db11ef106d00217d3176a794850524467bcd)** to **[`2535c18`](https://github.com/sagemath/sagetrac-mirror/commit/2535c186176468a691627bdc0cff84d8387782a8)**",
    "created_at": "2020-02-16T20:37:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455015",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2a01db1`](https://github.com/sagemath/sagetrac-mirror/commit/2a01db11ef106d00217d3176a794850524467bcd)** to **[`2535c18`](https://github.com/sagemath/sagetrac-mirror/commit/2535c186176468a691627bdc0cff84d8387782a8)**



---

archive/issue_comments_455016.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2535c186176468a691627bdc0cff84d8387782a8\"><code>2535c18</code></a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr></table>\n",
    "created_at": "2020-02-16T20:37:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455016",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2535c186176468a691627bdc0cff84d8387782a8"><code>2535c18</code></a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr></table>




---

archive/issue_comments_455017.json:
```json
{
    "body": "Changed dependencies from **#29051, #29071, #29084, #26130, #29056** to none",
    "created_at": "2020-02-16T20:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455017",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29051, #29071, #29084, #26130, #29056** to none



---

archive/issue_events_396645.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-16T20:38:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396645"
}
```



---

archive/issue_events_396646.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-16T20:38:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396646"
}
```



---

archive/issue_comments_455018.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nRebased on 9.1.beta4",
    "created_at": "2020-02-16T20:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455018",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Rebased on 9.1.beta4



---

archive/issue_comments_455019.json:
```json
{
    "body": "Changed commit from **[`2535c18`](https://github.com/sagemath/sagetrac-mirror/commit/2535c186176468a691627bdc0cff84d8387782a8)** to **[`3f2060e`](https://github.com/sagemath/sagetrac-mirror/commit/3f2060ebf71d3cd593efe44a751b1a8017af969b)**",
    "created_at": "2020-02-22T23:52:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455019",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2535c18`](https://github.com/sagemath/sagetrac-mirror/commit/2535c186176468a691627bdc0cff84d8387782a8)** to **[`3f2060e`](https://github.com/sagemath/sagetrac-mirror/commit/3f2060ebf71d3cd593efe44a751b1a8017af969b)**



---

archive/issue_comments_455020.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f2060ebf71d3cd593efe44a751b1a8017af969b\"><code>3f2060e</code></a></td><td><code>Merge tag '9.1.beta5' into t/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_</code></td></tr></table>\n",
    "created_at": "2020-02-22T23:52:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455020",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f2060ebf71d3cd593efe44a751b1a8017af969b"><code>3f2060e</code></a></td><td><code>Merge tag '9.1.beta5' into t/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_</code></td></tr></table>




---

archive/issue_comments_455021.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nNeeds review.",
    "created_at": "2020-02-22T23:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455021",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Needs review.



---

archive/issue_comments_455022.json:
```json
{
    "body": "Changed commit from **[`3f2060e`](https://github.com/sagemath/sagetrac-mirror/commit/3f2060ebf71d3cd593efe44a751b1a8017af969b)** to **[`d6b5677`](https://github.com/sagemath/sagetrac-mirror/commit/d6b5677f0a51dd790377482f4608fd041fb0fbbe)**",
    "created_at": "2020-03-02T01:51:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455022",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3f2060e`](https://github.com/sagemath/sagetrac-mirror/commit/3f2060ebf71d3cd593efe44a751b1a8017af969b)** to **[`d6b5677`](https://github.com/sagemath/sagetrac-mirror/commit/d6b5677f0a51dd790377482f4608fd041fb0fbbe)**



---

archive/issue_comments_455023.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d6b5677f0a51dd790377482f4608fd041fb0fbbe\"><code>d6b5677</code></a></td><td><code>Merge tag '9.1.beta6' into t/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_</code></td></tr></table>\n",
    "created_at": "2020-03-02T01:51:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455023",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d6b5677f0a51dd790377482f4608fd041fb0fbbe"><code>d6b5677</code></a></td><td><code>Merge tag '9.1.beta6' into t/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_</code></td></tr></table>




---

archive/issue_comments_455024.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAgreed on the first two points in the description.\n\nDon't agree on sage_system_blas_facade and the changes to Makefile.in.  I don't see how it's \"special-purpose code\".  It's a quite generic solution that you seem to be *replacing* with \"special-purpose code\" that's very specific to openblas.  This ticket was needed for more than just blas.",
    "created_at": "2020-03-06T14:40:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455024",
    "user": "https://github.com/embray"
}
```

<div id="comment:24" align="right">comment:24</div>

Agreed on the first two points in the description.

Don't agree on sage_system_blas_facade and the changes to Makefile.in.  I don't see how it's "special-purpose code".  It's a quite generic solution that you seem to be *replacing* with "special-purpose code" that's very specific to openblas.  This ticket was needed for more than just blas.



---

archive/issue_events_396647.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-03-06T14:42:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396647"
}
```



---

archive/issue_events_396648.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-03-06T14:42:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396648"
}
```



---

archive/issue_comments_455025.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n This ticket revises the 2-stage installation as follows:\n - Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.\n - Because `configure` (`config.status`) creates them, `make distclean` cleans them.\n-- Special-purpose code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n+- Code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n - `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.\n \n``````\n",
    "created_at": "2020-03-06T16:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455025",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 This ticket revises the 2-stage installation as follows:
 - Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.
 - Because `configure` (`config.status`) creates them, `make distclean` cleans them.
-- Special-purpose code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.
+- Code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.
 - `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.
 
``````




---

archive/issue_comments_455026.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nIs my ticket handling the `gsl.pc` correctly? Which packages use this file?",
    "created_at": "2020-03-07T03:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455026",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Is my ticket handling the `gsl.pc` correctly? Which packages use this file?



---

archive/issue_events_396649.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-14T01:10:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "title_is": "Move .pc file from src/ to build/, clean generated *.pc files at 'make distclean', fix 'permission denied' errors",
    "title_was": "Move .pc file from src/ to build/, clean generated *.pc files at 'make distclean'",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396649"
}
```



---

archive/issue_comments_455027.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,22 @@\n #29003 introduced 2-stage installation of generated *.pc files, \n via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).\n  \n+Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to override read-only files:\n+\n+```\n+  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/blas.pc\n+  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/cblas.pc\n+  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/lapack.pc\n+  [openblas-0.3.6.p0]   \n+  [openblas-0.3.6.p0]   real\t8m40.259s\n+  [openblas-0.3.6.p0]   user\t45m2.739s\n+  [openblas-0.3.6.p0]   sys\t5m48.754s\n+  [openblas-0.3.6.p0]   Copying package files from temporary location /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local\n+  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/cblas.pc: Permission denied\n+  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/blas.pc: Permission denied\n+  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/lapack.pc: Permission denied\n+```\n+\n This ticket revises the 2-stage installation as follows:\n - Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.\n - Because `configure` (`config.status`) creates them, `make distclean` cleans them.\n``````\n",
    "created_at": "2020-03-14T01:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455027",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,22 @@
 #29003 introduced 2-stage installation of generated *.pc files, 
 via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).
  
+Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to override read-only files:
+
+```
+  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/blas.pc
+  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/cblas.pc
+  [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/lapack.pc
+  [openblas-0.3.6.p0]   
+  [openblas-0.3.6.p0]   real	8m40.259s
+  [openblas-0.3.6.p0]   user	45m2.739s
+  [openblas-0.3.6.p0]   sys	5m48.754s
+  [openblas-0.3.6.p0]   Copying package files from temporary location /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst to /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local
+  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/cblas.pc: Permission denied
+  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/blas.pc: Permission denied
+  [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/lapack.pc: Permission denied
+```
+
 This ticket revises the 2-stage installation as follows:
 - Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.
 - Because `configure` (`config.status`) creates them, `make distclean` cleans them.
``````




---

archive/issue_comments_455028.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI also don't quite understand the need to create a special script package, instead of adjusting `build/make/Makefile.in`.\n\nIs there a technical problem?",
    "created_at": "2020-03-19T03:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455028",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

I also don't quite understand the need to create a special script package, instead of adjusting `build/make/Makefile.in`.

Is there a technical problem?



---

archive/issue_comments_455029.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nIt seemed to be an elegant solution when I wrote this a month ago",
    "created_at": "2020-03-19T03:49:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455029",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

It seemed to be an elegant solution when I wrote this a month ago



---

archive/issue_comments_455030.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nIt seems that your package handles more that blas/lapack pc files, no?\nPerhaps it just is wrongly named?",
    "created_at": "2020-03-19T03:58:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455030",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

It seems that your package handles more that blas/lapack pc files, no?
Perhaps it just is wrongly named?



---

archive/issue_comments_455031.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThat's basically my question regarding gsl.pc above, I guess.",
    "created_at": "2020-03-19T03:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455031",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

That's basically my question regarding gsl.pc above, I guess.



---

archive/issue_comments_455032.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nthere is also a bug: PKG_CONFIG_PATH is pointing to the wrong directory, so these\nnewly installed pc files are not found:\n\n```\n(sage-sh) dima@fedora:sagetrac-mirror$ echo $PKG_CONFIG_PATH\n/home/dima/sagetrac-mirror/local/lib/pkgconfig:.\n(sage-sh) dima@fedora:sagetrac-mirror$ find . -name cblas.pc\n./build/pkgs/sage_system_blas_facade/src/cblas.pc\n./src/lib/pkgconfig/cblas.pc\n```",
    "created_at": "2020-03-19T04:11:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455032",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:33" align="right">comment:33</div>

there is also a bug: PKG_CONFIG_PATH is pointing to the wrong directory, so these
newly installed pc files are not found:

```
(sage-sh) dima@fedora:sagetrac-mirror$ echo $PKG_CONFIG_PATH
/home/dima/sagetrac-mirror/local/lib/pkgconfig:.
(sage-sh) dima@fedora:sagetrac-mirror$ find . -name cblas.pc
./build/pkgs/sage_system_blas_facade/src/cblas.pc
./src/lib/pkgconfig/cblas.pc
```



---

archive/issue_comments_455033.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\noops, I mean, they are just not installed at all.\nPKG_CONFIG_PATH is correct, but pc files are not there, or anywhere, except the old location",
    "created_at": "2020-03-19T04:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455033",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

oops, I mean, they are just not installed at all.
PKG_CONFIG_PATH is correct, but pc files are not there, or anywhere, except the old location



---

archive/issue_comments_455034.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nFeel free to make changes -- otherwise I can look into it tomorrow",
    "created_at": "2020-03-19T04:29:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455034",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

Feel free to make changes -- otherwise I can look into it tomorrow



---

archive/issue_comments_455035.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nWhat does `build/pkgs/sage_system_blas_facade/spkg-install` look like on your machine?",
    "created_at": "2020-03-19T04:34:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455035",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

What does `build/pkgs/sage_system_blas_facade/spkg-install` look like on your machine?



---

archive/issue_comments_455036.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nhere it is:\n\n```\n#! /usr/bin/env bash\nPCFILES=\"blas.pccblas.pclapack.pc\"\nSAGE_PKGCONFIG=\"$SAGE_LOCAL/lib/pkgconfig\"\nmkdir -p \"$SAGE_PKGCONFIG\"\nif [ -n \"$PCFILES\" ]; then\n   cd build/pkgs/sage_system_blas_facade/src && cp -P $PCFILES \"$SAGE_PKGCONFIG\"\nfi\n```\nalso note that the original openblas.pc is in SAGE_ROOT",
    "created_at": "2020-03-19T04:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455036",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

here it is:

```
#! /usr/bin/env bash
PCFILES="blas.pccblas.pclapack.pc"
SAGE_PKGCONFIG="$SAGE_LOCAL/lib/pkgconfig"
mkdir -p "$SAGE_PKGCONFIG"
if [ -n "$PCFILES" ]; then
   cd build/pkgs/sage_system_blas_facade/src && cp -P $PCFILES "$SAGE_PKGCONFIG"
fi
```
also note that the original openblas.pc is in SAGE_ROOT



---

archive/issue_comments_455037.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nLooks like some spaces are missing",
    "created_at": "2020-03-19T04:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455037",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

Looks like some spaces are missing



---

archive/issue_comments_455038.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nindeed, one needs\n\n```diff\n--- a/build/pkgs/openblas/spkg-configure.m4\n+++ b/build/pkgs/openblas/spkg-configure.m4\n@@ -37,7 +37,7 @@ SAGE_SPKG_CONFIGURE([openblas], [dnl CHECK\n        m4_foreach([blaslibnam], [blas, cblas, lapack], [\n         AS_IF([test x$sage_install_]blaslibnam[_pc = xyes], [\n          AC_CONFIG_LINKS([build/pkgs/sage_system_blas_facade/src/]blaslibnam[.pc:$OPENBLASPCDIR/openblas.pc])\n-         AS_VAR_APPEND([SAGE_SYSTEM_BLAS_FACADE_PC_FILES], blaslibnam[.pc])])\n+         AS_VAR_APPEND([SAGE_SYSTEM_BLAS_FACADE_PC_FILES], [blaslibnam[.pc]' '])])\n          AC_SUBST([SAGE_BLAS], [sage_system_blas_facade])\n        ])\n     ])\n```",
    "created_at": "2020-03-19T06:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455038",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:39" align="right">comment:39</div>

indeed, one needs

```diff
--- a/build/pkgs/openblas/spkg-configure.m4
+++ b/build/pkgs/openblas/spkg-configure.m4
@@ -37,7 +37,7 @@ SAGE_SPKG_CONFIGURE([openblas], [dnl CHECK
        m4_foreach([blaslibnam], [blas, cblas, lapack], [
         AS_IF([test x$sage_install_]blaslibnam[_pc = xyes], [
          AC_CONFIG_LINKS([build/pkgs/sage_system_blas_facade/src/]blaslibnam[.pc:$OPENBLASPCDIR/openblas.pc])
-         AS_VAR_APPEND([SAGE_SYSTEM_BLAS_FACADE_PC_FILES], blaslibnam[.pc])])
+         AS_VAR_APPEND([SAGE_SYSTEM_BLAS_FACADE_PC_FILES], [blaslibnam[.pc]' '])])
          AC_SUBST([SAGE_BLAS], [sage_system_blas_facade])
        ])
     ])
```



---

archive/issue_comments_455039.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nbut this does not make any difference. As far as I can see, `spkg-install` of `sage_system_blas_facade` never gets run - I'm lost in untangling the reason for this.",
    "created_at": "2020-03-19T13:39:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455039",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

but this does not make any difference. As far as I can see, `spkg-install` of `sage_system_blas_facade` never gets run - I'm lost in untangling the reason for this.



---

archive/issue_comments_455040.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nOK, I'll take care of it later today.",
    "created_at": "2020-03-19T13:44:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455040",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

OK, I'll take care of it later today.



---

archive/issue_events_396650.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-19T15:11:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396650"
}
```



---

archive/issue_events_396651.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-19T15:11:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396651"
}
```



---

archive/issue_comments_455041.json:
```json
{
    "body": "Dependencies: **#29287**",
    "created_at": "2020-03-20T22:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455041",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29287**



---

archive/issue_comments_455042.json:
```json
{
    "body": "<div id=\"comment:44\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d1fd7a73c077f122847b27ef779bde44f9efc430\"><code>d1fd7a7</code></a></td><td><code>src/bin/sage-list-packages: Remove use of type=pip</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75175db466a0ef461b656fdb1b7b40e7479981f7\"><code>75175db</code></a></td><td><code>sage.misc.package.list_packages: For unversioned packages, use 'none' as version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3d78f47429f6d033abdfa47e32453d980f995e5\"><code>d3d78f4</code></a></td><td><code>m4/sage_spkg_collect.m4: Fix up collection of dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbb9860cb41006fbe4108447f4f01e26ed8f0bdd\"><code>dbb9860</code></a></td><td><code>build/pkgs/texlive/spkg-install: Fix up path</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b1d5ca6074561315be14ea4f072149b88fe2fd0\"><code>8b1d5ca</code></a></td><td><code>trac 29287: rewording documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/057a66bdd05ad75539f2bdbd27561af3f0d57d65\"><code>057a66b</code></a></td><td><code>Make pyopenssl a pip package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f6323ed8af19d0c1301c65e41d3b219a8fa7a43\"><code>8f6323e</code></a></td><td><code>src/sage/env.py: Fix up doctest on starting sage without SAGE_* variables</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/091908665ae681b6f9cc1f491d4801acbdfb89ae\"><code>0919086</code></a></td><td><code>trac 29287: doc fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67817908a4b8956b7a78d15295d1af3c0865bb82\"><code>6781790</code></a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86\"><code>30d3b82</code></a></td><td><code>build/pkgs/openblas/spkg-configure.m4: Separate library names by spaces</code></td></tr></table>\n",
    "created_at": "2020-03-20T22:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455042",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d1fd7a73c077f122847b27ef779bde44f9efc430"><code>d1fd7a7</code></a></td><td><code>src/bin/sage-list-packages: Remove use of type=pip</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75175db466a0ef461b656fdb1b7b40e7479981f7"><code>75175db</code></a></td><td><code>sage.misc.package.list_packages: For unversioned packages, use 'none' as version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3d78f47429f6d033abdfa47e32453d980f995e5"><code>d3d78f4</code></a></td><td><code>m4/sage_spkg_collect.m4: Fix up collection of dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbb9860cb41006fbe4108447f4f01e26ed8f0bdd"><code>dbb9860</code></a></td><td><code>build/pkgs/texlive/spkg-install: Fix up path</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b1d5ca6074561315be14ea4f072149b88fe2fd0"><code>8b1d5ca</code></a></td><td><code>trac 29287: rewording documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/057a66bdd05ad75539f2bdbd27561af3f0d57d65"><code>057a66b</code></a></td><td><code>Make pyopenssl a pip package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f6323ed8af19d0c1301c65e41d3b219a8fa7a43"><code>8f6323e</code></a></td><td><code>src/sage/env.py: Fix up doctest on starting sage without SAGE_* variables</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/091908665ae681b6f9cc1f491d4801acbdfb89ae"><code>0919086</code></a></td><td><code>trac 29287: doc fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67817908a4b8956b7a78d15295d1af3c0865bb82"><code>6781790</code></a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86"><code>30d3b82</code></a></td><td><code>build/pkgs/openblas/spkg-configure.m4: Separate library names by spaces</code></td></tr></table>




---

archive/issue_comments_455043.json:
```json
{
    "body": "Changed commit from **[`d6b5677`](https://github.com/sagemath/sagetrac-mirror/commit/d6b5677f0a51dd790377482f4608fd041fb0fbbe)** to **[`30d3b82`](https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86)**",
    "created_at": "2020-03-20T22:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455043",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d6b5677`](https://github.com/sagemath/sagetrac-mirror/commit/d6b5677f0a51dd790377482f4608fd041fb0fbbe)** to **[`30d3b82`](https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86)**



---

archive/issue_comments_455044.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nBranch is on top of #29287",
    "created_at": "2020-03-20T22:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455044",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

Branch is on top of #29287



---

archive/issue_comments_455045.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b68595e74582eacd050b93312610f0ece11d2a93\"><code>b68595e</code></a></td><td><code>Change type</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f\"><code>7fd5e31</code></a></td><td><code>fixup</code></td></tr></table>\n",
    "created_at": "2020-03-21T02:05:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455045",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b68595e74582eacd050b93312610f0ece11d2a93"><code>b68595e</code></a></td><td><code>Change type</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f"><code>7fd5e31</code></a></td><td><code>fixup</code></td></tr></table>




---

archive/issue_comments_455046.json:
```json
{
    "body": "Changed commit from **[`30d3b82`](https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86)** to **[`7fd5e31`](https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f)**",
    "created_at": "2020-03-21T02:05:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455046",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`30d3b82`](https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86)** to **[`7fd5e31`](https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f)**



---

archive/issue_comments_455047.json:
```json
{
    "body": "Changed commit from **[`7fd5e31`](https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f)** to **[`b493a32`](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)**",
    "created_at": "2020-03-21T02:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455047",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7fd5e31`](https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f)** to **[`b493a32`](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)**



---

archive/issue_comments_455048.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676\"><code>b493a32</code></a></td><td><code>install sage_system_blas_facade</code></td></tr></table>\n",
    "created_at": "2020-03-21T02:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455048",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676"><code>b493a32</code></a></td><td><code>install sage_system_blas_facade</code></td></tr></table>




---

archive/issue_events_396652.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-21T08:13:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396652"
}
```



---

archive/issue_events_396653.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-21T08:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396653"
}
```



---

archive/issue_comments_455049.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nthis prevents building on Fedora after distclean",
    "created_at": "2020-03-21T08:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455049",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:48" align="right">comment:48</div>

this prevents building on Fedora after distclean



---

archive/issue_comments_455050.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nI'm working on a simpler version of this ticket.",
    "created_at": "2020-03-21T12:36:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455050",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">comment:49</div>

I'm working on a simpler version of this ticket.



---

archive/issue_comments_455051.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n #29003 introduced 2-stage installation of generated *.pc files, \n via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).\n  \n-Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to override read-only files:\n+Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to overwrite read-only files:\n \n ```\n   [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/blas.pc\n@@ -20,6 +20,7 @@\n This ticket revises the 2-stage installation as follows:\n - Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.\n - Because `configure` (`config.status`) creates them, `make distclean` cleans them.\n+- The pc files installed into `SAGE_LOCAL` are uninstalled when necessary - or it is ensured that they are properly overwritten.\n - Code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n - `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.\n \n``````\n",
    "created_at": "2020-03-21T12:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455051",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 #29003 introduced 2-stage installation of generated *.pc files, 
 via `src/lib/pkgconfig`- but did not provide a way to clean them up at all. And this is a problem (cf. e.g. #29071).
  
-Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to override read-only files:
+Also, in some installations, repeated installations this code leads to 'permission denied' errors when trying to overwrite read-only files:
 
 ```
   [openblas-0.3.6.p0]   Wrote /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/var/tmp/sage/build/openblas-0.3.6.p0/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/lib/pkgconfig/blas.pc
@@ -20,6 +20,7 @@
 This ticket revises the 2-stage installation as follows:
 - Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.
 - Because `configure` (`config.status`) creates them, `make distclean` cleans them.
+- The pc files installed into `SAGE_LOCAL` are uninstalled when necessary - or it is ensured that they are properly overwritten.
 - Code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.
 - `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.
 
``````




---

archive/issue_comments_455052.json:
```json
{
    "body": "Changed dependencies from **#29287** to none",
    "created_at": "2020-03-21T15:52:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455052",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29287** to none



---

archive/issue_comments_455053.json:
```json
{
    "body": "Changed commit from **[`b493a32`](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)** to **[`705da6a`](https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371)**",
    "created_at": "2020-03-21T18:30:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455053",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b493a32`](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)** to **[`705da6a`](https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371)**



---

archive/issue_comments_455054.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371\"><code>705da6a</code></a></td><td><code>Link/generate pc files in make, not configure</code></td></tr></table>\n",
    "created_at": "2020-03-21T18:30:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455054",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371"><code>705da6a</code></a></td><td><code>Link/generate pc files in make, not configure</code></td></tr></table>




---

archive/issue_events_396654.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-21T18:31:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396654"
}
```



---

archive/issue_events_396655.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-21T18:31:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396655"
}
```



---

archive/issue_comments_455055.json:
```json
{
    "body": "Changed commit from **[`705da6a`](https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371)** to **[`d86cd33`](https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2)**",
    "created_at": "2020-03-21T18:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455055",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`705da6a`](https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371)** to **[`d86cd33`](https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2)**



---

archive/issue_comments_455056.json:
```json
{
    "body": "<div id=\"comment:54\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2\"><code>d86cd33</code></a></td><td><code>fixup</code></td></tr></table>\n",
    "created_at": "2020-03-21T18:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455056",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:54"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2"><code>d86cd33</code></a></td><td><code>fixup</code></td></tr></table>




---

archive/issue_comments_455057.json:
```json
{
    "body": "<div id=\"comment:55\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03\"><code>f5b4f62</code></a></td><td><code>Makefile [misc-clean]: No need to remove build/lib/pkgconfig</code></td></tr></table>\n",
    "created_at": "2020-03-21T19:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455057",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:55"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03"><code>f5b4f62</code></a></td><td><code>Makefile [misc-clean]: No need to remove build/lib/pkgconfig</code></td></tr></table>




---

archive/issue_comments_455058.json:
```json
{
    "body": "Changed commit from **[`d86cd33`](https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2)** to **[`f5b4f62`](https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03)**",
    "created_at": "2020-03-21T19:33:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455058",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d86cd33`](https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2)** to **[`f5b4f62`](https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03)**



---

archive/issue_events_396656.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-22T02:13:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396656"
}
```



---

archive/issue_events_396657.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-22T02:13:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396657"
}
```



---

archive/issue_comments_455059.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nError with gsl.pc for `local-homebrew-macos-standard` - https://github.com/mkoeppe/sage/runs/524361197",
    "created_at": "2020-03-22T02:13:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455059",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:56" align="right">comment:56</div>

Error with gsl.pc for `local-homebrew-macos-standard` - https://github.com/mkoeppe/sage/runs/524361197



---

archive/issue_comments_455060.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nalso `ubuntu-bionic-standard` (sagelib and cvxopt)",
    "created_at": "2020-03-22T02:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455060",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:57" align="right">comment:57</div>

also `ubuntu-bionic-standard` (sagelib and cvxopt)



---

archive/issue_comments_455061.json:
```json
{
    "body": "<div id=\"comment:58\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a\"><code>2a38a16</code></a></td><td><code>build/pkgs/gsl/spkg-configure.m4: Quoting fix</code></td></tr></table>\n",
    "created_at": "2020-03-22T02:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455061",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:58"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a"><code>2a38a16</code></a></td><td><code>build/pkgs/gsl/spkg-configure.m4: Quoting fix</code></td></tr></table>




---

archive/issue_comments_455062.json:
```json
{
    "body": "Changed commit from **[`f5b4f62`](https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03)** to **[`2a38a16`](https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a)**",
    "created_at": "2020-03-22T02:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455062",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f5b4f62`](https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03)** to **[`2a38a16`](https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a)**



---

archive/issue_events_396658.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-22T02:59:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396658"
}
```



---

archive/issue_events_396659.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-22T02:59:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396659"
}
```



---

archive/issue_comments_455063.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nTests run at https://github.com/mkoeppe/sage/actions/runs/60588138",
    "created_at": "2020-03-22T02:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455063",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

Tests run at https://github.com/mkoeppe/sage/actions/runs/60588138



---

archive/issue_comments_455064.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,10 +17,12 @@\n   [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/lapack.pc: Permission denied\n ```\n \n-This ticket revises the 2-stage installation as follows:\n-- Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.\n-- Because `configure` (`config.status`) creates them, `make distclean` cleans them.\n-- The pc files installed into `SAGE_LOCAL` are uninstalled when necessary - or it is ensured that they are properly overwritten.\n-- Code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n-- `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.\n+This ticket revises the installation as follows:\n \n+- `configure` no longer creates .pc files in the build tree\n+- Instead it creates rules in `make/Makefile` that create the .pc files in `SAGE_LOCAL`.\n+- Before pc files are installed into `SAGE_LOCAL`, the targets are removed, to avoid permission problems\n+\n+This ticket does not solve everything. There may still be problems when switching from a system library to an spkg-provided library. We will use the follow-up ticket #29387 (Complete solution for installing the generated *.pc files) to address this problem.\n+\n+\n``````\n",
    "created_at": "2020-03-22T03:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455064",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,10 +17,12 @@
   [openblas-0.3.6.p0]   cp: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/local-homebrew-minimal/local/./lib/pkgconfig/lapack.pc: Permission denied
 ```
 
-This ticket revises the 2-stage installation as follows:
-- Because the generated files are for sage-the-distribution, not sagelib, they belong into `build`, not `src`.
-- Because `configure` (`config.status`) creates them, `make distclean` cleans them.
-- The pc files installed into `SAGE_LOCAL` are uninstalled when necessary - or it is ensured that they are properly overwritten.
-- Code in `build/make/Makefile.in` is removed in favor of creating a new type=script package `sage_system_blas_facade`, whose `spkg-install` does the installation to `SAGE_LOCAL`.
-- `openblas/spkg-configure.m4` sets `SAGE_BLAS=sage_system_blas_facade` if PC files are generated.
+This ticket revises the installation as follows:
 
+- `configure` no longer creates .pc files in the build tree
+- Instead it creates rules in `make/Makefile` that create the .pc files in `SAGE_LOCAL`.
+- Before pc files are installed into `SAGE_LOCAL`, the targets are removed, to avoid permission problems
+
+This ticket does not solve everything. There may still be problems when switching from a system library to an spkg-provided library. We will use the follow-up ticket #29387 (Complete solution for installing the generated *.pc files) to address this problem.
+
+
``````




---

archive/issue_comments_455065.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-03-22T09:10:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455065",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_455066.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nOK, this does the needed job. Perhaps the make rules could be made less explicit, but OK.",
    "created_at": "2020-03-22T09:10:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455066",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:62" align="right">comment:62</div>

OK, this does the needed job. Perhaps the make rules could be made less explicit, but OK.



---

archive/issue_events_396660.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-22T09:10:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396660"
}
```



---

archive/issue_events_396661.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-22T09:10:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396661"
}
```



---

archive/issue_comments_455067.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThanks!",
    "created_at": "2020-03-22T09:27:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455067",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:63" align="right">comment:63</div>

Thanks!



---

archive/issue_events_396662.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-22T14:22:03Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "title_is": "Do not stage .pc files in src/lib/, clean old generated *.pc files at 'make distclean', fix 'permission denied' errors",
    "title_was": "Move .pc file from src/ to build/, clean generated *.pc files at 'make distclean', fix 'permission denied' errors",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396662"
}
```



---

archive/issue_comments_455068.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nMake distclean deletes `src/lib/pkgconfig/.gitignore`",
    "created_at": "2020-03-23T23:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455068",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:65" align="right">comment:65</div>

Make distclean deletes `src/lib/pkgconfig/.gitignore`



---

archive/issue_events_396663.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-23T23:22:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396663"
}
```



---

archive/issue_events_396664.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-23T23:22:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396664"
}
```



---

archive/issue_comments_455069.json:
```json
{
    "body": "<div id=\"comment:66\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0\"><code>329843b</code></a></td><td><code>Ignore /src/lib/pkgconfig using top-level .gitignore</code></td></tr></table>\n",
    "created_at": "2020-03-23T23:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455069",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:66"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0"><code>329843b</code></a></td><td><code>Ignore /src/lib/pkgconfig using top-level .gitignore</code></td></tr></table>




---

archive/issue_comments_455070.json:
```json
{
    "body": "Changed commit from **[`2a38a16`](https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a)** to **[`329843b`](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)**",
    "created_at": "2020-03-23T23:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455070",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2a38a16`](https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a)** to **[`329843b`](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)**



---

archive/issue_events_396665.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-23T23:27:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396665"
}
```



---

archive/issue_events_396666.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-23T23:27:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396666"
}
```



---

archive/issue_events_396667.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-24T03:32:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396667"
}
```



---

archive/issue_events_396668.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-03-24T03:32:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396668"
}
```



---

archive/issue_comments_455071.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nok. sorry for overlooking this.",
    "created_at": "2020-03-24T03:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455071",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">comment:68</div>

ok. sorry for overlooking this.



---

archive/issue_comments_455072.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nThanks",
    "created_at": "2020-03-24T03:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455072",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:69" align="right">comment:69</div>

Thanks



---

archive/issue_events_396669.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-29T00:24:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396669"
}
```



---

archive/issue_events_396670.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d7db290643f3daa9be08354dcccd2ea52ca797b0",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-03-29T00:24:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29082#event-396670"
}
```



---

archive/issue_comments_455073.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_)** to **[`329843b`](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)**",
    "created_at": "2020-03-29T00:24:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29082#issuecomment-455073",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_)** to **[`329843b`](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)**
