# Issue 29043: Doctest integrating (I*a*tan(d*x + c) + a)*sec(d*x + c)^10 via FriCAS

archive/issues_028806.json:
```json
{
    "body": "Assignee: @nasser1\n\nCC:  @mantepse\n\nKeywords: integrate symbolic, FriCAS\n\nUsing [SageMath](SageMath) 8.9  with FriCAS 1.3.5, in one test file\nI have, I see many integrals fail with same error\n\n```\nsage: integrate((I*a*tan(d*x + c) + a)*sec(d*x + c)^10,x, algorithm=\"fricas\")\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-7-586bc09b0cfc> in <module>()\n----> 1 integrate((I*a*tan(d*x + c) + a)*sec(d*x + c)**Integer(10),x, algorithm=\"fricas\")\n\n/usr/lib/python2.7/site-packages/sage/misc/functional.pyc in integral(x, *args, **kwds)\n    751     \"\"\"\n    752     if hasattr(x, 'integral'):\n--> 753         return x.integral(*args, **kwds)\n    754     else:\n    755         from sage.symbolic.ring import SR\n\n/usr/lib/python2.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.integral (build/cythonized/sage/symbolic/expression.cpp:64032)()\n  12360                     R = ring.SR\n  12361             return R(integral(f, v, a, b, **kwds))\n> 12362         return integral(self, *args, **kwds)\n  12363 \n  12364     integrate = integral\n\n/usr/lib/python2.7/site-packages/sage/symbolic/integration/integral.pyc in integrate(expression, v, a, b, algorithm, hold)\n    910         if not integrator:\n    911             raise ValueError(\"Unknown algorithm: %s\" % algorithm)\n--> 912         return integrator(expression, v, a, b)\n    913     if a is None:\n    914         return indefinite_integral(expression, v, hold=hold)\n\n/usr/lib/python2.7/site-packages/sage/symbolic/integration/external.pyc in fricas_integrator(expression, v, a, b, noPole)\n    393             result = ex.integrate(seg)\n    394 \n--> 395     result = result.sage()\n    396 \n    397     if result == \"failed\":\n\n/usr/lib/python2.7/site-packages/sage/interfaces/interface.pyc in sage(self, *args, **kwds)\n   1079             [0 0]\n   1080         \"\"\"\n-> 1081         return self._sage_(*args, **kwds)\n   1082 \n   1083     def __repr__(self):\n\n/usr/lib/python2.7/site-packages/sage/interfaces/fricas.pyc in _sage_(self)\n   1909             return R(unparsed_InputForm)\n   1910 \n-> 1911         raise NotImplementedError(\"the translation of the FriCAS object %s to sage is not yet implemented\" % (unparsed_InputForm))\n   1912 \n   1913 \n\nNotImplementedError: the translation of the FriCAS object sage2 to sage is not yet implemented\n```\n\nHere are more examples:\n\n```\nintegrate((I*a*tan(d*x + c) + a)*sec(d*x + c)^10, x, algorithm=\"fricas\")\n\nintegrate((I*a*tan(d*x + c) + a)*sec(d*x + c)^8, x, algorithm=\"fricas\")\n```\n\nThere are 10's or 100's of similar integrals,\nall fail with same error. But they work in FriCAS:\n\n```\n(6) -> ii:=integrate(cos(d*x+c)/(a+I*a*tan(d*x+c))^2,x);  \n\n                                         Type: Union(Expression(Integer),...)\n(7) -> unparse(ii::InputForm)                             \n\n   (7)\n  \"((3*I^3*sin(d*x+c)+3*I^2*cos(d*x+c))*log((((-2)*I*cos(d*x+c)*sin(d*x+c)+((I^\n  2+(-1))*cos(d*x+c)^2+(I^2+2)))*(I^2+1)^(1/2)+((2*I^2+2)*sin(d*x+c)+((-2)*I^3+\n  (-2)*I)*cos(d*x+c)))/(2*I*cos(d*x+c)*sin(d*x+c)+(((-1)*I^2+1)*cos(d*x+c)^2+I^\n  2)))+((2*I^2+2)*cos(d*x+c)*sin(d*x+c)+((2*I^3+2*I)*cos(d*x+c)^2+((-4)*I^3+2*I\n  )))*(I^2+1)^(1/2))/(((2*I^5+4*I^3+2*I)*a^2*d*sin(d*x+c)+(2*I^4+4*I^2+2)*a^2*d\n  *cos(d*x+c))*(I^2+1)^(1/2))\"\n```\n\nMore such examples at\n[this integrals page](https://www.12000.org/my_notes/CAS_integration_tests/reports/rubi_4_16_1/test_cases/4_Trig_functions/4.3_Tangent/4.3.1.2-d_sec-%5em-a+b_tan-%5en/rese2.htm#x3-130002).\n\nLooking at the table above, under FriCAS, each entry\nwhich says F(-2), means it failed due to this error.\n\nThis ended up coming from a bug in FriCAS\nrather than in translating results from FriCAS.\n\nFixed in FriCAS 1.3.6, to which we upgraded in #27309.\nThis ticket adds a doctest.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29043\n\n",
    "closed_at": "2021-07-08T16:57:54Z",
    "created_at": "2020-01-19T08:45:25Z",
    "labels": [
        "component: interfaces",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Doctest integrating (I*a*tan(d*x + c) + a)*sec(d*x + c)^10 via FriCAS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29043",
    "user": "https://github.com/nasser1"
}
```
Assignee: @nasser1

CC:  @mantepse

Keywords: integrate symbolic, FriCAS

Using [SageMath](SageMath) 8.9  with FriCAS 1.3.5, in one test file
I have, I see many integrals fail with same error

```
sage: integrate((I*a*tan(d*x + c) + a)*sec(d*x + c)^10,x, algorithm="fricas")
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-7-586bc09b0cfc> in <module>()
----> 1 integrate((I*a*tan(d*x + c) + a)*sec(d*x + c)**Integer(10),x, algorithm="fricas")

/usr/lib/python2.7/site-packages/sage/misc/functional.pyc in integral(x, *args, **kwds)
    751     """
    752     if hasattr(x, 'integral'):
--> 753         return x.integral(*args, **kwds)
    754     else:
    755         from sage.symbolic.ring import SR

/usr/lib/python2.7/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.integral (build/cythonized/sage/symbolic/expression.cpp:64032)()
  12360                     R = ring.SR
  12361             return R(integral(f, v, a, b, **kwds))
> 12362         return integral(self, *args, **kwds)
  12363 
  12364     integrate = integral

/usr/lib/python2.7/site-packages/sage/symbolic/integration/integral.pyc in integrate(expression, v, a, b, algorithm, hold)
    910         if not integrator:
    911             raise ValueError("Unknown algorithm: %s" % algorithm)
--> 912         return integrator(expression, v, a, b)
    913     if a is None:
    914         return indefinite_integral(expression, v, hold=hold)

/usr/lib/python2.7/site-packages/sage/symbolic/integration/external.pyc in fricas_integrator(expression, v, a, b, noPole)
    393             result = ex.integrate(seg)
    394 
--> 395     result = result.sage()
    396 
    397     if result == "failed":

/usr/lib/python2.7/site-packages/sage/interfaces/interface.pyc in sage(self, *args, **kwds)
   1079             [0 0]
   1080         """
-> 1081         return self._sage_(*args, **kwds)
   1082 
   1083     def __repr__(self):

/usr/lib/python2.7/site-packages/sage/interfaces/fricas.pyc in _sage_(self)
   1909             return R(unparsed_InputForm)
   1910 
-> 1911         raise NotImplementedError("the translation of the FriCAS object %s to sage is not yet implemented" % (unparsed_InputForm))
   1912 
   1913 

NotImplementedError: the translation of the FriCAS object sage2 to sage is not yet implemented
```

Here are more examples:

```
integrate((I*a*tan(d*x + c) + a)*sec(d*x + c)^10, x, algorithm="fricas")

integrate((I*a*tan(d*x + c) + a)*sec(d*x + c)^8, x, algorithm="fricas")
```

There are 10's or 100's of similar integrals,
all fail with same error. But they work in FriCAS:

```
(6) -> ii:=integrate(cos(d*x+c)/(a+I*a*tan(d*x+c))^2,x);  

                                         Type: Union(Expression(Integer),...)
(7) -> unparse(ii::InputForm)                             

   (7)
  "((3*I^3*sin(d*x+c)+3*I^2*cos(d*x+c))*log((((-2)*I*cos(d*x+c)*sin(d*x+c)+((I^
  2+(-1))*cos(d*x+c)^2+(I^2+2)))*(I^2+1)^(1/2)+((2*I^2+2)*sin(d*x+c)+((-2)*I^3+
  (-2)*I)*cos(d*x+c)))/(2*I*cos(d*x+c)*sin(d*x+c)+(((-1)*I^2+1)*cos(d*x+c)^2+I^
  2)))+((2*I^2+2)*cos(d*x+c)*sin(d*x+c)+((2*I^3+2*I)*cos(d*x+c)^2+((-4)*I^3+2*I
  )))*(I^2+1)^(1/2))/(((2*I^5+4*I^3+2*I)*a^2*d*sin(d*x+c)+(2*I^4+4*I^2+2)*a^2*d
  *cos(d*x+c))*(I^2+1)^(1/2))"
```

More such examples at
[this integrals page](https://www.12000.org/my_notes/CAS_integration_tests/reports/rubi_4_16_1/test_cases/4_Trig_functions/4.3_Tangent/4.3.1.2-d_sec-%5em-a+b_tan-%5en/rese2.htm#x3-130002).

Looking at the table above, under FriCAS, each entry
which says F(-2), means it failed due to this error.

This ended up coming from a bug in FriCAS
rather than in translating results from FriCAS.

Fixed in FriCAS 1.3.6, to which we upgraded in #27309.
This ticket adds a doctest.

Issue created by migration from https://trac.sagemath.org/ticket/29043





---

archive/issue_comments_406813.json:
```json
{
    "body": "Please always use the \"FriCAS\" keyword for tickets on this topic, otherwise I might not see it.",
    "created_at": "2020-01-19T21:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406813",
    "user": "https://github.com/mantepse"
}
```

Please always use the "FriCAS" keyword for tickets on this topic, otherwise I might not see it.



---

archive/issue_comments_406814.json:
```json
{
    "body": "Changing keywords from \"integrate symbolic\" to \"integrate symbolic, FriCAS\".",
    "created_at": "2020-01-19T21:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406814",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "integrate symbolic" to "integrate symbolic, FriCAS".



---

archive/issue_comments_406815.json:
```json
{
    "body": "Set assignee to @nasser1.",
    "created_at": "2020-01-21T04:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406815",
    "user": "https://github.com/nasser1"
}
```

Set assignee to @nasser1.



---

archive/issue_comments_406816.json:
```json
{
    "body": "this was a bug in Fricas. not sagemath need to close",
    "created_at": "2020-01-21T04:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406816",
    "user": "https://github.com/nasser1"
}
```

this was a bug in Fricas. not sagemath need to close



---

archive/issue_comments_406817.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-21T06:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406817",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_406818.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-21T06:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406818",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_406819.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-01-26T07:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406819",
    "user": "https://github.com/fchapoton"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_406820.json:
```json
{
    "body": "this would need a doctest, once in a stable release",
    "created_at": "2020-01-26T07:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406820",
    "user": "https://github.com/fchapoton"
}
```

this would need a doctest, once in a stable release



---

archive/issue_events_073611.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73611"
}
```



---

archive/issue_comments_406821.json:
```json
{
    "body": "Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406821",
    "user": "https://github.com/mkoeppe"
}
```

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_events_073612.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73612"
}
```



---

archive/issue_events_073613.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73613"
}
```



---

archive/issue_comments_406822.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406822",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_073614.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73614"
}
```



---

archive/issue_events_073615.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73615"
}
```



---

archive/issue_comments_406823.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-06-01T12:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406823",
    "user": "https://github.com/mantepse"
}
```

New commits:



---

archive/issue_comments_406824.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-01T12:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406824",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_406825.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-01T12:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406825",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_406826.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-06-23T12:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406826",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_406827.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-06-23T12:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406827",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_406828.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-23T14:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406828",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_073616.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2021-07-08T09:55:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73616"
}
```



---

archive/issue_events_073617.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2021-07-08T09:55:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73617"
}
```



---

archive/issue_comments_406829.json:
```json
{
    "body": "The doctest is added by #28630.",
    "created_at": "2021-07-08T09:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406829",
    "user": "https://github.com/mantepse"
}
```

The doctest is added by #28630.



---

archive/issue_comments_406830.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-08T09:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406830",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_406831.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2021-07-08T16:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29043#issuecomment-406831",
    "user": "https://github.com/fchapoton"
}
```

Resolution: duplicate



---

archive/issue_events_073618.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-07-08T16:57:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29043",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29043#event-73618"
}
```
