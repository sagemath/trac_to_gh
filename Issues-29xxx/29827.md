# Issue 29827: Upgrade gcc to 9.3

archive/issues_029590.json:
```json
{
    "body": "We upgrade gcc from 9.2 to 9.3\n\nhttps://gcc.gnu.org/bugzilla/buglist.cgi?bug_status=RESOLVED&resolution=FIXED&target_milestone=9.3\n\npart of #29703\n\ntarball: see checksums.ini [upstream_url]\n\nPrevious update:\n- #28691 (gcc 9.2)\n- #29674 (patches)\n\n\n\nCC:  @jhpalmieri @zlscherr\n\nBranch: u/mkoeppe/upgrade_gcc_to_9_3\n\nCommit: d07ba7bb91dcae08ca35e1f2f9ff710945169495\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/29827\n\n",
    "closed_at": "2021-05-28T16:47:30Z",
    "created_at": "2020-06-08T15:20:11Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Upgrade gcc to 9.3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29827",
    "user": "https://github.com/mkoeppe"
}
```
We upgrade gcc from 9.2 to 9.3

https://gcc.gnu.org/bugzilla/buglist.cgi?bug_status=RESOLVED&resolution=FIXED&target_milestone=9.3

part of #29703

tarball: see checksums.ini [upstream_url]

Previous update:
- #28691 (gcc 9.2)
- #29674 (patches)



CC:  @jhpalmieri @zlscherr

Branch: u/mkoeppe/upgrade_gcc_to_9_3

Commit: d07ba7bb91dcae08ca35e1f2f9ff710945169495

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/29827





---

archive/issue_comments_577561.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-06-08T15:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577561",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_577562.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,4 @@\n \n part of #29703\n \n+tarball: see checksums.ini [upstream_url]\n``````\n",
    "created_at": "2020-06-08T15:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577562",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,4 @@
 
 part of #29703
 
+tarball: see checksums.ini [upstream_url]
``````




---

archive/issue_comments_577563.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/upgrade_gcc_to_9_3\"",
    "created_at": "2020-06-08T19:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577563",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/upgrade_gcc_to_9_3"



---

archive/issue_comments_577564.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,9 @@\n part of #29703\n \n tarball: see checksums.ini [upstream_url]\n+\n+Previous update:\n+- #28691 (gcc 9.2)\n+- #29674 (patches)\n+\n+\n``````\n",
    "created_at": "2020-06-08T23:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577564",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,9 @@
 part of #29703
 
 tarball: see checksums.ini [upstream_url]
+
+Previous update:
+- #28691 (gcc 9.2)
+- #29674 (patches)
+
+
``````




---

archive/issue_comments_577565.json:
```json
{
    "body": "<a id='comment:3'></a>\nNew commits:\n|                                                                                                                                          |                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[ff3bb3a](https://github.com/sagemath/sagetrac-mirror/commit/ff3bb3a106d22290e942f3cb5192b406bc2a09a6)|`build/pkgs/gcc: Update to 9.3.0`|",
    "created_at": "2020-06-08T23:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577565",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
New commits:
|                                                                                                                                          |                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[ff3bb3a](https://github.com/sagemath/sagetrac-mirror/commit/ff3bb3a106d22290e942f3cb5192b406bc2a09a6)|`build/pkgs/gcc: Update to 9.3.0`|



---

archive/issue_comments_577566.json:
```json
{
    "body": "Changing commit from \"\" to \"ff3bb3a106d22290e942f3cb5192b406bc2a09a6\"",
    "created_at": "2020-06-08T23:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577566",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "ff3bb3a106d22290e942f3cb5192b406bc2a09a6"



---

archive/issue_events_094086.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29827#event-94086"
}
```



---

archive/issue_comments_577567.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[9eb8b21](https://github.com/sagemath/sagetrac-mirror/commit/9eb8b21553de98ab26bdce94308db004459565e9)|`build/pkgs/gcc: Update to 9.3.0`|\n|[cd59612](https://github.com/sagemath/sagetrac-mirror/commit/cd596127918fdbdc4de07206b4b7add22b5e05d5)|`build/pkgs/gcc: Remove libsanitizer patches (upstreamed)`|",
    "created_at": "2021-03-02T23:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577567",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[9eb8b21](https://github.com/sagemath/sagetrac-mirror/commit/9eb8b21553de98ab26bdce94308db004459565e9)|`build/pkgs/gcc: Update to 9.3.0`|
|[cd59612](https://github.com/sagemath/sagetrac-mirror/commit/cd596127918fdbdc4de07206b4b7add22b5e05d5)|`build/pkgs/gcc: Remove libsanitizer patches (upstreamed)`|



---

archive/issue_comments_577568.json:
```json
{
    "body": "Changing commit from \"ff3bb3a106d22290e942f3cb5192b406bc2a09a6\" to \"cd596127918fdbdc4de07206b4b7add22b5e05d5\"",
    "created_at": "2021-03-02T23:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577568",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ff3bb3a106d22290e942f3cb5192b406bc2a09a6" to "cd596127918fdbdc4de07206b4b7add22b5e05d5"



---

archive/issue_comments_577569.json:
```json
{
    "body": "Changing reviewer from \"\" to \"https://github.com/mkoeppe/sage/actions/runs/615728756\"",
    "created_at": "2021-03-02T23:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577569",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "https://github.com/mkoeppe/sage/actions/runs/615728756"



---

archive/issue_comments_577570.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-02T23:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577570",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_577571.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-03-03T01:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577571",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_577572.json:
```json
{
    "body": "<a id='comment:7'></a>\nPatches need updating\n\n```\ngfortran-9.3.0]   Applying patches from ../patches...\n  [gfortran-9.3.0]   Applying ../patches/gcc-multilib-multiarch.patch\n  [gfortran-9.3.0]   patching file gcc/config/i386/t-linux64\n  [gfortran-9.3.0]   patching file gcc/config/mips/t-linux64\n  [gfortran-9.3.0]   patching file gcc/config/rs6000/t-linux\n  [gfortran-9.3.0]   Hunk #1 succeeded at 2 with fuzz 2.\n  [gfortran-9.3.0]   patching file gcc/config/rs6000/t-linux64\n  [gfortran-9.3.0]   patching file gcc/config/s390/t-linux64\n  [gfortran-9.3.0]   patching file gcc/config/sparc/t-linux64\n  [gfortran-9.3.0]   Applying ../patches/homebrew-9.2.0-catalina.patch\n  [gfortran-9.3.0]   patching file fixincludes/fixincl.x\n  [gfortran-9.3.0]   Hunk #1 FAILED at 2.\n  [gfortran-9.3.0]   Hunk #2 FAILED at 15.\n  [gfortran-9.3.0]   Hunk #3 succeeded at 2686 (offset 50 lines).\n  [gfortran-9.3.0]   Hunk #4 FAILED at 10388.\n  [gfortran-9.3.0]   Hunk #5 succeeded at 10558 (offset 100 lines).\n  [gfortran-9.3.0]   Hunk #6 succeeded at 11071 (offset 106 lines).\n  [gfortran-9.3.0]   3 out of 6 hunks FAILED -- saving rejects to file fixincludes/fixincl.x.rej\n  [gfortran-9.3.0]   patching file fixincludes/inclhack.def\n  [gfortran-9.3.0]   Hunk #1 succeeded at 1325 (offset 27 lines).\n  [gfortran-9.3.0]   Error applying '../patches/homebrew-9.2.0-catalina.patch'\n```\nhttps://github.com/mkoeppe/sage/runs/2017617134?check_suite_focus=true",
    "created_at": "2021-03-03T01:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577572",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Patches need updating

```
gfortran-9.3.0]   Applying patches from ../patches...
  [gfortran-9.3.0]   Applying ../patches/gcc-multilib-multiarch.patch
  [gfortran-9.3.0]   patching file gcc/config/i386/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/mips/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/rs6000/t-linux
  [gfortran-9.3.0]   Hunk #1 succeeded at 2 with fuzz 2.
  [gfortran-9.3.0]   patching file gcc/config/rs6000/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/s390/t-linux64
  [gfortran-9.3.0]   patching file gcc/config/sparc/t-linux64
  [gfortran-9.3.0]   Applying ../patches/homebrew-9.2.0-catalina.patch
  [gfortran-9.3.0]   patching file fixincludes/fixincl.x
  [gfortran-9.3.0]   Hunk #1 FAILED at 2.
  [gfortran-9.3.0]   Hunk #2 FAILED at 15.
  [gfortran-9.3.0]   Hunk #3 succeeded at 2686 (offset 50 lines).
  [gfortran-9.3.0]   Hunk #4 FAILED at 10388.
  [gfortran-9.3.0]   Hunk #5 succeeded at 10558 (offset 100 lines).
  [gfortran-9.3.0]   Hunk #6 succeeded at 11071 (offset 106 lines).
  [gfortran-9.3.0]   3 out of 6 hunks FAILED -- saving rejects to file fixincludes/fixincl.x.rej
  [gfortran-9.3.0]   patching file fixincludes/inclhack.def
  [gfortran-9.3.0]   Hunk #1 succeeded at 1325 (offset 27 lines).
  [gfortran-9.3.0]   Error applying '../patches/homebrew-9.2.0-catalina.patch'
```
https://github.com/mkoeppe/sage/runs/2017617134?check_suite_focus=true



---

archive/issue_comments_577573.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[d07ba7b](https://github.com/sagemath/sagetrac-mirror/commit/d07ba7bb91dcae08ca35e1f2f9ff710945169495)|`build/pkgs/gcc/patches: Remove`|",
    "created_at": "2021-03-03T19:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[d07ba7b](https://github.com/sagemath/sagetrac-mirror/commit/d07ba7bb91dcae08ca35e1f2f9ff710945169495)|`build/pkgs/gcc/patches: Remove`|



---

archive/issue_comments_577574.json:
```json
{
    "body": "Changing commit from \"cd596127918fdbdc4de07206b4b7add22b5e05d5\" to \"d07ba7bb91dcae08ca35e1f2f9ff710945169495\"",
    "created_at": "2021-03-03T19:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577574",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cd596127918fdbdc4de07206b4b7add22b5e05d5" to "d07ba7bb91dcae08ca35e1f2f9ff710945169495"



---

archive/issue_comments_577575.json:
```json
{
    "body": "<a id='comment:9'></a>\nAs `@`gh-zlscherr reports in #31326, upgrading to gcc 9.3 does NOT fix the issues on macOS Big Sur.\n\nhomebrew:\n- uses this patch for GCC 10.2: https://raw.githubusercontent.com/Homebrew/formula-patches/6a83f36d/gcc/bigsur_2.patch\n- notes in https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L53: \"Patch for Big Sur, remove with GCC 10.3 - https://gcc.gnu.org/bugzilla/show_bug.cgi?id=98805\"\n\nNot sure if anyone has a backport to the GCC 9.x series",
    "created_at": "2021-03-16T03:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577575",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
As `@`gh-zlscherr reports in #31326, upgrading to gcc 9.3 does NOT fix the issues on macOS Big Sur.

homebrew:
- uses this patch for GCC 10.2: https://raw.githubusercontent.com/Homebrew/formula-patches/6a83f36d/gcc/bigsur_2.patch
- notes in https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gcc.rb#L53: "Patch for Big Sur, remove with GCC 10.3 - https://gcc.gnu.org/bugzilla/show_bug.cgi?id=98805"

Not sure if anyone has a backport to the GCC 9.x series



---

archive/issue_comments_577576.json:
```json
{
    "body": "Changing author from \"Matthias Koeppe\" to \"\"",
    "created_at": "2021-03-16T04:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577576",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Matthias Koeppe" to ""



---

archive/issue_events_094087.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-16T04:00:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29827#event-94087"
}
```



---

archive/issue_events_094088.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-16T04:00:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29827#event-94088"
}
```



---

archive/issue_comments_577577.json:
```json
{
    "body": "<a id='comment:10'></a>\nI had thought that staying for a while on the GCC 9.x series would be useful - given how many fixes were necessary in packages for the 10.x series, there may still be optional/experimental/user packages that cannot be built with GCC 10.\n\nBut it looks like this is not going anywhere, so let's move on and continue in #29703 with an upgrade to 10.x",
    "created_at": "2021-03-16T04:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577577",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
I had thought that staying for a while on the GCC 9.x series would be useful - given how many fixes were necessary in packages for the 10.x series, there may still be optional/experimental/user packages that cannot be built with GCC 10.

But it looks like this is not going anywhere, so let's move on and continue in #29703 with an upgrade to 10.x



---

archive/issue_comments_577578.json:
```json
{
    "body": "Changing reviewer from \"https://github.com/mkoeppe/sage/actions/runs/615728756\" to \"\"",
    "created_at": "2021-03-16T04:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577578",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "https://github.com/mkoeppe/sage/actions/runs/615728756" to ""



---

archive/issue_comments_577579.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-03-16T04:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577579",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_577580.json:
```json
{
    "body": "<a id='comment:11'></a>\nSounds okay.",
    "created_at": "2021-03-16T21:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577580",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
Sounds okay.



---

archive/issue_comments_577581.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-03-16T21:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577581",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_094089.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-05-28T16:47:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29827#event-94089"
}
```



---

archive/issue_comments_577582.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-05-28T16:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29827#issuecomment-577582",
    "user": "https://github.com/fchapoton"
}
```

Resolution: invalid
