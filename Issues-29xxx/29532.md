# Issue 29532: cygwin: Fix spkg-configure.m4 for iconv

archive/issues_029295.json:
```json
{
    "body": "Follow-up from #27823 (spkg-configure.m4 for iconv), comment 46:\n\n  It seems that, at least on Cygwin, AM_ICONV will pass, somehow, even if iconv.h is installed, thus making the libicon-devel package on Cygwin a requirement, at least when it comes to building R (which otherwise fails at #include <iconv.h>).\n\n  For now I'll just update the Cygwin build instructions to require libiconv-devel as a prerequisite which is preferable anyways. But maybe this still needs to be checked for somehow...\n\nIndeed this needs fixing:\n\n```\nconfigure:21635: g++ -std=gnu++11 -o conftest.exe -g -O2    conftest.cpp -lglpk -lreadline -lcurl -lbz2 -lflint -lmpfr -lgmp -lm  -lntl -liconv >&5\nconftest.cpp:68:10: fatal error: iconv.h: No such file or directory\n   68 | #include <iconv.h>\n      |          ^~~~~~~~~\ncompilation terminated.\n...\n\nconfigure:21645: result: no, consider installing GNU libiconv\n## ------------------------------------------------------ ##\n## Checking whether SageMath should install SPKG iconv... ##\n## ------------------------------------------------------ ##\nconfigure:21940: will use system package and not install SPKG iconv\n## ---------------------------------------------------- ##\n\n\n```\n\n\n  \n\nCC:  @embray @orlitzky @dimpase\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: 49c8e4d2eda1a1c9f320b983c6ac5b7657653484\n\nCommit: 49c8e4d2eda1a1c9f320b983c6ac5b7657653484\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29532\n\n",
    "closed_at": "2020-04-22T20:52:44Z",
    "created_at": "2020-04-19T13:40:58Z",
    "labels": [
        "component: build: configure",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "cygwin: Fix spkg-configure.m4 for iconv",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29532",
    "user": "https://github.com/mkoeppe"
}
```
Follow-up from #27823 (spkg-configure.m4 for iconv), comment 46:

  It seems that, at least on Cygwin, AM_ICONV will pass, somehow, even if iconv.h is installed, thus making the libicon-devel package on Cygwin a requirement, at least when it comes to building R (which otherwise fails at #include <iconv.h>).

  For now I'll just update the Cygwin build instructions to require libiconv-devel as a prerequisite which is preferable anyways. But maybe this still needs to be checked for somehow...

Indeed this needs fixing:

```
configure:21635: g++ -std=gnu++11 -o conftest.exe -g -O2    conftest.cpp -lglpk -lreadline -lcurl -lbz2 -lflint -lmpfr -lgmp -lm  -lntl -liconv >&5
conftest.cpp:68:10: fatal error: iconv.h: No such file or directory
   68 | #include <iconv.h>
      |          ^~~~~~~~~
compilation terminated.
...

configure:21645: result: no, consider installing GNU libiconv
## ------------------------------------------------------ ##
## Checking whether SageMath should install SPKG iconv... ##
## ------------------------------------------------------ ##
configure:21940: will use system package and not install SPKG iconv
## ---------------------------------------------------- ##


```


  

CC:  @embray @orlitzky @dimpase

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Branch: 49c8e4d2eda1a1c9f320b983c6ac5b7657653484

Commit: 49c8e4d2eda1a1c9f320b983c6ac5b7657653484

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29532





---

archive/issue_comments_414760.json:
```json
{
    "body": "<a id='comment:1'></a>hmm, so you are not running ./bootstrap on Cygwin?",
    "created_at": "2020-04-19T13:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414760",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>hmm, so you are not running ./bootstrap on Cygwin?



---

archive/issue_comments_414761.json:
```json
{
    "body": "<a id='comment:2'></a>note that spkg-install says \n\n```\n    echo \"iconv will be installed as the operating system is Cygwin, HP-UX or Solaris.\"\n    echo \"These systems either lack iconv, or do not have a sufficiently capable\"\n```\n\nIs this no longer true for Cygwin?",
    "created_at": "2020-04-19T14:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414761",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>note that spkg-install says 

```
    echo "iconv will be installed as the operating system is Cygwin, HP-UX or Solaris."
    echo "These systems either lack iconv, or do not have a sufficiently capable"
```

Is this no longer true for Cygwin?



---

archive/issue_comments_414762.json:
```json
{
    "body": "<a id='comment:3'></a>Gettext is installed, bootstrap worked.",
    "created_at": "2020-04-19T14:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414762",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Gettext is installed, bootstrap worked.



---

archive/issue_comments_414763.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2020-04-19T15:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414763",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_414764.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-19T15:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414764",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_414765.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-19T15:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414765",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_414766.json:
```json
{
    "body": "<a id='comment:7'></a>OK, good catch.",
    "created_at": "2020-04-19T15:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414766",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>OK, good catch.



---

archive/issue_comments_414767.json:
```json
{
    "body": "<a id='comment:8'></a>Thanks!",
    "created_at": "2020-04-19T15:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414767",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Thanks!



---

archive/issue_comments_414768.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-22T20:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29532#issuecomment-414768",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_075348.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-22T20:52:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29532",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29532#event-75348"
}
```
