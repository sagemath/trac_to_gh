# Issue 29976: Make matrix doctests ready for random seeds

archive/issues_029739.json:
```json
{
    "body": "This ticket makes\n\n```\nsage -t --long --random-seed=n src/sage/matrix/\n```\npass for n more general than just 0. \n\nCC:  @slel\n\nKeywords: random_seed, fuzz\n\nBranch/Commit: 4fceeae6daae483b6b0554b9270ea75aa0801ec8\n\nReviewer: Samuel Leli\u00e8vre\n\nAuthor: Jonathan Kliem\n\nDependencies: #29962\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29976\n\n",
    "closed_at": "2021-06-20T08:14:38Z",
    "created_at": "2020-06-24T21:29:41Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Make matrix doctests ready for random seeds",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29976",
    "user": "https://github.com/kliem"
}
```
This ticket makes

```
sage -t --long --random-seed=n src/sage/matrix/
```
pass for n more general than just 0. 

CC:  @slel

Keywords: random_seed, fuzz

Branch/Commit: 4fceeae6daae483b6b0554b9270ea75aa0801ec8

Reviewer: Samuel Leli√®vre

Author: Jonathan Kliem

Dependencies: #29962

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29976





---

archive/issue_comments_588874.json:
```json
{
    "body": "<a id='comment:1'></a>I have a very partial fix. But even after that the following still need to be taken care of\n\n```\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_cyclo_dense.pyx  # 3 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_generic_dense.pyx  # 1 doctest failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_gf2e_dense.pyx  # 67 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_integer_dense_saturation.py  # 2 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_integer_dense.pyx  # 3 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_dense_double.pyx  # 13 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_dense_float.pyx  # 12 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_dense_template.pxi  # 77 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_sparse.pyx  # 3 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_rational_dense.pyx  # 4 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_space.py  # 5 doctests failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_sparse.pyx  # 1 doctest failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix1.pyx  # 1 doctest failed\nsage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/special.py  # 37 doctests failed\n```",
    "created_at": "2020-06-24T21:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588874",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>I have a very partial fix. But even after that the following still need to be taken care of

```
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_cyclo_dense.pyx  # 3 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_generic_dense.pyx  # 1 doctest failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_gf2e_dense.pyx  # 67 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_integer_dense_saturation.py  # 2 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_integer_dense.pyx  # 3 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_dense_double.pyx  # 13 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_dense_float.pyx  # 12 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_dense_template.pxi  # 77 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_modn_sparse.pyx  # 3 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_rational_dense.pyx  # 4 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_space.py  # 5 doctests failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix_sparse.pyx  # 1 doctest failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/matrix1.pyx  # 1 doctest failed
sage -t --long --random-seed=151058820726654196682836430928254760259 src/sage/matrix/special.py  # 37 doctests failed
```



---

archive/issue_comments_588875.json:
```json
{
    "body": "Changing branch from \"\" to \"public/29976\"",
    "created_at": "2020-06-24T21:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588875",
    "user": "https://github.com/kliem"
}
```

Changing branch from "" to "public/29976"



---

archive/issue_comments_588876.json:
```json
{
    "body": "Changing commit from \"\" to \"9daa68b2bd7ef4b779d35ac7c0cce045c54c680b\"",
    "created_at": "2020-06-24T21:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "9daa68b2bd7ef4b779d35ac7c0cce045c54c680b"



---

archive/issue_comments_588877.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T21:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588877",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_076974.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29976#event-76974"
}
```



---

archive/issue_comments_588878.json:
```json
{
    "body": "<a id='comment:5'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588878",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_076975.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29976#event-76975"
}
```



---

archive/issue_events_076976.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29976#event-76976"
}
```



---

archive/issue_comments_588879.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n ```\n sage -t --long --random-seed=n src/sage/matrix/\n ```\n-pass for different values `n` than just `0`.\n+pass for n more general than just 0. \n \n Dependencies: #29962\n \n``````\n",
    "created_at": "2021-04-30T08:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588879",
    "user": "https://github.com/kliem"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 ```
 sage -t --long --random-seed=n src/sage/matrix/
 ```
-pass for different values `n` than just `0`.
+pass for n more general than just 0. 
 
 Dependencies: #29962
 
``````




---

archive/issue_comments_588880.json:
```json
{
    "body": "Changing commit from \"9daa68b2bd7ef4b779d35ac7c0cce045c54c680b\" to \"bf7fd3bb1d75013acd6505153e88ff53a8065b1b\"",
    "created_at": "2021-04-30T10:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588880",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9daa68b2bd7ef4b779d35ac7c0cce045c54c680b" to "bf7fd3bb1d75013acd6505153e88ff53a8065b1b"



---

archive/issue_comments_588881.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-04-30T10:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_588882.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-04T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588882",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_588883.json:
```json
{
    "body": "Changing branch from \"public/29976\" to \"public/29976-reb\"",
    "created_at": "2021-06-04T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588883",
    "user": "https://github.com/kliem"
}
```

Changing branch from "public/29976" to "public/29976-reb"



---

archive/issue_comments_588884.json:
```json
{
    "body": "Changing commit from \"bf7fd3bb1d75013acd6505153e88ff53a8065b1b\" to \"c1c315cf300a55f18b18008502b8deb9018b8411\"",
    "created_at": "2021-06-04T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588884",
    "user": "https://github.com/kliem"
}
```

Changing commit from "bf7fd3bb1d75013acd6505153e88ff53a8065b1b" to "c1c315cf300a55f18b18008502b8deb9018b8411"



---

archive/issue_comments_588885.json:
```json
{
    "body": "<a id='comment:8'></a>New commits:",
    "created_at": "2021-06-04T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588885",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>New commits:



---

archive/issue_comments_588886.json:
```json
{
    "body": "Changing author from \"\" to \"Jonathan Kliem\"",
    "created_at": "2021-06-04T14:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588886",
    "user": "https://github.com/kliem"
}
```

Changing author from "" to "Jonathan Kliem"



---

archive/issue_comments_588887.json:
```json
{
    "body": "Changing keywords from \"\" to \"random_seed, fuzz\".",
    "created_at": "2021-06-07T22:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588887",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "random_seed, fuzz".



---

archive/issue_comments_588888.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Samuel Leli\u00e8vre\"",
    "created_at": "2021-06-07T22:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588888",
    "user": "https://github.com/slel"
}
```

Changing reviewer from "" to "Samuel Leli√®vre"



---

archive/issue_comments_588889.json:
```json
{
    "body": "<a id='comment:10'></a>A typo in `src/sage/matrix/matrix_rational_dense.pyx`\nprevents the HTML documentation from building.\n\nTo fix it, change this in the docstring of `randomize`:\n\n```\n-        The default density is ``6/9`::\n+        The default density is `6/9`::\n```\n\nAfter fixing that, success doctesting `src/sage/matrix`\nbe it with the random seed in the ticket description\nor with a few extra random ones.\n\nInstead of using `l` (lowercase L) to name a list,\nin many cases a more descriptive name can be used\nand is less confusing; for a list of matrix entries,\nwhy not call it `entries` for example?",
    "created_at": "2021-06-07T22:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588889",
    "user": "https://github.com/slel"
}
```

<a id='comment:10'></a>A typo in `src/sage/matrix/matrix_rational_dense.pyx`
prevents the HTML documentation from building.

To fix it, change this in the docstring of `randomize`:

```
-        The default density is ``6/9`::
+        The default density is `6/9`::
```

After fixing that, success doctesting `src/sage/matrix`
be it with the random seed in the ticket description
or with a few extra random ones.

Instead of using `l` (lowercase L) to name a list,
in many cases a more descriptive name can be used
and is less confusing; for a list of matrix entries,
why not call it `entries` for example?



---

archive/issue_comments_588890.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-08T06:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_588891.json:
```json
{
    "body": "Changing commit from \"c1c315cf300a55f18b18008502b8deb9018b8411\" to \"4fceeae6daae483b6b0554b9270ea75aa0801ec8\"",
    "created_at": "2021-06-08T06:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c1c315cf300a55f18b18008502b8deb9018b8411" to "4fceeae6daae483b6b0554b9270ea75aa0801ec8"



---

archive/issue_comments_588892.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-08T15:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588892",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_588893.json:
```json
{
    "body": "<a id='comment:12'></a>Minor improvements such as renaming a list\nfrom `l` to `entries` can be done later.",
    "created_at": "2021-06-08T15:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588893",
    "user": "https://github.com/slel"
}
```

<a id='comment:12'></a>Minor improvements such as renaming a list
from `l` to `entries` can be done later.



---

archive/issue_comments_588894.json:
```json
{
    "body": "<a id='comment:13'></a>Thank you.",
    "created_at": "2021-06-08T17:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588894",
    "user": "https://github.com/kliem"
}
```

<a id='comment:13'></a>Thank you.



---

archive/issue_comments_588895.json:
```json
{
    "body": "Changing branch from \"public/29976-reb\" to \"4fceeae6daae483b6b0554b9270ea75aa0801ec8\"",
    "created_at": "2021-06-20T08:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588895",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/29976-reb" to "4fceeae6daae483b6b0554b9270ea75aa0801ec8"



---

archive/issue_events_076977.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-20T08:14:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29976#event-76977"
}
```



---

archive/issue_comments_588896.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-20T08:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29976#issuecomment-588896",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
