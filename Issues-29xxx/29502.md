# Issue 29502: spkg-configure for suitesparse

archive/issues_029265.json:
```json
{
    "assignees": [],
    "body": "Different distos use different subsets of SuiteSparse,\nbut this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies),UMFRACK and suitesparseconfig.\n\n\n\nCC:  @mkoeppe @orlitzky @thierry-FreeBSD @kiwifb\n\nComponent: **build: configure**\n\nAuthor: **Dima Pasechnik**\n\nBranch: **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)**\n\nReviewer: **Michael Orlitzky**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29502_\n\n",
    "closed_at": "2020-05-26T21:44:06Z",
    "created_at": "2020-04-13T03:33:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "spkg-configure for suitesparse",
    "type": "issue",
    "updated_at": "2020-07-03T04:18:18Z",
    "url": "https://github.com/sagemath/sage/issues/29502",
    "user": "https://github.com/dimpase"
}
```
Different distos use different subsets of SuiteSparse,
but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies),UMFRACK and suitesparseconfig.



CC:  @mkoeppe @orlitzky @thierry-FreeBSD @kiwifb

Component: **build: configure**

Author: **Dima Pasechnik**

Branch: **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)**

Reviewer: **Michael Orlitzky**

_Issue created by migration from https://trac.sagemath.org/ticket/29502_





---

archive/issue_events_402730.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-13T03:33:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402730"
}
```



---

archive/issue_events_402731.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-13T03:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "0000b0",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402731"
}
```



---

archive/issue_events_402732.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-13T03:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402732"
}
```



---

archive/issue_events_402733.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-13T03:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402733"
}
```



---

archive/issue_comments_463758.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,2 @@\n I guess that different distos use different subsets of SuiteSparse,\n-but this is needed to be done.\n+but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies).\n``````\n",
    "created_at": "2020-04-13T08:39:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463758",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,2 @@
 I guess that different distos use different subsets of SuiteSparse,
-but this is needed to be done.
+but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies).
``````




---

archive/issue_comments_463759.json:
```json
{
    "body": "Attachment: **[umfpack.m4.gz](https://github.com/sagemath/sage/files/ticket29502/umfpack.m4.gz)**",
    "created_at": "2020-04-13T09:05:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463759",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Attachment: **[umfpack.m4.gz](https://github.com/sagemath/sage/files/ticket29502/umfpack.m4.gz)**



---

archive/issue_comments_463760.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThanks! I do not know anything about macro m4 and autotools, but I already tried to work on this. For that, I borrowed a file umfpack.m4 from the Dune project, before they switched to cmake. It is released under a GPL license. Please see the attachment if it could help.",
    "created_at": "2020-04-13T09:09:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463760",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:3" align="right">comment:3</div>

Thanks! I do not know anything about macro m4 and autotools, but I already tried to work on this. For that, I borrowed a file umfpack.m4 from the Dune project, before they switched to cmake. It is released under a GPL license. Please see the attachment if it could help.



---

archive/issue_comments_463761.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nplease try this branch (not tested much, though)\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10ffa1f72a788e05e4e826c18ac899ad678b13aa\"><code>10ffa1f</code></a></td><td><code>spkg-configure for suitesparse (draft)</code></td></tr></table>\n",
    "created_at": "2020-04-13T10:10:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463761",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

please try this branch (not tested much, though)

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10ffa1f72a788e05e4e826c18ac899ad678b13aa"><code>10ffa1f</code></a></td><td><code>spkg-configure for suitesparse (draft)</code></td></tr></table>




---

archive/issue_comments_463762.json:
```json
{
    "body": "Branch: **[u/dimpase/packages/suitesparseconf](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/suitesparseconf)**",
    "created_at": "2020-04-13T10:10:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463762",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/packages/suitesparseconf](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/suitesparseconf)**



---

archive/issue_comments_463763.json:
```json
{
    "body": "Commit: **[`10ffa1f`](https://github.com/sagemath/sagetrac-mirror/commit/10ffa1f72a788e05e4e826c18ac899ad678b13aa)**",
    "created_at": "2020-04-13T10:10:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463763",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`10ffa1f`](https://github.com/sagemath/sagetrac-mirror/commit/10ffa1f72a788e05e4e826c18ac899ad678b13aa)**



---

archive/issue_comments_463764.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nConfigure is OK for iml and suitesparse:\n\n---\n\nChecking whether [SageMath](../wiki/SageMath) should install SPKG iml...\n\nchecking whether any of gmp mpir openblas is installed or will be installed as SPKG... no\n\nchecking for iml.h... yes\n\nchecking for library containing nonsingSolvLlhsMM... -liml\n\nconfigure: will use system package and not install SPKG iml\n\n---\n\n...\n\n---\n\nChecking whether [SageMath](../wiki/SageMath) should install SPKG suitesparse...\n\nchecking whether any of openblas is installed or will be installed as SPKG... no\n\nchecking suitesparse/SuiteSparse_config.h usability... yes\n\nchecking suitesparse/SuiteSparse_config.h presence... yes\n\nchecking for suitesparse/SuiteSparse_config.h... yes\n\nchecking for library containing cholmod_speye... -lcholmod\n\nconfigure: will use system package and not install SPKG suitesparse\n\n---\n\n...\n\niml-1.0.4p1.p2:                              using system package; SPKG will not be installed\n\n...\n\nsuitesparse-5.6.0:                           using system package; SPKG will not be installed\n\n\nBut now cvxopt fails:\n\n[cvxopt-1.2.3]     src/C/umfpack.c:23:10: fatal error: 'umfpack.h' file not found\n\n[cvxopt-1.2.3]     #include \"umfpack.h\"\n\nNote: on FreeBSD umfpack.h is located under /usr/local/include/suitesparse/umfpack.h. Just let me know if I fix it for FreeBSD or if the same failure could occur on other systems.",
    "created_at": "2020-04-13T12:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463764",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:5" align="right">comment:5</div>

Configure is OK for iml and suitesparse:

---

Checking whether [SageMath](../wiki/SageMath) should install SPKG iml...

checking whether any of gmp mpir openblas is installed or will be installed as SPKG... no

checking for iml.h... yes

checking for library containing nonsingSolvLlhsMM... -liml

configure: will use system package and not install SPKG iml

---

...

---

Checking whether [SageMath](../wiki/SageMath) should install SPKG suitesparse...

checking whether any of openblas is installed or will be installed as SPKG... no

checking suitesparse/SuiteSparse_config.h usability... yes

checking suitesparse/SuiteSparse_config.h presence... yes

checking for suitesparse/SuiteSparse_config.h... yes

checking for library containing cholmod_speye... -lcholmod

configure: will use system package and not install SPKG suitesparse

---

...

iml-1.0.4p1.p2:                              using system package; SPKG will not be installed

...

suitesparse-5.6.0:                           using system package; SPKG will not be installed


But now cvxopt fails:

[cvxopt-1.2.3]     src/C/umfpack.c:23:10: fatal error: 'umfpack.h' file not found

[cvxopt-1.2.3]     #include "umfpack.h"

Note: on FreeBSD umfpack.h is located under /usr/local/include/suitesparse/umfpack.h. Just let me know if I fix it for FreeBSD or if the same failure could occur on other systems.



---

archive/issue_comments_463765.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOn Debian the location of the header is also prefixed.\nProbably this is a cvxopt bug.\nOne might try to find out how Debian works around this.",
    "created_at": "2020-04-13T12:43:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463765",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

On Debian the location of the header is also prefixed.
Probably this is a cvxopt bug.
One might try to find out how Debian works around this.



---

archive/issue_comments_463766.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nOn Debian, the following hack makes things work:\n\n```diff\n--- a/build/pkgs/cvxopt/spkg-install.in\n+++ b/build/pkgs/cvxopt/spkg-install.in\n@@ -21,8 +21,8 @@ export CVXOPT_BLAS_LIB=\"$(pkg_libs blas)\"\n export CVXOPT_BLAS_LIB_DIR=\"$(pkg-config --variable=libdir blas)\"\n export CVXOPT_LAPACK_LIB=\"$(pkg_libs lapack)\"\n \n-export CVXOPT_SUITESPARSE_LIB_DIR=\"${SAGE_LOCAL}\"\n-export CVXOPT_SUITESPARSE_INC_DIR=\"${SAGE_LOCAL}/include\"\n+# export CVXOPT_SUITESPARSE_LIB_DIR=\"${SAGE_LOCAL}\"\n+# export CVXOPT_SUITESPARSE_INC_DIR=\"${SAGE_LOCAL}/include\"\n \n export CVXOPT_BUILD_GLPK=1\n export CVXOPT_GLPK_LIB_DIR=\"${SAGE_LOCAL}\"\n```\nI'll do a proper fix later, but this should get one",
    "created_at": "2020-04-13T15:06:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463766",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

On Debian, the following hack makes things work:

```diff
--- a/build/pkgs/cvxopt/spkg-install.in
+++ b/build/pkgs/cvxopt/spkg-install.in
@@ -21,8 +21,8 @@ export CVXOPT_BLAS_LIB="$(pkg_libs blas)"
 export CVXOPT_BLAS_LIB_DIR="$(pkg-config --variable=libdir blas)"
 export CVXOPT_LAPACK_LIB="$(pkg_libs lapack)"
 
-export CVXOPT_SUITESPARSE_LIB_DIR="${SAGE_LOCAL}"
-export CVXOPT_SUITESPARSE_INC_DIR="${SAGE_LOCAL}/include"
+# export CVXOPT_SUITESPARSE_LIB_DIR="${SAGE_LOCAL}"
+# export CVXOPT_SUITESPARSE_INC_DIR="${SAGE_LOCAL}/include"
 
 export CVXOPT_BUILD_GLPK=1
 export CVXOPT_GLPK_LIB_DIR="${SAGE_LOCAL}"
```
I'll do a proper fix later, but this should get one



---

archive/issue_comments_463767.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nA naive work-around (just adding -I /usr/local/include/suitesparse) was sufficient to build everything.\n\nI'm going to test your patch to check if it works for me.\n\nNote about u/dimpase/packages/suitesparseconf: actually cvxopt produces 3 python libraries, site-packages/cvxopt/amd.so, site-packages/cvxopt/cholmod.so and site-packages/cvxopt/umfpack.so, and they are linked to libamd.so.2, libsuitesparseconfig.so.5 and libumfpack.so.5 from suitesparse; maybe you would check if they are available in its spkg-configure.m4?",
    "created_at": "2020-04-13T15:55:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463767",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:8" align="right">comment:8</div>

A naive work-around (just adding -I /usr/local/include/suitesparse) was sufficient to build everything.

I'm going to test your patch to check if it works for me.

Note about u/dimpase/packages/suitesparseconf: actually cvxopt produces 3 python libraries, site-packages/cvxopt/amd.so, site-packages/cvxopt/cholmod.so and site-packages/cvxopt/umfpack.so, and they are linked to libamd.so.2, libsuitesparseconfig.so.5 and libumfpack.so.5 from suitesparse; maybe you would check if they are available in its spkg-configure.m4?



---

archive/issue_comments_463768.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A8):\n\n> Note about u/dimpase/packages/suitesparseconf: actually cvxopt produces 3 python libraries, site-packages/cvxopt/amd.so, site-packages/cvxopt/cholmod.so and site-packages/cvxopt/umfpack.so, and they are linked to libamd.so.2, libsuitesparseconfig.so.5 and libumfpack.so.5 from suitesparse; maybe you would check if they are available in its spkg-configure.m4?\n\nAMD, COLAMD, CCOLAMD are dependencies of CHOLMOD in  SuiteSparse, so it apparently suffices to add a check for UMFPACK (and suitesparseconfig - which presumably is always there, but OK).",
    "created_at": "2020-04-13T17:24:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463768",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@thierry-FreeBSD](#comment%3A8):

> Note about u/dimpase/packages/suitesparseconf: actually cvxopt produces 3 python libraries, site-packages/cvxopt/amd.so, site-packages/cvxopt/cholmod.so and site-packages/cvxopt/umfpack.so, and they are linked to libamd.so.2, libsuitesparseconfig.so.5 and libumfpack.so.5 from suitesparse; maybe you would check if they are available in its spkg-configure.m4?

AMD, COLAMD, CCOLAMD are dependencies of CHOLMOD in  SuiteSparse, so it apparently suffices to add a check for UMFPACK (and suitesparseconfig - which presumably is always there, but OK).



---

archive/issue_comments_463769.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nSame error on FreeBSD with the Debian's patch of build/pkgs/cvxopt/spkg-install.in : umfpack.h is not found.\n\nI would set something like:\n\nexport CVXOPT_SUITESPARSE_INC_DIR=\"${LOCALBASE}/suitesparse/include\"\n\nbut $LOCALBASE is not set!\n\nWould it be possible to modify build/pkgs/suitesparse/spkg-configure.m4 so that it sets a variable of the include path where SuiteSparse_config.h has been found?",
    "created_at": "2020-04-13T17:59:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463769",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:10" align="right">comment:10</div>

Same error on FreeBSD with the Debian's patch of build/pkgs/cvxopt/spkg-install.in : umfpack.h is not found.

I would set something like:

export CVXOPT_SUITESPARSE_INC_DIR="${LOCALBASE}/suitesparse/include"

but $LOCALBASE is not set!

Would it be possible to modify build/pkgs/suitesparse/spkg-configure.m4 so that it sets a variable of the include path where SuiteSparse_config.h has been found?



---

archive/issue_comments_463770.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@thierry-FreeBSD](#comment%3A10):\n> Same error on FreeBSD with the Debian's patch of build/pkgs/cvxopt/spkg-install.in : umfpack.h is not found.\n> \n> I would set something like:\n> \n> export CVXOPT_SUITESPARSE_INC_DIR=\"${LOCALBASE}/suitesparse/include\"\n> \n> but $LOCALBASE is not set!\n> \n> Would it be possible to modify build/pkgs/suitesparse/spkg-configure.m4 so that it sets a variable of the include path where SuiteSparse_config.h has been found?\n\ngetting a full include path is always a pain, and should not be needed as long as it is in the default compiler path for headers. Doesn't FreeBSD's clang look in `/usr/local/include/` by default (which is always the case on every Linux  I know, and on MacOS) ? Apparently it does not (which is insane, IMHO) - otherwise I don't understand this error on FreeBSD.",
    "created_at": "2020-04-14T02:09:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463770",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@thierry-FreeBSD](#comment%3A10):
> Same error on FreeBSD with the Debian's patch of build/pkgs/cvxopt/spkg-install.in : umfpack.h is not found.
> 
> I would set something like:
> 
> export CVXOPT_SUITESPARSE_INC_DIR="${LOCALBASE}/suitesparse/include"
> 
> but $LOCALBASE is not set!
> 
> Would it be possible to modify build/pkgs/suitesparse/spkg-configure.m4 so that it sets a variable of the include path where SuiteSparse_config.h has been found?

getting a full include path is always a pain, and should not be needed as long as it is in the default compiler path for headers. Doesn't FreeBSD's clang look in `/usr/local/include/` by default (which is always the case on every Linux  I know, and on MacOS) ? Apparently it does not (which is insane, IMHO) - otherwise I don't understand this error on FreeBSD.



---

archive/issue_comments_463771.json:
```json
{
    "body": "Changed commit from **[`10ffa1f`](https://github.com/sagemath/sagetrac-mirror/commit/10ffa1f72a788e05e4e826c18ac899ad678b13aa)** to **[`b7b85d7`](https://github.com/sagemath/sagetrac-mirror/commit/b7b85d7915c94159287213235400cd2be6956fad)**",
    "created_at": "2020-04-14T03:48:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463771",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`10ffa1f`](https://github.com/sagemath/sagetrac-mirror/commit/10ffa1f72a788e05e4e826c18ac899ad678b13aa)** to **[`b7b85d7`](https://github.com/sagemath/sagetrac-mirror/commit/b7b85d7915c94159287213235400cd2be6956fad)**



---

archive/issue_comments_463772.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7b85d7915c94159287213235400cd2be6956fad\"><code>b7b85d7</code></a></td><td><code>more distros info</code></td></tr></table>\n",
    "created_at": "2020-04-14T03:48:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463772",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7b85d7915c94159287213235400cd2be6956fad"><code>b7b85d7</code></a></td><td><code>more distros info</code></td></tr></table>




---

archive/issue_comments_463773.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2020-04-14T03:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463773",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_comments_463774.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,4 @@\n I guess that different distos use different subsets of SuiteSparse,\n-but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies).\n+but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies),UMFRACK and suitesparseconfig.\n+\n+We assume that the headers are prefixed with `suitesparse/`\n``````\n",
    "created_at": "2020-04-14T03:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463774",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,4 @@
 I guess that different distos use different subsets of SuiteSparse,
-but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies).
+but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies),UMFRACK and suitesparseconfig.
+
+We assume that the headers are prefixed with `suitesparse/`
``````




---

archive/issue_comments_463775.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSo the FreeBSD question is whether adding `-I /usr/local/include/` to `CFLAGS` and [comment:7](#comment%3A7) allow the thing to build.",
    "created_at": "2020-04-14T03:55:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463775",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

So the FreeBSD question is whether adding `-I /usr/local/include/` to `CFLAGS` and [comment:7](#comment%3A7) allow the thing to build.



---

archive/issue_comments_463776.json:
```json
{
    "body": "Changed commit from **[`b7b85d7`](https://github.com/sagemath/sagetrac-mirror/commit/b7b85d7915c94159287213235400cd2be6956fad)** to **[`184b88a`](https://github.com/sagemath/sagetrac-mirror/commit/184b88ad58fd788f11f6637e613015cf90f25f87)**",
    "created_at": "2020-04-14T05:32:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463776",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b7b85d7`](https://github.com/sagemath/sagetrac-mirror/commit/b7b85d7915c94159287213235400cd2be6956fad)** to **[`184b88a`](https://github.com/sagemath/sagetrac-mirror/commit/184b88ad58fd788f11f6637e613015cf90f25f87)**



---

archive/issue_comments_463777.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f5619ca99674fb06733de27f05a0054608faca6\"><code>0f5619c</code></a></td><td><code>set up SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b6b1a8aa00b003342ad40d9931eacea72cf0285\"><code>9b6b1a8</code></a></td><td><code>remove an old FreeBSD leftover</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/184b88ad58fd788f11f6637e613015cf90f25f87\"><code>184b88a</code></a></td><td><code>tests for other libs in sparsesuite</code></td></tr></table>\n",
    "created_at": "2020-04-14T05:32:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463777",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f5619ca99674fb06733de27f05a0054608faca6"><code>0f5619c</code></a></td><td><code>set up SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b6b1a8aa00b003342ad40d9931eacea72cf0285"><code>9b6b1a8</code></a></td><td><code>remove an old FreeBSD leftover</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/184b88ad58fd788f11f6637e613015cf90f25f87"><code>184b88a</code></a></td><td><code>tests for other libs in sparsesuite</code></td></tr></table>




---

archive/issue_events_402734.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-14T05:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402734"
}
```



---

archive/issue_comments_463778.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nGreat! The missing part was SAGE_SUITESPARSE_PREFIX.",
    "created_at": "2020-04-14T07:48:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463778",
    "user": "https://github.com/thierry-FreeBSD"
}
```

<div id="comment:17" align="right">comment:17</div>

Great! The missing part was SAGE_SUITESPARSE_PREFIX.



---

archive/issue_comments_463779.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\ntests being run here: https://github.com/dimpase/sage/actions?query=workflow%3A%22Run+SAGE_ROOT%2Ftox.ini%22\n\nlooks good (modulo unrelated things, e.g. problems with brial on Fedora, etc)",
    "created_at": "2020-04-14T15:53:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463779",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

tests being run here: https://github.com/dimpase/sage/actions?query=workflow%3A%22Run+SAGE_ROOT%2Ftox.ini%22

looks good (modulo unrelated things, e.g. problems with brial on Fedora, etc)



---

archive/issue_comments_463780.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nperhaps this can make it into 9.1?",
    "created_at": "2020-04-19T04:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463780",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

perhaps this can make it into 9.1?



---

archive/issue_events_402735.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-19T04:51:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402735"
}
```



---

archive/issue_events_402736.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-19T04:51:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402736"
}
```



---

archive/issue_comments_463781.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nNeeds rebasing on top of #29492 or something like that",
    "created_at": "2020-04-19T06:02:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463781",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Needs rebasing on top of #29492 or something like that



---

archive/issue_comments_463782.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI can't seem to get the branch of #29492  for some reason.",
    "created_at": "2020-04-19T06:53:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463782",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

I can't seem to get the branch of #29492  for some reason.



---

archive/issue_comments_463783.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOn Gentoo, I think users only need to install\n\n* sci-libs/cholmod\n* sci-libs/suitesparseconfig\n* sci-libs/umfpack\n\nwhich is a bit less than the whole suitesparse. But currently it doesn't work anyway because the check is looking for the header in the wrong place. Unless they moved it in v5.6.0, upstream SuiteSparse_config installs the header *without* the `suitesparse/` prefix.\n\nCVXOPT however checks both `/usr/include` and `/usr/include/suitesparse`, and nobody else looks for that header, so I think it would be fine to just add the un-prefixed path as an option to that header check.",
    "created_at": "2020-04-19T19:49:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463783",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:22" align="right">comment:22</div>

On Gentoo, I think users only need to install

* sci-libs/cholmod
* sci-libs/suitesparseconfig
* sci-libs/umfpack

which is a bit less than the whole suitesparse. But currently it doesn't work anyway because the check is looking for the header in the wrong place. Unless they moved it in v5.6.0, upstream SuiteSparse_config installs the header *without* the `suitesparse/` prefix.

CVXOPT however checks both `/usr/include` and `/usr/include/suitesparse`, and nobody else looks for that header, so I think it would be fine to just add the un-prefixed path as an option to that header check.



---

archive/issue_events_402737.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-04-19T19:49:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402737"
}
```



---

archive/issue_events_402738.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-04-19T19:49:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402738"
}
```



---

archive/issue_comments_463784.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nLooking at CVXOPT's setup.py,\n\nhttps://github.com/cvxopt/cvxopt/blob/master/setup.py\n\nI also see \"amd\" (sci-libs/amd) and \"colamd\" (sci-libs/colamd) make an appearance. I don't pretend to understand what's going on in there, but it's worth a look to see if we need to check for those libraries too.",
    "created_at": "2020-04-19T21:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463784",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:23" align="right">comment:23</div>

Looking at CVXOPT's setup.py,

https://github.com/cvxopt/cvxopt/blob/master/setup.py

I also see "amd" (sci-libs/amd) and "colamd" (sci-libs/colamd) make an appearance. I don't pretend to understand what's going on in there, but it's worth a look to see if we need to check for those libraries too.



---

archive/issue_comments_463785.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@orlitzky](#comment%3A23):\n> Looking at CVXOPT's setup.py,\n> \n> https://github.com/cvxopt/cvxopt/blob/master/setup.py\n> \n> I also see \"amd\" (sci-libs/amd) and \"colamd\" (sci-libs/colamd) make an appearance. I don't pretend to understand what's going on in there, but it's worth a look to see if we need to check for those libraries too.\n> \n\nThose two and even suitesparseconfig should be pulled in as dependency of cholmod. However, if we need dev packages for those as well then we need to check for them.",
    "created_at": "2020-04-19T21:22:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463785",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@orlitzky](#comment%3A23):
> Looking at CVXOPT's setup.py,
> 
> https://github.com/cvxopt/cvxopt/blob/master/setup.py
> 
> I also see "amd" (sci-libs/amd) and "colamd" (sci-libs/colamd) make an appearance. I don't pretend to understand what's going on in there, but it's worth a look to see if we need to check for those libraries too.
> 

Those two and even suitesparseconfig should be pulled in as dependency of cholmod. However, if we need dev packages for those as well then we need to check for them.



---

archive/issue_comments_463786.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nYup, I can at least see `amd.h` in cvxopt sources. So we need to check dev packages for those. Haven't seen colamd, but that cannot hurt.",
    "created_at": "2020-04-19T21:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463786",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Yup, I can at least see `amd.h` in cvxopt sources. So we need to check dev packages for those. Haven't seen colamd, but that cannot hurt.



---

archive/issue_comments_463787.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\namd is a dependency of cholmod.\n\nas to the headers location, unprefixed 3-letter filenames for headers as upstream does are silly. Is Gentoo the only distro that does not prefix it?",
    "created_at": "2020-04-19T23:58:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463787",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

amd is a dependency of cholmod.

as to the headers location, unprefixed 3-letter filenames for headers as upstream does are silly. Is Gentoo the only distro that does not prefix it?



---

archive/issue_comments_463788.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0913203f95c22aec8e5c6cf63c720b347ec0eb9\"><code>f091320</code></a></td><td><code>spkg-configure for suitesparse (draft)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84d124be030037ed3e8a85ac91fd66773f6d4b68\"><code>84d124b</code></a></td><td><code>more distros info</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6d8c59a6cf91ca33115aa15f965f1324fdaf11d\"><code>e6d8c59</code></a></td><td><code>set up SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f135bff77c9443d548ca55dddd24899e513a28d\"><code>8f135bf</code></a></td><td><code>remove an old FreeBSD leftover</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18f3e9c1fc6a0175fb3cabd0eef546c3fcceafae\"><code>18f3e9c</code></a></td><td><code>tests for other libs in sparsesuite</code></td></tr></table>\n",
    "created_at": "2020-04-23T13:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463788",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0913203f95c22aec8e5c6cf63c720b347ec0eb9"><code>f091320</code></a></td><td><code>spkg-configure for suitesparse (draft)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84d124be030037ed3e8a85ac91fd66773f6d4b68"><code>84d124b</code></a></td><td><code>more distros info</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6d8c59a6cf91ca33115aa15f965f1324fdaf11d"><code>e6d8c59</code></a></td><td><code>set up SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f135bff77c9443d548ca55dddd24899e513a28d"><code>8f135bf</code></a></td><td><code>remove an old FreeBSD leftover</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18f3e9c1fc6a0175fb3cabd0eef546c3fcceafae"><code>18f3e9c</code></a></td><td><code>tests for other libs in sparsesuite</code></td></tr></table>




---

archive/issue_comments_463789.json:
```json
{
    "body": "Changed commit from **[`184b88a`](https://github.com/sagemath/sagetrac-mirror/commit/184b88ad58fd788f11f6637e613015cf90f25f87)** to **[`18f3e9c`](https://github.com/sagemath/sagetrac-mirror/commit/18f3e9c1fc6a0175fb3cabd0eef546c3fcceafae)**",
    "created_at": "2020-04-23T13:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463789",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`184b88a`](https://github.com/sagemath/sagetrac-mirror/commit/184b88ad58fd788f11f6637e613015cf90f25f87)** to **[`18f3e9c`](https://github.com/sagemath/sagetrac-mirror/commit/18f3e9c1fc6a0175fb3cabd0eef546c3fcceafae)**



---

archive/issue_comments_463790.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nrebased over 9.1.rc1 - needs review",
    "created_at": "2020-04-23T13:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463790",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

rebased over 9.1.rc1 - needs review



---

archive/issue_events_402739.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-23T13:39:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402739"
}
```



---

archive/issue_events_402740.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-23T13:39:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402740"
}
```



---

archive/issue_comments_463791.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nSorry, I've been missing trac notifications again.\n\nIf `amd.h` is used by cvxopt, we should check for it, because users will probably need to install a `-dev` package on the binary distros to get it. If we don't check here, the ./configure script might think everything's OK with only e.g. `amd` installed and not `amd-dev` until the cvxopt build system crashes much later on.\n\nI agree that not prefixing the headers upstream shows a lack of foresight, but renaming other people's headers as a workaround is a dick move. Gentoo can't prefix them for the same reason no one else should prefix them: other software needs to know where to find them. If we move the headers, every consumer of the library fails to build. Renaming the headers completely changes a package's public API. It's on the same level as changing all of a library's function names to swahili to avoid symbol collisions and then packaging it up with the same name. It can work on a binary distro, but only if you're OK with supporting only pre-built binary software forever. When *every* binary distro does it, you wind up with `n*m` different cases in the `n` packages looking for the `m` places that someone decided to put them.\n\nSlackware, nix, conda, and homebrew are also likely to have them unprefixed for that reason. Not to mention people who just go the website, download the tarball, and install to `/usr/local`.",
    "created_at": "2020-04-25T22:58:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463791",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:29" align="right">comment:29</div>

Sorry, I've been missing trac notifications again.

If `amd.h` is used by cvxopt, we should check for it, because users will probably need to install a `-dev` package on the binary distros to get it. If we don't check here, the ./configure script might think everything's OK with only e.g. `amd` installed and not `amd-dev` until the cvxopt build system crashes much later on.

I agree that not prefixing the headers upstream shows a lack of foresight, but renaming other people's headers as a workaround is a dick move. Gentoo can't prefix them for the same reason no one else should prefix them: other software needs to know where to find them. If we move the headers, every consumer of the library fails to build. Renaming the headers completely changes a package's public API. It's on the same level as changing all of a library's function names to swahili to avoid symbol collisions and then packaging it up with the same name. It can work on a binary distro, but only if you're OK with supporting only pre-built binary software forever. When *every* binary distro does it, you wind up with `n*m` different cases in the `n` packages looking for the `m` places that someone decided to put them.

Slackware, nix, conda, and homebrew are also likely to have them unprefixed for that reason. Not to mention people who just go the website, download the tarball, and install to `/usr/local`.



---

archive/issue_comments_463792.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nAm I correst that cvxopt is able to work with suitesparse headers anywhere, so it's just a matter of checking for headers at another location too, right?",
    "created_at": "2020-04-26T00:51:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463792",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:30" align="right">comment:30</div>

Am I correst that cvxopt is able to work with suitesparse headers anywhere, so it's just a matter of checking for headers at another location too, right?



---

archive/issue_comments_463793.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@dimpase](#comment%3A30):\n> Am I correst that cvxopt is able to work with suitesparse headers anywhere, so it's just a matter of checking for headers at another location too, right?\n\nRight. As `n=1` here, you can see the `1*m` cases attempted in the setup.py I linked earlier.",
    "created_at": "2020-04-26T00:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463793",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@dimpase](#comment%3A30):
> Am I correst that cvxopt is able to work with suitesparse headers anywhere, so it's just a matter of checking for headers at another location too, right?

Right. As `n=1` here, you can see the `1*m` cases attempted in the setup.py I linked earlier.



---

archive/issue_comments_463794.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01d9afb0d7cde6b205bb42edf07dfb022b75de34\"><code>01d9afb</code></a></td><td><code>spkg-configure for suitesparse (draft)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8aec53420c49c0614d480ef04fbc3d556916576f\"><code>8aec534</code></a></td><td><code>more distros info</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6b207b31db114597d68fe9e8b0c06e2299271d6\"><code>e6b207b</code></a></td><td><code>set up SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17a95e61cea2d28a8c44544e2c65e9921c560481\"><code>17a95e6</code></a></td><td><code>remove an old FreeBSD leftover</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d9d0c1c9da3430b5f3dd598d910b10c3054fac3\"><code>3d9d0c1</code></a></td><td><code>tests for other libs in sparsesuite</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bc622bf554be5f6f0f754677ce59f186762f4da\"><code>7bc622b</code></a></td><td><code>check for unprefixed header, too</code></td></tr></table>\n",
    "created_at": "2020-04-26T09:49:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463794",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01d9afb0d7cde6b205bb42edf07dfb022b75de34"><code>01d9afb</code></a></td><td><code>spkg-configure for suitesparse (draft)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8aec53420c49c0614d480ef04fbc3d556916576f"><code>8aec534</code></a></td><td><code>more distros info</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6b207b31db114597d68fe9e8b0c06e2299271d6"><code>e6b207b</code></a></td><td><code>set up SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17a95e61cea2d28a8c44544e2c65e9921c560481"><code>17a95e6</code></a></td><td><code>remove an old FreeBSD leftover</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d9d0c1c9da3430b5f3dd598d910b10c3054fac3"><code>3d9d0c1</code></a></td><td><code>tests for other libs in sparsesuite</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bc622bf554be5f6f0f754677ce59f186762f4da"><code>7bc622b</code></a></td><td><code>check for unprefixed header, too</code></td></tr></table>




---

archive/issue_comments_463795.json:
```json
{
    "body": "Changed commit from **[`18f3e9c`](https://github.com/sagemath/sagetrac-mirror/commit/18f3e9c1fc6a0175fb3cabd0eef546c3fcceafae)** to **[`7bc622b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc622bf554be5f6f0f754677ce59f186762f4da)**",
    "created_at": "2020-04-26T09:49:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463795",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`18f3e9c`](https://github.com/sagemath/sagetrac-mirror/commit/18f3e9c1fc6a0175fb3cabd0eef546c3fcceafae)** to **[`7bc622b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc622bf554be5f6f0f754677ce59f186762f4da)**



---

archive/issue_comments_463796.json:
```json
{
    "body": "Changed commit from **[`7bc622b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc622bf554be5f6f0f754677ce59f186762f4da)** to **[`b8c8308`](https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4)**",
    "created_at": "2020-04-26T09:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463796",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7bc622b`](https://github.com/sagemath/sagetrac-mirror/commit/7bc622bf554be5f6f0f754677ce59f186762f4da)** to **[`b8c8308`](https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4)**



---

archive/issue_comments_463797.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4\"><code>b8c8308</code></a></td><td><code>check for amd.h too</code></td></tr></table>\n",
    "created_at": "2020-04-26T09:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463797",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4"><code>b8c8308</code></a></td><td><code>check for amd.h too</code></td></tr></table>




---

archive/issue_comments_463798.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\ntest run here: https://github.com/dimpase/sage/actions/runs/88161668\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4\"><code>b8c8308</code></a></td><td><code>check for amd.h too</code></td></tr></table>\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4\"><code>b8c8308</code></a></td><td><code>check for amd.h too</code></td></tr></table>\n",
    "created_at": "2020-04-26T10:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463798",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

test run here: https://github.com/dimpase/sage/actions/runs/88161668

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4"><code>b8c8308</code></a></td><td><code>check for amd.h too</code></td></tr></table>

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4"><code>b8c8308</code></a></td><td><code>check for amd.h too</code></td></tr></table>




---

archive/issue_comments_463799.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-I guess that different distos use different subsets of SuiteSparse,\n+Different distos use different subsets of SuiteSparse,\n but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies),UMFRACK and suitesparseconfig.\n \n-We assume that the headers are prefixed with `suitesparse/`\n+\n``````\n",
    "created_at": "2020-04-26T10:10:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463799",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-I guess that different distos use different subsets of SuiteSparse,
+Different distos use different subsets of SuiteSparse,
 but this is needed to be done. Apparently all we need is CHOLMOD (with its dependencies),UMFRACK and suitesparseconfig.
 
-We assume that the headers are prefixed with `suitesparse/`
+
``````




---

archive/issue_comments_463800.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nMy system copy is detected now, thanks. In gentoo.txt, I think we should have only\n\n```\nsci-libs/amd sci-libs/cholmod sci-libs/suitesparseconfig sci-libs/umfpack\n```\n\nThe `sci-libs/suitesparse` in there right now is a metapackage that pulls in everything. I'm still not sure about \"colamd\", but we're safe in any case so long as it remains a dependency of cholmod.",
    "created_at": "2020-04-26T19:07:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463800",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:36" align="right">comment:36</div>

My system copy is detected now, thanks. In gentoo.txt, I think we should have only

```
sci-libs/amd sci-libs/cholmod sci-libs/suitesparseconfig sci-libs/umfpack
```

The `sci-libs/suitesparse` in there right now is a metapackage that pulls in everything. I'm still not sure about "colamd", but we're safe in any case so long as it remains a dependency of cholmod.



---

archive/issue_comments_463801.json:
```json
{
    "body": "Changed commit from **[`b8c8308`](https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4)** to **[`45d6d07`](https://github.com/sagemath/sagetrac-mirror/commit/45d6d0760d841c2b79794b696eb91f3eb46d3887)**",
    "created_at": "2020-04-27T04:53:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463801",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b8c8308`](https://github.com/sagemath/sagetrac-mirror/commit/b8c83088cff21aec5c26866435f18bf10d1300f4)** to **[`45d6d07`](https://github.com/sagemath/sagetrac-mirror/commit/45d6d0760d841c2b79794b696eb91f3eb46d3887)**



---

archive/issue_comments_463802.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45d6d0760d841c2b79794b696eb91f3eb46d3887\"><code>45d6d07</code></a></td><td><code>adjust gentoo libs list</code></td></tr></table>\n",
    "created_at": "2020-04-27T04:53:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463802",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45d6d0760d841c2b79794b696eb91f3eb46d3887"><code>45d6d07</code></a></td><td><code>adjust gentoo libs list</code></td></tr></table>




---

archive/issue_comments_463803.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI was going to test this with the suitesparse-5.4.0 in gentoo (to see if we need version bounds), but I can't figure out which part of sage (if any) actually uses suitesparse. It's listed as a standard package, so it should be used *somewhere*. Does anyone have any ideas?",
    "created_at": "2020-04-28T18:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463803",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:38" align="right">comment:38</div>

I was going to test this with the suitesparse-5.4.0 in gentoo (to see if we need version bounds), but I can't figure out which part of sage (if any) actually uses suitesparse. It's listed as a standard package, so it should be used *somewhere*. Does anyone have any ideas?



---

archive/issue_comments_463804.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nIt is exclusively a dependency of cvxopt. Nothing else uses it - although we could unbundle some bit of glpk to use it. That's about it.",
    "created_at": "2020-04-28T19:51:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463804",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:39" align="right">comment:39</div>

It is exclusively a dependency of cvxopt. Nothing else uses it - although we could unbundle some bit of glpk to use it. That's about it.



---

archive/issue_events_402741.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-04-28T21:33:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402741"
}
```



---

archive/issue_events_402742.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-04-28T21:33:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402742"
}
```



---

archive/issue_comments_463805.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@kiwifb](#comment%3A39):\n> It is exclusively a dependency of cvxopt. Nothing else uses it - although we could unbundle some bit of glpk to use it. That's about it.\n\nOh, I could have sworn that cvxopt was an optional package. That makes sense, then.\n\nThis test,\n\n```\nAC_CHECK_HEADERS([SuiteSparse_config.h amd.h],\n                 [suispa_header_found=yes])\n```\n\nis intended to set `suispa_header_found` to \"yes\" if both headers are found, but the docs for `AC_CHECK_HEADERS` say \"If action-if-found is given, it is additional shell code to execute when one of the header files is found.\"",
    "created_at": "2020-04-28T21:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463805",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@kiwifb](#comment%3A39):
> It is exclusively a dependency of cvxopt. Nothing else uses it - although we could unbundle some bit of glpk to use it. That's about it.

Oh, I could have sworn that cvxopt was an optional package. That makes sense, then.

This test,

```
AC_CHECK_HEADERS([SuiteSparse_config.h amd.h],
                 [suispa_header_found=yes])
```

is intended to set `suispa_header_found` to "yes" if both headers are found, but the docs for `AC_CHECK_HEADERS` say "If action-if-found is given, it is additional shell code to execute when one of the header files is found."



---

archive/issue_comments_463806.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nWorks for me on OS X, for what it's worth.",
    "created_at": "2020-04-28T21:39:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463806",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:41" align="right">comment:41</div>

Works for me on OS X, for what it's worth.



---

archive/issue_comments_463807.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@orlitzky](#comment%3A40):\n> Replying to [@kiwifb](#comment%3A39):\n> > It is exclusively a dependency of cvxopt. Nothing else uses it - although we could unbundle some bit of glpk to use it. That's about it.\n\n> \n> Oh, I could have sworn that cvxopt was an optional package. That makes sense, then.\n> \n> This test,\n> \n> ```\n> AC_CHECK_HEADERS([SuiteSparse_config.h amd.h],\n>                  [suispa_header_found=yes])\n> ```\n> \n> is intended to set `suispa_header_found` to \"yes\" if both headers are found, but the docs for `AC_CHECK_HEADERS` say \"If action-if-found is given, it is additional shell code to execute when one of the header files is found.\"\n\nYes, you don't want to do that. That code would be executed if either of the headers were to be found, so the variable would be defined even if one is missing. You would be better to check for `ac_cv_header_suitesparse_config_h` and `ac_cv_header_amd_h` (are those name correct?) in a shell test after the call to `AC_CHECK_HEADERS`.",
    "created_at": "2020-04-28T21:46:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463807",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@orlitzky](#comment%3A40):
> Replying to [@kiwifb](#comment%3A39):
> > It is exclusively a dependency of cvxopt. Nothing else uses it - although we could unbundle some bit of glpk to use it. That's about it.

> 
> Oh, I could have sworn that cvxopt was an optional package. That makes sense, then.
> 
> This test,
> 
> ```
> AC_CHECK_HEADERS([SuiteSparse_config.h amd.h],
>                  [suispa_header_found=yes])
> ```
> 
> is intended to set `suispa_header_found` to "yes" if both headers are found, but the docs for `AC_CHECK_HEADERS` say "If action-if-found is given, it is additional shell code to execute when one of the header files is found."

Yes, you don't want to do that. That code would be executed if either of the headers were to be found, so the variable would be defined even if one is missing. You would be better to check for `ac_cv_header_suitesparse_config_h` and `ac_cv_header_amd_h` (are those name correct?) in a shell test after the call to `AC_CHECK_HEADERS`.



---

archive/issue_comments_463808.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nAnother option is to set the \"headers found\" variable to \"yes\" by default, and then use the *action-if-not-found* branch of `AC_CHECK_HEADERS` to set it to \"no\" if some header is not found. You'd have to reset the variable between the prefixed and unprefixed checks, but it looks like it would work anyway.",
    "created_at": "2020-04-28T22:56:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463808",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:43" align="right">comment:43</div>

Another option is to set the "headers found" variable to "yes" by default, and then use the *action-if-not-found* branch of `AC_CHECK_HEADERS` to set it to "no" if some header is not found. You'd have to reset the variable between the prefixed and unprefixed checks, but it looks like it would work anyway.



---

archive/issue_comments_463809.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@orlitzky](#comment%3A43):\n> Another option is to set the \"headers found\" variable to \"yes\" by default, and then use the *action-if-not-found* branch of `AC_CHECK_HEADERS` to set it to \"no\" if some header is not found. You'd have to reset the variable between the prefixed and unprefixed checks, but it looks like it would work anyway.\n\nSounds valid.",
    "created_at": "2020-04-28T22:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463809",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@orlitzky](#comment%3A43):
> Another option is to set the "headers found" variable to "yes" by default, and then use the *action-if-not-found* branch of `AC_CHECK_HEADERS` to set it to "no" if some header is not found. You'd have to reset the variable between the prefixed and unprefixed checks, but it looks like it would work anyway.

Sounds valid.



---

archive/issue_comments_463810.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0d812f6786d1846e40257bdc61059514a2c7d1f\"><code>e0d812f</code></a></td><td><code>correct the use of AC_CHECK_HEADERS</code></td></tr></table>\n",
    "created_at": "2020-04-29T13:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463810",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0d812f6786d1846e40257bdc61059514a2c7d1f"><code>e0d812f</code></a></td><td><code>correct the use of AC_CHECK_HEADERS</code></td></tr></table>




---

archive/issue_comments_463811.json:
```json
{
    "body": "Changed commit from **[`45d6d07`](https://github.com/sagemath/sagetrac-mirror/commit/45d6d0760d841c2b79794b696eb91f3eb46d3887)** to **[`e0d812f`](https://github.com/sagemath/sagetrac-mirror/commit/e0d812f6786d1846e40257bdc61059514a2c7d1f)**",
    "created_at": "2020-04-29T13:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463811",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`45d6d07`](https://github.com/sagemath/sagetrac-mirror/commit/45d6d0760d841c2b79794b696eb91f3eb46d3887)** to **[`e0d812f`](https://github.com/sagemath/sagetrac-mirror/commit/e0d812f6786d1846e40257bdc61059514a2c7d1f)**



---

archive/issue_events_402743.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-29T13:08:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402743"
}
```



---

archive/issue_events_402744.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-04-29T13:08:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402744"
}
```



---

archive/issue_comments_463812.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nthis appears to fix the use of AC_CHECK_HEADERS - thanks for catching this.",
    "created_at": "2020-04-29T13:08:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463812",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">comment:46</div>

this appears to fix the use of AC_CHECK_HEADERS - thanks for catching this.



---

archive/issue_comments_463813.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nLooks good now. One last nitpick; you should add quotes here for the people who have spaces in their sage path:\n\n```\nif test x$SAGE_SUITESPARSE_PREFIX != x; then\n   export CVXOPT_SUITESPARSE_LIB_DIR=\"${SAGE_LOCAL}\"\n   export CVXOPT_SUITESPARSE_INC_DIR=\"${SAGE_LOCAL}/include\"\nfi\n```\n\nAnd while the two are equivalent, I think using `SAGE_SUITESPARSE_PREFIX` instead of `SAGE_LOCAL`...\n\n```\nif test \"x$SAGE_SUITESPARSE_PREFIX\" != \"x\"; then\n   export CVXOPT_SUITESPARSE_LIB_DIR=\"${SAGE_SUITESPARSE_PREFIX}\"\n   export CVXOPT_SUITESPARSE_INC_DIR=\"${SAGE_SUITESPARSE_PREFIX}/include\"\nfi\n```\n\navoids some duplication and uses the `SAGE_SUITESPARSE_PREFIX` variable the way you intended it?",
    "created_at": "2020-04-29T13:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463813",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:47" align="right">comment:47</div>

Looks good now. One last nitpick; you should add quotes here for the people who have spaces in their sage path:

```
if test x$SAGE_SUITESPARSE_PREFIX != x; then
   export CVXOPT_SUITESPARSE_LIB_DIR="${SAGE_LOCAL}"
   export CVXOPT_SUITESPARSE_INC_DIR="${SAGE_LOCAL}/include"
fi
```

And while the two are equivalent, I think using `SAGE_SUITESPARSE_PREFIX` instead of `SAGE_LOCAL`...

```
if test "x$SAGE_SUITESPARSE_PREFIX" != "x"; then
   export CVXOPT_SUITESPARSE_LIB_DIR="${SAGE_SUITESPARSE_PREFIX}"
   export CVXOPT_SUITESPARSE_INC_DIR="${SAGE_SUITESPARSE_PREFIX}/include"
fi
```

avoids some duplication and uses the `SAGE_SUITESPARSE_PREFIX` variable the way you intended it?



---

archive/issue_comments_463814.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI am not trying to compute and pass the prefix of the installation of suitesparse.\nSo it is probably a misnaming.",
    "created_at": "2020-04-29T16:08:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463814",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:48" align="right">comment:48</div>

I am not trying to compute and pass the prefix of the installation of suitesparse.
So it is probably a misnaming.



---

archive/issue_comments_463815.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a\"><code>f2cc5b4</code></a></td><td><code>added quoting, renamed SAGE_SUITESPARSE_PREFIX to <>_LOCALINSTALL</code></td></tr></table>\n",
    "created_at": "2020-04-29T18:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463815",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a"><code>f2cc5b4</code></a></td><td><code>added quoting, renamed SAGE_SUITESPARSE_PREFIX to <>_LOCALINSTALL</code></td></tr></table>




---

archive/issue_comments_463816.json:
```json
{
    "body": "Changed commit from **[`e0d812f`](https://github.com/sagemath/sagetrac-mirror/commit/e0d812f6786d1846e40257bdc61059514a2c7d1f)** to **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)**",
    "created_at": "2020-04-29T18:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463816",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e0d812f`](https://github.com/sagemath/sagetrac-mirror/commit/e0d812f6786d1846e40257bdc61059514a2c7d1f)** to **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)**



---

archive/issue_comments_463817.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@dimpase](#comment%3A48):\n> I am not trying to compute and pass the prefix of the installation of suitesparse.\n> So it is probably a misnaming.\n\nIs it just supposed to be a boolean? I guess what I'm asking is, why define `SAGE_SUITESPARSE_LOCALINSTALL` to either `$SAGE_LOCAL` or the empty string if it's only used as a flag?",
    "created_at": "2020-04-29T18:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463817",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@dimpase](#comment%3A48):
> I am not trying to compute and pass the prefix of the installation of suitesparse.
> So it is probably a misnaming.

Is it just supposed to be a boolean? I guess what I'm asking is, why define `SAGE_SUITESPARSE_LOCALINSTALL` to either `$SAGE_LOCAL` or the empty string if it's only used as a flag?



---

archive/issue_comments_463818.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nyes, it is a boolean",
    "created_at": "2020-04-29T20:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463818",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

yes, it is a boolean



---

archive/issue_comments_463819.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@dimpase](#comment%3A51):\n> yes, it is a boolean\n\nIt think it would make more sense to set it to \"yes\" rather than \"$SAGE_LOCAL\" in that case?\n\nEither way, it works fine on Gentoo with suitesparse-5.4.0. Should we merge it and cross our fingers, or run it though github first to make sure all of the other distros have usable versions of suitesparse?",
    "created_at": "2020-04-30T00:33:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463819",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@dimpase](#comment%3A51):
> yes, it is a boolean

It think it would make more sense to set it to "yes" rather than "$SAGE_LOCAL" in that case?

Either way, it works fine on Gentoo with suitesparse-5.4.0. Should we merge it and cross our fingers, or run it though github first to make sure all of the other distros have usable versions of suitesparse?



---

archive/issue_comments_463820.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI would suggest to defer this to 9.2",
    "created_at": "2020-04-30T02:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463820",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

I would suggest to defer this to 9.2



---

archive/issue_comments_463821.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@orlitzky](#comment%3A52):\n> run it though github first to make sure all of the other distros have usable versions of suitesparse?\n\nYes please",
    "created_at": "2020-04-30T02:04:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463821",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@orlitzky](#comment%3A52):
> run it though github first to make sure all of the other distros have usable versions of suitesparse?

Yes please



---

archive/issue_comments_463822.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@mkoeppe](#comment%3A54):\n> Replying to [@orlitzky](#comment%3A52):\n> > run it though github first to make sure all of the other distros have usable versions of suitesparse?\n\n> \n> Yes please\n\nI did this https://github.com/dimpase/sage/actions/runs/88161666\nbefore commits starting at [comment:45](#comment%3A45) and have not found any problems.\n(apart from the trivial absense of useful system openblas implying no suitesparse,\neither)",
    "created_at": "2020-04-30T07:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463822",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@mkoeppe](#comment%3A54):
> Replying to [@orlitzky](#comment%3A52):
> > run it though github first to make sure all of the other distros have usable versions of suitesparse?

> 
> Yes please

I did this https://github.com/dimpase/sage/actions/runs/88161666
before commits starting at [comment:45](#comment%3A45) and have not found any problems.
(apart from the trivial absense of useful system openblas implying no suitesparse,
either)



---

archive/issue_events_402745.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-04T20:06:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402745"
}
```



---

archive/issue_events_402746.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-04T20:06:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402746"
}
```



---

archive/issue_comments_463823.json:
```json
{
    "body": "Reviewer: **Michael Orlitzky**",
    "created_at": "2020-05-19T13:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463823",
    "user": "https://github.com/orlitzky"
}
```

Reviewer: **Michael Orlitzky**



---

archive/issue_comments_463824.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nThe spkg-install for cvxopt is doing some weird stuff, but I can't find any immediate problems (and don't think we need to fix them here, in any case). For example,\n\n```\nexport CVXOPT_GLPK_LIB_DIR=\"${SAGE_LOCAL}\"\nexport CVXOPT_GLPK_INC_DIR=\"${SAGE_LOCAL}/include\"\n```\n\nis unconditionally adding those two library/include paths to the command line as `-L` and `-I` flags, even when we're using system packages. This doesn't cause an immediate problem because `--with-system-foo=yes` and `--with-system-foo=force` get ignored if the foo SPKG is installed, and that's the only way the extra dirs on the command-line could cause a problem. So for example if I install the suitesparse SPKG manually and attempt to use the system suitesparse, there's no risk of the SPKG being accidentally linked into cvxopt via the lines above, because there's no way to avoid using the SPKG in favor of the system copy in the first place.\n\nThese calls to pkg-config share the same risk,\n\n```\nexport CVXOPT_GSL_LIB_DIR=\"$(pkg-config --variable=libdir gsl)\"\nexport CVXOPT_GSL_INC_DIR=\"$(pkg-config --variable=includedir gsl)\"\n```\n\nbut so long as any SPKG that is installed and provides a *.pc file *must* be used (ignoring `--with-system` flags), they won't hurt.",
    "created_at": "2020-05-19T13:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463824",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:57" align="right">comment:57</div>

The spkg-install for cvxopt is doing some weird stuff, but I can't find any immediate problems (and don't think we need to fix them here, in any case). For example,

```
export CVXOPT_GLPK_LIB_DIR="${SAGE_LOCAL}"
export CVXOPT_GLPK_INC_DIR="${SAGE_LOCAL}/include"
```

is unconditionally adding those two library/include paths to the command line as `-L` and `-I` flags, even when we're using system packages. This doesn't cause an immediate problem because `--with-system-foo=yes` and `--with-system-foo=force` get ignored if the foo SPKG is installed, and that's the only way the extra dirs on the command-line could cause a problem. So for example if I install the suitesparse SPKG manually and attempt to use the system suitesparse, there's no risk of the SPKG being accidentally linked into cvxopt via the lines above, because there's no way to avoid using the SPKG in favor of the system copy in the first place.

These calls to pkg-config share the same risk,

```
export CVXOPT_GSL_LIB_DIR="$(pkg-config --variable=libdir gsl)"
export CVXOPT_GSL_INC_DIR="$(pkg-config --variable=includedir gsl)"
```

but so long as any SPKG that is installed and provides a *.pc file *must* be used (ignoring `--with-system` flags), they won't hurt.



---

archive/issue_events_402747.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-05-19T13:45:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402747"
}
```



---

archive/issue_events_402748.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-05-19T13:45:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402748"
}
```



---

archive/issue_comments_463825.json:
```json
{
    "body": "Changed branch from **[u/dimpase/packages/suitesparseconf](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/suitesparseconf)** to **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)**",
    "created_at": "2020-05-26T21:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463825",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dimpase/packages/suitesparseconf](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/suitesparseconf)** to **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)**



---

archive/issue_events_402749.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-05-26T21:44:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402749"
}
```



---

archive/issue_events_402750.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "fbb11c3130104b1145b5eae1ea34c7a177b832be",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-05-26T21:44:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29502#event-402750"
}
```



---

archive/issue_comments_463826.json:
```json
{
    "body": "Changed commit from **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)** to none",
    "created_at": "2020-07-03T04:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463826",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`f2cc5b4`](https://github.com/sagemath/sagetrac-mirror/commit/f2cc5b457f4945d15970bf823f5046d62564522a)** to none



---

archive/issue_comments_463827.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nFollow-up: #30052 ubuntu-eoan-i386: cvxopt build fails",
    "created_at": "2020-07-03T04:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29502#issuecomment-463827",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:59" align="right">comment:59</div>

Follow-up: #30052 ubuntu-eoan-i386: cvxopt build fails
