# Issue 29935: implicitly fuzz RNG-dependent doctests with a random random seed

archive/issues_029698.json:
```json
{
    "body": "Our documentation and tests include a variety of\nexamples and tests involving randomness.\n\nThose depend on a randomness seed, and up to Sage 9.1\nthey always used the same one: 0. Thus every run\nof `sage -t` or `make [p]test[all][long]` would run\nthose \"random\" doctests deterministically.\nIn many cases, the output of those tests even relied\non that. As a result, random examples and tests\nwere actually testing that they were run non-randomly!\n\nThis is reminiscent of\nan [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n\nBased on these considerations and the\nrelated [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\nwe propose to:\n\n- allow specifying a randomness when running tests (#29962),\n- adapt tests involving randomness, making sure they\n  test mathematical functionality independent of\n  the randomness seed used to run them (see roadmap),\n- default to a random randomness seed when none is specified\n  (present ticket),\n\nthus making those tests more robust and more useful,\nby becoming more likely to reveal bugs in a variety\nof cases including corner cases.\n\nThe first step (see #29962, merged in Sage 9.2)\nadds a `--random-seed` flag to `sage -t`, allowing:\n\n```\nsage -t --long --random-seed=9876543210 src/sage/\n```\n\nStill, when no randomness seed is specified,\nthe default seed 0 is used. This means most testers\ntest with the same randomness seed, making \"random\"\ndoctests still mostly deterministic in practice.\n\nHere is a way to pick a random randomness seed\nand run tests with it (can be used to work on\nthe tickets in the roadmap):\n\n```\n$ randseed() {\n    sage -c \"import sage.misc.randstate as randstate; \\\n             randstate.set_random_seed(); \\\n             print(randstate.initial_seed())\";\n    }\n$ SEED=$(randseed)\n$ DIR=src/sage\n$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n  && ./sage -t --long --random-seed=${SEED} ${DIR}\n```\n\nOnce examples and tests involving randomness\nhave been adapted, the present ticket puts\nthe final touch by making it so that\nwhen running tests with no seed specified,\na random one will be used:\n\n```\nsage -t src/sage/all.py \nRunning doctests with ID 2020-06-23-23-19-03-8003eea5.\n...\nsage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n    [16 tests, 0.73 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.8 seconds\n    cpu time: 0.7 seconds\n    cumulative wall time: 0.7 seconds\n```\n\nBeing displayed in the output, the seed used\ncan be used again if needed:\n\n```\nsage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n```\nallowing to explore any problematic case\nrevealed by running the tests with that seed.\n\nRoadmap:\n\n- Allow fuzzing: #29962\n- Make all parts of sage ready for default fuzzing:\n  - #29945: coding\n  - #29963: geometry\n  - #29964: libs\n  - #29965: graphs\n  - #32107: groups\n  - #29967: interfaces\n  - #29968: algebras\n  - #29969: misc\n  - #29970: arith\n  - #29971: categories\n  - #29972: stats\n  - #29973: sets\n  - #29974: combinat\n  - #29975: numerical, probability\n  - #29976: matrix\n  - #29977: modular\n  - #29978: modules\n  - #29979: rings\n  - #29980: crypto\n  - #29981: documentation\n  - #29982: dynamics\n  - #29983: finance\n  - #29984: symbolic\n  - #29985: schemes\n  - #29986: plot\n  - #32188: various missed tests along the way\n- #32216: Update the developers guide for implicitly fuzzing doctests \n- Finally make fuzzing default with this ticket.\n\nFollow-up:\n\n- #32544: Meta-ticket: Fix unstable doctests detected after #29935 \n- Remove `set_random_seed` in doctests where possible.\n\nErrors discovered by this ticket:\n\n- #29936: Hyperbolic geometry bugs revealed by fuzzing\n- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n  (just a wrong doctest, will be fixed here)\n- #29954: Unstable plotting\n- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n- #29957: Bug in `ContinuedFraction` rounding\n- #29958: Too many strong articulation points\n- #29961: Random symbolic expression is completely unstable\n- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n- Index error with random derangement (fixed in #29974)\n- #31890: simplify_hypergeometric is unstable\n- #31891: `ZeroDivisonError` when creating polynomial system\n- #31892: Conic parametrization broken\n- #32075: Polynomial generic power trunk broken \n- #32083: Various errors with polybori including segmentation fault \n- #32084 `_nth_root_naive` fails for integer mod \n- #32085: Errors when computing norms of padic elements \n- #32086: apply_homography unstable for continue fraction \n- #32095: DiFUB algorithm fails on some random graph \n- #32108: Fix random tree on one or less vertices \n- #32109: Fix 0/0 in ore function field \n- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n- #32117: Random relative number field checks only irreducibility over QQ \n- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n- #32124: SL2Z.random_element unstable \n- #32125: random Ore polynomials do not respect minimum degree bound\n- #32126: padic QpLC.random_element is broken\n- #32127: gosper_iterator of continued fractions is unstable\n- #32129: sage_input is unreliable for elements of ComplexField\n- #32131: Cut width of graph with one edge incorrect\n- #32132: Wrong gyration orbit length\n- #32138: is_groebner fails over fraction fields\n- #32141: Unstable doctest involving permutation groups \n- #32169: Bug in edge disjoint spanning trees \n- #32185: Failing weak order assertion on random symbolic expression\n- #32186: Random bounded tolerance graph\n- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP\n- #32657: `plot_vector_field` unstable \n\nCC:  @kliem @orlitzky @davewittemorris @slel @mantepse\n\nKeywords: fuzz, random, seed\n\nBranch/Commit: 047379c56890113ff59c9eb59276eeca274f4b79\n\nReviewer: Michael Orlitzky\n\nAuthor: Jonathan Kliem\n\nDependencies: #32667\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29935\n\n",
    "closed_at": "2021-10-19T20:35:13Z",
    "created_at": "2020-06-22T13:02:46Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "implicitly fuzz RNG-dependent doctests with a random random seed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29935",
    "user": "https://github.com/dimpase"
}
```
Our documentation and tests include a variety of
examples and tests involving randomness.

Those depend on a randomness seed, and up to Sage 9.1
they always used the same one: 0. Thus every run
of `sage -t` or `make [p]test[all][long]` would run
those "random" doctests deterministically.
In many cases, the output of those tests even relied
on that. As a result, random examples and tests
were actually testing that they were run non-randomly!

This is reminiscent of
an [xkcd comic illustration of random number generators](https://xkcd.com/221/).

Based on these considerations and the
related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
we propose to:

- allow specifying a randomness when running tests (#29962),
- adapt tests involving randomness, making sure they
  test mathematical functionality independent of
  the randomness seed used to run them (see roadmap),
- default to a random randomness seed when none is specified
  (present ticket),

thus making those tests more robust and more useful,
by becoming more likely to reveal bugs in a variety
of cases including corner cases.

The first step (see #29962, merged in Sage 9.2)
adds a `--random-seed` flag to `sage -t`, allowing:

```
sage -t --long --random-seed=9876543210 src/sage/
```

Still, when no randomness seed is specified,
the default seed 0 is used. This means most testers
test with the same randomness seed, making "random"
doctests still mostly deterministic in practice.

Here is a way to pick a random randomness seed
and run tests with it (can be used to work on
the tickets in the roadmap):

```
$ randseed() {
    sage -c "import sage.misc.randstate as randstate; \
             randstate.set_random_seed(); \
             print(randstate.initial_seed())";
    }
$ SEED=$(randseed)
$ DIR=src/sage
$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
  && ./sage -t --long --random-seed=${SEED} ${DIR}
```

Once examples and tests involving randomness
have been adapted, the present ticket puts
the final touch by making it so that
when running tests with no seed specified,
a random one will be used:

```
sage -t src/sage/all.py 
Running doctests with ID 2020-06-23-23-19-03-8003eea5.
...
sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
    [16 tests, 0.73 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.8 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
```

Being displayed in the output, the seed used
can be used again if needed:

```
sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
```
allowing to explore any problematic case
revealed by running the tests with that seed.

Roadmap:

- Allow fuzzing: #29962
- Make all parts of sage ready for default fuzzing:
  - #29945: coding
  - #29963: geometry
  - #29964: libs
  - #29965: graphs
  - #32107: groups
  - #29967: interfaces
  - #29968: algebras
  - #29969: misc
  - #29970: arith
  - #29971: categories
  - #29972: stats
  - #29973: sets
  - #29974: combinat
  - #29975: numerical, probability
  - #29976: matrix
  - #29977: modular
  - #29978: modules
  - #29979: rings
  - #29980: crypto
  - #29981: documentation
  - #29982: dynamics
  - #29983: finance
  - #29984: symbolic
  - #29985: schemes
  - #29986: plot
  - #32188: various missed tests along the way
- #32216: Update the developers guide for implicitly fuzzing doctests 
- Finally make fuzzing default with this ticket.

Follow-up:

- #32544: Meta-ticket: Fix unstable doctests detected after #29935 
- Remove `set_random_seed` in doctests where possible.

Errors discovered by this ticket:

- #29936: Hyperbolic geometry bugs revealed by fuzzing
- #29945: Failing doctest in `src/sage/coding/linear_code.py`
  (just a wrong doctest, will be fixed here)
- #29954: Unstable plotting
- #29956: Bug in `KlyachkoBundle_class.random_deformation`
- #29957: Bug in `ContinuedFraction` rounding
- #29958: Too many strong articulation points
- #29961: Random symbolic expression is completely unstable
- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
- Index error with random derangement (fixed in #29974)
- #31890: simplify_hypergeometric is unstable
- #31891: `ZeroDivisonError` when creating polynomial system
- #31892: Conic parametrization broken
- #32075: Polynomial generic power trunk broken 
- #32083: Various errors with polybori including segmentation fault 
- #32084 `_nth_root_naive` fails for integer mod 
- #32085: Errors when computing norms of padic elements 
- #32086: apply_homography unstable for continue fraction 
- #32095: DiFUB algorithm fails on some random graph 
- #32108: Fix random tree on one or less vertices 
- #32109: Fix 0/0 in ore function field 
- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
- #32117: Random relative number field checks only irreducibility over QQ 
- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
- #32124: SL2Z.random_element unstable 
- #32125: random Ore polynomials do not respect minimum degree bound
- #32126: padic QpLC.random_element is broken
- #32127: gosper_iterator of continued fractions is unstable
- #32129: sage_input is unreliable for elements of ComplexField
- #32131: Cut width of graph with one edge incorrect
- #32132: Wrong gyration orbit length
- #32138: is_groebner fails over fraction fields
- #32141: Unstable doctest involving permutation groups 
- #32169: Bug in edge disjoint spanning trees 
- #32185: Failing weak order assertion on random symbolic expression
- #32186: Random bounded tolerance graph
- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP
- #32657: `plot_vector_field` unstable 

CC:  @kliem @orlitzky @davewittemorris @slel @mantepse

Keywords: fuzz, random, seed

Branch/Commit: 047379c56890113ff59c9eb59276eeca274f4b79

Reviewer: Michael Orlitzky

Author: Jonathan Kliem

Dependencies: #32667

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29935





---

archive/issue_comments_449427.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -6,6 +6,24 @@\n See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n for more details.\n \n+The doctest framework modification is trivial:\n+\n+```diff\n+--- a/src/sage/doctest/forker.py\n++++ b/src/sage/doctest/forker.py\n+@@ -848,7 +848,7 @@ class SageDocTestRunner(doctest.DocTestRunner, object):\n+             TestResults(failed=0, attempted=4)\n+         \"\"\"\n+         self.setters = {}\n+-        randstate.set_random_seed(0)\n++        randstate.set_random_seed()\n+         # scipy 1.18 introduced reprecation warnings on a number of things they are moving to\n+         # numpy, e.g. DeprecationWarning: scipy.array is deprecated\n+         #             and will be removed in SciPy 2.0.0, use numpy.array instead\n+```\n+\n+but many doctests need to be fixed.\n+\n Comment: 1\n \n Summary: implicitly fuzz RNG-dependent doctests\n```\n",
    "created_at": "2020-06-22T13:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449427",
    "user": "https://github.com/dimpase"
}
```

Description changed:
```diff
--- 
+++ 
@@ -6,6 +6,24 @@
 See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
 for more details.
 
+The doctest framework modification is trivial:
+
+```diff
+--- a/src/sage/doctest/forker.py
++++ b/src/sage/doctest/forker.py
+@@ -848,7 +848,7 @@ class SageDocTestRunner(doctest.DocTestRunner, object):
+             TestResults(failed=0, attempted=4)
+         """
+         self.setters = {}
+-        randstate.set_random_seed(0)
++        randstate.set_random_seed()
+         # scipy 1.18 introduced reprecation warnings on a number of things they are moving to
+         # numpy, e.g. DeprecationWarning: scipy.array is deprecated
+         #             and will be removed in SciPy 2.0.0, use numpy.array instead
+```
+
+but many doctests need to be fixed.
+
 Comment: 1
 
 Summary: implicitly fuzz RNG-dependent doctests
```




---

archive/issue_comments_449428.json:
```json
{
    "body": "<a id='comment:3'></a>Just so that we don't forget that we will have to update\n\nhttps://doc.sagemath.org/html/en/developer/coding_basics.html",
    "created_at": "2020-06-22T13:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449428",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>Just so that we don't forget that we will have to update

https://doc.sagemath.org/html/en/developer/coding_basics.html



---

archive/issue_comments_449429.json:
```json
{
    "body": "<a id='comment:5'></a>`geometry/hyperbolic_space/hyperbolic_geodesic.py` makes some claims on how good approximations work, which doesn't seem to work. I had this thing run 7 times now and not one time did all tests pass. E.g. there is one test that gives me absolute errors of `0.7` when running this in the shell, but the test claims it is below `10**-9`.\n\nThere is also #29904. Other than that the `geometry` module appears to ready.\n\nEdit: And there is some place where you need to add `set_random_seed(0)` now or similar.",
    "created_at": "2020-06-22T13:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449429",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>`geometry/hyperbolic_space/hyperbolic_geodesic.py` makes some claims on how good approximations work, which doesn't seem to work. I had this thing run 7 times now and not one time did all tests pass. E.g. there is one test that gives me absolute errors of `0.7` when running this in the shell, but the test claims it is below `10**-9`.

There is also #29904. Other than that the `geometry` module appears to ready.

Edit: And there is some place where you need to add `set_random_seed(0)` now or similar.



---

archive/issue_comments_449430.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 gh-kliem]:\n> `geometry/hyperbolic_space/hyperbolic_geodesic.py` makes some claims on how good approximations work, which doesn't seem to work. I had this thing run 7 times now and not one time did all tests pass. E.g. there is one test that gives me absolute errors of `0.7` when running this in the shell, but the test claims it is below `10**-9`.\n\n\nthis is a great example of fuzzing catching an apparent error, it seems.\n\n> \n> There is also #29904. Other than that the `geometry` module appears to ready.\n> \n> Edit: And there is some place where you need to add `set_random_seed(0)` now or similar.",
    "created_at": "2020-06-22T14:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449430",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>Replying to [comment:5 gh-kliem]:
> `geometry/hyperbolic_space/hyperbolic_geodesic.py` makes some claims on how good approximations work, which doesn't seem to work. I had this thing run 7 times now and not one time did all tests pass. E.g. there is one test that gives me absolute errors of `0.7` when running this in the shell, but the test claims it is below `10**-9`.


this is a great example of fuzzing catching an apparent error, it seems.

> 
> There is also #29904. Other than that the `geometry` module appears to ready.
> 
> Edit: And there is some place where you need to add `set_random_seed(0)` now or similar.



---

archive/issue_comments_449431.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2020-06-22T14:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449431",
    "user": "https://github.com/kliem"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_449432.json:
```json
{
    "body": "<a id='comment:8'></a>Even in the developer guide there is an example, where it is confusing:\n\n```\nsage: M = matrix.identity(3) + random_matrix(RR,3,3)/10^3\nsage: M^2 # abs tol 1e-2\n[1 0 0]\n[0 1 0]\n[0 0 1]\n```\n\nThere is no mentioning there that only one particular matrix is tested.",
    "created_at": "2020-06-22T14:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449432",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>Even in the developer guide there is an example, where it is confusing:

```
sage: M = matrix.identity(3) + random_matrix(RR,3,3)/10^3
sage: M^2 # abs tol 1e-2
[1 0 0]
[0 1 0]
[0 0 1]
```

There is no mentioning there that only one particular matrix is tested.



---

archive/issue_comments_449433.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-22T14:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449434.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:8 gh-kliem]:\n> Even in the developer guide there is an example, where it is confusing:\n> \n> \n> ```\n> sage: M = matrix.identity(3) + random_matrix(RR,3,3)/10^3\n> sage: M^2 # abs tol 1e-2\n> [1 0 0]\n> [0 1 0]\n> [0 0 1]\n> ```\n> \n> There is no mentioning there that only one particular matrix is tested.\n\n\nindeed it assumes (?) that the entries of the random matrix are small in abs value",
    "created_at": "2020-06-22T15:14:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449434",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>Replying to [comment:8 gh-kliem]:
> Even in the developer guide there is an example, where it is confusing:
> 
> 
> ```
> sage: M = matrix.identity(3) + random_matrix(RR,3,3)/10^3
> sage: M^2 # abs tol 1e-2
> [1 0 0]
> [0 1 0]
> [0 0 1]
> ```
> 
> There is no mentioning there that only one particular matrix is tested.


indeed it assumes (?) that the entries of the random matrix are small in abs value



---

archive/issue_comments_449435.json:
```json
{
    "body": "<a id='comment:12'></a>Nothing to assume there. `random_matrix(RR,3,3)` has entries between `-1` and `1`. After dividing we are good.",
    "created_at": "2020-06-22T15:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449435",
    "user": "https://github.com/kliem"
}
```

<a id='comment:12'></a>Nothing to assume there. `random_matrix(RR,3,3)` has entries between `-1` and `1`. After dividing we are good.



---

archive/issue_comments_449436.json:
```json
{
    "body": "<a id='comment:14'></a>How about making the random seed an option to `sage-runtests`. Then people can fuzz the doctests if they want.",
    "created_at": "2020-06-22T16:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449436",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>How about making the random seed an option to `sage-runtests`. Then people can fuzz the doctests if they want.



---

archive/issue_comments_449437.json:
```json
{
    "body": "<a id='comment:15'></a>Will people do that? Especially enough to find incorrect claims. If you look into #29936 we have been claiming a preciseness that is far from true. Even if you consider the relative error instead of the absolute error. fuzzed doctests would have easily detected that. Even worse. Maybe the situation was better at some point and we never caught on about the regression.",
    "created_at": "2020-06-22T16:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449437",
    "user": "https://github.com/kliem"
}
```

<a id='comment:15'></a>Will people do that? Especially enough to find incorrect claims. If you look into #29936 we have been claiming a preciseness that is far from true. Even if you consider the relative error instead of the absolute error. fuzzed doctests would have easily detected that. Even worse. Maybe the situation was better at some point and we never caught on about the regression.



---

archive/issue_comments_449438.json:
```json
{
    "body": "<a id='comment:16'></a>it is not a \"real\" (time-consuming) fuzzing, it is making the main random seed nondeterministic in tests. making it optional is akin to making tests optional.\n\nwe already found a couple of examples which show usefulness of this change in detecting bugs in Sage.",
    "created_at": "2020-06-22T16:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449438",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>it is not a "real" (time-consuming) fuzzing, it is making the main random seed nondeterministic in tests. making it optional is akin to making tests optional.

we already found a couple of examples which show usefulness of this change in detecting bugs in Sage.



---

archive/issue_comments_449439.json:
```json
{
    "body": "<a id='comment:17'></a>The option that I propose to add needs to be added in any case, so that when a failure is revealed by a random random seeds, we can reproduce the failure with that seed.",
    "created_at": "2020-06-22T16:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449439",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>The option that I propose to add needs to be added in any case, so that when a failure is revealed by a random random seeds, we can reproduce the failure with that seed.



---

archive/issue_comments_449440.json:
```json
{
    "body": "<a id='comment:18'></a>it is a good point - and the non-det. seed needs to  be logged - if this is not yet in the branch it should get there.",
    "created_at": "2020-06-22T16:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449440",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>it is a good point - and the non-det. seed needs to  be logged - if this is not yet in the branch it should get there.



---

archive/issue_comments_449441.json:
```json
{
    "body": "<a id='comment:19'></a>So I would suggest to use this ticket to introduce the option, not change the default.",
    "created_at": "2020-06-22T16:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449441",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>So I would suggest to use this ticket to introduce the option, not change the default.



---

archive/issue_comments_449442.json:
```json
{
    "body": "<a id='comment:20'></a>no, I don't agree, it makes no sense to test less if one can test more, and also not having it default would not force people to make their tests robust.",
    "created_at": "2020-06-22T16:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449442",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>no, I don't agree, it makes no sense to test less if one can test more, and also not having it default would not force people to make their tests robust.



---

archive/issue_comments_449443.json:
```json
{
    "body": "<a id='comment:21'></a>By the way I don't think most doctests have the ambition to demonstrate correctness of mathematical claims. In my opinion, if a doctest intends to do that, it should run an explicit loop of several tests. Still deterministically.",
    "created_at": "2020-06-22T16:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449443",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>By the way I don't think most doctests have the ambition to demonstrate correctness of mathematical claims. In my opinion, if a doctest intends to do that, it should run an explicit loop of several tests. Still deterministically.



---

archive/issue_comments_449444.json:
```json
{
    "body": "<a id='comment:22'></a>Why would creating the option and changing the default have to be done on the same ticket? I think it's best practices to separate the two steps on two tickets.",
    "created_at": "2020-06-22T16:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449444",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>Why would creating the option and changing the default have to be done on the same ticket? I think it's best practices to separate the two steps on two tickets.



---

archive/issue_comments_449445.json:
```json
{
    "body": "<a id='comment:23'></a>Feel free to do with the branch whatever you think is reasonable.",
    "created_at": "2020-06-22T16:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449445",
    "user": "https://github.com/kliem"
}
```

<a id='comment:23'></a>Feel free to do with the branch whatever you think is reasonable.



---

archive/issue_comments_449446.json:
```json
{
    "body": "<a id='comment:24'></a>What I think would be great if running we could run each file at some \"random\" seed, e.g.\n\n```\nsage -t src/sage/all.py \nRunning doctests with ID 2020-06-22-18-56-54-668a26f3.\nGit branch: public/29935\nUsing --optional=4ti2,bliss,build,dochtml,e_antic,flask,flask_autoindex,flask_babel,flask_oldsessions,flask_openid,flask_silk,latte_int,lidia,lrslib,memlimit,normaliz,pynormaliz,python_openid,sage,speaklater,twisted\nDoctesting 1 file.\nsage -t --warn-long 91.5 --seed 123456 src/sage/all.py\n    [16 tests, 0.76 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.8 seconds\n    cpu time: 0.8 seconds\n    cumulative wall time: 0.8 seconds\n```\n\nYou can reproduce this test with\n\n```\nsage -t --warn-long 91.5 --seed 123456 src/sage/all.py\n```\n\nIs a bit annoying, as seeds can be long though. Then whenever a bot or someone discovers a failure, you can reproduce it. At least if it really was caused by the random seed.",
    "created_at": "2020-06-22T17:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449446",
    "user": "https://github.com/kliem"
}
```

<a id='comment:24'></a>What I think would be great if running we could run each file at some "random" seed, e.g.

```
sage -t src/sage/all.py 
Running doctests with ID 2020-06-22-18-56-54-668a26f3.
Git branch: public/29935
Using --optional=4ti2,bliss,build,dochtml,e_antic,flask,flask_autoindex,flask_babel,flask_oldsessions,flask_openid,flask_silk,latte_int,lidia,lrslib,memlimit,normaliz,pynormaliz,python_openid,sage,speaklater,twisted
Doctesting 1 file.
sage -t --warn-long 91.5 --seed 123456 src/sage/all.py
    [16 tests, 0.76 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.8 seconds
    cpu time: 0.8 seconds
    cumulative wall time: 0.8 seconds
```

You can reproduce this test with

```
sage -t --warn-long 91.5 --seed 123456 src/sage/all.py
```

Is a bit annoying, as seeds can be long though. Then whenever a bot or someone discovers a failure, you can reproduce it. At least if it really was caused by the random seed.



---

archive/issue_comments_449447.json:
```json
{
    "body": "<a id='comment:25'></a>Just to weigh in:\n\n1. The default should be to use a randomly-chosen seed.\n2. Failures should be reproducible:\n   a. It should be possible to pass a seed to the test runner with e.g. `--seed`.\n   b. Any test failures should log/echo the current seed so that the failing test can be reproduced easily using the option in (2.a.).\n\nThe sooner we can push this through the better. Tests that don't work due to bugs can even be deleted and replaced with trac tickets saying \"this never worked\" IMO.",
    "created_at": "2020-06-22T17:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449447",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:25'></a>Just to weigh in:

1. The default should be to use a randomly-chosen seed.
2. Failures should be reproducible:
   a. It should be possible to pass a seed to the test runner with e.g. `--seed`.
   b. Any test failures should log/echo the current seed so that the failing test can be reproduced easily using the option in (2.a.).

The sooner we can push this through the better. Tests that don't work due to bugs can even be deleted and replaced with trac tickets saying "this never worked" IMO.



---

archive/issue_comments_449448.json:
```json
{
    "body": "<a id='comment:26'></a>With #29904 (already pulled into this branch), #29936 (not yet pulled) and \t`b2954ceea638b4510e99d90cea3f99fa9a49338` (commit from above) geometry should be ready for this.\n\nEdit: The updated branch of #29904 (not yet pulled) doesn't have `set_random_seed` anymore. But there is plenty of `set_random_seed` for cones doctests? Should I remove those as well or do we do this somewhere else?",
    "created_at": "2020-06-22T18:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449448",
    "user": "https://github.com/kliem"
}
```

<a id='comment:26'></a>With #29904 (already pulled into this branch), #29936 (not yet pulled) and 	`b2954ceea638b4510e99d90cea3f99fa9a49338` (commit from above) geometry should be ready for this.

Edit: The updated branch of #29904 (not yet pulled) doesn't have `set_random_seed` anymore. But there is plenty of `set_random_seed` for cones doctests? Should I remove those as well or do we do this somewhere else?



---

archive/issue_comments_449449.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-22T19:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449449",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449450.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:26 gh-kliem]:\n> there is plenty of `set_random_seed` for cones doctests? Should I remove those as well or do we do this somewhere else?\n\n\nNot on the same ticket.",
    "created_at": "2020-06-22T19:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449450",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>Replying to [comment:26 gh-kliem]:
> there is plenty of `set_random_seed` for cones doctests? Should I remove those as well or do we do this somewhere else?


Not on the same ticket.



---

archive/issue_comments_449451.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-22T19:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449452.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-22T19:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449453.json:
```json
{
    "body": "<a id='comment:31'></a>Please tell me, if I should open seperate tickets for those or something else. I just felt like starting with those. I'm done for today.",
    "created_at": "2020-06-22T19:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449453",
    "user": "https://github.com/kliem"
}
```

<a id='comment:31'></a>Please tell me, if I should open seperate tickets for those or something else. I just felt like starting with those. I'm done for today.



---

archive/issue_comments_449454.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:25 mjo]:\n> 1. The default should be to use a randomly-chosen seed.\n> 2. Failures should be reproducible:\n>    a. It should be possible to pass a seed to the test runner with e.g. `--seed`.\n>    b. Any test failures should log/echo the current seed so that the failing test can be reproduced easily using the option in (2.a.).\n\n\n+1.\n\nAlso note that Sage still uses a verbatim copy of the Python-2 version of the `Random` module during doctesting, which was necessary in order to obtain consistent results between Python 2 and 3. This is why the bug in #29550 went unnoticed, for example. Now that support for Python 2 has been removed, we should switch to the Python 3 version of `Random`. This will require updating lots of doctests, but I assume this ticket here will simplify this if it makes doctests less dependent on the seed/RNG.",
    "created_at": "2020-06-23T19:02:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449454",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:32'></a>Replying to [comment:25 mjo]:
> 1. The default should be to use a randomly-chosen seed.
> 2. Failures should be reproducible:
>    a. It should be possible to pass a seed to the test runner with e.g. `--seed`.
>    b. Any test failures should log/echo the current seed so that the failing test can be reproduced easily using the option in (2.a.).


+1.

Also note that Sage still uses a verbatim copy of the Python-2 version of the `Random` module during doctesting, which was necessary in order to obtain consistent results between Python 2 and 3. This is why the bug in #29550 went unnoticed, for example. Now that support for Python 2 has been removed, we should switch to the Python 3 version of `Random`. This will require updating lots of doctests, but I assume this ticket here will simplify this if it makes doctests less dependent on the seed/RNG.



---

archive/issue_comments_449455.json:
```json
{
    "body": "<a id='comment:33'></a>Apparently `LinearCodeSyndromeDecoder.decode_to_code` is broken.\n\nSee #29945.",
    "created_at": "2020-06-23T19:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449455",
    "user": "https://github.com/kliem"
}
```

<a id='comment:33'></a>Apparently `LinearCodeSyndromeDecoder.decode_to_code` is broken.

See #29945.



---

archive/issue_comments_449456.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-23T19:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449457.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-23T21:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449457",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449458.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,36 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-23T21:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449458",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,36 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py 
 
 Comment: 1
 
```




---

archive/issue_comments_449459.json:
```json
{
    "body": "<a id='comment:37'></a>I specified `random_seed` to distinguish from `--randorder=SEED`. If after `--randorder=SEED` the next option is `--seed=SEED` that sounds a bit weird to me. Although `random_seed` is not much better.",
    "created_at": "2020-06-23T21:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449459",
    "user": "https://github.com/kliem"
}
```

<a id='comment:37'></a>I specified `random_seed` to distinguish from `--randorder=SEED`. If after `--randorder=SEED` the next option is `--seed=SEED` that sounds a bit weird to me. Although `random_seed` is not much better.



---

archive/issue_comments_449460.json:
```json
{
    "body": "<a id='comment:38'></a>Standard  bracked lyndon words are set up incorrectly. I don't know if that should be consider a bug:\n\n```\nsage: SBLW33 = StandardBracketedLyndonWords(3,3)\nsage: TestSuite(SBLW33).run()\nFailure in _test_an_element:\nTraceback (most recent call last):\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/sage_unittest.py\", line 296, in run\n    test_method(tester=tester)\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/categories/sets_cat.py\", line 1093, in _test_an_element\n    tester.assertTrue(an_element in self, \"self.an_element() is not in self\")\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py\", line 692, in assertTrue\n    raise self.failureException(msg)\nAssertionError: self.an_element() is not in self\n------------------------------------------------------------\nFailure in _test_enumerated_set_contains:\nTraceback (most recent call last):\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/sage_unittest.py\", line 296, in run\n    test_method(tester=tester)\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/categories/enumerated_sets.py\", line 945, in _test_enumerated_set_contains\n    tester.assertIn(w, self)\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py\", line 1106, in assertIn\n    self.fail(self._formatMessage(msg, standardMsg))\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py\", line 680, in fail\n    raise self.failureException(msg)\nAssertionError: [1, [1, 2]] not found in Standard bracketed Lyndon words from an alphabet of size 3 of length 3\n------------------------------------------------------------\nFailure in _test_some_elements:\nTraceback (most recent call last):\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/sage_unittest.py\", line 296, in run\n    test_method(tester=tester)\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/categories/sets_cat.py\", line 1385, in _test_some_elements\n    \"the object %s in self.some_elements() is not in self\")%(x,))\n  File \"/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py\", line 692, in assertTrue\n    raise self.failureException(msg)\nAssertionError: the object [1, [1, 2]] in self.some_elements() is not in self\n------------------------------------------------------------\nThe following tests failed: _test_an_element, _test_enumerated_set_contains, _test_some_elements\n```",
    "created_at": "2020-06-24T08:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449460",
    "user": "https://github.com/kliem"
}
```

<a id='comment:38'></a>Standard  bracked lyndon words are set up incorrectly. I don't know if that should be consider a bug:

```
sage: SBLW33 = StandardBracketedLyndonWords(3,3)
sage: TestSuite(SBLW33).run()
Failure in _test_an_element:
Traceback (most recent call last):
  File "/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/sage_unittest.py", line 296, in run
    test_method(tester=tester)
  File "/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/categories/sets_cat.py", line 1093, in _test_an_element
    tester.assertTrue(an_element in self, "self.an_element() is not in self")
  File "/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py", line 692, in assertTrue
    raise self.failureException(msg)
AssertionError: self.an_element() is not in self
------------------------------------------------------------
Failure in _test_enumerated_set_contains:
Traceback (most recent call last):
  File "/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/sage_unittest.py", line 296, in run
    test_method(tester=tester)
  File "/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/categories/enumerated_sets.py", line 945, in _test_enumerated_set_contains
    tester.assertIn(w, self)
  File "/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py", line 1106, in assertIn
    self.fail(self._formatMessage(msg, standardMsg))
  File "/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py", line 680, in fail
    raise self.failureException(msg)
AssertionError: [1, [1, 2]] not found in Standard bracketed Lyndon words from an alphabet of size 3 of length 3
------------------------------------------------------------
Failure in _test_some_elements:
Traceback (most recent call last):
  File "/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/misc/sage_unittest.py", line 296, in run
    test_method(tester=tester)
  File "/home/jonathan/Applications/sage/local/lib/python3.7/site-packages/sage/categories/sets_cat.py", line 1385, in _test_some_elements
    "the object %s in self.some_elements() is not in self")%(x,))
  File "/home/jonathan/Applications/sage/local/lib/python3.7/unittest/case.py", line 692, in assertTrue
    raise self.failureException(msg)
AssertionError: the object [1, [1, 2]] in self.some_elements() is not in self
------------------------------------------------------------
The following tests failed: _test_an_element, _test_enumerated_set_contains, _test_some_elements
```



---

archive/issue_comments_449461.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T09:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449462.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T09:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449462",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449463.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,37 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T12:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449463",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,37 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
 
 Comment: 1
 
```




---

archive/issue_comments_449464.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T12:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449464",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449465.json:
```json
{
    "body": "<a id='comment:43'></a>In `src/sage/plot/multigraphics.py` is a doctest that fails with the precicion:\n\n```\n1294             sage: g1 = plot(sin(x), (x, -pi, pi))\n1295             sage: g2 = circle((0,1), 1.)\n1296             sage: G = graphics_array([g1, g2])\n1297             sage: G.position(0)  # tol 1.0e-13\n1298             (0.023437500000000003,\n1299              0.03415488992713045,\n1300              0.4627803348994754,\n1301              0.9345951100728696)\n1302             sage: G.position(1)  # tol 1.0e-13\n1303             (0.5136230468749999,\n1304              0.19293222169724827,\n1305              0.46278033489947534,\n1306              0.617040446532634)\n```\nwhen running on `set_random_seed(151058820726654196682836430928254760259)`. The precision is somewhere around `1e-3` then. Is this a bug?",
    "created_at": "2020-06-24T13:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449465",
    "user": "https://github.com/kliem"
}
```

<a id='comment:43'></a>In `src/sage/plot/multigraphics.py` is a doctest that fails with the precicion:

```
1294             sage: g1 = plot(sin(x), (x, -pi, pi))
1295             sage: g2 = circle((0,1), 1.)
1296             sage: G = graphics_array([g1, g2])
1297             sage: G.position(0)  # tol 1.0e-13
1298             (0.023437500000000003,
1299              0.03415488992713045,
1300              0.4627803348994754,
1301              0.9345951100728696)
1302             sage: G.position(1)  # tol 1.0e-13
1303             (0.5136230468749999,
1304              0.19293222169724827,
1305              0.46278033489947534,
1306              0.617040446532634)
```
when running on `set_random_seed(151058820726654196682836430928254760259)`. The precision is somewhere around `1e-3` then. Is this a bug?



---

archive/issue_comments_449466.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,38 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T13:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449466",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,38 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation 
 
 Comment: 1
 
```




---

archive/issue_comments_449467.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,39 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T14:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449467",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,39 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding 
 
 Comment: 1
 
```




---

archive/issue_comments_449468.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,40 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T15:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449468",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,40 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points 
 
 Comment: 1
 
```




---

archive/issue_comments_449469.json:
```json
{
    "body": "<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T15:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449470.json:
```json
{
    "body": "<a id='comment:48'></a>It may be too late for this, but I would suggest a staged approach:\n\n- ticket 1: implement optional random seed but don't make it the default\n- tickets 2-n: fix doctests when using random seeds in various parts of the Sage library\n- ticket n+1: make random seed standard, if that is what people think should be done\n\nDoing everything all at once is likely to lead to a patch bomb, which will lead to merge conflicts and in general be hard to deal with.",
    "created_at": "2020-06-24T16:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449470",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:48'></a>It may be too late for this, but I would suggest a staged approach:

- ticket 1: implement optional random seed but don't make it the default
- tickets 2-n: fix doctests when using random seeds in various parts of the Sage library
- ticket n+1: make random seed standard, if that is what people think should be done

Doing everything all at once is likely to lead to a patch bomb, which will lead to merge conflicts and in general be hard to deal with.



---

archive/issue_comments_449471.json:
```json
{
    "body": "<a id='comment:49'></a>There is a reason that I have the fixes grouped by parts of sage. So that isn't spoiled yet.\n\nThat completely makes sense. We still need the last ticket to have the bots test everything.",
    "created_at": "2020-06-24T18:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449471",
    "user": "https://github.com/kliem"
}
```

<a id='comment:49'></a>There is a reason that I have the fixes grouped by parts of sage. So that isn't spoiled yet.

That completely makes sense. We still need the last ticket to have the bots test everything.



---

archive/issue_comments_449472.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,41 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T18:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449472",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,41 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449473.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T19:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449474.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,46 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Finally make fuzzing default with this ticket.\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T19:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449474",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,46 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Finally make fuzzing default with this ticket.
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449475.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T19:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449475",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449476.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,46 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Finally make fuzzing default with this ticket.\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T19:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449476",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,46 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random_seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Finally make fuzzing default with this ticket.
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449477.json:
```json
{
    "body": "<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-24T19:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449478.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,51 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29963: geometry\n+- Finally make fuzzing default with this ticket.\n+\n+Follow up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T20:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449478",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,51 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29963: geometry
+- Finally make fuzzing default with this ticket.
+
+Follow up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449479.json:
```json
{
    "body": "<a id='comment:56'></a>New commits:",
    "created_at": "2020-06-24T20:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449479",
    "user": "https://github.com/kliem"
}
```

<a id='comment:56'></a>New commits:



---

archive/issue_comments_449480.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,74 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945 coding\n+  - #29963 geometry\n+  - #29964 libs\n+  - #29965 graphs\n+  - #29967 interfaces\n+  - #29968 algebras\n+  - #29969 misc\n+  - #29970 arith\n+  - #29971 categories\n+  - #29972 stats\n+  - #29973 sets\n+  - #29974 combinat\n+  - #29975 numerical, probability\n+  - #29976 matrix\n+  - #29977 modular\n+  - #29978 modules\n+  - #29979 rings\n+  - #29980 crypto\n+  - #29981 documentation\n+  - #29982 dynamics\n+  - #29983 finance\n+  - #29984 symbolic\n+  - #29985 schemes\n+  - #29986 plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T22:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449480",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,74 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945 coding
+  - #29963 geometry
+  - #29964 libs
+  - #29965 graphs
+  - #29967 interfaces
+  - #29968 algebras
+  - #29969 misc
+  - #29970 arith
+  - #29971 categories
+  - #29972 stats
+  - #29973 sets
+  - #29974 combinat
+  - #29975 numerical, probability
+  - #29976 matrix
+  - #29977 modular
+  - #29978 modules
+  - #29979 rings
+  - #29980 crypto
+  - #29981 documentation
+  - #29982 dynamics
+  - #29983 finance
+  - #29984 symbolic
+  - #29985 schemes
+  - #29986 plot
+- Finally make fuzzing default with this ticket.
+
+Follow up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449481.json:
```json
{
    "body": "<a id='comment:58'></a>We had a little discussion on #29971, how we treat doctests as\n\n```\nsage: C = FiniteEnumeratedSets().example()\nsage: C.random_element()\n1\n```\n\nIf we tag this as `# random` and maybe test instead containment in `C`, the doctest we will essentially remove the doctest and add another. Is this what we want?\n\nMatthias Koeppe suggested inventing a new tag maybe `# random-seed=0`. If we implicitly fuzz all doctests this would only be tested if we run the test block twice?!\n\nI think we should agree on a something here. Depending on the agreement it needs to be taken care of with #29962 already.\n\nIMO tests as `C.random_element()` should run at least once with fuzzing (with checking that the object is consistent). We can run it twice to obtain our old test, but I would appreciate some help with that.",
    "created_at": "2020-06-29T08:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449481",
    "user": "https://github.com/kliem"
}
```

<a id='comment:58'></a>We had a little discussion on #29971, how we treat doctests as

```
sage: C = FiniteEnumeratedSets().example()
sage: C.random_element()
1
```

If we tag this as `# random` and maybe test instead containment in `C`, the doctest we will essentially remove the doctest and add another. Is this what we want?

Matthias Koeppe suggested inventing a new tag maybe `# random-seed=0`. If we implicitly fuzz all doctests this would only be tested if we run the test block twice?!

I think we should agree on a something here. Depending on the agreement it needs to be taken care of with #29962 already.

IMO tests as `C.random_element()` should run at least once with fuzzing (with checking that the object is consistent). We can run it twice to obtain our old test, but I would appreciate some help with that.



---

archive/issue_comments_449482.json:
```json
{
    "body": "<a id='comment:59'></a>This will do the job, and doesn't depend on the literal output of the random function:\n\n```\nsage: C = FiniteEnumeratedSets().example()\nsage: C.random_element() in C\nTrue\n```",
    "created_at": "2020-06-29T11:46:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449482",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:59'></a>This will do the job, and doesn't depend on the literal output of the random function:

```
sage: C = FiniteEnumeratedSets().example()
sage: C.random_element() in C
True
```



---

archive/issue_comments_449483.json:
```json
{
    "body": "<a id='comment:60'></a>In principal I agree.\n\nI prefer\n\n```\nsage: C = FiniteEnumeratedSets().example()\nsage: n = C.random_element(); n  # random\n1\nsage: n in C\nTrue\n```\nas this makes it a bit easier for the user to see, what will/might happen. But that is only minor.\n\nHowever, I just noticed, that there are problems with that approach. The representation of those random things will never be checked. In principal (almost) all random events should be reproducible with some random seed (doesn't work for e.g. hashing). By tagging something as `# random`, we might document nonsense or outdated information and no one will catch on.\n\nE.g. in #29981 I fixed a documentation mistake along the way: Solve a linear equation system with `A\\v` with `A` a random matrix. `A` should be non-singular of course, which was never thought of because the doctest is only tested for one matrix, which happens to be non-singular. In #29981, `A` is defined as `A = random_matrix(QQ, 3, algorithm='unimodular')`. However, I forgot to update the representation of `A` to some unimodular matrix and the doctests never caught on.\n\nNow if you tag something as `# random-seed=0` and we find some way to test this (both seed 0 and different), it would mean that the printed representations stay up to date and consistent and it is also tested, if those thing work for \"random\" input.\n\nI found many examples where functions where tested assuming random seed 0. One could make use of the double testing framework:\n\n```\ndef foo(y):\n   r\"\"\"\n   EXAMPLES::\n\n      sage: M = random(); M  # random-seed=0\n      <some random input>\n      sage: N = foo(M); N  # random-seed=0\n      <some random output>\n      sage: check_for_consistency(M, N)\n   \"\"\"\n   return _foo(y)\n```\nIt is still checked, that `foo` works exactly for some example that hopefully was verified by someone. But it is also checked, that the method in principal works on \"random\" input and that the output appears to be correct.",
    "created_at": "2020-06-29T12:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449483",
    "user": "https://github.com/kliem"
}
```

<a id='comment:60'></a>In principal I agree.

I prefer

```
sage: C = FiniteEnumeratedSets().example()
sage: n = C.random_element(); n  # random
1
sage: n in C
True
```
as this makes it a bit easier for the user to see, what will/might happen. But that is only minor.

However, I just noticed, that there are problems with that approach. The representation of those random things will never be checked. In principal (almost) all random events should be reproducible with some random seed (doesn't work for e.g. hashing). By tagging something as `# random`, we might document nonsense or outdated information and no one will catch on.

E.g. in #29981 I fixed a documentation mistake along the way: Solve a linear equation system with `A\v` with `A` a random matrix. `A` should be non-singular of course, which was never thought of because the doctest is only tested for one matrix, which happens to be non-singular. In #29981, `A` is defined as `A = random_matrix(QQ, 3, algorithm='unimodular')`. However, I forgot to update the representation of `A` to some unimodular matrix and the doctests never caught on.

Now if you tag something as `# random-seed=0` and we find some way to test this (both seed 0 and different), it would mean that the printed representations stay up to date and consistent and it is also tested, if those thing work for "random" input.

I found many examples where functions where tested assuming random seed 0. One could make use of the double testing framework:

```
def foo(y):
   r"""
   EXAMPLES::

      sage: M = random(); M  # random-seed=0
      <some random input>
      sage: N = foo(M); N  # random-seed=0
      <some random output>
      sage: check_for_consistency(M, N)
   """
   return _foo(y)
```
It is still checked, that `foo` works exactly for some example that hopefully was verified by someone. But it is also checked, that the method in principal works on "random" input and that the output appears to be correct.



---

archive/issue_comments_449484.json:
```json
{
    "body": "<a id='comment:61'></a>If we want to check the printed/string representation of something, can't we just... check it? In other words, instead of\n\n```\nsage: C = FiniteEnumeratedSets().example()\nsage: C.random_element()\n1\n```\n\nwe could do\n\n```\nsage: C = FiniteEnumeratedSets().example()\nsage: C.random_element() in C\nTrue\nsage: C[0]\n1\n```\n\nThis has the (big, in my opinion) added benefit of actually being a runnable example. If a user runs\n\n```\nsage: C = FiniteEnumeratedSets().example()\nsage: n = C.random_element(); n  # random\n```\n\nthen he's not going to see what the documentation says he should see, because `# random` does nothing on the command-line.",
    "created_at": "2020-06-29T17:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449484",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:61'></a>If we want to check the printed/string representation of something, can't we just... check it? In other words, instead of

```
sage: C = FiniteEnumeratedSets().example()
sage: C.random_element()
1
```

we could do

```
sage: C = FiniteEnumeratedSets().example()
sage: C.random_element() in C
True
sage: C[0]
1
```

This has the (big, in my opinion) added benefit of actually being a runnable example. If a user runs

```
sage: C = FiniteEnumeratedSets().example()
sage: n = C.random_element(); n  # random
```

then he's not going to see what the documentation says he should see, because `# random` does nothing on the command-line.



---

archive/issue_comments_449485.json:
```json
{
    "body": "<a id='comment:62'></a>IMO, it is not necessary to test the printing of random elements, as the repr of those elements is already tested elsewhere. We do not make any promises about the precise elements that are returned with a seed of 0, so we should not bake that into the doctests. As we cannot test the randomness, we can only test that `random_element` returns an element of the parent. The following check could be used for that:\n\n```\nsage: C.random_element().parent() is C\n```\nUnlike `__contains__`, this does not implicitly coerce the element into `C`.",
    "created_at": "2020-06-29T17:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449485",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:62'></a>IMO, it is not necessary to test the printing of random elements, as the repr of those elements is already tested elsewhere. We do not make any promises about the precise elements that are returned with a seed of 0, so we should not bake that into the doctests. As we cannot test the randomness, we can only test that `random_element` returns an element of the parent. The following check could be used for that:

```
sage: C.random_element().parent() is C
```
Unlike `__contains__`, this does not implicitly coerce the element into `C`.



---

archive/issue_comments_449486.json:
```json
{
    "body": "<a id='comment:63'></a>Replying to [comment:62 gh-mwageringel]:\n> IMO, it is not necessary to test the printing of random elements, as the repr of those elements is already tested elsewhere. We do not make any promises about the precise elements that are returned with a seed of 0, so we should not bake that into the doctests. As we cannot test the randomness, we can only test that `random_element` returns an element of the parent. The following check could be used for that:\n> \n> ```\n> sage: C.random_element().parent() is C\n> ```\n> Unlike `__contains__`, this does not implicitly coerce the element into `C`.\n\n\nSounds good to me.",
    "created_at": "2020-06-29T18:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449486",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:63'></a>Replying to [comment:62 gh-mwageringel]:
> IMO, it is not necessary to test the printing of random elements, as the repr of those elements is already tested elsewhere. We do not make any promises about the precise elements that are returned with a seed of 0, so we should not bake that into the doctests. As we cannot test the randomness, we can only test that `random_element` returns an element of the parent. The following check could be used for that:
> 
> ```
> sage: C.random_element().parent() is C
> ```
> Unlike `__contains__`, this does not implicitly coerce the element into `C`.


Sounds good to me.



---

archive/issue_comments_449487.json:
```json
{
    "body": "<a id='comment:64'></a>Replying to [comment:60 gh-kliem]:\n> {{{\n\nSounds good to me. As for the documentation of `random_element`, I don't think a user cares about the precise value of `set_random_seed(0); C.random_element()`.\n\nTwo more cases that I would like to discuss.\n\n- Basically from comment:60. How do we deal with something like this:\n\n```\ndef foo(y):\n   r\"\"\"\n   EXAMPLES::\n\n      sage: M = random(); M\n      <some random input>\n      sage: foo(M)\n      <some random output>\n   \"\"\"\n```\n  It appears to me that there are many examples, where someone did not write down a concrete element to doctest. I would propose having two doctests, if possible:\n- Explicitly obtain the old test.\n- Have a \"random\" test with a consistency check. (Even without a consistency check, it's probably worth checking that the function terminates without an error usually.)\n- The other one is a concrete example from #29981 (linear algrebra tutorial). The original test is\n\n```\n    sage: A=random_matrix(QQ,3)\n    sage: v=vector([2,3,1])\n    sage: A,v\n    (\n    [ 0 -1  1]\n    [-1 -1 -1]\n    [ 0  2  2], (2, 3, 1)\n    )\n    sage: x=A\\v; x\n    (-7/2, -3/4, 5/4)\n    sage: A*x\n    (2, 3, 1)\n```\n  As mentioned already, this does not work. I see basically two ways of fixing this. One is to explicitly write down `A`. The other one is similar to what I did. Use a correct random approach (e.g. random unimodular) and check that indeed `A*x == v`. Optionally one can print `x` and `A` and tag this as random. To be honest, I don't see how a user would profit from the printing. What a 3 by 3 matrix looks like should be clear by then.",
    "created_at": "2020-06-29T19:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449487",
    "user": "https://github.com/kliem"
}
```

<a id='comment:64'></a>Replying to [comment:60 gh-kliem]:
> {{{

Sounds good to me. As for the documentation of `random_element`, I don't think a user cares about the precise value of `set_random_seed(0); C.random_element()`.

Two more cases that I would like to discuss.

- Basically from comment:60. How do we deal with something like this:

```
def foo(y):
   r"""
   EXAMPLES::

      sage: M = random(); M
      <some random input>
      sage: foo(M)
      <some random output>
   """
```
  It appears to me that there are many examples, where someone did not write down a concrete element to doctest. I would propose having two doctests, if possible:
- Explicitly obtain the old test.
- Have a "random" test with a consistency check. (Even without a consistency check, it's probably worth checking that the function terminates without an error usually.)
- The other one is a concrete example from #29981 (linear algrebra tutorial). The original test is

```
    sage: A=random_matrix(QQ,3)
    sage: v=vector([2,3,1])
    sage: A,v
    (
    [ 0 -1  1]
    [-1 -1 -1]
    [ 0  2  2], (2, 3, 1)
    )
    sage: x=A\v; x
    (-7/2, -3/4, 5/4)
    sage: A*x
    (2, 3, 1)
```
  As mentioned already, this does not work. I see basically two ways of fixing this. One is to explicitly write down `A`. The other one is similar to what I did. Use a correct random approach (e.g. random unimodular) and check that indeed `A*x == v`. Optionally one can print `x` and `A` and tag this as random. To be honest, I don't see how a user would profit from the printing. What a 3 by 3 matrix looks like should be clear by then.



---

archive/issue_comments_449488.json:
```json
{
    "body": "<a id='comment:65'></a>Replying to [comment:64 gh-kliem]:\n> \n> - Basically from comment:60. How do we deal with something like this:\n> \n> ```\n> def foo(y):\n>    r\"\"\"\n>    EXAMPLES::\n> \n>       sage: M = random(); M\n>       <some random input>\n>       sage: foo(M)\n>       <some random output>\n>    \"\"\"\n> ```\n\n\nIf the point isn't to demonstrate the `random()` function, then the \"random\" element can just be replaced with whatever it winds up with now (i.e. the fixed element you get with a seed of zero).\nThe `TESTS` block can contain some truly random test of a property that the output from `foo()` should satisfy, like\n\n```\nsage: foo(random()) in RR\nTrue\n```\n\n\n> - The other one is a concrete example from #29981 (linear algrebra tutorial). The original test is\n> \n> ```\n>     sage: A=random_matrix(QQ,3)\n>     sage: v=vector([2,3,1])\n>     sage: A,v\n>     (\n>     [ 0 -1  1]\n>     [-1 -1 -1]\n>     [ 0  2  2], (2, 3, 1)\n>     )\n>     sage: x=A\\v; x\n>     (-7/2, -3/4, 5/4)\n>     sage: A*x\n>     (2, 3, 1)\n> ```\n\n\nHow about...\n\n```\nsage: A = random_matrix(QQ,3)\nsage: while not A.is_invertible():\n....:     A = random_matrix(QQ,3)\n....:     \nsage: v=vector([2,3,1])\nsage: x=A\\v\nsage: A*x - v == 0\nTrue\n```",
    "created_at": "2020-06-29T19:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449488",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:65'></a>Replying to [comment:64 gh-kliem]:
> 
> - Basically from comment:60. How do we deal with something like this:
> 
> ```
> def foo(y):
>    r"""
>    EXAMPLES::
> 
>       sage: M = random(); M
>       <some random input>
>       sage: foo(M)
>       <some random output>
>    """
> ```


If the point isn't to demonstrate the `random()` function, then the "random" element can just be replaced with whatever it winds up with now (i.e. the fixed element you get with a seed of zero).
The `TESTS` block can contain some truly random test of a property that the output from `foo()` should satisfy, like

```
sage: foo(random()) in RR
True
```


> - The other one is a concrete example from #29981 (linear algrebra tutorial). The original test is
> 
> ```
>     sage: A=random_matrix(QQ,3)
>     sage: v=vector([2,3,1])
>     sage: A,v
>     (
>     [ 0 -1  1]
>     [-1 -1 -1]
>     [ 0  2  2], (2, 3, 1)
>     )
>     sage: x=A\v; x
>     (-7/2, -3/4, 5/4)
>     sage: A*x
>     (2, 3, 1)
> ```


How about...

```
sage: A = random_matrix(QQ,3)
sage: while not A.is_invertible():
....:     A = random_matrix(QQ,3)
....:     
sage: v=vector([2,3,1])
sage: x=A\v
sage: A*x - v == 0
True
```



---

archive/issue_comments_449489.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,75 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945 coding\n+  - #29963 geometry\n+  - #29964 libs\n+  - #29965 graphs\n+  - #29967 interfaces\n+  - #29968 algebras\n+  - #29969 misc\n+  - #29970 arith\n+  - #29971 categories\n+  - #29972 stats\n+  - #29973 sets\n+  - #29974 combinat\n+  - #29975 numerical, probability\n+  - #29976 matrix\n+  - #29977 modular\n+  - #29978 modules\n+  - #29979 rings\n+  - #29980 crypto\n+  - #29981 documentation\n+  - #29982 dynamics\n+  - #29983 finance\n+  - #29984 symbolic\n+  - #29985 schemes\n+  - #29986 plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29939: Fix precicion for hyperbolic geodesic\n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder \n \n Comment: 1\n \n```\n",
    "created_at": "2020-07-02T11:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449489",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,75 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945 coding
+  - #29963 geometry
+  - #29964 libs
+  - #29965 graphs
+  - #29967 interfaces
+  - #29968 algebras
+  - #29969 misc
+  - #29970 arith
+  - #29971 categories
+  - #29972 stats
+  - #29973 sets
+  - #29974 combinat
+  - #29975 numerical, probability
+  - #29976 matrix
+  - #29977 modular
+  - #29978 modules
+  - #29979 rings
+  - #29980 crypto
+  - #29981 documentation
+  - #29982 dynamics
+  - #29983 finance
+  - #29984 symbolic
+  - #29985 schemes
+  - #29986 plot
+- Finally make fuzzing default with this ticket.
+
+Follow up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29939: Fix precicion for hyperbolic geodesic
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder 
 
 Comment: 1
 
```




---

archive/issue_comments_449490.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:65 mjo]:\n> Replying to [comment:64 gh-kliem]:\n> > \n> > - Basically from comment:60. How do we deal with something like this:\n> > \n> > ```\n> > def foo(y):\n> >    r\"\"\"\n> >    EXAMPLES::\n> > \n> >       sage: M = random(); M\n> >       <some random input>\n> >       sage: foo(M)\n> >       <some random output>\n> >    \"\"\"\n> > ```\n\n> \n> If the point isn't to demonstrate the `random()` function, then the \"random\" element can just be replaced with whatever it winds up with now (i.e. the fixed element you get with a seed of zero).\n> The `TESTS` block can contain some truly random test of a property that the output from `foo()` should satisfy, like\n> \n> \n> ```\n> sage: foo(random()) in RR\n> True\n> ```\n> \n> \n> > - The other one is a concrete example from #29981 (linear algrebra tutorial). The original test is\n> > \n> > ```\n> >     sage: A=random_matrix(QQ,3)\n> >     sage: v=vector([2,3,1])\n> >     sage: A,v\n> >     (\n> >     [ 0 -1  1]\n> >     [-1 -1 -1]\n> >     [ 0  2  2], (2, 3, 1)\n> >     )\n> >     sage: x=A\\v; x\n> >     (-7/2, -3/4, 5/4)\n> >     sage: A*x\n> >     (2, 3, 1)\n> > ```\n\n> \n> How about...\n> \n> \n> ```\n> sage: A = random_matrix(QQ,3)\n> sage: while not A.is_invertible():\n> ....:     A = random_matrix(QQ,3)\n> ....:     \n> sage: v=vector([2,3,1])\n> sage: x=A\\v\n> sage: A*x - v == 0\n> True\n> ```\n\n\nSounds reasonable to me. I will adhere to those suggestions.",
    "created_at": "2020-07-02T11:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449490",
    "user": "https://github.com/kliem"
}
```

<a id='comment:67'></a>Replying to [comment:65 mjo]:
> Replying to [comment:64 gh-kliem]:
> > 
> > - Basically from comment:60. How do we deal with something like this:
> > 
> > ```
> > def foo(y):
> >    r"""
> >    EXAMPLES::
> > 
> >       sage: M = random(); M
> >       <some random input>
> >       sage: foo(M)
> >       <some random output>
> >    """
> > ```

> 
> If the point isn't to demonstrate the `random()` function, then the "random" element can just be replaced with whatever it winds up with now (i.e. the fixed element you get with a seed of zero).
> The `TESTS` block can contain some truly random test of a property that the output from `foo()` should satisfy, like
> 
> 
> ```
> sage: foo(random()) in RR
> True
> ```
> 
> 
> > - The other one is a concrete example from #29981 (linear algrebra tutorial). The original test is
> > 
> > ```
> >     sage: A=random_matrix(QQ,3)
> >     sage: v=vector([2,3,1])
> >     sage: A,v
> >     (
> >     [ 0 -1  1]
> >     [-1 -1 -1]
> >     [ 0  2  2], (2, 3, 1)
> >     )
> >     sage: x=A\v; x
> >     (-7/2, -3/4, 5/4)
> >     sage: A*x
> >     (2, 3, 1)
> > ```

> 
> How about...
> 
> 
> ```
> sage: A = random_matrix(QQ,3)
> sage: while not A.is_invertible():
> ....:     A = random_matrix(QQ,3)
> ....:     
> sage: v=vector([2,3,1])
> sage: x=A\v
> sage: A*x - v == 0
> True
> ```


Sounds reasonable to me. I will adhere to those suggestions.



---

archive/issue_comments_449491.json:
```json
{
    "body": "<a id='comment:68'></a>New commits:",
    "created_at": "2020-07-11T07:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449491",
    "user": "https://github.com/kliem"
}
```

<a id='comment:68'></a>New commits:



---

archive/issue_comments_449492.json:
```json
{
    "body": "<a id='comment:69'></a>Maybe it makes sense to restrict the size of the random seed, so that one can still read the output of doctesting.",
    "created_at": "2020-07-11T07:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449492",
    "user": "https://github.com/kliem"
}
```

<a id='comment:69'></a>Maybe it makes sense to restrict the size of the random seed, so that one can still read the output of doctesting.



---

archive/issue_comments_449493.json:
```json
{
    "body": "<a id='comment:70'></a>Replying to [comment:69 gh-kliem]:\n> Maybe it makes sense to restrict the size of the random seed, so that one can still read the output of doctesting.\n\n\nit's not clear to me what you mean here.",
    "created_at": "2020-07-11T07:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449493",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:70'></a>Replying to [comment:69 gh-kliem]:
> Maybe it makes sense to restrict the size of the random seed, so that one can still read the output of doctesting.


it's not clear to me what you mean here.



---

archive/issue_comments_449494.json:
```json
{
    "body": "<a id='comment:71'></a>\n```\nsage -t src/sage/all.py \nRunning doctests with ID 2020-06-23-23-19-03-8003eea5.\n...\nsage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n    [16 tests, 0.73 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.8 seconds\n    cpu time: 0.7 seconds\n    cumulative wall time: 0.7 seconds\n```\n\nCurrently this output is the plan. This might be very annoying for patchbots and so on. If we instead restrict to fewer digits, we will still test a reasonable amount of different inputs and you can still read this line (even if working on a non-huge screen).",
    "created_at": "2020-07-11T07:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449494",
    "user": "https://github.com/kliem"
}
```

<a id='comment:71'></a>
```
sage -t src/sage/all.py 
Running doctests with ID 2020-06-23-23-19-03-8003eea5.
...
sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
    [16 tests, 0.73 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.8 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
```

Currently this output is the plan. This might be very annoying for patchbots and so on. If we instead restrict to fewer digits, we will still test a reasonable amount of different inputs and you can still read this line (even if working on a non-huge screen).



---

archive/issue_comments_449495.json:
```json
{
    "body": "<a id='comment:72'></a>I think it is ok - compare this with very long lists of optional packages which are there sometimes.",
    "created_at": "2020-07-11T07:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449495",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:72'></a>I think it is ok - compare this with very long lists of optional packages which are there sometimes.



---

archive/issue_comments_449496.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,75 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945 coding\n+  - #29963 geometry\n+  - #29964 libs\n+  - #29965 graphs\n+  - #29967 interfaces\n+  - #29968 algebras\n+  - #29969 misc\n+  - #29970 arith\n+  - #29971 categories\n+  - #29972 stats\n+  - #29973 sets\n+  - #29974 combinat\n+  - #29975 numerical, probability\n+  - #29976 matrix\n+  - #29977 modular\n+  - #29978 modules\n+  - #29979 rings\n+  - #29980 crypto\n+  - #29981 documentation\n+  - #29982 dynamics\n+  - #29983 finance\n+  - #29984 symbolic\n+  - #29985 schemes\n+  - #29986 plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936 Sign error in hyperbolic geodesic \n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder \n \n Comment: 1\n \n```\n",
    "created_at": "2020-07-13T09:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449496",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,75 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945 coding
+  - #29963 geometry
+  - #29964 libs
+  - #29965 graphs
+  - #29967 interfaces
+  - #29968 algebras
+  - #29969 misc
+  - #29970 arith
+  - #29971 categories
+  - #29972 stats
+  - #29973 sets
+  - #29974 combinat
+  - #29975 numerical, probability
+  - #29976 matrix
+  - #29977 modular
+  - #29978 modules
+  - #29979 rings
+  - #29980 crypto
+  - #29981 documentation
+  - #29982 dynamics
+  - #29983 finance
+  - #29984 symbolic
+  - #29985 schemes
+  - #29986 plot
+- Finally make fuzzing default with this ticket.
+
+Follow up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936 Sign error in hyperbolic geodesic 
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder 
 
 Comment: 1
 
```




---

archive/issue_comments_449497.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,76 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945 coding\n+  - #29963 geometry\n+  - #29936 Sign error in hyperbolic geodesic \n+  - #29964 libs\n+  - #29965 graphs\n+  - #29967 interfaces\n+  - #29968 algebras\n+  - #29969 misc\n+  - #29970 arith\n+  - #29971 categories\n+  - #29972 stats\n+  - #29973 sets\n+  - #29974 combinat\n+  - #29975 numerical, probability\n+  - #29976 matrix\n+  - #29977 modular\n+  - #29978 modules\n+  - #29979 rings\n+  - #29980 crypto\n+  - #29981 documentation\n+  - #29982 dynamics\n+  - #29983 finance\n+  - #29984 symbolic\n+  - #29985 schemes\n+  - #29986 plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936 Sign error in hyperbolic geodesic \n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder \n \n Comment: 1\n \n```\n",
    "created_at": "2020-08-14T13:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449497",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,76 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945 coding
+  - #29963 geometry
+  - #29936 Sign error in hyperbolic geodesic 
+  - #29964 libs
+  - #29965 graphs
+  - #29967 interfaces
+  - #29968 algebras
+  - #29969 misc
+  - #29970 arith
+  - #29971 categories
+  - #29972 stats
+  - #29973 sets
+  - #29974 combinat
+  - #29975 numerical, probability
+  - #29976 matrix
+  - #29977 modular
+  - #29978 modules
+  - #29979 rings
+  - #29980 crypto
+  - #29981 documentation
+  - #29982 dynamics
+  - #29983 finance
+  - #29984 symbolic
+  - #29985 schemes
+  - #29986 plot
+- Finally make fuzzing default with this ticket.
+
+Follow up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936 Sign error in hyperbolic geodesic 
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder 
 
 Comment: 1
 
```




---

archive/issue_comments_449498.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,77 @@\n+currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, this would make\n+these tests more robust.\n+\n+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+for more details.\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945 coding\n+  - #29963 geometry\n+  - #29936 Sign error in hyperbolic geodesic \n+  - #29964 libs\n+  - #29965 graphs\n+  - #29967 interfaces\n+  - #29968 algebras\n+  - #29969 misc\n+  - #29970 arith\n+  - #29971 categories\n+  - #29972 stats\n+  - #29973 sets\n+  - #29974 combinat\n+  - #29975 numerical, probability\n+  - #29976 matrix\n+  - #29977 modular\n+  - #29978 modules\n+  - #29979 rings\n+  - #29980 crypto\n+  - #29981 documentation\n+  - #29982 dynamics\n+  - #29983 finance\n+  - #29984 symbolic\n+  - #29985 schemes\n+  - #29986 plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936 Sign error in hyperbolic geodesic \n+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in KlyachkoBundle_class.random_deformation\n+- #29957: Bug in ContinuedFraction rounding\n+- #29958: Too many strong articulation points\n+- #29961: random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n \n Comment: 1\n \n```\n",
    "created_at": "2020-08-15T07:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449498",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,77 @@
+currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, this would make
+these tests more robust.
+
+See  this thread: https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+for more details.
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945 coding
+  - #29963 geometry
+  - #29936 Sign error in hyperbolic geodesic 
+  - #29964 libs
+  - #29965 graphs
+  - #29967 interfaces
+  - #29968 algebras
+  - #29969 misc
+  - #29970 arith
+  - #29971 categories
+  - #29972 stats
+  - #29973 sets
+  - #29974 combinat
+  - #29975 numerical, probability
+  - #29976 matrix
+  - #29977 modular
+  - #29978 modules
+  - #29979 rings
+  - #29980 crypto
+  - #29981 documentation
+  - #29982 dynamics
+  - #29983 finance
+  - #29984 symbolic
+  - #29985 schemes
+  - #29986 plot
+- Finally make fuzzing default with this ticket.
+
+Follow up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936 Sign error in hyperbolic geodesic 
+- #29945: Failing doctest in src/sage/coding/linear_code.py (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in KlyachkoBundle_class.random_deformation
+- #29957: Bug in ContinuedFraction rounding
+- #29958: Too many strong articulation points
+- #29961: random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
 
 Comment: 1
 
```




---

archive/issue_comments_449499.json:
```json
{
    "body": "<a id='comment:77'></a>See #29962#comment:19",
    "created_at": "2020-08-24T06:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449499",
    "user": "https://github.com/kliem"
}
```

<a id='comment:77'></a>See #29962#comment:19



---

archive/issue_events_076796.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29935#event-76796"
}
```



---

archive/issue_comments_449500.json:
```json
{
    "body": "<a id='comment:80'></a>Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-27T02:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449500",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:80'></a>Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_076797.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-27T02:13:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29935#event-76797"
}
```



---

archive/issue_events_076798.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-27T02:13:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29935#event-76798"
}
```



---

archive/issue_comments_449501.json:
```json
{
    "body": "<a id='comment:81'></a>Marking this as a meta-ticket.",
    "created_at": "2021-04-29T22:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449501",
    "user": "https://github.com/slel"
}
```

<a id='comment:81'></a>Marking this as a meta-ticket.



---

archive/issue_comments_449502.json:
```json
{
    "body": "Changing keywords from \"\" to \"fuzz, random, seed\".",
    "created_at": "2021-04-29T22:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449502",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "fuzz, random, seed".



---

archive/issue_comments_449503.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,76 @@\n+Currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, thus making those tests more robust and more useful.\n+\n+See  this sage-devel thread for more details:\n+\n+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n \n Comment: 1\n \n```\n",
    "created_at": "2021-04-29T22:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449503",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,76 @@
+Currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, thus making those tests more robust and more useful.
+
+See  this sage-devel thread for more details:
+
+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
 
 Comment: 1
 
```




---

archive/issue_comments_449504.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,77 @@\n+Currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, thus making those tests more robust and more useful.\n+\n+See  this sage-devel thread for more details:\n+\n+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-01T08:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449504",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,77 @@
+Currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, thus making those tests more robust and more useful.
+
+See  this sage-devel thread for more details:
+
+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449505.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,78 @@\n+Currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, thus making those tests more robust and more useful.\n+\n+See  this sage-devel thread for more details:\n+\n+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable \n+- #31891: ZeroDivisonError when creating polynomial system \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-01T09:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449505",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,78 @@
+Currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, thus making those tests more robust and more useful.
+
+See  this sage-devel thread for more details:
+
+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable 
+- #31891: ZeroDivisonError when creating polynomial system 
 
 Comment: 1
 
```




---

archive/issue_comments_449506.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,79 @@\n+Currently doctests are run completely deterministically, as they always start from the same random seed.\n \n+We propose to start from a \"random\" random seed, thus making those tests more robust and more useful.\n+\n+See  this sage-devel thread for more details:\n+\n+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ\n+\n+If not set, a random seed will be chosen for doctesting:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+This can then be reproduced with\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+\n+Schedule:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable \n+- #31891: ZeroDivisonError when creating polynomial system \n+- #31892: Conic parametrization broken \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-01T13:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449506",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,79 @@
+Currently doctests are run completely deterministically, as they always start from the same random seed.
 
+We propose to start from a "random" random seed, thus making those tests more robust and more useful.
+
+See  this sage-devel thread for more details:
+
+-  https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ
+
+If not set, a random seed will be chosen for doctesting:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+This can then be reproduced with
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+
+Schedule:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py` (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable 
+- #31891: ZeroDivisonError when creating polynomial system 
+- #31892: Conic parametrization broken 
 
 Comment: 1
 
```




---

archive/issue_comments_449507.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,138 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n+\n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n \n \n Comment: 1\n```\n",
    "created_at": "2021-06-08T10:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449507",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,138 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
+
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
 
 
 Comment: 1
```




---

archive/issue_comments_449508.json:
```json
{
    "body": "<a id='comment:85'></a>Expanding the ticket description, adding a code snippet giving\na way to set a random randomness seed, which I find useful\nfor working on the (few remaining) dependencies of this ticket.",
    "created_at": "2021-06-08T10:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449508",
    "user": "https://github.com/slel"
}
```

<a id='comment:85'></a>Expanding the ticket description, adding a code snippet giving
a way to set a random randomness seed, which I find useful
for working on the (few remaining) dependencies of this ticket.



---

archive/issue_comments_449509.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,139 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-28T15:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449509",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,139 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
 
 Comment: 1
 
```




---

archive/issue_comments_449510.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,140 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-29T08:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449510",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,140 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
 
 Comment: 1
 
```




---

archive/issue_comments_449511.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,141 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-29T16:30:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449511",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,141 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
 
 Comment: 1
 
```




---

archive/issue_comments_449512.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,142 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-29T16:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449512",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,142 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
 
 Comment: 1
 
```




---

archive/issue_comments_449513.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,143 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-29T18:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449513",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,143 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
 
 Comment: 1
 
```




---

archive/issue_comments_449514.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-01T12:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449514",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_449515.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-07-01T16:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449515",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_449516.json:
```json
{
    "body": "<a id='comment:93'></a>A couple of new tests fail yet.",
    "created_at": "2021-07-01T16:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449516",
    "user": "https://github.com/kliem"
}
```

<a id='comment:93'></a>A couple of new tests fail yet.



---

archive/issue_comments_449517.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,144 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-01T18:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449517",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,144 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
 
 Comment: 1
 
```




---

archive/issue_comments_449518.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,145 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-03T08:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449518",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,145 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
 
 Comment: 1
 
```




---

archive/issue_comments_449519.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,146 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-03T08:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449519",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,146 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
 
 Comment: 1
 
```




---

archive/issue_comments_449520.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,147 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-03T08:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449520",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,147 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
 
 Comment: 1
 
```




---

archive/issue_comments_449521.json:
```json
{
    "body": "<a id='comment:3'></a>Last 10 new commits:",
    "created_at": "2021-07-03T09:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449521",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>Last 10 new commits:



---

archive/issue_comments_449522.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-03T09:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449522",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449523.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,148 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-03T12:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449523",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,148 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
 
 Comment: 1
 
```




---

archive/issue_comments_449524.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,149 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-03T20:54:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449524",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,149 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
 
 Comment: 1
 
```




---

archive/issue_comments_449525.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,150 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-03T21:15:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449525",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,150 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
 
 Comment: 1
 
```




---

archive/issue_comments_449526.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-03T21:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449526",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449527.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,151 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-04T09:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449527",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,151 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449528.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,152 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n+\n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n \n \n Comment: 1\n```\n",
    "created_at": "2021-07-04T10:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449528",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,152 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
+
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
 
 
 Comment: 1
```




---

archive/issue_comments_449529.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,153 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n+\n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n \n \n Comment: 1\n```\n",
    "created_at": "2021-07-04T14:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449529",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,153 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
+
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
 
 
 Comment: 1
```




---

archive/issue_comments_449530.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,154 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n+\n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n \n \n Comment: 1\n```\n",
    "created_at": "2021-07-04T15:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449530",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,154 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
+
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
 
 
 Comment: 1
```




---

archive/issue_comments_449531.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,155 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n+\n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n \n \n Comment: 1\n```\n",
    "created_at": "2021-07-04T18:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449531",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,155 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
+
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
 
 
 Comment: 1
```




---

archive/issue_comments_449532.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,156 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-05T08:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449532",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,156 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect 
 
 Comment: 1
 
```




---

archive/issue_comments_449533.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,157 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-05T08:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449533",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,157 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length 
 
 Comment: 1
 
```




---

archive/issue_comments_449534.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-05T08:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449535.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-07-05T08:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_449536.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-07-05T08:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_449537.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-05T09:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449538.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-05T09:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449539.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-05T17:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449540.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,159 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+ \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-05T20:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449540",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,159 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+ 
 
 Comment: 1
 
```




---

archive/issue_comments_449541.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,159 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-06T05:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449541",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,159 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
 
 Comment: 1
 
```




---

archive/issue_comments_449542.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-06T07:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449543.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-06T15:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449544.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-06T16:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449544",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_449545.json:
```json
{
    "body": "<a id='comment:8'></a>This is getting more and more stable.\n\nI can now run it on 8 random seeds without failure (or without failure that doesn't appear on random seed 0). There are probably still failing examples, but its getting to a point, where it won't prevent patchbots from working and it's not too much of a burden to report failures because of this.",
    "created_at": "2021-07-06T16:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449545",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>This is getting more and more stable.

I can now run it on 8 random seeds without failure (or without failure that doesn't appear on random seed 0). There are probably still failing examples, but its getting to a point, where it won't prevent patchbots from working and it's not too much of a burden to report failures because of this.



---

archive/issue_comments_449546.json:
```json
{
    "body": "<a id='comment:9'></a>We should also remember to try the optional tests at some point, but I assume the majority of them does not use randomness.",
    "created_at": "2021-07-06T19:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449546",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:9'></a>We should also remember to try the optional tests at some point, but I assume the majority of them does not use randomness.



---

archive/issue_comments_449547.json:
```json
{
    "body": "<a id='comment:0'></a>Right, I forgot about the optional packages.\n\nI hope this helps a bit:\n\nhttps://github.com/kliem/sage/pull/48/checks",
    "created_at": "2021-07-06T19:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449547",
    "user": "https://github.com/kliem"
}
```

<a id='comment:0'></a>Right, I forgot about the optional packages.

I hope this helps a bit:

https://github.com/kliem/sage/pull/48/checks



---

archive/issue_comments_449548.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,160 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n+- #32169: Bug in edge disjoint spanning trees \n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-09T18:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449548",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,160 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
+- #32169: Bug in edge disjoint spanning trees 
 
 Comment: 1
 
```




---

archive/issue_comments_449549.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T19:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449549",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449550.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-12T06:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449550",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449551.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-12T15:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449551",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449552.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-12T15:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449552",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449553.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,163 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n+- #32169: Bug in edge disjoint spanning trees \n+- #32185: Failing weak order assertion on random symbolic expression\n+- #32186: Random bounded tolerance graph\n+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP\n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-12T15:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449553",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,163 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
+- #32169: Bug in edge disjoint spanning trees 
+- #32185: Failing weak order assertion on random symbolic expression
+- #32186: Random bounded tolerance graph
+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP
 
 Comment: 1
 
```




---

archive/issue_comments_449554.json:
```json
{
    "body": "<a id='comment:8'></a>I outsourced many of the small fixes to #32188, to make review here easier.",
    "created_at": "2021-07-12T15:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449554",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>I outsourced many of the small fixes to #32188, to make review here easier.



---

archive/issue_comments_449555.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,164 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+  - #32188: various missed tests along the way\n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n+- #32169: Bug in edge disjoint spanning trees \n+- #32185: Failing weak order assertion on random symbolic expression\n+- #32186: Random bounded tolerance graph\n+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP\n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-12T15:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449555",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,164 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+  - #32188: various missed tests along the way
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
+- #32169: Bug in edge disjoint spanning trees 
+- #32185: Failing weak order assertion on random symbolic expression
+- #32186: Random bounded tolerance graph
+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP
 
 Comment: 1
 
```




---

archive/issue_comments_449556.json:
```json
{
    "body": "<a id='comment:9'></a>Note that doctesting with a fixed seed is publicly documented behaviour in sage. Quoting from [Developer guide](https://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests):\n\n    ''However, most functions generating pseudorandom output do not need this tag since the doctesting framework guarantees the state of the pseudorandom number generators (PRNGs) used in Sage for a given doctest.\n''\n\nI would think that tests explicitly relying on this behaviour are rather weak and I wouldn't mind changing this \"policy\", but we shouldn't forget to update the developer guide as well.",
    "created_at": "2021-07-16T16:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449556",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:9'></a>Note that doctesting with a fixed seed is publicly documented behaviour in sage. Quoting from [Developer guide](https://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests):

    ''However, most functions generating pseudorandom output do not need this tag since the doctesting framework guarantees the state of the pseudorandom number generators (PRNGs) used in Sage for a given doctest.
''

I would think that tests explicitly relying on this behaviour are rather weak and I wouldn't mind changing this "policy", but we shouldn't forget to update the developer guide as well.



---

archive/issue_comments_449557.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,165 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+  - #32188: various missed tests along the way\n+- #32216: Update the developers guide for implicitly fuzzing doctests \n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n+- #32169: Bug in edge disjoint spanning trees \n+- #32185: Failing weak order assertion on random symbolic expression\n+- #32186: Random bounded tolerance graph\n+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP\n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-16T19:59:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449557",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,165 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+  - #32188: various missed tests along the way
+- #32216: Update the developers guide for implicitly fuzzing doctests 
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
+- #32169: Bug in edge disjoint spanning trees 
+- #32185: Failing weak order assertion on random symbolic expression
+- #32186: Random bounded tolerance graph
+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP
 
 Comment: 1
 
```




---

archive/issue_comments_449558.json:
```json
{
    "body": "<a id='comment:141'></a>Replying to [comment:139 nbruin]:\n> Note that doctesting with a fixed seed is publicly documented behaviour in sage. Quoting from [Developer guide](https://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests):\n> \n>     ''However, most functions generating pseudorandom output do not need this tag since the doctesting framework guarantees the state of the pseudorandom number generators (PRNGs) used in Sage for a given doctest.\n> ''\n> \n> I would think that tests explicitly relying on this behaviour are rather weak and I wouldn't mind changing this \"policy\", but we shouldn't forget to update the developer guide as well.\n\n\nThanks for the pointer. This is now #32216.",
    "created_at": "2021-07-16T20:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449558",
    "user": "https://github.com/kliem"
}
```

<a id='comment:141'></a>Replying to [comment:139 nbruin]:
> Note that doctesting with a fixed seed is publicly documented behaviour in sage. Quoting from [Developer guide](https://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests):
> 
>     ''However, most functions generating pseudorandom output do not need this tag since the doctesting framework guarantees the state of the pseudorandom number generators (PRNGs) used in Sage for a given doctest.
> ''
> 
> I would think that tests explicitly relying on this behaviour are rather weak and I wouldn't mind changing this "policy", but we shouldn't forget to update the developer guide as well.


Thanks for the pointer. This is now #32216.



---

archive/issue_events_076799.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29935#event-76799"
}
```



---

archive/issue_events_076800.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29935#event-76800"
}
```



---

archive/issue_comments_449559.json:
```json
{
    "body": "<a id='comment:3'></a>I'll leave #32169 for later and would just like to get this in.\n\n---\nNew commits:",
    "created_at": "2021-09-16T08:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449559",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>I'll leave #32169 for later and would just like to get this in.

---
New commits:



---

archive/issue_comments_449560.json:
```json
{
    "body": "<a id='comment:4'></a>I think this,\n\n```patch\n         ....:     n = ZZ.random_element().abs() + 5\n+        ....:     if n > 5000:  # avoid timeouts\n+        ....:         continue\n```\n\ncan be simplified by passing `(5,5001)` as the bound to `ZZ.random_element()`, without abs.\n\nAnd the fix for this has already been merged:\n\n```patch\n+        sage: test_symbolic_expression_order(10000)  # long time,  # not tested, known bug (see :trac:`32185`)\n```",
    "created_at": "2021-09-16T13:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449560",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:4'></a>I think this,

```patch
         ....:     n = ZZ.random_element().abs() + 5
+        ....:     if n > 5000:  # avoid timeouts
+        ....:         continue
```

can be simplified by passing `(5,5001)` as the bound to `ZZ.random_element()`, without abs.

And the fix for this has already been merged:

```patch
+        sage: test_symbolic_expression_order(10000)  # long time,  # not tested, known bug (see :trac:`32185`)
```



---

archive/issue_comments_449561.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-16T14:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449561",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449562.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-16T15:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449563.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-17T09:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449564.json:
```json
{
    "body": "<a id='comment:8'></a>Looks OK now, but there's really no way to be 100% certain. We will probably discover a few instances where e.g. a ptestlong happens to generate four relatively hard problems at once, leading to intermittent timeouts. But regardless, I think the sooner we can get this in, the better. I started some GH actions for added test cycles.",
    "created_at": "2021-09-19T10:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449564",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:8'></a>Looks OK now, but there's really no way to be 100% certain. We will probably discover a few instances where e.g. a ptestlong happens to generate four relatively hard problems at once, leading to intermittent timeouts. But regardless, I think the sooner we can get this in, the better. I started some GH actions for added test cycles.



---

archive/issue_comments_449565.json:
```json
{
    "body": "<a id='comment:149'></a>Replying to [comment:148 mjo]:\n> ... I think the sooner we can get this in, the better. ...\n\n\n+1",
    "created_at": "2021-09-20T01:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449565",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:149'></a>Replying to [comment:148 mjo]:
> ... I think the sooner we can get this in, the better. ...


+1



---

archive/issue_comments_449566.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-20T07:11:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449567.json:
```json
{
    "body": "<a id='comment:1'></a>I also think this is ready. It is rather stable now.\n\nWe should open a new (meta?) ticket, to collect all those failures, I think.",
    "created_at": "2021-09-20T07:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449567",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>I also think this is ready. It is rather stable now.

We should open a new (meta?) ticket, to collect all those failures, I think.



---

archive/issue_comments_449568.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-21T00:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449568",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_449569.json:
```json
{
    "body": "<a id='comment:2'></a>Let's just do it before beta2 happens.\n\nThanks for all your work on this, I never had the courage to try it myself.",
    "created_at": "2021-09-21T00:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449569",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:2'></a>Let's just do it before beta2 happens.

Thanks for all your work on this, I never had the courage to try it myself.



---

archive/issue_comments_449570.json:
```json
{
    "body": "<a id='comment:3'></a>Thank you.",
    "created_at": "2021-09-21T04:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449570",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>Thank you.



---

archive/issue_comments_449571.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,166 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+  - #32188: various missed tests along the way\n+- #32216: Update the developers guide for implicitly fuzzing doctests \n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- #32544: Meta-ticket: Fix unstable doctests detected after #29935 \n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n+- #32169: Bug in edge disjoint spanning trees \n+- #32185: Failing weak order assertion on random symbolic expression\n+- #32186: Random bounded tolerance graph\n+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP\n \n Comment: 1\n \n```\n",
    "created_at": "2021-09-21T06:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449571",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,166 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+  - #32188: various missed tests along the way
+- #32216: Update the developers guide for implicitly fuzzing doctests 
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- #32544: Meta-ticket: Fix unstable doctests detected after #29935 
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
+- #32169: Bug in edge disjoint spanning trees 
+- #32185: Failing weak order assertion on random symbolic expression
+- #32186: Random bounded tolerance graph
+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP
 
 Comment: 1
 
```




---

archive/issue_comments_449572.json:
```json
{
    "body": "<a id='comment:4'></a>I created #32544 for the errors appearing now that this is positively reviewed.\nThere already is a ticket on it (#32543).",
    "created_at": "2021-09-21T06:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449572",
    "user": "https://github.com/kliem"
}
```

<a id='comment:4'></a>I created #32544 for the errors appearing now that this is positively reviewed.
There already is a ticket on it (#32543).



---

archive/issue_comments_449573.json:
```json
{
    "body": "<a id='comment:5'></a>\n```\nsage -t --long --warn-long 45.3 --random-seed=58740356065403116296055203326248101103 src/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 23499, in sage.graphs.generic_graph.GenericGraph.edge_polytope\nFailed example:\n    P.is_combinatorially_isomorphic(product(components))\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   1 of  24 in sage.graphs.generic_graph.GenericGraph.edge_polytope\n    [3598 tests, 1 failure, 22.29 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 45.3 --random-seed=58740356065403116296055203326248101103 src/sage/graphs/generic_graph.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2021-10-02T14:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449573",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
```
sage -t --long --warn-long 45.3 --random-seed=58740356065403116296055203326248101103 src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 23499, in sage.graphs.generic_graph.GenericGraph.edge_polytope
Failed example:
    P.is_combinatorially_isomorphic(product(components))
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   1 of  24 in sage.graphs.generic_graph.GenericGraph.edge_polytope
    [3598 tests, 1 failure, 22.29 s]
----------------------------------------------------------------------
sage -t --long --warn-long 45.3 --random-seed=58740356065403116296055203326248101103 src/sage/graphs/generic_graph.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_449574.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-10-02T14:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449574",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_449575.json:
```json
{
    "body": "<a id='comment:6'></a>So this ticket got rejected because it detected my own mistake in #32498. That's fair I guess.\n\nWhat I claimed is complete nonsense, but it did work for seed 0 I guess. The (symmetric) edge polytope of a graph is of course the **join** of the (symmetric) edge polytopes of the connecting compoments.",
    "created_at": "2021-10-02T19:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449575",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>So this ticket got rejected because it detected my own mistake in #32498. That's fair I guess.

What I claimed is complete nonsense, but it did work for seed 0 I guess. The (symmetric) edge polytope of a graph is of course the **join** of the (symmetric) edge polytopes of the connecting compoments.



---

archive/issue_comments_449576.json:
```json
{
    "body": "<a id='comment:7'></a>No, that is not the join, it is the subdirect sum. It is really worth reading the definitions once in a while...",
    "created_at": "2021-10-02T19:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449576",
    "user": "https://github.com/kliem"
}
```

<a id='comment:7'></a>No, that is not the join, it is the subdirect sum. It is really worth reading the definitions once in a while...



---

archive/issue_comments_449577.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-02T19:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449578.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-10-02T19:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449578",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_449579.json:
```json
{
    "body": "<a id='comment:9'></a>`@`Martin Rubey: Can you please check the fix of #32498, everything else should still be fine.",
    "created_at": "2021-10-02T19:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449579",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>`@`Martin Rubey: Can you please check the fix of #32498, everything else should still be fine.



---

archive/issue_comments_449580.json:
```json
{
    "body": "<a id='comment:0'></a>I'm afraid there is a `MemoryError` reported by the bot.  I'll check whether it is reproducible.",
    "created_at": "2021-10-04T08:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449580",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:0'></a>I'm afraid there is a `MemoryError` reported by the bot.  I'll check whether it is reproducible.



---

archive/issue_comments_449581.json:
```json
{
    "body": "<a id='comment:1'></a>\n```\nsage -t --random-seed=306431873350217748498615142104107167501 src/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 23601, in sage.graphs.generic_graph.GenericGraph.symmetric_edge_polytope\nFailed example:\n    P.is_combinatorially_isomorphic(P1.subdirect_sum(P2))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generic_graph.GenericGraph.symmetric_edge_polytope[20]>\", line 1, in <module>\n        P.is_combinatorially_isomorphic(P1.subdirect_sum(P2))\n      File \"/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/geometry/polyhedron/base.py\", line 10715, in is_combinatorially_isomorphic\n        return G_self.is_isomorphic(G_other)\n      File \"/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/graphs/generic_graph.py\", line 22672, in is_isomorphic\n        isom = isomorphic(GC, GC2, partition, partition2, (self._directed or self.has_loops()), 1)\n      File \"sage/groups/perm_gps/partn_ref/refinement_graphs.pyx\", line 163, in sage.groups.perm_gps.partn_ref.refinement_graphs.isomorphic (build/cythonized/sage/groups/perm_gps/partn_ref/refinement_graphs.c:6775)\n        cdef bint isomorphic = double_coset(<void *>GS1, <void *>GS2, part, ordering, n, &all_children_are_equivalent, &refine_by_degree, &compare_graphs, NULL, NULL, output)\n      File \"sage/groups/perm_gps/partn_ref/double_coset.pyx\", line 364, in sage.groups.perm_gps.partn_ref.double_coset.double_coset (build/cythonized/sage/groups/perm_gps/partn_ref/double_coset.c:5618)\n        raise MemoryError\n    MemoryError\n**********************************************************************\n1 item had failures:\n   1 of  53 in sage.graphs.generic_graph.GenericGraph.symmetric_edge_polytope\n    [3558 tests, 1 failure, 42.09 s]\n----------------------------------------------------------------------\nsage -t --random-seed=306431873350217748498615142104107167501 src/sage/graphs/generic_graph.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 43.1 seconds\n    cpu time: 40.1 seconds\n    cumulative wall time: 42.1 seconds\nPytest is not installed, skip checking tests that rely on it.\n```",
    "created_at": "2021-10-04T08:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449581",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>
```
sage -t --random-seed=306431873350217748498615142104107167501 src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 23601, in sage.graphs.generic_graph.GenericGraph.symmetric_edge_polytope
Failed example:
    P.is_combinatorially_isomorphic(P1.subdirect_sum(P2))
Exception raised:
    Traceback (most recent call last):
      File "/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generic_graph.GenericGraph.symmetric_edge_polytope[20]>", line 1, in <module>
        P.is_combinatorially_isomorphic(P1.subdirect_sum(P2))
      File "/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/geometry/polyhedron/base.py", line 10715, in is_combinatorially_isomorphic
        return G_self.is_isomorphic(G_other)
      File "/home/martin/sage-develop/local/lib/python3.8/site-packages/sage/graphs/generic_graph.py", line 22672, in is_isomorphic
        isom = isomorphic(GC, GC2, partition, partition2, (self._directed or self.has_loops()), 1)
      File "sage/groups/perm_gps/partn_ref/refinement_graphs.pyx", line 163, in sage.groups.perm_gps.partn_ref.refinement_graphs.isomorphic (build/cythonized/sage/groups/perm_gps/partn_ref/refinement_graphs.c:6775)
        cdef bint isomorphic = double_coset(<void *>GS1, <void *>GS2, part, ordering, n, &all_children_are_equivalent, &refine_by_degree, &compare_graphs, NULL, NULL, output)
      File "sage/groups/perm_gps/partn_ref/double_coset.pyx", line 364, in sage.groups.perm_gps.partn_ref.double_coset.double_coset (build/cythonized/sage/groups/perm_gps/partn_ref/double_coset.c:5618)
        raise MemoryError
    MemoryError
**********************************************************************
1 item had failures:
   1 of  53 in sage.graphs.generic_graph.GenericGraph.symmetric_edge_polytope
    [3558 tests, 1 failure, 42.09 s]
----------------------------------------------------------------------
sage -t --random-seed=306431873350217748498615142104107167501 src/sage/graphs/generic_graph.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 43.1 seconds
    cpu time: 40.1 seconds
    cumulative wall time: 42.1 seconds
Pytest is not installed, skip checking tests that rely on it.
```



---

archive/issue_comments_449582.json:
```json
{
    "body": "<a id='comment:2'></a>Looks like I need to reduce the number of vertices.",
    "created_at": "2021-10-04T08:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449582",
    "user": "https://github.com/kliem"
}
```

<a id='comment:2'></a>Looks like I need to reduce the number of vertices.



---

archive/issue_comments_449583.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-04T08:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449583",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449584.json:
```json
{
    "body": "<a id='comment:4'></a>Previously I decomposed random graphs of up to 12 vertices. Now I take the disjoint union of random graphs and need to go down with the number of vertices.",
    "created_at": "2021-10-04T08:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449584",
    "user": "https://github.com/kliem"
}
```

<a id='comment:4'></a>Previously I decomposed random graphs of up to 12 vertices. Now I take the disjoint union of random graphs and need to go down with the number of vertices.



---

archive/issue_comments_449585.json:
```json
{
    "body": "timeout",
    "created_at": "2021-10-04T09:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449585",
    "user": "https://github.com/mantepse"
}
```

timeout



---

archive/issue_comments_449586.json:
```json
{
    "body": "<a id='comment:5'></a>Attachment [timeout.txt](tarball://root/attachments/some-uuid/ticket29935/timeout.txt) by @mantepse created at 2021-10-04 09:48:53\n\nIt seems that there is still a problem.  With some seeds, testing `generic_graph.py` takes about 16 seconds on my computer.  However,\n\n```\nsage -t --random-seed=236024484355828254371843550334759500607 src/sage/graphs/generic_graph.py\n```\ntimes out.  I attached the log.  The last line executed is\n\n```\nsage: trees = g.edge_disjoint_spanning_trees(k) ## line 6282 ##\n```\n\nOf course, this should not have anything to do with the SEP.",
    "created_at": "2021-10-04T09:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449586",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'></a>Attachment [timeout.txt](tarball://root/attachments/some-uuid/ticket29935/timeout.txt) by @mantepse created at 2021-10-04 09:48:53

It seems that there is still a problem.  With some seeds, testing `generic_graph.py` takes about 16 seconds on my computer.  However,

```
sage -t --random-seed=236024484355828254371843550334759500607 src/sage/graphs/generic_graph.py
```
times out.  I attached the log.  The last line executed is

```
sage: trees = g.edge_disjoint_spanning_trees(k) ## line 6282 ##
```

Of course, this should not have anything to do with the SEP.



---

archive/issue_comments_449587.json:
```json
{
    "body": "<a id='comment:6'></a>Yes, that is #32169. I was wondering why it did not happen in this case.",
    "created_at": "2021-10-04T09:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449587",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>Yes, that is #32169. I was wondering why it did not happen in this case.



---

archive/issue_comments_449588.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-04T09:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449589.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-08T07:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449590.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-08T14:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449590",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449591.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,167 @@\n+Our documentation and tests include a variety of\n+examples and tests involving randomness.\n \n+Those depend on a randomness seed, and up to Sage 9.1\n+they always used the same one: 0. Thus every run\n+of `sage -t` or `make [p]test[all][long]` would run\n+those \"random\" doctests deterministically.\n+In many cases, the output of those tests even relied\n+on that. As a result, random examples and tests\n+were actually testing that they were run non-randomly!\n+\n+This is reminiscent of\n+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).\n+\n+Based on these considerations and the\n+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),\n+we propose to:\n+\n+- allow specifying a randomness when running tests (#29962),\n+- adapt tests involving randomness, making sure they\n+  test mathematical functionality independent of\n+  the randomness seed used to run them (see roadmap),\n+- default to a random randomness seed when none is specified\n+  (present ticket),\n+\n+thus making those tests more robust and more useful,\n+by becoming more likely to reveal bugs in a variety\n+of cases including corner cases.\n+\n+The first step (see #29962, merged in Sage 9.2)\n+adds a `--random-seed` flag to `sage -t`, allowing:\n+\n+```\n+sage -t --long --random-seed=9876543210 src/sage/\n+```\n+\n+Still, when no randomness seed is specified,\n+the default seed 0 is used. This means most testers\n+test with the same randomness seed, making \"random\"\n+doctests still mostly deterministic in practice.\n+\n+Here is a way to pick a random randomness seed\n+and run tests with it (can be used to work on\n+the tickets in the roadmap):\n+\n+```\n+$ randseed() {\n+    sage -c \"import sage.misc.randstate as randstate; \\\n+             randstate.set_random_seed(); \\\n+             print(randstate.initial_seed())\";\n+    }\n+$ SEED=$(randseed)\n+$ DIR=src/sage\n+$ echo \"$ sage -t --long --random-seed=${SEED} ${DIR}\" \\\n+  && ./sage -t --long --random-seed=${SEED} ${DIR}\n+```\n+\n+Once examples and tests involving randomness\n+have been adapted, the present ticket puts\n+the final touch by making it so that\n+when running tests with no seed specified,\n+a random one will be used:\n+\n+```\n+sage -t src/sage/all.py \n+Running doctests with ID 2020-06-23-23-19-03-8003eea5.\n+...\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+    [16 tests, 0.73 s]\n+----------------------------------------------------------------------\n+All tests passed!\n+----------------------------------------------------------------------\n+Total time for all tests: 0.8 seconds\n+    cpu time: 0.7 seconds\n+    cumulative wall time: 0.7 seconds\n+```\n+\n+Being displayed in the output, the seed used\n+can be used again if needed:\n+\n+```\n+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py\n+```\n+allowing to explore any problematic case\n+revealed by running the tests with that seed.\n+\n+Roadmap:\n+\n+- Allow fuzzing: #29962\n+- Make all parts of sage ready for default fuzzing:\n+  - #29945: coding\n+  - #29963: geometry\n+  - #29964: libs\n+  - #29965: graphs\n+  - #32107: groups\n+  - #29967: interfaces\n+  - #29968: algebras\n+  - #29969: misc\n+  - #29970: arith\n+  - #29971: categories\n+  - #29972: stats\n+  - #29973: sets\n+  - #29974: combinat\n+  - #29975: numerical, probability\n+  - #29976: matrix\n+  - #29977: modular\n+  - #29978: modules\n+  - #29979: rings\n+  - #29980: crypto\n+  - #29981: documentation\n+  - #29982: dynamics\n+  - #29983: finance\n+  - #29984: symbolic\n+  - #29985: schemes\n+  - #29986: plot\n+  - #32188: various missed tests along the way\n+- #32216: Update the developers guide for implicitly fuzzing doctests \n+- Finally make fuzzing default with this ticket.\n+\n+Follow-up:\n+\n+- #32544: Meta-ticket: Fix unstable doctests detected after #29935 \n+- Remove `set_random_seed` in doctests where possible.\n+\n+Errors discovered by this ticket:\n+\n+- #29936: Hyperbolic geometry bugs revealed by fuzzing\n+- #29945: Failing doctest in `src/sage/coding/linear_code.py`\n+  (just a wrong doctest, will be fixed here)\n+- #29954: Unstable plotting\n+- #29956: Bug in `KlyachkoBundle_class.random_deformation`\n+- #29957: Bug in `ContinuedFraction` rounding\n+- #29958: Too many strong articulation points\n+- #29961: Random symbolic expression is completely unstable\n+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder\n+- Index error with random derangement (fixed in #29974)\n+- #31890: simplify_hypergeometric is unstable\n+- #31891: `ZeroDivisonError` when creating polynomial system\n+- #31892: Conic parametrization broken\n+- #32075: Polynomial generic power trunk broken \n+- #32083: Various errors with polybori including segmentation fault \n+- #32084 `_nth_root_naive` fails for integer mod \n+- #32085: Errors when computing norms of padic elements \n+- #32086: apply_homography unstable for continue fraction \n+- #32095: DiFUB algorithm fails on some random graph \n+- #32108: Fix random tree on one or less vertices \n+- #32109: Fix 0/0 in ore function field \n+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a \n+- #32117: Random relative number field checks only irreducibility over QQ \n+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity \n+- #32124: SL2Z.random_element unstable \n+- #32125: random Ore polynomials do not respect minimum degree bound\n+- #32126: padic QpLC.random_element is broken\n+- #32127: gosper_iterator of continued fractions is unstable\n+- #32129: sage_input is unreliable for elements of ComplexField\n+- #32131: Cut width of graph with one edge incorrect\n+- #32132: Wrong gyration orbit length\n+- #32138: is_groebner fails over fraction fields\n+- #32141: Unstable doctest involving permutation groups \n+- #32169: Bug in edge disjoint spanning trees \n+- #32185: Failing weak order assertion on random symbolic expression\n+- #32186: Random bounded tolerance graph\n+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP\n+- #32657: `plot_vector_field` unstable \n \n Comment: 1\n \n```\n",
    "created_at": "2021-10-08T14:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449591",
    "user": "https://github.com/kliem"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,167 @@
+Our documentation and tests include a variety of
+examples and tests involving randomness.
 
+Those depend on a randomness seed, and up to Sage 9.1
+they always used the same one: 0. Thus every run
+of `sage -t` or `make [p]test[all][long]` would run
+those "random" doctests deterministically.
+In many cases, the output of those tests even relied
+on that. As a result, random examples and tests
+were actually testing that they were run non-randomly!
+
+This is reminiscent of
+an [xkcd comic illustration of random number generators](https://xkcd.com/221/).
+
+Based on these considerations and the
+related [sage-devel discussion](https://groups.google.com/d/msg/sage-devel/c4UbKSdt3Aw/UQAo1iYoAAAJ),
+we propose to:
+
+- allow specifying a randomness when running tests (#29962),
+- adapt tests involving randomness, making sure they
+  test mathematical functionality independent of
+  the randomness seed used to run them (see roadmap),
+- default to a random randomness seed when none is specified
+  (present ticket),
+
+thus making those tests more robust and more useful,
+by becoming more likely to reveal bugs in a variety
+of cases including corner cases.
+
+The first step (see #29962, merged in Sage 9.2)
+adds a `--random-seed` flag to `sage -t`, allowing:
+
+```
+sage -t --long --random-seed=9876543210 src/sage/
+```
+
+Still, when no randomness seed is specified,
+the default seed 0 is used. This means most testers
+test with the same randomness seed, making "random"
+doctests still mostly deterministic in practice.
+
+Here is a way to pick a random randomness seed
+and run tests with it (can be used to work on
+the tickets in the roadmap):
+
+```
+$ randseed() {
+    sage -c "import sage.misc.randstate as randstate; \
+             randstate.set_random_seed(); \
+             print(randstate.initial_seed())";
+    }
+$ SEED=$(randseed)
+$ DIR=src/sage
+$ echo "$ sage -t --long --random-seed=${SEED} ${DIR}" \
+  && ./sage -t --long --random-seed=${SEED} ${DIR}
+```
+
+Once examples and tests involving randomness
+have been adapted, the present ticket puts
+the final touch by making it so that
+when running tests with no seed specified,
+a random one will be used:
+
+```
+sage -t src/sage/all.py 
+Running doctests with ID 2020-06-23-23-19-03-8003eea5.
+...
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+    [16 tests, 0.73 s]
+----------------------------------------------------------------------
+All tests passed!
+----------------------------------------------------------------------
+Total time for all tests: 0.8 seconds
+    cpu time: 0.7 seconds
+    cumulative wall time: 0.7 seconds
+```
+
+Being displayed in the output, the seed used
+can be used again if needed:
+
+```
+sage -t --warn-long 89.5 --random-seed=273987373473433732996760115183658447263 src/sage/all.py
+```
+allowing to explore any problematic case
+revealed by running the tests with that seed.
+
+Roadmap:
+
+- Allow fuzzing: #29962
+- Make all parts of sage ready for default fuzzing:
+  - #29945: coding
+  - #29963: geometry
+  - #29964: libs
+  - #29965: graphs
+  - #32107: groups
+  - #29967: interfaces
+  - #29968: algebras
+  - #29969: misc
+  - #29970: arith
+  - #29971: categories
+  - #29972: stats
+  - #29973: sets
+  - #29974: combinat
+  - #29975: numerical, probability
+  - #29976: matrix
+  - #29977: modular
+  - #29978: modules
+  - #29979: rings
+  - #29980: crypto
+  - #29981: documentation
+  - #29982: dynamics
+  - #29983: finance
+  - #29984: symbolic
+  - #29985: schemes
+  - #29986: plot
+  - #32188: various missed tests along the way
+- #32216: Update the developers guide for implicitly fuzzing doctests 
+- Finally make fuzzing default with this ticket.
+
+Follow-up:
+
+- #32544: Meta-ticket: Fix unstable doctests detected after #29935 
+- Remove `set_random_seed` in doctests where possible.
+
+Errors discovered by this ticket:
+
+- #29936: Hyperbolic geometry bugs revealed by fuzzing
+- #29945: Failing doctest in `src/sage/coding/linear_code.py`
+  (just a wrong doctest, will be fixed here)
+- #29954: Unstable plotting
+- #29956: Bug in `KlyachkoBundle_class.random_deformation`
+- #29957: Bug in `ContinuedFraction` rounding
+- #29958: Too many strong articulation points
+- #29961: Random symbolic expression is completely unstable
+- #30045: Bug in Reed-Solomon encoder and error-erasure decoder
+- Index error with random derangement (fixed in #29974)
+- #31890: simplify_hypergeometric is unstable
+- #31891: `ZeroDivisonError` when creating polynomial system
+- #31892: Conic parametrization broken
+- #32075: Polynomial generic power trunk broken 
+- #32083: Various errors with polybori including segmentation fault 
+- #32084 `_nth_root_naive` fails for integer mod 
+- #32085: Errors when computing norms of padic elements 
+- #32086: apply_homography unstable for continue fraction 
+- #32095: DiFUB algorithm fails on some random graph 
+- #32108: Fix random tree on one or less vertices 
+- #32109: Fix 0/0 in ore function field 
+- #32111: Unstable minimal polynomial for element of 2-adic Eisenstein Extension Field in pi defined by x^4 - 2*a 
+- #32117: Random relative number field checks only irreducibility over QQ 
+- #32118: AlgebraicForm checks invariance with random matrix that can be the identity 
+- #32124: SL2Z.random_element unstable 
+- #32125: random Ore polynomials do not respect minimum degree bound
+- #32126: padic QpLC.random_element is broken
+- #32127: gosper_iterator of continued fractions is unstable
+- #32129: sage_input is unreliable for elements of ComplexField
+- #32131: Cut width of graph with one edge incorrect
+- #32132: Wrong gyration orbit length
+- #32138: is_groebner fails over fraction fields
+- #32141: Unstable doctest involving permutation groups 
+- #32169: Bug in edge disjoint spanning trees 
+- #32185: Failing weak order assertion on random symbolic expression
+- #32186: Random bounded tolerance graph
+- #32187: permutation group generated by list perms in L of degree n incorrect when compared to GAP
+- #32657: `plot_vector_field` unstable 
 
 Comment: 1
 
```




---

archive/issue_comments_449592.json:
```json
{
    "body": "<a id='comment:0'></a>New commits:",
    "created_at": "2021-10-08T14:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449592",
    "user": "https://github.com/kliem"
}
```

<a id='comment:0'></a>New commits:



---

archive/issue_comments_449593.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-10-11T05:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449593",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_449594.json:
```json
{
    "body": "<a id='comment:2'></a>Rebased on #32498, which fixes the error with (symmetric) edge polytopes.",
    "created_at": "2021-10-11T05:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449594",
    "user": "https://github.com/kliem"
}
```

<a id='comment:2'></a>Rebased on #32498, which fixes the error with (symmetric) edge polytopes.



---

archive/issue_comments_449595.json:
```json
{
    "body": "<a id='comment:3'></a>Correct ticket.",
    "created_at": "2021-10-11T07:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449595",
    "user": "https://github.com/kliem"
}
```

<a id='comment:3'></a>Correct ticket.



---

archive/issue_comments_449596.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-13T12:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449596",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_449597.json:
```json
{
    "body": "<a id='comment:5'></a>Thank you.",
    "created_at": "2021-10-13T12:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449597",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>Thank you.



---

archive/issue_comments_449598.json:
```json
{
    "body": "<a id='comment:6'></a>No problem, you'll have to rebase this onto the typo-fix too I think.",
    "created_at": "2021-10-13T12:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449598",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:6'></a>No problem, you'll have to rebase this onto the typo-fix too I think.



---

archive/issue_comments_449599.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-10-13T12:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449599",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_449600.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:",
    "created_at": "2021-10-13T12:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449600",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:



---

archive/issue_comments_449601.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-13T12:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449601",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_449602.json:
```json
{
    "body": "<a id='comment:179'></a>Replying to [comment:176 mjo]:\n> No problem, you'll have to rebase this onto the typo-fix too I think.\n\n\nI don't know, if this is necessary, but it sure doesn't hurt.",
    "created_at": "2021-10-13T12:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449602",
    "user": "https://github.com/kliem"
}
```

<a id='comment:179'></a>Replying to [comment:176 mjo]:
> No problem, you'll have to rebase this onto the typo-fix too I think.


I don't know, if this is necessary, but it sure doesn't hurt.



---

archive/issue_comments_449603.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-10-13T19:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449603",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_449604.json:
```json
{
    "body": "<a id='comment:0'></a>Merge conflict",
    "created_at": "2021-10-13T19:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449604",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:0'></a>Merge conflict



---

archive/issue_comments_449605.json:
```json
{
    "body": "<a id='comment:1'></a>This is the merge conflict, which permits a trivial solution (at least trivial for a human being):\n\n```diff\ndiff --cc src/bin/sage-runtests\nindex d1fe6567e7,4fc2062b15..0000000000\n--- a/src/bin/sage-runtests\n+++ b/src/bin/sage-runtests\n@@@ -64,59 -55,60 +55,97 @@@ if __name__ == \"__main__\"\n               'if \"external\" is listed, will also run tests for available external software; '\n               'if \"build\" is listed, will also run tests specific to Sage\\'s build/packaging system; '\n               'if set to \"all\", then all tests will be run')\n++<<<<<<< HEAD\n +    parser.add_option(\"--randorder\", type=int, metavar=\"SEED\", help=\"randomize order of tests\")\n +    parser.add_option(\"--random-seed\", dest=\"random_seed\", type=int, metavar=\"SEED\", help=\"random seed (integer) for fuzzing doctests\")\n +    parser.add_option(\"--global-iterations\", \"--global_iterations\", type=int, default=0, help=\"repeat the whole testing process this many times\")\n +    parser.add_option(\"--file-iterations\", \"--file_iterations\", type=int, default=0, help=\"repeat each file this many times, stopping on the first failure\")\n +    parser.add_option(\"--environment\", type=str, default=\"sage.repl.ipython_kernel.all_jupyter\", help=\"name of a module that provides the global environment for tests\")\n +\n +    parser.add_option(\"-i\", \"--initial\", action=\"store_true\", default=False, help=\"only show the first failure in each file\")\n +    parser.add_option(\"--exitfirst\", action=\"store_true\", default=False, help=\"end the test run immediately after the first failure or unexpected exception\")\n +    parser.add_option(\"--force_lib\", \"--force-lib\", action=\"store_true\", default=False, help=\"do not import anything from the tested file(s)\")\n +    parser.add_option(\"--abspath\", action=\"store_true\", default=False, help=\"print absolute paths rather than relative paths\")\n +    parser.add_option(\"--verbose\", action=\"store_true\", default=False, help=\"print debugging output during the test\")\n +    parser.add_option(\"-d\", \"--debug\", action=\"store_true\", default=False, help=\"drop into a python debugger when an unexpected error is raised\")\n +    parser.add_option(\"--only-errors\", action=\"store_true\", default=False, help=\"only output failures, not test successes\")\n +\n +    parser.add_option(\"--gdb\", action=\"store_true\", default=False, help=\"run doctests under the control of gdb\")\n +    parser.add_option(\"--valgrind\", \"--memcheck\", action=\"store_true\", default=False,\n +                      help=\"run doctests using Valgrind's memcheck tool.  The log \"\n +                         \"files are named sage-memcheck.PID and can be found in \" +\n +                         os.path.join(DOT_SAGE, \"valgrind\"))\n +    parser.add_option(\"--massif\", action=\"store_true\", default=False,\n +                      help=\"run doctests using Valgrind's massif tool.  The log \"\n +                         \"files are named sage-massif.PID and can be found in \" +\n +                         os.path.join(DOT_SAGE, \"valgrind\"))\n +    parser.add_option(\"--cachegrind\", action=\"store_true\", default=False,\n +                      help=\"run doctests using Valgrind's cachegrind tool.  The log \"\n +                         \"files are named sage-cachegrind.PID and can be found in \" +\n +                         os.path.join(DOT_SAGE, \"valgrind\"))\n +    parser.add_option(\"--omega\", action=\"store_true\", default=False,\n +                      help=\"run doctests using Valgrind's omega tool.  The log \"\n +                         \"files are named sage-omega.PID and can be found in \" +\n +                         os.path.join(DOT_SAGE, \"valgrind\"))\n +\n +    parser.add_option(\"-f\", \"--failed\", action=\"store_true\", default=False,\n++=======\n+     parser.add_argument(\"--randorder\", type=int, metavar=\"SEED\", help=\"randomize order of tests\")\n+     parser.add_argument(\"--random-seed\", dest=\"random_seed\", type=int, metavar=\"SEED\", help=\"random seed for fuzzing doctests\")\n+     parser.add_argument(\"--global-iterations\", \"--global_iterations\", type=int, default=0, help=\"repeat the whole testing process this many times\")\n+     parser.add_argument(\"--file-iterations\", \"--file_iterations\", type=int, default=0, help=\"repeat each file this many times, stopping on the first failure\")\n+     parser.add_argument(\"--environment\", type=str, default=\"sage.repl.ipython_kernel.all_jupyter\", help=\"name of a module that provides the global environment for tests\")\n+ \n+     parser.add_argument(\"-i\", \"--initial\", action=\"store_true\", default=False, help=\"only show the first failure in each file\")\n+     parser.add_argument(\"--exitfirst\", action=\"store_true\", default=False, help=\"end the test run immediately after the first failure or unexpected exception\")\n+     parser.add_argument(\"--force_lib\", \"--force-lib\", action=\"store_true\", default=False, help=\"do not import anything from the test\n...\n```",
    "created_at": "2021-10-13T19:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449605",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>This is the merge conflict, which permits a trivial solution (at least trivial for a human being):

```diff
diff --cc src/bin/sage-runtests
index d1fe6567e7,4fc2062b15..0000000000
--- a/src/bin/sage-runtests
+++ b/src/bin/sage-runtests
@@@ -64,59 -55,60 +55,97 @@@ if __name__ == "__main__"
               'if "external" is listed, will also run tests for available external software; '
               'if "build" is listed, will also run tests specific to Sage\'s build/packaging system; '
               'if set to "all", then all tests will be run')
++<<<<<<< HEAD
 +    parser.add_option("--randorder", type=int, metavar="SEED", help="randomize order of tests")
 +    parser.add_option("--random-seed", dest="random_seed", type=int, metavar="SEED", help="random seed (integer) for fuzzing doctests")
 +    parser.add_option("--global-iterations", "--global_iterations", type=int, default=0, help="repeat the whole testing process this many times")
 +    parser.add_option("--file-iterations", "--file_iterations", type=int, default=0, help="repeat each file this many times, stopping on the first failure")
 +    parser.add_option("--environment", type=str, default="sage.repl.ipython_kernel.all_jupyter", help="name of a module that provides the global environment for tests")
 +
 +    parser.add_option("-i", "--initial", action="store_true", default=False, help="only show the first failure in each file")
 +    parser.add_option("--exitfirst", action="store_true", default=False, help="end the test run immediately after the first failure or unexpected exception")
 +    parser.add_option("--force_lib", "--force-lib", action="store_true", default=False, help="do not import anything from the tested file(s)")
 +    parser.add_option("--abspath", action="store_true", default=False, help="print absolute paths rather than relative paths")
 +    parser.add_option("--verbose", action="store_true", default=False, help="print debugging output during the test")
 +    parser.add_option("-d", "--debug", action="store_true", default=False, help="drop into a python debugger when an unexpected error is raised")
 +    parser.add_option("--only-errors", action="store_true", default=False, help="only output failures, not test successes")
 +
 +    parser.add_option("--gdb", action="store_true", default=False, help="run doctests under the control of gdb")
 +    parser.add_option("--valgrind", "--memcheck", action="store_true", default=False,
 +                      help="run doctests using Valgrind's memcheck tool.  The log "
 +                         "files are named sage-memcheck.PID and can be found in " +
 +                         os.path.join(DOT_SAGE, "valgrind"))
 +    parser.add_option("--massif", action="store_true", default=False,
 +                      help="run doctests using Valgrind's massif tool.  The log "
 +                         "files are named sage-massif.PID and can be found in " +
 +                         os.path.join(DOT_SAGE, "valgrind"))
 +    parser.add_option("--cachegrind", action="store_true", default=False,
 +                      help="run doctests using Valgrind's cachegrind tool.  The log "
 +                         "files are named sage-cachegrind.PID and can be found in " +
 +                         os.path.join(DOT_SAGE, "valgrind"))
 +    parser.add_option("--omega", action="store_true", default=False,
 +                      help="run doctests using Valgrind's omega tool.  The log "
 +                         "files are named sage-omega.PID and can be found in " +
 +                         os.path.join(DOT_SAGE, "valgrind"))
 +
 +    parser.add_option("-f", "--failed", action="store_true", default=False,
++=======
+     parser.add_argument("--randorder", type=int, metavar="SEED", help="randomize order of tests")
+     parser.add_argument("--random-seed", dest="random_seed", type=int, metavar="SEED", help="random seed for fuzzing doctests")
+     parser.add_argument("--global-iterations", "--global_iterations", type=int, default=0, help="repeat the whole testing process this many times")
+     parser.add_argument("--file-iterations", "--file_iterations", type=int, default=0, help="repeat each file this many times, stopping on the first failure")
+     parser.add_argument("--environment", type=str, default="sage.repl.ipython_kernel.all_jupyter", help="name of a module that provides the global environment for tests")
+ 
+     parser.add_argument("-i", "--initial", action="store_true", default=False, help="only show the first failure in each file")
+     parser.add_argument("--exitfirst", action="store_true", default=False, help="end the test run immediately after the first failure or unexpected exception")
+     parser.add_argument("--force_lib", "--force-lib", action="store_true", default=False, help="do not import anything from the test
...
```



---

archive/issue_comments_449606.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-13T19:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449607.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-10-13T19:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449607",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_076801.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-19T20:35:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29935#event-76801"
}
```



---

archive/issue_comments_449608.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-19T20:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29935#issuecomment-449608",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
