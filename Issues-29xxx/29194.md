# Issue 29194: Three.js-based Animations

archive/issues_028957.json:
```json
{
    "body": "Add to Sage the ability to produce interactive 3D animations that can be explored by translating, rotating, and zooming as the animation progresses. Previously, an animation would need to be re-generated each time a different viewpoint was desired.\n\nTo that end, this ticket implements the following:\n\n1. an `.interactive()` method on existing `Animation` objects that produces a new 3D graphics object containing all of the original frames of animation with additional animation metadata (keyframe assignments) attached that a supported viewer could use to depict the animation.\n\n2. changes to the Three.js viewer to support keyframe animation of points, lines, texts, and surfaces when animation metadata is present including optional graphical controls allowing the user to play/pause, adjust playback position, control playback speed, and toggle looping.\n\n3. support for saving a 3D graphics object directly to an HTML file that uses the Three.js viewer, bypassing the need to open it in a browser first and use the \"Save as HTML\" menu option.\n\n4. support for saving an animation to an HTML file using features 1 and 3 listed above.\n\n\nCC:  @paulmasson @egourgoulhon @slel\n\nKeywords: threejs animation\n\nBranch/Commit: 8af227dc286a4659c213a72b2a5ee69fe9d9e88f\n\nReviewer: Paul Masson\n\nAuthor: Joshua Campbell\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29194\n\n",
    "closed_at": "2020-07-28T22:31:54Z",
    "created_at": "2020-02-14T05:00:41Z",
    "labels": [
        "component: graphics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Three.js-based Animations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29194",
    "user": "https://github.com/jcamp0x2a"
}
```
Add to Sage the ability to produce interactive 3D animations that can be explored by translating, rotating, and zooming as the animation progresses. Previously, an animation would need to be re-generated each time a different viewpoint was desired.

To that end, this ticket implements the following:

1. an `.interactive()` method on existing `Animation` objects that produces a new 3D graphics object containing all of the original frames of animation with additional animation metadata (keyframe assignments) attached that a supported viewer could use to depict the animation.

2. changes to the Three.js viewer to support keyframe animation of points, lines, texts, and surfaces when animation metadata is present including optional graphical controls allowing the user to play/pause, adjust playback position, control playback speed, and toggle looping.

3. support for saving a 3D graphics object directly to an HTML file that uses the Three.js viewer, bypassing the need to open it in a browser first and use the "Save as HTML" menu option.

4. support for saving an animation to an HTML file using features 1 and 3 listed above.


CC:  @paulmasson @egourgoulhon @slel

Keywords: threejs animation

Branch/Commit: 8af227dc286a4659c213a72b2a5ee69fe9d9e88f

Reviewer: Paul Masson

Author: Joshua Campbell

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29194





---

archive/issue_comments_569227.json:
```json
{
    "body": "<a id='comment:2'></a>\nLooks very promising!",
    "created_at": "2020-02-14T20:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569227",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:2'></a>
Looks very promising!



---

archive/issue_comments_569228.json:
```json
{
    "body": "<a id='comment:3'></a>\nI opted not to implement persisting the animation state at this time. \n\nSince the template is being used elsewhere, I went ahead and broke the animation javascript and CSS out into separate files in this initial iteration. The changes to the template file are now quite minimal, and I hope that makes porting future changes to it between Sage and other projects easier.\n\nWith the feature work complete, I'll move on to documentation and tests. One thing I've encountered so far is that the `.. PLOT::` directive doesn't seem to work with Three.js plots. I'm curious if this is a problem in my installation of Sage or if it's a known issue. I noticed that the documentation for the Three.js viewer (`src/doc/en/reference/plot3d/threejs.rst`) embeds pre-generated HTML files so perhaps that's the direction I should go as well?",
    "created_at": "2020-02-19T18:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569228",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:3'></a>
I opted not to implement persisting the animation state at this time. 

Since the template is being used elsewhere, I went ahead and broke the animation javascript and CSS out into separate files in this initial iteration. The changes to the template file are now quite minimal, and I hope that makes porting future changes to it between Sage and other projects easier.

With the feature work complete, I'll move on to documentation and tests. One thing I've encountered so far is that the `.. PLOT::` directive doesn't seem to work with Three.js plots. I'm curious if this is a problem in my installation of Sage or if it's a known issue. I noticed that the documentation for the Three.js viewer (`src/doc/en/reference/plot3d/threejs.rst`) embeds pre-generated HTML files so perhaps that's the direction I should go as well?



---

archive/issue_comments_569229.json:
```json
{
    "body": "<a id='comment:4'></a>\nJoshua, I agree that it is better to separate the animation script as you have done. Have you verified that everything in the `threejs` folder gets copied during the build process?\n\nThe rendering of Three.js graphics requires a browser environment, unlike the `PLOT` directive. While it would be possible in principle to render WebGL at the command line using Node.js, that is a topic way outside of my interest as an HTML-oriented person. For that reason documentation is currently generated with Jmol as a static image. I am personally much more interested in the live HTML examples I put into the backend documentation and recommend you go in that direction as well. The only drawback is that the images won't appear in PDF versions of the documentation.",
    "created_at": "2020-02-21T00:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569229",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:4'></a>
Joshua, I agree that it is better to separate the animation script as you have done. Have you verified that everything in the `threejs` folder gets copied during the build process?

The rendering of Three.js graphics requires a browser environment, unlike the `PLOT` directive. While it would be possible in principle to render WebGL at the command line using Node.js, that is a topic way outside of my interest as an HTML-oriented person. For that reason documentation is currently generated with Jmol as a static image. I am personally much more interested in the live HTML examples I put into the backend documentation and recommend you go in that direction as well. The only drawback is that the images won't appear in PDF versions of the documentation.



---

archive/issue_comments_569230.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [paulmasson](#comment%3A4):\n> Joshua, I agree that it is better to separate the animation script as you have done. Have you verified that everything in the `threejs` folder gets copied during the build process?\n\n\nI've verified that `animation.js` and `animation.css` are automatically copied after doing a full `make build` but not after a `sage -b`. The template behaves similarly. Do we want to try to ensure they get copied during a `sage -b` as well? I've been copying them all over manually in my own start script in order to avoid a full rebuild when none of the Python had changed.\n\n> The rendering of Three.js graphics requires a browser environment, unlike the `PLOT` directive. While it would be possible in principle to render WebGL at the command line using Node.js, that is a topic way outside of my interest as an HTML-oriented person. For that reason documentation is currently generated with Jmol as a static image. I am personally much more interested in the live HTML examples I put into the backend documentation and recommend you go in that direction as well. The only drawback is that the images won't appear in PDF versions of the documentation.\n\n\nAhh, that makes sense. I was forgetting about the PDF version. I will proceed with the separate HTML files for plots in the documentation then. Thank you :)",
    "created_at": "2020-02-21T22:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569230",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:5'></a>
Replying to [paulmasson](#comment%3A4):
> Joshua, I agree that it is better to separate the animation script as you have done. Have you verified that everything in the `threejs` folder gets copied during the build process?


I've verified that `animation.js` and `animation.css` are automatically copied after doing a full `make build` but not after a `sage -b`. The template behaves similarly. Do we want to try to ensure they get copied during a `sage -b` as well? I've been copying them all over manually in my own start script in order to avoid a full rebuild when none of the Python had changed.

> The rendering of Three.js graphics requires a browser environment, unlike the `PLOT` directive. While it would be possible in principle to render WebGL at the command line using Node.js, that is a topic way outside of my interest as an HTML-oriented person. For that reason documentation is currently generated with Jmol as a static image. I am personally much more interested in the live HTML examples I put into the backend documentation and recommend you go in that direction as well. The only drawback is that the images won't appear in PDF versions of the documentation.


Ahh, that makes sense. I was forgetting about the PDF version. I will proceed with the separate HTML files for plots in the documentation then. Thank you :)



---

archive/issue_comments_569231.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [gh-jcamp0x2a](#comment%3A5):\n> Replying to [paulmasson](#comment%3A4):\n> > Joshua, I agree that it is better to separate the animation script as you have done. Have you verified that everything in the `threejs` folder gets copied during the build process?\n\n> \n> I've verified that `animation.js` and `animation.css` are automatically copied after doing a full `make build` but not after a `sage -b`. The template behaves similarly. Do we want to try to ensure they get copied during a `sage -b` as well? I've been copying them all over manually in my own start script in order to avoid a full rebuild when none of the Python had changed.\n> \n\nWe won't have any control over the `sage -b` behavior since our files are not part of the core of Sage. `make build` or manually copying are the options.",
    "created_at": "2020-02-23T02:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569231",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:6'></a>
Replying to [gh-jcamp0x2a](#comment%3A5):
> Replying to [paulmasson](#comment%3A4):
> > Joshua, I agree that it is better to separate the animation script as you have done. Have you verified that everything in the `threejs` folder gets copied during the build process?

> 
> I've verified that `animation.js` and `animation.css` are automatically copied after doing a full `make build` but not after a `sage -b`. The template behaves similarly. Do we want to try to ensure they get copied during a `sage -b` as well? I've been copying them all over manually in my own start script in order to avoid a full rebuild when none of the Python had changed.
> 

We won't have any control over the `sage -b` behavior since our files are not part of the core of Sage. `make build` or manually copying are the options.



---

archive/issue_comments_569232.json:
```json
{
    "body": "Changing author from \"\" to \"Joshua Campbell\"",
    "created_at": "2020-04-26T18:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569232",
    "user": "https://github.com/jcamp0x2a"
}
```

Changing author from "" to "Joshua Campbell"



---

archive/issue_comments_569233.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-jcamp0x2a/29194-threejs-animation\"",
    "created_at": "2020-04-26T18:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569233",
    "user": "https://github.com/jcamp0x2a"
}
```

Changing branch from "" to "u/gh-jcamp0x2a/29194-threejs-animation"



---

archive/issue_comments_569234.json:
```json
{
    "body": "Changing commit from \"\" to \"dcd36c9d859729b28df0bb7fdbb90869bcdf6747\"",
    "created_at": "2020-04-26T18:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569234",
    "user": "https://github.com/jcamp0x2a"
}
```

Changing commit from "" to "dcd36c9d859729b28df0bb7fdbb90869bcdf6747"



---

archive/issue_comments_569235.json:
```json
{
    "body": "<a id='comment:7'></a>\nHello, I hope this finds you well. I apologize for the delay in getting this ticket up for review, but I just didn't have a good feeling about the branch as it was. \n\nAfter using it for a couple months, I've found the performance when using multiple animated variables to be quite wanting, as you'd expect from the exponential nature of adding new dimensions to the array of keyframes. Memory use and file size gets very large very quickly, especially when each frame itself is complex or if you've got several of them in the same notebook. Reducing the number of keyframes per variable helps, but having only a handful of frames makes noticing higher frequency stuff going on impossible. I consistently found myself using the `interact` command in the Jupyter notebook to control those extra variables instead.\n\nI've pushed a new version of the branch for your review that drops support for multiple animated variables. A lot of the complexity of the old branch came from supporting them, so the new one is much simpler. It uses Three.js's built-in animation system now instead of a custom one, and it is invoked from the existing animation functionality users may already be familiar with: instead of calling an animation's `gif` or `apng` method, you call `interactive`. The name `interactive` was chosen instead of `threejs` to allow the possibility of other viewers supporting this in the future.\n\nI've updated [https://jcamp0x2a.github.io/threejs-animation-example/](https://jcamp0x2a.github.io/threejs-animation-example/) with an example animated plot from the new branch.\n\nPlease let me know if you'd still prefer the older version. I believe the new one to be superior, but I'll try to keep up with and support either one going forward.\n\nThanks!\n\nJoshua",
    "created_at": "2020-04-26T18:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569235",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:7'></a>
Hello, I hope this finds you well. I apologize for the delay in getting this ticket up for review, but I just didn't have a good feeling about the branch as it was. 

After using it for a couple months, I've found the performance when using multiple animated variables to be quite wanting, as you'd expect from the exponential nature of adding new dimensions to the array of keyframes. Memory use and file size gets very large very quickly, especially when each frame itself is complex or if you've got several of them in the same notebook. Reducing the number of keyframes per variable helps, but having only a handful of frames makes noticing higher frequency stuff going on impossible. I consistently found myself using the `interact` command in the Jupyter notebook to control those extra variables instead.

I've pushed a new version of the branch for your review that drops support for multiple animated variables. A lot of the complexity of the old branch came from supporting them, so the new one is much simpler. It uses Three.js's built-in animation system now instead of a custom one, and it is invoked from the existing animation functionality users may already be familiar with: instead of calling an animation's `gif` or `apng` method, you call `interactive`. The name `interactive` was chosen instead of `threejs` to allow the possibility of other viewers supporting this in the future.

I've updated [https://jcamp0x2a.github.io/threejs-animation-example/](https://jcamp0x2a.github.io/threejs-animation-example/) with an example animated plot from the new branch.

Please let me know if you'd still prefer the older version. I believe the new one to be superior, but I'll try to keep up with and support either one going forward.

Thanks!

Joshua



---

archive/issue_comments_569236.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-26T18:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569236",
    "user": "https://github.com/jcamp0x2a"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_569237.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[1b6d2bf](https://git.sagemath.org/sage.git/commit/?id=1b6d2bfb57b4c1af1143d7145cfe4fd695e8eed0)|`Only animate when at least two frames present.`|\n|[fd6f8a8](https://git.sagemath.org/sage.git/commit/?id=fd6f8a80362fa74a61eae451616e5a24ac57a041)|`Fix misuse of SEEALSO block`|",
    "created_at": "2020-04-28T00:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[1b6d2bf](https://git.sagemath.org/sage.git/commit/?id=1b6d2bfb57b4c1af1143d7145cfe4fd695e8eed0)|`Only animate when at least two frames present.`|
|[fd6f8a8](https://git.sagemath.org/sage.git/commit/?id=fd6f8a80362fa74a61eae451616e5a24ac57a041)|`Fix misuse of SEEALSO block`|



---

archive/issue_comments_569238.json:
```json
{
    "body": "Changing commit from \"dcd36c9d859729b28df0bb7fdbb90869bcdf6747\" to \"fd6f8a80362fa74a61eae451616e5a24ac57a041\"",
    "created_at": "2020-04-28T00:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dcd36c9d859729b28df0bb7fdbb90869bcdf6747" to "fd6f8a80362fa74a61eae451616e5a24ac57a041"



---

archive/issue_comments_569239.json:
```json
{
    "body": "<a id='comment:9'></a>\nJoshua, I\u2019ll take a look at this once we\u2019re into the next beta. Don\u2019t want to make any major changes just before a release.",
    "created_at": "2020-04-28T23:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569239",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:9'></a>
Joshua, I’ll take a look at this once we’re into the next beta. Don’t want to make any major changes just before a release.



---

archive/issue_comments_569240.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [paulmasson](#comment%3A9):\n> Joshua, I\u2019ll take a look at this once we\u2019re into the next beta. Don\u2019t want to make any major changes just before a release.\n\n\nUnderstood. I figured I missed the boat once I started seeing the '9.1rc' tags pop up in the git logs :)",
    "created_at": "2020-04-29T00:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569240",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:10'></a>
Replying to [paulmasson](#comment%3A9):
> Joshua, I’ll take a look at this once we’re into the next beta. Don’t want to make any major changes just before a release.


Understood. I figured I missed the boat once I started seeing the '9.1rc' tags pop up in the git logs :)



---

archive/issue_events_074162.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-29T19:31:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29194#event-74162"
}
```



---

archive/issue_comments_569241.json:
```json
{
    "body": "<a id='comment:12'></a>\nJoshua, could you rebase this ticket off a current branch? That would save build time in reviewing. Thanks!",
    "created_at": "2020-06-08T21:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569241",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:12'></a>
Joshua, could you rebase this ticket off a current branch? That would save build time in reviewing. Thanks!



---

archive/issue_comments_569242.json:
```json
{
    "body": "Changing commit from \"fd6f8a80362fa74a61eae451616e5a24ac57a041\" to \"ee6d7bc7bafefbd7324dd1901735ee281076f5b1\"",
    "created_at": "2020-06-08T23:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fd6f8a80362fa74a61eae451616e5a24ac57a041" to "ee6d7bc7bafefbd7324dd1901735ee281076f5b1"



---

archive/issue_comments_569243.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[ee6d7bc](https://git.sagemath.org/sage.git/commit/?id=ee6d7bc7bafefbd7324dd1901735ee281076f5b1)|`Add support for simple keyframe-based animation to Three.js viewer.`|",
    "created_at": "2020-06-08T23:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[ee6d7bc](https://git.sagemath.org/sage.git/commit/?id=ee6d7bc7bafefbd7324dd1901735ee281076f5b1)|`Add support for simple keyframe-based animation to Three.js viewer.`|



---

archive/issue_comments_569244.json:
```json
{
    "body": "<a id='comment:14'></a>\nHi Paul, I've rebased off of the latest in the `develop` branch. I verified that it still builds fine (hopefully the patch bot agrees) and quickly tested that the animation functionality is working as expected. I'll run a few more tests tonight or tomorrow as time permits to be sure, but it should be in a decent shape for review.\n\nI imagine I'll want to rebase it again once your three.js update gets merged.\n\nThanks!",
    "created_at": "2020-06-08T23:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569244",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:14'></a>
Hi Paul, I've rebased off of the latest in the `develop` branch. I verified that it still builds fine (hopefully the patch bot agrees) and quickly tested that the animation functionality is working as expected. I'll run a few more tests tonight or tomorrow as time permits to be sure, but it should be in a decent shape for review.

I imagine I'll want to rebase it again once your three.js update gets merged.

Thanks!



---

archive/issue_comments_569245.json:
```json
{
    "body": "<a id='comment:15'></a>\nI've confirmed that the new version builds just fine and runs as expected. There is quite a lot of stuff changing here, so I'll need some time to read through all the code.\n\nMy first reaction is about the new bar across the top: although it's convenient for jumping to a frame, not sure if I like it yet. Maybe Eric can take a look and comment on it. The discrete controls would really be enough to control the animation.\n\nOtherwise, it's looking great! Nice addition to Sage.",
    "created_at": "2020-06-15T22:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569245",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:15'></a>
I've confirmed that the new version builds just fine and runs as expected. There is quite a lot of stuff changing here, so I'll need some time to read through all the code.

My first reaction is about the new bar across the top: although it's convenient for jumping to a frame, not sure if I like it yet. Maybe Eric can take a look and comment on it. The discrete controls would really be enough to control the animation.

Otherwise, it's looking great! Nice addition to Sage.



---

archive/issue_comments_569246.json:
```json
{
    "body": "<a id='comment:16'></a>\nOne other thought: shouldn't the decrease play back button be a reverse arrow? Or is this a Google standard icon?",
    "created_at": "2020-06-15T22:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569246",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:16'></a>
One other thought: shouldn't the decrease play back button be a reverse arrow? Or is this a Google standard icon?



---

archive/issue_comments_569247.json:
```json
{
    "body": "<a id='comment:17'></a>\nHi Paul,\n\nI somewhat agree about the slider at the top, but I'm pondering future work where the animations aren't all or shouldn't necessarily all be discrete, in which case a way to navigate continuously would be helpful. For example: when just spinning an object about an axis there's no reason it shouldn't be transformed as continuously as the highest frame-rate the user/browser allows. Ideally, I'm imagining something like:\n\n```python\ndodecahedron().rotateX(pi, duration=10).then().rotateY(-pi, duration=10)\n```\n\nThe discrete frame-by-frame was a nice starting point, though, since that's what users currently do for 2D animations, and so only a small change is required: `animate(frames).interactive()` instead of, for example, `animate(frames).apng()`.\n\nPerhaps it's jumping the gun a bit, though it does also serve to show the animation progress. May come in handy for seamlessly looped animations to tell when one period ended and another began without a sharp cut as a visual cue.\n\n---\n\nReplying to [paulmasson](#comment%3A16):\n> One other thought: shouldn't the decrease play back button be a reverse arrow? Or is this a Google standard icon?\n\n\nI used the hollow arrows for decrease speed instead of the reverse arrow since I didn't want the user to think it was a rewind button. I'm not particularly happy with the icons for the speed buttons, but I couldn't find anything in their icon set that seemed to fit better, and I'm not much of a graphics artist I fear. \n\nDo you think chevrons instead of triangle arrows would convey the meaning better? `>` for slow down and `>>>` for speed up? That geometry doesn't seem too complicated so I'd probably be able to design it. Not up to Google's standards, I'm sure :)\n\n---\n\nI understand it's a good bit of code to look through, so no worries.\n\nThanks!",
    "created_at": "2020-06-16T03:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569247",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:17'></a>
Hi Paul,

I somewhat agree about the slider at the top, but I'm pondering future work where the animations aren't all or shouldn't necessarily all be discrete, in which case a way to navigate continuously would be helpful. For example: when just spinning an object about an axis there's no reason it shouldn't be transformed as continuously as the highest frame-rate the user/browser allows. Ideally, I'm imagining something like:

```python
dodecahedron().rotateX(pi, duration=10).then().rotateY(-pi, duration=10)
```

The discrete frame-by-frame was a nice starting point, though, since that's what users currently do for 2D animations, and so only a small change is required: `animate(frames).interactive()` instead of, for example, `animate(frames).apng()`.

Perhaps it's jumping the gun a bit, though it does also serve to show the animation progress. May come in handy for seamlessly looped animations to tell when one period ended and another began without a sharp cut as a visual cue.

---

Replying to [paulmasson](#comment%3A16):
> One other thought: shouldn't the decrease play back button be a reverse arrow? Or is this a Google standard icon?


I used the hollow arrows for decrease speed instead of the reverse arrow since I didn't want the user to think it was a rewind button. I'm not particularly happy with the icons for the speed buttons, but I couldn't find anything in their icon set that seemed to fit better, and I'm not much of a graphics artist I fear. 

Do you think chevrons instead of triangle arrows would convey the meaning better? `>` for slow down and `>>>` for speed up? That geometry doesn't seem too complicated so I'd probably be able to design it. Not up to Google's standards, I'm sure :)

---

I understand it's a good bit of code to look through, so no worries.

Thanks!



---

archive/issue_comments_569248.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [paulmasson](#comment%3A15):\n> \n> My first reaction is about the new bar across the top: although it's convenient for jumping to a frame, not sure if I like it yet. Maybe Eric can take a look and comment on it. The discrete controls would really be enough to control the animation.\n> \n\n\nI took a look and I don't have a strong opinion on both options, so I leave it to you.\n\n> Otherwise, it's looking great! Nice addition to Sage.\n\n\nIndeed! Thanks for this piece of work!",
    "created_at": "2020-06-19T20:15:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569248",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:18'></a>
Replying to [paulmasson](#comment%3A15):
> 
> My first reaction is about the new bar across the top: although it's convenient for jumping to a frame, not sure if I like it yet. Maybe Eric can take a look and comment on it. The discrete controls would really be enough to control the animation.
> 


I took a look and I don't have a strong opinion on both options, so I leave it to you.

> Otherwise, it's looking great! Nice addition to Sage.


Indeed! Thanks for this piece of work!



---

archive/issue_comments_569249.json:
```json
{
    "body": "<a id='comment:19'></a>\nneeds rebase",
    "created_at": "2020-07-12T18:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569249",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
needs rebase



---

archive/issue_comments_569250.json:
```json
{
    "body": "Changing commit from \"ee6d7bc7bafefbd7324dd1901735ee281076f5b1\" to \"03c980ff19ca9c17667e3919ea194eb578b22e6b\"",
    "created_at": "2020-07-12T22:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ee6d7bc7bafefbd7324dd1901735ee281076f5b1" to "03c980ff19ca9c17667e3919ea194eb578b22e6b"



---

archive/issue_comments_569251.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[03c980f](https://git.sagemath.org/sage.git/commit/?id=03c980ff19ca9c17667e3919ea194eb578b22e6b)|`Add support for simple keyframe-based animation to Three.js viewer.`|",
    "created_at": "2020-07-12T22:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[03c980f](https://git.sagemath.org/sage.git/commit/?id=03c980ff19ca9c17667e3919ea194eb578b22e6b)|`Add support for simple keyframe-based animation to Three.js viewer.`|



---

archive/issue_comments_569252.json:
```json
{
    "body": "<a id='comment:21'></a>\nOne nitpick after reading through code: I don\u2019t think you should change the documentation where you added \u201cspecifying an HTML file\u201d since half of the following options aren\u2019t supported. A bit confusing.",
    "created_at": "2020-07-13T00:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569252",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:21'></a>
One nitpick after reading through code: I don’t think you should change the documentation where you added “specifying an HTML file” since half of the following options aren’t supported. A bit confusing.



---

archive/issue_comments_569253.json:
```json
{
    "body": "<a id='comment:22'></a>\nLooks mostly good to me, except for the issue raised about icons. I really think the slow down arrow should point to the left, but you're right that the rewind icon is misleading.\n\nThere are several of sets of left/right single chevrons already in the set of icons you're using: keyboard_arrow_left/right, navigation_before/after, chevron_left/right. Another choice would be single filled arrow_left/right.\n\nOr perhaps even better switch_left/right, which shows a difference in direction immediately in the icons. For this choice I would have the filled arrow indicate the direction, which is opposite of the label. I think I like this last choice best.",
    "created_at": "2020-07-13T02:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569253",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:22'></a>
Looks mostly good to me, except for the issue raised about icons. I really think the slow down arrow should point to the left, but you're right that the rewind icon is misleading.

There are several of sets of left/right single chevrons already in the set of icons you're using: keyboard_arrow_left/right, navigation_before/after, chevron_left/right. Another choice would be single filled arrow_left/right.

Or perhaps even better switch_left/right, which shows a difference in direction immediately in the icons. For this choice I would have the filled arrow indicate the direction, which is opposite of the label. I think I like this last choice best.



---

archive/issue_comments_569254.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Paul Masson\"",
    "created_at": "2020-07-13T02:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569254",
    "user": "https://github.com/paulmasson"
}
```

Changing reviewer from "" to "Paul Masson"



---

archive/issue_comments_569255.json:
```json
{
    "body": "Changing commit from \"03c980ff19ca9c17667e3919ea194eb578b22e6b\" to \"d48807cad635f39a9ad96e08721e44fb58883e89\"",
    "created_at": "2020-07-13T16:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "03c980ff19ca9c17667e3919ea194eb578b22e6b" to "d48807cad635f39a9ad96e08721e44fb58883e89"



---

archive/issue_comments_569256.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[c5666a3](https://git.sagemath.org/sage.git/commit/?id=c5666a36cd7041fa24143cc228a46196c4301fed)|`Change increase/decrease playback speed icons`|\n|[d48807c](https://git.sagemath.org/sage.git/commit/?id=d48807cad635f39a9ad96e08721e44fb58883e89)|`Revert a documentation change in Graphics3d.save`|",
    "created_at": "2020-07-13T16:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[c5666a3](https://git.sagemath.org/sage.git/commit/?id=c5666a36cd7041fa24143cc228a46196c4301fed)|`Change increase/decrease playback speed icons`|
|[d48807c](https://git.sagemath.org/sage.git/commit/?id=d48807cad635f39a9ad96e08721e44fb58883e89)|`Revert a documentation change in Graphics3d.save`|



---

archive/issue_comments_569257.json:
```json
{
    "body": "<a id='comment:24'></a>\nHi Paul. I agree that that documentation change was confusing, so I've reverted it. I've also changed the icons to switch_left/right as requested, and I think they do indeed convey the meaning better. Here is an example of the new icons in action: https://jcamp0x2a.github.io/threejs-animation-example/simpler.html",
    "created_at": "2020-07-13T16:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569257",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:24'></a>
Hi Paul. I agree that that documentation change was confusing, so I've reverted it. I've also changed the icons to switch_left/right as requested, and I think they do indeed convey the meaning better. Here is an example of the new icons in action: https://jcamp0x2a.github.io/threejs-animation-example/simpler.html



---

archive/issue_comments_569258.json:
```json
{
    "body": "<a id='comment:25'></a>\nAlmost good to go: you didn't update the example with the new icons...",
    "created_at": "2020-07-13T20:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569258",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:25'></a>
Almost good to go: you didn't update the example with the new icons...



---

archive/issue_comments_569259.json:
```json
{
    "body": "Changing commit from \"d48807cad635f39a9ad96e08721e44fb58883e89\" to \"8af227dc286a4659c213a72b2a5ee69fe9d9e88f\"",
    "created_at": "2020-07-13T21:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569259",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d48807cad635f39a9ad96e08721e44fb58883e89" to "8af227dc286a4659c213a72b2a5ee69fe9d9e88f"



---

archive/issue_comments_569260.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|\n|[8af227d](https://git.sagemath.org/sage.git/commit/?id=8af227dc286a4659c213a72b2a5ee69fe9d9e88f)|`Update animation example in Three.js documentation with new icons`|",
    "created_at": "2020-07-13T21:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569260",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
|[8af227d](https://git.sagemath.org/sage.git/commit/?id=8af227dc286a4659c213a72b2a5ee69fe9d9e88f)|`Update animation example in Three.js documentation with new icons`|



---

archive/issue_comments_569261.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [paulmasson](#comment%3A25):\n> Almost good to go: you didn't update the example with the new icons...\n\n\nAh! Thank you for catching that.",
    "created_at": "2020-07-13T21:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569261",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:27'></a>
Replying to [paulmasson](#comment%3A25):
> Almost good to go: you didn't update the example with the new icons...


Ah! Thank you for catching that.



---

archive/issue_comments_569262.json:
```json
{
    "body": "<a id='comment:28'></a>\nCool! And you noticed that the examples for documentation should be generated using `online=True`. I'll add that to the template comment.\n\nThanks for your patience in the review process and slogging through multiple rebases. Nice work!",
    "created_at": "2020-07-13T22:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569262",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:28'></a>
Cool! And you noticed that the examples for documentation should be generated using `online=True`. I'll add that to the template comment.

Thanks for your patience in the review process and slogging through multiple rebases. Nice work!



---

archive/issue_comments_569263.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-13T22:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569263",
    "user": "https://github.com/paulmasson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_569264.json:
```json
{
    "body": "<a id='comment:29'></a>\nThe ticket description reads\n\n> Tasks remaining before I'd be comfortable making a merge request:\n\n\nIf those tasks are now part of the ticket, please update the ticket description to\n\n> This ticket implements the following:",
    "created_at": "2020-07-26T17:26:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569264",
    "user": "https://github.com/slel"
}
```

<a id='comment:29'></a>
The ticket description reads

> Tasks remaining before I'd be comfortable making a merge request:


If those tasks are now part of the ticket, please update the ticket description to

> This ticket implements the following:



---

archive/issue_comments_569265.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [slelievre](#comment%3A29):\n> The ticket description reads\n> \n> > Tasks remaining before I'd be comfortable making a merge request:\n\n> \n> If those tasks are now part of the ticket, please update the ticket description to\n> \n> > This ticket implements the following:\n\n\nApologies. The ticket description is indeed out-of-date. Many of the work items mentioned also became irrelevant following a change of course partway through. I will update the description to match the feature as currently implemented.",
    "created_at": "2020-07-27T17:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569265",
    "user": "https://github.com/jcamp0x2a"
}
```

<a id='comment:30'></a>
Replying to [slelievre](#comment%3A29):
> The ticket description reads
> 
> > Tasks remaining before I'd be comfortable making a merge request:

> 
> If those tasks are now part of the ticket, please update the ticket description to
> 
> > This ticket implements the following:


Apologies. The ticket description is indeed out-of-date. Many of the work items mentioned also became irrelevant following a change of course partway through. I will update the description to match the feature as currently implemented.



---

archive/issue_comments_569266.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,37 +1,12 @@\n-Moving conversation from #29192, where I mentioned that I've been working on adding support for three.js-based interactive 3D animated plots to Sage.\n+Add to Sage the ability to produce interactive 3D animations that can be explored by translating, rotating, and zooming as the animation progresses. Previously, an animation would need to be re-generated each time a different viewpoint was desired.\n \n-The current state of the work can be found at:\n+To that end, this ticket implements the following:\n \n-    https://gitlab.com/jcamp0x2a/sage/-/tree/threejs-animate\n+1. an `.interactive()` method on existing `Animation` objects that produces a new 3D graphics object containing all of the original frames of animation with additional animation metadata (keyframe assignments) attached that a supported viewer could use to depict the animation.\n \n-...and some examples of the plots generated so far and how the animation functionality is invoked:\n+2. changes to the Three.js viewer to support keyframe animation of points, lines, texts, and surfaces when animation metadata is present including optional graphical controls allowing the user to play/pause, adjust playback position, control playback speed, and toggle looping.\n \n-    https://jcamp0x2a.github.io/threejs-animation-example/\n+3. support for saving a 3D graphics object directly to an HTML file that uses the Three.js viewer, bypassing the need to open it in a browser first and use the \"Save as HTML\" menu option.\n \n-Tasks remaining before I'd be comfortable making a merge request:\n+4. support for saving an animation to an HTML file using features 1 and 3 listed above.\n \n-- Persist animation state across viewings. (maybe)\n-\n-- Better handling of variable name collisions. If both plot G1 and G2 use an animation variable `x`, rather than overwriting one of them when summing G1 + G2, rename one of them instead. `x`, `x\u2032`, `x\u2033`, etc.\n-\n-- Pause the render loop when no variable is being animated. (energy / battery life)\n-\n-- Partition scene objects into keyframe groups whose visibility can be toggled on/off in one assignment every frame vs. iterating over every scene object every frame.\n-\n-- Come up with several animated plots to embed in the documentation showing off a wide variety of plots being animated: simple shapes, parametric curves/surfaces, implicit surfaces, surfaces of revolution, scatter plots, vector fields, etc.\n-\n-- Tests!\n-\n-Possible future work:\n-\n-- Break animation javascript code off into a separate file that's only included when the plot contains animation. (smaller file size, less bandwidth, more modular)\n-\n-- Interpolate/blend/morph between keyframes in order to improve the appearance of the animations, and allow it to be disabled. Some ideas include:\n-  - Fade keyframes in and out (via object opacity).\n-  - Identify corresponding objects between frames and interpolate their transforms and/or geometries.\n-  - Image-based blending: render the two keyframes you're between (for N variables, the min/max corners of the N-box) then blend them while rendering to a textured screen-size quad.\n-\n-- Performance improvements due to the # of objects animation may add to the scene: \n-  - Use Buffer Geometry instead of Geometry.\n-  - Merge identical objects and use instanced rendering.\n-  - Merge geometries that share a material and use range-restricted draws.\n``````\n",
    "created_at": "2020-07-27T17:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569266",
    "user": "https://github.com/jcamp0x2a"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,37 +1,12 @@
-Moving conversation from #29192, where I mentioned that I've been working on adding support for three.js-based interactive 3D animated plots to Sage.
+Add to Sage the ability to produce interactive 3D animations that can be explored by translating, rotating, and zooming as the animation progresses. Previously, an animation would need to be re-generated each time a different viewpoint was desired.
 
-The current state of the work can be found at:
+To that end, this ticket implements the following:
 
-    https://gitlab.com/jcamp0x2a/sage/-/tree/threejs-animate
+1. an `.interactive()` method on existing `Animation` objects that produces a new 3D graphics object containing all of the original frames of animation with additional animation metadata (keyframe assignments) attached that a supported viewer could use to depict the animation.
 
-...and some examples of the plots generated so far and how the animation functionality is invoked:
+2. changes to the Three.js viewer to support keyframe animation of points, lines, texts, and surfaces when animation metadata is present including optional graphical controls allowing the user to play/pause, adjust playback position, control playback speed, and toggle looping.
 
-    https://jcamp0x2a.github.io/threejs-animation-example/
+3. support for saving a 3D graphics object directly to an HTML file that uses the Three.js viewer, bypassing the need to open it in a browser first and use the "Save as HTML" menu option.
 
-Tasks remaining before I'd be comfortable making a merge request:
+4. support for saving an animation to an HTML file using features 1 and 3 listed above.
 
-- Persist animation state across viewings. (maybe)
-
-- Better handling of variable name collisions. If both plot G1 and G2 use an animation variable `x`, rather than overwriting one of them when summing G1 + G2, rename one of them instead. `x`, `x′`, `x″`, etc.
-
-- Pause the render loop when no variable is being animated. (energy / battery life)
-
-- Partition scene objects into keyframe groups whose visibility can be toggled on/off in one assignment every frame vs. iterating over every scene object every frame.
-
-- Come up with several animated plots to embed in the documentation showing off a wide variety of plots being animated: simple shapes, parametric curves/surfaces, implicit surfaces, surfaces of revolution, scatter plots, vector fields, etc.
-
-- Tests!
-
-Possible future work:
-
-- Break animation javascript code off into a separate file that's only included when the plot contains animation. (smaller file size, less bandwidth, more modular)
-
-- Interpolate/blend/morph between keyframes in order to improve the appearance of the animations, and allow it to be disabled. Some ideas include:
-  - Fade keyframes in and out (via object opacity).
-  - Identify corresponding objects between frames and interpolate their transforms and/or geometries.
-  - Image-based blending: render the two keyframes you're between (for N variables, the min/max corners of the N-box) then blend them while rendering to a textured screen-size quad.
-
-- Performance improvements due to the # of objects animation may add to the scene: 
-  - Use Buffer Geometry instead of Geometry.
-  - Merge identical objects and use instanced rendering.
-  - Merge geometries that share a material and use range-restricted draws.
``````




---

archive/issue_comments_569267.json:
```json
{
    "body": "<a id='comment:32'></a>\nThanks! Do open a follow-up ticket if some items\nwere not covered here but would make sense.",
    "created_at": "2020-07-28T01:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569267",
    "user": "https://github.com/slel"
}
```

<a id='comment:32'></a>
Thanks! Do open a follow-up ticket if some items
were not covered here but would make sense.



---

archive/issue_comments_569268.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-28T22:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569268",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_569269.json:
```json
{
    "body": "Changing branch from \"u/gh-jcamp0x2a/29194-threejs-animation\" to \"8af227dc286a4659c213a72b2a5ee69fe9d9e88f\"",
    "created_at": "2020-07-28T22:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29194#issuecomment-569269",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gh-jcamp0x2a/29194-threejs-animation" to "8af227dc286a4659c213a72b2a5ee69fe9d9e88f"



---

archive/issue_events_074163.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-28T22:31:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29194",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29194#event-74163"
}
```
