# Issue 29143: tox.ini update: Fix breakage caused by src/ext move, add 32-bit linux environments and other architectures supported by docker

archive/issues_028906.json:
```json
{
    "body": "#29053 added `tox.ini` to support testing the sage distribution in isolated environments via docker.\n\nIn 9.1.beta6, the generated docker files do not work due to #21785.\n\nThis ticket fixes it and also adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).\n\nExamples:\n\n```\n$ tox -e docker-debian-buster-standard-i386\n$ tox -e docker-ubuntu-bionic-standard-arm64\n$ tox -e docker-ubuntu-bionic-minimal-armhf\n$ tox -e docker-fedora-31-standard-arm64v8         # Docker for Mac only\n$ tox -e docker-ubuntu-latest-standard-s390x       # Docker for Mac only\n```\n\n(The last two work with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.)\n\nSee also: https://trac.sagemath.org/wiki/ExoticPorts\n\n---\n\nResources:\n- How to Build and Run ARM Docker Containers on x86 Hosts \u00b7 MatchboxBlog - https://matchboxdorry.gitbooks.io/matchboxblog/content/blogs/build_and_run_arm_images.html\n- Cross Building and Running Multi-Arch Docker Images \u2013 Micheal Waltz \u2013 DevOps Engineer - https://www.ecliptik.com/Cross-Building-and-Running-Multi-Arch-Docker-Images/\n- multiarch/qemu-user-static - Docker Hub - https://hub.docker.com/r/multiarch/qemu-user-static/\n- multiarch/ubuntu-core - Docker Hub - https://hub.docker.com/r/multiarch/ubuntu-core/\n\n\nCC:  @vbraun tmonteil @kiwifb @dimpase\n\nBranch/Commit: 7f122bdda3253eeb23cef16c495491890f712959\n\nReviewer: Volker Braun\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29143\n\n",
    "closed_at": "2020-03-03T23:21:26Z",
    "created_at": "2020-02-02T17:33:59Z",
    "labels": [
        "component: porting"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "tox.ini update: Fix breakage caused by src/ext move, add 32-bit linux environments and other architectures supported by docker",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29143",
    "user": "https://github.com/mkoeppe"
}
```
#29053 added `tox.ini` to support testing the sage distribution in isolated environments via docker.

In 9.1.beta6, the generated docker files do not work due to #21785.

This ticket fixes it and also adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).

Examples:

```
$ tox -e docker-debian-buster-standard-i386
$ tox -e docker-ubuntu-bionic-standard-arm64
$ tox -e docker-ubuntu-bionic-minimal-armhf
$ tox -e docker-fedora-31-standard-arm64v8         # Docker for Mac only
$ tox -e docker-ubuntu-latest-standard-s390x       # Docker for Mac only
```

(The last two work with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.)

See also: https://trac.sagemath.org/wiki/ExoticPorts

---

Resources:
- How to Build and Run ARM Docker Containers on x86 Hosts · MatchboxBlog - https://matchboxdorry.gitbooks.io/matchboxblog/content/blogs/build_and_run_arm_images.html
- Cross Building and Running Multi-Arch Docker Images – Micheal Waltz – DevOps Engineer - https://www.ecliptik.com/Cross-Building-and-Running-Multi-Arch-Docker-Images/
- multiarch/qemu-user-static - Docker Hub - https://hub.docker.com/r/multiarch/qemu-user-static/
- multiarch/ubuntu-core - Docker Hub - https://hub.docker.com/r/multiarch/ubuntu-core/


CC:  @vbraun tmonteil @kiwifb @dimpase

Branch/Commit: 7f122bdda3253eeb23cef16c495491890f712959

Reviewer: Volker Braun

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29143





---

archive/issue_comments_568145.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,4 @@\n \n This ticket adds some 32-bit linux environments such as https://hub.docker.com/r/i386/ubuntu/\n \n+https://github.com/docker-library/official-images#architectures-other-than-amd64\n``````\n",
    "created_at": "2020-02-02T17:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568145",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,4 @@
 
 This ticket adds some 32-bit linux environments such as https://hub.docker.com/r/i386/ubuntu/
 
+https://github.com/docker-library/official-images#architectures-other-than-amd64
``````




---

archive/issue_comments_568146.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29053, #29104\"",
    "created_at": "2020-02-02T17:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568146",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29053, #29104"



---

archive/issue_comments_568147.json:
```json
{
    "body": "<a id='comment:2'></a>\non top of #29104 to avoid merge conflicts",
    "created_at": "2020-02-02T17:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568147",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
on top of #29104 to avoid merge conflicts



---

archive/issue_comments_568148.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/add_to_tox_ini_some_32_bit_linux_environments\"",
    "created_at": "2020-02-02T19:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568148",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/add_to_tox_ini_some_32_bit_linux_environments"



---

archive/issue_comments_568149.json:
```json
{
    "body": "Changing commit from \"\" to \"839d6fbb5685b21b03fdb61cac352fae7611b186\"",
    "created_at": "2020-02-02T19:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568149",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "839d6fbb5685b21b03fdb61cac352fae7611b186"



---

archive/issue_comments_568150.json:
```json
{
    "body": "<a id='comment:4'></a>\nLast 10 new commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[98edff6](https://git.sagemath.org/sage.git/commit?id=98edff6be135e9b3c3cd0ef8adfde4e5fff3ac90)|`Add build/pkgs/gfortran/distros/fedora.txt`|\n|[843ca76](https://git.sagemath.org/sage.git/commit?id=843ca764bdbf9385aed1b69b7928b91871363ee9)|`build/pkgs/fedora.txt: Add python3`|\n|[bd6a545](https://git.sagemath.org/sage.git/commit?id=bd6a5457b27b498115ed43171b38a129ba5de50d)|`tox.ini: Add debian stretch, put sid last`|\n|[23c6334](https://git.sagemath.org/sage.git/commit?id=23c6334cf2927a4d917a27b3963471e8242d86a3)|`build/pkgs/openblas/distros/arch.txt: Add lapack, cblas`|\n|[fca6654](https://git.sagemath.org/sage.git/commit?id=fca66540d85d7989d84c8551793f029533a8232d)|`tox.ini: Add toxenvs local-homebrew-macos-minimal, local-homebrew-macos-standard`|\n|[e0e8a4c](https://git.sagemath.org/sage.git/commit?id=e0e8a4c7be40336fa140195a213f9edf3075f6ee)|`tox.ini [local-homebrew]: Fixup PATH, PKG_CONFIG_PATH, set LDFLAGS, CPPFLAGS; [local-direct]: New`|\n|[16ca88f](https://git.sagemath.org/sage.git/commit?id=16ca88f3423ea20dcb164cd1e7b5bc0283fcec0b)|`tox.ini: Use {envlogdir}; use ln -sf`|\n|[6a1803d](https://git.sagemath.org/sage.git/commit?id=6a1803dae669007dcc7005448a1e578bcc950656)|`tox.ini [local]: First build the base-toolchain`|\n|[4b72987](https://git.sagemath.org/sage.git/commit?id=4b72987e58ff284f57f04d4fbb5fed8f39beb36d)|`tox.ini [local-homebrew]: Set PATH earlier and set ACLOCAL_PATH for bootstrapping`|\n|[839d6fb](https://git.sagemath.org/sage.git/commit?id=839d6fbb5685b21b03fdb61cac352fae7611b186)|`tox.ini: Add other archs supported by docker`|",
    "created_at": "2020-02-02T19:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568150",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Last 10 new commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[98edff6](https://git.sagemath.org/sage.git/commit?id=98edff6be135e9b3c3cd0ef8adfde4e5fff3ac90)|`Add build/pkgs/gfortran/distros/fedora.txt`|
|[843ca76](https://git.sagemath.org/sage.git/commit?id=843ca764bdbf9385aed1b69b7928b91871363ee9)|`build/pkgs/fedora.txt: Add python3`|
|[bd6a545](https://git.sagemath.org/sage.git/commit?id=bd6a5457b27b498115ed43171b38a129ba5de50d)|`tox.ini: Add debian stretch, put sid last`|
|[23c6334](https://git.sagemath.org/sage.git/commit?id=23c6334cf2927a4d917a27b3963471e8242d86a3)|`build/pkgs/openblas/distros/arch.txt: Add lapack, cblas`|
|[fca6654](https://git.sagemath.org/sage.git/commit?id=fca66540d85d7989d84c8551793f029533a8232d)|`tox.ini: Add toxenvs local-homebrew-macos-minimal, local-homebrew-macos-standard`|
|[e0e8a4c](https://git.sagemath.org/sage.git/commit?id=e0e8a4c7be40336fa140195a213f9edf3075f6ee)|`tox.ini [local-homebrew]: Fixup PATH, PKG_CONFIG_PATH, set LDFLAGS, CPPFLAGS; [local-direct]: New`|
|[16ca88f](https://git.sagemath.org/sage.git/commit?id=16ca88f3423ea20dcb164cd1e7b5bc0283fcec0b)|`tox.ini: Use {envlogdir}; use ln -sf`|
|[6a1803d](https://git.sagemath.org/sage.git/commit?id=6a1803dae669007dcc7005448a1e578bcc950656)|`tox.ini [local]: First build the base-toolchain`|
|[4b72987](https://git.sagemath.org/sage.git/commit?id=4b72987e58ff284f57f04d4fbb5fed8f39beb36d)|`tox.ini [local-homebrew]: Set PATH earlier and set ACLOCAL_PATH for bootstrapping`|
|[839d6fb](https://git.sagemath.org/sage.git/commit?id=839d6fbb5685b21b03fdb61cac352fae7611b186)|`tox.ini: Add other archs supported by docker`|



---

archive/issue_comments_568151.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-02T19:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568151",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_568152.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,13 @@\n #29053 adds `tox.ini` to support testing the sage distribution in isolated environments via docker.\n \n-This ticket adds some 32-bit linux environments such as https://hub.docker.com/r/i386/ubuntu/\n+This ticket adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).\n \n-https://github.com/docker-library/official-images#architectures-other-than-amd64\n+Examples:\n+\n+```\n+$ tox -e docker-fedora-31-standard-arm64v8\n+$ tox -e docker-debian-buster-standard-i386\n+$ tox -e docker-ubuntu-latest-standard-s390x\n+```\n+\n+}}}\n``````\n",
    "created_at": "2020-02-02T19:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568152",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,13 @@
 #29053 adds `tox.ini` to support testing the sage distribution in isolated environments via docker.
 
-This ticket adds some 32-bit linux environments such as https://hub.docker.com/r/i386/ubuntu/
+This ticket adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).
 
-https://github.com/docker-library/official-images#architectures-other-than-amd64
+Examples:
+
+```
+$ tox -e docker-fedora-31-standard-arm64v8
+$ tox -e docker-debian-buster-standard-i386
+$ tox -e docker-ubuntu-latest-standard-s390x
+```
+
+}}}
``````




---

archive/issue_comments_568153.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-02-02T19:23:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568153",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_568154.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------|\n|[67e14ce](https://git.sagemath.org/sage.git/commit/?id=67e14ce486e6cbb73c50dd9af61a95c2395e1ebd)|`fixup for llocal`|",
    "created_at": "2020-02-02T21:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568154",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------|
|[67e14ce](https://git.sagemath.org/sage.git/commit/?id=67e14ce486e6cbb73c50dd9af61a95c2395e1ebd)|`fixup for llocal`|



---

archive/issue_comments_568155.json:
```json
{
    "body": "Changing commit from \"839d6fbb5685b21b03fdb61cac352fae7611b186\" to \"67e14ce486e6cbb73c50dd9af61a95c2395e1ebd\"",
    "created_at": "2020-02-02T21:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568155",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "839d6fbb5685b21b03fdb61cac352fae7611b186" to "67e14ce486e6cbb73c50dd9af61a95c2395e1ebd"



---

archive/issue_comments_568156.json:
```json
{
    "body": "<a id='comment:7'></a>\nThis works on macOS because it is running everything in a virtualbox.\n\nI haven't succeeded in getting it to work on github actions yet. last attempt: https://github.com/mkoeppe/sage/runs/422184737?check_suite_focus=true",
    "created_at": "2020-02-03T14:07:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568156",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
This works on macOS because it is running everything in a virtualbox.

I haven't succeeded in getting it to work on github actions yet. last attempt: https://github.com/mkoeppe/sage/runs/422184737?check_suite_focus=true



---

archive/issue_comments_568157.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,4 +10,3 @@\n $ tox -e docker-ubuntu-latest-standard-s390x\n ```\n \n-}}}\n``````\n",
    "created_at": "2020-02-03T14:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568157",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,4 +10,3 @@
 $ tox -e docker-ubuntu-latest-standard-s390x
 ```
 
-}}}
``````




---

archive/issue_comments_568158.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,9 @@\n $ tox -e docker-ubuntu-latest-standard-s390x\n ```\n \n+This works out of the box with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.\n+- How to Build and Run ARM Docker Containers on x86 Hosts \u00b7 MatchboxBlog - https://matchboxdorry.gitbooks.io/matchboxblog/content/blogs/build_and_run_arm_images.html\n+- Cross Building and Running Multi-Arch Docker Images \u2013 Micheal Waltz \u2013 DevOps Engineer - https://www.ecliptik.com/Cross-Building-and-Running-Multi-Arch-Docker-Images/\n+- multiarch/qemu-user-static - Docker Hub - https://hub.docker.com/r/multiarch/qemu-user-static/\n+- multiarch/ubuntu-core - Docker Hub - https://hub.docker.com/r/multiarch/ubuntu-core/\n+\n``````\n",
    "created_at": "2020-02-04T22:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568158",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,9 @@
 $ tox -e docker-ubuntu-latest-standard-s390x
 ```
 
+This works out of the box with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.
+- How to Build and Run ARM Docker Containers on x86 Hosts · MatchboxBlog - https://matchboxdorry.gitbooks.io/matchboxblog/content/blogs/build_and_run_arm_images.html
+- Cross Building and Running Multi-Arch Docker Images – Micheal Waltz – DevOps Engineer - https://www.ecliptik.com/Cross-Building-and-Running-Multi-Arch-Docker-Images/
+- multiarch/qemu-user-static - Docker Hub - https://hub.docker.com/r/multiarch/qemu-user-static/
+- multiarch/ubuntu-core - Docker Hub - https://hub.docker.com/r/multiarch/ubuntu-core/
+
``````




---

archive/issue_comments_568159.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[2141b75](https://git.sagemath.org/sage.git/commit/?id=2141b7536c5b99a26d16568dcc0d734518bebc58)|`Merge tag '9.1.beta3' into t/29104/tox-homebrew`|\n|[2b0a25e](https://git.sagemath.org/sage.git/commit/?id=2b0a25e0b81bef9518059bdd3f0f8a58699ceb5c)|`tox.ini: Add other archs supported by docker`|\n|[e3f832c](https://git.sagemath.org/sage.git/commit/?id=e3f832c1cdc3e671ea4f6ee48e8949b336ff5d64)|`fixup for llocal`|\n|[b5361e2](https://git.sagemath.org/sage.git/commit/?id=b5361e25660b4f2f5afd9e48866c6b341ea70cfa)|`tox.ini: Restructure docker image:tag construction, add multiarch for Linux Docker`|",
    "created_at": "2020-02-06T14:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568159",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[2141b75](https://git.sagemath.org/sage.git/commit/?id=2141b7536c5b99a26d16568dcc0d734518bebc58)|`Merge tag '9.1.beta3' into t/29104/tox-homebrew`|
|[2b0a25e](https://git.sagemath.org/sage.git/commit/?id=2b0a25e0b81bef9518059bdd3f0f8a58699ceb5c)|`tox.ini: Add other archs supported by docker`|
|[e3f832c](https://git.sagemath.org/sage.git/commit/?id=e3f832c1cdc3e671ea4f6ee48e8949b336ff5d64)|`fixup for llocal`|
|[b5361e2](https://git.sagemath.org/sage.git/commit/?id=b5361e25660b4f2f5afd9e48866c6b341ea70cfa)|`tox.ini: Restructure docker image:tag construction, add multiarch for Linux Docker`|



---

archive/issue_comments_568160.json:
```json
{
    "body": "Changing commit from \"67e14ce486e6cbb73c50dd9af61a95c2395e1ebd\" to \"b5361e25660b4f2f5afd9e48866c6b341ea70cfa\"",
    "created_at": "2020-02-06T14:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568160",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "67e14ce486e6cbb73c50dd9af61a95c2395e1ebd" to "b5361e25660b4f2f5afd9e48866c6b341ea70cfa"



---

archive/issue_comments_568161.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,9 +5,11 @@\n Examples:\n \n ```\n-$ tox -e docker-fedora-31-standard-arm64v8\n $ tox -e docker-debian-buster-standard-i386\n-$ tox -e docker-ubuntu-latest-standard-s390x\n+$ tox -e docker-ubuntu-bionic-standard-arm64\n+$ tox -e docker-ubuntu-bionic-minimal-armhf\n+$ tox -e docker-fedora-31-standard-arm64v8         # Docker for Mac only\n+$ tox -e docker-ubuntu-latest-standard-s390x       # Docker for Mac only\n ```\n \n This works out of the box with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.\n``````\n",
    "created_at": "2020-02-06T14:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568161",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,9 +5,11 @@
 Examples:
 
 ```
-$ tox -e docker-fedora-31-standard-arm64v8
 $ tox -e docker-debian-buster-standard-i386
-$ tox -e docker-ubuntu-latest-standard-s390x
+$ tox -e docker-ubuntu-bionic-standard-arm64
+$ tox -e docker-ubuntu-bionic-minimal-armhf
+$ tox -e docker-fedora-31-standard-arm64v8         # Docker for Mac only
+$ tox -e docker-ubuntu-latest-standard-s390x       # Docker for Mac only
 ```
 
 This works out of the box with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.
``````




---

archive/issue_comments_568162.json:
```json
{
    "body": "Changing dependencies from \"#29053, #29104\" to \"#29104\"",
    "created_at": "2020-02-06T14:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568162",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29053, #29104" to "#29104"



---

archive/issue_comments_568163.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,13 @@\n $ tox -e docker-ubuntu-latest-standard-s390x       # Docker for Mac only\n ```\n \n-This works out of the box with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.\n+(The last two work with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.)\n+\n+The branch is on top of #29104 (homebrew).\n+\n+---\n+\n+Resources:\n - How to Build and Run ARM Docker Containers on x86 Hosts \u00b7 MatchboxBlog - https://matchboxdorry.gitbooks.io/matchboxblog/content/blogs/build_and_run_arm_images.html\n - Cross Building and Running Multi-Arch Docker Images \u2013 Micheal Waltz \u2013 DevOps Engineer - https://www.ecliptik.com/Cross-Building-and-Running-Multi-Arch-Docker-Images/\n - multiarch/qemu-user-static - Docker Hub - https://hub.docker.com/r/multiarch/qemu-user-static/\n``````\n",
    "created_at": "2020-02-06T14:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568163",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,13 @@
 $ tox -e docker-ubuntu-latest-standard-s390x       # Docker for Mac only
 ```
 
-This works out of the box with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.
+(The last two work with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.)
+
+The branch is on top of #29104 (homebrew).
+
+---
+
+Resources:
 - How to Build and Run ARM Docker Containers on x86 Hosts · MatchboxBlog - https://matchboxdorry.gitbooks.io/matchboxblog/content/blogs/build_and_run_arm_images.html
 - Cross Building and Running Multi-Arch Docker Images – Micheal Waltz – DevOps Engineer - https://www.ecliptik.com/Cross-Building-and-Running-Multi-Arch-Docker-Images/
 - multiarch/qemu-user-static - Docker Hub - https://hub.docker.com/r/multiarch/qemu-user-static/
``````




---

archive/issue_comments_568164.json:
```json
{
    "body": "<a id='comment:13'></a>\nTests run at https://github.com/mkoeppe/sage/actions/runs/35630769",
    "created_at": "2020-02-06T21:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568164",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Tests run at https://github.com/mkoeppe/sage/actions/runs/35630769



---

archive/issue_comments_568165.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,6 +16,8 @@\n \n The branch is on top of #29104 (homebrew).\n \n+See also: https://trac.sagemath.org/wiki/ExoticPorts\n+\n ---\n \n Resources:\n``````\n",
    "created_at": "2020-02-08T23:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568165",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,6 +16,8 @@
 
 The branch is on top of #29104 (homebrew).
 
+See also: https://trac.sagemath.org/wiki/ExoticPorts
+
 ---
 
 Resources:
``````




---

archive/issue_comments_568166.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[4350d0a](https://git.sagemath.org/sage.git/commit/?id=4350d0a075d7291de9a21b134dc309945bdc0850)|`tox.ini: Add raspbian`|",
    "created_at": "2020-02-09T15:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568166",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[4350d0a](https://git.sagemath.org/sage.git/commit/?id=4350d0a075d7291de9a21b134dc309945bdc0850)|`tox.ini: Add raspbian`|



---

archive/issue_comments_568167.json:
```json
{
    "body": "Changing commit from \"b5361e25660b4f2f5afd9e48866c6b341ea70cfa\" to \"4350d0a075d7291de9a21b134dc309945bdc0850\"",
    "created_at": "2020-02-09T15:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568167",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b5361e25660b4f2f5afd9e48866c6b341ea70cfa" to "4350d0a075d7291de9a21b134dc309945bdc0850"



---

archive/issue_comments_568168.json:
```json
{
    "body": "<a id='comment:16'></a>\nAlso this ticket needs review and would facilitate testing on 32bit x86 and ARM",
    "created_at": "2020-02-10T21:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568168",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Also this ticket needs review and would facilitate testing on 32bit x86 and ARM



---

archive/issue_comments_568169.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n|[59e1d6f](https://git.sagemath.org/sage.git/commit/?id=59e1d6fb6cfeb0b1effa860e7c4b325fd3fdbdf8)|`Merge tag '9.1.beta4' into t/29143/add_to_tox_ini_some_32_bit_linux_environments`|",
    "created_at": "2020-02-16T18:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|[59e1d6f](https://git.sagemath.org/sage.git/commit/?id=59e1d6fb6cfeb0b1effa860e7c4b325fd3fdbdf8)|`Merge tag '9.1.beta4' into t/29143/add_to_tox_ini_some_32_bit_linux_environments`|



---

archive/issue_comments_568170.json:
```json
{
    "body": "Changing commit from \"4350d0a075d7291de9a21b134dc309945bdc0850\" to \"59e1d6fb6cfeb0b1effa860e7c4b325fd3fdbdf8\"",
    "created_at": "2020-02-16T18:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4350d0a075d7291de9a21b134dc309945bdc0850" to "59e1d6fb6cfeb0b1effa860e7c4b325fd3fdbdf8"



---

archive/issue_comments_568171.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[4eb201b](https://git.sagemath.org/sage.git/commit/?id=4eb201b75f75fbbe526b84de9b52f2ba0ea3ef0e)|`Merge tag '9.1.beta4' into t/29104/tox-homebrew`|\n|[254753d](https://git.sagemath.org/sage.git/commit/?id=254753d75d332f231a121e58cabc3aef3b7170b5)|`Merge branch 't/29104/tox-homebrew' into t/29143/add_to_tox_ini_some_32_bit_linux_environments`|",
    "created_at": "2020-02-16T20:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[4eb201b](https://git.sagemath.org/sage.git/commit/?id=4eb201b75f75fbbe526b84de9b52f2ba0ea3ef0e)|`Merge tag '9.1.beta4' into t/29104/tox-homebrew`|
|[254753d](https://git.sagemath.org/sage.git/commit/?id=254753d75d332f231a121e58cabc3aef3b7170b5)|`Merge branch 't/29104/tox-homebrew' into t/29143/add_to_tox_ini_some_32_bit_linux_environments`|



---

archive/issue_comments_568172.json:
```json
{
    "body": "Changing commit from \"59e1d6fb6cfeb0b1effa860e7c4b325fd3fdbdf8\" to \"254753d75d332f231a121e58cabc3aef3b7170b5\"",
    "created_at": "2020-02-16T20:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "59e1d6fb6cfeb0b1effa860e7c4b325fd3fdbdf8" to "254753d75d332f231a121e58cabc3aef3b7170b5"



---

archive/issue_comments_568173.json:
```json
{
    "body": "Changing commit from \"254753d75d332f231a121e58cabc3aef3b7170b5\" to \"7f122bdda3253eeb23cef16c495491890f712959\"",
    "created_at": "2020-03-02T02:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "254753d75d332f231a121e58cabc3aef3b7170b5" to "7f122bdda3253eeb23cef16c495491890f712959"



---

archive/issue_comments_568174.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[749f83e](https://git.sagemath.org/sage.git/commit/?id=749f83e1a74b3b0628bc372c413199103f8188c7)|`tox.ini: Add other archs supported by docker`|\n|[e941bd5](https://git.sagemath.org/sage.git/commit/?id=e941bd55340543b822ab2088b0ca52f49dab5c40)|`fixup for llocal`|\n|[2441fe9](https://git.sagemath.org/sage.git/commit/?id=2441fe9c1443fbdcc9bfc50cca7f7a113ae2e545)|`tox.ini: Restructure docker image:tag construction, add multiarch for Linux Docker`|\n|[2f057cb](https://git.sagemath.org/sage.git/commit/?id=2f057cb8652617283ef27737b8e6b3e970d8d7c3)|`tox.ini: Add raspbian`|\n|[7f122bd](https://git.sagemath.org/sage.git/commit/?id=7f122bdda3253eeb23cef16c495491890f712959)|`build/bin/write-dockerfile.sh: src/ext has moved and is no longer needed for the configure phase`|",
    "created_at": "2020-03-02T02:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[749f83e](https://git.sagemath.org/sage.git/commit/?id=749f83e1a74b3b0628bc372c413199103f8188c7)|`tox.ini: Add other archs supported by docker`|
|[e941bd5](https://git.sagemath.org/sage.git/commit/?id=e941bd55340543b822ab2088b0ca52f49dab5c40)|`fixup for llocal`|
|[2441fe9](https://git.sagemath.org/sage.git/commit/?id=2441fe9c1443fbdcc9bfc50cca7f7a113ae2e545)|`tox.ini: Restructure docker image:tag construction, add multiarch for Linux Docker`|
|[2f057cb](https://git.sagemath.org/sage.git/commit/?id=2f057cb8652617283ef27737b8e6b3e970d8d7c3)|`tox.ini: Add raspbian`|
|[7f122bd](https://git.sagemath.org/sage.git/commit/?id=7f122bdda3253eeb23cef16c495491890f712959)|`build/bin/write-dockerfile.sh: src/ext has moved and is no longer needed for the configure phase`|



---

archive/issue_comments_568175.json:
```json
{
    "body": "Changing dependencies from \"#29104\" to \"\"",
    "created_at": "2020-03-02T02:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568175",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29104" to ""



---

archive/issue_comments_568176.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n-#29053 adds `tox.ini` to support testing the sage distribution in isolated environments via docker.\n+#29053 added `tox.ini` to support testing the sage distribution in isolated environments via docker.\n \n-This ticket adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).\n+In 9.1.beta6, the generated docker files do not work due to #21785.\n+\n+This ticket fixes it and also adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).\n \n Examples:\n \n@@ -14,8 +16,6 @@\n \n (The last two work with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.)\n \n-The branch is on top of #29104 (homebrew).\n-\n See also: https://trac.sagemath.org/wiki/ExoticPorts\n \n ---\n``````\n",
    "created_at": "2020-03-02T02:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568176",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,8 @@
-#29053 adds `tox.ini` to support testing the sage distribution in isolated environments via docker.
+#29053 added `tox.ini` to support testing the sage distribution in isolated environments via docker.
 
-This ticket adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).
+In 9.1.beta6, the generated docker files do not work due to #21785.
+
+This ticket fixes it and also adds linux environments for various other architectures supported by docker (see https://github.com/docker-library/official-images#architectures-other-than-amd64).
 
 Examples:
 
@@ -14,8 +16,6 @@
 
 (The last two work with macOS Docker Desktop because it has `binfmt_misc` with `qemu` enabled.)
 
-The branch is on top of #29104 (homebrew).
-
 See also: https://trac.sagemath.org/wiki/ExoticPorts
 
 ---
``````




---

archive/issue_comments_568177.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe branch is no longer on top of #29104 (homebrew). \n\nNeeds review.",
    "created_at": "2020-03-02T02:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568177",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
The branch is no longer on top of #29104 (homebrew). 

Needs review.



---

archive/issue_comments_568178.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-02T23:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568178",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_568179.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2020-03-02T23:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568179",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_568180.json:
```json
{
    "body": "<a id='comment:22'></a>\nThanks!",
    "created_at": "2020-03-02T23:33:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568180",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Thanks!



---

archive/issue_events_073944.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-03T23:21:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29143#event-73944"
}
```



---

archive/issue_comments_568181.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-03T23:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568181",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_568182.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/add_to_tox_ini_some_32_bit_linux_environments\" to \"7f122bdda3253eeb23cef16c495491890f712959\"",
    "created_at": "2020-03-03T23:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29143#issuecomment-568182",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/add_to_tox_ini_some_32_bit_linux_environments" to "7f122bdda3253eeb23cef16c495491890f712959"
