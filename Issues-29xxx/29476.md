# Issue 29476: Improvement on numerical modular symbols

archive/issues_029239.json:
```json
{
    "assignees": [],
    "body": "This is a follow up ticket on the recently closed #21046, where new code for numerical modular symbols for elliptic curves was added.\n\n1. Issue\n\n```\nsage: E = EllipticCurve(\"20a1\")\nsage: m = E.modular_symbol_numerical()\nsage: m(1/2)\n```\nfails as it attempts to use the code for unitary cusps.\n\n2. Bug\n\n```\nsage: E = EllipticCurve(\"361a1\")\nsage: ms = E.modular_symbol(+1,implementation=\"num\")\nsage: ms(1/19)\n158837/603592\nsage: _*19.\n4.99990556534878\n```\nis a problem with rounding. The correct value is 5/19.\n\n\nCC:  @varenyamBakshi @JohnCremona\n\nKeywords: **modular symbols**\n\nBranch/Commit: **[`0fb6294`](https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134)**\n\nReviewer: **Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Chris Wuthrich**\n\nComponent: **elliptic curves**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29476_\n\n",
    "closed_at": "2020-05-26T21:44:08Z",
    "created_at": "2020-04-07T21:04:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20modular%20forms"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improvement on numerical modular symbols",
    "type": "issue",
    "updated_at": "2020-05-26T21:44:08Z",
    "url": "https://github.com/sagemath/sage/issues/29476",
    "user": "https://github.com/categorie"
}
```
This is a follow up ticket on the recently closed #21046, where new code for numerical modular symbols for elliptic curves was added.

1. Issue

```
sage: E = EllipticCurve("20a1")
sage: m = E.modular_symbol_numerical()
sage: m(1/2)
```
fails as it attempts to use the code for unitary cusps.

2. Bug

```
sage: E = EllipticCurve("361a1")
sage: ms = E.modular_symbol(+1,implementation="num")
sage: ms(1/19)
158837/603592
sage: _*19.
4.99990556534878
```
is a problem with rounding. The correct value is 5/19.


CC:  @varenyamBakshi @JohnCremona

Keywords: **modular symbols**

Branch/Commit: **[`0fb6294`](https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134)**

Reviewer: **Vincent Delecroix, Frédéric Chapoton**

Author: **Chris Wuthrich**

Component: **elliptic curves**

_Issue created by migration from https://trac.sagemath.org/ticket/29476_





---

archive/issue_events_402331.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-07T21:04:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402331"
}
```



---

archive/issue_events_402332.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-07T21:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402332"
}
```



---

archive/issue_events_402333.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-07T21:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402333"
}
```



---

archive/issue_events_402334.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-07T21:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402334"
}
```



---

archive/issue_events_402335.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-07T21:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20modular%20forms",
    "label_color": "0000ff",
    "label_name": "c: modular forms",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402335"
}
```



---

archive/issue_events_402336.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402336"
}
```



---

archive/issue_events_402337.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402337"
}
```



---

archive/issue_comments_463174.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463174",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_463175.json:
```json
{
    "body": "Branch: **[u/wuthrich/trac_29476](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476)**",
    "created_at": "2020-04-19T13:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463175",
    "user": "https://github.com/categorie"
}
```

Branch: **[u/wuthrich/trac_29476](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476)**



---

archive/issue_comments_463176.json:
```json
{
    "body": "Commit: **[`1e9f0d6`](https://github.com/sagemath/sagetrac-mirror/commit/1e9f0d60b3139d71db810858dbea4104105729e5)**",
    "created_at": "2020-04-19T13:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463176",
    "user": "https://github.com/categorie"
}
```

Commit: **[`1e9f0d6`](https://github.com/sagemath/sagetrac-mirror/commit/1e9f0d60b3139d71db810858dbea4104105729e5)**



---

archive/issue_comments_463177.json:
```json
{
    "body": "Author: **Chris Wuthrich**",
    "created_at": "2020-04-19T13:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463177",
    "user": "https://github.com/categorie"
}
```

Author: **Chris Wuthrich**



---

archive/issue_comments_463178.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1792753d84ca88bb2dd03dd2dab7924ce7c18f63\"><code>1792753</code></a></td><td><code>numerical approximation modular symbols should work for non-unitary cusps</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3468851e166b38937ce7e7bc17fdca71eeb2cb92\"><code>3468851</code></a></td><td><code>trac #29476: transportable case can use unitary eps</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2fca84ef432eb9418b95c8ac9f96751303bf0895\"><code>2fca84e</code></a></td><td><code>trac #29476: improve denominator bound</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e9f0d60b3139d71db810858dbea4104105729e5\"><code>1e9f0d6</code></a></td><td><code>trac #29476: allow short cut again</code></td></tr></table>\n",
    "created_at": "2020-04-19T13:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463178",
    "user": "https://github.com/categorie"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1792753d84ca88bb2dd03dd2dab7924ce7c18f63"><code>1792753</code></a></td><td><code>numerical approximation modular symbols should work for non-unitary cusps</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3468851e166b38937ce7e7bc17fdca71eeb2cb92"><code>3468851</code></a></td><td><code>trac #29476: transportable case can use unitary eps</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2fca84ef432eb9418b95c8ac9f96751303bf0895"><code>2fca84e</code></a></td><td><code>trac #29476: improve denominator bound</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e9f0d60b3139d71db810858dbea4104105729e5"><code>1e9f0d6</code></a></td><td><code>trac #29476: allow short cut again</code></td></tr></table>




---

archive/issue_comments_463179.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,4 +21,3 @@\n ```\n is a problem with rounding. The correct value is 5/19.\n \n-I will continue to ad if I find things. But if part is solved I will move it on to a next tickets to separate issues when possible.\n``````\n",
    "created_at": "2020-04-19T13:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463179",
    "user": "https://github.com/categorie"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,4 +21,3 @@
 ```
 is a problem with rounding. The correct value is 5/19.
 
-I will continue to ad if I find things. But if part is solved I will move it on to a next tickets to separate issues when possible.
``````




---

archive/issue_events_402338.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-19T13:17:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402338"
}
```



---

archive/issue_comments_463180.json:
```json
{
    "body": "Changed commit from **[`1e9f0d6`](https://github.com/sagemath/sagetrac-mirror/commit/1e9f0d60b3139d71db810858dbea4104105729e5)** to **[`ad99f7d`](https://github.com/sagemath/sagetrac-mirror/commit/ad99f7d5bd1ca81a65f8e4aa8079299b068cbc6d)**",
    "created_at": "2020-04-19T16:02:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463180",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1e9f0d6`](https://github.com/sagemath/sagetrac-mirror/commit/1e9f0d60b3139d71db810858dbea4104105729e5)** to **[`ad99f7d`](https://github.com/sagemath/sagetrac-mirror/commit/ad99f7d5bd1ca81a65f8e4aa8079299b068cbc6d)**



---

archive/issue_comments_463181.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad99f7d5bd1ca81a65f8e4aa8079299b068cbc6d\"><code>ad99f7d</code></a></td><td><code>allow numercial padic L-functions and adjust precise outputs</code></td></tr></table>\n",
    "created_at": "2020-04-19T16:02:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463181",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad99f7d5bd1ca81a65f8e4aa8079299b068cbc6d"><code>ad99f7d</code></a></td><td><code>allow numercial padic L-functions and adjust precise outputs</code></td></tr></table>




---

archive/issue_comments_463182.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nPlease don't do\n\n```\n             sage: f(1/7)      # abs tol 1e-4\n-            1.00001356670155\n+            0.999844176260303\n```\nIf the expected value is `1.0` just write\n\n```\nsage: f(1/7)      # abs tol 1e-4\n1.0\n```\nThe `abs tol` keyword is exactly here to take care of the numerical noise.",
    "created_at": "2020-04-23T16:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463182",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

Please don't do

```
             sage: f(1/7)      # abs tol 1e-4
-            1.00001356670155
+            0.999844176260303
```
If the expected value is `1.0` just write

```
sage: f(1/7)      # abs tol 1e-4
1.0
```
The `abs tol` keyword is exactly here to take care of the numerical noise.



---

archive/issue_comments_463183.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSimilar here\n\n```\n     sage: Mn(3/123)       # abs tol 1e-10\n-    3.00000000000001\n+    3.00000000000018\n```\nJust use `3.0`.",
    "created_at": "2020-04-23T16:40:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463183",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

Similar here

```
     sage: Mn(3/123)       # abs tol 1e-10
-    3.00000000000001
+    3.00000000000018
```
Just use `3.0`.



---

archive/issue_comments_463184.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2020-04-23T16:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463184",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_402339.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-23T16:41:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402339"
}
```



---

archive/issue_events_402340.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-23T16:41:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402340"
}
```



---

archive/issue_comments_463185.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYou must also remove trailing whitespaces (spaces before end of line).",
    "created_at": "2020-04-23T16:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463185",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

You must also remove trailing whitespaces (spaces before end of line).



---

archive/issue_comments_463186.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@videlec](#comment:5):\n\nI see your point, but surprisingly I disagree. The algorithm produces a floating point number that is within a given precision of the correct result. It is NOT suppose to return the exact value. It will be off and up to a much higher precision all hardware should return the same number. The abs tol that I set is higher than whan is guaranteed by the algorithm.\n\nThis ticket changes some behaviour of the algorithm and it now produces different values than before.            \n\n```\nsage: f(1/7)      # abs tol 1e-4\n-            1.00001356670155\n+            0.999844176260303\n```\nis a case where it actually matters.\n\nIt is probably a matter of opinion and taste in the end, but I would like to keep output that is not 1.0 for this as it illustrates the errors that are made. If an exact value is needed, one should not use the approximating functions, anyway.\n\nOf course the trailing spaces need to be removed.",
    "created_at": "2020-04-24T09:36:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463186",
    "user": "https://github.com/categorie"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@videlec](#comment:5):

I see your point, but surprisingly I disagree. The algorithm produces a floating point number that is within a given precision of the correct result. It is NOT suppose to return the exact value. It will be off and up to a much higher precision all hardware should return the same number. The abs tol that I set is higher than whan is guaranteed by the algorithm.

This ticket changes some behaviour of the algorithm and it now produces different values than before.            

```
sage: f(1/7)      # abs tol 1e-4
-            1.00001356670155
+            0.999844176260303
```
is a case where it actually matters.

It is probably a matter of opinion and taste in the end, but I would like to keep output that is not 1.0 for this as it illustrates the errors that are made. If an exact value is needed, one should not use the approximating functions, anyway.

Of course the trailing spaces need to be removed.



---

archive/issue_comments_463187.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI think I agree with Chris on this.  If the \"expected output\" in the test is the exact value, such as 1.0, it does give the impression that the code should output 1.0 and anything else is an indication of an error.  Yet again we are using tests for two different things: as a *test* we could write (in effect) \"f(1/7) is within 1e-4 of 1.0\" and if that holds then the test passes.  But for *documentation* we want to show the user what they should except to actually see.",
    "created_at": "2020-04-24T09:44:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463187",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:9" align="right">comment:9</div>

I think I agree with Chris on this.  If the "expected output" in the test is the exact value, such as 1.0, it does give the impression that the code should output 1.0 and anything else is an indication of an error.  Yet again we are using tests for two different things: as a *test* we could write (in effect) "f(1/7) is within 1e-4 of 1.0" and if that holds then the test passes.  But for *documentation* we want to show the user what they should except to actually see.



---

archive/issue_comments_463188.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@categorie](#comment:8):\n> Replying to [@videlec](#comment:5):\n> \n> I see your point, but surprisingly I disagree. The algorithm produces a floating point number that is within a given precision of the correct result. It is NOT suppose to return the exact value. It will be off and up to a much higher precision all hardware should return the same number. The abs tol that I set is higher than whan is guaranteed by the algorithm.\n\nOf course your algorithm does not return the exact value. By \"expected value\" I meant \"actual value that the numerical algorithm approximates\". Sorry for my unprecise english.\n\nTo my mind, you are contradicting yourself.\n- If you want to test the actual output of the algorithm then don't write `# abs tol` at all.\n- If you want to test how close your algorithm gives an answer to the real one, then do write\n\n  ```\n  sage: my_function(xyz)   # abs. tol 1e-5\n  exact_value_that_I_should_be_expecting\n  ```\n- If you want to emphasize that the answer is non-exact to the reader, then the detail of the output does not matter. And there is no need to update anything.\n\nYou are in between these three: you use `# abs. tol` but at the same time claim that what is written in the output should match the actual value. I have hard time figuring out the purpose of it.\n\n> This ticket changes some behaviour of the algorithm and it now produces different values than before.            \n> \n> ```\n> sage: f(1/7)      # abs tol 1e-4\n> -            1.00001356670155\n> +            0.999844176260303\n> ```\n> is a case where it actually matters.\n\nShould that be considered as a regression?\n\n> It is probably a matter of opinion and taste in the end, but I would like to keep output that is not 1.0 for this as it illustrates the errors that are made. If an exact value is needed, one should not use the approximating functions, anyway.",
    "created_at": "2020-04-24T09:50:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463188",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@categorie](#comment:8):
> Replying to [@videlec](#comment:5):
> 
> I see your point, but surprisingly I disagree. The algorithm produces a floating point number that is within a given precision of the correct result. It is NOT suppose to return the exact value. It will be off and up to a much higher precision all hardware should return the same number. The abs tol that I set is higher than whan is guaranteed by the algorithm.

Of course your algorithm does not return the exact value. By "expected value" I meant "actual value that the numerical algorithm approximates". Sorry for my unprecise english.

To my mind, you are contradicting yourself.
- If you want to test the actual output of the algorithm then don't write `# abs tol` at all.
- If you want to test how close your algorithm gives an answer to the real one, then do write

  ```
  sage: my_function(xyz)   # abs. tol 1e-5
  exact_value_that_I_should_be_expecting
  ```
- If you want to emphasize that the answer is non-exact to the reader, then the detail of the output does not matter. And there is no need to update anything.

You are in between these three: you use `# abs. tol` but at the same time claim that what is written in the output should match the actual value. I have hard time figuring out the purpose of it.

> This ticket changes some behaviour of the algorithm and it now produces different values than before.            
> 
> ```
> sage: f(1/7)      # abs tol 1e-4
> -            1.00001356670155
> +            0.999844176260303
> ```
> is a case where it actually matters.

Should that be considered as a regression?

> It is probably a matter of opinion and taste in the end, but I would like to keep output that is not 1.0 for this as it illustrates the errors that are made. If an exact value is needed, one should not use the approximating functions, anyway.



---

archive/issue_comments_463189.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@JohnCremona](#comment:9):\n> I think I agree with Chris on this.  If the \"expected output\" in the test is the exact value, such as 1.0, it does give the impression that the code should output 1.0 and anything else is an indication of an error.  Yet again we are using tests for two different things: as a *test* we could write (in effect) \"f(1/7) is within 1e-4 of 1.0\" and if that holds then the test passes.  But for *documentation* we want to show the user what they should except to actually see.\n\nTo my mind the `# abs. tol 1e-4` does indicate that the answer is not precise since floating points provide 14 digits. Of course one can argue that people are not educated enough to know the meaning of `# abs. tol` and the precision of floating point numbers. But more importantly, if you really want to guarantee that what is written matches the output don't use `# abs. tol` at all (or perhaps `# abs. tol 1e-13` if it appears that the behavior is machine dependent).",
    "created_at": "2020-04-24T09:58:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463189",
    "user": "https://github.com/videlec"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@JohnCremona](#comment:9):
> I think I agree with Chris on this.  If the "expected output" in the test is the exact value, such as 1.0, it does give the impression that the code should output 1.0 and anything else is an indication of an error.  Yet again we are using tests for two different things: as a *test* we could write (in effect) "f(1/7) is within 1e-4 of 1.0" and if that holds then the test passes.  But for *documentation* we want to show the user what they should except to actually see.

To my mind the `# abs. tol 1e-4` does indicate that the answer is not precise since floating points provide 14 digits. Of course one can argue that people are not educated enough to know the meaning of `# abs. tol` and the precision of floating point numbers. But more importantly, if you really want to guarantee that what is written matches the output don't use `# abs. tol` at all (or perhaps `# abs. tol 1e-13` if it appears that the behavior is machine dependent).



---

archive/issue_comments_463190.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThe issue is easy explained with an example. Say\n\n```\nsage: def my_pi(prec=100):\n....:     return sqrt(6*sum( 1./n^2 for n in [1..prec] ))\nsage: my_pi(10)\n3.04936163598207\nsage: my_pi(1000)\n3.14063805620599\n```\nI think the doc test for my_pi should NOT check if the answer of my_pi(10) is pi up to n digit, it should check if that given precise answer 3.04936163598207 is exact up to 8 digits, say.\n\nIt is a regression in precision, but a speedup. In analogy with the above, the algorithm used to sum 1000 terms when asked to compute it so that the answer can be proven to be smaller than epsilon = 0.1. Now it only needs to do 100 terms and we still know how to prove that the answer is within 0.1. The bounds on convergenve of the sequence are much worst than the actual convergence, so with 100 or 1000 terms it comes close to the actual answer, yet with 100 maybe the error is not 0.0001 rather than 0.00000001.\n\nThe basic idea behind the algorithm is that we approximate an integer with an infinite sum. So we want to prove rigorously that the error is <0.5. I can estimate the error of the absolute sum which is an upper bound to the error. I don't want to do any extra work, so I am happy if the answer has an error of 0.1.\n\nDoes that help?",
    "created_at": "2020-04-24T13:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463190",
    "user": "https://github.com/categorie"
}
```

<div id="comment:12" align="right">comment:12</div>

The issue is easy explained with an example. Say

```
sage: def my_pi(prec=100):
....:     return sqrt(6*sum( 1./n^2 for n in [1..prec] ))
sage: my_pi(10)
3.04936163598207
sage: my_pi(1000)
3.14063805620599
```
I think the doc test for my_pi should NOT check if the answer of my_pi(10) is pi up to n digit, it should check if that given precise answer 3.04936163598207 is exact up to 8 digits, say.

It is a regression in precision, but a speedup. In analogy with the above, the algorithm used to sum 1000 terms when asked to compute it so that the answer can be proven to be smaller than epsilon = 0.1. Now it only needs to do 100 terms and we still know how to prove that the answer is within 0.1. The bounds on convergenve of the sequence are much worst than the actual convergence, so with 100 or 1000 terms it comes close to the actual answer, yet with 100 maybe the error is not 0.0001 rather than 0.00000001.

The basic idea behind the algorithm is that we approximate an integer with an infinite sum. So we want to prove rigorously that the error is <0.5. I can estimate the error of the absolute sum which is an upper bound to the error. I don't want to do any extra work, so I am happy if the answer has an error of 0.1.

Does that help?



---

archive/issue_comments_463191.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@categorie](#comment:12):\n> I think the doc test for my_pi should NOT check if the answer of my_pi(10) is pi up to n digit, it should check if that given precise answer 3.04936163598207 is exact up to 8 digits, say.\n\nWhy 8 digits? I still don't see the point of using a big `# abs. tol`. If `3.04936163598207` is the expected output then it is what should be in the doctest without `# abs. tol` at all. I don't understand your usage of `# abs. tol`. And you never explained it.\n\n> It is a regression in precision, but a speedup. \n> <SNIP>\n> \n> Does that help?\n\nSure. Thanks for the explanations.",
    "created_at": "2020-04-24T15:32:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463191",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@categorie](#comment:12):
> I think the doc test for my_pi should NOT check if the answer of my_pi(10) is pi up to n digit, it should check if that given precise answer 3.04936163598207 is exact up to 8 digits, say.

Why 8 digits? I still don't see the point of using a big `# abs. tol`. If `3.04936163598207` is the expected output then it is what should be in the doctest without `# abs. tol` at all. I don't understand your usage of `# abs. tol`. And you never explained it.

> It is a regression in precision, but a speedup. 
> <SNIP>
> 
> Does that help?

Sure. Thanks for the explanations.



---

archive/issue_comments_463192.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOh, that is just the usual issue with floating point computations: There is noise depending on the system; so one can not ask for the number to be equal until the last digit. The cython file uses usual llong, int, but also mpfr Real Numbers.\nhttp://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests .\n\nIs this not what has to be done with all floating point results?",
    "created_at": "2020-04-24T20:13:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463192",
    "user": "https://github.com/categorie"
}
```

<div id="comment:14" align="right">comment:14</div>

Oh, that is just the usual issue with floating point computations: There is noise depending on the system; so one can not ask for the number to be equal until the last digit. The cython file uses usual llong, int, but also mpfr Real Numbers.
http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests .

Is this not what has to be done with all floating point results?



---

archive/issue_comments_463193.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nmpfr does behave the same on any platform (or it is a bug). Numerical noise mostly comes from machine `float` and `double`. So it is not yet clear to me that there is numerical noise.\n\nEven though there would be numerical noise, you don't expect it to affect 70% of the digits of your computations. In other words, you should be using `# abs. tol e-13` and not `# abs. tol e-4`.",
    "created_at": "2020-04-24T20:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463193",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

mpfr does behave the same on any platform (or it is a bug). Numerical noise mostly comes from machine `float` and `double`. So it is not yet clear to me that there is numerical noise.

Even though there would be numerical noise, you don't expect it to affect 70% of the digits of your computations. In other words, you should be using `# abs. tol e-13` and not `# abs. tol e-4`.



---

archive/issue_comments_463194.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nSorry, of course I meant to include `double`. Most of the cases only use `double`, but even if the algorithm uses mpfr, it still returns double. \n\nI see your point about the value. I am happy to change them to `# abs tol e-13` everywhere if that matters.",
    "created_at": "2020-04-26T10:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463194",
    "user": "https://github.com/categorie"
}
```

<div id="comment:16" align="right">comment:16</div>

Sorry, of course I meant to include `double`. Most of the cases only use `double`, but even if the algorithm uses mpfr, it still returns double. 

I see your point about the value. I am happy to change them to `# abs tol e-13` everywhere if that matters.



---

archive/issue_comments_463195.json:
```json
{
    "body": "Changed commit from **[`ad99f7d`](https://github.com/sagemath/sagetrac-mirror/commit/ad99f7d5bd1ca81a65f8e4aa8079299b068cbc6d)** to **[`6435a75`](https://github.com/sagemath/sagetrac-mirror/commit/6435a7542f5520365268815845a555673b9fa0f4)**",
    "created_at": "2020-04-26T10:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463195",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ad99f7d`](https://github.com/sagemath/sagetrac-mirror/commit/ad99f7d5bd1ca81a65f8e4aa8079299b068cbc6d)** to **[`6435a75`](https://github.com/sagemath/sagetrac-mirror/commit/6435a7542f5520365268815845a555673b9fa0f4)**



---

archive/issue_comments_463196.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ae8a1a83276a48f0da9fb4030f26b622977b3a7\"><code>2ae8a1a</code></a></td><td><code>Merge branch sage.9.1.rc1 into modnum</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5b00688032e4242bf91b30d5afa3cdc64ad2e3f\"><code>f5b0068</code></a></td><td><code>Merge branch 'trac 29290' into modnum</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6435a7542f5520365268815845a555673b9fa0f4\"><code>6435a75</code></a></td><td><code>trac #29476: adjust precision in tests and delete some trailing whitespace</code></td></tr></table>\n",
    "created_at": "2020-04-26T10:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463196",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ae8a1a83276a48f0da9fb4030f26b622977b3a7"><code>2ae8a1a</code></a></td><td><code>Merge branch sage.9.1.rc1 into modnum</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5b00688032e4242bf91b30d5afa3cdc64ad2e3f"><code>f5b0068</code></a></td><td><code>Merge branch 'trac 29290' into modnum</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6435a7542f5520365268815845a555673b9fa0f4"><code>6435a75</code></a></td><td><code>trac #29476: adjust precision in tests and delete some trailing whitespace</code></td></tr></table>




---

archive/issue_events_402341.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-26T13:24:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402341"
}
```



---

archive/issue_events_402342.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-26T13:24:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402342"
}
```



---

archive/issue_comments_463197.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nLet put in needs review (for patchbots). Is it ready on your side?",
    "created_at": "2020-04-26T13:24:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463197",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">comment:18</div>

Let put in needs review (for patchbots). Is it ready on your side?



---

archive/issue_comments_463198.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI don't know what you did with the merging, but the automerging now fails...",
    "created_at": "2020-04-26T13:24:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463198",
    "user": "https://github.com/videlec"
}
```

<div id="comment:19" align="right">comment:19</div>

I don't know what you did with the merging, but the automerging now fails...



---

archive/issue_events_402343.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-26T13:24:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402343"
}
```



---

archive/issue_events_402344.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-26T13:24:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402344"
}
```



---

archive/issue_events_402345.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-26T17:28:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402345"
}
```



---

archive/issue_events_402346.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-26T17:28:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402346"
}
```



---

archive/issue_comments_463199.json:
```json
{
    "body": "Changed commit from **[`6435a75`](https://github.com/sagemath/sagetrac-mirror/commit/6435a7542f5520365268815845a555673b9fa0f4)** to **[`10ecc62`](https://github.com/sagemath/sagetrac-mirror/commit/10ecc62cf702aa13400f5bbf8050579e2e12932d)**",
    "created_at": "2020-04-26T17:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463199",
    "user": "https://github.com/categorie"
}
```

Changed commit from **[`6435a75`](https://github.com/sagemath/sagetrac-mirror/commit/6435a7542f5520365268815845a555673b9fa0f4)** to **[`10ecc62`](https://github.com/sagemath/sagetrac-mirror/commit/10ecc62cf702aa13400f5bbf8050579e2e12932d)**



---

archive/issue_comments_463200.json:
```json
{
    "body": "Changed branch from **[u/wuthrich/trac_29476](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476)** to **[u/wuthrich/trac_29476_2](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476_2)**",
    "created_at": "2020-04-26T17:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463200",
    "user": "https://github.com/categorie"
}
```

Changed branch from **[u/wuthrich/trac_29476](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476)** to **[u/wuthrich/trac_29476_2](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476_2)**



---

archive/issue_comments_463201.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOh? Not sure what went wrong. Let's try with this. I expact a minor problem when merging with #29290. (By the way, where do I see that \"the automerging now fails...\" ?) \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10ecc62cf702aa13400f5bbf8050579e2e12932d\"><code>10ecc62</code></a></td><td><code>trac #29476: adjust precision in tests and delete some trailing whitespace</code></td></tr></table>\n",
    "created_at": "2020-04-26T17:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463201",
    "user": "https://github.com/categorie"
}
```

<div id="comment:20" align="right">comment:20</div>

Oh? Not sure what went wrong. Let's try with this. I expact a minor problem when merging with #29290. (By the way, where do I see that "the automerging now fails..." ?) 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10ecc62cf702aa13400f5bbf8050579e2e12932d"><code>10ecc62</code></a></td><td><code>trac #29476: adjust precision in tests and delete some trailing whitespace</code></td></tr></table>




---

archive/issue_events_402347.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-26T17:32:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402347"
}
```



---

archive/issue_events_402348.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-26T17:32:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402348"
}
```



---

archive/issue_comments_463202.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f30ae439353b059e2cc7c0bb9f8009128e13dfa\"><code>9f30ae4</code></a></td><td><code>trac #29476 : Merge with sage.9.1.beta6</code></td></tr></table>\n",
    "created_at": "2020-04-26T18:33:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463202",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f30ae439353b059e2cc7c0bb9f8009128e13dfa"><code>9f30ae4</code></a></td><td><code>trac #29476 : Merge with sage.9.1.beta6</code></td></tr></table>




---

archive/issue_comments_463203.json:
```json
{
    "body": "Changed commit from **[`10ecc62`](https://github.com/sagemath/sagetrac-mirror/commit/10ecc62cf702aa13400f5bbf8050579e2e12932d)** to **[`9f30ae4`](https://github.com/sagemath/sagetrac-mirror/commit/9f30ae439353b059e2cc7c0bb9f8009128e13dfa)**",
    "created_at": "2020-04-26T18:33:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463203",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`10ecc62`](https://github.com/sagemath/sagetrac-mirror/commit/10ecc62cf702aa13400f5bbf8050579e2e12932d)** to **[`9f30ae4`](https://github.com/sagemath/sagetrac-mirror/commit/9f30ae439353b059e2cc7c0bb9f8009128e13dfa)**



---

archive/issue_comments_463204.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThat merge with #29290 was exactly the problem. Hope this works finally.",
    "created_at": "2020-04-26T18:35:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463204",
    "user": "https://github.com/categorie"
}
```

<div id="comment:23" align="right">comment:23</div>

That merge with #29290 was exactly the problem. Hope this works finally.



---

archive/issue_events_402349.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-26T18:35:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402349"
}
```



---

archive/issue_events_402350.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-04-26T18:35:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402350"
}
```



---

archive/issue_comments_463205.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@categorie](#comment:20):\n> Oh? Not sure what went wrong. Let's try with this. I expact a minor problem when merging with #29290. (By the way, where do I see that \"the automerging now fails...\" ?) \n\nSorry. This is in the ticket description, in the \"branch\" section. If your branch fails to merge with the current beta then it appears in red. Otherwise it is orange or green and is linked to git.sagemath.org.",
    "created_at": "2020-04-26T20:53:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463205",
    "user": "https://github.com/videlec"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@categorie](#comment:20):
> Oh? Not sure what went wrong. Let's try with this. I expact a minor problem when merging with #29290. (By the way, where do I see that "the automerging now fails..." ?) 

Sorry. This is in the ticket description, in the "branch" section. If your branch fails to merge with the current beta then it appears in red. Otherwise it is orange or green and is linked to git.sagemath.org.



---

archive/issue_comments_463206.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n> Sorry. This is in the ticket description, in the \"branch\" section. If your branch fails to merge with the current beta then it appears in red. Otherwise it is orange or green and is linked to git.sagemath.org.\n\nOh, that is helpful. As a colour-blind person I never paid attention to the colour there. Hovering over it, it is spelled out.",
    "created_at": "2020-04-27T17:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463206",
    "user": "https://github.com/categorie"
}
```

<div id="comment:25" align="right">comment:25</div>

> Sorry. This is in the ticket description, in the "branch" section. If your branch fails to merge with the current beta then it appears in red. Otherwise it is orange or green and is linked to git.sagemath.org.

Oh, that is helpful. As a colour-blind person I never paid attention to the colour there. Hovering over it, it is spelled out.



---

archive/issue_events_402351.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-27T17:59:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402351"
}
```



---

archive/issue_events_402352.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-04-27T17:59:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402352"
}
```



---

archive/issue_comments_463207.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nOn 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/ell_rational_field.py\", line 1358, in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_symbol_numerical\nFailed example:\n    f(1/7)      # abs tol 1e-13\nExpected:\n    0.999844176260303\nGot:\n    0.999844176260738\nTolerance exceeded:\n    0.999844176260303 vs 0.999844176260738, tolerance 5e-13 > 1e-13\n**********************************************************************\n1 item had failures:\n   1 of  13 in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_symbol_numerical\n    [849 tests, 1 failure, 130.58 s]\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 928, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value\nFailed example:\n    M.approximative_value(123/567,prec=2) # abs tol 1e-13\nExpected:\n    -4.00002815242902\nGot:\n    -4.00002815254972\nTolerance exceeded:\n    -4.00002815242902 vs -4.00002815254972, tolerance 2e-10 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 937, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value\nFailed example:\n    M.approximative_value(1/7,prec=2)  # abs tol 1e-13\nExpected:\n    0.999981178147778\nGot:\n    0.999981178140654\nTolerance exceeded:\n    0.999981178147778 vs 0.999981178140654, tolerance 8e-12 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 939, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value\nFailed example:\n    M.approximative_value(1/7,prec=10) # abs tol 1e-13\nExpected:\n    0.999999972802649\nGot:\n    0.999999972795519\nTolerance exceeded:\n    0.999999972802649 vs 0.999999972795519, tolerance 8e-12 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 1920, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.?\nFailed example:\n    m._from_ioo_to_r_approx(-1/7,0.01, use_partials=0) #abs tol 1e-13\nExpected:\n    6.22747410432385 - 1.48055182979493*I\nGot:\n    6.22747410432453 - 1.48055182979558*I\nTolerance exceeded in 2 of 2:\n    6.22747410432385 vs 6.22747410432453, tolerance 7e-13 > 1e-13\n    - 1.48055182979493 vs - 1.48055182979558, tolerance 7e-13 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 2202, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.?\nFailed example:\n    M._from_r_to_rr_approx(0/1,44/98761,0.001) # abs tol 1e-13\nExpected:\n    0.634604184365293 + 1.45881886531983*I\nGot:\n    0.634604184358477 + 1.45881886531049*I\nTolerance exceeded in 2 of 2:\n    0.634604184365293 vs 0.634604184358477, tolerance 7e-12 > 1e-13\n    + 1.45881886531983 vs + 1.45881886531049, tolerance 1e-11 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 2388, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx\nFailed example:\n    M._from_r_to_rr_approx( 0/1, -35/144, 0.001) # abs tol 1e-13\nExpected:\n    -6.22753204310913 - 1.31710951034592e-8*I\nGot:\n    -6.22753204314086 - 1.31794770652505e-8*I\nTolerance exceeded in 2 of 2:\n    -6.22753204310913 vs -6.22753204314086, tolerance 4e-11 > 1e-13\n    - 1.31710951034592e-8 vs - 1.31794770652505e-8, tolerance 9e-12 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 2393, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx\nFailed example:\n    M._transportable_approx( 0/1, -7/31798, 0.001) #abs tol 1e-13\nExpected:\n    -7.01577418382726e-9 - 7.40274138232394*I\nGot:\n    -7.01539626390968e-9 - 7.40274138232345*I\nTolerance exceeded in 2 of 2:\n    -7.01577418382726e-9 vs -7.01539626390968e-9, tolerance 4e-13 > 1e-13\n    - 7.40274138232394 vs - 7.40274138232345, tolerance 5e-13 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 3310, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx\nFailed example:\n    m._evaluate_approx(1/11,0.000001)  # abs tol 1e-13\nExpected:\n    9.69540669970570e-10 - 5.80486769763411e-11*I\nGot:\n    9.69678337625623e-10 - 5.76609870961420e-11*I\nTolerance exceeded in 2 of 2:\n    9.69540669970570e-10 vs 9.69678337625623e-10, tolerance 2e-13 > 1e-13\n    - 5.80486769763411e-11 vs - 5.76609870961420e-11, tolerance 4e-13 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 3312, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx\nFailed example:\n    m._evaluate_approx(1/17,0.000001) # abs tol 1e-13\nExpected:\n    -9.01145713605445e-10 + 7.40274134212215*I\nGot:\n    -9.01164337596683e-10 + 7.40274134212334*I\nTolerance exceeded in 1 of 2:\n    + 7.40274134212215 vs + 7.40274134212334, tolerance 2e-12 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 3320, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx\nFailed example:\n    M._evaluate_approx(1/17,0.01) # abs tol 1e-13\nExpected:\n    1.08712572498569 - 0.548379313090719*I\nGot:\n    1.08712572498701 - 0.548379313090238*I\nTolerance exceeded in 2 of 2:\n    1.08712572498569 vs 1.08712572498701, tolerance 2e-12 > 1e-13\n    - 0.548379313090719 vs - 0.548379313090238, tolerance 5e-13 > 1e-13\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 3493, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._twisted_approx\nFailed example:\n    M.approximative_value(6/19, sign=1, prec=20, use_twist=False) # abs tol 1e-13\nExpected:\n    2.99999999944834\nGot:\n    2.99999999944752\nTolerance exceeded:\n    2.99999999944834 vs 2.99999999944752, tolerance 9e-13 > 1e-13\n**********************************************************************\n5 items had failures:\n   2 of  89 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.?\n   3 of  13 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx\n   2 of  18 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx\n   1 of   7 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._twisted_approx\n   3 of  11 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value\n    [363 tests, 11 failures, 10.55 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/schemes/elliptic_curves/ell_rational_field.py  # 1 doctest failed\nsage -t --long src/sage/schemes/elliptic_curves/mod_sym_num.pyx  # 11 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2020-04-29T22:27:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463207",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">comment:27</div>

On 32-bit:

```
**********************************************************************
File "src/sage/schemes/elliptic_curves/ell_rational_field.py", line 1358, in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_symbol_numerical
Failed example:
    f(1/7)      # abs tol 1e-13
Expected:
    0.999844176260303
Got:
    0.999844176260738
Tolerance exceeded:
    0.999844176260303 vs 0.999844176260738, tolerance 5e-13 > 1e-13
**********************************************************************
1 item had failures:
   1 of  13 in sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_symbol_numerical
    [849 tests, 1 failure, 130.58 s]
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 928, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value
Failed example:
    M.approximative_value(123/567,prec=2) # abs tol 1e-13
Expected:
    -4.00002815242902
Got:
    -4.00002815254972
Tolerance exceeded:
    -4.00002815242902 vs -4.00002815254972, tolerance 2e-10 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 937, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value
Failed example:
    M.approximative_value(1/7,prec=2)  # abs tol 1e-13
Expected:
    0.999981178147778
Got:
    0.999981178140654
Tolerance exceeded:
    0.999981178147778 vs 0.999981178140654, tolerance 8e-12 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 939, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value
Failed example:
    M.approximative_value(1/7,prec=10) # abs tol 1e-13
Expected:
    0.999999972802649
Got:
    0.999999972795519
Tolerance exceeded:
    0.999999972802649 vs 0.999999972795519, tolerance 8e-12 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 1920, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.?
Failed example:
    m._from_ioo_to_r_approx(-1/7,0.01, use_partials=0) #abs tol 1e-13
Expected:
    6.22747410432385 - 1.48055182979493*I
Got:
    6.22747410432453 - 1.48055182979558*I
Tolerance exceeded in 2 of 2:
    6.22747410432385 vs 6.22747410432453, tolerance 7e-13 > 1e-13
    - 1.48055182979493 vs - 1.48055182979558, tolerance 7e-13 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 2202, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.?
Failed example:
    M._from_r_to_rr_approx(0/1,44/98761,0.001) # abs tol 1e-13
Expected:
    0.634604184365293 + 1.45881886531983*I
Got:
    0.634604184358477 + 1.45881886531049*I
Tolerance exceeded in 2 of 2:
    0.634604184365293 vs 0.634604184358477, tolerance 7e-12 > 1e-13
    + 1.45881886531983 vs + 1.45881886531049, tolerance 1e-11 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 2388, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx
Failed example:
    M._from_r_to_rr_approx( 0/1, -35/144, 0.001) # abs tol 1e-13
Expected:
    -6.22753204310913 - 1.31710951034592e-8*I
Got:
    -6.22753204314086 - 1.31794770652505e-8*I
Tolerance exceeded in 2 of 2:
    -6.22753204310913 vs -6.22753204314086, tolerance 4e-11 > 1e-13
    - 1.31710951034592e-8 vs - 1.31794770652505e-8, tolerance 9e-12 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 2393, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx
Failed example:
    M._transportable_approx( 0/1, -7/31798, 0.001) #abs tol 1e-13
Expected:
    -7.01577418382726e-9 - 7.40274138232394*I
Got:
    -7.01539626390968e-9 - 7.40274138232345*I
Tolerance exceeded in 2 of 2:
    -7.01577418382726e-9 vs -7.01539626390968e-9, tolerance 4e-13 > 1e-13
    - 7.40274138232394 vs - 7.40274138232345, tolerance 5e-13 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 3310, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx
Failed example:
    m._evaluate_approx(1/11,0.000001)  # abs tol 1e-13
Expected:
    9.69540669970570e-10 - 5.80486769763411e-11*I
Got:
    9.69678337625623e-10 - 5.76609870961420e-11*I
Tolerance exceeded in 2 of 2:
    9.69540669970570e-10 vs 9.69678337625623e-10, tolerance 2e-13 > 1e-13
    - 5.80486769763411e-11 vs - 5.76609870961420e-11, tolerance 4e-13 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 3312, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx
Failed example:
    m._evaluate_approx(1/17,0.000001) # abs tol 1e-13
Expected:
    -9.01145713605445e-10 + 7.40274134212215*I
Got:
    -9.01164337596683e-10 + 7.40274134212334*I
Tolerance exceeded in 1 of 2:
    + 7.40274134212215 vs + 7.40274134212334, tolerance 2e-12 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 3320, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx
Failed example:
    M._evaluate_approx(1/17,0.01) # abs tol 1e-13
Expected:
    1.08712572498569 - 0.548379313090719*I
Got:
    1.08712572498701 - 0.548379313090238*I
Tolerance exceeded in 2 of 2:
    1.08712572498569 vs 1.08712572498701, tolerance 2e-12 > 1e-13
    - 0.548379313090719 vs - 0.548379313090238, tolerance 5e-13 > 1e-13
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 3493, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._twisted_approx
Failed example:
    M.approximative_value(6/19, sign=1, prec=20, use_twist=False) # abs tol 1e-13
Expected:
    2.99999999944834
Got:
    2.99999999944752
Tolerance exceeded:
    2.99999999944834 vs 2.99999999944752, tolerance 9e-13 > 1e-13
**********************************************************************
5 items had failures:
   2 of  89 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.?
   3 of  13 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._evaluate_approx
   2 of  18 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx
   1 of   7 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._twisted_approx
   3 of  11 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical.approximative_value
    [363 tests, 11 failures, 10.55 s]
----------------------------------------------------------------------
sage -t --long src/sage/schemes/elliptic_curves/ell_rational_field.py  # 1 doctest failed
sage -t --long src/sage/schemes/elliptic_curves/mod_sym_num.pyx  # 11 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_402353.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-29T22:27:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402353"
}
```



---

archive/issue_events_402354.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-29T22:27:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402354"
}
```



---

archive/issue_comments_463208.json:
```json
{
    "body": "Changed commit from **[`9f30ae4`](https://github.com/sagemath/sagetrac-mirror/commit/9f30ae439353b059e2cc7c0bb9f8009128e13dfa)** to **[`16e9f3b`](https://github.com/sagemath/sagetrac-mirror/commit/16e9f3b040af7ff0616c05bacc5b4c06246ffd3d)**",
    "created_at": "2020-05-01T09:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463208",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9f30ae4`](https://github.com/sagemath/sagetrac-mirror/commit/9f30ae439353b059e2cc7c0bb9f8009128e13dfa)** to **[`16e9f3b`](https://github.com/sagemath/sagetrac-mirror/commit/16e9f3b040af7ff0616c05bacc5b4c06246ffd3d)**



---

archive/issue_comments_463209.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16e9f3b040af7ff0616c05bacc5b4c06246ffd3d\"><code>16e9f3b</code></a></td><td><code>trac #29476: readjusting tolerance to work for 32-bit</code></td></tr></table>\n",
    "created_at": "2020-05-01T09:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463209",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16e9f3b040af7ff0616c05bacc5b4c06246ffd3d"><code>16e9f3b</code></a></td><td><code>trac #29476: readjusting tolerance to work for 32-bit</code></td></tr></table>




---

archive/issue_comments_463210.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI changed all e-13 tolerance to e-11. The commit should solve the 32-bit problem, but I can't test that.",
    "created_at": "2020-05-01T09:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463210",
    "user": "https://github.com/categorie"
}
```

<div id="comment:29" align="right">comment:29</div>

I changed all e-13 tolerance to e-11. The commit should solve the 32-bit problem, but I can't test that.



---

archive/issue_events_402355.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-05-01T09:30:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402355"
}
```



---

archive/issue_events_402356.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-05-01T09:30:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402356"
}
```



---

archive/issue_events_402357.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-05-01T10:20:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402357"
}
```



---

archive/issue_events_402358.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-05-01T10:20:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402358"
}
```



---

archive/issue_comments_463211.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\n`e-11` won't do for all of them but I see that you set `e-9` for the corresponding doctest.\n\nOne way to test on 32 bits would be to have some docker images, but I don't think there are...",
    "created_at": "2020-05-01T10:20:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463211",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">comment:30</div>

`e-11` won't do for all of them but I see that you set `e-9` for the corresponding doctest.

One way to test on 32 bits would be to have some docker images, but I don't think there are...



---

archive/issue_comments_463212.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nOn 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/mod_sym_num.pyx\", line 2388, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx\nFailed example:\n    M._from_r_to_rr_approx( 0/1, -35/144, 0.001) # abs tol 1e-11\nExpected:\n    -6.22753204310913 - 1.31710951034592e-8*I\nGot:\n    -6.22753204314086 - 1.31794770652505e-8*I\nTolerance exceeded in 1 of 2:\n    -6.22753204310913 vs -6.22753204314086, tolerance 4e-11 > 1e-11\n**********************************************************************\n1 item had failures:\n   1 of  18 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx\n    [363 tests, 1 failure, 10.66 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/schemes/elliptic_curves/mod_sym_num.pyx  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2020-05-03T22:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463212",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">comment:31</div>

On 32-bit:

```
**********************************************************************
File "src/sage/schemes/elliptic_curves/mod_sym_num.pyx", line 2388, in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx
Failed example:
    M._from_r_to_rr_approx( 0/1, -35/144, 0.001) # abs tol 1e-11
Expected:
    -6.22753204310913 - 1.31710951034592e-8*I
Got:
    -6.22753204314086 - 1.31794770652505e-8*I
Tolerance exceeded in 1 of 2:
    -6.22753204310913 vs -6.22753204314086, tolerance 4e-11 > 1e-11
**********************************************************************
1 item had failures:
   1 of  18 in sage.schemes.elliptic_curves.mod_sym_num.ModularSymbolNumerical._transportable_approx
    [363 tests, 1 failure, 10.66 s]
----------------------------------------------------------------------
sage -t --long src/sage/schemes/elliptic_curves/mod_sym_num.pyx  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_402359.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-05-03T22:38:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402359"
}
```



---

archive/issue_events_402360.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-05-03T22:38:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402360"
}
```



---

archive/issue_comments_463213.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@videlec](#comment:30):\n> One way to test on 32 bits would be to have some docker images, but I don't think there are...\n\nYou can test on 32 bit using `tox -e docker-ubuntu-bionic-i386-standard`, for example.",
    "created_at": "2020-05-04T00:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463213",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@videlec](#comment:30):
> One way to test on 32 bits would be to have some docker images, but I don't think there are...

You can test on 32 bit using `tox -e docker-ubuntu-bionic-i386-standard`, for example.



---

archive/issue_comments_463214.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134\"><code>0fb6294</code></a></td><td><code>trac #29476: one more 32-bit precision adjustment</code></td></tr></table>\n",
    "created_at": "2020-05-06T09:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463214",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134"><code>0fb6294</code></a></td><td><code>trac #29476: one more 32-bit precision adjustment</code></td></tr></table>




---

archive/issue_comments_463215.json:
```json
{
    "body": "Changed commit from **[`16e9f3b`](https://github.com/sagemath/sagetrac-mirror/commit/16e9f3b040af7ff0616c05bacc5b4c06246ffd3d)** to **[`0fb6294`](https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134)**",
    "created_at": "2020-05-06T09:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463215",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`16e9f3b`](https://github.com/sagemath/sagetrac-mirror/commit/16e9f3b040af7ff0616c05bacc5b4c06246ffd3d)** to **[`0fb6294`](https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134)**



---

archive/issue_comments_463216.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nMinimal change to catch this last one. Sorry for not spotting.",
    "created_at": "2020-05-06T09:16:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463216",
    "user": "https://github.com/categorie"
}
```

<div id="comment:34" align="right">comment:34</div>

Minimal change to catch this last one. Sorry for not spotting.



---

archive/issue_events_402361.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-05-06T09:16:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402361"
}
```



---

archive/issue_events_402362.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2020-05-06T09:16:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402362"
}
```



---

archive/issue_events_402363.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-05-06T16:53:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402363"
}
```



---

archive/issue_events_402364.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-05-06T16:53:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402364"
}
```



---

archive/issue_comments_463217.json:
```json
{
    "body": "Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2020-05-06T16:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463217",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Frédéric Chapoton**



---

archive/issue_comments_463218.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nok",
    "created_at": "2020-05-06T16:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463218",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:35" align="right">comment:35</div>

ok



---

archive/issue_comments_463219.json:
```json
{
    "body": "Changed branch from **[u/wuthrich/trac_29476_2](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476_2)** to **[`0fb6294`](https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134)**",
    "created_at": "2020-05-26T21:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29476#issuecomment-463219",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/wuthrich/trac_29476_2](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/trac_29476_2)** to **[`0fb6294`](https://github.com/sagemath/sagetrac-mirror/commit/0fb6294575c884b57f4578d5410609ddcd7fa134)**



---

archive/issue_events_402365.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-05-26T21:44:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402365"
}
```



---

archive/issue_events_402366.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "36f38583973b28ecd28bd597c74529c8e6dbeae9",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-05-26T21:44:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29476",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29476#event-402366"
}
```
