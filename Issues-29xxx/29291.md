# Issue 29291: Check for required extension module "ssl" in python3 build and spkg-configure

archive/issues_029054.json:
```json
{
    "body": "Follow up from #27705.\n\nAs openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.\n\nAs SSL issues are no longer a likely diagnosis for failures with launching the notebook, we change the corresponding code in `src/bin/sage-notebook`. (Prompted by https://groups.google.com/g/sage-devel/c/IXypXTbVkDM/m/CsWl8HbZAwAJ)\n\n\n\n\nCC:  @dimpase @embray @jhpalmieri @slel @NathanDunfield tmonteil\n\nBranch/Commit: 789c96048da38405920f4c4561171d2fbfeb66fc\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29291\n\n",
    "closed_at": "2021-09-15T22:06:18Z",
    "created_at": "2020-03-06T22:38:50Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Check for required extension module \"ssl\" in python3 build and spkg-configure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29291",
    "user": "https://github.com/mkoeppe"
}
```
Follow up from #27705.

As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.

As SSL issues are no longer a likely diagnosis for failures with launching the notebook, we change the corresponding code in `src/bin/sage-notebook`. (Prompted by https://groups.google.com/g/sage-devel/c/IXypXTbVkDM/m/CsWl8HbZAwAJ)




CC:  @dimpase @embray @jhpalmieri @slel @NathanDunfield tmonteil

Branch/Commit: 789c96048da38405920f4c4561171d2fbfeb66fc

Reviewer: John Palmieri

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29291





---

archive/issue_comments_437921.json:
```json
{
    "body": "<a id='comment:1'></a>Can this also work with certifi package?\nI had issues previously with some other packages on Mac, and certifi seemed to fix it",
    "created_at": "2020-03-13T14:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437921",
    "user": "https://github.com/Shlokatadistance"
}
```

<a id='comment:1'></a>Can this also work with certifi package?
I had issues previously with some other packages on Mac, and certifi seemed to fix it



---

archive/issue_events_074515.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:33:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74515"
}
```



---

archive/issue_comments_437922.json:
```json
{
    "body": "<a id='comment:2'></a>pushing these forward to 9.2",
    "created_at": "2020-04-14T06:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437922",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>pushing these forward to 9.2



---

archive/issue_events_074516.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74516"
}
```



---

archive/issue_events_074517.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74517"
}
```



---

archive/issue_events_074518.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74518"
}
```



---

archive/issue_events_074519.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74519"
}
```



---

archive/issue_comments_437923.json:
```json
{
    "body": "<a id='comment:4'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437923",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_074520.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74520"
}
```



---

archive/issue_events_074521.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74521"
}
```



---

archive/issue_comments_437924.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n Follow up from #27705.\n \n-A warning should be shown, perhaps already at the end of the configure phase.\n+As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.\n \n-Of course, we will need to be careful regarding the macOS SSL problems.\n \n Comment: 1\n \n```\n",
    "created_at": "2021-08-13T04:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437924",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,8 +1,7 @@
 Follow up from #27705.
 
-A warning should be shown, perhaps already at the end of the configure phase.
+As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.
 
-Of course, we will need to be careful regarding the macOS SSL problems.
 
 Comment: 1
 
```




---

archive/issue_comments_437925.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-13T04:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437925",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_437926.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2021-08-13T04:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437926",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_437927.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-13T18:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437927",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_437928.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+Follow up from #27705.\n \n+As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.\n+\n+As SSL issues are no longer a likely diagnosis for failures with launching the notebook, we change the corresponding code in `src/bin/sage-notebook`. \n \n Comment: 1\n \n```\n",
    "created_at": "2021-08-13T18:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437928",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+Follow up from #27705.
 
+As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.
+
+As SSL issues are no longer a likely diagnosis for failures with launching the notebook, we change the corresponding code in `src/bin/sage-notebook`. 
 
 Comment: 1
 
```




---

archive/issue_comments_437929.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+Follow up from #27705.\n+\n+As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.\n+\n+As SSL issues are no longer a likely diagnosis for failures with launching the notebook, we change the corresponding code in `src/bin/sage-notebook`. (Prompted by https://groups.google.com/g/sage-devel/c/IXypXTbVkDM/m/CsWl8HbZAwAJ)\n+\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2021-08-13T18:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437929",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,10 @@
+Follow up from #27705.
+
+As openssl has been a standard package since Sage 9.3, there is no more point in accepting system python3 without ssl support or ignoring errors in building the ssl module when building the python3 spkg.
+
+As SSL issues are no longer a likely diagnosis for failures with launching the notebook, we change the corresponding code in `src/bin/sage-notebook`. (Prompted by https://groups.google.com/g/sage-devel/c/IXypXTbVkDM/m/CsWl8HbZAwAJ)
+
+
 
 
 Comment: 1
```




---

archive/issue_comments_437930.json:
```json
{
    "body": "<a id='comment:11'></a>In `build/pkgs/python3/spkg-build.in`, line 32,\nthe (preexisting) typo explicitely -> explicitly\ncould be fixed since we're editing that file.\n\nAny suggestions on how to review this ticket?",
    "created_at": "2021-08-22T09:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437930",
    "user": "https://github.com/slel"
}
```

<a id='comment:11'></a>In `build/pkgs/python3/spkg-build.in`, line 32,
the (preexisting) typo explicitely -> explicitly
could be fixed since we're editing that file.

Any suggestions on how to review this ticket?



---

archive/issue_comments_437931.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 slelievre]:\n> In `build/pkgs/python3/spkg-build.in`, line 32,\n> the (preexisting) typo explicitely -> explicitly\n> could be fixed since we're editing that file.\n> \n> Any suggestions on how to review this ticket?\n\n\nI guess if we can't find systems without the Python module ssl already installed, maybe we should just merge it and move on?",
    "created_at": "2021-09-14T04:20:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437931",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>Replying to [comment:11 slelievre]:
> In `build/pkgs/python3/spkg-build.in`, line 32,
> the (preexisting) typo explicitely -> explicitly
> could be fixed since we're editing that file.
> 
> Any suggestions on how to review this ticket?


I guess if we can't find systems without the Python module ssl already installed, maybe we should just merge it and move on?



---

archive/issue_comments_437932.json:
```json
{
    "body": "<a id='comment:14'></a>Right, I'm not aware of a distribution whose python would be missing the ssl module. The new configuration tests here on the ticket protect against broken pythons compiled by users. The most likely scenario could be that a user configures the source from within the `sage -sh` of some old installation of Sage. \nProbably not useful to replicate something like this in order to review the ticket.",
    "created_at": "2021-09-14T04:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437932",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Right, I'm not aware of a distribution whose python would be missing the ssl module. The new configuration tests here on the ticket protect against broken pythons compiled by users. The most likely scenario could be that a user configures the source from within the `sage -sh` of some old installation of Sage. 
Probably not useful to replicate something like this in order to review the ticket.



---

archive/issue_comments_437933.json:
```json
{
    "body": "<a id='comment:15'></a>Why not just remove `PREREQUISITE_ERROR` completely?",
    "created_at": "2021-09-14T17:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437933",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>Why not just remove `PREREQUISITE_ERROR` completely?



---

archive/issue_comments_437934.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-09-14T18:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437934",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_437935.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-14T21:23:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437935",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_437936.json:
```json
{
    "body": "<a id='comment:17'></a>This works for me, but my Python isn't broken (nor do I want to build a broken one), so I can't test the error messages. The code all makes sense, though.",
    "created_at": "2021-09-14T21:23:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437936",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>This works for me, but my Python isn't broken (nor do I want to build a broken one), so I can't test the error messages. The code all makes sense, though.



---

archive/issue_comments_437937.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-15T22:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29291#issuecomment-437937",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_074522.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-15T22:06:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29291",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29291#event-74522"
}
```
