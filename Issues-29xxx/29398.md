# Issue 29398: Accept system (Open)BLAS

archive/issues_029161.json:
```json
{
    "body": "As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided (but cblas.pc is broken).\n\nFrom http://cygwin.1069669.n5.nabble.com/Updated-openblas-0-3-3-1-td142613.html:\n\n  2) No devel package is provided as liblapack-devel already provide the needed headers and import. Openblas is fully compatible with Netlib BLAS.\n\n  3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS\n\nFedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities) - see #29393 (Use system openblas on Fedora)\n\nCC:  @dimpase @embray @isuruf @antonio-rojas @kiwifb @vbraun\n\nBranch/Commit: [0cda07c33fe26f035377c57c8982f3e2ea8da85d](https://github.com/sagemath/sagetrac-mirror/commit/0cda07c33fe26f035377c57c8982f3e2ea8da85d)\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29398\n\n",
    "closed_at": "2020-04-09T22:44:46Z",
    "created_at": "2020-03-24T02:04:24Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Accept system (Open)BLAS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29398",
    "user": "https://github.com/mkoeppe"
}
```
As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided (but cblas.pc is broken).

From http://cygwin.1069669.n5.nabble.com/Updated-openblas-0-3-3-1-td142613.html:

  2) No devel package is provided as liblapack-devel already provide the needed headers and import. Openblas is fully compatible with Netlib BLAS.

  3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS

Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities) - see #29393 (Use system openblas on Fedora)

CC:  @dimpase @embray @isuruf @antonio-rojas @kiwifb @vbraun

Branch/Commit: [0cda07c33fe26f035377c57c8982f3e2ea8da85d](https://github.com/sagemath/sagetrac-mirror/commit/0cda07c33fe26f035377c57c8982f3e2ea8da85d)

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29398





---

archive/issue_comments_574639.json:
```json
{
    "body": "<a id='comment:1'></a>\nShould we accept any system BLAS (blas+cblas+lapack) on cygwin, or test whether it's provided by openblas, for example by testing for `openblas_get_config` (https://github.com/xianyi/OpenBLAS/wiki/OpenBLAS-Extensions)?",
    "created_at": "2020-03-24T02:05:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574639",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
Should we accept any system BLAS (blas+cblas+lapack) on cygwin, or test whether it's provided by openblas, for example by testing for `openblas_get_config` (https://github.com/xianyi/OpenBLAS/wiki/OpenBLAS-Extensions)?



---

archive/issue_comments_574640.json:
```json
{
    "body": "<a id='comment:2'></a>\nif we use openblas we would need to generate missing openblas.pc\n(same problem on fedora)\n\nbuild/pkgs/openblas has a python script for this purpose, by the way.\n\nwe should ask cygwin maintainers to fix the install and provide pc file.",
    "created_at": "2020-03-24T02:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574640",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
if we use openblas we would need to generate missing openblas.pc
(same problem on fedora)

build/pkgs/openblas has a python script for this purpose, by the way.

we should ask cygwin maintainers to fix the install and provide pc file.



---

archive/issue_comments_574641.json:
```json
{
    "body": "<a id='comment:3'></a>\nwhich of our packages depends specifically on openblas.pc?",
    "created_at": "2020-03-24T02:40:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574641",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
which of our packages depends specifically on openblas.pc?



---

archive/issue_comments_574642.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [dimpase](#comment%3A2):\n> build/pkgs/openblas has a python script for this purpose, by the way.\n\n\nwrite_pc_file.py seems to do the opposite direction -- it writes blas.pc, cblas.pc, lapack.pc. Cygwin already has those",
    "created_at": "2020-03-24T02:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574642",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Replying to [dimpase](#comment%3A2):
> build/pkgs/openblas has a python script for this purpose, by the way.


write_pc_file.py seems to do the opposite direction -- it writes blas.pc, cblas.pc, lapack.pc. Cygwin already has those



---

archive/issue_comments_574643.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mkoeppe](#comment%3A3):\n> which of our packages depends specifically on openblas.pc?\n\n\nI meant, openblas.pc may be used by our spkg-configure for openblas. Otherwise it is not needed.",
    "created_at": "2020-03-24T02:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574643",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
Replying to [mkoeppe](#comment%3A3):
> which of our packages depends specifically on openblas.pc?


I meant, openblas.pc may be used by our spkg-configure for openblas. Otherwise it is not needed.



---

archive/issue_comments_574644.json:
```json
{
    "body": "<a id='comment:6'></a>\nYes, that's the problem.",
    "created_at": "2020-03-24T02:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574644",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Yes, that's the problem.



---

archive/issue_comments_574645.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/cygwin__accept_system_blas\"",
    "created_at": "2020-03-24T03:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574645",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/cygwin__accept_system_blas"



---

archive/issue_comments_574646.json:
```json
{
    "body": "Changing commit from \"\" to \"ba97132a21bc05c5b05cc31ea86567751bcffca6\"",
    "created_at": "2020-03-24T03:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574646",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "" to "ba97132a21bc05c5b05cc31ea86567751bcffca6"



---

archive/issue_comments_574647.json:
```json
{
    "body": "<a id='comment:8'></a>\nis this on top of a not yet merged ticket?\nPlease list it in Dependencies.\n\nAlso, what are these OPENBLAS_* variables?\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|\n|[bb89447](https://github.com/sagemath/sagetrac-mirror/commit/bb894474813c433d4cc3cea329026277e32cc2c2)|`build/pkgs/openblas/spkg-configure.m4: Use OPENBLAS_{LIBS,CFLAGS} while checking for cblas/lapack functions`|\n|[71ac6a5](https://github.com/sagemath/sagetrac-mirror/commit/71ac6a5e18ad2e08383a122ef305df593a34aa3a)|`build/pkgs/openblas/spkg-configure.m4: Do not use AC_FC_FUNC.`|\n|[7188bdd](https://github.com/sagemath/sagetrac-mirror/commit/7188bdded8e2c123a018e0d3eae83dbefb54dfc2)|`Merge branch 't/29361/openblas_spkg_configure_m4__fix_the_check_for_lapack_cblas_functions' into t/29398/cygwin__accept_system_blas`|\n|[ba97132](https://github.com/sagemath/sagetrac-mirror/commit/ba97132a21bc05c5b05cc31ea86567751bcffca6)|`build/pkgs/openblas/spkg-configure.m4: Fall back to checking whether {blas,cblas,lapack}.pc correspond to openblas - for cygwin`|",
    "created_at": "2020-03-24T03:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574647",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
is this on top of a not yet merged ticket?
Please list it in Dependencies.

Also, what are these OPENBLAS_* variables?

---
New commits:
|                                                                                                                                          |                                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
|[bb89447](https://github.com/sagemath/sagetrac-mirror/commit/bb894474813c433d4cc3cea329026277e32cc2c2)|`build/pkgs/openblas/spkg-configure.m4: Use OPENBLAS_{LIBS,CFLAGS} while checking for cblas/lapack functions`|
|[71ac6a5](https://github.com/sagemath/sagetrac-mirror/commit/71ac6a5e18ad2e08383a122ef305df593a34aa3a)|`build/pkgs/openblas/spkg-configure.m4: Do not use AC_FC_FUNC.`|
|[7188bdd](https://github.com/sagemath/sagetrac-mirror/commit/7188bdded8e2c123a018e0d3eae83dbefb54dfc2)|`Merge branch 't/29361/openblas_spkg_configure_m4__fix_the_check_for_lapack_cblas_functions' into t/29398/cygwin__accept_system_blas`|
|[ba97132](https://github.com/sagemath/sagetrac-mirror/commit/ba97132a21bc05c5b05cc31ea86567751bcffca6)|`build/pkgs/openblas/spkg-configure.m4: Fall back to checking whether {blas,cblas,lapack}.pc correspond to openblas - for cygwin`|



---

archive/issue_comments_574648.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29361\"",
    "created_at": "2020-03-24T03:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574648",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29361"



---

archive/issue_comments_574649.json:
```json
{
    "body": "<a id='comment:10'></a>\nNot ready for review yet.\n\nOPENBLAS_* is created by the pkgconfig macro",
    "created_at": "2020-03-24T03:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574649",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Not ready for review yet.

OPENBLAS_* is created by the pkgconfig macro



---

archive/issue_comments_574650.json:
```json
{
    "body": "<a id='comment:11'></a>\nAnd \"of course\" it does not work at all as advertised on cygwin.",
    "created_at": "2020-03-24T04:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574650",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
And "of course" it does not work at all as advertised on cygwin.



---

archive/issue_comments_574651.json:
```json
{
    "body": "<a id='comment:12'></a>\ncblas.pc refers to a non-existent library \"-lcblas\"...",
    "created_at": "2020-03-24T04:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574651",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
cblas.pc refers to a non-existent library "-lcblas"...



---

archive/issue_comments_574652.json:
```json
{
    "body": "<a id='comment:13'></a>\nwe can resort to shipping platform-dependent openblas.pc\n\nor, indeed, generate it.",
    "created_at": "2020-03-24T04:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574652",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>
we can resort to shipping platform-dependent openblas.pc

or, indeed, generate it.



---

archive/issue_comments_574653.json:
```json
{
    "body": "Changing commit from \"ba97132a21bc05c5b05cc31ea86567751bcffca6\" to \"089057b1fa6a29b15883be508d20df14323ba632\"",
    "created_at": "2020-03-24T19:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574653",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ba97132a21bc05c5b05cc31ea86567751bcffca6" to "089057b1fa6a29b15883be508d20df14323ba632"



---

archive/issue_comments_574654.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[f0bd0ec](https://github.com/sagemath/sagetrac-mirror/commit/f0bd0ec82498c77b39d4592a4787289d005b4be4)|`build/pkgs/openblas/spkg-configure.m4: Try if blas.pc alone has everything`|\n|[e08192b](https://github.com/sagemath/sagetrac-mirror/commit/e08192b651e308315e0e7a020962571b24fd2201)|`fixup`|\n|[089057b](https://github.com/sagemath/sagetrac-mirror/commit/089057b1fa6a29b15883be508d20df14323ba632)|`Update comments`|",
    "created_at": "2020-03-24T19:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574654",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[f0bd0ec](https://github.com/sagemath/sagetrac-mirror/commit/f0bd0ec82498c77b39d4592a4787289d005b4be4)|`build/pkgs/openblas/spkg-configure.m4: Try if blas.pc alone has everything`|
|[e08192b](https://github.com/sagemath/sagetrac-mirror/commit/e08192b651e308315e0e7a020962571b24fd2201)|`fixup`|
|[089057b](https://github.com/sagemath/sagetrac-mirror/commit/089057b1fa6a29b15883be508d20df14323ba632)|`Update comments`|



---

archive/issue_comments_574655.json:
```json
{
    "body": "<a id='comment:15'></a>\nThis is a version that works for cygwin (at least configure finds blas now).\nBut it is not really checking that the implementation is provided by openblas. It seems that functions such as `openblas_get_config` are not accessible.",
    "created_at": "2020-03-24T19:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574655",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
This is a version that works for cygwin (at least configure finds blas now).
But it is not really checking that the implementation is provided by openblas. It seems that functions such as `openblas_get_config` are not accessible.



---

archive/issue_comments_574656.json:
```json
{
    "body": "<a id='comment:16'></a>\n`gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`",
    "created_at": "2020-03-25T00:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574656",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
`gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`



---

archive/issue_comments_574657.json:
```json
{
    "body": "Changing dependencies from \"#29361\" to \"#29361, #29082\"",
    "created_at": "2020-03-25T00:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574657",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29361" to "#29361, #29082"



---

archive/issue_comments_574658.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[56a4f4c](https://github.com/sagemath/sagetrac-mirror/commit/56a4f4c290ba12ac6133bacd61de6932bfd659e1)|`build/pkgs/glpk/distros/cygwin.txt: New`|\n|[ba09bba](https://github.com/sagemath/sagetrac-mirror/commit/ba09bba5f920619a5f9dd2843c11e96fe4062f28)|`build/pkgs/ncurses/distros/cygwin.txt: Fixup`|\n|[391d224](https://github.com/sagemath/sagetrac-mirror/commit/391d2249f082b6712722e2a6f217c1fcb91a3a73)|`build/pkgs/openblas/distros/cygwin.txt: New`|\n|[e9f831a](https://github.com/sagemath/sagetrac-mirror/commit/e9f831aae0450a7d961ba9d18035f448752f2cf9)|`build/pkgs/ntl/distros/cygwin.txt: New`|\n|[905148b](https://github.com/sagemath/sagetrac-mirror/commit/905148b4eda8709445a6435e9f33e0f14a0d7bd5)|`build/pkgs/pcre/distros/cygwin.txt: New`|\n|[12540ac](https://github.com/sagemath/sagetrac-mirror/commit/12540ac4f30a3c8a224cabf6740432de787c9b90)|`build/pkgs/r/distros/cygwin.txt: New`|\n|[3fd30e3](https://github.com/sagemath/sagetrac-mirror/commit/3fd30e3146f2ba5e925f537d719f621dd84053da)|`build/pkgs/libatomic_ops/distros/cygwin.txt: New`|\n|[f29a168](https://github.com/sagemath/sagetrac-mirror/commit/f29a1686bd4d1d3bcae90497a3d30c225c2c9297)|`build/pkgs/cygwin.txt: python -> python37`|\n|[0162b7e](https://github.com/sagemath/sagetrac-mirror/commit/0162b7eea65883110d2b27f521e86d0892caf86a)|`Merge branch 't/29397/add_more_cygwin_system_packages' into t/29398/cygwin__accept_system_blas`|\n|[a34e7a3](https://github.com/sagemath/sagetrac-mirror/commit/a34e7a301461c814ef0112e376f99736324e0cb9)|`build/pkgs/r/distros/cygwin.txt: Add libtirpc-devel, needed for building rpy2`|",
    "created_at": "2020-03-25T01:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574658",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[56a4f4c](https://github.com/sagemath/sagetrac-mirror/commit/56a4f4c290ba12ac6133bacd61de6932bfd659e1)|`build/pkgs/glpk/distros/cygwin.txt: New`|
|[ba09bba](https://github.com/sagemath/sagetrac-mirror/commit/ba09bba5f920619a5f9dd2843c11e96fe4062f28)|`build/pkgs/ncurses/distros/cygwin.txt: Fixup`|
|[391d224](https://github.com/sagemath/sagetrac-mirror/commit/391d2249f082b6712722e2a6f217c1fcb91a3a73)|`build/pkgs/openblas/distros/cygwin.txt: New`|
|[e9f831a](https://github.com/sagemath/sagetrac-mirror/commit/e9f831aae0450a7d961ba9d18035f448752f2cf9)|`build/pkgs/ntl/distros/cygwin.txt: New`|
|[905148b](https://github.com/sagemath/sagetrac-mirror/commit/905148b4eda8709445a6435e9f33e0f14a0d7bd5)|`build/pkgs/pcre/distros/cygwin.txt: New`|
|[12540ac](https://github.com/sagemath/sagetrac-mirror/commit/12540ac4f30a3c8a224cabf6740432de787c9b90)|`build/pkgs/r/distros/cygwin.txt: New`|
|[3fd30e3](https://github.com/sagemath/sagetrac-mirror/commit/3fd30e3146f2ba5e925f537d719f621dd84053da)|`build/pkgs/libatomic_ops/distros/cygwin.txt: New`|
|[f29a168](https://github.com/sagemath/sagetrac-mirror/commit/f29a1686bd4d1d3bcae90497a3d30c225c2c9297)|`build/pkgs/cygwin.txt: python -> python37`|
|[0162b7e](https://github.com/sagemath/sagetrac-mirror/commit/0162b7eea65883110d2b27f521e86d0892caf86a)|`Merge branch 't/29397/add_more_cygwin_system_packages' into t/29398/cygwin__accept_system_blas`|
|[a34e7a3](https://github.com/sagemath/sagetrac-mirror/commit/a34e7a301461c814ef0112e376f99736324e0cb9)|`build/pkgs/r/distros/cygwin.txt: Add libtirpc-devel, needed for building rpy2`|



---

archive/issue_comments_574659.json:
```json
{
    "body": "Changing commit from \"089057b1fa6a29b15883be508d20df14323ba632\" to \"a34e7a301461c814ef0112e376f99736324e0cb9\"",
    "created_at": "2020-03-25T01:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574659",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "089057b1fa6a29b15883be508d20df14323ba632" to "a34e7a301461c814ef0112e376f99736324e0cb9"



---

archive/issue_comments_574660.json:
```json
{
    "body": "Changing commit from \"a34e7a301461c814ef0112e376f99736324e0cb9\" to \"5df9ca3af1cca195c7f9ac2fe5fc0b0c6480d2f1\"",
    "created_at": "2020-03-25T01:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574660",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a34e7a301461c814ef0112e376f99736324e0cb9" to "5df9ca3af1cca195c7f9ac2fe5fc0b0c6480d2f1"



---

archive/issue_comments_574661.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[705da6a](https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371)|`Link/generate pc files in make, not configure`|\n|[d86cd33](https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2)|`fixup`|\n|[f5b4f62](https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03)|`Makefile [misc-clean]: No need to remove build/lib/pkgconfig`|\n|[2a38a16](https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a)|`build/pkgs/gsl/spkg-configure.m4: Quoting fix`|\n|[329843b](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)|`Ignore /src/lib/pkgconfig using top-level .gitignore`|\n|[5df9ca3](https://github.com/sagemath/sagetrac-mirror/commit/5df9ca3af1cca195c7f9ac2fe5fc0b0c6480d2f1)|`Merge branch 't/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_' into t/29398/cygwin__accept_system_blas`|",
    "created_at": "2020-03-25T01:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[705da6a](https://github.com/sagemath/sagetrac-mirror/commit/705da6a06eaa69613f0c25149f7e9e2d21833371)|`Link/generate pc files in make, not configure`|
|[d86cd33](https://github.com/sagemath/sagetrac-mirror/commit/d86cd33c67e253dd17992a8a470a6391663892e2)|`fixup`|
|[f5b4f62](https://github.com/sagemath/sagetrac-mirror/commit/f5b4f625d6e3001f07123974b4d1f5356545ae03)|`Makefile [misc-clean]: No need to remove build/lib/pkgconfig`|
|[2a38a16](https://github.com/sagemath/sagetrac-mirror/commit/2a38a167ab0c6aa3f39d704eb4087d9adf36c85a)|`build/pkgs/gsl/spkg-configure.m4: Quoting fix`|
|[329843b](https://github.com/sagemath/sagetrac-mirror/commit/329843baa9cecfb751e8afdb6b666f01930f0bf0)|`Ignore /src/lib/pkgconfig using top-level .gitignore`|
|[5df9ca3](https://github.com/sagemath/sagetrac-mirror/commit/5df9ca3af1cca195c7f9ac2fe5fc0b0c6480d2f1)|`Merge branch 't/29082/move__pc_file_from_src__to_build___clean_generated___pc_files_at__make_distclean_' into t/29398/cygwin__accept_system_blas`|



---

archive/issue_comments_574662.json:
```json
{
    "body": "Changing dependencies from \"#29361, #29082\" to \"#29361, #29397, #29082\"",
    "created_at": "2020-03-25T01:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574662",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29361, #29082" to "#29361, #29397, #29082"



---

archive/issue_comments_574663.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [mkoeppe](#comment%3A16):\n> `gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`\n\n\nOr, rather, we should be generating cblas.pc",
    "created_at": "2020-03-25T01:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574663",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Replying to [mkoeppe](#comment%3A16):
> `gsl`'s `spkg-install` needs updating too -- it uses `pkgconfig cblas`


Or, rather, we should be generating cblas.pc



---

archive/issue_comments_574664.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided\n+As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided (but cblas.pc is broken).\n \n From http://cygwin.1069669.n5.nabble.com/Updated-openblas-0-3-3-1-td142613.html:\n \n``````\n",
    "created_at": "2020-03-25T01:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574664",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided
+As noted in #29397, Cygwin has openblas but does not provide openblas.pc; instead blas.pc, cblas.pc, lapack.pc are provided (but cblas.pc is broken).
 
 From http://cygwin.1069669.n5.nabble.com/Updated-openblas-0-3-3-1-td142613.html:
 
``````




---

archive/issue_comments_574665.json:
```json
{
    "body": "<a id='comment:22'></a>\nPerhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).",
    "created_at": "2020-03-25T01:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574665",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).



---

archive/issue_comments_574666.json:
```json
{
    "body": "<a id='comment:23'></a>\ngenerating *.pc files is a bit unpleasant, I did it on #28906 - I suppose one can borrow the relevant macros there (finind the absolute patch to the library was the most tricky part)",
    "created_at": "2020-03-25T02:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574666",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
generating *.pc files is a bit unpleasant, I did it on #28906 - I suppose one can borrow the relevant macros there (finind the absolute patch to the library was the most tricky part)



---

archive/issue_comments_574667.json:
```json
{
    "body": "<a id='comment:24'></a>\nI don't think one needs an absolute path at all in this situation.",
    "created_at": "2020-03-25T02:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574667",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
I don't think one needs an absolute path at all in this situation.



---

archive/issue_comments_574668.json:
```json
{
    "body": "<a id='comment:25'></a>\nwell, that's what you have in *.pc files, absolute paths, I don't really know why.",
    "created_at": "2020-03-25T02:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574668",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>
well, that's what you have in *.pc files, absolute paths, I don't really know why.



---

archive/issue_comments_574669.json:
```json
{
    "body": "<a id='comment:26'></a>\nTo my understanding, the variables at the top of the .pc files such as `prefix`, `includedir` are there only by convention and to make relocation easier. The only thing that matters is `Libs:` and `Cflags`",
    "created_at": "2020-03-25T02:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574669",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
To my understanding, the variables at the top of the .pc files such as `prefix`, `includedir` are there only by convention and to make relocation easier. The only thing that matters is `Libs:` and `Cflags`



---

archive/issue_comments_574670.json:
```json
{
    "body": "<a id='comment:27'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|\n|[db7ffdb](https://github.com/sagemath/sagetrac-mirror/commit/db7ffdba2980f5694665b0116bd763195a647ee9)|`build/pkgs/openblas/spkg-configure.m4: Fall back to checking whether {blas,cblas,lapack}.pc correspond to openblas - for cygwin`|\n|[20d2f9a](https://github.com/sagemath/sagetrac-mirror/commit/20d2f9a1d1c10acc023a98ea564ab962e48f5c06)|`build/pkgs/openblas/spkg-configure.m4: Try if blas.pc alone has everything`|\n|[f2c53d8](https://github.com/sagemath/sagetrac-mirror/commit/f2c53d8a8710b2b153ec0e57a966ee4ed0f2c023)|`fixup`|\n|[28d0055](https://github.com/sagemath/sagetrac-mirror/commit/28d0055359f94a802ea8073cffd4ba83b12f528d)|`Update comments`|\n|[b57d690](https://github.com/sagemath/sagetrac-mirror/commit/b57d690b5eb19a2fbfabd39d3f74101e2bbe24a9)|`build/pkgs/r/distros/cygwin.txt: Add libtirpc-devel, needed for building rpy2`|",
    "created_at": "2020-03-29T02:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574670",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
|[db7ffdb](https://github.com/sagemath/sagetrac-mirror/commit/db7ffdba2980f5694665b0116bd763195a647ee9)|`build/pkgs/openblas/spkg-configure.m4: Fall back to checking whether {blas,cblas,lapack}.pc correspond to openblas - for cygwin`|
|[20d2f9a](https://github.com/sagemath/sagetrac-mirror/commit/20d2f9a1d1c10acc023a98ea564ab962e48f5c06)|`build/pkgs/openblas/spkg-configure.m4: Try if blas.pc alone has everything`|
|[f2c53d8](https://github.com/sagemath/sagetrac-mirror/commit/f2c53d8a8710b2b153ec0e57a966ee4ed0f2c023)|`fixup`|
|[28d0055](https://github.com/sagemath/sagetrac-mirror/commit/28d0055359f94a802ea8073cffd4ba83b12f528d)|`Update comments`|
|[b57d690](https://github.com/sagemath/sagetrac-mirror/commit/b57d690b5eb19a2fbfabd39d3f74101e2bbe24a9)|`build/pkgs/r/distros/cygwin.txt: Add libtirpc-devel, needed for building rpy2`|



---

archive/issue_comments_574671.json:
```json
{
    "body": "Changing commit from \"5df9ca3af1cca195c7f9ac2fe5fc0b0c6480d2f1\" to \"b57d690b5eb19a2fbfabd39d3f74101e2bbe24a9\"",
    "created_at": "2020-03-29T02:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574671",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5df9ca3af1cca195c7f9ac2fe5fc0b0c6480d2f1" to "b57d690b5eb19a2fbfabd39d3f74101e2bbe24a9"



---

archive/issue_comments_574672.json:
```json
{
    "body": "<a id='comment:28'></a>\nRebased on 9.1.beta9",
    "created_at": "2020-03-29T02:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574672",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
Rebased on 9.1.beta9



---

archive/issue_comments_574673.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [mkoeppe](#comment%3A22):\n> Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).\n\n\nHelp with this would be welcome...",
    "created_at": "2020-03-29T14:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574673",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Replying to [mkoeppe](#comment%3A22):
> Perhaps best to ignore the .pc files in this situation and just do AC_SEARCH_LIBS for the libraries, and then writing out facade .pc files as in #29082. This would also take care of the `fedora-32-standard` openblas, which has no .pc files at all (#29393 Use system openblas on Fedora).


Help with this would be welcome...



---

archive/issue_comments_574674.json:
```json
{
    "body": "Changing dependencies from \"#29361, #29397, #29082\" to \"\"",
    "created_at": "2020-03-31T22:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574674",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29361, #29397, #29082" to ""



---

archive/issue_comments_574675.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|\n|[b9cc4b4](https://github.com/sagemath/sagetrac-mirror/commit/b9cc4b4c34ef870ea2488079d082fb54b19391d9)|`build/pkgs/r/distros/cygwin.txt: Add libtirpc-devel, needed for building rpy2`|\n|[950ba67](https://github.com/sagemath/sagetrac-mirror/commit/950ba671f078caeaa964db7292212a0450d30178)|`build/pkgs/openblas/spkg-configure.m4: Fall back to building openblas.pc from AC_SEARCH_LIBS`|",
    "created_at": "2020-04-01T03:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574675",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
|[b9cc4b4](https://github.com/sagemath/sagetrac-mirror/commit/b9cc4b4c34ef870ea2488079d082fb54b19391d9)|`build/pkgs/r/distros/cygwin.txt: Add libtirpc-devel, needed for building rpy2`|
|[950ba67](https://github.com/sagemath/sagetrac-mirror/commit/950ba671f078caeaa964db7292212a0450d30178)|`build/pkgs/openblas/spkg-configure.m4: Fall back to building openblas.pc from AC_SEARCH_LIBS`|



---

archive/issue_comments_574676.json:
```json
{
    "body": "Changing commit from \"b57d690b5eb19a2fbfabd39d3f74101e2bbe24a9\" to \"950ba671f078caeaa964db7292212a0450d30178\"",
    "created_at": "2020-04-01T03:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574676",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b57d690b5eb19a2fbfabd39d3f74101e2bbe24a9" to "950ba671f078caeaa964db7292212a0450d30178"



---

archive/issue_comments_574677.json:
```json
{
    "body": "<a id='comment:32'></a>\nThis seems to work. It falls back to using AC_SEARCH_LIBS, and then constructs a minimal openblas.pc.\n\nBut I think this needs some extra checks -- otherwise this would accept just about any BLAS in the system and pretend it's openblas.",
    "created_at": "2020-04-01T03:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574677",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
This seems to work. It falls back to using AC_SEARCH_LIBS, and then constructs a minimal openblas.pc.

But I think this needs some extra checks -- otherwise this would accept just about any BLAS in the system and pretend it's openblas.



---

archive/issue_comments_574678.json:
```json
{
    "body": "<a id='comment:33'></a>\nwould it also work on Fedora (which doesn't install openblas.pc)?",
    "created_at": "2020-04-01T03:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574678",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>
would it also work on Fedora (which doesn't install openblas.pc)?



---

archive/issue_comments_574679.json:
```json
{
    "body": "<a id='comment:34'></a>\nI would hope so, but haven't tested yet.",
    "created_at": "2020-04-01T03:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574679",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
I would hope so, but haven't tested yet.



---

archive/issue_comments_574680.json:
```json
{
    "body": "<a id='comment:35'></a>\nTests at https://github.com/mkoeppe/sage/actions/runs/67915244 and https://github.com/mkoeppe/sage/actions/runs/67915245",
    "created_at": "2020-04-01T03:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574680",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Tests at https://github.com/mkoeppe/sage/actions/runs/67915244 and https://github.com/mkoeppe/sage/actions/runs/67915245



---

archive/issue_comments_574681.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n \n   3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS\n \n-\n+Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities)\n``````\n",
    "created_at": "2020-04-01T03:40:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574681",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 
   3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS
 
-
+Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities)
``````




---

archive/issue_events_084535.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "rename": {
        "from": "cygwin: Accept system BLAS",
        "to": "Accept system (Open)BLAS"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29398#event-84535"
}
```



---

archive/issue_comments_574682.json:
```json
{
    "body": "<a id='comment:37'></a>\nFor checking whether a system blas on Linux is actually openblas, we can use a function test for openblas_get_config.\n\nOn Cygwin, I don't know a better solution than to do `strings $(which cygblas-0.dll) | grep openblas` to distinguish the good openblas from the bad generic blas.",
    "created_at": "2020-04-01T03:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574682",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
For checking whether a system blas on Linux is actually openblas, we can use a function test for openblas_get_config.

On Cygwin, I don't know a better solution than to do `strings $(which cygblas-0.dll) | grep openblas` to distinguish the good openblas from the bad generic blas.



---

archive/issue_comments_574683.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n \n   3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS\n \n-Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities)\n+Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities) - see #29393 (Use system openblas on Fedora)\n``````\n",
    "created_at": "2020-04-01T03:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574683",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 
   3) libopenblas consist of a single file /usr/bin/cygblas-0.dll that will precede in PATH the liblapack0 /usr/lib/lapack/cygblas-0.dll    and used instead. Removing libopenblas will restore the    usage of Netlib BLAS
 
-Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities)
+Fedora has a similar omission - it does not install openblas.pc (while its openblas has cblas and lapack capabilities) - see #29393 (Use system openblas on Fedora)
``````




---

archive/issue_comments_574684.json:
```json
{
    "body": "<a id='comment:39'></a>\nDo you mean that on Cygwin they don't have `openblas_get_config` even for \"real\" openblas? This is a bug...",
    "created_at": "2020-04-01T04:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574684",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>
Do you mean that on Cygwin they don't have `openblas_get_config` even for "real" openblas? This is a bug...



---

archive/issue_comments_574685.json:
```json
{
    "body": "<a id='comment:40'></a>\nThey only use openblas as a drop-in binary-compatible replacement for blas/cblas.",
    "created_at": "2020-04-01T04:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574685",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
They only use openblas as a drop-in binary-compatible replacement for blas/cblas.



---

archive/issue_comments_574686.json:
```json
{
    "body": "<a id='comment:41'></a>\nif it's cygwin-specific, maybe it's easier to call `cygcheck -c openblas` ?",
    "created_at": "2020-04-01T04:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574686",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
if it's cygwin-specific, maybe it's easier to call `cygcheck -c openblas` ?



---

archive/issue_comments_574687.json:
```json
{
    "body": "<a id='comment:42'></a>\nThat wouldn't give the correct answer when users change the PATH from the default one, so that the generic blas dll wins",
    "created_at": "2020-04-01T04:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574687",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>
That wouldn't give the correct answer when users change the PATH from the default one, so that the generic blas dll wins



---

archive/issue_comments_574688.json:
```json
{
    "body": "<a id='comment:43'></a>\nFedora seems to work too - https://github.com/mkoeppe/sage/runs/550765309",
    "created_at": "2020-04-01T12:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574688",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>
Fedora seems to work too - https://github.com/mkoeppe/sage/runs/550765309



---

archive/issue_comments_574689.json:
```json
{
    "body": "<a id='comment:44'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|\n|[2873d86](https://github.com/sagemath/sagetrac-mirror/commit/2873d86a6e39d76320250d1b8509e301ff00f868)|`build/pkgs/openblas/spkg-configure.m4: Check version also when no pc file is available`|",
    "created_at": "2020-04-02T04:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574689",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
|[2873d86](https://github.com/sagemath/sagetrac-mirror/commit/2873d86a6e39d76320250d1b8509e301ff00f868)|`build/pkgs/openblas/spkg-configure.m4: Check version also when no pc file is available`|



---

archive/issue_comments_574690.json:
```json
{
    "body": "Changing commit from \"950ba671f078caeaa964db7292212a0450d30178\" to \"2873d86a6e39d76320250d1b8509e301ff00f868\"",
    "created_at": "2020-04-02T04:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "950ba671f078caeaa964db7292212a0450d30178" to "2873d86a6e39d76320250d1b8509e301ff00f868"



---

archive/issue_comments_574691.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-04-02T04:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574691",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_574692.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-02T04:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574692",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_574693.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2020-04-02T06:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574693",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_574694.json:
```json
{
    "body": "<a id='comment:47'></a>\nlgtm",
    "created_at": "2020-04-02T06:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574694",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:47'></a>
lgtm



---

archive/issue_comments_574695.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-02T06:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574695",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_574696.json:
```json
{
    "body": "<a id='comment:48'></a>\nThanks!",
    "created_at": "2020-04-02T12:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574696",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:48'></a>
Thanks!



---

archive/issue_comments_574697.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-04-02T12:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574697",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_574698.json:
```json
{
    "body": "<a id='comment:50'></a>\nI guess I should remove my debugging code that disables pkgconfig detection from this!",
    "created_at": "2020-04-02T12:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574698",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:50'></a>
I guess I should remove my debugging code that disables pkgconfig detection from this!



---

archive/issue_comments_574699.json:
```json
{
    "body": "<a id='comment:51'></a>\nWith the pkgconfig-based detection disabled, on `debian-buster-standard` (https://github.com/mkoeppe/sage/runs/553984061) one sees the following:\n\n```\n       self._backend.solve()\n      File \"sage/numerical/backends/cvxopt_sdp_backend.pyx\", line 369, in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:4838)\n        from cvxopt import matrix as c_matrix, solvers\n      File \"/sage/local/lib/python3.7/site-packages/cvxopt/__init__.py\", line 279, in <module>\n        from cvxopt import solvers, blas, lapack\n    ImportError: /sage/local/lib/python3.7/site-packages/cvxopt/blas.cpython-37m-x86_64-linux-gnu.so: undefined symbol: dtrsm_\n```",
    "created_at": "2020-04-02T12:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574699",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'></a>
With the pkgconfig-based detection disabled, on `debian-buster-standard` (https://github.com/mkoeppe/sage/runs/553984061) one sees the following:

```
       self._backend.solve()
      File "sage/numerical/backends/cvxopt_sdp_backend.pyx", line 369, in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:4838)
        from cvxopt import matrix as c_matrix, solvers
      File "/sage/local/lib/python3.7/site-packages/cvxopt/__init__.py", line 279, in <module>
        from cvxopt import solvers, blas, lapack
    ImportError: /sage/local/lib/python3.7/site-packages/cvxopt/blas.cpython-37m-x86_64-linux-gnu.so: undefined symbol: dtrsm_
```



---

archive/issue_comments_574700.json:
```json
{
    "body": "Changing commit from \"2873d86a6e39d76320250d1b8509e301ff00f868\" to \"0cda07c33fe26f035377c57c8982f3e2ea8da85d\"",
    "created_at": "2020-04-02T12:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574700",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2873d86a6e39d76320250d1b8509e301ff00f868" to "0cda07c33fe26f035377c57c8982f3e2ea8da85d"



---

archive/issue_comments_574701.json:
```json
{
    "body": "<a id='comment:52'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n|[0cda07c](https://github.com/sagemath/sagetrac-mirror/commit/0cda07c33fe26f035377c57c8982f3e2ea8da85d)|`build/pkgs/openblas/spkg-configure.m4: Make pkgconfig-based detection work again`|",
    "created_at": "2020-04-02T12:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|[0cda07c](https://github.com/sagemath/sagetrac-mirror/commit/0cda07c33fe26f035377c57c8982f3e2ea8da85d)|`build/pkgs/openblas/spkg-configure.m4: Make pkgconfig-based detection work again`|



---

archive/issue_comments_574702.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-04-02T12:54:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574702",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_574703.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [git](#comment%3A52):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                                                                  |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n> |[0cda07c](https://github.com/sagemath/sagetrac-mirror/commit/0cda07c33fe26f035377c57c8982f3e2ea8da85d)|`build/pkgs/openblas/spkg-configure.m4: Make pkgconfig-based detection work again`|\n\n\noops, I missed this.",
    "created_at": "2020-04-02T15:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574703",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:54'></a>
Replying to [git](#comment%3A52):
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                                                                  |
> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
> |[0cda07c](https://github.com/sagemath/sagetrac-mirror/commit/0cda07c33fe26f035377c57c8982f3e2ea8da85d)|`build/pkgs/openblas/spkg-configure.m4: Make pkgconfig-based detection work again`|


oops, I missed this.



---

archive/issue_comments_574704.json:
```json
{
    "body": "<a id='comment:55'></a>\nFixed `debian-buster-standard`: https://github.com/mkoeppe/sage/runs/554994789",
    "created_at": "2020-04-02T16:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574704",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:55'></a>
Fixed `debian-buster-standard`: https://github.com/mkoeppe/sage/runs/554994789



---

archive/issue_comments_574705.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-02T16:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574705",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_574706.json:
```json
{
    "body": "<a id='comment:56'></a>\nOK, looks good.\nBy the way (offtopic), why do we see this\n\n```\n2020-04-02T16:07:07.4502918Z **********************************************************************\n2020-04-02T16:07:07.4503012Z File \"src/sage/tests/cmdline.py\", line 600, in sage.tests.cmdline.test_executable\n2020-04-02T16:07:07.4503087Z Failed example:\n2020-04-02T16:07:07.4503167Z     err\n2020-04-02T16:07:07.4503245Z Expected:\n2020-04-02T16:07:07.4503440Z     ''\n2020-04-02T16:07:07.4503502Z Got:\n2020-04-02T16:07:07.4503715Z     '/sage/src/bin/sage: line 564: exec: sqlite3: not found\\n'\n```\nis it by design?",
    "created_at": "2020-04-02T16:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574706",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:56'></a>
OK, looks good.
By the way (offtopic), why do we see this

```
2020-04-02T16:07:07.4502918Z **********************************************************************
2020-04-02T16:07:07.4503012Z File "src/sage/tests/cmdline.py", line 600, in sage.tests.cmdline.test_executable
2020-04-02T16:07:07.4503087Z Failed example:
2020-04-02T16:07:07.4503167Z     err
2020-04-02T16:07:07.4503245Z Expected:
2020-04-02T16:07:07.4503440Z     ''
2020-04-02T16:07:07.4503502Z Got:
2020-04-02T16:07:07.4503715Z     '/sage/src/bin/sage: line 564: exec: sqlite3: not found\n'
```
is it by design?



---

archive/issue_comments_574707.json:
```json
{
    "body": "<a id='comment:57'></a>\n\n```\n$ cat build/pkgs/sqlite/distros/debian.txt \nlibsqlite3-dev\n```\nWe can add the package with the executable `sqlite3`",
    "created_at": "2020-04-02T16:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574707",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'></a>

```
$ cat build/pkgs/sqlite/distros/debian.txt 
libsqlite3-dev
```
We can add the package with the executable `sqlite3`



---

archive/issue_comments_574708.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [mkoeppe](#comment%3A57):\n> We can add the package with the executable `sqlite3` \n\n\nThis is now #29487",
    "created_at": "2020-04-09T17:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574708",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:58'></a>
Replying to [mkoeppe](#comment%3A57):
> We can add the package with the executable `sqlite3` 


This is now #29487



---

archive/issue_comments_574709.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/cygwin__accept_system_blas\" to \"0cda07c33fe26f035377c57c8982f3e2ea8da85d\"",
    "created_at": "2020-04-09T22:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574709",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/cygwin__accept_system_blas" to "0cda07c33fe26f035377c57c8982f3e2ea8da85d"



---

archive/issue_comments_574710.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-09T22:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29398#issuecomment-574710",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_084536.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-09T22:44:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29398",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29398#event-84536"
}
```
