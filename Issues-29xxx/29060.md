# Issue 29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages

archive/issues_028823.json:
```json
{
    "body": "Testing of source and binary distributions relies too much on manual testing by people.\n\nWe propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n\n**Testing of source trees and source distributions:** (in progress) \n\nWith the important changes brought by #27330 (Meta-ticket: `spkg-configure`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n\n1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  `build/pkgs/SPKG/distros/`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n\n2. We generate well-defined test environments in the form of `Dockerfile`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides `build/bin/write-dockerfile.sh` that generates the `Dockerfile` using the information in 1. The `minimal` configuration has just the packages that are needed for a build to succeed. The `standard` configuration installs all distribution packages that sage knows how to use.\n\n3. Running tests on many test environments is automated using `tox` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using `tox`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run `tox -e docker-debian-stretch-minimal,docker-arch-latest-standard`.\n\n4. #29087 automates running the `tox` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every `git push` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n\n\nTickets:\n- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all `spkg-configure.m4` scripts work as expected\n- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n- #29129: Add more system packages to build/pkgs/SPKG/distros/\n- #29273: add system packages info for R and others\n- #29106: Add cygwin package information\n- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n- #29367: tox.ini: Add tests for python2\n- #29415: tox.ini: Add environment local-conda\n- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n- #29403: ci-cygwin.yml: Multi-stage build\n- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n- #29901: `.github/workflows/`: Test all optional packages, add workflow for testing all experimental packages\n- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n- #30064: Fix tox-docker builds broken by #29884\n- #29091: tox.ini: Add raspbian-buster\n- #29929: tox.ini: Various CI fixes\n- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n- #30044: tox.ini: Test on voidlinux\n- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n- #29130: Add nix package information, extend dockerfile generator to nix\n- #30216 GH Actions: Test Windows with WSL\n- #30923: tox.ini: Add environments `local-sudo-ubuntu-standard`, etc.\n- #30619: update opensuse.txt across build/pkgs/\n- #30154: cygwin: CI fixes\n- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n- #29527: tox.ini: Add docker-opensuse\n- #30213: tox.ini: Add scientificlinux\n- #29356: Meta-ticket: more system pkgs info for various linuxes\n- #32113: GH Actions: `conda-forge` tests broken\n- #32947: `tox.ini`, GH Actions: Update Linux platforms\n- #33196: `tox.ini`: Add `centos-stream-8`, `centos-stream-9`, remove defunct `centos-6`\n- #33296: tox.ini: Add `-recommended` package factor\n- #33140: GH Actions (macOS): Fix filtering of experimental packages\n- #31415: GH Actions workflow that builds documentation on each push\n- #33306: `tox.ini`: Linux platform updates\n- #32965: `tox` / GH Actions: Add `centos-7-devtoolset-gcc_{9,10,11}`\n- #32966: tox / GH Actions: Add ubuntu variants using `ppa:ubuntu-toolchain-r`\n- #33263: Add github action running on each push\n- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n- #32703: GH Actions: Run a job for `make build-local` first, cache image for job `make build`\n- #31211: `ci-cygwin*.yml`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n- #30933: GH Actions: Repair upload of docker images\n- #31413: GH Actions: Add workflow with `configure --enable-editable`\n- #34228: `tox -e docker-...-incremental`\n- #33062: GH Actions (docker): Run a job for \"make build-local\" first, cache image for job \"make build\"\n- #32784: Filter singular system package out of `tox.ini` for homebrew\t\n- #31088: GH Actions: WSL workflow: No space left on device\n- #32570: `tox.ini`, GH Actions: Update macOS environments\n- #32531: `SAGE_ROOT/tox.ini`: Add variants that provision a system python using `pyenv`\n- #30505: tox.ini: Add `wsl` as a technology, to complement `local` and `docker`\n- #30924: tox.ini: Add `cygwin` as a technology, to complement `local` and `docker`\n- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n- test gentoo \"prefix\" builds on top of some Linux distribution\n- #29416: tox.ini: Add local-copy\n- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n- #32280: Manage disk space constraints in continuous integration\n- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n- #29283: tox.ini: Add test environments using LXC\n- #29159: Add to tox.ini a toxenv docker-linuxbrew\n- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of `ci-sage.yml` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n\nRelated meta-tickets:\n- #29146: Meta-ticket: Refactor/improve system package related scripts, `tox.ini`, `build/bin/write_dockerfile.sh`\n- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows\n- #32074 Meta-ticket: Remove support for outdated distros\n\nIdeas without tickets so far:\n- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n- Test that packages can be cleanly uninstalled\n\n---\n\n**Testing of the sage binary distributions:** moved to #31133\n\n---\n\n**Testing of downstream packaging of sage:** (planning stage)\n\n- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that `sage -c SAGECOMMAND`, `sage -t`, `sage -python -c COMMAND`, ... work with the `sage` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n- #33671 Add `devcontainer.json` for development with VS Code in a Docker container\n\n---\n\nSymptoms:\n- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n\nCC:  @vbraun @kiwifb @isuruf @dimpase @embray @saraedum @antonio-rojas @slel @sheerluck @tobiasdiez\n\nKeywords: docker, ContinuousIntegration, sd111\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/29060\n\n",
    "created_at": "2020-01-21T15:42:32Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29060",
    "user": "https://github.com/mkoeppe"
}
```
Testing of source and binary distributions relies too much on manual testing by people.

We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.

**Testing of source trees and source distributions:** (in progress) 

With the important changes brought by #27330 (Meta-ticket: `spkg-configure`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 

1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  `build/pkgs/SPKG/distros/`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).

2. We generate well-defined test environments in the form of `Dockerfile`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides `build/bin/write-dockerfile.sh` that generates the `Dockerfile` using the information in 1. The `minimal` configuration has just the packages that are needed for a build to succeed. The `standard` configuration installs all distribution packages that sage knows how to use.

3. Running tests on many test environments is automated using `tox` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using `tox`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run `tox -e docker-debian-stretch-minimal,docker-arch-latest-standard`.

4. #29087 automates running the `tox` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every `git push` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271


Tickets:
- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all `spkg-configure.m4` scripts work as expected
- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
- #29129: Add more system packages to build/pkgs/SPKG/distros/
- #29273: add system packages info for R and others
- #29106: Add cygwin package information
- #29295: Add [GitHub](GitHub) CI workflow for cygwin
- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
- #29367: tox.ini: Add tests for python2
- #29415: tox.ini: Add environment local-conda
- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
- #29403: ci-cygwin.yml: Multi-stage build
- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
- #29901: `.github/workflows/`: Test all optional packages, add workflow for testing all experimental packages
- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
- #29105: Add gentoo package information, extend dockerfile generator to gentoo
- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
- #30064: Fix tox-docker builds broken by #29884
- #29091: tox.ini: Add raspbian-buster
- #29929: tox.ini: Various CI fixes
- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
- #30044: tox.ini: Test on voidlinux
- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
- #29130: Add nix package information, extend dockerfile generator to nix
- #30216 GH Actions: Test Windows with WSL
- #30923: tox.ini: Add environments `local-sudo-ubuntu-standard`, etc.
- #30619: update opensuse.txt across build/pkgs/
- #30154: cygwin: CI fixes
- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
- #30726: GH Actions: Test optional/experimental packages with Xcode 12
- #29527: tox.ini: Add docker-opensuse
- #30213: tox.ini: Add scientificlinux
- #29356: Meta-ticket: more system pkgs info for various linuxes
- #32113: GH Actions: `conda-forge` tests broken
- #32947: `tox.ini`, GH Actions: Update Linux platforms
- #33196: `tox.ini`: Add `centos-stream-8`, `centos-stream-9`, remove defunct `centos-6`
- #33296: tox.ini: Add `-recommended` package factor
- #33140: GH Actions (macOS): Fix filtering of experimental packages
- #31415: GH Actions workflow that builds documentation on each push
- #33306: `tox.ini`: Linux platform updates
- #32965: `tox` / GH Actions: Add `centos-7-devtoolset-gcc_{9,10,11}`
- #32966: tox / GH Actions: Add ubuntu variants using `ppa:ubuntu-toolchain-r`
- #33263: Add github action running on each push
- #30845: tox.ini, GH Actions: Add test for conda without SPKG
- #32703: GH Actions: Run a job for `make build-local` first, cache image for job `make build`
- #31211: `ci-cygwin*.yml`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
- #30933: GH Actions: Repair upload of docker images
- #31413: GH Actions: Add workflow with `configure --enable-editable`
- #34228: `tox -e docker-...-incremental`
- #33062: GH Actions (docker): Run a job for "make build-local" first, cache image for job "make build"
- #32784: Filter singular system package out of `tox.ini` for homebrew	
- #31088: GH Actions: WSL workflow: No space left on device
- #32570: `tox.ini`, GH Actions: Update macOS environments
- #32531: `SAGE_ROOT/tox.ini`: Add variants that provision a system python using `pyenv`
- #30505: tox.ini: Add `wsl` as a technology, to complement `local` and `docker`
- #30924: tox.ini: Add `cygwin` as a technology, to complement `local` and `docker`
- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
- test gentoo "prefix" builds on top of some Linux distribution
- #29416: tox.ini: Add local-copy
- #30506: GH Actions: Use cancel-all-previous-workflow-runs
- #32280: Manage disk space constraints in continuous integration
- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
- #29283: tox.ini: Add test environments using LXC
- #29159: Add to tox.ini a toxenv docker-linuxbrew
- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of `ci-sage.yml` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)

Related meta-tickets:
- #29146: Meta-ticket: Refactor/improve system package related scripts, `tox.ini`, `build/bin/write_dockerfile.sh`
- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows
- #32074 Meta-ticket: Remove support for outdated distros

Ideas without tickets so far:
- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
- Test that packages can be cleanly uninstalled

---

**Testing of the sage binary distributions:** moved to #31133

---

**Testing of downstream packaging of sage:** (planning stage)

- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that `sage -c SAGECOMMAND`, `sage -t`, `sage -python -c COMMAND`, ... work with the `sage` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
- #33671 Add `devcontainer.json` for development with VS Code in a Docker container

---

Symptoms:
- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy

CC:  @vbraun @kiwifb @isuruf @dimpase @embray @saraedum @antonio-rojas @slel @sheerluck @tobiasdiez

Keywords: docker, ContinuousIntegration, sd111

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/29060





---

archive/issue_comments_433882.json:
```json
{
    "body": "Changing keywords from \"\" to \"docker, ContinuousIntegration\".",
    "created_at": "2020-01-21T16:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433882",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "" to "docker, ContinuousIntegration".



---

archive/issue_comments_433883.json:
```json
{
    "body": "<a id='comment:1'></a>I like the general idea of doing more CI a lot. Probably we should split this ticket up though or turn it into a meta ticket that tracks similar CI improvements such as #28457, #24854, #25262.\n\nFor this to be actually noticed by people we probably would need some integration with Trac. If I understood embray correctly, adding something like that, similar to the patchbot status, would not be difficult. (Since #28457 has been ready for a while, it might be a good first candidate for such an integration.)\n\nI would propose to use [GitLab](GitLab) CI for probably all the things you describe. We already have some CI setup there that has been mostly stable recently (though most people don't know about it https://gitlab.com/sagemath/dev/trac/pipelines?page=1&scope=all since it's not visible in trac yet.) I had made some experiments with macOS & Windows there that were not completely disappointing. For macOS you cannot use docker but still [GitLab](GitLab) CI works, see e.g. #25980. Windows can be run inside docker (on Windows) but two years ago, the performance was not sufficient, see #25805. Without docker it worked fine though.\n\nFor our Linux CI needs, we can mostly use the free [GitLab](GitLab) runners but last time we tried we could also easily get plenty of free credits on Google Cloud. For macOS & Windows, I had at some point built a PoC runner that slelievre volunteered to host; unfortunately, I never finished that project.",
    "created_at": "2020-01-21T16:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433883",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:1'></a>I like the general idea of doing more CI a lot. Probably we should split this ticket up though or turn it into a meta ticket that tracks similar CI improvements such as #28457, #24854, #25262.

For this to be actually noticed by people we probably would need some integration with Trac. If I understood embray correctly, adding something like that, similar to the patchbot status, would not be difficult. (Since #28457 has been ready for a while, it might be a good first candidate for such an integration.)

I would propose to use [GitLab](GitLab) CI for probably all the things you describe. We already have some CI setup there that has been mostly stable recently (though most people don't know about it https://gitlab.com/sagemath/dev/trac/pipelines?page=1&scope=all since it's not visible in trac yet.) I had made some experiments with macOS & Windows there that were not completely disappointing. For macOS you cannot use docker but still [GitLab](GitLab) CI works, see e.g. #25980. Windows can be run inside docker (on Windows) but two years ago, the performance was not sufficient, see #25805. Without docker it worked fine though.

For our Linux CI needs, we can mostly use the free [GitLab](GitLab) runners but last time we tried we could also easily get plenty of free credits on Google Cloud. For macOS & Windows, I had at some point built a PoC runner that slelievre volunteered to host; unfortunately, I never finished that project.



---

archive/issue_comments_433884.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 saraedum]:\n> I like the general idea of doing more CI a lot. Probably we should split this ticket up though or turn it into a meta ticket that tracks similar CI improvements such as #28457, #24854, #25262.\n> \n> For this to be actually noticed by people we probably would need some integration with Trac. \n\n\nYes, that would be nice. But it would already help if this were run at the time that betas and releases are prepared. I don't think it needs to be run on every ticket.",
    "created_at": "2020-01-21T16:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433884",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>Replying to [comment:1 saraedum]:
> I like the general idea of doing more CI a lot. Probably we should split this ticket up though or turn it into a meta ticket that tracks similar CI improvements such as #28457, #24854, #25262.
> 
> For this to be actually noticed by people we probably would need some integration with Trac. 


Yes, that would be nice. But it would already help if this were run at the time that betas and releases are prepared. I don't think it needs to be run on every ticket.



---

archive/issue_comments_433885.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -15,6 +15,9 @@\n - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n - https://github.com/mkoeppe/sage_binary_tester (outdated)\n \n+Tickets:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+\n Comment: 1\n \n Summary: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages\n```\n",
    "created_at": "2020-01-22T17:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433885",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -15,6 +15,9 @@
 - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
 - https://github.com/mkoeppe/sage_binary_tester (outdated)
 
+Tickets:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+
 Comment: 1
 
 Summary: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages
```




---

archive/issue_comments_433886.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,25 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Examples:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that all \\`spkg-configure.m4\\` scripts work as expected (using \\`./configure --with-system-PACKAGE=force\\`)\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+See the following for some work in this direction:\n+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+- https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Tickets:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-24T16:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433886",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,25 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Examples:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that all \`spkg-configure.m4\` scripts work as expected (using \`./configure --with-system-PACKAGE=force\`)
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+See the following for some work in this direction:
+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+- https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Tickets:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
 
 Comment: 1
 
```




---

archive/issue_comments_433887.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Examples:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that all \\`spkg-configure.m4\\` scripts work as expected (using \\`./configure --with-system-PACKAGE=force\\`)\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+See the following for some work in this direction:\n+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+- https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Tickets:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29053: Add debian/fedora package information to build/pkgs, generate Dockerfiles and installation help\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-25T18:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433887",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,27 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Examples:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that all \`spkg-configure.m4\` scripts work as expected (using \`./configure --with-system-PACKAGE=force\`)
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+See the following for some work in this direction:
+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+- https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Tickets:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29053: Add debian/fedora package information to build/pkgs, generate Dockerfiles and installation help
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433888.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,28 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Examples:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that all \\`spkg-configure.m4\\` scripts work as expected (using \\`./configure --with-system-PACKAGE=force\\`)\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+See the following for some work in this direction:\n+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+- https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Tickets:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29053: Add debian/fedora package information to build/pkgs, generate Dockerfiles and installation help\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-27T17:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433888",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,28 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Examples:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that all \`spkg-configure.m4\` scripts work as expected (using \`./configure --with-system-PACKAGE=force\`)
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+See the following for some work in this direction:
+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+- https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Tickets:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29053: Add debian/fedora package information to build/pkgs, generate Dockerfiles and installation help
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433889.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,29 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Examples:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that all \\`spkg-configure.m4\\` scripts work as expected (using \\`./configure --with-system-PACKAGE=force\\`)\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+See the following for some work in this direction:\n+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+- https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Tickets:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-29T19:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433889",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,29 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Examples:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that all \`spkg-configure.m4\` scripts work as expected (using \`./configure --with-system-PACKAGE=force\`)
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+- Testing that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+See the following for some work in this direction:
+- https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+- https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Tickets:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433890.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,33 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Testing of source trees and source distributions:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+Testing of the sage binary distributions:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Testing of downstream packaging of sage:\n+\n+- Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-29T19:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433890",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,33 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Testing of source trees and source distributions:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+Testing of the sage binary distributions:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Testing of downstream packaging of sage:
+
+- Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433891.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,34 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Testing of source trees and source distributions:\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+Testing of the sage binary distributions:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Testing of downstream packaging of sage:\n+\n+- Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-30T02:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433891",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,34 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Testing of source trees and source distributions:
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+Testing of the sage binary distributions:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Testing of downstream packaging of sage:
+
+- Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433892.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,34 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Testing of source trees and source distributions:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+Testing of the sage binary distributions:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Testing of downstream packaging of sage:\n+\n+- Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-30T02:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433892",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,34 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Testing of source trees and source distributions:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+Testing of the sage binary distributions:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Testing of downstream packaging of sage:
+
+- Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433893.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,34 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+Testing of source trees and source distributions:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+Testing of the sage binary distributions:\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+Testing of downstream packaging of sage:\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-30T16:24:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433893",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,34 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+Testing of source trees and source distributions:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+Testing of the sage binary distributions:
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+Testing of downstream packaging of sage:
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433894.json:
```json
{
    "body": "<a id='comment:12'></a>This needs a writeup to explain how all these cogs: tox, docker, github actions, etc. fit together and move.",
    "created_at": "2020-01-30T16:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433894",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>This needs a writeup to explain how all these cogs: tox, docker, github actions, etc. fit together and move.



---

archive/issue_comments_433895.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,53 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration\\` has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- #29106 Add cygwin package information\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-30T17:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433895",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,53 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration\` has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- #29106 Add cygwin package information
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433896.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:12 dimpase]:\n> This needs a writeup to explain how all these cogs: tox, docker, github actions, etc. fit together and move.\n\nGood idea, please take a look at the revised description and let me know what needs more detail.",
    "created_at": "2020-01-30T17:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433896",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [comment:12 dimpase]:
> This needs a writeup to explain how all these cogs: tox, docker, github actions, etc. fit together and move.

Good idea, please take a look at the revised description and let me know what needs more detail.



---

archive/issue_comments_433897.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,53 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- #29106 Add cygwin package information\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-30T17:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433897",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,53 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- #29106 Add cygwin package information
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433898.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29106 Add cygwin package information\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-30T17:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433898",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,55 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29106 Add cygwin package information
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433899.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,56 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29106 Add cygwin package information\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-01-31T22:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433899",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,56 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29106 Add cygwin package information
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433900.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,57 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29106 Add cygwin package information\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-02-02T19:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433900",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,57 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29106 Add cygwin package information
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433901.json:
```json
{
    "body": "<a id='comment:19'></a>On some branches there are also lists of `<distro>` packages in `build/pkgs/<distro>.txt` which appear to be used for some kind of bootstrapping.\nWhat are these?",
    "created_at": "2020-02-02T19:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433901",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>On some branches there are also lists of `<distro>` packages in `build/pkgs/<distro>.txt` which appear to be used for some kind of bootstrapping.
What are these?



---

archive/issue_comments_433902.json:
```json
{
    "body": "<a id='comment:20'></a>`build/pkgs/DISTRO.txt` contains the minimal requirements for building sage from a source distribution\nand `build/pkgs/DISTRO-bootstrap.txt` are the additional requirements so that `./bootstrap` works.\nIn #29124 I propose to create pseudo-spkgs to capture these, instead, to make this a bit more uniform.",
    "created_at": "2020-02-02T20:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433902",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>`build/pkgs/DISTRO.txt` contains the minimal requirements for building sage from a source distribution
and `build/pkgs/DISTRO-bootstrap.txt` are the additional requirements so that `./bootstrap` works.
In #29124 I propose to create pseudo-spkgs to capture these, instead, to make this a bit more uniform.



---

archive/issue_comments_433903.json:
```json
{
    "body": "<a id='comment:21'></a>Comments on the top of `build/pkgs/debian.txt` explain this.",
    "created_at": "2020-02-02T20:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433903",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Comments on the top of `build/pkgs/debian.txt` explain this.



---

archive/issue_comments_433904.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,60 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29106: Add cygwin package information\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-03-06T02:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433904",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,60 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29106: Add cygwin package information
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433905.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,61 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Testing the cygwin build using Azure pipelines / GitHub Actions.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-03-09T03:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433905",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,61 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Testing the cygwin build using Azure pipelines / GitHub Actions.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433906.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,60 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-03-09T03:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433906",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,60 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433907.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,72 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29146: Meta-ticket: Refactor system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-03-29T04:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433907",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,72 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29146: Meta-ticket: Refactor system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433908.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,73 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29146: Meta-ticket: Refactor system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-04-17T21:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433908",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,73 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29146: Meta-ticket: Refactor system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433909.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,74 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29146: Meta-ticket: Refactor system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+- #29527: tox.ini: Add docker-opensuse\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-04-18T06:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433909",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,74 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29146: Meta-ticket: Refactor system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+- #29527: tox.ini: Add docker-opensuse
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433910.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,76 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29527: tox.ini: Add docker-opensuse\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-04-25T18:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433910",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,76 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29527: tox.ini: Add docker-opensuse
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433911.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,78 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29527: tox.ini: Add docker-opensuse\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-04-25T19:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433911",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,78 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29527: tox.ini: Add docker-opensuse
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_events_073667.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-04T20:06:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73667"
}
```



---

archive/issue_comments_433912.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,79 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29527: tox.ini: Add docker-opensuse\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-19T23:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433912",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,79 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29527: tox.ini: Add docker-opensuse
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433913.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,80 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29527: tox.ini: Add docker-opensuse\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-24T18:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433913",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,80 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29527: tox.ini: Add docker-opensuse
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433914.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,92 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30154: cygwin: CI fixes\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29527: tox.ini: Add docker-opensuse\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-07-24T20:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433914",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,92 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30154: cygwin: CI fixes
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29527: tox.ini: Add docker-opensuse
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433915.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,93 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30154: cygwin: CI fixes\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #30216 GH Actions: Test Windows with WSL\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29527: tox.ini: Add docker-opensuse\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-08-30T19:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433915",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,93 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30154: cygwin: CI fixes
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #30216 GH Actions: Test Windows with WSL
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29527: tox.ini: Add docker-opensuse
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433916.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,95 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30154: cygwin: CI fixes\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #30216 GH Actions: Test Windows with WSL\n+- #30505 tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #29527: tox.ini: Add docker-opensuse\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-09-04T15:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433916",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,95 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30154: cygwin: CI fixes
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #30216 GH Actions: Test Windows with WSL
+- #30505 tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #29527: tox.ini: Add docker-opensuse
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433917.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,97 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30505 tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30154: cygwin: CI fixes\n+- #30213 tox.ini: Add scientificlinux\n+- #30217 tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29527: tox.ini: Add docker-opensuse\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-09-04T15:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433917",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,97 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30505 tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30154: cygwin: CI fixes
+- #30213 tox.ini: Add scientificlinux
+- #30217 tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29527: tox.ini: Add docker-opensuse
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433918.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,98 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30619: update opensuse.txt across build/pkgs/\n+- #29527: tox.ini: Add docker-opensuse\n+- #30505 tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30154: cygwin: CI fixes\n+- #30213 tox.ini: Add scientificlinux\n+- #30217 tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-09-21T01:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433918",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,98 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30619: update opensuse.txt across build/pkgs/
+- #29527: tox.ini: Add docker-opensuse
+- #30505 tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30154: cygwin: CI fixes
+- #30213 tox.ini: Add scientificlinux
+- #30217 tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_events_073668.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73668"
}
```



---

archive/issue_events_073669.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73669"
}
```



---

archive/issue_comments_433919.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,99 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #29527: tox.ini: Add docker-opensuse\n+- #30505 tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30154: cygwin: CI fixes\n+- #30213 tox.ini: Add scientificlinux\n+- #30217 tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-11-16T02:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433919",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,99 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #29527: tox.ini: Add docker-opensuse
+- #30505 tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #29536 Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30154: cygwin: CI fixes
+- #30213 tox.ini: Add scientificlinux
+- #30217 tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433920.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,100 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #29527: tox.ini: Add docker-opensuse\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30154: cygwin: CI fixes\n+- #30213: tox.ini: Add scientificlinux\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** (planning stage)\n+\n+- A Dockerfile for testing that the sage binary distribution runs on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \\`ubuntu:latest\\` with the following set of installed distribution packages....\n+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)\n+- See the following for some work in this direction:\n+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)\n+   - https://github.com/mkoeppe/sage_binary_tester (outdated)\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-11-16T02:45:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433920",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,100 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #29527: tox.ini: Add docker-opensuse
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30154: cygwin: CI fixes
+- #30213: tox.ini: Add scientificlinux
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** (planning stage)
+
+- A Dockerfile for testing that the sage binary distribution runs on \`ubuntu:latest\` with the following set of installed distribution packages....
+- A Dockerfile for testing that the sage binary distribution is able to install optional packages when run on \`ubuntu:latest\` with the following set of installed distribution packages....
+- Test that a macOS binary distribution works on a set of OS versions, with and without XCode installed. (Sadly, cannot use Docker for that.)
+- See the following for some work in this direction:
+   - https://github.com/mkoeppe/sage-numerical-backends-coin (current)
+   - https://github.com/mkoeppe/sage_binary_tester (outdated)
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433921.json:
```json
{
    "body": "<a id='comment:41'></a>Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433921",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111



---

archive/issue_comments_433922.json:
```json
{
    "body": "Changing keywords from \"docker, ContinuousIntegration\" to \"docker, ContinuousIntegration, sd111\".",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433922",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "docker, ContinuousIntegration" to "docker, ContinuousIntegration, sd111".



---

archive/issue_comments_433923.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,93 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #29527: tox.ini: Add docker-opensuse\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30154: cygwin: CI fixes\n+- #30213: tox.ini: Add scientificlinux\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #29416: tox.ini: Add local-copy\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2020-12-29T20:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433923",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,93 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #29527: tox.ini: Add docker-opensuse
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30154: cygwin: CI fixes
+- #30213: tox.ini: Add scientificlinux
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #29416: tox.ini: Add local-copy
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433924.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,100 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30213: tox.ini: Add scientificlinux\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2021-03-09T18:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433924",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,100 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30213: tox.ini: Add scientificlinux
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433925.json:
```json
{
    "body": "<a id='comment:44'></a>Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433925",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_073670.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73670"
}
```



---

archive/issue_events_073671.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73671"
}
```



---

archive/issue_events_073672.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73672"
}
```



---

archive/issue_events_073673.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73673"
}
```



---

archive/issue_events_073674.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73674"
}
```



---

archive/issue_events_073675.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73675"
}
```



---

archive/issue_comments_433926.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,101 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30213: tox.ini: Add scientificlinux\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2021-12-21T16:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433926",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,101 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30213: tox.ini: Add scientificlinux
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433927.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,110 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- \n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2021-12-21T16:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433927",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,110 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- 
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433928.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,111 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- \n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows\n+- Also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-01-31T19:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433928",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,111 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- 
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows
+- Also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433929.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,110 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- \n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-02-13T19:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433929",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,110 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- 
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433930.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,118 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #33196: \\`tox.ini\\`: Add \\`centos-stream-8\\`, \\`centos-stream-9\\`, remove defunct \\`centos-6\\`\n+- #33296: tox.ini: Add \\`-recommended\\` package factor\n+- #33140: GH Actions (macOS): Fix filtering of experimental packages\n+- #31415: GH Actions workflow that builds documentation on each push\n+- #33306: \\`tox.ini\\`: Linux platform updates\n+- #32965: \\`tox\\` / GH Actions: Add \\`centos-7-devtoolset-gcc_{9,10,11}\\`\n+- #33263: Add github action running on each push\n+- #30845: GH Actions: Add test for conda without SPKG\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #32280: Manage disk space constraints in continuous integration\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-02-13T20:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433930",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,118 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #33196: \`tox.ini\`: Add \`centos-stream-8\`, \`centos-stream-9\`, remove defunct \`centos-6\`
+- #33296: tox.ini: Add \`-recommended\` package factor
+- #33140: GH Actions (macOS): Fix filtering of experimental packages
+- #31415: GH Actions workflow that builds documentation on each push
+- #33306: \`tox.ini\`: Linux platform updates
+- #32965: \`tox\` / GH Actions: Add \`centos-7-devtoolset-gcc_{9,10,11}\`
+- #33263: Add github action running on each push
+- #30845: GH Actions: Add test for conda without SPKG
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #32965: tox / GH Actions: Add fedora/centos variants using devtoolset
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #32280: Manage disk space constraints in continuous integration
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433931.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,117 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #33196: \\`tox.ini\\`: Add \\`centos-stream-8\\`, \\`centos-stream-9\\`, remove defunct \\`centos-6\\`\n+- #33296: tox.ini: Add \\`-recommended\\` package factor\n+- #33140: GH Actions (macOS): Fix filtering of experimental packages\n+- #31415: GH Actions workflow that builds documentation on each push\n+- #33306: \\`tox.ini\\`: Linux platform updates\n+- #32965: \\`tox\\` / GH Actions: Add \\`centos-7-devtoolset-gcc_{9,10,11}\\`\n+- #33263: Add github action running on each push\n+- #30845: GH Actions: Add test for conda without SPKG\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #32280: Manage disk space constraints in continuous integration\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-02-13T20:25:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433931",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,117 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #33196: \`tox.ini\`: Add \`centos-stream-8\`, \`centos-stream-9\`, remove defunct \`centos-6\`
+- #33296: tox.ini: Add \`-recommended\` package factor
+- #33140: GH Actions (macOS): Fix filtering of experimental packages
+- #31415: GH Actions workflow that builds documentation on each push
+- #33306: \`tox.ini\`: Linux platform updates
+- #32965: \`tox\` / GH Actions: Add \`centos-7-devtoolset-gcc_{9,10,11}\`
+- #33263: Add github action running on each push
+- #30845: GH Actions: Add test for conda without SPKG
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #32280: Manage disk space constraints in continuous integration
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_events_073676.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73676"
}
```



---

archive/issue_events_073677.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73677"
}
```



---

archive/issue_comments_433932.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,119 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #33196: \\`tox.ini\\`: Add \\`centos-stream-8\\`, \\`centos-stream-9\\`, remove defunct \\`centos-6\\`\n+- #33296: tox.ini: Add \\`-recommended\\` package factor\n+- #33140: GH Actions (macOS): Fix filtering of experimental packages\n+- #31415: GH Actions workflow that builds documentation on each push\n+- #33306: \\`tox.ini\\`: Linux platform updates\n+- #32965: \\`tox\\` / GH Actions: Add \\`centos-7-devtoolset-gcc_{9,10,11}\\`\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #33263: Add github action running on each push\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #34228: \\`tox -e docker-...-incremental\\`\n+- #33062: GH Actions (docker): Run a job for \"make build-local\" first, cache image for job \"make build\"\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #32280: Manage disk space constraints in continuous integration\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-09-19T16:03:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433932",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,119 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #33196: \`tox.ini\`: Add \`centos-stream-8\`, \`centos-stream-9\`, remove defunct \`centos-6\`
+- #33296: tox.ini: Add \`-recommended\` package factor
+- #33140: GH Actions (macOS): Fix filtering of experimental packages
+- #31415: GH Actions workflow that builds documentation on each push
+- #33306: \`tox.ini\`: Linux platform updates
+- #32965: \`tox\` / GH Actions: Add \`centos-7-devtoolset-gcc_{9,10,11}\`
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #33263: Add github action running on each push
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #34228: \`tox -e docker-...-incremental\`
+- #33062: GH Actions (docker): Run a job for "make build-local" first, cache image for job "make build"
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #32280: Manage disk space constraints in continuous integration
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_comments_433933.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,120 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #33196: \\`tox.ini\\`: Add \\`centos-stream-8\\`, \\`centos-stream-9\\`, remove defunct \\`centos-6\\`\n+- #33296: tox.ini: Add \\`-recommended\\` package factor\n+- #33140: GH Actions (macOS): Fix filtering of experimental packages\n+- #31415: GH Actions workflow that builds documentation on each push\n+- #33306: \\`tox.ini\\`: Linux platform updates\n+- #32965: \\`tox\\` / GH Actions: Add \\`centos-7-devtoolset-gcc_{9,10,11}\\`\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #33263: Add github action running on each push\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #34228: \\`tox -e docker-...-incremental\\`\n+- #33062: GH Actions (docker): Run a job for \"make build-local\" first, cache image for job \"make build\"\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #32280: Manage disk space constraints in continuous integration\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows\n+- #32074 Meta-ticket: Remove support for outdated distros\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-09-19T16:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433933",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,120 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #33196: \`tox.ini\`: Add \`centos-stream-8\`, \`centos-stream-9\`, remove defunct \`centos-6\`
+- #33296: tox.ini: Add \`-recommended\` package factor
+- #33140: GH Actions (macOS): Fix filtering of experimental packages
+- #31415: GH Actions workflow that builds documentation on each push
+- #33306: \`tox.ini\`: Linux platform updates
+- #32965: \`tox\` / GH Actions: Add \`centos-7-devtoolset-gcc_{9,10,11}\`
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #33263: Add github action running on each push
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #34228: \`tox -e docker-...-incremental\`
+- #33062: GH Actions (docker): Run a job for "make build-local" first, cache image for job "make build"
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #32280: Manage disk space constraints in continuous integration
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows
+- #32074 Meta-ticket: Remove support for outdated distros
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```




---

archive/issue_events_073678.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73678"
}
```



---

archive/issue_events_073679.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29060#event-73679"
}
```



---

archive/issue_comments_433934.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,120 @@\n+Testing of source and binary distributions relies too much on manual testing by people.\n \n+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.\n+\n+**Testing of source trees and source distributions:** (in progress) \n+\n+With the important changes brought by #27330 (Meta-ticket: \\`spkg-configure\\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. \n+\n+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \\`build/pkgs/SPKG/distros/\\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).\n+\n+2. We generate well-defined test environments in the form of \\`Dockerfile\\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \\`build/bin/write-dockerfile.sh\\` that generates the \\`Dockerfile\\` using the information in 1. The \\`minimal\\` configuration has just the packages that are needed for a build to succeed. The \\`standard\\` configuration installs all distribution packages that sage knows how to use.\n+\n+3. Running tests on many test environments is automated using \\`tox\\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \\`tox\\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \\`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\\`.\n+\n+4. #29087 automates running the \\`tox\\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \\`git push\\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271\n+\n+\n+Tickets:\n+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \\`spkg-configure.m4\\` scripts work as expected\n+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux\n+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)\n+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker\n+- #29129: Add more system packages to build/pkgs/SPKG/distros/\n+- #29273: add system packages info for R and others\n+- #29106: Add cygwin package information\n+- #29295: Add [GitHub](GitHub) CI workflow for cygwin\n+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions\n+- #29367: tox.ini: Add tests for python2\n+- #29415: tox.ini: Add environment local-conda\n+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes\n+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual\n+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages\n+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages\n+- #29403: ci-cygwin.yml: Multi-stage build\n+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes\n+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts\n+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2\n+- #29901: \\`.github/workflows/\\`: Test all optional packages, add workflow for testing all experimental packages\n+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc\n+- #29105: Add gentoo package information, extend dockerfile generator to gentoo\n+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7\n+- #30064: Fix tox-docker builds broken by #29884\n+- #29091: tox.ini: Add raspbian-buster\n+- #29929: tox.ini: Various CI fixes\n+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*\n+- #30044: tox.ini: Test on voidlinux\n+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini\n+- #29130: Add nix package information, extend dockerfile generator to nix\n+- #30216 GH Actions: Test Windows with WSL\n+- #30923: tox.ini: Add environments \\`local-sudo-ubuntu-standard\\`, etc.\n+- #30619: update opensuse.txt across build/pkgs/\n+- #30154: cygwin: CI fixes\n+- #28745: Add SAGE_ROOT/environment.yml for \"conda env create -f\".\n+- #30726: GH Actions: Test optional/experimental packages with Xcode 12\n+- #29527: tox.ini: Add docker-opensuse\n+- #30213: tox.ini: Add scientificlinux\n+- #29356: Meta-ticket: more system pkgs info for various linuxes\n+- #32113: GH Actions: \\`conda-forge\\` tests broken\n+- #32947: \\`tox.ini\\`, GH Actions: Update Linux platforms\n+- #33196: \\`tox.ini\\`: Add \\`centos-stream-8\\`, \\`centos-stream-9\\`, remove defunct \\`centos-6\\`\n+- #33296: tox.ini: Add \\`-recommended\\` package factor\n+- #33140: GH Actions (macOS): Fix filtering of experimental packages\n+- #31415: GH Actions workflow that builds documentation on each push\n+- #33306: \\`tox.ini\\`: Linux platform updates\n+- #32965: \\`tox\\` / GH Actions: Add \\`centos-7-devtoolset-gcc_{9,10,11}\\`\n+- #32966: tox / GH Actions: Add ubuntu variants using \\`ppa:ubuntu-toolchain-r\\`\n+- #33263: Add github action running on each push\n+- #30845: tox.ini, GH Actions: Add test for conda without SPKG\n+- #32703: GH Actions: Run a job for \\`make build-local\\` first, cache image for job \\`make build\\`\n+- #31211: \\`ci-cygwin*.yml\\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*\n+- #30933: GH Actions: Repair upload of docker images\n+- #31413: GH Actions: Add workflow with \\`configure --enable-editable\\`\n+- #34228: \\`tox -e docker-...-incremental\\`\n+- #33062: GH Actions (docker): Run a job for \"make build-local\" first, cache image for job \"make build\"\n+- #32784: Filter singular system package out of \\`tox.ini\\` for homebrew\t\n+- #31088: GH Actions: WSL workflow: No space left on device\n+- #32570: \\`tox.ini\\`, GH Actions: Update macOS environments\n+- #32531: \\`SAGE_ROOT/tox.ini\\`: Add variants that provision a system python using \\`pyenv\\`\n+- #30505: tox.ini: Add \\`wsl\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #30924: tox.ini: Add \\`cygwin\\` as a technology, to complement \\`local\\` and \\`docker\\`\n+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable\n+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes\n+- test gentoo \"prefix\" builds on top of some Linux distribution\n+- #29416: tox.ini: Add local-copy\n+- #30506: GH Actions: Use cancel-all-previous-workflow-runs\n+- #32280: Manage disk space constraints in continuous integration\n+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)\n+- #29283: tox.ini: Add test environments using LXC\n+- #29159: Add to tox.ini a toxenv docker-linuxbrew\n+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names\n+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \\`ci-sage.yml\\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)\n+\n+Related meta-tickets:\n+- #29146: Meta-ticket: Refactor/improve system package related scripts, \\`tox.ini\\`, \\`build/bin/write_dockerfile.sh\\`\n+- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows\n+- #32074 Meta-ticket: Remove support for outdated distros\n+\n+Ideas without tickets so far:\n+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.\n+- Test that packages can be cleanly uninstalled\n+\n+---\n+\n+**Testing of the sage binary distributions:** moved to #31133\n+\n+---\n+\n+**Testing of downstream packaging of sage:** (planning stage)\n+\n+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \\`sage -c SAGECOMMAND\\`, \\`sage -t\\`, \\`sage -python -c COMMAND\\`, ... work with the \\`sage\\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)\n+- #33671 Add \\`devcontainer.json\\` for development with VS Code in a Docker container\n+\n+---\n+\n+Symptoms:\n+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib\n+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy\n \n Comment: 1\n \n```\n",
    "created_at": "2022-09-20T00:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29060#issuecomment-433934",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,120 @@
+Testing of source and binary distributions relies too much on manual testing by people.
 
+We propose to set up Dockerfiles and CI scripts that document and test the expected capabilities of source and binary Sage distributions; and of downstream distribution packaging.
+
+**Testing of source trees and source distributions:** (in progress) 
+
+With the important changes brought by #27330 (Meta-ticket: \`spkg-configure\`: Try to use as many system packages as possible), sage-the-distribution has become less monolithic; it now interacts in a more complex way with distribution packaging. We propose to add infrastructure for testing correct installation of sage source distributions on a variety of platforms. 
+
+1. We collect information about distribution packages systematically and store it in on a per-SPKG basis in  \`build/pkgs/SPKG/distros/\`. (Right now this information is scattered - in downstream sage distribution packagers' build scripts, trac tickets, replies to bug reports in google groups, the sage installation manual, personal knowledge...) This is part of #29053, for debian/fedora/arch/conda (with follow-up tickets #29105, #29106 for other platforms).
+
+2. We generate well-defined test environments in the form of \`Dockerfile\`s. This makes it possible to test, on one's development computer, the correct installation of sage-the-distribution on a variety of platforms and configurations. #29053 provides \`build/bin/write-dockerfile.sh\` that generates the \`Dockerfile\` using the information in 1. The \`minimal\` configuration has just the packages that are needed for a build to succeed. The \`standard\` configuration installs all distribution packages that sage knows how to use.
+
+3. Running tests on many test environments is automated using \`tox\` in #29053. The top-level [tox.ini](https://git.sagemath.org/sage.git/tree/tox.ini?id=23c6334cf2927a4d917a27b3963471e8242d86a3) file defines the test environments. Using \`tox\`'s factor conditions (https://tox.readthedocs.io/en/latest/config.html#complex-factor-conditions), there is a succinct description of many test environments. For example, we can run \`tox -e docker-debian-stretch-minimal,docker-arch-latest-standard\`.
+
+4. #29087 automates running the \`tox\` tests for a selection of 34 platforms/configurations using a [GitHub](GitHub) Actions workflow on every \`git push\` to a [GitHub](GitHub) repository. An example run: https://github.com/mkoeppe/sage/actions/runs/32812271
+
+
+Tickets:
+- #29053: Add debian/fedora/arch/conda package information to build/pkgs, generate Dockerfiles and installation help; add tox.ini --- this helps test that all \`spkg-configure.m4\` scripts work as expected
+- #29066: Add Dockerfile that sets up sage prerequisites on Arch Linux
+- #29104: Add to tox.ini some homebrew toxenvs (with a fresh install not in /usr/local)
+- #29143: Add to tox.ini 32-bit linux environments and other architectures supported by docker
+- #29129: Add more system packages to build/pkgs/SPKG/distros/
+- #29273: add system packages info for R and others
+- #29106: Add cygwin package information
+- #29295: Add [GitHub](GitHub) CI workflow for cygwin
+- #29087: Add [GitHub](GitHub) Actions workflow for testing spkg-configure / build on various Linux distributions
+- #29367: tox.ini: Add tests for python2
+- #29415: tox.ini: Add environment local-conda
+- #29417: tox.ini, [GitHub](GitHub) CI workflow - minor fixes
+- #29401: Add documentation of tox and [GitHub](GitHub) actions workflow to developer's manual
+- #29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages
+- #29341: [GitHub](GitHub) CI workflow: Add testing of optional packages
+- #29403: ci-cygwin.yml: Multi-stage build
+- #29530: Make Docker images generated by [GitHub](GitHub) CI workflows available; minor CI fixes
+- #29669: For Sage 9.2: Remove Python 2 support from the build system and CI scripts
+- #29757: .github/workflows/tox-gcc_spkg.yml: Remove python2
+- #29901: \`.github/workflows/\`: Test all optional packages, add workflow for testing all experimental packages
+- #29815: .github/workflows/tox-gcc_spkg.yml: Disable tests on some platforms that fail --without-system-gcc
+- #29105: Add gentoo package information, extend dockerfile generator to gentoo
+- #29851: tox.ini: debian-bullseye, -sid have Python3.8 instead of 3.7
+- #30064: Fix tox-docker builds broken by #29884
+- #29091: tox.ini: Add raspbian-buster
+- #29929: tox.ini: Various CI fixes
+- #30195: tox.ini: Add centos-6, docker-nobootstrap, manylinux-*
+- #30044: tox.ini: Test on voidlinux
+- #30144: tox.ini / tox.yml: Move code for tagging/pushing docker images into tox.ini
+- #29130: Add nix package information, extend dockerfile generator to nix
+- #30216 GH Actions: Test Windows with WSL
+- #30923: tox.ini: Add environments \`local-sudo-ubuntu-standard\`, etc.
+- #30619: update opensuse.txt across build/pkgs/
+- #30154: cygwin: CI fixes
+- #28745: Add SAGE_ROOT/environment.yml for "conda env create -f".
+- #30726: GH Actions: Test optional/experimental packages with Xcode 12
+- #29527: tox.ini: Add docker-opensuse
+- #30213: tox.ini: Add scientificlinux
+- #29356: Meta-ticket: more system pkgs info for various linuxes
+- #32113: GH Actions: \`conda-forge\` tests broken
+- #32947: \`tox.ini\`, GH Actions: Update Linux platforms
+- #33196: \`tox.ini\`: Add \`centos-stream-8\`, \`centos-stream-9\`, remove defunct \`centos-6\`
+- #33296: tox.ini: Add \`-recommended\` package factor
+- #33140: GH Actions (macOS): Fix filtering of experimental packages
+- #31415: GH Actions workflow that builds documentation on each push
+- #33306: \`tox.ini\`: Linux platform updates
+- #32965: \`tox\` / GH Actions: Add \`centos-7-devtoolset-gcc_{9,10,11}\`
+- #32966: tox / GH Actions: Add ubuntu variants using \`ppa:ubuntu-toolchain-r\`
+- #33263: Add github action running on each push
+- #30845: tox.ini, GH Actions: Add test for conda without SPKG
+- #32703: GH Actions: Run a job for \`make build-local\` first, cache image for job \`make build\`
+- #31211: \`ci-cygwin*.yml\`: Fix packaging up of SAGE_LOCAL/var/tmp/sage/build/*
+- #30933: GH Actions: Repair upload of docker images
+- #31413: GH Actions: Add workflow with \`configure --enable-editable\`
+- #34228: \`tox -e docker-...-incremental\`
+- #33062: GH Actions (docker): Run a job for "make build-local" first, cache image for job "make build"
+- #32784: Filter singular system package out of \`tox.ini\` for homebrew	
+- #31088: GH Actions: WSL workflow: No space left on device
+- #32570: \`tox.ini\`, GH Actions: Update macOS environments
+- #32531: \`SAGE_ROOT/tox.ini\`: Add variants that provision a system python using \`pyenv\`
+- #30505: tox.ini: Add \`wsl\` as a technology, to complement \`local\` and \`docker\`
+- #30924: tox.ini: Add \`cygwin\` as a technology, to complement \`local\` and \`docker\`
+- #29536: Make docker images from [GitHub](GitHub) CI workflow and regular Sage Docker images interoperable
+- #30217: tox.ini: Add tests with Ubuntu + deadsnakes
+- test gentoo "prefix" builds on top of some Linux distribution
+- #29416: tox.ini: Add local-copy
+- #30506: GH Actions: Use cancel-all-previous-workflow-runs
+- #32280: Manage disk space constraints in continuous integration
+- #21469: Enable VPATH builds (several independent build trees connected to one source tree)
+- #29283: tox.ini: Add test environments using LXC
+- #29159: Add to tox.ini a toxenv docker-linuxbrew
+- #29535: Customize CI workflows on [GitHub](GitHub) Actions using specially structured tag names
+- #33338 Refactor GH Actions workflows using https://docs.github.com/en/actions/learn-github-actions/reusing-workflows, also use reusable workflows for the upstream deployments of \`ci-sage.yml\` (suggested in https://github.com/pypa/setuptools/pull/2923#discussion_r795977169)
+
+Related meta-tickets:
+- #29146: Meta-ticket: Refactor/improve system package related scripts, \`tox.ini\`, \`build/bin/write_dockerfile.sh\`
+- #33338 Meta-ticket: CI workflows for upstream projects using Sage reusable workflows
+- #32074 Meta-ticket: Remove support for outdated distros
+
+Ideas without tickets so far:
+- Testing that it is possible to build without error when upgrading with git from some list of previous releases.
+- Test that packages can be cleanly uninstalled
+
+---
+
+**Testing of the sage binary distributions:** moved to #31133
+
+---
+
+**Testing of downstream packaging of sage:** (planning stage)
+
+- #29111: Specify a subset of sage command line options that are supported by sagelib - rather than sage-the-distribution. Test that \`sage -c SAGECOMMAND\`, \`sage -t\`, \`sage -python -c COMMAND\`, ... work with the \`sage\` script provided by the distribution (see https://groups.google.com/d/msg/sage-packaging/BmkxIBdwbvE/fRMl2sjdBQAJ)
+- #33671 Add \`devcontainer.json\` for development with VS Code in a Docker container
+
+---
+
+Symptoms:
+- #29055: Installing any optional package on the binary distribution triggers full recompile of sagelib
+- #29051: Paths configured in installed numpy site.cfg [DEFAULT/ALL] do not affect scipy
 
 Comment: 1
 
```

