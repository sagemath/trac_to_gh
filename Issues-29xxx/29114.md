# Issue 29114: Only ./bootstrap should glob build/pkgs

archive/issues_028877.json:
```json
{
    "body": "Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.\n\nIn this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.\n\nBefore:\n\n```\n$ time ./configure -q --without-system-ntl\nreal\t0m40.860s\nuser\t0m24.260s\nsys\t0m16.266s\n```\n\nAfter:\n\n```\nreal\t0m32.485s\nuser\t0m20.773s\nsys\t0m10.462s\n```\n\nThere are no changes in functionality.\n\nWe make a cosmetic fix to the `./configure --help` output, fixing #33345#comment:20. \n\nEven after this ticket, `package-version.txt` and `dependencies` are processed at `configure` run time, not at `bootstrap` time. So simple package upgrades can still be done by developers without having to run `./bootstrap`.\n\n\nCC:  @dimpase @embray @orlitzky @jhpalmieri\n\nBranch/Commit: e7b8c3b398eba7721df7c79d8d4f77ca454838e8\n\nReviewer: Michael Orlitzky\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29114\n\n",
    "closed_at": "2022-03-01T21:31:38Z",
    "created_at": "2020-01-30T20:33:01Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Only ./bootstrap should glob build/pkgs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29114",
    "user": "https://github.com/mkoeppe"
}
```
Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.

In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.

Before:

```
$ time ./configure -q --without-system-ntl
real	0m40.860s
user	0m24.260s
sys	0m16.266s
```

After:

```
real	0m32.485s
user	0m20.773s
sys	0m10.462s
```

There are no changes in functionality.

We make a cosmetic fix to the `./configure --help` output, fixing #33345#comment:20. 

Even after this ticket, `package-version.txt` and `dependencies` are processed at `configure` run time, not at `bootstrap` time. So simple package upgrades can still be done by developers without having to run `./bootstrap`.


CC:  @dimpase @embray @orlitzky @jhpalmieri

Branch/Commit: e7b8c3b398eba7721df7c79d8d4f77ca454838e8

Reviewer: Michael Orlitzky

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29114





---

archive/issue_comments_435220.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,9 @@\n Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) glob.\n-This should be streamlined.\n+This should be streamlined. \n+\n+Currently `./configure` is too sensitive to stray files/subdirectories in `build/pkgs` (such as those that are `.gitignore`'d in another branch), as noted in https://groups.google.com/d/msg/sage-release/eVvjvJ6Iii8/W51ouUKpDwAJ (thread).\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-01-30T23:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435220",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,9 @@
 Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) glob.
-This should be streamlined.
+This should be streamlined. 
+
+Currently `./configure` is too sensitive to stray files/subdirectories in `build/pkgs` (such as those that are `.gitignore`'d in another branch), as noted in https://groups.google.com/d/msg/sage-release/eVvjvJ6Iii8/W51ouUKpDwAJ (thread).
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_435221.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2020-01-31T00:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435221",
    "user": "https://github.com/vbraun"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_435222.json:
```json
{
    "body": "<a id='comment:6'></a>Branch is on top of #28095.\n\n---\nNew commits:",
    "created_at": "2020-01-31T01:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435222",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>Branch is on top of #28095.

---
New commits:



---

archive/issue_comments_435223.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-31T01:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435223",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_435224.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-01-31T01:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_435225.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-31T02:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435225",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435226.json:
```json
{
    "body": "<a id='comment:9'></a>Could you explain what \"glob\" means here?",
    "created_at": "2020-01-31T09:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435226",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>Could you explain what "glob" means here?



---

archive/issue_comments_435227.json:
```json
{
    "body": "<a id='comment:10'></a>This reminds me of #27373 - which becomes obsolete as soon as this ticket and #29113 is done.",
    "created_at": "2020-01-31T09:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435227",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>This reminds me of #27373 - which becomes obsolete as soon as this ticket and #29113 is done.



---

archive/issue_comments_435228.json:
```json
{
    "body": "<a id='comment:11'></a>It seems this is adding a bunch of previously unnecessary complication only because #29038, which I strongly objected to, was merged.  I didn't step in then because I was busy with other things.  Can we please roll back #29038 instead?  I'm absolute convinced there's no need for it.",
    "created_at": "2020-01-31T11:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435228",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>It seems this is adding a bunch of previously unnecessary complication only because #29038, which I strongly objected to, was merged.  I didn't step in then because I was busy with other things.  Can we please roll back #29038 instead?  I'm absolute convinced there's no need for it.



---

archive/issue_comments_435229.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2020-01-31T11:26:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435229",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_435230.json:
```json
{
    "body": "<a id='comment:13'></a>See #29118 for an alternative proposal.",
    "created_at": "2020-01-31T11:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435230",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>See #29118 for an alternative proposal.



---

archive/issue_comments_435231.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-01-31T11:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435231",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_435232.json:
```json
{
    "body": "<a id='comment:14'></a>I think we should progress, even if the route is not optimal, and Matthias has a lot of time for working on the build system now. \n\nI hate to see ./configure running many times as I launch make, it really slows working on build system down, and I hope #29113 will happen soon.",
    "created_at": "2020-01-31T11:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435232",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>I think we should progress, even if the route is not optimal, and Matthias has a lot of time for working on the build system now. 

I hate to see ./configure running many times as I launch make, it really slows working on build system down, and I hope #29113 will happen soon.



---

archive/issue_comments_435233.json:
```json
{
    "body": "<a id='comment:15'></a>I should add, some of the changes in this ticket look reasonable.  But it's mixed up with a bunch of other stuff (the way this is built on top of #28095 in particular is confusing).  I'd like to start with #29118 and then see some fixes to individual bugs that predate #29038 .",
    "created_at": "2020-01-31T11:56:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435233",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>I should add, some of the changes in this ticket look reasonable.  But it's mixed up with a bunch of other stuff (the way this is built on top of #28095 in particular is confusing).  I'd like to start with #29118 and then see some fixes to individual bugs that predate #29038 .



---

archive/issue_comments_435234.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:14 dimpase]:\n> I think we should progress, even if the route is not optimal, and Matthias has a lot of time for working on the build system now. \n\n\nProgress on what though?  I don't think you can \"progress\" on unsolid footing.  I should note that part of the motivation behind #29038 is to enable the approach in #27824 which I also think is overcomplicated.\n\nI don't think we should be making complicated changes on top of complicated changes to enable even more complicated changes.  I hate to sound like Jeroen here because I've been on the other side of disagreements like this with him.  But he'd probably be saying the same if he were here and I'd agree this time.\n\nI would like to know what the bigger picture is to all this before making changes that don't seem well-motivated.  Don't commit a sunk cost fallacy especially when it's relatively early...",
    "created_at": "2020-01-31T11:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435234",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>Replying to [comment:14 dimpase]:
> I think we should progress, even if the route is not optimal, and Matthias has a lot of time for working on the build system now. 


Progress on what though?  I don't think you can "progress" on unsolid footing.  I should note that part of the motivation behind #29038 is to enable the approach in #27824 which I also think is overcomplicated.

I don't think we should be making complicated changes on top of complicated changes to enable even more complicated changes.  I hate to sound like Jeroen here because I've been on the other side of disagreements like this with him.  But he'd probably be saying the same if he were here and I'd agree this time.

I would like to know what the bigger picture is to all this before making changes that don't seem well-motivated.  Don't commit a sunk cost fallacy especially when it's relatively early...



---

archive/issue_comments_435235.json:
```json
{
    "body": "<a id='comment:17'></a>If you want to talk about simplification, why don't we just drop `sage -i/-f` instead of trying to keep this awful hack - something I proposed a year ago, and Jeroen objected...",
    "created_at": "2020-01-31T12:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435235",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>If you want to talk about simplification, why don't we just drop `sage -i/-f` instead of trying to keep this awful hack - something I proposed a year ago, and Jeroen objected...



---

archive/issue_comments_435236.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) glob.\n+This should be streamlined. \n+\n+Currently `./configure` is too sensitive to stray files/subdirectories in `build/pkgs` (such as those that are `.gitignore`'d in another branch), as noted in https://groups.google.com/d/msg/sage-release/eVvjvJ6Iii8/W51ouUKpDwAJ (thread). \n+While #29120 provides a quick workaround, the present ticket has the proper fix.\n+\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-01-31T14:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435236",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) glob.
+This should be streamlined. 
+
+Currently `./configure` is too sensitive to stray files/subdirectories in `build/pkgs` (such as those that are `.gitignore`'d in another branch), as noted in https://groups.google.com/d/msg/sage-release/eVvjvJ6Iii8/W51ouUKpDwAJ (thread). 
+While #29120 provides a quick workaround, the present ticket has the proper fix.
+
+
 
 
 Comment: 1
``````




---

archive/issue_comments_435237.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.\n+This should be streamlined. \n+\n+Currently `./configure` is too sensitive to stray files/subdirectories in `build/pkgs` (such as those that are `.gitignore`'d in another branch), as noted in https://groups.google.com/d/msg/sage-release/eVvjvJ6Iii8/W51ouUKpDwAJ (thread). \n+While #29120 provides a quick workaround, the present ticket has the proper fix.\n+\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-01-31T14:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435237",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.
+This should be streamlined. 
+
+Currently `./configure` is too sensitive to stray files/subdirectories in `build/pkgs` (such as those that are `.gitignore`'d in another branch), as noted in https://groups.google.com/d/msg/sage-release/eVvjvJ6Iii8/W51ouUKpDwAJ (thread). 
+While #29120 provides a quick workaround, the present ticket has the proper fix.
+
+
 
 
 Comment: 1
``````




---

archive/issue_comments_435238.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-01-31T14:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_435239.json:
```json
{
    "body": "<a id='comment:21'></a>I've rebased on top of #29120, which has the \"hot fix\", which may be easier to review and should go into the next beta.\n\nThe present ticket, #29114, is not so urgent.",
    "created_at": "2020-01-31T14:45:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435239",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>I've rebased on top of #29120, which has the "hot fix", which may be easier to review and should go into the next beta.

The present ticket, #29114, is not so urgent.



---

archive/issue_comments_435240.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-03-16T01:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435240",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_435241.json:
```json
{
    "body": "<a id='comment:25'></a>Since this list changes maybe once a year, we could just write it into configure.ac and avoid that part of the bootstrap process.",
    "created_at": "2020-03-16T15:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435241",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:25'></a>Since this list changes maybe once a year, we could just write it into configure.ac and avoid that part of the bootstrap process.



---

archive/issue_comments_435242.json:
```json
{
    "body": "<a id='comment:26'></a>I think that may be too radical a change (although I am personally in favor of it - agreeing with the autotools policies) - Sage has traditionally used source discovery instead of listing files explicitly.  That's why in this ticket I just want to put the source discovery for build/pkgs into 1 script",
    "created_at": "2020-03-16T15:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435242",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>I think that may be too radical a change (although I am personally in favor of it - agreeing with the autotools policies) - Sage has traditionally used source discovery instead of listing files explicitly.  That's why in this ticket I just want to put the source discovery for build/pkgs into 1 script



---

archive/issue_events_073840.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:04:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73840"
}
```



---

archive/issue_events_073841.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73841"
}
```



---

archive/issue_events_073842.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73842"
}
```



---

archive/issue_events_073843.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73843"
}
```



---

archive/issue_events_073844.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73844"
}
```



---

archive/issue_comments_435243.json:
```json
{
    "body": "<a id='comment:29'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435243",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_073845.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-12T03:41:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73845"
}
```



---

archive/issue_events_073846.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-12T03:41:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73846"
}
```



---

archive/issue_comments_435244.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-02-17T21:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_073847.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-17T21:40:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73847"
}
```



---

archive/issue_events_073848.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-17T21:40:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73848"
}
```



---

archive/issue_comments_435245.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.\n+This should be streamlined. \n \n \n Comment: 1\n``````\n",
    "created_at": "2022-02-17T21:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435245",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.
+This should be streamlined. 
 
 
 Comment: 1
``````




---

archive/issue_comments_435246.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-17T22:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435247.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-02-17T22:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_435248.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-17T23:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435248",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435249.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-17T23:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435249",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435250.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-18T00:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435251.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-18T01:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435252.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-18T02:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435253.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-02-18T02:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435253",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_435254.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,25 @@\n+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.\n+\n+In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.\n+\n+Before:\n+\n+```\n+$ time ./configure -q --without-system-ntl\n+real\t0m40.860s\n+user\t0m24.260s\n+sys\t0m16.266s\n+```\n+\n+After:\n+\n+```\n+real\t0m32.485s\n+user\t0m20.773s\n+sys\t0m10.462s\n+```\n+\n+There are no changes in functionality.\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-02-18T02:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435254",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,25 @@
+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.
+
+In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.
+
+Before:
+
+```
+$ time ./configure -q --without-system-ntl
+real	0m40.860s
+user	0m24.260s
+sys	0m16.266s
+```
+
+After:
+
+```
+real	0m32.485s
+user	0m20.773s
+sys	0m10.462s
+```
+
+There are no changes in functionality.
 
 
 Comment: 1
``````




---

archive/issue_comments_435255.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-18T02:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435256.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-18T04:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435257.json:
```json
{
    "body": "<a id='comment:45'></a>`./configure -q` is a useful command. I see this output:\n\n```\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nImportError: No module named lzma\n./configure: line 39392: ,: command not found\n```\nThe first is probably coming from the line `if \"$SAGE_BOOTSTRAP_PYTHON\" -c \"import lzma\"; then :`, no big deal. The other error is from a comma all by itself on line 39392 (that's with `develop`; it's line 42361 with this branch). Maybe an extra comma in `build/pkgs/qhull/spkg-configure.m4`?",
    "created_at": "2022-02-18T06:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435257",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:45'></a>`./configure -q` is a useful command. I see this output:

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named lzma
./configure: line 39392: ,: command not found
```
The first is probably coming from the line `if "$SAGE_BOOTSTRAP_PYTHON" -c "import lzma"; then :`, no big deal. The other error is from a comma all by itself on line 39392 (that's with `develop`; it's line 42361 with this branch). Maybe an extra comma in `build/pkgs/qhull/spkg-configure.m4`?



---

archive/issue_comments_435258.json:
```json
{
    "body": "<a id='comment:46'></a>This is unrelated to the ticket and fixed in #33247",
    "created_at": "2022-02-18T06:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435258",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>This is unrelated to the ticket and fixed in #33247



---

archive/issue_comments_435259.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,27 @@\n+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.\n+\n+In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.\n+\n+Before:\n+\n+```\n+$ time ./configure -q --without-system-ntl\n+real\t0m40.860s\n+user\t0m24.260s\n+sys\t0m16.266s\n+```\n+\n+After:\n+\n+```\n+real\t0m32.485s\n+user\t0m20.773s\n+sys\t0m10.462s\n+```\n+\n+There are no changes in functionality.\n+\n+Even after this ticket, `package-version.txt` and `dependencies` are processed at `configure` run time, not at `bootstrap` time. So simple package upgrades can still be done by developers without having to run `./bootstrap`.\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-02-20T02:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435259",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,27 @@
+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.
+
+In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.
+
+Before:
+
+```
+$ time ./configure -q --without-system-ntl
+real	0m40.860s
+user	0m24.260s
+sys	0m16.266s
+```
+
+After:
+
+```
+real	0m32.485s
+user	0m20.773s
+sys	0m10.462s
+```
+
+There are no changes in functionality.
+
+Even after this ticket, `package-version.txt` and `dependencies` are processed at `configure` run time, not at `bootstrap` time. So simple package upgrades can still be done by developers without having to run `./bootstrap`.
 
 
 Comment: 1
``````




---

archive/issue_comments_435260.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.\n+\n+In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.\n+\n+Before:\n+\n+```\n+$ time ./configure -q --without-system-ntl\n+real\t0m40.860s\n+user\t0m24.260s\n+sys\t0m16.266s\n+```\n+\n+After:\n+\n+```\n+real\t0m32.485s\n+user\t0m20.773s\n+sys\t0m10.462s\n+```\n+\n+There are no changes in functionality.\n+\n+We make a cosmetic fix to the `./configure --help` output, fixing #33345#comment:20. \n+\n+Even after this ticket, `package-version.txt` and `dependencies` are processed at `configure` run time, not at `bootstrap` time. So simple package upgrades can still be done by developers without having to run `./bootstrap`.\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-02-20T02:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435260",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,29 @@
+Right now both `./bootstrap` and `./configure` (via `m4/sage_spkg_collect.m4`) [glob](https://en.wikipedia.org/wiki/Glob_(programming)) `build/pkgs`.
+
+In this ticket, we move this code into `bootstrap`, making the generated `configure` script more static, more straightforward to read and debug, and slightly faster because less work (and file system accesses) is done at the run time of `configure`.
+
+Before:
+
+```
+$ time ./configure -q --without-system-ntl
+real	0m40.860s
+user	0m24.260s
+sys	0m16.266s
+```
+
+After:
+
+```
+real	0m32.485s
+user	0m20.773s
+sys	0m10.462s
+```
+
+There are no changes in functionality.
+
+We make a cosmetic fix to the `./configure --help` output, fixing #33345#comment:20. 
+
+Even after this ticket, `package-version.txt` and `dependencies` are processed at `configure` run time, not at `bootstrap` time. So simple package upgrades can still be done by developers without having to run `./bootstrap`.
 
 
 Comment: 1
``````




---

archive/issue_comments_435261.json:
```json
{
    "body": "<a id='comment:49'></a>In principle this looks good to me, and Sage builds. It would be great if someone more familiar with `.m4` code could check the details.",
    "created_at": "2022-02-24T23:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435261",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:49'></a>In principle this looks good to me, and Sage builds. It would be great if someone more familiar with `.m4` code could check the details.



---

archive/issue_comments_435262.json:
```json
{
    "body": "<a id='comment:50'></a>I looked through it all and don't see anything too scary. My one question is about the `grep -v ^=` that was added to bootstrap. It looks like that only affects the sagemath_categories, sagemath_objects, and sage_docbuild packages. Why do those have `======...` headers in their SPKG.rst to begin with?",
    "created_at": "2022-02-28T16:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435262",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:50'></a>I looked through it all and don't see anything too scary. My one question is about the `grep -v ^=` that was added to bootstrap. It looks like that only affects the sagemath_categories, sagemath_objects, and sage_docbuild packages. Why do those have `======...` headers in their SPKG.rst to begin with?



---

archive/issue_comments_435263.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:50 mjo]:\n> It looks like that only affects the sagemath_categories, sagemath_objects, and sage_docbuild packages. Why do those have `======...` headers in their SPKG.rst to begin with?\n\n\nThese files double as README.rst for these distributions, so this affects how it displays on PyPI.",
    "created_at": "2022-02-28T18:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435263",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'></a>Replying to [comment:50 mjo]:
> It looks like that only affects the sagemath_categories, sagemath_objects, and sage_docbuild packages. Why do those have `======...` headers in their SPKG.rst to begin with?


These files double as README.rst for these distributions, so this affects how it displays on PyPI.



---

archive/issue_comments_435264.json:
```json
{
    "body": "<a id='comment:52'></a>Ok, I don't believe in parsing `SPKG.rst` for package information anyway, so I don't mind the hack. (In the futue, I would rather we quit parsing that file than try to make them all nice and consistent.)\n\nEverything else looks reasonable. Nothing broke in my sage build and there aren't any new subtle `./configure` errors logged to the console.\n\nJohn, don't forget to add yourself as a reviewer if you want to.",
    "created_at": "2022-02-28T18:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435264",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:52'></a>Ok, I don't believe in parsing `SPKG.rst` for package information anyway, so I don't mind the hack. (In the futue, I would rather we quit parsing that file than try to make them all nice and consistent.)

Everything else looks reasonable. Nothing broke in my sage build and there aren't any new subtle `./configure` errors logged to the console.

John, don't forget to add yourself as a reviewer if you want to.



---

archive/issue_comments_435265.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-28T18:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435265",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_435266.json:
```json
{
    "body": "<a id='comment:53'></a>Thanks.",
    "created_at": "2022-02-28T18:54:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435266",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'></a>Thanks.



---

archive/issue_comments_435267.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-03-01T21:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29114#issuecomment-435267",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_073849.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-03-01T21:31:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29114",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29114#event-73849"
}
```
