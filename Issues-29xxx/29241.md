# Issue 29241: gfortran installation on 32bit userland, 64bit kernel: Configure for the same ABI as gcc

archive/issues_029004.json:
```json
{
    "assignees": [],
    "body": "The `i386-minimal` targets have build errors compiling `gfortran` (see for example https://github.com/mkoeppe/sage/runs/463683795) because of ABI mismatch. These tests are running 32-bit distributions on a 64-bit kernel. `gfortran` tries to build native (64-bit) but that fails because the corresponding architecture files are missing.\n\n\n\nCC:  @dimpase tmonteil @vbraun @jhpalmieri @orlitzky\n\nBranch/Commit: **[c85c26f](https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18)**\n\nReviewer: **Michael Orlitzky**\n\nAuthor: **Matthias Koeppe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29241_\n\n",
    "closed_at": "2020-03-18T22:40:44Z",
    "created_at": "2020-02-24T08:00:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20porting",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "gfortran installation on 32bit userland, 64bit kernel: Configure for the same ABI as gcc",
    "type": "issue",
    "updated_at": "2020-03-18T22:40:44Z",
    "url": "https://github.com/sagemath/sage/issues/29241",
    "user": "https://github.com/mkoeppe"
}
```
The `i386-minimal` targets have build errors compiling `gfortran` (see for example https://github.com/mkoeppe/sage/runs/463683795) because of ABI mismatch. These tests are running 32-bit distributions on a 64-bit kernel. `gfortran` tries to build native (64-bit) but that fails because the corresponding architecture files are missing.



CC:  @dimpase tmonteil @vbraun @jhpalmieri @orlitzky

Branch/Commit: **[c85c26f](https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18)**

Reviewer: **Michael Orlitzky**

Author: **Matthias Koeppe**

_Issue created by migration from https://trac.sagemath.org/ticket/29241_





---

archive/issue_events_370455.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-24T08:00:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370455"
}
```



---

archive/issue_events_370456.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-24T08:00:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20porting",
    "label_color": "000080",
    "label_name": "component: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370456"
}
```



---

archive/issue_events_370457.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-24T08:00:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370457"
}
```



---

archive/issue_events_370458.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-24T08:00:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370458"
}
```



---

archive/issue_comments_461529.json:
```json
{
    "body": "Branch: **[u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc)**",
    "created_at": "2020-03-03T03:18:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461529",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc)**



---

archive/issue_events_370459.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-03T03:27:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370459"
}
```



---

archive/issue_comments_461530.json:
```json
{
    "body": "Commit: **[3972311](https://github.com/sagemath/sagetrac-mirror/commit/3972311748757b4795754b4f7d831ed2fccdfa1a)**",
    "created_at": "2020-03-03T03:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461530",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[3972311](https://github.com/sagemath/sagetrac-mirror/commit/3972311748757b4795754b4f7d831ed2fccdfa1a)**



---

archive/issue_comments_461531.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nTested on `docker-debian-buster-i386-minimal`, where the gfortran build now succeeds.\nNeeds review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/749f83e1a74b3b0628bc372c413199103f8188c7\">749f83e</a></td><td><code>tox.ini: Add other archs supported by docker</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e941bd55340543b822ab2088b0ca52f49dab5c40\">e941bd5</a></td><td><code>fixup for llocal</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2441fe9c1443fbdcc9bfc50cca7f7a113ae2e545\">2441fe9</a></td><td><code>tox.ini: Restructure docker image:tag construction, add multiarch for Linux Docker</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f057cb8652617283ef27737b8e6b3e970d8d7c3\">2f057cb</a></td><td><code>tox.ini: Add raspbian</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f122bdda3253eeb23cef16c495491890f712959\">7f122bd</a></td><td><code>build/bin/write-dockerfile.sh: src/ext has moved and is no longer needed for the configure phase</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3972311748757b4795754b4f7d831ed2fccdfa1a\">3972311</a></td><td><code>gfortran on 32bit: Configure for the same ABI as gcc</code></td></tr></table>\n",
    "created_at": "2020-03-03T03:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461531",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'>Comment 2:</a>
Tested on `docker-debian-buster-i386-minimal`, where the gfortran build now succeeds.
Needs review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/749f83e1a74b3b0628bc372c413199103f8188c7">749f83e</a></td><td><code>tox.ini: Add other archs supported by docker</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e941bd55340543b822ab2088b0ca52f49dab5c40">e941bd5</a></td><td><code>fixup for llocal</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2441fe9c1443fbdcc9bfc50cca7f7a113ae2e545">2441fe9</a></td><td><code>tox.ini: Restructure docker image:tag construction, add multiarch for Linux Docker</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f057cb8652617283ef27737b8e6b3e970d8d7c3">2f057cb</a></td><td><code>tox.ini: Add raspbian</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f122bdda3253eeb23cef16c495491890f712959">7f122bd</a></td><td><code>build/bin/write-dockerfile.sh: src/ext has moved and is no longer needed for the configure phase</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3972311748757b4795754b4f7d831ed2fccdfa1a">3972311</a></td><td><code>gfortran on 32bit: Configure for the same ABI as gcc</code></td></tr></table>




---

archive/issue_comments_461532.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-03-03T03:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461532",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_370460.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-03T22:52:15Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "title_is": "gfortran installation on 32bit userland, 64bit kernel: Configure for the same ABI as gcc",
    "title_was": "gfortran on 32bit: Configure for the same ABI as gcc",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370460"
}
```



---

archive/issue_comments_461533.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nAnyone interested in reviewing this?",
    "created_at": "2020-03-08T20:37:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461533",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'>Comment 4:</a>
Anyone interested in reviewing this?



---

archive/issue_comments_461534.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nI don't know how to set up an environment where this change matters.",
    "created_at": "2020-03-08T20:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461534",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'>Comment 5:</a>
I don't know how to set up an environment where this change matters.



---

archive/issue_comments_461535.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ae21c3f35718808ddbba90431097d18e3f95e7b\">7ae21c3</a></td><td><code>Merge tag '9.1.beta7' into t/29241/gfortran_on_32bit__configure_for_the_same_abi_as_gcc</code></td></tr></table>\n",
    "created_at": "2020-03-08T22:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461535",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ae21c3f35718808ddbba90431097d18e3f95e7b">7ae21c3</a></td><td><code>Merge tag '9.1.beta7' into t/29241/gfortran_on_32bit__configure_for_the_same_abi_as_gcc</code></td></tr></table>




---

archive/issue_comments_461536.json:
```json
{
    "body": "Changed commit from **[3972311](https://github.com/sagemath/sagetrac-mirror/commit/3972311748757b4795754b4f7d831ed2fccdfa1a)** to **[7ae21c3](https://github.com/sagemath/sagetrac-mirror/commit/7ae21c3f35718808ddbba90431097d18e3f95e7b)**",
    "created_at": "2020-03-08T22:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461536",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3972311](https://github.com/sagemath/sagetrac-mirror/commit/3972311748757b4795754b4f7d831ed2fccdfa1a)** to **[7ae21c3](https://github.com/sagemath/sagetrac-mirror/commit/7ae21c3f35718808ddbba90431097d18e3f95e7b)**



---

archive/issue_comments_461537.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nWill the gfortran `spkg-install` file ever be run on OS X?\n\n```\n$ gcc -print-multiarch\nclang: error: unknown argument: '-print-multiarch'\nclang: error: no input files\n```",
    "created_at": "2020-03-09T01:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461537",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'>Comment 7:</a>
Will the gfortran `spkg-install` file ever be run on OS X?

```
$ gcc -print-multiarch
clang: error: unknown argument: '-print-multiarch'
clang: error: no input files
```



---

archive/issue_comments_461538.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nThe equivalent option with clang is `gcc -print-target-triple`",
    "created_at": "2020-03-09T01:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461538",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'>Comment 8:</a>
The equivalent option with clang is `gcc -print-target-triple`



---

archive/issue_events_370461.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-09T01:31:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370461"
}
```



---

archive/issue_events_370462.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-09T01:31:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370462"
}
```



---

archive/issue_comments_461539.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nWell, on OS X building for i386 no longer works. But I'll add clang support just in case for FreeBSD.",
    "created_at": "2020-03-09T03:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461539",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'>Comment 10:</a>
Well, on OS X building for i386 no longer works. But I'll add clang support just in case for FreeBSD.



---

archive/issue_comments_461540.json:
```json
{
    "body": "Changed commit from **[7ae21c3](https://github.com/sagemath/sagetrac-mirror/commit/7ae21c3f35718808ddbba90431097d18e3f95e7b)** to **[35711ae](https://github.com/sagemath/sagetrac-mirror/commit/35711aea44edb54e56b1c46ec6b09465fd4acc79)**",
    "created_at": "2020-03-09T03:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461540",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7ae21c3](https://github.com/sagemath/sagetrac-mirror/commit/7ae21c3f35718808ddbba90431097d18e3f95e7b)** to **[35711ae](https://github.com/sagemath/sagetrac-mirror/commit/35711aea44edb54e56b1c46ec6b09465fd4acc79)**



---

archive/issue_comments_461541.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35711aea44edb54e56b1c46ec6b09465fd4acc79\">35711ae</a></td><td><code>Use gcc -print-target-triple for clang</code></td></tr></table>\n",
    "created_at": "2020-03-09T03:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461541",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35711aea44edb54e56b1c46ec6b09465fd4acc79">35711ae</a></td><td><code>Use gcc -print-target-triple for clang</code></td></tr></table>




---

archive/issue_events_370463.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-09T03:40:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370463"
}
```



---

archive/issue_events_370464.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-09T03:40:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370464"
}
```



---

archive/issue_comments_461542.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@dimpase](#comment%3A5):\n> I don't know how to set up an environment where this change matters.\n\nTests ran at https://github.com/mkoeppe/sage/runs/493828325\n\nFixed: `ubuntu-bionic-i386-minimal`, `ubuntu-eoan-i386-minimal`, `debian-buster-i386-minimal`.\n\nRemaining error: `centos-7-i386-minimal` (https://github.com/mkoeppe/sage/runs/493828336)",
    "created_at": "2020-03-09T21:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461542",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@dimpase](#comment%3A5):
> I don't know how to set up an environment where this change matters.

Tests ran at https://github.com/mkoeppe/sage/runs/493828325

Fixed: `ubuntu-bionic-i386-minimal`, `ubuntu-eoan-i386-minimal`, `debian-buster-i386-minimal`.

Remaining error: `centos-7-i386-minimal` (https://github.com/mkoeppe/sage/runs/493828336)



---

archive/issue_comments_461543.json:
```json
{
    "body": "Changed commit from **[35711ae](https://github.com/sagemath/sagetrac-mirror/commit/35711aea44edb54e56b1c46ec6b09465fd4acc79)** to **[7847ee9](https://github.com/sagemath/sagetrac-mirror/commit/7847ee9dc264532c071b4930d022fb41512e8a10)**",
    "created_at": "2020-03-09T21:25:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461543",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[35711ae](https://github.com/sagemath/sagetrac-mirror/commit/35711aea44edb54e56b1c46ec6b09465fd4acc79)** to **[7847ee9](https://github.com/sagemath/sagetrac-mirror/commit/7847ee9dc264532c071b4930d022fb41512e8a10)**



---

archive/issue_comments_461544.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7847ee9dc264532c071b4930d022fb41512e8a10\">7847ee9</a></td><td><code>build/pkgs/gfortran/spkg-build: Treat i[4-6]86 like i386</code></td></tr></table>\n",
    "created_at": "2020-03-09T21:25:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461544",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>Comment 14:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7847ee9dc264532c071b4930d022fb41512e8a10">7847ee9</a></td><td><code>build/pkgs/gfortran/spkg-build: Treat i[4-6]86 like i386</code></td></tr></table>




---

archive/issue_comments_461545.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dcdb8cee9e31b937542e0f47d6f2d5d0d993dfbe\">dcdb8ce</a></td><td><code>Usee gcc -dumpmachine</code></td></tr></table>\n",
    "created_at": "2020-03-10T23:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461545",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dcdb8cee9e31b937542e0f47d6f2d5d0d993dfbe">dcdb8ce</a></td><td><code>Usee gcc -dumpmachine</code></td></tr></table>




---

archive/issue_comments_461546.json:
```json
{
    "body": "Changed commit from **[7847ee9](https://github.com/sagemath/sagetrac-mirror/commit/7847ee9dc264532c071b4930d022fb41512e8a10)** to **[dcdb8ce](https://github.com/sagemath/sagetrac-mirror/commit/dcdb8cee9e31b937542e0f47d6f2d5d0d993dfbe)**",
    "created_at": "2020-03-10T23:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461546",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7847ee9](https://github.com/sagemath/sagetrac-mirror/commit/7847ee9dc264532c071b4930d022fb41512e8a10)** to **[dcdb8ce](https://github.com/sagemath/sagetrac-mirror/commit/dcdb8cee9e31b937542e0f47d6f2d5d0d993dfbe)**



---

archive/issue_comments_461547.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nTests at https://github.com/mkoeppe/sage/actions/runs/53297072",
    "created_at": "2020-03-10T23:48:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461547",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'>Comment 16:</a>
Tests at https://github.com/mkoeppe/sage/actions/runs/53297072



---

archive/issue_comments_461548.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nThis fixed the remaining platform `centos-7-i386-minimal`.\n\nReady for review.",
    "created_at": "2020-03-11T18:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461548",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'>Comment 17:</a>
This fixed the remaining platform `centos-7-i386-minimal`.

Ready for review.



---

archive/issue_comments_461549.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c830344820c40a8079d773a23c22378d10ce8e05\">c830344</a></td><td><code>Use gcc -dumpmachine</code></td></tr></table>\n",
    "created_at": "2020-03-15T23:51:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461549",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c830344820c40a8079d773a23c22378d10ce8e05">c830344</a></td><td><code>Use gcc -dumpmachine</code></td></tr></table>




---

archive/issue_comments_461550.json:
```json
{
    "body": "Changed commit from **[dcdb8ce](https://github.com/sagemath/sagetrac-mirror/commit/dcdb8cee9e31b937542e0f47d6f2d5d0d993dfbe)** to **[c830344](https://github.com/sagemath/sagetrac-mirror/commit/c830344820c40a8079d773a23c22378d10ce8e05)**",
    "created_at": "2020-03-15T23:51:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461550",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[dcdb8ce](https://github.com/sagemath/sagetrac-mirror/commit/dcdb8cee9e31b937542e0f47d6f2d5d0d993dfbe)** to **[c830344](https://github.com/sagemath/sagetrac-mirror/commit/c830344820c40a8079d773a23c22378d10ce8e05)**



---

archive/issue_comments_461551.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nI'll have to take your word for it that this fixes the problem. Some implementation nitpicks:\n\n```\nARCH=`$CC -dumpmachine 2>/dev/null || echo unknown`\n```\n\nThe form `$(command)` should be preferred over backticks here (http://mywiki.wooledge.org/BashFAQ/082).\n\nAnd if you explicitly want to call GCC here, shouldn't you use \"gcc\" instead of $CC?\n\n```\n    x86_64,i[3-6]86*)\n```\n\nPersonally I would just write `[3456]` there. Ranges in globs are a bash extension, but more importantly they involve the system locale and collation, leading to rare problems that can be avoided by just listing the numbers you want to match.",
    "created_at": "2020-03-16T00:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461551",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:20'>Comment 20:</a>
I'll have to take your word for it that this fixes the problem. Some implementation nitpicks:

```
ARCH=`$CC -dumpmachine 2>/dev/null || echo unknown`
```

The form `$(command)` should be preferred over backticks here (http://mywiki.wooledge.org/BashFAQ/082).

And if you explicitly want to call GCC here, shouldn't you use "gcc" instead of $CC?

```
    x86_64,i[3-6]86*)
```

Personally I would just write `[3456]` there. Ranges in globs are a bash extension, but more importantly they involve the system locale and collation, leading to rare problems that can be avoided by just listing the numbers you want to match.



---

archive/issue_comments_461552.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@orlitzky](#comment%3A20):\n> I'll have to take your word for it that this fixes the problem. \n\nThe logs on the various machines are available at the links posted.\n\n> Some implementation nitpicks:\n> \n> ```\n> ARCH=`$CC -dumpmachine 2>/dev/null || echo unknown`\n> ```\n> \n> The form `$(command)` should be preferred over backticks here (http://mywiki.wooledge.org/BashFAQ/082).\n\nOK will do.\n\n> \n> And if you explicitly want to call GCC here, shouldn't you use \"gcc\" instead of $CC?\n\nNo, this needs to run the specific compiler that is configured!\n\n> ```\n>     x86_64,i[3-6]86*)\n> ```\n> \n> Personally I would just write `[3456]` there. Ranges in globs are a bash extension, but more importantly they involve the system locale and collation, leading to rare problems that can be avoided by just listing the numbers you want to match.\n\nOK will do.",
    "created_at": "2020-03-16T00:21:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461552",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@orlitzky](#comment%3A20):
> I'll have to take your word for it that this fixes the problem. 

The logs on the various machines are available at the links posted.

> Some implementation nitpicks:
> 
> ```
> ARCH=`$CC -dumpmachine 2>/dev/null || echo unknown`
> ```
> 
> The form `$(command)` should be preferred over backticks here (http://mywiki.wooledge.org/BashFAQ/082).

OK will do.

> 
> And if you explicitly want to call GCC here, shouldn't you use "gcc" instead of $CC?

No, this needs to run the specific compiler that is configured!

> ```
>     x86_64,i[3-6]86*)
> ```
> 
> Personally I would just write `[3456]` there. Ranges in globs are a bash extension, but more importantly they involve the system locale and collation, leading to rare problems that can be avoided by just listing the numbers you want to match.

OK will do.



---

archive/issue_comments_461553.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nReplying to [@mkoeppe](#comment%3A21):\n> > And if you explicitly want to call GCC here, shouldn't you use \"gcc\" instead of $CC?\n\n> \n> No, this needs to run the specific compiler that is configured!\n\nIn particular, this is supposed to work also if CC is configured to be \"gcc -m32\".",
    "created_at": "2020-03-16T00:27:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461553",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'>Comment 22:</a>
Replying to [@mkoeppe](#comment%3A21):
> > And if you explicitly want to call GCC here, shouldn't you use "gcc" instead of $CC?

> 
> No, this needs to run the specific compiler that is configured!

In particular, this is supposed to work also if CC is configured to be "gcc -m32".



---

archive/issue_comments_461554.json:
```json
{
    "body": "Changed commit from **[c830344](https://github.com/sagemath/sagetrac-mirror/commit/c830344820c40a8079d773a23c22378d10ce8e05)** to **[c85c26f](https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18)**",
    "created_at": "2020-03-16T00:29:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461554",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c830344](https://github.com/sagemath/sagetrac-mirror/commit/c830344820c40a8079d773a23c22378d10ce8e05)** to **[c85c26f](https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18)**



---

archive/issue_comments_461555.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18\">c85c26f</a></td><td><code>build/pkgs/gfortran/spkg-build: shell style fixes suggested by mjo</code></td></tr></table>\n",
    "created_at": "2020-03-16T00:29:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461555",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18">c85c26f</a></td><td><code>build/pkgs/gfortran/spkg-build: shell style fixes suggested by mjo</code></td></tr></table>




---

archive/issue_comments_461556.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [@mkoeppe](#comment%3A22):\n> \n> In particular, this is supposed to work also if CC is configured to be \"gcc -m32\".\n> \n\nAh, ok. I was thinking more along the lines of, what if `CC` is e.g. clang or icc?",
    "created_at": "2020-03-16T00:32:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461556",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [@mkoeppe](#comment%3A22):
> 
> In particular, this is supposed to work also if CC is configured to be "gcc -m32".
> 

Ah, ok. I was thinking more along the lines of, what if `CC` is e.g. clang or icc?



---

archive/issue_comments_461557.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nReplying to [@orlitzky](#comment%3A24):\n> Replying to [@mkoeppe](#comment%3A22):\n> > \n> > In particular, this is supposed to work also if CC is configured to be \"gcc -m32\".\n> > \n\n> \n> Ah, ok. I was thinking more along the lines of, what if `CC` is e.g. clang or icc?\n\nWell, clang supports the `-dumpmachine` option too.\n\nI have not tested with icc; I don't know if Sage is known to build at all with this compiler.",
    "created_at": "2020-03-16T00:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461557",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'>Comment 25:</a>
Replying to [@orlitzky](#comment%3A24):
> Replying to [@mkoeppe](#comment%3A22):
> > 
> > In particular, this is supposed to work also if CC is configured to be "gcc -m32".
> > 

> 
> Ah, ok. I was thinking more along the lines of, what if `CC` is e.g. clang or icc?

Well, clang supports the `-dumpmachine` option too.

I have not tested with icc; I don't know if Sage is known to build at all with this compiler.



---

archive/issue_comments_461558.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nThere's some evidence (https://github.com/JuliaLang/julia/issues/9145) that icc supports this option too on Linux (but possibly not on macOS - which is not a problem because 32-bit builds are no longer supported; and the fallback to `unknown` should take care of it).",
    "created_at": "2020-03-16T00:44:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461558",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'>Comment 26:</a>
There's some evidence (https://github.com/JuliaLang/julia/issues/9145) that icc supports this option too on Linux (but possibly not on macOS - which is not a problem because 32-bit builds are no longer supported; and the fallback to `unknown` should take care of it).



---

archive/issue_comments_461559.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nMy concern isn't about the `-dumpmachine` flag per se. We need to build gfortran with the same ABI as gcc, because gfortran tries to use headers from GCC and they won't be where gfortran expects them to be if the ABIs are mismatched. But if `CC=clang`, why should we insist that the ABI of clang and gfortran are the same? In that case, you still want to ensure that the ABIs of gfortran/gcc agree, not gfortran/clang.",
    "created_at": "2020-03-16T00:56:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461559",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:27'>Comment 27:</a>
My concern isn't about the `-dumpmachine` flag per se. We need to build gfortran with the same ABI as gcc, because gfortran tries to use headers from GCC and they won't be where gfortran expects them to be if the ABIs are mismatched. But if `CC=clang`, why should we insist that the ABI of clang and gfortran are the same? In that case, you still want to ensure that the ABIs of gfortran/gcc agree, not gfortran/clang.



---

archive/issue_comments_461560.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nSimply because we cannot link 32bit & 64bit into one executable",
    "created_at": "2020-03-16T01:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461560",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'>Comment 28:</a>
Simply because we cannot link 32bit & 64bit into one executable



---

archive/issue_comments_461561.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nWe need to build gfortran with the same ABI as the C compiler that is used, not some gcc that may be on the system.",
    "created_at": "2020-03-16T01:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461561",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'>Comment 29:</a>
We need to build gfortran with the same ABI as the C compiler that is used, not some gcc that may be on the system.



---

archive/issue_comments_461562.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nOk, that makes sense. I was focusing on the `bits/libc-header-start.h: No such file or directory` errors. I guess we could still get build failures if GCC is 32-bit but someone has built a 64-bit clang and sets `CC=clang`. These are pretty low return-on-investment scenarios, though. Feel free to set positive review if the CI and build bots are happy.",
    "created_at": "2020-03-16T01:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461562",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:30'>Comment 30:</a>
Ok, that makes sense. I was focusing on the `bits/libc-header-start.h: No such file or directory` errors. I guess we could still get build failures if GCC is 32-bit but someone has built a 64-bit clang and sets `CC=clang`. These are pretty low return-on-investment scenarios, though. Feel free to set positive review if the CI and build bots are happy.



---

archive/issue_comments_461563.json:
```json
{
    "body": "Reviewer: **Michael Orlitzky**",
    "created_at": "2020-03-16T01:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461563",
    "user": "https://github.com/orlitzky"
}
```

Reviewer: **Michael Orlitzky**



---

archive/issue_comments_461564.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nReplying to [@orlitzky](#comment%3A30):\n> Ok, that makes sense. I was focusing on the `bits/libc-header-start.h: No such file or directory` errors. I guess we could still get build failures if GCC is 32-bit but someone has built a 64-bit clang and sets `CC=clang`. \n\nRight. In this situation, probably we would have to build the full gcc, possibly with bootstrapping. \n\n> These are pretty low return-on-investment scenarios, though. \n\nI agree. If this ever becomes a problem, this can be fixed separately.\n\n> Feel free to set positive review if the CI and build bots are happy.\n\nThanks!",
    "created_at": "2020-03-16T01:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461564",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'>Comment 31:</a>
Replying to [@orlitzky](#comment%3A30):
> Ok, that makes sense. I was focusing on the `bits/libc-header-start.h: No such file or directory` errors. I guess we could still get build failures if GCC is 32-bit but someone has built a 64-bit clang and sets `CC=clang`. 

Right. In this situation, probably we would have to build the full gcc, possibly with bootstrapping. 

> These are pretty low return-on-investment scenarios, though. 

I agree. If this ever becomes a problem, this can be fixed separately.

> Feel free to set positive review if the CI and build bots are happy.

Thanks!



---

archive/issue_events_370465.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-16T01:35:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370465"
}
```



---

archive/issue_events_370466.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-16T01:35:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370466"
}
```



---

archive/issue_events_370467.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-18T22:40:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370467"
}
```



---

archive/issue_events_370468.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e484a811789bd633a33e900f9112bb863e5c2834",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-03-18T22:40:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29241#event-370468"
}
```



---

archive/issue_comments_461565.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc)** to **[c85c26f](https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18)**",
    "created_at": "2020-03-18T22:40:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29241",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29241#issuecomment-461565",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/gfortran_on_32bit__configure_for_the_same_abi_as_gcc)** to **[c85c26f](https://github.com/sagemath/sagetrac-mirror/commit/c85c26f2beda594cfb6d8a5904ce7ecc39f28a18)**
