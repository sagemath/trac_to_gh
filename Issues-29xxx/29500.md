# Issue 29500: Install all Python packages via pip wheel (or setup.py bdist_wheel), store wheels in $SAGE_LOCAL/var/lib/sage/wheels

archive/issues_029263.json:
```json
{
    "body": "Our current version of pip already tries to install packages via `bdist_wheel`. \n\nIn this ticket, we break the build process into these steps by modifying `sdh_pip_install`:\n\n1. Build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w \"$SAGE_SPKG_WHEELS\"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_SPKG_WHEELS=$SAGE_LOCAL/var/lib/sage/wheels`.\n\n2. Then install the wheel.\n\nThe wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel). Example (after rebuilding a few packages on this branch):\n\n```\n$ ls -l local/var/lib/sage/wheels/\n...\n-rw-r--r--  1 mkoeppe  staff    545293 Sep  8 12:44 Pillow-7.2.0-cp37-cp37m-macosx_10_9_x86_64.whl\n-rw-r--r--  1 mkoeppe  staff   4573510 Sep  8 12:06 numpy-1.19.1-cp37-cp37m-macosx_10_9_x86_64.whl\n-rw-r--r--  1 mkoeppe  staff      2237 Sep  8 12:44 sage_conf-9.2b12-py3-none-any.whl\n-rw-r--r--  1 mkoeppe  staff  17981103 Sep  8 12:59 scipy-1.5.2-cp37-cp37m-macosx_10_9_x86_64.whl\n```\n\nUsers can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.\n\n- Example:\n\n    {{{\n$ python3 -m venv some-venv\n$ cd some-venv/\n$ bin/pip3 install -v --no-index --find-links=../local/var/lib/sage/wheels/ Pillow    \n      }}}\n- In follow-up ticket #30527, we create a PEP 503 simple repository for the wheels built during installation, which enables more convenient installation options for users.\n\n\nIn this ticket, we keep using the `DESTDIR` staging mechanism also for the installation of the package from the wheel. \n\n- In a follow-up ticket, we can change this -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). \n\n---\n\nReferences:\n\n- https://pip.pypa.io/en/stable/user_guide/#installing-from-local-packages\n\n- https://pip.pypa.io/en/stable/reference/pip_cache/\n\n\nCC:  @slel @tobiasdiez @embray @jhpalmieri @tscrim\n\nReviewer: Tobias Diez, John Palmieri\n\nAuthor: Matthias Koeppe\n\nBranch: f2e707561ab3044221b57151ae4cc67d502fe9f8\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29500\n\n",
    "closed_at": "2020-09-27T09:09:52Z",
    "created_at": "2020-04-13T02:40:23Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Install all Python packages via pip wheel (or setup.py bdist_wheel), store wheels in $SAGE_LOCAL/var/lib/sage/wheels",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29500",
    "user": "https://github.com/mkoeppe"
}
```
Our current version of pip already tries to install packages via `bdist_wheel`. 

In this ticket, we break the build process into these steps by modifying `sdh_pip_install`:

1. Build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w "$SAGE_SPKG_WHEELS"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_SPKG_WHEELS=$SAGE_LOCAL/var/lib/sage/wheels`.

2. Then install the wheel.

The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel). Example (after rebuilding a few packages on this branch):

```
$ ls -l local/var/lib/sage/wheels/
...
-rw-r--r--  1 mkoeppe  staff    545293 Sep  8 12:44 Pillow-7.2.0-cp37-cp37m-macosx_10_9_x86_64.whl
-rw-r--r--  1 mkoeppe  staff   4573510 Sep  8 12:06 numpy-1.19.1-cp37-cp37m-macosx_10_9_x86_64.whl
-rw-r--r--  1 mkoeppe  staff      2237 Sep  8 12:44 sage_conf-9.2b12-py3-none-any.whl
-rw-r--r--  1 mkoeppe  staff  17981103 Sep  8 12:59 scipy-1.5.2-cp37-cp37m-macosx_10_9_x86_64.whl
```

Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.

- Example:

    {{{
$ python3 -m venv some-venv
$ cd some-venv/
$ bin/pip3 install -v --no-index --find-links=../local/var/lib/sage/wheels/ Pillow    
      }}}
- In follow-up ticket #30527, we create a PEP 503 simple repository for the wheels built during installation, which enables more convenient installation options for users.


In this ticket, we keep using the `DESTDIR` staging mechanism also for the installation of the package from the wheel. 

- In a follow-up ticket, we can change this -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). 

---

References:

- https://pip.pypa.io/en/stable/user_guide/#installing-from-local-packages

- https://pip.pypa.io/en/stable/reference/pip_cache/


CC:  @slel @tobiasdiez @embray @jhpalmieri @tscrim

Reviewer: Tobias Diez, John Palmieri

Author: Matthias Koeppe

Branch: f2e707561ab3044221b57151ae4cc67d502fe9f8

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29500





---

archive/issue_comments_576463.json:
```json
{
    "body": "<a id='comment:1'></a>\nWould that be `gambit`, `numpy` and `pillow`?\n\nAnd is this how to find them?\n\n```\n$ git grep \"setup.py\" build/pkgs\n```",
    "created_at": "2020-05-09T23:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576463",
    "user": "https://github.com/slel"
}
```

<a id='comment:1'></a>
Would that be `gambit`, `numpy` and `pillow`?

And is this how to find them?

```
$ git grep "setup.py" build/pkgs
```



---

archive/issue_events_075232.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29500#event-75232"
}
```



---

archive/issue_comments_576464.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n-Some of our Python packages are still installed by calling setup.py directly. This should be fixed\n+Some of our Python packages are still installed by calling `setup.py` directly. This should be fixed.\n+\n+pip tries to install packages via `bdist_wheel`. We should build the wheel explicitly using `pipand then install the wheel -- replacing (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation.\n+\n+\n``````\n",
    "created_at": "2020-08-27T04:07:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576464",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
-Some of our Python packages are still installed by calling setup.py directly. This should be fixed
+Some of our Python packages are still installed by calling `setup.py` directly. This should be fixed.
+
+pip tries to install packages via `bdist_wheel`. We should build the wheel explicitly using `pipand then install the wheel -- replacing (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation.
+
+
``````




---

archive/issue_comments_576465.json:
```json
{
    "body": "<a id='comment:5'></a>\n... Also consider pipenv + pipfile as suggested in #30317 ...",
    "created_at": "2020-08-30T19:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576465",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
... Also consider pipenv + pipfile as suggested in #30317 ...



---

archive/issue_comments_576466.json:
```json
{
    "body": "<a id='comment:7'></a>\nI would prefer not to have two separate package installation and management systems.  If the only motivation of this is the race condition, like I said this can be solved with an additional file lock to prevent multiple Python packages from being installed simultaneously.",
    "created_at": "2020-09-01T13:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576466",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
I would prefer not to have two separate package installation and management systems.  If the only motivation of this is the race condition, like I said this can be solved with an additional file lock to prevent multiple Python packages from being installed simultaneously.



---

archive/issue_comments_576467.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,25 @@\n-Some of our Python packages are still installed by calling `setup.py` directly. This should be fixed.\n+Our current version of pip already tries to install packages via `bdist_wheel`. \n \n-pip tries to install packages via `bdist_wheel`. We should build the wheel explicitly using `pipand then install the wheel -- replacing (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation.\n+In this ticket, we break the build process into these steps:\n+\n+1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/repo`.\n+\n+2. In `spkg-install`, install the wheel.\n+\n+We drop (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation (step 2).\n+\n+Optionally, the wheels in `SAGE_ROOT/repo` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/repo`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.\n+\n+---\n+\n+References:\n+\n+- https://github.com/pytorch/pytorch/issues/25639 \"Implement pep 503 Simple Repository API for deployment\"\n+\n+- https://pypi.org/project/piprepo/ - create PEP 503 package repo\n+\n+- https://stackoverflow.com/questions/45744937/how-do-install-packages-from-a-local-python-package-index\n+\n+- https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes\n \n \n``````\n",
    "created_at": "2020-09-06T04:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576467",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,25 @@
-Some of our Python packages are still installed by calling `setup.py` directly. This should be fixed.
+Our current version of pip already tries to install packages via `bdist_wheel`. 
 
-pip tries to install packages via `bdist_wheel`. We should build the wheel explicitly using `pipand then install the wheel -- replacing (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation.
+In this ticket, we break the build process into these steps:
+
+1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/repo`.
+
+2. In `spkg-install`, install the wheel.
+
+We drop (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation (step 2).
+
+Optionally, the wheels in `SAGE_ROOT/repo` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/repo`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.
+
+---
+
+References:
+
+- https://github.com/pytorch/pytorch/issues/25639 "Implement pep 503 Simple Repository API for deployment"
+
+- https://pypi.org/project/piprepo/ - create PEP 503 package repo
+
+- https://stackoverflow.com/questions/45744937/how-do-install-packages-from-a-local-python-package-index
+
+- https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes
 
 
``````




---

archive/issue_comments_576468.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,13 +2,13 @@\n \n In this ticket, we break the build process into these steps:\n \n-1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/repo`.\n+1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/wheelhouse`.\n \n 2. In `spkg-install`, install the wheel.\n \n We drop (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation (step 2).\n \n-Optionally, the wheels in `SAGE_ROOT/repo` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/repo`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.\n+Optionally, the wheels in `SAGE_ROOT/wheelhouse` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/wheelhouse`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.\n \n ---\n \n``````\n",
    "created_at": "2020-09-06T05:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576468",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,13 +2,13 @@
 
 In this ticket, we break the build process into these steps:
 
-1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/repo`.
+1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/wheelhouse`.
 
 2. In `spkg-install`, install the wheel.
 
 We drop (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation (step 2).
 
-Optionally, the wheels in `SAGE_ROOT/repo` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/repo`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.
+Optionally, the wheels in `SAGE_ROOT/wheelhouse` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/wheelhouse`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.
 
 ---
 
``````




---

archive/issue_comments_576469.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n In this ticket, we break the build process into these steps:\n \n-1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/wheelhouse`.\n+1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary --no-build-isolation -w \"$SAGE_ROOT/wheelhouse\"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.\n \n 2. In `spkg-install`, install the wheel.\n \n``````\n",
    "created_at": "2020-09-06T05:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576469",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 In this ticket, we break the build process into these steps:
 
-1. In `spkg-build`, build the wheel explicitly using `pip wheel` (or `setup.py bdist_wheel`); store the wheel in `SAGE_ROOT/wheelhouse`.
+1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary --no-build-isolation -w "$SAGE_ROOT/wheelhouse"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.
 
 2. In `spkg-install`, install the wheel.
 
``````




---

archive/issue_comments_576470.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n In this ticket, we break the build process into these steps:\n \n-1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary --no-build-isolation -w \"$SAGE_ROOT/wheelhouse\"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.\n+1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w \"$SAGE_ROOT/wheelhouse\"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.\n \n 2. In `spkg-install`, install the wheel.\n \n``````\n",
    "created_at": "2020-09-06T05:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576470",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 In this ticket, we break the build process into these steps:
 
-1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary --no-build-isolation -w "$SAGE_ROOT/wheelhouse"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.
+1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w "$SAGE_ROOT/wheelhouse"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.
 
 2. In `spkg-install`, install the wheel.
 
``````




---

archive/issue_comments_576471.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#30024\"",
    "created_at": "2020-09-06T23:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576471",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#30024"



---

archive/issue_comments_576472.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,4 +22,5 @@\n \n - https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes\n \n+- https://pip.pypa.io/en/stable/reference/pip_cache/\n \n``````\n",
    "created_at": "2020-09-07T03:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576472",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,4 +22,5 @@
 
 - https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes
 
+- https://pip.pypa.io/en/stable/reference/pip_cache/
 
``````




---

archive/issue_comments_576473.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,6 +14,8 @@\n \n References:\n \n+- https://pip.pypa.io/en/stable/user_guide/#installing-from-local-packages\n+\n - https://github.com/pytorch/pytorch/issues/25639 \"Implement pep 503 Simple Repository API for deployment\"\n \n - https://pypi.org/project/piprepo/ - create PEP 503 package repo\n``````\n",
    "created_at": "2020-09-08T00:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576473",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,6 +14,8 @@
 
 References:
 
+- https://pip.pypa.io/en/stable/user_guide/#installing-from-local-packages
+
 - https://github.com/pytorch/pytorch/issues/25639 "Implement pep 503 Simple Repository API for deployment"
 
 - https://pypi.org/project/piprepo/ - create PEP 503 package repo
``````




---

archive/issue_comments_576474.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,14 +1,18 @@\n Our current version of pip already tries to install packages via `bdist_wheel`. \n \n-In this ticket, we break the build process into these steps:\n+In this ticket, we break the build process into these steps by modifying `sdh_pip_install`:\n \n-1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w \"$SAGE_ROOT/wheelhouse\"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.\n+1. Build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w \"$SAGE_SPKG_WHEELS\"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_SPKG_WHEELS=$SAGE_LOCAL/var/lib/sage/wheels`.\n \n-2. In `spkg-install`, install the wheel.\n+2. Then install the wheel.\n \n-We drop (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation (step 2).\n+The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the DESTDIR staging mechanism -- there will be exactly 1 wheel for each installed package.\n \n-Optionally, the wheels in `SAGE_ROOT/wheelhouse` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/wheelhouse`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.\n+Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.\n+\n+Optionally, we can create a PEP 503 compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.\n+\n+In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). \n \n ---\n \n``````\n",
    "created_at": "2020-09-08T02:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576474",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,14 +1,18 @@
 Our current version of pip already tries to install packages via `bdist_wheel`. 
 
-In this ticket, we break the build process into these steps:
+In this ticket, we break the build process into these steps by modifying `sdh_pip_install`:
 
-1. In `spkg-build`, build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w "$SAGE_ROOT/wheelhouse"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_ROOT/wheelhouse`.
+1. Build the wheel explicitly using `pip wheel --no-binary :all: --no-build-isolation -w "$SAGE_SPKG_WHEELS"` (or `setup.py bdist_wheel`), which stores the wheel in `SAGE_SPKG_WHEELS=$SAGE_LOCAL/var/lib/sage/wheels`.
 
-2. In `spkg-install`, install the wheel.
+2. Then install the wheel.
 
-We drop (for Python packages only) the problematic use of the DESTDIR staging mechanism (#29585). The pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) will only need to be held during the wheel installation (step 2).
+The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the DESTDIR staging mechanism -- there will be exactly 1 wheel for each installed package.
 
-Optionally, the wheels in `SAGE_ROOT/wheelhouse` will persist after the completed build.  Then we can create a PEP 503 compliant Simple Repository index in `SAGE_ROOT/wheelhouse`. Then users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --find-links` or `pip install --index-url`.
+Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.
+
+Optionally, we can create a PEP 503 compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.
+
+In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). 
 
 ---
 
``````




---

archive/issue_comments_576475.json:
```json
{
    "body": "<a id='comment:15'></a>\nNarrowed the scope of the ticket.",
    "created_at": "2020-09-08T02:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576475",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Narrowed the scope of the ticket.



---

archive/issue_comments_576476.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels\"",
    "created_at": "2020-09-08T05:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576476",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels"



---

archive/issue_comments_576477.json:
```json
{
    "body": "<a id='comment:17'></a>\nNew commits:\n|                                                                                                                                          |                                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[8aa6fd9](https://git.sagemath.org/sage.git/commit?id=8aa6fd96607c207a0f9563c583978cd50ddc52a7)|`build/bin/sage-dist-helpers (sdh_pip_install): Build a wheel, store it`|",
    "created_at": "2020-09-08T05:29:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576477",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
New commits:
|                                                                                                                                          |                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[8aa6fd9](https://git.sagemath.org/sage.git/commit?id=8aa6fd96607c207a0f9563c583978cd50ddc52a7)|`build/bin/sage-dist-helpers (sdh_pip_install): Build a wheel, store it`|



---

archive/issue_comments_576478.json:
```json
{
    "body": "Changing commit from \"\" to \"8aa6fd96607c207a0f9563c583978cd50ddc52a7\"",
    "created_at": "2020-09-08T05:29:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576478",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "8aa6fd96607c207a0f9563c583978cd50ddc52a7"



---

archive/issue_comments_576479.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,9 +10,9 @@\n \n Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.\n \n-Optionally, we can create a PEP 503 compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.\n+In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). \n \n-In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). \n+Follow-up: #30527 Create PEP 503 simple repository for wheels built during installation\n \n ---\n \n@@ -20,13 +20,5 @@\n \n - https://pip.pypa.io/en/stable/user_guide/#installing-from-local-packages\n \n-- https://github.com/pytorch/pytorch/issues/25639 \"Implement pep 503 Simple Repository API for deployment\"\n-\n-- https://pypi.org/project/piprepo/ - create PEP 503 package repo\n-\n-- https://stackoverflow.com/questions/45744937/how-do-install-packages-from-a-local-python-package-index\n-\n-- https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes\n-\n - https://pip.pypa.io/en/stable/reference/pip_cache/\n \n``````\n",
    "created_at": "2020-09-08T05:29:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576479",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,9 +10,9 @@
 
 Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.
 
-Optionally, we can create a PEP 503 compliant Simple Repository index in `$SAGE_SPKG_WHEELS`. Then users can create their virtual environment using tools such as `pipenv` `[This is the Trac macro *source* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#source-macro)` or `pip install --index-url`.
+In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). 
 
-In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). 
+Follow-up: #30527 Create PEP 503 simple repository for wheels built during installation
 
 ---
 
@@ -20,13 +20,5 @@
 
 - https://pip.pypa.io/en/stable/user_guide/#installing-from-local-packages
 
-- https://github.com/pytorch/pytorch/issues/25639 "Implement pep 503 Simple Repository API for deployment"
-
-- https://pypi.org/project/piprepo/ - create PEP 503 package repo
-
-- https://stackoverflow.com/questions/45744937/how-do-install-packages-from-a-local-python-package-index
-
-- https://pipenv-fork.readthedocs.io/en/latest/advanced.html#specifying-package-indexes
-
 - https://pip.pypa.io/en/stable/reference/pip_cache/
 
``````




---

archive/issue_comments_576480.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-09-08T05:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576480",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_576481.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,13 +6,16 @@\n \n 2. Then install the wheel.\n \n-The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the DESTDIR staging mechanism -- there will be exactly 1 wheel for each installed package.\n+The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel).\n \n Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.\n \n-In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). \n+- In follow-up ticket #30527, we create a PEP 503 simple repository for the wheels built during installation, which enables more convenient installation options for users.\n \n-Follow-up: #30527 Create PEP 503 simple repository for wheels built during installation\n+\n+In this ticket, we keep using the `DESTDIR` staging mechanism also for the installation of the package from the wheel. \n+\n+- In a follow-up ticket, we can change this -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). \n \n ---\n \n``````\n",
    "created_at": "2020-09-08T05:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576481",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,13 +6,16 @@
 
 2. Then install the wheel.
 
-The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the DESTDIR staging mechanism -- there will be exactly 1 wheel for each installed package.
+The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel).
 
 Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.
 
-In this ticket, we keep using the DESTDIR staging mechanism also for the installation of the package from the wheel. This can be changed later -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). 
+- In follow-up ticket #30527, we create a PEP 503 simple repository for the wheels built during installation, which enables more convenient installation options for users.
 
-Follow-up: #30527 Create PEP 503 simple repository for wheels built during installation
+
+In this ticket, we keep using the `DESTDIR` staging mechanism also for the installation of the package from the wheel. 
+
+- In a follow-up ticket, we can change this -- to remove the problems described in #29585 -- by just holding the pip lock (if it is at all still necessary after the major pip upgrades in the 9.2 series) during the wheel installation (step 2). 
 
 ---
 
``````




---

archive/issue_comments_576482.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-08T05:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576482",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_576483.json:
```json
{
    "body": "Changing dependencies from \"#30024\" to \"\"",
    "created_at": "2020-09-08T05:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576483",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#30024" to ""



---

archive/issue_comments_576484.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [slelievre](#comment%3A1):\n> Would that be `gambit`, `numpy` and `pillow`?\n> \n> And is this how to find them?\n> \n> ```\n> $ git grep \"setup.py\" build/pkgs\n> ```\n\nYes, still need to take care of these.",
    "created_at": "2020-09-08T05:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576484",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Replying to [slelievre](#comment%3A1):
> Would that be `gambit`, `numpy` and `pillow`?
> 
> And is this how to find them?
> 
> ```
> $ git grep "setup.py" build/pkgs
> ```

Yes, still need to take care of these.



---

archive/issue_comments_576485.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-09-08T05:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576485",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_576486.json:
```json
{
    "body": "<a id='comment:21'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|\n|[d369aab](https://git.sagemath.org/sage.git/commit/?id=d369aabcda2feff14b4f1d14fe824e591d8c5c36)|`build/bin/sage-dist-helpers (sdh_store_and_pip_install_wheel): New, factored out from sdh_pip_install`|\n|[2d435ab](https://git.sagemath.org/sage.git/commit/?id=2d435ab90d74d86264d681371034700a8214e6d3)|`build/pkgs/numpy/spkg-install.in: Install via setup.py bdist_wheel`|\n|[55993b6](https://git.sagemath.org/sage.git/commit/?id=55993b6e25560af5e582aed7fcfbb56d317b92fe)|`build/bin/sage-dist-helpers: Fixup`|\n|[0a64674](https://git.sagemath.org/sage.git/commit/?id=0a646747dbf7c823030e1b23419348ff795a0661)|`build/pkgs/gambit/spkg-install.in: Install via bdist_wheel`|\n|[ca58693](https://git.sagemath.org/sage.git/commit/?id=ca586938cbdd91114a10dd3364201c8076412485)|`build/pkgs/pillow/spkg-install.in: Install via bdist_wheel`|",
    "created_at": "2020-09-08T19:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576486",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
|[d369aab](https://git.sagemath.org/sage.git/commit/?id=d369aabcda2feff14b4f1d14fe824e591d8c5c36)|`build/bin/sage-dist-helpers (sdh_store_and_pip_install_wheel): New, factored out from sdh_pip_install`|
|[2d435ab](https://git.sagemath.org/sage.git/commit/?id=2d435ab90d74d86264d681371034700a8214e6d3)|`build/pkgs/numpy/spkg-install.in: Install via setup.py bdist_wheel`|
|[55993b6](https://git.sagemath.org/sage.git/commit/?id=55993b6e25560af5e582aed7fcfbb56d317b92fe)|`build/bin/sage-dist-helpers: Fixup`|
|[0a64674](https://git.sagemath.org/sage.git/commit/?id=0a646747dbf7c823030e1b23419348ff795a0661)|`build/pkgs/gambit/spkg-install.in: Install via bdist_wheel`|
|[ca58693](https://git.sagemath.org/sage.git/commit/?id=ca586938cbdd91114a10dd3364201c8076412485)|`build/pkgs/pillow/spkg-install.in: Install via bdist_wheel`|



---

archive/issue_comments_576487.json:
```json
{
    "body": "Changing commit from \"8aa6fd96607c207a0f9563c583978cd50ddc52a7\" to \"ca586938cbdd91114a10dd3364201c8076412485\"",
    "created_at": "2020-09-08T19:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8aa6fd96607c207a0f9563c583978cd50ddc52a7" to "ca586938cbdd91114a10dd3364201c8076412485"



---

archive/issue_comments_576488.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,7 +6,16 @@\n \n 2. Then install the wheel.\n \n-The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel).\n+The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel). Example (after rebuilding a few packages on this branch):\n+\n+```\n+$ ls -l local/var/lib/sage/wheels/\n+...\n+-rw-r--r--  1 mkoeppe  staff    545293 Sep  8 12:44 Pillow-7.2.0-cp37-cp37m-macosx_10_9_x86_64.whl\n+-rw-r--r--  1 mkoeppe  staff   4573510 Sep  8 12:06 numpy-1.19.1-cp37-cp37m-macosx_10_9_x86_64.whl\n+-rw-r--r--  1 mkoeppe  staff      2237 Sep  8 12:44 sage_conf-9.2b12-py3-none-any.whl\n+-rw-r--r--  1 mkoeppe  staff  17981103 Sep  8 12:59 scipy-1.5.2-cp37-cp37m-macosx_10_9_x86_64.whl\n+```\n \n Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.\n \n``````\n",
    "created_at": "2020-09-08T20:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576488",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,7 +6,16 @@
 
 2. Then install the wheel.
 
-The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel).
+The wheels in `$SAGE_SPKG_WHEELS` persist after the completed build. We manage them using the `DESTDIR` staging mechanism -- there will be exactly 1 wheel for each installed package (and removing a package removes the wheel). Example (after rebuilding a few packages on this branch):
+
+```
+$ ls -l local/var/lib/sage/wheels/
+...
+-rw-r--r--  1 mkoeppe  staff    545293 Sep  8 12:44 Pillow-7.2.0-cp37-cp37m-macosx_10_9_x86_64.whl
+-rw-r--r--  1 mkoeppe  staff   4573510 Sep  8 12:06 numpy-1.19.1-cp37-cp37m-macosx_10_9_x86_64.whl
+-rw-r--r--  1 mkoeppe  staff      2237 Sep  8 12:44 sage_conf-9.2b12-py3-none-any.whl
+-rw-r--r--  1 mkoeppe  staff  17981103 Sep  8 12:59 scipy-1.5.2-cp37-cp37m-macosx_10_9_x86_64.whl
+```
 
 Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.
 
``````




---

archive/issue_comments_576489.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-09-08T20:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576489",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_576490.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,6 +19,13 @@\n \n Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.\n \n+- Example:\n+\n+    {{{\n+$ python3 -m venv some-venv\n+$ cd some-venv/\n+$ bin/pip3 install -v --no-index --find-links=../local/var/lib/sage/wheels/ Pillow    \n+      }}}\n - In follow-up ticket #30527, we create a PEP 503 simple repository for the wheels built during installation, which enables more convenient installation options for users.\n \n \n``````\n",
    "created_at": "2020-09-08T20:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576490",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,6 +19,13 @@
 
 Users can create virtual environments and install the wheels built by the Sage distribution into them, using standard tools such as `pip install --find-links`.
 
+- Example:
+
+    {{{
+$ python3 -m venv some-venv
+$ cd some-venv/
+$ bin/pip3 install -v --no-index --find-links=../local/var/lib/sage/wheels/ Pillow    
+      }}}
 - In follow-up ticket #30527, we create a PEP 503 simple repository for the wheels built during installation, which enables more convenient installation options for users.
 
 
``````




---

archive/issue_comments_576491.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Tobias Diez, ...\"",
    "created_at": "2020-09-09T17:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576491",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Tobias Diez, ..."



---

archive/issue_comments_576492.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[5a747c4](https://git.sagemath.org/sage.git/commit/?id=5a747c48eca1be0104c202e4922e5386aa794d08)|`build/bin/sage-pip-{install,uninstall}: Remove pip2 support`|",
    "created_at": "2020-09-09T17:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[5a747c4](https://git.sagemath.org/sage.git/commit/?id=5a747c48eca1be0104c202e4922e5386aa794d08)|`build/bin/sage-pip-{install,uninstall}: Remove pip2 support`|



---

archive/issue_comments_576493.json:
```json
{
    "body": "Changing commit from \"ca586938cbdd91114a10dd3364201c8076412485\" to \"5a747c48eca1be0104c202e4922e5386aa794d08\"",
    "created_at": "2020-09-09T17:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ca586938cbdd91114a10dd3364201c8076412485" to "5a747c48eca1be0104c202e4922e5386aa794d08"



---

archive/issue_comments_576494.json:
```json
{
    "body": "<a id='comment:28'></a>\n- Why `sdh_store_and_pip_install_wheel requires . as only argument`? Why not just call it with no arguments?\n\n- This function should be documented in `developer/packaging.rst`.\n\n- Does `sage-pip-uninstall` leave the old wheels lying around?\n\n- Typo in `sage-pip-uninstall` (copied from `sage-pip-install`): \"this command hould use\"",
    "created_at": "2020-09-17T00:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576494",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
- Why `sdh_store_and_pip_install_wheel requires . as only argument`? Why not just call it with no arguments?

- This function should be documented in `developer/packaging.rst`.

- Does `sage-pip-uninstall` leave the old wheels lying around?

- Typo in `sage-pip-uninstall` (copied from `sage-pip-install`): "this command hould use"



---

archive/issue_comments_576495.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [jhpalmieri](#comment%3A28):\n> - Why `sdh_store_and_pip_install_wheel requires . as only argument`? Why not just call it with no arguments?\n\n\nI did this to emphasize the analogy to `sage-pip-install`.\n\n> - This function should be documented in `developer/packaging.rst`.\n\n\nGood idea, will do.\n\n> - Does `sage-pip-uninstall` leave the old wheels lying around?\n\n\n`sage-pip-uninstall` is not really used for regular uninstalls. Rather, it \"force-uninstalls\" previously installed versions - in case the site-packages directory was somehow messed up. (This code was previously part of `sage-pip-install`.)\n\nThe wheels are installed with the staging mechanism (DESTDIR), which records the installed files. In this way, the `-clean` targets etc. automatically install the wheel.\n\n> - Typo in `sage-pip-uninstall` (copied from `sage-pip-install`): \"this command hould use\"\n\n\nThanks",
    "created_at": "2020-09-17T00:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576495",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Replying to [jhpalmieri](#comment%3A28):
> - Why `sdh_store_and_pip_install_wheel requires . as only argument`? Why not just call it with no arguments?


I did this to emphasize the analogy to `sage-pip-install`.

> - This function should be documented in `developer/packaging.rst`.


Good idea, will do.

> - Does `sage-pip-uninstall` leave the old wheels lying around?


`sage-pip-uninstall` is not really used for regular uninstalls. Rather, it "force-uninstalls" previously installed versions - in case the site-packages directory was somehow messed up. (This code was previously part of `sage-pip-install`.)

The wheels are installed with the staging mechanism (DESTDIR), which records the installed files. In this way, the `-clean` targets etc. automatically install the wheel.

> - Typo in `sage-pip-uninstall` (copied from `sage-pip-install`): "this command hould use"


Thanks



---

archive/issue_comments_576496.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [mkoeppe](#comment%3A29):\n> The wheels are installed with the staging mechanism (DESTDIR), which records the installed files. In this way, the `-clean` targets etc. automatically install the wheel.\n\n\nTo clarify, both the wheels and the installation made from the wheels uses the staging mechanism.",
    "created_at": "2020-09-17T00:42:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576496",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>
Replying to [mkoeppe](#comment%3A29):
> The wheels are installed with the staging mechanism (DESTDIR), which records the installed files. In this way, the `-clean` targets etc. automatically install the wheel.


To clarify, both the wheels and the installation made from the wheels uses the staging mechanism.



---

archive/issue_comments_576497.json:
```json
{
    "body": "Changing commit from \"5a747c48eca1be0104c202e4922e5386aa794d08\" to \"4135e8b236d2e5491b3ee96cbd00196dc5b6e036\"",
    "created_at": "2020-09-17T01:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5a747c48eca1be0104c202e4922e5386aa794d08" to "4135e8b236d2e5491b3ee96cbd00196dc5b6e036"



---

archive/issue_comments_576498.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[9ee2110](https://git.sagemath.org/sage.git/commit/?id=9ee21109dfb001feec2b032c197defb91cc75783)|`build/bin/sage-dist-helpers: Also use $sudo for storing the wheel file`|\n|[d7aac84](https://git.sagemath.org/sage.git/commit/?id=d7aac84ab4dd86ad6203a99eb82371c1d2a46363)|`src/doc/en/developer/packaging.rst: Update sdh_... documentation`|\n|[9b7c7a0](https://git.sagemath.org/sage.git/commit/?id=9b7c7a04d658838ce511e352edb9c03f42c4a7f2)|`build/bin/sage-pip-{install,uninstall}: Fix typo in comment`|\n|[4135e8b](https://git.sagemath.org/sage.git/commit/?id=4135e8b236d2e5491b3ee96cbd00196dc5b6e036)|`build/bin/sage-pip-install: Remove an outdated comment`|",
    "created_at": "2020-09-17T01:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576498",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[9ee2110](https://git.sagemath.org/sage.git/commit/?id=9ee21109dfb001feec2b032c197defb91cc75783)|`build/bin/sage-dist-helpers: Also use $sudo for storing the wheel file`|
|[d7aac84](https://git.sagemath.org/sage.git/commit/?id=d7aac84ab4dd86ad6203a99eb82371c1d2a46363)|`src/doc/en/developer/packaging.rst: Update sdh_... documentation`|
|[9b7c7a0](https://git.sagemath.org/sage.git/commit/?id=9b7c7a04d658838ce511e352edb9c03f42c4a7f2)|`build/bin/sage-pip-{install,uninstall}: Fix typo in comment`|
|[4135e8b](https://git.sagemath.org/sage.git/commit/?id=4135e8b236d2e5491b3ee96cbd00196dc5b6e036)|`build/bin/sage-pip-install: Remove an outdated comment`|



---

archive/issue_comments_576499.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-18T03:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576499",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_576500.json:
```json
{
    "body": "Changing reviewer from \"Tobias Diez, ...\" to \"Tobias Diez, John Palmieri\"",
    "created_at": "2020-09-18T03:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576500",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "Tobias Diez, ..." to "Tobias Diez, John Palmieri"



---

archive/issue_comments_576501.json:
```json
{
    "body": "<a id='comment:32'></a>\nSeems okay to me, and it built and passed tests before, so I think it's okay. Of course, I can [no longer build Sage](https://trac.sagemath.org/ticket/30494#comment:9) anymore, so perhaps take this review with a grain of salt.",
    "created_at": "2020-09-18T03:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576501",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>
Seems okay to me, and it built and passed tests before, so I think it's okay. Of course, I can [no longer build Sage](https://trac.sagemath.org/ticket/30494#comment:9) anymore, so perhaps take this review with a grain of salt.



---

archive/issue_comments_576502.json:
```json
{
    "body": "<a id='comment:33'></a>\nThanks!",
    "created_at": "2020-09-18T03:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576502",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
Thanks!



---

archive/issue_comments_576503.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-09-21T21:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576503",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_576504.json:
```json
{
    "body": "<a id='comment:34'></a>\nMerge conflict",
    "created_at": "2020-09-21T21:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576504",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>
Merge conflict



---

archive/issue_comments_576505.json:
```json
{
    "body": "Changing commit from \"4135e8b236d2e5491b3ee96cbd00196dc5b6e036\" to \"f2e707561ab3044221b57151ae4cc67d502fe9f8\"",
    "created_at": "2020-09-21T21:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4135e8b236d2e5491b3ee96cbd00196dc5b6e036" to "f2e707561ab3044221b57151ae4cc67d502fe9f8"



---

archive/issue_comments_576506.json:
```json
{
    "body": "<a id='comment:35'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|\n|[f2e7075](https://git.sagemath.org/sage.git/commit/?id=f2e707561ab3044221b57151ae4cc67d502fe9f8)|`Merge tag '9.2.beta13' into t/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels`|",
    "created_at": "2020-09-21T21:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
|[f2e7075](https://git.sagemath.org/sage.git/commit/?id=f2e707561ab3044221b57151ae4cc67d502fe9f8)|`Merge tag '9.2.beta13' into t/29500/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels`|



---

archive/issue_comments_576507.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-09-21T21:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576507",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_576508.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels\" to \"f2e707561ab3044221b57151ae4cc67d502fe9f8\"",
    "created_at": "2020-09-27T09:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576508",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/install_all_python_packages_via_pip_wheel__create_pep_503_simple_repository_for_wheels" to "f2e707561ab3044221b57151ae4cc67d502fe9f8"



---

archive/issue_events_075233.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-27T09:09:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29500#event-75233"
}
```



---

archive/issue_comments_576509.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-09-27T09:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576509",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_075234.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-27T16:18:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29500#event-75234"
}
```



---

archive/issue_events_075235.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-27T16:18:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29500#event-75235"
}
```



---

archive/issue_comments_576510.json:
```json
{
    "body": "<a id='comment:39'></a>\nFollow-up: #30771",
    "created_at": "2020-10-15T04:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576510",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
Follow-up: #30771



---

archive/issue_comments_576511.json:
```json
{
    "body": "Changing commit from \"f2e707561ab3044221b57151ae4cc67d502fe9f8\" to \"\"",
    "created_at": "2020-10-15T04:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576511",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "f2e707561ab3044221b57151ae4cc67d502fe9f8" to ""



---

archive/issue_comments_576512.json:
```json
{
    "body": "<a id='comment:40'></a>\nI'm not really sure what the advantage is of this complication. For the follow-up do you propose eliminating the installation manifests installed to `/var/lib/sage/installed/`? I would very much prefer to not do that. I see no reason for Python packages to be arbitrarily treated differently in this regard. But I'm not sure if that is really the plan.",
    "created_at": "2020-10-22T13:33:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576512",
    "user": "https://github.com/embray"
}
```

<a id='comment:40'></a>
I'm not really sure what the advantage is of this complication. For the follow-up do you propose eliminating the installation manifests installed to `/var/lib/sage/installed/`? I would very much prefer to not do that. I see no reason for Python packages to be arbitrarily treated differently in this regard. But I'm not sure if that is really the plan.



---

archive/issue_comments_576513.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [embray](#comment%3A40):\n> I'm not really sure what the advantage is of this complication. \n\nhttps://wiki.sagemath.org/ReleaseTours/sage-9.2#Reusable_wheels_for_the_Python_packages_built_by_the_Sage_distribution explains an immediate use case.",
    "created_at": "2020-10-22T15:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576513",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>
Replying to [embray](#comment%3A40):
> I'm not really sure what the advantage is of this complication. 

https://wiki.sagemath.org/ReleaseTours/sage-9.2#Reusable_wheels_for_the_Python_packages_built_by_the_Sage_distribution explains an immediate use case.



---

archive/issue_comments_576514.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [embray](#comment%3A40):\n> For the follow-up do you propose eliminating the installation manifests installed to `/var/lib/sage/installed/`?\n\n\nI don't have a ticket for this at the moment. But I think it's unavoidable to make some changes. Already now these installation manifests (which duplicate the `.egg-info` record in `site-packages`) can fall out of sync with the actual installation when the user uses `sage -pip install`, which could lead to upgrades of some python package dependencies. It's best to use standard Python tools to manage Python packages.",
    "created_at": "2020-10-22T15:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29500#issuecomment-576514",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>
Replying to [embray](#comment%3A40):
> For the follow-up do you propose eliminating the installation manifests installed to `/var/lib/sage/installed/`?


I don't have a ticket for this at the moment. But I think it's unavoidable to make some changes. Already now these installation manifests (which duplicate the `.egg-info` record in `site-packages`) can fall out of sync with the actual installation when the user uses `sage -pip install`, which could lead to upgrades of some python package dependencies. It's best to use standard Python tools to manage Python packages.
