# Issue 29845: PEP 517 / PEP 660 buildapi for sage_setup

archive/issues_029608.json:
```json
{
    "body": "Instead of fixing `setup.py sdist` using `MANIFEST.in` (#21516), we implement a PEP 517 `buildapi` in `sage_setup`. \n\nThis could be done, for example, by customizing flit. \n\n\nReferences:\n- https://github.com/takluyver/flit/blob/master/flit_core/flit_core/buildapi.py\n- https://flit.readthedocs.io/en/latest/pyproject_toml.html#\n- [Poetry issue #265 - Support for custom commands and functions](https://github.com/python-poetry/poetry/issues/265) - closed as wontfix\n- https://pypi.org/project/enscons/ ?\n\n- https://www.python.org/dev/peps/pep-0660/ Editable installs for pyproject.toml based builds (wheel based)\n- https://github.com/python/cpython/issues/92054 Clarification about how to implement namespace packages (as in PEP 420) via import hooks for PEP 660 use case\n- https://discuss.python.org/t/help-testing-pep-660-support-in-setuptools/16904 \n\n\nDependencies: #29846, #30581\n\nIssue created by migration from https://trac.sagemath.org/ticket/29845\n\n",
    "created_at": "2020-06-11T02:25:50Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "PEP 517 / PEP 660 buildapi for sage_setup",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29845",
    "user": "https://github.com/mkoeppe"
}
```
Instead of fixing `setup.py sdist` using `MANIFEST.in` (#21516), we implement a PEP 517 `buildapi` in `sage_setup`. 

This could be done, for example, by customizing flit. 


References:
- https://github.com/takluyver/flit/blob/master/flit_core/flit_core/buildapi.py
- https://flit.readthedocs.io/en/latest/pyproject_toml.html#
- [Poetry issue #265 - Support for custom commands and functions](https://github.com/python-poetry/poetry/issues/265) - closed as wontfix
- https://pypi.org/project/enscons/ ?

- https://www.python.org/dev/peps/pep-0660/ Editable installs for pyproject.toml based builds (wheel based)
- https://github.com/python/cpython/issues/92054 Clarification about how to implement namespace packages (as in PEP 420) via import hooks for PEP 660 use case
- https://discuss.python.org/t/help-testing-pep-660-support-in-setuptools/16904 


Dependencies: #29846, #30581

Issue created by migration from https://trac.sagemath.org/ticket/29845





---

archive/issue_events_076436.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-14T14:12:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29845",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29845#event-76436"
}
```



---

archive/issue_events_076437.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29845",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29845#event-76437"
}
```



---

archive/issue_events_076438.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29845",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29845#event-76438"
}
```



---

archive/issue_comments_419975.json:
```json
{
    "body": "<a id='comment:7'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29845",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29845#issuecomment-419975",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_076439.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-14T01:33:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29845",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29845#event-76439"
}
```



---

archive/issue_events_076440.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-14T01:33:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29845",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29845#event-76440"
}
```
