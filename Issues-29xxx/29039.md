# Issue 29039: pip-installable version of package sage_conf - installs non-Python bits of the Sage distribution in ~/.sage/

archive/issues_028802.json:
```json
{
    "body": "As #30913 makes **sage-conf** both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of **sage-conf** must be made available on PyPI.\n\nThis version of **sage-conf** includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n\nThere are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n\nTo test:\n\n```\n./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)\n```\nThis test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n\n```\n[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config\nVERSION=9.3.beta7\nMAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\nARB_LIBRARY=arb\nSAGE_NAUTY_BINS_PREFIX=\nCBLAS_PC_MODULES=cblas\nMATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\nTHREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\nSAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\nSAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\npython finish: run-test  after 0.17 seconds\n```\n\nTo build a source distribution:\n\n```\n./sage -sh -c build/pkgs/sage_conf/spkg-src\n```\n(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n\nFollow-up steps:\n- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n- Optionally, it would create a venv that is used for building wheels. \n- #30036: Make the build more incremental: On installation of **sage-conf**,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python distribution packages such as **sagemath-standard** to install packages if present.\n\n\n\nCC:  @jhpalmieri @dimpase @kiwifb @vbraun\n\nKeywords: sd111\n\nReviewer: Dima Pasechnik, Fran\u00e7ois Bissey\n\nAuthor: Matthias Koeppe\n\nBranch: 2a4a32384133408ef05edb4f40b9d363697d3087\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29039\n\n",
    "closed_at": "2021-12-29T21:43:11Z",
    "created_at": "2020-01-18T17:34:51Z",
    "labels": [
        "component: build",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "pip-installable version of package sage_conf - installs non-Python bits of the Sage distribution in ~/.sage/",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29039",
    "user": "https://github.com/mkoeppe"
}
```
As #30913 makes **sage-conf** both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of **sage-conf** must be made available on PyPI.

This version of **sage-conf** includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 

There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 

To test:

```
./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)
```
This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:

```
[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config
VERSION=9.3.beta7
MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
ARB_LIBRARY=arb
SAGE_NAUTY_BINS_PREFIX=
CBLAS_PC_MODULES=cblas
MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
python finish: run-test  after 0.17 seconds
```

To build a source distribution:

```
./sage -sh -c build/pkgs/sage_conf/spkg-src
```
(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)

Follow-up steps:
- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
- Optionally, it would create a venv that is used for building wheels. 
- #30036: Make the build more incremental: On installation of **sage-conf**,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python distribution packages such as **sagemath-standard** to install packages if present.



CC:  @jhpalmieri @dimpase @kiwifb @vbraun

Keywords: sd111

Reviewer: Dima Pasechnik, FranÃ§ois Bissey

Author: Matthias Koeppe

Branch: 2a4a32384133408ef05edb4f40b9d363697d3087

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29039





---

archive/issue_comments_433335.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,8 @@\n \n It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of a new Python package `sage_local`.\n \n-It also installs `sage_conf.py` (#29038) to enable installing a sagelib using that SAGE_LOCAL>\n+It also installs `sage_conf.py` (#29038) to enable installing a sagelib using that SAGE_LOCAL.\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-01-30T16:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433335",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,8 @@
 
 It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of a new Python package `sage_local`.
 
-It also installs `sage_conf.py` (#29038) to enable installing a sagelib using that SAGE_LOCAL>
+It also installs `sage_conf.py` (#29038) to enable installing a sagelib using that SAGE_LOCAL.
+
 
 Comment: 1
 
``````




---

archive/issue_events_073575.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-30T16:28:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73575"
}
```



---

archive/issue_events_073576.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T06:19:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73576"
}
```



---

archive/issue_events_073577.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T06:19:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73577"
}
```



---

archive/issue_comments_433336.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,8 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of the Python package `sage_bootstrap`.  The installed script `build/bin/sage-site` can be used by Python packages such as `sagelib` to install additional packages.\n+\n+It also installs `build/sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL.\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-06-28T06:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433336",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,8 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of the Python package `sage_bootstrap`.  The installed script `build/bin/sage-site` can be used by Python packages such as `sagelib` to install additional packages.
+
+It also installs `build/sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL.
 
 
 Comment: 1
``````




---

archive/issue_comments_433337.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,16 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of the Python package `sage_bootstrap`.  The installed script `build/bin/sage-site` can be used by Python packages such as `sagelib` to install additional packages.\n+\n+It also installs `build/sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL.\n+\n+Steps:\n+- Move `configure.ac`, `m4`, `config` into `build/`.  \n+- Leave behind a symlink `configure -> build/configure`. \n+- Split out `build/bootstrap` from `SAGE_ROOT/bootstrap`, call it from there.\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-06-28T22:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433337",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,16 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of the Python package `sage_bootstrap`.  The installed script `build/bin/sage-site` can be used by Python packages such as `sagelib` to install additional packages.
+
+It also installs `build/sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL.
+
+Steps:
+- Move `configure.ac`, `m4`, `config` into `build/`.  
+- Leave behind a symlink `configure -> build/configure`. 
+- Split out `build/bootstrap` from `SAGE_ROOT/bootstrap`, call it from there.
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433338.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of the Python package `sage_bootstrap`.  The installed script `build/bin/sage-site` can be used by Python packages such as `sagelib` to install additional packages.\n+\n+It also installs `build/sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL.\n+\n+Steps:\n+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-06-29T20:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433338",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy in the installed `package_data` of the Python package `sage_bootstrap`.  The installed script `build/bin/sage-site` can be used by Python packages such as `sagelib` to install additional packages.
+
+It also installs `build/sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL.
+
+Steps:
+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433339.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2020-06-29T22:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433339",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_comments_433340.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,18 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+\n+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.\n+\n+It also installs `sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL. (Or there could be a different installed configuration module such as `sage_bootstrap.config`.)\n+\n+\n+\n+Steps:\n+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-06-29T22:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433340",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,18 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+
+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.
+
+It also installs `sage_conf.py` (#29038) as a Python module to enable installing a sagelib using that SAGE_LOCAL. (Or there could be a different installed configuration module such as `sage_bootstrap.config`.)
+
+
+
+Steps:
+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433341.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-30T01:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433341",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433342.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-01T03:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433343.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-01T06:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433343",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433344.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,18 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+\n+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.\n+\n+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. \n+\n+\n+\n+Steps:\n+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-07-01T06:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433344",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,18 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+
+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.
+
+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. 
+
+
+
+Steps:
+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433345.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-03T06:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433345",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433346.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,21 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. \n+\n+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+\n+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.\n+\n+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. \n+\n+\n+\n+Steps:\n+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-09-17T03:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433346",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,21 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. 
+
+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+
+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.
+
+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. 
+
+
+
+Steps:
+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433347.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,22 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. \n+\n+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+\n+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.\n+\n+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. \n+\n+\n+\n+Steps:\n+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-09-17T04:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433347",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,22 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. 
+
+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+
+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.
+
+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. 
+
+
+
+Steps:
+- #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433348.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,22 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. \n+\n+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+\n+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.\n+\n+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. \n+\n+\n+\n+Steps:\n+- Optional: #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2020-11-07T01:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433348",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,22 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. 
+
+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+
+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.
+
+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. 
+
+
+
+Steps:
+- Optional: #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433349.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-11-26T01:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433349",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433350.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-26T04:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433351.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T17:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433351",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_433352.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,25 @@\n+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.\n+\n+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. \n+\n+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+\n+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.\n+\n+\n+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. \n+\n+\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires`, also a version of `sage_conf` must be made available on PyPI.\n+\n+\n+Steps:\n+- Optional: #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` \n+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. \n+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. \n \n \n Comment: 1\n``````\n",
    "created_at": "2021-01-20T21:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433352",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,25 @@
+This provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need.
+
+It establishes a python-less SAGE_LOCAL hierarchy either in the installed `package_data` of the Python package `sage_bootstrap`, or in `~/.sage/`, or something configured by the user (by passing `--prefix` to `setup.py`).  On installation, it only runs `configure` but does not install anything. 
+
+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+
+A Python entry point in `sage_bootstrap` can be used by Python packages such as `sagelib` to install packages if present.
+
+
+It also installs `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`) to enable installing a sagelib using that `SAGE_LOCAL`. 
+
+
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires`, also a version of `sage_conf` must be made available on PyPI.
+
+
+Steps:
+- Optional: #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Extend `build/MANIFEST.in` to include all files in `build`, including `build/pkgs` and `build/make` 
+- An sdist of `sage_bootstrap` will contain `configure`, just as an sdist of `sage_doc` will contain the files generated by `src/doc/bootstrap`. 
+- Exclude the symlinked `build/pkgs/sagelib/src/`, probably exclude all Python spkgs. 
 
 
 Comment: 1
``````




---

archive/issue_comments_433353.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-02-14T02:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_433354.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T07:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433354",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433355.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,20 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` runs includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**`. On installation (or wheel building) it runs `configure` and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. \n+\n+It establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` or something configured by the user (by passing `--prefix` to `setup.py`).  \n+\n+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+\n+Steps:\n+- Optional: #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`\n+- Exclude the symlinked `build/pkgs/sagelib/src/` via `MANIFEST.in`\n+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-14T07:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433355",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,20 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` runs includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**`. On installation (or wheel building) it runs `configure` and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. 
+
+It establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` or something configured by the user (by passing `--prefix` to `setup.py`).  
+
+- By default, instead of installing a copy of python3 or creating a venv, it would only run a python3 version check and would issue a warning if trying to install into a Python outside of the supported range.
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+
+Steps:
+- Optional: #30025: Clean up `SAGE_ROOT` directory by moving stuff into `SAGE_ROOT/build/`
+- Exclude the symlinked `build/pkgs/sagelib/src/` via `MANIFEST.in`
+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433356.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-02-14T07:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433356",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433357.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-02-14T07:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433357",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433358.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T08:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433359.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,24 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` runs includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**`. On installation (or wheel building) it runs `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. \n+\n+It establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/`.  \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && MAKE=\"make -j12\" tox -v -v -v)\n+```\n+\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-14T08:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433359",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,24 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` runs includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**`. On installation (or wheel building) it runs `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. 
+
+It establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/`.  
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && MAKE="make -j12" tox -v -v -v)
+```
+
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433360.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,22 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` runs includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**`. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && MAKE=\"make -j12\" tox -v -v -v)\n+```\n+\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-14T08:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433360",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,22 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` runs includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**`. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && MAKE="make -j12" tox -v -v -v)
+```
+
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433361.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-02-14T08:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433362.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T08:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433363.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T18:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433364.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T19:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433365.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,26 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n+```\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-14T19:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433365",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,26 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing sage-the-distribution that may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
+```
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433366.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-02-14T19:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433366",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_433367.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-02-14T19:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433367",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_433368.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,42 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-14T20:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433368",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,42 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433369.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T20:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433369",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433370.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,42 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-14T20:23:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433370",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,42 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433371.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T20:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433371",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433372.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T20:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433372",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433373.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-14T22:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433374.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-07T21:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433375.json:
```json
{
    "body": "<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-15T01:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433376.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-03-15T01:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433376",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_433377.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-15T02:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433378.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-15T03:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433378",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433379.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-24T06:20:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433379",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433380.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,43 @@\n+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-03-24T07:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433380",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,43 @@
+As #30913 makes `sage_conf` a PEP517/518 `build_system` `requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433381.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,43 @@\n+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-04-04T19:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433381",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,43 @@
+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433382.json:
```json
{
    "body": "<a id='comment:57'></a>what does the change to `build/pkgs/sagelib/src/MANIFEST.in` mean? is it becoming a symbolic link?",
    "created_at": "2021-04-09T08:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433382",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:57'></a>what does the change to `build/pkgs/sagelib/src/MANIFEST.in` mean? is it becoming a symbolic link?



---

archive/issue_comments_433383.json:
```json
{
    "body": "<a id='comment:58'></a>after merging 9.3.rc2 in, I get an error (is it from `sh: line 0: .: .homebrew-build-env: file not found`, cf below ?):\n\n```\n$ ./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n...\n    warning: no previously-included files matching '__pycache__' found anywhere in distribution\n    warning: no previously-included files matching '*.pyc' found anywhere in distribution\n    writing manifest file '/home/scratch2/dimpase/tmp/pip-modern-metadata-27nf1gz1/sage_conf.egg-info/SOURCES.txt'\n    creating '/home/scratch2/dimpase/tmp/pip-modern-metadata-27nf1gz1/sage_conf.dist-info'\n    Preparing wheel metadata ... done\n  Source in /home/scratch2/dimpase/tmp/pip-req-build-0rrkid61 has version 9.3rc2, which satisfies requirement sage-conf==9.3rc2 from file:///home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip\n  Removed sage-conf==9.3rc2 from file:///home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip from build tracker '/home/scratch2/dimpase/tmp/pip-req-tracker-bla_u_md'\nCreated temporary directory: /home/scratch2/dimpase/tmp/pip-unpack-rwlm13mn\nBuilding wheels for collected packages: sage-conf\n  Created temporary directory: /home/scratch2/dimpase/tmp/pip-wheel-k4duer3n\n  Destination directory: /home/scratch2/dimpase/tmp/pip-wheel-k4duer3n\n  Running command /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_vendor/pep517/_in_process.py build_wheel /home/scratch2/dimpase/tmp/tmpdhib0roj\n  running bdist_wheel\n  running build\n  running build_py\n  sh: line 0: .: .homebrew-build-env: file not found\n  Running cd /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu && . .homebrew-build-env 2>&1; : && ./configure --prefix=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local --with-python=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python --with-system-python3=force --disable-notebook --disable-sagelib\n  error: configure failed\n  Building wheel for sage-conf (PEP 517) ... error\n  ERROR: Failed building wheel for sage-conf\nFailed to build sage-conf\nERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nException information:\nTraceback (most recent call last):\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/commands/install.py\", line 361, in run\n    \", \".join(pep517_build_failure_names)\npip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nRemoved build tracker: '/home/scratch2/dimpase/tmp/pip-req-tracker-bla_u_md'\npython finish: installpkg after 3.39 seconds\npython start: envreport \nsetting PATH=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin\n  /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi$ /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip freeze >/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/log/python-3.log\npython finish: envreport after 0.20 seconds\npython installed: \n_________________________________________________________________________________________________ summary __________________________________________________________________________________________________\nERROR:   python: InvocationError for command '/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --no-deps -U -v /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip' (exited with code 1)\ncleanup /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip\n```",
    "created_at": "2021-04-09T09:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433383",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:58'></a>after merging 9.3.rc2 in, I get an error (is it from `sh: line 0: .: .homebrew-build-env: file not found`, cf below ?):

```
$ ./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
...
    warning: no previously-included files matching '__pycache__' found anywhere in distribution
    warning: no previously-included files matching '*.pyc' found anywhere in distribution
    writing manifest file '/home/scratch2/dimpase/tmp/pip-modern-metadata-27nf1gz1/sage_conf.egg-info/SOURCES.txt'
    creating '/home/scratch2/dimpase/tmp/pip-modern-metadata-27nf1gz1/sage_conf.dist-info'
    Preparing wheel metadata ... done
  Source in /home/scratch2/dimpase/tmp/pip-req-build-0rrkid61 has version 9.3rc2, which satisfies requirement sage-conf==9.3rc2 from file:///home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip
  Removed sage-conf==9.3rc2 from file:///home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip from build tracker '/home/scratch2/dimpase/tmp/pip-req-tracker-bla_u_md'
Created temporary directory: /home/scratch2/dimpase/tmp/pip-unpack-rwlm13mn
Building wheels for collected packages: sage-conf
  Created temporary directory: /home/scratch2/dimpase/tmp/pip-wheel-k4duer3n
  Destination directory: /home/scratch2/dimpase/tmp/pip-wheel-k4duer3n
  Running command /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_vendor/pep517/_in_process.py build_wheel /home/scratch2/dimpase/tmp/tmpdhib0roj
  running bdist_wheel
  running build
  running build_py
  sh: line 0: .: .homebrew-build-env: file not found
  Running cd /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu && . .homebrew-build-env 2>&1; : && ./configure --prefix=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local --with-python=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python --with-system-python3=force --disable-notebook --disable-sagelib
  error: configure failed
  Building wheel for sage-conf (PEP 517) ... error
  ERROR: Failed building wheel for sage-conf
Failed to build sage-conf
ERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Exception information:
Traceback (most recent call last):
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/commands/install.py", line 361, in run
    ", ".join(pep517_build_failure_names)
pip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Removed build tracker: '/home/scratch2/dimpase/tmp/pip-req-tracker-bla_u_md'
python finish: installpkg after 3.39 seconds
python start: envreport 
setting PATH=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin
  /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi$ /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip freeze >/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/log/python-3.log
python finish: envreport after 0.20 seconds
python installed: 
_________________________________________________________________________________________________ summary __________________________________________________________________________________________________
ERROR:   python: InvocationError for command '/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --no-deps -U -v /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip' (exited with code 1)
cleanup /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip
```



---

archive/issue_comments_433384.json:
```json
{
    "body": "<a id='comment:59'></a>this is on Fedora 30, in case it matters",
    "created_at": "2021-04-09T09:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433384",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:59'></a>this is on Fedora 30, in case it matters



---

archive/issue_comments_433385.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-09T09:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433385",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_433386.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:57 dimpase]:\n> what does the change to `build/pkgs/sagelib/src/MANIFEST.in` mean? is it becoming a symbolic link?\n\nYes, it was duplicated with `SAGE_ROOT/src/MANIFEST.in`, and I replaced it with a symlink",
    "created_at": "2021-04-09T16:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433386",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>Replying to [comment:57 dimpase]:
> what does the change to `build/pkgs/sagelib/src/MANIFEST.in` mean? is it becoming a symbolic link?

Yes, it was duplicated with `SAGE_ROOT/src/MANIFEST.in`, and I replaced it with a symlink



---

archive/issue_comments_433387.json:
```json
{
    "body": "<a id='comment:61'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-09T16:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433387",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:61'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433388.json:
```json
{
    "body": "<a id='comment:62'></a>Replying to [comment:58 dimpase]:\n> after merging 9.3.rc2 in, I get an error (is it from `sh: line 0: .: .homebrew-build-env: file not found`, cf below ?):\n> \n> ```\n> $ ./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)\n> ...\n\n\nThanks for testing! Is this running in a docker container? Not clear to me why the file would be missing. Anyway I have cherry-picked a related change from #31396 and made another change - please take a look if this gets farther",
    "created_at": "2021-04-09T16:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433388",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:62'></a>Replying to [comment:58 dimpase]:
> after merging 9.3.rc2 in, I get an error (is it from `sh: line 0: .: .homebrew-build-env: file not found`, cf below ?):
> 
> ```
> $ ./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)
> ...


Thanks for testing! Is this running in a docker container? Not clear to me why the file would be missing. Anyway I have cherry-picked a related change from #31396 and made another change - please take a look if this gets farther



---

archive/issue_comments_433389.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-04-09T16:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433389",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_433390.json:
```json
{
    "body": "<a id='comment:64'></a>no, still the same error:\n\n```\n...\nCreated temporary directory: /home/scratch2/dimpase/tmp/pip-unpack-169y8koj\nBuilding wheels for collected packages: sage-conf\n  Created temporary directory: /home/scratch2/dimpase/tmp/pip-wheel-exb6ynmx\n  Destination directory: /home/scratch2/dimpase/tmp/pip-wheel-exb6ynmx\n  Running command /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_vendor/pep517/_in_process.py build_wheel /home/scratch2/dimpase/tmp/tmpvehv3h0s\n  running bdist_wheel\n  running build\n  running build_py\n  sh: line 0: .: .homebrew-build-env: file not found\n  Running cd /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu && (. .homebrew-build-env 2>&1 || :) && ./configure --prefix=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local --with-python=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python --with-system-python3=force --disable-notebook --disable-sagelib\n  error: configure failed\n  Building wheel for sage-conf (PEP 517) ... error\n  ERROR: Failed building wheel for sage-conf\nFailed to build sage-conf\nERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nException information:\nTraceback (most recent call last):\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/commands/install.py\", line 361, in run\n    \", \".join(pep517_build_failure_names)\npip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nRemoved build tracker: '/home/scratch2/dimpase/tmp/pip-req-tracker-_6q2pk49'\npython finish: installpkg after 3.35 seconds\npython start: envreport \nsetting PATH=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin\n  /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi$ /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip freeze >/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/log/python-9.log\npython finish: envreport after 0.20 seconds\npython installed: \n__________________________________________________________________________ summary ___________________________________________________________________________\nERROR:   python: InvocationError for command '/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --no-deps -U -v /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip' (exited with code 1)\n```",
    "created_at": "2021-04-09T19:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433390",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:64'></a>no, still the same error:

```
...
Created temporary directory: /home/scratch2/dimpase/tmp/pip-unpack-169y8koj
Building wheels for collected packages: sage-conf
  Created temporary directory: /home/scratch2/dimpase/tmp/pip-wheel-exb6ynmx
  Destination directory: /home/scratch2/dimpase/tmp/pip-wheel-exb6ynmx
  Running command /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_vendor/pep517/_in_process.py build_wheel /home/scratch2/dimpase/tmp/tmpvehv3h0s
  running bdist_wheel
  running build
  running build_py
  sh: line 0: .: .homebrew-build-env: file not found
  Running cd /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu && (. .homebrew-build-env 2>&1 || :) && ./configure --prefix=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local --with-python=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python --with-system-python3=force --disable-notebook --disable-sagelib
  error: configure failed
  Building wheel for sage-conf (PEP 517) ... error
  ERROR: Failed building wheel for sage-conf
Failed to build sage-conf
ERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Exception information:
Traceback (most recent call last):
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pip/_internal/commands/install.py", line 361, in run
    ", ".join(pep517_build_failure_names)
pip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Removed build tracker: '/home/scratch2/dimpase/tmp/pip-req-tracker-_6q2pk49'
python finish: installpkg after 3.35 seconds
python start: envreport 
setting PATH=/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/libexec/python3-sphinx:/usr/lib64/qt-3.3/bin:/usr/share/Modules/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/users/dimpase/.cabal/bin:/auto/users/dimpase/bin
  /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi$ /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip freeze >/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/log/python-9.log
python finish: envreport after 0.20 seconds
python installed: 
__________________________________________________________________________ summary ___________________________________________________________________________
ERROR:   python: InvocationError for command '/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --no-deps -U -v /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3rc2.zip' (exited with code 1)
```



---

archive/issue_comments_433391.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-09T19:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433391",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_433392.json:
```json
{
    "body": "<a id='comment:66'></a>Could you show what's in `/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu`?",
    "created_at": "2021-04-09T19:33:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433392",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:66'></a>Could you show what's in `/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu`?



---

archive/issue_comments_433393.json:
```json
{
    "body": "<a id='comment:67'></a>\n```\n$ ls -la /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu\ntotal 1196\ndrwxr-xr-x 6 dimpase staff    4096 Apr  9 20:24 .\ndrwxr-xr-x 4 dimpase staff    4096 Apr  9 20:24 ..\n-rwxr-xr-x 1 dimpase staff      81 Apr  9 20:24 bootstrap\ndrwxr-xr-x 7 dimpase staff    4096 Apr  9 20:24 build\ndrwxr-xr-x 2 dimpase staff    4096 Apr  9 20:24 config\n-rwxr-xr-x 1 dimpase staff 1126829 Apr  9 20:24 configure\n-rw-r--r-- 1 dimpase staff   18020 Apr  9 20:24 configure.ac\n-rw-r--r-- 1 dimpase staff    1602 Apr  9 20:24 .homebrew-build-env\ndrwxr-xr-x 2 dimpase staff    4096 Apr  9 20:24 m4\n-rw-r--r-- 1 dimpase staff    9744 Apr  9 20:24 Makefile\n-rw-r--r-- 1 dimpase staff   20890 Apr  9 20:24 README.md\ndrwxr-xr-x 4 dimpase staff    4096 Apr  9 20:24 src\n-rw-r--r-- 1 dimpase staff      51 Apr  9 20:24 VERSION.txt\n```",
    "created_at": "2021-04-09T19:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433393",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:67'></a>
```
$ ls -la /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu
total 1196
drwxr-xr-x 6 dimpase staff    4096 Apr  9 20:24 .
drwxr-xr-x 4 dimpase staff    4096 Apr  9 20:24 ..
-rwxr-xr-x 1 dimpase staff      81 Apr  9 20:24 bootstrap
drwxr-xr-x 7 dimpase staff    4096 Apr  9 20:24 build
drwxr-xr-x 2 dimpase staff    4096 Apr  9 20:24 config
-rwxr-xr-x 1 dimpase staff 1126829 Apr  9 20:24 configure
-rw-r--r-- 1 dimpase staff   18020 Apr  9 20:24 configure.ac
-rw-r--r-- 1 dimpase staff    1602 Apr  9 20:24 .homebrew-build-env
drwxr-xr-x 2 dimpase staff    4096 Apr  9 20:24 m4
-rw-r--r-- 1 dimpase staff    9744 Apr  9 20:24 Makefile
-rw-r--r-- 1 dimpase staff   20890 Apr  9 20:24 README.md
drwxr-xr-x 4 dimpase staff    4096 Apr  9 20:24 src
-rw-r--r-- 1 dimpase staff      51 Apr  9 20:24 VERSION.txt
```



---

archive/issue_comments_433394.json:
```json
{
    "body": "<a id='comment:68'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-10T18:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433394",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433395.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-04-10T18:15:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433395",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_433396.json:
```json
{
    "body": "<a id='comment:70'></a>the dependent ticket is not merged in the branch, any reason for this?",
    "created_at": "2021-04-11T16:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433396",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:70'></a>the dependent ticket is not merged in the branch, any reason for this?



---

archive/issue_comments_433397.json:
```json
{
    "body": "<a id='comment:71'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-11T16:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433397",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:71'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433398.json:
```json
{
    "body": "<a id='comment:72'></a>Replying to [comment:70 dimpase]:\n> the dependent ticket is not merged in the branch, any reason for this?\n\nThanks for catching this, the latest version was not merged",
    "created_at": "2021-04-11T16:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433398",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:72'></a>Replying to [comment:70 dimpase]:
> the dependent ticket is not merged in the branch, any reason for this?

Thanks for catching this, the latest version was not merged



---

archive/issue_comments_433399.json:
```json
{
    "body": "<a id='comment:73'></a>Here on the ticket I am creating things in `src/pkgs/` but in #31577 I have a different proposal for the source layout, comments welcome",
    "created_at": "2021-04-11T16:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433399",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:73'></a>Here on the ticket I am creating things in `src/pkgs/` but in #31577 I have a different proposal for the source layout, comments welcome



---

archive/issue_comments_433400.json:
```json
{
    "body": "<a id='comment:74'></a>now I get a failure in building numpy, if I run\n`./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)`\nafter distclean.\n\n\n```\nUninstalling 'numpy' with legacy uninstaller\nPackage 'numpy' is currently not installed\nTraceback (most recent call last):\n  File \"../lapack_conf.py\", line 3, in <module>\n    import pkgconfig, os\nModuleNotFoundError: No module named 'pkgconfig'\n```\n\nand also weird error with cysignal:\n\n```\nchecking for std::atomic with OpenMP in C++ code... yes\nconfigure: creating ./config.status\nconfig.status: creating src/cysignals/signals.pxd\nconfig.status: creating src/config.h\nconfig.status: creating src/cysignals/cysignals_config.h\nconfigure: WARNING: unrecognized options: --disable-maintainer-mode, --disable-dependency-tracking\nInstalling cysignals-1.10.3\nWARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2310>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/\nWARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2690>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/\nWARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2890>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/\nWARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2ad0>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/\nWARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2d10>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/\nERROR: Could not find a version that satisfies the requirement Cython>=0.28\nERROR: No matching distribution found for Cython>=0.28\nTraceback (most recent call last):\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/installer.py\", line 75, in fetch_build_egg\n    subprocess.check_call(cmd)\n  File \"/usr/lib64/python3.7/subprocess.py\", line 363, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '['/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local/bin/python3', '-m', 'pip', '--disable-pip-version-check', 'wheel', '--no-deps', '-w', '/home/scratch2/dimpase/tmp/tmp772nb9rh', '--quiet', 'Cython>=0.28']' returned non-zero exit status 1.\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"setup.py\", line 152, in <module>\n    cmdclass=dict(build=build, bdist_egg=no_egg),\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/__init__.py\", line 152, in setup\n    _install_setup_requires(attrs)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/__init__.py\", line 147, in _install_setup_requires\n    dist.fetch_build_eggs(dist.setup_requires)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/dist.py\", line 724, in fetch_build_eggs\n    replace_conflicting=True,\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pkg_resources/__init__.py\", line 768, in resolve\n    replace_conflicting=replace_conflicting\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pkg_resources/__init__.py\", line 1051, in best_match\n    return self.obtain(req, installer)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pkg_resources/__init__.py\", line 1063, in obtain\n    return installer(requirement)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/dist.py\", line 780, in fetch_build_egg\n    return fetch_build_egg(self, req)\n  File \"/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/installer.py\", line 77, in fetch_build_egg\n    raise DistutilsError(str(e)) from e\ndistutils.errors.DistutilsError: Command '['/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local/bin/python3', '-m', 'pip', '--disable-pip-version-check', 'wheel', '--no-deps', '-w', '/home/scratch2/dimpase/tmp/tmp772nb9rh', '--quiet', 'Cython>=0.28']' returned non-zero exit status 1.\nError: could not determine package name\n```\n\ndependencies issue?",
    "created_at": "2021-04-11T18:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433400",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:74'></a>now I get a failure in building numpy, if I run
`./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -v -v -v)`
after distclean.


```
Uninstalling 'numpy' with legacy uninstaller
Package 'numpy' is currently not installed
Traceback (most recent call last):
  File "../lapack_conf.py", line 3, in <module>
    import pkgconfig, os
ModuleNotFoundError: No module named 'pkgconfig'
```

and also weird error with cysignal:

```
checking for std::atomic with OpenMP in C++ code... yes
configure: creating ./config.status
config.status: creating src/cysignals/signals.pxd
config.status: creating src/config.h
config.status: creating src/cysignals/cysignals_config.h
configure: WARNING: unrecognized options: --disable-maintainer-mode, --disable-dependency-tracking
Installing cysignals-1.10.3
WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2310>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/
WARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2690>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/
WARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2890>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/
WARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2ad0>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/
WARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectTimeoutError(<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7fda2cad2d10>, 'Connection to 192.0.2.0 timed out. (connect timeout=15)')': /simple/cython/
ERROR: Could not find a version that satisfies the requirement Cython>=0.28
ERROR: No matching distribution found for Cython>=0.28
Traceback (most recent call last):
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/installer.py", line 75, in fetch_build_egg
    subprocess.check_call(cmd)
  File "/usr/lib64/python3.7/subprocess.py", line 363, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '['/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local/bin/python3', '-m', 'pip', '--disable-pip-version-check', 'wheel', '--no-deps', '-w', '/home/scratch2/dimpase/tmp/tmp772nb9rh', '--quiet', 'Cython>=0.28']' returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "setup.py", line 152, in <module>
    cmdclass=dict(build=build, bdist_egg=no_egg),
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/__init__.py", line 152, in setup
    _install_setup_requires(attrs)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/__init__.py", line 147, in _install_setup_requires
    dist.fetch_build_eggs(dist.setup_requires)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/dist.py", line 724, in fetch_build_eggs
    replace_conflicting=True,
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pkg_resources/__init__.py", line 768, in resolve
    replace_conflicting=replace_conflicting
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pkg_resources/__init__.py", line 1051, in best_match
    return self.obtain(req, installer)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/pkg_resources/__init__.py", line 1063, in obtain
    return installer(requirement)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/dist.py", line 780, in fetch_build_egg
    return fetch_build_egg(self, req)
  File "/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.7/site-packages/setuptools/installer.py", line 77, in fetch_build_egg
    raise DistutilsError(str(e)) from e
distutils.errors.DistutilsError: Command '['/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local/bin/python3', '-m', 'pip', '--disable-pip-version-check', 'wheel', '--no-deps', '-w', '/home/scratch2/dimpase/tmp/tmp772nb9rh', '--quiet', 'Cython>=0.28']' returned non-zero exit status 1.
Error: could not determine package name
```

dependencies issue?



---

archive/issue_comments_433401.json:
```json
{
    "body": "<a id='comment:75'></a>Note that `make distclean` does not clean stuff in `.tox`, so if you want to start from scratch, use `tox -r`",
    "created_at": "2021-04-11T18:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433401",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:75'></a>Note that `make distclean` does not clean stuff in `.tox`, so if you want to start from scratch, use `tox -r`



---

archive/issue_comments_433402.json:
```json
{
    "body": "<a id='comment:76'></a>still, after successful `make build`, running the command in the ticket description ends with \n\n```\n  Error building Sage.\n\n  The following package(s) may have failed to build (not necessarily\n  during this run of 'make all-build'):\n\n  * package:         numpy-1.19.5\n    last build time: Apr 11 22:40\n    log file:        /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/logs/pkgs/numpy-1.19.5.log\n    build directory: /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local/var/tmp/sage/build/numpy-1.19.5\n\n```\nand in the numpy log I see\n\n```\nUninstalling 'numpy' with legacy uninstaller\nPackage 'numpy' is currently not installed\nTraceback (most recent call last):\n  File \"../lapack_conf.py\", line 3, in <module>\n    import pkgconfig, os\nModuleNotFoundError: No module named 'pkgconfig'\n\nreal    0m0.064s\nuser    0m0.049s\nsys     0m0.010s\n************************************************************************\nError installing package numpy-1.19.5\n``` \n\na race condition, `pkgconfig` is not installed yet?",
    "created_at": "2021-04-11T22:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433402",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:76'></a>still, after successful `make build`, running the command in the ticket description ends with 

```
  Error building Sage.

  The following package(s) may have failed to build (not necessarily
  during this run of 'make all-build'):

  * package:         numpy-1.19.5
    last build time: Apr 11 22:40
    log file:        /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/logs/pkgs/numpy-1.19.5.log
    build directory: /home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu/local/var/tmp/sage/build/numpy-1.19.5

```
and in the numpy log I see

```
Uninstalling 'numpy' with legacy uninstaller
Package 'numpy' is currently not installed
Traceback (most recent call last):
  File "../lapack_conf.py", line 3, in <module>
    import pkgconfig, os
ModuleNotFoundError: No module named 'pkgconfig'

real    0m0.064s
user    0m0.049s
sys     0m0.010s
************************************************************************
Error installing package numpy-1.19.5
``` 

a race condition, `pkgconfig` is not installed yet?



---

archive/issue_comments_433403.json:
```json
{
    "body": "<a id='comment:77'></a>and this\n\n```\n$ ./sage --python\nPython 3.7.7 (default, Mar 13 2020, 21:39:43) \n[GCC 9.2.1 20190827 (Red Hat 9.2.1-1)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import pkgconfig\n>>> \n```\nis OK. Is something weird happening with the Python while building numpy?",
    "created_at": "2021-04-11T22:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433403",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:77'></a>and this

```
$ ./sage --python
Python 3.7.7 (default, Mar 13 2020, 21:39:43) 
[GCC 9.2.1 20190827 (Red Hat 9.2.1-1)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import pkgconfig
>>> 
```
is OK. Is something weird happening with the Python while building numpy?



---

archive/issue_comments_433404.json:
```json
{
    "body": "<a id='comment:78'></a>Oh, I see. The script `lapack_conf.py` calls `sage-bootstrap-python`, which is not Sage's python in this case, it's a python2.\n\n```\nclpc171[/home/scratch2/dimpase/sage/sage]$ ./sage --buildsh\n\nStarting subshell with Sage environment variables set.  Don't forget\nto exit when you are done.  Beware:\n * Do not do anything with other copies of Sage on your system.\n * Do not use this for installing Sage packages using \"sage -i\" or for\n   running \"make\" at Sage's root directory.  These should be done\n   outside the Sage shell.\n\nBypassing shell configuration files...\n\nNote: SAGE_ROOT=/home/scratch2/dimpase/sage/sage\n(sage-buildsh) dimpase@clpc171:sage$ sage-bootstrap-python \nPython 2.7.18 (default, Apr 21 2020, 18:49:31) \n[GCC 9.3.1 20200408 (Red Hat 9.3.1-2)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> \n```",
    "created_at": "2021-04-11T23:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433404",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:78'></a>Oh, I see. The script `lapack_conf.py` calls `sage-bootstrap-python`, which is not Sage's python in this case, it's a python2.

```
clpc171[/home/scratch2/dimpase/sage/sage]$ ./sage --buildsh

Starting subshell with Sage environment variables set.  Don't forget
to exit when you are done.  Beware:
 * Do not do anything with other copies of Sage on your system.
 * Do not use this for installing Sage packages using "sage -i" or for
   running "make" at Sage's root directory.  These should be done
   outside the Sage shell.

Bypassing shell configuration files...

Note: SAGE_ROOT=/home/scratch2/dimpase/sage/sage
(sage-buildsh) dimpase@clpc171:sage$ sage-bootstrap-python 
Python 2.7.18 (default, Apr 21 2020, 18:49:31) 
[GCC 9.3.1 20200408 (Red Hat 9.3.1-2)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```



---

archive/issue_comments_433405.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-11T23:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433405",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_433406.json:
```json
{
    "body": "<a id='comment:80'></a>That's really something that we need to fix in a separate ticket!",
    "created_at": "2021-04-11T23:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433406",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:80'></a>That's really something that we need to fix in a separate ticket!



---

archive/issue_comments_433407.json:
```json
{
    "body": "<a id='comment:81'></a>No, actually `spkg-install.in` calls `python3`.",
    "created_at": "2021-04-11T23:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433407",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:81'></a>No, actually `spkg-install.in` calls `python3`.



---

archive/issue_comments_433408.json:
```json
{
    "body": "<a id='comment:82'></a>You are interacting with the wrong SAGE_ROOT, by the way. The relevant `SAGE_ROOT` is `/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu`. What's happening in `/home/scratch2/dimpase/sage/sage` is irrelevant.",
    "created_at": "2021-04-11T23:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433408",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:82'></a>You are interacting with the wrong SAGE_ROOT, by the way. The relevant `SAGE_ROOT` is `/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu`. What's happening in `/home/scratch2/dimpase/sage/sage` is irrelevant.



---

archive/issue_comments_433409.json:
```json
{
    "body": "<a id='comment:83'></a>Replying to [comment:81 mkoeppe]:\n> No, actually `spkg-install.in` calls `python3`.\n\n\nwell, it calls the failing `lapack_conf.py`, which prescribes a different Python.",
    "created_at": "2021-04-12T08:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433409",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:83'></a>Replying to [comment:81 mkoeppe]:
> No, actually `spkg-install.in` calls `python3`.


well, it calls the failing `lapack_conf.py`, which prescribes a different Python.



---

archive/issue_comments_433410.json:
```json
{
    "body": "<a id='comment:84'></a>See #31663, where I explain this in more detail",
    "created_at": "2021-04-12T16:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433410",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:84'></a>See #31663, where I explain this in more detail



---

archive/issue_comments_433411.json:
```json
{
    "body": "<a id='comment:85'></a>Replying to [comment:82 mkoeppe]:\n> You are interacting with the wrong SAGE_ROOT, by the way. The relevant `SAGE_ROOT` is `/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu`. What's happening in `/home/scratch2/dimpase/sage/sage` is irrelevant.\n\n\nOK, so I guess here is the test showing that `pkgconfig` module is not there\n(I `cd` to the said `SAGE_ROOT` and run `./local/bin/python3` there):\n\n```\nclpc171[/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu]$ ./local/bin/python3\nPython 3.7.7 (default, Mar 13 2020, 21:39:43) \n[GCC 9.2.1 20190827 (Red Hat 9.2.1-1)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import pkgconfig\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nModuleNotFoundError: No module named 'pkgconfig'\n```\n\n(and the same import works for the \"usual\" SAGE_ROOT just fine)",
    "created_at": "2021-04-12T22:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433411",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:85'></a>Replying to [comment:82 mkoeppe]:
> You are interacting with the wrong SAGE_ROOT, by the way. The relevant `SAGE_ROOT` is `/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu`. What's happening in `/home/scratch2/dimpase/sage/sage` is irrelevant.


OK, so I guess here is the test showing that `pkgconfig` module is not there
(I `cd` to the said `SAGE_ROOT` and run `./local/bin/python3` there):

```
clpc171[/home/scratch2/dimpase/sage/sage/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.rc2-cpython-37m-x86_64-linux-gnu]$ ./local/bin/python3
Python 3.7.7 (default, Mar 13 2020, 21:39:43) 
[GCC 9.2.1 20190827 (Red Hat 9.2.1-1)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import pkgconfig
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ModuleNotFoundError: No module named 'pkgconfig'
```

(and the same import works for the "usual" SAGE_ROOT just fine)



---

archive/issue_comments_433412.json:
```json
{
    "body": "<a id='comment:86'></a>If I pip-install `pkgconfig` and `cython` in the correct SAGE_ROOT, then tox run gets through numpy install just fine, but fails later in a similar way on pplpy.\n\nI guess dependency resolution is shot, or there is a race somewhere, leading to wrong order of installations.",
    "created_at": "2021-04-13T08:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433412",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:86'></a>If I pip-install `pkgconfig` and `cython` in the correct SAGE_ROOT, then tox run gets through numpy install just fine, but fails later in a similar way on pplpy.

I guess dependency resolution is shot, or there is a race somewhere, leading to wrong order of installations.



---

archive/issue_comments_433413.json:
```json
{
    "body": "<a id='comment:87'></a>Thanks for testing! This is very strange...",
    "created_at": "2021-04-13T15:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433413",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:87'></a>Thanks for testing! This is very strange...



---

archive/issue_events_073578.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-15T02:16:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73578"
}
```



---

archive/issue_events_073579.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-15T02:16:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73579"
}
```



---

archive/issue_comments_433414.json:
```json
{
    "body": "<a id='comment:89'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-11T03:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433415.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-11T17:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433415",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_433416.json:
```json
{
    "body": "<a id='comment:90'></a>It may be worth testing whether at least the built source distribution (https://pypi.org/project/sagemath-standard/) works for you as advertised.",
    "created_at": "2021-05-11T17:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433416",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:90'></a>It may be worth testing whether at least the built source distribution (https://pypi.org/project/sagemath-standard/) works for you as advertised.



---

archive/issue_comments_433417.json:
```json
{
    "body": "<a id='comment:91'></a>it seems to parallelize `make` too aggressively. Just had to reboot a machine I tried this on.\nNamely, `top` shows a massive number of `make` instances launched, hundreds. The log is full of\n\n```\nmake[20]: warning: -j4 forced in submake: resetting jobserver mode.\n  make -j4 build/make/Makefile --stop\n```\n\n\n\nAlso, the 1st attempt to run `tox -v -v -v` failed with a message like \"packages PEP <something>\nare not directly installable\" (or something like this). I just started it again, and it went on.",
    "created_at": "2021-05-12T09:43:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433417",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:91'></a>it seems to parallelize `make` too aggressively. Just had to reboot a machine I tried this on.
Namely, `top` shows a massive number of `make` instances launched, hundreds. The log is full of

```
make[20]: warning: -j4 forced in submake: resetting jobserver mode.
  make -j4 build/make/Makefile --stop
```



Also, the 1st attempt to run `tox -v -v -v` failed with a message like "packages PEP <something>
are not directly installable" (or something like this). I just started it again, and it went on.



---

archive/issue_comments_433418.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,43 @@\n+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -r -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-05-12T19:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433418",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,43 @@
+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -r -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433419.json:
```json
{
    "body": "<a id='comment:93'></a>Replying to [comment:91 dimpase]:\n> it seems to parallelize `make` too aggressively. Just had to reboot a machine I tried this on.\n\nThis sounds more like an infinite \"make\" recursion. Could you remove the setting of `-j` from `src/pkgs/sage_conf-pypi/setup.py` (and from your environment) and try what it does then?",
    "created_at": "2021-05-12T19:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433419",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:93'></a>Replying to [comment:91 dimpase]:
> it seems to parallelize `make` too aggressively. Just had to reboot a machine I tried this on.

This sounds more like an infinite "make" recursion. Could you remove the setting of `-j` from `src/pkgs/sage_conf-pypi/setup.py` (and from your environment) and try what it does then?



---

archive/issue_comments_433420.json:
```json
{
    "body": "<a id='comment:94'></a>I still quickly get `make` completely taking over the machine:\n\n```\n$ ps -def | grep make | wc -l\n1797\n```\neven after\n\n```diff\ndiff --git a/src/pkgs/sage_conf-pypi/setup.py b/src/pkgs/sage_conf-pypi/setup.py\nindex b7646224d6..8ee7211104 100644\n--- a/src/pkgs/sage_conf-pypi/setup.py\n+++ b/src/pkgs/sage_conf-pypi/setup.py\n@@ -52,7 +52,7 @@ class build_py(distutils_build_py):\n         # but then a user could use \"make build-venv\" to build compatible wheels for all Python packages.\n         # TODO: A target to only build wheels of tricky packages\n         # (that use native libraries shared with other packages).\n-        SETMAKE = 'if [ -z \"$MAKE\" ]; then export MAKE=\"make -j$(PATH=build/bin:$PATH build/bin/sage-build-num-threads | cut -d\" \" -f 2)\"; fi'\n+        SETMAKE = 'if [ -z \"$MAKE\" ]; then export MAKE=\"make\"; fi'\n         cmd = f'cd {SAGE_ROOT} && {SETENV} && {SETMAKE} && $MAKE V=0 build'\n         if os.system(cmd) != 0:\n             raise DistutilsSetupError(\"make build-local failed\")\n```\nno more `warning: -j4 forced in submake: resetting jobserver mode` seen, but that's not the root cause. This is with make 4.3.",
    "created_at": "2021-05-13T09:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433420",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:94'></a>I still quickly get `make` completely taking over the machine:

```
$ ps -def | grep make | wc -l
1797
```
even after

```diff
diff --git a/src/pkgs/sage_conf-pypi/setup.py b/src/pkgs/sage_conf-pypi/setup.py
index b7646224d6..8ee7211104 100644
--- a/src/pkgs/sage_conf-pypi/setup.py
+++ b/src/pkgs/sage_conf-pypi/setup.py
@@ -52,7 +52,7 @@ class build_py(distutils_build_py):
         # but then a user could use "make build-venv" to build compatible wheels for all Python packages.
         # TODO: A target to only build wheels of tricky packages
         # (that use native libraries shared with other packages).
-        SETMAKE = 'if [ -z "$MAKE" ]; then export MAKE="make -j$(PATH=build/bin:$PATH build/bin/sage-build-num-threads | cut -d" " -f 2)"; fi'
+        SETMAKE = 'if [ -z "$MAKE" ]; then export MAKE="make"; fi'
         cmd = f'cd {SAGE_ROOT} && {SETENV} && {SETMAKE} && $MAKE V=0 build'
         if os.system(cmd) != 0:
             raise DistutilsSetupError("make build-local failed")
```
no more `warning: -j4 forced in submake: resetting jobserver mode` seen, but that's not the root cause. This is with make 4.3.



---

archive/issue_comments_433421.json:
```json
{
    "body": "<a id='comment:95'></a>It could be that some wrong links are created by git; if I try to pull this branch I get\n\n```\nCONFLICT (directory/file): There is a directory with name build/pkgs/sage_conf/src in HEAD. Adding build/pkgs/sage_conf/src as build/pkgs/sage_conf/src~df2f8d11a2d204b5e5197b968ab1bb8e62486508\nAutomatic merge failed; fix conflicts and then commit the result.\n```\nand perhaps I didn't fix conflicts correctly.\n\nIt would be good to have something rebased on the develop branch here.",
    "created_at": "2021-05-13T10:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433421",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:95'></a>It could be that some wrong links are created by git; if I try to pull this branch I get

```
CONFLICT (directory/file): There is a directory with name build/pkgs/sage_conf/src in HEAD. Adding build/pkgs/sage_conf/src as build/pkgs/sage_conf/src~df2f8d11a2d204b5e5197b968ab1bb8e62486508
Automatic merge failed; fix conflicts and then commit the result.
```
and perhaps I didn't fix conflicts correctly.

It would be good to have something rebased on the develop branch here.



---

archive/issue_comments_433422.json:
```json
{
    "body": "<a id='comment:96'></a>OK, on a clean tree checkout I don't get the make issues. Apologies.",
    "created_at": "2021-05-13T13:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433422",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:96'></a>OK, on a clean tree checkout I don't get the make issues. Apologies.



---

archive/issue_comments_433423.json:
```json
{
    "body": "<a id='comment:97'></a>`./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -r -v -v -v)` seems to work, although I had to restart `tox -r -v -v -v` at some moment. Retrying after distclean, to see if I can reproduce this.\nI'm getting\n\n```\n make --no-print-directory polytopes_db-no-deps\n  sage-logger -p 'SAGE_CHECK=no sage-spkg   polytopes_db-20170220.p0' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/polytopes_db-20170220.p0.log'\n  [polytopes_db-20170220.p0] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/polytopes_db-20170220.p0.log\n    [polytopes_db-20170220.p0] successfully installed.\n  make --no-print-directory singular-no-deps\n  sage-logger -p 'SAGE_CHECK=no sage-spkg   singular-4.2.0p1+2021-04-06+sage' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log'\n  [singular-4.2.0p1+2021-04-06+sage] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log\n    [palp-2.11] successfully installed.\n  make --no-print-directory ratpoints-no-deps\n  make[3]: *** No rule to make target '../pkgs/sage_conf/src/bin/sage-env-config', needed by '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local/var/lib/sage/installed/sage_conf-9.3'.  Stop.\n  make[3]: *** Waiting for unfinished jobs....\n  sage-logger -p 'SAGE_CHECK=no sage-spkg   ratpoints-2.1.3.p5' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log'\n  [ratpoints-2.1.3.p5] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log\n    [ratpoints-2.1.3.p5] successfully installed.\n    [ecl-21.2.1] successfully installed.\n    [gap-4.11.0.p1] successfully installed.\n    [singular-4.2.0p1+2021-04-06+sage] successfully installed.\n  make[2]: *** [Makefile:2150: all-build] Error 2\n  make[2]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/build/make'\n\n  real\t9m41.134s\n  user\t24m26.005s\n  sys\t1m57.351s\n  ***************************************************************\n  Error building Sage.\n\n  The following package(s) may have failed to build (not necessarily\n  during this run of 'make all-build'):\n\n  It is safe to delete any log files and build directories, but they\n  contain information that is helpful for debugging build problems.\n  WARNING: If you now run 'make' again, the build directory of the\n  same version of the package will, by default, be deleted. Set the\n  environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.\n\n  make[1]: *** [Makefile:39: all-build] Error 1\n  make[1]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu'\n  make: *** [Makefile:16: build] Error 2\n  Running cd /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local --with-python=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python --enable-build-as-root --with-system-python3=force --disable-notebook --disable-sagelib\n  error: make build-local failed\n  Building wheel for sage-conf (PEP 517) ... error\n  ERROR: Failed building wheel for sage-conf\nFailed to build sage-conf\nERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nException information:\nTraceback (most recent call last):\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/commands/install.py\", line 358, in run\n    raise InstallationError(\npip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nWARNING: You are using pip version 21.0.1; however, version 21.1.1 is available.\nYou should consider upgrading via the '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --upgrade pip' command.\nRemoved build tracker: '/tmp/pip-req-tracker-edpp7niq'\nERROR: invocation failed (exit code 1)\npython finish: installpkg /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip after 622.22 seconds\n_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\nERROR:   python: InvocationError for command /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --exists-action w -v .tox/.tmp/package/1/sage_conf-9.3.zip (exited with code 1)\ncleanup /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip\n```\n\nAt this point I can just start `tox -r -v -v -v` again, and it happily continues.\nNot sure whether the final result is correct. \n\nAnyway, the error isn't good.\nLooks like a bit of an error in a make rule, it tries to make `../pkgs/sage_conf/src/bin/sage-env-config`.",
    "created_at": "2021-05-13T13:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433423",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:97'></a>`./bootstrap && (cd src/pkgs/sage_conf-pypi/ && tox -r -v -v -v)` seems to work, although I had to restart `tox -r -v -v -v` at some moment. Retrying after distclean, to see if I can reproduce this.
I'm getting

```
 make --no-print-directory polytopes_db-no-deps
  sage-logger -p 'SAGE_CHECK=no sage-spkg   polytopes_db-20170220.p0' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/polytopes_db-20170220.p0.log'
  [polytopes_db-20170220.p0] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/polytopes_db-20170220.p0.log
    [polytopes_db-20170220.p0] successfully installed.
  make --no-print-directory singular-no-deps
  sage-logger -p 'SAGE_CHECK=no sage-spkg   singular-4.2.0p1+2021-04-06+sage' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log'
  [singular-4.2.0p1+2021-04-06+sage] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log
    [palp-2.11] successfully installed.
  make --no-print-directory ratpoints-no-deps
  make[3]: *** No rule to make target '../pkgs/sage_conf/src/bin/sage-env-config', needed by '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local/var/lib/sage/installed/sage_conf-9.3'.  Stop.
  make[3]: *** Waiting for unfinished jobs....
  sage-logger -p 'SAGE_CHECK=no sage-spkg   ratpoints-2.1.3.p5' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log'
  [ratpoints-2.1.3.p5] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log
    [ratpoints-2.1.3.p5] successfully installed.
    [ecl-21.2.1] successfully installed.
    [gap-4.11.0.p1] successfully installed.
    [singular-4.2.0p1+2021-04-06+sage] successfully installed.
  make[2]: *** [Makefile:2150: all-build] Error 2
  make[2]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/build/make'

  real	9m41.134s
  user	24m26.005s
  sys	1m57.351s
  ***************************************************************
  Error building Sage.

  The following package(s) may have failed to build (not necessarily
  during this run of 'make all-build'):

  It is safe to delete any log files and build directories, but they
  contain information that is helpful for debugging build problems.
  WARNING: If you now run 'make' again, the build directory of the
  same version of the package will, by default, be deleted. Set the
  environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.

  make[1]: *** [Makefile:39: all-build] Error 1
  make[1]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu'
  make: *** [Makefile:16: build] Error 2
  Running cd /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local --with-python=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python --enable-build-as-root --with-system-python3=force --disable-notebook --disable-sagelib
  error: make build-local failed
  Building wheel for sage-conf (PEP 517) ... error
  ERROR: Failed building wheel for sage-conf
Failed to build sage-conf
ERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Exception information:
Traceback (most recent call last):
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/commands/install.py", line 358, in run
    raise InstallationError(
pip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
WARNING: You are using pip version 21.0.1; however, version 21.1.1 is available.
You should consider upgrading via the '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --upgrade pip' command.
Removed build tracker: '/tmp/pip-req-tracker-edpp7niq'
ERROR: invocation failed (exit code 1)
python finish: installpkg /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip after 622.22 seconds
_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
ERROR:   python: InvocationError for command /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --exists-action w -v .tox/.tmp/package/1/sage_conf-9.3.zip (exited with code 1)
cleanup /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip
```

At this point I can just start `tox -r -v -v -v` again, and it happily continues.
Not sure whether the final result is correct. 

Anyway, the error isn't good.
Looks like a bit of an error in a make rule, it tries to make `../pkgs/sage_conf/src/bin/sage-env-config`.



---

archive/issue_comments_433424.json:
```json
{
    "body": "<a id='comment:98'></a>After the restart, I see again\n\n```\nmake[3]: *** No rule to make target '../pkgs/sage_conf/src/bin/sage-env-config', needed by '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local/var/lib/sage/installed/sage_conf-9.3'.  Stop.\n  make[3]: *** Waiting for unfinished jobs....\n```\nbut it does not lead to (immediate) termination.",
    "created_at": "2021-05-13T13:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433424",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:98'></a>After the restart, I see again

```
make[3]: *** No rule to make target '../pkgs/sage_conf/src/bin/sage-env-config', needed by '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local/var/lib/sage/installed/sage_conf-9.3'.  Stop.
  make[3]: *** Waiting for unfinished jobs....
```
but it does not lead to (immediate) termination.



---

archive/issue_comments_433425.json:
```json
{
    "body": "<a id='comment:99'></a>after a while it then errors out with already mentioned\n\n```\nFailed to build sage-conf\nERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\n```\nin more detail:\n\n```\n...\n  [singular-4.2.0p1+2021-04-06+sage] successfully installed.\n  make[2]: *** [Makefile:2150: all-build] Error 2\n  make[2]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/build/make'\n\n  real\t10m35.056s\n  user\t24m37.840s\n  sys\t2m0.611s\n  ***************************************************************\n  Error building Sage.\n\n  The following package(s) may have failed to build (not necessarily\n  during this run of 'make all-build'):\n\n  It is safe to delete any log files and build directories, but they\n  contain information that is helpful for debugging build problems.\n  WARNING: If you now run 'make' again, the build directory of the\n  same version of the package will, by default, be deleted. Set the\n  environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.\n\n  make[1]: *** [Makefile:39: all-build] Error 1\n  make[1]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu'\n  make: *** [Makefile:16: build] Error 2\n  Running cd /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local --with-python=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python --enable-build-as-root --with-system-python3=force --disable-notebook --disable-sagelib\n  error: make build-local failed\n  Building wheel for sage-conf (PEP 517) ... error\n  ERROR: Failed building wheel for sage-conf\nFailed to build sage-conf\nERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nException information:\nTraceback (most recent call last):\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/commands/install.py\", line 358, in run\n    raise InstallationError(\npip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nWARNING: You are using pip version 21.0.1; however, version 21.1.1 is available.\nYou should consider upgrading via the '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --upgrade pip' command.\nRemoved build tracker: '/tmp/pip-req-tracker-u1_zy58f'\nERROR: invocation failed (exit code 1)\npython finish: installpkg /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip after 675.89 seconds\n_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\nERROR:   python: InvocationError for command /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --exists-action w -v .tox/.tmp/package/1/sage_conf-9.3.zip (exited with code 1)\ncleanup /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip",
    "created_at": "2021-05-13T14:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433425",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:99'></a>after a while it then errors out with already mentioned

```
Failed to build sage-conf
ERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
```
in more detail:

```
...
  [singular-4.2.0p1+2021-04-06+sage] successfully installed.
  make[2]: *** [Makefile:2150: all-build] Error 2
  make[2]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/build/make'

  real	10m35.056s
  user	24m37.840s
  sys	2m0.611s
  ***************************************************************
  Error building Sage.

  The following package(s) may have failed to build (not necessarily
  during this run of 'make all-build'):

  It is safe to delete any log files and build directories, but they
  contain information that is helpful for debugging build problems.
  WARNING: If you now run 'make' again, the build directory of the
  same version of the package will, by default, be deleted. Set the
  environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.

  make[1]: *** [Makefile:39: all-build] Error 1
  make[1]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu'
  make: *** [Makefile:16: build] Error 2
  Running cd /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local --with-python=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python --enable-build-as-root --with-system-python3=force --disable-notebook --disable-sagelib
  error: make build-local failed
  Building wheel for sage-conf (PEP 517) ... error
  ERROR: Failed building wheel for sage-conf
Failed to build sage-conf
ERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Exception information:
Traceback (most recent call last):
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/commands/install.py", line 358, in run
    raise InstallationError(
pip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
WARNING: You are using pip version 21.0.1; however, version 21.1.1 is available.
You should consider upgrading via the '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --upgrade pip' command.
Removed build tracker: '/tmp/pip-req-tracker-u1_zy58f'
ERROR: invocation failed (exit code 1)
python finish: installpkg /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip after 675.89 seconds
_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
ERROR:   python: InvocationError for command /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --exists-action w -v .tox/.tmp/package/1/sage_conf-9.3.zip (exited with code 1)
cleanup /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip



---

archive/issue_comments_433426.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-13T15:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433426",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_433427.json:
```json
{
    "body": "<a id='comment:0'></a>No, no matter how many times I restart tox, it errors out with \n\n```\nmake --no-print-directory singular-no-deps\n  sage-logger -p 'SAGE_CHECK=no sage-spkg   singular-4.2.0p1+2021-04-06+sage' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log'\n  [singular-4.2.0p1+2021-04-06+sage] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log\n    [palp-2.11] successfully installed.\n  make --no-print-directory ratpoints-no-deps\n  make[3]: *** No rule to make target '../pkgs/sage_conf/src/bin/sage-env-config', needed by '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local/var/lib/sage/installed/sage_conf-9.3'.  Stop.\n  make[3]: *** Waiting for unfinished jobs....\n  sage-logger -p 'SAGE_CHECK=no sage-spkg   ratpoints-2.1.3.p5' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log'\n  [ratpoints-2.1.3.p5] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log\n    [ratpoints-2.1.3.p5] successfully installed.\n    [ecl-21.2.1] successfully installed.\n    [gap-4.11.0.p1] successfully installed.\n    [singular-4.2.0p1+2021-04-06+sage] successfully installed.\n  make[2]: *** [Makefile:2150: all-build] Error 2\n  make[2]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/build/make'\n\n  real\t9m16.619s\n  user\t23m45.919s\n  sys\t1m54.965s\n  ***************************************************************\n  Error building Sage.\n\n  The following package(s) may have failed to build (not necessarily\n  during this run of 'make all-build'):\n\n  It is safe to delete any log files and build directories, but they\n  contain information that is helpful for debugging build problems.\n  WARNING: If you now run 'make' again, the build directory of the\n  same version of the package will, by default, be deleted. Set the\n  environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.\n\n  make[1]: *** [Makefile:39: all-build] Error 1\n  make[1]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu'\n  make: *** [Makefile:16: build] Error 2\n  Running cd /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local --with-python=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python --enable-build-as-root --with-system-python3=force --disable-notebook --disable-sagelib\n  error: make build-local failed\n  Building wheel for sage-conf (PEP 517) ... error\n  ERROR: Failed building wheel for sage-conf\nFailed to build sage-conf\nERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nException information:\nTraceback (most recent call last):\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/commands/install.py\", line 358, in run\n    raise InstallationError(\npip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly\nWARNING: You are using pip version 21.0.1; however, version 21.1.1 is available.\nYou should consider upgrading via the '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --upgrade pip' command.\nRemoved build tracker: '/tmp/pip-req-tracker-9ti8dn54'\nERROR: invocation failed (exit code 1)\npython finish: installpkg /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip after 597.56 seconds\n_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\nERROR:   python: InvocationError for command /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --exists-action w -v .tox/.tmp/package/1/sage_conf-9.3.zip (exited with code 1)\ncleanup /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip\n```",
    "created_at": "2021-05-13T15:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433427",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>No, no matter how many times I restart tox, it errors out with 

```
make --no-print-directory singular-no-deps
  sage-logger -p 'SAGE_CHECK=no sage-spkg   singular-4.2.0p1+2021-04-06+sage' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log'
  [singular-4.2.0p1+2021-04-06+sage] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/singular-4.2.0p1+2021-04-06+sage.log
    [palp-2.11] successfully installed.
  make --no-print-directory ratpoints-no-deps
  make[3]: *** No rule to make target '../pkgs/sage_conf/src/bin/sage-env-config', needed by '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local/var/lib/sage/installed/sage_conf-9.3'.  Stop.
  make[3]: *** Waiting for unfinished jobs....
  sage-logger -p 'SAGE_CHECK=no sage-spkg   ratpoints-2.1.3.p5' '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log'
  [ratpoints-2.1.3.p5] installing. Log file: /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/logs/pkgs/ratpoints-2.1.3.p5.log
    [ratpoints-2.1.3.p5] successfully installed.
    [ecl-21.2.1] successfully installed.
    [gap-4.11.0.p1] successfully installed.
    [singular-4.2.0p1+2021-04-06+sage] successfully installed.
  make[2]: *** [Makefile:2150: all-build] Error 2
  make[2]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/build/make'

  real	9m16.619s
  user	23m45.919s
  sys	1m54.965s
  ***************************************************************
  Error building Sage.

  The following package(s) may have failed to build (not necessarily
  during this run of 'make all-build'):

  It is safe to delete any log files and build directories, but they
  contain information that is helpful for debugging build problems.
  WARNING: If you now run 'make' again, the build directory of the
  same version of the package will, by default, be deleted. Set the
  environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.

  make[1]: *** [Makefile:39: all-build] Error 1
  make[1]: Leaving directory '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu'
  make: *** [Makefile:16: build] Error 2
  Running cd /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3-cpython-38-x86_64-linux-gnu/local --with-python=/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python --enable-build-as-root --with-system-python3=force --disable-notebook --disable-sagelib
  error: make build-local failed
  Building wheel for sage-conf (PEP 517) ... error
  ERROR: Failed building wheel for sage-conf
Failed to build sage-conf
ERROR: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
Exception information:
Traceback (most recent call last):
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/lib/python3.8/site-packages/pip/_internal/commands/install.py", line 358, in run
    raise InstallationError(
pip._internal.exceptions.InstallationError: Could not build wheels for sage-conf which use PEP 517 and cannot be installed directly
WARNING: You are using pip version 21.0.1; however, version 21.1.1 is available.
You should consider upgrading via the '/mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --upgrade pip' command.
Removed build tracker: '/tmp/pip-req-tracker-9ti8dn54'
ERROR: invocation failed (exit code 1)
python finish: installpkg /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip after 597.56 seconds
_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ summary __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
ERROR:   python: InvocationError for command /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/python/bin/python -m pip install --exists-action w -v .tox/.tmp/package/1/sage_conf-9.3.zip (exited with code 1)
cleanup /mnt/opt/Sage/sage-clang/src/pkgs/sage_conf-pypi/.tox/.tmp/package/1/sage_conf-9.3.zip
```



---

archive/issue_comments_433428.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-26T01:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433428",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433429.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-06T20:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433430.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-06-25T06:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433430",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433431.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-06-25T06:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433431",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_433432.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-06-25T06:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433433.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,43 @@\n+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels (#30527). \n+- Using #29013, it could support several python versions\n+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-06-25T06:28:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433433",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,43 @@
+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels (#30527). 
+- Using #29013, it could support several python versions
+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433434.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-25T18:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433434",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433435.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-25T19:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433435",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433436.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-25T19:31:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433436",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433437.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-25T20:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433438.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-25T20:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433438",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_433439.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-26T00:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433439",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433440.json:
```json
{
    "body": "<a id='comment:8'></a>I tried testing this over a recent pynac 0.7.28 branch, and it errors out as it apparently does not know how to pull upstream tarballs not from the mirrors. Missing `--enable-download-from-upstream-url` missing somewhere?",
    "created_at": "2021-06-28T13:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433440",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>I tried testing this over a recent pynac 0.7.28 branch, and it errors out as it apparently does not know how to pull upstream tarballs not from the mirrors. Missing `--enable-download-from-upstream-url` missing somewhere?



---

archive/issue_comments_433441.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-28T15:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433442.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-29T15:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433442",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433443.json:
```json
{
    "body": "<a id='comment:0'></a>OK, this works",
    "created_at": "2021-06-29T15:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433443",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:0'></a>OK, this works



---

archive/issue_comments_433444.json:
```json
{
    "body": "<a id='comment:1'></a>Thank you!",
    "created_at": "2021-06-29T15:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433444",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>Thank you!



---

archive/issue_comments_433445.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-07-01T22:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433445",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_433446.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-07-01T22:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433446",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_433447.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-01T22:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433447",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433448.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-01T22:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433448",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433449.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-07-24T19:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433449",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_433450.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-07-24T19:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_events_073580.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-24T19:26:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73580"
}
```



---

archive/issue_events_073581.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-24T19:26:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73581"
}
```



---

archive/issue_comments_433451.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-12T21:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433452.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-12T22:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433453.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-12T23:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433453",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433454.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-13T00:32:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433454",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433455.json:
```json
{
    "body": "<a id='comment:2'></a>To make it more user-friendly, on a failing configure it should display install instructions for build prereqs.\n\nOn a fresh Google Colab:\n\n```\n!pip install -v sage-conf\n...\n  configure: Sorry, the 'm4' command must be in the path to build Sage\n  configure: On some systems it can be found in /usr/ccs/bin\n  configure: See also http://www.gnu.org/software/m4/\n  configure: error: Exiting, as the macro processor 'm4' can not be found.\n  Running cd /root/.sage/sage-9.4-cpython-37m-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/root/.sage/sage-9.4-cpython-37m-x86_64-linux-gnu/local --with-python=/usr/bin/python3 --enable-build-as-root --enable-download-from-upstream-url --with-system-python3=force --disable-notebook --disable-sagelib\n  error: configure failed\n  Building wheel for sage-conf (PEP 517) ... error\n  ERROR: Failed building wheel for sage-conf\nFailed to build sage-conf\n```",
    "created_at": "2021-09-14T23:37:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433455",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>To make it more user-friendly, on a failing configure it should display install instructions for build prereqs.

On a fresh Google Colab:

```
!pip install -v sage-conf
...
  configure: Sorry, the 'm4' command must be in the path to build Sage
  configure: On some systems it can be found in /usr/ccs/bin
  configure: See also http://www.gnu.org/software/m4/
  configure: error: Exiting, as the macro processor 'm4' can not be found.
  Running cd /root/.sage/sage-9.4-cpython-37m-x86_64-linux-gnu && (. ./.homebrew-build-env 2> /dev/null || :) && ./configure --prefix=/root/.sage/sage-9.4-cpython-37m-x86_64-linux-gnu/local --with-python=/usr/bin/python3 --enable-build-as-root --enable-download-from-upstream-url --with-system-python3=force --disable-notebook --disable-sagelib
  error: configure failed
  Building wheel for sage-conf (PEP 517) ... error
  ERROR: Failed building wheel for sage-conf
Failed to build sage-conf
```



---

archive/issue_comments_433456.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-15T00:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433457.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-09-15T00:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433457",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433458.json:
```json
{
    "body": "<a id='comment:5'></a>Better now... but would be better with deferred configure exits (#32060).\n\n```\n  -----------------------------------------------------------------------------\n  Checking whether SageMath should install SPKG python3...\n  checking whether any of bzip2 xz libffi is installed as or will be installed as SPKG... yes; install python3 as well\n  configure: error: given --with-system-python3=force but no system package could be used\n  configure failed; this may be caused by missing build prerequisites.\n  You can install the required build prerequisites using the following shell command\n\n  sudo apt-get install  binutils make m4 perl python3 tar bc gcc g++ ca-certificates\n\n```",
    "created_at": "2021-09-15T00:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433458",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Better now... but would be better with deferred configure exits (#32060).

```
  -----------------------------------------------------------------------------
  Checking whether SageMath should install SPKG python3...
  checking whether any of bzip2 xz libffi is installed as or will be installed as SPKG... yes; install python3 as well
  configure: error: given --with-system-python3=force but no system package could be used
  configure failed; this may be caused by missing build prerequisites.
  You can install the required build prerequisites using the following shell command

  sudo apt-get install  binutils make m4 perl python3 tar bc gcc g++ ca-certificates

```



---

archive/issue_comments_433459.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-15T01:09:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433460.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-15T01:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433461.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T14:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433462.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-26T19:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433462",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433463.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-09-26T19:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433463",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_433464.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-26T19:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433464",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433465.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,42 @@\n+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.\n+\n+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels. \n+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-09-26T20:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433465",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,42 @@
+As #30913 makes `sage_conf` both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of `sage_conf` must be made available on PyPI.
+
+This version of `sage_conf` includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels. 
+- #30036: Make the build more incremental: On installation of `sage_conf`,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python packages such as `sagemath-standard` to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433466.json:
```json
{
    "body": "<a id='comment:8'></a>A little bit late at this stage to ask for stuff but here it goes. Would it be appropriate to split the file `sage_conf.py` into two parts? \n\nOne that would keep the name and contains the `main` function and doesn't need to be configured, and the second one that just contains the variables and that would be pre-parsed by configure.\n\nThe idea being that distro could just provide/configure the second file has they see fit without touching the functionality of the package. Although I am not sure what to do with `sage-env-config` yet in that scenario.",
    "created_at": "2021-09-27T21:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433466",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>A little bit late at this stage to ask for stuff but here it goes. Would it be appropriate to split the file `sage_conf.py` into two parts? 

One that would keep the name and contains the `main` function and doesn't need to be configured, and the second one that just contains the variables and that would be pre-parsed by configure.

The idea being that distro could just provide/configure the second file has they see fit without touching the functionality of the package. Although I am not sure what to do with `sage-env-config` yet in that scenario.



---

archive/issue_comments_433467.json:
```json
{
    "body": "<a id='comment:9'></a>Yes, this makes sense but I think it would be best done in a follow-up ticket to this ticket and to #31396. Basically a bit of refactoring for the three versions of `sage_conf`.",
    "created_at": "2021-09-27T22:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433467",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Yes, this makes sense but I think it would be best done in a follow-up ticket to this ticket and to #31396. Basically a bit of refactoring for the three versions of `sage_conf`.



---

archive/issue_comments_433468.json:
```json
{
    "body": "<a id='comment:0'></a>I can wait for that but that would go a long way to ease my adopting it as a new package. \n\nI am working on splitting sage in sage-on-gentoo on similar lines with some success. I now have a separate sage_setup and sage_docbuild -mostly with the idea that they can be usable by downstream sage package like flatsurf and snappy that I am looking at packaging experimentally. And in the next beta we can expect to have a separate sage-doc to debut. Well \"re-debut\", it used to be a separate package 10 years ago before I brought back everything in a single coherent unit. Fells a bit like a trip back in time but we are definitely not in the same place as then.",
    "created_at": "2021-09-27T22:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433468",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>I can wait for that but that would go a long way to ease my adopting it as a new package. 

I am working on splitting sage in sage-on-gentoo on similar lines with some success. I now have a separate sage_setup and sage_docbuild -mostly with the idea that they can be usable by downstream sage package like flatsurf and snappy that I am looking at packaging experimentally. And in the next beta we can expect to have a separate sage-doc to debut. Well "re-debut", it used to be a separate package 10 years ago before I brought back everything in a single coherent unit. Fells a bit like a trip back in time but we are definitely not in the same place as then.



---

archive/issue_comments_433469.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-28T00:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433470.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-09-28T00:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433470",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_433471.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,42 @@\n+As #30913 makes **sage-conf** both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of **sage-conf** must be made available on PyPI.\n+\n+This version of **sage-conf** includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). \n+\n+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. \n+\n+To test:\n+\n+```\n+./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)\n+```\n+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:\n+\n+```\n+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config\n+VERSION=9.3.beta7\n+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima\n+ARB_LIBRARY=arb\n+SAGE_NAUTY_BINS_PREFIX=\n+CBLAS_PC_MODULES=cblas\n+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax\n+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs\n+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local\n+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin\n+python finish: run-test  after 0.17 seconds\n+```\n+\n+To build a source distribution:\n+\n+```\n+./sage -sh -c build/pkgs/sage_conf/spkg-src\n+```\n+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)\n+\n+Follow-up steps:\n+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).\n+- Optionally, it would create a venv that is used for building wheels. \n+- #30036: Make the build more incremental: On installation of **sage-conf**,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python distribution packages such as **sagemath-standard** to install packages if present.\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-10-11T21:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433471",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,42 @@
+As #30913 makes **sage-conf** both (a) a PEP517/518 `build_system` `requires` and (b) an `install-requires` of sagelib (`sagemath-standard`), also a version of **sage-conf** must be made available on PyPI.
+
+This version of **sage-conf** includes a copy of `SAGE_ROOT` and `SAGE_ROOT/build/**` in its source distribution. On installation (or wheel building) it establishes a python-less SAGE_LOCAL hierarchy (#31362) in `~/.sage/` by running `configure` and `make build-local`; and then installs the configured `sage_conf.py` (#29038) as a Python module (and `sage-config`, `sage-env-config`). 
+
+There are no changes to how the Sage distribution is built. This ticket only provides an alternative and strictly optional way of installing (the non-Python bits of) Sage-the-distribution.  It may be useful for some users who wish to use `pip` to install everything they need. 
+
+To test:
+
+```
+./bootstrap && (cd pkgs/sage-conf_pypi/ && tox -r -v -v -v)
+```
+This test using `tox` uses `.sage` in an isolated directory within `.tox` instead of in your home directory. At the end of the tox run, the installed `sage-config` script is executed; it prints the configuration variables:
+
+```
+[10639] /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf_pypi$ /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/pkgs/sage-conf-pypi/.tox/python/bin/sage-config
+VERSION=9.3.beta7
+MAXIMA=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/bin/maxima
+ARB_LIBRARY=arb
+SAGE_NAUTY_BINS_PREFIX=
+CBLAS_PC_MODULES=cblas
+MATHJAX_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/mathjax
+THREEJS_DIR=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local/share/threejs
+SAGE_LOCAL=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin/local
+SAGE_ROOT=/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/pkgs/sage_conf-pypi/.tox/python/.sage/sage-9.3.beta7-cpython-39-darwin
+python finish: run-test  after 0.17 seconds
+```
+
+To build a source distribution:
+
+```
+./sage -sh -c build/pkgs/sage_conf/spkg-src
+```
+(The source distribution has been uploaded to https://pypi.org/project/sage-conf/)
+
+Follow-up steps:
+- Make SAGE_ROOT configurable by the user (by passing `--prefix` to `setup.py`).
+- Optionally, it would create a venv that is used for building wheels. 
+- #30036: Make the build more incremental: On installation of **sage-conf**,  only run `configure` but do not install anything; rather, a Python entry point can be used by Python distribution packages such as **sagemath-standard** to install packages if present.
+
 
 
 Comment: 1
``````




---

archive/issue_comments_433472.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-29T07:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433472",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433473.json:
```json
{
    "body": "<a id='comment:5'></a>Still waiting for review",
    "created_at": "2021-11-12T06:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433473",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Still waiting for review



---

archive/issue_comments_433474.json:
```json
{
    "body": "<a id='comment:6'></a>Right, let's move this forward, it needs a fair bit of bot-testing.",
    "created_at": "2021-11-12T06:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433474",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>Right, let's move this forward, it needs a fair bit of bot-testing.



---

archive/issue_comments_433475.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-11-12T06:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433475",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433476.json:
```json
{
    "body": "<a id='comment:7'></a>Thanks.\n\nNote that that we currently do not have automatic testing for this by bots or GH Actions.\nThere are a number of open tickets: #32703, #32570, #32113, #30845 that need attention",
    "created_at": "2021-11-12T20:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433476",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Thanks.

Note that that we currently do not have automatic testing for this by bots or GH Actions.
There are a number of open tickets: #32703, #32570, #32113, #30845 that need attention



---

archive/issue_comments_433477.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-11-19T00:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_433478.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-11-19T00:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433478",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_433479.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-11-19T00:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433479",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433480.json:
```json
{
    "body": "<a id='comment:160'></a>Replying to [comment:75 mkoeppe]:\n> Note that `make distclean` does not clean stuff in `.tox`, so if you want to start from scratch, use `tox -r`\n\n\nShould `make distclean` clean stuff in `.tox`? Running `tox -r` might have helped with a problem at https://ask.sagemath.org/question/60029/sage-not-installing-from-source.",
    "created_at": "2021-12-03T20:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433480",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:160'></a>Replying to [comment:75 mkoeppe]:
> Note that `make distclean` does not clean stuff in `.tox`, so if you want to start from scratch, use `tox -r`


Should `make distclean` clean stuff in `.tox`? Running `tox -r` might have helped with a problem at https://ask.sagemath.org/question/60029/sage-not-installing-from-source.



---

archive/issue_comments_433481.json:
```json
{
    "body": "<a id='comment:1'></a>It shouldn't (because .tox is not an artifact of the normal build that is orchestrated by \"make\"), and this user's problems have nothing to do with tox",
    "created_at": "2021-12-03T20:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433481",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>It shouldn't (because .tox is not an artifact of the normal build that is orchestrated by "make"), and this user's problems have nothing to do with tox



---

archive/issue_comments_433482.json:
```json
{
    "body": "<a id='comment:2'></a>Release script seems to have skipped this ticket",
    "created_at": "2021-12-19T19:33:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433482",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>Release script seems to have skipped this ticket



---

archive/issue_comments_433483.json:
```json
{
    "body": "<a id='comment:3'></a>This ticket depends on a ticket that has no attached branch, hence it'll never be merged",
    "created_at": "2021-12-28T21:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433483",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>This ticket depends on a ticket that has no attached branch, hence it'll never be merged



---

archive/issue_comments_433484.json:
```json
{
    "body": "<a id='comment:4'></a>Thanks",
    "created_at": "2021-12-28T21:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433484",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Thanks



---

archive/issue_events_073582.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-29T21:43:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29039#event-73582"
}
```



---

archive/issue_comments_433485.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-29T21:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433485",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_433486.json:
```json
{
    "body": "<a id='comment:166'></a>Replying to [comment:148 fbissey]:\n> A little bit late at this stage to ask for stuff but here it goes. Would it be appropriate to split the file `sage_conf.py` into two parts? \n> \n> One that would keep the name and contains the `main` function and doesn't need to be configured, and the second one that just contains the variables and that would be pre-parsed by configure.\n> \n> The idea being that distro could just provide/configure the second file has they see fit without touching the functionality of the package.\n\n\nDone now in #31396. Happy new year!",
    "created_at": "2022-01-01T19:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29039#issuecomment-433486",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:166'></a>Replying to [comment:148 fbissey]:
> A little bit late at this stage to ask for stuff but here it goes. Would it be appropriate to split the file `sage_conf.py` into two parts? 
> 
> One that would keep the name and contains the `main` function and doesn't need to be configured, and the second one that just contains the variables and that would be pre-parsed by configure.
> 
> The idea being that distro could just provide/configure the second file has they see fit without touching the functionality of the package.


Done now in #31396. Happy new year!
