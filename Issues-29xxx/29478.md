# Issue 29478: Add a memory bound in discrete_log function

archive/issues_029241.json:
```json
{
    "body": "In the `discrete_log` function of **groups/generic.py** file, after the subgroup separation, the Baby step Giant step (`bsgs` function) algorithm will be used in each subgroup. However, bsgs requires O(sqrt(order)) space complexity. If the system memory is not big enough the system will become unstable and crash. Nevertheless with the `discrete_log_lambda` for the same subgroup size the computation would take longer but finishes normally since it use O(log(order)) space complexity.\n\nFor example with the following:\n\n```\nF = GF(140737488355333)\nE = EllipticCurve(F,[1,139])\nk = int(F.random_element()) % order\nG = E.gen(0)\nQ = k * G\nx = bsgs(G, Q, [0,order], operation=\"+\")\n```\n\nOn my computer, the function bsg will consume too much memory and won't finish but the **discrete_log_lambda** function will finish properly after few hours.\n\nI suggest to check the available memory in the system with the **virtual_memory_limit** function and if the ratio of the group element size times sqrt(order) over the memory available is to high to fall back using the `discrete_log_lambda` maybe with a warning. I do not know how to have a correct estimation of a group element size since `getsizeof` function does not give a correct result.\n\n**Keywords:** discrete_log groups\n\n**Status:** new\n\nIssue created by migration from https://trac.sagemath.org/ticket/29478\n\n",
    "created_at": "2020-04-08T10:18:23Z",
    "labels": [
        "component: group theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add a memory bound in discrete_log function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29478",
    "user": "https://github.com/sylvainpelissier"
}
```
In the `discrete_log` function of **groups/generic.py** file, after the subgroup separation, the Baby step Giant step (`bsgs` function) algorithm will be used in each subgroup. However, bsgs requires O(sqrt(order)) space complexity. If the system memory is not big enough the system will become unstable and crash. Nevertheless with the `discrete_log_lambda` for the same subgroup size the computation would take longer but finishes normally since it use O(log(order)) space complexity.

For example with the following:

```
F = GF(140737488355333)
E = EllipticCurve(F,[1,139])
k = int(F.random_element()) % order
G = E.gen(0)
Q = k * G
x = bsgs(G, Q, [0,order], operation="+")
```

On my computer, the function bsg will consume too much memory and won't finish but the **discrete_log_lambda** function will finish properly after few hours.

I suggest to check the available memory in the system with the **virtual_memory_limit** function and if the ratio of the group element size times sqrt(order) over the memory available is to high to fall back using the `discrete_log_lambda` maybe with a warning. I do not know how to have a correct estimation of a group element size since `getsizeof` function does not give a correct result.

**Keywords:** discrete_log groups

**Status:** new

Issue created by migration from https://trac.sagemath.org/ticket/29478





---

archive/issue_comments_550387.json:
```json
{
    "body": "<a id='comment:1'></a>\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-550387",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_084503.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84503"
}
```



---

archive/issue_events_084504.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84504"
}
```



---

archive/issue_events_084505.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84505"
}
```



---

archive/issue_events_084506.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84506"
}
```



---

archive/issue_events_084507.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84507"
}
```



---

archive/issue_comments_550388.json:
```json
{
    "body": "<a id='comment:3'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-550388",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_084508.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84508"
}
```



---

archive/issue_events_084509.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84509"
}
```



---

archive/issue_events_084510.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84510"
}
```



---

archive/issue_events_084511.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84511"
}
```



---

archive/issue_events_084512.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84512"
}
```



---

archive/issue_events_084513.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84513"
}
```



---

archive/issue_events_084514.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84514"
}
```



---

archive/issue_events_084515.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29478#event-84515"
}
```
