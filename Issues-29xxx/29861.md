# Issue 29861: Upgrade Cython to 0.29.21

archive/issues_029624.json:
```json
{
    "body": "We upgrade Cython to 0.29.21\n\n(https://github.com/cython/cython/blob/master/CHANGES.rst#02921-2020-07-09)\n\nThis is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):\n\n```\n$sage -c 1+1\nSageMath version 9.1, Release Date: 2020-05-20\nTraceback (most recent call last):\n  File \"/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval\", line 4, in <module>\n    from sage.all import *\n  File \"/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py\", line 117, in <module>\n    import sage.misc.lazy_import\n  File \"sage/misc/lazy_import.pyx\", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)\nAttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'\n```\n\nPrevious update:\n- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)\n\n\nCC:  @isuruf @nbruin @kiwifb @dimpase @antonio-rojas @jhpalmieri\n\nKeywords: upgrade, cython\n\nBranch/Commit: c24d109199a68d09b138b3a29436704b9532fb39\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nDependencies: #29867\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29861\n\n",
    "closed_at": "2020-07-25T22:51:21Z",
    "created_at": "2020-06-15T00:13:51Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Upgrade Cython to 0.29.21",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29861",
    "user": "https://github.com/mkoeppe"
}
```
We upgrade Cython to 0.29.21

(https://github.com/cython/cython/blob/master/CHANGES.rst#02921-2020-07-09)

This is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):

```
$sage -c 1+1
SageMath version 9.1, Release Date: 2020-05-20
Traceback (most recent call last):
  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval", line 4, in <module>
    from sage.all import *
  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py", line 117, in <module>
    import sage.misc.lazy_import
  File "sage/misc/lazy_import.pyx", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)
AttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'
```

Previous update:
- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)


CC:  @isuruf @nbruin @kiwifb @dimpase @antonio-rojas @jhpalmieri

Keywords: upgrade, cython

Branch/Commit: c24d109199a68d09b138b3a29436704b9532fb39

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Dependencies: #29867

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29861





---

archive/issue_comments_448322.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -17,7 +17,8 @@\n \\`\\`\\`\n \n Previous update:\n-- #29480 - Upgrade Cython to 0.29.17\n+- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2020-06-15T00:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448322",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -17,7 +17,8 @@
 \`\`\`
 
 Previous update:
-- #29480 - Upgrade Cython to 0.29.17
+- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)
+
 
 Comment: 1
 
```




---

archive/issue_comments_448323.json:
```json
{
    "body": "<a id='comment:2'></a>apparently the cause for this is already found.\n\n```\nThis works for me with no apparent issues:\n```\nhttps://aur.archlinux.org/cgit/aur.git/tree/sagemath-cython-0.29.20.patch?h=sagemath-git",
    "created_at": "2020-06-15T08:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448323",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>apparently the cause for this is already found.

```
This works for me with no apparent issues:
```
https://aur.archlinux.org/cgit/aur.git/tree/sagemath-cython-0.29.20.patch?h=sagemath-git



---

archive/issue_comments_448324.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, cython\".",
    "created_at": "2020-06-18T02:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448324",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "upgrade, cython".



---

archive/issue_comments_448325.json:
```json
{
    "body": "<a id='comment:5'></a>0.29.21 is out. Needed by numpy branches `master`, `maintenance/1.19.x`",
    "created_at": "2020-07-14T23:56:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448325",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>0.29.21 is out. Needed by numpy branches `master`, `maintenance/1.19.x`



---

archive/issue_comments_448326.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,23 @@\n+We upgrade Cython to 0.29.21\n+\n+(https://github.com/cython/cython/blob/master/CHANGES.rst#02920-2020-06-10)\n+\n+This is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):\n+\n+\\`\\`\\`\n+$sage -c 1+1\n+SageMath version 9.1, Release Date: 2020-05-20\n+Traceback (most recent call last):\n+  File \"/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval\", line 4, in <module>\n+    from sage.all import *\n+  File \"/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py\", line 117, in <module>\n+    import sage.misc.lazy_import\n+  File \"sage/misc/lazy_import.pyx\", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)\n+AttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'\n+\\`\\`\\`\n+\n+Previous update:\n+- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)\n \n \n Comment: 1\n```\n",
    "created_at": "2020-07-15T00:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448326",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,23 @@
+We upgrade Cython to 0.29.21
+
+(https://github.com/cython/cython/blob/master/CHANGES.rst#02920-2020-06-10)
+
+This is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):
+
+\`\`\`
+$sage -c 1+1
+SageMath version 9.1, Release Date: 2020-05-20
+Traceback (most recent call last):
+  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval", line 4, in <module>
+    from sage.all import *
+  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py", line 117, in <module>
+    import sage.misc.lazy_import
+  File "sage/misc/lazy_import.pyx", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)
+AttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'
+\`\`\`
+
+Previous update:
+- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)
 
 
 Comment: 1
```




---

archive/issue_comments_448327.json:
```json
{
    "body": "<a id='comment:8'></a>Tests with 0.29.21 run at https://github.com/mkoeppe/sage/actions/runs/169380426\n\n---\nNew commits:",
    "created_at": "2020-07-15T00:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448327",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Tests with 0.29.21 run at https://github.com/mkoeppe/sage/actions/runs/169380426

---
New commits:



---

archive/issue_comments_448328.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,23 @@\n+We upgrade Cython to 0.29.21\n+\n+(https://github.com/cython/cython/blob/master/CHANGES.rst#02921-2020-07-09)\n+\n+This is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):\n+\n+\\`\\`\\`\n+$sage -c 1+1\n+SageMath version 9.1, Release Date: 2020-05-20\n+Traceback (most recent call last):\n+  File \"/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval\", line 4, in <module>\n+    from sage.all import *\n+  File \"/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py\", line 117, in <module>\n+    import sage.misc.lazy_import\n+  File \"sage/misc/lazy_import.pyx\", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)\n+AttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'\n+\\`\\`\\`\n+\n+Previous update:\n+- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)\n \n \n Comment: 1\n```\n",
    "created_at": "2020-07-15T00:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448328",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,23 @@
+We upgrade Cython to 0.29.21
+
+(https://github.com/cython/cython/blob/master/CHANGES.rst#02921-2020-07-09)
+
+This is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):
+
+\`\`\`
+$sage -c 1+1
+SageMath version 9.1, Release Date: 2020-05-20
+Traceback (most recent call last):
+  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval", line 4, in <module>
+    from sage.all import *
+  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py", line 117, in <module>
+    import sage.misc.lazy_import
+  File "sage/misc/lazy_import.pyx", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)
+AttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'
+\`\`\`
+
+Previous update:
+- #29480 - Upgrade Cython to 0.29.17 (merged in 9.2.beta1)
 
 
 Comment: 1
```




---

archive/issue_comments_448329.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-15T01:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448329",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_448330.json:
```json
{
    "body": "<a id='comment:13'></a>Tests look clean. Needs review",
    "created_at": "2020-07-15T19:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448330",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Tests look clean. Needs review



---

archive/issue_comments_448331.json:
```json
{
    "body": "<a id='comment:14'></a>Works for me on OS X, seems to be needed for #27754.",
    "created_at": "2020-07-15T21:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448331",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>Works for me on OS X, seems to be needed for #27754.



---

archive/issue_comments_448332.json:
```json
{
    "body": "<a id='comment:15'></a>lgtm",
    "created_at": "2020-07-16T16:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448332",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>lgtm



---

archive/issue_comments_448333.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-16T16:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448333",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_448334.json:
```json
{
    "body": "<a id='comment:16'></a>Thanks!",
    "created_at": "2020-07-16T19:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448334",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Thanks!



---

archive/issue_comments_448335.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-25T22:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29861#issuecomment-448335",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_076490.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-25T22:51:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29861",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29861#event-76490"
}
```
