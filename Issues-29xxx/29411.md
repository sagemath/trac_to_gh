# Issue 29411: make sagelib a script package

archive/issues_029174.json:
```json
{
    "body": "... so that sagelib is just an ordinary `script` package whose source tree is included (hence, no `checksums.ini` file; see #29287).\n\nRelated sage-devel discussions:\n- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/_7GdzGy4BgAJ (\"package sources\")\n- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/-obd4rMDBAAJ\n \nRelated tickets:\n- #29386 Install script packages via sage-spkg\n\n\n\nCC:  @embray @videlec @orlitzky @dimpase @jhpalmieri @kiwifb\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: cc304711ef42f25733f1ca861801d87f58fa1118\n\nDependencies: #29098, #29697, #29793\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29411\n\n",
    "closed_at": "2020-07-02T21:30:21Z",
    "created_at": "2020-03-26T19:02:19Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "make sagelib a script package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29411",
    "user": "https://github.com/mkoeppe"
}
```
... so that sagelib is just an ordinary `script` package whose source tree is included (hence, no `checksums.ini` file; see #29287).

Related sage-devel discussions:
- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/_7GdzGy4BgAJ ("package sources")
- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/-obd4rMDBAAJ
 
Related tickets:
- #29386 Install script packages via sage-spkg



CC:  @embray @videlec @orlitzky @dimpase @jhpalmieri @kiwifb

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Branch: cc304711ef42f25733f1ca861801d87f58fa1118

Dependencies: #29098, #29697, #29793

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29411





---

archive/issue_events_084579.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:22:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29411#event-84579"
}
```



---

archive/issue_comments_575202.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,10 @@\n+... so that sagelib is just an ordinary `script` package whose source tree is included (hence, no `checksums.ini` file; see #29287).\n \n+Related sage-devel discussions:\n+- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/_7GdzGy4BgAJ (\"package sources\")\n+- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/-obd4rMDBAAJ\n+ \n+Related tickets:\n+- #29386 Install script packages via sage-spkg\n+\n+\n``````\n",
    "created_at": "2020-05-13T04:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575202",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,10 @@
+... so that sagelib is just an ordinary `script` package whose source tree is included (hence, no `checksums.ini` file; see #29287).
 
+Related sage-devel discussions:
+- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/_7GdzGy4BgAJ ("package sources")
+- https://groups.google.com/d/msg/sage-devel/nTwhCV89FXE/-obd4rMDBAAJ
+ 
+Related tickets:
+- #29386 Install script packages via sage-spkg
+
+
``````




---

archive/issue_comments_575203.json:
```json
{
    "body": "Changing dependencies from \"#29287\" to \"#29098\"",
    "created_at": "2020-05-16T01:25:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575203",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29287" to "#29098"



---

archive/issue_comments_575204.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/make_sagelib_a_script_package\"",
    "created_at": "2020-05-16T04:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575204",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/make_sagelib_a_script_package"



---

archive/issue_comments_575205.json:
```json
{
    "body": "Changing commit from \"\" to \"80cb1b9dc4d0658d23ff075e9354d49b6ceac356\"",
    "created_at": "2020-05-16T04:18:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575205",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "80cb1b9dc4d0658d23ff075e9354d49b6ceac356"



---

archive/issue_comments_575206.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[768a314](https://github.com/sagemath/sagetrac-mirror/commit/768a314f478f915a317527821f7024dce4a25ed1)|`Merge build/make/deps into build/make/Makefile.in`|\n|[80cb1b9](https://github.com/sagemath/sagetrac-mirror/commit/80cb1b9dc4d0658d23ff075e9354d49b6ceac356)|`Make sagelib a script package`|",
    "created_at": "2020-05-16T04:18:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575206",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[768a314](https://github.com/sagemath/sagetrac-mirror/commit/768a314f478f915a317527821f7024dce4a25ed1)|`Merge build/make/deps into build/make/Makefile.in`|
|[80cb1b9](https://github.com/sagemath/sagetrac-mirror/commit/80cb1b9dc4d0658d23ff075e9354d49b6ceac356)|`Make sagelib a script package`|



---

archive/issue_comments_575207.json:
```json
{
    "body": "<a id='comment:6'></a>\nNot quite done yet. Next step is to get rid of `src/Makefile.in`, moving the contents into the `spkg-install` and `spkg-clean` scripts.",
    "created_at": "2020-05-16T05:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575207",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Not quite done yet. Next step is to get rid of `src/Makefile.in`, moving the contents into the `spkg-install` and `spkg-clean` scripts.



---

archive/issue_comments_575208.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe `clean` target should perhaps be transformed into `setup.py clean`, reference: https://github.com/pypa/setuptools/issues/1347",
    "created_at": "2020-05-16T05:30:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575208",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
The `clean` target should perhaps be transformed into `setup.py clean`, reference: https://github.com/pypa/setuptools/issues/1347



---

archive/issue_comments_575209.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-05-16T06:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575209",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_575210.json:
```json
{
    "body": "Changing commit from \"80cb1b9dc4d0658d23ff075e9354d49b6ceac356\" to \"91e5a3dd01722c50e21dc02152316d397e70ebb9\"",
    "created_at": "2020-05-16T07:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "80cb1b9dc4d0658d23ff075e9354d49b6ceac356" to "91e5a3dd01722c50e21dc02152316d397e70ebb9"



---

archive/issue_comments_575211.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|\n|[91e5a3d](https://github.com/sagemath/sagetrac-mirror/commit/91e5a3dd01722c50e21dc02152316d397e70ebb9)|`src/Makefile.in: Merge into build/make/Makefile.in, build/pkgs/sagelib/spkg-install`|",
    "created_at": "2020-05-16T07:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575211",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
|[91e5a3d](https://github.com/sagemath/sagetrac-mirror/commit/91e5a3dd01722c50e21dc02152316d397e70ebb9)|`src/Makefile.in: Merge into build/make/Makefile.in, build/pkgs/sagelib/spkg-install`|



---

archive/issue_comments_575212.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [mkoeppe](#comment%3A7):\n> The `clean` target should perhaps be transformed into `setup.py clean`, reference: https://github.com/pypa/setuptools/issues/1347\n\nThat's already noted in #21508, will not happen on the present ticket",
    "created_at": "2020-05-16T07:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575212",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Replying to [mkoeppe](#comment%3A7):
> The `clean` target should perhaps be transformed into `setup.py clean`, reference: https://github.com/pypa/setuptools/issues/1347

That's already noted in #21508, will not happen on the present ticket



---

archive/issue_comments_575213.json:
```json
{
    "body": "<a id='comment:11'></a>\nTBD: sagelib rebuilds are no longer triggered because it now goes through a non-phony target",
    "created_at": "2020-05-16T07:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575213",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
TBD: sagelib rebuilds are no longer triggered because it now goes through a non-phony target



---

archive/issue_comments_575214.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|\n|[08cbbf2](https://github.com/sagemath/sagetrac-mirror/commit/08cbbf200f2c5edc1bee4cac4372335f1bdf7168)|`build/make/Makefile.in, build/pkgs/sagelib/dependencies: Make sure sagelib spkg-install is always run`|",
    "created_at": "2020-05-16T15:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
|[08cbbf2](https://github.com/sagemath/sagetrac-mirror/commit/08cbbf200f2c5edc1bee4cac4372335f1bdf7168)|`build/make/Makefile.in, build/pkgs/sagelib/dependencies: Make sure sagelib spkg-install is always run`|



---

archive/issue_comments_575215.json:
```json
{
    "body": "Changing commit from \"91e5a3dd01722c50e21dc02152316d397e70ebb9\" to \"08cbbf200f2c5edc1bee4cac4372335f1bdf7168\"",
    "created_at": "2020-05-16T15:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "91e5a3dd01722c50e21dc02152316d397e70ebb9" to "08cbbf200f2c5edc1bee4cac4372335f1bdf7168"



---

archive/issue_comments_575216.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-16T19:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575216",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_575217.json:
```json
{
    "body": "<a id='comment:15'></a>\nNot quite what I had in mind but this is a step in the right direction. It makes sagelib less special in the build system. I believe the dependency part is OK. The makefile bits deserve a bit scrutiny and field testing.",
    "created_at": "2020-05-16T21:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575217",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'></a>
Not quite what I had in mind but this is a step in the right direction. It makes sagelib less special in the build system. I believe the dependency part is OK. The makefile bits deserve a bit scrutiny and field testing.



---

archive/issue_comments_575218.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe old `src/Makefile.in` and now the new `build/pkgs/sagelib/spkg-install` has this in it:\n\n```\nHoping that #20382 will make this unnecessary.\n```\n#20382 has been merged, so perhaps this should be clarified, although not necessarily on this ticket.",
    "created_at": "2020-05-16T21:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575218",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
The old `src/Makefile.in` and now the new `build/pkgs/sagelib/spkg-install` has this in it:

```
Hoping that #20382 will make this unnecessary.
```
#20382 has been merged, so perhaps this should be clarified, although not necessarily on this ticket.



---

archive/issue_comments_575219.json:
```json
{
    "body": "<a id='comment:17'></a>\nRight, this is now #28815.",
    "created_at": "2020-05-16T22:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575219",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
Right, this is now #28815.



---

archive/issue_comments_575220.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[5e915b0](https://github.com/sagemath/sagetrac-mirror/commit/5e915b0031876052a7138ea3c862d643bab39e29)|`build/pkgs/sagelib/spkg-install: Update references to tickets`|",
    "created_at": "2020-05-16T22:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575220",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[5e915b0](https://github.com/sagemath/sagetrac-mirror/commit/5e915b0031876052a7138ea3c862d643bab39e29)|`build/pkgs/sagelib/spkg-install: Update references to tickets`|



---

archive/issue_comments_575221.json:
```json
{
    "body": "Changing commit from \"08cbbf200f2c5edc1bee4cac4372335f1bdf7168\" to \"5e915b0031876052a7138ea3c862d643bab39e29\"",
    "created_at": "2020-05-16T22:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "08cbbf200f2c5edc1bee4cac4372335f1bdf7168" to "5e915b0031876052a7138ea3c862d643bab39e29"



---

archive/issue_comments_575222.json:
```json
{
    "body": "Changing dependencies from \"#29098\" to \"#29098, #29697\"",
    "created_at": "2020-05-17T03:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575222",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29098" to "#29098, #29697"



---

archive/issue_comments_575223.json:
```json
{
    "body": "Changing commit from \"5e915b0031876052a7138ea3c862d643bab39e29\" to \"f6e3fa191fdcc19b6bad34a46ddaea8648b62a30\"",
    "created_at": "2020-05-17T03:35:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575223",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5e915b0031876052a7138ea3c862d643bab39e29" to "f6e3fa191fdcc19b6bad34a46ddaea8648b62a30"



---

archive/issue_comments_575224.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|\n|[53f0359](https://github.com/sagemath/sagetrac-mirror/commit/53f0359017fc1909498de22c4c4b8c5310e76bdb)|`src/sage/env.py (sage_include_directories): Do not put SAGE_INC in front of the sage source include directories`|\n|[16247ad](https://github.com/sagemath/sagetrac-mirror/commit/16247ad9675343f1d3e1158cc5e43137aec82645)|`src/setup.py: Do not put SAGE_LOCAL/lib in front of the library directories`|\n|[9a50cba](https://github.com/sagemath/sagetrac-mirror/commit/9a50cba23abb1c6ff4b022c62624da800b88e282)|`src/sage/env.py (sage_include_directories): Fixup doctest`|\n|[73fb13a](https://github.com/sagemath/sagetrac-mirror/commit/73fb13a4826189f58a24894f5e8309522faddc8e)|`Merge branch 't/29697/src_setup_py__src_sage_env_py__sage_include_directories___do_not_add_another_copy_of_sage_inc__sage_local_lib_to_include_dirs__library_dirs' into t/29411/make_sagelib_a_script_package`|\n|[f6e3fa1](https://github.com/sagemath/sagetrac-mirror/commit/f6e3fa191fdcc19b6bad34a46ddaea8648b62a30)|`build/pkgs/sagelib/spkg-install: Also poison environment variables SAGE_LOCAL etc.`|",
    "created_at": "2020-05-17T03:35:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
|[53f0359](https://github.com/sagemath/sagetrac-mirror/commit/53f0359017fc1909498de22c4c4b8c5310e76bdb)|`src/sage/env.py (sage_include_directories): Do not put SAGE_INC in front of the sage source include directories`|
|[16247ad](https://github.com/sagemath/sagetrac-mirror/commit/16247ad9675343f1d3e1158cc5e43137aec82645)|`src/setup.py: Do not put SAGE_LOCAL/lib in front of the library directories`|
|[9a50cba](https://github.com/sagemath/sagetrac-mirror/commit/9a50cba23abb1c6ff4b022c62624da800b88e282)|`src/sage/env.py (sage_include_directories): Fixup doctest`|
|[73fb13a](https://github.com/sagemath/sagetrac-mirror/commit/73fb13a4826189f58a24894f5e8309522faddc8e)|`Merge branch 't/29697/src_setup_py__src_sage_env_py__sage_include_directories___do_not_add_another_copy_of_sage_inc__sage_local_lib_to_include_dirs__library_dirs' into t/29411/make_sagelib_a_script_package`|
|[f6e3fa1](https://github.com/sagemath/sagetrac-mirror/commit/f6e3fa191fdcc19b6bad34a46ddaea8648b62a30)|`build/pkgs/sagelib/spkg-install: Also poison environment variables SAGE_LOCAL etc.`|



---

archive/issue_comments_575225.json:
```json
{
    "body": "<a id='comment:21'></a>\nReady for review.",
    "created_at": "2020-05-17T03:36:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575225",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Ready for review.



---

archive/issue_comments_575226.json:
```json
{
    "body": "Changing commit from \"f6e3fa191fdcc19b6bad34a46ddaea8648b62a30\" to \"fcf2cabede2195ab056c9220bc4db5c3a032560b\"",
    "created_at": "2020-05-17T03:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575226",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f6e3fa191fdcc19b6bad34a46ddaea8648b62a30" to "fcf2cabede2195ab056c9220bc4db5c3a032560b"



---

archive/issue_comments_575227.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|\n|[fcf2cab](https://github.com/sagemath/sagetrac-mirror/commit/fcf2cabede2195ab056c9220bc4db5c3a032560b)|`build/pkgs/sagelib/spkg-install: Add comment regarding SAGE_SPKG_INST`|",
    "created_at": "2020-05-17T03:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575227",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|
|[fcf2cab](https://github.com/sagemath/sagetrac-mirror/commit/fcf2cabede2195ab056c9220bc4db5c3a032560b)|`build/pkgs/sagelib/spkg-install: Add comment regarding SAGE_SPKG_INST`|



---

archive/issue_comments_575228.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|\n|[a973fc4](https://github.com/sagemath/sagetrac-mirror/commit/a973fc499fa531efecffe34284701ce2d8632c52)|`build/pkgs/sagelib/spkg-install: Also poison SAGE_PKGCONFIG, SAGE_SPKG_SCRIPTS`|",
    "created_at": "2020-05-17T03:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575228",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
|[a973fc4](https://github.com/sagemath/sagetrac-mirror/commit/a973fc499fa531efecffe34284701ce2d8632c52)|`build/pkgs/sagelib/spkg-install: Also poison SAGE_PKGCONFIG, SAGE_SPKG_SCRIPTS`|



---

archive/issue_comments_575229.json:
```json
{
    "body": "Changing commit from \"fcf2cabede2195ab056c9220bc4db5c3a032560b\" to \"a973fc499fa531efecffe34284701ce2d8632c52\"",
    "created_at": "2020-05-17T03:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575229",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fcf2cabede2195ab056c9220bc4db5c3a032560b" to "a973fc499fa531efecffe34284701ce2d8632c52"



---

archive/issue_comments_575230.json:
```json
{
    "body": "<a id='comment:24'></a>\nplease remove `gcc` from the modified comment in `src/setup.py` - it's a misleading artefact from the past, where gcc was needed to build Sage.",
    "created_at": "2020-05-17T20:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575230",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
please remove `gcc` from the modified comment in `src/setup.py` - it's a misleading artefact from the past, where gcc was needed to build Sage.



---

archive/issue_comments_575231.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[c1db7ed](https://github.com/sagemath/sagetrac-mirror/commit/c1db7ed4ac41daebbdce7d7777abe86dae96fa4a)|`src/setup.py: Update comment (not specific to gcc)`|",
    "created_at": "2020-05-17T20:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[c1db7ed](https://github.com/sagemath/sagetrac-mirror/commit/c1db7ed4ac41daebbdce7d7777abe86dae96fa4a)|`src/setup.py: Update comment (not specific to gcc)`|



---

archive/issue_comments_575232.json:
```json
{
    "body": "Changing commit from \"a973fc499fa531efecffe34284701ce2d8632c52\" to \"c1db7ed4ac41daebbdce7d7777abe86dae96fa4a\"",
    "created_at": "2020-05-17T20:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575232",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a973fc499fa531efecffe34284701ce2d8632c52" to "c1db7ed4ac41daebbdce7d7777abe86dae96fa4a"



---

archive/issue_comments_575233.json:
```json
{
    "body": "<a id='comment:26'></a>\nWhat is the point of `FORCE` target - to always (re)build sagelib, right?\nBut is it needed?",
    "created_at": "2020-05-17T20:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575233",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>
What is the point of `FORCE` target - to always (re)build sagelib, right?
But is it needed?



---

archive/issue_comments_575234.json:
```json
{
    "body": "<a id='comment:27'></a>\nYes, without it, sagelib would not be rebuilt when source files change.",
    "created_at": "2020-05-17T20:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575234",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Yes, without it, sagelib would not be rebuilt when source files change.



---

archive/issue_comments_575235.json:
```json
{
    "body": "<a id='comment:28'></a>\nhmm, but why not honestly list deps in a makefile?",
    "created_at": "2020-05-17T20:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575235",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>
hmm, but why not honestly list deps in a makefile?



---

archive/issue_comments_575236.json:
```json
{
    "body": "<a id='comment:29'></a>\nWell, instead of the dependency on FORCE that is listed in `build/pkgs/sagelib/dependencies`, we could make it a dependency on `$(SAGE_SRC) $(SAGE_SRC)/* $(SAGE_SRC)/*/* $(SAGE_SRC)/*/*/* $(SAGE_SRC)/*/*/*/*`, but I don't think this is better",
    "created_at": "2020-05-17T21:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575236",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Well, instead of the dependency on FORCE that is listed in `build/pkgs/sagelib/dependencies`, we could make it a dependency on `$(SAGE_SRC) $(SAGE_SRC)/* $(SAGE_SRC)/*/* $(SAGE_SRC)/*/*/* $(SAGE_SRC)/*/*/*/*`, but I don't think this is better



---

archive/issue_comments_575237.json:
```json
{
    "body": "<a id='comment:30'></a>\nIn other words, we do not have dependency tracking at all for sagelib. Neither of `distutils`, `setuptools`, `cython` seem to have a mechanism for generating dependencies like `gcc -M`. This would be certainly be nice to have; in particular if it included dependencies on \"system\" headers and libraries, so that sagelib could automatically rebuild when system headers/libraries change (as in, most recently, https://groups.google.com/d/msg/sage-release/A53tGGsJNLg/uA01oUugAQAJ). But that's outside of the scope of this ticket.",
    "created_at": "2020-05-17T21:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575237",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>
In other words, we do not have dependency tracking at all for sagelib. Neither of `distutils`, `setuptools`, `cython` seem to have a mechanism for generating dependencies like `gcc -M`. This would be certainly be nice to have; in particular if it included dependencies on "system" headers and libraries, so that sagelib could automatically rebuild when system headers/libraries change (as in, most recently, https://groups.google.com/d/msg/sage-release/A53tGGsJNLg/uA01oUugAQAJ). But that's outside of the scope of this ticket.



---

archive/issue_comments_575238.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2020-05-17T21:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575238",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_575239.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-17T21:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575239",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_575240.json:
```json
{
    "body": "<a id='comment:31'></a>\nOK, makes sense.",
    "created_at": "2020-05-17T21:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575240",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>
OK, makes sense.



---

archive/issue_comments_575241.json:
```json
{
    "body": "<a id='comment:32'></a>\nThanks!",
    "created_at": "2020-05-17T23:04:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575241",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
Thanks!



---

archive/issue_comments_575242.json:
```json
{
    "body": "<a id='comment:33'></a>\nI have created #29711 (sagelib setup.py: Dependencies on header files of packages).",
    "created_at": "2020-05-19T01:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575242",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
I have created #29711 (sagelib setup.py: Dependencies on header files of packages).



---

archive/issue_comments_575243.json:
```json
{
    "body": "Changing commit from \"c1db7ed4ac41daebbdce7d7777abe86dae96fa4a\" to \"6ee66dddccadf36476af10720f72cddaa158a501\"",
    "created_at": "2020-05-22T05:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c1db7ed4ac41daebbdce7d7777abe86dae96fa4a" to "6ee66dddccadf36476af10720f72cddaa158a501"



---

archive/issue_comments_575244.json:
```json
{
    "body": "<a id='comment:34'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:\n|                                                                                                                                           |                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[e1a9413](https://github.com/sagemath/sagetrac-mirror/commit/e1a9413b72a001482f3e7775e053853f3cd75f96)|`Merge build/make/deps into build/make/Makefile.in`|\n|[da9538e](https://github.com/sagemath/sagetrac-mirror/commit/da9538e59475e7069aeaca02d3e5bba257052193)|`Make sagelib a script package`|\n|[9fd3f7e](https://github.com/sagemath/sagetrac-mirror/commit/9fd3f7eb0c06c880bdd957694acfc320234a1d62)|`src/Makefile.in: Merge into build/make/Makefile.in, build/pkgs/sagelib/spkg-install`|\n|[9ea77e5](https://github.com/sagemath/sagetrac-mirror/commit/9ea77e5552b49092cf3b51d5b46773b632d4e0f1)|`build/make/Makefile.in, build/pkgs/sagelib/dependencies: Make sure sagelib spkg-install is always run`|\n|[c3908e9](https://github.com/sagemath/sagetrac-mirror/commit/c3908e9677eca92677e5dd5d5be19b38893200fa)|`build/pkgs/sagelib/spkg-install: Update references to tickets`|\n|[62f2841](https://github.com/sagemath/sagetrac-mirror/commit/62f2841785c6dcee69f0051f9083dbb1d69b27c5)|`Merge branch 't/29697/src_setup_py__src_sage_env_py__sage_include_directories___do_not_add_another_copy_of_sage_inc__sage_local_lib_to_include_dirs__library_dirs' into t/29411/make_sagelib_a_script_package`|\n|[048ce5b](https://github.com/sagemath/sagetrac-mirror/commit/048ce5bec8ec226cc4b3ef8752a999a19f52cfdc)|`build/pkgs/sagelib/spkg-install: Also poison environment variables SAGE_LOCAL etc.`|\n|[4590c4c](https://github.com/sagemath/sagetrac-mirror/commit/4590c4c08a9c2483b7352f3694a0dd47534ddce4)|`build/pkgs/sagelib/spkg-install: Add comment regarding SAGE_SPKG_INST`|\n|[ed312c5](https://github.com/sagemath/sagetrac-mirror/commit/ed312c53ee8df33a8215a42b2d778323c15ef588)|`build/pkgs/sagelib/spkg-install: Also poison SAGE_PKGCONFIG, SAGE_SPKG_SCRIPTS`|\n|[6ee66dd](https://github.com/sagemath/sagetrac-mirror/commit/6ee66dddccadf36476af10720f72cddaa158a501)|`src/setup.py: Update comment (not specific to gcc)`|",
    "created_at": "2020-05-22T05:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. Last 10 new commits:
|                                                                                                                                           |                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[e1a9413](https://github.com/sagemath/sagetrac-mirror/commit/e1a9413b72a001482f3e7775e053853f3cd75f96)|`Merge build/make/deps into build/make/Makefile.in`|
|[da9538e](https://github.com/sagemath/sagetrac-mirror/commit/da9538e59475e7069aeaca02d3e5bba257052193)|`Make sagelib a script package`|
|[9fd3f7e](https://github.com/sagemath/sagetrac-mirror/commit/9fd3f7eb0c06c880bdd957694acfc320234a1d62)|`src/Makefile.in: Merge into build/make/Makefile.in, build/pkgs/sagelib/spkg-install`|
|[9ea77e5](https://github.com/sagemath/sagetrac-mirror/commit/9ea77e5552b49092cf3b51d5b46773b632d4e0f1)|`build/make/Makefile.in, build/pkgs/sagelib/dependencies: Make sure sagelib spkg-install is always run`|
|[c3908e9](https://github.com/sagemath/sagetrac-mirror/commit/c3908e9677eca92677e5dd5d5be19b38893200fa)|`build/pkgs/sagelib/spkg-install: Update references to tickets`|
|[62f2841](https://github.com/sagemath/sagetrac-mirror/commit/62f2841785c6dcee69f0051f9083dbb1d69b27c5)|`Merge branch 't/29697/src_setup_py__src_sage_env_py__sage_include_directories___do_not_add_another_copy_of_sage_inc__sage_local_lib_to_include_dirs__library_dirs' into t/29411/make_sagelib_a_script_package`|
|[048ce5b](https://github.com/sagemath/sagetrac-mirror/commit/048ce5bec8ec226cc4b3ef8752a999a19f52cfdc)|`build/pkgs/sagelib/spkg-install: Also poison environment variables SAGE_LOCAL etc.`|
|[4590c4c](https://github.com/sagemath/sagetrac-mirror/commit/4590c4c08a9c2483b7352f3694a0dd47534ddce4)|`build/pkgs/sagelib/spkg-install: Add comment regarding SAGE_SPKG_INST`|
|[ed312c5](https://github.com/sagemath/sagetrac-mirror/commit/ed312c53ee8df33a8215a42b2d778323c15ef588)|`build/pkgs/sagelib/spkg-install: Also poison SAGE_PKGCONFIG, SAGE_SPKG_SCRIPTS`|
|[6ee66dd](https://github.com/sagemath/sagetrac-mirror/commit/6ee66dddccadf36476af10720f72cddaa158a501)|`src/setup.py: Update comment (not specific to gcc)`|



---

archive/issue_comments_575245.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-05-22T05:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_575246.json:
```json
{
    "body": "<a id='comment:35'></a>\nRedone on top of new version of #29098",
    "created_at": "2020-05-22T05:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575246",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Redone on top of new version of #29098



---

archive/issue_comments_575247.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-22T05:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575247",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_575248.json:
```json
{
    "body": "<a id='comment:36'></a>\nOh, I was just thinking about this.  Thanks for picking up the work.  This is something I've been wanting to do for years.",
    "created_at": "2020-05-28T15:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575248",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>
Oh, I was just thinking about this.  Thanks for picking up the work.  This is something I've been wanting to do for years.



---

archive/issue_comments_575249.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-05-30T21:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575249",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_575250.json:
```json
{
    "body": "<a id='comment:37'></a>\nI'm getting this on kucalk buildbot\n\n```\nmake[3]: Entering directory '/var/lib/buildbot/slave/sage_git/build/build/make'\ncd '/var/lib/buildbot/slave/sage_git/build' && source '/var/lib/buildbot/slave/sage_git/build/src/bin/sage-env' && source '/var/lib/buildbot/slave/sage_git/build/build/bin/sage-build-env-config' && sage-logger -p '/var/lib/buildbot/slave/sage_git/build/build/pkgs/sagelib/spkg-install' '/var/lib/buildbot/slave/sage_git/build/logs/pkgs/sagelib-9.1.rc5.log'\n[sagelib-9.1.rc5] /var/lib/buildbot/slave/sage_git/build/local/bin/pkg-config: line 16: /doesnotexist/bin/pkgconf: No such file or directory\n[sagelib-9.1.rc5] ************************************************************************\n[sagelib-9.1.rc5] Traceback (most recent call last):\n[sagelib-9.1.rc5]   File \"setup.py\", line 72, in <module>\n[sagelib-9.1.rc5]     from module_list import ext_modules, library_order\n[sagelib-9.1.rc5]   File \"/var/lib/buildbot/slave/sage_git/build/src/module_list.py\", line 14, in <module>\n[sagelib-9.1.rc5]     cblas_pc = pkgconfig.parse('cblas')\n[sagelib-9.1.rc5]   File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/pkgconfig/pkgconfig.py\", line 248, in parse\n[sagelib-9.1.rc5]     _raise_if_not_exists(package)\n[sagelib-9.1.rc5]   File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/pkgconfig/pkgconfig.py\", line 103, in _raise_if_not_exists\n[sagelib-9.1.rc5]     raise PackageNotFoundError(package)\n[sagelib-9.1.rc5] pkgconfig.pkgconfig.PackageNotFoundError: cblas not found\n[sagelib-9.1.rc5] ************************************************************************\n[sagelib-9.1.rc5] Error building the Sage library\n[sagelib-9.1.rc5] ************************************************************************\n[sagelib-9.1.rc5] Please email sage-devel (http://groups.google.com/group/sage-devel)\n[sagelib-9.1.rc5] explaining the problem and including the relevant part of the log file\n[sagelib-9.1.rc5]   /var/lib/buildbot/slave/sage_git/build/logs/pkgs/sagelib-9.2.beta0.log\n[sagelib-9.1.rc5] Describe your computer, operating system, etc.\n[sagelib-9.1.rc5] ************************************************************************\n[sagelib-9.1.rc5] \n[sagelib-9.1.rc5] real\t0m0.117s\n[sagelib-9.1.rc5] user\t0m0.100s\n[sagelib-9.1.rc5] sys\t0m0.012s\n```",
    "created_at": "2020-05-30T21:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575250",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:37'></a>
I'm getting this on kucalk buildbot

```
make[3]: Entering directory '/var/lib/buildbot/slave/sage_git/build/build/make'
cd '/var/lib/buildbot/slave/sage_git/build' && source '/var/lib/buildbot/slave/sage_git/build/src/bin/sage-env' && source '/var/lib/buildbot/slave/sage_git/build/build/bin/sage-build-env-config' && sage-logger -p '/var/lib/buildbot/slave/sage_git/build/build/pkgs/sagelib/spkg-install' '/var/lib/buildbot/slave/sage_git/build/logs/pkgs/sagelib-9.1.rc5.log'
[sagelib-9.1.rc5] /var/lib/buildbot/slave/sage_git/build/local/bin/pkg-config: line 16: /doesnotexist/bin/pkgconf: No such file or directory
[sagelib-9.1.rc5] ************************************************************************
[sagelib-9.1.rc5] Traceback (most recent call last):
[sagelib-9.1.rc5]   File "setup.py", line 72, in <module>
[sagelib-9.1.rc5]     from module_list import ext_modules, library_order
[sagelib-9.1.rc5]   File "/var/lib/buildbot/slave/sage_git/build/src/module_list.py", line 14, in <module>
[sagelib-9.1.rc5]     cblas_pc = pkgconfig.parse('cblas')
[sagelib-9.1.rc5]   File "/var/lib/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/pkgconfig/pkgconfig.py", line 248, in parse
[sagelib-9.1.rc5]     _raise_if_not_exists(package)
[sagelib-9.1.rc5]   File "/var/lib/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/pkgconfig/pkgconfig.py", line 103, in _raise_if_not_exists
[sagelib-9.1.rc5]     raise PackageNotFoundError(package)
[sagelib-9.1.rc5] pkgconfig.pkgconfig.PackageNotFoundError: cblas not found
[sagelib-9.1.rc5] ************************************************************************
[sagelib-9.1.rc5] Error building the Sage library
[sagelib-9.1.rc5] ************************************************************************
[sagelib-9.1.rc5] Please email sage-devel (http://groups.google.com/group/sage-devel)
[sagelib-9.1.rc5] explaining the problem and including the relevant part of the log file
[sagelib-9.1.rc5]   /var/lib/buildbot/slave/sage_git/build/logs/pkgs/sagelib-9.2.beta0.log
[sagelib-9.1.rc5] Describe your computer, operating system, etc.
[sagelib-9.1.rc5] ************************************************************************
[sagelib-9.1.rc5] 
[sagelib-9.1.rc5] real	0m0.117s
[sagelib-9.1.rc5] user	0m0.100s
[sagelib-9.1.rc5] sys	0m0.012s
```



---

archive/issue_comments_575251.json:
```json
{
    "body": "Changing commit from \"6ee66dddccadf36476af10720f72cddaa158a501\" to \"1cfed7c676bd72db6100d81df7f397cd8d2442f3\"",
    "created_at": "2020-06-02T03:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6ee66dddccadf36476af10720f72cddaa158a501" to "1cfed7c676bd72db6100d81df7f397cd8d2442f3"



---

archive/issue_comments_575252.json:
```json
{
    "body": "<a id='comment:38'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|\n|[1cfed7c](https://github.com/sagemath/sagetrac-mirror/commit/1cfed7c676bd72db6100d81df7f397cd8d2442f3)|`build/pkgs/sagelib/spkg-install: Do not poison SAGE_LOCAL, used in script installed by spkg pkgconf`|",
    "created_at": "2020-06-02T03:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
|[1cfed7c](https://github.com/sagemath/sagetrac-mirror/commit/1cfed7c676bd72db6100d81df7f397cd8d2442f3)|`build/pkgs/sagelib/spkg-install: Do not poison SAGE_LOCAL, used in script installed by spkg pkgconf`|



---

archive/issue_comments_575253.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-02T03:04:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575253",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_575254.json:
```json
{
    "body": "<a id='comment:40'></a>\n(simplification in follow-up ticket: #29779 pkg-config installed from SPKG pkgconf should not depend on environment variable SAGE_LOCAL)",
    "created_at": "2020-06-02T03:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575254",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
(simplification in follow-up ticket: #29779 pkg-config installed from SPKG pkgconf should not depend on environment variable SAGE_LOCAL)



---

archive/issue_comments_575255.json:
```json
{
    "body": "<a id='comment:41'></a>\n`kucalk buildbot` -> I read on sage-devel that people suspect it to be running with \n`--with-python=2`, which of course is meaningless with Sage 9.2+.\nPerhaps we should make `--with-python=2` trigger an error?",
    "created_at": "2020-06-02T09:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575255",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
`kucalk buildbot` -> I read on sage-devel that people suspect it to be running with 
`--with-python=2`, which of course is meaningless with Sage 9.2+.
Perhaps we should make `--with-python=2` trigger an error?



---

archive/issue_comments_575256.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [dimpase](#comment%3A41):\n> `kucalk buildbot` -> I read on sage-devel that people suspect it to be running with \n> `--with-python=2`, which of course is meaningless with Sage 9.2+.\n> Perhaps we should make `--with-python=2` trigger an error? \n\n#29669 makes it an error already.\n\nBut the above is unrelated to python 2 vs python 3. This error showed up on systems where no system pkg-config is available. Fixed by 1cfed7c.",
    "created_at": "2020-06-02T16:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575256",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>
Replying to [dimpase](#comment%3A41):
> `kucalk buildbot` -> I read on sage-devel that people suspect it to be running with 
> `--with-python=2`, which of course is meaningless with Sage 9.2+.
> Perhaps we should make `--with-python=2` trigger an error? 

#29669 makes it an error already.

But the above is unrelated to python 2 vs python 3. This error showed up on systems where no system pkg-config is available. Fixed by 1cfed7c.



---

archive/issue_comments_575257.json:
```json
{
    "body": "<a id='comment:43'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|\n|[38b6bcf](https://github.com/sagemath/sagetrac-mirror/commit/38b6bcfa65c52d0cc07d1eaf66ece3e6d586dc05)|`Merge tag '9.2.beta0' into t/29411/make_sagelib_a_script_package`|\n|[f9a30f6](https://github.com/sagemath/sagetrac-mirror/commit/f9a30f60f7bcd47b5e3c781f0ad625e315765cea)|`build/pkgs/sagelib/spkg-install: Fix up error exits`|",
    "created_at": "2020-06-04T00:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575257",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
|[38b6bcf](https://github.com/sagemath/sagetrac-mirror/commit/38b6bcfa65c52d0cc07d1eaf66ece3e6d586dc05)|`Merge tag '9.2.beta0' into t/29411/make_sagelib_a_script_package`|
|[f9a30f6](https://github.com/sagemath/sagetrac-mirror/commit/f9a30f60f7bcd47b5e3c781f0ad625e315765cea)|`build/pkgs/sagelib/spkg-install: Fix up error exits`|



---

archive/issue_comments_575258.json:
```json
{
    "body": "Changing commit from \"1cfed7c676bd72db6100d81df7f397cd8d2442f3\" to \"f9a30f60f7bcd47b5e3c781f0ad625e315765cea\"",
    "created_at": "2020-06-04T00:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575258",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1cfed7c676bd72db6100d81df7f397cd8d2442f3" to "f9a30f60f7bcd47b5e3c781f0ad625e315765cea"



---

archive/issue_comments_575259.json:
```json
{
    "body": "Changing dependencies from \"#29098, #29697\" to \"#29098, #29697, #29793\"",
    "created_at": "2020-06-04T18:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575259",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29098, #29697" to "#29098, #29697, #29793"



---

archive/issue_comments_575260.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-04T18:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575260",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_575261.json:
```json
{
    "body": "<a id='comment:45'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[305d8cf](https://github.com/sagemath/sagetrac-mirror/commit/305d8cfac37e6b110710d6b0892f00c3abce1a98)|`Trac #29345: replace a bash array with something portable.`|\n|[d0dff56](https://github.com/sagemath/sagetrac-mirror/commit/d0dff56f6bb004b32f07c067b653f966bd1f7569)|`Trac #29345: replace a few uses of \"source\" with \".\"`|\n|[5ac420b](https://github.com/sagemath/sagetrac-mirror/commit/5ac420b15ac0e561e5e8f7f64bb9566a1b6e7890)|`Trac #29345: fix some bashisms in sage-env's resolvelinks() function.`|\n|[0a61795](https://github.com/sagemath/sagetrac-mirror/commit/0a617950488b3945fb6f494cec8b50e8486bd9dd)|`Trac #29345: don't force SHELL=bash any longer.`|\n|[5db5318](https://github.com/sagemath/sagetrac-mirror/commit/5db53186b9ae9a546bc78fc9107cc1af713b7e24)|`Trac #29345: remove \"break\" statements from AC_SEARCH_LIBS.`|\n|[e810ad1](https://github.com/sagemath/sagetrac-mirror/commit/e810ad1596d527c832bf43d3aac745407c9ba98d)|`Trac #29345: don't use sage's config.status for the lrcalc build.`|\n|[93c9921](https://github.com/sagemath/sagetrac-mirror/commit/93c9921cc5ff461cd1f02f441b46cea4400dcd85)|`Trac #29345: replace the function that populates the CVXOPT_* variables.`|\n|[0e66a0a](https://github.com/sagemath/sagetrac-mirror/commit/0e66a0abc00d5bf5ac1496e13f4d2f4ef7fe29dc)|`Trac #29345: add Dima's SPKG patches for ksh compatibility.`|\n|[df3f05e](https://github.com/sagemath/sagetrac-mirror/commit/df3f05e03ba671dd6be502ccae96d2a6162d29d4)|`build/make/Makefile.in [SCRIPT_PACKAGE_templ]: cd into the SPKG directory; adjust spkg-install scripts`|\n|[5372065](https://github.com/sagemath/sagetrac-mirror/commit/5372065710668ae1b36d059c2cbf9b6f325239c7)|`Merge branch 't/29793/script_packages_should_cd_into_the_spkg_directory' into t/29411/make_sagelib_a_script_package`|",
    "created_at": "2020-06-04T18:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575261",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[305d8cf](https://github.com/sagemath/sagetrac-mirror/commit/305d8cfac37e6b110710d6b0892f00c3abce1a98)|`Trac #29345: replace a bash array with something portable.`|
|[d0dff56](https://github.com/sagemath/sagetrac-mirror/commit/d0dff56f6bb004b32f07c067b653f966bd1f7569)|`Trac #29345: replace a few uses of "source" with "."`|
|[5ac420b](https://github.com/sagemath/sagetrac-mirror/commit/5ac420b15ac0e561e5e8f7f64bb9566a1b6e7890)|`Trac #29345: fix some bashisms in sage-env's resolvelinks() function.`|
|[0a61795](https://github.com/sagemath/sagetrac-mirror/commit/0a617950488b3945fb6f494cec8b50e8486bd9dd)|`Trac #29345: don't force SHELL=bash any longer.`|
|[5db5318](https://github.com/sagemath/sagetrac-mirror/commit/5db53186b9ae9a546bc78fc9107cc1af713b7e24)|`Trac #29345: remove "break" statements from AC_SEARCH_LIBS.`|
|[e810ad1](https://github.com/sagemath/sagetrac-mirror/commit/e810ad1596d527c832bf43d3aac745407c9ba98d)|`Trac #29345: don't use sage's config.status for the lrcalc build.`|
|[93c9921](https://github.com/sagemath/sagetrac-mirror/commit/93c9921cc5ff461cd1f02f441b46cea4400dcd85)|`Trac #29345: replace the function that populates the CVXOPT_* variables.`|
|[0e66a0a](https://github.com/sagemath/sagetrac-mirror/commit/0e66a0abc00d5bf5ac1496e13f4d2f4ef7fe29dc)|`Trac #29345: add Dima's SPKG patches for ksh compatibility.`|
|[df3f05e](https://github.com/sagemath/sagetrac-mirror/commit/df3f05e03ba671dd6be502ccae96d2a6162d29d4)|`build/make/Makefile.in [SCRIPT_PACKAGE_templ]: cd into the SPKG directory; adjust spkg-install scripts`|
|[5372065](https://github.com/sagemath/sagetrac-mirror/commit/5372065710668ae1b36d059c2cbf9b6f325239c7)|`Merge branch 't/29793/script_packages_should_cd_into_the_spkg_directory' into t/29411/make_sagelib_a_script_package`|



---

archive/issue_comments_575262.json:
```json
{
    "body": "Changing commit from \"f9a30f60f7bcd47b5e3c781f0ad625e315765cea\" to \"5372065710668ae1b36d059c2cbf9b6f325239c7\"",
    "created_at": "2020-06-04T18:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f9a30f60f7bcd47b5e3c781f0ad625e315765cea" to "5372065710668ae1b36d059c2cbf9b6f325239c7"



---

archive/issue_comments_575263.json:
```json
{
    "body": "<a id='comment:46'></a>\nMerged in #29793 to resolve a merge conflict. Needs review",
    "created_at": "2020-06-04T18:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575263",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>
Merged in #29793 to resolve a merge conflict. Needs review



---

archive/issue_comments_575264.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-04T18:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575264",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_575265.json:
```json
{
    "body": "Changing commit from \"5372065710668ae1b36d059c2cbf9b6f325239c7\" to \"cc304711ef42f25733f1ca861801d87f58fa1118\"",
    "created_at": "2020-06-07T20:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575265",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5372065710668ae1b36d059c2cbf9b6f325239c7" to "cc304711ef42f25733f1ca861801d87f58fa1118"



---

archive/issue_comments_575266.json:
```json
{
    "body": "<a id='comment:47'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[cc30471](https://github.com/sagemath/sagetrac-mirror/commit/cc304711ef42f25733f1ca861801d87f58fa1118)|`build/bin/write-dockerfile.sh: Do not ADD removed file src/Makefile.in`|",
    "created_at": "2020-06-07T20:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575266",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[cc30471](https://github.com/sagemath/sagetrac-mirror/commit/cc304711ef42f25733f1ca861801d87f58fa1118)|`build/bin/write-dockerfile.sh: Do not ADD removed file src/Makefile.in`|



---

archive/issue_comments_575267.json:
```json
{
    "body": "<a id='comment:48'></a>\nAh, that's why this was failing on [GitHub](GitHub) runs!",
    "created_at": "2020-06-07T20:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575267",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:48'></a>
Ah, that's why this was failing on [GitHub](GitHub) runs!



---

archive/issue_comments_575268.json:
```json
{
    "body": "<a id='comment:49'></a>\nReady for review...",
    "created_at": "2020-06-10T20:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575268",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>
Ready for review...



---

archive/issue_comments_575269.json:
```json
{
    "body": "<a id='comment:50'></a>\nwhy do I see `[sagelib-9.1.rc5]` while building, even though\n\n```\n$ cat VERSION.txt \nSageMath version 9.2.beta0, Release Date: 2020-05-28\n```",
    "created_at": "2020-06-12T08:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575269",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:50'></a>
why do I see `[sagelib-9.1.rc5]` while building, even though

```
$ cat VERSION.txt 
SageMath version 9.2.beta0, Release Date: 2020-05-28
```



---

archive/issue_comments_575270.json:
```json
{
    "body": "<a id='comment:51'></a>\nWhen this ticket is merged, `src/bin/sage-update-version` will update `build/pkgs/sagelib/package-version.txt`, where this comes from",
    "created_at": "2020-06-12T10:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575270",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'></a>
When this ticket is merged, `src/bin/sage-update-version` will update `build/pkgs/sagelib/package-version.txt`, where this comes from



---

archive/issue_comments_575271.json:
```json
{
    "body": "<a id='comment:52'></a>\nOK",
    "created_at": "2020-06-12T14:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575271",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:52'></a>
OK



---

archive/issue_comments_575272.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-12T14:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575272",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_575273.json:
```json
{
    "body": "<a id='comment:53'></a>\nThanks!",
    "created_at": "2020-06-12T17:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575273",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'></a>
Thanks!



---

archive/issue_comments_575274.json:
```json
{
    "body": "<a id='comment:54'></a>\nrebased over rebased #29793\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|\n|[aa206bf](https://github.com/sagemath/sagetrac-mirror/commit/aa206bf10df74bf322ea2616ebdf4596c96f69e4)|`src/Makefile.in: Merge into build/make/Makefile.in, build/pkgs/sagelib/spkg-install`|\n|[e052741](https://github.com/sagemath/sagetrac-mirror/commit/e052741e3b41fe9373b6b68faefc19e25ff97567)|`build/make/Makefile.in, build/pkgs/sagelib/dependencies: Make sure sagelib spkg-install is always run`|\n|[1e19861](https://github.com/sagemath/sagetrac-mirror/commit/1e19861fbf54670d6b7f4bff955e80a4943cc56c)|`build/pkgs/sagelib/spkg-install: Update references to tickets`|\n|[d6ee516](https://github.com/sagemath/sagetrac-mirror/commit/d6ee516aa750c12d276ab9e60fc7510a709f05e9)|`build/pkgs/sagelib/spkg-install: Also poison environment variables SAGE_LOCAL etc.`|\n|[8a4b60d](https://github.com/sagemath/sagetrac-mirror/commit/8a4b60d0f5f89360acd15fcf8107f9c22df93248)|`build/pkgs/sagelib/spkg-install: Add comment regarding SAGE_SPKG_INST`|\n|[4071eeb](https://github.com/sagemath/sagetrac-mirror/commit/4071eebd0aa7a71f78cce6840ab8c8de1286b7e0)|`build/pkgs/sagelib/spkg-install: Also poison SAGE_PKGCONFIG, SAGE_SPKG_SCRIPTS`|\n|[1707161](https://github.com/sagemath/sagetrac-mirror/commit/1707161f1508f5ea0524b47e54f17a6de35e1848)|`src/setup.py: Update comment (not specific to gcc)`|\n|[985bfca](https://github.com/sagemath/sagetrac-mirror/commit/985bfca7e63a419a7a0c185953a8c453fab2423d)|`build/pkgs/sagelib/spkg-install: Do not poison SAGE_LOCAL, used in script installed by spkg pkgconf`|\n|[b212ce8](https://github.com/sagemath/sagetrac-mirror/commit/b212ce8c65236d0b91713a9482d1de3ef6294310)|`build/pkgs/sagelib/spkg-install: Fix up error exits`|\n|[5790687](https://github.com/sagemath/sagetrac-mirror/commit/5790687b9dbf244e1c6d49b42481d552e2d5537f)|`build/bin/write-dockerfile.sh: Do not ADD removed file src/Makefile.in`|",
    "created_at": "2020-06-15T12:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575274",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:54'></a>
rebased over rebased #29793

---
Last 10 new commits:
|                                                                                                                                          |                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
|[aa206bf](https://github.com/sagemath/sagetrac-mirror/commit/aa206bf10df74bf322ea2616ebdf4596c96f69e4)|`src/Makefile.in: Merge into build/make/Makefile.in, build/pkgs/sagelib/spkg-install`|
|[e052741](https://github.com/sagemath/sagetrac-mirror/commit/e052741e3b41fe9373b6b68faefc19e25ff97567)|`build/make/Makefile.in, build/pkgs/sagelib/dependencies: Make sure sagelib spkg-install is always run`|
|[1e19861](https://github.com/sagemath/sagetrac-mirror/commit/1e19861fbf54670d6b7f4bff955e80a4943cc56c)|`build/pkgs/sagelib/spkg-install: Update references to tickets`|
|[d6ee516](https://github.com/sagemath/sagetrac-mirror/commit/d6ee516aa750c12d276ab9e60fc7510a709f05e9)|`build/pkgs/sagelib/spkg-install: Also poison environment variables SAGE_LOCAL etc.`|
|[8a4b60d](https://github.com/sagemath/sagetrac-mirror/commit/8a4b60d0f5f89360acd15fcf8107f9c22df93248)|`build/pkgs/sagelib/spkg-install: Add comment regarding SAGE_SPKG_INST`|
|[4071eeb](https://github.com/sagemath/sagetrac-mirror/commit/4071eebd0aa7a71f78cce6840ab8c8de1286b7e0)|`build/pkgs/sagelib/spkg-install: Also poison SAGE_PKGCONFIG, SAGE_SPKG_SCRIPTS`|
|[1707161](https://github.com/sagemath/sagetrac-mirror/commit/1707161f1508f5ea0524b47e54f17a6de35e1848)|`src/setup.py: Update comment (not specific to gcc)`|
|[985bfca](https://github.com/sagemath/sagetrac-mirror/commit/985bfca7e63a419a7a0c185953a8c453fab2423d)|`build/pkgs/sagelib/spkg-install: Do not poison SAGE_LOCAL, used in script installed by spkg pkgconf`|
|[b212ce8](https://github.com/sagemath/sagetrac-mirror/commit/b212ce8c65236d0b91713a9482d1de3ef6294310)|`build/pkgs/sagelib/spkg-install: Fix up error exits`|
|[5790687](https://github.com/sagemath/sagetrac-mirror/commit/5790687b9dbf244e1c6d49b42481d552e2d5537f)|`build/bin/write-dockerfile.sh: Do not ADD removed file src/Makefile.in`|



---

archive/issue_comments_575275.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/make_sagelib_a_script_package\" to \"public/make_sagelib_a_script_package\"",
    "created_at": "2020-06-15T12:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575275",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "u/mkoeppe/make_sagelib_a_script_package" to "public/make_sagelib_a_script_package"



---

archive/issue_comments_575276.json:
```json
{
    "body": "Changing commit from \"cc304711ef42f25733f1ca861801d87f58fa1118\" to \"5790687b9dbf244e1c6d49b42481d552e2d5537f\"",
    "created_at": "2020-06-15T12:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575276",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "cc304711ef42f25733f1ca861801d87f58fa1118" to "5790687b9dbf244e1c6d49b42481d552e2d5537f"



---

archive/issue_comments_575277.json:
```json
{
    "body": "Changing commit from \"5790687b9dbf244e1c6d49b42481d552e2d5537f\" to \"cc304711ef42f25733f1ca861801d87f58fa1118\"",
    "created_at": "2020-06-15T16:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575277",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "5790687b9dbf244e1c6d49b42481d552e2d5537f" to "cc304711ef42f25733f1ca861801d87f58fa1118"



---

archive/issue_comments_575278.json:
```json
{
    "body": "Changing branch from \"public/make_sagelib_a_script_package\" to \"u/mkoeppe/make_sagelib_a_script_package\"",
    "created_at": "2020-06-15T16:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575278",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "public/make_sagelib_a_script_package" to "u/mkoeppe/make_sagelib_a_script_package"



---

archive/issue_comments_575279.json:
```json
{
    "body": "Changing commit from \"cc304711ef42f25733f1ca861801d87f58fa1118\" to \"539c1828dd17c90e5baa63d814f2c84419146f90\"",
    "created_at": "2020-06-25T07:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575279",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cc304711ef42f25733f1ca861801d87f58fa1118" to "539c1828dd17c90e5baa63d814f2c84419146f90"



---

archive/issue_comments_575280.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-06-25T07:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575280",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_575281.json:
```json
{
    "body": "<a id='comment:56'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[539c182](https://github.com/sagemath/sagetrac-mirror/commit/539c1828dd17c90e5baa63d814f2c84419146f90)|`build/make/install: Do not depend on src/bin/sage-version.sh`|",
    "created_at": "2020-06-25T07:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575281",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[539c182](https://github.com/sagemath/sagetrac-mirror/commit/539c1828dd17c90e5baa63d814f2c84419146f90)|`build/make/install: Do not depend on src/bin/sage-version.sh`|



---

archive/issue_comments_575282.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-25T07:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575282",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_575283.json:
```json
{
    "body": "<a id='comment:57'></a>\nPushed to wrong ticket, sorry",
    "created_at": "2020-06-25T07:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575283",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'></a>
Pushed to wrong ticket, sorry



---

archive/issue_comments_575284.json:
```json
{
    "body": "Changing commit from \"539c1828dd17c90e5baa63d814f2c84419146f90\" to \"cc304711ef42f25733f1ca861801d87f58fa1118\"",
    "created_at": "2020-06-25T07:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575284",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "539c1828dd17c90e5baa63d814f2c84419146f90" to "cc304711ef42f25733f1ca861801d87f58fa1118"



---

archive/issue_comments_575285.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-06-25T07:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575285",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_575286.json:
```json
{
    "body": "<a id='comment:58'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2020-06-25T07:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575286",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_575287.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-25T07:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575287",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_084580.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-02T21:30:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29411#event-84580"
}
```



---

archive/issue_comments_575288.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/make_sagelib_a_script_package\" to \"cc304711ef42f25733f1ca861801d87f58fa1118\"",
    "created_at": "2020-07-02T21:30:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575288",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/make_sagelib_a_script_package" to "cc304711ef42f25733f1ca861801d87f58fa1118"



---

archive/issue_comments_575289.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-02T21:30:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575289",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_575290.json:
```json
{
    "body": "<a id='comment:61'></a>\nthis has caused a [breakage of jupyter notebook/server](https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!msg/sage-devel/mWTD0_iBwKc/SDZa965UAQAJ). Apparently some of its dependencies get  \"blessed\"\nby `./sage -b`, but no longer get blessed by `make build`.\n\n---\n\nRunning 'make build' on that ticket's commit in the develop branch (0bcd001f760ff724832c32b4f65fa575fd82e000 make sagelib a script package) produces the error for me whereas doing so on the immediately previous commit (10fb62408a9761bf91a95d9eb7d7f16a104924c7 Trac #29289: Remove support for installing old-style SPKGs, deprecated in Sage 6.9) does not. Interestingly, it's been sort of hit-and-miss on whether the error shows up when doing just a './sage -b'.\n\n\nOn Saturday, July 11, 2020 at 5:26:02 PM UTC-7, Paul Masson wrote:\n\n    Just built a ticket based on 9.2.beta3 and the same problem occurs.\n\n    On Saturday, July 11, 2020 at 4:09:56 PM UTC-7, Paul Masson wrote:\n\n        After a successful incremental build from 9.2.beta2, trying to start a new notebook results in the browser console error \"Failed to load resource: the server responded with a status of 404 (Not Found)\" when trying to fetch Mathjax from http://localhost:8888/nbextensions/mathjax/MathJax.js. Has anyone other than Dima seen this also?\n\n        This appears to be a serious server configuration error. I don't see any ticket in either this beta or the previous one that would cause this. Am I missing some new configuration step? Sage built and runs just fine.",
    "created_at": "2020-07-12T09:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575290",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:61'></a>
this has caused a [breakage of jupyter notebook/server](https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!msg/sage-devel/mWTD0_iBwKc/SDZa965UAQAJ). Apparently some of its dependencies get  "blessed"
by `./sage -b`, but no longer get blessed by `make build`.

---

Running 'make build' on that ticket's commit in the develop branch (0bcd001f760ff724832c32b4f65fa575fd82e000 make sagelib a script package) produces the error for me whereas doing so on the immediately previous commit (10fb62408a9761bf91a95d9eb7d7f16a104924c7 Trac #29289: Remove support for installing old-style SPKGs, deprecated in Sage 6.9) does not. Interestingly, it's been sort of hit-and-miss on whether the error shows up when doing just a './sage -b'.


On Saturday, July 11, 2020 at 5:26:02 PM UTC-7, Paul Masson wrote:

    Just built a ticket based on 9.2.beta3 and the same problem occurs.

    On Saturday, July 11, 2020 at 4:09:56 PM UTC-7, Paul Masson wrote:

        After a successful incremental build from 9.2.beta2, trying to start a new notebook results in the browser console error "Failed to load resource: the server responded with a status of 404 (Not Found)" when trying to fetch Mathjax from http://localhost:8888/nbextensions/mathjax/MathJax.js. Has anyone other than Dima seen this also?

        This appears to be a serious server configuration error. I don't see any ticket in either this beta or the previous one that would cause this. Am I missing some new configuration step? Sage built and runs just fine.



---

archive/issue_comments_575291.json:
```json
{
    "body": "Changing commit from \"cc304711ef42f25733f1ca861801d87f58fa1118\" to \"\"",
    "created_at": "2020-07-12T09:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575291",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "cc304711ef42f25733f1ca861801d87f58fa1118" to ""



---

archive/issue_comments_575292.json:
```json
{
    "body": "<a id='comment:62'></a>\nThis is now #30123",
    "created_at": "2020-07-12T18:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575292",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:62'></a>
This is now #30123



---

archive/issue_comments_575293.json:
```json
{
    "body": "<a id='comment:63'></a>\nThis broke `sage -b`: it wants to run `make` in a directory with no `Makefile`.",
    "created_at": "2020-07-16T03:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29411#issuecomment-575293",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:63'></a>
This broke `sage -b`: it wants to run `make` in a directory with no `Makefile`.
