# Issue 29785: Move Extension options from src/module_list.py to "distutils:" directives in the individual files (part 3: Get rid of uname_specific)

archive/issues_029548.json:
```json
{
    "body": "Follow-up from #29706.\n\nWe get rid of the use of `uname_specific` to define an `Extension` option in `module_list`, replacing it by use of `cython_aliases`.\n\n\n\n\nCC:  @kliem @kiwifb @dimpase @orlitzky\n\nBranch/Commit: 2ba1d7b7087536784391480d54c42a06ead2a6dd\n\nReviewer: Jonathan Kliem\n\nAuthor: Matthias Koeppe\n\nDependencies: #29706\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29785\n\n",
    "closed_at": "2020-06-26T15:38:08Z",
    "created_at": "2020-06-03T03:53:17Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Move Extension options from src/module_list.py to \"distutils:\" directives in the individual files (part 3: Get rid of uname_specific)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29785",
    "user": "https://github.com/mkoeppe"
}
```
Follow-up from #29706.

We get rid of the use of `uname_specific` to define an `Extension` option in `module_list`, replacing it by use of `cython_aliases`.




CC:  @kliem @kiwifb @dimpase @orlitzky

Branch/Commit: 2ba1d7b7087536784391480d54c42a06ead2a6dd

Reviewer: Jonathan Kliem

Author: Matthias Koeppe

Dependencies: #29706

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29785





---

archive/issue_comments_584108.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29706\"",
    "created_at": "2020-06-03T06:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584108",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29706"



---

archive/issue_comments_584109.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_3__get_rid_of_uname_specific_\"",
    "created_at": "2020-06-03T18:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584109",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_3__get_rid_of_uname_specific_"



---

archive/issue_comments_584110.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2020-06-03T18:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584110",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_584111.json:
```json
{
    "body": "Changing dependencies from \"#29706\" to \"\"",
    "created_at": "2020-06-03T18:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584111",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29706" to ""



---

archive/issue_comments_584112.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-06-03T18:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584112",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_584113.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-03T18:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584113",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_584114.json:
```json
{
    "body": "Changing commit from \"\" to \"0bd21a1f02ef0a74782f66aba621f40c3eb68467\"",
    "created_at": "2020-06-03T18:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584114",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "0bd21a1f02ef0a74782f66aba621f40c3eb68467"



---

archive/issue_comments_584115.json:
```json
{
    "body": "<a id='comment:6'></a>\n```\nFile \"src/sage/env.py\", line 384, in sage.env.cython_aliases\nFailed example:\n    sorted(cython_aliases().keys())\nExpected:\n    ['ARB_LIBRARY',\n     'FFLASFFPACK_CFLAGS',\n     'FFLASFFPACK_INCDIR',\n     'FFLASFFPACK_LIBDIR',\n     'FFLASFFPACK_LIBEXTRA',\n     'FFLASFFPACK_LIBRARIES',\n     'GIVARO_CFLAGS',\n     'GIVARO_INCDIR',\n     'GIVARO_LIBDIR',\n     'GIVARO_LIBEXTRA',\n     'GIVARO_LIBRARIES',\n     'GSL_CFLAGS',\n     'GSL_INCDIR',\n     'GSL_LIBDIR',\n     'GSL_LIBEXTRA',\n     'GSL_LIBRARIES',\n     'LINBOX_CFLAGS',\n     'LINBOX_INCDIR',\n     'LINBOX_LIBDIR',\n     'LINBOX_LIBEXTRA',\n     'LINBOX_LIBRARIES',\n     'SINGULAR_CFLAGS',\n     'SINGULAR_INCDIR',\n     'SINGULAR_LIBDIR',\n     'SINGULAR_LIBEXTRA',\n     'SINGULAR_LIBRARIES']\nGot:\n    ['ARB_LIBRARY',\n     'FFLASFFPACK_CFLAGS',\n     'FFLASFFPACK_INCDIR',\n     'FFLASFFPACK_LIBDIR',\n     'FFLASFFPACK_LIBEXTRA',\n     'FFLASFFPACK_LIBRARIES',\n     'GIVARO_CFLAGS',\n     'GIVARO_INCDIR',\n     'GIVARO_LIBDIR',\n     'GIVARO_LIBEXTRA',\n     'GIVARO_LIBRARIES',\n     'GSL_CFLAGS',\n     'GSL_INCDIR',\n     'GSL_LIBDIR',\n     'GSL_LIBEXTRA',\n     'GSL_LIBRARIES',\n     'LINBOX_CFLAGS',\n     'LINBOX_INCDIR',\n     'LINBOX_LIBDIR',\n     'LINBOX_LIBEXTRA',\n     'LINBOX_LIBRARIES',\n     'LINUX_NOEXECSTACK',\n     'SINGULAR_CFLAGS',\n     'SINGULAR_INCDIR',\n     'SINGULAR_LIBDIR',\n     'SINGULAR_LIBEXTRA',\n     'SINGULAR_LIBRARIES']\n```\n\nand pyflakes warnings:\n\n```\n+src/sage/env.py:153: undefined name 'HOSTNAME'\n+src/sage/env.py:162: undefined name 'SAGE_LOCAL'\n+src/sage/env.py:163: undefined name 'SAGE_LOCAL'\n+src/sage/env.py:164: undefined name 'SAGE_LOCAL'\n+src/sage/env.py:165: undefined name 'SAGE_SHARE'\n+src/sage/env.py:166: undefined name 'SAGE_LOCAL'\n+src/sage/env.py:168: undefined name 'SAGE_LIB'\n+src/sage/env.py:171: undefined name 'SAGE_ROOT'\n+src/sage/env.py:171: undefined name 'SAGE_LIB'\n+src/sage/env.py:172: undefined name 'SAGE_ROOT'\n+src/sage/env.py:172: undefined name 'SAGE_DOC'\n+src/sage/env.py:173: undefined name 'SAGE_ROOT'\n+src/sage/env.py:174: undefined name 'SAGE_ROOT'\n+src/sage/env.py:177: undefined name 'DOT_SAGE'\n+src/sage/env.py:180: undefined name 'SAGE_SHARE'\n+src/sage/env.py:181: undefined name 'SAGE_SHARE'\n+src/sage/env.py:182: undefined name 'SAGE_SHARE'\n+src/sage/env.py:183: undefined name 'SAGE_SHARE'\n+src/sage/env.py:184: undefined name 'SAGE_SHARE'\n+src/sage/env.py:185: undefined name 'SAGE_SHARE'\n+src/sage/env.py:186: undefined name 'SAGE_SHARE'\n+src/sage/env.py:187: undefined name 'SAGE_SHARE'\n+src/sage/env.py:188: undefined name 'SAGE_SHARE'\n+src/sage/env.py:189: undefined name 'SAGE_SHARE'\n+src/sage/env.py:190: undefined name 'SAGE_SHARE'\n+src/sage/env.py:191: undefined name 'SAGE_SHARE'\n+src/sage/env.py:192: undefined name 'SAGE_SHARE'\n+src/sage/env.py:193: undefined name 'SAGE_SHARE'\n+src/sage/env.py:194: undefined name 'SAGE_SHARE'\n+src/sage/env.py:195: undefined name 'SAGE_SHARE'\n+src/sage/env.py:251: undefined name 'SAGE_LOCAL'\n+src/sage/env.py:272: undefined name 'SAGE_LOCAL'\n+src/sage/env.py:299: undefined name 'DOT_SAGE'\n+src/sage/env.py:300: undefined name 'UNAME'\n+src/sage/env.py:316: undefined name 'UNAME'\n+src/sage/env.py:365: undefined name 'SAGE_SRC'\n+src/sage/env.py:365: undefined name 'SAGE_LIB'\n+src/sage/env.py:367: undefined name 'SAGE_INC'\n+src/sage/env.py:448: undefined name 'ARB_LIBRARY'\n+\n+found 39 pyflakes errors in the modified files\n```",
    "created_at": "2020-06-05T13:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584115",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>
```
File "src/sage/env.py", line 384, in sage.env.cython_aliases
Failed example:
    sorted(cython_aliases().keys())
Expected:
    ['ARB_LIBRARY',
     'FFLASFFPACK_CFLAGS',
     'FFLASFFPACK_INCDIR',
     'FFLASFFPACK_LIBDIR',
     'FFLASFFPACK_LIBEXTRA',
     'FFLASFFPACK_LIBRARIES',
     'GIVARO_CFLAGS',
     'GIVARO_INCDIR',
     'GIVARO_LIBDIR',
     'GIVARO_LIBEXTRA',
     'GIVARO_LIBRARIES',
     'GSL_CFLAGS',
     'GSL_INCDIR',
     'GSL_LIBDIR',
     'GSL_LIBEXTRA',
     'GSL_LIBRARIES',
     'LINBOX_CFLAGS',
     'LINBOX_INCDIR',
     'LINBOX_LIBDIR',
     'LINBOX_LIBEXTRA',
     'LINBOX_LIBRARIES',
     'SINGULAR_CFLAGS',
     'SINGULAR_INCDIR',
     'SINGULAR_LIBDIR',
     'SINGULAR_LIBEXTRA',
     'SINGULAR_LIBRARIES']
Got:
    ['ARB_LIBRARY',
     'FFLASFFPACK_CFLAGS',
     'FFLASFFPACK_INCDIR',
     'FFLASFFPACK_LIBDIR',
     'FFLASFFPACK_LIBEXTRA',
     'FFLASFFPACK_LIBRARIES',
     'GIVARO_CFLAGS',
     'GIVARO_INCDIR',
     'GIVARO_LIBDIR',
     'GIVARO_LIBEXTRA',
     'GIVARO_LIBRARIES',
     'GSL_CFLAGS',
     'GSL_INCDIR',
     'GSL_LIBDIR',
     'GSL_LIBEXTRA',
     'GSL_LIBRARIES',
     'LINBOX_CFLAGS',
     'LINBOX_INCDIR',
     'LINBOX_LIBDIR',
     'LINBOX_LIBEXTRA',
     'LINBOX_LIBRARIES',
     'LINUX_NOEXECSTACK',
     'SINGULAR_CFLAGS',
     'SINGULAR_INCDIR',
     'SINGULAR_LIBDIR',
     'SINGULAR_LIBEXTRA',
     'SINGULAR_LIBRARIES']
```

and pyflakes warnings:

```
+src/sage/env.py:153: undefined name 'HOSTNAME'
+src/sage/env.py:162: undefined name 'SAGE_LOCAL'
+src/sage/env.py:163: undefined name 'SAGE_LOCAL'
+src/sage/env.py:164: undefined name 'SAGE_LOCAL'
+src/sage/env.py:165: undefined name 'SAGE_SHARE'
+src/sage/env.py:166: undefined name 'SAGE_LOCAL'
+src/sage/env.py:168: undefined name 'SAGE_LIB'
+src/sage/env.py:171: undefined name 'SAGE_ROOT'
+src/sage/env.py:171: undefined name 'SAGE_LIB'
+src/sage/env.py:172: undefined name 'SAGE_ROOT'
+src/sage/env.py:172: undefined name 'SAGE_DOC'
+src/sage/env.py:173: undefined name 'SAGE_ROOT'
+src/sage/env.py:174: undefined name 'SAGE_ROOT'
+src/sage/env.py:177: undefined name 'DOT_SAGE'
+src/sage/env.py:180: undefined name 'SAGE_SHARE'
+src/sage/env.py:181: undefined name 'SAGE_SHARE'
+src/sage/env.py:182: undefined name 'SAGE_SHARE'
+src/sage/env.py:183: undefined name 'SAGE_SHARE'
+src/sage/env.py:184: undefined name 'SAGE_SHARE'
+src/sage/env.py:185: undefined name 'SAGE_SHARE'
+src/sage/env.py:186: undefined name 'SAGE_SHARE'
+src/sage/env.py:187: undefined name 'SAGE_SHARE'
+src/sage/env.py:188: undefined name 'SAGE_SHARE'
+src/sage/env.py:189: undefined name 'SAGE_SHARE'
+src/sage/env.py:190: undefined name 'SAGE_SHARE'
+src/sage/env.py:191: undefined name 'SAGE_SHARE'
+src/sage/env.py:192: undefined name 'SAGE_SHARE'
+src/sage/env.py:193: undefined name 'SAGE_SHARE'
+src/sage/env.py:194: undefined name 'SAGE_SHARE'
+src/sage/env.py:195: undefined name 'SAGE_SHARE'
+src/sage/env.py:251: undefined name 'SAGE_LOCAL'
+src/sage/env.py:272: undefined name 'SAGE_LOCAL'
+src/sage/env.py:299: undefined name 'DOT_SAGE'
+src/sage/env.py:300: undefined name 'UNAME'
+src/sage/env.py:316: undefined name 'UNAME'
+src/sage/env.py:365: undefined name 'SAGE_SRC'
+src/sage/env.py:365: undefined name 'SAGE_LIB'
+src/sage/env.py:367: undefined name 'SAGE_INC'
+src/sage/env.py:448: undefined name 'ARB_LIBRARY'
+
+found 39 pyflakes errors in the modified files
```



---

archive/issue_comments_584116.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29706\"",
    "created_at": "2020-06-07T18:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584116",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29706"



---

archive/issue_comments_584117.json:
```json
{
    "body": "<a id='comment:8'></a>The pyflakes warnings are ... flakes. These variables are injected into the globals dynamically.",
    "created_at": "2020-06-07T18:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584117",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>The pyflakes warnings are ... flakes. These variables are injected into the globals dynamically.



---

archive/issue_comments_584118.json:
```json
{
    "body": "Changing commit from \"0bd21a1f02ef0a74782f66aba621f40c3eb68467\" to \"2ba1d7b7087536784391480d54c42a06ead2a6dd\"",
    "created_at": "2020-06-07T18:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584118",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0bd21a1f02ef0a74782f66aba621f40c3eb68467" to "2ba1d7b7087536784391480d54c42a06ead2a6dd"



---

archive/issue_comments_584119.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2020-06-07T18:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584119",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_584120.json:
```json
{
    "body": "<a id='comment:10'></a>Merged in #29706, which makes the doctest more flexible",
    "created_at": "2020-06-07T18:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584120",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Merged in #29706, which makes the doctest more flexible



---

archive/issue_comments_584121.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n-... replacing it by use of `cython_aliases`.\n+Follow-up from #29706.\n+\n+We get rid of the use of `uname_specific` to define an `Extension` option in `module_list`, replacing it by use of `cython_aliases`.\n \n \n+\n``````\n",
    "created_at": "2020-06-09T03:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584121",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
-... replacing it by use of `cython_aliases`.
+Follow-up from #29706.
+
+We get rid of the use of `uname_specific` to define an `Extension` option in `module_list`, replacing it by use of `cython_aliases`.
 
 
+
``````




---

archive/issue_comments_584122.json:
```json
{
    "body": "<a id='comment:12'></a>Needs review",
    "created_at": "2020-06-12T20:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584122",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Needs review



---

archive/issue_comments_584123.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-13T09:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584123",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_584124.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jonathan Kliem\"",
    "created_at": "2020-06-13T09:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584124",
    "user": "https://github.com/kliem"
}
```

Changing reviewer from "" to "Jonathan Kliem"



---

archive/issue_comments_584125.json:
```json
{
    "body": "<a id='comment:13'></a>LGTM.",
    "created_at": "2020-06-13T09:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584125",
    "user": "https://github.com/kliem"
}
```

<a id='comment:13'></a>LGTM.



---

archive/issue_comments_584126.json:
```json
{
    "body": "<a id='comment:14'></a>Thanks!",
    "created_at": "2020-06-13T10:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584126",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Thanks!



---

archive/issue_comments_584127.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-06-26T15:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584127",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_584128.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_3__get_rid_of_uname_specific_\" to \"2ba1d7b7087536784391480d54c42a06ead2a6dd\"",
    "created_at": "2020-06-26T15:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29785#issuecomment-584128",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_3__get_rid_of_uname_specific_" to "2ba1d7b7087536784391480d54c42a06ead2a6dd"



---

archive/issue_events_076257.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-06-26T15:38:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29785",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29785#event-76257"
}
```
