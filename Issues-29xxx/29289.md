# Issue 29289: Remove support for installing old-style SPKGs, deprecated in Sage 6.9

archive/issues_029052.json:
```json
{
    "assignees": [],
    "body": "Old-style SPKGs were deprecated in #19158, merged in Sage 6.9.\n\nThere is only sparse evidence of non-broken old-style SPKGs:\n\n- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ - added as new-style package in #29834\n\n- `polytopes_db_4d` - added as new-style package in #26029\n\nWe remove support for old-style packages, but we keep the command `sage -p`, which can also be used for installing a new-style package without dependencies.\n\n\nDepends on #26029\nDepends on #29834\n\nCC:  @dimpase @embray @vbraun @jhpalmieri @orlitzky\n\nBranch/Commit: **[`c0fb6d4`](https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238)**\n\nReviewer: **Dima Pasechnik, John Palmieri, Matthias Koeppe**\n\nAuthor: **Matthias Koeppe, John Palmieri**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29289_\n\n",
    "closed_at": "2020-07-02T21:30:24Z",
    "created_at": "2020-03-06T22:06:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove support for installing old-style SPKGs, deprecated in Sage 6.9",
    "type": "issue",
    "updated_at": "2020-07-02T21:30:24Z",
    "url": "https://github.com/sagemath/sage/issues/29289",
    "user": "https://github.com/mkoeppe"
}
```
Old-style SPKGs were deprecated in #19158, merged in Sage 6.9.

There is only sparse evidence of non-broken old-style SPKGs:

- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ - added as new-style package in #29834

- `polytopes_db_4d` - added as new-style package in #26029

We remove support for old-style packages, but we keep the command `sage -p`, which can also be used for installing a new-style package without dependencies.


Depends on #26029
Depends on #29834

CC:  @dimpase @embray @vbraun @jhpalmieri @orlitzky

Branch/Commit: **[`c0fb6d4`](https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238)**

Reviewer: **Dima Pasechnik, John Palmieri, Matthias Koeppe**

Author: **Matthias Koeppe, John Palmieri**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/29289_





---

archive/issue_events_402682.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-06T22:06:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402682"
}
```



---

archive/issue_events_402683.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-06T22:06:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402683"
}
```



---

archive/issue_events_402684.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-06T22:06:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402684"
}
```



---

archive/issue_events_402685.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-06T22:06:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402685"
}
```



---

archive/issue_comments_459438.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n Old-style SPKGs were deprecated in #19158, merged in Sage 6.9.\n \n-There is no evidence that any non-broken old-style SPKGs exist. \n+There is only sparse evidence of non-broken old-style SPKGs:\n \n+- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ\n+\n+\n``````\n",
    "created_at": "2020-03-12T22:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459438",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,7 @@
 Old-style SPKGs were deprecated in #19158, merged in Sage 6.9.
 
-There is no evidence that any non-broken old-style SPKGs exist. 
+There is only sparse evidence of non-broken old-style SPKGs:
 
+- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ
+
+
``````




---

archive/issue_events_402686.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-25T18:18:35Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "title_is": "Remove support for installing old-style SPKGs, deprecated in Sage 6.9",
    "title_was": "Remove support for old-style SPKGs, deprecated in Sage 6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402686"
}
```



---

archive/issue_events_402687.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:10:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402687"
}
```



---

archive/issue_events_402688.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:10:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402688"
}
```



---

archive/issue_comments_459439.json:
```json
{
    "body": "Branch: **[u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)**",
    "created_at": "2020-06-08T07:17:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459439",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)**



---

archive/issue_events_402689.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-08T07:18:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402689"
}
```



---

archive/issue_comments_459440.json:
```json
{
    "body": "Commit: **[`6820fa7`](https://github.com/sagemath/sagetrac-mirror/commit/6820fa7fb9eb9a9468b44b5b962f4562ef835cc0)**",
    "created_at": "2020-06-08T07:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459440",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`6820fa7`](https://github.com/sagemath/sagetrac-mirror/commit/6820fa7fb9eb9a9468b44b5b962f4562ef835cc0)**



---

archive/issue_comments_459441.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-06-08T07:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459441",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_459442.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6820fa7fb9eb9a9468b44b5b962f4562ef835cc0\"><code>6820fa7</code></a></td><td><code>build/bin/sage-spkg, src/bin/sage: Remove support for installing old-style SPKGs</code></td></tr></table>\n",
    "created_at": "2020-06-08T07:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459442",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6820fa7fb9eb9a9468b44b5b962f4562ef835cc0"><code>6820fa7</code></a></td><td><code>build/bin/sage-spkg, src/bin/sage: Remove support for installing old-style SPKGs</code></td></tr></table>




---

archive/issue_comments_459443.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nthere is also an old style `polytopes_db_4d`, a huge download, 8Gb, see e.g. https://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/palp_database.html\n\nlet me see if I can have a go converting it.",
    "created_at": "2020-06-09T08:52:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459443",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

there is also an old style `polytopes_db_4d`, a huge download, 8Gb, see e.g. https://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/palp_database.html

let me see if I can have a go converting it.



---

archive/issue_events_402690.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-09T08:52:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402690"
}
```



---

archive/issue_events_402691.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-09T08:52:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402691"
}
```



---

archive/issue_comments_459444.json:
```json
{
    "body": "Dependencies: **#26029**",
    "created_at": "2020-06-09T21:54:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459444",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#26029**



---

archive/issue_comments_459445.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nsee #26029 for the new-style `polytopes_db_4d`\n\nI'll do the same with `cunningham_tables`",
    "created_at": "2020-06-09T21:54:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459445",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

see #26029 for the new-style `polytopes_db_4d`

I'll do the same with `cunningham_tables`



---

archive/issue_comments_459446.json:
```json
{
    "body": "Changed dependencies from **#26029** to **#26029, #29834**",
    "created_at": "2020-06-09T23:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459446",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#26029** to **#26029, #29834**



---

archive/issue_events_402692.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-09T23:32:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402692"
}
```



---

archive/issue_events_402693.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-09T23:32:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402693"
}
```



---

archive/issue_comments_459447.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n#29834 - converted cunningham_tables",
    "created_at": "2020-06-09T23:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459447",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

#29834 - converted cunningham_tables



---

archive/issue_comments_459448.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nlgtm - modulo the deps (which are not merged in the branch).",
    "created_at": "2020-06-10T08:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459448",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

lgtm - modulo the deps (which are not merged in the branch).



---

archive/issue_events_402694.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-10T08:50:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402694"
}
```



---

archive/issue_events_402695.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-10T08:50:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402695"
}
```



---

archive/issue_comments_459449.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-06-10T08:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459449",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_459450.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks!",
    "created_at": "2020-06-10T15:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459450",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks!



---

archive/issue_events_402696.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-06-16T22:38:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402696"
}
```



---

archive/issue_events_402697.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2020-06-16T22:38:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402697"
}
```



---

archive/issue_comments_459451.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0b6112766e17ca2a4c72698d866afea6a3693db\"><code>e0b6112</code></a></td><td><code>build/bin/sage-spkg, src/bin/sage: Remove support for installing old-style SPKGs</code></td></tr></table>\n",
    "created_at": "2020-06-16T22:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459451",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0b6112766e17ca2a4c72698d866afea6a3693db"><code>e0b6112</code></a></td><td><code>build/bin/sage-spkg, src/bin/sage: Remove support for installing old-style SPKGs</code></td></tr></table>




---

archive/issue_comments_459452.json:
```json
{
    "body": "Changed commit from **[`6820fa7`](https://github.com/sagemath/sagetrac-mirror/commit/6820fa7fb9eb9a9468b44b5b962f4562ef835cc0)** to **[`e0b6112`](https://github.com/sagemath/sagetrac-mirror/commit/e0b6112766e17ca2a4c72698d866afea6a3693db)**",
    "created_at": "2020-06-16T22:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459452",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6820fa7`](https://github.com/sagemath/sagetrac-mirror/commit/6820fa7fb9eb9a9468b44b5b962f4562ef835cc0)** to **[`e0b6112`](https://github.com/sagemath/sagetrac-mirror/commit/e0b6112766e17ca2a4c72698d866afea6a3693db)**



---

archive/issue_comments_459453.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nRebased on 9.2.beta1",
    "created_at": "2020-06-16T22:38:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459453",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Rebased on 9.2.beta1



---

archive/issue_events_402698.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-16T22:38:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402698"
}
```



---

archive/issue_events_402699.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-16T22:38:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402699"
}
```



---

archive/issue_events_402700.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-06-18T21:12:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402700"
}
```



---

archive/issue_events_402701.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-06-18T21:12:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402701"
}
```



---

archive/issue_comments_459454.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nFails doctests. From tests/cmdline.py:\n\n```\n        sage: out, err, ret = test_executable([\"sage\", \"-p\", \"--info\", \"--info\", \"sqlite\"])  # optional - build\n        sage: print(out)  # optional - build\n        Found local metadata for sqlite-...\n```",
    "created_at": "2020-06-18T21:12:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459454",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

Fails doctests. From tests/cmdline.py:

```
        sage: out, err, ret = test_executable(["sage", "-p", "--info", "--info", "sqlite"])  # optional - build
        sage: print(out)  # optional - build
        Found local metadata for sqlite-...
```



---

archive/issue_comments_459455.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThanks for catching this!",
    "created_at": "2020-06-18T21:16:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459455",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Thanks for catching this!



---

archive/issue_comments_459456.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nJeroen was a fan of `sage -p`, but I'm not sure why. Does it serve any purpose now? It was used (as in `tests/cmdline.py`) for non-old-style packages. Is it indeed redundant?",
    "created_at": "2020-06-18T21:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459456",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

Jeroen was a fan of `sage -p`, but I'm not sure why. Does it serve any purpose now? It was used (as in `tests/cmdline.py`) for non-old-style packages. Is it indeed redundant?



---

archive/issue_comments_459457.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI don't think they serve any purpose at this point, other than to confuse users. All known packages seem to have been converted (Dima did two remaining ones in #26029, #29834), and it's easy to convert a package should another one be spotted in the wild.\n\nI would say that the whole model of encouraging users to distribute their code in a packaging format specific to Sage (in fact, specific to Sage-the-distribution!) is outdated and far from best practices.  Users have found better ways to package code - see https://wiki.sagemath.org/SageMathExternalPackages .",
    "created_at": "2020-06-18T22:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459457",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

I don't think they serve any purpose at this point, other than to confuse users. All known packages seem to have been converted (Dima did two remaining ones in #26029, #29834), and it's easy to convert a package should another one be spotted in the wild.

I would say that the whole model of encouraging users to distribute their code in a packaging format specific to Sage (in fact, specific to Sage-the-distribution!) is outdated and far from best practices.  Users have found better ways to package code - see https://wiki.sagemath.org/SageMathExternalPackages .



---

archive/issue_comments_459458.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOh, rereading your comment, are you referring to the use of `sage -p` to install new-style packages?  I was actually not aware that that works, but it seems to do exactly the same as `sage -i`.",
    "created_at": "2020-06-18T22:07:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459458",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

Oh, rereading your comment, are you referring to the use of `sage -p` to install new-style packages?  I was actually not aware that that works, but it seems to do exactly the same as `sage -i`.



---

archive/issue_comments_459459.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOK, I see `-p` was documented as `-p [opts] [packages]-- install the given Sage packages, without dependency checking ` ...",
    "created_at": "2020-06-18T22:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459459",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

OK, I see `-p` was documented as `-p [opts] [packages]-- install the given Sage packages, without dependency checking ` ...



---

archive/issue_comments_459460.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI'll restore this option. Let's figure out if it should be deprecated.",
    "created_at": "2020-06-18T22:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459460",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

I'll restore this option. Let's figure out if it should be deprecated.



---

archive/issue_comments_459461.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSounds good. I'm completely fine with getting rid of the old-style packaging machinery, but I also think it's a good idea to keep `sage -p` for now, for its other use.",
    "created_at": "2020-06-18T22:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459461",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

Sounds good. I'm completely fine with getting rid of the old-style packaging machinery, but I also think it's a good idea to keep `sage -p` for now, for its other use.



---

archive/issue_comments_459462.json:
```json
{
    "body": "Changed commit from **[`e0b6112`](https://github.com/sagemath/sagetrac-mirror/commit/e0b6112766e17ca2a4c72698d866afea6a3693db)** to **[`f4f1121`](https://github.com/sagemath/sagetrac-mirror/commit/f4f112115f423f7414757b81803854d86ae19589)**",
    "created_at": "2020-06-18T22:30:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459462",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e0b6112`](https://github.com/sagemath/sagetrac-mirror/commit/e0b6112766e17ca2a4c72698d866afea6a3693db)** to **[`f4f1121`](https://github.com/sagemath/sagetrac-mirror/commit/f4f112115f423f7414757b81803854d86ae19589)**



---

archive/issue_comments_459463.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4f112115f423f7414757b81803854d86ae19589\"><code>f4f1121</code></a></td><td><code>build/bin/sage-spkg, src/bin/sage: Remove support for installing old-style SPKGs</code></td></tr></table>\n",
    "created_at": "2020-06-18T22:30:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459463",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4f112115f423f7414757b81803854d86ae19589"><code>f4f1121</code></a></td><td><code>build/bin/sage-spkg, src/bin/sage: Remove support for installing old-style SPKGs</code></td></tr></table>




---

archive/issue_events_402702.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-18T22:32:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402702"
}
```



---

archive/issue_events_402703.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-18T22:32:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402703"
}
```



---

archive/issue_comments_459464.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, John Palmieri**",
    "created_at": "2020-06-18T22:56:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459464",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, John Palmieri**



---

archive/issue_comments_459465.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nIt looks like more can be removed. I haven't tested these changes thoroughly; what do you think?\n\n```diff\ndiff --git a/build/bin/sage-spkg b/build/bin/sage-spkg\nindex c8d800fcae..620925a319 100755\n--- a/build/bin/sage-spkg\n+++ b/build/bin/sage-spkg\n@@ -255,10 +255,8 @@ if echo \"$PKG_SRC\" | grep / >/dev/null; then\n     echo >&2 \"Error: Installing old-style SPKGs is no longer supported\"\n     exit 1\n fi\n-# PKG_NAME is the last path component without .spkg\n-# This already reduces case 2b to case 2a.\n-PKG_NAME=`basename \"$PKG_SRC\" | sed 's/\\.spkg$//'`\n-PKG_BASE=`echo \"$PKG_NAME\" | sed 's/-.*//'`\n+PKG_NAME=\"$PKG_SRC\"\n+PKG_BASE=`echo \"$PKG_NAME\" | sed 's/-.*//'` # strip version number\n \n # USE_LOCAL_SCRIPTS is a flag that if non-empty will cause\n # this script to try to install the package using local metadata\n@@ -266,39 +264,31 @@ PKG_BASE=`echo \"$PKG_NAME\" | sed 's/-.*//'`\n # the value of this flag is set in the next codeblock\n USE_LOCAL_SCRIPTS=\n \n-if [ -f \"$PKG_SRC\" ]; then\n-    # PKG_SRC is a file.  If it is given by a relative path, prepend `pwd`\n-    # (reduce case 1b to 1a)\n-    if ! echo \"$PKG_SRC\" | grep '^/' >/dev/null; then\n-        PKG_SRC=\"`pwd`/$PKG_SRC\"\n-    fi\n-elif [ -z \"$PKG_HAS_PATH\" ]; then\n-    # If PKG_SRC is not an existing file and doesn't contain a slash,\n-    # we are in case 2a or 3.  If version in 2a matches the version in\n-    # build/pkgs or we are in case 3 use the local scripts, otherwise\n-    # we try to find a package in upstream\n-    PKG_VER=\"${PKG_NAME#${PKG_BASE}}\"\n-    PKG_VER=\"${PKG_VER#-}\"\n-    PKG_SCRIPTS=\"$SAGE_ROOT/build/pkgs/$PKG_BASE\"\n-    LOCAL_PKG_VER=`cat $PKG_SCRIPTS/package-version.txt 2>/dev/null`\n-    if [ -n \"$LOCAL_PKG_VER\" ] && [ -z \"$PKG_VER\" -o \"$PKG_VER\" = \"$LOCAL_PKG_VER\" ]; then\n-        PKG_VER=\"$LOCAL_PKG_VER\"\n-        if [ -z \"$PKG_VER\" ]; then\n-            PKG_NAME=\"${PKG_BASE}\"\n-        else\n-            PKG_NAME=\"${PKG_BASE}-${PKG_VER}\"\n-        fi\n-        USE_LOCAL_SCRIPTS=yes\n-        PKG_BASE_VER=`echo $PKG_VER | sed 's/\\.p[0-9][0-9]*$//'`\n-        PKG_NAME_UPSTREAM=`lookup_param tarball \"$PKG_SCRIPTS/checksums.ini\" | sed \"s/VERSION/$PKG_BASE_VER/\"`\n-        echo \"Found local metadata for $PKG_NAME\"\n-\n-        # Warning for experimental packages\n-        if [ x`cat \"$PKG_SCRIPTS/type\"` = x\"experimental\" -a $INFO = 0 ]; then\n-            if [ $YES != 1 ]; then\n-                # We use /dev/tty here because our output may be redirected\n-                # to a logfile, or line-buffered.\n-                write_to_tty <<EOF\n+# PKG_SRC should look like \"package-VERSION\" or just \"package\".\n+# If VERSION matches the version in build/pkgs or there is no version\n+# specified, use the local scripts; otherwise we try to find a package\n+# in upstream.\n+PKG_VER=\"${PKG_NAME#${PKG_BASE}}\"\n+PKG_VER=\"${PKG_VER#-}\"\n+PKG_SCRIPTS=\"$SAGE_ROOT/build/pkgs/$PKG_BASE\"\n+LOCAL_PKG_VER=`cat $PKG_SCRIPTS/package-version.txt 2>/dev/null`\n+PKG_VER=\"$LOCAL_PKG_VER\"\n+if [ -z \"$PKG_VER\" ]; then\n+    PKG_NAME=\"${PKG_BASE}\"\n+else\n+    PKG_NAME=\"${PKG_BASE}-${PKG_VER}\"\n+fi\n+USE_LOCAL_SCRIPTS=yes\n+PKG_BASE_VER=`echo $PKG_VER | sed 's/\\.p[0-9][0-9]*$//'`\n+PKG_NAME_UPSTREAM=`lookup_param tarball \"$PKG_SCRIPTS/checksums.ini\" | sed \"s/VERSION/$PKG_BASE_VER/\"`\n+echo \"Found local metadata for $PKG_NAME\"\n+\n+# Warning for experimental packages\n+if [ x`cat \"$PKG_SCRIPTS/type\"` = x\"experimental\" -a $INFO = 0 ]; then\n+    if [ $YES != 1 ]; then\n+        # We use /dev/tty here because our output may be redirected\n+        # to a logfile, or line-buffered.\n+        write_to_tty <<EOF\n =========================== WARNING ===========================\n You are about to download and install the experimental package\n $PKG_NAME.  This probably won't work at all for you! There\n@@ -306,36 +296,22 @@ is no guarantee that it will build correctly, or behave as\n expected. Use at your own risk!\n ===============================================================\n EOF\n-                if [ $? -ne 0 ]; then\n-                    echo \"Terminal not available for prompting.  Use 'sage -i -y $PKG_BASE'\"\n-                    echo \"to install experimental packages in non-interactive mode.\"\n-                    YES=-1\n-                fi\n-                if [ $YES != -1 ]; then\n-                    read -p \"Are you sure you want to continue [Y/n]? \" answer < /dev/tty > /dev/tty 2>&1\n-                else\n-                    answer=n\n-                fi\n-                case \"$answer\" in\n-                    n*|N*) exit 1;;\n-                esac\n-                # Confirm the user's input.  (This gives important\n-                # feedback to the user when output is redirected to a logfile.)\n-                echo > /dev/tty \"OK, installing $PKG_NAME now...\"\n-            fi\n+        if [ $? -ne 0 ]; then\n+            echo \"Terminal not available for prompting.  Use 'sage -i -y $PKG_BASE'\"\n+            echo \"to install experimental packages in non-interactive mode.\"\n+            YES=-1\n         fi\n-\n-    else\n-        cd \"$SAGE_DISTFILES\"\n-        for spkg in `ls -1t ${PKG_NAME}.spkg ${PKG_NAME}-*.spkg 2>/dev/null`; do\n-            if [ -f \"$spkg\" ]; then\n-                # Found a good package\n-                echo \"Found package $PKG_NAME in $SAGE_DISTFILES/$spkg\"\n-                PKG_SRC=\"`pwd`/$spkg\"\n-                PKG_NAME=`basename \"$spkg\" | sed 's/\\.spkg$//'`\n-                break\n-            fi\n-        done\n+        if [ $YES != -1 ]; then\n+            read -p \"Are you sure you want to continue [Y/n]? \" answer < /dev/tty > /dev/tty 2>&1\n+        else\n+            answer=n\n+        fi\n+        case \"$answer\" in\n+            n*|N*) exit 1;;\n+        esac\n+        # Confirm the user's input.  (This gives important\n+        # feedback to the user when output is redirected to a logfile.)\n+        echo > /dev/tty \"OK, installing $PKG_NAME now...\"\n     fi\n fi\n \n```",
    "created_at": "2020-06-18T23:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459465",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">comment:26</div>

It looks like more can be removed. I haven't tested these changes thoroughly; what do you think?

```diff
diff --git a/build/bin/sage-spkg b/build/bin/sage-spkg
index c8d800fcae..620925a319 100755
--- a/build/bin/sage-spkg
+++ b/build/bin/sage-spkg
@@ -255,10 +255,8 @@ if echo "$PKG_SRC" | grep / >/dev/null; then
     echo >&2 "Error: Installing old-style SPKGs is no longer supported"
     exit 1
 fi
-# PKG_NAME is the last path component without .spkg
-# This already reduces case 2b to case 2a.
-PKG_NAME=`basename "$PKG_SRC" | sed 's/\.spkg$//'`
-PKG_BASE=`echo "$PKG_NAME" | sed 's/-.*//'`
+PKG_NAME="$PKG_SRC"
+PKG_BASE=`echo "$PKG_NAME" | sed 's/-.*//'` # strip version number
 
 # USE_LOCAL_SCRIPTS is a flag that if non-empty will cause
 # this script to try to install the package using local metadata
@@ -266,39 +264,31 @@ PKG_BASE=`echo "$PKG_NAME" | sed 's/-.*//'`
 # the value of this flag is set in the next codeblock
 USE_LOCAL_SCRIPTS=
 
-if [ -f "$PKG_SRC" ]; then
-    # PKG_SRC is a file.  If it is given by a relative path, prepend `pwd`
-    # (reduce case 1b to 1a)
-    if ! echo "$PKG_SRC" | grep '^/' >/dev/null; then
-        PKG_SRC="`pwd`/$PKG_SRC"
-    fi
-elif [ -z "$PKG_HAS_PATH" ]; then
-    # If PKG_SRC is not an existing file and doesn't contain a slash,
-    # we are in case 2a or 3.  If version in 2a matches the version in
-    # build/pkgs or we are in case 3 use the local scripts, otherwise
-    # we try to find a package in upstream
-    PKG_VER="${PKG_NAME#${PKG_BASE}}"
-    PKG_VER="${PKG_VER#-}"
-    PKG_SCRIPTS="$SAGE_ROOT/build/pkgs/$PKG_BASE"
-    LOCAL_PKG_VER=`cat $PKG_SCRIPTS/package-version.txt 2>/dev/null`
-    if [ -n "$LOCAL_PKG_VER" ] && [ -z "$PKG_VER" -o "$PKG_VER" = "$LOCAL_PKG_VER" ]; then
-        PKG_VER="$LOCAL_PKG_VER"
-        if [ -z "$PKG_VER" ]; then
-            PKG_NAME="${PKG_BASE}"
-        else
-            PKG_NAME="${PKG_BASE}-${PKG_VER}"
-        fi
-        USE_LOCAL_SCRIPTS=yes
-        PKG_BASE_VER=`echo $PKG_VER | sed 's/\.p[0-9][0-9]*$//'`
-        PKG_NAME_UPSTREAM=`lookup_param tarball "$PKG_SCRIPTS/checksums.ini" | sed "s/VERSION/$PKG_BASE_VER/"`
-        echo "Found local metadata for $PKG_NAME"
-
-        # Warning for experimental packages
-        if [ x`cat "$PKG_SCRIPTS/type"` = x"experimental" -a $INFO = 0 ]; then
-            if [ $YES != 1 ]; then
-                # We use /dev/tty here because our output may be redirected
-                # to a logfile, or line-buffered.
-                write_to_tty <<EOF
+# PKG_SRC should look like "package-VERSION" or just "package".
+# If VERSION matches the version in build/pkgs or there is no version
+# specified, use the local scripts; otherwise we try to find a package
+# in upstream.
+PKG_VER="${PKG_NAME#${PKG_BASE}}"
+PKG_VER="${PKG_VER#-}"
+PKG_SCRIPTS="$SAGE_ROOT/build/pkgs/$PKG_BASE"
+LOCAL_PKG_VER=`cat $PKG_SCRIPTS/package-version.txt 2>/dev/null`
+PKG_VER="$LOCAL_PKG_VER"
+if [ -z "$PKG_VER" ]; then
+    PKG_NAME="${PKG_BASE}"
+else
+    PKG_NAME="${PKG_BASE}-${PKG_VER}"
+fi
+USE_LOCAL_SCRIPTS=yes
+PKG_BASE_VER=`echo $PKG_VER | sed 's/\.p[0-9][0-9]*$//'`
+PKG_NAME_UPSTREAM=`lookup_param tarball "$PKG_SCRIPTS/checksums.ini" | sed "s/VERSION/$PKG_BASE_VER/"`
+echo "Found local metadata for $PKG_NAME"
+
+# Warning for experimental packages
+if [ x`cat "$PKG_SCRIPTS/type"` = x"experimental" -a $INFO = 0 ]; then
+    if [ $YES != 1 ]; then
+        # We use /dev/tty here because our output may be redirected
+        # to a logfile, or line-buffered.
+        write_to_tty <<EOF
 =========================== WARNING ===========================
 You are about to download and install the experimental package
 $PKG_NAME.  This probably won't work at all for you! There
@@ -306,36 +296,22 @@ is no guarantee that it will build correctly, or behave as
 expected. Use at your own risk!
 ===============================================================
 EOF
-                if [ $? -ne 0 ]; then
-                    echo "Terminal not available for prompting.  Use 'sage -i -y $PKG_BASE'"
-                    echo "to install experimental packages in non-interactive mode."
-                    YES=-1
-                fi
-                if [ $YES != -1 ]; then
-                    read -p "Are you sure you want to continue [Y/n]? " answer < /dev/tty > /dev/tty 2>&1
-                else
-                    answer=n
-                fi
-                case "$answer" in
-                    n*|N*) exit 1;;
-                esac
-                # Confirm the user's input.  (This gives important
-                # feedback to the user when output is redirected to a logfile.)
-                echo > /dev/tty "OK, installing $PKG_NAME now..."
-            fi
+        if [ $? -ne 0 ]; then
+            echo "Terminal not available for prompting.  Use 'sage -i -y $PKG_BASE'"
+            echo "to install experimental packages in non-interactive mode."
+            YES=-1
         fi
-
-    else
-        cd "$SAGE_DISTFILES"
-        for spkg in `ls -1t ${PKG_NAME}.spkg ${PKG_NAME}-*.spkg 2>/dev/null`; do
-            if [ -f "$spkg" ]; then
-                # Found a good package
-                echo "Found package $PKG_NAME in $SAGE_DISTFILES/$spkg"
-                PKG_SRC="`pwd`/$spkg"
-                PKG_NAME=`basename "$spkg" | sed 's/\.spkg$//'`
-                break
-            fi
-        done
+        if [ $YES != -1 ]; then
+            read -p "Are you sure you want to continue [Y/n]? " answer < /dev/tty > /dev/tty 2>&1
+        else
+            answer=n
+        fi
+        case "$answer" in
+            n*|N*) exit 1;;
+        esac
+        # Confirm the user's input.  (This gives important
+        # feedback to the user when output is redirected to a logfile.)
+        echo > /dev/tty "OK, installing $PKG_NAME now..."
     fi
 fi
 
```



---

archive/issue_comments_459466.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI agree, please go ahead and push it to the branch.",
    "created_at": "2020-06-18T23:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459466",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

I agree, please go ahead and push it to the branch.



---

archive/issue_comments_459467.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)** to **[u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)**",
    "created_at": "2020-06-19T00:06:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459467",
    "user": "https://github.com/jhpalmieri"
}
```

Changed branch from **[u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)** to **[u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)**



---

archive/issue_comments_459468.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThis seems to work well.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238\"><code>c0fb6d4</code></a></td><td><code>trac 29289: remove more code for old-style packages</code></td></tr></table>\n",
    "created_at": "2020-06-19T00:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459468",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

This seems to work well.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238"><code>c0fb6d4</code></a></td><td><code>trac 29289: remove more code for old-style packages</code></td></tr></table>




---

archive/issue_comments_459469.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik, John Palmieri** to **Dima Pasechnik, John Palmieri, Matthias Koeppe**",
    "created_at": "2020-06-19T00:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459469",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Dima Pasechnik, John Palmieri** to **Dima Pasechnik, John Palmieri, Matthias Koeppe**



---

archive/issue_comments_459470.json:
```json
{
    "body": "Changed commit from **[`f4f1121`](https://github.com/sagemath/sagetrac-mirror/commit/f4f112115f423f7414757b81803854d86ae19589)** to **[`c0fb6d4`](https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238)**",
    "created_at": "2020-06-19T00:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459470",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`f4f1121`](https://github.com/sagemath/sagetrac-mirror/commit/f4f112115f423f7414757b81803854d86ae19589)** to **[`c0fb6d4`](https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238)**



---

archive/issue_comments_459471.json:
```json
{
    "body": "Changed author from **Matthias Koeppe** to **Matthias Koeppe, John Palmieri**",
    "created_at": "2020-06-19T00:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459471",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Matthias Koeppe** to **Matthias Koeppe, John Palmieri**



---

archive/issue_comments_459472.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,9 @@\n \n There is only sparse evidence of non-broken old-style SPKGs:\n \n-- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ\n+- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ - added as new-style package in #29834\n \n+- `polytopes_db_4d` - added as new-style package in #26029\n \n+We remove support for old-style packages, but we keep the command `sage -p`, which can also be used for installing a new-style package without dependencies.\n+\n``````\n",
    "created_at": "2020-06-19T00:31:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459472",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,9 @@
 
 There is only sparse evidence of non-broken old-style SPKGs:
 
-- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ
+- `cunningham_tables` - https://groups.google.com/d/msg/sage-support/T4IO-AmOsCM/HYy_N6UdAQAJ - added as new-style package in #29834
 
+- `polytopes_db_4d` - added as new-style package in #26029
 
+We remove support for old-style packages, but we keep the command `sage -p`, which can also be used for installing a new-style package without dependencies.
+
``````




---

archive/issue_comments_459473.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReady for review",
    "created_at": "2020-06-19T15:14:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459473",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Ready for review



---

archive/issue_comments_459474.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThis works for me, too.",
    "created_at": "2020-06-19T15:55:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459474",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

This works for me, too.



---

archive/issue_events_402704.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-06-19T15:56:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402704"
}
```



---

archive/issue_events_402705.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2020-06-19T15:56:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402705"
}
```



---

archive/issue_comments_459475.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nLet's move ahead with it.",
    "created_at": "2020-06-19T15:56:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459475",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:33" align="right">comment:33</div>

Let's move ahead with it.



---

archive/issue_comments_459476.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThanks!",
    "created_at": "2020-06-19T16:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459476",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Thanks!



---

archive/issue_comments_459477.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)** to **[`c0fb6d4`](https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238)**",
    "created_at": "2020-07-02T21:30:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29289#issuecomment-459477",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/remove_support_for_installing_old_style_spkgs__deprecated_in_sage_6_9)** to **[`c0fb6d4`](https://github.com/sagemath/sagetrac-mirror/commit/c0fb6d47362a1d52ede61e57ef5b7777045ce238)**



---

archive/issue_events_402706.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-02T21:30:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402706"
}
```



---

archive/issue_events_402707.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "10fb62408a9761bf91a95d9eb7d7f16a104924c7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-07-02T21:30:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29289",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29289#event-402707"
}
```
