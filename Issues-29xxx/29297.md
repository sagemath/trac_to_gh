# Issue 29297: Special case is_unitary() for trivial RDF/CDF matrices

archive/issues_029060.json:
```json
{
    "body": "We have a doctest ensuring that `is_unitary()` crashes for trivial RDF/CDF matrices:\n\n```\nThe smallest cases.  The Schur decomposition used by the\northonormal algorithm will fail on a matrix of size zero.  ::\n\n    sage: P = matrix(CDF, 0, 0,)\n    sage: P.is_unitary(algorithm='orthonormal')\n    Traceback (most recent call last):\n    ...\n    error: ((lwork==-1)||(lwork >= MAX(1,2*n))) failed for 3rd keyword lwork: zgees:lwork=0\n```\n\nIgnoring the value of such a test for the time being... it's failing for me due to some change in a library:\n\n```\nFailed example:\n    P.is_unitary(algorithm='orthonormal')\nExpected:\n    Traceback (most recent call last):\n    ...\n    error: ((lwork==-1)||(lwork >= MAX(1,2*n))) failed for 3rd keyword lwork: zgees:lwork=0\nGot:\n    ...\n    ValueError: On entry to ZGEES parameter number 6 had an illegal value\n```\n\nRather than try to accommodate both error messages... let's just make it work.\n\nBranch/Commit: cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a\n\nReviewer: Markus Wageringel\n\nAuthor: Michael Orlitzky\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29297\n\n",
    "closed_at": "2020-03-11T23:46:07Z",
    "created_at": "2020-03-08T01:26:56Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Special case is_unitary() for trivial RDF/CDF matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29297",
    "user": "https://github.com/orlitzky"
}
```
We have a doctest ensuring that `is_unitary()` crashes for trivial RDF/CDF matrices:

```
The smallest cases.  The Schur decomposition used by the
orthonormal algorithm will fail on a matrix of size zero.  ::

    sage: P = matrix(CDF, 0, 0,)
    sage: P.is_unitary(algorithm='orthonormal')
    Traceback (most recent call last):
    ...
    error: ((lwork==-1)||(lwork >= MAX(1,2*n))) failed for 3rd keyword lwork: zgees:lwork=0
```

Ignoring the value of such a test for the time being... it's failing for me due to some change in a library:

```
Failed example:
    P.is_unitary(algorithm='orthonormal')
Expected:
    Traceback (most recent call last):
    ...
    error: ((lwork==-1)||(lwork >= MAX(1,2*n))) failed for 3rd keyword lwork: zgees:lwork=0
Got:
    ...
    ValueError: On entry to ZGEES parameter number 6 had an illegal value
```

Rather than try to accommodate both error messages... let's just make it work.

Branch/Commit: cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a

Reviewer: Markus Wageringel

Author: Michael Orlitzky

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29297





---

archive/issue_comments_571384.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|\n|[cc3eb9f](https://git.sagemath.org/sage.git/commit?id=cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a)|`Trac #29297: add special case to is_unitary() for trivial RDF/CDF matrices.`|",
    "created_at": "2020-03-08T01:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571384",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
|[cc3eb9f](https://git.sagemath.org/sage.git/commit?id=cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a)|`Trac #29297: add special case to is_unitary() for trivial RDF/CDF matrices.`|



---

archive/issue_comments_571385.json:
```json
{
    "body": "Changing author from \"\" to \"Michael Orlitzky\"",
    "created_at": "2020-03-08T01:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571385",
    "user": "https://github.com/orlitzky"
}
```

Changing author from "" to "Michael Orlitzky"



---

archive/issue_comments_571386.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-03-08T01:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571386",
    "user": "https://github.com/orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_571387.json:
```json
{
    "body": "Changing commit from \"\" to \"cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a\"",
    "created_at": "2020-03-08T01:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571387",
    "user": "https://github.com/orlitzky"
}
```

Changing commit from "" to "cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a"



---

archive/issue_comments_571388.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mjo/ticket/29297\"",
    "created_at": "2020-03-08T01:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571388",
    "user": "https://github.com/orlitzky"
}
```

Changing branch from "" to "u/mjo/ticket/29297"



---

archive/issue_comments_571389.json:
```json
{
    "body": "<a id='comment:2'></a>\nI have also observed this issue when building Sage with ATLAS. Thanks for the fix.",
    "created_at": "2020-03-08T12:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571389",
    "user": "https://github.com/mwageringel"
}
```

<a id='comment:2'></a>
I have also observed this issue when building Sage with ATLAS. Thanks for the fix.



---

archive/issue_comments_571390.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Markus Wageringel\"",
    "created_at": "2020-03-08T12:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571390",
    "user": "https://github.com/mwageringel"
}
```

Changing reviewer from "" to "Markus Wageringel"



---

archive/issue_comments_571391.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-08T12:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571391",
    "user": "https://github.com/mwageringel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_074529.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-11T23:46:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29297#event-74529"
}
```



---

archive/issue_comments_571392.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-11T23:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571392",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_571393.json:
```json
{
    "body": "Changing branch from \"u/mjo/ticket/29297\" to \"cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a\"",
    "created_at": "2020-03-11T23:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29297",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29297#issuecomment-571393",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mjo/ticket/29297" to "cc3eb9ffa991e328b09028d32aab7e7cc2ddbb6a"
