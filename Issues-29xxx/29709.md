# Issue 29709: Frobenius on elliptic curves in Weierstrass form

archive/issues_029472.json:
```json
{
    "assignees": [],
    "body": "The code for computing Frobenius on a point on an elliptic curve over a p-adic field would like the elliptic curve to be in the form y<sup>2</sup> = f(x). So it should raise an error if one of a_1 or a_3 is not zero, but instead it checks if one of  a_1  or a_2 is not zero:\n\n```\nsage: E = EllipticCurve([0,1,0,1,1])\nsage: E\nElliptic Curve defined by y^2 = x^3 + x^2 + x + 1 over Rational Field\nsage: EK = E.change_ring(Qp(7,10))\nsage: EK.frobenius(EK(1,2))\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-4-77549f6ac826> in <module>()\n----> 1 EK.frobenius(EK(Integer(1),Integer(2)))\n\n/ext/sage/sage-8.9_1804/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_padic_field.pyc in frobenius(self, P)\n     71             a1, a2, a3, a4, a6 = self.a_invariants()\n     72             if a1 != 0 or a2 != 0:\n---> 73                 raise NotImplementedError(\"Curve must be in weierstrass normal form.\")\n     74 \n     75             f = x*x*x + a2*x*x + a4*x + a6\n\nNotImplementedError: Curve must be in weierstrass normal form.\n```\n\nNote that one can work around this by pretending the elliptic curve is a hyperelliptic curve:\n\n```\nsage: R.<x> = QQ['x']\nsage: H = HyperellipticCurve(x^3 + x^2 + x + 1)\nsage: HK = H.change_ring(Qp(7,10))\nsage: HK.frobenius(HK(1,2))\n(1 + O(7^10) : 2 + O(7^10) : 1 + O(7^10))\n```\nso this isn't urgent, but it'd be nice to fix.\n\n\nCC:  @roed314 @edgarcosta\n\nKeywords: **padics, elliptic curves**\n\nBranch/Commit: **[3a39e96](https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46)**\n\nReviewer: **Kiran Kedlaya**\n\nAuthor: **Alex J. Best**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29709_\n\n",
    "closed_at": "2020-08-23T16:28:06Z",
    "created_at": "2020-05-18T17:43:17Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Frobenius on elliptic curves in Weierstrass form",
    "type": "issue",
    "updated_at": "2020-08-23T16:28:06Z",
    "url": "https://github.com/sagemath/sage/issues/29709",
    "user": "https://github.com/jbalakrishnan"
}
```
The code for computing Frobenius on a point on an elliptic curve over a p-adic field would like the elliptic curve to be in the form y<sup>2</sup> = f(x). So it should raise an error if one of a_1 or a_3 is not zero, but instead it checks if one of  a_1  or a_2 is not zero:

```
sage: E = EllipticCurve([0,1,0,1,1])
sage: E
Elliptic Curve defined by y^2 = x^3 + x^2 + x + 1 over Rational Field
sage: EK = E.change_ring(Qp(7,10))
sage: EK.frobenius(EK(1,2))
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-4-77549f6ac826> in <module>()
----> 1 EK.frobenius(EK(Integer(1),Integer(2)))

/ext/sage/sage-8.9_1804/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_padic_field.pyc in frobenius(self, P)
     71             a1, a2, a3, a4, a6 = self.a_invariants()
     72             if a1 != 0 or a2 != 0:
---> 73                 raise NotImplementedError("Curve must be in weierstrass normal form.")
     74 
     75             f = x*x*x + a2*x*x + a4*x + a6

NotImplementedError: Curve must be in weierstrass normal form.
```

Note that one can work around this by pretending the elliptic curve is a hyperelliptic curve:

```
sage: R.<x> = QQ['x']
sage: H = HyperellipticCurve(x^3 + x^2 + x + 1)
sage: HK = H.change_ring(Qp(7,10))
sage: HK.frobenius(HK(1,2))
(1 + O(7^10) : 2 + O(7^10) : 1 + O(7^10))
```
so this isn't urgent, but it'd be nice to fix.


CC:  @roed314 @edgarcosta

Keywords: **padics, elliptic curves**

Branch/Commit: **[3a39e96](https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46)**

Reviewer: **Kiran Kedlaya**

Author: **Alex J. Best**

_Issue created by migration from https://trac.sagemath.org/ticket/29709_





---

archive/issue_events_390559.json:
```json
{
    "actor": "https://github.com/jbalakrishnan",
    "created_at": "2020-05-18T17:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390559"
}
```



---

archive/issue_events_390560.json:
```json
{
    "actor": "https://github.com/jbalakrishnan",
    "created_at": "2020-05-18T17:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390560"
}
```



---

archive/issue_events_390561.json:
```json
{
    "actor": "https://github.com/jbalakrishnan",
    "created_at": "2020-05-18T17:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390561"
}
```



---

archive/issue_events_390562.json:
```json
{
    "actor": "https://github.com/jbalakrishnan",
    "created_at": "2020-05-18T17:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390562"
}
```



---

archive/issue_comments_471475.json:
```json
{
    "body": "Branch: **[u/alexjbest/29709](https://github.com/sagemath/sagetrac-mirror/tree/u/alexjbest/29709)**",
    "created_at": "2020-08-11T04:56:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471475",
    "user": "https://github.com/alexjbest"
}
```

Branch: **[u/alexjbest/29709](https://github.com/sagemath/sagetrac-mirror/tree/u/alexjbest/29709)**



---

archive/issue_comments_471476.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46\">3a39e96</a></td><td><code>fix 29709 by checking correct a invariant</code></td></tr></table>\n",
    "created_at": "2020-08-11T04:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471476",
    "user": "https://github.com/alexjbest"
}
```

<div id="comment:2" align="right">Comment 2</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46">3a39e96</a></td><td><code>fix 29709 by checking correct a invariant</code></td></tr></table>




---

archive/issue_comments_471477.json:
```json
{
    "body": "Commit: **[3a39e96](https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46)**",
    "created_at": "2020-08-11T04:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471477",
    "user": "https://github.com/alexjbest"
}
```

Commit: **[3a39e96](https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46)**



---

archive/issue_comments_471478.json:
```json
{
    "body": "Author: **Alex J. Best**",
    "created_at": "2020-08-11T04:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471478",
    "user": "https://github.com/alexjbest"
}
```

Author: **Alex J. Best**



---

archive/issue_events_390563.json:
```json
{
    "actor": "https://github.com/alexjbest",
    "created_at": "2020-08-11T04:57:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390563"
}
```



---

archive/issue_comments_471479.json:
```json
{
    "body": "Changed keywords from none to **padics, elliptic curves**",
    "created_at": "2020-08-11T04:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471479",
    "user": "https://github.com/alexjbest"
}
```

Changed keywords from none to **padics, elliptic curves**



---

archive/issue_comments_471480.json:
```json
{
    "body": "Reviewer: **Kiran Kedlaya**",
    "created_at": "2020-08-11T23:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471480",
    "user": "https://github.com/kedlaya"
}
```

Reviewer: **Kiran Kedlaya**



---

archive/issue_comments_471481.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nLooks fine to me. Once patchbot comes up green, you can set this to positive review.",
    "created_at": "2020-08-11T23:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471481",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:3" align="right">Comment 3</div>

Looks fine to me. Once patchbot comes up green, you can set this to positive review.



---

archive/issue_events_390564.json:
```json
{
    "actor": "https://github.com/alexjbest",
    "created_at": "2020-08-12T22:04:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390564"
}
```



---

archive/issue_events_390565.json:
```json
{
    "actor": "https://github.com/alexjbest",
    "created_at": "2020-08-12T22:04:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390565"
}
```



---

archive/issue_comments_471482.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThanks!",
    "created_at": "2020-08-12T22:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471482",
    "user": "https://github.com/alexjbest"
}
```

<div id="comment:4" align="right">Comment 4</div>

Thanks!



---

archive/issue_events_390566.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-23T16:28:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390566"
}
```



---

archive/issue_events_390567.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b9fd68f163d682e370880bb7824d2eaf00fb5c57",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-23T16:28:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29709#event-390567"
}
```



---

archive/issue_comments_471483.json:
```json
{
    "body": "Changed branch from **[u/alexjbest/29709](https://github.com/sagemath/sagetrac-mirror/tree/u/alexjbest/29709)** to **[3a39e96](https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46)**",
    "created_at": "2020-08-23T16:28:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29709#issuecomment-471483",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/alexjbest/29709](https://github.com/sagemath/sagetrac-mirror/tree/u/alexjbest/29709)** to **[3a39e96](https://github.com/sagemath/sagetrac-mirror/commit/3a39e9628694f8f74020cbe31257800a05028a46)**
