# Issue 29555: Upgrade: OpenSSL 3.0, make it a standard package

archive/issues_029318.json:
```json
{
    "body": "Upgrade to OpenSSL 3.0 and make openssl a standard package.\n\nLicense is now Apache 2.0, which is GPL-compatible.\nhttps://github.com/openssl/openssl/blob/master/LICENSE\n\nOnce Sage macOS binaries ship OpenSSL,\nthey will allow easily pip-installing extra packages.\n\nDownload tarball from:\n- https://ftp.openssl.org/source/\n\nCC:  @slel @NathanDunfield tmonteil @orlitzky @dimpase @posita @vbraun\n\nKeywords: openssl\n\nBranch/Commit: 383a10029e5ab56b0ba58950635ccdb75fd6d611\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29555\n\n",
    "closed_at": "2021-02-20T10:46:30Z",
    "created_at": "2020-04-23T15:49:29Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Upgrade: OpenSSL 3.0, make it a standard package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29555",
    "user": "https://github.com/slel"
}
```
Upgrade to OpenSSL 3.0 and make openssl a standard package.

License is now Apache 2.0, which is GPL-compatible.
https://github.com/openssl/openssl/blob/master/LICENSE

Once Sage macOS binaries ship OpenSSL,
they will allow easily pip-installing extra packages.

Download tarball from:
- https://ftp.openssl.org/source/

CC:  @slel @NathanDunfield tmonteil @orlitzky @dimpase @posita @vbraun

Keywords: openssl

Branch/Commit: 383a10029e5ab56b0ba58950635ccdb75fd6d611

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29555





---

archive/issue_comments_415219.json:
```json
{
    "body": "<a id='comment:1'></a>OpenSSL 3.0.0-alpha1 is out. Blog post:\nhttps://www.openssl.org/blog/blog/2020/04/23/OpenSSL3.0Alpha1/\n\nOpenSSL 3.0.0-alpha1 tarball:\n- https://ftp.openssl.org/source/openssl-3.0.0-alpha1.tar.gz",
    "created_at": "2020-04-23T15:51:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415219",
    "user": "https://github.com/slel"
}
```

<a id='comment:1'></a>OpenSSL 3.0.0-alpha1 is out. Blog post:
https://www.openssl.org/blog/blog/2020/04/23/OpenSSL3.0Alpha1/

OpenSSL 3.0.0-alpha1 tarball:
- https://ftp.openssl.org/source/openssl-3.0.0-alpha1.tar.gz



---

archive/issue_comments_415220.json:
```json
{
    "body": "<a id='comment:2'></a>Time to make openssl a standard package too. Related tickets:\n- #24107 Inclusion of OpenSSL, stage 1\n- #23893 make openssl a dependency for pip packages",
    "created_at": "2020-04-23T15:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415220",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'></a>Time to make openssl a standard package too. Related tickets:
- #24107 Inclusion of OpenSSL, stage 1
- #23893 make openssl a dependency for pip packages



---

archive/issue_comments_415221.json:
```json
{
    "body": "Changing keywords from \"\" to \"openssl\".",
    "created_at": "2020-04-23T16:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415221",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "openssl".



---

archive/issue_comments_415222.json:
```json
{
    "body": "<a id='comment:6'></a>https://www.openssl.org/source/openssl-3.0.0-alpha3.tar.gz is out now",
    "created_at": "2020-06-09T00:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415222",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>https://www.openssl.org/source/openssl-3.0.0-alpha3.tar.gz is out now



---

archive/issue_comments_415223.json:
```json
{
    "body": "<a id='comment:8'></a>Of course it's too early to merge, but I wanted to check whether our python3 compiles with it. It does, at least on macOS.\n\n---\nNew commits:",
    "created_at": "2020-06-09T01:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415223",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Of course it's too early to merge, but I wanted to check whether our python3 compiles with it. It does, at least on macOS.

---
New commits:



---

archive/issue_comments_415224.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T01:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415225.json:
```json
{
    "body": "<a id='comment:10'></a>Next (other than waiting for the release), we need an spkg-configure.m4 for openssl",
    "created_at": "2020-06-09T01:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415225",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Next (other than waiting for the release), we need an spkg-configure.m4 for openssl



---

archive/issue_comments_415226.json:
```json
{
    "body": "<a id='comment:12'></a>Now there's openssl-3.0.0-alpha4",
    "created_at": "2020-07-06T23:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415226",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Now there's openssl-3.0.0-alpha4



---

archive/issue_comments_415227.json:
```json
{
    "body": "<a id='comment:13'></a>OpenSSL 3.0.0.alpha6 is out.",
    "created_at": "2020-08-07T00:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415227",
    "user": "https://github.com/slel"
}
```

<a id='comment:13'></a>OpenSSL 3.0.0.alpha6 is out.



---

archive/issue_events_075429.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29555#event-75429"
}
```



---

archive/issue_comments_415228.json:
```json
{
    "body": "<a id='comment:16'></a>alpha9 is out...",
    "created_at": "2020-12-15T04:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415228",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>alpha9 is out...



---

archive/issue_comments_415229.json:
```json
{
    "body": "<a id='comment:17'></a>alpha10 is out",
    "created_at": "2021-01-19T21:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415229",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>alpha10 is out



---

archive/issue_comments_415230.json:
```json
{
    "body": "<a id='comment:18'></a>alpha11",
    "created_at": "2021-01-28T16:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415230",
    "user": "https://github.com/slel"
}
```

<a id='comment:18'></a>alpha11



---

archive/issue_comments_415231.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-31T19:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415232.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-31T21:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415232",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415233.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-31T21:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415233",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_415234.json:
```json
{
    "body": "<a id='comment:21'></a>Wondering how people would feel about this one. Solves our openssl license compatibility problem. Includes big fat warning that it's an alpha release. To my understanding, the way that current jupyter depends on the ssl module (via `tornado` - see 30674), it is merely a dependency and no SSL is actually spoken to anyone but possibly localhost.\n\nSSL would still kick in when pip packages are installed - but these are all optional and users have been warned.",
    "created_at": "2021-01-31T21:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415234",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Wondering how people would feel about this one. Solves our openssl license compatibility problem. Includes big fat warning that it's an alpha release. To my understanding, the way that current jupyter depends on the ssl module (via `tornado` - see 30674), it is merely a dependency and no SSL is actually spoken to anyone but possibly localhost.

SSL would still kick in when pip packages are installed - but these are all optional and users have been warned.



---

archive/issue_comments_415235.json:
```json
{
    "body": "<a id='comment:22'></a>I would prefer that we stick to 1.1.1* until openssl 3.0 is released, the current 3.0 is not even beta !",
    "created_at": "2021-01-31T21:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415235",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:22'></a>I would prefer that we stick to 1.1.1* until openssl 3.0 is released, the current 3.0 is not even beta !



---

archive/issue_comments_415236.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 tmonteil]:\n> I would prefer that we stick to 1.1.1* until openssl 3.0 is released, the current 3.0 is not even beta !\n\n\nCurrently, the macOS binaries don't have any version of openssl at all.  So there, the choice is 3.0 alpha or nothing, meaning the user is unable to run Jupyter notebooks, which is a pretty core feature of Sage for many users.\n\nI say go for it, the current situation is causing a lot of people problems, see all the posts to sage-support and sage-devel.",
    "created_at": "2021-02-01T03:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415236",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:23'></a>Replying to [comment:22 tmonteil]:
> I would prefer that we stick to 1.1.1* until openssl 3.0 is released, the current 3.0 is not even beta !


Currently, the macOS binaries don't have any version of openssl at all.  So there, the choice is 3.0 alpha or nothing, meaning the user is unable to run Jupyter notebooks, which is a pretty core feature of Sage for many users.

I say go for it, the current situation is causing a lot of people problems, see all the posts to sage-support and sage-devel.



---

archive/issue_comments_415237.json:
```json
{
    "body": "<a id='comment:24'></a>Could this be only shipped with macOS binaries ?",
    "created_at": "2021-02-01T10:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415237",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:24'></a>Could this be only shipped with macOS binaries ?



---

archive/issue_comments_415238.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 tmonteil]:\n> Could this be only shipped with macOS binaries ?\n\n\nOn Linux, Sage doesn't need to provide its own copy of openssl, it just uses the system library.  The problem is macOS deprecated openssl in favor of their own APIs and only provides openssl 0.9.8, which is too old to be useful.",
    "created_at": "2021-02-01T14:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415238",
    "user": "https://github.com/NathanDunfield"
}
```

<a id='comment:25'></a>Replying to [comment:24 tmonteil]:
> Could this be only shipped with macOS binaries ?


On Linux, Sage doesn't need to provide its own copy of openssl, it just uses the system library.  The problem is macOS deprecated openssl in favor of their own APIs and only provides openssl 0.9.8, which is too old to be useful.



---

archive/issue_comments_415239.json:
```json
{
    "body": "<a id='comment:26'></a>Another idea could be to make openssl 3.0 standard (as on this ticket) but keep the stable (but license-incompatible) openssl 1.1.x as an optional package.  So people who need to deploy a secure system but cannot do so using a system installation of openssl would be enable this optional package.  But it is not clear whether this is a convincing use case that would warrant adding this kind of build system complexity for it.",
    "created_at": "2021-02-02T19:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415239",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>Another idea could be to make openssl 3.0 standard (as on this ticket) but keep the stable (but license-incompatible) openssl 1.1.x as an optional package.  So people who need to deploy a secure system but cannot do so using a system installation of openssl would be enable this optional package.  But it is not clear whether this is a convincing use case that would warrant adding this kind of build system complexity for it.



---

archive/issue_comments_415240.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:24 tmonteil]:\n> Could this be only shipped with macOS binaries ?\n\nThese issues with ssl also affect people who build from source.",
    "created_at": "2021-02-02T19:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415240",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>Replying to [comment:24 tmonteil]:
> Could this be only shipped with macOS binaries ?

These issues with ssl also affect people who build from source.



---

archive/issue_comments_415241.json:
```json
{
    "body": "<a id='comment:28'></a>I suppose this is tested on macOS. On Linux it's fine.",
    "created_at": "2021-02-03T00:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415241",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>I suppose this is tested on macOS. On Linux it's fine.



---

archive/issue_comments_415242.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-02-03T00:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415242",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415243.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 mkoeppe]:\n> Replying to [comment:24 tmonteil]:\n> > Could this be only shipped with macOS binaries ?\n\n> These issues with ssl also affect people who build from source.\n\nI imagine the people that build from source use a decent distribution of packages that includes `openssl` like homebrew, as recommended in the Sage installation documenation.\n\nI do not like the current way as it will install an immature implementation of SSL within Sage for most people, since even on some OS that ship `openssl-dev`, this latter is rarely installed by default, see e.g. https://ask.sagemath.org/question/47513/rise-in-jupyter/\n\nThe warning are probably not enough (and probably lost among tons of configure lines) since people will just go ahead and \"prefer\" using the standard `openssl` spkg over installing the lib from their distro.",
    "created_at": "2021-02-03T01:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415243",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:29'></a>Replying to [comment:27 mkoeppe]:
> Replying to [comment:24 tmonteil]:
> > Could this be only shipped with macOS binaries ?

> These issues with ssl also affect people who build from source.

I imagine the people that build from source use a decent distribution of packages that includes `openssl` like homebrew, as recommended in the Sage installation documenation.

I do not like the current way as it will install an immature implementation of SSL within Sage for most people, since even on some OS that ship `openssl-dev`, this latter is rarely installed by default, see e.g. https://ask.sagemath.org/question/47513/rise-in-jupyter/

The warning are probably not enough (and probably lost among tons of configure lines) since people will just go ahead and "prefer" using the standard `openssl` spkg over installing the lib from their distro.



---

archive/issue_comments_415244.json:
```json
{
    "body": "<a id='comment:30'></a>I'm also uneasy with an alpha stage OpenSSL 3 becoming standard.\n\nMaybe we can create an \"openssl3\" optional package for now?\n\nWe should advertise the `fix_mac_sage` scripts by the 3-manifolds group\n\n- https://github.com/3-manifolds/fix_mac_sage/\n\nthat can \"fix\" a Sage install on macOS by adding SSL and tkinter to its Python.\n\nWe should advertise it\n\n- in the README file that is shipped with macOS binaries\n- on the macOS download page of the SageMath website",
    "created_at": "2021-02-03T02:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415244",
    "user": "https://github.com/slel"
}
```

<a id='comment:30'></a>I'm also uneasy with an alpha stage OpenSSL 3 becoming standard.

Maybe we can create an "openssl3" optional package for now?

We should advertise the `fix_mac_sage` scripts by the 3-manifolds group

- https://github.com/3-manifolds/fix_mac_sage/

that can "fix" a Sage install on macOS by adding SSL and tkinter to its Python.

We should advertise it

- in the README file that is shipped with macOS binaries
- on the macOS download page of the SageMath website



---

archive/issue_comments_415245.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-02-20T10:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29555#issuecomment-415245",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_075430.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-02-20T10:46:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29555",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29555#event-75430"
}
```
