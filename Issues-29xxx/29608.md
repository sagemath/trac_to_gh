# Issue 29608: error message has maxima code instead of sage code

archive/issues_029371.json:
```json
{
    "body": "Running sage on the following file `bug.sage` yields an error message saying that an \"example of legal syntax is `assume(cos((4*%pi*m+%pi)/2)*z>0)`\". However, this is not legal syntax, because `%pi` is a maxima constant, not a sage constant.\n\n```\n# bug.sage\nm = var(\"m\");\nx = var(\"x\");\ny = var(\"y\");\nz = var(\"z\");\nassume(m, 'integer');\nassume(m > 0);\nassume(x >= 0);\nassume(y >= 0);\nassume(z >= 0);\nD = cos((4 * m + 1)*arcsin(z/sqrt(x^2 + y^2 + z^2)))/sqrt((x^2 + y^2)/(x^2 + y^2 + z^2));\nprint(limit(limit(D, x = 0), y = 0));\n# ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(cos((4*%pi*m+%pi)/2)*z>0)', see `assume?` for more details)\nassume(cos((4*%pi*m+%pi)/2)*z==0);\n# SyntaxError: invalid syntax\nassume(cos((4*pi*m+pi)/2)*z==0);\n# ValueError: Assumption is redundant\n```\n\nOutput:\n\n```\n$ sage < bug.sage \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.0, Release Date: 2020-01-01                     \u2502\n\u2502 Using Python 3.8.2. Type \"help()\" for help.                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nsage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: ---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n/usr/lib/python3/dist-packages/sage/interfaces/maxima_lib.py in sr_limit(self, expr, v, a, dir)\n    984                 L.append(max_minus)\n--> 985             return max_to_sr(maxima_eval(([max_limit], L)))\n    986         except RuntimeError as error:\n\n/usr/lib/python3/dist-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7841)()\n    818         lispargs = EclObject(list(args))\n--> 819         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))\n    820 \n\n/usr/lib/python3/dist-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5503)()\n    390         s = si_coerce_to_base_string(ecl_values(1))\n--> 391         raise RuntimeError(\"ECL says: {}\".format(\n    392             char_to_str(ecl_base_string_pointer_safe(s))))\n\nRuntimeError: ECL says: Maxima asks: Is cos((4*%pi*_SAGE_VAR_m+%pi)/2)*_SAGE_VAR_z positive, negative or zero?\n\nDuring handling of the above exception, another exception occurred:\n\nValueError                                Traceback (most recent call last)\n<ipython-input-11-0d1303e560b0> in <module>\n----> 1 print(limit(limit(D, x = Integer(0)), y = Integer(0)));\n\n/usr/lib/python3/dist-packages/sage/calculus/calculus.py in limit(ex, dir, taylor, algorithm, **argv)\n   1366     if algorithm == 'maxima':\n   1367         if dir is None:\n-> 1368             l = maxima.sr_limit(ex, v, a)\n   1369         elif dir in dir_plus:\n   1370             l = maxima.sr_limit(ex, v, a, 'plus')\n\n/usr/lib/python3/dist-packages/sage/interfaces/maxima_lib.py in sr_limit(self, expr, v, a, dir)\n    987             s = str(error)\n    988             if \"Is\" in s: # Maxima asked for a condition\n--> 989                 self._missing_assumption(s)\n    990             else:\n    991                 raise\n\n/usr/lib/python3/dist-packages/sage/interfaces/maxima_lib.py in _missing_assumption(self, errstr)\n   1032              + errstr[jj+1:k] +\">0)', see `assume?` for more details)\\n\" + errstr\n   1033         outstr = outstr.replace('_SAGE_VAR_','')\n-> 1034         raise ValueError(outstr)\n   1035 \n   1036 def is_MaximaLibElement(x):\n\nValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(cos((4*%pi*m+%pi)/2)*z>0)', see `assume?` for more details)\nIs cos((4*%pi*m+%pi)/2)*z positive, negative or zero?\nsage: sage:   File \"<ipython-input-13-7a440a048b66>\", line 1\n    assume(cos((Integer(4)*%pi*m+%pi)/Integer(2))*z==Integer(0));\n                           ^\nSyntaxError: invalid syntax\n\nsage: sage: Exiting Sage (CPU time 0m2.26s, Wall time 0m1.83s).\n```\n\n```\nVersions:\n$ apt-cache policy sagemath maxima\nsagemath:\n  Installed: 9.0-4\n  Candidate: 9.0-4\n  Version table:\n *** 9.0-4 500\n        500 http://ftp.uk.debian.org/debian unstable/main amd64 Packages\n        100 /var/lib/dpkg/status\nmaxima:\n  Installed: 5.43.2-3\n  Candidate: 5.43.2-3\n  Version table:\n *** 5.43.2-3 990\n        990 http://ftp.uk.debian.org/debian bullseye/main amd64 Packages\n        990 http://ftp.uk.debian.org/debian testing/main amd64 Packages\n        500 http://ftp.uk.debian.org/debian unstable/main amd64 Packages\n        100 /var/lib/dpkg/status\n```\n\n\n**Keywords:** maxima\n\nIssue created by migration from https://trac.sagemath.org/ticket/29608\n\n",
    "created_at": "2020-04-28T04:26:47Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "error message has maxima code instead of sage code",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29608",
    "user": "https://github.com/claudeha"
}
```
Running sage on the following file `bug.sage` yields an error message saying that an "example of legal syntax is `assume(cos((4*%pi*m+%pi)/2)*z>0)`". However, this is not legal syntax, because `%pi` is a maxima constant, not a sage constant.

```
# bug.sage
m = var("m");
x = var("x");
y = var("y");
z = var("z");
assume(m, 'integer');
assume(m > 0);
assume(x >= 0);
assume(y >= 0);
assume(z >= 0);
D = cos((4 * m + 1)*arcsin(z/sqrt(x^2 + y^2 + z^2)))/sqrt((x^2 + y^2)/(x^2 + y^2 + z^2));
print(limit(limit(D, x = 0), y = 0));
# ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(cos((4*%pi*m+%pi)/2)*z>0)', see `assume?` for more details)
assume(cos((4*%pi*m+%pi)/2)*z==0);
# SyntaxError: invalid syntax
assume(cos((4*pi*m+pi)/2)*z==0);
# ValueError: Assumption is redundant
```

Output:

```
$ sage < bug.sage 
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.0, Release Date: 2020-01-01                     │
│ Using Python 3.8.2. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: ---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
/usr/lib/python3/dist-packages/sage/interfaces/maxima_lib.py in sr_limit(self, expr, v, a, dir)
    984                 L.append(max_minus)
--> 985             return max_to_sr(maxima_eval(([max_limit], L)))
    986         except RuntimeError as error:

/usr/lib/python3/dist-packages/sage/libs/ecl.pyx in sage.libs.ecl.EclObject.__call__ (build/cythonized/sage/libs/ecl.c:7841)()
    818         lispargs = EclObject(list(args))
--> 819         return ecl_wrap(ecl_safe_apply(self.obj,(<EclObject>lispargs).obj))
    820 

/usr/lib/python3/dist-packages/sage/libs/ecl.pyx in sage.libs.ecl.ecl_safe_apply (build/cythonized/sage/libs/ecl.c:5503)()
    390         s = si_coerce_to_base_string(ecl_values(1))
--> 391         raise RuntimeError("ECL says: {}".format(
    392             char_to_str(ecl_base_string_pointer_safe(s))))

RuntimeError: ECL says: Maxima asks: Is cos((4*%pi*_SAGE_VAR_m+%pi)/2)*_SAGE_VAR_z positive, negative or zero?

During handling of the above exception, another exception occurred:

ValueError                                Traceback (most recent call last)
<ipython-input-11-0d1303e560b0> in <module>
----> 1 print(limit(limit(D, x = Integer(0)), y = Integer(0)));

/usr/lib/python3/dist-packages/sage/calculus/calculus.py in limit(ex, dir, taylor, algorithm, **argv)
   1366     if algorithm == 'maxima':
   1367         if dir is None:
-> 1368             l = maxima.sr_limit(ex, v, a)
   1369         elif dir in dir_plus:
   1370             l = maxima.sr_limit(ex, v, a, 'plus')

/usr/lib/python3/dist-packages/sage/interfaces/maxima_lib.py in sr_limit(self, expr, v, a, dir)
    987             s = str(error)
    988             if "Is" in s: # Maxima asked for a condition
--> 989                 self._missing_assumption(s)
    990             else:
    991                 raise

/usr/lib/python3/dist-packages/sage/interfaces/maxima_lib.py in _missing_assumption(self, errstr)
   1032              + errstr[jj+1:k] +">0)', see `assume?` for more details)\n" + errstr
   1033         outstr = outstr.replace('_SAGE_VAR_','')
-> 1034         raise ValueError(outstr)
   1035 
   1036 def is_MaximaLibElement(x):

ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(cos((4*%pi*m+%pi)/2)*z>0)', see `assume?` for more details)
Is cos((4*%pi*m+%pi)/2)*z positive, negative or zero?
sage: sage:   File "<ipython-input-13-7a440a048b66>", line 1
    assume(cos((Integer(4)*%pi*m+%pi)/Integer(2))*z==Integer(0));
                           ^
SyntaxError: invalid syntax

sage: sage: Exiting Sage (CPU time 0m2.26s, Wall time 0m1.83s).
```

```
Versions:
$ apt-cache policy sagemath maxima
sagemath:
  Installed: 9.0-4
  Candidate: 9.0-4
  Version table:
 *** 9.0-4 500
        500 http://ftp.uk.debian.org/debian unstable/main amd64 Packages
        100 /var/lib/dpkg/status
maxima:
  Installed: 5.43.2-3
  Candidate: 5.43.2-3
  Version table:
 *** 5.43.2-3 990
        990 http://ftp.uk.debian.org/debian bullseye/main amd64 Packages
        990 http://ftp.uk.debian.org/debian testing/main amd64 Packages
        500 http://ftp.uk.debian.org/debian unstable/main amd64 Packages
        100 /var/lib/dpkg/status
```


**Keywords:** maxima

Issue created by migration from https://trac.sagemath.org/ticket/29608





---

archive/issue_events_268316.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-29T07:03:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "label": "component: symbolics",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268316"
}
```



---

archive/issue_events_268317.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-29T07:03:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "label": "component: interfaces",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268317"
}
```



---

archive/issue_comments_470346.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"maxima\".",
    "created_at": "2020-04-29T07:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29608#issuecomment-470346",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Changing keywords** from "" to "maxima".



---

archive/issue_events_268318.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-29T07:03:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268318"
}
```



---

archive/issue_events_268319.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-29T07:03:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268319"
}
```



---

archive/issue_comments_470347.json:
```json
{
    "body": "<a id='comment:1'></a>\nI opened ticket #29616 to discuss the error about the assumption being redundant, so this ticket can focus on the other issue: can the maxima code (`%pi`) in the error message be automatically translated to sage syntax (`pi`) before it is presented to the user?",
    "created_at": "2020-04-29T07:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29608#issuecomment-470347",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:1'></a>
I opened ticket #29616 to discuss the error about the assumption being redundant, so this ticket can focus on the other issue: can the maxima code (`%pi`) in the error message be automatically translated to sage syntax (`pi`) before it is presented to the user?



---

archive/issue_comments_470348.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,7 @@\n-Input `bug.sage`:\n+Running sage on the following file `bug.sage` yields an error message saying that an \"example of legal syntax is `assume(cos((4*%pi*m+%pi)/2)*z>0)`\". However, this is not legal syntax, because `%pi` is a maxima constant, not a sage constant.\n \n ```\n+# bug.sage\n m = var(\"m\");\n x = var(\"x\");\n y = var(\"y\");\n``````\n",
    "created_at": "2020-04-29T07:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29608#issuecomment-470348",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,7 @@
-Input `bug.sage`:
+Running sage on the following file `bug.sage` yields an error message saying that an "example of legal syntax is `assume(cos((4*%pi*m+%pi)/2)*z>0)`". However, this is not legal syntax, because `%pi` is a maxima constant, not a sage constant.
 
 ```
+# bug.sage
 m = var("m");
 x = var("x");
 y = var("y");
``````




---

archive/issue_events_268320.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2020-04-29T07:03:51Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "rename": {
        "from": "assumption suggestion gives syntax and is-redundant errors",
        "to": "error message has maxima code instead of sage code"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268320"
}
```



---

archive/issue_events_268321.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268321"
}
```



---

archive/issue_events_268322.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-29T16:37:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268322"
}
```



---

archive/issue_events_268323.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268323"
}
```



---

archive/issue_events_268324.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268324"
}
```



---

archive/issue_comments_470349.json:
```json
{
    "body": "<a id='comment:3'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29608#issuecomment-470349",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_268325.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:26:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268325"
}
```



---

archive/issue_events_268326.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:26:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268326"
}
```



---

archive/issue_events_268327.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268327"
}
```



---

archive/issue_events_268328.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268328"
}
```



---

archive/issue_events_268329.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268329"
}
```



---

archive/issue_events_268330.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268330"
}
```



---

archive/issue_events_268331.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268331"
}
```



---

archive/issue_events_268332.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29608",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29608#event-268332"
}
```
