# Issue 29262: Combination unranking new algorithm

archive/issues_029025.json:
```json
{
    "body": "I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.\nThe actual implementation is related to McCaffrey's blog.\nIn a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1\nI compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.\n\nIf possible I would like to commit this new implementation. My function has the same signature from the previous one.\n\nRegards.\nAntoine\n\n\nExample :\nActual implementation (on my laptop : core i7 32GiB Ubuntu Linux)\n\n```\nsage: n = 100\nsage: k = 50\nsage: set_random_seed(12345678987654321)\nsage: r = randint(0, binomial(n,k)-1)\nsage: %time A = combination.from_rank(r,n,k)\n\nCPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms\nWall time: 1.06 ms\n\n## With my algorithm\n## (in the commit the function replace from_rank(.,.,.))\n\nsage: %time B = unrank_combi_direct(r, n, k)   \n\nCPU times: user 297 \u00b5s, sys: 53 \u00b5s, total: 350 \u00b5s\nWall time: 296 \u00b5s\n\n## Finally\n\nsage: A==B\n\nTrue\n\n\n## A second example with greater values\n\nsage: n = 10000\nsage: k = 5000\nsage: set_random_seed(12345678987654321)\nsage: r = randint(0, binomial(n,k)-1)\nsage: %time A = combination.from_rank(r,n,k)\n\nCPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s\nWall time: 2.85 s\n\n## With my algorithm  (in the git branch I obviously reused the function name from_rank)\n\nsage: %time B = unrank_combi_direct(r, n, k)\n\nCPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms\nWall time: 21 ms\n\n## Finally\n\nsage: A==B\n\nTrue\n```\n\n\n**Keywords:** combination unranking\n\n**Branch/Commit:** [845c21e3e4c1c2890aaa7cc06e8810d39a756ba0](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Antoine Genitrini\n\nIssue created by migration from https://trac.sagemath.org/ticket/29262\n\n",
    "closed_at": "2020-03-12T22:48:16Z",
    "created_at": "2020-02-29T15:54:45Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "title": "Combination unranking new algorithm",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/29262",
    "user": "https://github.com/agenitrini"
}
```
I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.
The actual implementation is related to McCaffrey's blog.
In a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1
I compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.

If possible I would like to commit this new implementation. My function has the same signature from the previous one.

Regards.
Antoine


Example :
Actual implementation (on my laptop : core i7 32GiB Ubuntu Linux)

```
sage: n = 100
sage: k = 50
sage: set_random_seed(12345678987654321)
sage: r = randint(0, binomial(n,k)-1)
sage: %time A = combination.from_rank(r,n,k)

CPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms
Wall time: 1.06 ms

## With my algorithm
## (in the commit the function replace from_rank(.,.,.))

sage: %time B = unrank_combi_direct(r, n, k)   

CPU times: user 297 µs, sys: 53 µs, total: 350 µs
Wall time: 296 µs

## Finally

sage: A==B

True


## A second example with greater values

sage: n = 10000
sage: k = 5000
sage: set_random_seed(12345678987654321)
sage: r = randint(0, binomial(n,k)-1)
sage: %time A = combination.from_rank(r,n,k)

CPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s
Wall time: 2.85 s

## With my algorithm  (in the git branch I obviously reused the function name from_rank)

sage: %time B = unrank_combi_direct(r, n, k)

CPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms
Wall time: 21 ms

## Finally

sage: A==B

True
```


**Keywords:** combination unranking

**Branch/Commit:** [845c21e3e4c1c2890aaa7cc06e8810d39a756ba0](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)

**Reviewer:** Travis Scrimshaw

**Author:** Antoine Genitrini

Issue created by migration from https://trac.sagemath.org/ticket/29262





---

archive/issue_comments_461624.json:
```json
{
    "body": "**Branch:** [u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)",
    "created_at": "2020-02-29T15:58:19Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461624",
    "user": "https://github.com/agenitrini"
}
```

**Branch:** [u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)



---

archive/issue_events_260282.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T16:03:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "component: combinatorics",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260282"
}
```



---

archive/issue_comments_461625.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"combination unranking\".",
    "created_at": "2020-02-29T16:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461625",
    "user": "https://github.com/agenitrini"
}
```

**Changing keywords** from "" to "combination unranking".



---

archive/issue_comments_461626.json:
```json
{
    "body": "**Commit:** [268f41a1791a63ab7528a7af0f05eafe1d4b1fab](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)",
    "created_at": "2020-02-29T16:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461626",
    "user": "https://github.com/agenitrini"
}
```

**Commit:** [268f41a1791a63ab7528a7af0f05eafe1d4b1fab](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)



---

archive/issue_comments_461627.json:
```json
{
    "body": "**Author:** Antoine Genitrini",
    "created_at": "2020-02-29T16:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461627",
    "user": "https://github.com/agenitrini"
}
```

**Author:** Antoine Genitrini



---

archive/issue_comments_461628.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,64 @@\n+I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.\n+The actual implementation is related to McCaffrey's blog.\n+In a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1\n+I compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.\n \n+If possible I would like to commit this new implementation. My function has the same signature from the previous one.\n+\n+Regards.\n+Antoine\n+\n+\n+Example :\n+Actual implementation (on my laptop : core i7 32GiB Ubuntu Linux)\n+\n+```\n+sage: n = 100\n+sage: k = 50\n+sage: set_random_seed(12345678987654321)\n+sage: r = randint(0, binomial(n,k)-1)\n+sage: %time A = combination.from_rank(r,n,k)\n+\n+CPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms\n+Wall time: 1.06 ms\n+\n+## With my algorithm\n+## (in the commit the function replace from_rank(.,.,.))\n+\n+sage: %time B = unrank_combi_direct(r, n, k)   \n+\n+CPU times: user 297 \u00b5s, sys: 53 \u00b5s, total: 350 \u00b5s\n+Wall time: 296 \u00b5s\n+\n+## Finally\n+\n+sage: A==B\n+\n+True\n+\n+\n+## A second example with greater values\n+\n+sage: n = 10000\n+sage: k = 5000\n+sage: set_random_seed(12345678987654321)\n+sage: r = randint(0, binomial(n,k)-1)\n+sage: %time A = combination.from_rank(r,n,k)\n+\n+CPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s\n+Wall time: 2.85 s\n+\n+## With my algorithm  (in the git branch I obviously reused the function name from_rank)\n+\n+sage: %time B = unrank_combi_direct(r, n, k)\n+\n+CPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms\n+Wall time: 21 ms\n+\n+## Finally\n+\n+sage: A==B\n+\n+True\n+```\n+\n``````\n",
    "created_at": "2020-02-29T16:03:58Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461628",
    "user": "https://github.com/agenitrini"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,64 @@
+I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.
+The actual implementation is related to McCaffrey's blog.
+In a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1
+I compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.
 
+If possible I would like to commit this new implementation. My function has the same signature from the previous one.
+
+Regards.
+Antoine
+
+
+Example :
+Actual implementation (on my laptop : core i7 32GiB Ubuntu Linux)
+
+```
+sage: n = 100
+sage: k = 50
+sage: set_random_seed(12345678987654321)
+sage: r = randint(0, binomial(n,k)-1)
+sage: %time A = combination.from_rank(r,n,k)
+
+CPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms
+Wall time: 1.06 ms
+
+## With my algorithm
+## (in the commit the function replace from_rank(.,.,.))
+
+sage: %time B = unrank_combi_direct(r, n, k)   
+
+CPU times: user 297 µs, sys: 53 µs, total: 350 µs
+Wall time: 296 µs
+
+## Finally
+
+sage: A==B
+
+True
+
+
+## A second example with greater values
+
+sage: n = 10000
+sage: k = 5000
+sage: set_random_seed(12345678987654321)
+sage: r = randint(0, binomial(n,k)-1)
+sage: %time A = combination.from_rank(r,n,k)
+
+CPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s
+Wall time: 2.85 s
+
+## With my algorithm  (in the git branch I obviously reused the function name from_rank)
+
+sage: %time B = unrank_combi_direct(r, n, k)
+
+CPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms
+Wall time: 21 ms
+
+## Finally
+
+sage: A==B
+
+True
+```
+
``````




---

archive/issue_events_260283.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T16:03:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260283"
}
```



---

archive/issue_events_260284.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T16:07:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260284"
}
```



---

archive/issue_comments_461629.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837\">9a7a3cc</a></td><td><code>function from_rank in combinatorics.py modified</code></td></tr></table>\n",
    "created_at": "2020-02-29T16:12:35Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837">9a7a3cc</a></td><td><code>function from_rank in combinatorics.py modified</code></td></tr></table>




---

archive/issue_comments_461630.json:
```json
{
    "body": "**Changing commit** from \"[268f41a1791a63ab7528a7af0f05eafe1d4b1fab](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)\" to \"[9a7a3ccaf713ea06371a79f093a35b155f744837](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)\".",
    "created_at": "2020-02-29T16:12:35Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[268f41a1791a63ab7528a7af0f05eafe1d4b1fab](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)" to "[9a7a3ccaf713ea06371a79f093a35b155f744837](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)".



---

archive/issue_comments_461631.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis is quite a nice improvement. So it would be good to add `[DGH20]` to the master references file (as `[DGH2020]`) and then cite it as `[DGH20]_` (or with the changed name `[DGH2020]_`). Other than that, a few PEP8 space around operators:\n\n```diff\n-if k < n/2:\n+if k < n / 2:\n\n-k = n-k\n+k = n - k\n\n-while d < k-1:\n+while d < k - 1:\n\n-if n-1-m==0:\n+if n - 1 - m == 0:\n\n-B = (B * (k-1-i))//(n-1-m)\n+B = (B * (k-1-i)) // (n-1-m)\n\n-D[k-1] = n+r+k-1-B\n+D[k-1] = n + r + k - 1 - B\n```\nand these can be simplified:\n\n```diff\n-D = [0 for i in range(k)]\n+D = [0]*k\n\n-d = d + 1\n+d += 1\n\n-i = i + 1\n+i += 1\n\n-n = n - 1\n+n += 1\n\n-r = r - B\n+r -= B\n\n-m = m + 1\n+m += 1\n\n-j = j + 1\n+j += 1\n```\nAlso would it be possible to keep the same variable names as before? While I doubt anyone is explicitly calling it with `n=foo`, it is still good in terms of being fully backwards compatible. Plus I feel it would be better to define `n0 = n` instead of the other way around.",
    "created_at": "2020-03-02T00:42:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461631",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
This is quite a nice improvement. So it would be good to add `[DGH20]` to the master references file (as `[DGH2020]`) and then cite it as `[DGH20]_` (or with the changed name `[DGH2020]_`). Other than that, a few PEP8 space around operators:

```diff
-if k < n/2:
+if k < n / 2:

-k = n-k
+k = n - k

-while d < k-1:
+while d < k - 1:

-if n-1-m==0:
+if n - 1 - m == 0:

-B = (B * (k-1-i))//(n-1-m)
+B = (B * (k-1-i)) // (n-1-m)

-D[k-1] = n+r+k-1-B
+D[k-1] = n + r + k - 1 - B
```
and these can be simplified:

```diff
-D = [0 for i in range(k)]
+D = [0]*k

-d = d + 1
+d += 1

-i = i + 1
+i += 1

-n = n - 1
+n += 1

-r = r - B
+r -= B

-m = m + 1
+m += 1

-j = j + 1
+j += 1
```
Also would it be possible to keep the same variable names as before? While I doubt anyone is explicitly calling it with `n=foo`, it is still good in terms of being fully backwards compatible. Plus I feel it would be better to define `n0 = n` instead of the other way around.



---

archive/issue_comments_461632.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43\">0232cd6</a></td><td><code>reference [DGH2020] added in index.rst</code></td></tr></table>\n",
    "created_at": "2020-03-02T17:58:14Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43">0232cd6</a></td><td><code>reference [DGH2020] added in index.rst</code></td></tr></table>




---

archive/issue_comments_461633.json:
```json
{
    "body": "**Changing commit** from \"[9a7a3ccaf713ea06371a79f093a35b155f744837](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)\" to \"[0232cd602af8f3ad27bd4dfadbf5d04d37933d43](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)\".",
    "created_at": "2020-03-02T17:58:14Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461633",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9a7a3ccaf713ea06371a79f093a35b155f744837](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)" to "[0232cd602af8f3ad27bd4dfadbf5d04d37933d43](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)".



---

archive/issue_comments_461634.json:
```json
{
    "body": "<a id='comment:7'></a>\nLooks like you have some corner case issues appearing in `src/sage/combinat/subset.py`.",
    "created_at": "2020-03-04T02:24:58Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461634",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
Looks like you have some corner case issues appearing in `src/sage/combinat/subset.py`.



---

archive/issue_events_260285.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-04T02:24:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260285"
}
```



---

archive/issue_events_260286.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-04T02:24:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260286"
}
```



---

archive/issue_comments_461635.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2\">24799fb</a></td><td><code>test for the possible values of r corrected</code></td></tr></table>\n",
    "created_at": "2020-03-04T09:10:01Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2">24799fb</a></td><td><code>test for the possible values of r corrected</code></td></tr></table>




---

archive/issue_comments_461636.json:
```json
{
    "body": "**Changing commit** from \"[0232cd602af8f3ad27bd4dfadbf5d04d37933d43](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)\" to \"[24799fbb4c496df7ec5ca35782a984dae11972e2](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)\".",
    "created_at": "2020-03-04T09:10:01Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461636",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0232cd602af8f3ad27bd4dfadbf5d04d37933d43](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)" to "[24799fbb4c496df7ec5ca35782a984dae11972e2](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)".



---

archive/issue_comments_461637.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd\">e83efe8</a></td><td><code>Case n=0 now taken into account</code></td></tr></table>\n",
    "created_at": "2020-03-04T13:21:07Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461637",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd">e83efe8</a></td><td><code>Case n=0 now taken into account</code></td></tr></table>




---

archive/issue_comments_461638.json:
```json
{
    "body": "**Changing commit** from \"[24799fbb4c496df7ec5ca35782a984dae11972e2](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)\" to \"[e83efe8d55a54e90377ef25449748ffa91aeb3cd](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)\".",
    "created_at": "2020-03-04T13:21:07Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461638",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[24799fbb4c496df7ec5ca35782a984dae11972e2](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)" to "[e83efe8d55a54e90377ef25449748ffa91aeb3cd](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)".



---

archive/issue_events_260287.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-05T11:57:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260287"
}
```



---

archive/issue_events_260288.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-05T11:57:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260288"
}
```



---

archive/issue_events_260289.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-05T12:17:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260289"
}
```



---

archive/issue_events_260290.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-05T12:17:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260290"
}
```



---

archive/issue_comments_461639.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2020-03-05T12:17:43Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461639",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_461640.json:
```json
{
    "body": "<a id='comment:11'></a>\nThank you. LGTM.",
    "created_at": "2020-03-05T12:17:43Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461640",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>
Thank you. LGTM.



---

archive/issue_events_260291.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-08T23:56:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260291"
}
```



---

archive/issue_events_260292.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-08T23:56:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260292"
}
```



---

archive/issue_comments_461641.json:
```json
{
    "body": "<a id='comment:12'></a>\n\n```\nsage -t --long --warn-long 35.8 src/sage/rings/polynomial/pbori.pyx  # 3 doctests failed\nsage -t --long --warn-long 35.8 src/sage/matrix/matrix_mpolynomial_dense.pyx  # 4 doctests failed\n```",
    "created_at": "2020-03-08T23:56:40Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461641",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>

```
sage -t --long --warn-long 35.8 src/sage/rings/polynomial/pbori.pyx  # 3 doctests failed
sage -t --long --warn-long 35.8 src/sage/matrix/matrix_mpolynomial_dense.pyx  # 4 doctests failed
```



---

archive/issue_comments_461642.json:
```json
{
    "body": "<a id='comment:13'></a>\nSo here is the problem:\n\n```\nsage: from sage.combinat.combination import from_rank\nsage: from_rank(0, 2, 1)\n(1,)\nsage: from_rank(1, 2, 1)\n(2,)\n```\ninstead this should be `(0,)` and `(1,)`. I haven't traced through the algorithm, but from testing, this seems to be just some special corner case (if indeed there is no bug in the implementation). It works on larger values of `n` and `k`.",
    "created_at": "2020-03-09T03:05:01Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461642",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
So here is the problem:

```
sage: from sage.combinat.combination import from_rank
sage: from_rank(0, 2, 1)
(1,)
sage: from_rank(1, 2, 1)
(2,)
```
instead this should be `(0,)` and `(1,)`. I haven't traced through the algorithm, but from testing, this seems to be just some special corner case (if indeed there is no bug in the implementation). It works on larger values of `n` and `k`.



---

archive/issue_comments_461643.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe\">110e94f</a></td><td><code>corner case n == 2 and k == 1 corrected with a direct answer when k == 1</code></td></tr></table>\n",
    "created_at": "2020-03-09T08:33:45Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe">110e94f</a></td><td><code>corner case n == 2 and k == 1 corrected with a direct answer when k == 1</code></td></tr></table>




---

archive/issue_comments_461644.json:
```json
{
    "body": "**Changing commit** from \"[e83efe8d55a54e90377ef25449748ffa91aeb3cd](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)\" to \"[110e94f0ebacf614a5d8083650e136daed6b5efe](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)\".",
    "created_at": "2020-03-09T08:33:45Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461644",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e83efe8d55a54e90377ef25449748ffa91aeb3cd](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)" to "[110e94f0ebacf614a5d8083650e136daed6b5efe](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)".



---

archive/issue_events_260293.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-09T08:38:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260293"
}
```



---

archive/issue_events_260294.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-09T08:38:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260294"
}
```



---

archive/issue_comments_461645.json:
```json
{
    "body": "<a id='comment:16'></a>\nThank you. Green patchbot now. (Interestingly, there was a green patchbot on the previous version, so I was disregarding the other failing tests.) However, I am going to add a more systematic test (which is how I caught the corner case) on a push tomorrow morning. Should be trivial to review.",
    "created_at": "2020-03-09T12:22:04Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461645",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'></a>
Thank you. Green patchbot now. (Interestingly, there was a green patchbot on the previous version, so I was disregarding the other failing tests.) However, I am going to add a more systematic test (which is how I caught the corner case) on a push tomorrow morning. Should be trivial to review.



---

archive/issue_comments_461646.json:
```json
{
    "body": "<a id='comment:17'></a>\nHere is my trivial change and additional doctest.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b142db69e5f8f003af373b17a7a33111d33aa264\">b142db6</a></td><td><code>Merge branch 'u/gh-agenitrini/combination_unranking_new_algorithm' of git://trac.sagemath.org/sage into public/combinat/new_combination_unranking-29262</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0\">845c21e</a></td><td><code>Adding a systematic test against old version.</code></td></tr></table>\n",
    "created_at": "2020-03-09T23:59:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461646",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Here is my trivial change and additional doctest.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b142db69e5f8f003af373b17a7a33111d33aa264">b142db6</a></td><td><code>Merge branch 'u/gh-agenitrini/combination_unranking_new_algorithm' of git://trac.sagemath.org/sage into public/combinat/new_combination_unranking-29262</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0">845c21e</a></td><td><code>Adding a systematic test against old version.</code></td></tr></table>




---

archive/issue_comments_461647.json:
```json
{
    "body": "**Changing commit** from \"[110e94f0ebacf614a5d8083650e136daed6b5efe](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)\" to \"[845c21e3e4c1c2890aaa7cc06e8810d39a756ba0](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)\".",
    "created_at": "2020-03-09T23:59:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461647",
    "user": "https://github.com/tscrim"
}
```

**Changing commit** from "[110e94f0ebacf614a5d8083650e136daed6b5efe](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)" to "[845c21e3e4c1c2890aaa7cc06e8810d39a756ba0](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)".



---

archive/issue_comments_461648.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)\" to \"[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)\".",
    "created_at": "2020-03-09T23:59:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461648",
    "user": "https://github.com/tscrim"
}
```

**Changing branch** from "[u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)" to "[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)".



---

archive/issue_comments_461649.json:
```json
{
    "body": "<a id='comment:18'></a>\nGreen bot. If you agree with my changes, then please set it back to a positive review.",
    "created_at": "2020-03-11T02:35:18Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461649",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
Green bot. If you agree with my changes, then please set it back to a positive review.



---

archive/issue_comments_461650.json:
```json
{
    "body": "<a id='comment:19'></a>\nThe tests are fine to me, thanks.",
    "created_at": "2020-03-11T06:46:08Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461650",
    "user": "https://github.com/agenitrini"
}
```

<a id='comment:19'></a>
The tests are fine to me, thanks.



---

archive/issue_events_260295.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-11T07:35:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260295"
}
```



---

archive/issue_events_260296.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-11T07:35:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260296"
}
```



---

archive/issue_events_260297.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-12T22:48:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260297"
}
```



---

archive/issue_events_260298.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3e3b0da5c868d8fc586c2532a0d4a9db0930900f",
    "created_at": "2020-03-12T22:48:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-260298"
}
```



---

archive/issue_comments_461651.json:
```json
{
    "body": "**Changing branch** from \"[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)\" to \"[845c21e3e4c1c2890aaa7cc06e8810d39a756ba0](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)\".",
    "created_at": "2020-03-12T22:48:16Z",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-461651",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)" to "[845c21e3e4c1c2890aaa7cc06e8810d39a756ba0](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)".
