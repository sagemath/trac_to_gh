# Issue 29262: Combination unranking new algorithm

archive/issues_029025.json:
```json
{
    "assignees": [],
    "body": "I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.\nThe actual implementation is related to McCaffrey's blog.\nIn a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1\nI compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.\n\nIf possible I would like to commit this new implementation. My function has the same signature from the previous one.\n\nRegards.\nAntoine\n\n\nExample :\nActual implementation (on my laptop : core i7 32GiB Ubuntu Linux)\n\n```\nsage: n = 100\nsage: k = 50\nsage: set_random_seed(12345678987654321)\nsage: r = randint(0, binomial(n,k)-1)\nsage: %time A = combination.from_rank(r,n,k)\n\nCPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms\nWall time: 1.06 ms\n\n## With my algorithm\n## (in the commit the function replace from_rank(.,.,.))\n\nsage: %time B = unrank_combi_direct(r, n, k)   \n\nCPU times: user 297 \u00b5s, sys: 53 \u00b5s, total: 350 \u00b5s\nWall time: 296 \u00b5s\n\n## Finally\n\nsage: A==B\n\nTrue\n\n\n## A second example with greater values\n\nsage: n = 10000\nsage: k = 5000\nsage: set_random_seed(12345678987654321)\nsage: r = randint(0, binomial(n,k)-1)\nsage: %time A = combination.from_rank(r,n,k)\n\nCPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s\nWall time: 2.85 s\n\n## With my algorithm  (in the git branch I obviously reused the function name from_rank)\n\nsage: %time B = unrank_combi_direct(r, n, k)\n\nCPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms\nWall time: 21 ms\n\n## Finally\n\nsage: A==B\n\nTrue\n```\n\n\nKeywords: **combination unranking**\n\nBranch/Commit: **[`845c21e`](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Antoine Genitrini**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29262_\n\n",
    "closed_at": "2020-03-12T22:48:16Z",
    "created_at": "2020-02-29T15:54:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Combination unranking new algorithm",
    "type": "issue",
    "updated_at": "2020-03-12T22:48:16Z",
    "url": "https://github.com/sagemath/sage/issues/29262",
    "user": "https://github.com/agenitrini"
}
```
I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.
The actual implementation is related to McCaffrey's blog.
In a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1
I compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.

If possible I would like to commit this new implementation. My function has the same signature from the previous one.

Regards.
Antoine


Example :
Actual implementation (on my laptop : core i7 32GiB Ubuntu Linux)

```
sage: n = 100
sage: k = 50
sage: set_random_seed(12345678987654321)
sage: r = randint(0, binomial(n,k)-1)
sage: %time A = combination.from_rank(r,n,k)

CPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms
Wall time: 1.06 ms

## With my algorithm
## (in the commit the function replace from_rank(.,.,.))

sage: %time B = unrank_combi_direct(r, n, k)   

CPU times: user 297 µs, sys: 53 µs, total: 350 µs
Wall time: 296 µs

## Finally

sage: A==B

True


## A second example with greater values

sage: n = 10000
sage: k = 5000
sage: set_random_seed(12345678987654321)
sage: r = randint(0, binomial(n,k)-1)
sage: %time A = combination.from_rank(r,n,k)

CPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s
Wall time: 2.85 s

## With my algorithm  (in the git branch I obviously reused the function name from_rank)

sage: %time B = unrank_combi_direct(r, n, k)

CPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms
Wall time: 21 ms

## Finally

sage: A==B

True
```


Keywords: **combination unranking**

Branch/Commit: **[`845c21e`](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)**

Reviewer: **Travis Scrimshaw**

Author: **Antoine Genitrini**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/29262_





---

archive/issue_events_399284.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T15:54:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399284"
}
```



---

archive/issue_events_399285.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T15:54:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399285"
}
```



---

archive/issue_comments_458769.json:
```json
{
    "body": "Branch: **[u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)**",
    "created_at": "2020-02-29T15:58:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458769",
    "user": "https://github.com/agenitrini"
}
```

Branch: **[u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)**



---

archive/issue_events_399286.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T16:03:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399286"
}
```



---

archive/issue_comments_458770.json:
```json
{
    "body": "Changed keywords from none to **combination unranking**",
    "created_at": "2020-02-29T16:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458770",
    "user": "https://github.com/agenitrini"
}
```

Changed keywords from none to **combination unranking**



---

archive/issue_comments_458771.json:
```json
{
    "body": "Commit: **[`268f41a`](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)**",
    "created_at": "2020-02-29T16:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458771",
    "user": "https://github.com/agenitrini"
}
```

Commit: **[`268f41a`](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)**



---

archive/issue_comments_458772.json:
```json
{
    "body": "Author: **Antoine Genitrini**",
    "created_at": "2020-02-29T16:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458772",
    "user": "https://github.com/agenitrini"
}
```

Author: **Antoine Genitrini**



---

archive/issue_comments_458773.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,64 @@\n+I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.\n+The actual implementation is related to McCaffrey's blog.\n+In a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1\n+I compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.\n \n+If possible I would like to commit this new implementation. My function has the same signature from the previous one.\n+\n+Regards.\n+Antoine\n+\n+\n+Example :\n+Actual implementation (on my laptop : core i7 32GiB Ubuntu Linux)\n+\n+```\n+sage: n = 100\n+sage: k = 50\n+sage: set_random_seed(12345678987654321)\n+sage: r = randint(0, binomial(n,k)-1)\n+sage: %time A = combination.from_rank(r,n,k)\n+\n+CPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms\n+Wall time: 1.06 ms\n+\n+## With my algorithm\n+## (in the commit the function replace from_rank(.,.,.))\n+\n+sage: %time B = unrank_combi_direct(r, n, k)   \n+\n+CPU times: user 297 \u00b5s, sys: 53 \u00b5s, total: 350 \u00b5s\n+Wall time: 296 \u00b5s\n+\n+## Finally\n+\n+sage: A==B\n+\n+True\n+\n+\n+## A second example with greater values\n+\n+sage: n = 10000\n+sage: k = 5000\n+sage: set_random_seed(12345678987654321)\n+sage: r = randint(0, binomial(n,k)-1)\n+sage: %time A = combination.from_rank(r,n,k)\n+\n+CPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s\n+Wall time: 2.85 s\n+\n+## With my algorithm  (in the git branch I obviously reused the function name from_rank)\n+\n+sage: %time B = unrank_combi_direct(r, n, k)\n+\n+CPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms\n+Wall time: 21 ms\n+\n+## Finally\n+\n+sage: A==B\n+\n+True\n+```\n+\n``````\n",
    "created_at": "2020-02-29T16:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458773",
    "user": "https://github.com/agenitrini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,64 @@
+I propose to implement a new algorithm for the unranking of combinations in the lexicographic order, cf. sage.combinat.combination algorithm from_rank.
+The actual implementation is related to McCaffrey's blog.
+In a recent paper I have written, cf. https://hal.archives-ouvertes.fr/hal-02462764v1
+I compare this method to other from the literature and a new one I have developed with my co-authors. The paper is actually under review.
 
+If possible I would like to commit this new implementation. My function has the same signature from the previous one.
+
+Regards.
+Antoine
+
+
+Example :
+Actual implementation (on my laptop : core i7 32GiB Ubuntu Linux)
+
+```
+sage: n = 100
+sage: k = 50
+sage: set_random_seed(12345678987654321)
+sage: r = randint(0, binomial(n,k)-1)
+sage: %time A = combination.from_rank(r,n,k)
+
+CPU times: user 1.55 ms, sys: 0 ns, total: 1.55 ms
+Wall time: 1.06 ms
+
+## With my algorithm
+## (in the commit the function replace from_rank(.,.,.))
+
+sage: %time B = unrank_combi_direct(r, n, k)   
+
+CPU times: user 297 µs, sys: 53 µs, total: 350 µs
+Wall time: 296 µs
+
+## Finally
+
+sage: A==B
+
+True
+
+
+## A second example with greater values
+
+sage: n = 10000
+sage: k = 5000
+sage: set_random_seed(12345678987654321)
+sage: r = randint(0, binomial(n,k)-1)
+sage: %time A = combination.from_rank(r,n,k)
+
+CPU times: user 2.9 s, sys: 9.69 ms, total: 2.91 s
+Wall time: 2.85 s
+
+## With my algorithm  (in the git branch I obviously reused the function name from_rank)
+
+sage: %time B = unrank_combi_direct(r, n, k)
+
+CPU times: user 22.4 ms, sys: 4.45 ms, total: 26.9 ms
+Wall time: 21 ms
+
+## Finally
+
+sage: A==B
+
+True
+```
+
``````




---

archive/issue_events_399287.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T16:03:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399287"
}
```



---

archive/issue_events_399288.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-02-29T16:07:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399288"
}
```



---

archive/issue_comments_458774.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837\"><code>9a7a3cc</code></a></td><td><code>function from_rank in combinatorics.py modified</code></td></tr></table>\n",
    "created_at": "2020-02-29T16:12:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458774",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837"><code>9a7a3cc</code></a></td><td><code>function from_rank in combinatorics.py modified</code></td></tr></table>




---

archive/issue_comments_458775.json:
```json
{
    "body": "Changed commit from **[`268f41a`](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)** to **[`9a7a3cc`](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)**",
    "created_at": "2020-02-29T16:12:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458775",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`268f41a`](https://github.com/sagemath/sagetrac-mirror/commit/268f41a1791a63ab7528a7af0f05eafe1d4b1fab)** to **[`9a7a3cc`](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)**



---

archive/issue_comments_458776.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThis is quite a nice improvement. So it would be good to add `[DGH20]` to the master references file (as `[DGH2020]`) and then cite it as `[DGH20]_` (or with the changed name `[DGH2020]_`). Other than that, a few PEP8 space around operators:\n\n```diff\n-if k < n/2:\n+if k < n / 2:\n\n-k = n-k\n+k = n - k\n\n-while d < k-1:\n+while d < k - 1:\n\n-if n-1-m==0:\n+if n - 1 - m == 0:\n\n-B = (B * (k-1-i))//(n-1-m)\n+B = (B * (k-1-i)) // (n-1-m)\n\n-D[k-1] = n+r+k-1-B\n+D[k-1] = n + r + k - 1 - B\n```\nand these can be simplified:\n\n```diff\n-D = [0 for i in range(k)]\n+D = [0]*k\n\n-d = d + 1\n+d += 1\n\n-i = i + 1\n+i += 1\n\n-n = n - 1\n+n += 1\n\n-r = r - B\n+r -= B\n\n-m = m + 1\n+m += 1\n\n-j = j + 1\n+j += 1\n```\nAlso would it be possible to keep the same variable names as before? While I doubt anyone is explicitly calling it with `n=foo`, it is still good in terms of being fully backwards compatible. Plus I feel it would be better to define `n0 = n` instead of the other way around.",
    "created_at": "2020-03-02T00:42:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458776",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

This is quite a nice improvement. So it would be good to add `[DGH20]` to the master references file (as `[DGH2020]`) and then cite it as `[DGH20]_` (or with the changed name `[DGH2020]_`). Other than that, a few PEP8 space around operators:

```diff
-if k < n/2:
+if k < n / 2:

-k = n-k
+k = n - k

-while d < k-1:
+while d < k - 1:

-if n-1-m==0:
+if n - 1 - m == 0:

-B = (B * (k-1-i))//(n-1-m)
+B = (B * (k-1-i)) // (n-1-m)

-D[k-1] = n+r+k-1-B
+D[k-1] = n + r + k - 1 - B
```
and these can be simplified:

```diff
-D = [0 for i in range(k)]
+D = [0]*k

-d = d + 1
+d += 1

-i = i + 1
+i += 1

-n = n - 1
+n += 1

-r = r - B
+r -= B

-m = m + 1
+m += 1

-j = j + 1
+j += 1
```
Also would it be possible to keep the same variable names as before? While I doubt anyone is explicitly calling it with `n=foo`, it is still good in terms of being fully backwards compatible. Plus I feel it would be better to define `n0 = n` instead of the other way around.



---

archive/issue_comments_458777.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43\"><code>0232cd6</code></a></td><td><code>reference [DGH2020] added in index.rst</code></td></tr></table>\n",
    "created_at": "2020-03-02T17:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458777",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43"><code>0232cd6</code></a></td><td><code>reference [DGH2020] added in index.rst</code></td></tr></table>




---

archive/issue_comments_458778.json:
```json
{
    "body": "Changed commit from **[`9a7a3cc`](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)** to **[`0232cd6`](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)**",
    "created_at": "2020-03-02T17:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458778",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9a7a3cc`](https://github.com/sagemath/sagetrac-mirror/commit/9a7a3ccaf713ea06371a79f093a35b155f744837)** to **[`0232cd6`](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)**



---

archive/issue_comments_458779.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nLooks like you have some corner case issues appearing in `src/sage/combinat/subset.py`.",
    "created_at": "2020-03-04T02:24:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458779",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

Looks like you have some corner case issues appearing in `src/sage/combinat/subset.py`.



---

archive/issue_events_399289.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-04T02:24:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399289"
}
```



---

archive/issue_events_399290.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-04T02:24:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399290"
}
```



---

archive/issue_comments_458780.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2\"><code>24799fb</code></a></td><td><code>test for the possible values of r corrected</code></td></tr></table>\n",
    "created_at": "2020-03-04T09:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458780",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2"><code>24799fb</code></a></td><td><code>test for the possible values of r corrected</code></td></tr></table>




---

archive/issue_comments_458781.json:
```json
{
    "body": "Changed commit from **[`0232cd6`](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)** to **[`24799fb`](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)**",
    "created_at": "2020-03-04T09:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458781",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0232cd6`](https://github.com/sagemath/sagetrac-mirror/commit/0232cd602af8f3ad27bd4dfadbf5d04d37933d43)** to **[`24799fb`](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)**



---

archive/issue_comments_458782.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd\"><code>e83efe8</code></a></td><td><code>Case n=0 now taken into account</code></td></tr></table>\n",
    "created_at": "2020-03-04T13:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458782",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd"><code>e83efe8</code></a></td><td><code>Case n=0 now taken into account</code></td></tr></table>




---

archive/issue_comments_458783.json:
```json
{
    "body": "Changed commit from **[`24799fb`](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)** to **[`e83efe8`](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)**",
    "created_at": "2020-03-04T13:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458783",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`24799fb`](https://github.com/sagemath/sagetrac-mirror/commit/24799fbb4c496df7ec5ca35782a984dae11972e2)** to **[`e83efe8`](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)**



---

archive/issue_events_399291.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-05T11:57:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399291"
}
```



---

archive/issue_events_399292.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-05T11:57:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399292"
}
```



---

archive/issue_events_399293.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-05T12:17:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399293"
}
```



---

archive/issue_events_399294.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-05T12:17:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399294"
}
```



---

archive/issue_comments_458784.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2020-03-05T12:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458784",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_458785.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThank you. LGTM.",
    "created_at": "2020-03-05T12:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458785",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

Thank you. LGTM.



---

archive/issue_events_399295.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-08T23:56:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399295"
}
```



---

archive/issue_events_399296.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-08T23:56:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399296"
}
```



---

archive/issue_comments_458786.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n\n```\nsage -t --long --warn-long 35.8 src/sage/rings/polynomial/pbori.pyx  # 3 doctests failed\nsage -t --long --warn-long 35.8 src/sage/matrix/matrix_mpolynomial_dense.pyx  # 4 doctests failed\n```",
    "created_at": "2020-03-08T23:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458786",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">comment:12</div>


```
sage -t --long --warn-long 35.8 src/sage/rings/polynomial/pbori.pyx  # 3 doctests failed
sage -t --long --warn-long 35.8 src/sage/matrix/matrix_mpolynomial_dense.pyx  # 4 doctests failed
```



---

archive/issue_comments_458787.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nSo here is the problem:\n\n```\nsage: from sage.combinat.combination import from_rank\nsage: from_rank(0, 2, 1)\n(1,)\nsage: from_rank(1, 2, 1)\n(2,)\n```\ninstead this should be `(0,)` and `(1,)`. I haven't traced through the algorithm, but from testing, this seems to be just some special corner case (if indeed there is no bug in the implementation). It works on larger values of `n` and `k`.",
    "created_at": "2020-03-09T03:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458787",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

So here is the problem:

```
sage: from sage.combinat.combination import from_rank
sage: from_rank(0, 2, 1)
(1,)
sage: from_rank(1, 2, 1)
(2,)
```
instead this should be `(0,)` and `(1,)`. I haven't traced through the algorithm, but from testing, this seems to be just some special corner case (if indeed there is no bug in the implementation). It works on larger values of `n` and `k`.



---

archive/issue_comments_458788.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe\"><code>110e94f</code></a></td><td><code>corner case n == 2 and k == 1 corrected with a direct answer when k == 1</code></td></tr></table>\n",
    "created_at": "2020-03-09T08:33:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458788",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe"><code>110e94f</code></a></td><td><code>corner case n == 2 and k == 1 corrected with a direct answer when k == 1</code></td></tr></table>




---

archive/issue_comments_458789.json:
```json
{
    "body": "Changed commit from **[`e83efe8`](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)** to **[`110e94f`](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)**",
    "created_at": "2020-03-09T08:33:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458789",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e83efe8`](https://github.com/sagemath/sagetrac-mirror/commit/e83efe8d55a54e90377ef25449748ffa91aeb3cd)** to **[`110e94f`](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)**



---

archive/issue_events_399297.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-09T08:38:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399297"
}
```



---

archive/issue_events_399298.json:
```json
{
    "actor": "https://github.com/agenitrini",
    "created_at": "2020-03-09T08:38:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399298"
}
```



---

archive/issue_comments_458790.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThank you. Green patchbot now. (Interestingly, there was a green patchbot on the previous version, so I was disregarding the other failing tests.) However, I am going to add a more systematic test (which is how I caught the corner case) on a push tomorrow morning. Should be trivial to review.",
    "created_at": "2020-03-09T12:22:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458790",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:16" align="right">comment:16</div>

Thank you. Green patchbot now. (Interestingly, there was a green patchbot on the previous version, so I was disregarding the other failing tests.) However, I am going to add a more systematic test (which is how I caught the corner case) on a push tomorrow morning. Should be trivial to review.



---

archive/issue_comments_458791.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHere is my trivial change and additional doctest.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b142db69e5f8f003af373b17a7a33111d33aa264\"><code>b142db6</code></a></td><td><code>Merge branch 'u/gh-agenitrini/combination_unranking_new_algorithm' of git://trac.sagemath.org/sage into public/combinat/new_combination_unranking-29262</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0\"><code>845c21e</code></a></td><td><code>Adding a systematic test against old version.</code></td></tr></table>\n",
    "created_at": "2020-03-09T23:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458791",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

Here is my trivial change and additional doctest.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b142db69e5f8f003af373b17a7a33111d33aa264"><code>b142db6</code></a></td><td><code>Merge branch 'u/gh-agenitrini/combination_unranking_new_algorithm' of git://trac.sagemath.org/sage into public/combinat/new_combination_unranking-29262</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0"><code>845c21e</code></a></td><td><code>Adding a systematic test against old version.</code></td></tr></table>




---

archive/issue_comments_458792.json:
```json
{
    "body": "Changed commit from **[`110e94f`](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)** to **[`845c21e`](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)**",
    "created_at": "2020-03-09T23:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458792",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[`110e94f`](https://github.com/sagemath/sagetrac-mirror/commit/110e94f0ebacf614a5d8083650e136daed6b5efe)** to **[`845c21e`](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)**



---

archive/issue_comments_458793.json:
```json
{
    "body": "Changed branch from **[u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)** to **[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)**",
    "created_at": "2020-03-09T23:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458793",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/gh-agenitrini/combination_unranking_new_algorithm](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-agenitrini/combination_unranking_new_algorithm)** to **[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)**



---

archive/issue_comments_458794.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nGreen bot. If you agree with my changes, then please set it back to a positive review.",
    "created_at": "2020-03-11T02:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458794",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Green bot. If you agree with my changes, then please set it back to a positive review.



---

archive/issue_comments_458795.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe tests are fine to me, thanks.",
    "created_at": "2020-03-11T06:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458795",
    "user": "https://github.com/agenitrini"
}
```

<div id="comment:19" align="right">comment:19</div>

The tests are fine to me, thanks.



---

archive/issue_events_399299.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-11T07:35:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399299"
}
```



---

archive/issue_events_399300.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-11T07:35:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399300"
}
```



---

archive/issue_events_399301.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-12T22:48:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399301"
}
```



---

archive/issue_events_399302.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3e3b0da5c868d8fc586c2532a0d4a9db0930900f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-03-12T22:48:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29262#event-399302"
}
```



---

archive/issue_comments_458796.json:
```json
{
    "body": "Changed branch from **[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)** to **[`845c21e`](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)**",
    "created_at": "2020-03-12T22:48:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29262#issuecomment-458796",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/combinat/new_combination_unranking-29262](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/new_combination_unranking-29262)** to **[`845c21e`](https://github.com/sagemath/sagetrac-mirror/commit/845c21e3e4c1c2890aaa7cc06e8810d39a756ba0)**
