# Issue 29868: pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf

archive/issues_029631.json:
```json
{
    "body": "Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n\nWe create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n\nWe create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\nIt is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n\nAll of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.\nThe incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n\nThe script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n\nFollow-up tickets:\n- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html\n- Or alternatively as a JupyterLab extension\n   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html\n\n\nSee also: \n- #30010: Split `sage_setup.docbuild` out to a separate package\n- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files\n\n\nCC:  @isuruf @kiwifb @antonio-rojas @timokau @nbruin @dimpase @jhpalmieri @mwageringel @zlscherr\n\nKeywords: sd111\n\nStatus: new\n\nDependencies: #33852\n\nIssue created by migration from https://trac.sagemath.org/ticket/29868\n\n",
    "created_at": "2020-06-15T15:57:37Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29868",
    "user": "https://github.com/mkoeppe"
}
```
Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.

We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.

We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.

All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.
The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.

The script `sage-grepdoc` will be provided by `sagemath-doc-html`.

Follow-up tickets:
- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html
- Or alternatively as a JupyterLab extension
   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html


See also: 
- #30010: Split `sage_setup.docbuild` out to a separate package
- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files


CC:  @isuruf @kiwifb @antonio-rojas @timokau @nbruin @dimpase @jhpalmieri @mwageringel @zlscherr

Keywords: sd111

Status: new

Dependencies: #33852

Issue created by migration from https://trac.sagemath.org/ticket/29868





---

archive/issue_comments_448575.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n Similar to #29411, which makes sagelib a script package, we make the sage docbuild a script package.\n+\n+\n+See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-06-28T19:23:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448575",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
 Similar to #29411, which makes sagelib a script package, we make the sage docbuild a script package.
+
+
+See also: #30010 - Split `sage_setup.docbuild` out to a separate package
+
 
 Comment: 1
 
``````




---

archive/issue_comments_448576.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. \n+\n+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-08-08T17:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448576",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+
+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. 
+
+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+See also: #30010 - Split `sage_setup.docbuild` out to a separate package
 
 
 Comment: 1
``````




---

archive/issue_comments_448577.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. \n+\n+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n+\n+See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-08-09T03:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448577",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,12 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+
+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. 
+
+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
+
+See also: #30010 - Split `sage_setup.docbuild` out to a separate package
 
 
 Comment: 1
``````




---

archive/issue_comments_448578.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. \n+\n+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n+\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-08-10T01:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448578",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+
+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. 
+
+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
+
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
 
 
 Comment: 1
``````




---

archive/issue_comments_448579.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n+\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-08-10T01:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448579",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+
+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
+
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
 
 
 Comment: 1
``````




---

archive/issue_events_076530.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76530"
}
```



---

archive/issue_comments_448580.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T17:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448580",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_448581.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-12-09T01:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448581",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
 
 
 Comment: 1
``````




---

archive/issue_comments_448582.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,15 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-12-30T18:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448582",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,15 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files
 
 
 Comment: 1
``````




---

archive/issue_comments_448583.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,23 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\n+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n+\n+We no longer install `doctrees` in `$SAGE_LOCAL/share/doc/sage/`.\n+The incremental build features of the docbuild will only be active when the package is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n+\n+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+Follow-up tickets:\n+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-06T03:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448583",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,23 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.
+
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.
+
+We no longer install `doctrees` in `$SAGE_LOCAL/share/doc/sage/`.
+The incremental build features of the docbuild will only be active when the package is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.
+
+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+Follow-up tickets:
+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files
 
 
 Comment: 1
``````




---

archive/issue_comments_448584.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,23 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\n+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n+\n+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.\n+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n+\n+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+Follow-up tickets:\n+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-02-06T05:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448584",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,23 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.
+
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.
+
+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.
+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.
+
+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+Follow-up tickets:
+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files
 
 
 Comment: 1
``````




---

archive/issue_events_076531.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76531"
}
```



---

archive/issue_events_076532.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76532"
}
```



---

archive/issue_comments_448585.json:
```json
{
    "body": "<a id='comment:14'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448585",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_448586.json:
```json
{
    "body": "<a id='comment:15'></a>Input and help from docbuild experts is very welcome.",
    "created_at": "2021-04-14T04:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448586",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Input and help from docbuild experts is very welcome.



---

archive/issue_comments_448587.json:
```json
{
    "body": "<a id='comment:16'></a>Some questions: \n\n- Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?\n\n- Is there a way to only generate the doctrees but not build HTML or PDF?\n\n- Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?",
    "created_at": "2021-04-15T00:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448587",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Some questions: 

- Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?

- Is there a way to only generate the doctrees but not build HTML or PDF?

- Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?



---

archive/issue_comments_448588.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 mkoeppe]:\n> Some questions: \n> \n> - Is there a way to only generate the doctrees but not build HTML or PDF?\n\n\nI do believe there is a sphinx option for doing just that.\n\n> \n> - Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?\n\n\nAs far as I know they need to be able to run the sage library. In particular all graphs/plots are generated during the documentation build.",
    "created_at": "2021-04-15T01:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448588",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>Replying to [comment:16 mkoeppe]:
> Some questions: 
> 
> - Is there a way to only generate the doctrees but not build HTML or PDF?


I do believe there is a sphinx option for doing just that.

> 
> - Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?


As far as I know they need to be able to run the sage library. In particular all graphs/plots are generated during the documentation build.



---

archive/issue_comments_448589.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 fbissey]:\n> Replying to [comment:16 mkoeppe]:\n> > Some questions: \n> > \n> > - Is there a way to only generate the doctrees but not build HTML or PDF?\n \n> \n> I do believe there is a sphinx option for doing just that.\n> \n\n\nI cannot find such an option anymore. If it existed. There is an option to say where the doctrees should be stored and found, but nothing on producing it in isolation.",
    "created_at": "2021-04-15T04:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448589",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:18'></a>Replying to [comment:17 fbissey]:
> Replying to [comment:16 mkoeppe]:
> > Some questions: 
> > 
> > - Is there a way to only generate the doctrees but not build HTML or PDF?
 
> 
> I do believe there is a sphinx option for doing just that.
> 


I cannot find such an option anymore. If it existed. There is an option to say where the doctrees should be stored and found, but nothing on producing it in isolation.



---

archive/issue_comments_448590.json:
```json
{
    "body": "<a id='comment:19'></a>Well, `./sage --docbuild all inventory` builds the inventory files and the doctree files, but not html or pdf.",
    "created_at": "2021-04-15T05:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448590",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>Well, `./sage --docbuild all inventory` builds the inventory files and the doctree files, but not html or pdf.



---

archive/issue_comments_448591.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:16 mkoeppe]:\n> Some questions: \n> \n> - Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?\n\n\nThe `autodoc` procedure does this, with `sage/monoids/free_monoid.py` as input. (Edit: or maybe just `src/doc/en/reference/monoids/index.rst` as input?) I'm not sure precisely how this is done, but the file `sage_docbuild/ext/sage_autodoc.py` is certainly relevant. (This is Sage's fork of the Sphinx autodoc module.)",
    "created_at": "2021-04-15T05:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448591",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>Replying to [comment:16 mkoeppe]:
> Some questions: 
> 
> - Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?


The `autodoc` procedure does this, with `sage/monoids/free_monoid.py` as input. (Edit: or maybe just `src/doc/en/reference/monoids/index.rst` as input?) I'm not sure precisely how this is done, but the file `sage_docbuild/ext/sage_autodoc.py` is certainly relevant. (This is Sage's fork of the Sphinx autodoc module.)



---

archive/issue_comments_448592.json:
```json
{
    "body": "<a id='comment:21'></a>No, I'm wrong about that. It's done in `sage_docbuild/__init__.py`, in the `write_auto_rest_file` method.",
    "created_at": "2021-04-15T05:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448592",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>No, I'm wrong about that. It's done in `sage_docbuild/__init__.py`, in the `write_auto_rest_file` method.



---

archive/issue_events_076533.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76533"
}
```



---

archive/issue_events_076534.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76534"
}
```



---

archive/issue_events_076535.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76535"
}
```



---

archive/issue_events_076536.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76536"
}
```



---

archive/issue_comments_448593.json:
```json
{
    "body": "<a id='comment:25'></a>According to #33064#comment:19, there is no need to install doctrees in `SAGE_LOCAL`, not even for introspection (`sage.misc.sphinxify`)",
    "created_at": "2022-01-12T02:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448593",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>According to #33064#comment:19, there is no need to install doctrees in `SAGE_LOCAL`, not even for introspection (`sage.misc.sphinxify`)



---

archive/issue_comments_448594.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,23 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\n+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n+\n+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.\n+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n+\n+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+Follow-up tickets:\n+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+\n+See also: \n+- #30010: Split `sage_setup.docbuild` out to a separate package\n+- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-01-12T08:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448594",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,23 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.
+
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.
+
+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.
+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.
+
+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+Follow-up tickets:
+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+
+See also: 
+- #30010: Split `sage_setup.docbuild` out to a separate package
+- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files
 
 
 Comment: 1
``````




---

archive/issue_events_076537.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76537"
}
```



---

archive/issue_events_076538.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76538"
}
```



---

archive/issue_comments_448595.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,27 @@\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n+\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+\n+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\n+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n+\n+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.\n+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n+\n+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+Follow-up tickets:\n+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html\n+- Or alternatively as a JupyterLab extension\n+   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html\n+\n+\n+See also: \n+- #30010: Split `sage_setup.docbuild` out to a separate package\n+- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-05-17T03:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-448595",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,27 @@
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.
+
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+
+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.
+
+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.
+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.
+
+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+Follow-up tickets:
+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html
+- Or alternatively as a JupyterLab extension
+   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html
+
+
+See also: 
+- #30010: Split `sage_setup.docbuild` out to a separate package
+- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files
 
 
 Comment: 1
``````




---

archive/issue_events_076539.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T20:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76539"
}
```



---

archive/issue_events_076540.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T20:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29868#event-76540"
}
```
