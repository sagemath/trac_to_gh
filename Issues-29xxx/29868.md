# Issue 29868: pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf

archive/issues_029631.json:
```json
{
    "body": "Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n\nWe create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n\nWe create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\nIt is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n\nAll of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.\nThe incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n\nThe script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n\nFollow-up tickets:\n- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html\n- Or alternatively as a JupyterLab extension\n   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html\n\n\nSee also: \n- #30010: Split `sage_setup.docbuild` out to a separate package\n- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files\n\n\nDepends on #33852\n\n**CC:**  @isuruf @kiwifb @antonio-rojas @timokau @nbruin @dimpase @jhpalmieri @mwageringel @zlscherr\n\n**Keywords:** sd111\n\nIssue created by migration from https://trac.sagemath.org/ticket/29868\n\n",
    "created_at": "2020-06-15T15:57:37Z",
    "labels": [
        "component: build",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "title": "pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/29868",
    "user": "https://github.com/mkoeppe"
}
```
Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.

We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.

We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.

All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.
The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.

The script `sage-grepdoc` will be provided by `sagemath-doc-html`.

Follow-up tickets:
- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html
- Or alternatively as a JupyterLab extension
   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html


See also: 
- #30010: Split `sage_setup.docbuild` out to a separate package
- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files


Depends on #33852

**CC:**  @isuruf @kiwifb @antonio-rojas @timokau @nbruin @dimpase @jhpalmieri @mwageringel @zlscherr

**Keywords:** sd111

Issue created by migration from https://trac.sagemath.org/ticket/29868





---

archive/issue_comments_474834.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Similar to #29411, which makes sagelib a script package, we make the sage docbuild a script package.\n \n \n+See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n+\n``````\n",
    "created_at": "2020-06-28T19:23:29Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474834",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Similar to #29411, which makes sagelib a script package, we make the sage docbuild a script package.
 
 
+See also: #30010 - Split `sage_setup.docbuild` out to a separate package
+
``````




---

archive/issue_comments_474835.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,8 @@\n-Similar to #29411, which makes sagelib a script package, we make the sage docbuild a script package.\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n \n+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. \n+\n+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n \n See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n \n``````\n",
    "created_at": "2020-08-08T17:23:38Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474835",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,8 @@
-Similar to #29411, which makes sagelib a script package, we make the sage docbuild a script package.
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
 
+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. 
+
+When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
 
 See also: #30010 - Split `sage_setup.docbuild` out to a separate package
 
``````




---

archive/issue_events_266495.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T17:23:38Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "rename": {
        "from": "Make sage docbuild a script package",
        "to": "pip-installable packages sage-doc-html, sage-doc-pdf"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266495"
}
```



---

archive/issue_comments_474836.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,5 +4,7 @@\n \n When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n \n+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n+\n See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n \n``````\n",
    "created_at": "2020-08-09T03:48:25Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474836",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,5 +4,7 @@
 
 When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
 
+Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
+
 See also: #30010 - Split `sage_setup.docbuild` out to a separate package
 
``````




---

archive/issue_comments_474837.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,5 +6,7 @@\n \n Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n \n-See also: #30010 - Split `sage_setup.docbuild` out to a separate package\n+See also: \n+- #30010 - Split `sage_setup.docbuild` out to a separate package\n+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n \n``````\n",
    "created_at": "2020-08-10T01:18:23Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474837",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,5 +6,7 @@
 
 Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
 
-See also: #30010 - Split `sage_setup.docbuild` out to a separate package
+See also: 
+- #30010 - Split `sage_setup.docbuild` out to a separate package
+- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
 
``````




---

archive/issue_comments_474838.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n \n-We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. \n+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n \n-When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n \n Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n \n``````\n",
    "created_at": "2020-08-10T01:30:32Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474838",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
 
-We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. 
+We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
 
-When installed using pip, they provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
 
 Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
 
``````




---

archive/issue_events_266496.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266496"
}
```



---

archive/issue_events_266497.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266497"
}
```



---

archive/issue_comments_474839.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd111\".",
    "created_at": "2020-12-06T17:42:54Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474839",
    "user": "https://github.com/mkoeppe"
}
```

**Changing keywords** from "" to "sd111".



---

archive/issue_comments_474840.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n \n-We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n \n When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n \n-Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.\n+Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n \n See also: \n - #30010 - Split `sage_setup.docbuild` out to a separate package\n``````\n",
    "created_at": "2020-12-09T01:50:04Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474840",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
 Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
 
-We create pip-installable packages `sage-doc-html` and `sage-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
+We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
 
 When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
 
-Also, the script `sage-grepdoc` will be provided by `sage-doc-html`.
+Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.
 
 See also: 
 - #30010 - Split `sage_setup.docbuild` out to a separate package
``````




---

archive/issue_events_266498.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-09T01:50:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "rename": {
        "from": "pip-installable packages sage-doc-html, sage-doc-pdf",
        "to": "pip-installable packages sagemath-doc-html, sagemath-doc-pdf"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266498"
}
```



---

archive/issue_comments_474841.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,4 +9,5 @@\n See also: \n - #30010 - Split `sage_setup.docbuild` out to a separate package\n - #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files\n \n``````\n",
    "created_at": "2020-12-30T18:10:51Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474841",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,4 +9,5 @@
 See also: 
 - #30010 - Split `sage_setup.docbuild` out to a separate package
 - #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files
 
``````




---

archive/issue_comments_474842.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,18 @@\n-Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.\n+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.\n \n We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.\n \n-When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\n+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n \n-Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+We no longer install `doctrees` in `$SAGE_LOCAL/share/doc/sage/`.\n+The incremental build features of the docbuild will only be active when the package is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n+\n+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n+\n+Follow-up tickets:\n+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n \n See also: \n - #30010 - Split `sage_setup.docbuild` out to a separate package\n``````\n",
    "created_at": "2021-02-06T03:22:17Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474842",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,18 @@
-Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the installation scheme of the sage documentation.
+Similar to #29411 + #29950, which made `sagelib` a pip-installable distribution (which is then installed by the sage-the-distribution script package `sagelib`), we change the build/installation scheme of the sage documentation.
 
 We create pip-installable packages `sagemath-doc-html` and `sagemath-doc-pdf`. By providing wheels on pypi, users can get access to an offline copy of the documentation without having to build it themselves.
 
-When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
+It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.
 
-Also, the script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+We no longer install `doctrees` in `$SAGE_LOCAL/share/doc/sage/`.
+The incremental build features of the docbuild will only be active when the package is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
+`pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.
+
+The script `sage-grepdoc` will be provided by `sagemath-doc-html`.
+
+Follow-up tickets:
+- When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
 
 See also: 
 - #30010 - Split `sage_setup.docbuild` out to a separate package
``````




---

archive/issue_events_266499.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-06T03:22:17Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "rename": {
        "from": "pip-installable packages sagemath-doc-html, sagemath-doc-pdf",
        "to": "pip-installable packages sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266499"
}
```



---

archive/issue_events_266500.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-06T05:45:01Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "rename": {
        "from": "pip-installable packages sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf",
        "to": "pip-installable packages sagemath-doc-src, sagemath-doc-inventory, sagemath-doc-html, sagemath-doc-pdf"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266500"
}
```



---

archive/issue_comments_474843.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,8 +5,8 @@\n We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.\n It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.\n \n-We no longer install `doctrees` in `$SAGE_LOCAL/share/doc/sage/`.\n-The incremental build features of the docbuild will only be active when the package is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.\n+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.\n `pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.\n \n The script `sage-grepdoc` will be provided by `sagemath-doc-html`.\n``````\n",
    "created_at": "2021-02-06T05:45:01Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474843",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,8 +5,8 @@
 We create a package `sagemath-doc-inventory`, which is in charge of building and installing the inventory files.
 It is a build dependency of `sagemath-doc-html` and `sagemath-doc-pdf`.
 
-We no longer install `doctrees` in `$SAGE_LOCAL/share/doc/sage/`.
-The incremental build features of the docbuild will only be active when the package is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
+All of these packages depend on `sagemath-doc-src`. It has a build-system dependency on sagelib. An `sdist` of it consists of `SAGE_SRC/doc`. A `wheel` of `sagemath-doc-src` (and thus an installation) contains a copy of the sources (including the auto-generated rst files) in `share/doc/sage/src/` and the doctrees in `share/doc/sage/doctrees`.
+The incremental build features of the docbuild will only be active when the package `sagemath-doc-src` is installed directly using `setup.py install`, `setup.py develop` or `pip install --editable`.  In these cases, the doctrees (including environment pickes) are kept in the source directory.
 `pip wheel` will always make a from-scratch build of the documentation, eliminating incremental build errors.
 
 The script `sage-grepdoc` will be provided by `sagemath-doc-html`.
``````




---

archive/issue_comments_474844.json:
```json
{
    "body": "**Dependencies:** #31356",
    "created_at": "2021-02-07T18:33:43Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474844",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #31356



---

archive/issue_events_266501.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266501"
}
```



---

archive/issue_events_266502.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266502"
}
```



---

archive/issue_comments_474845.json:
```json
{
    "body": "<a id='comment:14'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474845",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_474846.json:
```json
{
    "body": "<a id='comment:15'></a>\nInput and help from docbuild experts is very welcome.",
    "created_at": "2021-04-14T04:32:48Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474846",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Input and help from docbuild experts is very welcome.



---

archive/issue_comments_474847.json:
```json
{
    "body": "<a id='comment:16'></a>\nSome questions: \n\n- Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?\n\n- Is there a way to only generate the doctrees but not build HTML or PDF?\n\n- Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?",
    "created_at": "2021-04-15T00:49:20Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474847",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Some questions: 

- Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?

- Is there a way to only generate the doctrees but not build HTML or PDF?

- Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?



---

archive/issue_comments_474848.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [@mkoeppe](#comment%3A16):\n> Some questions: \n> \n> - Is there a way to only generate the doctrees but not build HTML or PDF?\n\nI do believe there is a sphinx option for doing just that.\n\n> \n> - Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?\n\nAs far as I know they need to be able to run the sage library. In particular all graphs/plots are generated during the documentation build.",
    "created_at": "2021-04-15T01:33:59Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474848",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
Replying to [@mkoeppe](#comment%3A16):
> Some questions: 
> 
> - Is there a way to only generate the doctrees but not build HTML or PDF?

I do believe there is a sphinx option for doing just that.

> 
> - Do the HTML and PDF builds need to be able to run the Sage library, or can they build these formats if given only the doctrees?

As far as I know they need to be able to run the sage library. In particular all graphs/plots are generated during the documentation build.



---

archive/issue_comments_474849.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [@kiwifb](#comment%3A17):\n> Replying to [@mkoeppe](#comment%3A16):\n> > Some questions: \n> > \n> > - Is there a way to only generate the doctrees but not build HTML or PDF?\n\n> \n> I do believe there is a sphinx option for doing just that.\n> \n\nI cannot find such an option anymore. If it existed. There is an option to say where the doctrees should be stored and found, but nothing on producing it in isolation.",
    "created_at": "2021-04-15T04:34:20Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474849",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:18'></a>
Replying to [@kiwifb](#comment%3A17):
> Replying to [@mkoeppe](#comment%3A16):
> > Some questions: 
> > 
> > - Is there a way to only generate the doctrees but not build HTML or PDF?

> 
> I do believe there is a sphinx option for doing just that.
> 

I cannot find such an option anymore. If it existed. There is an option to say where the doctrees should be stored and found, but nothing on producing it in isolation.



---

archive/issue_comments_474850.json:
```json
{
    "body": "<a id='comment:19'></a>\nWell, `./sage --docbuild all inventory` builds the inventory files and the doctree files, but not html or pdf.",
    "created_at": "2021-04-15T05:14:54Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474850",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
Well, `./sage --docbuild all inventory` builds the inventory files and the doctree files, but not html or pdf.



---

archive/issue_comments_474851.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [@mkoeppe](#comment%3A16):\n> Some questions: \n> \n> - Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?\n\nThe `autodoc` procedure does this, with `sage/monoids/free_monoid.py` as input. (Edit: or maybe just `src/doc/en/reference/monoids/index.rst` as input?) I'm not sure precisely how this is done, but the file `sage_docbuild/ext/sage_autodoc.py` is certainly relevant. (This is Sage's fork of the Sphinx autodoc module.)",
    "created_at": "2021-04-15T05:20:14Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474851",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>
Replying to [@mkoeppe](#comment%3A16):
> Some questions: 
> 
> - Who generates files such as `src/doc/en/reference/monoids/sage/monoids/free_monoid.rst`, and should they be part of what `sagemath-doc-src` installs (and thus ships with the wheel)?

The `autodoc` procedure does this, with `sage/monoids/free_monoid.py` as input. (Edit: or maybe just `src/doc/en/reference/monoids/index.rst` as input?) I'm not sure precisely how this is done, but the file `sage_docbuild/ext/sage_autodoc.py` is certainly relevant. (This is Sage's fork of the Sphinx autodoc module.)



---

archive/issue_comments_474852.json:
```json
{
    "body": "<a id='comment:21'></a>\nNo, I'm wrong about that. It's done in `sage_docbuild/__init__.py`, in the `write_auto_rest_file` method.",
    "created_at": "2021-04-15T05:24:10Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474852",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>
No, I'm wrong about that. It's done in `sage_docbuild/__init__.py`, in the `write_auto_rest_file` method.



---

archive/issue_events_266503.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266503"
}
```



---

archive/issue_events_266504.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266504"
}
```



---

archive/issue_comments_474853.json:
```json
{
    "body": "**Changing dependencies** from \"#31356\" to \"#31356, #32713\".",
    "created_at": "2021-11-09T21:02:38Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474853",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31356" to "#31356, #32713".



---

archive/issue_events_266505.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266505"
}
```



---

archive/issue_events_266506.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266506"
}
```



---

archive/issue_comments_474854.json:
```json
{
    "body": "<a id='comment:25'></a>\nAccording to [#33064 comment:19](https://github.com/sagemath/sage/issues/33064#comment:19), there is no need to install doctrees in `SAGE_LOCAL`, not even for introspection (`sage.misc.sphinxify`)",
    "created_at": "2022-01-12T02:54:47Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474854",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
According to [#33064 comment:19](https://github.com/sagemath/sage/issues/33064#comment:19), there is no need to install doctrees in `SAGE_LOCAL`, not even for introspection (`sage.misc.sphinxify`)



---

archive/issue_comments_474855.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,7 +15,7 @@\n - When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n \n See also: \n-- #30010 - Split `sage_setup.docbuild` out to a separate package\n-- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n-- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files\n+- #30010: Split `sage_setup.docbuild` out to a separate package\n+- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`\n+- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files\n \n``````\n",
    "created_at": "2022-01-12T08:33:19Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474855",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,7 +15,7 @@
 - When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
 
 See also: 
-- #30010 - Split `sage_setup.docbuild` out to a separate package
-- #29097 - `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
-- #29231 (add intersphinx mapping for SciPy) - with discussion about docbuild and inventory files
+- #30010: Split `sage_setup.docbuild` out to a separate package
+- #29097: `build/make/Makefile.in`: Rename make targets `SPKG-clean` to `SPKG-uninstall`
+- #29231: Add intersphinx mapping for SciPy -- with discussion about docbuild and inventory files
 
``````




---

archive/issue_events_266507.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266507"
}
```



---

archive/issue_events_266508.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266508"
}
```



---

archive/issue_comments_474856.json:
```json
{
    "body": "**Changing dependencies** from \"#31356, #32713\" to \"#33852\".",
    "created_at": "2022-05-15T07:04:19Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474856",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31356, #32713" to "#33852".



---

archive/issue_comments_474857.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,6 +13,10 @@\n \n Follow-up tickets:\n - When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).\n+   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html\n+- Or alternatively as a JupyterLab extension\n+   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html\n+\n \n See also: \n - #30010: Split `sage_setup.docbuild` out to a separate package\n``````\n",
    "created_at": "2022-05-17T03:43:21Z",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29868#issuecomment-474857",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,6 +13,10 @@
 
 Follow-up tickets:
 - When installed using pip, the packages provide `nbextension`s that provide offline help in a Jupyter notebook. This is useful in particular with local notebooks connecting to remote sage kernels (see  #30306 (3)).
+   - https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Distributing%20Jupyter%20Extensions%20as%20Python%20Packages.html
+- Or alternatively as a JupyterLab extension
+   - https://jupyterlab.readthedocs.io/en/stable/extension/extension_dev.html
+
 
 See also: 
 - #30010: Split `sage_setup.docbuild` out to a separate package
``````




---

archive/issue_events_266509.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T20:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266509"
}
```



---

archive/issue_events_266510.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T20:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29868",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29868#event-266510"
}
```
