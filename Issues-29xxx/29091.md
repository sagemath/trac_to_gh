# Issue 29091: tox.ini: Add raspbian-buster

archive/issues_028854.json:
```json
{
    "body": "On Raspberry Pi 4 4GB on Raspbian Buster build failed with fplll:\n\n```\nlibtool: link: g++ -std=gnu++11 -std=c++11 -fPIC -I/home/pi/sagemath/sage-9.1.be\nta1/local/include/ -O3 -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1.beta1/local/lib\n -o .libs/fplll main.o  -L/home/pi/sagemath/sage-9.1.beta1/local/lib -L/lib ./.l\nibs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1.\nbeta1/local/lib\n/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'\n/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'\ncollect2: error: ld returned 1 exit status\n```\n\nThis is fixed by upgrading FPLLL in #30021.\n\nIn this ticket, we add Docker-based testing for the platform `raspbian-buster-armhf` so that it can be verified that FPLLL now builds on this platform by the following:\n\n```\n  tox -e docker-raspbian-buster-armhf-standard -- fplll\n```\n\n\n\n\nDepends on #30021\n\n**CC:**  @malb @slel @fchapoton @kliem\n\n**Keywords:** raspberry\n\n**Branch/Commit:** [1b4c49715cd408788edda6f394034f220d48c6bc](https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc)\n\n**Upstream:** Completely fixed; Fix reported upstream\n\n**Reviewer:** Jaap Spies\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/29091\n\n",
    "closed_at": "2020-07-15T22:25:15Z",
    "created_at": "2020-01-28T09:52:03Z",
    "labels": [
        "component: build",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "title": "tox.ini: Add raspbian-buster",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/29091",
    "user": "https://github.com/jaapspies"
}
```
On Raspberry Pi 4 4GB on Raspbian Buster build failed with fplll:

```
libtool: link: g++ -std=gnu++11 -std=c++11 -fPIC -I/home/pi/sagemath/sage-9.1.be
ta1/local/include/ -O3 -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1.beta1/local/lib
 -o .libs/fplll main.o  -L/home/pi/sagemath/sage-9.1.beta1/local/lib -L/lib ./.l
ibs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1.
beta1/local/lib
/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'
/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'
collect2: error: ld returned 1 exit status
```

This is fixed by upgrading FPLLL in #30021.

In this ticket, we add Docker-based testing for the platform `raspbian-buster-armhf` so that it can be verified that FPLLL now builds on this platform by the following:

```
  tox -e docker-raspbian-buster-armhf-standard -- fplll
```




Depends on #30021

**CC:**  @malb @slel @fchapoton @kliem

**Keywords:** raspberry

**Branch/Commit:** [1b4c49715cd408788edda6f394034f220d48c6bc](https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc)

**Upstream:** Completely fixed; Fix reported upstream

**Reviewer:** Jaap Spies

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/29091





---

archive/attachments_022022.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "fplll-5.3.2.log",
    "asset_url": "tarball://root/attachments/ticket29091/fplll-5.3.2.log",
    "created_at": "2020-02-09T15:48:41Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket29091/fplll-5.3.2.log",
    "user": "https://github.com/mkoeppe"
}
```



---

archive/issue_comments_458196.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Attachment:** [fplll-5.3.2.log](https://github.com/sagemath/sage/files/ticket29091/fplll-5.3.2.log)\n\nI have added `raspbian-jessie` and `raspbian-stretch` to #29143. There appears to be no Docker image for raspbian-buster.",
    "created_at": "2020-02-09T15:48:41Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458196",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
**Attachment:** [fplll-5.3.2.log](https://github.com/sagemath/sage/files/ticket29091/fplll-5.3.2.log)

I have added `raspbian-jessie` and `raspbian-stretch` to #29143. There appears to be no Docker image for raspbian-buster.



---

archive/issue_comments_458197.json:
```json
{
    "body": "<a id='comment:2'></a>\nMoving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458197",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_events_258493.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258493"
}
```



---

archive/issue_events_258494.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-01T04:28:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258494"
}
```



---

archive/issue_comments_458198.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"raspberry\".",
    "created_at": "2020-05-13T11:22:15Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458198",
    "user": "https://github.com/fchapoton"
}
```

**Changing keywords** from "" to "raspberry".



---

archive/issue_comments_458199.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis *might* be fixed upstream, can you try again? See https://github.com/fplll/fplll/issues/418",
    "created_at": "2020-06-24T10:31:56Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458199",
    "user": "https://github.com/malb"
}
```

<a id='comment:4'></a>
This *might* be fixed upstream, can you try again? See https://github.com/fplll/fplll/issues/418



---

archive/issue_comments_458200.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [malb](#comment%3A4):\n> This *might* be fixed upstream, can you try again? See https://github.com/fplll/fplll/issues/418\n\nBuilding sage-9.1 I get still the same ailure:\n\n```\n/bin/bash ../libtool  --tag=CXX   --mode=link g++ -std=gnu++11 -std=c++11  -fPIC -I/home/pi/sagemath/sage-9.1/local/include/ -L/home/pi/sagemath/sage-9.1/local/lib -O3  -Wl,-rpath-link,/home/pi/sagemath/sage-9.1/local/lib -L/home/pi/sagemath/sage-9.1/local/lib -Wl,-rpath,/home/pi/sagemath/sage-9.1/local/lib  -L/lib -o fplll main.o libfplll.la -lmpfr -lmpfr -lgmp -lgmp \nlibtool: link: g++ -std=gnu++11 -std=c++11 -fPIC -I/home/pi/sagemath/sage-9.1/local/include/ -O3 -Wl,-rpath-link -Wl,/home/pi/sagemath/sage-9.1/local/lib -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1/local/lib -o .libs/fplll main.o  -L/home/pi/sagemath/sage-9.1/local/lib -L/lib ./.libs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1/local/lib\n/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'\n/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'\ncollect2: error: ld returned 1 exit status\nmake[7]: *** [Makefile:1165: fplll] Error 1\nmake[7]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src/fplll'\nmake[6]: *** [Makefile:739: all] Error 2\nmake[6]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src/fplll'\nmake[5]: *** [Makefile:483: all-recursive] Error 1\nmake[5]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src'\nmake[4]: *** [Makefile:370: all] Error 2\nmake[4]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src'\n********************************************************************************\nError building fplll-5.3.2\n********************************************************************************\n\nreal\t51m45.333s\nuser\t67m10.859s\nsys\t1m31.680s\n************************************************************************\nError installing package fplll-5.3.2\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the log file\n  /home/pi/sagemath/sage-9.1/logs/pkgs/fplll-5.3.2.log\nDescribe your computer, operating system, etc.\nIf you want to try to fix the problem yourself, *don't* just cd to\n/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2 and type 'make' or whatever is appropriate.\nInstead, the following commands setup all environment variables\ncorrectly and load a subshell for you to debug the error:\n  (cd '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2' && '/home/pi/sagemath/sage-9.1/sage' --buildsh)\nWhen you are done debugging, you can type \"exit\" to leave the subshell.\n************************************************************************\n```",
    "created_at": "2020-06-24T13:55:36Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458200",
    "user": "https://github.com/jaapspies"
}
```

<a id='comment:5'></a>
Replying to [malb](#comment%3A4):
> This *might* be fixed upstream, can you try again? See https://github.com/fplll/fplll/issues/418

Building sage-9.1 I get still the same ailure:

```
/bin/bash ../libtool  --tag=CXX   --mode=link g++ -std=gnu++11 -std=c++11  -fPIC -I/home/pi/sagemath/sage-9.1/local/include/ -L/home/pi/sagemath/sage-9.1/local/lib -O3  -Wl,-rpath-link,/home/pi/sagemath/sage-9.1/local/lib -L/home/pi/sagemath/sage-9.1/local/lib -Wl,-rpath,/home/pi/sagemath/sage-9.1/local/lib  -L/lib -o fplll main.o libfplll.la -lmpfr -lmpfr -lgmp -lgmp 
libtool: link: g++ -std=gnu++11 -std=c++11 -fPIC -I/home/pi/sagemath/sage-9.1/local/include/ -O3 -Wl,-rpath-link -Wl,/home/pi/sagemath/sage-9.1/local/lib -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1/local/lib -o .libs/fplll main.o  -L/home/pi/sagemath/sage-9.1/local/lib -L/lib ./.libs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1/local/lib
/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'
/usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'
collect2: error: ld returned 1 exit status
make[7]: *** [Makefile:1165: fplll] Error 1
make[7]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src/fplll'
make[6]: *** [Makefile:739: all] Error 2
make[6]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src/fplll'
make[5]: *** [Makefile:483: all-recursive] Error 1
make[5]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src'
make[4]: *** [Makefile:370: all] Error 2
make[4]: Leaving directory '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2/src'
********************************************************************************
Error building fplll-5.3.2
********************************************************************************

real	51m45.333s
user	67m10.859s
sys	1m31.680s
************************************************************************
Error installing package fplll-5.3.2
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log file
  /home/pi/sagemath/sage-9.1/logs/pkgs/fplll-5.3.2.log
Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2 and type 'make' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
  (cd '/home/pi/sagemath/sage-9.1/local/var/tmp/sage/build/fplll-5.3.2' && '/home/pi/sagemath/sage-9.1/sage' --buildsh)
When you are done debugging, you can type "exit" to leave the subshell.
************************************************************************
```



---

archive/issue_comments_458201.json:
```json
{
    "body": "<a id='comment:6'></a>\nSorry that fix isn't in Sage (or an upstream release yet). I meant trying upstream `master`. I should cut a new release, though.",
    "created_at": "2020-06-24T14:09:17Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458201",
    "user": "https://github.com/malb"
}
```

<a id='comment:6'></a>
Sorry that fix isn't in Sage (or an upstream release yet). I meant trying upstream `master`. I should cut a new release, though.



---

archive/issue_comments_458202.json:
```json
{
    "body": "**Upstream:** Reported upstream. Developers acknowledge bug.",
    "created_at": "2020-06-24T16:31:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458202",
    "user": "https://github.com/slel"
}
```

**Upstream:** Reported upstream. Developers acknowledge bug.



---

archive/issue_comments_458203.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n+On Raspberry Pi 4 4GB on Raspbian Buster build failed with fplll:\n \n ```\n-On Raspberry Pi 4 4GB on Raspbian Buster build failed with fplll:\n-\n libtool: link: g++ -std=gnu++11 -std=c++11 -fPIC -I/home/pi/sagemath/sage-9.1.be\n ta1/local/include/ -O3 -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1.beta1/local/lib\n  -o .libs/fplll main.o  -L/home/pi/sagemath/sage-9.1.beta1/local/lib -L/lib ./.l\n@@ -10,5 +9,4 @@\n /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'\n /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'\n collect2: error: ld returned 1 exit status\n-\n ```\n``````\n",
    "created_at": "2020-06-24T16:31:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458203",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
+On Raspberry Pi 4 4GB on Raspbian Buster build failed with fplll:
 
 ```
-On Raspberry Pi 4 4GB on Raspbian Buster build failed with fplll:
-
 libtool: link: g++ -std=gnu++11 -std=c++11 -fPIC -I/home/pi/sagemath/sage-9.1.be
 ta1/local/include/ -O3 -Wl,-rpath -Wl,/home/pi/sagemath/sage-9.1.beta1/local/lib
  -o .libs/fplll main.o  -L/home/pi/sagemath/sage-9.1.beta1/local/lib -L/lib ./.l
@@ -10,5 +9,4 @@
 /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'
 /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'
 collect2: error: ld returned 1 exit status
-
 ```
``````




---

archive/issue_comments_458204.json:
```json
{
    "body": "<a id='comment:7'></a>\nI opened this issue in the fplll issue tracker\n\n- Fix ARM-specific problem with new multicore code in fplll 5.3.x\n\n  https://github.com/fplll/fplll/issues/432\n\nbut apparently this issue might have been relevant\n\n- add `-latomic` when needed\n\n  https://github.com/fplll/fplll/issues/418\n\nand it was fixed in Apr 2020 by this pull request\n\n- check for -latomic\n\n  https://github.com/fplll/fplll/pull/419\n\nThe current latest release, fplll 5.3.2, is from Jan 2020.\nThus the fix should be tried by using the master branch.\nI hope it fixes things and the next release works on ARM.\nSorry for the extra noise.",
    "created_at": "2020-06-24T16:31:13Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458204",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>
I opened this issue in the fplll issue tracker

- Fix ARM-specific problem with new multicore code in fplll 5.3.x

  https://github.com/fplll/fplll/issues/432

but apparently this issue might have been relevant

- add `-latomic` when needed

  https://github.com/fplll/fplll/issues/418

and it was fixed in Apr 2020 by this pull request

- check for -latomic

  https://github.com/fplll/fplll/pull/419

The current latest release, fplll 5.3.2, is from Jan 2020.
Thus the fix should be tried by using the master branch.
I hope it fixes things and the next release works on ARM.
Sorry for the extra noise.



---

archive/issue_comments_458205.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/raspian-buster](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/raspian-buster)",
    "created_at": "2020-06-24T20:21:09Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458205",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/raspian-buster](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/raspian-buster)



---

archive/issue_comments_458206.json:
```json
{
    "body": "<a id='comment:9'></a>\nI have just added a test environment for `raspbian-buster`.\nYou can try\n\n```\ntox -e docker-raspbian-buster-standard -- fplll\n```\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d\">e5e2244</a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add raspbian-buster</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/714bdcefc02e22ba0c0174a5cab78d13e5f92264\">714bdce</a></td><td><code>.github/workflows/tox*.yml: Add raspbian-stretch, raspbian-buster</code></td></tr></table>\n",
    "created_at": "2020-06-24T20:22:41Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458206",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
I have just added a test environment for `raspbian-buster`.
You can try

```
tox -e docker-raspbian-buster-standard -- fplll
```

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d">e5e2244</a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add raspbian-buster</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/714bdcefc02e22ba0c0174a5cab78d13e5f92264">714bdce</a></td><td><code>.github/workflows/tox*.yml: Add raspbian-stretch, raspbian-buster</code></td></tr></table>




---

archive/issue_comments_458207.json:
```json
{
    "body": "**Commit:** [714bdcefc02e22ba0c0174a5cab78d13e5f92264](https://github.com/sagemath/sagetrac-mirror/commit/714bdcefc02e22ba0c0174a5cab78d13e5f92264)",
    "created_at": "2020-06-24T20:22:41Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458207",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [714bdcefc02e22ba0c0174a5cab78d13e5f92264](https://github.com/sagemath/sagetrac-mirror/commit/714bdcefc02e22ba0c0174a5cab78d13e5f92264)



---

archive/issue_comments_458208.json:
```json
{
    "body": "<a id='comment:10'></a>\nTests running at https://github.com/mkoeppe/sage/actions/runs/146618564",
    "created_at": "2020-06-24T20:23:19Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458208",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Tests running at https://github.com/mkoeppe/sage/actions/runs/146618564



---

archive/issue_comments_458209.json:
```json
{
    "body": "<a id='comment:11'></a>\nRunning this on my Mac, I was able to reproduce the error:\n\n```\n  [fplll-5.3.2] error installing, exit status 1. End of log file:\n  [fplll-5.3.2]   make[5]: *** [Makefile:1175: latsieve] Error 1\n  [fplll-5.3.2]   /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'\n  [fplll-5.3.2]   /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'\n  [fplll-5.3.2]   collect2: error: ld returned 1 exit status\n  [fplll-5.3.2]   make[5]: *** [Makefile:1165: fplll] Error 1\n  [fplll-5.3.2]   make[5]: Target 'all-am' not remade because of errors.\n  [fplll-5.3.2]   make[5]: Leaving directory '/sage/local/var/tmp/sage/build/fplll-5.3.2/src/fplll'\n  [fplll-5.3.2]   make[4]: *** [Makefile:739: all] Error 2\n```",
    "created_at": "2020-06-24T22:15:32Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458209",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Running this on my Mac, I was able to reproduce the error:

```
  [fplll-5.3.2] error installing, exit status 1. End of log file:
  [fplll-5.3.2]   make[5]: *** [Makefile:1175: latsieve] Error 1
  [fplll-5.3.2]   /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_store_8'
  [fplll-5.3.2]   /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'
  [fplll-5.3.2]   collect2: error: ld returned 1 exit status
  [fplll-5.3.2]   make[5]: *** [Makefile:1165: fplll] Error 1
  [fplll-5.3.2]   make[5]: Target 'all-am' not remade because of errors.
  [fplll-5.3.2]   make[5]: Leaving directory '/sage/local/var/tmp/sage/build/fplll-5.3.2/src/fplll'
  [fplll-5.3.2]   make[4]: *** [Makefile:739: all] Error 2
```



---

archive/issue_comments_458210.json:
```json
{
    "body": "**Changing author** from \"jsp\" to \"Matthias Koeppe\".",
    "created_at": "2020-06-25T00:08:07Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458210",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "jsp" to "Matthias Koeppe".



---

archive/issue_comments_458211.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [mkoeppe](#comment%3A9):\n> I have just added a test environment for `raspbian-buster`.\n> You can try\n> \n> ```\n> tox -e docker-raspbian-buster-standard -- fplll\n> ```\n\nActually, it is\n\n```\n  tox -e docker-raspbian-buster-armhf-standard -- fplll\n```\nwhich will also work on Linux Docker.\n\nTests with fplll@master run at https://github.com/mkoeppe/fplll/actions/runs/146958161",
    "created_at": "2020-06-25T04:37:29Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458211",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Replying to [mkoeppe](#comment%3A9):
> I have just added a test environment for `raspbian-buster`.
> You can try
> 
> ```
> tox -e docker-raspbian-buster-standard -- fplll
> ```

Actually, it is

```
  tox -e docker-raspbian-buster-armhf-standard -- fplll
```
which will also work on Linux Docker.

Tests with fplll@master run at https://github.com/mkoeppe/fplll/actions/runs/146958161



---

archive/issue_comments_458212.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mkoeppe](#comment%3A13):\n> Tests with fplll@master run at https://github.com/mkoeppe/fplll/actions/runs/146958161\n\nIt says:\n> The job running on runner [GitHub](../wikis/GitHub) Actions 36 has exceeded the maximum execution time of 360. \n\nCould a tox environment install most dependencies using Conda via miniforge?\n\nMiniforge provides Conda on ARM:\n\n- https://github.com/conda-forge/miniforge/",
    "created_at": "2020-06-25T13:06:57Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458212",
    "user": "https://github.com/slel"
}
```

<a id='comment:14'></a>
Replying to [mkoeppe](#comment%3A13):
> Tests with fplll@master run at https://github.com/mkoeppe/fplll/actions/runs/146958161

It says:
> The job running on runner [GitHub](../wikis/GitHub) Actions 36 has exceeded the maximum execution time of 360. 

Could a tox environment install most dependencies using Conda via miniforge?

Miniforge provides Conda on ARM:

- https://github.com/conda-forge/miniforge/



---

archive/issue_comments_458213.json:
```json
{
    "body": "<a id='comment:15'></a>\nfplll@master on `raspbian-buster-armhf-standard` succeeded in 5h 7m 1s at\n https://github.com/mkoeppe/fplll/runs/805921434 \n\nThis confirms that master contains the correct fix.",
    "created_at": "2020-06-25T17:15:51Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458213",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
fplll@master on `raspbian-buster-armhf-standard` succeeded in 5h 7m 1s at
 https://github.com/mkoeppe/fplll/runs/805921434 

This confirms that master contains the correct fix.



---

archive/issue_comments_458214.json:
```json
{
    "body": "<a id='comment:16'></a>\nhttps://github.com/fplll/fplll/pull/433",
    "created_at": "2020-06-25T17:28:40Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458214",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
https://github.com/fplll/fplll/pull/433



---

archive/issue_comments_458215.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2020-06-25T18:41:14Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458215",
    "user": "https://github.com/mkoeppe"
}
```

**Changing upstream** from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_458216.json:
```json
{
    "body": "**Changing commit** from \"[714bdcefc02e22ba0c0174a5cab78d13e5f92264](https://github.com/sagemath/sagetrac-mirror/commit/714bdcefc02e22ba0c0174a5cab78d13e5f92264)\" to \"[e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d](https://github.com/sagemath/sagetrac-mirror/commit/e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d)\".",
    "created_at": "2020-06-26T00:10:14Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[714bdcefc02e22ba0c0174a5cab78d13e5f92264](https://github.com/sagemath/sagetrac-mirror/commit/714bdcefc02e22ba0c0174a5cab78d13e5f92264)" to "[e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d](https://github.com/sagemath/sagetrac-mirror/commit/e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d)".



---

archive/issue_comments_458217.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:",
    "created_at": "2020-06-26T00:10:14Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:



---

archive/issue_comments_458218.json:
```json
{
    "body": "<a id='comment:19'></a>\nRemoved 714bdce from the branch - the build is so slow because of the emulation that it does not make sense to test the sage distribution on this platform on GH Actions.",
    "created_at": "2020-06-26T00:11:41Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458218",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Removed 714bdce from the branch - the build is so slow because of the emulation that it does not make sense to test the sage distribution on this platform on GH Actions.



---

archive/issue_comments_458219.json:
```json
{
    "body": "<a id='comment:20'></a>\nSee https://github.com/fplll/fplll/releases/tag/5.3.3 and #30021.",
    "created_at": "2020-06-29T15:59:10Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458219",
    "user": "https://github.com/malb"
}
```

<a id='comment:20'></a>
See https://github.com/fplll/fplll/releases/tag/5.3.3 and #30021.



---

archive/issue_comments_458220.json:
```json
{
    "body": "**Dependencies:** #30021",
    "created_at": "2020-06-29T16:31:54Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458220",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #30021



---

archive/issue_comments_458221.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/242c55239c18a11921d24ed55749b56389c61e3a\">242c552</a></td><td><code>update FPLLL to 5.3.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53acc590061bf587170671fd5a7b0a148a34fbab\">53acc59</a></td><td><code>add upstream_url for fplll</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc\">1b4c497</a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add raspbian-buster</code></td></tr></table>\n",
    "created_at": "2020-07-03T04:30:07Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/242c55239c18a11921d24ed55749b56389c61e3a">242c552</a></td><td><code>update FPLLL to 5.3.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53acc590061bf587170671fd5a7b0a148a34fbab">53acc59</a></td><td><code>add upstream_url for fplll</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc">1b4c497</a></td><td><code>tox.ini, build/bin/write-dockerfile.sh: Add raspbian-buster</code></td></tr></table>




---

archive/issue_comments_458222.json:
```json
{
    "body": "**Changing commit** from \"[e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d](https://github.com/sagemath/sagetrac-mirror/commit/e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d)\" to \"[1b4c49715cd408788edda6f394034f220d48c6bc](https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc)\".",
    "created_at": "2020-07-03T04:30:07Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d](https://github.com/sagemath/sagetrac-mirror/commit/e5e2244b7ba11b48a661da9b1a0d7abbaf8baa8d)" to "[1b4c49715cd408788edda6f394034f220d48c6bc](https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc)".



---

archive/issue_comments_458223.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, but not in a stable release.\" to \"Completely fixed; Fix reported upstream\".",
    "created_at": "2020-07-03T04:30:32Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458223",
    "user": "https://github.com/mkoeppe"
}
```

**Changing upstream** from "Fixed upstream, but not in a stable release." to "Completely fixed; Fix reported upstream".



---

archive/issue_events_258495.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-03T04:30:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258495"
}
```



---

archive/issue_comments_458224.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,3 +10,14 @@\n /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'\n collect2: error: ld returned 1 exit status\n ```\n+\n+This is fixed by upgrading FPLLL in #30021.\n+\n+In this ticket, we add Docker-based testing for the platform `raspbian-buster-armhf` so that it can be verified that FPLLL now builds on this platform by the following:\n+\n+```\n+  tox -e docker-raspbian-buster-armhf-standard -- fplll\n+```\n+\n+\n+\n``````\n",
    "created_at": "2020-07-03T04:30:32Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458224",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,3 +10,14 @@
 /usr/bin/ld: ./.libs/libfplll.so: undefined reference to `__atomic_load_8'
 collect2: error: ld returned 1 exit status
 ```
+
+This is fixed by upgrading FPLLL in #30021.
+
+In this ticket, we add Docker-based testing for the platform `raspbian-buster-armhf` so that it can be verified that FPLLL now builds on this platform by the following:
+
+```
+  tox -e docker-raspbian-buster-armhf-standard -- fplll
+```
+
+
+
``````




---

archive/issue_events_258496.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-03T20:25:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "minor",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258496"
}
```



---

archive/issue_events_258497.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-08T23:27:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "rename": {
        "from": "Build failure of  fplll-5.3.2 on Raspbian Buster (ARM)",
        "to": "tox.ini: Add raspbian-buster"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258497"
}
```



---

archive/issue_events_258498.json:
```json
{
    "actor": "https://github.com/jaapspies",
    "created_at": "2020-07-09T14:06:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258498"
}
```



---

archive/issue_events_258499.json:
```json
{
    "actor": "https://github.com/jaapspies",
    "created_at": "2020-07-09T14:06:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258499"
}
```



---

archive/issue_comments_458225.json:
```json
{
    "body": "<a id='comment:27'></a>\nWorks for me on a Raspberry Pi 4 4GB, Raspbian Buster",
    "created_at": "2020-07-09T14:06:56Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458225",
    "user": "https://github.com/jaapspies"
}
```

<a id='comment:27'></a>
Works for me on a Raspberry Pi 4 4GB, Raspbian Buster



---

archive/issue_comments_458226.json:
```json
{
    "body": "<a id='comment:28'></a>\nHere you can read more about how we address portability testing. One does not need an actual Raspberry Pi. https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker",
    "created_at": "2020-07-09T14:12:51Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458226",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
Here you can read more about how we address portability testing. One does not need an actual Raspberry Pi. https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker



---

archive/issue_comments_458227.json:
```json
{
    "body": "<a id='comment:29'></a>\nI noted on some other ticket that [GitHub](../wikis/GitHub) Actions offer an ARM platform.",
    "created_at": "2020-07-09T14:58:31Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458227",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>
I noted on some other ticket that [GitHub](../wikis/GitHub) Actions offer an ARM platform.



---

archive/issue_events_258500.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-11T23:26:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258500"
}
```



---

archive/issue_events_258501.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-11T23:26:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258501"
}
```



---

archive/issue_comments_458228.json:
```json
{
    "body": "<a id='comment:30'></a>\nReviewer name is missing",
    "created_at": "2020-07-11T23:26:05Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458228",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'></a>
Reviewer name is missing



---

archive/issue_comments_458229.json:
```json
{
    "body": "**Reviewer:** Jaap Spies",
    "created_at": "2020-07-11T23:38:05Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458229",
    "user": "https://github.com/slel"
}
```

**Reviewer:** Jaap Spies



---

archive/issue_events_258502.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-07-11T23:38:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258502"
}
```



---

archive/issue_events_258503.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-07-11T23:38:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258503"
}
```



---

archive/issue_events_258504.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-15T22:25:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258504"
}
```



---

archive/issue_events_258505.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "10f0dad9c8d769546d0b629d1272a6fc6ebe839a",
    "created_at": "2020-07-15T22:25:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29091#event-258505"
}
```



---

archive/issue_comments_458230.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/raspian-buster](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/raspian-buster)\" to \"[1b4c49715cd408788edda6f394034f220d48c6bc](https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc)\".",
    "created_at": "2020-07-15T22:25:15Z",
    "issue": "https://github.com/sagemath/sage/issues/29091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29091#issuecomment-458230",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/raspian-buster](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/raspian-buster)" to "[1b4c49715cd408788edda6f394034f220d48c6bc](https://github.com/sagemath/sagetrac-mirror/commit/1b4c49715cd408788edda6f394034f220d48c6bc)".
