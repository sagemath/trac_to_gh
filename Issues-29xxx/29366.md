# Issue 29366: archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages

archive/issues_029129.json:
```json
{
    "body": "https://groups.google.com/d/msg/sage-devel/JgArPVx7dwg/gMxeB4b7AgAJ\n\nTo test:\n\n```\n  tox -e docker-archlinux-latest-standard\n```\n\n\nCC:  @videlec @antonio-rojas @dimpase\n\nBranch/Commit: 338468facda0ba5aef8ab8c505bdcaa4e47efb7b\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe, Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29366\n\n",
    "closed_at": "2020-04-09T22:44:51Z",
    "created_at": "2020-03-19T14:23:55Z",
    "labels": [
        "component: porting"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "archlinux: Add missing system packages (arch.txt), add arch section to installation manual, fix detection of system packages",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29366",
    "user": "https://github.com/mkoeppe"
}
```
https://groups.google.com/d/msg/sage-devel/JgArPVx7dwg/gMxeB4b7AgAJ

To test:

```
  tox -e docker-archlinux-latest-standard
```


CC:  @videlec @antonio-rojas @dimpase

Branch/Commit: 338468facda0ba5aef8ab8c505bdcaa4e47efb7b

Reviewer: Dima Pasechnik

Author: Matthias Koeppe, Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29366





---

archive/issue_comments_439116.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [config.log](tarball://root/attachments/some-uuid/ticket29366/config.log) by @dimpase created at 2020-03-19 15:10:54\n\nnot sure there is much on Sage's side that can be done - apart from keeping correct lists of packages to install.",
    "created_at": "2020-03-19T15:10:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439116",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>Attachment [config.log](tarball://root/attachments/some-uuid/ticket29366/config.log) by @dimpase created at 2020-03-19 15:10:54

not sure there is much on Sage's side that can be done - apart from keeping correct lists of packages to install.



---

archive/issue_comments_439117.json:
```json
{
    "body": "<a id='comment:4'></a>Indeed, I would like to be sure that it is not on Sage side **and** have an up to date developer manual for the relevant packages.",
    "created_at": "2020-03-19T15:14:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439117",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Indeed, I would like to be sure that it is not on Sage side **and** have an up to date developer manual for the relevant packages.



---

archive/issue_comments_439118.json:
```json
{
    "body": "Attachment [configure-output.log](tarball://root/attachments/some-uuid/ticket29366/configure-output.log) by @videlec created at 2020-03-19 15:15:37",
    "created_at": "2020-03-19T15:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439118",
    "user": "https://github.com/videlec"
}
```

Attachment [configure-output.log](tarball://root/attachments/some-uuid/ticket29366/configure-output.log) by @videlec created at 2020-03-19 15:15:37



---

archive/issue_comments_439119.json:
```json
{
    "body": "<a id='comment:5'></a>In case you haven't seen it yet: the system package lists in the developer's manual are now autogenerated. But adding some Arch specific instructions would be a useful addition",
    "created_at": "2020-03-19T15:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439119",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>In case you haven't seen it yet: the system package lists in the developer's manual are now autogenerated. But adding some Arch specific instructions would be a useful addition



---

archive/issue_comments_439120.json:
```json
{
    "body": "<a id='comment:6'></a>Installation manual, that is",
    "created_at": "2020-03-19T15:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439120",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>Installation manual, that is



---

archive/issue_comments_439121.json:
```json
{
    "body": "<a id='comment:7'></a>Well, config.log is clear enough on e.g. what's missing w.r.t. Pari:\nnamely, install elldata, galpol, seadata, as seen in\n\n```\nconfigure:14982: checking is pari_elldata installed?\n1735\t  ***   at top-level: r=ellinit(\"11a1\");r[11]\n1736\t  ***                   ^---------------------\n1737\t  *** ellinit: error opening elldata file: `/usr/share/pari/elldata/ell0'.\n1738\tconfigure:14989: result: no; cannot use system pari/GP without elldata package\n1739\tconfigure:14991: Install elldata package and reconfigure.\n1740\tconfigure:14993: Otherwise Sage will build its own pari/GP.\n1741\tconfigure:14997: checking is pari_galdata installed?\n1742\tconfigure:15001: result: yes\n1743\tconfigure:15012: checking is pari_galpol installed?\n1744\t  ***   at top-level: galoisgetname(12,1)==\"C3 : C4\"\n1745\t  ***                 ^------------------------------\n1746\t  *** galoisgetname: error opening galpol file: `/usr/share/pari/galpol/12/nb'.\n1747\tconfigure:15019: result: no; cannot use system pari/GP without galpol package\n1748\tconfigure:15021: Install galpol package and reconfigure.\n1749\tconfigure:15023: Otherwise Sage will build its own pari/GP.\n1750\tconfigure:15027: checking is pari_seadata installed?\n1751\t  ***   at top-level: poldegree(ellmodulareqn(211)[1])\n1752\t  ***                           ^----------------------\n1753\t  *** ellmodulareqn: error opening seadata file: `/usr/share/pari/seadata/sea211'.\n1754\tconfigure:15034: result: no; cannot use system pari/GP without seadata package\n1755\tconfigure:15036: Install seadata package and reconfigure.\n1756\tconfigure:15038: Otherwise Sage will build its own pari/GP.\n1757\tconfigure:15266: no suitable system package found for SPKG pari\n1758\tconfigure:15284: result: using Sage's pari SPKG\n```",
    "created_at": "2020-03-19T15:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439121",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Well, config.log is clear enough on e.g. what's missing w.r.t. Pari:
namely, install elldata, galpol, seadata, as seen in

```
configure:14982: checking is pari_elldata installed?
1735	  ***   at top-level: r=ellinit("11a1");r[11]
1736	  ***                   ^---------------------
1737	  *** ellinit: error opening elldata file: `/usr/share/pari/elldata/ell0'.
1738	configure:14989: result: no; cannot use system pari/GP without elldata package
1739	configure:14991: Install elldata package and reconfigure.
1740	configure:14993: Otherwise Sage will build its own pari/GP.
1741	configure:14997: checking is pari_galdata installed?
1742	configure:15001: result: yes
1743	configure:15012: checking is pari_galpol installed?
1744	  ***   at top-level: galoisgetname(12,1)=="C3 : C4"
1745	  ***                 ^------------------------------
1746	  *** galoisgetname: error opening galpol file: `/usr/share/pari/galpol/12/nb'.
1747	configure:15019: result: no; cannot use system pari/GP without galpol package
1748	configure:15021: Install galpol package and reconfigure.
1749	configure:15023: Otherwise Sage will build its own pari/GP.
1750	configure:15027: checking is pari_seadata installed?
1751	  ***   at top-level: poldegree(ellmodulareqn(211)[1])
1752	  ***                           ^----------------------
1753	  *** ellmodulareqn: error opening seadata file: `/usr/share/pari/seadata/sea211'.
1754	configure:15034: result: no; cannot use system pari/GP without seadata package
1755	configure:15036: Install seadata package and reconfigure.
1756	configure:15038: Otherwise Sage will build its own pari/GP.
1757	configure:15266: no suitable system package found for SPKG pari
1758	configure:15284: result: using Sage's pari SPKG
```



---

archive/issue_comments_439122.json:
```json
{
    "body": "<a id='comment:8'></a>Nothing to fix on Arch side either - givaro is not used because you have an older version on /usr/local which is detected first, and pari is not used because of missing optional packages",
    "created_at": "2020-03-19T15:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439122",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:8'></a>Nothing to fix on Arch side either - givaro is not used because you have an older version on /usr/local which is detected first, and pari is not used because of missing optional packages



---

archive/issue_comments_439123.json:
```json
{
    "body": "<a id='comment:9'></a>Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?",
    "created_at": "2020-03-19T15:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439123",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?



---

archive/issue_comments_439124.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 mkoeppe]:\n> Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?\n\n\nLooks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. Other packages (fplll, ecm) are simply not installed on the build machine.",
    "created_at": "2020-03-19T15:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439124",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:10'></a>Replying to [comment:9 mkoeppe]:
> Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?


Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. Other packages (fplll, ecm) are simply not installed on the build machine.



---

archive/issue_comments_439125.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 arojas]:\n> Replying to [comment:9 mkoeppe]:\n> > Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?\n\n> \n> Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. \n\n\nRight, this build is using #29339 - Fix NTL spkg-configure.m4 so it rejects NTLs built with NTL_THREADS\n\n> Other packages (fplll, ecm) are simply not installed on the build machine.\n\n\nOK, this means we need to add `arch.txt` files for these packages",
    "created_at": "2020-03-19T15:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439125",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>Replying to [comment:10 arojas]:
> Replying to [comment:9 mkoeppe]:
> > Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?

> 
> Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. 


Right, this build is using #29339 - Fix NTL spkg-configure.m4 so it rejects NTLs built with NTL_THREADS

> Other packages (fplll, ecm) are simply not installed on the build machine.


OK, this means we need to add `arch.txt` files for these packages



---

archive/issue_comments_439126.json:
```json
{
    "body": "<a id='comment:12'></a>and for more of the following listed here:\n\nconfigure: notice: the following SPKGs did not find equivalent system packages: arb cbc cliquer cmake eclib ecm flint fplll git givaro gp2c isl lcalc libatomic_ops libsemigroups mpfi ninja_build ntl pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small perl_term_readline_gnu yasm zeromq",
    "created_at": "2020-03-19T15:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439126",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>and for more of the following listed here:

configure: notice: the following SPKGs did not find equivalent system packages: arb cbc cliquer cmake eclib ecm flint fplll git givaro gp2c isl lcalc libatomic_ops libsemigroups mpfi ninja_build ntl pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small perl_term_readline_gnu yasm zeromq



---

archive/issue_comments_439127.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 mkoeppe]:\n> Replying to [comment:10 arojas]:\n> > Replying to [comment:9 mkoeppe]:\n> > > Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?\n\n> > \n> > Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. \n\n> \n> Right, this build is using #29339 - Fix NTL spkg-configure.m4 so it rejects NTLs built with NTL_THREADS\n\n\nI believe that I was able to use Arch's NTL in builds few betas ago.\nThis again points at #29339 as being too drastic in its approach.",
    "created_at": "2020-03-19T15:44:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439127",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>Replying to [comment:11 mkoeppe]:
> Replying to [comment:10 arojas]:
> > Replying to [comment:9 mkoeppe]:
> > > Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?

> > 
> > Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. 

> 
> Right, this build is using #29339 - Fix NTL spkg-configure.m4 so it rejects NTLs built with NTL_THREADS


I believe that I was able to use Arch's NTL in builds few betas ago.
This again points at #29339 as being too drastic in its approach.



---

archive/issue_comments_439128.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 dimpase]:\n> Replying to [comment:11 mkoeppe]:\n> > Replying to [comment:10 arojas]:\n> > > Replying to [comment:9 mkoeppe]:\n> > > > Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?\n\n> > > \n> > > Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. \n\n> > \n> > Right, this build is using #29339 - Fix NTL spkg-configure.m4 so it rejects NTLs built with NTL_THREADS\n\n> \n> I believe that I was able to use Arch's NTL in builds few betas ago.\n> This again points at #29339 as being too drastic in its approach.\n> \n\n\nAnd the distro sagemath package has been using multithreaded NTL for years with no issues whatsoever",
    "created_at": "2020-03-19T15:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439128",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:14'></a>Replying to [comment:13 dimpase]:
> Replying to [comment:11 mkoeppe]:
> > Replying to [comment:10 arojas]:
> > > Replying to [comment:9 mkoeppe]:
> > > > Could you also take a look at the build logs at https://github.com/mkoeppe/sage/runs/518106289 please?

> > > 
> > > Looks like Arch's ntl is not accepted because it is built with threads, which in turn causes all its reverse dependencies to be compiled. 

> > 
> > Right, this build is using #29339 - Fix NTL spkg-configure.m4 so it rejects NTLs built with NTL_THREADS

> 
> I believe that I was able to use Arch's NTL in builds few betas ago.
> This again points at #29339 as being too drastic in its approach.
> 


And the distro sagemath package has been using multithreaded NTL for years with no issues whatsoever



---

archive/issue_comments_439129.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 arojas]:\n> And the distro sagemath package has been using multithreaded NTL for years with no issues whatsoever\n\n\nWell, it is currently disabled as of last NTL upgrade  #20590.",
    "created_at": "2020-03-19T16:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439129",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Replying to [comment:14 arojas]:
> And the distro sagemath package has been using multithreaded NTL for years with no issues whatsoever


Well, it is currently disabled as of last NTL upgrade  #20590.



---

archive/issue_comments_439130.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 mkoeppe]:\n> Replying to [comment:14 arojas]:\n> > And the distro sagemath package has been using multithreaded NTL for years with no issues whatsoever\n\n> \n> Well, it is currently disabled as of last NTL upgrade  #20590.\n\n\nI mean the Arch sagemath package, not sage-the-distro",
    "created_at": "2020-03-19T16:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439130",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:16'></a>Replying to [comment:15 mkoeppe]:
> Replying to [comment:14 arojas]:
> > And the distro sagemath package has been using multithreaded NTL for years with no issues whatsoever

> 
> Well, it is currently disabled as of last NTL upgrade  #20590.


I mean the Arch sagemath package, not sage-the-distro



---

archive/issue_comments_439131.json:
```json
{
    "body": "<a id='comment:17'></a>Ah, thanks for the clarification",
    "created_at": "2020-03-19T16:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439131",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Ah, thanks for the clarification



---

archive/issue_comments_439132.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:12 mkoeppe]:\n> and for more of the following listed here:\n> \n> configure: notice: the following SPKGs did not find equivalent system packages: arb cbc cliquer cmake eclib ecm flint fplll git givaro gp2c isl lcalc libatomic_ops libsemigroups mpfi ninja_build ntl pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small perl_term_readline_gnu yasm zeromq\n> \n\n\nNote that the packages `pari-seadata` and `pari-seadata-small` conflict.\n\nAfter removing the pkgconfig file of givaro in `/usr/local` (my bad) and installing the three pari packages (`pari-seadata`, `pari-galpol`, `pari-elldata`), everything is now taken from the system! Thanks.\n\n---\nNew commits:",
    "created_at": "2020-03-19T21:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439132",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>Replying to [comment:12 mkoeppe]:
> and for more of the following listed here:
> 
> configure: notice: the following SPKGs did not find equivalent system packages: arb cbc cliquer cmake eclib ecm flint fplll git givaro gp2c isl lcalc libatomic_ops libsemigroups mpfi ninja_build ntl pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small perl_term_readline_gnu yasm zeromq
> 


Note that the packages `pari-seadata` and `pari-seadata-small` conflict.

After removing the pkgconfig file of givaro in `/usr/local` (my bad) and installing the three pari packages (`pari-seadata`, `pari-galpol`, `pari-elldata`), everything is now taken from the system! Thanks.

---
New commits:



---

archive/issue_comments_439133.json:
```json
{
    "body": "<a id='comment:22'></a>So what are we missing in our arch.txt files?",
    "created_at": "2020-03-19T22:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439133",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>So what are we missing in our arch.txt files?



---

archive/issue_comments_439134.json:
```json
{
    "body": "<a id='comment:23'></a>I don't understand what these `arch.txt` are supposed to say. It looks like a kind of translation `sage package` -> `arch package`. However, for pari to be recognized by the sagemath configure, it needs to be installed with the optional packages `pari-seadata`, `pari-galpol`, `pari-elldata`. Where is this specified?",
    "created_at": "2020-03-20T07:59:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439134",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>I don't understand what these `arch.txt` are supposed to say. It looks like a kind of translation `sage package` -> `arch package`. However, for pari to be recognized by the sagemath configure, it needs to be installed with the optional packages `pari-seadata`, `pari-galpol`, `pari-elldata`. Where is this specified?



---

archive/issue_comments_439135.json:
```json
{
    "body": "<a id='comment:24'></a>Here is an example from `build/pkgs/pari/distros/debian.txt`:\n\n```\npari-gp2c libpari-dev\n# #29319: cypari2 needs gphelp at installation time\npari-doc\n# We add these data packages because they are checked by spkg-configure.m4\npari-elldata pari-galdata pari-galpol pari-seadata\n```\nPut the equivalent of these Debian package names\ninto  `build/pkgs/pari/distros/arch.txt`",
    "created_at": "2020-03-20T08:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439135",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>Here is an example from `build/pkgs/pari/distros/debian.txt`:

```
pari-gp2c libpari-dev
# #29319: cypari2 needs gphelp at installation time
pari-doc
# We add these data packages because they are checked by spkg-configure.m4
pari-elldata pari-galdata pari-galpol pari-seadata
```
Put the equivalent of these Debian package names
into  `build/pkgs/pari/distros/arch.txt`



---

archive/issue_comments_439136.json:
```json
{
    "body": "<a id='comment:25'></a>Where is the format documented?",
    "created_at": "2020-03-20T08:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439136",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>Where is the format documented?



---

archive/issue_comments_439137.json:
```json
{
    "body": "<a id='comment:26'></a>As many things in our build system, nowhere, AFAIK - unless I miss a ticket that didn't make it into Sage 9.1.beta8 (the renaming `spkg-install` -> `spkg-install.in` did make it there, though). Please feel free to add things to Developer Guide, in `src/doc/en/developer/packaging.rst`",
    "created_at": "2020-03-20T08:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439137",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>As many things in our build system, nowhere, AFAIK - unless I miss a ticket that didn't make it into Sage 9.1.beta8 (the renaming `spkg-install` -> `spkg-install.in` did make it there, though). Please feel free to add things to Developer Guide, in `src/doc/en/developer/packaging.rst`



---

archive/issue_comments_439138.json:
```json
{
    "body": "<a id='comment:27'></a>these files are processed by `src/doc/bootstrap` called from `./bootstrap`.",
    "created_at": "2020-03-20T08:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439138",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>these files are processed by `src/doc/bootstrap` called from `./bootstrap`.



---

archive/issue_comments_439139.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-20T19:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439139",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439140.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-20T20:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439140",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439141.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-20T20:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439141",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439142.json:
```json
{
    "body": "<a id='comment:32'></a>Also, both pari-seadata and pari-elldata are from [AUR](https://wiki.archlinux.org/index.php/Arch_User_Repository).",
    "created_at": "2020-03-20T20:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439142",
    "user": "https://github.com/videlec"
}
```

<a id='comment:32'></a>Also, both pari-seadata and pari-elldata are from [AUR](https://wiki.archlinux.org/index.php/Arch_User_Repository).



---

archive/issue_comments_439143.json:
```json
{
    "body": "<a id='comment:33'></a>\n```\n$ tox -e docker-archlinux-latest-standard\ndocker-archlinux-latest-standard run-test-pre: PYTHONHASHSEED='2835960636'\ndocker-archlinux-latest-standard run-test: commands[0] | bash -c 'build/bin/write-dockerfile.sh arch \"standard\" yes no > /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/docker-archlinux-latest-standard/Dockerfile'\ndocker-archlinux-latest-standard run-test: commands[1] | docker build . -f /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/docker-archlinux-latest-standard/Dockerfile --build-arg EXTRA_CONFIGURE_ARGS= --build-arg BASE_IMAGE=archlinux:latest --build-arg http_proxy=http://host.docker.internal:3128 --build-arg https_proxy=http://host.docker.internal:3128\nSending build context to Docker daemon  179.1MB\nStep 1/23 : ARG BASE_IMAGE=archlinux:latest\nStep 2/23 : FROM ${BASE_IMAGE}\n ---> 0152bf6f0800\nStep 3/23 : ENV PACKAGES=\"binutils make m4 perl python tar bc gcc which gettext autoconf automake libtool pkg-config arb boost eclib gcc gf2x gfan gcc-fortran glpk gsl lcalc gd lrcalc m4ri m4rie nauty openblas lapack cblas pari pari-galdata pari-seadata pari-elldata pari-galdata pari-seadata-small patch planarity r readline rankwidth sqlite3 symmetrica tachyon\"\n ---> Using cache\n ---> 61ceb4b4c200\nStep 4/23 : RUN  pacman -Syu --noconfirm binutils make m4 perl python tar bc gcc which gettext autoconf automake libtool pkg-config arb boost eclib gcc gf2x gfan gcc-fortran glpk gsl lcalc gd lrcalc m4ri m4rie nauty openblas lapack cblas pari pari-galdata pari-seadata pari-elldata pari-galdata pari-seadata-small patch planarity r readline rankwidth sqlite3 symmetrica tachyon\n ---> Running in a4547b23d1cc\n:: Synchronizing package databases...\ndownloading core.db...\ndownloading extra.db...\ndownloading community.db...\nwarning: perl-5.30.1-1 is up to date -- reinstalling\nwarning: tar-1.32-3 is up to date -- reinstalling\nerror: target not found: pari-seadata\nerror: target not found: pari-elldata\nThe command '/bin/sh -c pacman -Syu --noconfirm binutils make m4 perl python tar bc gcc which gettext autoconf automake libtool pkg-config arb boost eclib gcc gf2x gfan gcc-fortran glpk gsl lcalc gd lrcalc m4ri m4rie nauty openblas lapack cblas pari pari-galdata pari-seadata pari-elldata pari-galdata pari-seadata-small patch planarity r readline rankwidth sqlite3 symmetrica tachyon' returned a non-zero code: 1\nERROR: InvocationError for command /usr/local/bin/docker build . -f .tox/docker-archlinux-latest-standard/Dockerfile --build-arg EXTRA_CONFIGURE_ARGS= --build-arg BASE_IMAGE=archlinux:latest --build-arg http_proxy=http://host.docker.internal:3128 --build-arg https_proxy=http://host.docker.internal:3128 (exited with code 1)\n```",
    "created_at": "2020-03-21T00:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439143",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
```
$ tox -e docker-archlinux-latest-standard
docker-archlinux-latest-standard run-test-pre: PYTHONHASHSEED='2835960636'
docker-archlinux-latest-standard run-test: commands[0] | bash -c 'build/bin/write-dockerfile.sh arch "standard" yes no > /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/docker-archlinux-latest-standard/Dockerfile'
docker-archlinux-latest-standard run-test: commands[1] | docker build . -f /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/.tox/docker-archlinux-latest-standard/Dockerfile --build-arg EXTRA_CONFIGURE_ARGS= --build-arg BASE_IMAGE=archlinux:latest --build-arg http_proxy=http://host.docker.internal:3128 --build-arg https_proxy=http://host.docker.internal:3128
Sending build context to Docker daemon  179.1MB
Step 1/23 : ARG BASE_IMAGE=archlinux:latest
Step 2/23 : FROM ${BASE_IMAGE}
 ---> 0152bf6f0800
Step 3/23 : ENV PACKAGES="binutils make m4 perl python tar bc gcc which gettext autoconf automake libtool pkg-config arb boost eclib gcc gf2x gfan gcc-fortran glpk gsl lcalc gd lrcalc m4ri m4rie nauty openblas lapack cblas pari pari-galdata pari-seadata pari-elldata pari-galdata pari-seadata-small patch planarity r readline rankwidth sqlite3 symmetrica tachyon"
 ---> Using cache
 ---> 61ceb4b4c200
Step 4/23 : RUN  pacman -Syu --noconfirm binutils make m4 perl python tar bc gcc which gettext autoconf automake libtool pkg-config arb boost eclib gcc gf2x gfan gcc-fortran glpk gsl lcalc gd lrcalc m4ri m4rie nauty openblas lapack cblas pari pari-galdata pari-seadata pari-elldata pari-galdata pari-seadata-small patch planarity r readline rankwidth sqlite3 symmetrica tachyon
 ---> Running in a4547b23d1cc
:: Synchronizing package databases...
downloading core.db...
downloading extra.db...
downloading community.db...
warning: perl-5.30.1-1 is up to date -- reinstalling
warning: tar-1.32-3 is up to date -- reinstalling
error: target not found: pari-seadata
error: target not found: pari-elldata
The command '/bin/sh -c pacman -Syu --noconfirm binutils make m4 perl python tar bc gcc which gettext autoconf automake libtool pkg-config arb boost eclib gcc gf2x gfan gcc-fortran glpk gsl lcalc gd lrcalc m4ri m4rie nauty openblas lapack cblas pari pari-galdata pari-seadata pari-elldata pari-galdata pari-seadata-small patch planarity r readline rankwidth sqlite3 symmetrica tachyon' returned a non-zero code: 1
ERROR: InvocationError for command /usr/local/bin/docker build . -f .tox/docker-archlinux-latest-standard/Dockerfile --build-arg EXTRA_CONFIGURE_ARGS= --build-arg BASE_IMAGE=archlinux:latest --build-arg http_proxy=http://host.docker.internal:3128 --build-arg https_proxy=http://host.docker.internal:3128 (exited with code 1)
```



---

archive/issue_comments_439144.json:
```json
{
    "body": "<a id='comment:34'></a>pacman cannot install packages from AUR, they need to be built from source:\nhttps://wiki.archlinux.org/index.php/Arch_User_Repository#Installing_packages\n\n(in case of these packages \"building\" is instant though, it just needs different commands to be run)\n\nYes, it'd be possible to script this, so these packages need to at least be tagged somehow.",
    "created_at": "2020-03-21T03:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439144",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>pacman cannot install packages from AUR, they need to be built from source:
https://wiki.archlinux.org/index.php/Arch_User_Repository#Installing_packages

(in case of these packages "building" is instant though, it just needs different commands to be run)

Yes, it'd be possible to script this, so these packages need to at least be tagged somehow.



---

archive/issue_comments_439145.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-29T02:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439145",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439146.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-03-29T02:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439146",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_439147.json:
```json
{
    "body": "<a id='comment:36'></a>This is not complete but let's get it into 9.1",
    "created_at": "2020-03-29T02:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439147",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>This is not complete but let's get it into 9.1



---

archive/issue_comments_439148.json:
```json
{
    "body": "<a id='comment:37'></a>there are replacements for `pacman` which allow automatic install of packages from AUR and the standard repo, such as `yay`.\n\nso the script can first install yay, and then use it for the rest.",
    "created_at": "2020-03-29T02:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439148",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>there are replacements for `pacman` which allow automatic install of packages from AUR and the standard repo, such as `yay`.

so the script can first install yay, and then use it for the rest.



---

archive/issue_comments_439149.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:37 dimpase]:\n> there are replacements for `pacman` which allow automatic install of packages from AUR and the standard repo, such as `yay`.\n> \n> so the script can first install yay, and then use it for the rest.\n\n\nPlease don't. AUR is unsupported, user generated content. There's no guarantee that it couldn't be replaced with broken or even malicious content at any time.\n\nIf necessary, I could move these packages to the binary repos. But I don't really see the need to check for those at build time, at least on Arch, given that they can be installed by the user at any time after Sage install.",
    "created_at": "2020-03-29T08:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439149",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:38'></a>Replying to [comment:37 dimpase]:
> there are replacements for `pacman` which allow automatic install of packages from AUR and the standard repo, such as `yay`.
> 
> so the script can first install yay, and then use it for the rest.


Please don't. AUR is unsupported, user generated content. There's no guarantee that it couldn't be replaced with broken or even malicious content at any time.

If necessary, I could move these packages to the binary repos. But I don't really see the need to check for those at build time, at least on Arch, given that they can be installed by the user at any time after Sage install.



---

archive/issue_comments_439150.json:
```json
{
    "body": "<a id='comment:39'></a>well, if we recommend AUR packages, it's better if we test with them too, no?\nBut, indeed, if they can be moved to the regular package repo, why not?",
    "created_at": "2020-03-29T08:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439150",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>well, if we recommend AUR packages, it's better if we test with them too, no?
But, indeed, if they can be moved to the regular package repo, why not?



---

archive/issue_comments_439151.json:
```json
{
    "body": "<a id='comment:40'></a>Alright, packages are now in the official repos",
    "created_at": "2020-03-29T12:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439151",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:40'></a>Alright, packages are now in the official repos



---

archive/issue_comments_439152.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-03-29T14:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439152",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_439153.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,11 @@\n https://groups.google.com/d/msg/sage-devel/JgArPVx7dwg/gMxeB4b7AgAJ\n+\n+To test:\n+\n+```\n+  tox -e docker-archlinux-latest-standard\n+```\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2020-03-29T14:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439153",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,11 @@
 https://groups.google.com/d/msg/sage-devel/JgArPVx7dwg/gMxeB4b7AgAJ
+
+To test:
+
+```
+  tox -e docker-archlinux-latest-standard
+```
+
 
 Comment: 1
 
```




---

archive/issue_comments_439154.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:40 arojas]:\n> Alright, packages are now in the official repos\n\nThanks very much, that's great.\n\n`configure` now finds the packages!\n\n```\ntox -e docker-archlinux-latest-standard -- base-toolchain\n...\nChecking whether SageMath should install SPKG pari...\nchecking installing gmp/mpir or readline? ... no\nchecking installing PARI/GP packages? ... checking for gp... /usr/sbin/gp\nchecking for gphelp... /usr/sbin/gphelp\nchecking whether gphelp has access to the documentation... yes\nchecking is pari_elldata installed? ... yes\nchecking is pari_galdata installed? ... yes\nchecking is pari_galpol installed? ... yes\nchecking is pari_seadata installed? ... yes\nconfigure: will use system package and not install SPKG pari\nusing pari/gp from the system\n```\n\nNeeds review.",
    "created_at": "2020-03-29T14:28:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439154",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>Replying to [comment:40 arojas]:
> Alright, packages are now in the official repos

Thanks very much, that's great.

`configure` now finds the packages!

```
tox -e docker-archlinux-latest-standard -- base-toolchain
...
Checking whether SageMath should install SPKG pari...
checking installing gmp/mpir or readline? ... no
checking installing PARI/GP packages? ... checking for gp... /usr/sbin/gp
checking for gphelp... /usr/sbin/gphelp
checking whether gphelp has access to the documentation... yes
checking is pari_elldata installed? ... yes
checking is pari_galdata installed? ... yes
checking is pari_galpol installed? ... yes
checking is pari_seadata installed? ... yes
configure: will use system package and not install SPKG pari
using pari/gp from the system
```

Needs review.



---

archive/issue_comments_439155.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-29T14:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439155",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439156.json:
```json
{
    "body": "<a id='comment:44'></a>lgtm",
    "created_at": "2020-03-29T14:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439156",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>lgtm



---

archive/issue_comments_439157.json:
```json
{
    "body": "<a id='comment:45'></a>Thank you!",
    "created_at": "2020-03-29T14:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439157",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>Thank you!



---

archive/issue_events_074812.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-09T22:44:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29366#event-74812"
}
```



---

archive/issue_comments_439158.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-09T22:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29366#issuecomment-439158",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
