# Issue 29927: shifting issue in padic _set_from_list functions

archive/issues_029690.json:
```json
{
    "assignees": [],
    "body": "Using version 9.1 of sage, the function _set_from_list_both(), implemented in: /sage/src/sage/rings/padics/padic_ZZ_pX_element.pyx, crashes or returns wrong results for some inputs.\n\nExample for wrong results:\n\n```\nsage: T.<a> = Qp(5).extension(x^2-5)\nsage: W.<w> = Qp(5).extension(x^2-5)\nsage: W(a^-41)\nO(w^-1)\n```\nExample for a crash (full output is availabale in the attached file):\n\n```\nsage: T.<a> = Qp(5).extension(x^2-5)\nsage: T([5^-2], absprec=-1)\n------------------------------------------------------------------------\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x828b)[0x7f250e49428b]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x8348)[0x7f250e494348]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0xb323)[0x7f250e497323]\n/lib/x86_64-linux-gnu/libc.so.6(+0x3ef20)[0x7f251cc46f20]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/rings/padics/padic_ZZ_pX_CR_element.cpython-37m-x86_64-linux-gnu.so(+0x34d62)[0x7f2455837d62]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/rings/padics/padic_ZZ_pX_element.cpython-37m-x86_64-linux-gnu.so(+0x1f27d)[0x7f2455c9027d]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/rings/padics/padic_ZZ_pX_CR_element.cpython-37m-x86_64-linux-gnu.so(+0x2fee9)[0x7f2455832ee9]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x105972)[0x7f251d0fe972]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyObject_Call+0x68)[0x7f251d096538]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x4fc5)[0x7f251d067d65]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallDict+0x14a)[0x7f251d093cda]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyObject_Call_Prepend+0xcc)[0x7f251d094ecc]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/structure/coerce_maps.cpython-37m-x86_64-linux-gnu.so(+0x7c7c)[0x7f25074c2c7c]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/structure/coerce_maps.cpython-37m-x86_64-linux-gnu.so(+0x13bec)[0x7f25074cebec]\n/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/structure/parent.cpython-37m-x86_64-linux-gnu.so(+0x1dfa9)[0x7f250d533fa9]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyObject_FastCallKeywords+0xc3)[0x7f251d094503]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x5132)[0x7f251d067ed2]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCodeEx+0x3e)[0x7f251d181bde]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCode+0x1b)[0x7f251d181c0b]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x185e4d)[0x7f251d17ee4d]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyMethodDef_RawFastCallKeywords+0x23d)[0x7f251d09433d]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyCFunction_FastCallKeywords+0x25)[0x7f251d094425]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x8ffe)[0x7f251d06bd9e]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x6cae)[0x7f251d069a4e]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x6cae)[0x7f251d069a4e]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x68c8f)[0x7f251d061c8f]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCodeEx+0x3e)[0x7f251d181bde]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCode+0x1b)[0x7f251d181c0b]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyRun_FileExFlags+0xaa)[0x7f251d1b6f3a]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyRun_SimpleFileExFlags+0xfd)[0x7f251d1b70ad]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x1e25e0)[0x7f251d1db5e0]\n/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_Py_UnixMain+0x49)[0x7f251d1db859]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xe7)[0x7f251cc29b97]\n/home/noa/workspace/padic_project/sage/local/bin/python3(_start+0x2a)[0x558e97ef478a]\n------------------------------------------------------------------------\n```\n\nThe bug occurs because the element is set to the desirable absolute precision **before** it is shifted by p<sup>min_val</sup>. \n\nTo fix this, I subtracted (min_val * ramification-index) from the absolute precision to which the element is set, so that **after** shifting it will hopefully reach the desirable precision.\n\nHowever, this does not completely solve the problem, because in case p is not a power of the uniformizer, shifting doesn't necessarily increase the absolute precision by exactly (min_val * ramification-index). So perhaps it would be best to set the absolute precision to the desirable value, only **after** the shifting (I didn't figure out how to do this correctly).\n\nHowever, if it isn't necessary to have the exact desirable precision, the above solution could be enough.\n\nThe issue of shifting after setting the precision, is also relevant to _set_from_list_abs(), which I changed similarly.\n\nNote: The first example given in this ticket requires fixing not only this bug, but also tickets #29925, #29926. After those bugs are all fixed, we get the result: w<sup>-41</sup> + O(w<sup>-2</sup>).\n\nCC:  @xcaruso @roed314\n\nKeywords: **precision, set_from_list, shifting**\n\nBranch/Commit: **[a97b2a6](https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83)**\n\nReviewer: **Julian R\u00fcth**\n\nAuthor: **Noa Viner**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29927_\n\n",
    "closed_at": "2022-02-27T22:00:52Z",
    "created_at": "2020-06-21T21:05:33Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20padics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "shifting issue in padic _set_from_list functions",
    "type": "issue",
    "updated_at": "2022-02-27T22:00:52Z",
    "url": "https://github.com/sagemath/sage/issues/29927",
    "user": "https://github.com/n-vi"
}
```
Using version 9.1 of sage, the function _set_from_list_both(), implemented in: /sage/src/sage/rings/padics/padic_ZZ_pX_element.pyx, crashes or returns wrong results for some inputs.

Example for wrong results:

```
sage: T.<a> = Qp(5).extension(x^2-5)
sage: W.<w> = Qp(5).extension(x^2-5)
sage: W(a^-41)
O(w^-1)
```
Example for a crash (full output is availabale in the attached file):

```
sage: T.<a> = Qp(5).extension(x^2-5)
sage: T([5^-2], absprec=-1)
------------------------------------------------------------------------
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x828b)[0x7f250e49428b]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x8348)[0x7f250e494348]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0xb323)[0x7f250e497323]
/lib/x86_64-linux-gnu/libc.so.6(+0x3ef20)[0x7f251cc46f20]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/rings/padics/padic_ZZ_pX_CR_element.cpython-37m-x86_64-linux-gnu.so(+0x34d62)[0x7f2455837d62]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/rings/padics/padic_ZZ_pX_element.cpython-37m-x86_64-linux-gnu.so(+0x1f27d)[0x7f2455c9027d]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/rings/padics/padic_ZZ_pX_CR_element.cpython-37m-x86_64-linux-gnu.so(+0x2fee9)[0x7f2455832ee9]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x105972)[0x7f251d0fe972]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyObject_Call+0x68)[0x7f251d096538]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x4fc5)[0x7f251d067d65]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallDict+0x14a)[0x7f251d093cda]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyObject_Call_Prepend+0xcc)[0x7f251d094ecc]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/structure/coerce_maps.cpython-37m-x86_64-linux-gnu.so(+0x7c7c)[0x7f25074c2c7c]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/structure/coerce_maps.cpython-37m-x86_64-linux-gnu.so(+0x13bec)[0x7f25074cebec]
/home/noa/workspace/padic_project/sage/local/lib/python3.7/site-packages/sage/structure/parent.cpython-37m-x86_64-linux-gnu.so(+0x1dfa9)[0x7f250d533fa9]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyObject_FastCallKeywords+0xc3)[0x7f251d094503]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x5132)[0x7f251d067ed2]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCodeEx+0x3e)[0x7f251d181bde]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCode+0x1b)[0x7f251d181c0b]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x185e4d)[0x7f251d17ee4d]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyMethodDef_RawFastCallKeywords+0x23d)[0x7f251d09433d]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyCFunction_FastCallKeywords+0x25)[0x7f251d094425]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x8ffe)[0x7f251d06bd9e]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x6cae)[0x7f251d069a4e]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x6cae)[0x7f251d069a4e]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyFunction_FastCallKeywords+0x8f)[0x7f251d093eef]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x68c8f)[0x7f251d061c8f]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalFrameDefault+0x7219)[0x7f251d069fb9]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_PyEval_EvalCodeWithName+0xa81)[0x7f251d181af1]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCodeEx+0x3e)[0x7f251d181bde]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyEval_EvalCode+0x1b)[0x7f251d181c0b]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyRun_FileExFlags+0xaa)[0x7f251d1b6f3a]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(PyRun_SimpleFileExFlags+0xfd)[0x7f251d1b70ad]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(+0x1e25e0)[0x7f251d1db5e0]
/home/noa/workspace/padic_project/sage/local/lib/libpython3.7m.so.1.0(_Py_UnixMain+0x49)[0x7f251d1db859]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xe7)[0x7f251cc29b97]
/home/noa/workspace/padic_project/sage/local/bin/python3(_start+0x2a)[0x558e97ef478a]
------------------------------------------------------------------------
```

The bug occurs because the element is set to the desirable absolute precision **before** it is shifted by p<sup>min_val</sup>. 

To fix this, I subtracted (min_val * ramification-index) from the absolute precision to which the element is set, so that **after** shifting it will hopefully reach the desirable precision.

However, this does not completely solve the problem, because in case p is not a power of the uniformizer, shifting doesn't necessarily increase the absolute precision by exactly (min_val * ramification-index). So perhaps it would be best to set the absolute precision to the desirable value, only **after** the shifting (I didn't figure out how to do this correctly).

However, if it isn't necessary to have the exact desirable precision, the above solution could be enough.

The issue of shifting after setting the precision, is also relevant to _set_from_list_abs(), which I changed similarly.

Note: The first example given in this ticket requires fixing not only this bug, but also tickets #29925, #29926. After those bugs are all fixed, we get the result: w<sup>-41</sup> + O(w<sup>-2</sup>).

CC:  @xcaruso @roed314

Keywords: **precision, set_from_list, shifting**

Branch/Commit: **[a97b2a6](https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83)**

Reviewer: **Julian Rüth**

Author: **Noa Viner**

_Issue created by migration from https://trac.sagemath.org/ticket/29927_





---

archive/issue_events_393648.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-06-21T21:05:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393648"
}
```



---

archive/issue_events_393649.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-06-21T21:05:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20padics",
    "label_color": "0000ff",
    "label_name": "component: padics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393649"
}
```



---

archive/issue_events_393650.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-06-21T21:05:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393650"
}
```



---

archive/issue_events_393651.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-06-21T21:05:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393651"
}
```



---

archive/issue_comments_475943.json:
```json
{
    "body": "Attachment: **[set_from_list_both_crash_log.gz](https://github.com/sagemath/sage/files/ticket29927/set_from_list_both_crash_log.gz)**",
    "created_at": "2020-06-21T21:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475943",
    "user": "https://github.com/n-vi"
}
```

Attachment: **[set_from_list_both_crash_log.gz](https://github.com/sagemath/sage/files/ticket29927/set_from_list_both_crash_log.gz)**



---

archive/issue_comments_475944.json:
```json
{
    "body": "Branch: **[u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions)**",
    "created_at": "2020-06-21T23:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475944",
    "user": "https://github.com/n-vi"
}
```

Branch: **[u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions)**



---

archive/issue_comments_475945.json:
```json
{
    "body": "Commit: **[34df5e2](https://github.com/sagemath/sagetrac-mirror/commit/34df5e2f6b8c1400be99c1b395478068b55c9462)**",
    "created_at": "2020-06-22T00:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475945",
    "user": "https://github.com/n-vi"
}
```

Commit: **[34df5e2](https://github.com/sagemath/sagetrac-mirror/commit/34df5e2f6b8c1400be99c1b395478068b55c9462)**



---

archive/issue_comments_475946.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Using version 9.1 of sage, the function _set_from_list_both(), which is written in the file: /sage/src/sage/rings/padics/padic_ZZ_pX_element.pyx, crashes or returns wrong results for some inputs.\n+Using version 9.1 of sage, the function _set_from_list_both(), implemented in: /sage/src/sage/rings/padics/padic_ZZ_pX_element.pyx, crashes or returns wrong results for some inputs.\n \n Example for wrong results:\n \n@@ -8,7 +8,7 @@\n sage: W(a^-41)\n O(w^-1)\n ```\n-Example for a crash (see full output in attached file):\n+Example for a crash (full output is availabale in the attached file):\n \n ```\n sage: T.<a> = Qp(5).extension(x^2-5)\n@@ -72,8 +72,10 @@\n \n To fix this, I subtracted (min_val * ramification-index) from the absolute precision to which the element is set, so that **after** shifting it will hopefully reach the desirable precision.\n \n-However, this does not completely solve the problem, because in case p is not a power of the uniformizer, it's not necessary that shifting increases the absolute precision in exactly (min_val * ramification-index). So perhaps it would be best to set the absolute precision to the desirable value, only **after** the shifting (I didn't figure out how to do this correctly).\n+However, this does not completely solve the problem, because in case p is not a power of the uniformizer, shifting doesn't necessarily increase the absolute precision by exactly (min_val * ramification-index). So perhaps it would be best to set the absolute precision to the desirable value, only **after** the shifting (I didn't figure out how to do this correctly).\n \n However, if it isn't necessary to have the exact desirable precision, the above solution could be enough.\n \n-Note: The issue of shifting after setting the precision, is also relevant for _set_from_list_abs(), which I changed similarly.\n+The issue of shifting after setting the precision, is also relevant to _set_from_list_abs(), which I changed similarly.\n+\n+Note: The first example given in this ticket requires fixing not only this bug, but also tickets #29925, #29926. After those bugs are all fixed, we get the result: w<sup>-41</sup> + O(w<sup>-2</sup>).\n``````\n",
    "created_at": "2020-06-22T00:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475946",
    "user": "https://github.com/n-vi"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Using version 9.1 of sage, the function _set_from_list_both(), which is written in the file: /sage/src/sage/rings/padics/padic_ZZ_pX_element.pyx, crashes or returns wrong results for some inputs.
+Using version 9.1 of sage, the function _set_from_list_both(), implemented in: /sage/src/sage/rings/padics/padic_ZZ_pX_element.pyx, crashes or returns wrong results for some inputs.
 
 Example for wrong results:
 
@@ -8,7 +8,7 @@
 sage: W(a^-41)
 O(w^-1)
 ```
-Example for a crash (see full output in attached file):
+Example for a crash (full output is availabale in the attached file):
 
 ```
 sage: T.<a> = Qp(5).extension(x^2-5)
@@ -72,8 +72,10 @@
 
 To fix this, I subtracted (min_val * ramification-index) from the absolute precision to which the element is set, so that **after** shifting it will hopefully reach the desirable precision.
 
-However, this does not completely solve the problem, because in case p is not a power of the uniformizer, it's not necessary that shifting increases the absolute precision in exactly (min_val * ramification-index). So perhaps it would be best to set the absolute precision to the desirable value, only **after** the shifting (I didn't figure out how to do this correctly).
+However, this does not completely solve the problem, because in case p is not a power of the uniformizer, shifting doesn't necessarily increase the absolute precision by exactly (min_val * ramification-index). So perhaps it would be best to set the absolute precision to the desirable value, only **after** the shifting (I didn't figure out how to do this correctly).
 
 However, if it isn't necessary to have the exact desirable precision, the above solution could be enough.
 
-Note: The issue of shifting after setting the precision, is also relevant for _set_from_list_abs(), which I changed similarly.
+The issue of shifting after setting the precision, is also relevant to _set_from_list_abs(), which I changed similarly.
+
+Note: The first example given in this ticket requires fixing not only this bug, but also tickets #29925, #29926. After those bugs are all fixed, we get the result: w<sup>-41</sup> + O(w<sup>-2</sup>).
``````




---

archive/issue_events_393652.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-06-22T00:01:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393652"
}
```



---

archive/issue_comments_475947.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/34df5e2f6b8c1400be99c1b395478068b55c9462\">34df5e2</a></td><td><code>Fix precision in shifting</code></td></tr></table>\n",
    "created_at": "2020-06-22T00:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475947",
    "user": "https://github.com/n-vi"
}
```

<div id="comment:2" align="right">Comment 2</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/34df5e2f6b8c1400be99c1b395478068b55c9462">34df5e2</a></td><td><code>Fix precision in shifting</code></td></tr></table>




---

archive/issue_comments_475948.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nthis looks simple enough, but needs people that know the padics code",
    "created_at": "2020-09-08T10:07:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475948",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">Comment 3</div>

this looks simple enough, but needs people that know the padics code



---

archive/issue_comments_475949.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\ngh-n-vi: I don't know a better way of contacting you. So, we're meeting every Thursday 3pm US/Eastern = 9pm CEST on Zulip (and then maybe in Zoom.) Feel free to join us if you want to discuss p-adics :)\nhttps://zulip.sagemath.org/#narrow/stream/15-padics",
    "created_at": "2020-09-08T15:43:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475949",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:4" align="right">Comment 4</div>

gh-n-vi: I don't know a better way of contacting you. So, we're meeting every Thursday 3pm US/Eastern = 9pm CEST on Zulip (and then maybe in Zoom.) Feel free to join us if you want to discuss p-adics :)
https://zulip.sagemath.org/#narrow/stream/15-padics



---

archive/issue_comments_475950.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@saraedum](#comment%3A4):\n> gh-n-vi: I don't know a better way of contacting you. So, we're meeting every Thursday 3pm US/Eastern = 9pm CEST on Zulip (and then maybe in Zoom.) Feel free to join us if you want to discuss p-adics :)\n> https://zulip.sagemath.org/#narrow/stream/15-padics\n\nThanks saraedum, I would be glad to join the discussion!",
    "created_at": "2020-09-08T19:38:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475950",
    "user": "https://github.com/n-vi"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@saraedum](#comment%3A4):
> gh-n-vi: I don't know a better way of contacting you. So, we're meeting every Thursday 3pm US/Eastern = 9pm CEST on Zulip (and then maybe in Zoom.) Feel free to join us if you want to discuss p-adics :)
> https://zulip.sagemath.org/#narrow/stream/15-padics

Thanks saraedum, I would be glad to join the discussion!



---

archive/issue_comments_475951.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nWould you mind adding the first example to the doctests as well? (I read that it did not work originally, but it should now, right?)",
    "created_at": "2020-09-17T23:09:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475951",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:6" align="right">Comment 6</div>

Would you mind adding the first example to the doctests as well? (I read that it did not work originally, but it should now, right?)



---

archive/issue_events_393653.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2020-09-17T23:31:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393653"
}
```



---

archive/issue_events_393654.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2020-09-17T23:31:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393654"
}
```



---

archive/issue_comments_475952.json:
```json
{
    "body": "Reviewer: **Julian R\u00fcth**",
    "created_at": "2020-09-17T23:31:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475952",
    "user": "https://github.com/saraedum"
}
```

Reviewer: **Julian Rüth**



---

archive/issue_comments_475953.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\n> However, this does not completely solve the problem, because in case p is not a power of the uniformizer, shifting doesn't necessarily increase the absolute precision by exactly (min_val * ramification-index).\n\nTrue. It's been a while since I looked at this. But isn't it at most off by one?\n\nIs this correct when `min_val` is positive?\n\n```\nself._set_from_ZZ_pX_abs(&(<ntl_ZZ_pX>ntl_ZZ_pX(L, ctx)).x, ctx, absprec - (min_val * self.parent().e()))\n```\n\nWhen `min_val` is large, wouldn't x be 0 modulo the precision then?\n\nIt seems to me that you have to do the shift (probably depending on the sign of `min_val`) and then reduce the precision to `absprec` explicitly again for this to be really correct. Is that what you tried originally? Feel free to ask on Zulip if you are not sure how to do this.",
    "created_at": "2020-09-17T23:31:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475953",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:7" align="right">Comment 7</div>

> However, this does not completely solve the problem, because in case p is not a power of the uniformizer, shifting doesn't necessarily increase the absolute precision by exactly (min_val * ramification-index).

True. It's been a while since I looked at this. But isn't it at most off by one?

Is this correct when `min_val` is positive?

```
self._set_from_ZZ_pX_abs(&(<ntl_ZZ_pX>ntl_ZZ_pX(L, ctx)).x, ctx, absprec - (min_val * self.parent().e()))
```

When `min_val` is large, wouldn't x be 0 modulo the precision then?

It seems to me that you have to do the shift (probably depending on the sign of `min_val`) and then reduce the precision to `absprec` explicitly again for this to be really correct. Is that what you tried originally? Feel free to ask on Zulip if you are not sure how to do this.



---

archive/issue_comments_475954.json:
```json
{
    "body": "Changed commit from **[34df5e2](https://github.com/sagemath/sagetrac-mirror/commit/34df5e2f6b8c1400be99c1b395478068b55c9462)** to **[41856e4](https://github.com/sagemath/sagetrac-mirror/commit/41856e44e0ed05f7205c2d366c40574716d0d26b)**",
    "created_at": "2020-09-21T17:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475954",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[34df5e2](https://github.com/sagemath/sagetrac-mirror/commit/34df5e2f6b8c1400be99c1b395478068b55c9462)** to **[41856e4](https://github.com/sagemath/sagetrac-mirror/commit/41856e44e0ed05f7205c2d366c40574716d0d26b)**



---

archive/issue_comments_475955.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41856e44e0ed05f7205c2d366c40574716d0d26b\">41856e4</a></td><td><code>Add first doctest</code></td></tr></table>\n",
    "created_at": "2020-09-21T17:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475955",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8" align="right">Comment 8</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41856e44e0ed05f7205c2d366c40574716d0d26b">41856e4</a></td><td><code>Add first doctest</code></td></tr></table>




---

archive/issue_comments_475956.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nHi Julian, thank you for the review! \n\n* I have added the first example as you suggested.\n* Regarding the question of the increase in the absolute-precision when shifting by p<sup>min_val</sup> : \n  Rethinking about the subject, it seems to me that perhaps the absolute-precision is actually increased by exactly (min_val * ramification-index). \n  Here is a proof (if anything in the process is wrong, I will appreciate any corrections!):\nDenote the original number by x, the uniformizer by u, the ramification index by e, and min_val by n.\n1. The valuation of p always equals e. Therefore the valuation of p<sup>n</sup> is e*n. \n   Denote: p<sup>n</sup> = a0*(u<sup>e*n</sup>) + a1*(u<sup>e*n+1</sup>) + a2*(u<sup>e*n+2</sup>) +...\n2. x*p<sup>n</sup> = (x*a0*(u<sup>e*n</sup>)) + (x*a1*(u<sup>e*n+1</sup>)) + (x*a2*(u<sup>e*n+2</sup>)) +... \n3. The absolute-precision of x*p<sup>n</sup> equals the absolute-precision of the element which has the lowest absolute-precision among those in the sum.\n4. For each i>=0, (x*ai*(u<sup>e*n+i</sup>)).absolute_precision() = x.absolute_precision() + e*n+i.\n5. 3. and 4. imply that: (x*p<sup>n</sup>).absolute_precision() = (x*a0*(u<sup>e*n</sup>)).absolute_precision() = x.absolute_precision() + e*n.\nTherefore, the absolute-precision has indeed been increased by exactly e*n.\n* Correctness in case min_val is positive:\n  Denote the valuation of x by v, and: x = a0*(u<sup>v</sup>) + a1*(u<sup>v+1</sup>) + ... \n  If the i-th element in this sum is truncated when setting the precision of x to  (absprec - (min_val * e)), it means that i >= (absprec - (min_val * e)). \n  Now, I claim that this element would also be truncated if we set the precision after the shifting. Let's assume for simplicity that p is a power of the uniformizer: p=u<sup>e</sup>, which implies that: p<sup>min_val</sup>=u<sup>min_val*e</sup>. \n  We need to shift x by p<sup>min_val</sup> and then truncate its precision to absprec. \n  So the i-th element is shifted by min_val*e entries, and now equals: ai*(u<sup>v+i+min_val*e</sup>). \n  Now we set the result (x*p<sup>min_val</sup>) to precision absprec. We assumed that i >= (absprec - (min_val * e)). Therefore i+min_val*e >= absprec, which implies that this element (ai*(u<sup>v+i+min_val*e</sup>)) is truncated. \n  Therefore I think that if min_val is large enough so that x is 0 modolu (absprec - (min_val * e)), it is O.K because x would be truncated either way. Am I right in this deduction?\n\n* The problem I had with changing the precision after the shifting, is that I don't know how to increase precision of elements (the only method I found to be relevant is lift_to_precision, but it does not guarantee that the new entries that are added to the element are zero-entries). So if I wanted to do this, I would have to make sure that the precision needs to be decreased rather than increased.",
    "created_at": "2020-09-21T18:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475956",
    "user": "https://github.com/n-vi"
}
```

<div id="comment:9" align="right">Comment 9</div>

Hi Julian, thank you for the review! 

* I have added the first example as you suggested.
* Regarding the question of the increase in the absolute-precision when shifting by p<sup>min_val</sup> : 
  Rethinking about the subject, it seems to me that perhaps the absolute-precision is actually increased by exactly (min_val * ramification-index). 
  Here is a proof (if anything in the process is wrong, I will appreciate any corrections!):
Denote the original number by x, the uniformizer by u, the ramification index by e, and min_val by n.
1. The valuation of p always equals e. Therefore the valuation of p<sup>n</sup> is e*n. 
   Denote: p<sup>n</sup> = a0*(u<sup>e*n</sup>) + a1*(u<sup>e*n+1</sup>) + a2*(u<sup>e*n+2</sup>) +...
2. x*p<sup>n</sup> = (x*a0*(u<sup>e*n</sup>)) + (x*a1*(u<sup>e*n+1</sup>)) + (x*a2*(u<sup>e*n+2</sup>)) +... 
3. The absolute-precision of x*p<sup>n</sup> equals the absolute-precision of the element which has the lowest absolute-precision among those in the sum.
4. For each i>=0, (x*ai*(u<sup>e*n+i</sup>)).absolute_precision() = x.absolute_precision() + e*n+i.
5. 3. and 4. imply that: (x*p<sup>n</sup>).absolute_precision() = (x*a0*(u<sup>e*n</sup>)).absolute_precision() = x.absolute_precision() + e*n.
Therefore, the absolute-precision has indeed been increased by exactly e*n.
* Correctness in case min_val is positive:
  Denote the valuation of x by v, and: x = a0*(u<sup>v</sup>) + a1*(u<sup>v+1</sup>) + ... 
  If the i-th element in this sum is truncated when setting the precision of x to  (absprec - (min_val * e)), it means that i >= (absprec - (min_val * e)). 
  Now, I claim that this element would also be truncated if we set the precision after the shifting. Let's assume for simplicity that p is a power of the uniformizer: p=u<sup>e</sup>, which implies that: p<sup>min_val</sup>=u<sup>min_val*e</sup>. 
  We need to shift x by p<sup>min_val</sup> and then truncate its precision to absprec. 
  So the i-th element is shifted by min_val*e entries, and now equals: ai*(u<sup>v+i+min_val*e</sup>). 
  Now we set the result (x*p<sup>min_val</sup>) to precision absprec. We assumed that i >= (absprec - (min_val * e)). Therefore i+min_val*e >= absprec, which implies that this element (ai*(u<sup>v+i+min_val*e</sup>)) is truncated. 
  Therefore I think that if min_val is large enough so that x is 0 modolu (absprec - (min_val * e)), it is O.K because x would be truncated either way. Am I right in this deduction?

* The problem I had with changing the precision after the shifting, is that I don't know how to increase precision of elements (the only method I found to be relevant is lift_to_precision, but it does not guarantee that the new entries that are added to the element are zero-entries). So if I wanted to do this, I would have to make sure that the precision needs to be decreased rather than increased.



---

archive/issue_events_393655.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-09-21T18:11:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393655"
}
```



---

archive/issue_events_393656.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2020-09-21T18:11:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393656"
}
```



---

archive/issue_events_393657.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393657"
}
```



---

archive/issue_events_393658.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393658"
}
```



---

archive/issue_events_393659.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393659"
}
```



---

archive/issue_events_393660.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393660"
}
```



---

archive/issue_comments_475957.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475957",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">Comment 12</div>

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_475958.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\n>  Therefore I think that if min_val is large enough so that x is 0 modolu (absprec - (min_val * e)), it is O.K because x would be truncated either way. Am I right in this deduction?\n\nIt was my understanding that this code also used for capped-relative p-adics? In that case I don't think that this is correct.",
    "created_at": "2021-05-03T22:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475958",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:13" align="right">Comment 13</div>

>  Therefore I think that if min_val is large enough so that x is 0 modolu (absprec - (min_val * e)), it is O.K because x would be truncated either way. Am I right in this deduction?

It was my understanding that this code also used for capped-relative p-adics? In that case I don't think that this is correct.



---

archive/issue_events_393661.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2021-05-03T22:58:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393661"
}
```



---

archive/issue_events_393662.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2021-05-03T22:58:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393662"
}
```



---

archive/issue_events_393663.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2021-05-03T22:58:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393663"
}
```



---

archive/issue_events_393664.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2021-05-03T22:58:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393664"
}
```



---

archive/issue_events_393665.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393665"
}
```



---

archive/issue_events_393666.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393666"
}
```



---

archive/issue_comments_475959.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475959",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">Comment 15</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_393667.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393667"
}
```



---

archive/issue_events_393668.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393668"
}
```



---

archive/issue_events_393669.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2022-02-01T10:17:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393669"
}
```



---

archive/issue_events_393670.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2022-02-01T10:17:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393670"
}
```



---

archive/issue_comments_475960.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@saraedum](#comment%3A13):\n> \n> It was my understanding that this code also used for capped-relative p-adics? In that case I don't think that this is correct.\n\nHi Julian!\nSorry about the very-long-delay in answering your comment. \\\\\nCan you please explain, or give an example, why there should be a problem with the capped-relative case? I tried to think about it but didn't manage to figure out myself.\\\\\nThank you!",
    "created_at": "2022-02-01T10:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475960",
    "user": "https://github.com/n-vi"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@saraedum](#comment%3A13):
> 
> It was my understanding that this code also used for capped-relative p-adics? In that case I don't think that this is correct.

Hi Julian!
Sorry about the very-long-delay in answering your comment. \\
Can you please explain, or give an example, why there should be a problem with the capped-relative case? I tried to think about it but didn't manage to figure out myself.\\
Thank you!



---

archive/issue_comments_475961.json:
```json
{
    "body": "Changed branch from **[u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions)** to **[u/saraedum/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/shifting_issue_in_padic__set_from_list_functions)**",
    "created_at": "2022-02-23T06:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475961",
    "user": "https://github.com/saraedum"
}
```

Changed branch from **[u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-n-vi/shifting_issue_in_padic__set_from_list_functions)** to **[u/saraedum/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/shifting_issue_in_padic__set_from_list_functions)**



---

archive/issue_comments_475962.json:
```json
{
    "body": "Changed commit from **[41856e4](https://github.com/sagemath/sagetrac-mirror/commit/41856e44e0ed05f7205c2d366c40574716d0d26b)** to **[a97b2a6](https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83)**",
    "created_at": "2022-02-23T06:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475962",
    "user": "https://github.com/saraedum"
}
```

Changed commit from **[41856e4](https://github.com/sagemath/sagetrac-mirror/commit/41856e44e0ed05f7205c2d366c40574716d0d26b)** to **[a97b2a6](https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83)**



---

archive/issue_comments_475963.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI made some minor modifications to the documentation. If these look good to you, feel free to set this to positive review.\n\nSorry, for getting you wrong the first time and delaying this forever in doing so. The `relprec` in the docstring confused me when it should have been `absprec`.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c76d35e5e16f6aac23ac5f6292a8a4e9dff69051\">c76d35e</a></td><td><code>Merge remote-tracking branch 'trac/develop' into HEAD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4203fd1ba59ef0b4b7575ea53cc4060d99ecae61\">4203fd1</a></td><td><code>Merge remote-tracking branch 'trac/develop' into HEAD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83\">a97b2a6</a></td><td><code>Improve set_from_list documentation</code></td></tr></table>\n",
    "created_at": "2022-02-23T06:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475963",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:19" align="right">Comment 19</div>

I made some minor modifications to the documentation. If these look good to you, feel free to set this to positive review.

Sorry, for getting you wrong the first time and delaying this forever in doing so. The `relprec` in the docstring confused me when it should have been `absprec`.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c76d35e5e16f6aac23ac5f6292a8a4e9dff69051">c76d35e</a></td><td><code>Merge remote-tracking branch 'trac/develop' into HEAD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4203fd1ba59ef0b4b7575ea53cc4060d99ecae61">4203fd1</a></td><td><code>Merge remote-tracking branch 'trac/develop' into HEAD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83">a97b2a6</a></td><td><code>Improve set_from_list documentation</code></td></tr></table>




---

archive/issue_comments_475964.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nThis is great, thank you Julian! The documentation was indeed misleading here...",
    "created_at": "2022-02-23T06:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475964",
    "user": "https://github.com/n-vi"
}
```

<div id="comment:20" align="right">Comment 20</div>

This is great, thank you Julian! The documentation was indeed misleading here...



---

archive/issue_events_393671.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2022-02-23T06:48:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393671"
}
```



---

archive/issue_events_393672.json:
```json
{
    "actor": "https://github.com/n-vi",
    "created_at": "2022-02-23T06:48:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393672"
}
```



---

archive/issue_events_393673.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-27T22:00:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393673"
}
```



---

archive/issue_events_393674.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "02bde440d38fe59baa56d57ccb471a22f9426a52",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-02-27T22:00:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29927#event-393674"
}
```



---

archive/issue_comments_475965.json:
```json
{
    "body": "Changed branch from **[u/saraedum/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/shifting_issue_in_padic__set_from_list_functions)** to **[a97b2a6](https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83)**",
    "created_at": "2022-02-27T22:00:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29927",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29927#issuecomment-475965",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/saraedum/shifting_issue_in_padic__set_from_list_functions](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/shifting_issue_in_padic__set_from_list_functions)** to **[a97b2a6](https://github.com/sagemath/sagetrac-mirror/commit/a97b2a675fa285c410d0382ee68cfd087d89da83)**
