# Issue 29105: tox.ini, build/bin/write-dockerfile.sh: Add gentoo linux, add more gentoo packages

archive/issues_028868.json:
```json
{
    "assignees": [],
    "body": "As a followup to #29053 and #29273, we\n- extend `build/bin/write-dockerfile.sh` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4\n- add `build/pkgs/gentoo*.txt`\n- extend `bin/sage-print-system-package-command` to handle gentoo\n- add gentoo to the platforms tested in [GitHub](../wiki/GitHub) CI.\n\nTo test: `tox -e docker-gentoo-standard`\n\nThis is a part of:\n- #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages\n\n---\n\nResources:\n- https://forums.gentoo.org/viewtopic-t-969278-start-0.html\n- cschwan/sage-on-gentoo: (Unofficial) Gentoo Overlay for Sage- and Sage-related ebuilds: https://github.com/cschwan/sage-on-gentoo\n- Project:Overlays/Old User Guide - Gentoo Wiki: https://wiki.gentoo.org/wiki/Project:Overlays/Old_User_Guide\n- Layman - Gentoo Wiki: https://wiki.gentoo.org/wiki/Layman\n\n\nDepends on #29273\n\nCC:  @orlitzky @kiwifb @dimpase @sheerluck\n\nBranch: **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)**\n\nReviewer: **Matthias Koeppe**\n\nAuthor: **Andrey Belgorodski**\n\nComponent: **porting**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29105_\n\n",
    "closed_at": "2020-06-27T09:26:45Z",
    "created_at": "2020-01-30T02:29:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "tox.ini, build/bin/write-dockerfile.sh: Add gentoo linux, add more gentoo packages",
    "type": "issue",
    "updated_at": "2021-10-12T11:53:13Z",
    "url": "https://github.com/sagemath/sage/issues/29105",
    "user": "https://github.com/mkoeppe"
}
```
As a followup to #29053 and #29273, we
- extend `build/bin/write-dockerfile.sh` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4
- add `build/pkgs/gentoo*.txt`
- extend `bin/sage-print-system-package-command` to handle gentoo
- add gentoo to the platforms tested in [GitHub](../wiki/GitHub) CI.

To test: `tox -e docker-gentoo-standard`

This is a part of:
- #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages

---

Resources:
- https://forums.gentoo.org/viewtopic-t-969278-start-0.html
- cschwan/sage-on-gentoo: (Unofficial) Gentoo Overlay for Sage- and Sage-related ebuilds: https://github.com/cschwan/sage-on-gentoo
- Project:Overlays/Old User Guide - Gentoo Wiki: https://wiki.gentoo.org/wiki/Project:Overlays/Old_User_Guide
- Layman - Gentoo Wiki: https://wiki.gentoo.org/wiki/Layman


Depends on #29273

CC:  @orlitzky @kiwifb @dimpase @sheerluck

Branch: **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)**

Reviewer: **Matthias Koeppe**

Author: **Andrey Belgorodski**

Component: **porting**

_Issue created by migration from https://trac.sagemath.org/ticket/29105_





---

archive/issue_events_397026.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-30T02:29:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397026"
}
```



---

archive/issue_events_397027.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-30T02:29:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "0000b0",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397027"
}
```



---

archive/issue_events_397028.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-30T02:29:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397028"
}
```



---

archive/issue_events_397029.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-30T02:29:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397029"
}
```



---

archive/issue_comments_455827.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nCreating a dockerfile for setting up sage prerequisites on a Gentoo \"prefix\" was previously discussed in #28905.\n\nAn attempt (incomplete) is at https://github.com/sagemath/sage/files/ticket28905/Dockerfile-sage_gentoo.gz and would need help from Gentoo experts.",
    "created_at": "2020-01-30T02:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455827",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Creating a dockerfile for setting up sage prerequisites on a Gentoo "prefix" was previously discussed in #28905.

An attempt (incomplete) is at https://github.com/sagemath/sage/files/ticket28905/Dockerfile-sage_gentoo.gz and would need help from Gentoo experts.



---

archive/issue_comments_455828.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we\n - add files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages\n-- extend `build/bin/write-dockerfile` to generate a Dockerfile for a gentoo \"prefix\" build.\n+- extend `build/bin/write-dockerfile` to generate a Dockerfile for a gentoo \"prefix\" build - for rigorous multi-platform testing.\n \n This is a part of:\n - #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages\n``````\n",
    "created_at": "2020-01-30T02:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455828",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we
 - add files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages
-- extend `build/bin/write-dockerfile` to generate a Dockerfile for a gentoo "prefix" build.
+- extend `build/bin/write-dockerfile` to generate a Dockerfile for a gentoo "prefix" build - for rigorous multi-platform testing.
 
 This is a part of:
 - #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages
``````




---

archive/issue_comments_455829.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n`compiler can't create executables` in a configure phase of gcc typically means the compiler can't find libgmp and al. Do you have a log for me to review? Prefix on ubuntu is definitely supported. The only thing I can think of is that the bootstrap usually object being run as root.",
    "created_at": "2020-01-30T03:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455829",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:2" align="right">comment:2</div>

`compiler can't create executables` in a configure phase of gcc typically means the compiler can't find libgmp and al. Do you have a log for me to review? Prefix on ubuntu is definitely supported. The only thing I can think of is that the bootstrap usually object being run as root.



---

archive/issue_comments_455830.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThanks, yes, turns out this was not specific to the gentoo prefix installer. I had to add some more packages. Let me see how far I get with this.",
    "created_at": "2020-01-30T03:36:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455830",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Thanks, yes, turns out this was not specific to the gentoo prefix installer. I had to add some more packages. Let me see how far I get with this.



---

archive/issue_comments_455831.json:
```json
{
    "body": "Attachment: **[gentoo-log-2.txt](https://github.com/sagemath/sage/files/ticket29105/gentoo-log-2.txt)**",
    "created_at": "2020-01-30T04:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455831",
    "user": "https://github.com/mkoeppe"
}
```

Attachment: **[gentoo-log-2.txt](https://github.com/sagemath/sage/files/ticket29105/gentoo-log-2.txt)**



---

archive/issue_comments_455832.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAttachment: **[Dockerfile-sage_gentoo.gz](https://github.com/sagemath/sage/files/ticket29105/Dockerfile-sage_gentoo.gz)**\n\nOK... this is where I got now. The `./bootstrap-prefix.sh` script was claiming to bootstrap some packages - such as xz and patch - and succeeded with that; but then it was missing \"xz\" to unpack the Python sources. I think something is wrong there, but I added xz&patch in ubuntu. This is attached Dockerfile-sage_gentoo and log from 'docker build' with that. \n\nAs you can see in the log, now it's complaining about a module missing in the Python that it just built:\n\n```\n  File \"/gentoo/var/tmp/python-3.6.10/Python-3.6.10/Lib/xml/parsers/expat.py\", line 4, in <module>\n    from pyexpat import *\nModuleNotFoundError: No module named 'pyexpat'\nmake: *** [install] Error 1\nMakefile:1102: recipe for target 'install' failed\n??? Python failed to install *sigh* continuing anyway\n* Python bootstrapped\nhttp://distfiles.gentoo.org/snapshots\n```\nand then dies with:\n\n```\n* Compiling prefix-portage\n./configure --host=x86_64-pc-linux-gnu --prefix=/gentoo/tmp/usr --mandir=/gentoo/tmp/usr/share/man --infodir=/gentoo/tmp/usr/share/info --datadir=/gentoo/tmp/usr/share --sysconfdir=/gentoo/tmp/etc --localstatedir=/gentoo/tmp/var/lib --build=x86_64-pc-linux-gnu --with-offset-prefix=/gentoo/tmp --with-portage-user=root --with-portage-group=root --with-extra-path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nchecking build system type... x86_64-pc-linux-gnu\nchecking host system type... x86_64-pc-linux-gnu\nchecking target system type... x86_64-pc-linux-gnu\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /bin/mkdir -p\nchecking for gawk... no\nchecking for mawk... mawk\n....\nchecking whether /usr/bin/id is good enough... yes\nchecking for python... no\nconfigure: error: no python found in your path\n```",
    "created_at": "2020-01-30T04:17:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455832",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Attachment: **[Dockerfile-sage_gentoo.gz](https://github.com/sagemath/sage/files/ticket29105/Dockerfile-sage_gentoo.gz)**

OK... this is where I got now. The `./bootstrap-prefix.sh` script was claiming to bootstrap some packages - such as xz and patch - and succeeded with that; but then it was missing "xz" to unpack the Python sources. I think something is wrong there, but I added xz&patch in ubuntu. This is attached Dockerfile-sage_gentoo and log from 'docker build' with that. 

As you can see in the log, now it's complaining about a module missing in the Python that it just built:

```
  File "/gentoo/var/tmp/python-3.6.10/Python-3.6.10/Lib/xml/parsers/expat.py", line 4, in <module>
    from pyexpat import *
ModuleNotFoundError: No module named 'pyexpat'
make: *** [install] Error 1
Makefile:1102: recipe for target 'install' failed
??? Python failed to install *sigh* continuing anyway
* Python bootstrapped
http://distfiles.gentoo.org/snapshots
```
and then dies with:

```
* Compiling prefix-portage
./configure --host=x86_64-pc-linux-gnu --prefix=/gentoo/tmp/usr --mandir=/gentoo/tmp/usr/share/man --infodir=/gentoo/tmp/usr/share/info --datadir=/gentoo/tmp/usr/share --sysconfdir=/gentoo/tmp/etc --localstatedir=/gentoo/tmp/var/lib --build=x86_64-pc-linux-gnu --with-offset-prefix=/gentoo/tmp --with-portage-user=root --with-portage-group=root --with-extra-path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
checking target system type... x86_64-pc-linux-gnu
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
....
checking whether /usr/bin/id is good enough... yes
checking for python... no
configure: error: no python found in your path
```



---

archive/issue_comments_455833.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n`xz` is rearing up its head again. Yes it should be an early one. Because many more sources are in .xz I am not shocked that it should be a pre-requisite along with patch. The pyexpat stuff is weird. I'll do some experimenting later. I haven't really touched prefix since ppc64 was retired (because I didn't want or could maintain it long term).",
    "created_at": "2020-01-30T04:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455833",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

`xz` is rearing up its head again. Yes it should be an early one. Because many more sources are in .xz I am not shocked that it should be a pre-requisite along with patch. The pyexpat stuff is weird. I'll do some experimenting later. I haven't really touched prefix since ppc64 was retired (because I didn't want or could maintain it long term).



---

archive/issue_comments_455834.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,18 @@\n As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we\n - add files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages\n-- extend `build/bin/write-dockerfile` to generate a Dockerfile for a gentoo \"prefix\" build - for rigorous multi-platform testing.\n+- extend `build/bin/write-dockerfile` to \n+   - generate a Dockerfile using https://hub.docker.com/r/gentoo/stage3-amd64/tags\n+   - generate a Dockerfile for a gentoo \"prefix\" build on top of some Linux distribution\n+  for rigorous multi-platform testing.\n \n This is a part of:\n - #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages\n+\n+---\n+\n+Resources:\n+- https://forums.gentoo.org/viewtopic-t-969278-start-0.html\n+- cschwan/sage-on-gentoo: (Unofficial) Gentoo Overlay for Sage- and Sage-related ebuilds: https://github.com/cschwan/sage-on-gentoo\n+- Project:Overlays/Old User Guide - Gentoo Wiki: https://wiki.gentoo.org/wiki/Project:Overlays/Old_User_Guide\n+- Layman - Gentoo Wiki: https://wiki.gentoo.org/wiki/Layman\n+\n``````\n",
    "created_at": "2020-02-12T03:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455834",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,18 @@
 As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we
 - add files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages
-- extend `build/bin/write-dockerfile` to generate a Dockerfile for a gentoo "prefix" build - for rigorous multi-platform testing.
+- extend `build/bin/write-dockerfile` to 
+   - generate a Dockerfile using https://hub.docker.com/r/gentoo/stage3-amd64/tags
+   - generate a Dockerfile for a gentoo "prefix" build on top of some Linux distribution
+  for rigorous multi-platform testing.
 
 This is a part of:
 - #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages
+
+---
+
+Resources:
+- https://forums.gentoo.org/viewtopic-t-969278-start-0.html
+- cschwan/sage-on-gentoo: (Unofficial) Gentoo Overlay for Sage- and Sage-related ebuilds: https://github.com/cschwan/sage-on-gentoo
+- Project:Overlays/Old User Guide - Gentoo Wiki: https://wiki.gentoo.org/wiki/Project:Overlays/Old_User_Guide
+- Layman - Gentoo Wiki: https://wiki.gentoo.org/wiki/Layman
+
``````




---

archive/issue_comments_455835.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,7 @@\n-As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we\n-- add files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages\n-- extend `build/bin/write-dockerfile` to \n+As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we are adding files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages in #29273.\n+\n+In this ticket, \n+- we extend `build/bin/write-dockerfile` to \n    - generate a Dockerfile using https://hub.docker.com/r/gentoo/stage3-amd64/tags\n    - generate a Dockerfile for a gentoo \"prefix\" build on top of some Linux distribution\n   for rigorous multi-platform testing.\n``````\n",
    "created_at": "2020-03-04T00:52:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455835",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,7 @@
-As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we
-- add files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages
-- extend `build/bin/write-dockerfile` to 
+As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we are adding files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages in #29273.
+
+In this ticket, 
+- we extend `build/bin/write-dockerfile` to 
    - generate a Dockerfile using https://hub.docker.com/r/gentoo/stage3-amd64/tags
    - generate a Dockerfile for a gentoo "prefix" build on top of some Linux distribution
   for rigorous multi-platform testing.
``````




---

archive/issue_events_397030.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-04T00:52:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "title_is": "Extend dockerfile generator to gentoo",
    "title_was": "Add gentoo package information, extend dockerfile generator to gentoo",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397030"
}
```



---

archive/issue_comments_455836.json:
```json
{
    "body": "Dependencies: **#29273**",
    "created_at": "2020-03-04T00:52:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455836",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29273**



---

archive/issue_comments_455837.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThis tickets needs help from someone who actually uses Gentoo. I found the instructions for installing stuff inadequate.",
    "created_at": "2020-03-04T00:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455837",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

This tickets needs help from someone who actually uses Gentoo. I found the instructions for installing stuff inadequate.



---

archive/issue_comments_455838.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI use Gentoo, but neither prefix, not docker.",
    "created_at": "2020-03-04T01:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455838",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

I use Gentoo, but neither prefix, not docker.



---

archive/issue_comments_455839.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI need to make time for this. I cannot give you a time frame.",
    "created_at": "2020-03-04T01:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455839",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

I need to make time for this. I cannot give you a time frame.



---

archive/issue_comments_455840.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@dimpase](#comment:10):\n> I use Gentoo, but [...] not docker.\n\nAfter installing a docker client, it only takes \n\n```\ndocker run -it gentoo/stage3-amd64\n```\nThis gives you root prompt. I would need instructions on what to do next to install relevant gentoo packages here.",
    "created_at": "2020-03-04T01:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455840",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@dimpase](#comment:10):
> I use Gentoo, but [...] not docker.

After installing a docker client, it only takes 

```
docker run -it gentoo/stage3-amd64
```
This gives you root prompt. I would need instructions on what to do next to install relevant gentoo packages here.



---

archive/issue_comments_455841.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIf I understand well you have a minimal gentoo image running now. What do you want to install? Do you have a list somewhere?",
    "created_at": "2020-03-04T01:41:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455841",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:13" align="right">comment:13</div>

If I understand well you have a minimal gentoo image running now. What do you want to install? Do you have a list somewhere?



---

archive/issue_comments_455842.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@kiwifb](#comment:13):\n> If I understand well you have a minimal gentoo image running now. What do you want to install? Do you have a list somewhere?\n\nThe equivalent of the lists in  build/pkgs/debian-bootstrap.txt and build/pkgs/debian.txt (minimal requirements for bootstrapping and building) -- which would be added in #29273 as well since gentoo packages are being added there.",
    "created_at": "2020-03-04T01:45:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455842",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@kiwifb](#comment:13):
> If I understand well you have a minimal gentoo image running now. What do you want to install? Do you have a list somewhere?

The equivalent of the lists in  build/pkgs/debian-bootstrap.txt and build/pkgs/debian.txt (minimal requirements for bootstrapping and building) -- which would be added in #29273 as well since gentoo packages are being added there.



---

archive/issue_comments_455843.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@mkoeppe](#comment:12):\n> Replying to [@dimpase](#comment:10):\n> > I use Gentoo, but [...] not docker.\n\n> \n> After installing a docker client, it only takes \n> \n> ```\n> docker run -it gentoo/stage3-amd64\n> ```\n> This gives you root prompt. I would need instructions on what to do next to install relevant gentoo packages here. \n\nI can try either this or Gentoo in lxc container, if such a thing exists somewhere.",
    "created_at": "2020-03-05T20:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455843",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@mkoeppe](#comment:12):
> Replying to [@dimpase](#comment:10):
> > I use Gentoo, but [...] not docker.

> 
> After installing a docker client, it only takes 
> 
> ```
> docker run -it gentoo/stage3-amd64
> ```
> This gives you root prompt. I would need instructions on what to do next to install relevant gentoo packages here. 

I can try either this or Gentoo in lxc container, if such a thing exists somewhere.



---

archive/issue_comments_455844.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nDocker please because that's what my tox.ini infrastructure uses.\nIf we want to do the same with lxc instead of docker, why not, but perhaps one step at a time?",
    "created_at": "2020-03-05T20:31:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455844",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Docker please because that's what my tox.ini infrastructure uses.
If we want to do the same with lxc instead of docker, why not, but perhaps one step at a time?



---

archive/issue_comments_455845.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI have created ticket #29283 for the goal of lxc containers for testing, in case someone wants to work on that.",
    "created_at": "2020-03-18T03:13:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455845",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

I have created ticket #29283 for the goal of lxc containers for testing, in case someone wants to work on that.



---

archive/issue_events_397031.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-18T03:15:05Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "title_is": "Extend dockerfile generator to gentoo, add more gentoo packages",
    "title_was": "Extend dockerfile generator to gentoo",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397031"
}
```



---

archive/issue_events_397032.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:20:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397032"
}
```



---

archive/issue_events_397033.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:20:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397033"
}
```



---

archive/issue_comments_455846.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nStarting points for people who want to help with this:\n- https://doc.sagemath.org/html/en/developer/portability_testing.html \n- https://researchseminars.org/talk/SageDays109/7/",
    "created_at": "2020-06-14T12:41:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455846",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Starting points for people who want to help with this:
- https://doc.sagemath.org/html/en/developer/portability_testing.html 
- https://researchseminars.org/talk/SageDays109/7/



---

archive/issue_comments_455847.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWhen I run `tox -e docker-gentoo` I get half-baked `sage/.tox/docker-gentoo/Dockerfile`, I need a way to shove the hand-crafted `Dockerfile` instead (for debugging purposes). What is the best way to do it?",
    "created_at": "2020-06-15T17:34:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455847",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:22" align="right">comment:22</div>

When I run `tox -e docker-gentoo` I get half-baked `sage/.tox/docker-gentoo/Dockerfile`, I need a way to shove the hand-crafted `Dockerfile` instead (for debugging purposes). What is the best way to do it?



---

archive/issue_comments_455848.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nDoes your handcrafted Dockerfile work with `docker build` already?",
    "created_at": "2020-06-15T17:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455848",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">comment:23</div>

Does your handcrafted Dockerfile work with `docker build` already?



---

archive/issue_comments_455849.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nYou could insert a line before `    # From https://hub.docker.com/r/multiarch/ubuntu-core/\n`\nthat says\n\n```\n    docker-gentoo:  bash -c 'whatever command to create a handcrafted {envdir}/Dockerfile'    \n\n```",
    "created_at": "2020-06-15T17:47:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455849",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

You could insert a line before `    # From https://hub.docker.com/r/multiarch/ubuntu-core/
`
that says

```
    docker-gentoo:  bash -c 'whatever command to create a handcrafted {envdir}/Dockerfile'    

```



---

archive/issue_comments_455850.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSo right after\n\n```\ndocker:        bash -c 'build/bin/write-dockerfile.sh  ... > {envdir}/Dockerfile'\n```\nThank you!",
    "created_at": "2020-06-15T17:51:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455850",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:25" align="right">comment:25</div>

So right after

```
docker:        bash -c 'build/bin/write-dockerfile.sh  ... > {envdir}/Dockerfile'
```
Thank you!



---

archive/issue_comments_455851.json:
```json
{
    "body": "Attachment: **[docker-gentoo-installed.txt](https://github.com/sagemath/sage/files/ticket29105/docker-gentoo-installed.txt)**\n\ndocker-gentoo-installed.txt",
    "created_at": "2020-06-15T21:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455851",
    "user": "https://github.com/sheerluck"
}
```

Attachment: **[docker-gentoo-installed.txt](https://github.com/sagemath/sage/files/ticket29105/docker-gentoo-installed.txt)**

docker-gentoo-installed.txt



---

archive/issue_comments_455852.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThe work is still in progress.\nI managed to install 555 packages.",
    "created_at": "2020-06-15T21:17:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455852",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:26" align="right">comment:26</div>

The work is still in progress.
I managed to install 555 packages.



---

archive/issue_comments_455853.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nNice",
    "created_at": "2020-06-15T21:19:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455853",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Nice



---

archive/issue_comments_455854.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n\n```\nreal    14m14.888s\nuser    98m59.353s\nsys     3m4.286s\nSAGE_CHECK=warn, so scanning the log files. This may take a few seconds.\nSage build/upgrade complete!\nmake[1]: Leaving directory '/sage'\nRemoving intermediate container e0e5bbfb22ea\n ---> 14316b24894b\n[Warning] One or more build-args [TARGETS_OPTIONAL] were not consumed\nSuccessfully built 14316b24894b\nSuccessfully tagged sage-docker-gentoo-standard-with-targets:9.2.beta1-dirty\n_________________________ summary __________________________\n  docker-gentoo-standard: commands succeeded\n  congratulations :)\n```\n\n1) run `docker build -t fbissey/sage-on-gentoo-stage4:20.6 -t fbissey/sage-on-gentoo-stage4:latest -f Dockerfile_gentoo-20.06-gcc9-py37 .`  \n\n2) patch `tox.ini` and `write-dockerfile.sh`",
    "created_at": "2020-06-16T16:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455854",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:28" align="right">comment:28</div>


```
real    14m14.888s
user    98m59.353s
sys     3m4.286s
SAGE_CHECK=warn, so scanning the log files. This may take a few seconds.
Sage build/upgrade complete!
make[1]: Leaving directory '/sage'
Removing intermediate container e0e5bbfb22ea
 ---> 14316b24894b
[Warning] One or more build-args [TARGETS_OPTIONAL] were not consumed
Successfully built 14316b24894b
Successfully tagged sage-docker-gentoo-standard-with-targets:9.2.beta1-dirty
_________________________ summary __________________________
  docker-gentoo-standard: commands succeeded
  congratulations :)
```

1) run `docker build -t fbissey/sage-on-gentoo-stage4:20.6 -t fbissey/sage-on-gentoo-stage4:latest -f Dockerfile_gentoo-20.06-gcc9-py37 .`  

2) patch `tox.ini` and `write-dockerfile.sh`



---

archive/issue_comments_455855.json:
```json
{
    "body": "Attachment: **[tox.ini.patch.gz](https://github.com/sagemath/sage/files/ticket29105/tox.ini.patch.gz)**",
    "created_at": "2020-06-16T16:30:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455855",
    "user": "https://github.com/sheerluck"
}
```

Attachment: **[tox.ini.patch.gz](https://github.com/sagemath/sage/files/ticket29105/tox.ini.patch.gz)**



---

archive/issue_comments_455856.json:
```json
{
    "body": "Attachment: **[write-dockerfile.sh.patch.gz](https://github.com/sagemath/sage/files/ticket29105/write-dockerfile.sh.patch.gz)**",
    "created_at": "2020-06-16T16:30:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455856",
    "user": "https://github.com/sheerluck"
}
```

Attachment: **[write-dockerfile.sh.patch.gz](https://github.com/sagemath/sage/files/ticket29105/write-dockerfile.sh.patch.gz)**



---

archive/issue_comments_455857.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nAttachment: **[Dockerfile_gentoo-20.06-gcc9-py37.gz](https://github.com/sagemath/sage/files/ticket29105/Dockerfile_gentoo-20.06-gcc9-py37.gz)**\n\nhttps://hub.docker.com/r/fbissey/sage-on-gentoo-stage/tags ... this does not seem to exist yet?",
    "created_at": "2020-06-16T16:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455857",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Attachment: **[Dockerfile_gentoo-20.06-gcc9-py37.gz](https://github.com/sagemath/sage/files/ticket29105/Dockerfile_gentoo-20.06-gcc9-py37.gz)**

https://hub.docker.com/r/fbissey/sage-on-gentoo-stage/tags ... this does not seem to exist yet?



---

archive/issue_comments_455858.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@mkoeppe](#comment:29):\n> https://hub.docker.com/r/fbissey/sage-on-gentoo-stage/tags ... this does not seem to exist yet?\n\nIt does not exist. Someone have to decide where to store an image. I have no idea, my docker-fu is weak.",
    "created_at": "2020-06-16T16:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455858",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@mkoeppe](#comment:29):
> https://hub.docker.com/r/fbissey/sage-on-gentoo-stage/tags ... this does not seem to exist yet?

It does not exist. Someone have to decide where to store an image. I have no idea, my docker-fu is weak.



---

archive/issue_comments_455859.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nWhy not create an account on docker hub? Next step: https://docs.docker.com/docker-hub/builds/",
    "created_at": "2020-06-16T17:46:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455859",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Why not create an account on docker hub? Next step: https://docs.docker.com/docker-hub/builds/



---

archive/issue_comments_455860.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI am working on `Dockerfile_gentoo-20.06-gcc9-py37`\u200b to make image size much much smaller :(",
    "created_at": "2020-06-17T04:47:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455860",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:32" align="right">comment:32</div>

I am working on `Dockerfile_gentoo-20.06-gcc9-py37`​ to make image size much much smaller :(



---

archive/issue_comments_455861.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\n`docker pull sheerluck/sage-on-gentoo-stage4:latest`",
    "created_at": "2020-06-17T12:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455861",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:33" align="right">comment:33</div>

`docker pull sheerluck/sage-on-gentoo-stage4:latest`



---

archive/issue_comments_455862.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\n\n```\n$ docker run -it sheerluck/sage-on-gentoo-stage4 /bin/bash\ncf6f39e01c4a / # ipython --no-banner\n\nIn [1]: from os import walk\n   ...: pth, ext = \"/var/db/pkg\", \".ebuild\"\n   ...: lex, res = len(ext), []\n   ...: for _, _, u in walk(pth):\n   ...:     res += [x[:-lex] for x in u if x.endswith(ext)]\n   ...: for  pkg  in sorted(res): print(pkg)\nAlnuth-3.1.1\nApp-pwhich-1.150.0\nAuthen-SASL-2.160.0-r1\n...\nzn_poly-0.9.2\nzope-interface-4.7.1\nzstd-1.4.4-r4\nzziplib-0.13.69-r1\n```",
    "created_at": "2020-06-17T12:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455862",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:34" align="right">comment:34</div>


```
$ docker run -it sheerluck/sage-on-gentoo-stage4 /bin/bash
cf6f39e01c4a / # ipython --no-banner

In [1]: from os import walk
   ...: pth, ext = "/var/db/pkg", ".ebuild"
   ...: lex, res = len(ext), []
   ...: for _, _, u in walk(pth):
   ...:     res += [x[:-lex] for x in u if x.endswith(ext)]
   ...: for  pkg  in sorted(res): print(pkg)
Alnuth-3.1.1
App-pwhich-1.150.0
Authen-SASL-2.160.0-r1
...
zn_poly-0.9.2
zope-interface-4.7.1
zstd-1.4.4-r4
zziplib-0.13.69-r1
```



---

archive/issue_comments_455863.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nAwesome!",
    "created_at": "2020-06-17T15:21:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455863",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

Awesome!



---

archive/issue_comments_455864.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nCould you put the changes to the sage scripts on a git branch please?",
    "created_at": "2020-06-18T19:48:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455864",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

Could you put the changes to the sage scripts on a git branch please?



---

archive/issue_comments_455865.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\n\n```\n$ git push trac HEAD:u/gh-sheerluck/gentoo\n...\nTo trac.sagemath.org:sage.git\n * [new branch]            HEAD -> u/gh-sheerluck/gentoo\n```",
    "created_at": "2020-06-18T20:45:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455865",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:37" align="right">comment:37</div>


```
$ git push trac HEAD:u/gh-sheerluck/gentoo
...
To trac.sagemath.org:sage.git
 * [new branch]            HEAD -> u/gh-sheerluck/gentoo
```



---

archive/issue_comments_455866.json:
```json
{
    "body": "Branch: **[u/gh-sheerluck/gentoo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-sheerluck/gentoo)**",
    "created_at": "2020-06-18T21:05:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455866",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/gh-sheerluck/gentoo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-sheerluck/gentoo)**



---

archive/issue_comments_455867.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25d05792b7d44103de445e2e591393f3e5ef3862\"><code>25d0579</code></a></td><td><code>write-dockerfile.sh is extended to support gentoo</code></td></tr></table>\n",
    "created_at": "2020-06-18T21:05:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455867",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25d05792b7d44103de445e2e591393f3e5ef3862"><code>25d0579</code></a></td><td><code>write-dockerfile.sh is extended to support gentoo</code></td></tr></table>




---

archive/issue_comments_455868.json:
```json
{
    "body": "Commit: **[`25d0579`](https://github.com/sagemath/sagetrac-mirror/commit/25d05792b7d44103de445e2e591393f3e5ef3862)**",
    "created_at": "2020-06-18T21:05:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455868",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`25d0579`](https://github.com/sagemath/sagetrac-mirror/commit/25d05792b7d44103de445e2e591393f3e5ef3862)**



---

archive/issue_comments_455869.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\n\n```\nsed: ./build/pkgs/gentoo.txt: No such file or directory\nsed: ./build/pkgs/gentoo-bootstrap.txt: No such file or directory\n```",
    "created_at": "2020-06-18T22:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455869",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">comment:39</div>


```
sed: ./build/pkgs/gentoo.txt: No such file or directory
sed: ./build/pkgs/gentoo-bootstrap.txt: No such file or directory
```



---

archive/issue_comments_455870.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nAlso, at the end of `configure`, I see:\n\n```\nconfigure: notice: the following SPKGs did not find equivalent system packages: cbc eclib gp2c isl lcalc libsemigroups pandoc pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small perl_cpan_polymake_prereq perl_term_readline_gnu r yasm\nchecking for the package system in use... gentoo\nconfigure: hint: installing the following system packages is recommended and may avoid building some of the above SPKGs from source:\nconfigure: # install the following packages: sci-mathematics/eclib[flint] sci-mathematics/gp2c dev-libs/isl app-text/pandoc sci-mathematics/pari sci-mathematics/pari-data XML-Writer XML-LibXML XML-LibXSLT File-Slurp dev-perl/Term-ReadLine-Gnu JSON SVG dev-perl/MongoDB dev-perl/Term-ReadLine-Gnu dev-lang/R\n```\nCould you update `build/bin/sage-print-system-package-command` so that an actual installation command is displayed?",
    "created_at": "2020-06-18T22:53:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455870",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

Also, at the end of `configure`, I see:

```
configure: notice: the following SPKGs did not find equivalent system packages: cbc eclib gp2c isl lcalc libsemigroups pandoc pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small perl_cpan_polymake_prereq perl_term_readline_gnu r yasm
checking for the package system in use... gentoo
configure: hint: installing the following system packages is recommended and may avoid building some of the above SPKGs from source:
configure: # install the following packages: sci-mathematics/eclib[flint] sci-mathematics/gp2c dev-libs/isl app-text/pandoc sci-mathematics/pari sci-mathematics/pari-data XML-Writer XML-LibXML XML-LibXSLT File-Slurp dev-perl/Term-ReadLine-Gnu JSON SVG dev-perl/MongoDB dev-perl/Term-ReadLine-Gnu dev-lang/R
```
Could you update `build/bin/sage-print-system-package-command` so that an actual installation command is displayed?



---

archive/issue_comments_455871.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI added `gentoo.txt` and `gentoo-bootstrap.txt` and updated `sage-print-system-package-command` and I am going to refresh `sheerluck/sage-on-gentoo-stage4:latest` with additional packages (except `pandoc`) and after testing I will push in `u/gh-sheerluck/gentoo` branch",
    "created_at": "2020-06-19T06:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455871",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:41" align="right">comment:41</div>

I added `gentoo.txt` and `gentoo-bootstrap.txt` and updated `sage-print-system-package-command` and I am going to refresh `sheerluck/sage-on-gentoo-stage4:latest` with additional packages (except `pandoc`) and after testing I will push in `u/gh-sheerluck/gentoo` branch



---

archive/issue_comments_455872.json:
```json
{
    "body": "Changed commit from **[`25d0579`](https://github.com/sagemath/sagetrac-mirror/commit/25d05792b7d44103de445e2e591393f3e5ef3862)** to **[`c55cfa9`](https://github.com/sagemath/sagetrac-mirror/commit/c55cfa9bd2d0d29df3cd5cc24be5b743eee8aadf)**",
    "created_at": "2020-06-19T12:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455872",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`25d0579`](https://github.com/sagemath/sagetrac-mirror/commit/25d05792b7d44103de445e2e591393f3e5ef3862)** to **[`c55cfa9`](https://github.com/sagemath/sagetrac-mirror/commit/c55cfa9bd2d0d29df3cd5cc24be5b743eee8aadf)**



---

archive/issue_comments_455873.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c55cfa9bd2d0d29df3cd5cc24be5b743eee8aadf\"><code>c55cfa9</code></a></td><td><code>sage-print-system-package-command updated</code></td></tr></table>\n",
    "created_at": "2020-06-19T12:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455873",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c55cfa9bd2d0d29df3cd5cc24be5b743eee8aadf"><code>c55cfa9</code></a></td><td><code>sage-print-system-package-command updated</code></td></tr></table>




---

archive/issue_comments_455874.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nNow `configure` says \"configure:   $ sudo emerge sci-mathematics/eclib[flint] sci-mathematics/gp2c app-text/pandoc sci-mathematics/pari sci-mathematics/pari-data XML-Writer XML-LibXML XML-LibXSLT File-Slurp dev-perl/Term-ReadLine-Gnu JSON SVG dev-perl/MongoDB dev-lang/R\" although everything is installed in `sheerluck/sage-on-gentoo-stage4:latest` (except `pandoc`)",
    "created_at": "2020-06-19T12:54:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455874",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:43" align="right">comment:43</div>

Now `configure` says "configure:   $ sudo emerge sci-mathematics/eclib[flint] sci-mathematics/gp2c app-text/pandoc sci-mathematics/pari sci-mathematics/pari-data XML-Writer XML-LibXML XML-LibXSLT File-Slurp dev-perl/Term-ReadLine-Gnu JSON SVG dev-perl/MongoDB dev-lang/R" although everything is installed in `sheerluck/sage-on-gentoo-stage4:latest` (except `pandoc`)



---

archive/issue_comments_455875.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nFor `sci-mathematics/eclib[flint]`, please check whether this syntax does whatever was intended there. See previous discussion in #29273.\n\n`config.log` should give information on why a particular package was rejected by `configure`.",
    "created_at": "2020-06-19T15:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455875",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">comment:44</div>

For `sci-mathematics/eclib[flint]`, please check whether this syntax does whatever was intended there. See previous discussion in #29273.

`config.log` should give information on why a particular package was rejected by `configure`.



---

archive/issue_comments_455876.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReading `config.log` is fascinating.\n\nFor example,  \"cbc >= 2.9.4\" might refer to `sci-libs/coinor-cbc-2.10.5` (https://github.com/coin-or/Cbc)\n\nWIP",
    "created_at": "2020-06-19T17:53:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455876",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:45" align="right">comment:45</div>

Reading `config.log` is fascinating.

For example,  "cbc >= 2.9.4" might refer to `sci-libs/coinor-cbc-2.10.5` (https://github.com/coin-or/Cbc)

WIP



---

archive/issue_comments_455877.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@sheerluck](#comment:43):\n> Now `configure` says \"configure:   $ sudo emerge sci-mathematics/eclib[flint] sci-mathematics/gp2c app-text/pandoc sci-mathematics/pari sci-mathematics/pari-data XML-Writer XML-LibXML XML-LibXSLT File-Slurp dev-perl/Term-ReadLine-Gnu JSON SVG dev-perl/MongoDB dev-lang/R\" although everything is installed in `sheerluck/sage-on-gentoo-stage4:latest` (except `pandoc`)\n> \n\n`USE=flint sudo emerge sci-mathematics/eclib`? I am not completely sure `USE` is passed to the `sudo` environment that way. I am not sure how many people use `sudo` on their Gentoo system either. It is not quite the default. I would go\n\n```\nUSE=flint su -c \"emerge sci-mathematics/eclib\"\n```",
    "created_at": "2020-06-19T20:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455877",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@sheerluck](#comment:43):
> Now `configure` says "configure:   $ sudo emerge sci-mathematics/eclib[flint] sci-mathematics/gp2c app-text/pandoc sci-mathematics/pari sci-mathematics/pari-data XML-Writer XML-LibXML XML-LibXSLT File-Slurp dev-perl/Term-ReadLine-Gnu JSON SVG dev-perl/MongoDB dev-lang/R" although everything is installed in `sheerluck/sage-on-gentoo-stage4:latest` (except `pandoc`)
> 

`USE=flint sudo emerge sci-mathematics/eclib`? I am not completely sure `USE` is passed to the `sudo` environment that way. I am not sure how many people use `sudo` on their Gentoo system either. It is not quite the default. I would go

```
USE=flint su -c "emerge sci-mathematics/eclib"
```



---

archive/issue_comments_455878.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nYou can leave off the sudo/su command. It's understood that you should have root privileges to use it, and if not, emerge itself will tell you.\n\nThe `emerge a[foo] b[bar]` syntax isn't right but there is no one-line command that does what we want. The closest thing is `USE=\"foo bar\" emerge a b`, but the next time the user updates his system those `USE` flags will be lost. It also has the side effect of enabling `USE=foo` for `b` and `USE=bar` for `a`, which may not work. What should really be done is to place\n\n```\na foo\nb bar\n```\n\nin `/etc/portage/package.use`, or whatever is equivalent for pkgcore (the other Gentoo package manager). Pkgcore has its own, different, installation commands too.\n\nThe `a[foo]` syntax does make sense in users' heads, so to keep things simple, we could probably just have it say \"install the following packages: a[foo] b[bar]\", or something like that.",
    "created_at": "2020-06-19T20:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455878",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:47" align="right">comment:47</div>

You can leave off the sudo/su command. It's understood that you should have root privileges to use it, and if not, emerge itself will tell you.

The `emerge a[foo] b[bar]` syntax isn't right but there is no one-line command that does what we want. The closest thing is `USE="foo bar" emerge a b`, but the next time the user updates his system those `USE` flags will be lost. It also has the side effect of enabling `USE=foo` for `b` and `USE=bar` for `a`, which may not work. What should really be done is to place

```
a foo
b bar
```

in `/etc/portage/package.use`, or whatever is equivalent for pkgcore (the other Gentoo package manager). Pkgcore has its own, different, installation commands too.

The `a[foo]` syntax does make sense in users' heads, so to keep things simple, we could probably just have it say "install the following packages: a[foo] b[bar]", or something like that.



---

archive/issue_comments_455879.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nDo not worry about USE flags. Every USE flag in `sheerluck/sage-on-gentoo-stage4:latest` already is correct, because Dockerfile uses \"sage-on-gentoo\" overlay. If suddenly we need `sys-devel/bc[foo]` I will go to https://github.com/cschwan/sage-on-gentoo/issues, wait for @kiwifb and then refresh latest image. There is no need to have two conflicting places for USE flags, overlay is enough",
    "created_at": "2020-06-19T21:06:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455879",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:48" align="right">comment:48</div>

Do not worry about USE flags. Every USE flag in `sheerluck/sage-on-gentoo-stage4:latest` already is correct, because Dockerfile uses "sage-on-gentoo" overlay. If suddenly we need `sys-devel/bc[foo]` I will go to https://github.com/cschwan/sage-on-gentoo/issues, wait for @kiwifb and then refresh latest image. There is no need to have two conflicting places for USE flags, overlay is enough



---

archive/issue_comments_455880.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nI was referring only to,\n\n> Now configure says \"configure: $ sudo emerge sci-mathematics/eclib[flint]\n\nwhich won't work =)",
    "created_at": "2020-06-19T21:09:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455880",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:49" align="right">comment:49</div>

I was referring only to,

> Now configure says "configure: $ sudo emerge sci-mathematics/eclib[flint]

which won't work =)



---

archive/issue_comments_455881.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nI also thought it won't work but I tried and it works. Maybe there's a bug in portage =)",
    "created_at": "2020-06-19T21:16:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455881",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:50" align="right">comment:50</div>

I also thought it won't work but I tried and it works. Maybe there's a bug in portage =)



---

archive/issue_comments_455882.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nOk, you got me, I had no idea that worked!\n\nIt still won't automatically enable the USE flag if it's not set, you get something like\n\n```\n$ emerge -pv1 sci-mathematics/eclib[flint]\n...\nThe following USE changes are necessary to proceed:\n (see \"package.use\" in the portage(5) man page for more details)\n# required by sci-mathematics/eclib[flint] (argument)\n>=sci-mathematics/eclib-20190909 flint\n```\n\nbut that's fine. It's telling you to do the right thing.",
    "created_at": "2020-06-19T21:35:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455882",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:51" align="right">comment:51</div>

Ok, you got me, I had no idea that worked!

It still won't automatically enable the USE flag if it's not set, you get something like

```
$ emerge -pv1 sci-mathematics/eclib[flint]
...
The following USE changes are necessary to proceed:
 (see "package.use" in the portage(5) man page for more details)
# required by sci-mathematics/eclib[flint] (argument)
>=sci-mathematics/eclib-20190909 flint
```

but that's fine. It's telling you to do the right thing.



---

archive/issue_comments_455883.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nThat's interesting it is basically processed like an atom dependency from an ebuild. It is probably designed so the dependency list can be feed as is to emerge.",
    "created_at": "2020-06-20T01:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455883",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:52" align="right">comment:52</div>

That's interesting it is basically processed like an atom dependency from an ebuild. It is probably designed so the dependency list can be feed as is to emerge.



---

archive/issue_comments_455884.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nhttps://github.com/cschwan/sage-on-gentoo/pull/591\n\nThanks to @kiwifb, today I used the `repoman` for the first time in my life.",
    "created_at": "2020-06-20T12:02:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455884",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:53" align="right">comment:53</div>

https://github.com/cschwan/sage-on-gentoo/pull/591

Thanks to @kiwifb, today I used the `repoman` for the first time in my life.



---

archive/issue_comments_455885.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\n\n```\n will be installed as an SPKG      already installed in latest image\n===============================================================================\n alabaster-0.7.12                  dev-python/alabaster-0.7.12\n appnope-0.1.0.p0                  \n babel-2.6.0                       dev-python/Babel-2.8.0-r1\n backports_abc-0.5                 \n backports_functools_lru_cache-1.5 \n backports_shutil_get_terminal_size\n backports_ssl_match_hostname-3.5.0\n bleach-3.1.0                      dev-python/bleach-3.1.4-r1\n brial-1.2.8                       sci-libs/brial-1.2.8\n certifi-2019.3.9                  dev-python/certifi-2020.4.5.1\n combinatorial_designs-20140630.p0 sci-mathematics/sage-data-combinatorial_designs-20140630\n configparser-3.7.4                \n conway_polynomials-0.5            sci-mathematics/sage-data-conway_polynomials-0.5\n cvxopt-1.2.3                      dev-python/cvxopt-1.2.5-r1\n cycler-0.10.0.p0                  dev-python/cycler-0.10.0-r1\n cypari-2.1.1                      dev-python/cypari2-2.1.1\n cysignals-1.10.2                  dev-python/cysignals-1.10.2\n cython-0.29.17                    dev-python/cython-0.29.19\n dateutil-2.8.1                    \n decorator-4.4.0                   dev-python/decorator-4.4.2\n defusedxml-0.6.0                  \n docutils-0.14                     dev-python/docutils-0.16\n ecl-16.1.2.p5                     dev-lisp/ecls-16.1.2-r1\n elliptic_curves-0.8.1             sci-mathematics/sage-data-elliptic_curves-0.8\n entrypoints-0.3                   dev-python/entrypoints-0.3-r1\n enum34-1.1.6                      \n fpylll-0.5.1dev                   dev-python/fpylll-0.5.1\n functools32-3.2.3-2.p0            \n future-0.17.1                     dev-python/future-0.18.2\n gap-4.10.2.p1                     sci-mathematics/gap-4.10.2-r1\n gc-8.0.4                          \n giac-1.5.0.63-p0                  sci-mathematics/giac-1.5.0.87\n gmpy2-2.1.0b1                     dev-python/gmpy-2.1.0_beta1-r1\n graphs-20161026.p0                sci-mathematics/sage-data-graphs-20161026\n html5lib-1.0.1                    dev-python/html5lib-1.0.1-r2\n imagesize-1.1.0                   dev-python/imagesize-1.1.0\n ipaddress-1.0.22                  \n ipykernel-4.8.2                   dev-python/ipykernel-5.1.4\n ipython-5.8.0                     dev-python/ipython-7.5.0\n ipython_genutils-0.2.0            dev-python/ipython_genutils-0.2.0\n ipywidgets-7.4.2                  dev-python/ipywidgets-7.4.2-r1\n itsdangerous-1.1.0                \n jinja2-2.10                       dev-python/jinja-2.11.1\n jmol-14.29.52                     \n jsonschema-2.6.0                  dev-python/jsonschema-3.0.1\n jupyter_client-5.2.4              dev-python/jupyter_client-5.2.3-r1\n jupyter_core-4.4.0                dev-python/jupyter_core-4.6.1-r1\n kiwisolver-1.0.1                  dev-python/kiwisolver-1.0.1\n libhomfly-1.02r4.p0               sci-libs/libhomfly-1.02.5\n linbox-1.6.3.p0                   sci-libs/linbox-1.6.3\n markupsafe-1.1.0                  dev-python/markupsafe-1.1.1\n mathjax-2.7.4.p0                  dev-libs/mathjax-2.7.7\n matplotlib-3.2.1                  dev-python/matplotlib-3.1.2  (3.2.1 available)\n maxima-5.42.2                     sci-mathematics/maxima-5.42.2\n mistune-0.8.4                     dev-python/mistune-0.8.4\n mpmath-1.1.0                      dev-python/mpmath-1.1.0\n nbconvert-5.4.0                   dev-python/nbconvert-5.2.1 (5.6.1 available)\n nbformat-4.4.0                    dev-python/nbformat-4.4.0-r1\n networkx-2.2                      dev-python/networkx-2.4-r2\n nose-1.3.7                        \n notebook-5.7.6.p0                 dev-python/notebook-5.7.8\n numpy-1.16.6                      dev-python/numpy-1.17.4-r3\n packaging-18.0                    dev-python/packaging-20.3\n palp-2.1.p2                       sci-mathematics/palp-2.11-r1\n pandocfilters-1.4.2               dev-python/pandocfilters-1.4.2-r1\n pathlib2-2.3.3                    \n pathpy-7.1.p0                     dev-python/path-py-12.0.2-r2\n pexpect-4.6.0.p0                  dev-python/pexpect-4.6.0\n pickleshare-0.7.5                 dev-python/pickleshare-0.7.4-r1\n pillow-5.3.0.p0                   dev-python/pillow-7.0.0\n pip-18.1                          \n pkgconfig-1.5.1                   dev-python/pkgconfig-1.5.1\n polytopes_db-20170220.p0          sci-mathematics/sage-data-polytopes_db-20170220\n pplpy-0.8.4                       dev-python/pplpy-0.8.4-r2\n prometheus_client-0.5.0           dev-python/prometheus_client-0.7.1-r1\n prompt_toolkit-1.0.15             dev-python/prompt_toolkit-2.0.10\n psutil-5.2.0.p2                   dev-python/psutil-5.7.0\n ptyprocess-0.5.1.p0               dev-python/ptyprocess-0.6.0\n pycygwin-0.1                      \n pygments-2.3.1.p0                 dev-python/pygments-2.6.1\n pynac-0.7.26.sage-2020-04-03      sci-libs/pynac-0.7.26\n pyparsing-2.3.0                   dev-python/pyparsing-2.4.6\n pytz-2018.7                       dev-python/pytz-2019.3\n pyzmq-19.0.0                      dev-python/pyzmq-19.0.0\n ratpoints-2.1.3.p5                sci-mathematics/ratpoints-2.1.3-r4\n requests-2.13.0                   dev-python/requests-2.23.0\n rpy2-2.8.2.p1                     dev-python/rpy-2.9.0\n rubiks-20070912.p21               \n sage_brial-1.2.8                  dev-python/sage-brial-1.2.8\n sage_conf-none                    \n sagenb_export-3.3                 sci-mathematics/ExportSageNB-3.3\n sagetex-3.4                       \n scandir-1.9.0                     \n scipy-1.2.3                       sci-libs/scipy-1.4.1\n send2trash-1.5.0                  \n setuptools-40.6.3                 dev-python/send2trash-1.5.0-r1\n setuptools_scm-3.1.0              dev-python/setuptools_scm-3.5.0\n simplegeneric-0.8.1.p0            \n singledispatch-3.4.0.3.p0         \n singular-4.1.1p2.p0               sci-mathematics/singular-4.1.1_p2-r2\n six-1.12.0                        dev-python/six-1.14.0\n snowballstemmer-1.2.1.p0          dev-python/snowballstemmer-2.0.0\n sphinx-1.8.5.p0                   dev-python/sphinx-3.0.4\n sphinxcontrib_websupport-1.1.0    \n subprocess32-3.5.3                \n sympy-1.5                         dev-python/sympy-1.5.1-r1\n terminado-0.8.1                   dev-python/terminado-0.8.3\n testpath-0.4.2                    dev-python/testpath-0.3.1\n thebe-9624e0a0.p0                 www-misc/thebe-20160525\n threejs-r110                      media-gfx/threejs-sage-extension-110\n tornado-4.5.2                     www-servers/tornado-6.0.4\n traitlets-4.3.3                   dev-python/traitlets-4.3.2\n typing-3.6.6                      \n vcversioner-2.16.0.0.p0           dev-python/vcversioner-2.16.0.0\n wcwidth-0.1.7.p0                  dev-python/wcwidth-0.1.9\n webencodings-0.5.1                dev-python/webencodings-0.5.1-r1\n werkzeug-0.14.1                   \n widgetsnbextension-3.4.2          dev-python/widgetsnbextension-3.4.2\n zn_poly-0.9.1.p0                  sci-libs/zn_poly-0.9.2\n zope_interface-4.6.0              dev-python/zope-interface-4.7.1     \n\n```",
    "created_at": "2020-06-21T18:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455885",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:54" align="right">comment:54</div>


```
 will be installed as an SPKG      already installed in latest image
===============================================================================
 alabaster-0.7.12                  dev-python/alabaster-0.7.12
 appnope-0.1.0.p0                  
 babel-2.6.0                       dev-python/Babel-2.8.0-r1
 backports_abc-0.5                 
 backports_functools_lru_cache-1.5 
 backports_shutil_get_terminal_size
 backports_ssl_match_hostname-3.5.0
 bleach-3.1.0                      dev-python/bleach-3.1.4-r1
 brial-1.2.8                       sci-libs/brial-1.2.8
 certifi-2019.3.9                  dev-python/certifi-2020.4.5.1
 combinatorial_designs-20140630.p0 sci-mathematics/sage-data-combinatorial_designs-20140630
 configparser-3.7.4                
 conway_polynomials-0.5            sci-mathematics/sage-data-conway_polynomials-0.5
 cvxopt-1.2.3                      dev-python/cvxopt-1.2.5-r1
 cycler-0.10.0.p0                  dev-python/cycler-0.10.0-r1
 cypari-2.1.1                      dev-python/cypari2-2.1.1
 cysignals-1.10.2                  dev-python/cysignals-1.10.2
 cython-0.29.17                    dev-python/cython-0.29.19
 dateutil-2.8.1                    
 decorator-4.4.0                   dev-python/decorator-4.4.2
 defusedxml-0.6.0                  
 docutils-0.14                     dev-python/docutils-0.16
 ecl-16.1.2.p5                     dev-lisp/ecls-16.1.2-r1
 elliptic_curves-0.8.1             sci-mathematics/sage-data-elliptic_curves-0.8
 entrypoints-0.3                   dev-python/entrypoints-0.3-r1
 enum34-1.1.6                      
 fpylll-0.5.1dev                   dev-python/fpylll-0.5.1
 functools32-3.2.3-2.p0            
 future-0.17.1                     dev-python/future-0.18.2
 gap-4.10.2.p1                     sci-mathematics/gap-4.10.2-r1
 gc-8.0.4                          
 giac-1.5.0.63-p0                  sci-mathematics/giac-1.5.0.87
 gmpy2-2.1.0b1                     dev-python/gmpy-2.1.0_beta1-r1
 graphs-20161026.p0                sci-mathematics/sage-data-graphs-20161026
 html5lib-1.0.1                    dev-python/html5lib-1.0.1-r2
 imagesize-1.1.0                   dev-python/imagesize-1.1.0
 ipaddress-1.0.22                  
 ipykernel-4.8.2                   dev-python/ipykernel-5.1.4
 ipython-5.8.0                     dev-python/ipython-7.5.0
 ipython_genutils-0.2.0            dev-python/ipython_genutils-0.2.0
 ipywidgets-7.4.2                  dev-python/ipywidgets-7.4.2-r1
 itsdangerous-1.1.0                
 jinja2-2.10                       dev-python/jinja-2.11.1
 jmol-14.29.52                     
 jsonschema-2.6.0                  dev-python/jsonschema-3.0.1
 jupyter_client-5.2.4              dev-python/jupyter_client-5.2.3-r1
 jupyter_core-4.4.0                dev-python/jupyter_core-4.6.1-r1
 kiwisolver-1.0.1                  dev-python/kiwisolver-1.0.1
 libhomfly-1.02r4.p0               sci-libs/libhomfly-1.02.5
 linbox-1.6.3.p0                   sci-libs/linbox-1.6.3
 markupsafe-1.1.0                  dev-python/markupsafe-1.1.1
 mathjax-2.7.4.p0                  dev-libs/mathjax-2.7.7
 matplotlib-3.2.1                  dev-python/matplotlib-3.1.2  (3.2.1 available)
 maxima-5.42.2                     sci-mathematics/maxima-5.42.2
 mistune-0.8.4                     dev-python/mistune-0.8.4
 mpmath-1.1.0                      dev-python/mpmath-1.1.0
 nbconvert-5.4.0                   dev-python/nbconvert-5.2.1 (5.6.1 available)
 nbformat-4.4.0                    dev-python/nbformat-4.4.0-r1
 networkx-2.2                      dev-python/networkx-2.4-r2
 nose-1.3.7                        
 notebook-5.7.6.p0                 dev-python/notebook-5.7.8
 numpy-1.16.6                      dev-python/numpy-1.17.4-r3
 packaging-18.0                    dev-python/packaging-20.3
 palp-2.1.p2                       sci-mathematics/palp-2.11-r1
 pandocfilters-1.4.2               dev-python/pandocfilters-1.4.2-r1
 pathlib2-2.3.3                    
 pathpy-7.1.p0                     dev-python/path-py-12.0.2-r2
 pexpect-4.6.0.p0                  dev-python/pexpect-4.6.0
 pickleshare-0.7.5                 dev-python/pickleshare-0.7.4-r1
 pillow-5.3.0.p0                   dev-python/pillow-7.0.0
 pip-18.1                          
 pkgconfig-1.5.1                   dev-python/pkgconfig-1.5.1
 polytopes_db-20170220.p0          sci-mathematics/sage-data-polytopes_db-20170220
 pplpy-0.8.4                       dev-python/pplpy-0.8.4-r2
 prometheus_client-0.5.0           dev-python/prometheus_client-0.7.1-r1
 prompt_toolkit-1.0.15             dev-python/prompt_toolkit-2.0.10
 psutil-5.2.0.p2                   dev-python/psutil-5.7.0
 ptyprocess-0.5.1.p0               dev-python/ptyprocess-0.6.0
 pycygwin-0.1                      
 pygments-2.3.1.p0                 dev-python/pygments-2.6.1
 pynac-0.7.26.sage-2020-04-03      sci-libs/pynac-0.7.26
 pyparsing-2.3.0                   dev-python/pyparsing-2.4.6
 pytz-2018.7                       dev-python/pytz-2019.3
 pyzmq-19.0.0                      dev-python/pyzmq-19.0.0
 ratpoints-2.1.3.p5                sci-mathematics/ratpoints-2.1.3-r4
 requests-2.13.0                   dev-python/requests-2.23.0
 rpy2-2.8.2.p1                     dev-python/rpy-2.9.0
 rubiks-20070912.p21               
 sage_brial-1.2.8                  dev-python/sage-brial-1.2.8
 sage_conf-none                    
 sagenb_export-3.3                 sci-mathematics/ExportSageNB-3.3
 sagetex-3.4                       
 scandir-1.9.0                     
 scipy-1.2.3                       sci-libs/scipy-1.4.1
 send2trash-1.5.0                  
 setuptools-40.6.3                 dev-python/send2trash-1.5.0-r1
 setuptools_scm-3.1.0              dev-python/setuptools_scm-3.5.0
 simplegeneric-0.8.1.p0            
 singledispatch-3.4.0.3.p0         
 singular-4.1.1p2.p0               sci-mathematics/singular-4.1.1_p2-r2
 six-1.12.0                        dev-python/six-1.14.0
 snowballstemmer-1.2.1.p0          dev-python/snowballstemmer-2.0.0
 sphinx-1.8.5.p0                   dev-python/sphinx-3.0.4
 sphinxcontrib_websupport-1.1.0    
 subprocess32-3.5.3                
 sympy-1.5                         dev-python/sympy-1.5.1-r1
 terminado-0.8.1                   dev-python/terminado-0.8.3
 testpath-0.4.2                    dev-python/testpath-0.3.1
 thebe-9624e0a0.p0                 www-misc/thebe-20160525
 threejs-r110                      media-gfx/threejs-sage-extension-110
 tornado-4.5.2                     www-servers/tornado-6.0.4
 traitlets-4.3.3                   dev-python/traitlets-4.3.2
 typing-3.6.6                      
 vcversioner-2.16.0.0.p0           dev-python/vcversioner-2.16.0.0
 wcwidth-0.1.7.p0                  dev-python/wcwidth-0.1.9
 webencodings-0.5.1                dev-python/webencodings-0.5.1-r1
 werkzeug-0.14.1                   
 widgetsnbextension-3.4.2          dev-python/widgetsnbextension-3.4.2
 zn_poly-0.9.1.p0                  sci-libs/zn_poly-0.9.2
 zope_interface-4.6.0              dev-python/zope-interface-4.7.1     

```



---

archive/issue_comments_455886.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\n\n```\n$ docker run -it sheerluck/sage-on-gentoo-stage4 /bin/bash\n# python -c 'import sys, pkgutil; sys.exit(0 if pkgutil.find_loader(\"notinstalled\") else 1)'\n# echo $?\n1\n# python -c 'import sys, pkgutil; sys.exit(0 if pkgutil.find_loader(\"fpylll\") else 1)'\n# echo $?\n0\n# python -c 'import sys, pkgutil; sys.exit(0 if pkgutil.find_loader(\"numpy\") else 1)'\n# echo $?\n0\n```",
    "created_at": "2020-06-22T07:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455886",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:55" align="right">comment:55</div>


```
$ docker run -it sheerluck/sage-on-gentoo-stage4 /bin/bash
# python -c 'import sys, pkgutil; sys.exit(0 if pkgutil.find_loader("notinstalled") else 1)'
# echo $?
1
# python -c 'import sys, pkgutil; sys.exit(0 if pkgutil.find_loader("fpylll") else 1)'
# echo $?
0
# python -c 'import sys, pkgutil; sys.exit(0 if pkgutil.find_loader("numpy") else 1)'
# echo $?
0
```



---

archive/issue_comments_455887.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nI read `m4/sage_spkg_configure.m4` and created `build/pkgs/numpy/spkg-configure.m4`\n\n```\nSAGE_SPKG_CONFIGURE([numpy], [\n    if build/bin/sage-system-python -c 'import pkgutil; exit(not pkgutil.find_loader(\"numpy\"))'; then\n      sage_spkg_install_numpy=no\n    else\n      sage_spkg_install_numpy=yes\n    fi  \n    if test x$sage_spkg_install_numpy = xyes; then\n      AC_MSG_RESULT([using Sage's numpy SPKG])\n    else\n      AC_MSG_RESULT([using numpy library from the system])\n    fi  \n])\n```\nand `tox -e docker-gentoo-standard` shows\n\n```\n-----------------------------------------------------------------------------\nChecking whether SageMath should install SPKG numpy...\nusing numpy library from the system\nconfigure: will use system package and not install SPKG numpy\n-----------------------------------------------------------------------------\n...\nnumpy-1.16.6:                using system package; SPKG will not be installed\n```\n\nI can copy and paste that `spkg-configure.m4` for all `dev-python/*` packages\nfrom the list above. What do you think? Should I proceed?",
    "created_at": "2020-06-22T15:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455887",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:56" align="right">comment:56</div>

I read `m4/sage_spkg_configure.m4` and created `build/pkgs/numpy/spkg-configure.m4`

```
SAGE_SPKG_CONFIGURE([numpy], [
    if build/bin/sage-system-python -c 'import pkgutil; exit(not pkgutil.find_loader("numpy"))'; then
      sage_spkg_install_numpy=no
    else
      sage_spkg_install_numpy=yes
    fi  
    if test x$sage_spkg_install_numpy = xyes; then
      AC_MSG_RESULT([using Sage's numpy SPKG])
    else
      AC_MSG_RESULT([using numpy library from the system])
    fi  
])
```
and `tox -e docker-gentoo-standard` shows

```
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG numpy...
using numpy library from the system
configure: will use system package and not install SPKG numpy
-----------------------------------------------------------------------------
...
numpy-1.16.6:                using system package; SPKG will not be installed
```

I can copy and paste that `spkg-configure.m4` for all `dev-python/*` packages
from the list above. What do you think? Should I proceed?



---

archive/issue_comments_455888.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nPlease don't. Sage-the-distribution does not use the system Python's site packages. We have a ticket for future work on that: #29023. It will definitely NOT go through spkg-configure.m4.",
    "created_at": "2020-06-22T16:19:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455888",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:57" align="right">comment:57</div>

Please don't. Sage-the-distribution does not use the system Python's site packages. We have a ticket for future work on that: #29023. It will definitely NOT go through spkg-configure.m4.



---

archive/issue_comments_455889.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nWhat's the status of the current branch? Is it ready for testing?",
    "created_at": "2020-06-22T16:21:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455889",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

What's the status of the current branch? Is it ready for testing?



---

archive/issue_comments_455890.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nIt is ready",
    "created_at": "2020-06-22T16:25:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455890",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:59" align="right">comment:59</div>

It is ready



---

archive/issue_comments_455891.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nAdd author name please and set to \"needs_review\" then",
    "created_at": "2020-06-22T17:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455891",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

Add author name please and set to "needs_review" then



---

archive/issue_comments_455892.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nAlso, could you edit `.github/workflows/tox.yml` and `tox-optional.yml`, adding `gentoo` to the list of tested systems?",
    "created_at": "2020-06-22T17:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455892",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:61" align="right">comment:61</div>

Also, could you edit `.github/workflows/tox.yml` and `tox-optional.yml`, adding `gentoo` to the list of tested systems?



---

archive/issue_comments_455893.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314\"><code>9959ee9</code></a></td><td><code>tox_system_factor: gentoo</code></td></tr></table>\n",
    "created_at": "2020-06-22T18:41:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455893",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314"><code>9959ee9</code></a></td><td><code>tox_system_factor: gentoo</code></td></tr></table>




---

archive/issue_comments_455894.json:
```json
{
    "body": "Changed commit from **[`c55cfa9`](https://github.com/sagemath/sagetrac-mirror/commit/c55cfa9bd2d0d29df3cd5cc24be5b743eee8aadf)** to **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)**",
    "created_at": "2020-06-22T18:41:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455894",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c55cfa9`](https://github.com/sagemath/sagetrac-mirror/commit/c55cfa9bd2d0d29df3cd5cc24be5b743eee8aadf)** to **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)**



---

archive/issue_events_397034.json:
```json
{
    "actor": "https://github.com/sheerluck",
    "created_at": "2020-06-22T18:43:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397034"
}
```



---

archive/issue_comments_455895.json:
```json
{
    "body": "Author: **gh-sheerluck**",
    "created_at": "2020-06-22T18:43:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455895",
    "user": "https://github.com/sheerluck"
}
```

Author: **gh-sheerluck**



---

archive/issue_comments_455896.json:
```json
{
    "body": "Reviewer: **Matthias Koeppe**",
    "created_at": "2020-06-22T18:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455896",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Matthias Koeppe**



---

archive/issue_comments_455897.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nTests run at https://github.com/mkoeppe/sage/actions/runs/144060041\nand https://github.com/mkoeppe/sage/actions/runs/144060039",
    "created_at": "2020-06-22T20:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455897",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:65" align="right">comment:65</div>

Tests run at https://github.com/mkoeppe/sage/actions/runs/144060041
and https://github.com/mkoeppe/sage/actions/runs/144060039



---

archive/issue_comments_455898.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nCould you update the ticket description so that it matches what is implemented?",
    "created_at": "2020-06-22T20:17:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455898",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:66" align="right">comment:66</div>

Could you update the ticket description so that it matches what is implemented?



---

archive/issue_comments_455899.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nI have hard time describing `git diff 9.2.beta1..u/gh-sheerluck/gentoo` , not much was implemented, most of the work is in https://github.com/sheerluck/sage-on-gentoo-stage4",
    "created_at": "2020-06-22T20:55:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455899",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:67" align="right">comment:67</div>

I have hard time describing `git diff 9.2.beta1..u/gh-sheerluck/gentoo` , not much was implemented, most of the work is in https://github.com/sheerluck/sage-on-gentoo-stage4



---

archive/issue_comments_455900.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nIt would be enough to just update the sentence starting with \"In this ticket,\"",
    "created_at": "2020-06-22T20:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455900",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">comment:68</div>

It would be enough to just update the sentence starting with "In this ticket,"



---

archive/issue_comments_455901.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nMy mistake was I tried only `tox -e docker-gentoo-standard`\n\nI never tried \n\n`tox -e docker-gentoo-minimal -- build doc-html ptest`\n\n`tox -e docker-gentoo-standard -- build doc-html ptest`\n\n`tox -e docker-gentoo-maximal -- build doc-html ptest`\n\nI'm working on it",
    "created_at": "2020-06-23T09:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455901",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:69" align="right">comment:69</div>

My mistake was I tried only `tox -e docker-gentoo-standard`

I never tried 

`tox -e docker-gentoo-minimal -- build doc-html ptest`

`tox -e docker-gentoo-standard -- build doc-html ptest`

`tox -e docker-gentoo-maximal -- build doc-html ptest`

I'm working on it



---

archive/issue_events_397035.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-23T17:29:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397035"
}
```



---

archive/issue_events_397036.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-23T17:29:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397036"
}
```



---

archive/issue_comments_455902.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nPrevious error was due `tachyon` package, latest image is fixed: SPKG version will be used.\n\nBoth `docker-gentoo-minimal` and `docker-gentoo-maximal` commands failed same way:\n\n```\nsage -t src/sage/lfunctions/dokchitser.py  # 2 doctests failed\nsage -t src/sage/lfunctions/pari.py  # 1 doctest failed\nsage -t src/sage/libs/glpk/error.pyx  # 1 doctest failed\nsage -t src/sage/numerical/backends/glpk_backend.pyx  # 1 doctest failed\nsage -t src/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed\nsage -t src/sage/rings/number_field/number_field_ideal.py  # 2 doctests failed\nsage -t src/sage/rings/number_field/number_field.py  # 7 doctests failed\nsage -t src/sage/rings/number_field/unit_group.py  # 1 doctest failed\nsage -t src/sage/rings/polynomial/polynomial_quotient_ring.py  # 2 doctests failed\nsage -t src/sage/schemes/elliptic_curves/ell_number_field.py  # 2 doctests failed\n```",
    "created_at": "2020-06-24T13:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455902",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:71" align="right">comment:71</div>

Previous error was due `tachyon` package, latest image is fixed: SPKG version will be used.

Both `docker-gentoo-minimal` and `docker-gentoo-maximal` commands failed same way:

```
sage -t src/sage/lfunctions/dokchitser.py  # 2 doctests failed
sage -t src/sage/lfunctions/pari.py  # 1 doctest failed
sage -t src/sage/libs/glpk/error.pyx  # 1 doctest failed
sage -t src/sage/numerical/backends/glpk_backend.pyx  # 1 doctest failed
sage -t src/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed
sage -t src/sage/rings/number_field/number_field_ideal.py  # 2 doctests failed
sage -t src/sage/rings/number_field/number_field.py  # 7 doctests failed
sage -t src/sage/rings/number_field/unit_group.py  # 1 doctest failed
sage -t src/sage/rings/polynomial/polynomial_quotient_ring.py  # 2 doctests failed
sage -t src/sage/schemes/elliptic_curves/ell_number_field.py  # 2 doctests failed
```



---

archive/issue_events_397037.json:
```json
{
    "actor": "https://github.com/sheerluck",
    "created_at": "2020-06-24T13:19:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397037"
}
```



---

archive/issue_events_397038.json:
```json
{
    "actor": "https://github.com/sheerluck",
    "created_at": "2020-06-24T13:19:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397038"
}
```



---

archive/issue_comments_455903.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nTests run at https://github.com/mkoeppe/sage/actions/runs/146222291 and https://github.com/mkoeppe/sage/actions/runs/146222283",
    "created_at": "2020-06-24T18:53:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455903",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:73" align="right">comment:73</div>

Tests run at https://github.com/mkoeppe/sage/actions/runs/146222291 and https://github.com/mkoeppe/sage/actions/runs/146222283



---

archive/issue_comments_455904.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n-As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we are adding files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages in #29273.\n+As a followup to #29053 and #29273, we\n+- extend `build/bin/write-dockerfile` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4\n+- add `build/pkgs/gentoo*.txt`\n+- extend `bin/sage-print-system-package-command` to handle gentoo\n+- add gentoo to the platforms tested in [GitHub](../wiki/GitHub) CI.\n \n-In this ticket, \n-- we extend `build/bin/write-dockerfile` to \n-   - generate a Dockerfile using https://hub.docker.com/r/gentoo/stage3-amd64/tags\n-   - generate a Dockerfile for a gentoo \"prefix\" build on top of some Linux distribution\n-  for rigorous multi-platform testing.\n+To test: `tox -e docker-gentoo-standard`\n \n This is a part of:\n - #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages\n``````\n",
    "created_at": "2020-06-24T19:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455904",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
-As a followup to #29053, in analogy to the work done for debian/fedora/arch/conda, we are adding files `build/pkgs/SPKG/distros/gentoo.txt` to keep track of equivalent distribution packages in #29273.
+As a followup to #29053 and #29273, we
+- extend `build/bin/write-dockerfile` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4
+- add `build/pkgs/gentoo*.txt`
+- extend `bin/sage-print-system-package-command` to handle gentoo
+- add gentoo to the platforms tested in [GitHub](../wiki/GitHub) CI.
 
-In this ticket, 
-- we extend `build/bin/write-dockerfile` to 
-   - generate a Dockerfile using https://hub.docker.com/r/gentoo/stage3-amd64/tags
-   - generate a Dockerfile for a gentoo "prefix" build on top of some Linux distribution
-  for rigorous multi-platform testing.
+To test: `tox -e docker-gentoo-standard`
 
 This is a part of:
 - #29060: Meta-ticket: Add Dockerfiles and CI scripts for integration testing of source and binary distributions and of downstream packages
``````




---

archive/issue_comments_455905.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n As a followup to #29053 and #29273, we\n-- extend `build/bin/write-dockerfile` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4\n+- extend `build/bin/write-dockerfile.sh` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4\n - add `build/pkgs/gentoo*.txt`\n - extend `bin/sage-print-system-package-command` to handle gentoo\n - add gentoo to the platforms tested in [GitHub](../wiki/GitHub) CI.\n``````\n",
    "created_at": "2020-06-24T19:03:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455905",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 As a followup to #29053 and #29273, we
-- extend `build/bin/write-dockerfile` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4
+- extend `build/bin/write-dockerfile.sh` to generate a Dockerfile using https://hub.docker.com/r/sheerluck/sage-on-gentoo-stage4
 - add `build/pkgs/gentoo*.txt`
 - extend `bin/sage-print-system-package-command` to handle gentoo
 - add gentoo to the platforms tested in [GitHub](../wiki/GitHub) CI.
``````




---

archive/issue_events_397039.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T19:03:02Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "title_is": "tox.ini, build/bin/write-dockerfile.sh: Add gentoo linux, add more gentoo packages",
    "title_was": "Extend dockerfile generator to gentoo, add more gentoo packages",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397039"
}
```



---

archive/issue_events_397040.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-25T05:58:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397040"
}
```



---

archive/issue_events_397041.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-25T05:58:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397041"
}
```



---

archive/issue_comments_455906.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nLooking great, thanks for this contribution. Would you mind setting \"Authors\" to a real name?",
    "created_at": "2020-06-25T05:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455906",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:76" align="right">comment:76</div>

Looking great, thanks for this contribution. Would you mind setting "Authors" to a real name?



---

archive/issue_comments_455907.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nNext week in addition to existing `Dockerfile_gentoo-20.06-gcc9-py37`\n\nI plan to make\n\n`Dockerfile_gentoo-20.07-gcc9-py37` (with tags `20.07` and `latest`)\n\n`Dockerfile_gentoo-20.07-gcc9-py38` (with tags `py38-20.07` and `py38-latest`)\n\nAnd maybe even\n\n`Dockerfile_gentoo-20.07-clang10-py37`\n\n`Dockerfile_gentoo-20.07-clang10-py38`\n\ngcc-10 is not ready for this kind of fun yet",
    "created_at": "2020-06-25T06:32:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455907",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:77" align="right">comment:77</div>

Next week in addition to existing `Dockerfile_gentoo-20.06-gcc9-py37`

I plan to make

`Dockerfile_gentoo-20.07-gcc9-py37` (with tags `20.07` and `latest`)

`Dockerfile_gentoo-20.07-gcc9-py38` (with tags `py38-20.07` and `py38-latest`)

And maybe even

`Dockerfile_gentoo-20.07-clang10-py37`

`Dockerfile_gentoo-20.07-clang10-py38`

gcc-10 is not ready for this kind of fun yet



---

archive/issue_comments_455908.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nauthor name should be Full Real Name, please !",
    "created_at": "2020-06-25T13:43:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455908",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:78" align="right">comment:78</div>

author name should be Full Real Name, please !



---

archive/issue_comments_455909.json:
```json
{
    "body": "Changed author from **gh-sheerluck** to **Fran\u00e7ois Bissey**",
    "created_at": "2020-06-25T18:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455909",
    "user": "https://github.com/sheerluck"
}
```

Changed author from **gh-sheerluck** to **François Bissey**



---

archive/issue_comments_455910.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nplot twist?",
    "created_at": "2020-06-25T18:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455910",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:80" align="right">comment:80</div>

plot twist?



---

archive/issue_comments_455911.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nI didn't author any of these. I cannot claim responsibility. If you don't want your name to be published, say so and we may find something.",
    "created_at": "2020-06-25T20:08:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455911",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:81" align="right">comment:81</div>

I didn't author any of these. I cannot claim responsibility. If you don't want your name to be published, say so and we may find something.



---

archive/issue_comments_455912.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nI don't want my name to be published",
    "created_at": "2020-06-25T20:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455912",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:82" align="right">comment:82</div>

I don't want my name to be published



---

archive/issue_comments_455913.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nIn github, your are \"Andrew\" from Belgorod, Russia. What's your exact problem with our rule that contributors should give their full real name ?",
    "created_at": "2020-06-25T20:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455913",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:83" align="right">comment:83</div>

In github, your are "Andrew" from Belgorod, Russia. What's your exact problem with our rule that contributors should give their full real name ?



---

archive/issue_comments_455914.json:
```json
{
    "body": "Changed author from **Fran\u00e7ois Bissey** to **Andrey Belgorodski**",
    "created_at": "2020-06-25T22:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455914",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **François Bissey** to **Andrey Belgorodski**



---

archive/issue_events_397042.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-06-27T09:26:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397042"
}
```



---

archive/issue_events_397043.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4896a87888023a5d7b7a9908eb619cfe20b59567",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-06-27T09:26:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29105#event-397043"
}
```



---

archive/issue_comments_455915.json:
```json
{
    "body": "Changed branch from **[u/gh-sheerluck/gentoo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-sheerluck/gentoo)** to **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)**",
    "created_at": "2020-06-27T09:26:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455915",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-sheerluck/gentoo](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-sheerluck/gentoo)** to **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)**



---

archive/issue_comments_455916.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nWhat\u2019s New in `sheerluck/sage-on-gentoo-stage4:20.7`\n\n```\n1) base image:\n   FROM gentoo/portage:20200701 as portage\n   FROM gentoo/stage3-amd64:20200701\n\n2) python compiled with sqlite support\n   (fixes ModuleNotFoundError: No module named 'sqlite3')\n\n3) updates:\n   pandoc             2.9.2.1 -> 2.10 \n   sci-libs/amd       2.3.1   -> 2.4.6\n   sci-libs/cholmod   2.1.2   -> 3.0.13\n   sci-libs/colamd    2.8.0   -> 2.9.6\n   sci-libs/openblas  0.3.9   -> 0.3.9-r1\n   dev-lang/perl      5.30.1  -> 5.30.3\n   dev-lang/R         4.0.0   -> 4.0.2\n   sci-libs/umfpack   5.6.2   -> 5.7.9 \n```\nwith `latest` image only 1 doctest failed: combinat/cluster_algebra_quiver/quiver.py",
    "created_at": "2020-07-02T17:07:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455916",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:86" align="right">comment:86</div>

What’s New in `sheerluck/sage-on-gentoo-stage4:20.7`

```
1) base image:
   FROM gentoo/portage:20200701 as portage
   FROM gentoo/stage3-amd64:20200701

2) python compiled with sqlite support
   (fixes ModuleNotFoundError: No module named 'sqlite3')

3) updates:
   pandoc             2.9.2.1 -> 2.10 
   sci-libs/amd       2.3.1   -> 2.4.6
   sci-libs/cholmod   2.1.2   -> 3.0.13
   sci-libs/colamd    2.8.0   -> 2.9.6
   sci-libs/openblas  0.3.9   -> 0.3.9-r1
   dev-lang/perl      5.30.1  -> 5.30.3
   dev-lang/R         4.0.0   -> 4.0.2
   sci-libs/umfpack   5.6.2   -> 5.7.9 
```
with `latest` image only 1 doctest failed: combinat/cluster_algebra_quiver/quiver.py



---

archive/issue_comments_455917.json:
```json
{
    "body": "Changed commit from **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)** to none",
    "created_at": "2020-07-02T17:07:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455917",
    "user": "https://github.com/sheerluck"
}
```

Changed commit from **[`9959ee9`](https://github.com/sagemath/sagetrac-mirror/commit/9959ee996823a796140a70e6b3ee16d45d7b1314)** to none



---

archive/issue_comments_455918.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nGreat! I am assuming no change to tox.ini is required?",
    "created_at": "2020-07-02T22:38:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455918",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:87" align="right">comment:87</div>

Great! I am assuming no change to tox.ini is required?



---

archive/issue_comments_455919.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nno changes",
    "created_at": "2020-07-03T05:32:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455919",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:88" align="right">comment:88</div>

no changes



---

archive/issue_comments_455920.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nLast error from https://github.com/mkoeppe/sage/actions, namely this one: \n\n```\nIt might be possible to solve this slot collision\nby applying all of the following changes:\n   - sci-libs/m4ri-20200125 (Change USE: +png)\n   - sci-libs/brial-1.2.8 (Change USE: +png)\n\nThe following USE changes are necessary to proceed:\n (see \"package.use\" in the portage(5) man page for more details)\n# required by sci-libs/brial-1.2.8::sage-on-gentoo\n# required by sci-libs/brial (argument)\n>=sci-libs/m4ri-20200125 -png \n```\nis solved with `png` for `sci-libs/brial` in `latest` image\n\n(checked on `u/mkoeppe/fix_tox_docker_builds_broken_by__29884`)",
    "created_at": "2020-07-06T11:02:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455920",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:89" align="right">comment:89</div>

Last error from https://github.com/mkoeppe/sage/actions, namely this one: 

```
It might be possible to solve this slot collision
by applying all of the following changes:
   - sci-libs/m4ri-20200125 (Change USE: +png)
   - sci-libs/brial-1.2.8 (Change USE: +png)

The following USE changes are necessary to proceed:
 (see "package.use" in the portage(5) man page for more details)
# required by sci-libs/brial-1.2.8::sage-on-gentoo
# required by sci-libs/brial (argument)
>=sci-libs/m4ri-20200125 -png 
```
is solved with `png` for `sci-libs/brial` in `latest` image

(checked on `u/mkoeppe/fix_tox_docker_builds_broken_by__29884`)



---

archive/issue_comments_455921.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\n\n```\n-----------------\nAll tests passed!\n-----------------\n____ summary ____\ndocker-gentoo-standard: commands succeeded\ncongratulations :)\n```",
    "created_at": "2020-07-06T19:15:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455921",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:90" align="right">comment:90</div>


```
-----------------
All tests passed!
-----------------
____ summary ____
docker-gentoo-standard: commands succeeded
congratulations :)
```



---

archive/issue_comments_455922.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nI've created `latest-gcc10` in addition to\u2002`latest`. For fun. \n\n```\n version in            latest         latest-gcc10\n====================================================\n sys-devel/gcc         9.3.0          10.1.0-r2\n sci-libs/arpack       3.1.5          3.5.0\n sci-mathematics/gp2c  0.0.11.2-r1    0.0.11.3\n app-misc/rlwrap       0.42           0.43\n```\n\nBut `tox -e docker-gentoo-gcc10-maximal -- build doc-html doc-pdf ptest` says \n\n```\nchecking gcc version... 10.1.0\nchecking g++ version... 10.1.0\nconfigure: Installing GCC because g++ -std=gnu++11 is g++ version 10.1.0, which is too recent for this version of Sage \nconfigure: no suitable system package found for SPKG gcc\n```\n\nSage is not ready for gcc10 yet...\n\nbut if anyone wants to play with `latest-gcc10` it's available on hub.docker.com",
    "created_at": "2020-07-12T10:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455922",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:91" align="right">comment:91</div>

I've created `latest-gcc10` in addition to `latest`. For fun. 

```
 version in            latest         latest-gcc10
====================================================
 sys-devel/gcc         9.3.0          10.1.0-r2
 sci-libs/arpack       3.1.5          3.5.0
 sci-mathematics/gp2c  0.0.11.2-r1    0.0.11.3
 app-misc/rlwrap       0.42           0.43
```

But `tox -e docker-gentoo-gcc10-maximal -- build doc-html doc-pdf ptest` says 

```
checking gcc version... 10.1.0
checking g++ version... 10.1.0
configure: Installing GCC because g++ -std=gnu++11 is g++ version 10.1.0, which is too recent for this version of Sage 
configure: no suitable system package found for SPKG gcc
```

Sage is not ready for gcc10 yet...

but if anyone wants to play with `latest-gcc10` it's available on hub.docker.com



---

archive/issue_comments_455923.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nThanks. A related latest annoyance is that on macOS Homebrew provides gcc package, which is gcc-10, and this breaks things (even though only gfortran is used, not gcc).",
    "created_at": "2020-07-12T10:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455923",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:92" align="right">comment:92</div>

Thanks. A related latest annoyance is that on macOS Homebrew provides gcc package, which is gcc-10, and this breaks things (even though only gfortran is used, not gcc).



---

archive/issue_comments_455924.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nWhat\u2019s New in `sheerluck/sage-on-gentoo-stage4:20.8`\n\n```\n1) base image:\n   FROM gentoo/portage:20200801 as portage\n   FROM gentoo/stage3-amd64:20200801\n\n2) updates:\n   arb                2.16.0  -> 2.18.0\n   arpack             3.1.5   -> 3.5.0\n   cython             0.29.19 -> 0.29.21 \n   flint              2.5.2   -> 2.6.0\n   fplll              5.3.2   -> 5.3.3\n   gp2c               0.11.2  -> 0.11.3\n   ipython            7.5.0   -> 7.16.1\n   matplotlib         3.1.2   -> 3.2.2\n   numpy              1.17.4  -> 1.19.1\n   pandas             1.0.1   -> 1.0.5\n   pandoc             2.10    -> 2.10.1\n   pillow             7.0.0   -> 7.1.2\n   python             3.7.7   -> 3.7.8\n   scipy              1.4.1   -> 1.5.2 \n   sqlite             3.31.1  -> 3.32.3\n```\nno changes to tox.ini is required",
    "created_at": "2020-08-01T19:26:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455924",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:93" align="right">comment:93</div>

What’s New in `sheerluck/sage-on-gentoo-stage4:20.8`

```
1) base image:
   FROM gentoo/portage:20200801 as portage
   FROM gentoo/stage3-amd64:20200801

2) updates:
   arb                2.16.0  -> 2.18.0
   arpack             3.1.5   -> 3.5.0
   cython             0.29.19 -> 0.29.21 
   flint              2.5.2   -> 2.6.0
   fplll              5.3.2   -> 5.3.3
   gp2c               0.11.2  -> 0.11.3
   ipython            7.5.0   -> 7.16.1
   matplotlib         3.1.2   -> 3.2.2
   numpy              1.17.4  -> 1.19.1
   pandas             1.0.1   -> 1.0.5
   pandoc             2.10    -> 2.10.1
   pillow             7.0.0   -> 7.1.2
   python             3.7.7   -> 3.7.8
   scipy              1.4.1   -> 1.5.2 
   sqlite             3.31.1  -> 3.32.3
```
no changes to tox.ini is required



---

archive/issue_comments_455925.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nGood news, everyone!\nWe used one `latest` image, now we have two images:\n* `latest` with python-3.8.5\n* `latest-py37` with python-3.7.8\n\n\n```\nchecking ... whether /usr/bin/python3 is good... no, Python 3.8.5 is too recent\n```\n\nno changes to tox.ini is required, unless we want to be prepared for #29023 when most of installed packages would be used, in that case we can have both \"gentoo\" and \"gentoo-py37\" in tox.ini",
    "created_at": "2020-08-04T17:22:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455925",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:94" align="right">comment:94</div>

Good news, everyone!
We used one `latest` image, now we have two images:
* `latest` with python-3.8.5
* `latest-py37` with python-3.7.8


```
checking ... whether /usr/bin/python3 is good... no, Python 3.8.5 is too recent
```

no changes to tox.ini is required, unless we want to be prepared for #29023 when most of installed packages would be used, in that case we can have both "gentoo" and "gentoo-py37" in tox.ini



---

archive/issue_comments_455926.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nGreat! You may want to test with #27754, which aims for Python 3.8 compatibility",
    "created_at": "2020-08-04T17:25:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455926",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:95" align="right">comment:95</div>

Great! You may want to test with #27754, which aims for Python 3.8 compatibility



---

archive/issue_comments_455927.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nFor the record sage-on-gentoo enables building with python 3.8 since 9.2.beta7. Building of the documentation with it may currently be failing though (but I managed a build between beta6 and beta7 somehow).",
    "created_at": "2020-08-04T21:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455927",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:96" align="right">comment:96</div>

For the record sage-on-gentoo enables building with python 3.8 since 9.2.beta7. Building of the documentation with it may currently be failing though (but I managed a build between beta6 and beta7 somehow).



---

archive/issue_comments_455928.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nSage is ready for gcc-10, so...\n\nWhat\u2019s New in `sheerluck/sage-on-gentoo-stage4:20.9`\n\n```\n1) base image:\n   FROM gentoo/portage:20200901 as portage\n   FROM gentoo/stage3-amd64:20200901\n\n2) gcc-10 + python-3.8.5\n\n3) updates:\n   arb                2.18.0  -> 2.18.1\n   flint              2.6.0   -> 2.6.3\n   glibc              2.30-r8 -> 2.31-r6\n   libhomfly          1.02.5  -> 1.02.6\n   matplotlib         3.2.2   -> 3.3.1\n   mpfr               4.0.2   -> 4.1.0\n   sphinx             3.1.2   -> 3.2.1\n```\nno changes to tox.ini are required",
    "created_at": "2020-09-01T18:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455928",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:97" align="right">comment:97</div>

Sage is ready for gcc-10, so...

What’s New in `sheerluck/sage-on-gentoo-stage4:20.9`

```
1) base image:
   FROM gentoo/portage:20200901 as portage
   FROM gentoo/stage3-amd64:20200901

2) gcc-10 + python-3.8.5

3) updates:
   arb                2.18.0  -> 2.18.1
   flint              2.6.0   -> 2.6.3
   glibc              2.30-r8 -> 2.31-r6
   libhomfly          1.02.5  -> 1.02.6
   matplotlib         3.2.2   -> 3.3.1
   mpfr               4.0.2   -> 4.1.0
   sphinx             3.1.2   -> 3.2.1
```
no changes to tox.ini are required



---

archive/issue_comments_455929.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nWhat\u2019s New in `sheerluck/sage-on-gentoo-stage4:20.10`\n\n```\n1) base image:\n   FROM gentoo/portage:20201001 as portage\n   FROM gentoo/stage3:20201001\n\n2) gcc-10 + python-3.8.6\n\n3) updates:\n   arpack-3.7.0       new\n   tox-3.19.0         new\n   brial              1.2.8   -> 1.2.9\n   gmpy-2.1.0         b1-r1   -> b5\n   guile              2.2.4   -> 2.2.6\n   ipython            7.16.1  -> 7.17.0\n   sqlite             3.32.3  -> 3.33.0\n   swig               3.0.12  -> 4.0.0\n```\n\n`sheerluck/sage-on-gentoo-stage4:20.10-py37` is the same, only \n\n```\n2) gcc-9 + python-3.7.9\n```",
    "created_at": "2020-10-02T07:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455929",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:98" align="right">comment:98</div>

What’s New in `sheerluck/sage-on-gentoo-stage4:20.10`

```
1) base image:
   FROM gentoo/portage:20201001 as portage
   FROM gentoo/stage3:20201001

2) gcc-10 + python-3.8.6

3) updates:
   arpack-3.7.0       new
   tox-3.19.0         new
   brial              1.2.8   -> 1.2.9
   gmpy-2.1.0         b1-r1   -> b5
   guile              2.2.4   -> 2.2.6
   ipython            7.16.1  -> 7.17.0
   sqlite             3.32.3  -> 3.33.0
   swig               3.0.12  -> 4.0.0
```

`sheerluck/sage-on-gentoo-stage4:20.10-py37` is the same, only 

```
2) gcc-9 + python-3.7.9
```



---

archive/issue_comments_455930.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nPlease mask `brial-1.2.9` there are issues with it and it will be replaced by 1.2.10 in short order.",
    "created_at": "2020-10-02T07:38:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455930",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:99" align="right">comment:99</div>

Please mask `brial-1.2.9` there are issues with it and it will be replaced by 1.2.10 in short order.



---

archive/issue_comments_455931.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nmasked, downgraded, squashed, tested, pushed",
    "created_at": "2020-10-02T11:21:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455931",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:0" align="right">comment:0</div>

masked, downgraded, squashed, tested, pushed



---

archive/issue_comments_455932.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n\n```\nchecking for python3 >= 3.6.0, < 3.10.0 with modules ...  \nchecking ... whether /usr/bin/python3 is good... yes\n```\n\nAlthough overlay `cschwan/sage-on-gentoo` is not ready for `python-3.9` yet, \n`develop` branch of `sagemath/sage` accepts `python-3.9`.\n\nSo as if two images weren't enough, I used some ugly hacks to create third image -- `latest-py39`\n\nIf someone finds it usefull to play with python-3.9, tox.ini may be changed this way: \n\n```\n--- a/tox.ini\n+++ b/tox.ini\n@@ -208,6 +208,7 @@ setenv =\n     gentoo:      SYSTEM=gentoo\n     gentoo:      BASE_IMAGE=sheerluck/sage-on-gentoo-stage4\n     gentoo-python3.7: BASE_TAG=latest-py37\n+    gentoo-python3.9: BASE_TAG=latest-py39\n     #    \n     # https://hub.docker.com/_/archlinux/\n     #    \n```",
    "created_at": "2020-10-17T20:00:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455932",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:1" align="right">comment:1</div>


```
checking for python3 >= 3.6.0, < 3.10.0 with modules ...  
checking ... whether /usr/bin/python3 is good... yes
```

Although overlay `cschwan/sage-on-gentoo` is not ready for `python-3.9` yet, 
`develop` branch of `sagemath/sage` accepts `python-3.9`.

So as if two images weren't enough, I used some ugly hacks to create third image -- `latest-py39`

If someone finds it usefull to play with python-3.9, tox.ini may be changed this way: 

```
--- a/tox.ini
+++ b/tox.ini
@@ -208,6 +208,7 @@ setenv =
     gentoo:      SYSTEM=gentoo
     gentoo:      BASE_IMAGE=sheerluck/sage-on-gentoo-stage4
     gentoo-python3.7: BASE_TAG=latest-py37
+    gentoo-python3.9: BASE_TAG=latest-py39
     #    
     # https://hub.docker.com/_/archlinux/
     #    
```



---

archive/issue_comments_455933.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI have created #30785 for this",
    "created_at": "2020-10-17T20:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455933",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

I have created #30785 for this



---

archive/issue_comments_455934.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI was under impression that something is not right with my images until I saw #31395\nThat bug has ruined monthful of latest https://github.com/mkoeppe/sage/actions/ :(",
    "created_at": "2021-03-17T07:14:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455934",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:3" align="right">comment:3</div>

I was under impression that something is not right with my images until I saw #31395
That bug has ruined monthful of latest https://github.com/mkoeppe/sage/actions/ :(



---

archive/issue_comments_455935.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@sheerluck](#comment:103):\n> I was under impression that something is not right with my images until I saw #31395\n> That bug has ruined monthful of latest https://github.com/mkoeppe/sage/actions/ :(\n\nI'm going to post a branch that removes the memlimit and then turn off my computer for a month while people yell at me.",
    "created_at": "2021-03-17T11:38:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455935",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@sheerluck](#comment:103):
> I was under impression that something is not right with my images until I saw #31395
> That bug has ruined monthful of latest https://github.com/mkoeppe/sage/actions/ :(

I'm going to post a branch that removes the memlimit and then turn off my computer for a month while people yell at me.



---

archive/issue_comments_455936.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nReplying to [@orlitzky](#comment:104):\n> Replying to [@sheerluck](#comment:103):\n> > I was under impression that something is not right with my images until I saw #31395\n> > That bug has ruined monthful of latest https://github.com/mkoeppe/sage/actions/ :(\n\n> \n> I'm going to post a branch that removes the memlimit and then turn off my computer for a month while people yell at me.\n\nsee, #31395 got in :-)",
    "created_at": "2021-04-12T11:33:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455936",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:105" align="right">comment:105</div>

Replying to [@orlitzky](#comment:104):
> Replying to [@sheerluck](#comment:103):
> > I was under impression that something is not right with my images until I saw #31395
> > That bug has ruined monthful of latest https://github.com/mkoeppe/sage/actions/ :(

> 
> I'm going to post a branch that removes the memlimit and then turn off my computer for a month while people yell at me.

see, #31395 got in :-)



---

archive/issue_comments_455937.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n`latest` image contains `clang-12.0.1` for `tox -e docker-gentoo-maximal`",
    "created_at": "2021-09-02T08:25:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455937",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:6" align="right">comment:6</div>

`latest` image contains `clang-12.0.1` for `tox -e docker-gentoo-maximal`



---

archive/issue_comments_455938.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAt https://github.com/orlitzky/sage/runs/3851208039?check_suite_focus=true#step:7:11493 I see **Pytest is not installed, skip checking tests that rely on it.**\n\nWell, that is not true, `latest` image got `/usr/bin/py.test` and `/usr/bin/pytest`",
    "created_at": "2021-10-12T09:54:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455938",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:7" align="right">comment:7</div>

At https://github.com/orlitzky/sage/runs/3851208039?check_suite_focus=true#step:7:11493 I see **Pytest is not installed, skip checking tests that rely on it.**

Well, that is not true, `latest` image got `/usr/bin/py.test` and `/usr/bin/pytest`



---

archive/issue_comments_455939.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nyou need pytest in sage's venv.\n\ne.g.\n\n```\nmake pytest\n```\nwill do the trick",
    "created_at": "2021-10-12T11:53:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29105#issuecomment-455939",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

you need pytest in sage's venv.

e.g.

```
make pytest
```
will do the trick
