# Issue 29167: test failures in sage.schemes.curves.zariski_vankampen with sirocco built with -O2

archive/issues_028930.json:
```json
{
    "assignees": [],
    "body": "#29149 fixes building Sage with the sirocco package installed on Cygwin. This required, for linking purposes, removing the forced `-O0` flag (this could probably be worked around by other means--building with optimizations disabled *should* be possible).\n\nHowever, as mmarco remarked below, there are some optimizations that cause numerical errors in sirocco such that it fails to converge or takes a longer path than necessary.  This *can* be reproduced on Linux (although it was previously found on Cygwin).\n\nIn particular this causes test failures in `sage.schemes.curves.zariski_vankampen`.  First the following test fails:\n\n```\nFile \"src/sage/schemes/curves/zariski_vankampen.py\", line 268, in sage.schemes.curves.zariski_vankampen.followstrand\nFailed example:\n    followstrand(f, x0, x1, -1.0) # optional - sirocco # abs tol 1e-15\nExpected:\n    [(0.0, -1.0, 0.0),\n     (0.7500000000000001, -1.015090921153253, -0.24752813818386948),\n     (1.0, -1.026166099551513, -0.32768940253604323)]\nGot:\n    [(0.0, -1.0, 0.0),\n     (0.04687500000000001, -1.0000610264662042, -0.015624364352899234),\n     (0.09376287283569926, -1.0002440686687775, -0.031249206930640684),\n     (0.14068935711887412, -1.00054911561723, -0.046879295645742315),\n     (0.18768019150872053, -1.0009762160115023, -0.06251939538085316),\n     (0.23476112890433726, -1.0015254781428102, -0.07817426805966325),\n     (0.2819579506558838, -1.0021970697475961, -0.0938486727311868),\n     (0.32683564123989106, -1.0029469806716729, -0.10873190673317454),\n     (0.36890847616239786, -1.0037475631034418, -0.12266360371442413),\n     (0.408351758902248, -1.0045828947575761, -0.13570358710012892),\n     (0.4453298364708575, -1.0054396825086667, -0.14790834427708396),\n     (0.5146637319120003, -1.007235298523974, -0.1707339873423019),\n     (0.5753308904230002, -1.0090048273677124, -0.19063761622091374),\n     (0.6284146541201252, -1.0107014101228857, -0.20799548368797782),\n     (0.6748629473551095, -1.0122968271247523, -0.22313613838778654),\n     (0.7155052039357208, -1.0137759106169235, -0.23634583220457633),\n     (0.7866291529517906, -1.0165461226074612, -0.25937181657421426),\n     (0.8399721147138429, -1.0187713227013186, -0.2765614548183696),\n     (0.8799793360353821, -1.0205207374109584, -0.28940677345545085),\n     (0.939990168017691, -1.0232704733075533, -0.30859664694102984),\n     (1.0, -1.026166099551513, -0.3276894025360433)]\n```\n\nThe first an last lines are correct, but none of the stuff in the middle.\n\nThen a bit later it hangs, seemingly indefinitely at\n\n```\nTrying (line 339):    B = zvk.braid_in_segment(g,CC(p1),CC(p2)) # optional - sirocco\n```\n\nwhich on Linux passes very quickly.  However, the CPU is still very active during this hang so it must be some kind of busy loop.\n\nI don't understand anything about this package except that it's using some kind of linear approximation techniques, so there might be some small numerical glitches being invoked that are causing some solutions to diverge or something.\n\nIt might be possible to work around this by identifying exactly which optimizations result in the problem, rather than disabling all optimizations.\n\n*Upstream PR:* https://github.com/miguelmarco/SIROCCO2/pull/3\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\nCC:  @miguelmarco\n\nComponent: **algebraic topology**\n\nKeywords: **cygwin sirocco**\n\nAuthor: **Erik Bray**\n\nBranch/Commit: **[u/embray/ticket-29167](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-29167) @ [`35d7703`](https://github.com/sagemath/sagetrac-mirror/commit/35d7703fff39cdd210ced0846c1e8693bb262aa6)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29167_\n\n",
    "closed_at": "2020-03-15T19:45:35Z",
    "created_at": "2020-02-07T17:24:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20topology",
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20cygwin",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "test failures in sage.schemes.curves.zariski_vankampen with sirocco built with -O2",
    "type": "issue",
    "updated_at": "2020-03-15T19:45:35Z",
    "url": "https://github.com/sagemath/sage/issues/29167",
    "user": "https://github.com/embray"
}
```
#29149 fixes building Sage with the sirocco package installed on Cygwin. This required, for linking purposes, removing the forced `-O0` flag (this could probably be worked around by other means--building with optimizations disabled *should* be possible).

However, as mmarco remarked below, there are some optimizations that cause numerical errors in sirocco such that it fails to converge or takes a longer path than necessary.  This *can* be reproduced on Linux (although it was previously found on Cygwin).

In particular this causes test failures in `sage.schemes.curves.zariski_vankampen`.  First the following test fails:

```
File "src/sage/schemes/curves/zariski_vankampen.py", line 268, in sage.schemes.curves.zariski_vankampen.followstrand
Failed example:
    followstrand(f, x0, x1, -1.0) # optional - sirocco # abs tol 1e-15
Expected:
    [(0.0, -1.0, 0.0),
     (0.7500000000000001, -1.015090921153253, -0.24752813818386948),
     (1.0, -1.026166099551513, -0.32768940253604323)]
Got:
    [(0.0, -1.0, 0.0),
     (0.04687500000000001, -1.0000610264662042, -0.015624364352899234),
     (0.09376287283569926, -1.0002440686687775, -0.031249206930640684),
     (0.14068935711887412, -1.00054911561723, -0.046879295645742315),
     (0.18768019150872053, -1.0009762160115023, -0.06251939538085316),
     (0.23476112890433726, -1.0015254781428102, -0.07817426805966325),
     (0.2819579506558838, -1.0021970697475961, -0.0938486727311868),
     (0.32683564123989106, -1.0029469806716729, -0.10873190673317454),
     (0.36890847616239786, -1.0037475631034418, -0.12266360371442413),
     (0.408351758902248, -1.0045828947575761, -0.13570358710012892),
     (0.4453298364708575, -1.0054396825086667, -0.14790834427708396),
     (0.5146637319120003, -1.007235298523974, -0.1707339873423019),
     (0.5753308904230002, -1.0090048273677124, -0.19063761622091374),
     (0.6284146541201252, -1.0107014101228857, -0.20799548368797782),
     (0.6748629473551095, -1.0122968271247523, -0.22313613838778654),
     (0.7155052039357208, -1.0137759106169235, -0.23634583220457633),
     (0.7866291529517906, -1.0165461226074612, -0.25937181657421426),
     (0.8399721147138429, -1.0187713227013186, -0.2765614548183696),
     (0.8799793360353821, -1.0205207374109584, -0.28940677345545085),
     (0.939990168017691, -1.0232704733075533, -0.30859664694102984),
     (1.0, -1.026166099551513, -0.3276894025360433)]
```

The first an last lines are correct, but none of the stuff in the middle.

Then a bit later it hangs, seemingly indefinitely at

```
Trying (line 339):    B = zvk.braid_in_segment(g,CC(p1),CC(p2)) # optional - sirocco
```

which on Linux passes very quickly.  However, the CPU is still very active during this hang so it must be some kind of busy loop.

I don't understand anything about this package except that it's using some kind of linear approximation techniques, so there might be some small numerical glitches being invoked that are causing some solutions to diverge or something.

It might be possible to work around this by identifying exactly which optimizations result in the problem, rather than disabling all optimizations.

*Upstream PR:* https://github.com/miguelmarco/SIROCCO2/pull/3

Upstream: **Fixed upstream, but not in a stable release.**

CC:  @miguelmarco

Component: **algebraic topology**

Keywords: **cygwin sirocco**

Author: **Erik Bray**

Branch/Commit: **[u/embray/ticket-29167](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-29167) @ [`35d7703`](https://github.com/sagemath/sagetrac-mirror/commit/35d7703fff39cdd210ced0846c1e8693bb262aa6)**

_Issue created by migration from https://trac.sagemath.org/ticket/29167_





---

archive/issue_events_397956.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-07T17:24:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397956"
}
```



---

archive/issue_events_397957.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-07T17:24:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20topology",
    "label_color": "0000ff",
    "label_name": "c: algebraic topology",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397957"
}
```



---

archive/issue_events_397958.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-07T17:24:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397958"
}
```



---

archive/issue_events_397959.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-07T17:24:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397959"
}
```



---

archive/issue_events_397960.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-07T17:24:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20cygwin",
    "label_color": "0000b0",
    "label_name": "c: porting: cygwin",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397960"
}
```



---

archive/issue_comments_457158.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThanks for looking into this.\n\nSadly, I don't have access to any windows system, so I never tested Sirocco there.\n\nAs you say, Sirocco does numerical aproximations of the movements of roots of a polynomial, but carefully testing that the step is small enough to guarantee the correctness. So it is indeed very sensitive to all the small subtleties of floating point computing.\n\nFor example, we discovered when we moved to autotools that the optimization flag -O2 can actually go against performance (and maybe even correctness) , so we had to make sure that it was compiled with no optimization options. Maybe the problem you are detecting on windows is related to that?",
    "created_at": "2020-02-08T10:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457158",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:1" align="right">comment:1</div>

Thanks for looking into this.

Sadly, I don't have access to any windows system, so I never tested Sirocco there.

As you say, Sirocco does numerical aproximations of the movements of roots of a polynomial, but carefully testing that the step is small enough to guarantee the correctness. So it is indeed very sensitive to all the small subtleties of floating point computing.

For example, we discovered when we moved to autotools that the optimization flag -O2 can actually go against performance (and maybe even correctness) , so we had to make sure that it was compiled with no optimization options. Maybe the problem you are detecting on windows is related to that?



---

archive/issue_comments_457159.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI just tested under a linux box disabling the tweek we did to prevent the compiler optimization and I get the same error as you point, so it really looks that is the cuplrit.\n\nIn particular, the only line I had to modify is this one:\n\n```\n: ${CXXFLAGS=-O0 -g}\n```\n\n\nIn the `configure.ac` file [1]\n\nMaybe that kind of autotools behaviour is platform-dependent?\n\n\n[1] https://github.com/miguelmarco/SIROCCO2/blob/master/configure.ac#L4\n\n\nP.S. I noticed that you forked the old sirocco repo. The one we are using here is the version 2 one:  https://github.com/miguelmarco/SIROCCO2",
    "created_at": "2020-02-08T11:08:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457159",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:2" align="right">comment:2</div>

I just tested under a linux box disabling the tweek we did to prevent the compiler optimization and I get the same error as you point, so it really looks that is the cuplrit.

In particular, the only line I had to modify is this one:

```
: ${CXXFLAGS=-O0 -g}
```


In the `configure.ac` file [1]

Maybe that kind of autotools behaviour is platform-dependent?


[1] https://github.com/miguelmarco/SIROCCO2/blob/master/configure.ac#L4


P.S. I noticed that you forked the old sirocco repo. The one we are using here is the version 2 one:  https://github.com/miguelmarco/SIROCCO2



---

archive/issue_comments_457160.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThat's for the note about `-O0`.  I have another ticket #29149 where I'm fixing building sirocco on Cygwin (though I haven't posted the patch yet).  In particular I had to *remove* `CXXFLAGS=-O0` to even get it to build, because otherwise I had problems during linking with some templates; I'm not exactly sure why but it seems like they were being *overspecialized*, in such a way that resulted in multiple definitions for some functions.  Removing `-O0` fixed it because then the compiler would optimize out unused specializations, but there is probably a better solution.\n\nAs you say, this is likely the culprit.",
    "created_at": "2020-02-10T14:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457160",
    "user": "https://github.com/embray"
}
```

<div id="comment:3" align="right">comment:3</div>

That's for the note about `-O0`.  I have another ticket #29149 where I'm fixing building sirocco on Cygwin (though I haven't posted the patch yet).  In particular I had to *remove* `CXXFLAGS=-O0` to even get it to build, because otherwise I had problems during linking with some templates; I'm not exactly sure why but it seems like they were being *overspecialized*, in such a way that resulted in multiple definitions for some functions.  Removing `-O0` fixed it because then the compiler would optimize out unused specializations, but there is probably a better solution.

As you say, this is likely the culprit.



---

archive/issue_comments_457161.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@miguelmarco](#comment%3A2):\n> P.S. I noticed that you forked the old sirocco repo. The one we are using here is the version 2 one:  https://github.com/miguelmarco/SIROCCO2\n\nI see.  When I noticed that my copy was not 2.0 I updated my fork of the repo to 2.0 as well, so I can confirm that I am building the correct version at least.",
    "created_at": "2020-02-10T14:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457161",
    "user": "https://github.com/embray"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@miguelmarco](#comment%3A2):
> P.S. I noticed that you forked the old sirocco repo. The one we are using here is the version 2 one:  https://github.com/miguelmarco/SIROCCO2

I see.  When I noticed that my copy was not 2.0 I updated my fork of the repo to 2.0 as well, so I can confirm that I am building the correct version at least.



---

archive/issue_comments_457162.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@miguelmarco](#comment%3A1):\n> For example, we discovered when we moved to autotools that the optimization flag -O2 can actually go against performance (and maybe even correctness) , so we had to make sure that it was compiled with no optimization options. Maybe the problem you are detecting on windows is related to that?\n\nDid you ever figure out what *specific* optimizations were hurting performance and/or correctness, and where those optimizations were occurring?  Because disabling *all* optimizations is a blunt hammer and probably hurts performance in other cases.  I know figuring that out can be tricky of course, but I have to ask.",
    "created_at": "2020-02-10T15:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457162",
    "user": "https://github.com/embray"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@miguelmarco](#comment%3A1):
> For example, we discovered when we moved to autotools that the optimization flag -O2 can actually go against performance (and maybe even correctness) , so we had to make sure that it was compiled with no optimization options. Maybe the problem you are detecting on windows is related to that?

Did you ever figure out what *specific* optimizations were hurting performance and/or correctness, and where those optimizations were occurring?  Because disabling *all* optimizations is a blunt hammer and probably hurts performance in other cases.  I know figuring that out can be tricky of course, but I have to ask.



---

archive/issue_events_397961.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-10T15:45:40Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "title_is": "test failures in sage.schemes.curves.zariski_vankampen with sirocco built with -O2",
    "title_was": "Cygwin: test failures in sage.schemes.curves.zariski_vankampen with sirocco",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397961"
}
```



---

archive/issue_comments_457163.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI was able to reproduce this on Linux also by removing `-O0` and setting `-O2` instead.",
    "created_at": "2020-02-10T15:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457163",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

I was able to reproduce this on Linux also by removing `-O0` and setting `-O2` instead.



---

archive/issue_comments_457164.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n-#29149 fixes building Sage with the sirocco package installed on Cygwin.\n+#29149 fixes building Sage with the sirocco package installed on Cygwin. This required, for linking purposes, removing the forced `-O0` flag (this could probably be worked around by other means--building with optimizations disabled *should* be possible).\n \n-However, this then has some test failures in `sage.schemes.curves.zariski_vankampen` that I can't reproduce on Linux.  First the following test fails:\n+However, as mmarco remarked below, there are some optimizations that cause numerical errors in sirocco such that it fails to converge or takes a longer path than necessary.  This *can* be reproduced on Linux (although it was previously found on Cygwin).\n+\n+In particular this causes test failures in `sage.schemes.curves.zariski_vankampen`.  First the following test fails:\n \n ```\n File \"src/sage/schemes/curves/zariski_vankampen.py\", line 268, in sage.schemes.curves.zariski_vankampen.followstrand\n@@ -45,3 +47,5 @@\n which on Linux passes very quickly.  However, the CPU is still very active during this hang so it must be some kind of busy loop.\n \n I don't understand anything about this package except that it's using some kind of linear approximation techniques, so there might be some small numerical glitches being invoked that are causing some solutions to diverge or something.\n+\n+It might be possible to work around this by identifying exactly which optimizations result in the problem, rather than disabling all optimizations.\n``````\n",
    "created_at": "2020-02-10T15:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457164",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,8 @@
-#29149 fixes building Sage with the sirocco package installed on Cygwin.
+#29149 fixes building Sage with the sirocco package installed on Cygwin. This required, for linking purposes, removing the forced `-O0` flag (this could probably be worked around by other means--building with optimizations disabled *should* be possible).
 
-However, this then has some test failures in `sage.schemes.curves.zariski_vankampen` that I can't reproduce on Linux.  First the following test fails:
+However, as mmarco remarked below, there are some optimizations that cause numerical errors in sirocco such that it fails to converge or takes a longer path than necessary.  This *can* be reproduced on Linux (although it was previously found on Cygwin).
+
+In particular this causes test failures in `sage.schemes.curves.zariski_vankampen`.  First the following test fails:
 
 ```
 File "src/sage/schemes/curves/zariski_vankampen.py", line 268, in sage.schemes.curves.zariski_vankampen.followstrand
@@ -45,3 +47,5 @@
 which on Linux passes very quickly.  However, the CPU is still very active during this hang so it must be some kind of busy loop.
 
 I don't understand anything about this package except that it's using some kind of linear approximation techniques, so there might be some small numerical glitches being invoked that are causing some solutions to diverge or something.
+
+It might be possible to work around this by identifying exactly which optimizations result in the problem, rather than disabling all optimizations.
``````




---

archive/issue_comments_457165.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI can also reproduce the problem enabling basic optimizations with `-O1`, so it could be any combination of\n\n```\n-fauto-inc-dec \n-fbranch-count-reg \n-fcombine-stack-adjustments \n-fcompare-elim \n-fcprop-registers \n-fdce \n-fdefer-pop \n-fdelayed-branch \n-fdse \n-fforward-propagate \n-fguess-branch-probability \n-fif-conversion \n-fif-conversion2 \n-finline-functions-called-once \n-fipa-profile \n-fipa-pure-const \n-fipa-reference \n-fipa-reference-addressable \n-fmerge-constants \n-fmove-loop-invariants \n-fomit-frame-pointer \n-freorder-blocks \n-fshrink-wrap \n-fshrink-wrap-separate \n-fsplit-wide-types \n-fssa-backprop \n-fssa-phiopt \n-ftree-bit-ccp \n-ftree-ccp \n-ftree-ch \n-ftree-coalesce-vars \n-ftree-copy-prop \n-ftree-dce \n-ftree-dominator-opts \n-ftree-dse \n-ftree-forwprop \n-ftree-fre \n-ftree-phiprop \n-ftree-pta \n-ftree-scev-cprop \n-ftree-sink \n-ftree-slsr \n-ftree-sra \n-ftree-ter \n-funit-at-a-time\n```",
    "created_at": "2020-02-10T15:57:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457165",
    "user": "https://github.com/embray"
}
```

<div id="comment:8" align="right">comment:8</div>

I can also reproduce the problem enabling basic optimizations with `-O1`, so it could be any combination of

```
-fauto-inc-dec 
-fbranch-count-reg 
-fcombine-stack-adjustments 
-fcompare-elim 
-fcprop-registers 
-fdce 
-fdefer-pop 
-fdelayed-branch 
-fdse 
-fforward-propagate 
-fguess-branch-probability 
-fif-conversion 
-fif-conversion2 
-finline-functions-called-once 
-fipa-profile 
-fipa-pure-const 
-fipa-reference 
-fipa-reference-addressable 
-fmerge-constants 
-fmove-loop-invariants 
-fomit-frame-pointer 
-freorder-blocks 
-fshrink-wrap 
-fshrink-wrap-separate 
-fsplit-wide-types 
-fssa-backprop 
-fssa-phiopt 
-ftree-bit-ccp 
-ftree-ccp 
-ftree-ch 
-ftree-coalesce-vars 
-ftree-copy-prop 
-ftree-dce 
-ftree-dominator-opts 
-ftree-dse 
-ftree-forwprop 
-ftree-fre 
-ftree-phiprop 
-ftree-pta 
-ftree-scev-cprop 
-ftree-sink 
-ftree-slsr 
-ftree-sra 
-ftree-ter 
-funit-at-a-time
```



---

archive/issue_comments_457166.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI didn't dig into the details of what specific optimization was the problem. Sorry.",
    "created_at": "2020-02-10T16:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457166",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:9" align="right">comment:9</div>

I didn't dig into the details of what specific optimization was the problem. Sorry.



---

archive/issue_comments_457167.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOne problem I found (if not *the* problem) is that although there is a template specialization for evaluation polynomials on complex intervals:\n\n```\ntemplate <>\nIComplex Polynomial<IComplex>::operator () (const IComplex &x, const IComplex &y) const{\n    IComplex rop, ropx, ropy;\n\n#ifdef DEVELOPER\n    std::cerr << \"using specialized polynomial eval for \" << __PRETTY_FUNCTION__ << std::endl;\n#endif\n\n    ropx = this->evalIPolHornerXY (x, y);\n    ropy = this->evalIPolHornerYX (x, y);\n    rop  = this->evalPolClassic (x, y);\n\n\n    rop.r.a = MAX(MAX(ropx.r.a, ropy.r.a), rop.r.a);\n    rop.r.b = MIN(MIN(ropx.r.b, ropy.r.b), rop.r.b);\n    rop.i.a = MAX(MAX(ropx.i.a, ropy.i.a), rop.i.a);\n    rop.i.b = MIN(MIN(ropx.i.b, ropy.i.b), rop.i.b);\n\n    return rop;\n}\n```\n\nwhen building with `-O1` that specialization seems to be being ignored, and instead it's using the unspecialized template:\n\n```\ntemplate <class T>\nT Polynomial<T>::operator() (const T &x, const T &y) const {\n#ifdef DEVELOPER\n    std::cerr << \"using unspecialized polynomial eval for \" << __PRETTY_FUNCTION__ << std::endl;\n#endif\n    return this->evalPolClassic (x,y);\n}\n```\n\nI don't know why that would be but I'll keep looking...",
    "created_at": "2020-02-10T17:20:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457167",
    "user": "https://github.com/embray"
}
```

<div id="comment:10" align="right">comment:10</div>

One problem I found (if not *the* problem) is that although there is a template specialization for evaluation polynomials on complex intervals:

```
template <>
IComplex Polynomial<IComplex>::operator () (const IComplex &x, const IComplex &y) const{
    IComplex rop, ropx, ropy;

#ifdef DEVELOPER
    std::cerr << "using specialized polynomial eval for " << __PRETTY_FUNCTION__ << std::endl;
#endif

    ropx = this->evalIPolHornerXY (x, y);
    ropy = this->evalIPolHornerYX (x, y);
    rop  = this->evalPolClassic (x, y);


    rop.r.a = MAX(MAX(ropx.r.a, ropy.r.a), rop.r.a);
    rop.r.b = MIN(MIN(ropx.r.b, ropy.r.b), rop.r.b);
    rop.i.a = MAX(MAX(ropx.i.a, ropy.i.a), rop.i.a);
    rop.i.b = MIN(MIN(ropx.i.b, ropy.i.b), rop.i.b);

    return rop;
}
```

when building with `-O1` that specialization seems to be being ignored, and instead it's using the unspecialized template:

```
template <class T>
T Polynomial<T>::operator() (const T &x, const T &y) const {
#ifdef DEVELOPER
    std::cerr << "using unspecialized polynomial eval for " << __PRETTY_FUNCTION__ << std::endl;
#endif
    return this->evalPolClassic (x,y);
}
```

I don't know why that would be but I'll keep looking...



---

archive/issue_comments_457168.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThis seems to fix it for me:\n\n```\ndiff --git a/include/polynomial.hpp b/include/polynomial.hpp\nindex 88d1299..4596579 100644\n--- a/include/polynomial.hpp\n+++ b/include/polynomial.hpp\n@@ -230,6 +230,10 @@ T Polynomial<T>::operator() (const T &x, const T &y) const {\n        return this->evalPolClassic (x,y);\n }\n\n+// Defined in lib/polynomial.cpp\n+template <> IComplex Polynomial<IComplex>::operator() (const IComplex &x, const IComplex &y) const;\n+template <> MPIComplex Polynomial<MPIComplex>::operator () (const MPIComplex &x, const MPIComplex &y) const;\n+\n template <class T>\n T Polynomial<T>::diffX (const T &x, const T &y) const {\n                // coef[(i*(i+1))/2 + j] is coeficient of monomial of degree 'i',\n@@ -311,6 +315,10 @@ T Polynomial<T>::diffY (const T &x, const T &y) const {\n        return this->evalPolYClassic (x,y);\n }\n\n+// Defined in lib/polynomial.cpp\n+template<> IComplex Polynomial<IComplex>::diffY (const IComplex &x, const IComplex &y) const;\n+template<> MPIComplex Polynomial<MPIComplex>::diffY (const MPIComplex &x, const MPIComplex &y) const;\n+\n\n template <class T>\n T Polynomial<T>::diffXX (const T &x, const T &y) const {\n```\n\nThe problem is that sirocco.cpp includes \"polynomial.hpp\" which only has the unspecialized `operator()` defined inline, but no declaration for the specialized version, so it just use the unspecialized one.  Meanwhile, when compiling `polynomial.cpp` the unused specializations are just optimized out.\n\nThis would possibly explain the link errors I was having on Cygwin as well--I don't know why the problem only occurs on Windows but it must be generating an explicit specialization for `Polynomial<IComplex>::operator()` in `sirocco.o` and then conflicting with the one in `polynomial.o`.  Going to test that theory out now.",
    "created_at": "2020-02-10T17:36:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457168",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

This seems to fix it for me:

```
diff --git a/include/polynomial.hpp b/include/polynomial.hpp
index 88d1299..4596579 100644
--- a/include/polynomial.hpp
+++ b/include/polynomial.hpp
@@ -230,6 +230,10 @@ T Polynomial<T>::operator() (const T &x, const T &y) const {
        return this->evalPolClassic (x,y);
 }

+// Defined in lib/polynomial.cpp
+template <> IComplex Polynomial<IComplex>::operator() (const IComplex &x, const IComplex &y) const;
+template <> MPIComplex Polynomial<MPIComplex>::operator () (const MPIComplex &x, const MPIComplex &y) const;
+
 template <class T>
 T Polynomial<T>::diffX (const T &x, const T &y) const {
                // coef[(i*(i+1))/2 + j] is coeficient of monomial of degree 'i',
@@ -311,6 +315,10 @@ T Polynomial<T>::diffY (const T &x, const T &y) const {
        return this->evalPolYClassic (x,y);
 }

+// Defined in lib/polynomial.cpp
+template<> IComplex Polynomial<IComplex>::diffY (const IComplex &x, const IComplex &y) const;
+template<> MPIComplex Polynomial<MPIComplex>::diffY (const MPIComplex &x, const MPIComplex &y) const;
+

 template <class T>
 T Polynomial<T>::diffXX (const T &x, const T &y) const {
```

The problem is that sirocco.cpp includes "polynomial.hpp" which only has the unspecialized `operator()` defined inline, but no declaration for the specialized version, so it just use the unspecialized one.  Meanwhile, when compiling `polynomial.cpp` the unused specializations are just optimized out.

This would possibly explain the link errors I was having on Cygwin as well--I don't know why the problem only occurs on Windows but it must be generating an explicit specialization for `Polynomial<IComplex>::operator()` in `sirocco.o` and then conflicting with the one in `polynomial.o`.  Going to test that theory out now.



---

archive/issue_comments_457169.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nYep, this is exactly the link error that I got which motivated me to try removing the `-O0`.  This explains it exactly:\n\n```\nlibtool: link: g++ -std=gnu++11 -std=gnu++11 -shared -nostdlib /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/crtbeginS.o  .libs/icomplex.o .libs/interval.o .libs/mp_complex.o .libs/mp_icomplex.o .libs/mp_interval.o .libs/polynomial.o .libs/sirocco.o   -lmpfr -lgmp -L/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local/lib/../lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0 -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/lib/../lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../lib -L/lib/../lib -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../.. -lstdc++ -lgcc_s -lgcc -lcygwin -ladvapi32 -lshell32 -luser32 -lkernel32 -lgcc_s -lgcc /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/crtend.o  -O0 -Wl,-rpath -Wl,/home/embray/src/sagemath/sage/local/lib   -o .libs/cygsirocco-0.dll -Wl,--enable-auto-image-base -Xlinker --out-implib -Xlinker .libs/libsirocco.dll.a\n.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI8IComplexEclERKS0_S3_[_ZNK10PolynomialI8IComplexEclERKS0_S3_]+0x0): multiple definition of `Polynomial<IComplex>::operator()(IComplex const&, IComplex const&) const'\n.libs/polynomial.o:polynomial.cpp:(.text+0x642): first defined here\n.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI8IComplexE5diffYERKS0_S3_[_ZNK10PolynomialI8IComplexE5diffYERKS0_S3_]+0x0): multiple definition of `Polynomial<IComplex>::diffY(IComplex const&, IComplex const&) const'\n.libs/polynomial.o:polynomial.cpp:(.text+0xfbe): first defined here\n.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI10MPIComplexEclERKS0_S3_[_ZNK10PolynomialI10MPIComplexEclERKS0_S3_]+0x0): multiple definition of `Polynomial<MPIComplex>::operator()(MPIComplex const&, MPIComplex const&) const'\n.libs/polynomial.o:polynomial.cpp:(.text+0x188a): first defined here\n.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI10MPIComplexE5diffYERKS0_S3_[_ZNK10PolynomialI10MPIComplexE5diffYERKS0_S3_]+0x0): multiple definition of `Polynomial<MPIComplex>::diffY(MPIComplex const&, MPIComplex const&) const'\n.libs/polynomial.o:polynomial.cpp:(.text+0x22f8): first defined here\ncollect2: error: ld returned 1 exit status\n```",
    "created_at": "2020-02-10T17:39:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457169",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

Yep, this is exactly the link error that I got which motivated me to try removing the `-O0`.  This explains it exactly:

```
libtool: link: g++ -std=gnu++11 -std=gnu++11 -shared -nostdlib /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/crtbeginS.o  .libs/icomplex.o .libs/interval.o .libs/mp_complex.o .libs/mp_icomplex.o .libs/mp_interval.o .libs/polynomial.o .libs/sirocco.o   -lmpfr -lgmp -L/home/embray/src/sagemath/sage/local/lib -L/home/embray/src/sagemath/sage/local/lib/../lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0 -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/lib/../lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../lib -L/lib/../lib -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/lib -L/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../.. -lstdc++ -lgcc_s -lgcc -lcygwin -ladvapi32 -lshell32 -luser32 -lkernel32 -lgcc_s -lgcc /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/crtend.o  -O0 -Wl,-rpath -Wl,/home/embray/src/sagemath/sage/local/lib   -o .libs/cygsirocco-0.dll -Wl,--enable-auto-image-base -Xlinker --out-implib -Xlinker .libs/libsirocco.dll.a
.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI8IComplexEclERKS0_S3_[_ZNK10PolynomialI8IComplexEclERKS0_S3_]+0x0): multiple definition of `Polynomial<IComplex>::operator()(IComplex const&, IComplex const&) const'
.libs/polynomial.o:polynomial.cpp:(.text+0x642): first defined here
.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI8IComplexE5diffYERKS0_S3_[_ZNK10PolynomialI8IComplexE5diffYERKS0_S3_]+0x0): multiple definition of `Polynomial<IComplex>::diffY(IComplex const&, IComplex const&) const'
.libs/polynomial.o:polynomial.cpp:(.text+0xfbe): first defined here
.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI10MPIComplexEclERKS0_S3_[_ZNK10PolynomialI10MPIComplexEclERKS0_S3_]+0x0): multiple definition of `Polynomial<MPIComplex>::operator()(MPIComplex const&, MPIComplex const&) const'
.libs/polynomial.o:polynomial.cpp:(.text+0x188a): first defined here
.libs/sirocco.o:sirocco.cpp:(.text$_ZNK10PolynomialI10MPIComplexE5diffYERKS0_S3_[_ZNK10PolynomialI10MPIComplexE5diffYERKS0_S3_]+0x0): multiple definition of `Polynomial<MPIComplex>::diffY(MPIComplex const&, MPIComplex const&) const'
.libs/polynomial.o:polynomial.cpp:(.text+0x22f8): first defined here
collect2: error: ld returned 1 exit status
```



---

archive/issue_events_397962.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-02-10T18:58:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397962"
}
```



---

archive/issue_comments_457170.json:
```json
{
    "body": "Author: **Erik Bray**",
    "created_at": "2020-02-10T18:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457170",
    "user": "https://github.com/embray"
}
```

Author: **Erik Bray**



---

archive/issue_comments_457171.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35d7703fff39cdd210ced0846c1e8693bb262aa6\"><code>35d7703</code></a></td><td><code>Trac #29167: Fix incorrect results that occur when sirocco is build with</code></td></tr></table>\n",
    "created_at": "2020-02-10T18:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457171",
    "user": "https://github.com/embray"
}
```

<div id="comment:13"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35d7703fff39cdd210ced0846c1e8693bb262aa6"><code>35d7703</code></a></td><td><code>Trac #29167: Fix incorrect results that occur when sirocco is build with</code></td></tr></table>




---

archive/issue_comments_457172.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -49,3 +49,5 @@\n I don't understand anything about this package except that it's using some kind of linear approximation techniques, so there might be some small numerical glitches being invoked that are causing some solutions to diverge or something.\n \n It might be possible to work around this by identifying exactly which optimizations result in the problem, rather than disabling all optimizations.\n+\n+*Upstream PR:* https://github.com/miguelmarco/SIROCCO2/pull/3\n``````\n",
    "created_at": "2020-02-10T18:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457172",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -49,3 +49,5 @@
 I don't understand anything about this package except that it's using some kind of linear approximation techniques, so there might be some small numerical glitches being invoked that are causing some solutions to diverge or something.
 
 It might be possible to work around this by identifying exactly which optimizations result in the problem, rather than disabling all optimizations.
+
+*Upstream PR:* https://github.com/miguelmarco/SIROCCO2/pull/3
``````




---

archive/issue_comments_457173.json:
```json
{
    "body": "Branch: **[u/embray/ticket-29167](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-29167)**",
    "created_at": "2020-02-10T18:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457173",
    "user": "https://github.com/embray"
}
```

Branch: **[u/embray/ticket-29167](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-29167)**



---

archive/issue_comments_457174.json:
```json
{
    "body": "Upstream: **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2020-02-10T18:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457174",
    "user": "https://github.com/embray"
}
```

Upstream: **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_457175.json:
```json
{
    "body": "Commit: **[`35d7703`](https://github.com/sagemath/sagetrac-mirror/commit/35d7703fff39cdd210ced0846c1e8693bb262aa6)**",
    "created_at": "2020-02-10T18:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457175",
    "user": "https://github.com/embray"
}
```

Commit: **[`35d7703`](https://github.com/sagemath/sagetrac-mirror/commit/35d7703fff39cdd210ced0846c1e8693bb262aa6)**



---

archive/issue_comments_457176.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThanks a lot. Great work.\n\nI might need some time to review and test it though.\n\nDid you check that all test pass with this patch?\n\nAlso, what would you consider the best way to go: just patch sirocco at install time inside Sage, or release a new version of Sirocco and using that in Sage?",
    "created_at": "2020-02-10T19:12:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457176",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:14" align="right">comment:14</div>

Thanks a lot. Great work.

I might need some time to review and test it though.

Did you check that all test pass with this patch?

Also, what would you consider the best way to go: just patch sirocco at install time inside Sage, or release a new version of Sirocco and using that in Sage?



---

archive/issue_comments_457177.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@miguelmarco](#comment%3A14):\n> Thanks a lot. Great work.\n> \n> I might need some time to review and test it though.\n\nThank you for looking at it! There's no hurry.\n\n> Did you check that all test pass with this patch?\n\nPer our discussion on GitHub, yes.  I'm just reiterating here for the record.\n\n> Also, what would you consider the best way to go: just patch sirocco at install time inside Sage, or release a new version of Sirocco and using that in Sage?\n\nIt's up to you.  There's no urgency on this either way, so whatever's easiest for you.",
    "created_at": "2020-02-11T13:39:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457177",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@miguelmarco](#comment%3A14):
> Thanks a lot. Great work.
> 
> I might need some time to review and test it though.

Thank you for looking at it! There's no hurry.

> Did you check that all test pass with this patch?

Per our discussion on GitHub, yes.  I'm just reiterating here for the record.

> Also, what would you consider the best way to go: just patch sirocco at install time inside Sage, or release a new version of Sirocco and using that in Sage?

It's up to you.  There's no urgency on this either way, so whatever's easiest for you.



---

archive/issue_comments_457178.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2020-02-11T13:39:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457178",
    "user": "https://github.com/embray"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_457179.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI just created a new release in github. The source code is available at https://github.com/miguelmarco/SIROCCO2/releases/download/v2.0.1/libsirocco-2.0.1.tar.gz",
    "created_at": "2020-02-11T14:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457179",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:16" align="right">comment:16</div>

I just created a new release in github. The source code is available at https://github.com/miguelmarco/SIROCCO2/releases/download/v2.0.1/libsirocco-2.0.1.tar.gz



---

archive/issue_comments_457180.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOh shoot, before you made the release I should have pointed out to you the fixes I made for Cygwin.  I forgot to make a PR for them yet.  I will do that now...",
    "created_at": "2020-02-12T17:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457180",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

Oh shoot, before you made the release I should have pointed out to you the fixes I made for Cygwin.  I forgot to make a PR for them yet.  I will do that now...



---

archive/issue_comments_457181.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nNo problem, I can make another release (that is the good thing about numbers: we won't run out of them).",
    "created_at": "2020-02-12T19:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457181",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:18" align="right">comment:18</div>

No problem, I can make another release (that is the good thing about numbers: we won't run out of them).



---

archive/issue_comments_457182.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI made a new release on github.\n\nThe tarball is available at https://github.com/miguelmarco/SIROCCO2/releases/download/2.0.2/libsirocco-2.0.2.tar.gz",
    "created_at": "2020-02-16T19:43:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457182",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:19" align="right">comment:19</div>

I made a new release on github.

The tarball is available at https://github.com/miguelmarco/SIROCCO2/releases/download/2.0.2/libsirocco-2.0.2.tar.gz



---

archive/issue_comments_457183.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nErik, are you going to rebase this ticket based on the new release?",
    "created_at": "2020-02-25T01:49:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457183",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Erik, are you going to rebase this ticket based on the new release?



---

archive/issue_comments_457184.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nYes, I've been busy with other things, but I plan to replace this ticket with one to update the sirocco spkg to the new release.",
    "created_at": "2020-03-05T12:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457184",
    "user": "https://github.com/embray"
}
```

<div id="comment:21" align="right">comment:21</div>

Yes, I've been busy with other things, but I plan to replace this ticket with one to update the sirocco spkg to the new release.



---

archive/issue_events_397963.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-03-06T14:57:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397963"
}
```



---

archive/issue_comments_457185.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSuperseded by #29284 which upgrades the SIROCCO SPKG to the new 2.0.2 release, rather than patching.",
    "created_at": "2020-03-06T14:57:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29167#issuecomment-457185",
    "user": "https://github.com/embray"
}
```

<div id="comment:22" align="right">comment:22</div>

Superseded by #29284 which upgrades the SIROCCO SPKG to the new 2.0.2 release, rather than patching.



---

archive/issue_events_397964.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-03-06T14:57:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397964"
}
```



---

archive/issue_events_397965.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-03-06T14:57:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397965"
}
```



---

archive/issue_events_397966.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-03-15T19:45:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397966"
}
```



---

archive/issue_events_397967.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-03-15T19:45:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397967"
}
```



---

archive/issue_events_397968.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-03-15T19:45:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397968"
}
```



---

archive/issue_events_397969.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-03-15T19:45:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29167",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "c6c6c6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29167#event-397969"
}
```
