# Issue 29125: `is_inscribed` depends on order of vertices

archive/issues_028888.json:
```json
{
    "body": "CC:  @jplab @laisrast\n\nKeywords: polytopes, is inscribed\n\nCurrently the inscription test for polyhedra depends on the order of vertices:\n\n```\nsage: Polyhedron(vertices=[[-2,-1], [-2,1], [0,-1], [0,1]]).is_inscribed()\nTrue\nsage: P = Polyhedron(vertices=[[-2,-1], [-2,1], [0,-1], [0,1]], backend='field')\nsage: P.is_inscribed()\nFalse\nsage: V = P.Vrepresentation()\nsage: H = P.Hrepresentation()\nsage: parent = P.parent()\nsage: dic = {True: 0, False: 0}\nsage: for V1 in Permutations(V):\n....:     P1 = parent._element_constructor_(\n....:         [V1, [], []], [H, []], Vrep_minimal=True, Hrep_minimal=True)\n....:     dic[P1.is_inscribed()] += 1\n....:     \nsage: dic\n{True: 18, False: 6}\n```\n\nThe algorithm constructs a sphere around `dim + 1` vertices in general position. The circumcenter is computed up to sign. Then, one vertex is taken to determine, which sign to choose. However, up to `dim` vertices might lie on the intersection of both spheres.\n\nWe fix this by checking distance from the circumcenter for all vertices of that simplex.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29125\n\n",
    "closed_at": "2020-02-11T21:06:22Z",
    "created_at": "2020-01-31T20:13:42Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "`is_inscribed` depends on order of vertices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29125",
    "user": "https://github.com/kliem"
}
```
CC:  @jplab @laisrast

Keywords: polytopes, is inscribed

Currently the inscription test for polyhedra depends on the order of vertices:

```
sage: Polyhedron(vertices=[[-2,-1], [-2,1], [0,-1], [0,1]]).is_inscribed()
True
sage: P = Polyhedron(vertices=[[-2,-1], [-2,1], [0,-1], [0,1]], backend='field')
sage: P.is_inscribed()
False
sage: V = P.Vrepresentation()
sage: H = P.Hrepresentation()
sage: parent = P.parent()
sage: dic = {True: 0, False: 0}
sage: for V1 in Permutations(V):
....:     P1 = parent._element_constructor_(
....:         [V1, [], []], [H, []], Vrep_minimal=True, Hrep_minimal=True)
....:     dic[P1.is_inscribed()] += 1
....:     
sage: dic
{True: 18, False: 6}
```

The algorithm constructs a sphere around `dim + 1` vertices in general position. The circumcenter is computed up to sign. Then, one vertex is taken to determine, which sign to choose. However, up to `dim` vertices might lie on the intersection of both spheres.

We fix this by checking distance from the circumcenter for all vertices of that simplex.

Issue created by migration from https://trac.sagemath.org/ticket/29125





---

archive/issue_comments_408526.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-01-31T20:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29125",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29125#issuecomment-408526",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_408527.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-31T20:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29125",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29125#issuecomment-408527",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_408528.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-07T10:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29125",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29125#issuecomment-408528",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_408529.json:
```json
{
    "body": "Looks good to me. Thanks for fixing this error!\n\nAgain, the pyflakes is fixed in another ticket.",
    "created_at": "2020-02-07T10:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29125",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29125#issuecomment-408529",
    "user": "https://github.com/jplab"
}
```

Looks good to me. Thanks for fixing this error!

Again, the pyflakes is fixed in another ticket.



---

archive/issue_comments_408530.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-11T21:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29125",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29125#issuecomment-408530",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_073875.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-11T21:06:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29125",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29125#event-73875"
}
```
