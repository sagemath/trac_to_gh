# Issue 29950: Build sagelib from build/pkgs/sagelib/src, fix `setup.py sdist`, add spkg-src and tox.ini

archive/issues_029713.json:
```json
{
    "assignees": [],
    "body": "As a follow-up to #29411, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`.\n\nWe fix `setup.py sdist`, which can be tested using `spkg-src` (which builds a pip-installable tarball in `upstream/`) and `tox`:\n\n```\n./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'\n./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'\n```\n\nThe call of `./sage -sh` is necessary so that `SAGE_LOCAL` is set. \nMoreover, for scripts that use `sage-env`, also `SAGE_ENV_SOURCED` is crucial for the correct operation; otherwise `sage-env` sets things based on `SAGE_LOCAL` again. \n\nDepends on #29701\n\nCC:  @kiwifb @jhpalmieri @dimpase @kliem @isuruf @vbraun\n\nComponent: **refactoring**\n\nAuthor: **Matthias Koeppe**\n\nBranch/Commit: **[`ccc67b0`](https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473)**\n\nReviewer: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29950_\n\n",
    "closed_at": "2020-08-12T19:53:18Z",
    "created_at": "2020-06-24T02:12:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/refactoring",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Build sagelib from build/pkgs/sagelib/src, fix `setup.py sdist`, add spkg-src and tox.ini",
    "type": "issue",
    "updated_at": "2020-08-12T19:53:18Z",
    "url": "https://github.com/sagemath/sage/issues/29950",
    "user": "https://github.com/mkoeppe"
}
```
As a follow-up to #29411, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`.

We fix `setup.py sdist`, which can be tested using `spkg-src` (which builds a pip-installable tarball in `upstream/`) and `tox`:

```
./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'
./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'
```

The call of `./sage -sh` is necessary so that `SAGE_LOCAL` is set. 
Moreover, for scripts that use `sage-env`, also `SAGE_ENV_SOURCED` is crucial for the correct operation; otherwise `sage-env` sets things based on `SAGE_LOCAL` again. 

Depends on #29701

CC:  @kiwifb @jhpalmieri @dimpase @kliem @isuruf @vbraun

Component: **refactoring**

Author: **Matthias Koeppe**

Branch/Commit: **[`ccc67b0`](https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473)**

Reviewer: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/29950_





---

archive/issue_events_409255.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T02:12:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409255"
}
```



---

archive/issue_events_409256.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T02:12:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409256"
}
```



---

archive/issue_events_409257.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T02:12:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409257"
}
```



---

archive/issue_events_409258.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T02:12:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409258"
}
```



---

archive/issue_comments_473698.json:
```json
{
    "body": "Branch: **[u/mkoeppe/build_sagelib_using_installed_sage_setup](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/build_sagelib_using_installed_sage_setup)**",
    "created_at": "2020-06-24T02:28:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473698",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/build_sagelib_using_installed_sage_setup](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/build_sagelib_using_installed_sage_setup)**



---

archive/issue_comments_473699.json:
```json
{
    "body": "Commit: **[`1ab75a9`](https://github.com/sagemath/sagetrac-mirror/commit/1ab75a99c46a00e7424a5d91366097fc32c9a13a)**",
    "created_at": "2020-06-24T02:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473699",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`1ab75a9`](https://github.com/sagemath/sagetrac-mirror/commit/1ab75a99c46a00e7424a5d91366097fc32c9a13a)**



---

archive/issue_comments_473700.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0459006f8ad828e3c3f83004b6db605ec036a0f6\"><code>0459006</code></a></td><td><code>.gitignore: Ignore generated files in build/pkgs/*/src</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ab75a99c46a00e7424a5d91366097fc32c9a13a\"><code>1ab75a9</code></a></td><td><code>Build sagelib using the installed sage_setup</code></td></tr></table>\n",
    "created_at": "2020-06-24T02:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473700",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0459006f8ad828e3c3f83004b6db605ec036a0f6"><code>0459006</code></a></td><td><code>.gitignore: Ignore generated files in build/pkgs/*/src</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ab75a99c46a00e7424a5d91366097fc32c9a13a"><code>1ab75a9</code></a></td><td><code>Build sagelib using the installed sage_setup</code></td></tr></table>




---

archive/issue_events_409259.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T02:47:29Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "title_is": "Build sagelib using the installed sage_setup, add spkg-src",
    "title_was": "Build sagelib using the installed sage_setup",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409259"
}
```



---

archive/issue_comments_473701.json:
```json
{
    "body": "Work Issues: **add spkg-src**",
    "created_at": "2020-06-24T02:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473701",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **add spkg-src**



---

archive/issue_comments_473702.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2020-06-24T05:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473702",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_473703.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d83c125fc0b3fdfe5538805336c84b335c7e77a\"><code>3d83c12</code></a></td><td><code>build/pkgs/sagelib/spkg-src: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2bde507b741801e970744fbb127a6f9cbf7d06a\"><code>a2bde50</code></a></td><td><code>src/MANIFEST.in: prune .tox</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b258d39f92f93e44f04724b50383f3558bc2349\"><code>4b258d3</code></a></td><td><code>src/MANIFEST.in: Remove bitrotted file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a29cd2d79dd84d9653f9f0ea38466f846edb0e4f\"><code>a29cd2d</code></a></td><td><code>build/pkgs/sagelib/MANIFEST.in: New</code></td></tr></table>\n",
    "created_at": "2020-06-25T06:32:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473703",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d83c125fc0b3fdfe5538805336c84b335c7e77a"><code>3d83c12</code></a></td><td><code>build/pkgs/sagelib/spkg-src: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2bde507b741801e970744fbb127a6f9cbf7d06a"><code>a2bde50</code></a></td><td><code>src/MANIFEST.in: prune .tox</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b258d39f92f93e44f04724b50383f3558bc2349"><code>4b258d3</code></a></td><td><code>src/MANIFEST.in: Remove bitrotted file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a29cd2d79dd84d9653f9f0ea38466f846edb0e4f"><code>a29cd2d</code></a></td><td><code>build/pkgs/sagelib/MANIFEST.in: New</code></td></tr></table>




---

archive/issue_comments_473704.json:
```json
{
    "body": "Changed commit from **[`1ab75a9`](https://github.com/sagemath/sagetrac-mirror/commit/1ab75a99c46a00e7424a5d91366097fc32c9a13a)** to **[`a29cd2d`](https://github.com/sagemath/sagetrac-mirror/commit/a29cd2d79dd84d9653f9f0ea38466f846edb0e4f)**",
    "created_at": "2020-06-25T06:32:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473704",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1ab75a9`](https://github.com/sagemath/sagetrac-mirror/commit/1ab75a99c46a00e7424a5d91366097fc32c9a13a)** to **[`a29cd2d`](https://github.com/sagemath/sagetrac-mirror/commit/a29cd2d79dd84d9653f9f0ea38466f846edb0e4f)**



---

archive/issue_comments_473705.json:
```json
{
    "body": "Changed work issues from **add spkg-src** to **Fixup MANIFEST.in**",
    "created_at": "2020-06-25T06:45:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473705",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **add spkg-src** to **Fixup MANIFEST.in**



---

archive/issue_comments_473706.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nsdist is broken: Files named `**` end up in the tar file.",
    "created_at": "2020-06-28T16:25:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473706",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

sdist is broken: Files named `**` end up in the tar file.



---

archive/issue_comments_473707.json:
```json
{
    "body": "Changed dependencies from **#29411, #29847** to **#29411, #29847, #29701**",
    "created_at": "2020-06-28T16:26:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473707",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29411, #29847** to **#29411, #29847, #29701**



---

archive/issue_comments_473708.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nhttps://github.com/sagemath/cypari2/issues/93",
    "created_at": "2020-06-28T18:18:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473708",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

https://github.com/sagemath/cypari2/issues/93



---

archive/issue_comments_473709.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f8850adc52d8798852646b550f4f9c88b30b468\"><code>7f8850a</code></a></td><td><code>src/module_list.py: Document that it is obsolete</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/26a85a4303d4774427d173cae932ad48b5ac5926\"><code>26a85a4</code></a></td><td><code>Merge branch 't/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d5803ef5920f894bcac69ed1268e1e03ea9dd5e\"><code>5d5803e</code></a></td><td><code>src/sage/graphs/planarity.pyx: Add forgotten distutils directive</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0be9b64ce3623fe4470d7b2483d21f343225ca7\"><code>a0be9b6</code></a></td><td><code>Merge branch 't/29790/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_5__sage_graphs_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14396af45af31c8f3a48d934d0e1ad424712ba4c\"><code>14396af</code></a></td><td><code>Merge tag '9.2.beta2' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/821e33757098467c10108f7e467a1634150b5d0f\"><code>821e337</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeb6ba458a2fd725e91f578db4d15156005d270e\"><code>eeb6ba4</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt, tox.ini: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce8b84da913604989f28945fa0dd08833ccadda0\"><code>ce8b84d</code></a></td><td><code>build/pkgs/sagelib/src/MANIFEST.in: Prune sage/ext/interpreters</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9a1335840197b854b78957dc6a8b59666323633\"><code>a9a1335</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt: Add packages required for runtime</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3b8f8f057647eca8725a7a35a415c1cc3e19d4b\"><code>c3b8f8f</code></a></td><td><code>Suggest tox -v -v</code></td></tr></table>\n",
    "created_at": "2020-06-28T18:26:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473709",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f8850adc52d8798852646b550f4f9c88b30b468"><code>7f8850a</code></a></td><td><code>src/module_list.py: Document that it is obsolete</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/26a85a4303d4774427d173cae932ad48b5ac5926"><code>26a85a4</code></a></td><td><code>Merge branch 't/29702/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d5803ef5920f894bcac69ed1268e1e03ea9dd5e"><code>5d5803e</code></a></td><td><code>src/sage/graphs/planarity.pyx: Add forgotten distutils directive</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0be9b64ce3623fe4470d7b2483d21f343225ca7"><code>a0be9b6</code></a></td><td><code>Merge branch 't/29790/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_5__sage_graphs_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14396af45af31c8f3a48d934d0e1ad424712ba4c"><code>14396af</code></a></td><td><code>Merge tag '9.2.beta2' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/821e33757098467c10108f7e467a1634150b5d0f"><code>821e337</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeb6ba458a2fd725e91f578db4d15156005d270e"><code>eeb6ba4</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt, tox.ini: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce8b84da913604989f28945fa0dd08833ccadda0"><code>ce8b84d</code></a></td><td><code>build/pkgs/sagelib/src/MANIFEST.in: Prune sage/ext/interpreters</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9a1335840197b854b78957dc6a8b59666323633"><code>a9a1335</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt: Add packages required for runtime</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3b8f8f057647eca8725a7a35a415c1cc3e19d4b"><code>c3b8f8f</code></a></td><td><code>Suggest tox -v -v</code></td></tr></table>




---

archive/issue_comments_473710.json:
```json
{
    "body": "Changed commit from **[`a29cd2d`](https://github.com/sagemath/sagetrac-mirror/commit/a29cd2d79dd84d9653f9f0ea38466f846edb0e4f)** to **[`c3b8f8f`](https://github.com/sagemath/sagetrac-mirror/commit/c3b8f8f057647eca8725a7a35a415c1cc3e19d4b)**",
    "created_at": "2020-06-28T18:26:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473710",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a29cd2d`](https://github.com/sagemath/sagetrac-mirror/commit/a29cd2d79dd84d9653f9f0ea38466f846edb0e4f)** to **[`c3b8f8f`](https://github.com/sagemath/sagetrac-mirror/commit/c3b8f8f057647eca8725a7a35a415c1cc3e19d4b)**



---

archive/issue_comments_473711.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,8 @@\n-After #29411 and #29847, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`. In particular, we arrange for the installed `sage_setup` (#29847), rather than the one from the source tree, to be used.\n+As a follow-up to #29411, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`.\n \n+We fix `setup.py sdist`, which can be tested using `spkg-src` and `tox`.\n+\n+```\n+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'\n+```\n+\n``````\n",
    "created_at": "2020-06-28T18:29:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473711",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,8 @@
-After #29411 and #29847, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`. In particular, we arrange for the installed `sage_setup` (#29847), rather than the one from the source tree, to be used.
+As a follow-up to #29411, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`.
 
+We fix `setup.py sdist`, which can be tested using `spkg-src` and `tox`.
+
+```
+./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'
+```
+
``````




---

archive/issue_comments_473712.json:
```json
{
    "body": "Changed work issues from **Fixup MANIFEST.in** to **Rebase away from #29847**",
    "created_at": "2020-06-28T18:29:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473712",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **Fixup MANIFEST.in** to **Rebase away from #29847**



---

archive/issue_events_409260.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T18:29:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "title_is": "Build sagelib from build/pkgs/sagelib/src, fix `setup.py sdist`, add spkg-src and tox.ini",
    "title_was": "Build sagelib using the installed sage_setup, add spkg-src",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409260"
}
```



---

archive/issue_comments_473713.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cdf501f96008303331b78fa398aa039a080c23fb\"><code>cdf501f</code></a></td><td><code>build/pkgs/sagelib/spkg-src: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef4f5b8b6536243e494faa80148cf0bbb0b348b4\"><code>ef4f5b8</code></a></td><td><code>Move src/MANIFEST.in to build/pkgs/sagelib/MANIFEST.in, fix up</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/233f6baf8f2d701104232601ad6fb7362fef7071\"><code>233f6ba</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt, tox.ini: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/177cd4c40a9f74a547f605375ad501aa986c39ec\"><code>177cd4c</code></a></td><td><code>build/pkgs/sagelib/src/MANIFEST.in: Prune sage/ext/interpreters</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07b29fbe8af49c018f4b6453fe31225f7a9bc53c\"><code>07b29fb</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt: Add packages required for runtime</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad3370590f559c4a13132896d31054b939ffaea5\"><code>ad33705</code></a></td><td><code>Suggest tox -v -v</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/481e2128aa39dd1f9961955e51575d6bebb5031b\"><code>481e212</code></a></td><td><code>.gitignore: Ignore generated files in build/pkgs/*/src</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9955a3ff69870ff844e5ebb45cf47c4b6f214263\"><code>9955a3f</code></a></td><td><code>Build sagelib from build/pkgs/sagelib/src</code></td></tr></table>\n",
    "created_at": "2020-06-28T19:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473713",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cdf501f96008303331b78fa398aa039a080c23fb"><code>cdf501f</code></a></td><td><code>build/pkgs/sagelib/spkg-src: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef4f5b8b6536243e494faa80148cf0bbb0b348b4"><code>ef4f5b8</code></a></td><td><code>Move src/MANIFEST.in to build/pkgs/sagelib/MANIFEST.in, fix up</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/233f6baf8f2d701104232601ad6fb7362fef7071"><code>233f6ba</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt, tox.ini: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/177cd4c40a9f74a547f605375ad501aa986c39ec"><code>177cd4c</code></a></td><td><code>build/pkgs/sagelib/src/MANIFEST.in: Prune sage/ext/interpreters</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07b29fbe8af49c018f4b6453fe31225f7a9bc53c"><code>07b29fb</code></a></td><td><code>build/pkgs/sagelib/src/requirements.txt: Add packages required for runtime</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad3370590f559c4a13132896d31054b939ffaea5"><code>ad33705</code></a></td><td><code>Suggest tox -v -v</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/481e2128aa39dd1f9961955e51575d6bebb5031b"><code>481e212</code></a></td><td><code>.gitignore: Ignore generated files in build/pkgs/*/src</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9955a3ff69870ff844e5ebb45cf47c4b6f214263"><code>9955a3f</code></a></td><td><code>Build sagelib from build/pkgs/sagelib/src</code></td></tr></table>




---

archive/issue_comments_473714.json:
```json
{
    "body": "Changed commit from **[`c3b8f8f`](https://github.com/sagemath/sagetrac-mirror/commit/c3b8f8f057647eca8725a7a35a415c1cc3e19d4b)** to **[`9955a3f`](https://github.com/sagemath/sagetrac-mirror/commit/9955a3ff69870ff844e5ebb45cf47c4b6f214263)**",
    "created_at": "2020-06-28T19:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473714",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c3b8f8f`](https://github.com/sagemath/sagetrac-mirror/commit/c3b8f8f057647eca8725a7a35a415c1cc3e19d4b)** to **[`9955a3f`](https://github.com/sagemath/sagetrac-mirror/commit/9955a3ff69870ff844e5ebb45cf47c4b6f214263)**



---

archive/issue_comments_473715.json:
```json
{
    "body": "Changed dependencies from **#29411, #29847, #29701** to **#29411, #29701**",
    "created_at": "2020-06-28T19:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473715",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29411, #29847, #29701** to **#29411, #29701**



---

archive/issue_comments_473716.json:
```json
{
    "body": "Changed work issues from **Rebase away from #29847** to none",
    "created_at": "2020-06-28T19:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473716",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **Rebase away from #29847** to none



---

archive/issue_comments_473717.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n\n```\n    from .maxima import maxima, Maxima\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python/lib/python3.7/site-packages/sage/interfaces/maxima.py\", line 1236, in <module>\n    script_subdirectory=None)\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python/lib/python3.7/site-packages/sage/interfaces/maxima.py\", line 528, in __init__\n    raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')\nRuntimeError: You must get the file local/bin/sage-maxima.lisp\n```",
    "created_at": "2020-06-28T19:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473717",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>


```
    from .maxima import maxima, Maxima
  File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python/lib/python3.7/site-packages/sage/interfaces/maxima.py", line 1236, in <module>
    script_subdirectory=None)
  File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python/lib/python3.7/site-packages/sage/interfaces/maxima.py", line 528, in __init__
    raise RuntimeError('You must get the file local/bin/sage-maxima.lisp')
RuntimeError: You must get the file local/bin/sage-maxima.lisp
```



---

archive/issue_comments_473718.json:
```json
{
    "body": "Changed dependencies from **#29411, #29701** to **#29411, #29701, #27171**",
    "created_at": "2020-06-28T19:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473718",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29411, #29701** to **#29411, #29701, #27171**



---

archive/issue_comments_473719.json:
```json
{
    "body": "Changed dependencies from **#29411, #29701, #27171** to **#29411, #29701, #21559**",
    "created_at": "2020-06-28T19:18:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473719",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29411, #29701, #27171** to **#29411, #29701, #21559**



---

archive/issue_comments_473720.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/875940dea7853575e42f567759bcaa5392d6c5b3\"><code>875940d</code></a></td><td><code>trac 29111: more tinkering. Fix doctests in tests/cmdline.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a3d36eb78976d31d9d27623712b2af7b6b74006\"><code>4a3d36e</code></a></td><td><code>Move 'sage -app' back to src/bin/sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a0193c9f0a12407ac3708fea6d70c9b72d4f864\"><code>3a0193c</code></a></td><td><code>src/bin/sage: Remove handling of 'sage -axiom'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b04075aca84249a2418a365f31ea4a0978461a8\"><code>6b04075</code></a></td><td><code>Merge branch 't/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c7116b5cb5bb36cfa4834719d7cd4220fae0d91\"><code>9c7116b</code></a></td><td><code>src/bin/sage-list-optional, sage-list-experimental, sage-list-standard: Remove deprecated scripts</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/831cc09d32828144a27f7bc8c8b2f70150ed0047\"><code>831cc09</code></a></td><td><code>Merge branch 't/29920/remove_deprecated_scripts_sage_list_optional__sage_list_experimental__sage_list_standard' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a56dc35031486df9378f17c2d2ae6405946fac25\"><code>a56dc35</code></a></td><td><code>Merge tag '9.2.beta1' into t/29702/public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3eca857db71b602cf2c7c16755ab2cdeaca1773\"><code>e3eca85</code></a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d29141662fe9ffd80c61e8867153244004d0a37\"><code>7d29141</code></a></td><td><code>src/setup.py: Do not install removed script sage-rsyncdist</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08f5175bdf71236ccf3e80f6efaffa83d5edc532\"><code>08f5175</code></a></td><td><code>Merge branch 'u/mkoeppe/change-src-bin-installation' of git://trac.sagemath.org/sage into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>\n",
    "created_at": "2020-06-28T19:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473720",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/875940dea7853575e42f567759bcaa5392d6c5b3"><code>875940d</code></a></td><td><code>trac 29111: more tinkering. Fix doctests in tests/cmdline.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a3d36eb78976d31d9d27623712b2af7b6b74006"><code>4a3d36e</code></a></td><td><code>Move 'sage -app' back to src/bin/sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a0193c9f0a12407ac3708fea6d70c9b72d4f864"><code>3a0193c</code></a></td><td><code>src/bin/sage: Remove handling of 'sage -axiom'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b04075aca84249a2418a365f31ea4a0978461a8"><code>6b04075</code></a></td><td><code>Merge branch 't/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c7116b5cb5bb36cfa4834719d7cd4220fae0d91"><code>9c7116b</code></a></td><td><code>src/bin/sage-list-optional, sage-list-experimental, sage-list-standard: Remove deprecated scripts</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/831cc09d32828144a27f7bc8c8b2f70150ed0047"><code>831cc09</code></a></td><td><code>Merge branch 't/29920/remove_deprecated_scripts_sage_list_optional__sage_list_experimental__sage_list_standard' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a56dc35031486df9378f17c2d2ae6405946fac25"><code>a56dc35</code></a></td><td><code>Merge tag '9.2.beta1' into t/29702/public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3eca857db71b602cf2c7c16755ab2cdeaca1773"><code>e3eca85</code></a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d29141662fe9ffd80c61e8867153244004d0a37"><code>7d29141</code></a></td><td><code>src/setup.py: Do not install removed script sage-rsyncdist</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08f5175bdf71236ccf3e80f6efaffa83d5edc532"><code>08f5175</code></a></td><td><code>Merge branch 'u/mkoeppe/change-src-bin-installation' of git://trac.sagemath.org/sage into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>




---

archive/issue_comments_473721.json:
```json
{
    "body": "Changed commit from **[`9955a3f`](https://github.com/sagemath/sagetrac-mirror/commit/9955a3ff69870ff844e5ebb45cf47c4b6f214263)** to **[`08f5175`](https://github.com/sagemath/sagetrac-mirror/commit/08f5175bdf71236ccf3e80f6efaffa83d5edc532)**",
    "created_at": "2020-06-28T19:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473721",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9955a3f`](https://github.com/sagemath/sagetrac-mirror/commit/9955a3ff69870ff844e5ebb45cf47c4b6f214263)** to **[`08f5175`](https://github.com/sagemath/sagetrac-mirror/commit/08f5175bdf71236ccf3e80f6efaffa83d5edc532)**



---

archive/issue_comments_473722.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n As a follow-up to #29411, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`.\n \n-We fix `setup.py sdist`, which can be tested using `spkg-src` and `tox`.\n+We fix `setup.py sdist`, which can be tested using `spkg-src` (which builds a pip-installable tarball in `upstream/`) and `tox`:\n \n ```\n ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'\n``````\n",
    "created_at": "2020-06-28T19:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473722",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 As a follow-up to #29411, we set up a separate directory `build/pkgs/sagelib/src` with symlinks into `SAGE_ROOT/src` so that sagelib's `setup.py` does not have access to the whole tree `SAGE_ROOT/src`.
 
-We fix `setup.py sdist`, which can be tested using `spkg-src` and `tox`.
+We fix `setup.py sdist`, which can be tested using `spkg-src` (which builds a pip-installable tarball in `upstream/`) and `tox`:
 
 ```
 ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'
``````




---

archive/issue_comments_473723.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n\n```\n./sage -sh -c '(cd build/pkgs/sagelib/src && tox -r -v -v)'\n...\nRuntimeError: libSingular not found--a working Singular install in $SAGE_LOCAL is required for Sage to work\nERROR: InvocationError for command /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python/bin/python -c 'import sys; \"\" in sys.path and sys.path.remove(\"\"); import sage.all' (exited with code 1)\n```\n\nThis is because of:\n\n```\n$ build/pkgs/sagelib/src/.tox/python/bin/python\nPython 3.7.7 (v3.7.7:d7c567b08f, Mar 10 2020, 02:56:16) \n[Clang 6.0 (clang-600.0.57)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import sage.env\n>>> sage.env.SINGULAR_SO\n>>> sage.env.GAP_SO\n>>> sage.env.SAGE_LOCAL\n'/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python'\n>>> \n```",
    "created_at": "2020-06-28T20:36:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473723",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>


```
./sage -sh -c '(cd build/pkgs/sagelib/src && tox -r -v -v)'
...
RuntimeError: libSingular not found--a working Singular install in $SAGE_LOCAL is required for Sage to work
ERROR: InvocationError for command /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python/bin/python -c 'import sys; "" in sys.path and sys.path.remove(""); import sage.all' (exited with code 1)
```

This is because of:

```
$ build/pkgs/sagelib/src/.tox/python/bin/python
Python 3.7.7 (v3.7.7:d7c567b08f, Mar 10 2020, 02:56:16) 
[Clang 6.0 (clang-600.0.57)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import sage.env
>>> sage.env.SINGULAR_SO
>>> sage.env.GAP_SO
>>> sage.env.SAGE_LOCAL
'/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/.tox/python'
>>> 
```



---

archive/issue_comments_473724.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nPassing the correct `SAGE_LOCAL` suffices to fix this, of course. But the singular library location should be configured separately (#29024).",
    "created_at": "2020-06-28T20:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473724",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Passing the correct `SAGE_LOCAL` suffices to fix this, of course. But the singular library location should be configured separately (#29024).



---

archive/issue_comments_473725.json:
```json
{
    "body": "Changed commit from **[`08f5175`](https://github.com/sagemath/sagetrac-mirror/commit/08f5175bdf71236ccf3e80f6efaffa83d5edc532)** to **[`516358b`](https://github.com/sagemath/sagetrac-mirror/commit/516358b66059dbf458ed7c970ff05923b539b71c)**",
    "created_at": "2020-06-28T20:48:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473725",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`08f5175`](https://github.com/sagemath/sagetrac-mirror/commit/08f5175bdf71236ccf3e80f6efaffa83d5edc532)** to **[`516358b`](https://github.com/sagemath/sagetrac-mirror/commit/516358b66059dbf458ed7c970ff05923b539b71c)**



---

archive/issue_comments_473726.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/516358b66059dbf458ed7c970ff05923b539b71c\"><code>516358b</code></a></td><td><code>build/pkgs/sagelib/src/tox.ini: Pass SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2020-06-28T20:48:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473726",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/516358b66059dbf458ed7c970ff05923b539b71c"><code>516358b</code></a></td><td><code>build/pkgs/sagelib/src/tox.ini: Pass SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_473727.json:
```json
{
    "body": "Changed commit from **[`516358b`](https://github.com/sagemath/sagetrac-mirror/commit/516358b66059dbf458ed7c970ff05923b539b71c)** to **[`eaced09`](https://github.com/sagemath/sagetrac-mirror/commit/eaced098339d5c7655244667b3dd1c90f5fd7f9e)**",
    "created_at": "2020-06-28T22:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473727",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`516358b`](https://github.com/sagemath/sagetrac-mirror/commit/516358b66059dbf458ed7c970ff05923b539b71c)** to **[`eaced09`](https://github.com/sagemath/sagetrac-mirror/commit/eaced098339d5c7655244667b3dd1c90f5fd7f9e)**



---

archive/issue_comments_473728.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d62da1559ca1448b07962ea69fcde212cfea75f0\"><code>d62da15</code></a></td><td><code>sage_setup.command.sage_build: Add the extensions to the distribution</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e577ab0bc470fb6d74500b5e855b3b6f828dd50\"><code>5e577ab</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eaced098339d5c7655244667b3dd1c90f5fd7f9e\"><code>eaced09</code></a></td><td><code>build/pkgs/sagelib: Add remaining Python dependencies for sage.all</code></td></tr></table>\n",
    "created_at": "2020-06-28T22:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473728",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d62da1559ca1448b07962ea69fcde212cfea75f0"><code>d62da15</code></a></td><td><code>sage_setup.command.sage_build: Add the extensions to the distribution</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e577ab0bc470fb6d74500b5e855b3b6f828dd50"><code>5e577ab</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eaced098339d5c7655244667b3dd1c90f5fd7f9e"><code>eaced09</code></a></td><td><code>build/pkgs/sagelib: Add remaining Python dependencies for sage.all</code></td></tr></table>




---

archive/issue_comments_473729.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,5 +4,6 @@\n \n ```\n ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'\n+./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'\n ```\n \n``````\n",
    "created_at": "2020-06-28T23:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473729",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,5 +4,6 @@
 
 ```
 ./sage -sh -c '(cd build/pkgs/sagelib/src && tox -v -v)'
+./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'
 ```
 
``````




---

archive/issue_events_409261.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-28T23:08:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409261"
}
```



---

archive/issue_comments_473730.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,5 @@\n ./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'\n ```\n \n+Scripts installed into the tox virtual environment that use `sage-env` do not work yet -- `sage-env` sets things based on `SAGE_LOCAL` again.\n+\n``````\n",
    "created_at": "2020-06-28T23:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473730",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,5 @@
 ./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'
 ```
 
+Scripts installed into the tox virtual environment that use `sage-env` do not work yet -- `sage-env` sets things based on `SAGE_LOCAL` again.
+
``````




---

archive/issue_comments_473731.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n ./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'\n ```\n \n-Scripts installed into the tox virtual environment that use `sage-env` do not work yet -- `sage-env` sets things based on `SAGE_LOCAL` again.\n-\n+The call of `./sage -sh` is necessary so that `SAGE_LOCAL` is set. \n+Moreover, for scripts that use `sage-env`, also `SAGE_ENV_SOURCED` is crucial for the correct operation; otherwise `sage-env` sets things based on `SAGE_LOCAL` again. \n``````\n",
    "created_at": "2020-06-28T23:54:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473731",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 ./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage-ipython'
 ```
 
-Scripts installed into the tox virtual environment that use `sage-env` do not work yet -- `sage-env` sets things based on `SAGE_LOCAL` again.
-
+The call of `./sage -sh` is necessary so that `SAGE_LOCAL` is set. 
+Moreover, for scripts that use `sage-env`, also `SAGE_ENV_SOURCED` is crucial for the correct operation; otherwise `sage-env` sets things based on `SAGE_LOCAL` again. 
``````




---

archive/issue_comments_473732.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThe `sage` script relies on `PATH` to be set correctly when invoking auxiliary scripts such as `sage-eval`.  Hence the following does not work correctly:\n\n```\n$ ./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage -c \"print(sys.path)\"'\n['/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/bin', '/Library/Frameworks/Python.framework/Versions/3.7/lib/python37.zip', '/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7', '/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/lib-dynload', '/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages']\n```",
    "created_at": "2020-06-28T23:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473732",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

The `sage` script relies on `PATH` to be set correctly when invoking auxiliary scripts such as `sage-eval`.  Hence the following does not work correctly:

```
$ ./sage -sh -c 'build/pkgs/sagelib/src/.tox/python/bin/sage -c "print(sys.path)"'
['/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/src/bin', '/Library/Frameworks/Python.framework/Versions/3.7/lib/python37.zip', '/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7', '/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/lib-dynload', '/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages']
```



---

archive/issue_comments_473733.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThis will be fixed by #30013 (`src/bin/sage-env`: Make sure `SAGE_SCRIPTS_DIR` is at the beginning of the `PATH`).",
    "created_at": "2020-06-29T00:10:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473733",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

This will be fixed by #30013 (`src/bin/sage-env`: Make sure `SAGE_SCRIPTS_DIR` is at the beginning of the `PATH`).



---

archive/issue_comments_473734.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4\"><code>b8e366e</code></a></td><td><code>build/pkgs/sagelib/spkg-src: chmod +x</code></td></tr></table>\n",
    "created_at": "2020-06-29T00:11:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473734",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4"><code>b8e366e</code></a></td><td><code>build/pkgs/sagelib/spkg-src: chmod +x</code></td></tr></table>




---

archive/issue_comments_473735.json:
```json
{
    "body": "Changed commit from **[`eaced09`](https://github.com/sagemath/sagetrac-mirror/commit/eaced098339d5c7655244667b3dd1c90f5fd7f9e)** to **[`b8e366e`](https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4)**",
    "created_at": "2020-06-29T00:11:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473735",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`eaced09`](https://github.com/sagemath/sagetrac-mirror/commit/eaced098339d5c7655244667b3dd1c90f5fd7f9e)** to **[`b8e366e`](https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4)**



---

archive/issue_comments_473736.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nAll dependencies of this ticket are green. Ready for review.",
    "created_at": "2020-07-02T20:14:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473736",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

All dependencies of this ticket are green. Ready for review.



---

archive/issue_comments_473737.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5f7f2fb29d376c6bb103e2f070f92690c689161\"><code>c5f7f2f</code></a></td><td><code>Merge tag '9.2.beta3' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0473ef3670f0a39c7d0141c09b9e9fc738d3d0b2\"><code>0473ef3</code></a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06a360974cc56699a85f291494a493fed041dbc9\"><code>06a3609</code></a></td><td><code>sage_setup.find.find_python_sources: Add benchmark doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/174626c7f81e7b9417bbad49fd110144a07165a6\"><code>174626c</code></a></td><td><code>Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/034a7f71a52fffc9a6566bda3e63abccdb5d6825\"><code>034a7f7</code></a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3c608b0d59077ef2ec58d32a5da0dccdbcddfd8\"><code>d3c608b</code></a></td><td><code>Merge tag '9.2.beta3' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06\"><code>7244371</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>\n",
    "created_at": "2020-07-04T16:30:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473737",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5f7f2fb29d376c6bb103e2f070f92690c689161"><code>c5f7f2f</code></a></td><td><code>Merge tag '9.2.beta3' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0473ef3670f0a39c7d0141c09b9e9fc738d3d0b2"><code>0473ef3</code></a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06a360974cc56699a85f291494a493fed041dbc9"><code>06a3609</code></a></td><td><code>sage_setup.find.find_python_sources: Add benchmark doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/174626c7f81e7b9417bbad49fd110144a07165a6"><code>174626c</code></a></td><td><code>Merge branch 't/29786/move_extension_options_from_src_module_list_py_to__distutils___directives_in_the_individual_files__part_4__sage_rings_' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/034a7f71a52fffc9a6566bda3e63abccdb5d6825"><code>034a7f7</code></a></td><td><code>Merge branch 'public/move_all_code_from_src_setup_py__src_fpickle_setup_py_to_sage_setup' of git://trac.sagemath.org/sage into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3c608b0d59077ef2ec58d32a5da0dccdbcddfd8"><code>d3c608b</code></a></td><td><code>Merge tag '9.2.beta3' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06"><code>7244371</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>




---

archive/issue_comments_473738.json:
```json
{
    "body": "Changed commit from **[`b8e366e`](https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4)** to **[`7244371`](https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06)**",
    "created_at": "2020-07-04T16:30:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473738",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b8e366e`](https://github.com/sagemath/sagetrac-mirror/commit/b8e366ec56a9d3527c81df9d8d4206afc2562be4)** to **[`7244371`](https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06)**



---

archive/issue_comments_473739.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nMerged in latest versions #29701, #21559 (on top of 9.2.beta3). Needs review",
    "created_at": "2020-07-04T16:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473739",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Merged in latest versions #29701, #21559 (on top of 9.2.beta3). Needs review



---

archive/issue_comments_473740.json:
```json
{
    "body": "Changed commit from **[`7244371`](https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06)** to **[`4344f89`](https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f)**",
    "created_at": "2020-07-08T23:26:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473740",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7244371`](https://github.com/sagemath/sagetrac-mirror/commit/72443711047daa51d1ba92b087ec9022b2eeef06)** to **[`4344f89`](https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f)**



---

archive/issue_comments_473741.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39536716aef05e8953bdc50038c49e5959ffdb6a\"><code>3953671</code></a></td><td><code>Merge tag '9.2.beta4' into t/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19d7f677eab07dc41e3f1e71b9a37f3b58560c39\"><code>19d7f67</code></a></td><td><code>Merge branch 't/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f\"><code>4344f89</code></a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>\n",
    "created_at": "2020-07-08T23:26:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473741",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39536716aef05e8953bdc50038c49e5959ffdb6a"><code>3953671</code></a></td><td><code>Merge tag '9.2.beta4' into t/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19d7f677eab07dc41e3f1e71b9a37f3b58560c39"><code>19d7f67</code></a></td><td><code>Merge branch 't/29111/specify_a_subset_of_sage_command_line_options_that_are_supported_by_sagelib___rather_than_sage_the_distribution' into t/21559/change-src-bin-installation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f"><code>4344f89</code></a></td><td><code>Merge branch 't/21559/change-src-bin-installation' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>




---

archive/issue_comments_473742.json:
```json
{
    "body": "Changed commit from **[`4344f89`](https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f)** to **[`01b96b0`](https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58)**",
    "created_at": "2020-08-03T00:53:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473742",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4344f89`](https://github.com/sagemath/sagetrac-mirror/commit/4344f8940fc44d959da5d20dbea43b64181b961f)** to **[`01b96b0`](https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58)**



---

archive/issue_comments_473743.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcad5184daba6a9d1d347950b3908fc98ec856ce\"><code>fcad518</code></a></td><td><code>Merge tag '9.2.beta7' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55c3fbc565fd7884f3df9555de83dd326ace276e\"><code>55c3fbc</code></a></td><td><code>src/sage_setup/clean.py: Fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58\"><code>01b96b0</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>\n",
    "created_at": "2020-08-03T00:53:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473743",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcad5184daba6a9d1d347950b3908fc98ec856ce"><code>fcad518</code></a></td><td><code>Merge tag '9.2.beta7' into t/29701/replace_use_of_module_list_optionalextension</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55c3fbc565fd7884f3df9555de83dd326ace276e"><code>55c3fbc</code></a></td><td><code>src/sage_setup/clean.py: Fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58"><code>01b96b0</code></a></td><td><code>Merge branch 't/29701/replace_use_of_module_list_optionalextension' into t/29950/build_sagelib_using_installed_sage_setup</code></td></tr></table>




---

archive/issue_comments_473744.json:
```json
{
    "body": "Changed dependencies from **#29411, #29701, #21559** to **#29701**",
    "created_at": "2020-08-03T00:54:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473744",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#29411, #29701, #21559** to **#29701**



---

archive/issue_comments_473745.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nlgtm",
    "created_at": "2020-08-05T08:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473745",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

lgtm



---

archive/issue_comments_473746.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-08-05T08:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473746",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_409262.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-08-05T08:22:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409262"
}
```



---

archive/issue_events_409263.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-08-05T08:22:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409263"
}
```



---

archive/issue_events_409264.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T20:50:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409264"
}
```



---

archive/issue_events_409265.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T20:50:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409265"
}
```



---

archive/issue_comments_473747.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nFailing doctest needs work as noted in #29701.",
    "created_at": "2020-08-08T20:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473747",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

Failing doctest needs work as noted in #29701.



---

archive/issue_comments_473748.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca\"><code>8a19fe2</code></a></td><td><code>build/make/Makefile.in (sagelib-clean): Clean the new build location</code></td></tr></table>\n",
    "created_at": "2020-08-08T22:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473748",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca"><code>8a19fe2</code></a></td><td><code>build/make/Makefile.in (sagelib-clean): Clean the new build location</code></td></tr></table>




---

archive/issue_comments_473749.json:
```json
{
    "body": "Changed commit from **[`01b96b0`](https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58)** to **[`8a19fe2`](https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca)**",
    "created_at": "2020-08-08T22:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473749",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`01b96b0`](https://github.com/sagemath/sagetrac-mirror/commit/01b96b0f44f4ff7407fd2f3ce83de1cc74259d58)** to **[`8a19fe2`](https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca)**



---

archive/issue_comments_473750.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473\"><code>ccc67b0</code></a></td><td><code>src/sage_setup: Update cythonized_dir in doctests</code></td></tr></table>\n",
    "created_at": "2020-08-08T23:08:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473750",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473"><code>ccc67b0</code></a></td><td><code>src/sage_setup: Update cythonized_dir in doctests</code></td></tr></table>




---

archive/issue_comments_473751.json:
```json
{
    "body": "Changed commit from **[`8a19fe2`](https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca)** to **[`ccc67b0`](https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473)**",
    "created_at": "2020-08-08T23:08:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473751",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8a19fe2`](https://github.com/sagemath/sagetrac-mirror/commit/8a19fe2a9bf4ed64a48ac3110cccbbdff97684ca)** to **[`ccc67b0`](https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473)**



---

archive/issue_events_409266.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T23:11:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409266"
}
```



---

archive/issue_events_409267.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-08T23:11:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409267"
}
```



---

archive/issue_events_409268.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-08-10T16:45:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409268"
}
```



---

archive/issue_events_409269.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-08-10T16:45:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409269"
}
```



---

archive/issue_comments_473752.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nok",
    "created_at": "2020-08-10T16:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473752",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:42" align="right">comment:42</div>

ok



---

archive/issue_comments_473753.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nThanks!",
    "created_at": "2020-08-10T16:51:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473753",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">comment:43</div>

Thanks!



---

archive/issue_events_409270.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-12T19:53:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409270"
}
```



---

archive/issue_events_409271.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "eaa2f0a3613296cb880dd0c5c22f5656532286ab",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-08-12T19:53:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29950#event-409271"
}
```



---

archive/issue_comments_473754.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/build_sagelib_using_installed_sage_setup](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/build_sagelib_using_installed_sage_setup)** to **[`ccc67b0`](https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473)**",
    "created_at": "2020-08-12T19:53:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29950#issuecomment-473754",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/build_sagelib_using_installed_sage_setup](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/build_sagelib_using_installed_sage_setup)** to **[`ccc67b0`](https://github.com/sagemath/sagetrac-mirror/commit/ccc67b0356373330164dd75060f574c184142473)**
