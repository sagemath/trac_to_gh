# Issue 29387: Complete solution for installing the generated *.pc files

archive/issues_029150.json:
```json
{
    "assignees": [],
    "body": "Follow up from #29082.\n\nThis ticket makes sure that **installed** pc files in `SAGE_LOCAL` are uninstalled correctly when the installation changes, via the staging/uninstalling mechanism extended to script packages by #29386.\n\n- Code in `build/make/Makefile.in` is removed in favor of creating one or several new type=script packages, whose `spkg-install` does the installation to `SAGE_LOCAL`.\n\n\n\nDepends on #29082\nDepends on #29386\n\nCC:  @dimpase @jhpalmieri\n\nBranch/Commit: **[u/mkoeppe/system_blas_facade](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/system_blas_facade) @ [b493a32](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29387_\n\n",
    "created_at": "2020-03-21T15:46:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Complete solution for installing the generated *.pc files",
    "type": "issue",
    "updated_at": "2023-01-07T21:39:40Z",
    "url": "https://github.com/sagemath/sage/issues/29387",
    "user": "https://github.com/mkoeppe"
}
```
Follow up from #29082.

This ticket makes sure that **installed** pc files in `SAGE_LOCAL` are uninstalled correctly when the installation changes, via the staging/uninstalling mechanism extended to script packages by #29386.

- Code in `build/make/Makefile.in` is removed in favor of creating one or several new type=script packages, whose `spkg-install` does the installation to `SAGE_LOCAL`.



Depends on #29082
Depends on #29386

CC:  @dimpase @jhpalmieri

Branch/Commit: **[u/mkoeppe/system_blas_facade](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/system_blas_facade) @ [b493a32](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)**

_Issue created by migration from https://trac.sagemath.org/ticket/29387_





---

archive/issue_events_385818.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-21T15:46:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385818"
}
```



---

archive/issue_events_385819.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-21T15:46:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385819"
}
```



---

archive/issue_events_385820.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-21T15:46:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385820"
}
```



---

archive/issue_events_385821.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-03-21T15:46:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385821"
}
```



---

archive/issue_comments_464193.json:
```json
{
    "body": "Branch: **[u/mkoeppe/system_blas_facade](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/system_blas_facade)**",
    "created_at": "2020-03-21T15:48:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29387#issuecomment-464193",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/system_blas_facade](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/system_blas_facade)**



---

archive/issue_comments_464194.json:
```json
{
    "body": "Commit: **[b493a32](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)**",
    "created_at": "2020-03-21T15:49:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29387#issuecomment-464194",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[b493a32](https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676)**



---

archive/issue_comments_464195.json:
```json
{
    "body": "Dependencies: **#29082, #29386**",
    "created_at": "2020-03-21T15:49:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29387#issuecomment-464195",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#29082, #29386**



---

archive/issue_comments_464196.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThe branch on the ticket is the old branch from #29082. Needs work.\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbb9860cb41006fbe4108447f4f01e26ed8f0bdd\">dbb9860</a></td><td><code>build/pkgs/texlive/spkg-install: Fix up path</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b1d5ca6074561315be14ea4f072149b88fe2fd0\">8b1d5ca</a></td><td><code>trac 29287: rewording documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/057a66bdd05ad75539f2bdbd27561af3f0d57d65\">057a66b</a></td><td><code>Make pyopenssl a pip package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f6323ed8af19d0c1301c65e41d3b219a8fa7a43\">8f6323e</a></td><td><code>src/sage/env.py: Fix up doctest on starting sage without SAGE_* variables</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/091908665ae681b6f9cc1f491d4801acbdfb89ae\">0919086</a></td><td><code>trac 29287: doc fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67817908a4b8956b7a78d15295d1af3c0865bb82\">6781790</a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86\">30d3b82</a></td><td><code>build/pkgs/openblas/spkg-configure.m4: Separate library names by spaces</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b68595e74582eacd050b93312610f0ece11d2a93\">b68595e</a></td><td><code>Change type</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f\">7fd5e31</a></td><td><code>fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676\">b493a32</a></td><td><code>install sage_system_blas_facade</code></td></tr></table>\n",
    "created_at": "2020-03-21T15:49:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29387#issuecomment-464196",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'>Comment 2:</a>
The branch on the ticket is the old branch from #29082. Needs work.

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbb9860cb41006fbe4108447f4f01e26ed8f0bdd">dbb9860</a></td><td><code>build/pkgs/texlive/spkg-install: Fix up path</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b1d5ca6074561315be14ea4f072149b88fe2fd0">8b1d5ca</a></td><td><code>trac 29287: rewording documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/057a66bdd05ad75539f2bdbd27561af3f0d57d65">057a66b</a></td><td><code>Make pyopenssl a pip package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f6323ed8af19d0c1301c65e41d3b219a8fa7a43">8f6323e</a></td><td><code>src/sage/env.py: Fix up doctest on starting sage without SAGE_* variables</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/091908665ae681b6f9cc1f491d4801acbdfb89ae">0919086</a></td><td><code>trac 29287: doc fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67817908a4b8956b7a78d15295d1af3c0865bb82">6781790</a></td><td><code>Move all BLAS PC file installation logic to new script package sage_sage_system_blas_facade</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30d3b8245cbcee8c7b629dfebc9de213e89f7c86">30d3b82</a></td><td><code>build/pkgs/openblas/spkg-configure.m4: Separate library names by spaces</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b68595e74582eacd050b93312610f0ece11d2a93">b68595e</a></td><td><code>Change type</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7fd5e31fa51e0f9a662848450dbae37732468d6f">7fd5e31</a></td><td><code>fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b493a32df5c9bb08613e370759412e55a2501676">b493a32</a></td><td><code>install sage_system_blas_facade</code></td></tr></table>




---

archive/issue_comments_464197.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\npushing these forward to 9.2",
    "created_at": "2020-04-14T06:33:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29387#issuecomment-464197",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'>Comment 3:</a>
pushing these forward to 9.2



---

archive/issue_events_385822.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:33:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385822"
}
```



---

archive/issue_events_385823.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:33:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385823"
}
```



---

archive/issue_events_385824.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385824"
}
```



---

archive/issue_events_385825.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385825"
}
```



---

archive/issue_events_385826.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385826"
}
```



---

archive/issue_events_385827.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385827"
}
```



---

archive/issue_comments_464198.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29387#issuecomment-464198",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>Comment 5:</a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_385828.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385828"
}
```



---

archive/issue_events_385829.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385829"
}
```



---

archive/issue_events_385830.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385830"
}
```



---

archive/issue_events_385831.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385831"
}
```



---

archive/issue_events_385832.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385832"
}
```



---

archive/issue_events_385833.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385833"
}
```



---

archive/issue_events_385834.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385834"
}
```



---

archive/issue_events_385835.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385835"
}
```



---

archive/issue_events_385836.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385836"
}
```



---

archive/issue_events_385837.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29387",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29387#event-385837"
}
```
