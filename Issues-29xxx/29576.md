# Issue 29576: Sage documentation search page broken

archive/issues_029339.json:
```json
{
    "body": "Go to \nhttps://doc.sagemath.org/html/en/reference/search.html?q=modules\n\nand see the many [object Object] labels throughout the page.\n\nCC:  @jcamp0x2a @kwankyu @haraldschilly @slel @williamstein\n\nKeywords: online_documentation, search, js\n\nReviewer: Matthias Koeppe\n\nBranch: u/klee/29576\n\nCommit: 74d1330a311ad7142b096f23838edca8c8e98f93\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/29576\n\n",
    "closed_at": "2022-02-26T18:53:04Z",
    "created_at": "2020-04-25T07:52:49Z",
    "labels": [
        "component: documentation",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Sage documentation search page broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29576",
    "user": "https://github.com/antonio-rojas"
}
```
Go to 
https://doc.sagemath.org/html/en/reference/search.html?q=modules

and see the many [object Object] labels throughout the page.

CC:  @jcamp0x2a @kwankyu @haraldschilly @slel @williamstein

Keywords: online_documentation, search, js

Reviewer: Matthias Koeppe

Branch: u/klee/29576

Commit: 74d1330a311ad7142b096f23838edca8c8e98f93

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/29576





---

archive/issue_events_075489.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-17T18:33:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75489"
}
```



---

archive/issue_comments_578353.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578353",
    "user": "https://github.com/slel"
}
```

Changing priority from major to critical.



---

archive/issue_comments_578354.json:
```json
{
    "body": "Changing keywords from \"\" to \"online_documentation, search, js\".",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578354",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "online_documentation, search, js".



---

archive/issue_comments_578355.json:
```json
{
    "body": "<a id='comment:4'></a>Restoring the online documentation's search box\nseems critical to me.\n\nCan anyone help with that?",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578355",
    "user": "https://github.com/slel"
}
```

<a id='comment:4'></a>Restoring the online documentation's search box
seems critical to me.

Can anyone help with that?



---

archive/issue_events_075490.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75490"
}
```



---

archive/issue_events_075491.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75491"
}
```



---

archive/issue_comments_578356.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [slelievre](#comment%3A4):\n> Restoring the online documentation's search box\n> seems critical to me.\n> \n> Can anyone help with that?\n\n\nWhat is the normal result of the search box? What should be shown? Would you explain?",
    "created_at": "2021-04-14T01:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578356",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'></a>Replying to [slelievre](#comment%3A4):
> Restoring the online documentation's search box
> seems critical to me.
> 
> Can anyone help with that?


What is the normal result of the search box? What should be shown? Would you explain?



---

archive/issue_comments_578357.json:
```json
{
    "body": "<a id='comment:8'></a>Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578357",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_075492.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75492"
}
```



---

archive/issue_events_075493.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75493"
}
```



---

archive/issue_events_075494.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75494"
}
```



---

archive/issue_events_075495.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75495"
}
```



---

archive/issue_comments_578358.json:
```json
{
    "body": "<a id='comment:10'></a>Reported again in https://groups.google.com/g/sage-devel/c/FxjVDtqxw1U/m/t_K6IDjUAAAJ",
    "created_at": "2021-11-11T00:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578358",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Reported again in https://groups.google.com/g/sage-devel/c/FxjVDtqxw1U/m/t_K6IDjUAAAJ



---

archive/issue_comments_578359.json:
```json
{
    "body": "<a id='comment:11'></a>See also: #31415",
    "created_at": "2021-11-11T01:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578359",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>See also: #31415



---

archive/issue_comments_578360.json:
```json
{
    "body": "Changing branch from \"\" to \"u/klee/29576\"",
    "created_at": "2021-11-11T07:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578360",
    "user": "https://github.com/kwankyu"
}
```

Changing branch from "" to "u/klee/29576"



---

archive/issue_comments_578361.json:
```json
{
    "body": "Changing author from \"\" to \"Kwankyu Lee\"",
    "created_at": "2021-11-11T07:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578361",
    "user": "https://github.com/kwankyu"
}
```

Changing author from "" to "Kwankyu Lee"



---

archive/issue_comments_578362.json:
```json
{
    "body": "Changing commit from \"\" to \"74d1330a311ad7142b096f23838edca8c8e98f93\"",
    "created_at": "2021-11-11T07:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "74d1330a311ad7142b096f23838edca8c8e98f93"



---

archive/issue_comments_578363.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-11T07:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_578364.json:
```json
{
    "body": "<a id='comment:14'></a>The patch revives search page. \n\nFor this, I had to turn off Thebe (see changes in `layout.html`), which seems to conflict with `underline.js`. Actually it seems old Thebe javascript file is to blame, as with the latest one from CDN works fine with the search page.\n\nI am not sure if Thebe still works with Sage. See related #24593. If we cannot turn off Thebe, then please provide updated javascript (here or to #24593).",
    "created_at": "2021-11-11T08:04:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578364",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>The patch revives search page. 

For this, I had to turn off Thebe (see changes in `layout.html`), which seems to conflict with `underline.js`. Actually it seems old Thebe javascript file is to blame, as with the latest one from CDN works fine with the search page.

I am not sure if Thebe still works with Sage. See related #24593. If we cannot turn off Thebe, then please provide updated javascript (here or to #24593).



---

archive/issue_comments_578365.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2021-11-11T08:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578365",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_578366.json:
```json
{
    "body": "<a id='comment:16'></a>What I did is mostly to make our customized `layout.html` and `search.html` to be close to original ones from Sphinx.",
    "created_at": "2021-11-11T08:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578366",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:16'></a>What I did is mostly to make our customized `layout.html` and `search.html` to be close to original ones from Sphinx.



---

archive/issue_comments_578367.json:
```json
{
    "body": "<a id='comment:18'></a>See also #32854.",
    "created_at": "2021-11-12T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578367",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>See also #32854.



---

archive/issue_comments_578368.json:
```json
{
    "body": "<a id='comment:19'></a>Set milestone to sage-9.6 after Sage 9.5 release.",
    "created_at": "2022-01-30T15:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578368",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>Set milestone to sage-9.6 after Sage 9.5 release.



---

archive/issue_events_075496.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75496"
}
```



---

archive/issue_events_075497.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75497"
}
```



---

archive/issue_events_075498.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75498"
}
```



---

archive/issue_events_075499.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75499"
}
```



---

archive/issue_comments_578369.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-02-10T12:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578369",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_578370.json:
```json
{
    "body": "<a id='comment:20'></a>The code in this ticket is now merged to the branch of #33309. Hence we close this ticket.",
    "created_at": "2022-02-10T12:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578370",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>The code in this ticket is now merged to the branch of #33309. Hence we close this ticket.



---

archive/issue_comments_578371.json:
```json
{
    "body": "Changing author from \"Kwankyu Lee\" to \"\"",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578371",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Kwankyu Lee" to ""



---

archive/issue_comments_578372.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578372",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_578373.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578373",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_578374.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-02-26T18:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-578374",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid



---

archive/issue_events_075500.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-26T18:53:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-75500"
}
```
