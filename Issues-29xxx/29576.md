# Issue 29576: Sage documentation search page broken

archive/issues_029339.json:
```json
{
    "body": "Go to \nhttps://doc.sagemath.org/html/en/reference/search.html?q=modules\n\nand see the many [object Object] labels throughout the page.\n\nCC:  @jcamp0x2a @kwankyu @haraldschilly @slel @williamstein\n\nKeywords: online_documentation, search, js\n\nBranch: [u/klee/29576](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/29576)\n\nReviewer: Matthias Koeppe\n\nCommit: 74d1330a311ad7142b096f23838edca8c8e98f93\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/29576\n\n",
    "closed_at": "2022-02-26T18:53:04Z",
    "created_at": "2020-04-25T07:52:49Z",
    "labels": [
        "component: documentation",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Sage documentation search page broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29576",
    "user": "https://github.com/antonio-rojas"
}
```
Go to 
https://doc.sagemath.org/html/en/reference/search.html?q=modules

and see the many [object Object] labels throughout the page.

CC:  @jcamp0x2a @kwankyu @haraldschilly @slel @williamstein

Keywords: online_documentation, search, js

Branch: [u/klee/29576](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/29576)

Reviewer: Matthias Koeppe

Commit: 74d1330a311ad7142b096f23838edca8c8e98f93

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/29576





---

archive/issue_events_085193.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-17T18:33:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85193"
}
```



---

archive/issue_comments_579290.json:
```json
{
    "body": "Changing keywords from \"\" to \"online_documentation, search, js\".",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579290",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "online_documentation, search, js".



---

archive/issue_comments_579291.json:
```json
{
    "body": "<a id='comment:4'></a>\nRestoring the online documentation's search box\nseems critical to me.\n\nCan anyone help with that?",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579291",
    "user": "https://github.com/slel"
}
```

<a id='comment:4'></a>
Restoring the online documentation's search box
seems critical to me.

Can anyone help with that?



---

archive/issue_events_085194.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85194"
}
```



---

archive/issue_events_085195.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85195"
}
```



---

archive/issue_comments_579292.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [slelievre](#comment%3A4):\n> Restoring the online documentation's search box\n> seems critical to me.\n> \n> Can anyone help with that?\n\n\nWhat is the normal result of the search box? What should be shown? Would you explain?",
    "created_at": "2021-04-14T01:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579292",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'></a>
Replying to [slelievre](#comment%3A4):
> Restoring the online documentation's search box
> seems critical to me.
> 
> Can anyone help with that?


What is the normal result of the search box? What should be shown? Would you explain?



---

archive/issue_comments_579293.json:
```json
{
    "body": "<a id='comment:8'></a>\nMoving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579293",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_085196.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85196"
}
```



---

archive/issue_events_085197.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85197"
}
```



---

archive/issue_events_085198.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85198"
}
```



---

archive/issue_events_085199.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85199"
}
```



---

archive/issue_comments_579294.json:
```json
{
    "body": "<a id='comment:10'></a>\nReported again in https://groups.google.com/g/sage-devel/c/FxjVDtqxw1U/m/t_K6IDjUAAAJ",
    "created_at": "2021-11-11T00:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579294",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Reported again in https://groups.google.com/g/sage-devel/c/FxjVDtqxw1U/m/t_K6IDjUAAAJ



---

archive/issue_comments_579295.json:
```json
{
    "body": "<a id='comment:11'></a>\nSee also: #31415",
    "created_at": "2021-11-11T01:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579295",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
See also: #31415



---

archive/issue_comments_579296.json:
```json
{
    "body": "Changing branch from \"\" to \"u/klee/29576\"",
    "created_at": "2021-11-11T07:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579296",
    "user": "https://github.com/kwankyu"
}
```

Changing branch from "" to "u/klee/29576"



---

archive/issue_comments_579297.json:
```json
{
    "body": "Changing author from \"\" to \"Kwankyu Lee\"",
    "created_at": "2021-11-11T07:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579297",
    "user": "https://github.com/kwankyu"
}
```

Changing author from "" to "Kwankyu Lee"



---

archive/issue_comments_579298.json:
```json
{
    "body": "Changing commit from \"\" to \"74d1330a311ad7142b096f23838edca8c8e98f93\"",
    "created_at": "2021-11-11T07:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579298",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "74d1330a311ad7142b096f23838edca8c8e98f93"



---

archive/issue_comments_579299.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[74d1330](https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93)|`Revive search in documentation`|",
    "created_at": "2021-11-11T07:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579299",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[74d1330](https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93)|`Revive search in documentation`|



---

archive/issue_comments_579300.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe patch revives search page. \n\nFor this, I had to turn off Thebe (see changes in `layout.html`), which seems to conflict with `underline.js`. Actually it seems old Thebe javascript file is to blame, as with the latest one from CDN works fine with the search page.\n\nI am not sure if Thebe still works with Sage. See related #24593. If we cannot turn off Thebe, then please provide updated javascript (here or to #24593).",
    "created_at": "2021-11-11T08:04:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579300",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>
The patch revives search page. 

For this, I had to turn off Thebe (see changes in `layout.html`), which seems to conflict with `underline.js`. Actually it seems old Thebe javascript file is to blame, as with the latest one from CDN works fine with the search page.

I am not sure if Thebe still works with Sage. See related #24593. If we cannot turn off Thebe, then please provide updated javascript (here or to #24593).



---

archive/issue_comments_579301.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2021-11-11T08:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579301",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_579302.json:
```json
{
    "body": "<a id='comment:16'></a>\nWhat I did is mostly to make our customized `layout.html` and `search.html` to be close to original ones from Sphinx.",
    "created_at": "2021-11-11T08:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579302",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:16'></a>
What I did is mostly to make our customized `layout.html` and `search.html` to be close to original ones from Sphinx.



---

archive/issue_events_085200.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "rename": {
        "from": "Missing js objects on doc search page",
        "to": "Sage documentation search page broken"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85200"
}
```



---

archive/issue_comments_579303.json:
```json
{
    "body": "<a id='comment:18'></a>\nSee also #32854.",
    "created_at": "2021-11-12T17:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579303",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
See also #32854.



---

archive/issue_comments_579304.json:
```json
{
    "body": "<a id='comment:19'></a>\nSet milestone to sage-9.6 after Sage 9.5 release.",
    "created_at": "2022-01-30T15:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579304",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>
Set milestone to sage-9.6 after Sage 9.5 release.



---

archive/issue_events_085201.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85201"
}
```



---

archive/issue_events_085202.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85202"
}
```



---

archive/issue_events_085203.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85203"
}
```



---

archive/issue_events_085204.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85204"
}
```



---

archive/issue_comments_579305.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-02-10T12:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579305",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_579306.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe code in this ticket is now merged to the branch of #33309. Hence we close this ticket.",
    "created_at": "2022-02-10T12:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579306",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>
The code in this ticket is now merged to the branch of #33309. Hence we close this ticket.



---

archive/issue_comments_579307.json:
```json
{
    "body": "Changing author from \"Kwankyu Lee\" to \"\"",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579307",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Kwankyu Lee" to ""



---

archive/issue_comments_579308.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579308",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_579309.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579309",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_579310.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-02-26T18:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29576#issuecomment-579310",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid



---

archive/issue_events_085205.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-26T18:53:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29576",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29576#event-85205"
}
```
