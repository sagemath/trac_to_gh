# Issue 29576: Sage documentation search page broken

archive/issues_029339.json:
```json
{
    "body": "Go to \nhttps://doc.sagemath.org/html/en/reference/search.html?q=modules\n\nand see the many [object Object] labels throughout the page.\n\n**CC:**  @jcamp0x2a @kwankyu @haraldschilly @slel @williamstein\n\n**Keywords:** online_documentation, search, js\n\n**Branch:** [u/klee/29576](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/29576)\n\n**Commit:** [74d1330a311ad7142b096f23838edca8c8e98f93](https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93)\n\n**Reviewer:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/29576\n\n",
    "closed_at": "2022-02-26T18:53:04Z",
    "created_at": "2020-04-25T07:52:49Z",
    "labels": [
        "component: documentation",
        "critical",
        "bug",
        "invalid"
    ],
    "title": "Sage documentation search page broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/29576",
    "user": "https://github.com/antonio-rojas"
}
```
Go to 
https://doc.sagemath.org/html/en/reference/search.html?q=modules

and see the many [object Object] labels throughout the page.

**CC:**  @jcamp0x2a @kwankyu @haraldschilly @slel @williamstein

**Keywords:** online_documentation, search, js

**Branch:** [u/klee/29576](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/29576)

**Commit:** [74d1330a311ad7142b096f23838edca8c8e98f93](https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93)

**Reviewer:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/29576





---

archive/issue_events_263415.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-17T18:33:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263415"
}
```



---

archive/issue_events_263416.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-05-17T18:33:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263416"
}
```



---

archive/issue_events_263417.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-10-02T09:09:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263417"
}
```



---

archive/issue_comments_468168.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"online_documentation, search, js\".",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468168",
    "user": "https://github.com/slel"
}
```

**Changing keywords** from "" to "online_documentation, search, js".



---

archive/issue_comments_468169.json:
```json
{
    "body": "<a id='comment:4'></a>\nRestoring the online documentation's search box\nseems critical to me.\n\nCan anyone help with that?",
    "created_at": "2020-10-02T09:09:54Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468169",
    "user": "https://github.com/slel"
}
```

<a id='comment:4'></a>
Restoring the online documentation's search box
seems critical to me.

Can anyone help with that?



---

archive/issue_events_263418.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263418"
}
```



---

archive/issue_events_263419.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263419"
}
```



---

archive/issue_comments_468170.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [@slel](#comment%3A4):\n> Restoring the online documentation's search box\n> seems critical to me.\n> \n> Can anyone help with that?\n\nWhat is the normal result of the search box? What should be shown? Would you explain?",
    "created_at": "2021-04-14T01:00:27Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468170",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'></a>
Replying to [@slel](#comment%3A4):
> Restoring the online documentation's search box
> seems critical to me.
> 
> Can anyone help with that?

What is the normal result of the search box? What should be shown? Would you explain?



---

archive/issue_comments_468171.json:
```json
{
    "body": "<a id='comment:8'></a>\nMoving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468171",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_263420.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263420"
}
```



---

archive/issue_events_263421.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263421"
}
```



---

archive/issue_events_263422.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263422"
}
```



---

archive/issue_events_263423.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263423"
}
```



---

archive/issue_comments_468172.json:
```json
{
    "body": "<a id='comment:10'></a>\nReported again in https://groups.google.com/g/sage-devel/c/FxjVDtqxw1U/m/t_K6IDjUAAAJ",
    "created_at": "2021-11-11T00:18:59Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468172",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Reported again in https://groups.google.com/g/sage-devel/c/FxjVDtqxw1U/m/t_K6IDjUAAAJ



---

archive/issue_comments_468173.json:
```json
{
    "body": "<a id='comment:11'></a>\nSee also: #31415",
    "created_at": "2021-11-11T01:25:06Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468173",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
See also: #31415



---

archive/issue_comments_468174.json:
```json
{
    "body": "**Branch:** [u/klee/29576](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/29576)",
    "created_at": "2021-11-11T07:54:16Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468174",
    "user": "https://github.com/kwankyu"
}
```

**Branch:** [u/klee/29576](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/29576)



---

archive/issue_comments_468175.json:
```json
{
    "body": "**Author:** Kwankyu Lee",
    "created_at": "2021-11-11T07:54:16Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468175",
    "user": "https://github.com/kwankyu"
}
```

**Author:** Kwankyu Lee



---

archive/issue_comments_468176.json:
```json
{
    "body": "**Commit:** [74d1330a311ad7142b096f23838edca8c8e98f93](https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93)",
    "created_at": "2021-11-11T07:54:21Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [74d1330a311ad7142b096f23838edca8c8e98f93](https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93)



---

archive/issue_comments_468177.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93\">74d1330</a></td><td><code>Revive search in documentation</code></td></tr></table>\n",
    "created_at": "2021-11-11T07:54:21Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/74d1330a311ad7142b096f23838edca8c8e98f93">74d1330</a></td><td><code>Revive search in documentation</code></td></tr></table>




---

archive/issue_comments_468178.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe patch revives search page. \n\nFor this, I had to turn off Thebe (see changes in `layout.html`), which seems to conflict with `underline.js`. Actually it seems old Thebe javascript file is to blame, as with the latest one from CDN works fine with the search page.\n\nI am not sure if Thebe still works with Sage. See related #24593. If we cannot turn off Thebe, then please provide updated javascript (here or to #24593).",
    "created_at": "2021-11-11T08:04:46Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468178",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>
The patch revives search page. 

For this, I had to turn off Thebe (see changes in `layout.html`), which seems to conflict with `underline.js`. Actually it seems old Thebe javascript file is to blame, as with the latest one from CDN works fine with the search page.

I am not sure if Thebe still works with Sage. See related #24593. If we cannot turn off Thebe, then please provide updated javascript (here or to #24593).



---

archive/issue_events_263424.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-11T08:05:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263424"
}
```



---

archive/issue_comments_468179.json:
```json
{
    "body": "<a id='comment:16'></a>\nWhat I did is mostly to make our customized `layout.html` and `search.html` to be close to original ones from Sphinx.",
    "created_at": "2021-11-11T08:10:23Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468179",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:16'></a>
What I did is mostly to make our customized `layout.html` and `search.html` to be close to original ones from Sphinx.



---

archive/issue_events_263425.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-12T11:21:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "rename": {
        "from": "Missing js objects on doc search page",
        "to": "Sage documentation search page broken"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263425"
}
```



---

archive/issue_comments_468180.json:
```json
{
    "body": "<a id='comment:18'></a>\nSee also #32854.",
    "created_at": "2021-11-12T17:51:53Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468180",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
See also #32854.



---

archive/issue_comments_468181.json:
```json
{
    "body": "<a id='comment:19'></a>\nSet milestone to sage-9.6 after Sage 9.5 release.",
    "created_at": "2022-01-30T15:44:20Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468181",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>
Set milestone to sage-9.6 after Sage 9.5 release.



---

archive/issue_events_263426.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263426"
}
```



---

archive/issue_events_263427.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-30T15:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263427"
}
```



---

archive/issue_events_263428.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263428"
}
```



---

archive/issue_events_263429.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263429"
}
```



---

archive/issue_events_263430.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-02-10T12:37:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263430"
}
```



---

archive/issue_comments_468182.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe code in this ticket is now merged to the branch of #33309. Hence we close this ticket.",
    "created_at": "2022-02-10T12:37:50Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468182",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>
The code in this ticket is now merged to the branch of #33309. Hence we close this ticket.



---

archive/issue_comments_468183.json:
```json
{
    "body": "**Changing author** from \"Kwankyu Lee\" to \"\".",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468183",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "Kwankyu Lee" to "".



---

archive/issue_events_263431.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-13T17:48:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263431"
}
```



---

archive/issue_events_263432.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-13T17:48:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263432"
}
```



---

archive/issue_comments_468184.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2022-02-13T17:48:25Z",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29576#issuecomment-468184",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_events_263433.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-26T18:53:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263433"
}
```



---

archive/issue_events_263434.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-26T18:53:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29576",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29576#event-263434"
}
```
