# Issue 29403: ci-cygwin.yml: Multi-stage build

archive/issues_029166.json:
```json
{
    "body": "The [GitHub](GitHub) workflow for cygwin does not fit into the 6-hour time limit.\nWe do a multi-stage build, saving and loading `local/` to/from build artifacts.\n\n\nCC:  @dimpase @embray @slel jpflori @tscrim @vbraun @kcrisman\n\nBranch/Commit: 27ddea32cbd2c93d98e0e67942dd6b3fbd9f3a1b\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nDependencies: #29417, #29392\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29403\n\n",
    "closed_at": "2020-04-23T22:32:47Z",
    "created_at": "2020-03-25T01:55:07Z",
    "labels": [
        "component: porting: cygwin"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "ci-cygwin.yml: Multi-stage build",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29403",
    "user": "https://github.com/mkoeppe"
}
```
The [GitHub](GitHub) workflow for cygwin does not fit into the 6-hour time limit.
We do a multi-stage build, saving and loading `local/` to/from build artifacts.


CC:  @dimpase @embray @slel jpflori @tscrim @vbraun @kcrisman

Branch/Commit: 27ddea32cbd2c93d98e0e67942dd6b3fbd9f3a1b

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Dependencies: #29417, #29392

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29403





---

archive/issue_comments_573846.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/ci_cygwin_yml__multi_stage_build\"",
    "created_at": "2020-03-25T02:09:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573846",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/ci_cygwin_yml__multi_stage_build"



---

archive/issue_comments_573847.json:
```json
{
    "body": "Changing commit from \"\" to \"79bee2f55b707b8c2f83d17f1c4f18b010996024\"",
    "created_at": "2020-03-25T03:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573847",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "79bee2f55b707b8c2f83d17f1c4f18b010996024"



---

archive/issue_comments_573848.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-25T03:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573848",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573849.json:
```json
{
    "body": "Changing commit from \"79bee2f55b707b8c2f83d17f1c4f18b010996024\" to \"cef0d7382cd899ce2f04ab31f38c7137394b9ae0\"",
    "created_at": "2020-03-26T19:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573849",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "79bee2f55b707b8c2f83d17f1c4f18b010996024" to "cef0d7382cd899ce2f04ab31f38c7137394b9ae0"



---

archive/issue_comments_573850.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2020-03-26T19:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573850",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_573851.json:
```json
{
    "body": "<a id='comment:4'></a>Sample run https://github.com/mkoeppe/sage/actions/runs/63708828",
    "created_at": "2020-03-26T19:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573851",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Sample run https://github.com/mkoeppe/sage/actions/runs/63708828



---

archive/issue_comments_573852.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29397\"",
    "created_at": "2020-03-26T20:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573852",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29397"



---

archive/issue_comments_573853.json:
```json
{
    "body": "<a id='comment:6'></a>Something is still triggering rebuilds of targets that have been built in a previous stage.",
    "created_at": "2020-03-29T03:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573853",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>Something is still triggering rebuilds of targets that have been built in a previous stage.



---

archive/issue_comments_573854.json:
```json
{
    "body": "<a id='comment:7'></a>I'd suspect it's the `toolchain` crud.",
    "created_at": "2020-03-29T03:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573854",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>I'd suspect it's the `toolchain` crud.



---

archive/issue_comments_573855.json:
```json
{
    "body": "Changing dependencies from \"#29397\" to \"\"",
    "created_at": "2020-03-29T04:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573855",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29397" to ""



---

archive/issue_comments_573856.json:
```json
{
    "body": "<a id='comment:9'></a>I'm running one test with MAKE=\"make --debug=verbose\" to see what's happening there",
    "created_at": "2020-03-29T04:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573856",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>I'm running one test with MAKE="make --debug=verbose" to see what's happening there



---

archive/issue_comments_573857.json:
```json
{
    "body": "Changing commit from \"cef0d7382cd899ce2f04ab31f38c7137394b9ae0\" to \"de50cf8fd0b06c8073f77f358af1f2be75b81bec\"",
    "created_at": "2020-03-30T22:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573857",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cef0d7382cd899ce2f04ab31f38c7137394b9ae0" to "de50cf8fd0b06c8073f77f358af1f2be75b81bec"



---

archive/issue_comments_573858.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-30T22:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573859.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-03-30T22:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573859",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_573860.json:
```json
{
    "body": "<a id='comment:13'></a>This works pretty well now.",
    "created_at": "2020-03-31T16:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573860",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>This works pretty well now.



---

archive/issue_comments_573861.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-04T14:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573861",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573862.json:
```json
{
    "body": "Changing commit from \"de50cf8fd0b06c8073f77f358af1f2be75b81bec\" to \"9f38852dbc749a52081da7dc6341b4cbe397012d\"",
    "created_at": "2020-04-04T14:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "de50cf8fd0b06c8073f77f358af1f2be75b81bec" to "9f38852dbc749a52081da7dc6341b4cbe397012d"



---

archive/issue_comments_573863.json:
```json
{
    "body": "<a id='comment:15'></a>New failure mode: https://github.com/mkoeppe/sage/runs/560884908\n\n```\n\"/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py\", line 775, in __init__\n  [backports_abc-0.5]       restore_signals, start_new_session)\n  [backports_abc-0.5]     File \"/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py\", line 1453, in _execute_child\n  [backports_abc-0.5]       restore_signals, start_new_session, preexec_fn)\n  [backports_abc-0.5]   BlockingIOError: [Errno 11] Resource temporarily unavailable\n  [backports_abc-0.5]   Cleaning up...\n```",
    "created_at": "2020-04-05T02:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573863",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>New failure mode: https://github.com/mkoeppe/sage/runs/560884908

```
"/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py", line 775, in __init__
  [backports_abc-0.5]       restore_signals, start_new_session)
  [backports_abc-0.5]     File "/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py", line 1453, in _execute_child
  [backports_abc-0.5]       restore_signals, start_new_session, preexec_fn)
  [backports_abc-0.5]   BlockingIOError: [Errno 11] Resource temporarily unavailable
  [backports_abc-0.5]   Cleaning up...
```



---

archive/issue_comments_573864.json:
```json
{
    "body": "<a id='comment:16'></a>https://github.com/mkoeppe/sage/runs/560884917\n\n```\nInstalling backports_abc-0.5\n      0 [main] python3.7 16471 child_info_fork::abort: address space needed by 'cyglzma-5.dll' (0x400000) is already occupied\nInstalling package backports_abc using pip3\n      0 [main] python3.7 16554 child_info_fork::abort: address space needed by 'cyglzma-5.dll' (0x400000) is already occupied\nIgnoring indexes: https://pypi.org/simple\n```",
    "created_at": "2020-04-05T02:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573864",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>https://github.com/mkoeppe/sage/runs/560884917

```
Installing backports_abc-0.5
      0 [main] python3.7 16471 child_info_fork::abort: address space needed by 'cyglzma-5.dll' (0x400000) is already occupied
Installing package backports_abc using pip3
      0 [main] python3.7 16554 child_info_fork::abort: address space needed by 'cyglzma-5.dll' (0x400000) is already occupied
Ignoring indexes: https://pypi.org/simple
```



---

archive/issue_comments_573865.json:
```json
{
    "body": "<a id='comment:17'></a>https://github.com/mkoeppe/sage/runs/560884917\n\n```\n [r-3.6.2.p0]   gcc -I../../src/extra -I../../src/extra/xdr -I. -I../../src/include -I../../src/include -I/cygdrive/d/a/sage/sage/local/include  -I../../src/nmath -DHAVE_CONFIG_H   -fopenmp   -g -O2  -fPIC  -c version.c -o version.o\n  [r-3.6.2.p0]   sysutils.c:554:10: fatal error: iconv.h: No such file or directory\n  [r-3.6.2.p0]     554 | #include <iconv.h>\n  [r-3.6.2.p0]         |          ^~~~~~~~~\n  [r-3.6.2.p0]   compilation terminated.\n```",
    "created_at": "2020-04-05T02:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573865",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>https://github.com/mkoeppe/sage/runs/560884917

```
 [r-3.6.2.p0]   gcc -I../../src/extra -I../../src/extra/xdr -I. -I../../src/include -I../../src/include -I/cygdrive/d/a/sage/sage/local/include  -I../../src/nmath -DHAVE_CONFIG_H   -fopenmp   -g -O2  -fPIC  -c version.c -o version.o
  [r-3.6.2.p0]   sysutils.c:554:10: fatal error: iconv.h: No such file or directory
  [r-3.6.2.p0]     554 | #include <iconv.h>
  [r-3.6.2.p0]         |          ^~~~~~~~~
  [r-3.6.2.p0]   compilation terminated.
```



---

archive/issue_comments_573866.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:15 mkoeppe]:\n> New failure mode: https://github.com/mkoeppe/sage/runs/560884908\n> \n> ```\n> \"/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py\", line 775, in __init__\n>   [backports_abc-0.5]       restore_signals, start_new_session)\n>   [backports_abc-0.5]     File \"/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py\", line 1453, in _execute_child\n>   [backports_abc-0.5]       restore_signals, start_new_session, preexec_fn)\n>   [backports_abc-0.5]   BlockingIOError: [Errno 11] Resource temporarily unavailable\n>   [backports_abc-0.5]   Cleaning up...\n> ```\n\n\nwelcome to Cygwin rebase Hell. \nOne might need to call one of these `src/bin/sage-rebase*` (sacrificing a black chicken might be a pre-req).",
    "created_at": "2020-04-05T02:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573866",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>Replying to [comment:15 mkoeppe]:
> New failure mode: https://github.com/mkoeppe/sage/runs/560884908
> 
> ```
> "/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py", line 775, in __init__
>   [backports_abc-0.5]       restore_signals, start_new_session)
>   [backports_abc-0.5]     File "/cygdrive/d/a/sage/sage/local/lib/python3.7/subprocess.py", line 1453, in _execute_child
>   [backports_abc-0.5]       restore_signals, start_new_session, preexec_fn)
>   [backports_abc-0.5]   BlockingIOError: [Errno 11] Resource temporarily unavailable
>   [backports_abc-0.5]   Cleaning up...
> ```


welcome to Cygwin rebase Hell. 
One might need to call one of these `src/bin/sage-rebase*` (sacrificing a black chicken might be a pre-req).



---

archive/issue_comments_573867.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-08T14:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573867",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573868.json:
```json
{
    "body": "Changing commit from \"9f38852dbc749a52081da7dc6341b4cbe397012d\" to \"0a5342978268f8fe5dea76fa1e22529dffc5dea3\"",
    "created_at": "2020-04-08T14:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573868",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9f38852dbc749a52081da7dc6341b4cbe397012d" to "0a5342978268f8fe5dea76fa1e22529dffc5dea3"



---

archive/issue_comments_573869.json:
```json
{
    "body": "<a id='comment:21'></a>In https://github.com/mkoeppe/sage/runs/572730280 (cygwin-stage-ii-a (minimal)), despite rebasing in the \"Extract sage-local artifact\" step, I am still getting `_fork::abort: address space needed by 'cyglzma-5.dll' (0x400000) is already occupied` when building packages",
    "created_at": "2020-04-09T16:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573869",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>In https://github.com/mkoeppe/sage/runs/572730280 (cygwin-stage-ii-a (minimal)), despite rebasing in the "Extract sage-local artifact" step, I am still getting `_fork::abort: address space needed by 'cyglzma-5.dll' (0x400000) is already occupied` when building packages



---

archive/issue_comments_573870.json:
```json
{
    "body": "<a id='comment:23'></a>#29486 cygwin-standard: rpy2 fails to build",
    "created_at": "2020-04-09T16:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573870",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>#29486 cygwin-standard: rpy2 fails to build



---

archive/issue_comments_573871.json:
```json
{
    "body": "<a id='comment:24'></a>cygwin-stage-ii-b (minimal) times out -  https://github.com/mkoeppe/sage/runs/572730298 - may need to rebalance stages",
    "created_at": "2020-04-09T16:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573871",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>cygwin-stage-ii-b (minimal) times out -  https://github.com/mkoeppe/sage/runs/572730298 - may need to rebalance stages



---

archive/issue_comments_573872.json:
```json
{
    "body": "<a id='comment:25'></a>In https://github.com/mkoeppe/sage/runs/572730287 (cygwin-stage-ii-a (standard)): matplotlib fails to build - numpy-related \n\n```\n     File \"/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/matrixlib/__init__.py\", line 6, in <module>\n        from .defmatrix import *\n      File \"/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/matrixlib/defmatrix.py\", line 13, in <module>\n        from numpy.linalg import matrix_power\n      File \"/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/linalg/__init__.py\", line 51, in <module>\n        from .linalg import *\n      File \"/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/linalg/linalg.py\", line 35, in <module>\n        from numpy.linalg import lapack_lite, _umath_linalg\n    ImportError: No such file or directory\n```",
    "created_at": "2020-04-09T17:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573872",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>In https://github.com/mkoeppe/sage/runs/572730287 (cygwin-stage-ii-a (standard)): matplotlib fails to build - numpy-related 

```
     File "/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/matrixlib/__init__.py", line 6, in <module>
        from .defmatrix import *
      File "/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/matrixlib/defmatrix.py", line 13, in <module>
        from numpy.linalg import matrix_power
      File "/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/linalg/__init__.py", line 51, in <module>
        from .linalg import *
      File "/cygdrive/d/a/sage/sage/local/lib/python3.7/site-packages/numpy/linalg/linalg.py", line 35, in <module>
        from numpy.linalg import lapack_lite, _umath_linalg
    ImportError: No such file or directory
```



---

archive/issue_comments_573873.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-12T15:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573873",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_573874.json:
```json
{
    "body": "<a id='comment:27'></a>Anyone out there who is interested in cygwin?",
    "created_at": "2020-04-12T16:39:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573874",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>Anyone out there who is interested in cygwin?



---

archive/issue_comments_573875.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2020-04-13T05:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573875",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_573876.json:
```json
{
    "body": "Changing commit from \"0a5342978268f8fe5dea76fa1e22529dffc5dea3\" to \"c08176edeb5871de7d7548c91944f3a3eaa5038d\"",
    "created_at": "2020-04-13T05:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0a5342978268f8fe5dea76fa1e22529dffc5dea3" to "c08176edeb5871de7d7548c91944f3a3eaa5038d"



---

archive/issue_comments_573877.json:
```json
{
    "body": "<a id='comment:29'></a>Merged in #29417 to resolve merge conflicts",
    "created_at": "2020-04-13T05:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573877",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Merged in #29417 to resolve merge conflicts



---

archive/issue_comments_573878.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29417\"",
    "created_at": "2020-04-13T05:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573878",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29417"



---

archive/issue_comments_573879.json:
```json
{
    "body": "<a id='comment:30'></a>As far as I can tell, this is okay, but I am not enough of an expert to say definitively. I would appreciate a second opinion from someone who is more well-versed in the Sage build system to double-check.",
    "created_at": "2020-04-15T22:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573879",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:30'></a>As far as I can tell, this is okay, but I am not enough of an expert to say definitively. I would appreciate a second opinion from someone who is more well-versed in the Sage build system to double-check.



---

archive/issue_comments_573880.json:
```json
{
    "body": "<a id='comment:31'></a>The issue of comment 21 is not resolved yet",
    "created_at": "2020-04-15T23:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573880",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>The issue of comment 21 is not resolved yet



---

archive/issue_comments_573881.json:
```json
{
    "body": "<a id='comment:33'></a>Ancient info on rebasing: https://groups.google.com/d/msg/sage-windows/ygK1kJm9p9w/x0ckGqo2ej4J",
    "created_at": "2020-04-17T03:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573881",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>Ancient info on rebasing: https://groups.google.com/d/msg/sage-windows/ygK1kJm9p9w/x0ckGqo2ej4J



---

archive/issue_comments_573882.json:
```json
{
    "body": "<a id='comment:34'></a>well, yes, it was not clear whether rebasing must be done from outside of Cygwin shell, or not.\n\nI gather that we rebase within Cygwin.\n\nBy the way, it would be interesting to do testing  in Windows WSL...",
    "created_at": "2020-04-17T05:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573882",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>well, yes, it was not clear whether rebasing must be done from outside of Cygwin shell, or not.

I gather that we rebase within Cygwin.

By the way, it would be interesting to do testing  in Windows WSL...



---

archive/issue_comments_573883.json:
```json
{
    "body": "<a id='comment:35'></a>I'll give it another shot, doing exactly what is also done in sage-spkg",
    "created_at": "2020-04-17T06:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573883",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>I'll give it another shot, doing exactly what is also done in sage-spkg



---

archive/issue_comments_573884.json:
```json
{
    "body": "Changing commit from \"c08176edeb5871de7d7548c91944f3a3eaa5038d\" to \"ffdc97e0a8784971757c46eb8c3e8719e286b726\"",
    "created_at": "2020-04-17T06:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573884",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c08176edeb5871de7d7548c91944f3a3eaa5038d" to "ffdc97e0a8784971757c46eb8c3e8719e286b726"



---

archive/issue_comments_573885.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-17T06:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573886.json:
```json
{
    "body": "<a id='comment:37'></a>with these multi-stage builds, where *.so get built at one place, and moved then somewhere esle, it could be that more rebasing is needed. In particular, I recall seeing and fixing rebase locations for Python modules being built.\n(Basically it was the issue that totally broke building Sage on Cygwin32, simply due to insufficient address space).",
    "created_at": "2020-04-17T07:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573886",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>with these multi-stage builds, where *.so get built at one place, and moved then somewhere esle, it could be that more rebasing is needed. In particular, I recall seeing and fixing rebase locations for Python modules being built.
(Basically it was the issue that totally broke building Sage on Cygwin32, simply due to insufficient address space).



---

archive/issue_comments_573887.json:
```json
{
    "body": "<a id='comment:38'></a>Testing at https://github.com/mkoeppe/sage/actions/runs/80516745",
    "created_at": "2020-04-17T07:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573887",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>Testing at https://github.com/mkoeppe/sage/actions/runs/80516745



---

archive/issue_comments_573888.json:
```json
{
    "body": "<a id='comment:39'></a>Yes, I'm rebasing after unpacking `local` from the previous stages.",
    "created_at": "2020-04-17T07:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573888",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>Yes, I'm rebasing after unpacking `local` from the previous stages.



---

archive/issue_comments_573889.json:
```json
{
    "body": "<a id='comment:40'></a>I think it's working now, and we can see the real build errors again in `cygwin-standard`: matplotlib, rpy2, scipy (likely BLAS-related) https://github.com/mkoeppe/sage/runs/596536457",
    "created_at": "2020-04-17T21:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573889",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>I think it's working now, and we can see the real build errors again in `cygwin-standard`: matplotlib, rpy2, scipy (likely BLAS-related) https://github.com/mkoeppe/sage/runs/596536457



---

archive/issue_comments_573890.json:
```json
{
    "body": "Changing component from porting to porting: Cygwin.",
    "created_at": "2020-04-17T21:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573890",
    "user": "https://github.com/mkoeppe"
}
```

Changing component from porting to porting: Cygwin.



---

archive/issue_comments_573891.json:
```json
{
    "body": "Changing commit from \"ffdc97e0a8784971757c46eb8c3e8719e286b726\" to \"fc61002be19bf67d889c5e3262b1a7f5e6dec6dc\"",
    "created_at": "2020-04-17T23:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ffdc97e0a8784971757c46eb8c3e8719e286b726" to "fc61002be19bf67d889c5e3262b1a7f5e6dec6dc"



---

archive/issue_comments_573892.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-17T23:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573892",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573893.json:
```json
{
    "body": "<a id='comment:43'></a>testing on https://github.com/dimpase/sage/actions/runs/81294070",
    "created_at": "2020-04-18T04:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573893",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'></a>testing on https://github.com/dimpase/sage/actions/runs/81294070



---

archive/issue_comments_573894.json:
```json
{
    "body": "<a id='comment:44'></a>I cannot reproduce the matplotlib build error locally - even when I download and unpack stage-i-a and stage-i-b (standard) and configure against that.",
    "created_at": "2020-04-18T04:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573894",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>I cannot reproduce the matplotlib build error locally - even when I download and unpack stage-i-a and stage-i-b (standard) and configure against that.



---

archive/issue_comments_573895.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-18T05:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573895",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573896.json:
```json
{
    "body": "Changing commit from \"fc61002be19bf67d889c5e3262b1a7f5e6dec6dc\" to \"037f5085be90f4f225c30ce58e80ffdd89c0a882\"",
    "created_at": "2020-04-18T05:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573896",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fc61002be19bf67d889c5e3262b1a7f5e6dec6dc" to "037f5085be90f4f225c30ce58e80ffdd89c0a882"



---

archive/issue_comments_573897.json:
```json
{
    "body": "Changing dependencies from \"#29417\" to \"#29417, #29392\"",
    "created_at": "2020-04-18T05:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573897",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29417" to "#29417, #29392"



---

archive/issue_comments_573898.json:
```json
{
    "body": "Changing commit from \"037f5085be90f4f225c30ce58e80ffdd89c0a882\" to \"998f02d703f4b0ed6127f3431874dbbc70d1f6c6\"",
    "created_at": "2020-04-18T05:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "037f5085be90f4f225c30ce58e80ffdd89c0a882" to "998f02d703f4b0ed6127f3431874dbbc70d1f6c6"



---

archive/issue_comments_573899.json:
```json
{
    "body": "<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-18T05:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573899",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573900.json:
```json
{
    "body": "Changing commit from \"998f02d703f4b0ed6127f3431874dbbc70d1f6c6\" to \"d6bf4b1db50e2e8ae7731a4246a6d2e8caa8b791\"",
    "created_at": "2020-04-18T07:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "998f02d703f4b0ed6127f3431874dbbc70d1f6c6" to "d6bf4b1db50e2e8ae7731a4246a6d2e8caa8b791"



---

archive/issue_comments_573901.json:
```json
{
    "body": "<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-18T07:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573901",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573902.json:
```json
{
    "body": "<a id='comment:49'></a>how does one need to modify ~/.github/ to make GH Actions only run cygwin tests?",
    "created_at": "2020-04-18T09:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573902",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:49'></a>how does one need to modify ~/.github/ to make GH Actions only run cygwin tests?



---

archive/issue_comments_573903.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 dimpase]:\n> how does one need to modify ~/.github/ to make GH Actions only run cygwin tests?\n\n\nJust delete the file tox.yml",
    "created_at": "2020-04-18T15:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573903",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:50'></a>Replying to [comment:49 dimpase]:
> how does one need to modify ~/.github/ to make GH Actions only run cygwin tests?


Just delete the file tox.yml



---

archive/issue_comments_573904.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-18T16:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573905.json:
```json
{
    "body": "Changing commit from \"d6bf4b1db50e2e8ae7731a4246a6d2e8caa8b791\" to \"2779e2446a37b51e49906adc5d39dd459ab13c88\"",
    "created_at": "2020-04-18T16:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d6bf4b1db50e2e8ae7731a4246a6d2e8caa8b791" to "2779e2446a37b51e49906adc5d39dd459ab13c88"



---

archive/issue_comments_573906.json:
```json
{
    "body": "Changing commit from \"2779e2446a37b51e49906adc5d39dd459ab13c88\" to \"27ddea32cbd2c93d98e0e67942dd6b3fbd9f3a1b\"",
    "created_at": "2020-04-19T03:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2779e2446a37b51e49906adc5d39dd459ab13c88" to "27ddea32cbd2c93d98e0e67942dd6b3fbd9f3a1b"



---

archive/issue_comments_573907.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-19T03:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573907",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_573908.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2020-04-19T23:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573908",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_573909.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-19T23:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573909",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_573910.json:
```json
{
    "body": "<a id='comment:54'></a>Thanks!",
    "created_at": "2020-04-20T00:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573910",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:54'></a>Thanks!



---

archive/issue_events_074932.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-04-23T22:32:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29403#event-74932"
}
```



---

archive/issue_comments_573911.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-23T22:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573911",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_573912.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/ci_cygwin_yml__multi_stage_build\" to \"27ddea32cbd2c93d98e0e67942dd6b3fbd9f3a1b\"",
    "created_at": "2020-04-23T22:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29403#issuecomment-573912",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/ci_cygwin_yml__multi_stage_build" to "27ddea32cbd2c93d98e0e67942dd6b3fbd9f3a1b"
