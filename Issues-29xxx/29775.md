# Issue 29775: Add a bit of typing to manifold code

archive/issues_029538.json:
```json
{
    "assignees": [],
    "body": "This PR adds a bit of typing information to some of the methods in the manifolds module.\n\n**CC:**  @tscrim @nthiery @mjungmath @fchapoton\n\n**Keywords:** typing\n\n**Branch/Commit:** [7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec](https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec)\n\n**Reviewer:** Matthias Koeppe, Tobias Diez, Eric Gourgoulhon\n\n**Author:** Tobias Diez\n\nIssue created by migration from https://trac.sagemath.org/ticket/29775\n\n",
    "closed_at": "2022-04-02T10:52:31Z",
    "created_at": "2020-06-01T12:04:41Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20manifolds",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add a bit of typing to manifold code",
    "type": "issue",
    "updated_at": "2022-04-02T10:52:31Z",
    "url": "https://github.com/sagemath/sage/issues/29775",
    "user": "https://github.com/tobiasdiez"
}
```
This PR adds a bit of typing information to some of the methods in the manifolds module.

**CC:**  @tscrim @nthiery @mjungmath @fchapoton

**Keywords:** typing

**Branch/Commit:** [7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec](https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec)

**Reviewer:** Matthias Koeppe, Tobias Diez, Eric Gourgoulhon

**Author:** Tobias Diez

Issue created by migration from https://trac.sagemath.org/ticket/29775





---

archive/issue_events_359699.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-06-01T12:04:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359699"
}
```



---

archive/issue_events_359700.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-06-01T12:04:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "08517b",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359700"
}
```



---

archive/issue_events_359701.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-06-01T12:04:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359701"
}
```



---

archive/issue_events_359702.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-06-01T12:04:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359702"
}
```



---

archive/issue_comments_472706.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nIn case people are interested in a general discussion of typing in the Sage library: #29756 Meta-ticket: Review of Python 3 features that sagelib should use systematically",
    "created_at": "2020-06-01T19:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472706",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'>**Comment 1:**</a>
In case people are interested in a general discussion of typing in the Sage library: #29756 Meta-ticket: Review of Python 3 features that sagelib should use systematically



---

archive/issue_events_359703.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-06-01T22:49:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359703"
}
```



---

archive/issue_comments_472707.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nThe addition of `identity_map` to `DifferentiableManifold` is code duplication (the code is identical to `identity_map` provided by the mother class `TopologicalManifold`). I'm not sure adding typing  is worth duplicating the code, opening the root to all evil...",
    "created_at": "2020-06-02T10:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472707",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'>**Comment 3:**</a>
The addition of `identity_map` to `DifferentiableManifold` is code duplication (the code is identical to `identity_map` provided by the mother class `TopologicalManifold`). I'm not sure adding typing  is worth duplicating the code, opening the root to all evil...



---

archive/issue_comments_472708.json:
```json
{
    "body": "**Changing commit** from \"[e620d059f0f89f840fa2b0091477e7a7ddaa6630](https://github.com/sagemath/sagetrac-mirror/commit/e620d059f0f89f840fa2b0091477e7a7ddaa6630)\" to \"[23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3](https://github.com/sagemath/sagetrac-mirror/commit/23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3)\".",
    "created_at": "2020-06-02T14:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472708",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e620d059f0f89f840fa2b0091477e7a7ddaa6630](https://github.com/sagemath/sagetrac-mirror/commit/e620d059f0f89f840fa2b0091477e7a7ddaa6630)" to "[23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3](https://github.com/sagemath/sagetrac-mirror/commit/23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3)".



---

archive/issue_comments_472709.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3\">23b6012</a></td><td><code>Add more typing</code></td></tr></table>\n",
    "created_at": "2020-06-02T14:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472709",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>**Comment 4:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3">23b6012</a></td><td><code>Add more typing</code></td></tr></table>




---

archive/issue_comments_472710.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nReplying to [@egourgoulhon](#comment%3A3):\n> The addition of `identity_map` to `DifferentiableManifold` is code duplication (the code is identical to `identity_map` provided by the mother class `TopologicalManifold`). I'm not sure adding typing  is worth duplicating the code, opening the root to all evil...\n\nI think this is a very important point, and one that needs discussion in a broader context. \n\n1) Can the category system be used to add these tightened type annotations automatically?\n\n2) In such situations, should the doctests be replaced or augmented by `_test_...` methods so that subclasses are tested properly.",
    "created_at": "2020-06-02T16:26:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472710",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>**Comment 5:**</a>
Replying to [@egourgoulhon](#comment%3A3):
> The addition of `identity_map` to `DifferentiableManifold` is code duplication (the code is identical to `identity_map` provided by the mother class `TopologicalManifold`). I'm not sure adding typing  is worth duplicating the code, opening the root to all evil...

I think this is a very important point, and one that needs discussion in a broader context. 

1) Can the category system be used to add these tightened type annotations automatically?

2) In such situations, should the doctests be replaced or augmented by `_test_...` methods so that subclasses are tested properly.



---

archive/issue_comments_472711.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nReplying to [@egourgoulhon](#comment%3A3):\n> The addition of `identity_map` to `DifferentiableManifold` is code duplication (the code is identical to `identity_map` provided by the mother class `TopologicalManifold`). I'm not sure adding typing  is worth duplicating the code, opening the root to all evil...\n\nIf we don't duplicate the code, then the output type of `identity_map` is indicated as `ContinuousMap`, which is correct for a smooth manifold as well. Of course, for such a manifold, it is a particular kind of continuous map, namely a smooth one and the returned object pertains to the subclass `DiffMap` of `ContinuousMap`. But I would say we can live with this; IMHO, it is preferable not to duplicate the code and have type hints not as precise as they could be.",
    "created_at": "2020-06-02T18:58:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472711",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:6'>**Comment 6:**</a>
Replying to [@egourgoulhon](#comment%3A3):
> The addition of `identity_map` to `DifferentiableManifold` is code duplication (the code is identical to `identity_map` provided by the mother class `TopologicalManifold`). I'm not sure adding typing  is worth duplicating the code, opening the root to all evil...

If we don't duplicate the code, then the output type of `identity_map` is indicated as `ContinuousMap`, which is correct for a smooth manifold as well. Of course, for such a manifold, it is a particular kind of continuous map, namely a smooth one and the returned object pertains to the subclass `DiffMap` of `ContinuousMap`. But I would say we can live with this; IMHO, it is preferable not to duplicate the code and have type hints not as precise as they could be.



---

archive/issue_comments_472712.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-This PR adds a bit of typing information to some of the methods in the manifolds package that I added while browsing the code. I've changed the inline documentation accordingly. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.\n-Probably the biggest change is the addition of the identity map for a smooth manifold (which is a `DiffMap` and not just a `ContininousMap`).\n+This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. I've changed the inline documentation accordingly. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.\n+Probably the biggest change is the addition of the identity map for a smooth manifold (which is a `DiffMap` and not just a `ContinousMap`).\n \n Moreover, a few very minor clarifications to the documentation were added as well.\n \n``````\n",
    "created_at": "2020-06-02T19:05:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472712",
    "user": "https://github.com/egourgoulhon"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-This PR adds a bit of typing information to some of the methods in the manifolds package that I added while browsing the code. I've changed the inline documentation accordingly. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.
-Probably the biggest change is the addition of the identity map for a smooth manifold (which is a `DiffMap` and not just a `ContininousMap`).
+This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. I've changed the inline documentation accordingly. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.
+Probably the biggest change is the addition of the identity map for a smooth manifold (which is a `DiffMap` and not just a `ContinousMap`).
 
 Moreover, a few very minor clarifications to the documentation were added as well.
 
``````




---

archive/issue_events_359704.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2020-06-02T19:05:17Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "rename": {
        "from": "Add a bit of typing to manifolds package",
        "to": "Add a bit of typing to manifold code"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359704"
}
```



---

archive/issue_comments_472713.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nIt's true that I noticed while working on typing support, but the addition is actually rather independent of this. As Eric says, `identity_map` on a differentiable manifold only returns a `ContinuousMap` and one can thus not take it's differential etc. So far this doesn't lead to any problems since the identity case is always handled separately in the code. I'm not familiar with the category code, but maybe it can be improved so that the function `def hom_set: return Hom(self, self)` defined in class A, returns the correct homomrophisms for derived classes `B(A)` as well (so `b.hom_set` returns the hom set of `b` as an element of B).\n\nIf it were just for typing, one could also annotate the original `identity_map` on `TopologicalManifold` (see https://mypy.readthedocs.io/en/stable/more_types.html#advanced-uses-of-self-types).",
    "created_at": "2020-06-03T11:50:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472713",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:8'>**Comment 8:**</a>
It's true that I noticed while working on typing support, but the addition is actually rather independent of this. As Eric says, `identity_map` on a differentiable manifold only returns a `ContinuousMap` and one can thus not take it's differential etc. So far this doesn't lead to any problems since the identity case is always handled separately in the code. I'm not familiar with the category code, but maybe it can be improved so that the function `def hom_set: return Hom(self, self)` defined in class A, returns the correct homomrophisms for derived classes `B(A)` as well (so `b.hom_set` returns the hom set of `b` as an element of B).

If it were just for typing, one could also annotate the original `identity_map` on `TopologicalManifold` (see https://mypy.readthedocs.io/en/stable/more_types.html#advanced-uses-of-self-types).



---

archive/issue_comments_472714.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nReplying to [@tobiasdiez](#comment%3A8):\n> It's true that I noticed while working on typing support, but the addition is actually rather independent of this. As Eric says, `identity_map` on a differentiable manifold only returns a `ContinuousMap` and one can thus not take it's differential etc. \n\nNo, one can take the differential because the returned object in this case is actually a `DiffMap`, which is also a `ContinuousMap` since `DiffMap` is a subclass of `ContinuousMap` (see the example below). \n\n>I'm not familiar with the category code, but maybe it can be improved so that the function `def hom_set: return Hom(self, self)` defined in class A, returns the correct homomrophisms for derived classes `B(A)` as well (so `b.hom_set` returns the hom set of `b` as an element of B).\n\nNo need for improvement, this is already the case:\n\n```\nsage: M = Manifold(2, 'M'); M\n2-dimensional differentiable manifold M\nsage: Id = M.identity_map()\nsage: type(Id)\n<class 'sage.manifolds.differentiable.manifold_homset.DifferentiableManifoldHomset_with_category.element_class'>\nsage: isinstance(Id, sage.manifolds.differentiable.diff_map.DiffMap)\nTrue\nsage: isinstance(Id, sage.manifolds.continuous_map.ContinuousMap)\nTrue\nsage: Id.parent()\nSet of Morphisms from 2-dimensional differentiable manifold M \n to 2-dimensional differentiable manifold M in Category of \n smooth manifolds over Real Field with 53 bits of precision\n```",
    "created_at": "2020-06-03T12:18:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472714",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:9'>**Comment 9:**</a>
Replying to [@tobiasdiez](#comment%3A8):
> It's true that I noticed while working on typing support, but the addition is actually rather independent of this. As Eric says, `identity_map` on a differentiable manifold only returns a `ContinuousMap` and one can thus not take it's differential etc. 

No, one can take the differential because the returned object in this case is actually a `DiffMap`, which is also a `ContinuousMap` since `DiffMap` is a subclass of `ContinuousMap` (see the example below). 

>I'm not familiar with the category code, but maybe it can be improved so that the function `def hom_set: return Hom(self, self)` defined in class A, returns the correct homomrophisms for derived classes `B(A)` as well (so `b.hom_set` returns the hom set of `b` as an element of B).

No need for improvement, this is already the case:

```
sage: M = Manifold(2, 'M'); M
2-dimensional differentiable manifold M
sage: Id = M.identity_map()
sage: type(Id)
<class 'sage.manifolds.differentiable.manifold_homset.DifferentiableManifoldHomset_with_category.element_class'>
sage: isinstance(Id, sage.manifolds.differentiable.diff_map.DiffMap)
True
sage: isinstance(Id, sage.manifolds.continuous_map.ContinuousMap)
True
sage: Id.parent()
Set of Morphisms from 2-dimensional differentiable manifold M 
 to 2-dimensional differentiable manifold M in Category of 
 smooth manifolds over Real Field with 53 bits of precision
```



---

archive/issue_comments_472715.json:
```json
{
    "body": "**Changing commit** from \"[23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3](https://github.com/sagemath/sagetrac-mirror/commit/23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3)\" to \"[3f93d314779566116609cf208ba3651fbdadca03](https://github.com/sagemath/sagetrac-mirror/commit/3f93d314779566116609cf208ba3651fbdadca03)\".",
    "created_at": "2020-06-04T10:19:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472715",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3](https://github.com/sagemath/sagetrac-mirror/commit/23b6012d4b5a2f9dbd1b8a07f454ec29191bf0a3)" to "[3f93d314779566116609cf208ba3651fbdadca03](https://github.com/sagemath/sagetrac-mirror/commit/3f93d314779566116609cf208ba3651fbdadca03)".



---

archive/issue_comments_472716.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca06162b4f767fa35b2919f8ee1f4b5c11510da2\">ca06162</a></td><td><code>Remove identity_map duplication</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f93d314779566116609cf208ba3651fbdadca03\">3f93d31</a></td><td><code>Add mininmal configuration for type checking</code></td></tr></table>\n",
    "created_at": "2020-06-04T10:19:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472716",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>**Comment 10:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca06162b4f767fa35b2919f8ee1f4b5c11510da2">ca06162</a></td><td><code>Remove identity_map duplication</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f93d314779566116609cf208ba3651fbdadca03">3f93d31</a></td><td><code>Add mininmal configuration for type checking</code></td></tr></table>




---

archive/issue_comments_472717.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nThanks for the clarification. I actually tested it before, but apparently made some mistakes as `identity_map` indeed returns a `DiffMap` on a differentiable manifold.\n\nI've thus removed the `identity_map` method again from `DifferentiableManifold` and instead added the typing information to the existing map.\n\nAnything else that needs improvement? From my side this is good to go. I would add more typing in follow-up issues to keep the size of the changes small and reviewable.",
    "created_at": "2020-06-04T14:09:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472717",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:11'>**Comment 11:**</a>
Thanks for the clarification. I actually tested it before, but apparently made some mistakes as `identity_map` indeed returns a `DiffMap` on a differentiable manifold.

I've thus removed the `identity_map` method again from `DifferentiableManifold` and instead added the typing information to the existing map.

Anything else that needs improvement? From my side this is good to go. I would add more typing in follow-up issues to keep the size of the changes small and reviewable.



---

archive/issue_comments_472718.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nThere are some doctest errors, as well as coverage, pyflakes and pycodeystyle errors; check the patchbot reports (click on the \"9.2.beta0 button\" in the top right of the ticket description).",
    "created_at": "2020-06-08T13:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472718",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:12'>**Comment 12:**</a>
There are some doctest errors, as well as coverage, pyflakes and pycodeystyle errors; check the patchbot reports (click on the "9.2.beta0 button" in the top right of the ticket description).



---

archive/issue_comments_472719.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nAnother thing: the typing information does not show up in the html documentation produced by Sphinx.",
    "created_at": "2020-06-08T13:30:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472719",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:13'>**Comment 13:**</a>
Another thing: the typing information does not show up in the html documentation produced by Sphinx.



---

archive/issue_comments_472720.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nThe file `pyrightconfig.json` at the root of the Sage directory has probably been added to the commit by mistake.",
    "created_at": "2020-06-08T13:40:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472720",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:14'>**Comment 14:**</a>
The file `pyrightconfig.json` at the root of the Sage directory has probably been added to the commit by mistake.



---

archive/issue_comments_472721.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nI had a quick look at the errors and most of them are a result of that the tools (pyflakes and pycodestyle) have problems with the typing syntax. After a bit of googling, it appears that these issues are fixed in the most recent versions (e.g. https://github.com/PyCQA/pyflakes/issues/247 and https://github.com/vim-syntastic/syntastic/issues/1667). Where do I find the version used? Moreover, one common problems seems to be that these tools need to be installed under python 3, since otherwise they check the files using python 2 syntax (e.g. https://github.com/vim-syntastic/syntastic/issues/1667#issuecomment-172538109). How can I make sure that it's the case indeed?\nI'll have a look at the remaining issues after these false positives are fixed.\n\nFinally, the `pyrightconfig.json` is the configuration file for `pyright`, which is static type checker. At the moment there are still to many type problems but in the long term this should be integrated in the build progress.",
    "created_at": "2020-06-08T17:02:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472721",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:15'>**Comment 15:**</a>
I had a quick look at the errors and most of them are a result of that the tools (pyflakes and pycodestyle) have problems with the typing syntax. After a bit of googling, it appears that these issues are fixed in the most recent versions (e.g. https://github.com/PyCQA/pyflakes/issues/247 and https://github.com/vim-syntastic/syntastic/issues/1667). Where do I find the version used? Moreover, one common problems seems to be that these tools need to be installed under python 3, since otherwise they check the files using python 2 syntax (e.g. https://github.com/vim-syntastic/syntastic/issues/1667#issuecomment-172538109). How can I make sure that it's the case indeed?
I'll have a look at the remaining issues after these false positives are fixed.

Finally, the `pyrightconfig.json` is the configuration file for `pyright`, which is static type checker. At the moment there are still to many type problems but in the long term this should be integrated in the build progress.



---

archive/issue_comments_472722.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nReplying to [@tobiasdiez](#comment%3A15):\n> Finally, the `pyrightconfig.json` is the configuration file for `pyright`, which is static type checker. At the moment there are still to many type problems but in the long term this should be integrated in the build progress.\n\nCould you create a separate ticket for this please and link to it from #28936",
    "created_at": "2020-07-22T17:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472722",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'>**Comment 17:**</a>
Replying to [@tobiasdiez](#comment%3A15):
> Finally, the `pyrightconfig.json` is the configuration file for `pyright`, which is static type checker. At the moment there are still to many type problems but in the long term this should be integrated in the build progress.

Could you create a separate ticket for this please and link to it from #28936



---

archive/issue_comments_472723.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nReplying to [@tobiasdiez](#comment%3A15):\n> I had a quick look at the errors and most of them are a result of that the tools (pyflakes and pycodestyle) have problems with the typing syntax. ... Where do I find the version used? \n\nBest to open an issue on https://github.com/sagemath/sage-patchbot",
    "created_at": "2020-07-22T17:31:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472723",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'>**Comment 18:**</a>
Replying to [@tobiasdiez](#comment%3A15):
> I had a quick look at the errors and most of them are a result of that the tools (pyflakes and pycodestyle) have problems with the typing syntax. ... Where do I find the version used? 

Best to open an issue on https://github.com/sagemath/sage-patchbot



---

archive/issue_events_359705.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-08-14T12:46:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359705"
}
```



---

archive/issue_events_359706.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-08-14T12:46:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359706"
}
```



---

archive/issue_comments_472724.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nbranch is red and needs to be rebased on the latest beta",
    "created_at": "2020-08-14T12:46:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472724",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'>**Comment 19:**</a>
branch is red and needs to be rebased on the latest beta



---

archive/issue_comments_472725.json:
```json
{
    "body": "**Changing commit** from \"[3f93d314779566116609cf208ba3651fbdadca03](https://github.com/sagemath/sagetrac-mirror/commit/3f93d314779566116609cf208ba3651fbdadca03)\" to \"[f348b54a4ddb2d0bf45836af3b12ab2b460558d0](https://github.com/sagemath/sagetrac-mirror/commit/f348b54a4ddb2d0bf45836af3b12ab2b460558d0)\".",
    "created_at": "2020-08-14T20:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472725",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3f93d314779566116609cf208ba3651fbdadca03](https://github.com/sagemath/sagetrac-mirror/commit/3f93d314779566116609cf208ba3651fbdadca03)" to "[f348b54a4ddb2d0bf45836af3b12ab2b460558d0](https://github.com/sagemath/sagetrac-mirror/commit/f348b54a4ddb2d0bf45836af3b12ab2b460558d0)".



---

archive/issue_comments_472726.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f348b54a4ddb2d0bf45836af3b12ab2b460558d0\">f348b54</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2020-08-14T20:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472726",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>**Comment 20:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f348b54a4ddb2d0bf45836af3b12ab2b460558d0">f348b54</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>




---

archive/issue_comments_472727.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0\">3a4e0eb</a></td><td><code>Remove pyright config</code></td></tr></table>\n",
    "created_at": "2020-08-14T20:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472727",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'>**Comment 21:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0">3a4e0eb</a></td><td><code>Remove pyright config</code></td></tr></table>




---

archive/issue_comments_472728.json:
```json
{
    "body": "**Changing commit** from \"[f348b54a4ddb2d0bf45836af3b12ab2b460558d0](https://github.com/sagemath/sagetrac-mirror/commit/f348b54a4ddb2d0bf45836af3b12ab2b460558d0)\" to \"[3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0](https://github.com/sagemath/sagetrac-mirror/commit/3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0)\".",
    "created_at": "2020-08-14T20:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472728",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[f348b54a4ddb2d0bf45836af3b12ab2b460558d0](https://github.com/sagemath/sagetrac-mirror/commit/f348b54a4ddb2d0bf45836af3b12ab2b460558d0)" to "[3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0](https://github.com/sagemath/sagetrac-mirror/commit/3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0)".



---

archive/issue_comments_472729.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\n@mkoeppe done!\n@fchapoton rebased!\n\nThe pyflakes tests still fail because pyflakes does not (fully) understand the typings code. Not sure if the reason is an old pyflakes or if this is even unresolved in the most recent version. Refs https://github.com/sagemath/sage-patchbot/issues/143. Can I disable pyflakes for the lines that are wrongly reported?",
    "created_at": "2020-08-14T21:04:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472729",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:22'>**Comment 22:**</a>
@mkoeppe done!
@fchapoton rebased!

The pyflakes tests still fail because pyflakes does not (fully) understand the typings code. Not sure if the reason is an old pyflakes or if this is even unresolved in the most recent version. Refs https://github.com/sagemath/sage-patchbot/issues/143. Can I disable pyflakes for the lines that are wrongly reported?



---

archive/issue_events_359707.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-08-14T21:04:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359707"
}
```



---

archive/issue_events_359708.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-08-14T21:04:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359708"
}
```



---

archive/issue_events_359709.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-08-16T05:48:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359709"
}
```



---

archive/issue_events_359710.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2020-08-16T05:48:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359710"
}
```



---

archive/issue_comments_472730.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\n\n```\nsage -t --long --warn-long 63.8 --random-seed=0 src/sage/manifolds/manifold.py\n**********************************************************************\nFile \"src/sage/manifolds/manifold.py\", line 2203, in sage.manifolds.manifold.TopologicalManifold.identity_map\nFailed example:\n    isinstance(id, DiffMap)\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 715, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1139, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.manifolds.manifold.TopologicalManifold.identity_map[10]>\", line 1, in <module>\n        isinstance(id, DiffMap)\n    NameError: name 'DiffMap' is not defined\n**********************************************************************\nFile \"src/sage/manifolds/manifold.py\", line 2209, in sage.manifolds.manifold.TopologicalManifold.identity_map\nFailed example:\n    isinstance(M.identity_map(), DiffMap)\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 715, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1139, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.manifolds.manifold.TopologicalManifold.identity_map[12]>\", line 1, in <module>\n        isinstance(M.identity_map(), DiffMap)\n    NameError: name 'DiffMap' is not defined\n```",
    "created_at": "2020-08-16T05:48:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472730",
    "user": "https://github.com/kliem"
}
```

<a id='comment:24'>**Comment 24:**</a>

```
sage -t --long --warn-long 63.8 --random-seed=0 src/sage/manifolds/manifold.py
**********************************************************************
File "src/sage/manifolds/manifold.py", line 2203, in sage.manifolds.manifold.TopologicalManifold.identity_map
Failed example:
    isinstance(id, DiffMap)
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 715, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1139, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.manifolds.manifold.TopologicalManifold.identity_map[10]>", line 1, in <module>
        isinstance(id, DiffMap)
    NameError: name 'DiffMap' is not defined
**********************************************************************
File "src/sage/manifolds/manifold.py", line 2209, in sage.manifolds.manifold.TopologicalManifold.identity_map
Failed example:
    isinstance(M.identity_map(), DiffMap)
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 715, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/patchbot-sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1139, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.manifolds.manifold.TopologicalManifold.identity_map[12]>", line 1, in <module>
        isinstance(M.identity_map(), DiffMap)
    NameError: name 'DiffMap' is not defined
```



---

archive/issue_comments_472731.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nThanks for your comment. How are imports for the documentation handled? Should I simply add the import for the whole file, or is there a special way to do this just for the doc tests?",
    "created_at": "2020-08-16T12:53:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472731",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:25'>**Comment 25:**</a>
Thanks for your comment. How are imports for the documentation handled? Should I simply add the import for the whole file, or is there a special way to do this just for the doc tests?



---

archive/issue_comments_472732.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nI think you can just do\n\n```\nfrom sage.manifolds.differentiable.diff_map import DiffMap\n```\n\nat the beginning of the doctest or\n\n```\nisinstance(id, sage.manifolds.differentiable.diff_map.DiffMap)\n```\n\nAfter building your modified sage, the doctest should pass with\n\n```\nsage -t --long src/sage/manifolds/manifold.py\n```\n\nThe doctest works almost like a mini sage session.",
    "created_at": "2020-08-16T18:22:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472732",
    "user": "https://github.com/kliem"
}
```

<a id='comment:26'>**Comment 26:**</a>
I think you can just do

```
from sage.manifolds.differentiable.diff_map import DiffMap
```

at the beginning of the doctest or

```
isinstance(id, sage.manifolds.differentiable.diff_map.DiffMap)
```

After building your modified sage, the doctest should pass with

```
sage -t --long src/sage/manifolds/manifold.py
```

The doctest works almost like a mini sage session.



---

archive/issue_comments_472733.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40aab0b315fbd08bad8410797b121efb2f17d080\">40aab0b</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45c55d6a05ec9305751db34bbb4ce24a3d04c2fc\">45c55d6</a></td><td><code>Fix patchbot warnings</code></td></tr></table>\n",
    "created_at": "2020-08-28T17:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472733",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>**Comment 27:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40aab0b315fbd08bad8410797b121efb2f17d080">40aab0b</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45c55d6a05ec9305751db34bbb4ce24a3d04c2fc">45c55d6</a></td><td><code>Fix patchbot warnings</code></td></tr></table>




---

archive/issue_comments_472734.json:
```json
{
    "body": "**Changing commit** from \"[3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0](https://github.com/sagemath/sagetrac-mirror/commit/3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0)\" to \"[45c55d6a05ec9305751db34bbb4ce24a3d04c2fc](https://github.com/sagemath/sagetrac-mirror/commit/45c55d6a05ec9305751db34bbb4ce24a3d04c2fc)\".",
    "created_at": "2020-08-28T17:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472734",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0](https://github.com/sagemath/sagetrac-mirror/commit/3a4e0ebeb1ae217cae58fbd8c8e645eed6e1e7b0)" to "[45c55d6a05ec9305751db34bbb4ce24a3d04c2fc](https://github.com/sagemath/sagetrac-mirror/commit/45c55d6a05ec9305751db34bbb4ce24a3d04c2fc)".



---

archive/issue_comments_472735.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4827cd2c643327a228fbf5f19c9d097e379ba5b2\">4827cd2</a></td><td><code>Fix import problem</code></td></tr></table>\n",
    "created_at": "2020-08-28T17:17:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472735",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>**Comment 28:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4827cd2c643327a228fbf5f19c9d097e379ba5b2">4827cd2</a></td><td><code>Fix import problem</code></td></tr></table>




---

archive/issue_comments_472736.json:
```json
{
    "body": "**Changing commit** from \"[45c55d6a05ec9305751db34bbb4ce24a3d04c2fc](https://github.com/sagemath/sagetrac-mirror/commit/45c55d6a05ec9305751db34bbb4ce24a3d04c2fc)\" to \"[4827cd2c643327a228fbf5f19c9d097e379ba5b2](https://github.com/sagemath/sagetrac-mirror/commit/4827cd2c643327a228fbf5f19c9d097e379ba5b2)\".",
    "created_at": "2020-08-28T17:17:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472736",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[45c55d6a05ec9305751db34bbb4ce24a3d04c2fc](https://github.com/sagemath/sagetrac-mirror/commit/45c55d6a05ec9305751db34bbb4ce24a3d04c2fc)" to "[4827cd2c643327a228fbf5f19c9d097e379ba5b2](https://github.com/sagemath/sagetrac-mirror/commit/4827cd2c643327a228fbf5f19c9d097e379ba5b2)".



---

archive/issue_events_359711.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-08-28T17:21:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359711"
}
```



---

archive/issue_events_359712.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-08-28T17:21:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359712"
}
```



---

archive/issue_comments_472737.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nI've finally fixed these missing imports (or so I hope, I cannot run sage -t because pip couldn't be installed via make -- I will report this elsewhere). Thanks `@`gh-kliem for the helpful instructions.\n\nThe patchbot warnings should be fixed now as well. Note that the negative coverage changes  are due to the fact that `@overload` seems not to be supported.",
    "created_at": "2020-08-28T17:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472737",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:29'>**Comment 29:**</a>
I've finally fixed these missing imports (or so I hope, I cannot run sage -t because pip couldn't be installed via make -- I will report this elsewhere). Thanks `@`gh-kliem for the helpful instructions.

The patchbot warnings should be fixed now as well. Note that the negative coverage changes  are due to the fact that `@overload` seems not to be supported.



---

archive/issue_events_359713.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-09-25T17:01:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359713"
}
```



---

archive/issue_events_359714.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-09-25T17:01:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359714"
}
```



---

archive/issue_comments_472738.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nred branch => needs work",
    "created_at": "2020-09-25T17:01:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472738",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'>**Comment 30:**</a>
red branch => needs work



---

archive/issue_comments_472739.json:
```json
{
    "body": "**Changing commit** from \"[4827cd2c643327a228fbf5f19c9d097e379ba5b2](https://github.com/sagemath/sagetrac-mirror/commit/4827cd2c643327a228fbf5f19c9d097e379ba5b2)\" to \"[c9bf8620892a7ed243a6f4bebc0dafa801f1950f](https://github.com/sagemath/sagetrac-mirror/commit/c9bf8620892a7ed243a6f4bebc0dafa801f1950f)\".",
    "created_at": "2020-09-26T19:39:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472739",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[4827cd2c643327a228fbf5f19c9d097e379ba5b2](https://github.com/sagemath/sagetrac-mirror/commit/4827cd2c643327a228fbf5f19c9d097e379ba5b2)" to "[c9bf8620892a7ed243a6f4bebc0dafa801f1950f](https://github.com/sagemath/sagetrac-mirror/commit/c9bf8620892a7ed243a6f4bebc0dafa801f1950f)".



---

archive/issue_comments_472740.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9bf8620892a7ed243a6f4bebc0dafa801f1950f\">c9bf862</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2020-09-26T19:39:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472740",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>**Comment 31:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9bf8620892a7ed243a6f4bebc0dafa801f1950f">c9bf862</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>




---

archive/issue_comments_472741.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nThanks. I've now merged upstream into this branch.",
    "created_at": "2020-09-26T19:41:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472741",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:32'>**Comment 32:**</a>
Thanks. I've now merged upstream into this branch.



---

archive/issue_events_359715.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-09-26T19:41:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359715"
}
```



---

archive/issue_events_359716.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-09-26T19:41:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359716"
}
```



---

archive/issue_events_359717.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359717"
}
```



---

archive/issue_events_359718.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359718"
}
```



---

archive/issue_comments_472742.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nred branch => needs work",
    "created_at": "2020-11-01T18:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472742",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'>**Comment 34:**</a>
red branch => needs work



---

archive/issue_events_359719.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-11-01T18:06:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359719"
}
```



---

archive/issue_events_359720.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-11-01T18:06:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359720"
}
```



---

archive/issue_comments_472743.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5db7ddfe2123b2bbf8500736548921ed3698ac35\">5db7ddf</a></td><td><code>Merge develop</code></td></tr></table>\n",
    "created_at": "2020-11-08T13:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472743",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:36'>**Comment 36:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5db7ddfe2123b2bbf8500736548921ed3698ac35">5db7ddf</a></td><td><code>Merge develop</code></td></tr></table>




---

archive/issue_comments_472744.json:
```json
{
    "body": "**Changing commit** from \"[c9bf8620892a7ed243a6f4bebc0dafa801f1950f](https://github.com/sagemath/sagetrac-mirror/commit/c9bf8620892a7ed243a6f4bebc0dafa801f1950f)\" to \"[5db7ddfe2123b2bbf8500736548921ed3698ac35](https://github.com/sagemath/sagetrac-mirror/commit/5db7ddfe2123b2bbf8500736548921ed3698ac35)\".",
    "created_at": "2020-11-08T13:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472744",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c9bf8620892a7ed243a6f4bebc0dafa801f1950f](https://github.com/sagemath/sagetrac-mirror/commit/c9bf8620892a7ed243a6f4bebc0dafa801f1950f)" to "[5db7ddfe2123b2bbf8500736548921ed3698ac35](https://github.com/sagemath/sagetrac-mirror/commit/5db7ddfe2123b2bbf8500736548921ed3698ac35)".



---

archive/issue_comments_472745.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe\">cd9ef9e</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2020-11-08T13:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472745",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:37'>**Comment 37:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe">cd9ef9e</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>




---

archive/issue_comments_472746.json:
```json
{
    "body": "**Changing commit** from \"[5db7ddfe2123b2bbf8500736548921ed3698ac35](https://github.com/sagemath/sagetrac-mirror/commit/5db7ddfe2123b2bbf8500736548921ed3698ac35)\" to \"[cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe](https://github.com/sagemath/sagetrac-mirror/commit/cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe)\".",
    "created_at": "2020-11-08T13:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472746",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[5db7ddfe2123b2bbf8500736548921ed3698ac35](https://github.com/sagemath/sagetrac-mirror/commit/5db7ddfe2123b2bbf8500736548921ed3698ac35)" to "[cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe](https://github.com/sagemath/sagetrac-mirror/commit/cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe)".



---

archive/issue_events_359721.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-11-08T13:55:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359721"
}
```



---

archive/issue_events_359722.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-11-08T13:55:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359722"
}
```



---

archive/issue_comments_472747.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nMerged upstream.",
    "created_at": "2020-11-08T13:55:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472747",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:38'>**Comment 38:**</a>
Merged upstream.



---

archive/issue_comments_472748.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\nIn changes like this one:\n\n```\n@@ -596,14 +597,13 @@ class DegenerateSubmanifold(DegenerateManifold, DifferentiableSubmanifold):\n         self._default_screen = self._screens[name]\n         return self._screens[name]\n \n-    def induced_metric(self):\n+    def induced_metric(self) -> DegenerateMetric:\n         r\"\"\"\n         Return the pullback of the ambient metric.\n \n         OUTPUT:\n \n-        - induced metric, as an instance of\n-          :class:`~sage.manifolds.differentiable.metric.DegenerateMetric`\n+        - induced mettric\n \n         EXAMPLES:\n```\nDid you check that our built documentation contains the output type?\n\n(Also note this introduces a typo)",
    "created_at": "2020-11-09T02:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472748",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'>**Comment 39:**</a>
In changes like this one:

```
@@ -596,14 +597,13 @@ class DegenerateSubmanifold(DegenerateManifold, DifferentiableSubmanifold):
         self._default_screen = self._screens[name]
         return self._screens[name]
 
-    def induced_metric(self):
+    def induced_metric(self) -> DegenerateMetric:
         r"""
         Return the pullback of the ambient metric.
 
         OUTPUT:
 
-        - induced metric, as an instance of
-          :class:`~sage.manifolds.differentiable.metric.DegenerateMetric`
+        - induced mettric
 
         EXAMPLES:
```
Did you check that our built documentation contains the output type?

(Also note this introduces a typo)



---

archive/issue_comments_472749.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\nReplying to [@mkoeppe](#comment%3A39):\n> In changes like this one:\n> \n> ```\n> -    def induced_metric(self):\n> +    def induced_metric(self) -> DegenerateMetric:\n>  \n> -        - induced metric, as an instance of\n> -          :class:`~sage.manifolds.differentiable.metric.DegenerateMetric`\n> +        - induced mettric\n> ```\n> Did you check that our built documentation contains the output type?\n> \n\nNo it does not: the output type does no longer appear in the generated html documentation.\n> (Also note this introduces a typo)\n> \n\nMoreover, what is the meaning of this change in `src/sage/manifolds/differentiable/manifold.py`:\n\n```diff\n-    def metric(self, name, signature=None, latex_name=None, dest_map=None):\n+    def metric(self, name=None, signature=None, latex_name=None, dest_map=None) -> PseudoRiemannianMetric:\n```\ni.e. why `name` is replaced by `name=None` ?",
    "created_at": "2020-11-09T20:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472749",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:40'>**Comment 40:**</a>
Replying to [@mkoeppe](#comment%3A39):
> In changes like this one:
> 
> ```
> -    def induced_metric(self):
> +    def induced_metric(self) -> DegenerateMetric:
>  
> -        - induced metric, as an instance of
> -          :class:`~sage.manifolds.differentiable.metric.DegenerateMetric`
> +        - induced mettric
> ```
> Did you check that our built documentation contains the output type?
> 

No it does not: the output type does no longer appear in the generated html documentation.
> (Also note this introduces a typo)
> 

Moreover, what is the meaning of this change in `src/sage/manifolds/differentiable/manifold.py`:

```diff
-    def metric(self, name, signature=None, latex_name=None, dest_map=None):
+    def metric(self, name=None, signature=None, latex_name=None, dest_map=None) -> PseudoRiemannianMetric:
```
i.e. why `name` is replaced by `name=None` ?



---

archive/issue_comments_472750.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nIf we do\n\n```\nsage: M = Manifold(2, 'M')                                                                          \nsage: M.vector_field_module?                                                                        \n```\nwe get\n\n``` \nSignature:     \nM.vector_field_module(\n    dest_map: sage.manifolds.differentiable.diff_map.DiffMap = None,\n    force_free=False,\n) -> sage.manifolds.differentiable.vectorfield_module.VectorFieldModule\n```\nwhich is barely readable, I think.",
    "created_at": "2020-11-09T21:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472750",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:41'>**Comment 41:**</a>
If we do

```
sage: M = Manifold(2, 'M')                                                                          
sage: M.vector_field_module?                                                                        
```
we get

``` 
Signature:     
M.vector_field_module(
    dest_map: sage.manifolds.differentiable.diff_map.DiffMap = None,
    force_free=False,
) -> sage.manifolds.differentiable.vectorfield_module.VectorFieldModule
```
which is barely readable, I think.



---

archive/issue_comments_472751.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nI'm currently working on a solution to show the typing information in the documentation using https://pypi.org/project/sphinx-autodoc-typehints/ (in a new ticket of course).\n\nNot sure why I changed the name to `None`. Probably I was \"inspired\" by the constructor of a generic tensor field:\n\n```\ndef __init__(self, vector_field_module, tensor_type, name=None,\n                 latex_name=None, sym=None, antisym=None, parent=None):\n```\nDoes the name has to be set for a metric?",
    "created_at": "2020-11-09T21:29:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472751",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:42'>**Comment 42:**</a>
I'm currently working on a solution to show the typing information in the documentation using https://pypi.org/project/sphinx-autodoc-typehints/ (in a new ticket of course).

Not sure why I changed the name to `None`. Probably I was "inspired" by the constructor of a generic tensor field:

```
def __init__(self, vector_field_module, tensor_type, name=None,
                 latex_name=None, sym=None, antisym=None, parent=None):
```
Does the name has to be set for a metric?



---

archive/issue_comments_472752.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\nReplying to [@tobiasdiez](#comment%3A42):\n> \n> Not sure why I changed the name to `None`. Probably I was \"inspired\" by the constructor of a generic tensor field:\n> \n> ```\n> def __init__(self, vector_field_module, tensor_type, name=None,\n>                  latex_name=None, sym=None, antisym=None, parent=None):\n> ```\n> Does the name has to be set for a metric? \n\nYes for it is used to set the name of derived quantities (Levi-Civita connection, curvature tensor, etc.). Of course, this can be discussed and changed, but in another ticket, since this definitely does not pertain to the current ticket.",
    "created_at": "2020-11-10T14:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472752",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:43'>**Comment 43:**</a>
Replying to [@tobiasdiez](#comment%3A42):
> 
> Not sure why I changed the name to `None`. Probably I was "inspired" by the constructor of a generic tensor field:
> 
> ```
> def __init__(self, vector_field_module, tensor_type, name=None,
>                  latex_name=None, sym=None, antisym=None, parent=None):
> ```
> Does the name has to be set for a metric? 

Yes for it is used to set the name of derived quantities (Levi-Civita connection, curvature tensor, etc.). Of course, this can be discussed and changed, but in another ticket, since this definitely does not pertain to the current ticket.



---

archive/issue_events_359723.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-11T17:01:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359723"
}
```



---

archive/issue_events_359724.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-11-11T17:01:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359724"
}
```



---

archive/issue_comments_472753.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db5a3fc859f51c490964b271e4a3b53883cd2ad1\">db5a3fc</a></td><td><code>Readd documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c937af86321a0814134ee7181def881e3804ec2\">0c937af</a></td><td><code>Remove none for metric</code></td></tr></table>\n",
    "created_at": "2020-11-21T12:20:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472753",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:45'>**Comment 45:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db5a3fc859f51c490964b271e4a3b53883cd2ad1">db5a3fc</a></td><td><code>Readd documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c937af86321a0814134ee7181def881e3804ec2">0c937af</a></td><td><code>Remove none for metric</code></td></tr></table>




---

archive/issue_comments_472754.json:
```json
{
    "body": "**Changing commit** from \"[cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe](https://github.com/sagemath/sagetrac-mirror/commit/cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe)\" to \"[0c937af86321a0814134ee7181def881e3804ec2](https://github.com/sagemath/sagetrac-mirror/commit/0c937af86321a0814134ee7181def881e3804ec2)\".",
    "created_at": "2020-11-21T12:20:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472754",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe](https://github.com/sagemath/sagetrac-mirror/commit/cd9ef9e0cd24aaa748fdc470268f6ce8dc69aefe)" to "[0c937af86321a0814134ee7181def881e3804ec2](https://github.com/sagemath/sagetrac-mirror/commit/0c937af86321a0814134ee7181def881e3804ec2)".



---

archive/issue_comments_472755.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\nI tried to change the documentation to incorporate typing information, but this turns out to be a bit more complicated than expected.\nSo for now I've readded the class information in the documentation.\n\nMoreover, I've removed the `name = None` for the metric again.\n\nSo it should be ready for review now.",
    "created_at": "2020-11-21T12:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472755",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:46'>**Comment 46:**</a>
I tried to change the documentation to incorporate typing information, but this turns out to be a bit more complicated than expected.
So for now I've readded the class information in the documentation.

Moreover, I've removed the `name = None` for the metric again.

So it should be ready for review now.



---

archive/issue_events_359725.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-11-21T12:35:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359725"
}
```



---

archive/issue_events_359726.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-11-21T12:35:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359726"
}
```



---

archive/issue_comments_472756.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,3 @@\n-This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. I've changed the inline documentation accordingly. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.\n-Probably the biggest change is the addition of the identity map for a smooth manifold (which is a `DiffMap` and not just a `ContinousMap`).\n+This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.\n \n Moreover, a few very minor clarifications to the documentation were added as well.\n-\n-(This is my first real PR to sagemath, so please forgive me if I overlooked something.)\n``````\n",
    "created_at": "2020-11-21T12:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472756",
    "user": "https://github.com/tobiasdiez"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,3 @@
-This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. I've changed the inline documentation accordingly. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.
-Probably the biggest change is the addition of the identity map for a smooth manifold (which is a `DiffMap` and not just a `ContinousMap`).
+This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.
 
 Moreover, a few very minor clarifications to the documentation were added as well.
-
-(This is my first real PR to sagemath, so please forgive me if I overlooked something.)
``````




---

archive/issue_events_359727.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T18:21:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359727"
}
```



---

archive/issue_events_359728.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T18:21:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359728"
}
```



---

archive/issue_comments_472757.json:
```json
{
    "body": "<a id='comment:47'>**Comment 47:**</a>\nred branch",
    "created_at": "2020-12-19T18:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472757",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:47'>**Comment 47:**</a>
red branch



---

archive/issue_comments_472758.json:
```json
{
    "body": "**Changing commit** from \"[0c937af86321a0814134ee7181def881e3804ec2](https://github.com/sagemath/sagetrac-mirror/commit/0c937af86321a0814134ee7181def881e3804ec2)\" to \"[06770cdb3dafa5f0833b96580675e2bf847d5ca3](https://github.com/sagemath/sagetrac-mirror/commit/06770cdb3dafa5f0833b96580675e2bf847d5ca3)\".",
    "created_at": "2020-12-20T22:46:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472758",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[0c937af86321a0814134ee7181def881e3804ec2](https://github.com/sagemath/sagetrac-mirror/commit/0c937af86321a0814134ee7181def881e3804ec2)" to "[06770cdb3dafa5f0833b96580675e2bf847d5ca3](https://github.com/sagemath/sagetrac-mirror/commit/06770cdb3dafa5f0833b96580675e2bf847d5ca3)".



---

archive/issue_comments_472759.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06770cdb3dafa5f0833b96580675e2bf847d5ca3\">06770cd</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2020-12-20T22:46:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472759",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:48'>**Comment 48:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06770cdb3dafa5f0833b96580675e2bf847d5ca3">06770cd</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>




---

archive/issue_events_359729.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-12-20T22:47:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359729"
}
```



---

archive/issue_events_359730.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2020-12-20T22:47:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359730"
}
```



---

archive/issue_comments_472760.json:
```json
{
    "body": "<a id='comment:49'>**Comment 49:**</a>\nMerged develop branch.",
    "created_at": "2020-12-20T22:47:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472760",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:49'>**Comment 49:**</a>
Merged develop branch.



---

archive/issue_comments_472761.json:
```json
{
    "body": "<a id='comment:50'>**Comment 50:**</a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472761",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:50'>**Comment 50:**</a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_359731.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359731"
}
```



---

archive/issue_events_359732.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359732"
}
```



---

archive/issue_comments_472762.json:
```json
{
    "body": "<a id='comment:51'>**Comment 51:**</a>\nIt would be nice if this ticket could be reviewed. Thanks!",
    "created_at": "2021-04-23T08:12:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472762",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:51'>**Comment 51:**</a>
It would be nice if this ticket could be reviewed. Thanks!



---

archive/issue_comments_472763.json:
```json
{
    "body": "<a id='comment:52'>**Comment 52:**</a>\nThe patchbot reports many doctest errors.",
    "created_at": "2021-04-24T12:26:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472763",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:52'>**Comment 52:**</a>
The patchbot reports many doctest errors.



---

archive/issue_events_359733.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-24T21:03:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359733"
}
```



---

archive/issue_events_359734.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-24T21:03:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359734"
}
```



---

archive/issue_comments_472764.json:
```json
{
    "body": "<a id='comment:54'>**Comment 54:**</a>\nAlso, now that we can use `from `__future__` import annotations`, I think some of the type annotations can be simplified",
    "created_at": "2021-05-27T23:28:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472764",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:54'>**Comment 54:**</a>
Also, now that we can use `from `__future__` import annotations`, I think some of the type annotations can be simplified



---

archive/issue_comments_472765.json:
```json
{
    "body": "<a id='comment:55'>**Comment 55:**</a>\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472765",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:55'>**Comment 55:**</a>
Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_359735.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359735"
}
```



---

archive/issue_events_359736.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359736"
}
```



---

archive/issue_comments_472766.json:
```json
{
    "body": "<a id='comment:56'>**Comment 56:**</a>\nSorry for the delay, but the doctests should be fixed now. I also use the future import for annotations, which indeed simplifies a few things. \nAgain ready for review.",
    "created_at": "2021-11-28T20:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472766",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:56'>**Comment 56:**</a>
Sorry for the delay, but the doctests should be fixed now. I also use the future import for annotations, which indeed simplifies a few things. 
Again ready for review.



---

archive/issue_events_359737.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2021-11-28T20:52:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359737"
}
```



---

archive/issue_events_359738.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2021-11-28T20:52:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359738"
}
```



---

archive/issue_comments_472767.json:
```json
{
    "body": "**Changing commit** from \"[06770cdb3dafa5f0833b96580675e2bf847d5ca3](https://github.com/sagemath/sagetrac-mirror/commit/06770cdb3dafa5f0833b96580675e2bf847d5ca3)\" to \"[fc15d33011d3b64a937f2e3b3f54610d66707741](https://github.com/sagemath/sagetrac-mirror/commit/fc15d33011d3b64a937f2e3b3f54610d66707741)\".",
    "created_at": "2021-11-28T20:53:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472767",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[06770cdb3dafa5f0833b96580675e2bf847d5ca3](https://github.com/sagemath/sagetrac-mirror/commit/06770cdb3dafa5f0833b96580675e2bf847d5ca3)" to "[fc15d33011d3b64a937f2e3b3f54610d66707741](https://github.com/sagemath/sagetrac-mirror/commit/fc15d33011d3b64a937f2e3b3f54610d66707741)".



---

archive/issue_comments_472768.json:
```json
{
    "body": "<a id='comment:57'>**Comment 57:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b45edce74275bef50ab7af981973bbfd9538c77f\">b45edce</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/manifolds/typing</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc15d33011d3b64a937f2e3b3f54610d66707741\">fc15d33</a></td><td><code>Improve typing</code></td></tr></table>\n",
    "created_at": "2021-11-28T20:53:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472768",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:57'>**Comment 57:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b45edce74275bef50ab7af981973bbfd9538c77f">b45edce</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/manifolds/typing</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc15d33011d3b64a937f2e3b3f54610d66707741">fc15d33</a></td><td><code>Improve typing</code></td></tr></table>




---

archive/issue_comments_472769.json:
```json
{
    "body": "**Changing commit** from \"[fc15d33011d3b64a937f2e3b3f54610d66707741](https://github.com/sagemath/sagetrac-mirror/commit/fc15d33011d3b64a937f2e3b3f54610d66707741)\" to \"[3f16aee5f3d1ba819e7506deb4dc647cea8f1a86](https://github.com/sagemath/sagetrac-mirror/commit/3f16aee5f3d1ba819e7506deb4dc647cea8f1a86)\".",
    "created_at": "2021-11-28T20:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472769",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[fc15d33011d3b64a937f2e3b3f54610d66707741](https://github.com/sagemath/sagetrac-mirror/commit/fc15d33011d3b64a937f2e3b3f54610d66707741)" to "[3f16aee5f3d1ba819e7506deb4dc647cea8f1a86](https://github.com/sagemath/sagetrac-mirror/commit/3f16aee5f3d1ba819e7506deb4dc647cea8f1a86)".



---

archive/issue_comments_472770.json:
```json
{
    "body": "<a id='comment:58'>**Comment 58:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f16aee5f3d1ba819e7506deb4dc647cea8f1a86\">3f16aee</a></td><td><code>Fix tests</code></td></tr></table>\n",
    "created_at": "2021-11-28T20:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472770",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:58'>**Comment 58:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f16aee5f3d1ba819e7506deb4dc647cea8f1a86">3f16aee</a></td><td><code>Fix tests</code></td></tr></table>




---

archive/issue_events_359739.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359739"
}
```



---

archive/issue_events_359740.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359740"
}
```



---

archive/issue_comments_472771.json:
```json
{
    "body": "<a id='comment:59'>**Comment 59:**</a>\nStalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472771",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:59'>**Comment 59:**</a>
Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_359741.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-12-28T16:27:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359741"
}
```



---

archive/issue_events_359742.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-12-28T16:27:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359742"
}
```



---

archive/issue_comments_472772.json:
```json
{
    "body": "<a id='comment:60'>**Comment 60:**</a>\nred branch => needs work",
    "created_at": "2021-12-28T16:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472772",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:60'>**Comment 60:**</a>
red branch => needs work



---

archive/issue_events_359743.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2021-12-28T17:53:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359743"
}
```



---

archive/issue_events_359744.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2021-12-28T17:53:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359744"
}
```



---

archive/issue_comments_472773.json:
```json
{
    "body": "<a id='comment:61'>**Comment 61:**</a>\nSetting it back to needs review as the merge conflict should be easy to resolve but I'm not near my dev machine for a couple of days.\n\nIt would be really nice if someone could review this ticket, as it's in this limbo state now for quite some time.",
    "created_at": "2021-12-28T17:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472773",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:61'>**Comment 61:**</a>
Setting it back to needs review as the merge conflict should be easy to resolve but I'm not near my dev machine for a couple of days.

It would be really nice if someone could review this ticket, as it's in this limbo state now for quite some time.



---

archive/issue_comments_472774.json:
```json
{
    "body": "<a id='comment:62'>**Comment 62:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69c09434fd99d865c4740f864844e52778042267\">69c0943</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2022-01-03T12:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472774",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:62'>**Comment 62:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69c09434fd99d865c4740f864844e52778042267">69c0943</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into public/manifolds/typing</code></td></tr></table>




---

archive/issue_comments_472775.json:
```json
{
    "body": "**Changing commit** from \"[3f16aee5f3d1ba819e7506deb4dc647cea8f1a86](https://github.com/sagemath/sagetrac-mirror/commit/3f16aee5f3d1ba819e7506deb4dc647cea8f1a86)\" to \"[69c09434fd99d865c4740f864844e52778042267](https://github.com/sagemath/sagetrac-mirror/commit/69c09434fd99d865c4740f864844e52778042267)\".",
    "created_at": "2022-01-03T12:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472775",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3f16aee5f3d1ba819e7506deb4dc647cea8f1a86](https://github.com/sagemath/sagetrac-mirror/commit/3f16aee5f3d1ba819e7506deb4dc647cea8f1a86)" to "[69c09434fd99d865c4740f864844e52778042267](https://github.com/sagemath/sagetrac-mirror/commit/69c09434fd99d865c4740f864844e52778042267)".



---

archive/issue_events_359745.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-01-28T00:07:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "08517b",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359745"
}
```



---

archive/issue_events_359746.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-01-28T00:07:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20manifolds",
    "label_color": "08517b",
    "label_name": "component: manifolds",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359746"
}
```



---

archive/issue_comments_472776.json:
```json
{
    "body": "<a id='comment:64'>**Comment 64:**</a>\nred branch",
    "created_at": "2022-02-23T17:58:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472776",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'>**Comment 64:**</a>
red branch



---

archive/issue_events_359747.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-23T17:58:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359747"
}
```



---

archive/issue_events_359748.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-23T17:58:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359748"
}
```



---

archive/issue_events_359749.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-23T21:52:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359749"
}
```



---

archive/issue_events_359750.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-02-23T21:52:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359750"
}
```



---

archive/issue_comments_472777.json:
```json
{
    "body": "<a id='comment:65'>**Comment 65:**</a>\nMerging the develop branch should be trivial, but I'll not be able to do this is in the near future; so setting it back to \"needs review\".",
    "created_at": "2022-02-23T21:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472777",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:65'>**Comment 65:**</a>
Merging the develop branch should be trivial, but I'll not be able to do this is in the near future; so setting it back to "needs review".



---

archive/issue_comments_472778.json:
```json
{
    "body": "**Changing commit** from \"[69c09434fd99d865c4740f864844e52778042267](https://github.com/sagemath/sagetrac-mirror/commit/69c09434fd99d865c4740f864844e52778042267)\" to \"[229fde199d98d0eb71102ff413c827277b2c2c54](https://github.com/sagemath/sagetrac-mirror/commit/229fde199d98d0eb71102ff413c827277b2c2c54)\".",
    "created_at": "2022-03-01T13:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472778",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[69c09434fd99d865c4740f864844e52778042267](https://github.com/sagemath/sagetrac-mirror/commit/69c09434fd99d865c4740f864844e52778042267)" to "[229fde199d98d0eb71102ff413c827277b2c2c54](https://github.com/sagemath/sagetrac-mirror/commit/229fde199d98d0eb71102ff413c827277b2c2c54)".



---

archive/issue_comments_472779.json:
```json
{
    "body": "<a id='comment:66'>**Comment 66:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/229fde199d98d0eb71102ff413c827277b2c2c54\">229fde1</a></td><td><code>Merge remote-tracking branch 'origin/develop' into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2022-03-01T13:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472779",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:66'>**Comment 66:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/229fde199d98d0eb71102ff413c827277b2c2c54">229fde1</a></td><td><code>Merge remote-tracking branch 'origin/develop' into public/manifolds/typing</code></td></tr></table>




---

archive/issue_comments_472780.json:
```json
{
    "body": "<a id='comment:67'>**Comment 67:**</a>\n\n```\n--- a/src/sage/manifolds/differentiable/metric.py\n+++ b/src/sage/manifolds/differentiable/metric.py\n@@ -41,12 +41,16 @@ REFERENCES:\n #  the License, or (at your option) any later version.\n #                  https://www.gnu.org/licenses/\n # *****************************************************************************\n+from __future__ import annotations\n+from typing import overload, TYPE_CHECKING\n \n from __future__ import annotations\n from typing import TYPE_CHECKING\n from sage.rings.integer import Integer\n from sage.manifolds.differentiable.tensorfield import TensorField\n from sage.manifolds.differentiable.tensorfield_paral import TensorFieldParal\n+if TYPE_CHECKING:\n+    from sage.manifolds.differentiable.diff_form import DiffForm\n \n if TYPE_CHECKING:\n     from sage.manifolds.differentiable.diff_form import DiffForm\n```\n\nThis doesn't look right",
    "created_at": "2022-03-01T17:24:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472780",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:67'>**Comment 67:**</a>

```
--- a/src/sage/manifolds/differentiable/metric.py
+++ b/src/sage/manifolds/differentiable/metric.py
@@ -41,12 +41,16 @@ REFERENCES:
 #  the License, or (at your option) any later version.
 #                  https://www.gnu.org/licenses/
 # *****************************************************************************
+from __future__ import annotations
+from typing import overload, TYPE_CHECKING
 
 from __future__ import annotations
 from typing import TYPE_CHECKING
 from sage.rings.integer import Integer
 from sage.manifolds.differentiable.tensorfield import TensorField
 from sage.manifolds.differentiable.tensorfield_paral import TensorFieldParal
+if TYPE_CHECKING:
+    from sage.manifolds.differentiable.diff_form import DiffForm
 
 if TYPE_CHECKING:
     from sage.manifolds.differentiable.diff_form import DiffForm
```

This doesn't look right



---

archive/issue_events_359751.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-01T17:24:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359751"
}
```



---

archive/issue_events_359752.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-01T17:24:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359752"
}
```



---

archive/issue_comments_472781.json:
```json
{
    "body": "<a id='comment:69'>**Comment 69:**</a>\nAnd I would urge to use more restraint in changing the coding style.\nFor example, these changes are entirely gratuitous:\n\n```\n     if structure is None:\n-        diff_degree = extra_kwds.get('diff_degree', infinity)\n+        diff_degree = extra_kwds.get(\"diff_degree\", infinity)\n         if diff_degree == infinity:\n-            structure = 'smooth'\n+            structure = \"smooth\"\n         elif diff_degree > 0:\n-            structure = 'differentiable'\n+            structure = \"differentiable\"\n         else:\n-            structure = 'topological'\n+            structure = \"topological\"\n```",
    "created_at": "2022-03-01T17:25:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472781",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:69'>**Comment 69:**</a>
And I would urge to use more restraint in changing the coding style.
For example, these changes are entirely gratuitous:

```
     if structure is None:
-        diff_degree = extra_kwds.get('diff_degree', infinity)
+        diff_degree = extra_kwds.get("diff_degree", infinity)
         if diff_degree == infinity:
-            structure = 'smooth'
+            structure = "smooth"
         elif diff_degree > 0:
-            structure = 'differentiable'
+            structure = "differentiable"
         else:
-            structure = 'topological'
+            structure = "topological"
```



---

archive/issue_comments_472782.json:
```json
{
    "body": "<a id='comment:70'>**Comment 70:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4290c246b93db15f99eb683fcbb6b44de326813d\">4290c24</a></td><td><code>Fix style</code></td></tr></table>\n",
    "created_at": "2022-03-01T18:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472782",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:70'>**Comment 70:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4290c246b93db15f99eb683fcbb6b44de326813d">4290c24</a></td><td><code>Fix style</code></td></tr></table>




---

archive/issue_comments_472783.json:
```json
{
    "body": "**Changing commit** from \"[229fde199d98d0eb71102ff413c827277b2c2c54](https://github.com/sagemath/sagetrac-mirror/commit/229fde199d98d0eb71102ff413c827277b2c2c54)\" to \"[4290c246b93db15f99eb683fcbb6b44de326813d](https://github.com/sagemath/sagetrac-mirror/commit/4290c246b93db15f99eb683fcbb6b44de326813d)\".",
    "created_at": "2022-03-01T18:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472783",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[229fde199d98d0eb71102ff413c827277b2c2c54](https://github.com/sagemath/sagetrac-mirror/commit/229fde199d98d0eb71102ff413c827277b2c2c54)" to "[4290c246b93db15f99eb683fcbb6b44de326813d](https://github.com/sagemath/sagetrac-mirror/commit/4290c246b93db15f99eb683fcbb6b44de326813d)".



---

archive/issue_events_359753.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-01T18:19:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359753"
}
```



---

archive/issue_events_359754.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-01T18:19:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359754"
}
```



---

archive/issue_comments_472784.json:
```json
{
    "body": "<a id='comment:71'>**Comment 71:**</a>\nReplying to [@mkoeppe](#comment%3A67):\n> \n> ```\n> --- a/src/sage/manifolds/differentiable/metric.py\n> +++ b/src/sage/manifolds/differentiable/metric.py\n> This doesn't look right\n> ```\n\nThanks, I was still in the process of fixing some of the merge conflicts. Done now.",
    "created_at": "2022-03-01T18:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472784",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:71'>**Comment 71:**</a>
Replying to [@mkoeppe](#comment%3A67):
> 
> ```
> --- a/src/sage/manifolds/differentiable/metric.py
> +++ b/src/sage/manifolds/differentiable/metric.py
> This doesn't look right
> ```

Thanks, I was still in the process of fixing some of the merge conflicts. Done now.



---

archive/issue_comments_472785.json:
```json
{
    "body": "<a id='comment:72'>**Comment 72:**</a>\nYou didn't address [comment:69](#comment%3A69)",
    "created_at": "2022-03-03T01:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472785",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:72'>**Comment 72:**</a>
You didn't address [comment:69](#comment%3A69)



---

archive/issue_events_359755.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-03T01:01:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359755"
}
```



---

archive/issue_events_359756.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-03T01:01:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359756"
}
```



---

archive/issue_comments_472786.json:
```json
{
    "body": "<a id='comment:73'>**Comment 73:**</a>\nAnd this change is an API change (= introduces a bug).\n\nThe argument `tensor_type` does NOT have `Tuple[int, int]` as its input type. It also accepts lists. It marshals the input to a tuple.\n\nYour change removes the marshaling.\n\n```\n TensorType = Tuple[int, int]\n\n@@ -402,8 +405,17 @@ class TensorField(ModuleElementWithMutability):\n         ValueError: the name of an immutable element cannot be changed\n \n     \"\"\"\n-    def __init__(self, vector_field_module, tensor_type, name=None,\n-                 latex_name=None, sym=None, antisym=None, parent=None):\n+\n+    def __init__(\n+        self,\n+        vector_field_module: VectorFieldModule,\n+        tensor_type: TensorType,\n+        name: Optional[str] = None,\n+        latex_name: Optional[str] = None,\n+        sym=None,\n+        antisym=None,\n+        parent=None,\n+    ):\n         r\"\"\"\n         Construct a tensor field.\n \n@@ -451,7 +463,7 @@ class TensorField(ModuleElementWithMutability):\n             parent = vector_field_module.tensor_module(*tensor_type)\n         ModuleElementWithMutability.__init__(self, parent)\n         self._vmodule = vector_field_module\n-        self._tensor_type = tuple(tensor_type)\n+        self._tensor_type = tensor_type\n         self._tensor_rank = self._tensor_type[0] + self._tensor_type[1]\n         self._is_zero = False # a priori, may be changed below or via\n                               # method __bool__()\n```",
    "created_at": "2022-03-03T01:11:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472786",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:73'>**Comment 73:**</a>
And this change is an API change (= introduces a bug).

The argument `tensor_type` does NOT have `Tuple[int, int]` as its input type. It also accepts lists. It marshals the input to a tuple.

Your change removes the marshaling.

```
 TensorType = Tuple[int, int]

@@ -402,8 +405,17 @@ class TensorField(ModuleElementWithMutability):
         ValueError: the name of an immutable element cannot be changed
 
     """
-    def __init__(self, vector_field_module, tensor_type, name=None,
-                 latex_name=None, sym=None, antisym=None, parent=None):
+
+    def __init__(
+        self,
+        vector_field_module: VectorFieldModule,
+        tensor_type: TensorType,
+        name: Optional[str] = None,
+        latex_name: Optional[str] = None,
+        sym=None,
+        antisym=None,
+        parent=None,
+    ):
         r"""
         Construct a tensor field.
 
@@ -451,7 +463,7 @@ class TensorField(ModuleElementWithMutability):
             parent = vector_field_module.tensor_module(*tensor_type)
         ModuleElementWithMutability.__init__(self, parent)
         self._vmodule = vector_field_module
-        self._tensor_type = tuple(tensor_type)
+        self._tensor_type = tensor_type
         self._tensor_rank = self._tensor_type[0] + self._tensor_type[1]
         self._is_zero = False # a priori, may be changed below or via
                               # method __bool__()
```



---

archive/issue_comments_472787.json:
```json
{
    "body": "<a id='comment:74'>**Comment 74:**</a>\nReplying to [@mkoeppe](#comment%3A73):\n> And this change is an API change (= introduces a bug).\n> \n> The argument `tensor_type` does NOT have `Tuple[int, int]` as its input type. It also accepts lists. It marshals the input to a tuple.\n\nAccording to the documentation \n> - ``tensor_type`` -- pair `(k,l)` with `k` being the contravariant rank\n\n      and `l` the covariant rank\n\nwhich is quite clear about that it expects a 2-tuple. Thus, this change is only a formalization of the current public interface; I can of course revert it and adapt the documentation to point out that it also accepts arbitrary iterables if that's really desired. It feels however more consistent to represent the tensor type everywhere by a tuple.",
    "created_at": "2022-03-03T12:10:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472787",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:74'>**Comment 74:**</a>
Replying to [@mkoeppe](#comment%3A73):
> And this change is an API change (= introduces a bug).
> 
> The argument `tensor_type` does NOT have `Tuple[int, int]` as its input type. It also accepts lists. It marshals the input to a tuple.

According to the documentation 
> - ``tensor_type`` -- pair `(k,l)` with `k` being the contravariant rank

      and `l` the covariant rank

which is quite clear about that it expects a 2-tuple. Thus, this change is only a formalization of the current public interface; I can of course revert it and adapt the documentation to point out that it also accepts arbitrary iterables if that's really desired. It feels however more consistent to represent the tensor type everywhere by a tuple.



---

archive/issue_comments_472788.json:
```json
{
    "body": "<a id='comment:75'>**Comment 75:**</a>\nReplying to [@mkoeppe](#comment%3A72):\n> You didn't address [comment:69](#comment%3A69)\n\nI accidentally run a code formatter over these files and committed the changes; sorry for this. Will try not to do this again in the future.",
    "created_at": "2022-03-03T12:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472788",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:75'>**Comment 75:**</a>
Replying to [@mkoeppe](#comment%3A72):
> You didn't address [comment:69](#comment%3A69)

I accidentally run a code formatter over these files and committed the changes; sorry for this. Will try not to do this again in the future.



---

archive/issue_comments_472789.json:
```json
{
    "body": "<a id='comment:76'>**Comment 76:**</a>\nReplying to [@tobiasdiez](#comment%3A74):\n> Replying to [@mkoeppe](#comment%3A73):\n> > And this change is an API change (= introduces a bug).\n> > \n> > The argument `tensor_type` does NOT have `Tuple[int, int]` as its input type. It also accepts lists. It marshals the input to a tuple.\n\n> \n> According to the documentation \n> > - ``tensor_type`` -- pair `(k,l)` with `k` being the contravariant rank\n\n>       and `l` the covariant rank\n> \n> which is quite clear about that it expects a 2-tuple. \n\nWell, the code obviously was concerned about making it a tuple to provide a robust interface. \n\n> Thus, this change is only a formalization of the current public interface\n\nNo, this is not how Python typing works. You cannot rely on the type annotations for input checking/marshaling; this still has to be done by code. Type annotations are merely decoration for documentation purposes and static checkers.",
    "created_at": "2022-03-03T19:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472789",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:76'>**Comment 76:**</a>
Replying to [@tobiasdiez](#comment%3A74):
> Replying to [@mkoeppe](#comment%3A73):
> > And this change is an API change (= introduces a bug).
> > 
> > The argument `tensor_type` does NOT have `Tuple[int, int]` as its input type. It also accepts lists. It marshals the input to a tuple.

> 
> According to the documentation 
> > - ``tensor_type`` -- pair `(k,l)` with `k` being the contravariant rank

>       and `l` the covariant rank
> 
> which is quite clear about that it expects a 2-tuple. 

Well, the code obviously was concerned about making it a tuple to provide a robust interface. 

> Thus, this change is only a formalization of the current public interface

No, this is not how Python typing works. You cannot rely on the type annotations for input checking/marshaling; this still has to be done by code. Type annotations are merely decoration for documentation purposes and static checkers.



---

archive/issue_comments_472790.json:
```json
{
    "body": "**Changing commit** from \"[4290c246b93db15f99eb683fcbb6b44de326813d](https://github.com/sagemath/sagetrac-mirror/commit/4290c246b93db15f99eb683fcbb6b44de326813d)\" to \"[b7d121c6a5c178273069a0fc0b638e41aea86c65](https://github.com/sagemath/sagetrac-mirror/commit/b7d121c6a5c178273069a0fc0b638e41aea86c65)\".",
    "created_at": "2022-03-20T13:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472790",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[4290c246b93db15f99eb683fcbb6b44de326813d](https://github.com/sagemath/sagetrac-mirror/commit/4290c246b93db15f99eb683fcbb6b44de326813d)" to "[b7d121c6a5c178273069a0fc0b638e41aea86c65](https://github.com/sagemath/sagetrac-mirror/commit/b7d121c6a5c178273069a0fc0b638e41aea86c65)".



---

archive/issue_comments_472791.json:
```json
{
    "body": "<a id='comment:77'>**Comment 77:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e911a4f3eabc5b6a556fee6444f068886c1d69f\">8e911a4</a></td><td><code>Readd tuple</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7d121c6a5c178273069a0fc0b638e41aea86c65\">b7d121c</a></td><td><code>Merge remote-tracking branch 'origin/develop' into public/manifolds/typing</code></td></tr></table>\n",
    "created_at": "2022-03-20T13:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472791",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:77'>**Comment 77:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e911a4f3eabc5b6a556fee6444f068886c1d69f">8e911a4</a></td><td><code>Readd tuple</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7d121c6a5c178273069a0fc0b638e41aea86c65">b7d121c</a></td><td><code>Merge remote-tracking branch 'origin/develop' into public/manifolds/typing</code></td></tr></table>




---

archive/issue_events_359757.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-20T16:23:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359757"
}
```



---

archive/issue_events_359758.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-20T16:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359758"
}
```



---

archive/issue_comments_472792.json:
```json
{
    "body": "<a id='comment:79'>**Comment 79:**</a>\nI think these changes are not good. They are obscuring the internal data representation\n\n```\n@@ -847,11 +847,11 @@ class TopologicalSubmanifold(TopologicalManifold):\n              3-dimensional topological manifold M\n \n         \"\"\"\n-        if not self._immersed:\n+        if not self._immersed or not self._immersion:\n             raise ValueError(\"the submanifold is not immersed\")\n         return self._immersion\n\n[...] \n@@ -873,7 +873,7 @@ class TopologicalSubmanifold(TopologicalManifold):\n              3-dimensional topological manifold M\n \n         \"\"\"\n-        if not self._embedded:\n+        if not self._embedded or not self._immersion:\n             raise ValueError(\"the submanifold is not embedded\")\n         return self._immersion\n \n```",
    "created_at": "2022-03-20T16:54:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472792",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:79'>**Comment 79:**</a>
I think these changes are not good. They are obscuring the internal data representation

```
@@ -847,11 +847,11 @@ class TopologicalSubmanifold(TopologicalManifold):
              3-dimensional topological manifold M
 
         """
-        if not self._immersed:
+        if not self._immersed or not self._immersion:
             raise ValueError("the submanifold is not immersed")
         return self._immersion

[...] 
@@ -873,7 +873,7 @@ class TopologicalSubmanifold(TopologicalManifold):
              3-dimensional topological manifold M
 
         """
-        if not self._embedded:
+        if not self._embedded or not self._immersion:
             raise ValueError("the submanifold is not embedded")
         return self._immersion
 
```



---

archive/issue_comments_472793.json:
```json
{
    "body": "<a id='comment:80'>**Comment 80:**</a>\nI'm personally in favor of these changes (the 80 character limit is a bit inflexible when module names or identifiers are already 40-ish characters long), but probably @egourgoulhon should indicate whether these formatting changes are acceptable / welcome.\n\n```\n@@ -647,8 +654,8 @@ class VectorFieldModule(UniqueRepresentation, Parent):\n             for more examples and documentation.\n \n         \"\"\"\n-        from sage.manifolds.differentiable.diff_form_module import \\\n-                                                                 DiffFormModule\n+        from sage.manifolds.differentiable.diff_form_module import DiffFormModule\n+\n         if p == 0:\n             return self._ring\n         if p not in self._dual_exterior_powers:\n```",
    "created_at": "2022-03-20T16:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472793",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:80'>**Comment 80:**</a>
I'm personally in favor of these changes (the 80 character limit is a bit inflexible when module names or identifiers are already 40-ish characters long), but probably @egourgoulhon should indicate whether these formatting changes are acceptable / welcome.

```
@@ -647,8 +654,8 @@ class VectorFieldModule(UniqueRepresentation, Parent):
             for more examples and documentation.
 
         """
-        from sage.manifolds.differentiable.diff_form_module import \
-                                                                 DiffFormModule
+        from sage.manifolds.differentiable.diff_form_module import DiffFormModule
+
         if p == 0:
             return self._ring
         if p not in self._dual_exterior_powers:
```



---

archive/issue_comments_472794.json:
```json
{
    "body": "<a id='comment:81'>**Comment 81:**</a>\nI don't understand what you mean. How can a submanifold be considered to be immersed/embedded if there is map that provides such an immersion?",
    "created_at": "2022-03-20T17:00:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472794",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:81'>**Comment 81:**</a>
I don't understand what you mean. How can a submanifold be considered to be immersed/embedded if there is map that provides such an immersion?



---

archive/issue_comments_472795.json:
```json
{
    "body": "<a id='comment:82'>**Comment 82:**</a>\nIt is an invariant of the internal representation (data structure) that `_immersed or _embedded` implies that `_immersion` is set.",
    "created_at": "2022-03-20T18:58:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472795",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:82'>**Comment 82:**</a>
It is an invariant of the internal representation (data structure) that `_immersed or _embedded` implies that `_immersion` is set.



---

archive/issue_comments_472796.json:
```json
{
    "body": "<a id='comment:83'>**Comment 83:**</a>\nReplying to [@mkoeppe](#comment%3A82):\n> It is an invariant of the internal representation (data structure) that `_immersed or _embedded` implies that `_immersion` is set.\n\nBut that's not something a static checker could infer and thus they warn that `return self._immersion` might return null although the method is decorated to always return a continuous map.",
    "created_at": "2022-03-20T19:39:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472796",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:83'>**Comment 83:**</a>
Replying to [@mkoeppe](#comment%3A82):
> It is an invariant of the internal representation (data structure) that `_immersed or _embedded` implies that `_immersion` is set.

But that's not something a static checker could infer and thus they warn that `return self._immersion` might return null although the method is decorated to always return a continuous map.



---

archive/issue_comments_472797.json:
```json
{
    "body": "<a id='comment:84'>**Comment 84:**</a>\nIt may be a use case for an `assert _immersion` here. If the static checker still can't infer it after that, get a better one",
    "created_at": "2022-03-20T19:41:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472797",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:84'>**Comment 84:**</a>
It may be a use case for an `assert _immersion` here. If the static checker still can't infer it after that, get a better one



---

archive/issue_comments_472798.json:
```json
{
    "body": "<a id='comment:85'>**Comment 85:**</a>\nReplying to [@mkoeppe](#comment%3A84):\n> It may be a use case for an `assert _immersion` here. If the static checker still can't infer it after that, get a better one\n\nBut that's what the above code is doing (except for displaying a nicer error message in the case its null). What a type checker cannot infer is the \"invariant of the internal representation\" that `_immersed is true` implies that `_immersion is not null`. There are workarounds for such implications for type checkers but they are overkill in this situation.",
    "created_at": "2022-03-20T19:46:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472798",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:85'>**Comment 85:**</a>
Replying to [@mkoeppe](#comment%3A84):
> It may be a use case for an `assert _immersion` here. If the static checker still can't infer it after that, get a better one

But that's what the above code is doing (except for displaying a nicer error message in the case its null). What a type checker cannot infer is the "invariant of the internal representation" that `_immersed is true` implies that `_immersion is not null`. There are workarounds for such implications for type checkers but they are overkill in this situation.



---

archive/issue_comments_472799.json:
```json
{
    "body": "<a id='comment:86'>**Comment 86:**</a>\nNo, your changes weaken the invariant, indicating to developers that it's OK to set `_immersed` to `True` and `_immersion` to `None`.",
    "created_at": "2022-03-20T19:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472799",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:86'>**Comment 86:**</a>
No, your changes weaken the invariant, indicating to developers that it's OK to set `_immersed` to `True` and `_immersion` to `None`.



---

archive/issue_comments_472800.json:
```json
{
    "body": "<a id='comment:87'>**Comment 87:**</a>\nWould it be okay if I completely replace the `_immersed` variable with checks if `_immersion` is None? As you indirectly noticed, keeping the internal state consistent just creates an unnecessary overhead.",
    "created_at": "2022-03-20T20:08:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472800",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:87'>**Comment 87:**</a>
Would it be okay if I completely replace the `_immersed` variable with checks if `_immersion` is None? As you indirectly noticed, keeping the internal state consistent just creates an unnecessary overhead.



---

archive/issue_comments_472801.json:
```json
{
    "body": "<a id='comment:88'>**Comment 88:**</a>\nTry `assert` if you haven't yet.",
    "created_at": "2022-03-20T20:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472801",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:88'>**Comment 88:**</a>
Try `assert` if you haven't yet.



---

archive/issue_comments_472802.json:
```json
{
    "body": "**Changing commit** from \"[b7d121c6a5c178273069a0fc0b638e41aea86c65](https://github.com/sagemath/sagetrac-mirror/commit/b7d121c6a5c178273069a0fc0b638e41aea86c65)\" to \"[3dd340d3c6e6c80ff1e5e576632aae61dff6b228](https://github.com/sagemath/sagetrac-mirror/commit/3dd340d3c6e6c80ff1e5e576632aae61dff6b228)\".",
    "created_at": "2022-03-20T21:08:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472802",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b7d121c6a5c178273069a0fc0b638e41aea86c65](https://github.com/sagemath/sagetrac-mirror/commit/b7d121c6a5c178273069a0fc0b638e41aea86c65)" to "[3dd340d3c6e6c80ff1e5e576632aae61dff6b228](https://github.com/sagemath/sagetrac-mirror/commit/3dd340d3c6e6c80ff1e5e576632aae61dff6b228)".



---

archive/issue_comments_472803.json:
```json
{
    "body": "<a id='comment:89'>**Comment 89:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3dd340d3c6e6c80ff1e5e576632aae61dff6b228\">3dd340d</a></td><td><code>Use assert</code></td></tr></table>\n",
    "created_at": "2022-03-20T21:08:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472803",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:89'>**Comment 89:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3dd340d3c6e6c80ff1e5e576632aae61dff6b228">3dd340d</a></td><td><code>Use assert</code></td></tr></table>




---

archive/issue_comments_472804.json:
```json
{
    "body": "<a id='comment:90'>**Comment 90:**</a>\nTo separate the changes that the ticket promises from the reformatting, I'd recommend `git merge 9.6.beta5 && git reset 9.6.beta5 && git add -p`.",
    "created_at": "2022-03-20T21:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472804",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:90'>**Comment 90:**</a>
To separate the changes that the ticket promises from the reformatting, I'd recommend `git merge 9.6.beta5 && git reset 9.6.beta5 && git add -p`.



---

archive/issue_comments_472805.json:
```json
{
    "body": "<a id='comment:91'>**Comment 91:**</a>\nJust tried it on gitpod: merge: 9.6.beta5 - not something we can merge",
    "created_at": "2022-03-20T21:31:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472805",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:91'>**Comment 91:**</a>
Just tried it on gitpod: merge: 9.6.beta5 - not something we can merge



---

archive/issue_comments_472806.json:
```json
{
    "body": "<a id='comment:92'>**Comment 92:**</a>\nFetch it first: `git fetch trac 9.6.beta5`",
    "created_at": "2022-03-20T21:35:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472806",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:92'>**Comment 92:**</a>
Fetch it first: `git fetch trac 9.6.beta5`



---

archive/issue_comments_472807.json:
```json
{
    "body": "**Changing commit** from \"[3dd340d3c6e6c80ff1e5e576632aae61dff6b228](https://github.com/sagemath/sagetrac-mirror/commit/3dd340d3c6e6c80ff1e5e576632aae61dff6b228)\" to \"[0a521654d98ce20d8d5a24cb8f869a71f06a4767](https://github.com/sagemath/sagetrac-mirror/commit/0a521654d98ce20d8d5a24cb8f869a71f06a4767)\".",
    "created_at": "2022-03-20T22:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472807",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3dd340d3c6e6c80ff1e5e576632aae61dff6b228](https://github.com/sagemath/sagetrac-mirror/commit/3dd340d3c6e6c80ff1e5e576632aae61dff6b228)" to "[0a521654d98ce20d8d5a24cb8f869a71f06a4767](https://github.com/sagemath/sagetrac-mirror/commit/0a521654d98ce20d8d5a24cb8f869a71f06a4767)".



---

archive/issue_comments_472808.json:
```json
{
    "body": "<a id='comment:93'>**Comment 93:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a521654d98ce20d8d5a24cb8f869a71f06a4767\">0a52165</a></td><td><code>Add a bit of typing to manifold code</code></td></tr></table>\n",
    "created_at": "2022-03-20T22:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472808",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:93'>**Comment 93:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a521654d98ce20d8d5a24cb8f869a71f06a4767">0a52165</a></td><td><code>Add a bit of typing to manifold code</code></td></tr></table>




---

archive/issue_comments_472809.json:
```json
{
    "body": "<a id='comment:94'>**Comment 94:**</a>\nThat also don't work, but I've managed to revert (most of) the formatting changes now. Still don't understand why its worth that we both spend more time discussing this than it would to have been to review.",
    "created_at": "2022-03-20T22:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472809",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:94'>**Comment 94:**</a>
That also don't work, but I've managed to revert (most of) the formatting changes now. Still don't understand why its worth that we both spend more time discussing this than it would to have been to review.



---

archive/issue_comments_472810.json:
```json
{
    "body": "<a id='comment:95'>**Comment 95:**</a>\nI think time would be well spent on some git practice...",
    "created_at": "2022-03-20T22:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472810",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:95'>**Comment 95:**</a>
I think time would be well spent on some git practice...



---

archive/issue_events_359759.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-20T22:09:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359759"
}
```



---

archive/issue_events_359760.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-20T22:09:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359760"
}
```



---

archive/issue_comments_472811.json:
```json
{
    "body": "<a id='comment:96'>**Comment 96:**</a>\nPlease learn to use `git reset` and `git add -p` and prepare a ticket that only changes what needs to be changed. [comment:69](#comment%3A69) still unaddressed.",
    "created_at": "2022-03-20T22:09:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472811",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:96'>**Comment 96:**</a>
Please learn to use `git reset` and `git add -p` and prepare a ticket that only changes what needs to be changed. [comment:69](#comment%3A69) still unaddressed.



---

archive/issue_comments_472812.json:
```json
{
    "body": "<a id='comment:97'>**Comment 97:**</a>\nReplying to [@tobiasdiez](#comment%3A94):\n> Still don't understand why its worth that we both spend more time discussing this than it would to have been to review. \n\nThen please prepare a focused ticket instead of forcing reviewers to look at all that stuff.",
    "created_at": "2022-03-20T22:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472812",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:97'>**Comment 97:**</a>
Replying to [@tobiasdiez](#comment%3A94):
> Still don't understand why its worth that we both spend more time discussing this than it would to have been to review. 

Then please prepare a focused ticket instead of forcing reviewers to look at all that stuff.



---

archive/issue_comments_472813.json:
```json
{
    "body": "<a id='comment:98'>**Comment 98:**</a>\nReplying to [@mkoeppe](#comment%3A95):\n> I think time would be well spent on some git practice...\n\nThanks for this very constructive and helpful comment. Definitely motivated me to not spend any more time in reverting formatting changes.\n\nIf you really think its worth the time to extract the homogenization of quotes around strings in 3 lines to a new ticket, please be my guest.",
    "created_at": "2022-03-20T22:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472813",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:98'>**Comment 98:**</a>
Replying to [@mkoeppe](#comment%3A95):
> I think time would be well spent on some git practice...

Thanks for this very constructive and helpful comment. Definitely motivated me to not spend any more time in reverting formatting changes.

If you really think its worth the time to extract the homogenization of quotes around strings in 3 lines to a new ticket, please be my guest.



---

archive/issue_comments_472814.json:
```json
{
    "body": "<a id='comment:99'>**Comment 99:**</a>\nThere's no need for a new ticket because the change is not an improvement.",
    "created_at": "2022-03-20T22:19:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472814",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:99'>**Comment 99:**</a>
There's no need for a new ticket because the change is not an improvement.



---

archive/issue_comments_472815.json:
```json
{
    "body": "<a id='comment:0'>**Comment 0:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3239f7e07180b53e3958b8e6e99976f91b46ad3\">c3239f7</a></td><td><code>Add a bit of typing to manifold code</code></td></tr></table>\n",
    "created_at": "2022-03-20T22:25:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472815",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:0'>**Comment 0:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3239f7e07180b53e3958b8e6e99976f91b46ad3">c3239f7</a></td><td><code>Add a bit of typing to manifold code</code></td></tr></table>




---

archive/issue_comments_472816.json:
```json
{
    "body": "**Changing commit** from \"[0a521654d98ce20d8d5a24cb8f869a71f06a4767](https://github.com/sagemath/sagetrac-mirror/commit/0a521654d98ce20d8d5a24cb8f869a71f06a4767)\" to \"[c3239f7e07180b53e3958b8e6e99976f91b46ad3](https://github.com/sagemath/sagetrac-mirror/commit/c3239f7e07180b53e3958b8e6e99976f91b46ad3)\".",
    "created_at": "2022-03-20T22:25:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472816",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[0a521654d98ce20d8d5a24cb8f869a71f06a4767](https://github.com/sagemath/sagetrac-mirror/commit/0a521654d98ce20d8d5a24cb8f869a71f06a4767)" to "[c3239f7e07180b53e3958b8e6e99976f91b46ad3](https://github.com/sagemath/sagetrac-mirror/commit/c3239f7e07180b53e3958b8e6e99976f91b46ad3)".



---

archive/issue_comments_472817.json:
```json
{
    "body": "<a id='comment:101'>**Comment 101:**</a>\nReplying to [@tobiasdiez](#comment%3A98):\n> please be my guest.\n\nhere we go",
    "created_at": "2022-03-20T22:26:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472817",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:101'>**Comment 101:**</a>
Replying to [@tobiasdiez](#comment%3A98):
> please be my guest.

here we go



---

archive/issue_events_359761.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-20T22:26:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359761"
}
```



---

archive/issue_events_359762.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-20T22:26:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359762"
}
```



---

archive/issue_comments_472818.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nThis is now focused on the change described on the ticket, so I can review it without needing to consult with the original authors regarding style changes (comment:80).",
    "created_at": "2022-03-20T22:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472818",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'>**Comment 3:**</a>
This is now focused on the change described on the ticket, so I can review it without needing to consult with the original authors regarding style changes (comment:80).



---

archive/issue_comments_472819.json:
```json
{
    "body": "<a id='comment:104'>**Comment 104:**</a>\nReplying to [@tobiasdiez](#comment%3A94):\n> why its worth that we both spend more time discussing this\n\nThere's no need to worry about my time - I'm investing it for the long term benefits.",
    "created_at": "2022-03-20T22:47:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472819",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:104'>**Comment 104:**</a>
Replying to [@tobiasdiez](#comment%3A94):
> why its worth that we both spend more time discussing this

There's no need to worry about my time - I'm investing it for the long term benefits.



---

archive/issue_comments_472820.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2022-03-20T22:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472820",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_comments_472821.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nOK, `./sage -tox -e pyright src/sage/manifolds/topological_submanifold.py` (#30411) does not report additional failures introduced here, so it looks like the solution with `assert` worked.",
    "created_at": "2022-03-20T23:11:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472821",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'>**Comment 6:**</a>
OK, `./sage -tox -e pyright src/sage/manifolds/topological_submanifold.py` (#30411) does not report additional failures introduced here, so it looks like the solution with `assert` worked.



---

archive/issue_comments_472822.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nI've also successfully tested `./sage -tp --long src/sage/manifolds/` with python 3.7.",
    "created_at": "2022-03-21T00:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472822",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>**Comment 7:**</a>
I've also successfully tested `./sage -tp --long src/sage/manifolds/` with python 3.7.



---

archive/issue_events_359763.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-21T00:09:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359763"
}
```



---

archive/issue_events_359764.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-21T00:09:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359764"
}
```



---

archive/issue_comments_472823.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nThanks for this contribution.",
    "created_at": "2022-03-21T00:09:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472823",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'>**Comment 8:**</a>
Thanks for this contribution.



---

archive/issue_comments_472824.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nThanks",
    "created_at": "2022-03-21T09:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472824",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'>**Comment 9:**</a>
Thanks



---

archive/issue_comments_472825.json:
```json
{
    "body": "<a id='comment:0'>**Comment 0:**</a>\nWhy do we have doc changes in here such as:\n\n```diff\n-    the *vector field module* `\\mathfrak{X}(U,\\Phi)` is the set of\n+    the *vector field module* `\\mathfrak{X}(U,\\Phi) = \\Gamma(\\Phi^* TM)` is the set of\n```\n\nThis should not be part of this ticket, should it?\n\nI agree that the doc could use some upgrades, but I suggest we do that in another ticket, and then thoroughly.",
    "created_at": "2022-03-21T10:24:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472825",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:0'>**Comment 0:**</a>
Why do we have doc changes in here such as:

```diff
-    the *vector field module* `\mathfrak{X}(U,\Phi)` is the set of
+    the *vector field module* `\mathfrak{X}(U,\Phi) = \Gamma(\Phi^* TM)` is the set of
```

This should not be part of this ticket, should it?

I agree that the doc could use some upgrades, but I suggest we do that in another ticket, and then thoroughly.



---

archive/issue_events_359765.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2022-03-21T10:24:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359765"
}
```



---

archive/issue_events_359766.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2022-03-21T10:24:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359766"
}
```



---

archive/issue_comments_472826.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nHere's the corresponding follow-up: #33542",
    "created_at": "2022-03-21T10:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472826",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:1'>**Comment 1:**</a>
Here's the corresponding follow-up: #33542



---

archive/issue_comments_472827.json:
```json
{
    "body": "**Changing commit** from \"[c3239f7e07180b53e3958b8e6e99976f91b46ad3](https://github.com/sagemath/sagetrac-mirror/commit/c3239f7e07180b53e3958b8e6e99976f91b46ad3)\" to \"[10bdad975caba590cd96cbbad73f3473346435a5](https://github.com/sagemath/sagetrac-mirror/commit/10bdad975caba590cd96cbbad73f3473346435a5)\".",
    "created_at": "2022-03-21T11:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472827",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c3239f7e07180b53e3958b8e6e99976f91b46ad3](https://github.com/sagemath/sagetrac-mirror/commit/c3239f7e07180b53e3958b8e6e99976f91b46ad3)" to "[10bdad975caba590cd96cbbad73f3473346435a5](https://github.com/sagemath/sagetrac-mirror/commit/10bdad975caba590cd96cbbad73f3473346435a5)".



---

archive/issue_comments_472828.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10bdad975caba590cd96cbbad73f3473346435a5\">10bdad9</a></td><td><code>Add a bit of typing to manifold code</code></td></tr></table>\n",
    "created_at": "2022-03-21T11:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472828",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>**Comment 2:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10bdad975caba590cd96cbbad73f3473346435a5">10bdad9</a></td><td><code>Add a bit of typing to manifold code</code></td></tr></table>




---

archive/issue_events_359767.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-21T11:35:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359767"
}
```



---

archive/issue_events_359768.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-21T11:35:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359768"
}
```



---

archive/issue_comments_472829.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n-This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.\n-\n-Moreover, a few very minor clarifications to the documentation were added as well.\n+This PR adds a bit of typing information to some of the methods in the manifolds module.\n``````\n",
    "created_at": "2022-03-21T11:35:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472829",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1 @@
-This PR adds a bit of typing information to some of the methods in the manifolds module that I added while browsing the code. If these types of changes are ok, I'll add further typing information as I proceed understanding the code.
-
-Moreover, a few very minor clarifications to the documentation were added as well.
+This PR adds a bit of typing information to some of the methods in the manifolds module.
``````




---

archive/issue_comments_472830.json:
```json
{
    "body": "**Changing reviewer** from \"Matthias Koeppe\" to \"Matthias Koeppe, ...\".",
    "created_at": "2022-03-21T11:35:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472830",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Matthias Koeppe" to "Matthias Koeppe, ...".



---

archive/issue_comments_472831.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nI've reduced the scope of the ticket as requested",
    "created_at": "2022-03-21T11:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472831",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'>**Comment 4:**</a>
I've reduced the scope of the ticket as requested



---

archive/issue_comments_472832.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nThe documentation changes are now on #33542.",
    "created_at": "2022-03-21T11:39:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472832",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>**Comment 5:**</a>
The documentation changes are now on #33542.



---

archive/issue_comments_472833.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nI really don't like the extra imports like\n\n```diff\n+ from sage.tensor.modules.free_module_basis import FreeModuleBasis\n```\nin `src/sage/tensor/modules/free_module_tensor.py`. They are used only for type checking. On a pure Python side, they make the code more complicated (and potentially slower) for nothing. Do we have a policy at the level of all Sage for this?",
    "created_at": "2022-03-21T17:43:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472833",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:6'>**Comment 6:**</a>
I really don't like the extra imports like

```diff
+ from sage.tensor.modules.free_module_basis import FreeModuleBasis
```
in `src/sage/tensor/modules/free_module_tensor.py`. They are used only for type checking. On a pure Python side, they make the code more complicated (and potentially slower) for nothing. Do we have a policy at the level of all Sage for this?



---

archive/issue_comments_472834.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nWe can move them into `if TYPE_CHECKING:` blocks.",
    "created_at": "2022-03-21T20:02:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472834",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>**Comment 7:**</a>
We can move them into `if TYPE_CHECKING:` blocks.



---

archive/issue_comments_472835.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nI believe this the currently preferred solution, at least until https://peps.python.org/pep-0649/ hits. I don't think we need a Sage-specific policy on this.",
    "created_at": "2022-03-21T20:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472835",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'>**Comment 8:**</a>
I believe this the currently preferred solution, at least until https://peps.python.org/pep-0649/ hits. I don't think we need a Sage-specific policy on this.



---

archive/issue_comments_472836.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3905b5e1000496963225f17031a910cc7ffef17\">a3905b5</a></td><td><code>src/sage/tensor/modules/free_module_tensor.py: Conditionalize an import with 'if TYPE_CHECKING:', add 'from `__future__` import annotations'</code></td></tr></table>\n",
    "created_at": "2022-03-21T20:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472836",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>**Comment 9:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3905b5e1000496963225f17031a910cc7ffef17">a3905b5</a></td><td><code>src/sage/tensor/modules/free_module_tensor.py: Conditionalize an import with 'if TYPE_CHECKING:', add 'from `__future__` import annotations'</code></td></tr></table>




---

archive/issue_comments_472837.json:
```json
{
    "body": "**Changing commit** from \"[10bdad975caba590cd96cbbad73f3473346435a5](https://github.com/sagemath/sagetrac-mirror/commit/10bdad975caba590cd96cbbad73f3473346435a5)\" to \"[a3905b5e1000496963225f17031a910cc7ffef17](https://github.com/sagemath/sagetrac-mirror/commit/a3905b5e1000496963225f17031a910cc7ffef17)\".",
    "created_at": "2022-03-21T20:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472837",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[10bdad975caba590cd96cbbad73f3473346435a5](https://github.com/sagemath/sagetrac-mirror/commit/10bdad975caba590cd96cbbad73f3473346435a5)" to "[a3905b5e1000496963225f17031a910cc7ffef17](https://github.com/sagemath/sagetrac-mirror/commit/a3905b5e1000496963225f17031a910cc7ffef17)".



---

archive/issue_comments_472838.json:
```json
{
    "body": "<a id='comment:120'>**Comment 120:**</a>\nReplying to [@mkoeppe](#comment%3A117):\n> We can move them into `if TYPE_CHECKING:` blocks.\n\nYes, at least this would be consistent with other parts of the code introduced in this ticket where `if TYPE_CHECKING:` is used.",
    "created_at": "2022-03-21T20:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472838",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:120'>**Comment 120:**</a>
Replying to [@mkoeppe](#comment%3A117):
> We can move them into `if TYPE_CHECKING:` blocks.

Yes, at least this would be consistent with other parts of the code introduced in this ticket where `if TYPE_CHECKING:` is used.



---

archive/issue_comments_472839.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2a68dc74673077d9d40ff287c7f01400a2b1985\">b2a68dc</a></td><td><code>src/sage/manifolds/differentiable/manifold.py: Conditionalize imports with 'if TYPE_CHECKING:'</code></td></tr></table>\n",
    "created_at": "2022-03-21T20:14:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472839",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:1'>**Comment 1:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2a68dc74673077d9d40ff287c7f01400a2b1985">b2a68dc</a></td><td><code>src/sage/manifolds/differentiable/manifold.py: Conditionalize imports with 'if TYPE_CHECKING:'</code></td></tr></table>




---

archive/issue_comments_472840.json:
```json
{
    "body": "**Changing commit** from \"[a3905b5e1000496963225f17031a910cc7ffef17](https://github.com/sagemath/sagetrac-mirror/commit/a3905b5e1000496963225f17031a910cc7ffef17)\" to \"[b2a68dc74673077d9d40ff287c7f01400a2b1985](https://github.com/sagemath/sagetrac-mirror/commit/b2a68dc74673077d9d40ff287c7f01400a2b1985)\".",
    "created_at": "2022-03-21T20:14:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472840",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[a3905b5e1000496963225f17031a910cc7ffef17](https://github.com/sagemath/sagetrac-mirror/commit/a3905b5e1000496963225f17031a910cc7ffef17)" to "[b2a68dc74673077d9d40ff287c7f01400a2b1985](https://github.com/sagemath/sagetrac-mirror/commit/b2a68dc74673077d9d40ff287c7f01400a2b1985)".



---

archive/issue_comments_472841.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f\">2061a50</a></td><td><code>src/sage/manifolds/differentiable/degenerate.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr></table>\n",
    "created_at": "2022-03-21T20:15:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472841",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>**Comment 2:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f">2061a50</a></td><td><code>src/sage/manifolds/differentiable/degenerate.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr></table>




---

archive/issue_comments_472842.json:
```json
{
    "body": "**Changing commit** from \"[b2a68dc74673077d9d40ff287c7f01400a2b1985](https://github.com/sagemath/sagetrac-mirror/commit/b2a68dc74673077d9d40ff287c7f01400a2b1985)\" to \"[2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f](https://github.com/sagemath/sagetrac-mirror/commit/2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f)\".",
    "created_at": "2022-03-21T20:15:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472842",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b2a68dc74673077d9d40ff287c7f01400a2b1985](https://github.com/sagemath/sagetrac-mirror/commit/b2a68dc74673077d9d40ff287c7f01400a2b1985)" to "[2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f](https://github.com/sagemath/sagetrac-mirror/commit/2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f)".



---

archive/issue_comments_472843.json:
```json
{
    "body": "**Changing commit** from \"[2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f](https://github.com/sagemath/sagetrac-mirror/commit/2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f)\" to \"[056a69dbffe57c7b866cfc622556645c82b2afc5](https://github.com/sagemath/sagetrac-mirror/commit/056a69dbffe57c7b866cfc622556645c82b2afc5)\".",
    "created_at": "2022-03-21T20:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472843",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f](https://github.com/sagemath/sagetrac-mirror/commit/2061a5033457dd1ffd6f4aad3b5f4bbde3ace65f)" to "[056a69dbffe57c7b866cfc622556645c82b2afc5](https://github.com/sagemath/sagetrac-mirror/commit/056a69dbffe57c7b866cfc622556645c82b2afc5)".



---

archive/issue_comments_472844.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/056a69dbffe57c7b866cfc622556645c82b2afc5\">056a69d</a></td><td><code>src/sage/manifolds/differentiable/degenerate_submanifold.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr></table>\n",
    "created_at": "2022-03-21T20:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472844",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>**Comment 3:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/056a69dbffe57c7b866cfc622556645c82b2afc5">056a69d</a></td><td><code>src/sage/manifolds/differentiable/degenerate_submanifold.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr></table>




---

archive/issue_comments_472845.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nThere's also one file that still manually string-quotes types instead of relying on `from `__future__` import annotations`.",
    "created_at": "2022-03-21T20:21:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472845",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'>**Comment 4:**</a>
There's also one file that still manually string-quotes types instead of relying on `from `__future__` import annotations`.



---

archive/issue_comments_472846.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249\">f813f3c</a></td><td><code>src/sage/manifolds/differentiable/tensorfield.py: Don't string-quote types</code></td></tr></table>\n",
    "created_at": "2022-03-21T20:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472846",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>**Comment 5:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249">f813f3c</a></td><td><code>src/sage/manifolds/differentiable/tensorfield.py: Don't string-quote types</code></td></tr></table>




---

archive/issue_comments_472847.json:
```json
{
    "body": "**Changing commit** from \"[056a69dbffe57c7b866cfc622556645c82b2afc5](https://github.com/sagemath/sagetrac-mirror/commit/056a69dbffe57c7b866cfc622556645c82b2afc5)\" to \"[f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249](https://github.com/sagemath/sagetrac-mirror/commit/f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249)\".",
    "created_at": "2022-03-21T20:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472847",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[056a69dbffe57c7b866cfc622556645c82b2afc5](https://github.com/sagemath/sagetrac-mirror/commit/056a69dbffe57c7b866cfc622556645c82b2afc5)" to "[f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249](https://github.com/sagemath/sagetrac-mirror/commit/f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249)".



---

archive/issue_comments_472848.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nReady now, I think. \n\nThe patch is still bigger than really necessary as a result of Tobias's tool alphabetically sorting the imports.\n\nAlso the formatting of the typed argument lists uses a mix of styles across the file.",
    "created_at": "2022-03-21T20:35:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472848",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'>**Comment 6:**</a>
Ready now, I think. 

The patch is still bigger than really necessary as a result of Tobias's tool alphabetically sorting the imports.

Also the formatting of the typed argument lists uses a mix of styles across the file.



---

archive/issue_comments_472849.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nTests still OK with Python 3.7",
    "created_at": "2022-03-21T20:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472849",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>**Comment 7:**</a>
Tests still OK with Python 3.7



---

archive/issue_events_359769.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-28T10:37:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359769"
}
```



---

archive/issue_events_359770.json:
```json
{
    "actor": "https://github.com/tobiasdiez",
    "created_at": "2022-03-28T10:37:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359770"
}
```



---

archive/issue_comments_472850.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nAs all remarks seem to be addressed, Matthias is fine with my changes and I'm with his, I'll set it back to positively reviewed.",
    "created_at": "2022-03-28T10:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472850",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:8'>**Comment 8:**</a>
As all remarks seem to be addressed, Matthias is fine with my changes and I'm with his, I'll set it back to positively reviewed.



---

archive/issue_comments_472851.json:
```json
{
    "body": "**Changing reviewer** from \"Matthias Koeppe, ...\" to \"Matthias Koeppe, Tobias Diez\".",
    "created_at": "2022-03-28T10:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472851",
    "user": "https://github.com/tobiasdiez"
}
```

**Changing reviewer** from "Matthias Koeppe, ..." to "Matthias Koeppe, Tobias Diez".



---

archive/issue_comments_472852.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nThere is a merge failure with Sage 9.6.beta6",
    "created_at": "2022-03-28T10:48:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472852",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:9'>**Comment 9:**</a>
There is a merge failure with Sage 9.6.beta6



---

archive/issue_events_359771.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2022-03-28T10:48:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359771"
}
```



---

archive/issue_events_359772.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2022-03-28T10:48:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359772"
}
```



---

archive/issue_comments_472853.json:
```json
{
    "body": "<a id='comment:0'>**Comment 0:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51ee92b98cdb7f7e67fc7a737524b856ba5ca76e\">51ee92b</a></td><td><code>Add a bit of typing to manifold code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/974ec0afd442eb5a162ee0a947dc41de92fd09ec\">974ec0a</a></td><td><code>src/sage/tensor/modules/free_module_tensor.py: Conditionalize an import with 'if TYPE_CHECKING:', add 'from `__future__` import annotations'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9905ade3c53aa1473c1ec36fb930e23de723ad82\">9905ade</a></td><td><code>src/sage/manifolds/differentiable/manifold.py: Conditionalize imports with 'if TYPE_CHECKING:'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba751f16e22519baca848b044d214cbb9e7f79ae\">ba751f1</a></td><td><code>src/sage/manifolds/differentiable/degenerate.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3beb020f68ac2f1a0427f417ba2d030010fbebf9\">3beb020</a></td><td><code>src/sage/manifolds/differentiable/degenerate_submanifold.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec\">7c18c7f</a></td><td><code>src/sage/manifolds/differentiable/tensorfield.py: Don't string-quote types</code></td></tr></table>\n",
    "created_at": "2022-03-28T16:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472853",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:0'>**Comment 0:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51ee92b98cdb7f7e67fc7a737524b856ba5ca76e">51ee92b</a></td><td><code>Add a bit of typing to manifold code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/974ec0afd442eb5a162ee0a947dc41de92fd09ec">974ec0a</a></td><td><code>src/sage/tensor/modules/free_module_tensor.py: Conditionalize an import with 'if TYPE_CHECKING:', add 'from `__future__` import annotations'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9905ade3c53aa1473c1ec36fb930e23de723ad82">9905ade</a></td><td><code>src/sage/manifolds/differentiable/manifold.py: Conditionalize imports with 'if TYPE_CHECKING:'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba751f16e22519baca848b044d214cbb9e7f79ae">ba751f1</a></td><td><code>src/sage/manifolds/differentiable/degenerate.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3beb020f68ac2f1a0427f417ba2d030010fbebf9">3beb020</a></td><td><code>src/sage/manifolds/differentiable/degenerate_submanifold.py: Conditionalize an import with 'if TYPE_CHECKING:'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec">7c18c7f</a></td><td><code>src/sage/manifolds/differentiable/tensorfield.py: Don't string-quote types</code></td></tr></table>




---

archive/issue_comments_472854.json:
```json
{
    "body": "**Changing commit** from \"[f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249](https://github.com/sagemath/sagetrac-mirror/commit/f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249)\" to \"[7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec](https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec)\".",
    "created_at": "2022-03-28T16:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472854",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249](https://github.com/sagemath/sagetrac-mirror/commit/f813f3c8e852a1ca33f9ccbc61eb20d4fbc3a249)" to "[7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec](https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec)".



---

archive/issue_comments_472855.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nrebased",
    "created_at": "2022-03-28T16:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472855",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'>**Comment 1:**</a>
rebased



---

archive/issue_events_359773.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-28T16:42:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359773"
}
```



---

archive/issue_events_359774.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-28T16:42:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359774"
}
```



---

archive/issue_events_359775.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2022-03-29T06:59:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359775"
}
```



---

archive/issue_events_359776.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2022-03-29T06:59:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359776"
}
```



---

archive/issue_comments_472856.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nThe patchbot reveals some coverage issue, but this seems to be triggered by the use of `@overload`, hence this is more an issue about the patchbot's `coverage` plugin than about the present code.",
    "created_at": "2022-03-29T06:59:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472856",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:2'>**Comment 2:**</a>
The patchbot reveals some coverage issue, but this seems to be triggered by the use of `@overload`, hence this is more an issue about the patchbot's `coverage` plugin than about the present code.



---

archive/issue_comments_472857.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nThanks!",
    "created_at": "2022-03-29T08:41:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472857",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:3'>**Comment 3:**</a>
Thanks!



---

archive/issue_comments_472858.json:
```json
{
    "body": "**Changing reviewer** from \"Matthias Koeppe, Tobias Diez\" to \"Matthias Koeppe, Tobias Diez, Eric Gourgoulhon\".",
    "created_at": "2022-03-29T18:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472858",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Matthias Koeppe, Tobias Diez" to "Matthias Koeppe, Tobias Diez, Eric Gourgoulhon".



---

archive/issue_comments_472859.json:
```json
{
    "body": "<a id='comment:135'>**Comment 135:**</a>\nReplying to [@egourgoulhon](#comment%3A132):\n> The patchbot reveals some coverage issue, but this seems\n> to be triggered by the use of `@overload`, hence this is\n> more an issue about the patchbot's `coverage` plugin\n> than about the present code.\n\nMight be worth opening a ticket at\n\n- https://github.com/sagemath/sage-patchbot/issues",
    "created_at": "2022-03-29T19:11:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472859",
    "user": "https://github.com/slel"
}
```

<a id='comment:135'>**Comment 135:**</a>
Replying to [@egourgoulhon](#comment%3A132):
> The patchbot reveals some coverage issue, but this seems
> to be triggered by the use of `@overload`, hence this is
> more an issue about the patchbot's `coverage` plugin
> than about the present code.

Might be worth opening a ticket at

- https://github.com/sagemath/sage-patchbot/issues



---

archive/issue_comments_472860.json:
```json
{
    "body": "<a id='comment:136'>**Comment 136:**</a>\nReplying to [@slel](#comment%3A135):\n> \n> Might be worth opening a ticket at\n> \n> - https://github.com/sagemath/sage-patchbot/issues\n\nThanks for the suggestion; this is now\nhttps://github.com/sagemath/sage-patchbot/issues/161",
    "created_at": "2022-03-30T20:07:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472860",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:136'>**Comment 136:**</a>
Replying to [@slel](#comment%3A135):
> 
> Might be worth opening a ticket at
> 
> - https://github.com/sagemath/sage-patchbot/issues

Thanks for the suggestion; this is now
https://github.com/sagemath/sage-patchbot/issues/161



---

archive/issue_events_359777.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-02T10:52:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359777"
}
```



---

archive/issue_events_359778.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f4a39b12e3480c563a1f1d013dbf3629ad58e011",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-04-02T10:52:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29775#event-359778"
}
```



---

archive/issue_comments_472861.json:
```json
{
    "body": "**Changing branch** from \"[public/manifolds/typing](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/typing)\" to \"[7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec](https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec)\".",
    "created_at": "2022-04-02T10:52:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29775",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29775#issuecomment-472861",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/manifolds/typing](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/typing)" to "[7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec](https://github.com/sagemath/sagetrac-mirror/commit/7c18c7f8cd8c123d850e1aeaae25d5e6e37e5cec)".
