# Issue 29673: spkg-configure.m4 for sympow

archive/issues_029436.json:
```json
{
    "body": "CC:  @orlitzky @mkoeppe @isuruf\n\nthis should be easy, just binaries (and possibly data, tbd)\n\nin Debian it's `sympow` and (maybe needed) `sympow-data`\n\nIssue created by migration from https://trac.sagemath.org/ticket/29673\n\n",
    "closed_at": "2020-06-03T22:32:11Z",
    "created_at": "2020-05-10T19:34:24Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "spkg-configure.m4 for sympow",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29673",
    "user": "https://github.com/dimpase"
}
```
CC:  @orlitzky @mkoeppe @isuruf

this should be easy, just binaries (and possibly data, tbd)

in Debian it's `sympow` and (maybe needed) `sympow-data`

Issue created by migration from https://trac.sagemath.org/ticket/29673





---

archive/issue_comments_417254.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-05-10T22:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417254",
    "user": "https://github.com/dimpase"
}
```

New commits:



---

archive/issue_comments_417255.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-10T22:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417255",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_417256.json:
```json
{
    "body": "Works for me with the sympow fork. As of five minutes ago, this is `sci-mathematics/sympow` in Gentoo. Can you add that to gentoo.txt?\n\nMy only other question is why you settled on testing `$ac_cv_path_SYMPOW` instead of just `$SYMPOW`? The name of that cache variable is documented, so it should work just as well, but it was surprising to me.",
    "created_at": "2020-05-18T01:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417256",
    "user": "https://github.com/orlitzky"
}
```

Works for me with the sympow fork. As of five minutes ago, this is `sci-mathematics/sympow` in Gentoo. Can you add that to gentoo.txt?

My only other question is why you settled on testing `$ac_cv_path_SYMPOW` instead of just `$SYMPOW`? The name of that cache variable is documented, so it should work just as well, but it was surprising to me.



---

archive/issue_comments_417257.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-05-18T10:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417257",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_417258.json:
```json
{
    "body": "Added gentoo info.\n\nRegarding `SYMPOW` vs `ac_cv_path_SYMPOW`, the latter seems to be what we normally use in many other spkg-configure.m4 files.\n\nIt appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.",
    "created_at": "2020-05-18T10:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417258",
    "user": "https://github.com/dimpase"
}
```

Added gentoo info.

Regarding `SYMPOW` vs `ac_cv_path_SYMPOW`, the latter seems to be what we normally use in many other spkg-configure.m4 files.

It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.



---

archive/issue_comments_417259.json:
```json
{
    "body": "Replying to [comment:5 dimpase]:\n> \n> It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.\n> \n\n\nYou mean if the user exports `SYMPOW=\"junk or some non-PATH location\"`? I think the only reason `ac_cv_path_SYMPOW` avoids that same problem is because of the ugly variable name. Instead of `SYMPOW` we could use e.g. `SAGE_SYMPOW_PATH` or something like that to the same end.\n\nIn another life, we could make overrides work with e.g. `--with-sympow=/home/mjo/bin/sympow` but I think we all have better things to do right now.",
    "created_at": "2020-05-18T11:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417259",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:5 dimpase]:
> 
> It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.
> 


You mean if the user exports `SYMPOW="junk or some non-PATH location"`? I think the only reason `ac_cv_path_SYMPOW` avoids that same problem is because of the ugly variable name. Instead of `SYMPOW` we could use e.g. `SAGE_SYMPOW_PATH` or something like that to the same end.

In another life, we could make overrides work with e.g. `--with-sympow=/home/mjo/bin/sympow` but I think we all have better things to do right now.



---

archive/issue_comments_417260.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-18T11:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417260",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_417261.json:
```json
{
    "body": "Replying to [comment:6 mjo]:\n> Replying to [comment:5 dimpase]:\n> > \n> > It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.\n> > \n\n> \n> You mean if the user exports `SYMPOW=\"junk or some non-PATH location\"`? I think the only reason `ac_cv_path_SYMPOW` avoids that same problem is because of the ugly variable name. Instead of `SYMPOW` we could use e.g. `SAGE_SYMPOW_PATH` or something like that to the same end.\n\n\nAutoconf docs are silent on what happens if `ac_cv_path_SYMPOW` is pre-set, so it appears to be more robust.\n\nThanks for review!",
    "created_at": "2020-05-18T11:57:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417261",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:6 mjo]:
> Replying to [comment:5 dimpase]:
> > 
> > It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.
> > 

> 
> You mean if the user exports `SYMPOW="junk or some non-PATH location"`? I think the only reason `ac_cv_path_SYMPOW` avoids that same problem is because of the ugly variable name. Instead of `SYMPOW` we could use e.g. `SAGE_SYMPOW_PATH` or something like that to the same end.


Autoconf docs are silent on what happens if `ac_cv_path_SYMPOW` is pre-set, so it appears to be more robust.

Thanks for review!



---

archive/issue_comments_417262.json:
```json
{
    "body": "Replying to [comment:8 dimpase]:\n> \n> Autoconf docs are silent on what happens if `ac_cv_path_SYMPOW` is pre-set, so it appears to be more robust.\n\n\nI can't find any explicit docs, but as a cache variable, it does what you'd expect: the configure script first tests the value of `ac_cv_path_SYMPOW`, and if it's set, its value gets used in lieu of the check:\n\n```\nif ${ac_cv_path_SYMPOW+:} false; then :\n  $as_echo_n \"(cached) \" >&6\nelse\n  # the check gets run and ac_cv_path_SYMPOW is populated\nfi\nSYMPOW=$ac_cv_path_SYMPOW\n```",
    "created_at": "2020-05-18T12:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417262",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:8 dimpase]:
> 
> Autoconf docs are silent on what happens if `ac_cv_path_SYMPOW` is pre-set, so it appears to be more robust.


I can't find any explicit docs, but as a cache variable, it does what you'd expect: the configure script first tests the value of `ac_cv_path_SYMPOW`, and if it's set, its value gets used in lieu of the check:

```
if ${ac_cv_path_SYMPOW+:} false; then :
  $as_echo_n "(cached) " >&6
else
  # the check gets run and ac_cv_path_SYMPOW is populated
fi
SYMPOW=$ac_cv_path_SYMPOW
```



---

archive/issue_comments_417263.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-06-03T22:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417263",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_075868.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-06-03T22:32:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29673#event-75868"
}
```



---

archive/issue_comments_417264.json:
```json
{
    "body": "Follow-up: It looks like this accepts a broken sympow on fedora-32 - #3360",
    "created_at": "2020-07-14T22:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417264",
    "user": "https://github.com/mkoeppe"
}
```

Follow-up: It looks like this accepts a broken sympow on fedora-32 - #3360



---

archive/issue_comments_417265.json:
```json
{
    "body": "Also with `sympow` on `ubuntu-bionic-standard` (https://github.com/mkoeppe/sage/runs/867730944)",
    "created_at": "2020-07-14T22:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417265",
    "user": "https://github.com/mkoeppe"
}
```

Also with `sympow` on `ubuntu-bionic-standard` (https://github.com/mkoeppe/sage/runs/867730944)



---

archive/issue_comments_417266.json:
```json
{
    "body": "also `fedora-28-standard` (https://github.com/mkoeppe/sage/runs/867731144)",
    "created_at": "2020-07-14T22:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417266",
    "user": "https://github.com/mkoeppe"
}
```

also `fedora-28-standard` (https://github.com/mkoeppe/sage/runs/867731144)



---

archive/issue_comments_417267.json:
```json
{
    "body": "I've opened #30147 (Fix `spkg-configure.m4` for `sympow`) for this.\nPlease fix!",
    "created_at": "2020-07-14T22:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-417267",
    "user": "https://github.com/mkoeppe"
}
```

I've opened #30147 (Fix `spkg-configure.m4` for `sympow`) for this.
Please fix!
