# Issue 29605: plotting function for forests

archive/issues_029368.json:
```json
{
    "body": "Currently, it is not possible to plot forests using the `layout_tree` algorithm. : `layout_tree` raises an exception when the input graph is not a tree.\n\nThis ticket introduces the `layout_forest` function, which plots forests using `layout_tree` on each connected component, via the `layout_split` function introduced in ticket #29522 to deal with disconnected graphs. The function is very simple, it is basically a wrapper for `layout_split`.\n\nOther things changed in this ticket:\n- Minor changes in `layout_split` to deal with the layout options.\n- Returning a dict of lists of size 2 (positions of the vertices) in `layout_tree` instead of a dict of pairs. This is to match the behavior of the other graph layout functions (useful here as `layout_split` should work with all layout functions).\n- Checking whether the input graph is empty and if so returning the appropriate result in `layout_tree` (otherwise, the result is an exception saying that the graph is not a tree).\n\nKeywords: graph plotting forest\n\nBranch/Commit: 3f5abedf9706ff2c73872777722f327808301230\n\nReviewer: David Coudert\n\nAuthor: Jean-Florent Raymond\n\nDependencies: #29522\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29605\n\n",
    "closed_at": "2020-07-08T19:32:38Z",
    "created_at": "2020-04-27T18:42:59Z",
    "labels": [
        "component: graph theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "plotting function for forests",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29605",
    "user": "https://github.com/jfraymond"
}
```
Currently, it is not possible to plot forests using the `layout_tree` algorithm. : `layout_tree` raises an exception when the input graph is not a tree.

This ticket introduces the `layout_forest` function, which plots forests using `layout_tree` on each connected component, via the `layout_split` function introduced in ticket #29522 to deal with disconnected graphs. The function is very simple, it is basically a wrapper for `layout_split`.

Other things changed in this ticket:
- Minor changes in `layout_split` to deal with the layout options.
- Returning a dict of lists of size 2 (positions of the vertices) in `layout_tree` instead of a dict of pairs. This is to match the behavior of the other graph layout functions (useful here as `layout_split` should work with all layout functions).
- Checking whether the input graph is empty and if so returning the appropriate result in `layout_tree` (otherwise, the result is an exception saying that the graph is not a tree).

Keywords: graph plotting forest

Branch/Commit: 3f5abedf9706ff2c73872777722f327808301230

Reviewer: David Coudert

Author: Jean-Florent Raymond

Dependencies: #29522

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29605





---

archive/issue_comments_578963.json:
```json
{
    "body": "<a id='comment:1'></a>When I was looking for places where `layout_tree` (from `GenericGraph`) is used I found an other `layout_tree` function in `graph_plot.py`. It seems to be the same function (some parts of the code are identical) with less options.\nAlso it is unclear from the [documentation](https://doc.sagemath.org/html/en/reference/graphs/sage/graphs/graph_plot.html#sage.graphs.graph_plot.GraphPlot.layout_tree) what is the purpose of having this function here while the same result can be achieved with `layout_tree` from `GenericGraph`).\nIs it something that somebody planned to remove but forgot?\n\nSecond question:\nthe only failing doctest I got is the following:\n\n```python\nsage: g = graphs.LadderGraph(3) #TODO!!!!\nsage: g.layout_spring()\n{0: [0.73..., -0.29...],\n1: [1.37..., 0.30...],\n2: [2.08..., 0.89...],\n3: [1.23..., -0.83...],\n4: [1.88..., -0.30...],\n5: [2.53..., 0.22...]}\n```\n(\"TODO!!!!\" is not mine)\n\nIt is quite surprising as I did not touch this function and tests passed on the branch on which this one is based (that of #29522).\nAlso, I always get different results when I run the following\n\n```python\nsage: g = graphs.LadderGraph(3)\nsage: g.layout_spring()\n```\neven on the `develop` branch. (So I do not even see how the tests can pass on this branch.) Any idea?",
    "created_at": "2020-04-27T19:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578963",
    "user": "https://github.com/jfraymond"
}
```

<a id='comment:1'></a>When I was looking for places where `layout_tree` (from `GenericGraph`) is used I found an other `layout_tree` function in `graph_plot.py`. It seems to be the same function (some parts of the code are identical) with less options.
Also it is unclear from the [documentation](https://doc.sagemath.org/html/en/reference/graphs/sage/graphs/graph_plot.html#sage.graphs.graph_plot.GraphPlot.layout_tree) what is the purpose of having this function here while the same result can be achieved with `layout_tree` from `GenericGraph`).
Is it something that somebody planned to remove but forgot?

Second question:
the only failing doctest I got is the following:

```python
sage: g = graphs.LadderGraph(3) #TODO!!!!
sage: g.layout_spring()
{0: [0.73..., -0.29...],
1: [1.37..., 0.30...],
2: [2.08..., 0.89...],
3: [1.23..., -0.83...],
4: [1.88..., -0.30...],
5: [2.53..., 0.22...]}
```
("TODO!!!!" is not mine)

It is quite surprising as I did not touch this function and tests passed on the branch on which this one is based (that of #29522).
Also, I always get different results when I run the following

```python
sage: g = graphs.LadderGraph(3)
sage: g.layout_spring()
```
even on the `develop` branch. (So I do not even see how the tests can pass on this branch.) Any idea?



---

archive/issue_comments_578964.json:
```json
{
    "body": "Changing commit from \"c882cf4111ae86d60d82287f7777ef0e0c808143\" to \"d87d4e00c1660626c1389bf75dd52286f43aad43\"",
    "created_at": "2020-04-28T08:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c882cf4111ae86d60d82287f7777ef0e0c808143" to "d87d4e00c1660626c1389bf75dd52286f43aad43"



---

archive/issue_comments_578965.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-28T08:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578965",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_578966.json:
```json
{
    "body": "<a id='comment:3'></a>Problem 2 solved: The result of `layout_spring` was different because I changed the definition of the variable `buffer` in `layout_split`, which is used by `layout_spring` (even when the graph is connected).\nSo I fixed the failing doctest by changing the expected layout in the docstring for what sage got when running the tests, even though it is still a mystery for me why the test pass now for such a function that return different results every time I run it.",
    "created_at": "2020-04-28T08:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578966",
    "user": "https://github.com/jfraymond"
}
```

<a id='comment:3'></a>Problem 2 solved: The result of `layout_spring` was different because I changed the definition of the variable `buffer` in `layout_split`, which is used by `layout_spring` (even when the graph is connected).
So I fixed the failing doctest by changing the expected layout in the docstring for what sage got when running the tests, even though it is still a mystery for me why the test pass now for such a function that return different results every time I run it.



---

archive/issue_comments_578967.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-28T09:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578967",
    "user": "https://github.com/jfraymond"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_578968.json:
```json
{
    "body": "Changing commit from \"d87d4e00c1660626c1389bf75dd52286f43aad43\" to \"68004038f3bb392291e2e28ddf6dafb35a1d5ef1\"",
    "created_at": "2020-05-01T08:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578968",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d87d4e00c1660626c1389bf75dd52286f43aad43" to "68004038f3bb392291e2e28ddf6dafb35a1d5ef1"



---

archive/issue_comments_578969.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-01T08:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_578970.json:
```json
{
    "body": "<a id='comment:6'></a>Please fix the patchbot warning\n\n```\n+src/sage/graphs/graph_plot.py:596:41: E701 multiple statements on one line (colon)\n```\neven if it's not your fault.",
    "created_at": "2020-05-02T06:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578970",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>Please fix the patchbot warning

```
+src/sage/graphs/graph_plot.py:596:41: E701 multiple statements on one line (colon)
```
even if it's not your fault.



---

archive/issue_comments_578971.json:
```json
{
    "body": "Changing commit from \"68004038f3bb392291e2e28ddf6dafb35a1d5ef1\" to \"14bcaca22d72849e89860691fb43229a90c194b8\"",
    "created_at": "2020-05-02T09:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578971",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "68004038f3bb392291e2e28ddf6dafb35a1d5ef1" to "14bcaca22d72849e89860691fb43229a90c194b8"



---

archive/issue_comments_578972.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-02T09:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578972",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_578973.json:
```json
{
    "body": "<a id='comment:8'></a>red branch",
    "created_at": "2020-06-03T16:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578973",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>red branch



---

archive/issue_comments_578974.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-03T16:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578974",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_578975.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-20T07:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578975",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_578976.json:
```json
{
    "body": "<a id='comment:9'></a>I rebased the ticket on 9.2.beta1, fixed merge conflicts and added a missing doctest.\n\n---\nNew commits:",
    "created_at": "2020-06-20T07:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578976",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:9'></a>I rebased the ticket on 9.2.beta1, fixed merge conflicts and added a missing doctest.

---
New commits:



---

archive/issue_comments_578977.json:
```json
{
    "body": "Changing branch from \"u/gh-jfraymond/layout_forest\" to \"public/graphs/29605_plot_foret\"",
    "created_at": "2020-06-20T07:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578977",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "u/gh-jfraymond/layout_forest" to "public/graphs/29605_plot_foret"



---

archive/issue_comments_578978.json:
```json
{
    "body": "Changing commit from \"14bcaca22d72849e89860691fb43229a90c194b8\" to \"053c5cc154ffa260fbae1db97dbfa3bbc6e571f8\"",
    "created_at": "2020-06-20T07:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578978",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "14bcaca22d72849e89860691fb43229a90c194b8" to "053c5cc154ffa260fbae1db97dbfa3bbc6e571f8"



---

archive/issue_comments_578979.json:
```json
{
    "body": "Changing commit from \"053c5cc154ffa260fbae1db97dbfa3bbc6e571f8\" to \"3f5abedf9706ff2c73872777722f327808301230\"",
    "created_at": "2020-06-20T08:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578979",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "053c5cc154ffa260fbae1db97dbfa3bbc6e571f8" to "3f5abedf9706ff2c73872777722f327808301230"



---

archive/issue_comments_578980.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-20T08:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578980",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_578981.json:
```json
{
    "body": "<a id='comment:11'></a>Thanks!",
    "created_at": "2020-06-23T14:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578981",
    "user": "https://github.com/jfraymond"
}
```

<a id='comment:11'></a>Thanks!



---

archive/issue_comments_578982.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Coudert\"",
    "created_at": "2020-06-23T15:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578982",
    "user": "https://github.com/dcoudert"
}
```

Changing reviewer from "" to "David Coudert"



---

archive/issue_comments_578983.json:
```json
{
    "body": "<a id='comment:12'></a>If you are OK, you can set this ticket to positive review on my behalf.",
    "created_at": "2020-06-23T15:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578983",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:12'></a>If you are OK, you can set this ticket to positive review on my behalf.



---

archive/issue_comments_578984.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-23T16:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578984",
    "user": "https://github.com/jfraymond"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_578985.json:
```json
{
    "body": "<a id='comment:13'></a>Done. Thanks!",
    "created_at": "2020-06-23T16:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578985",
    "user": "https://github.com/jfraymond"
}
```

<a id='comment:13'></a>Done. Thanks!



---

archive/issue_events_075591.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:32:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29605#event-75591"
}
```



---

archive/issue_comments_578986.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578986",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_578987.json:
```json
{
    "body": "Changing branch from \"public/graphs/29605_plot_foret\" to \"3f5abedf9706ff2c73872777722f327808301230\"",
    "created_at": "2020-07-08T19:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29605#issuecomment-578987",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/graphs/29605_plot_foret" to "3f5abedf9706ff2c73872777722f327808301230"
