# Issue 29828: Broken conversion from ZZ['x'] to Qp['y']

archive/issues_029591.json:
```json
{
    "body": "Currently, the following code fails:\n\n```\nsage: R.<x> = PolynomialRing(ZZ)\nsage: f = x^4 - x - 1\nsage: S.<y> = PolynomialRing(Qp(5))\nsage: g2 = S(f)\nsage: g2.factor()\n\nTypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable\n```\n\nHowever, the following code works\n\n```\nsage: g = y^4 - y - 1\nsage: g.factor()\n```\nand moreover\n\n```\nsage: g == g2\nTrue\n```\n\nThe cause seems to be the following:\n\n```\nsage: g2._poly\nx^4 - x - 1\n```\n\nTo fix this, we change the line where ._poly is initialized when converting from ZZ[] to Qp[].\n\nCC:  @bhutz @pfili\n\nKeywords: gsoc20\n\nBranch/Commit: 726c83b4c3ea482666d3785c7ebfb78e6fd68384\n\nReviewer: Travis Scrimshaw\n\nAuthor: Alexander Galarraga\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29828\n\n",
    "closed_at": "2020-07-08T19:31:43Z",
    "created_at": "2020-06-08T21:54:54Z",
    "labels": [
        "component: padics",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Broken conversion from ZZ['x'] to Qp['y']",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29828",
    "user": "https://github.com/EnderWannabe"
}
```
Currently, the following code fails:

```
sage: R.<x> = PolynomialRing(ZZ)
sage: f = x^4 - x - 1
sage: S.<y> = PolynomialRing(Qp(5))
sage: g2 = S(f)
sage: g2.factor()

TypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable
```

However, the following code works

```
sage: g = y^4 - y - 1
sage: g.factor()
```
and moreover

```
sage: g == g2
True
```

The cause seems to be the following:

```
sage: g2._poly
x^4 - x - 1
```

To fix this, we change the line where ._poly is initialized when converting from ZZ[] to Qp[].

CC:  @bhutz @pfili

Keywords: gsoc20

Branch/Commit: 726c83b4c3ea482666d3785c7ebfb78e6fd68384

Reviewer: Travis Scrimshaw

Author: Alexander Galarraga

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29828





---

archive/issue_comments_447696.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -30,7 +30,7 @@\n False\n ```\n \n-To fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].\n+To fix this, we change the line where ._poly is initialized when converting from ZZ[] to Qp[].\n \n Author: Alexander Galarraga\n \n```\n",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447696",
    "user": "https://github.com/EnderWannabe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -30,7 +30,7 @@
 False
 ```
 
-To fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].
+To fix this, we change the line where ._poly is initialized when converting from ZZ[] to Qp[].
 
 Author: Alexander Galarraga
 
```




---

archive/issue_comments_447697.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447697",
    "user": "https://github.com/EnderWannabe"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_447698.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447698",
    "user": "https://github.com/EnderWannabe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_447699.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T01:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447700.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,36 @@\n+Currently, the following code fails:\n \n+```\n+sage: R.<x> = PolynomialRing(ZZ)\n+sage: f = x^4 - x - 1\n+sage: S.<y> = PolynomialRing(Qp(5))\n+sage: g2 = S(f)\n+sage: g2.factor()\n+\n+TypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable\n+```\n+\n+However, the following code works\n+\n+```\n+sage: g = y^4 - y - 1\n+sage: g.factor()\n+```\n+and moreover\n+\n+```\n+sage: g == g2\n+True\n+```\n+\n+The cause seems to be the following:\n+\n+```\n+sage: g2._poly\n+x^4 - x - 1\n+```\n+\n+To fix this, we change the line where ._poly is initialized when converting from ZZ[] to Qp[].\n \n Author: Alexander Galarraga\n \n```\n",
    "created_at": "2020-06-09T01:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447700",
    "user": "https://github.com/EnderWannabe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,36 @@
+Currently, the following code fails:
 
+```
+sage: R.<x> = PolynomialRing(ZZ)
+sage: f = x^4 - x - 1
+sage: S.<y> = PolynomialRing(Qp(5))
+sage: g2 = S(f)
+sage: g2.factor()
+
+TypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable
+```
+
+However, the following code works
+
+```
+sage: g = y^4 - y - 1
+sage: g.factor()
+```
+and moreover
+
+```
+sage: g == g2
+True
+```
+
+The cause seems to be the following:
+
+```
+sage: g2._poly
+x^4 - x - 1
+```
+
+To fix this, we change the line where ._poly is initialized when converting from ZZ[] to Qp[].
 
 Author: Alexander Galarraga
 
```




---

archive/issue_comments_447701.json:
```json
{
    "body": "<a id='comment:5'></a>The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.",
    "created_at": "2020-06-09T07:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447701",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.



---

archive/issue_comments_447702.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T18:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447703.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:5 tscrim]:\n> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.\n\n\nDoctest added. Tests multiplication since this also breaks without the fix",
    "created_at": "2020-06-09T18:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447703",
    "user": "https://github.com/EnderWannabe"
}
```

<a id='comment:7'></a>Replying to [comment:5 tscrim]:
> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.


Doctest added. Tests multiplication since this also breaks without the fix



---

archive/issue_comments_447704.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T20:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447705.json:
```json
{
    "body": "<a id='comment:9'></a>Thank you. LGTM.",
    "created_at": "2020-06-10T00:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447705",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>Thank you. LGTM.



---

archive/issue_comments_447706.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-10T00:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447706",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_447707.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29828#issuecomment-447707",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_076396.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:31:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29828",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29828#event-76396"
}
```
