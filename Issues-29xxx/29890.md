# Issue 29890: build/bin/sage-system-python: Try "python" first

archive/issues_029653.json:
```json
{
    "body": "This is a workaround for a minor annoyance affecting sage developers who update packages on macOS.\n\npython2 urllib works correctly with ssl but the python3 may not (as discussed in #29418). The correct fix is to update `sage_bootstrap` to initialize certificates, or to use a higher-level library for downloading. The workaround to use python2 gives us a bit of time... until Apple removes python2 from the OS.\n\n\n\n\n\nCC:  @jhpalmieri\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nBranch: 1d36a2e75e99df0444330586b9c393f07c913a30\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29890\n\n",
    "closed_at": "2020-07-02T21:29:49Z",
    "created_at": "2020-06-17T19:01:54Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "build/bin/sage-system-python: Try \"python\" first",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29890",
    "user": "https://github.com/mkoeppe"
}
```
This is a workaround for a minor annoyance affecting sage developers who update packages on macOS.

python2 urllib works correctly with ssl but the python3 may not (as discussed in #29418). The correct fix is to update `sage_bootstrap` to initialize certificates, or to use a higher-level library for downloading. The workaround to use python2 gives us a bit of time... until Apple removes python2 from the OS.





CC:  @jhpalmieri

Reviewer: John Palmieri

Author: Matthias Koeppe

Branch: 1d36a2e75e99df0444330586b9c393f07c913a30

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29890





---

archive/issue_comments_587415.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-06-17T19:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587415",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_events_086487.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "rename": {
        "from": "src/bin/sage-system-python: Try \"python\" first",
        "to": "build/bin/sage-system-python: Try \"python\" first"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29890#event-86487"
}
```



---

archive/issue_comments_587416.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n-This has an advantage on macOS, where the python2 urllib works correctly with ssl but the python3 may not.\n+This is a workaround for a minor annoyance affecting sage developers who update packages on macOS.\n+\n+python2 urllib works correctly with ssl but the python3 may not (as discussed in #29418). The correct fix is to update `sage_bootstrap` to initialize certificates, or to use a higher-level library for downloading. The workaround to use python2 gives us a bit of time... until Apple removes python2 from the OS.\n \n \n+\n+\n``````\n",
    "created_at": "2020-06-18T00:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587416",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
-This has an advantage on macOS, where the python2 urllib works correctly with ssl but the python3 may not.
+This is a workaround for a minor annoyance affecting sage developers who update packages on macOS.
+
+python2 urllib works correctly with ssl but the python3 may not (as discussed in #29418). The correct fix is to update `sage_bootstrap` to initialize certificates, or to use a higher-level library for downloading. The workaround to use python2 gives us a bit of time... until Apple removes python2 from the OS.
 
 
+
+
``````




---

archive/issue_comments_587417.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/build_bin_sage_system_python__try__python__first\"",
    "created_at": "2020-06-18T00:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587417",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/build_bin_sage_system_python__try__python__first"



---

archive/issue_comments_587418.json:
```json
{
    "body": "Changing commit from \"\" to \"1d36a2e75e99df0444330586b9c393f07c913a30\"",
    "created_at": "2020-06-18T00:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587418",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "1d36a2e75e99df0444330586b9c393f07c913a30"



---

archive/issue_comments_587419.json:
```json
{
    "body": "<a id='comment:4'></a>\nNew commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[1d36a2e](https://github.com/sagemath/sagetrac-mirror/commit/1d36a2e75e99df0444330586b9c393f07c913a30)|`build/bin/sage-system-python: Try python first`|",
    "created_at": "2020-06-18T00:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587419",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[1d36a2e](https://github.com/sagemath/sagetrac-mirror/commit/1d36a2e75e99df0444330586b9c393f07c913a30)|`build/bin/sage-system-python: Try python first`|



---

archive/issue_comments_587420.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-18T00:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587420",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_587421.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Palmieri\"",
    "created_at": "2020-06-19T04:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587421",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "" to "John Palmieri"



---

archive/issue_comments_587422.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-19T04:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587422",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_587423.json:
```json
{
    "body": "<a id='comment:5'></a>\nSeems to work with a build from scratch and also building a bunch of optional packages. I didn't see any new breakages with those, just packages which were broken independently of this branch: boost, database_stein_watkins_mini, sage_numerical_backends_cplex, sage_numerical_backends_gurobi, texlive (although why anyone would want to install texlive via Sage is baffling to me).\n\nI tested this on OS X using very few system packages, to try out installing as many of Sage's packages as possible (in case some package used Python 3 syntax in its installation process). I used the system's gfortran because of lack of patience, and I used the system's curl because Sage's build of R failed when Sage built its own curl. That is, I used this command:\n\n```\n./configure --with-system-boost_cropped=no --with-system-curl=yes --with-system-freetype=no --with-system-glpk=no --with-system-gmp=no --with-system-gsl=no --with-system-iconv=no --with-system-libffi=no --with-system-libgd=no --with-system-libpng=no --with-system-mpc=no --with-system-mpfi=no --with-system-mpfr=no --with-system-mpir=no --with-system-ncurses=no --with-system-ninja_build=no --with-system-ntl=no --with-system-openblas=no --with-system-pkgconf=no --with-system-ppl=no --with-system-python3=no --with-system-r=no --with-system-readline=no --with-system-sqlite=no --with-system-suitesparse=no --with-system-xz=no --with-system-yasm=no --with-system-zeromq=no --with-system-zlib=no\n```\nWas there some quicker way to tell `./configure` to ignore system packages?",
    "created_at": "2020-06-19T04:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587423",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Seems to work with a build from scratch and also building a bunch of optional packages. I didn't see any new breakages with those, just packages which were broken independently of this branch: boost, database_stein_watkins_mini, sage_numerical_backends_cplex, sage_numerical_backends_gurobi, texlive (although why anyone would want to install texlive via Sage is baffling to me).

I tested this on OS X using very few system packages, to try out installing as many of Sage's packages as possible (in case some package used Python 3 syntax in its installation process). I used the system's gfortran because of lack of patience, and I used the system's curl because Sage's build of R failed when Sage built its own curl. That is, I used this command:

```
./configure --with-system-boost_cropped=no --with-system-curl=yes --with-system-freetype=no --with-system-glpk=no --with-system-gmp=no --with-system-gsl=no --with-system-iconv=no --with-system-libffi=no --with-system-libgd=no --with-system-libpng=no --with-system-mpc=no --with-system-mpfi=no --with-system-mpfr=no --with-system-mpir=no --with-system-ncurses=no --with-system-ninja_build=no --with-system-ntl=no --with-system-openblas=no --with-system-pkgconf=no --with-system-ppl=no --with-system-python3=no --with-system-r=no --with-system-readline=no --with-system-sqlite=no --with-system-suitesparse=no --with-system-xz=no --with-system-yasm=no --with-system-zeromq=no --with-system-zlib=no
```
Was there some quicker way to tell `./configure` to ignore system packages?



---

archive/issue_comments_587424.json:
```json
{
    "body": "<a id='comment:6'></a>\n`database_stein_watkins_mini` is taken care of at #29897.",
    "created_at": "2020-06-19T05:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587424",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
`database_stein_watkins_mini` is taken care of at #29897.



---

archive/issue_comments_587425.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [jhpalmieri](#comment%3A5):\n> I used this command:\n> \n> ```\n> ./configure --with-system-boost_cropped=no --with-system-curl=yes --with-system-freetype=no --with-system-glpk=no --with-system-gmp=no --with-system-gsl=no --with-system-iconv=no --with-system-libffi=no --with-system-libgd=no --with-system-libpng=no --with-system-mpc=no --with-system-mpfi=no --with-system-mpfr=no --with-system-mpir=no --with-system-ncurses=no --with-system-ninja_build=no --with-system-ntl=no --with-system-openblas=no --with-system-pkgconf=no --with-system-ppl=no --with-system-python3=no --with-system-r=no --with-system-readline=no --with-system-sqlite=no --with-system-suitesparse=no --with-system-xz=no --with-system-yasm=no --with-system-zeromq=no --with-system-zlib=no\n> ```\n> Was there some quicker way to tell `./configure` to ignore system packages?\n\nUnfortunately, no.",
    "created_at": "2020-06-19T05:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587425",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Replying to [jhpalmieri](#comment%3A5):
> I used this command:
> 
> ```
> ./configure --with-system-boost_cropped=no --with-system-curl=yes --with-system-freetype=no --with-system-glpk=no --with-system-gmp=no --with-system-gsl=no --with-system-iconv=no --with-system-libffi=no --with-system-libgd=no --with-system-libpng=no --with-system-mpc=no --with-system-mpfi=no --with-system-mpfr=no --with-system-mpir=no --with-system-ncurses=no --with-system-ninja_build=no --with-system-ntl=no --with-system-openblas=no --with-system-pkgconf=no --with-system-ppl=no --with-system-python3=no --with-system-r=no --with-system-readline=no --with-system-sqlite=no --with-system-suitesparse=no --with-system-xz=no --with-system-yasm=no --with-system-zeromq=no --with-system-zlib=no
> ```
> Was there some quicker way to tell `./configure` to ignore system packages?

Unfortunately, no.



---

archive/issue_comments_587426.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jhpalmieri](#comment%3A5):\n> Seems to work with a build from scratch and also building a bunch of optional packages. I didn't see any new breakages with those, just packages which were broken independently of this branch: boost, database_stein_watkins_mini, sage_numerical_backends_cplex, sage_numerical_backends_gurobi, texlive (although why anyone would want to install texlive via Sage is baffling to me).\n\n\nProbably we should add automatic testing for all optional packages. `.github/workflows/tox-optional.yml` only tests the following: \n\n  `4ti2 pynormaliz qepcad lrslib latte_int topcom barvinok isl qhull sage_numerical_backends_coin primecount plantri polymake jupymake kenzo libsemigroups mcqd meataxe mpfrcx openssl p_group_cohomology rst2ipynb sirocco tdlib tides` \n\n(and their dependencies).",
    "created_at": "2020-06-19T05:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587426",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Replying to [jhpalmieri](#comment%3A5):
> Seems to work with a build from scratch and also building a bunch of optional packages. I didn't see any new breakages with those, just packages which were broken independently of this branch: boost, database_stein_watkins_mini, sage_numerical_backends_cplex, sage_numerical_backends_gurobi, texlive (although why anyone would want to install texlive via Sage is baffling to me).


Probably we should add automatic testing for all optional packages. `.github/workflows/tox-optional.yml` only tests the following: 

  `4ti2 pynormaliz qepcad lrslib latte_int topcom barvinok isl qhull sage_numerical_backends_coin primecount plantri polymake jupymake kenzo libsemigroups mcqd meataxe mpfrcx openssl p_group_cohomology rst2ipynb sirocco tdlib tides` 

(and their dependencies).



---

archive/issue_comments_587427.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe experimental packages are even worse: I tried most of them, and only one (`compilerwrapper`) succeeded.",
    "created_at": "2020-06-19T15:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587427",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
The experimental packages are even worse: I tried most of them, and only one (`compilerwrapper`) succeeded.



---

archive/issue_comments_587428.json:
```json
{
    "body": "<a id='comment:10'></a>\nLet's continue on #29900 (Meta-ticket: Fix optional and experimental packages for Sage 9.2)",
    "created_at": "2020-06-19T16:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587428",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Let's continue on #29900 (Meta-ticket: Fix optional and experimental packages for Sage 9.2)



---

archive/issue_comments_587429.json:
```json
{
    "body": "Changing commit from \"1d36a2e75e99df0444330586b9c393f07c913a30\" to \"1c78ade31af18ae523e8fb9a1ffde4aaba6e70e9\"",
    "created_at": "2020-06-19T20:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1d36a2e75e99df0444330586b9c393f07c913a30" to "1c78ade31af18ae523e8fb9a1ffde4aaba6e70e9"



---

archive/issue_comments_587430.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-06-19T20:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587430",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_587431.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[1c78ade](https://github.com/sagemath/sagetrac-mirror/commit/1c78ade31af18ae523e8fb9a1ffde4aaba6e70e9)|`build/bin/sage-system-python: Test that python has argparse`|",
    "created_at": "2020-06-19T20:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587431",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[1c78ade](https://github.com/sagemath/sagetrac-mirror/commit/1c78ade31af18ae523e8fb9a1ffde4aaba6e70e9)|`build/bin/sage-system-python: Test that python has argparse`|



---

archive/issue_comments_587432.json:
```json
{
    "body": "Changing commit from \"1c78ade31af18ae523e8fb9a1ffde4aaba6e70e9\" to \"1d36a2e75e99df0444330586b9c393f07c913a30\"",
    "created_at": "2020-06-19T20:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1c78ade31af18ae523e8fb9a1ffde4aaba6e70e9" to "1d36a2e75e99df0444330586b9c393f07c913a30"



---

archive/issue_comments_587433.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-06-19T20:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_587434.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-19T20:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587434",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_587435.json:
```json
{
    "body": "<a id='comment:13'></a>\nSorry, pushed to the wrong ticket.",
    "created_at": "2020-06-19T20:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587435",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Sorry, pushed to the wrong ticket.



---

archive/issue_events_086488.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-02T21:29:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29890#event-86488"
}
```



---

archive/issue_comments_587436.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-02T21:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587436",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_587437.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/build_bin_sage_system_python__try__python__first\" to \"1d36a2e75e99df0444330586b9c393f07c913a30\"",
    "created_at": "2020-07-02T21:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587437",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/build_bin_sage_system_python__try__python__first" to "1d36a2e75e99df0444330586b9c393f07c913a30"



---

archive/issue_comments_587438.json:
```json
{
    "body": "<a id='comment:15'></a>\nFollow up in #29929",
    "created_at": "2020-07-05T19:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587438",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Follow up in #29929



---

archive/issue_comments_587439.json:
```json
{
    "body": "Changing commit from \"1d36a2e75e99df0444330586b9c393f07c913a30\" to \"\"",
    "created_at": "2020-07-05T19:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29890#issuecomment-587439",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "1d36a2e75e99df0444330586b9c393f07c913a30" to ""
