# Issue 29919: Restore "huge" package type

archive/issues_029682.json:
```json
{
    "body": "(from #29901)\n\n... for packages like `database_stein_watkins` and `polytopes_db_4d`\n\nParts of `sage_bootstrap` know about this package type, but other scripts don't.\n\nOur GH Actions scripts filter out these packages by name. This can be refactored.\n\nWith the present ticket, we can now say `sage --package list :optional: :experimental: --no-file huge` to filter out the huge packages.\n\nHuge packages are now marked by the presence of the file `huge`; so this is actually orthogonal to the package type.\n\nWe also add files named `has_nonfree_dependencies` to some other packages so that they can be filtered out by the same mechanism.\n\n\n\nCC:  @jhpalmieri @dimpase @orlitzky @seblabbe @etn40ff @tobiasdiez\n\nBranch/Commit: 15cc20c4a35db2b2b3a0bb52e444bb6d67268c32\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/29919\n\n",
    "closed_at": "2022-02-27T22:00:55Z",
    "created_at": "2020-06-20T16:18:11Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Restore \"huge\" package type",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29919",
    "user": "https://github.com/mkoeppe"
}
```
(from #29901)

... for packages like `database_stein_watkins` and `polytopes_db_4d`

Parts of `sage_bootstrap` know about this package type, but other scripts don't.

Our GH Actions scripts filter out these packages by name. This can be refactored.

With the present ticket, we can now say `sage --package list :optional: :experimental: --no-file huge` to filter out the huge packages.

Huge packages are now marked by the presence of the file `huge`; so this is actually orthogonal to the package type.

We also add files named `has_nonfree_dependencies` to some other packages so that they can be filtered out by the same mechanism.



CC:  @jhpalmieri @dimpase @orlitzky @seblabbe @etn40ff @tobiasdiez

Branch/Commit: 15cc20c4a35db2b2b3a0bb52e444bb6d67268c32

Reviewer: John Palmieri

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/29919





---

archive/issue_events_076718.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76718"
}
```



---

archive/issue_events_076719.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76719"
}
```



---

archive/issue_events_076720.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76720"
}
```



---

archive/issue_comments_421012.json:
```json
{
    "body": "<a id='comment:5'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421012",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_076721.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76721"
}
```



---

archive/issue_events_076722.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76722"
}
```



---

archive/issue_events_076723.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76723"
}
```



---

archive/issue_events_076724.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76724"
}
```



---

archive/issue_comments_421013.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-02-13T22:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421013",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_421014.json:
```json
{
    "body": "<a id='comment:11'></a>New commits:",
    "created_at": "2022-02-13T22:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421014",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>New commits:



---

archive/issue_comments_421015.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-16T05:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421015",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_421016.json:
```json
{
    "body": "<a id='comment:14'></a>Can you document both `huge` and `has_nonfree_dependencies` in the developer's guide?",
    "created_at": "2022-02-24T23:35:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421016",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>Can you document both `huge` and `has_nonfree_dependencies` in the developer's guide?



---

archive/issue_comments_421017.json:
```json
{
    "body": "<a id='comment:15'></a>Good idea",
    "created_at": "2022-02-24T23:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421017",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Good idea



---

archive/issue_comments_421018.json:
```json
{
    "body": "<a id='comment:16'></a>I think we should have a cleaner way to add \"tags\" to packages, but in lieu of general solution this gets the job done.\n\nThe nonfree-dependencies thing is a bit of a legal mess. Users who install such a package lose the right to distribute their copy of sage. Entities such as universities may not want to wade into that sort of grey area. Anyway, that's orthogonal to this ticket.",
    "created_at": "2022-02-25T00:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421018",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:16'></a>I think we should have a cleaner way to add "tags" to packages, but in lieu of general solution this gets the job done.

The nonfree-dependencies thing is a bit of a legal mess. Users who install such a package lose the right to distribute their copy of sage. Entities such as universities may not want to wade into that sort of grey area. Anyway, that's orthogonal to this ticket.



---

archive/issue_comments_421019.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-25T01:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_421020.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-25T18:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_421021.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-25T18:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421021",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_421022.json:
```json
{
    "body": "<a id='comment:20'></a>Would\n\n```\nif any(not pkg.has_file(filename) for filename in filenames):\n```\nbe more efficient than the current\n\n```\nif not all(pkg.has_file(filename) for filename in filenames):\n```\nand similarly a few lines later with `not any(...)`? Or does Python do this sort of optimization automatically?",
    "created_at": "2022-02-25T19:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421022",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>Would

```
if any(not pkg.has_file(filename) for filename in filenames):
```
be more efficient than the current

```
if not all(pkg.has_file(filename) for filename in filenames):
```
and similarly a few lines later with `not any(...)`? Or does Python do this sort of optimization automatically?



---

archive/issue_comments_421023.json:
```json
{
    "body": "<a id='comment:21'></a>Never mind, I guess it doesn't matter.",
    "created_at": "2022-02-25T20:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421023",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>Never mind, I guess it doesn't matter.



---

archive/issue_comments_421024.json:
```json
{
    "body": "<a id='comment:22'></a>There's no difference in efficiency - both `any` and `all` shortcircuit.\nAnd I think there is no difference in clarity",
    "created_at": "2022-02-25T20:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421024",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>There's no difference in efficiency - both `any` and `all` shortcircuit.
And I think there is no difference in clarity



---

archive/issue_comments_421025.json:
```json
{
    "body": "<a id='comment:23'></a>I got confused and thought that the two might short-circuit at different points, but they will short-circuit at exactly the same point, so it makes no difference.\n\nThis is not your fault and should not be fixed on this ticket, but I wish that the code in `expand_class.py` were documented. Anyway, let's move forward with this.",
    "created_at": "2022-02-25T21:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421025",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>I got confused and thought that the two might short-circuit at different points, but they will short-circuit at exactly the same point, so it makes no difference.

This is not your fault and should not be fixed on this ticket, but I wish that the code in `expand_class.py` were documented. Anyway, let's move forward with this.



---

archive/issue_comments_421026.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-25T21:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421026",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_421027.json:
```json
{
    "body": "<a id='comment:24'></a>Thanks!",
    "created_at": "2022-02-25T22:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421027",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>Thanks!



---

archive/issue_events_076725.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-27T22:00:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29919#event-76725"
}
```



---

archive/issue_comments_421028.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-27T22:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29919",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29919#issuecomment-421028",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
