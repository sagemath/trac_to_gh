# Issue 29231: add intersphinx mapping for SciPy

archive/issues_028994.json:
```json
{
    "assignees": [],
    "body": "This ticket adds an intersphinx mapping for Sphinx to resolve hyperlinks to the Scipy documentation.\n\nWith this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. It links against the latest version of the Scipy documentation to keep it simple.\n\nIf the download fails, for example when building Sage without internet access, the docbuild will still succeed, but the Scipy cross-links will not be resolved.\n\nCC:  @embray @jhpalmieri\n\nBranch/Commit: **[u/gh-mwageringel/29231](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/29231) @ [d19232d](https://github.com/sagemath/sagetrac-mirror/commit/d19232deed357d9aad904bbac9bf84eeb818de04)**\n\nAuthor: **Markus Wageringel**\n\nComponent: **documentation**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/29231_\n\n",
    "created_at": "2020-02-21T13:51:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20documentation",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20info"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "add intersphinx mapping for SciPy",
    "type": "issue",
    "updated_at": "2022-08-31T05:25:02Z",
    "url": "https://github.com/sagemath/sage/issues/29231",
    "user": "https://github.com/mwageringel"
}
```
This ticket adds an intersphinx mapping for Sphinx to resolve hyperlinks to the Scipy documentation.

With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. It links against the latest version of the Scipy documentation to keep it simple.

If the download fails, for example when building Sage without internet access, the docbuild will still succeed, but the Scipy cross-links will not be resolved.

CC:  @embray @jhpalmieri

Branch/Commit: **[u/gh-mwageringel/29231](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/29231) @ [d19232d](https://github.com/sagemath/sagetrac-mirror/commit/d19232deed357d9aad904bbac9bf84eeb818de04)**

Author: **Markus Wageringel**

Component: **documentation**

_Issue created by migration from https://trac.sagemath.org/ticket/29231_





---

archive/issue_events_401883.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-21T13:51:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401883"
}
```



---

archive/issue_events_401884.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-21T13:51:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401884"
}
```



---

archive/issue_events_401885.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-21T13:51:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401885"
}
```



---

archive/issue_events_401886.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-21T13:51:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401886"
}
```



---

archive/issue_comments_458518.json:
```json
{
    "body": "Author: **Markus Wageringel**",
    "created_at": "2020-02-21T13:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458518",
    "user": "https://github.com/mwageringel"
}
```

Author: **Markus Wageringel**



---

archive/issue_comments_458519.json:
```json
{
    "body": "Commit: **[3bd5293](https://github.com/sagemath/sagetrac-mirror/commit/3bd529364f133b7b53bf00138c0acce9eb2d011e)**",
    "created_at": "2020-02-21T13:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458519",
    "user": "https://github.com/mwageringel"
}
```

Commit: **[3bd5293](https://github.com/sagemath/sagetrac-mirror/commit/3bd529364f133b7b53bf00138c0acce9eb2d011e)**



---

archive/issue_comments_458520.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis merges cleanly with #17405.\n\nIf this gets accepted, the same could be applied to numpy.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3bd529364f133b7b53bf00138c0acce9eb2d011e\">3bd5293</a></td><td><code>29231: add intersphinx mapping for scipy</code></td></tr></table>\n",
    "created_at": "2020-02-21T13:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458520",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:1" align="right">comment:1</div>

This merges cleanly with #17405.

If this gets accepted, the same could be applied to numpy.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3bd529364f133b7b53bf00138c0acce9eb2d011e">3bd5293</a></td><td><code>29231: add intersphinx mapping for scipy</code></td></tr></table>




---

archive/issue_events_401887.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-21T13:56:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401887"
}
```



---

archive/issue_comments_458521.json:
```json
{
    "body": "Branch: **[u/gh-mwageringel/29231](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/29231)**",
    "created_at": "2020-02-21T13:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458521",
    "user": "https://github.com/mwageringel"
}
```

Branch: **[u/gh-mwageringel/29231](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mwageringel/29231)**



---

archive/issue_comments_458522.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,3 @@\n This ticket adds an intersphinx mapping for Sphinx to resolve hyperlinks to the Scipy documentation.\n \n-With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. (If this fails for some reason, the docbuild will also fail.)\n-\n+With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. (If this fails for some reason, the docbuild will also fail.) It links against the latest version of the Scipy documentation to keep it simple.\n``````\n",
    "created_at": "2020-02-21T13:59:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458522",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,3 @@
 This ticket adds an intersphinx mapping for Sphinx to resolve hyperlinks to the Scipy documentation.
 
-With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. (If this fails for some reason, the docbuild will also fail.)
-
+With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. (If this fails for some reason, the docbuild will also fail.) It links against the latest version of the Scipy documentation to keep it simple.
``````




---

archive/issue_comments_458523.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSage should in principle build without an internet connection, so I am not in favor of this approach. (\u201cIf this fails for some reason, the docbuild will also fail.\u201d)",
    "created_at": "2020-02-21T14:48:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458523",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

Sage should in principle build without an internet connection, so I am not in favor of this approach. (“If this fails for some reason, the docbuild will also fail.”)



---

archive/issue_comments_458524.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2bd8a8a8a0e15820c2c08967beee923e71d6264c\">2bd8a8a</a></td><td><code>29231: fallback for scipy inventory file when not connected to internet</code></td></tr></table>\n",
    "created_at": "2020-02-21T18:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458524",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2bd8a8a8a0e15820c2c08967beee923e71d6264c">2bd8a8a</a></td><td><code>29231: fallback for scipy inventory file when not connected to internet</code></td></tr></table>




---

archive/issue_comments_458525.json:
```json
{
    "body": "Changed commit from **[3bd5293](https://github.com/sagemath/sagetrac-mirror/commit/3bd529364f133b7b53bf00138c0acce9eb2d011e)** to **[2bd8a8a](https://github.com/sagemath/sagetrac-mirror/commit/2bd8a8a8a0e15820c2c08967beee923e71d6264c)**",
    "created_at": "2020-02-21T18:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458525",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3bd5293](https://github.com/sagemath/sagetrac-mirror/commit/3bd529364f133b7b53bf00138c0acce9eb2d011e)** to **[2bd8a8a](https://github.com/sagemath/sagetrac-mirror/commit/2bd8a8a8a0e15820c2c08967beee923e71d6264c)**



---

archive/issue_comments_458526.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n This ticket adds an intersphinx mapping for Sphinx to resolve hyperlinks to the Scipy documentation.\n \n-With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. (If this fails for some reason, the docbuild will also fail.) It links against the latest version of the Scipy documentation to keep it simple.\n+With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. It links against the latest version of the Scipy documentation to keep it simple.\n+\n+If the download fails, for example when building Sage without internet access, the docbuild will still succeed, but the Scipy cross-links will not be resolved.\n``````\n",
    "created_at": "2020-02-21T18:49:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458526",
    "user": "https://github.com/mwageringel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 This ticket adds an intersphinx mapping for Sphinx to resolve hyperlinks to the Scipy documentation.
 
-With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. (If this fails for some reason, the docbuild will also fail.) It links against the latest version of the Scipy documentation to keep it simple.
+With this change, Sphinx fetches the Scipy inventory file `objects.inv` from https://docs.scipy.org/doc/scipy/reference/ during the docbuild. It links against the latest version of the Scipy documentation to keep it simple.
+
+If the download fails, for example when building Sage without internet access, the docbuild will still succeed, but the Scipy cross-links will not be resolved.
``````




---

archive/issue_comments_458527.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYou are right, that is a problem. It is possible to set a local inventory file as a fallback*. For Python, this was done by adding `src/doc/common/python3.inv` to the repository. However, I do not really like the idea of adding another binary file to the repository that would need to be updated manually.\n\nInstead, I have configured intersphinx to use the `python3.inv` as fallback for Scipy. This means that cross-links for Scipy are not resolved when the fallback is used, as they are not present in the Python inventory file, but the documentation build still succeeds.\n\nWith these changes applied, I have successfully built the documentation without internet access.\n\n---\n*For reference, see [Multiple target for the inventory](https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#confval-intersphinx_mapping).",
    "created_at": "2020-02-21T18:49:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458527",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:5" align="right">comment:5</div>

You are right, that is a problem. It is possible to set a local inventory file as a fallback*. For Python, this was done by adding `src/doc/common/python3.inv` to the repository. However, I do not really like the idea of adding another binary file to the repository that would need to be updated manually.

Instead, I have configured intersphinx to use the `python3.inv` as fallback for Scipy. This means that cross-links for Scipy are not resolved when the fallback is used, as they are not present in the Python inventory file, but the documentation build still succeeds.

With these changes applied, I have successfully built the documentation without internet access.

---
*For reference, see [Multiple target for the inventory](https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#confval-intersphinx_mapping).



---

archive/issue_events_401888.json:
```json
{
    "actor": "https://github.com/mwageringel",
    "created_at": "2020-02-21T18:49:33Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "title_is": "add intersphinx mapping for SciPy",
    "title_was": "add intersphinx mapping for Scipy",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401888"
}
```



---

archive/issue_comments_458528.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@jhpalmieri](#comment:3):\n> Sage should in principle build without an internet connection, so I am not in favor of this approach. (\u201cIf this fails for some reason, the docbuild will also fail.\u201d)\n\n+1.\n\nThough, it would be great that something like <code>:obj:\\`scipy:scipy.integrate.ode\\`</code> in Sage documentation resolves correctly (either pointing to the local documentation or online). `pplpy` intersphinx relies on the fact that its documentation is built and installed. This is implemented in `build/pkgs/pplpy/spkg-postinst`\n\n```\n$ cat build/pkgs/pplpy/spkg-postinst \nif [[ \"$SAGE_SPKG_INSTALL_DOCS\" != no ]] ; then\n    # Compile pplpy's documentation\n    cd src\n    cd docs\n    $MAKE html\n\n    # install pplpy's documentation\n    PPLPY_DOCS=$SAGE_SHARE/doc/pplpy\n    mkdir -p $PPLPY_DOCS\n    cp -r build/html/*  $PPLPY_DOCS\nfi\n```\nThough, if we start allowing for `pplpy` to come from the system the `intersphinx` will be broken and that also needs a solution.",
    "created_at": "2020-02-22T08:15:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458528",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@jhpalmieri](#comment:3):
> Sage should in principle build without an internet connection, so I am not in favor of this approach. (“If this fails for some reason, the docbuild will also fail.”)

+1.

Though, it would be great that something like <code>:obj:\`scipy:scipy.integrate.ode\`</code> in Sage documentation resolves correctly (either pointing to the local documentation or online). `pplpy` intersphinx relies on the fact that its documentation is built and installed. This is implemented in `build/pkgs/pplpy/spkg-postinst`

```
$ cat build/pkgs/pplpy/spkg-postinst 
if [[ "$SAGE_SPKG_INSTALL_DOCS" != no ]] ; then
    # Compile pplpy's documentation
    cd src
    cd docs
    $MAKE html

    # install pplpy's documentation
    PPLPY_DOCS=$SAGE_SHARE/doc/pplpy
    mkdir -p $PPLPY_DOCS
    cp -r build/html/*  $PPLPY_DOCS
fi
```
Though, if we start allowing for `pplpy` to come from the system the `intersphinx` will be broken and that also needs a solution.



---

archive/issue_comments_458529.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@videlec](#comment:6):\n> Though, if we start allowing for `pplpy` to come from the system the `intersphinx` will be broken and that also needs a solution.\n\nI would suggest to change the pplpy intersphinx mapping to point to the online version of the pplpy documentation instead of the local version. The local inventory file can be used as fallback (and the dummy file as secondary fallback). This ensures that cross-links (to the online version) can still be resolved correctly if either an internet connection or the local pplpy documentation exists during the docbuild.\n\nAdmittedly, it might be better if the cross-links resolved to the local documentation in the case when the local objects.inv is used, and to the online documentation if the online version is used, but there does not seem to be an easy way to configure this, as far as I understand.",
    "created_at": "2020-02-22T10:29:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458529",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@videlec](#comment:6):
> Though, if we start allowing for `pplpy` to come from the system the `intersphinx` will be broken and that also needs a solution.

I would suggest to change the pplpy intersphinx mapping to point to the online version of the pplpy documentation instead of the local version. The local inventory file can be used as fallback (and the dummy file as secondary fallback). This ensures that cross-links (to the online version) can still be resolved correctly if either an internet connection or the local pplpy documentation exists during the docbuild.

Admittedly, it might be better if the cross-links resolved to the local documentation in the case when the local objects.inv is used, and to the online documentation if the online version is used, but there does not seem to be an easy way to configure this, as far as I understand.



---

archive/issue_comments_458530.json:
```json
{
    "body": "Changed commit from **[2bd8a8a](https://github.com/sagemath/sagetrac-mirror/commit/2bd8a8a8a0e15820c2c08967beee923e71d6264c)** to **[ad16967](https://github.com/sagemath/sagetrac-mirror/commit/ad16967f543aae7990ac4765a2410b6867f6a66d)**",
    "created_at": "2020-02-24T17:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458530",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2bd8a8a](https://github.com/sagemath/sagetrac-mirror/commit/2bd8a8a8a0e15820c2c08967beee923e71d6264c)** to **[ad16967](https://github.com/sagemath/sagetrac-mirror/commit/ad16967f543aae7990ac4765a2410b6867f6a66d)**



---

archive/issue_comments_458531.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad16967f543aae7990ac4765a2410b6867f6a66d\">ad16967</a></td><td><code>29231: use online pplpy docs for intersphinx with local fallback</code></td></tr></table>\n",
    "created_at": "2020-02-24T17:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458531",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad16967f543aae7990ac4765a2410b6867f6a66d">ad16967</a></td><td><code>29231: use online pplpy docs for intersphinx with local fallback</code></td></tr></table>




---

archive/issue_comments_458532.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI have just made the change for `pplpy` as well, so Intersphinx gets the online version of the `objects.inv` file and uses the local version as fallback. I have successfully built the documentation without internet access. There do not seem to be any `pplpy` cross-links, so far. The dochtml.log shows that Intersphinx correctly finds the fallback, though.",
    "created_at": "2020-02-24T17:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458532",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:9" align="right">comment:9</div>

I have just made the change for `pplpy` as well, so Intersphinx gets the online version of the `objects.inv` file and uses the local version as fallback. I have successfully built the documentation without internet access. There do not seem to be any `pplpy` cross-links, so far. The dochtml.log shows that Intersphinx correctly finds the fallback, though.



---

archive/issue_comments_458533.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d19232deed357d9aad904bbac9bf84eeb818de04\">d19232d</a></td><td><code>29231: fix pyflakes warnings</code></td></tr></table>\n",
    "created_at": "2020-02-25T17:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458533",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d19232deed357d9aad904bbac9bf84eeb818de04">d19232d</a></td><td><code>29231: fix pyflakes warnings</code></td></tr></table>




---

archive/issue_comments_458534.json:
```json
{
    "body": "Changed commit from **[ad16967](https://github.com/sagemath/sagetrac-mirror/commit/ad16967f543aae7990ac4765a2410b6867f6a66d)** to **[d19232d](https://github.com/sagemath/sagetrac-mirror/commit/d19232deed357d9aad904bbac9bf84eeb818de04)**",
    "created_at": "2020-02-25T17:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458534",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ad16967](https://github.com/sagemath/sagetrac-mirror/commit/ad16967f543aae7990ac4765a2410b6867f6a66d)** to **[d19232d](https://github.com/sagemath/sagetrac-mirror/commit/d19232deed357d9aad904bbac9bf84eeb818de04)**



---

archive/issue_events_401889.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-02-26T08:43:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401889"
}
```



---

archive/issue_events_401890.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-02-26T08:43:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401890"
}
```



---

archive/issue_comments_458535.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThis proposal is not acceptable. Building Sage should not trigger any internet connection beyond downloading packages (that can be done prior to the build with `sage -d`).\n\nOne option would actually be to package the various inventories. But that look tedious to maintain.\n\nDo you know what other projects do?",
    "created_at": "2020-02-26T08:43:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458535",
    "user": "https://github.com/videlec"
}
```

<div id="comment:11" align="right">comment:11</div>

This proposal is not acceptable. Building Sage should not trigger any internet connection beyond downloading packages (that can be done prior to the build with `sage -d`).

One option would actually be to package the various inventories. But that look tedious to maintain.

Do you know what other projects do?



---

archive/issue_comments_458536.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOther projects like [numpy](https://github.com/numpy/numpy/blob/cef4dc9d91d980c3df816de00154a22e96439fa4/doc/source/conf.py#L239-L243), [scipy](https://github.com/scipy/scipy/blob/04c59ef48e66675f9902e88163506f3843fccdfb/doc/source/conf.py#L326-L331) and [matplotlib](https://github.com/matplotlib/matplotlib/blob/5cb84e070bcb4ebc5ddd5b1c8e5e8a1eccec5863/doc/conf.py#L110-L119) all use the online versions of inventory files. None of them even provides a fallback for the case that the download fails. This also means we cannot follow the `pplpy` approach of compiling the documentation for those packages ourselves, as it would connect to the internet.\n\nI am not sure why triggering an internet connection is a problem, as long as download failures are handled gracefully. In the worst case, one ends up without cross-references, which is exactly what we have now.\n\nI would like to avoid extra maintenance burdens that would be caused by packaging the inventory files. How about making the download of inventory files optional, similar to the `--no-plot` docbuild option? It would be nice then if this was used for the documentation on our website, at least, which is probably where most people read the Sage documentation.",
    "created_at": "2020-02-26T13:16:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458536",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:12" align="right">comment:12</div>

Other projects like [numpy](https://github.com/numpy/numpy/blob/cef4dc9d91d980c3df816de00154a22e96439fa4/doc/source/conf.py#L239-L243), [scipy](https://github.com/scipy/scipy/blob/04c59ef48e66675f9902e88163506f3843fccdfb/doc/source/conf.py#L326-L331) and [matplotlib](https://github.com/matplotlib/matplotlib/blob/5cb84e070bcb4ebc5ddd5b1c8e5e8a1eccec5863/doc/conf.py#L110-L119) all use the online versions of inventory files. None of them even provides a fallback for the case that the download fails. This also means we cannot follow the `pplpy` approach of compiling the documentation for those packages ourselves, as it would connect to the internet.

I am not sure why triggering an internet connection is a problem, as long as download failures are handled gracefully. In the worst case, one ends up without cross-references, which is exactly what we have now.

I would like to avoid extra maintenance burdens that would be caused by packaging the inventory files. How about making the download of inventory files optional, similar to the `--no-plot` docbuild option? It would be nice then if this was used for the documentation on our website, at least, which is probably where most people read the Sage documentation.



---

archive/issue_comments_458537.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@mwageringel](#comment:12):\n> Other projects like [numpy](https://github.com/numpy/numpy/blob/cef4dc9d91d980c3df816de00154a22e96439fa4/doc/source/conf.py#L239-L243), [scipy](https://github.com/scipy/scipy/blob/04c59ef48e66675f9902e88163506f3843fccdfb/doc/source/conf.py#L326-L331) and [matplotlib](https://github.com/matplotlib/matplotlib/blob/5cb84e070bcb4ebc5ddd5b1c8e5e8a1eccec5863/doc/conf.py#L110-L119) all use the online versions of inventory files. None of them even provides a fallback for the case that the download fails. This also means we cannot follow the `pplpy` approach of compiling the documentation for those packages ourselves, as it would connect to the internet.\n> \n> I am not sure why triggering an internet connection is a problem, as long as download failures are handled gracefully. In the worst case, one ends up without cross-references, which is exactly what we have now.\n\nBecause a user do not expect `make build` to trigger an internet connection. I do not quite agree with the term \"handled gracefully\" since you end up with a different documentation.\n \n> I would like to avoid extra maintenance burdens that would be caused by packaging the inventory files.\n\n+1. It makes no sense to have these files as packages. It will be outdated very soon.\n\n> How about making the download of inventory files optional, similar to the `--no-plot` docbuild option? It would be nice then if this was used for the documentation on our website, at least, which is probably where most people read the Sage documentation.\n\nCould you make a detailed proposal on sage-devel? This kind of changes in the build system have to go through a common agreement by devs.",
    "created_at": "2020-02-26T14:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458537",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@mwageringel](#comment:12):
> Other projects like [numpy](https://github.com/numpy/numpy/blob/cef4dc9d91d980c3df816de00154a22e96439fa4/doc/source/conf.py#L239-L243), [scipy](https://github.com/scipy/scipy/blob/04c59ef48e66675f9902e88163506f3843fccdfb/doc/source/conf.py#L326-L331) and [matplotlib](https://github.com/matplotlib/matplotlib/blob/5cb84e070bcb4ebc5ddd5b1c8e5e8a1eccec5863/doc/conf.py#L110-L119) all use the online versions of inventory files. None of them even provides a fallback for the case that the download fails. This also means we cannot follow the `pplpy` approach of compiling the documentation for those packages ourselves, as it would connect to the internet.
> 
> I am not sure why triggering an internet connection is a problem, as long as download failures are handled gracefully. In the worst case, one ends up without cross-references, which is exactly what we have now.

Because a user do not expect `make build` to trigger an internet connection. I do not quite agree with the term "handled gracefully" since you end up with a different documentation.
 
> I would like to avoid extra maintenance burdens that would be caused by packaging the inventory files.

+1. It makes no sense to have these files as packages. It will be outdated very soon.

> How about making the download of inventory files optional, similar to the `--no-plot` docbuild option? It would be nice then if this was used for the documentation on our website, at least, which is probably where most people read the Sage documentation.

Could you make a detailed proposal on sage-devel? This kind of changes in the build system have to go through a common agreement by devs.



---

archive/issue_comments_458538.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nHere is the thread on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/h3jkMGhKjBs). There is also a very similar ticket #27164.",
    "created_at": "2020-02-26T19:50:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458538",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:14" align="right">comment:14</div>

Here is the thread on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/h3jkMGhKjBs). There is also a very similar ticket #27164.



---

archive/issue_comments_458539.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThere is also #27495, which is somewhat related.",
    "created_at": "2020-02-26T20:01:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458539",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

There is also #27495, which is somewhat related.



---

archive/issue_events_401891.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-15T14:58:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401891"
}
```



---

archive/issue_events_401892.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-15T14:58:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401892"
}
```



---

archive/issue_events_401893.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401893"
}
```



---

archive/issue_events_401894.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401894"
}
```



---

archive/issue_comments_458540.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nWhat's the status of this?  There has been discussion of this recently again, and it would be good to do at least *something* about it, as I need this for #31404 as well.\n\nI think currently this looks good--one thing I might change is for the dummy fallback see if the docs are installed locally first (e.g. if pplpy was installed with `SAGE_SPKG_INSTALL_DOCS`, then we can find its docs in `SAGE_SHARE/doc/pplpy`).\n\nI think this is better than nothing for now.",
    "created_at": "2021-02-26T11:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458540",
    "user": "https://github.com/embray"
}
```

<div id="comment:18" align="right">comment:18</div>

What's the status of this?  There has been discussion of this recently again, and it would be good to do at least *something* about it, as I need this for #31404 as well.

I think currently this looks good--one thing I might change is for the dummy fallback see if the docs are installed locally first (e.g. if pplpy was installed with `SAGE_SPKG_INSTALL_DOCS`, then we can find its docs in `SAGE_SHARE/doc/pplpy`).

I think this is better than nothing for now.



---

archive/issue_comments_458541.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI think the main concern voiced on the mailing list discussion linked in [comment:14](#comment:14) is that intersphinx eagerly tries to connect to the internet, which may be undesirable for some people in some situations. To avoid this, Sage could by default ask for permission to connect to the internet to download missing files, but that would be quite a complex change to the build system.",
    "created_at": "2021-03-05T18:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458541",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:19" align="right">comment:19</div>

I think the main concern voiced on the mailing list discussion linked in [comment:14](#comment:14) is that intersphinx eagerly tries to connect to the internet, which may be undesirable for some people in some situations. To avoid this, Sage could by default ask for permission to connect to the internet to download missing files, but that would be quite a complex change to the build system.



---

archive/issue_comments_458542.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nWe should just make this optional, enabled by another `SAGE_DOC_....` option.\nWhen building the version for the website (see also #31415), we would enable the option.",
    "created_at": "2021-03-05T18:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458542",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

We should just make this optional, enabled by another `SAGE_DOC_....` option.
When building the version for the website (see also #31415), we would enable the option.



---

archive/issue_events_401895.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401895"
}
```



---

archive/issue_events_401896.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401896"
}
```



---

archive/issue_comments_458543.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458543",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_401897.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401897"
}
```



---

archive/issue_events_401898.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401898"
}
```



---

archive/issue_comments_458544.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458544",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_458545.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nStalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/29231#issuecomment-458545",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">comment:23</div>

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_401899.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401899"
}
```



---

archive/issue_events_401900.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401900"
}
```



---

archive/issue_events_401901.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401901"
}
```



---

archive/issue_events_401902.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401902"
}
```



---

archive/issue_events_401903.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401903"
}
```



---

archive/issue_events_401904.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/29231",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/29231#event-401904"
}
```
