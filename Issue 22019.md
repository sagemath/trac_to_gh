# Issue 22019: py3: no cmp() in padics pow_computer

Issue created by migration from https://trac.sagemath.org/ticket/22256

Original creator: chapoton

Original creation time: 2017-01-25 13:28:17

as another step to py3


---

Comment by chapoton created at 2017-01-25 14:24:36

New commits:


---

Comment by chapoton created at 2017-01-25 20:19:27

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-01-25 20:19:27

waiting for the bots


---

Comment by tscrim created at 2017-01-26 14:52:06

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2017-01-26 14:52:06

Bot reports test failures.


---

Comment by git created at 2017-01-26 19:45:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-01-26 19:46:01

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2017-01-26 19:46:01

better second tentative, let us wait for the bots


---

Comment by chapoton created at 2017-01-27 11:13:22

green bot, please review


---

Comment by tscrim created at 2017-01-27 20:56:21

I think it would be better to use the base class `__richcmp__` rather than duplicate the code. Perhaps something like:

```python
if PowComputer_flint.__richcmp__(self, other, op):
    if op == Py_EQ:
        return fmpz_poly_equal(s.modulus, o.modulus)
    return True
if op == Py_NE:
    return not fmpz_poly_equal(s.modulus, o.modulus)
return False
```



---

Comment by chapoton created at 2017-01-28 07:44:35

Hello Travis,

I tried hard to do that before posting my branch, and failed, so I turned to code duplication. If you think you can make it work, please do.

Replying to [comment:7 tscrim]:
> I think it would be better to use the base class `__richcmp__` rather than duplicate the code. Perhaps something like:
> {{{#!python
> if PowComputer_flint.__richcmp__(self, other, op):
>     if op == Py_EQ:
>         return fmpz_poly_equal(s.modulus, o.modulus)
>     return True
> if op == Py_NE:
>     return not fmpz_poly_equal(s.modulus, o.modulus)
> return False
> }}}


---

Comment by tscrim created at 2017-01-30 17:00:14

While it is do-able by pulling out a separate function (I don't know why I could not do a super call here; some Cython thing), the extra cost of dealing with the `<=` and `>=` and having that being undefined for the modulus part is too much of a burden. So duplicating code is the best option to me now. I added an extra check for the inequalities being undefined if we get to the modulus check and we are not doing `==` nor `!=`. If my changes are good, then positive review.
----
New commits:


---

Comment by chapoton created at 2017-01-30 19:30:49

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2017-01-30 19:30:49

ok, let it be. Thank you !


---

Comment by vbraun created at 2017-02-02 22:09:17

Resolution: fixed
