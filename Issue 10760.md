# Issue 10760: Make numpy support SAGE_SPKG_INSTALL_DOCS

Issue created by migration from https://trac.sagemath.org/ticket/10826

Original creator: jason

Original creation time: 2011-02-23 01:54:25

Assignee: tbd

This ticket implements #10823 for numpy.  New spkg at http://sage.math.washington.edu/home/jason/numpy-1.5.1.p0.spkg (depends on #10792)


---

Comment by jason created at 2011-02-23 01:55:04

Changing status from new to needs_review.


---

Comment by drkirkby created at 2011-03-01 15:26:13

Changing status from needs_review to needs_work.


---

Comment by drkirkby created at 2011-03-01 15:26:13

See comments on #10828


---

Comment by jason created at 2011-03-01 19:12:12

FYI Only---already applied to spkg.


---

Comment by jason created at 2011-03-01 19:14:21

Changing status from needs_work to needs_review.


---

Attachment


---

Comment by drkirkby created at 2011-03-02 01:46:12

Changing status from needs_review to needs_info.


---

Comment by drkirkby created at 2011-03-02 01:46:12

See my comments on #10828 
I'm not saying this needs work, as it might not do, but if its anything like the matplotlib case, a lot of unnecessary files get copied. 

We should clarify this before marking this for review.

Dave


---

Comment by jason created at 2011-03-02 03:13:33

Changing status from needs_info to needs_review.


---

Comment by jason created at 2011-03-02 03:13:33

The numpy docs that are copied contain just the standalone built files, not the full doc source directory.


---

Comment by drkirkby created at 2011-03-02 05:02:25

I'm surprised there's a data file objects.inv, but overall it looks fine.

Dave


---

Comment by drkirkby created at 2011-03-02 05:02:25

Changing status from needs_review to positive_review.


---

Comment by jason created at 2011-03-02 06:03:21

According to http://sphinx.pocoo.org/ext/intersphinx.html, that file helps Sphinx provide interlinking between documentation.  I think you're probably right that it isn't strictly necessary, but I'll bet there is a way to provide interlinking between Sage's, Scipy's, and numpy's documentation if we have that file (as a future project).


---

Comment by drkirkby created at 2011-03-07 00:24:17

Why is the milestone now a "sage-feature"? Is there any reason it can't go into 4.7, given it has a positive review? 

Dave


---

Comment by jdemeyer created at 2011-03-07 10:25:23

I use sage-feature as a placeholder for tickets with positive review which can't or won't be merged.  This ticket depends on #10792 which does not have positive review, so it can't be merged yet.  Sorry, I should have mentioned this.


---

Comment by drkirkby created at 2011-03-07 11:23:57

Replying to [comment:11 jdemeyer]:
> I use sage-feature as a placeholder for tickets with positive review which can't or won't be merged.  This ticket depends on #10792 which does not have positive review, so it can't be merged yet.  Sorry, I should have mentioned this.

If one click' on sage-feature, one gets _This is the "big feature" milestone. Tickets assigned here should have somebody responsible for the issue. Once a feature is ready to go in please retag the ticket to the next appropriate milestone and attach a patch/bundle/link to an spkg._

The above description of "sage-feature" does not match the situation on here. Perhaps a new milestone should be created, specifically to address the case of tickets with positive review, but depending on other tickets. 

Dave


---

Comment by jason created at 2011-03-07 11:31:01

Or in the longer term, maybe we should install a trac dependency tracker.  For example, something like this: 

http://trac-hacks.org/wiki/MasterTicketsPlugin

or this

http://trac-hacks.org/wiki/TracDependencyPlugin


---

Comment by kcrisman created at 2011-03-18 13:04:28

#10792 now has positive review.


---

Comment by jdemeyer created at 2011-03-18 19:18:26

Resolution: fixed


---

Comment by jdemeyer created at 2011-04-13 07:54:56

Resolution changed from fixed to 


---

Comment by jdemeyer created at 2011-04-13 07:54:56

Changing status from closed to new.


---

Comment by jdemeyer created at 2011-04-13 07:56:39

Dan Drake wrote on sage-devel:

Hrm. There is a problem with numpy when SAGE_SPKG_INSTALL_DOCS is set.
Here's the relevant part of the log:


```
    make[2]: Entering directory `/home/drake/s/sage-4.7.alpha4/spkg/build/numpy-1.5.1.p0/src/doc'
    mkdir -p build
    touch build/generate-stamp
    mkdir -p build/html build/doctrees
    LANG=C sphinx-build -b html -d build/doctrees   source build/html 
    /bin/sh: sphinx-build: not found
    make[2]: *** [html] Error 127
    make[2]: Leaving directory `/home/drake/s/sage-4.7.alpha4/spkg/build/numpy-1.5.1.p0/src/doc'
    Error building numpy docs.
```


This is a fresh build from source. It looks like we need to alter the
build dependencies to get Sphinx built early. Or perhaps the spkg
installation script could check to see if the INSTALL_DOCS variable is
set, and if so, check that Sphinx is built? 

The tricky thing here seems to be that the build deps are different if 
SAGE_SPKG_INSTALL_DOCS is set.

I installed the Sphinx spkg and restarted the build, but now I get:


```
    make[2]: Entering directory `/home/drake/s/sage-4.7.alpha4/spkg/build/numpy-1.5.1.p0/src/doc'
    mkdir -p build
    touch build/generate-stamp
    mkdir -p build/html build/doctrees
    LANG=C sphinx-build -b html -d build/doctrees   source build/html 
    Traceback (most recent call last):
      File "/home/drake/s/sage-4.7.alpha4/local/bin/sphinx-build", line 6, in <module>
        import sage.all
    ImportError: No module named sage.all
    make[2]: *** [html] Error 1
    make[2]: Leaving directory `/home/drake/s/sage-4.7.alpha4/spkg/build/numpy-1.5.1.p0/src/doc'
    Error building numpy docs.
```

 
Yikes. Do we need the Sage library before we can build any Sphinx
documents? Do we need to build documents *after* the usual build process
is done?


---

Comment by jdemeyer created at 2011-04-13 07:56:39

Changing status from new to needs_work.


---

Comment by jason created at 2011-04-14 13:51:53

See #11197 for bulding docs after the sage build


---

Comment by was created at 2011-08-24 23:37:30

Changing keywords from "" to "sd32".


---

Comment by mkoeppe created at 2021-12-02 01:09:58

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-12-02 01:09:58

outdated, should close


---

Comment by dimpase created at 2021-12-03 17:34:33

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-12-03 18:41:01

Resolution: invalid
