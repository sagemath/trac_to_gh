# Issue 14754: Wrap mpmath's root-finding

Issue created by migration from https://trac.sagemath.org/ticket/14991

Original creator: eviatarbach

Original creation time: 2013-07-31 17:43:36

CC:  burcin fredrik.johansson mforets nbruin ppurka slelievre

Sage should wrap mpmath's root-finding; it has many algorithms available, arbitrary precision, and support for complex roots, none of which the current `find_root` appears to have.


---

Comment by ppurka created at 2014-01-29 16:42:24

This depends on #13608 for it to be of any use. Because of this default behavior:

```
sage: from mpmath import findroot
sage: f(x) = log(x+2) - x   
sage: findroot(f, (0, 0.5))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-90ff3b38dfea> in <module>()
----> 1 findroot(f, (Integer(0), RealNumber('0.5')))

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/mpmath/calculus/optimization.pyc in findroot(ctx, f, x0, solver, tol, verbose, verify, **kwargs)
    926             multidimensional = isinstance(fx, (list, tuple, ctx.matrix))
    927         except TypeError:
--> 928             fx = f(x0[0])
    929             multidimensional = False
    930         if 'multidimensional' in kwargs:

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.__call__ (sage/symbolic/expression.cpp:20616)()

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/sage/symbolic/callable.pyc in _call_element_(self, _the_element, *args, **kwds)
    475         d = dict(zip(map(repr, self.arguments()), args))
    476         d.update(kwds)
--> 477         return SR(_the_element.substitute(**d))
    478 
    479 

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.substitute (sage/symbolic/expression.cpp:19871)()

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.coerce_in (sage/symbolic/expression.cpp:14074)()

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/sage/structure/parent_old.so in sage.structure.parent_old.Parent._coerce_ (sage/structure/parent_old.c:3909)()

/home/punarbasu/tmp/sage/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.coerce (sage/structure/parent.c:9544)()

TypeError: no canonical coercion from <type 'sage.libs.mpmath.ext_main.mpf'> to Callable function ring with arguments (x,)
sage: 
```



---

Comment by slelievre created at 2018-12-14 15:32:39

Changing keywords from "" to "find_root, mpmath".
