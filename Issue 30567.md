# Issue 30567: Add Standard Sphere to Manifold Catalog

archive/issues_030567.json:
```json
{
    "body": "CC:  egourgoulhon tscrim @tobiasdiez\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30804\n\n",
    "created_at": "2020-10-20T18:36:11Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Add Standard Sphere to Manifold Catalog",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30567",
    "user": "@mjungmath"
}
```
CC:  egourgoulhon tscrim @tobiasdiez



Issue created by migration from https://trac.sagemath.org/ticket/30804





---

archive/issue_comments_436785.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-10-20T20:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436785",
    "user": "@mjungmath"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_436786.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to manifolds.",
    "created_at": "2020-10-20T20:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436786",
    "user": "@mjungmath"
}
```

Changing component from PLEASE CHANGE to manifolds.



---

archive/issue_comments_436787.json:
```json
{
    "body": "Establishing the stereographic projection in more than 3 dimensions is very demanding, even if you know the inverse. I know that you can speed these things up a little by turning off checking and choosing a suitable simplification. But do you know more workarounds?\n\nI also suspect that the Jacobian takes a long time.",
    "created_at": "2020-10-20T20:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436787",
    "user": "@mjungmath"
}
```

Establishing the stereographic projection in more than 3 dimensions is very demanding, even if you know the inverse. I know that you can speed these things up a little by turning off checking and choosing a suitable simplification. But do you know more workarounds?

I also suspect that the Jacobian takes a long time.



---

archive/issue_comments_436788.json:
```json
{
    "body": "Even if it takes a long time, IMO it still is good to have a general version (with a warning to the user about the time).",
    "created_at": "2020-10-21T09:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436788",
    "user": "tscrim"
}
```

Even if it takes a long time, IMO it still is good to have a general version (with a warning to the user about the time).



---

archive/issue_comments_436789.json:
```json
{
    "body": "I agree. It is good to have these examples.\n\nI thought about computing the desired quantities only on demand. Unfortunately it turned out difficult since most quantities are integral components and invoked by attributes not by methods. That's why I usually prefer methods rather than attributes.",
    "created_at": "2020-10-21T11:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436789",
    "user": "@mjungmath"
}
```

I agree. It is good to have these examples.

I thought about computing the desired quantities only on demand. Unfortunately it turned out difficult since most quantities are integral components and invoked by attributes not by methods. That's why I usually prefer methods rather than attributes.



---

archive/issue_comments_436790.json:
```json
{
    "body": "Please take a peek at this first approach. I'd appreciate if someone can take a closer look at the details, i.e. transition maps, choice of subsets etc.\n\nI tried to cover spherical coordinates in arbitrary dimensions as well. But it turned out that the transition map to the stereographic coordinates is a bit complicated in the general setup. I welcome any kind of reference that might help. Furthermore, I wanted to ensure that the spherical coordinates have the correct orientation right from the start. That explains the reordering of coordinates compared to [Wikipedia](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates), and it makes the transition map to figure out even more tricky.\n----\nNew commits:",
    "created_at": "2020-10-21T18:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436790",
    "user": "@mjungmath"
}
```

Please take a peek at this first approach. I'd appreciate if someone can take a closer look at the details, i.e. transition maps, choice of subsets etc.

I tried to cover spherical coordinates in arbitrary dimensions as well. But it turned out that the transition map to the stereographic coordinates is a bit complicated in the general setup. I welcome any kind of reference that might help. Furthermore, I wanted to ensure that the spherical coordinates have the correct orientation right from the start. That explains the reordering of coordinates compared to [Wikipedia](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates), and it makes the transition map to figure out even more tricky.
----
New commits:



---

archive/issue_comments_436791.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-21T20:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436791",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436792.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-21T21:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436792",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436793.json:
```json
{
    "body": "This should be the correct transition map, now. Checks all pass, too. I hope I didn't mess up the domains. Please check. Examples follow.",
    "created_at": "2020-10-21T21:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436793",
    "user": "@mjungmath"
}
```

This should be the correct transition map, now. Checks all pass, too. I hope I didn't mess up the domains. Please check. Examples follow.



---

archive/issue_comments_436794.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-21T21:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436794",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436795.json:
```json
{
    "body": "Replying to [comment:6 gh-mjungmath]:\n> \n> I tried to cover spherical coordinates in arbitrary dimensions as well. But it turned out that the transition map to the stereographic coordinates is a bit complicated in the general setup. I welcome any kind of reference that might help. \n\nA very good reference for the sphere in any dimension is Chapter 18 *The sphere for its own sake* in Marcel Berger: *Geometry*, vol. II, Universitext. Springer-Verlag, Berlin, 1987.\n\n>Furthermore, I wanted to ensure that the spherical coordinates have the correct orientation right from the start. That explains the reordering of coordinates compared to [Wikipedia](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates), and it makes the transition map to figure out even more tricky.\n\nOn general grounds, I don't think we should depart from Wikipedia conventions without a good reason. Moreover, I think it is standard convention to have the periodic coordinate on *S<sup>n</sup>* to be the last one (as in *(theta, phi)* for *S<sup>2</sup>*), not the first one.",
    "created_at": "2020-10-22T09:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436795",
    "user": "egourgoulhon"
}
```

Replying to [comment:6 gh-mjungmath]:
> 
> I tried to cover spherical coordinates in arbitrary dimensions as well. But it turned out that the transition map to the stereographic coordinates is a bit complicated in the general setup. I welcome any kind of reference that might help. 

A very good reference for the sphere in any dimension is Chapter 18 *The sphere for its own sake* in Marcel Berger: *Geometry*, vol. II, Universitext. Springer-Verlag, Berlin, 1987.

>Furthermore, I wanted to ensure that the spherical coordinates have the correct orientation right from the start. That explains the reordering of coordinates compared to [Wikipedia](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates), and it makes the transition map to figure out even more tricky.

On general grounds, I don't think we should depart from Wikipedia conventions without a good reason. Moreover, I think it is standard convention to have the periodic coordinate on *S<sup>n</sup>* to be the last one (as in *(theta, phi)* for *S<sup>2</sup>*), not the first one.



---

archive/issue_comments_436796.json:
```json
{
    "body": "Replying to [comment:12 egourgoulhon]:\n> Replying to [comment:6 gh-mjungmath]:\n> > \n> > I tried to cover spherical coordinates in arbitrary dimensions as well. But it turned out that the transition map to the stereographic coordinates is a bit complicated in the general setup. I welcome any kind of reference that might help. \n> \n> A very good reference for the sphere in any dimension is Chapter 18 *The sphere for its own sake* in Marcel Berger: *Geometry*, vol. II, Universitext. Springer-Verlag, Berlin, 1987.\n\nThanks. I'll take a look.\n\n> \n> >Furthermore, I wanted to ensure that the spherical coordinates have the correct orientation right from the start. That explains the reordering of coordinates compared to [Wikipedia](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates), and it makes the transition map to figure out even more tricky.\n> \n> On general grounds, I don't think we should depart from Wikipedia conventions without a good reason. Moreover, I think it is standard convention to have the periodic coordinate on *S<sup>n</sup>* to be the last one (as in *(theta, phi)* for *S<sup>2</sup>*), not the first one.  \n\nWe have to deviate from the Wikipedia convention anyway.\n\nThis is simply because the slit we take out for spherical coordinates should meet the poles. Currently, the north/south pole is encoded in the last coordinate. We can shift it to the first, and then we can recover the conventions in Wikipedia for spherical coordinates. But that would be another convention we break, namely for the stereographic projection.",
    "created_at": "2020-10-22T09:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436796",
    "user": "@mjungmath"
}
```

Replying to [comment:12 egourgoulhon]:
> Replying to [comment:6 gh-mjungmath]:
> > 
> > I tried to cover spherical coordinates in arbitrary dimensions as well. But it turned out that the transition map to the stereographic coordinates is a bit complicated in the general setup. I welcome any kind of reference that might help. 
> 
> A very good reference for the sphere in any dimension is Chapter 18 *The sphere for its own sake* in Marcel Berger: *Geometry*, vol. II, Universitext. Springer-Verlag, Berlin, 1987.

Thanks. I'll take a look.

> 
> >Furthermore, I wanted to ensure that the spherical coordinates have the correct orientation right from the start. That explains the reordering of coordinates compared to [Wikipedia](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates), and it makes the transition map to figure out even more tricky.
> 
> On general grounds, I don't think we should depart from Wikipedia conventions without a good reason. Moreover, I think it is standard convention to have the periodic coordinate on *S<sup>n</sup>* to be the last one (as in *(theta, phi)* for *S<sup>2</sup>*), not the first one.  

We have to deviate from the Wikipedia convention anyway.

This is simply because the slit we take out for spherical coordinates should meet the poles. Currently, the north/south pole is encoded in the last coordinate. We can shift it to the first, and then we can recover the conventions in Wikipedia for spherical coordinates. But that would be another convention we break, namely for the stereographic projection.



---

archive/issue_comments_436797.json:
```json
{
    "body": "Replying to [comment:13 gh-mjungmath]:\n> \n> We have to deviate from the Wikipedia convention anyway.\n> \n> This is simply because the slit we take out for spherical coordinates should meet the poles. Currently, the north/south pole is encoded in the last coordinate. We can shift it to the first, and then we can recover the conventions in Wikipedia for spherical coordinates. But that would be another convention we break, namely for the stereographic projection.\n\nSorry I don't understand what you mean. It seems to me that we can keep Wikipedia conventions, both for spherical coordinates and stereographic ones, as we do already for S<sup>2</sup> in this [example](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Then the spherical frame and the stereographic frame from the South pole are right-handed and the stereographic frame from the North pole is left-handed.",
    "created_at": "2020-10-22T09:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436797",
    "user": "egourgoulhon"
}
```

Replying to [comment:13 gh-mjungmath]:
> 
> We have to deviate from the Wikipedia convention anyway.
> 
> This is simply because the slit we take out for spherical coordinates should meet the poles. Currently, the north/south pole is encoded in the last coordinate. We can shift it to the first, and then we can recover the conventions in Wikipedia for spherical coordinates. But that would be another convention we break, namely for the stereographic projection.

Sorry I don't understand what you mean. It seems to me that we can keep Wikipedia conventions, both for spherical coordinates and stereographic ones, as we do already for S<sup>2</sup> in this [example](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Then the spherical frame and the stereographic frame from the South pole are right-handed and the stereographic frame from the North pole is left-handed.



---

archive/issue_comments_436798.json:
```json
{
    "body": "Replying to [comment:14 egourgoulhon]:\n> Replying to [comment:13 gh-mjungmath]:\n> > \n> > We have to deviate from the Wikipedia convention anyway.\n> > \n> > This is simply because the slit we take out for spherical coordinates should meet the poles. Currently, the north/south pole is encoded in the last coordinate. We can shift it to the first, and then we can recover the conventions in Wikipedia for spherical coordinates. But that would be another convention we break, namely for the stereographic projection.\n> \n> Sorry I don't understand what you mean. It seems to me that we can keep Wikipedia conventions, both for spherical coordinates and stereographic ones, as we do already for S<sup>2</sup> in this [example](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Then the spherical frame and the stereographic frame from the South pole are right-handed and the stereographic frame from the North pole is left-handed.\n\nThat's right. But notice that the convention in the general case is slightly different than in the 2-sphere case, compare [https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates [1]] with [https://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates [2]]. If you consider the embedding in spherical coordinates in the general case, and follow the convention [1], it appears to happen that the poles do not belong to the removed meridian.\n\nSo what I did was reversing the order of the `x_i` and `phi_i` simultanously (compare [1]) in hope to find a consistent formula. Turns out that everything behaves nicely in this setup: the implementation is easy and the inverse looks comparably nice. One even gets an oriented coordinate frame on top.\n\nWhatever convention we choose, I will provide a thorough documentation of the conventions used in the implementation anyway.",
    "created_at": "2020-10-22T10:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436798",
    "user": "@mjungmath"
}
```

Replying to [comment:14 egourgoulhon]:
> Replying to [comment:13 gh-mjungmath]:
> > 
> > We have to deviate from the Wikipedia convention anyway.
> > 
> > This is simply because the slit we take out for spherical coordinates should meet the poles. Currently, the north/south pole is encoded in the last coordinate. We can shift it to the first, and then we can recover the conventions in Wikipedia for spherical coordinates. But that would be another convention we break, namely for the stereographic projection.
> 
> Sorry I don't understand what you mean. It seems to me that we can keep Wikipedia conventions, both for spherical coordinates and stereographic ones, as we do already for S<sup>2</sup> in this [example](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Then the spherical frame and the stereographic frame from the South pole are right-handed and the stereographic frame from the North pole is left-handed.

That's right. But notice that the convention in the general case is slightly different than in the 2-sphere case, compare [https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates [1]] with [https://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates [2]]. If you consider the embedding in spherical coordinates in the general case, and follow the convention [1], it appears to happen that the poles do not belong to the removed meridian.

So what I did was reversing the order of the `x_i` and `phi_i` simultanously (compare [1]) in hope to find a consistent formula. Turns out that everything behaves nicely in this setup: the implementation is easy and the inverse looks comparably nice. One even gets an oriented coordinate frame on top.

Whatever convention we choose, I will provide a thorough documentation of the conventions used in the implementation anyway.



---

archive/issue_comments_436799.json:
```json
{
    "body": "Attachment [spherical.png](tarball://root/attachments/some-uuid/ticket30804/spherical.png) by @mjungmath created at 2020-10-22 16:03:52\n\nI have added the choice of coordinates and their inverse in an [attachment](https://trac.sagemath.org/attachment/ticket/30804/spherical.png). I think the formulas look very nice this way (provided I haven't miscalculated).",
    "created_at": "2020-10-22T16:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436799",
    "user": "@mjungmath"
}
```

Attachment [spherical.png](tarball://root/attachments/some-uuid/ticket30804/spherical.png) by @mjungmath created at 2020-10-22 16:03:52

I have added the choice of coordinates and their inverse in an [attachment](https://trac.sagemath.org/attachment/ticket/30804/spherical.png). I think the formulas look very nice this way (provided I haven't miscalculated).



---

archive/issue_comments_436800.json:
```json
{
    "body": "I see these options:\n\n1. Keep it the way I suggested.\n2. Break the convention for the stereographic projection, and put the poles to the first coordinate, then use the convention [https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates [1]].\n3. Use suggestion 1 or 2 and separate the 2-sphere to obtain convention [https://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates [2]].\n4. Keep the stereographic convention, alter the convention [https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates [1]] in such a way that we obtain convention [https://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates [2]] for the 2-sphere case.\n\nI personally vote for 1 as long as the documentation is thorough enough.",
    "created_at": "2020-10-23T14:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436800",
    "user": "@mjungmath"
}
```

I see these options:

1. Keep it the way I suggested.
2. Break the convention for the stereographic projection, and put the poles to the first coordinate, then use the convention [https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates [1]].
3. Use suggestion 1 or 2 and separate the 2-sphere to obtain convention [https://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates [2]].
4. Keep the stereographic convention, alter the convention [https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates [1]] in such a way that we obtain convention [https://en.wikipedia.org/wiki/Spherical_coordinate_system#Cartesian_coordinates [2]] for the 2-sphere case.

I personally vote for 1 as long as the documentation is thorough enough.



---

archive/issue_comments_436801.json:
```json
{
    "body": "I gave it a little thought. I think option 4 is best. Option 4 is in a way canonical: we obtain the convention for `S^1` and for `S^2`. It is only plausible then that the convention should be kept for higher dimensions as well (I don't know why it isn't so).\n\nIn addition, we don't need an extra class with facade pattern for 1D and 2D.\n\nAgreed?",
    "created_at": "2020-10-25T09:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436801",
    "user": "@mjungmath"
}
```

I gave it a little thought. I think option 4 is best. Option 4 is in a way canonical: we obtain the convention for `S^1` and for `S^2`. It is only plausible then that the convention should be kept for higher dimensions as well (I don't know why it isn't so).

In addition, we don't need an extra class with facade pattern for 1D and 2D.

Agreed?



---

archive/issue_comments_436802.json:
```json
{
    "body": "This sounds like a good plan.\n\nI'm not sure if that works, but is it possible to add all these different conventions as additional charts? Then the user can decide which convention he wants to follow. This would also be the most flexible approach (e.g. to verify formulas in different conventions etc).",
    "created_at": "2020-10-25T12:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436802",
    "user": "@tobiasdiez"
}
```

This sounds like a good plan.

I'm not sure if that works, but is it possible to add all these different conventions as additional charts? Then the user can decide which convention he wants to follow. This would also be the most flexible approach (e.g. to verify formulas in different conventions etc).



---

archive/issue_comments_436803.json:
```json
{
    "body": "Replying to [comment:22 gh-tobiasdiez]:\n> I'm not sure if that works, but is it possible to add all these different conventions as additional charts? Then the user can decide which convention he wants to follow. This would also be the most flexible approach (e.g. to verify formulas in different conventions etc). \n\nI agree that this would be the best option. But I suspect that it is not worth the effort. Furthermore, these details can be added by time. I think, a non-primitive  working sphere example in any dimension is enough for now.",
    "created_at": "2020-10-26T13:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436803",
    "user": "@mjungmath"
}
```

Replying to [comment:22 gh-tobiasdiez]:
> I'm not sure if that works, but is it possible to add all these different conventions as additional charts? Then the user can decide which convention he wants to follow. This would also be the most flexible approach (e.g. to verify formulas in different conventions etc). 

I agree that this would be the best option. But I suspect that it is not worth the effort. Furthermore, these details can be added by time. I think, a non-primitive  working sphere example in any dimension is enough for now.



---

archive/issue_comments_436804.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-27T15:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436804",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436805.json:
```json
{
    "body": "I have added some more features and adapted the coordinates. If you agree on these conventions, I would start with the documentation.",
    "created_at": "2020-10-27T15:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436805",
    "user": "@mjungmath"
}
```

I have added some more features and adapted the coordinates. If you agree on these conventions, I would start with the documentation.



---

archive/issue_comments_436806.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-27T15:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436806",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436807.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-02T13:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436807",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436808.json:
```json
{
    "body": "Okay, this is it, the code should be complete now. I will finish the documentation soon. Until then, you are free to comment on the code.\n\nIf everything is done, I will stash the commits to smooth the final merge.",
    "created_at": "2020-11-02T13:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436808",
    "user": "@mjungmath"
}
```

Okay, this is it, the code should be complete now. I will finish the documentation soon. Until then, you are free to comment on the code.

If everything is done, I will stash the commits to smooth the final merge.



---

archive/issue_comments_436809.json:
```json
{
    "body": "If you have any ideas for examples that should come up in the documentation, please let me know.",
    "created_at": "2020-11-02T13:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436809",
    "user": "@mjungmath"
}
```

If you have any ideas for examples that should come up in the documentation, please let me know.



---

archive/issue_comments_436810.json:
```json
{
    "body": "This looks very nice. Thanks!\n\n \nSome first few remarks:\n\n- the reference to Berger should be *Geometry II*, not *Geometry I*\n- the LaTeX formula in the docstring of `spherical_coordinates` is not correct; in particular, one should have x_n = cos phi_1, not x_n = cos phi_n\n- could one have an option for the periodic coordinate phi_n to range in [0, 2*pi] instead of [-pi, pi]? Both conventions exist in the literature. What should be the default? (I would vote for [0, 2*pi])\n- for S<sup>3</sup>, could we have customized spher. coordinate names (chi, theta, phi) (I think this is pretty standard for S<sup>3</sup>), instead of (phi_1, phi_2, phi_3)? \n- for S<sup>3</sup>, we should probably have Hopf coordinates as well",
    "created_at": "2020-11-02T17:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436810",
    "user": "egourgoulhon"
}
```

This looks very nice. Thanks!

 
Some first few remarks:

- the reference to Berger should be *Geometry II*, not *Geometry I*
- the LaTeX formula in the docstring of `spherical_coordinates` is not correct; in particular, one should have x_n = cos phi_1, not x_n = cos phi_n
- could one have an option for the periodic coordinate phi_n to range in [0, 2*pi] instead of [-pi, pi]? Both conventions exist in the literature. What should be the default? (I would vote for [0, 2*pi])
- for S<sup>3</sup>, could we have customized spher. coordinate names (chi, theta, phi) (I think this is pretty standard for S<sup>3</sup>), instead of (phi_1, phi_2, phi_3)? 
- for S<sup>3</sup>, we should probably have Hopf coordinates as well



---

archive/issue_comments_436811.json:
```json
{
    "body": "Replying to [comment:30 egourgoulhon]:\n> This looks very nice. Thanks!\n> \n>  \n> Some first few remarks:\n> \n> - the reference to Berger should be *Geometry II*, not *Geometry I*\n> - the LaTeX formula in the docstring of `spherical_coordinates` is not correct; in particular, one should have x_n = cos phi_1, not x_n = cos phi_n\n\nCorrected. The finished docstring will be pushed soon. Almost done here.\n\n> - could one have an option for the periodic coordinate phi_n to range in [0, 2*pi] instead of [-pi, pi]? Both conventions exist in the literature. What should be the default? (I would vote for [0, 2*pi])\n\nThis belongs more or less to what Tobias suggested. In principle it is good to allow various conventions. However, the case `[-pi, pi]` is easier to handle with the `atan2` function (its range is exactly `[-pi, pi]`).\n\n> - for S<sup>3</sup>, could we have customized spher. coordinate names (chi, theta, phi) (I think this is pretty standard for S<sup>3</sup>), instead of (phi_1, phi_2, phi_3)? \n\nI will add them.\n\n> - for S<sup>3</sup>, we should probably have Hopf coordinates as well\n\nI agree. However, I would prefer that the special cases `S^1`, `S^3`, `S^7` are dedicated to a follow up ticket. This ticket already covers all necessary functionalities of general spheres.",
    "created_at": "2020-11-02T17:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436811",
    "user": "@mjungmath"
}
```

Replying to [comment:30 egourgoulhon]:
> This looks very nice. Thanks!
> 
>  
> Some first few remarks:
> 
> - the reference to Berger should be *Geometry II*, not *Geometry I*
> - the LaTeX formula in the docstring of `spherical_coordinates` is not correct; in particular, one should have x_n = cos phi_1, not x_n = cos phi_n

Corrected. The finished docstring will be pushed soon. Almost done here.

> - could one have an option for the periodic coordinate phi_n to range in [0, 2*pi] instead of [-pi, pi]? Both conventions exist in the literature. What should be the default? (I would vote for [0, 2*pi])

This belongs more or less to what Tobias suggested. In principle it is good to allow various conventions. However, the case `[-pi, pi]` is easier to handle with the `atan2` function (its range is exactly `[-pi, pi]`).

> - for S<sup>3</sup>, could we have customized spher. coordinate names (chi, theta, phi) (I think this is pretty standard for S<sup>3</sup>), instead of (phi_1, phi_2, phi_3)? 

I will add them.

> - for S<sup>3</sup>, we should probably have Hopf coordinates as well

I agree. However, I would prefer that the special cases `S^1`, `S^3`, `S^7` are dedicated to a follow up ticket. This ticket already covers all necessary functionalities of general spheres.



---

archive/issue_comments_436812.json:
```json
{
    "body": "Moreover, I think it is a splendid idea to connect `S^1` and `S^3` to its corresponding Lie groups, i.e. `U(1)` and `SU(2)`, and possible spin groups.",
    "created_at": "2020-11-02T17:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436812",
    "user": "@mjungmath"
}
```

Moreover, I think it is a splendid idea to connect `S^1` and `S^3` to its corresponding Lie groups, i.e. `U(1)` and `SU(2)`, and possible spin groups.



---

archive/issue_comments_436813.json:
```json
{
    "body": "Replying to [comment:31 gh-mjungmath]:\n> Replying to [comment:30 egourgoulhon]:\n> \n> > - could one have an option for the periodic coordinate phi_n to range in [0, 2*pi] instead of [-pi, pi]? Both conventions exist in the literature. What should be the default? (I would vote for [0, 2*pi])\n> \n> This belongs more or less to what Tobias suggested. In principle it is good to allow various conventions. However, the case `[-pi, pi]` is easier to handle with the `atan2` function (its range is exactly `[-pi, pi]`).\n> \nIndeed. Could we have at least a keyword argument `periodic_range` in `Sphere`? Or do you think this deserves another ticket?\n\n> \n> > - for S<sup>3</sup>, we should probably have Hopf coordinates as well\n> \n> I agree. However, I would prefer that the special cases `S^1`, `S^3`, `S^7` are dedicated to a follow up ticket. This ticket already covers all necessary functionalities of general spheres.\n\nAgreed.",
    "created_at": "2020-11-02T17:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436813",
    "user": "egourgoulhon"
}
```

Replying to [comment:31 gh-mjungmath]:
> Replying to [comment:30 egourgoulhon]:
> 
> > - could one have an option for the periodic coordinate phi_n to range in [0, 2*pi] instead of [-pi, pi]? Both conventions exist in the literature. What should be the default? (I would vote for [0, 2*pi])
> 
> This belongs more or less to what Tobias suggested. In principle it is good to allow various conventions. However, the case `[-pi, pi]` is easier to handle with the `atan2` function (its range is exactly `[-pi, pi]`).
> 
Indeed. Could we have at least a keyword argument `periodic_range` in `Sphere`? Or do you think this deserves another ticket?

> 
> > - for S<sup>3</sup>, we should probably have Hopf coordinates as well
> 
> I agree. However, I would prefer that the special cases `S^1`, `S^3`, `S^7` are dedicated to a follow up ticket. This ticket already covers all necessary functionalities of general spheres.

Agreed.



---

archive/issue_comments_436814.json:
```json
{
    "body": "Replying to [comment:32 gh-mjungmath]:\n> Moreover, I think it is a splendid idea to connect `S^1` and `S^3` to its corresponding Lie groups, i.e. `U(1)` and `SU(2)`, and possible spin groups.\n\n+1",
    "created_at": "2020-11-02T17:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436814",
    "user": "egourgoulhon"
}
```

Replying to [comment:32 gh-mjungmath]:
> Moreover, I think it is a splendid idea to connect `S^1` and `S^3` to its corresponding Lie groups, i.e. `U(1)` and `SU(2)`, and possible spin groups.

+1



---

archive/issue_comments_436815.json:
```json
{
    "body": "Replying to [comment:33 egourgoulhon]:\n> Indeed. Could we have at least a keyword argument `periodic_range` in `Sphere`? Or do you think this deserves another ticket?\n\nHm, I personally would vote for another ticket. Adding new features would clutter my current progress. I would like to finish the examples and conclude that ticket as soon as possible. Then we can discuss further improvements. My proposal is already more comprehensive than the previous and worth a merge, I'd say.",
    "created_at": "2020-11-02T17:55:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436815",
    "user": "@mjungmath"
}
```

Replying to [comment:33 egourgoulhon]:
> Indeed. Could we have at least a keyword argument `periodic_range` in `Sphere`? Or do you think this deserves another ticket?

Hm, I personally would vote for another ticket. Adding new features would clutter my current progress. I would like to finish the examples and conclude that ticket as soon as possible. Then we can discuss further improvements. My proposal is already more comprehensive than the previous and worth a merge, I'd say.



---

archive/issue_comments_436816.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-02T19:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436816",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436817.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-03T00:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436817",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436818.json:
```json
{
    "body": "docstring should be finished now. Last opportunity to declare wishes for examples.\n\nI will finish everything up tomorrow and set the ticket to `needs_review`.",
    "created_at": "2020-11-03T00:03:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436818",
    "user": "@mjungmath"
}
```

docstring should be finished now. Last opportunity to declare wishes for examples.

I will finish everything up tomorrow and set the ticket to `needs_review`.



---

archive/issue_comments_436819.json:
```json
{
    "body": "By the way, I noticed that there is no section in the documentation dedicated to general examples (except for `EuclideanSpace`). This should be expanded when more examples of this kind are added.",
    "created_at": "2020-11-03T00:06:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436819",
    "user": "@mjungmath"
}
```

By the way, I noticed that there is no section in the documentation dedicated to general examples (except for `EuclideanSpace`). This should be expanded when more examples of this kind are added.



---

archive/issue_comments_436820.json:
```json
{
    "body": "You can just set it to needs review now; if there are more comments then people can provide it then.",
    "created_at": "2020-11-03T00:15:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436820",
    "user": "tscrim"
}
```

You can just set it to needs review now; if there are more comments then people can provide it then.



---

archive/issue_comments_436821.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-11-03T09:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436821",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436822.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-11-03T09:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436822",
    "user": "@mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_436823.json:
```json
{
    "body": "Squashed commits. Ready for review.",
    "created_at": "2020-11-03T09:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436823",
    "user": "@mjungmath"
}
```

Squashed commits. Ready for review.



---

archive/issue_comments_436824.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-03T10:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436824",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436825.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-03T14:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436825",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436826.json:
```json
{
    "body": "Patchbot full green.",
    "created_at": "2020-11-03T19:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436826",
    "user": "@mjungmath"
}
```

Patchbot full green.



---

archive/issue_comments_436827.json:
```json
{
    "body": "Good for me. Travis, do you agree?",
    "created_at": "2020-11-03T20:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436827",
    "user": "egourgoulhon"
}
```

Good for me. Travis, do you agree?



---

archive/issue_comments_436828.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-03T20:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436828",
    "user": "egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_436829.json:
```json
{
    "body": "Yep, I agree.",
    "created_at": "2020-11-03T23:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436829",
    "user": "tscrim"
}
```

Yep, I agree.



---

archive/issue_comments_436830.json:
```json
{
    "body": "Thank you! :)\n\nEric, would you mind going for the Hopf coordinates?",
    "created_at": "2020-11-04T07:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436830",
    "user": "@mjungmath"
}
```

Thank you! :)

Eric, would you mind going for the Hopf coordinates?



---

archive/issue_comments_436831.json:
```json
{
    "body": "Replying to [comment:50 gh-mjungmath]:\n> Thank you! :)\n> \n\nThank you for this work. \n\n> Eric, would you mind going for the Hopf coordinates? \n\nI'll be happy to make a ticket for S<sup>3</sup> as a subclass of `Sphere`, but at the moment I am busy by other things, as you may have guessed from my slowness in reacting to Sage tickets.",
    "created_at": "2020-11-04T16:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436831",
    "user": "egourgoulhon"
}
```

Replying to [comment:50 gh-mjungmath]:
> Thank you! :)
> 

Thank you for this work. 

> Eric, would you mind going for the Hopf coordinates? 

I'll be happy to make a ticket for S<sup>3</sup> as a subclass of `Sphere`, but at the moment I am busy by other things, as you may have guessed from my slowness in reacting to Sage tickets.



---

archive/issue_comments_436832.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-22T15:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436832",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_436833.json:
```json
{
    "body": "See #31781 for a follow-up.",
    "created_at": "2021-05-05T15:53:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30567",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30567#issuecomment-436833",
    "user": "egourgoulhon"
}
```

See #31781 for a follow-up.
