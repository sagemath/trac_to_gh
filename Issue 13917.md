# Issue 13917: Fixing bug in shuffle product

Issue created by migration from Trac.

Original creator: chrisjamesberg

Original creation time: 2013-02-14 16:21:47

Assignee: Chris Berg

Keywords: shuffle product, days45

Shuffle product contains method does not work properly.


```
sage: w = Word('ab')
sage: x = Word('ac')
sage: w.shuffle(x)
Shuffle product of word: ab and word: ac
sage: s = w.shuffle(x)
sage: s.list()
[word: abac, word: aabc, word: aacb, word: aabc, word: aacb, word: acab]
sage: x*w in s
False
```



---

Comment by chrisjamesberg created at 2013-02-14 16:49:50

Changing status from new to needs_review.


---

Attachment


---

Comment by vdelecroix created at 2013-02-15 15:06:58

Hi,

You should add a test that ensures you actually correct the thing ! However, it would be a good idea to actually rewrite the whole method.

Vincent


---

Comment by darij created at 2013-02-15 15:24:08

Theorem 7 in http://www8.cs.umu.se/research/uminf/reports/2011/001/part1.pdf seems relevant to finding a polynomial-time algorithm for this. Just mentioning.


---

Attachment


---

Comment by chapoton created at 2013-03-03 11:19:26

Here is a doctest.


---

Comment by ncohen created at 2013-03-09 22:36:53

Hellooooooooooooooooooo !!

Well, this patch definitely fixes a bug and is only slower ono the instances for which it gave bad answers... I think that it's good to go ! What would you think of adding a `.. TODO` in the method's docstring saying that the pdf given above contains the recipe for an efficient future new implementation of that method ?

Whether you chose to add this comment or not, feel free to set this ticket to `positive_review` once you are set `:-)`

Nathann


---

Comment by darij created at 2013-03-09 22:38:19

Wait, wait -- I've never said it gives a more efficient solution; I said it "seems relevant". I fear it uses a constant-size alphabet, which is not what we want...


---

Comment by ncohen created at 2013-03-10 14:47:44

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-03-10 14:47:44

HMmmmmmmmmmm... Well, then until we find a better way out ... `:-)`

Nathann


---

Comment by jdemeyer created at 2013-03-13 10:51:24

Resolution: fixed
