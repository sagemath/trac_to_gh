# Issue 29716: Let diff() act on chart functions and differentiable forms

Issue created by migration from https://trac.sagemath.org/ticket/29953

Original creator: egourgoulhon

Original creation time: 2020-06-24 09:49:16

CC:  tscrim

In Sage 9.1, we have

```
sage: M = Manifold(2, 'M')
sage: X.<x,y> = M.chart()
sage: f = X.function(x^2*y)
sage: f.diff(x)
2*x*y
sage: diff(f, x)
...
NotImplementedError:
```

Similarly, if one tries to apply `diff` to get the exterior derivative of a differentiable form, one gets an error:

```
sage: a = M.one_form(-y, x)
sage: a.display()
-y dx + x dy
sage: diff(a)
...
TypeError: unable to convert 1-form on the 2-dimensional differentiable manifold M to a symbolic expression
```


With the code implemented in this ticket, we get 

```
sage: diff(f, x)
2*x*y
sage: type(diff(f,x))
<class 'sage.manifolds.chart_func.ChartFunctionRing_with_category.element_class'>
```

and 

```
sage: diff(a)
2-form on the 2-dimensional differentiable manifold M
sage: diff(a).display()
2 dx/\dy
sage: diff(a) is a.exterior_derivative()
True
```



---

Comment by egourgoulhon created at 2020-06-24 09:50:25

New commits:


---

Comment by egourgoulhon created at 2020-06-24 09:50:25

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-06-24 23:02:40

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-06-24 23:02:40

LGTM.


---

Comment by egourgoulhon created at 2020-06-25 09:51:36

Thank you for the review!


---

Comment by vbraun created at 2020-07-08 19:33:23

Resolution: fixed
