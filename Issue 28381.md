# Issue 28381: polynomial rings over p-adics behave weirdly wrt coercion

Issue created by migration from https://trac.sagemath.org/ticket/28618

Original creator: vdelecroix

Original creation time: 2019-10-16 17:19:29

CC:  caruso saraedum roed


```
sage: cm = get_coercion_model()
sage: cm.get_action(QQ['x'], ZZ, operator.mul)
Right scalar multiplication by Integer Ring on
  Univariate Polynomial Ring in x over Rational Field
sage: cm.get_action(Zmod(135)['x']['y'], ZZ, operator.mul)
Right scalar multiplication by Integer Ring on
  Univariate Polynomial Ring in y over
  Univariate Polynomial Ring in x over
  Ring of integers modulo 135
sage: cm.get_action(Qp(7)['x'], ZZ, operator.mul)  # nothing!
```


This causes trouble for some code factorization in #28592.


---

Comment by nbruin created at 2019-10-16 17:53:29

The original trouble in #28592 probably qualifies as a bug. I'm not entirely sure that what is observed here is: at the face of it, we don't need an action because there's a common parent. Also, as reported on #28592, the would be

```
sage: cm.bin_op(Qp(7)['x'].one(), ZZ.one(), operator.truediv).parent()
Fraction Field of Univariate Polynomial Ring in x over 7-adic Field with capped relative precision 20
```

however, this is at odds with actually executing the operation:

```
sage: parent(Qp(7)['x'].one() / ZZ.one())
Univariate Polynomial Ring in x over 7-adic Field with capped relative precision 20
```

In any case, should it turn out that the right way of getting this fixed is indeed by introducing actions, we should probably also consider

```
cm.bin_op(Qp(7)['x'].one(), Zp(7).one(), operator.truediv).parent()
```

Given that actions can't really be discovered transitively through the coercion graph, you'd end up having to add a LOT of actions, because there are so many copies of p-adic rings possible (with different precisions). That would have to be done programmatically (which is possible) and you would need to be careful about not introducing memory leaks.


---

Comment by vdelecroix created at 2019-10-17 01:31:40

More accurate description...


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by mkoeppe created at 2021-05-10 17:42:09

Moving to 9.4, as 9.3 has been released.
