# Issue 28381: polynomial rings over p-adics behave weirdly wrt coercion

archive/issues_028381.json:
```json
{
    "body": "CC:  @xcaruso @saraedum @roed314\n\n\n```\nsage: cm = get_coercion_model()\nsage: cm.get_action(QQ['x'], ZZ, operator.mul)\nRight scalar multiplication by Integer Ring on\n  Univariate Polynomial Ring in x over Rational Field\nsage: cm.get_action(Zmod(135)['x']['y'], ZZ, operator.mul)\nRight scalar multiplication by Integer Ring on\n  Univariate Polynomial Ring in y over\n  Univariate Polynomial Ring in x over\n  Ring of integers modulo 135\nsage: cm.get_action(Qp(7)['x'], ZZ, operator.mul)  # nothing!\n```\n\n\nThis causes trouble for some code factorization in #28592.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28618\n\n",
    "created_at": "2019-10-16T17:19:29Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "polynomial rings over p-adics behave weirdly wrt coercion",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28381",
    "user": "https://github.com/videlec"
}
```
CC:  @xcaruso @saraedum @roed314


```
sage: cm = get_coercion_model()
sage: cm.get_action(QQ['x'], ZZ, operator.mul)
Right scalar multiplication by Integer Ring on
  Univariate Polynomial Ring in x over Rational Field
sage: cm.get_action(Zmod(135)['x']['y'], ZZ, operator.mul)
Right scalar multiplication by Integer Ring on
  Univariate Polynomial Ring in y over
  Univariate Polynomial Ring in x over
  Ring of integers modulo 135
sage: cm.get_action(Qp(7)['x'], ZZ, operator.mul)  # nothing!
```


This causes trouble for some code factorization in #28592.

Issue created by migration from https://trac.sagemath.org/ticket/28618





---

archive/issue_comments_400363.json:
```json
{
    "body": "The original trouble in #28592 probably qualifies as a bug. I'm not entirely sure that what is observed here is: at the face of it, we don't need an action because there's a common parent. Also, as reported on #28592, the would be\n\n```\nsage: cm.bin_op(Qp(7)['x'].one(), ZZ.one(), operator.truediv).parent()\nFraction Field of Univariate Polynomial Ring in x over 7-adic Field with capped relative precision 20\n```\n\nhowever, this is at odds with actually executing the operation:\n\n```\nsage: parent(Qp(7)['x'].one() / ZZ.one())\nUnivariate Polynomial Ring in x over 7-adic Field with capped relative precision 20\n```\n\nIn any case, should it turn out that the right way of getting this fixed is indeed by introducing actions, we should probably also consider\n\n```\ncm.bin_op(Qp(7)['x'].one(), Zp(7).one(), operator.truediv).parent()\n```\n\nGiven that actions can't really be discovered transitively through the coercion graph, you'd end up having to add a LOT of actions, because there are so many copies of p-adic rings possible (with different precisions). That would have to be done programmatically (which is possible) and you would need to be careful about not introducing memory leaks.",
    "created_at": "2019-10-16T17:53:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28381#issuecomment-400363",
    "user": "https://github.com/nbruin"
}
```

The original trouble in #28592 probably qualifies as a bug. I'm not entirely sure that what is observed here is: at the face of it, we don't need an action because there's a common parent. Also, as reported on #28592, the would be

```
sage: cm.bin_op(Qp(7)['x'].one(), ZZ.one(), operator.truediv).parent()
Fraction Field of Univariate Polynomial Ring in x over 7-adic Field with capped relative precision 20
```

however, this is at odds with actually executing the operation:

```
sage: parent(Qp(7)['x'].one() / ZZ.one())
Univariate Polynomial Ring in x over 7-adic Field with capped relative precision 20
```

In any case, should it turn out that the right way of getting this fixed is indeed by introducing actions, we should probably also consider

```
cm.bin_op(Qp(7)['x'].one(), Zp(7).one(), operator.truediv).parent()
```

Given that actions can't really be discovered transitively through the coercion graph, you'd end up having to add a LOT of actions, because there are so many copies of p-adic rings possible (with different precisions). That would have to be done programmatically (which is possible) and you would need to be careful about not introducing memory leaks.



---

archive/issue_comments_400364.json:
```json
{
    "body": "More accurate description...",
    "created_at": "2019-10-17T01:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28381#issuecomment-400364",
    "user": "https://github.com/videlec"
}
```

More accurate description...



---

archive/issue_comments_400365.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28381#issuecomment-400365",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_400366.json:
```json
{
    "body": "Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28381#issuecomment-400366",
    "user": "https://github.com/mkoeppe"
}
```

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_comments_400367.json:
```json
{
    "body": "Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28381#issuecomment-400367",
    "user": "https://github.com/mkoeppe"
}
```

Moving to 9.4, as 9.3 has been released.
