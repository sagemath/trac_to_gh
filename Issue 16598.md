# Issue 16598: cartesian product of ModulesWithBasis not in ModulesWithBasis

archive/issues_016598.json:
```json
{
    "body": "CC:  nthiery\n\n\n```\nsage: X=CombinatorialFreeModule(RDF,ZZ,category=ModulesWithBasis(RDF))\nsage: Y=cartesian_product((X,X))\nsage: X in ModulesWithBasis(RDF)\nTrue\nsage: Y in ModulesWithBasis(RDF)\nFalse\nsage: Y.categories()[1]\nCategory of modules with basis over Real Double Field\nsage: Y.categories()[1] is ModulesWithBasis(RDF)\nFalse\n```\n\n\nThis weirdness relates to the fact that `ModulesWithBasis(RDF)` prints as the `Category of vector spaces with basis over Real Double Field`. The `Category of modules with basis over Real Double Field` is one of its super categories.\n\nIn the case at hand I cannot construct a morphism from `Y` to `X` because of the category mismatch:\n\n```\nsage: Y.module_morphism(codomain=X,on_basis=lambda (i,j):X.monomial(i))\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n..\nValueError: Free module generated by Integer Ring over Real Double Field (+) Free module generated by Integer Ring over Real Double Field is not in Category of vector spaces with basis over Real Double Field\n```\n\n\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16835\n\n",
    "created_at": "2014-08-15T22:36:08Z",
    "labels": [
        "categories",
        "major",
        "bug"
    ],
    "title": "cartesian product of ModulesWithBasis not in ModulesWithBasis",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16598",
    "user": "cnassau"
}
```
CC:  nthiery


```
sage: X=CombinatorialFreeModule(RDF,ZZ,category=ModulesWithBasis(RDF))
sage: Y=cartesian_product((X,X))
sage: X in ModulesWithBasis(RDF)
True
sage: Y in ModulesWithBasis(RDF)
False
sage: Y.categories()[1]
Category of modules with basis over Real Double Field
sage: Y.categories()[1] is ModulesWithBasis(RDF)
False
```


This weirdness relates to the fact that `ModulesWithBasis(RDF)` prints as the `Category of vector spaces with basis over Real Double Field`. The `Category of modules with basis over Real Double Field` is one of its super categories.

In the case at hand I cannot construct a morphism from `Y` to `X` because of the category mismatch:

```
sage: Y.module_morphism(codomain=X,on_basis=lambda (i,j):X.monomial(i))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
..
ValueError: Free module generated by Integer Ring over Real Double Field (+) Free module generated by Integer Ring over Real Double Field is not in Category of vector spaces with basis over Real Double Field
```





Issue created by migration from https://trac.sagemath.org/ticket/16835





---

archive/issue_comments_218825.json:
```json
{
    "body": "For the same reason this also fails:\n\n```\nsage: -Y.an_element()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: Free module generated by Integer Ring over Real Double Field (+) Free module generated by Integer Ring over Real Double Field is not in Category of vector spaces with basis over Real Double Field\n```\n",
    "created_at": "2014-08-16T05:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218825",
    "user": "cnassau"
}
```

For the same reason this also fails:

```
sage: -Y.an_element()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: Free module generated by Integer Ring over Real Double Field (+) Free module generated by Integer Ring over Real Double Field is not in Category of vector spaces with basis over Real Double Field
```




---

archive/issue_comments_218826.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-08-16T11:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218826",
    "user": "cnassau"
}
```

New commits:



---

archive/issue_comments_218827.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-16T11:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218827",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218828.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-16T11:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218828",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218829.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-16T11:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218829",
    "user": "cnassau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218830.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-16T11:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218830",
    "user": "cnassau"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218831.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-16T12:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218831",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218832.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-16T12:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218832",
    "user": "cnassau"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218833.json:
```json
{
    "body": "I've also had to change half a dozen unrelated files that had doctests to make sure that vector spaces had neither tensor product nor cartesian products. \n\nThe idea to document a snapshot of the current category graph in doctests that are spread out all over the place is not very good: it makes fixing things painful, and it doesn't prevent serious bugs [as this and other category related tickets show].",
    "created_at": "2014-08-16T12:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218833",
    "user": "cnassau"
}
```

I've also had to change half a dozen unrelated files that had doctests to make sure that vector spaces had neither tensor product nor cartesian products. 

The idea to document a snapshot of the current category graph in doctests that are spread out all over the place is not very good: it makes fixing things painful, and it doesn't prevent serious bugs [as this and other category related tickets show].



---

archive/issue_comments_218834.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2014-09-10T07:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218834",
    "user": "cnassau"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_218835.json:
```json
{
    "body": "I've changed the priority to make sure this issue gets addressed in the next release.",
    "created_at": "2014-09-10T07:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218835",
    "user": "cnassau"
}
```

I've changed the priority to make sure this issue gets addressed in the next release.



---

archive/issue_comments_218836.json:
```json
{
    "body": "Changing priority from blocker to major.",
    "created_at": "2014-09-10T07:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218836",
    "user": "tscrim"
}
```

Changing priority from blocker to major.



---

archive/issue_comments_218837.json:
```json
{
    "body": "Not a blocker, but this has been on my todo list. I hope to get to this next week.",
    "created_at": "2014-09-10T07:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218837",
    "user": "tscrim"
}
```

Not a blocker, but this has been on my todo list. I hope to get to this next week.



---

archive/issue_comments_218838.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-14T16:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218838",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218839.json:
```json
{
    "body": "LGTM. Although I've made a few trivial line break changes.\n\nBTW, we all want our bugs (and tickets) addressed/reviewed quickly. As a courtesy, please don't set things to blocker trying to get yours looked at. Instead you can cc me (or other who might be good for reviewing it) and I'll look at it as soon as I can.\n----\nNew commits:",
    "created_at": "2014-09-14T16:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218839",
    "user": "tscrim"
}
```

LGTM. Although I've made a few trivial line break changes.

BTW, we all want our bugs (and tickets) addressed/reviewed quickly. As a courtesy, please don't set things to blocker trying to get yours looked at. Instead you can cc me (or other who might be good for reviewing it) and I'll look at it as soon as I can.
----
New commits:



---

archive/issue_comments_218840.json:
```json
{
    "body": "Thanks very much for taking the time to review this issue!\n\nReplying to [comment:11 tscrim]:\n> BTW, we all want our bugs (and tickets) addressed/reviewed quickly. As a courtesy, please don't set things to blocker trying to get yours looked at. Instead you can cc me (or other who might be good for reviewing it) and I'll look at it as soon as I can.\n\nActually, my intention was not to get it reviewed quickly, just to make sure it gets adressed at all in the next release. \n\n\n> ----\n> New commits:\n> ||[da19932](http://git.sagemath.org/sage.git/commit/?id=da19932c0f2847e27b5cb9225d056f7b37251c68)||`Merge branch 'u/cnassau/16835' of trac.sagemath.org:sage into u/tscrim/product_modules_with_basis-16835`||\n> ||[4e52d99](http://git.sagemath.org/sage.git/commit/?id=4e52d992d0e4ea3480fb3f538325c8a602c84047)||`Added some line breaks.`||",
    "created_at": "2014-09-14T21:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218840",
    "user": "cnassau"
}
```

Thanks very much for taking the time to review this issue!

Replying to [comment:11 tscrim]:
> BTW, we all want our bugs (and tickets) addressed/reviewed quickly. As a courtesy, please don't set things to blocker trying to get yours looked at. Instead you can cc me (or other who might be good for reviewing it) and I'll look at it as soon as I can.

Actually, my intention was not to get it reviewed quickly, just to make sure it gets adressed at all in the next release. 


> ----
> New commits:
> ||[da19932](http://git.sagemath.org/sage.git/commit/?id=da19932c0f2847e27b5cb9225d056f7b37251c68)||`Merge branch 'u/cnassau/16835' of trac.sagemath.org:sage into u/tscrim/product_modules_with_basis-16835`||
> ||[4e52d99](http://git.sagemath.org/sage.git/commit/?id=4e52d992d0e4ea3480fb3f538325c8a602c84047)||`Added some line breaks.`||



---

archive/issue_comments_218841.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-16T18:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-218841",
    "user": "vbraun"
}
```

Resolution: fixed
