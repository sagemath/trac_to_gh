# Issue 33852: stock prices doesn't work anymore

Issue created by migration from https://trac.sagemath.org/ticket/34089

Original creator: was

Original creation time: 2022-06-26 18:31:17

This is now broken:


```
import sage.finance.stock
sage.finance.stock.Stock('IBM')
```


It depended on http://finance.yahoo.com/d/quotes.csv which seems to no longer exist.

The actual doctest does say:


```
sage: S        # optional -- internet # known bug
```


but that known bug tag is annoying in this case since it doesn't point to a trac ticket.  I didn't find one via search.
What to do?  I don't know.  On pypi I found

https://pypi.org/project/stockquotes/

but that also depends on yahoo and seems broken as well.  I also found 

https://pypi.org/project/googlefinance/

but it seems similarly broken these days.

Though I like this functionality existing, it's probably best to deprecate or remove it at this point, unless there is a good library on pypi for doing this.  And if there is, then maybe the deprecation should just point to that library (e.g., if you need stock data, please install XXX).


---

Comment by @DaveWitteMorris created at 2022-06-26 20:03:28

I think this ticket would be a duplicate of #26754, except that the ticket was closed because #32427 supposedly deprecated all of sage.finance. Does something still need to be done?


---

Comment by was created at 2022-06-26 20:17:22

The way this deprecation gets presented is VERY confusing. Look:

```
sage: finance                           
/ext/sage/9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/repl/display/fancy_repr.py:272: DeprecationWarning: the package sage.finance is deprecated
See https://trac.sagemath.org/32427 for details.
  output = repr(obj)
/ext/sage/9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/repl/display/fancy_repr.py:272: DeprecationWarning: 
Importing finance from here is deprecated. If you need to use it, please import it directly from sage.finance
See https://trac.sagemath.org/32427 for details.
  output = repr(obj)
<module 'sage.finance.all' from '/ext/sage/9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/finance/all.py'>
sage: import sage.finance               
sage: # NO warnings       
```


The problem is that there are multiple deprecation at once, so you see a big block of errors.  It's Python so you look at the one at the very bottom, and typically by default ignore what's above it unless you are stuck.  The bottom one says "Importing finance from here is deprecated. If you need to use it, please import it directly from sage.finance", so you do that, and never see the message about sage.finance itself being deprecated.

That's what led me here.   I'll just close this, since life's too short to worry about improving this sort of UX issue.


---

Comment by was created at 2022-06-26 20:17:34

Resolution: duplicate
