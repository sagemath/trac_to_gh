# Issue 25429: Interface GSL Monte Carlo with sage

archive/issues_025429.json:
```json
{
    "body": "CC:  vdelecroix\n\nCurrently Sage can on dimensional integration with the gsl function `numerical_integral`.\n\nThe goal of this ticket is to allow sage to do multidimensional integration with gsl's monte carlo function.\nGsl documentation https://www.gnu.org/software/gsl/doc/html/montecarlo.html\n\nIssue created by migration from https://trac.sagemath.org/ticket/25666\n\n",
    "created_at": "2018-06-26T14:18:47Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Interface GSL Monte Carlo with sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25429",
    "user": "vklein"
}
```
CC:  vdelecroix

Currently Sage can on dimensional integration with the gsl function `numerical_integral`.

The goal of this ticket is to allow sage to do multidimensional integration with gsl's monte carlo function.
Gsl documentation https://www.gnu.org/software/gsl/doc/html/montecarlo.html

Issue created by migration from https://trac.sagemath.org/ticket/25666





---

archive/issue_comments_358515.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to calculus.",
    "created_at": "2018-06-26T15:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358515",
    "user": "vklein"
}
```

Changing component from PLEASE CHANGE to calculus.



---

archive/issue_comments_358516.json:
```json
{
    "body": "The branch is a development version.\n----\nNew commits:",
    "created_at": "2019-06-19T13:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358516",
    "user": "vklein"
}
```

The branch is a development version.
----
New commits:



---

archive/issue_comments_358517.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-19T13:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358517",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358518.json:
```json
{
    "body": "- the Monte Carlo version should apear in the code **after** the one-dimensional deterministic version\n- right now the code is far too slow. The integration goes through the function `double c_monte_ff(double *x, size_t dim, void *params)` which creates a Python list in order to evaluate the integrand\n- the code only works with function that can be transformed into fast callble. It should also work for Python function such as `lambda u,v: u*v`\n- I did `Ctrl-C` and obtained a segfault",
    "created_at": "2019-06-19T13:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358518",
    "user": "vdelecroix"
}
```

- the Monte Carlo version should apear in the code **after** the one-dimensional deterministic version
- right now the code is far too slow. The integration goes through the function `double c_monte_ff(double *x, size_t dim, void *params)` which creates a Python list in order to evaluate the integrand
- the code only works with function that can be transformed into fast callble. It should also work for Python function such as `lambda u,v: u*v`
- I did `Ctrl-C` and obtained a segfault



---

archive/issue_comments_358519.json:
```json
{
    "body": "Changing keywords from \"\" to \"days101\".",
    "created_at": "2019-06-19T21:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358519",
    "user": "vdelecroix"
}
```

Changing keywords from "" to "days101".



---

archive/issue_comments_358520.json:
```json
{
    "body": "I removed the list constructions.\n----\nNew commits:",
    "created_at": "2019-06-20T09:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358520",
    "user": "vdelecroix"
}
```

I removed the list constructions.
----
New commits:



---

archive/issue_comments_358521.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-20T15:53:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358521",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358522.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-20T16:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358522",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358523.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-06-20T16:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358523",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_358524.json:
```json
{
    "body": "- Monte Carlo has been moved after the one-dimensional version\n- Pythons function are now supported.\n- Some tests have been added\n- I don't have managed to reproduce the segfault.",
    "created_at": "2019-06-20T16:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358524",
    "user": "vklein"
}
```

- Monte Carlo has been moved after the one-dimensional version
- Pythons function are now supported.
- Some tests have been added
- I don't have managed to reproduce the segfault.



---

archive/issue_comments_358525.json:
```json
{
    "body": "- instead of `elif not isinstance(func, Wrapper)` you should check for `Wrapper_rdf`. For example the following segfaults\n\n```\nsage: from sage.calculus.integration import monte_carlo_integration\nsage: f(u,v) = u*v\nsage: f = fast_callable(f, domain=CDF)\nsage: monte_carlo_integration(f, [0,0], [2,2], 10^7) # abs tol 0.1\n```\n\n- the first line of the documentation must be a single short line. For example `Integrate func` is enough. The details are provided by the rest of the documentation.\n- there is no newline at end of file (and git somehow complains)\n- can you replace `PyMem_Malloc`/`PyMem_Free` by the more modern `MemoryAllocator` from `ext/memory_allocator.pyx` (for `_xl` and `_xu`)\n- to make it faster with Python functions, you can try to change directly the values of the floating points in wrapper.lx via the [https://docs.python.org/2/c-api/float.html C API](https://docs.python.org/2/c-api/float.html C API)\n- you should change `print('TODO: Implement the case where the algo param is wrong')` with a proper error :-0",
    "created_at": "2019-06-20T20:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358525",
    "user": "vdelecroix"
}
```

- instead of `elif not isinstance(func, Wrapper)` you should check for `Wrapper_rdf`. For example the following segfaults

```
sage: from sage.calculus.integration import monte_carlo_integration
sage: f(u,v) = u*v
sage: f = fast_callable(f, domain=CDF)
sage: monte_carlo_integration(f, [0,0], [2,2], 10^7) # abs tol 0.1
```

- the first line of the documentation must be a single short line. For example `Integrate func` is enough. The details are provided by the rest of the documentation.
- there is no newline at end of file (and git somehow complains)
- can you replace `PyMem_Malloc`/`PyMem_Free` by the more modern `MemoryAllocator` from `ext/memory_allocator.pyx` (for `_xl` and `_xu`)
- to make it faster with Python functions, you can try to change directly the values of the floating points in wrapper.lx via the [https://docs.python.org/2/c-api/float.html C API](https://docs.python.org/2/c-api/float.html C API)
- you should change `print('TODO: Implement the case where the algo param is wrong')` with a proper error :-0



---

archive/issue_comments_358526.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-06-24T15:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358526",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_358527.json:
```json
{
    "body": "I think it would be simpler to add a `list lx` attribute to `PyFunctionWrapper` rather than creating the ad hoc `PyMonteWrapper`. When unused this attribute will be set to `NULL` and should not affect performance (though you should check it).\n\nAlso I would not use `monte` alone but rather `monte_carlo`. The abbreviation sounds weird.",
    "created_at": "2019-06-24T15:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358527",
    "user": "vdelecroix"
}
```

I think it would be simpler to add a `list lx` attribute to `PyFunctionWrapper` rather than creating the ad hoc `PyMonteWrapper`. When unused this attribute will be set to `NULL` and should not affect performance (though you should check it).

Also I would not use `monte` alone but rather `monte_carlo`. The abbreviation sounds weird.



---

archive/issue_comments_358528.json:
```json
{
    "body": "Ok i will do that.",
    "created_at": "2019-06-25T07:33:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358528",
    "user": "vklein"
}
```

Ok i will do that.



---

archive/issue_comments_358529.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-25T08:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358529",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358530.json:
```json
{
    "body": "Done.\nPerformance check has been done with :\n\n```\nsage: f(x,a) = 1/(a+x^2)\nsage: %time l=[numerical_integral(f, 1, 2, max_points=100000, params=[n]) for n in range(10000)]\nCPU times: user 2.93 s, sys: 176 ms, total: 3.11 s\nWall time: 3.1 s\n```\n\n\nAnd as you predicted the modification seems to be harmless.\n\nTell me if you have an example to maximize the number of sample points required.\n\nI give positive review to commits `39e4ea2`, \u200b`99e76a3` and `4e3eafc`.",
    "created_at": "2019-06-25T08:10:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358530",
    "user": "vklein"
}
```

Done.
Performance check has been done with :

```
sage: f(x,a) = 1/(a+x^2)
sage: %time l=[numerical_integral(f, 1, 2, max_points=100000, params=[n]) for n in range(10000)]
CPU times: user 2.93 s, sys: 176 ms, total: 3.11 s
Wall time: 3.1 s
```


And as you predicted the modification seems to be harmless.

Tell me if you have an example to maximize the number of sample points required.

I give positive review to commits `39e4ea2`, ​`99e76a3` and `4e3eafc`.



---

archive/issue_comments_358531.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-25T08:10:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358531",
    "user": "vklein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_358532.json:
```json
{
    "body": "Terminology is still bad. We would have `numerical_integral` and `monte_carlo_integration`. Why not `monte_carlo_integral`?",
    "created_at": "2019-06-25T08:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358532",
    "user": "vdelecroix"
}
```

Terminology is still bad. We would have `numerical_integral` and `monte_carlo_integration`. Why not `monte_carlo_integral`?



---

archive/issue_comments_358533.json:
```json
{
    "body": "Please add a space around comparison signs such as in `len(wrapper.the_parameters)!=0`.",
    "created_at": "2019-06-25T08:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358533",
    "user": "vdelecroix"
}
```

Please add a space around comparison signs such as in `len(wrapper.the_parameters)!=0`.



---

archive/issue_comments_358534.json:
```json
{
    "body": "(and assignment as well)",
    "created_at": "2019-06-25T08:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358534",
    "user": "vdelecroix"
}
```

(and assignment as well)



---

archive/issue_comments_358535.json:
```json
{
    "body": "Concerning documentation string, please read carefully the [developer manual](http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) and the [Python conventions in PEP 8](https://www.python.org/dev/peps/pep-0008/). In particular:\n- long lines (> 79 characters) should be split\n- there should be a linebreak between the first line and the rest of the doc\n- etc\n\nAlso `python` -> `Python`.",
    "created_at": "2019-06-25T08:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358535",
    "user": "vdelecroix"
}
```

Concerning documentation string, please read carefully the [developer manual](http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) and the [Python conventions in PEP 8](https://www.python.org/dev/peps/pep-0008/). In particular:
- long lines (> 79 characters) should be split
- there should be a linebreak between the first line and the rest of the doc
- etc

Also `python` -> `Python`.



---

archive/issue_comments_358536.json:
```json
{
    "body": "It should be said the it uses gsl under the hood and make a reference to the documentation. The main authors of this are the GSL developers.",
    "created_at": "2019-06-25T08:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358536",
    "user": "vdelecroix"
}
```

It should be said the it uses gsl under the hood and make a reference to the documentation. The main authors of this are the GSL developers.



---

archive/issue_comments_358537.json:
```json
{
    "body": "This corner case is not correct\n\n```\n    if not dim:\n        return float(0)\n```\n\n(perhaps my fault). I would advised to simply raise an error.",
    "created_at": "2019-06-25T08:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358537",
    "user": "vdelecroix"
}
```

This corner case is not correct

```
    if not dim:
        return float(0)
```

(perhaps my fault). I would advised to simply raise an error.



---

archive/issue_comments_358538.json:
```json
{
    "body": "To allocate arrays, use `calloc` not `malloc`. It is safe for overflows.",
    "created_at": "2019-06-25T08:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358538",
    "user": "vdelecroix"
}
```

To allocate arrays, use `calloc` not `malloc`. It is safe for overflows.



---

archive/issue_comments_358539.json:
```json
{
    "body": "Is it really occurring\n\n```\n        if not func is None:\n            wrapper.the_function = func\n        else:\n            raise ValueError(\"No integrand defined\")\n```\n\nI think this gets catch earlier by `if not callable(func)`. Anyway, any error should be tested in the doctest.",
    "created_at": "2019-06-25T09:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358539",
    "user": "vdelecroix"
}
```

Is it really occurring

```
        if not func is None:
            wrapper.the_function = func
        else:
            raise ValueError("No integrand defined")
```

I think this gets catch earlier by `if not callable(func)`. Anyway, any error should be tested in the doctest.



---

archive/issue_comments_358540.json:
```json
{
    "body": "Replying to [comment:25 vdelecroix]:\n> This corner case is not correct\n> {{{\n>     if not dim:\n>         return float(0)\n> }}}\n> (perhaps my fault). I would advised to simply raise an error.\n\nWhich one ? `ValueError: 0 dimension specified` ?",
    "created_at": "2019-06-25T09:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358540",
    "user": "vklein"
}
```

Replying to [comment:25 vdelecroix]:
> This corner case is not correct
> {{{
>     if not dim:
>         return float(0)
> }}}
> (perhaps my fault). I would advised to simply raise an error.

Which one ? `ValueError: 0 dimension specified` ?



---

archive/issue_comments_358541.json:
```json
{
    "body": "Replying to [comment:28 vklein]:\n> Replying to [comment:25 vdelecroix]:\n> > This corner case is not correct\n> > {{{\n> >     if not dim:\n> >         return float(0)\n> > }}}\n> > (perhaps my fault). I would advised to simply raise an error.\n> \n> Which one ? `ValueError: 0 dimension specified` ?\n\nThe user never specifies dimensions but simply integration bounds for the generalized cube. I would rather use the message `NotImplementedError: 0 dimensional integration not available`.",
    "created_at": "2019-06-25T09:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358541",
    "user": "vdelecroix"
}
```

Replying to [comment:28 vklein]:
> Replying to [comment:25 vdelecroix]:
> > This corner case is not correct
> > {{{
> >     if not dim:
> >         return float(0)
> > }}}
> > (perhaps my fault). I would advised to simply raise an error.
> 
> Which one ? `ValueError: 0 dimension specified` ?

The user never specifies dimensions but simply integration bounds for the generalized cube. I would rather use the message `NotImplementedError: 0 dimensional integration not available`.



---

archive/issue_comments_358542.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-06-25T09:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358542",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_358543.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-25T09:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358543",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358544.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-25T12:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358544",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358545.json:
```json
{
    "body": "Error management is not consistent between fastcallable and Python function :\n\n\n\n```\nsage: x, y = SR.var('x,y')\nsage: monte_carlo_integral(x*y, [0,0,0], [2,2,2], 1)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: The function to be integrated depends on 2 variables (x, y), and so cannot be integrated in one dimension. Please fix additional variables with the 'params' argument\nsage: monte_carlo_integral(lambda x,y: y*x, [0,0,0], [2,2,2], 1)\nobject of type 'NoneType' has no len()\n(0.0, inf)\n```\n",
    "created_at": "2019-06-25T12:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358545",
    "user": "vklein"
}
```

Error management is not consistent between fastcallable and Python function :



```
sage: x, y = SR.var('x,y')
sage: monte_carlo_integral(x*y, [0,0,0], [2,2,2], 1)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: The function to be integrated depends on 2 variables (x, y), and so cannot be integrated in one dimension. Please fix additional variables with the 'params' argument
sage: monte_carlo_integral(lambda x,y: y*x, [0,0,0], [2,2,2], 1)
object of type 'NoneType' has no len()
(0.0, inf)
```




---

archive/issue_comments_358546.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-25T13:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358546",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358547.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-06-25T13:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358547",
    "user": "vklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_358548.json:
```json
{
    "body": "[comment:24]?",
    "created_at": "2019-06-25T15:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358548",
    "user": "vdelecroix"
}
```

[comment:24]?



---

archive/issue_comments_358549.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-06-25T15:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358549",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_358550.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-25T16:05:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358550",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358551.json:
```json
{
    "body": "I am not sure if the ref `[GSL1]` is ok or if there is a naming convention i need to know for references.",
    "created_at": "2019-06-25T16:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358551",
    "user": "vklein"
}
```

I am not sure if the ref `[GSL1]` is ok or if there is a naming convention i need to know for references.



---

archive/issue_comments_358552.json:
```json
{
    "body": "The link you used for `[GSL1]` is exactly the same as for `[GSL]`. Is that intended?\n\nFor naming convention, I would rather make a single entry\n\n```\n.. [GSL]\n   https://www.gnu.org/software/gsl/doc/html/\n```\n\nand when cited, make something more specific\n\n```\nDocumentation can be found in [GSL]_ chapter \"Look at there\".\n```\n",
    "created_at": "2019-06-25T18:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358552",
    "user": "vdelecroix"
}
```

The link you used for `[GSL1]` is exactly the same as for `[GSL]`. Is that intended?

For naming convention, I would rather make a single entry

```
.. [GSL]
   https://www.gnu.org/software/gsl/doc/html/
```

and when cited, make something more specific

```
Documentation can be found in [GSL]_ chapter "Look at there".
```




---

archive/issue_comments_358553.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-06-26T07:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358553",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_358554.json:
```json
{
    "body": "Replying to [comment:39 vdelecroix]:\n> The link you used for `[GSL1]` is exactly the same as for `[GSL]`. Is that intended?\n\nNot at all. It was a genuine mistake.\n\n> For naming convention, I would rather make a single entry\n> {{{\n> .. [GSL]\n>    https://www.gnu.org/software/gsl/doc/html/\n> }}}\n> and when cited, make something more specific\n> {{{\n> Documentation can be found in [GSL]_ chapter \"Look at there\".\n> }}}\n\nOk let's do that.",
    "created_at": "2019-06-26T07:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358554",
    "user": "vklein"
}
```

Replying to [comment:39 vdelecroix]:
> The link you used for `[GSL1]` is exactly the same as for `[GSL]`. Is that intended?

Not at all. It was a genuine mistake.

> For naming convention, I would rather make a single entry
> {{{
> .. [GSL]
>    https://www.gnu.org/software/gsl/doc/html/
> }}}
> and when cited, make something more specific
> {{{
> Documentation can be found in [GSL]_ chapter "Look at there".
> }}}

Ok let's do that.



---

archive/issue_comments_358555.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-06-26T07:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358555",
    "user": "vklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_358556.json:
```json
{
    "body": "The following should be allocated inside the `try`/`finally`\n\n```\n    type_rng = gsl_rng_default\n    _rng = gsl_rng_alloc(type_rng)\n```\n\nOtherwise, the function might return without deallocation.",
    "created_at": "2019-06-26T21:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358556",
    "user": "vdelecroix"
}
```

The following should be allocated inside the `try`/`finally`

```
    type_rng = gsl_rng_default
    _rng = gsl_rng_alloc(type_rng)
```

Otherwise, the function might return without deallocation.



---

archive/issue_comments_358557.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-27T07:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358557",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_358558.json:
```json
{
    "body": "Done.",
    "created_at": "2019-06-27T07:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358558",
    "user": "vklein"
}
```

Done.



---

archive/issue_comments_358559.json:
```json
{
    "body": "Good to go.",
    "created_at": "2019-06-27T09:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358559",
    "user": "vdelecroix"
}
```

Good to go.



---

archive/issue_comments_358560.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-27T09:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358560",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_358561.json:
```json
{
    "body": "Thanks for the review.",
    "created_at": "2019-06-27T09:43:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358561",
    "user": "vklein"
}
```

Thanks for the review.



---

archive/issue_comments_358562.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-28T04:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25429#issuecomment-358562",
    "user": "vbraun"
}
```

Resolution: fixed
