# Issue 16838: Install blas pkgconfig files

archive/issues_016838.json:
```json
{
    "body": "CC:  fbissey jpflori\n\nIn an ideal world every blas implementation would come with pkgconfig files, but unfortunately it couldn't be farther from the truth. So, instead:\n\n* Let Sage build one / all / none of our included blas implementations, depending on OS and user input.\n\n* Then install a `blas-config` package that picks the most suitable blas install from `SAGE_LOCAL/lib`. If there is none, look in the base OS install.\n\nImplementation: https://github.com/vbraun/blas-config\n\nAlso includes a mini-benchmark (mostly to check that cblas works), and a `blas-config` script that can be used later on to switch to another implementation.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17075\n\n",
    "created_at": "2014-09-30T11:20:36Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "title": "Install blas pkgconfig files",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16838",
    "user": "vbraun"
}
```
CC:  fbissey jpflori

In an ideal world every blas implementation would come with pkgconfig files, but unfortunately it couldn't be farther from the truth. So, instead:

* Let Sage build one / all / none of our included blas implementations, depending on OS and user input.

* Then install a `blas-config` package that picks the most suitable blas install from `SAGE_LOCAL/lib`. If there is none, look in the base OS install.

Implementation: https://github.com/vbraun/blas-config

Also includes a mini-benchmark (mostly to check that cblas works), and a `blas-config` script that can be used later on to switch to another implementation.

Issue created by migration from https://trac.sagemath.org/ticket/17075





---

archive/issue_comments_222914.json:
```json
{
    "body": "This is not yet finished, but if you have any design input then now would be the time ;-)",
    "created_at": "2014-09-30T11:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222914",
    "user": "vbraun"
}
```

This is not yet finished, but if you have any design input then now would be the time ;-)



---

archive/issue_comments_222915.json:
```json
{
    "body": "Are we doing stages? First install a pc file for atlas (and OS X make it point to accelerate) and convert to that? Then work out how we replace ATLAS. Or do you plan to switch hard to something like openblas straight away?\n\nMy current patch for module_list.py and misc/cython.py live here https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/sage-6.4-blas.patch I considered that we basically needed two things:\n* the library to be linked (c)blas_lib\n* the folder containing the libraries (c)blas_dir\nI probably need to harmonise between the two files.\n\nWe could also want a cblas_inc for headers but that is probably not necessary.",
    "created_at": "2014-09-30T11:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222915",
    "user": "fbissey"
}
```

Are we doing stages? First install a pc file for atlas (and OS X make it point to accelerate) and convert to that? Then work out how we replace ATLAS. Or do you plan to switch hard to something like openblas straight away?

My current patch for module_list.py and misc/cython.py live here https://github.com/cschwan/sage-on-gentoo/blob/master/sci-mathematics/sage/files/sage-6.4-blas.patch I considered that we basically needed two things:
* the library to be linked (c)blas_lib
* the folder containing the libraries (c)blas_dir
I probably need to harmonise between the two files.

We could also want a cblas_inc for headers but that is probably not necessary.



---

archive/issue_comments_222916.json:
```json
{
    "body": "I don't want to do too much at once. For now ATLAS should stay the default. Though this ticket should work with at least one other BLAS implementation ;-)\n\nThere is no guarantee that all cblas libraries are in the same directory. What do you need `cblas_dir` for that can't be done with `pkgconfig --libs`?",
    "created_at": "2014-09-30T11:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222916",
    "user": "vbraun"
}
```

I don't want to do too much at once. For now ATLAS should stay the default. Though this ticket should work with at least one other BLAS implementation ;-)

There is no guarantee that all cblas libraries are in the same directory. What do you need `cblas_dir` for that can't be done with `pkgconfig --libs`?



---

archive/issue_comments_222917.json:
```json
{
    "body": "In module_list.py, at least, we need to separate the two. We get code of the form\n\n```\n     Extension('sage.gsl.dwt',\n              sources = ['sage/gsl/dwt.pyx'],\n              library_dirs = blas_dir,\n              libraries=['gsl'] + blas_libs,\n              define_macros=[('GSL_DISABLE_DEPRECATED','1')]),\n```\n\nAs far as I can tell shoving everything into \"libraries=\" won't work. But pkg-config will helpfully give us all the directories that we need. So at least to build sage or any extensions you won't be able to just use pkgconfig --libs because distutils wouldn't grok it properly.",
    "created_at": "2014-09-30T11:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222917",
    "user": "fbissey"
}
```

In module_list.py, at least, we need to separate the two. We get code of the form

```
     Extension('sage.gsl.dwt',
              sources = ['sage/gsl/dwt.pyx'],
              library_dirs = blas_dir,
              libraries=['gsl'] + blas_libs,
              define_macros=[('GSL_DISABLE_DEPRECATED','1')]),
```

As far as I can tell shoving everything into "libraries=" won't work. But pkg-config will helpfully give us all the directories that we need. So at least to build sage or any extensions you won't be able to just use pkgconfig --libs because distutils wouldn't grok it properly.



---

archive/issue_comments_222918.json:
```json
{
    "body": "My only comment so far is that we should take care of the strange variable LINBOX_BLAS set up by linbox/fflas-ffpack, written in share/cblas_config, and used in modules_list.py IIRC.",
    "created_at": "2014-09-30T12:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222918",
    "user": "jpflori"
}
```

My only comment so far is that we should take care of the strange variable LINBOX_BLAS set up by linbox/fflas-ffpack, written in share/cblas_config, and used in modules_list.py IIRC.



---

archive/issue_comments_222919.json:
```json
{
    "body": "Replying to [comment:5 jpflori]:\n> My only comment so far is that we should take care of the strange variable LINBOX_BLAS set up by linbox/fflas-ffpack, written in share/cblas_config, and used in modules_list.py IIRC.\n\n*yes* so the file is created by the fflas-ffpack spkg for consumption in linbox. fflas-ffpack provides a fflas-ffpack-config which you would think would help...\n\n```\n(sage-sh) fbissey@QCD-nzi3:sage-6.3.beta7$ fflas-ffpack-config --blas-libs  \n-L/home/work/fbissey/sandbox/sage-6.3.beta7/local/lib -lcblas -latlas -L/home/work/fbissey/sandbox/sage-6.3.beta7/local/lib -llapack\n```\n\nAnd the problem with that output is lapack. My foggy memory tells me that configuring linbox with lapack leads to troubles in sage-on-gentoo (needs re-checking). If we move to .pc we can forget about the whole LINBOX_BLAS business. In sage-on-gentoo I patched fflas-ffpack to use pkg-config directly to find blas/cblas (but I commented lapack out) \nhttps://github.com/cschwan/sage-on-gentoo/blob/master/sci-libs/fflas-ffpack/files/fflas-ffpack-1.6.0-blaslapack-3.patch\nStrangely enough I don't need to do anything in linbox to pick up the right blas and I think the whole cblas-config is not useful in linbox because configure will call fflas-ffpack-config to get its values for BLAS_LIBS and BLAS_CFLAGS. I also cannot find a trace of cblas_config in module_list.py - that would have got my attention in sage-on-gentoo.",
    "created_at": "2014-09-30T21:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222919",
    "user": "fbissey"
}
```

Replying to [comment:5 jpflori]:
> My only comment so far is that we should take care of the strange variable LINBOX_BLAS set up by linbox/fflas-ffpack, written in share/cblas_config, and used in modules_list.py IIRC.

*yes* so the file is created by the fflas-ffpack spkg for consumption in linbox. fflas-ffpack provides a fflas-ffpack-config which you would think would help...

```
(sage-sh) fbissey@QCD-nzi3:sage-6.3.beta7$ fflas-ffpack-config --blas-libs  
-L/home/work/fbissey/sandbox/sage-6.3.beta7/local/lib -lcblas -latlas -L/home/work/fbissey/sandbox/sage-6.3.beta7/local/lib -llapack
```

And the problem with that output is lapack. My foggy memory tells me that configuring linbox with lapack leads to troubles in sage-on-gentoo (needs re-checking). If we move to .pc we can forget about the whole LINBOX_BLAS business. In sage-on-gentoo I patched fflas-ffpack to use pkg-config directly to find blas/cblas (but I commented lapack out) 
https://github.com/cschwan/sage-on-gentoo/blob/master/sci-libs/fflas-ffpack/files/fflas-ffpack-1.6.0-blaslapack-3.patch
Strangely enough I don't need to do anything in linbox to pick up the right blas and I think the whole cblas-config is not useful in linbox because configure will call fflas-ffpack-config to get its values for BLAS_LIBS and BLAS_CFLAGS. I also cannot find a trace of cblas_config in module_list.py - that would have got my attention in sage-on-gentoo.



---

archive/issue_comments_222920.json:
```json
{
    "body": "As far as I'm aware:\n* the code in ffla-ffpack and linbox spkg-install scripts is duplicated, but only fflas writes it down to the cbals-config file.\n* linbox currently does not link to lapack!!! (I must have opended a ticket for that ages ago)",
    "created_at": "2014-09-30T22:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222920",
    "user": "jpflori"
}
```

As far as I'm aware:
* the code in ffla-ffpack and linbox spkg-install scripts is duplicated, but only fflas writes it down to the cbals-config file.
* linbox currently does not link to lapack!!! (I must have opended a ticket for that ages ago)



---

archive/issue_comments_222921.json:
```json
{
    "body": "Replying to [comment:7 jpflori]:\n> As far as I'm aware:\n> * the code in ffla-ffpack and linbox spkg-install scripts is duplicated, but only fflas writes it down to the cbals-config file.\n> * linbox currently does not link to lapack!!! (I must have opended a ticket for that ages ago)\nliblinbox doesn't but liblinboxsage does!\n\n```\n(sage-sh) fbissey@QCD-nzi3:sage-6.3.beta7$ ldd -r local/lib/liblinboxsage.so\n        linux-vdso.so.1 (0x00007ffffbfde000)\n        libntl.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libntl.so.3 (0x00007f15ebac4000)\n        libgf2x.so.1 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgf2x.so.1 (0x00007f15eb8ad000)\n        liblapack.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/liblapack.so.3 (0x00007f15eb077000)\n        libf77blas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libf77blas.so.3 (0x00007f15eae57000)\n        liblinbox.so.0 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/liblinbox.so.0 (0x00007f15eac4f000)\n        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgivaro.so.0 (0x00007f15ea9f2000)\n        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmpxx.so.4 (0x00007f15ea7ec000)\n        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmp.so.11 (0x00007f15ea57a000)\n        libcblas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libcblas.so.3 (0x00007f15ea357000)\n        libatlas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libatlas.so.3 (0x00007f15e9a7a000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f15e981d000)\n        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f15e9514000)\n        libm.so.6 => /lib64/libm.so.6 (0x00007f15e9213000)\n        libc.so.6 => /lib64/libc.so.6 (0x00007f15e8e6b000)\n        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f15e8c54000)\n        libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgfortran.so.3 (0x00007f15e8939000)\n        libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libquadmath.so.0 (0x00007f15e86fc000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f15ec2c2000)\nundefined symbol: maxMagnMP     (local/lib/liblinboxsage.so)\nundefined symbol: findRNS       (local/lib/liblinboxsage.so)\nundefined symbol: RNSbound      (local/lib/liblinboxsage.so)\nundefined symbol: certSolveMP   (local/lib/liblinboxsage.so)\nundefined symbol: certSolveRedMP        (local/lib/liblinboxsage.so)\nundefined symbol: nonsingSolvLlhsMM     (local/lib/liblinboxsage.so)\nundefined symbol: nonsingSolvRNSMM      (local/lib/liblinboxsage.so)\n(sage-sh) fbissey@QCD-nzi3:sage-6.3.beta7$ ldd -r local/lib/liblinbox.so\n        linux-vdso.so.1 (0x00007fffe41ff000)\n        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgivaro.so.0 (0x00007f02187f2000)\n        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmpxx.so.4 (0x00007f02185eb000)\n        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmp.so.11 (0x00007f021837a000)\n        libcblas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libcblas.so.3 (0x00007f0218157000)\n        libatlas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libatlas.so.3 (0x00007f0217879000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f021761d000)\n        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f0217314000)\n        libm.so.6 => /lib64/libm.so.6 (0x00007f0217012000)\n        libc.so.6 => /lib64/libc.so.6 (0x00007f0216c6b000)\n        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f0216a54000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f0218c57000)\n```\n\nNote that we don't link anything in the sage library to lapack - it is not in module_list.py. So anything using lapack in linboxsage is well contained.",
    "created_at": "2014-09-30T22:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222921",
    "user": "fbissey"
}
```

Replying to [comment:7 jpflori]:
> As far as I'm aware:
> * the code in ffla-ffpack and linbox spkg-install scripts is duplicated, but only fflas writes it down to the cbals-config file.
> * linbox currently does not link to lapack!!! (I must have opended a ticket for that ages ago)
liblinbox doesn't but liblinboxsage does!

```
(sage-sh) fbissey@QCD-nzi3:sage-6.3.beta7$ ldd -r local/lib/liblinboxsage.so
        linux-vdso.so.1 (0x00007ffffbfde000)
        libntl.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libntl.so.3 (0x00007f15ebac4000)
        libgf2x.so.1 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgf2x.so.1 (0x00007f15eb8ad000)
        liblapack.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/liblapack.so.3 (0x00007f15eb077000)
        libf77blas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libf77blas.so.3 (0x00007f15eae57000)
        liblinbox.so.0 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/liblinbox.so.0 (0x00007f15eac4f000)
        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgivaro.so.0 (0x00007f15ea9f2000)
        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmpxx.so.4 (0x00007f15ea7ec000)
        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmp.so.11 (0x00007f15ea57a000)
        libcblas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libcblas.so.3 (0x00007f15ea357000)
        libatlas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libatlas.so.3 (0x00007f15e9a7a000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f15e981d000)
        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f15e9514000)
        libm.so.6 => /lib64/libm.so.6 (0x00007f15e9213000)
        libc.so.6 => /lib64/libc.so.6 (0x00007f15e8e6b000)
        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f15e8c54000)
        libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgfortran.so.3 (0x00007f15e8939000)
        libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libquadmath.so.0 (0x00007f15e86fc000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f15ec2c2000)
undefined symbol: maxMagnMP     (local/lib/liblinboxsage.so)
undefined symbol: findRNS       (local/lib/liblinboxsage.so)
undefined symbol: RNSbound      (local/lib/liblinboxsage.so)
undefined symbol: certSolveMP   (local/lib/liblinboxsage.so)
undefined symbol: certSolveRedMP        (local/lib/liblinboxsage.so)
undefined symbol: nonsingSolvLlhsMM     (local/lib/liblinboxsage.so)
undefined symbol: nonsingSolvRNSMM      (local/lib/liblinboxsage.so)
(sage-sh) fbissey@QCD-nzi3:sage-6.3.beta7$ ldd -r local/lib/liblinbox.so
        linux-vdso.so.1 (0x00007fffe41ff000)
        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgivaro.so.0 (0x00007f02187f2000)
        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmpxx.so.4 (0x00007f02185eb000)
        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libgmp.so.11 (0x00007f021837a000)
        libcblas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libcblas.so.3 (0x00007f0218157000)
        libatlas.so.3 => /home/work/fbissey/sandbox/sage-6.3.beta7/local/lib/libatlas.so.3 (0x00007f0217879000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f021761d000)
        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f0217314000)
        libm.so.6 => /lib64/libm.so.6 (0x00007f0217012000)
        libc.so.6 => /lib64/libc.so.6 (0x00007f0216c6b000)
        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f0216a54000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f0218c57000)
```

Note that we don't link anything in the sage library to lapack - it is not in module_list.py. So anything using lapack in linboxsage is well contained.



---

archive/issue_comments_222922.json:
```json
{
    "body": "cblas_config is read by the linbox spkg\n\n```\n###############################################################################\n# Set up environment variables:\n###############################################################################\nLD_CBLAS=`cat $SAGE_LOCAL/share/cblas_config`\nLDFLAGS=\"$LDFLAGS -L$SAGE_LOCAL/lib $LD_CBLAS\"\n```\n\nWhen fflas-ffpack got split from linbox, fflas-ffpack inherited the variable LINBOX_BLAS, it is not present anymore in the linbox spkg.",
    "created_at": "2014-09-30T22:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222922",
    "user": "fbissey"
}
```

cblas_config is read by the linbox spkg

```
###############################################################################
# Set up environment variables:
###############################################################################
LD_CBLAS=`cat $SAGE_LOCAL/share/cblas_config`
LDFLAGS="$LDFLAGS -L$SAGE_LOCAL/lib $LD_CBLAS"
```

When fflas-ffpack got split from linbox, fflas-ffpack inherited the variable LINBOX_BLAS, it is not present anymore in the linbox spkg.



---

archive/issue_comments_222923.json:
```json
{
    "body": "And I have just done a build of 6.4.beta4 with a linbox in which I removed the above two lines.\n\n```\n(sage-sh) fbissey@QCD-nzi3:sage-6.4.beta4$ ldd -r local/lib/liblinbox.so\n        linux-vdso.so.1 (0x00007fff8a9ff000)\n        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgivaro.so.0 (0x00007f08b0731000)\n        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmpxx.so.4 (0x00007f08b052a000)\n        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmp.so.11 (0x00007f08b02b9000)\n        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f08aff72000)\n        libm.so.6 => /lib64/libm.so.6 (0x00007f08afc70000)\n        libc.so.6 => /lib64/libc.so.6 (0x00007f08af8c9000)\n        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f08af6b2000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f08b0b96000)\n(sage-sh) fbissey@QCD-nzi3:sage-6.4.beta4$ ldd -r local/lib/liblinboxsage.so\n        linux-vdso.so.1 (0x00007fffdd33b000)\n        libntl.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libntl.so.3 (0x00007f3281172000)\n        libgf2x.so.1 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgf2x.so.1 (0x00007f3280f5b000)\n        liblapack.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/liblapack.so.3 (0x00007f3280725000)\n        libcblas.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libcblas.so.3 (0x00007f3280502000)\n        libf77blas.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libf77blas.so.3 (0x00007f32802e1000)\n        libatlas.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libatlas.so.3 (0x00007f327fa04000)\n        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f327f7a8000)\n        liblinbox.so.0 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/liblinbox.so.0 (0x00007f327f5a0000)\n        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgivaro.so.0 (0x00007f327f343000)\n        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmpxx.so.4 (0x00007f327f13d000)\n        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmp.so.11 (0x00007f327eecb000)\n        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f327ebc2000)\n        libm.so.6 => /lib64/libm.so.6 (0x00007f327e8c1000)\n        libc.so.6 => /lib64/libc.so.6 (0x00007f327e519000)\n        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f327e302000)\n        libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgfortran.so.3 (0x00007f327dfe7000)\n        libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libquadmath.so.0 (0x00007f327ddaa000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f3281970000)\n```\n\nI will check on a OS X machine but I think the whole cblas_config can be safely removed.",
    "created_at": "2014-10-01T01:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222923",
    "user": "fbissey"
}
```

And I have just done a build of 6.4.beta4 with a linbox in which I removed the above two lines.

```
(sage-sh) fbissey@QCD-nzi3:sage-6.4.beta4$ ldd -r local/lib/liblinbox.so
        linux-vdso.so.1 (0x00007fff8a9ff000)
        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgivaro.so.0 (0x00007f08b0731000)
        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmpxx.so.4 (0x00007f08b052a000)
        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmp.so.11 (0x00007f08b02b9000)
        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f08aff72000)
        libm.so.6 => /lib64/libm.so.6 (0x00007f08afc70000)
        libc.so.6 => /lib64/libc.so.6 (0x00007f08af8c9000)
        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f08af6b2000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f08b0b96000)
(sage-sh) fbissey@QCD-nzi3:sage-6.4.beta4$ ldd -r local/lib/liblinboxsage.so
        linux-vdso.so.1 (0x00007fffdd33b000)
        libntl.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libntl.so.3 (0x00007f3281172000)
        libgf2x.so.1 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgf2x.so.1 (0x00007f3280f5b000)
        liblapack.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/liblapack.so.3 (0x00007f3280725000)
        libcblas.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libcblas.so.3 (0x00007f3280502000)
        libf77blas.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libf77blas.so.3 (0x00007f32802e1000)
        libatlas.so.3 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libatlas.so.3 (0x00007f327fa04000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f327f7a8000)
        liblinbox.so.0 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/liblinbox.so.0 (0x00007f327f5a0000)
        libgivaro.so.0 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgivaro.so.0 (0x00007f327f343000)
        libgmpxx.so.4 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmpxx.so.4 (0x00007f327f13d000)
        libgmp.so.11 => /home/work/fbissey/sandbox/sage-6.4.beta4/local/lib/libgmp.so.11 (0x00007f327eecb000)
        libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libstdc++.so.6 (0x00007f327ebc2000)
        libm.so.6 => /lib64/libm.so.6 (0x00007f327e8c1000)
        libc.so.6 => /lib64/libc.so.6 (0x00007f327e519000)
        libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgcc_s.so.1 (0x00007f327e302000)
        libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libgfortran.so.3 (0x00007f327dfe7000)
        libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/4.8.3/libquadmath.so.0 (0x00007f327ddaa000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f3281970000)
```

I will check on a OS X machine but I think the whole cblas_config can be safely removed.



---

archive/issue_comments_222924.json:
```json
{
    "body": "Interesting on OS X I get \n\n```\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinboxsage.dylib \nlocal/lib/liblinboxsage.dylib:\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinboxsage.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libntl.2.dylib (compatibility version 3.0.0, current version 3.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgf2x.1.dylib (compatibility version 2.0.0, current version 2.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinbox.dylib \nlocal/lib/liblinbox.dylib:\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n```\n\nwith or without these lines and we have\n\n```\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ fflas-ffpack-config --blas-libs\n/usr/lib/libcblas.dylib\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ fflas-ffpack-config --blas-home\n\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ fflas-ffpack-config --blas-cflags\n-I/Users/fbissey/build/sage-6.2.beta5/local/include -D__FFLASFFPACK_HAVE_CBLAS\n```\n\nAt this stage there may be something to do to fflas-ffpack.",
    "created_at": "2014-10-01T01:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222924",
    "user": "fbissey"
}
```

Interesting on OS X I get 

```
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinboxsage.dylib 
local/lib/liblinboxsage.dylib:
	/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinboxsage.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libntl.2.dylib (compatibility version 3.0.0, current version 3.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgf2x.1.dylib (compatibility version 2.0.0, current version 2.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinbox.dylib 
local/lib/liblinbox.dylib:
	/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
```

with or without these lines and we have

```
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ fflas-ffpack-config --blas-libs
/usr/lib/libcblas.dylib
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ fflas-ffpack-config --blas-home

(sage-sh) fbissey@Mirage:sage-6.2.beta5$ fflas-ffpack-config --blas-cflags
-I/Users/fbissey/build/sage-6.2.beta5/local/include -D__FFLASFFPACK_HAVE_CBLAS
```

At this stage there may be something to do to fflas-ffpack.



---

archive/issue_comments_222925.json:
```json
{
    "body": "Yes if I replace\n\n```\nLINBOX_BLAS=/usr/lib/libcblas.dylib\n```\n\nby \n\n```\nLINBOX_BLAS=-lcblas\n```\n\nI get\n\n```\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinbox.dylib \nlocal/lib/liblinbox.dylib:\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)\n\t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinboxsage.dylib \nlocal/lib/liblinboxsage.dylib:\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinboxsage.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libntl.2.dylib (compatibility version 3.0.0, current version 3.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgf2x.1.dylib (compatibility version 2.0.0, current version 2.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)\n\t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)\n\t/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n(sage-sh) fbissey@Mirage:sage-6.2.beta5$ \n```\n\nso we end up with blas in both liblinbox and liblinboxsage. Most curious.",
    "created_at": "2014-10-01T02:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222925",
    "user": "fbissey"
}
```

Yes if I replace

```
LINBOX_BLAS=/usr/lib/libcblas.dylib
```

by 

```
LINBOX_BLAS=-lcblas
```

I get

```
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinbox.dylib 
local/lib/liblinbox.dylib:
	/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ otool -L local/lib/liblinboxsage.dylib 
local/lib/liblinboxsage.dylib:
	/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinboxsage.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libntl.2.dylib (compatibility version 3.0.0, current version 3.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgf2x.1.dylib (compatibility version 2.0.0, current version 2.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/liblinbox.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgivaro.0.dylib (compatibility version 6.0.0, current version 6.1.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmpxx.4.dylib (compatibility version 5.0.0, current version 5.21.0)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib (compatibility version 1.0.0, current version 1.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1197.1.1)
	/Users/fbissey/build/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
(sage-sh) fbissey@Mirage:sage-6.2.beta5$ 
```

so we end up with blas in both liblinbox and liblinboxsage. Most curious.



---

archive/issue_comments_222926.json:
```json
{
    "body": "I see I had restored linbox to its original state. If I remove the two lines reading cblas_config. blas disapear from liblinbox.dylib. I guess if there was --as-needed option for OS X we could check that it is indeed not needed for liblinbox. I checked the Makefile.am for liblinbox and liblinboxsage and it is clearly the intent that only the sage interface depends on blas.\n\nSo for linbox I think we should make a small change in fflas-ffpack for OS X, remove the cblas_config file and update the linbox spkg accordingly.",
    "created_at": "2014-10-01T02:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222926",
    "user": "fbissey"
}
```

I see I had restored linbox to its original state. If I remove the two lines reading cblas_config. blas disapear from liblinbox.dylib. I guess if there was --as-needed option for OS X we could check that it is indeed not needed for liblinbox. I checked the Makefile.am for liblinbox and liblinboxsage and it is clearly the intent that only the sage interface depends on blas.

So for linbox I think we should make a small change in fflas-ffpack for OS X, remove the cblas_config file and update the linbox spkg accordingly.



---

archive/issue_comments_222927.json:
```json
{
    "body": "Preliminary clean up of fflas-ffpack+linbox is now #17087.",
    "created_at": "2014-10-02T08:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222927",
    "user": "fbissey"
}
```

Preliminary clean up of fflas-ffpack+linbox is now #17087.



---

archive/issue_comments_222928.json:
```json
{
    "body": "For info, an old ticket I opened is at #14390.",
    "created_at": "2014-10-14T13:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222928",
    "user": "jpflori"
}
```

For info, an old ticket I opened is at #14390.



---

archive/issue_comments_222929.json:
```json
{
    "body": "Was looking at integrating coinor-cbc in sage-on-gentoo and then I noticed that in this one and only place we have a reference to lapack in module_list.py. So if we continue to support that particular binding we need to pull lapack as well.",
    "created_at": "2015-03-29T01:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222929",
    "user": "fbissey"
}
```

Was looking at integrating coinor-cbc in sage-on-gentoo and then I noticed that in this one and only place we have a reference to lapack in module_list.py. So if we continue to support that particular binding we need to pull lapack as well.



---

archive/issue_comments_222930.json:
```json
{
    "body": "Putting the conversion of ATLAS to `.pc` files here. I should commit the sage bits in a few hours.\n----\nNew commits:",
    "created_at": "2015-07-03T05:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222930",
    "user": "fbissey"
}
```

Putting the conversion of ATLAS to `.pc` files here. I should commit the sage bits in a few hours.
----
New commits:



---

archive/issue_comments_222931.json:
```json
{
    "body": "Cannot this get in by itself?\nAnd the \"sage bits\" be put into other ticekts?",
    "created_at": "2015-07-03T09:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222931",
    "user": "jpflori"
}
```

Cannot this get in by itself?
And the "sage bits" be put into other ticekts?



---

archive/issue_comments_222932.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-07-03T09:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222932",
    "user": "fbissey"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_222933.json:
```json
{
    "body": "I am fine with that, nice and progressive. I am putting to need review then and you can play with it. I have only tried on OS X and my linux box will be off soon because the university has some power outage planned for the week end. No sage-on-gentoo development until Monday either because of that.\n\nHum, will have to change the description at some point.",
    "created_at": "2015-07-03T09:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222933",
    "user": "fbissey"
}
```

I am fine with that, nice and progressive. I am putting to need review then and you can play with it. I have only tried on OS X and my linux box will be off soon because the university has some power outage planned for the week end. No sage-on-gentoo development until Monday either because of that.

Hum, will have to change the description at some point.



---

archive/issue_comments_222934.json:
```json
{
    "body": "Replying to [comment:18 jpflori]:\n> Cannot this get in by itself?\n> And the \"sage bits\" be put into other ticekts?\n\nIt doesn't really make sense to test just this ticket by itself. There should be at least one package using the new `.pc` file to shows that it actually works (either on this or a new ticket).",
    "created_at": "2015-07-07T13:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222934",
    "user": "jdemeyer"
}
```

Replying to [comment:18 jpflori]:
> Cannot this get in by itself?
> And the "sage bits" be put into other ticekts?

It doesn't really make sense to test just this ticket by itself. There should be at least one package using the new `.pc` file to shows that it actually works (either on this or a new ticket).



---

archive/issue_comments_222935.json:
```json
{
    "body": "You can easily test it using pkgconfig. Its a strategic goal for us to clean up *blas linking. We should do what gets us fastest to that goal. How does doing more here or stacking tickets help us achieve that goal faster?",
    "created_at": "2015-07-07T22:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222935",
    "user": "vbraun"
}
```

You can easily test it using pkgconfig. Its a strategic goal for us to clean up *blas linking. We should do what gets us fastest to that goal. How does doing more here or stacking tickets help us achieve that goal faster?



---

archive/issue_comments_222936.json:
```json
{
    "body": "I can import the sage-on-gentoo bits for sage quite easily (depends if we want to keep the `library_dir` bits which enable blas in odd location or not). To some extent that would be testable immediately. The various packages would probably need to be staged carefully. I am especially concerned by the python package - numpy and scipy in particular. Have to be careful how we feed those two and which way is easiest - Gentoo way is too complicated, I think we can do something easier.",
    "created_at": "2015-07-07T22:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222936",
    "user": "fbissey"
}
```

I can import the sage-on-gentoo bits for sage quite easily (depends if we want to keep the `library_dir` bits which enable blas in odd location or not). To some extent that would be testable immediately. The various packages would probably need to be staged carefully. I am especially concerned by the python package - numpy and scipy in particular. Have to be careful how we feed those two and which way is easiest - Gentoo way is too complicated, I think we can do something easier.



---

archive/issue_comments_222937.json:
```json
{
    "body": "Replying to [comment:22 fbissey]:\n> I can import the sage-on-gentoo bits for sage quite easily (depends if we want to keep the `library_dir` bits which enable blas in odd location or not). To some extent that would be testable immediately. The various packages would probably need to be staged carefully. I am especially concerned by the python package - numpy and scipy in particular. Have to be careful how we feed those two and which way is easiest - Gentoo way is too complicated, I think we can do something easier.\nI think in the end we want to allow users to use strange BLAS implems in strange places.\n\nAnd for the numpy and scipy bits, can we work on top of what was done at #17630?\n\nAs Volker, I propose to merge this ticket asap and work on using the produced pc files for our spkg in follow up tickets and maybe make #17630 a task to be closed when everything is ported.",
    "created_at": "2015-07-21T12:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222937",
    "user": "jpflori"
}
```

Replying to [comment:22 fbissey]:
> I can import the sage-on-gentoo bits for sage quite easily (depends if we want to keep the `library_dir` bits which enable blas in odd location or not). To some extent that would be testable immediately. The various packages would probably need to be staged carefully. I am especially concerned by the python package - numpy and scipy in particular. Have to be careful how we feed those two and which way is easiest - Gentoo way is too complicated, I think we can do something easier.
I think in the end we want to allow users to use strange BLAS implems in strange places.

And for the numpy and scipy bits, can we work on top of what was done at #17630?

As Volker, I propose to merge this ticket asap and work on using the produced pc files for our spkg in follow up tickets and maybe make #17630 a task to be closed when everything is ported.



---

archive/issue_comments_222938.json:
```json
{
    "body": "I am sorry I am not more active on this, I have a collection of issue pestering and I have trouble keeping any at the top. I'll add the stuff in question because it will be quick and easy but sage side I am more worried about fixing numpy 1.9.x to get it in. I have a number of Gentoo issue also pestering me (well for starter the blas infrastructure is broken in a Gentoo prefix coincidence I guess).",
    "created_at": "2015-07-21T21:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222938",
    "user": "fbissey"
}
```

I am sorry I am not more active on this, I have a collection of issue pestering and I have trouble keeping any at the top. I'll add the stuff in question because it will be quick and easy but sage side I am more worried about fixing numpy 1.9.x to get it in. I have a number of Gentoo issue also pestering me (well for starter the blas infrastructure is broken in a Gentoo prefix coincidence I guess).



---

archive/issue_comments_222939.json:
```json
{
    "body": "Replying to [comment:23 jpflori]:\n> How does doing more here or stacking tickets help us achieve that goal faster?\nBy increasing the chances of somebody reviewing this ticket if they can actually see that it works.\n\nThe goal of Sage tickets is not just to write code, but to get it reviewed. A ticket without a working use-case is hard to test and therefore hard to review.",
    "created_at": "2015-07-24T16:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222939",
    "user": "jdemeyer"
}
```

Replying to [comment:23 jpflori]:
> How does doing more here or stacking tickets help us achieve that goal faster?
By increasing the chances of somebody reviewing this ticket if they can actually see that it works.

The goal of Sage tickets is not just to write code, but to get it reviewed. A ticket without a working use-case is hard to test and therefore hard to review.



---

archive/issue_comments_222940.json:
```json
{
    "body": "The ticket description doesn't seem to correspond with the code in the branch, can you please update the description?",
    "created_at": "2015-07-24T16:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222940",
    "user": "jdemeyer"
}
```

The ticket description doesn't seem to correspond with the code in the branch, can you please update the description?



---

archive/issue_comments_222941.json:
```json
{
    "body": "Bumpy comment.\nWhat's the relation between Volker code and Fran\u00e7ois branch?\nIt would be very nice to use something else than a very outdated ATLAS in Sage :(",
    "created_at": "2016-02-10T15:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222941",
    "user": "jpflori"
}
```

Bumpy comment.
What's the relation between Volker code and François branch?
It would be very nice to use something else than a very outdated ATLAS in Sage :(



---

archive/issue_comments_222942.json:
```json
{
    "body": "Well, I have commented in a related ticket that I had been somewhat demotivated to work on this. I think most stuff has to be thrown away or re-based. Jeroen was working on an ATLAS upgrade more recently because of power8.\n\nBut really the plan is to get something like the functionality I have now in sage-on-gentoo: \n* you can use one of many blas/lapack\n* Each blas/lapack install some .pc file\n* we use the .pc file to find the libraries and headers needed\n \n\nSo the first step is get ATLAS to install .pc files, then migrate spkg to use them including the sage library. Then we can start writing alternative blas/lapack spkg.",
    "created_at": "2016-02-10T20:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222942",
    "user": "fbissey"
}
```

Well, I have commented in a related ticket that I had been somewhat demotivated to work on this. I think most stuff has to be thrown away or re-based. Jeroen was working on an ATLAS upgrade more recently because of power8.

But really the plan is to get something like the functionality I have now in sage-on-gentoo: 
* you can use one of many blas/lapack
* Each blas/lapack install some .pc file
* we use the .pc file to find the libraries and headers needed
 

So the first step is get ATLAS to install .pc files, then migrate spkg to use them including the sage library. Then we can start writing alternative blas/lapack spkg.



---

archive/issue_comments_222943.json:
```json
{
    "body": "Replying to [comment:28 fbissey]:\n> Jeroen was working on an ATLAS upgrade more recently because of power8.\nRight, but there are issues with the new ATLAS...\n\nIn any case, that upgrade does not involve the build system, so it's independent of this ticket here.",
    "created_at": "2016-02-12T15:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222943",
    "user": "jdemeyer"
}
```

Replying to [comment:28 fbissey]:
> Jeroen was working on an ATLAS upgrade more recently because of power8.
Right, but there are issues with the new ATLAS...

In any case, that upgrade does not involve the build system, so it's independent of this ticket here.



---

archive/issue_comments_222944.json:
```json
{
    "body": "Rebased onto latest beta\n\nThis seems to work so lets merge it\n----\nNew commits:",
    "created_at": "2016-02-22T18:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222944",
    "user": "vbraun"
}
```

Rebased onto latest beta

This seems to work so lets merge it
----
New commits:



---

archive/issue_comments_222945.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-22T18:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222945",
    "user": "vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_222946.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-02-23T08:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16838#issuecomment-222946",
    "user": "vbraun"
}
```

Resolution: fixed
