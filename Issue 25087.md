# Issue 25087: giac-1.4.9.45-p2 does not compile with clang-6

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2018-05-10 08:38:52

CC:  fbissey frederichan parisse slelievre

clang-6 has new picks:

```
solve.cc:5751:23: error: non-constant-expression cannot be narrowed from type 'int' to 'short' in initializer list [-Wc++11-narrowing]
      order_t order_={order,lexvars};
                      ^~~~~
solve.cc:5751:23: note: insert an explicit cast to silence this issue
      order_t order_={order,lexvars};
                      ^~~~~
                      static_cast<short>( )
```

I attached the full log.,


---

Attachment


---

Comment by fbissey created at 2018-05-10 09:04:20

Do we know what c++ standard clang-6 default to? C++11 or C++14?


---

Comment by slelievre created at 2018-05-10 09:45:31

Changing keywords from "" to "build, clang, giac".


---

Comment by slelievre created at 2018-05-10 09:45:31

According to the [Clang 6.0.0 release notes](https://isocpp.org/blog/2018/03/clang-6.0.0-released),

> Clangâ€™s default C++ dialect is now gnu++14 instead of gnu++98.
> This means Clang will by default accept code using features from
> C++14 and conforming GNU extensions. Projects incompatible
> with C++14 can add -std=gnu++98 to their build settings to
> restore the previous behaviour.
>
> Added support for some features from the C++ standard after
> C++17 (provisionally known as C++2a but expected to be C++20).
> This support can be enabled with the -std=c++2a flag.


---

Comment by slelievre created at 2018-05-10 09:48:38

Cc Giac and giacpy developers.


---

Comment by fbissey created at 2018-05-10 09:50:56

I suspected it could be the case. So in the interim adding `std=gnu++11` is probably a good work around.


---

Comment by slelievre created at 2018-05-10 13:44:21

Bernard Parisse, the main Giac developer, says clang-6
recommends using static_cast to fix this problem; adding
`static_cast` twice in `solve.cc` in Giac fixes it. This will be in
the next stable release of Giac; see changes to `solve.cc` in
[changeset 61700 in Geogegra](http://dev.geogebra.org/trac/changeset/61700).


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by jdemeyer created at 2018-08-07 14:22:33

While we could upgrade giac, there is also a small issue with PARI-2.11 compatibility (#25567). So I'd rather wait until that has been fixed too.


---

Comment by dimpase created at 2019-01-09 16:22:35

this is tentatively fixed on #26315.


---

Comment by dimpase created at 2019-01-09 16:23:15

Changing status from new to needs_review.


---

Comment by dimpase created at 2019-01-16 09:45:55

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2019-01-16 09:45:55

fixed by #26315.


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid
