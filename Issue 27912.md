# Issue 27912: Implement compact real forms for matrix Lie algebras

archive/issues_027912.json:
```json
{
    "body": "CC:  bsalisbury1 chapoton\n\nKeywords: lie algebras, fpsac2019\n\nBecause they are interesting and are useful.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28149\n\n",
    "created_at": "2019-07-09T22:20:52Z",
    "labels": [
        "algebra",
        "major",
        "enhancement"
    ],
    "title": "Implement compact real forms for matrix Lie algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27912",
    "user": "tscrim"
}
```
CC:  bsalisbury1 chapoton

Keywords: lie algebras, fpsac2019

Because they are interesting and are useful.

Issue created by migration from https://trac.sagemath.org/ticket/28149





---

archive/issue_comments_394119.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-07-09T22:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394119",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_394120.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-07-09T22:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394120",
    "user": "tscrim"
}
```

New commits:



---

archive/issue_comments_394121.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T07:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394121",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_394122.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T08:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394122",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_394123.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T21:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394123",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_394124.json:
```json
{
    "body": "Hi Travis,\n\nI made some small changes to the documentation.  If you are okay with these changes, you may set this to positive review on my behalf.\n\n~Ben",
    "created_at": "2019-07-10T21:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394124",
    "user": "bsalisbury1"
}
```

Hi Travis,

I made some small changes to the documentation.  If you are okay with these changes, you may set this to positive review on my behalf.

~Ben



---

archive/issue_comments_394125.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-10T21:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394125",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_394126.json:
```json
{
    "body": "Thank you!",
    "created_at": "2019-07-10T21:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394126",
    "user": "tscrim"
}
```

Thank you!



---

archive/issue_comments_394127.json:
```json
{
    "body": "On Python 3:\n\n```\nsage -t --long src/sage/algebras/lie_algebras/classical_lie_algebra.py\n**********************************************************************\nFile \"src/sage/algebras/lie_algebras/classical_lie_algebra.py\", line 1202, in sage.algebras.lie_algebras.classical_lie_algebra.MatrixCompactRealForm.Element._richcmp_\nFailed example:\n    sorted(L.basis())\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1105, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.algebras.lie_algebras.classical_lie_algebra.MatrixCompactRealForm.Element._richcmp_[1]>\", line 1, in <module>\n        sorted(L.basis())\n      File \"sage/structure/element.pyx\", line 1091, in sage.structure.element.Element.__richcmp__ (build/cythonized/sage/structure/element.c:9923)\n        return (<Element>self)._richcmp_(other, op)\n      File \"sage/structure/element.pyx\", line 1095, in sage.structure.element.Element._richcmp_ (build/cythonized/sage/structure/element.c:10030)\n        cpdef _richcmp_(left, right, int op):\n      File \"/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/algebras/lie_algebras/classical_lie_algebra.py\", line 1208, in _richcmp_\n        return richcmp((self._real, self._imag), (other._real, other._imag), op)\n      File \"sage/structure/richcmp.pxd\", line 6, in sage.structure.richcmp.richcmp (build/cythonized/sage/structure/richcmp.c:3043)\n        cpdef inline richcmp(x, y, int op):\n      File \"sage/structure/richcmp.pxd\", line 50, in sage.structure.richcmp.richcmp (build/cythonized/sage/structure/richcmp.c:2939)\n        return PyObject_RichCompare(x, y, op)\n      File \"sage/structure/element.pyx\", line 1091, in sage.structure.element.Element.__richcmp__ (build/cythonized/sage/structure/element.c:9923)\n        return (<Element>self)._richcmp_(other, op)\n      File \"sage/matrix/matrix_sparse.pyx\", line 373, in sage.matrix.matrix_sparse.Matrix_sparse._richcmp_ (build/cythonized/sage/matrix/matrix_sparse.c:5799)\n        return richcmp(self._dict(), right._dict(), op)\n      File \"sage/structure/richcmp.pxd\", line 50, in sage.structure.richcmp.richcmp (build/cythonized/sage/matrix/matrix_sparse.c:14822)\n        return PyObject_RichCompare(x, y, op)\n    TypeError: '<' not supported between instances of 'dict' and 'dict'\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.algebras.lie_algebras.classical_lie_algebra.MatrixCompactRealForm.Element._richcmp_\n    [210 tests, 1 failure, 47.86 s]\n```\n",
    "created_at": "2019-07-12T19:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394127",
    "user": "vbraun"
}
```

On Python 3:

```
sage -t --long src/sage/algebras/lie_algebras/classical_lie_algebra.py
**********************************************************************
File "src/sage/algebras/lie_algebras/classical_lie_algebra.py", line 1202, in sage.algebras.lie_algebras.classical_lie_algebra.MatrixCompactRealForm.Element._richcmp_
Failed example:
    sorted(L.basis())
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1105, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.algebras.lie_algebras.classical_lie_algebra.MatrixCompactRealForm.Element._richcmp_[1]>", line 1, in <module>
        sorted(L.basis())
      File "sage/structure/element.pyx", line 1091, in sage.structure.element.Element.__richcmp__ (build/cythonized/sage/structure/element.c:9923)
        return (<Element>self)._richcmp_(other, op)
      File "sage/structure/element.pyx", line 1095, in sage.structure.element.Element._richcmp_ (build/cythonized/sage/structure/element.c:10030)
        cpdef _richcmp_(left, right, int op):
      File "/var/lib/buildbot/slave/sage3_git/build/local/lib/python3.7/site-packages/sage/algebras/lie_algebras/classical_lie_algebra.py", line 1208, in _richcmp_
        return richcmp((self._real, self._imag), (other._real, other._imag), op)
      File "sage/structure/richcmp.pxd", line 6, in sage.structure.richcmp.richcmp (build/cythonized/sage/structure/richcmp.c:3043)
        cpdef inline richcmp(x, y, int op):
      File "sage/structure/richcmp.pxd", line 50, in sage.structure.richcmp.richcmp (build/cythonized/sage/structure/richcmp.c:2939)
        return PyObject_RichCompare(x, y, op)
      File "sage/structure/element.pyx", line 1091, in sage.structure.element.Element.__richcmp__ (build/cythonized/sage/structure/element.c:9923)
        return (<Element>self)._richcmp_(other, op)
      File "sage/matrix/matrix_sparse.pyx", line 373, in sage.matrix.matrix_sparse.Matrix_sparse._richcmp_ (build/cythonized/sage/matrix/matrix_sparse.c:5799)
        return richcmp(self._dict(), right._dict(), op)
      File "sage/structure/richcmp.pxd", line 50, in sage.structure.richcmp.richcmp (build/cythonized/sage/matrix/matrix_sparse.c:14822)
        return PyObject_RichCompare(x, y, op)
    TypeError: '<' not supported between instances of 'dict' and 'dict'
**********************************************************************
1 item had failures:
   1 of   3 in sage.algebras.lie_algebras.classical_lie_algebra.MatrixCompactRealForm.Element._richcmp_
    [210 tests, 1 failure, 47.86 s]
```




---

archive/issue_comments_394128.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-07-12T19:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394128",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_394129.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-13T16:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394129",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_394130.json:
```json
{
    "body": "The root cause is that `dict`'s are incomparable on Python3, which means sparse matrices are incomparable, unlike dense matrices. So I changed how comparisons are done for sparse matrices, which is why I put you in cc Fr\u00e9d\u00e9ric.",
    "created_at": "2019-07-13T16:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394130",
    "user": "tscrim"
}
```

The root cause is that `dict`'s are incomparable on Python3, which means sparse matrices are incomparable, unlike dense matrices. So I changed how comparisons are done for sparse matrices, which is why I put you in cc Frédéric.



---

archive/issue_comments_394131.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-13T16:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394131",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_394132.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-17T15:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394132",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_394133.json:
```json
{
    "body": "(Now) Passes all doctests. Can someone review the last two changes? Should be quick.",
    "created_at": "2019-07-17T15:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394133",
    "user": "tscrim"
}
```

(Now) Passes all doctests. Can someone review the last two changes? Should be quick.



---

archive/issue_comments_394134.json:
```json
{
    "body": "* some pyflakes warnings, see last patchbot (only 2 fixable ones)\n\n* typo \"tranposes\"\n\n* here the brackets can be removed, I think: \n`+        names = tuple(['CR%s'%s for s in range(dim)])`\n\nOtherwise, looks good. You can set to positive once the above is fixed.",
    "created_at": "2019-07-17T19:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394134",
    "user": "chapoton"
}
```

* some pyflakes warnings, see last patchbot (only 2 fixable ones)

* typo "tranposes"

* here the brackets can be removed, I think: 
`+        names = tuple(['CR%s'%s for s in range(dim)])`

Otherwise, looks good. You can set to positive once the above is fixed.



---

archive/issue_comments_394135.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-17T20:10:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394135",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_394136.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-17T20:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394136",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_394137.json:
```json
{
    "body": "Replying to [comment:13 chapoton]:\n> * some pyflakes warnings, see last patchbot (only 2 fixable ones)\n\nFixed.\n\n> * typo \"tranposes\"\n\nFixed.\n\n> * here the brackets can be removed, I think: \n> `+        names = tuple(['CR%s'%s for s in range(dim)])`\n\nIt is actually slightly faster to have the brackets. I think internally Python has some optimization for constructing tuples from lists.\n\n> Otherwise, looks good. You can set to positive once the above is fixed.\n\nThank you. I am allowing myself to set this to a positive review.",
    "created_at": "2019-07-17T20:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394137",
    "user": "tscrim"
}
```

Replying to [comment:13 chapoton]:
> * some pyflakes warnings, see last patchbot (only 2 fixable ones)

Fixed.

> * typo "tranposes"

Fixed.

> * here the brackets can be removed, I think: 
> `+        names = tuple(['CR%s'%s for s in range(dim)])`

It is actually slightly faster to have the brackets. I think internally Python has some optimization for constructing tuples from lists.

> Otherwise, looks good. You can set to positive once the above is fixed.

Thank you. I am allowing myself to set this to a positive review.



---

archive/issue_comments_394138.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-20T09:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27912#issuecomment-394138",
    "user": "vbraun"
}
```

Resolution: fixed
