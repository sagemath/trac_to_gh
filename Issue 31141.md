# Issue 31141: Create a new module for morphic words

archive/issues_031141.json:
```json
{
    "body": "CC:  vdelecroix\n\nThe aim is to make the following computations take less time. \n\n\n\n```\nsage: m = WordMorphism('a->ab,b->a')\nsage: w = m.fixed_point('a')\nsage: w\nword: abaababaabaababaababaabaababaabaababaaba...\nsage: %time w[1000]\nCPU times: user 1.45 ms, sys: 0 ns, total: 1.45 ms\nWall time: 1.45 ms\n'a'\nsage: %time w[10000]\nCPU times: user 82.9 ms, sys: 0 ns, total: 82.9 ms\nWall time: 82.1 ms\n'a'\nsage: %time w[100000]\nCPU times: user 5.19 s, sys: 6.26 ms, total: 5.2 s\nWall time: 5.19 s\n'b'\nsage: %time w[1000000]\nCPU times: user 12min 45s, sys: 93.4 ms, total: 12min 45s\nWall time: 12min 45s\n'a'\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31378\n\n",
    "created_at": "2021-02-11T07:33:09Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Create a new module for morphic words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31141",
    "user": "jlepsova"
}
```
CC:  vdelecroix

The aim is to make the following computations take less time. 



```
sage: m = WordMorphism('a->ab,b->a')
sage: w = m.fixed_point('a')
sage: w
word: abaababaabaababaababaabaababaabaababaaba...
sage: %time w[1000]
CPU times: user 1.45 ms, sys: 0 ns, total: 1.45 ms
Wall time: 1.45 ms
'a'
sage: %time w[10000]
CPU times: user 82.9 ms, sys: 0 ns, total: 82.9 ms
Wall time: 82.1 ms
'a'
sage: %time w[100000]
CPU times: user 5.19 s, sys: 6.26 ms, total: 5.2 s
Wall time: 5.19 s
'b'
sage: %time w[1000000]
CPU times: user 12min 45s, sys: 93.4 ms, total: 12min 45s
Wall time: 12min 45s
'a'
```


Issue created by migration from https://trac.sagemath.org/ticket/31378





---

archive/issue_comments_444951.json:
```json
{
    "body": "duplicate of #31370 ?",
    "created_at": "2021-02-11T08:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444951",
    "user": "chapoton"
}
```

duplicate of #31370 ?



---

archive/issue_comments_444952.json:
```json
{
    "body": "Replying to [comment:1 chapoton]:\n> duplicate of #31370 ?\n\nLet's close #31370 and keep this one (Jana is learning how to contribute to Sage).",
    "created_at": "2021-02-11T09:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444952",
    "user": "slabbe"
}
```

Replying to [comment:1 chapoton]:
> duplicate of #31370 ?

Let's close #31370 and keep this one (Jana is learning how to contribute to Sage).



---

archive/issue_comments_444953.json:
```json
{
    "body": "I rebased the branch on top of `9.3.beta7`. I also added a commit which links the new module added by Jana to the existing sage words library.\n----\nNew commits:",
    "created_at": "2021-02-15T11:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444953",
    "user": "slabbe"
}
```

I rebased the branch on top of `9.3.beta7`. I also added a commit which links the new module added by Jana to the existing sage words library.
----
New commits:



---

archive/issue_comments_444954.json:
```json
{
    "body": "Jana, the next step is to update the examples in the documentation in the `morphic.py` file.\n\nWith the current branch,\n\n\n```\n$ sage -bt src/sage/combinat/words/morphic.py \n```\n\n\nreturns\n\n\n```\n[...]\n\n**********************************************************************\nFile \"src/sage/combinat/words/morphic.py\", line 157, in sage.combinat.words.morphic.WordDatatype_morphic.__iter__\nFailed example:\n    print('update the examples here')\nExpected nothing\nGot:\n    update the examples here\n**********************************************************************\n\n[...]\n\n**********************************************************************\n3 items had failures:\n   1 of   2 in sage.combinat.words.morphic\n   1 of   2 in sage.combinat.words.morphic.WordDatatype_morphic.__getitem__\n   6 of  13 in sage.combinat.words.morphic.WordDatatype_morphic.__iter__\n    [30 tests, 8 failures, 0.02 s]\n----------------------------------------------------------------------\nsage -t --warn-long 72.7 --random-seed=0 src/sage/combinat/words/morphic.py  # 8 doctests failed\n----------------------------------------------------------------------\n```\n",
    "created_at": "2021-02-16T08:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444954",
    "user": "slabbe"
}
```

Jana, the next step is to update the examples in the documentation in the `morphic.py` file.

With the current branch,


```
$ sage -bt src/sage/combinat/words/morphic.py 
```


returns


```
[...]

**********************************************************************
File "src/sage/combinat/words/morphic.py", line 157, in sage.combinat.words.morphic.WordDatatype_morphic.__iter__
Failed example:
    print('update the examples here')
Expected nothing
Got:
    update the examples here
**********************************************************************

[...]

**********************************************************************
3 items had failures:
   1 of   2 in sage.combinat.words.morphic
   1 of   2 in sage.combinat.words.morphic.WordDatatype_morphic.__getitem__
   6 of  13 in sage.combinat.words.morphic.WordDatatype_morphic.__iter__
    [30 tests, 8 failures, 0.02 s]
----------------------------------------------------------------------
sage -t --warn-long 72.7 --random-seed=0 src/sage/combinat/words/morphic.py  # 8 doctests failed
----------------------------------------------------------------------
```




---

archive/issue_comments_444955.json:
```json
{
    "body": "I fixed the doctests in morphic.py.\n----\nNew commits:",
    "created_at": "2021-02-18T12:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444955",
    "user": "jlepsova"
}
```

I fixed the doctests in morphic.py.
----
New commits:



---

archive/issue_comments_444956.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-20T11:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444956",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444957.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444957",
    "user": "mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_444958.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-04-02T08:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444958",
    "user": "slabbe"
}
```

New commits:



---

archive/issue_comments_444959.json:
```json
{
    "body": "I fixed the doctests with respect to saving the objects (loads, dumps, reduce, etc.).\n\nIt remains only one issue:\n\n\n```\n            sage: m = WordMorphism(\"a->ab,b->\")          \n            sage: w = m.fixed_point(\"a\")                                      \n            sage: w.representation(0)                \n            []                                      \n            sage: w.representation(1)             \n            [1]                         \n            sage: w.representation(2)  #infinite loop\n```\n\n\nJana: can you take a look at this?",
    "created_at": "2021-04-02T08:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444959",
    "user": "slabbe"
}
```

I fixed the doctests with respect to saving the objects (loads, dumps, reduce, etc.).

It remains only one issue:


```
            sage: m = WordMorphism("a->ab,b->")          
            sage: w = m.fixed_point("a")                                      
            sage: w.representation(0)                
            []                                      
            sage: w.representation(1)             
            [1]                         
            sage: w.representation(2)  #infinite loop
```


Jana: can you take a look at this?



---

archive/issue_comments_444960.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-04-15T19:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444960",
    "user": "jlepsova"
}
```

New commits:



---

archive/issue_comments_444961.json:
```json
{
    "body": "Does the most recent commit also handles the following infinite loop?\n\n```\nsage: m = WordMorphism(\"a->ab,b->,c->cdab,d->dcab\")\nsage: w = m.fixed_point(\"a\")\nsage: w.representation(2)\n```\n\n\nWhat is the remaining problem you mention in the commit message? Can you provide an example?\n\n\nIn the following, the multiplication `vMk*M` is computed twice. Maybe you want to write `vMk1 = vMk*M` to represent `vM^{k+1}` and at the end of the loop, you may do `vMk = vMk1`.\n\n\n```diff\n         while vMk[position] <= n:\n+            if vMk == vMk*M:\n+                raise ValueError('The morphism has a finite fixed point of length {}.'.format(vMk[position]))\n             vMk = vMk*M\n             length_of_images.append(vMk)\n```\n\n\nI would suggest that the error message also include the value of `n`. Something like `IndexError: index (=2) out of range, the fixed point is finite and has length 2`.\n\nI think the error should be an `IndexError` instead of `ValueError`, as it is for strings:\n\n\n```\nsage: s = 'ab'                                                                  \nsage: s[2]                                                                      \n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n<ipython-input-2-2d1d9bdb9b26> in <module>\n----> 1 s[Integer(2)]\n\nIndexError: string index out of range\n```\n",
    "created_at": "2021-04-16T14:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444961",
    "user": "slabbe"
}
```

Does the most recent commit also handles the following infinite loop?

```
sage: m = WordMorphism("a->ab,b->,c->cdab,d->dcab")
sage: w = m.fixed_point("a")
sage: w.representation(2)
```


What is the remaining problem you mention in the commit message? Can you provide an example?


In the following, the multiplication `vMk*M` is computed twice. Maybe you want to write `vMk1 = vMk*M` to represent `vM^{k+1}` and at the end of the loop, you may do `vMk = vMk1`.


```diff
         while vMk[position] <= n:
+            if vMk == vMk*M:
+                raise ValueError('The morphism has a finite fixed point of length {}.'.format(vMk[position]))
             vMk = vMk*M
             length_of_images.append(vMk)
```


I would suggest that the error message also include the value of `n`. Something like `IndexError: index (=2) out of range, the fixed point is finite and has length 2`.

I think the error should be an `IndexError` instead of `ValueError`, as it is for strings:


```
sage: s = 'ab'                                                                  
sage: s[2]                                                                      
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-2-2d1d9bdb9b26> in <module>
----> 1 s[Integer(2)]

IndexError: string index out of range
```




---

archive/issue_comments_444962.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-16T14:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444962",
    "user": "slabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_444963.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-16T14:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444963",
    "user": "slabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_444964.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-06T09:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444964",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444965.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-06T09:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444965",
    "user": "jlepsova"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_444966.json:
```json
{
    "body": "I solved comment 13 with regard to morphic.py but the issue with infinite_datatype remains.",
    "created_at": "2021-05-06T09:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444966",
    "user": "jlepsova"
}
```

I solved comment 13 with regard to morphic.py but the issue with infinite_datatype remains.



---

archive/issue_comments_444967.json:
```json
{
    "body": "I fixed the remaining issue. Should be okay now.\n\nI added a reference. I need to learn the new way of adding reference to sage...\n----\nNew commits:",
    "created_at": "2021-05-06T09:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444967",
    "user": "slabbe"
}
```

I fixed the remaining issue. Should be okay now.

I added a reference. I need to learn the new way of adding reference to sage...
----
New commits:



---

archive/issue_comments_444968.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-06T10:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444968",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444969.json:
```json
{
    "body": "Fixed the reference.\n\nNeeds review!",
    "created_at": "2021-05-06T10:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444969",
    "user": "slabbe"
}
```

Fixed the reference.

Needs review!



---

archive/issue_comments_444970.json:
```json
{
    "body": "* see patchbot plugins about not using \"Returns\"\n\n* doc does not seem to build (WARNING: Duplicate explicit target name: \"br2010\".)",
    "created_at": "2021-06-07T09:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444970",
    "user": "chapoton"
}
```

* see patchbot plugins about not using "Returns"

* doc does not seem to build (WARNING: Duplicate explicit target name: "br2010".)



---

archive/issue_comments_444971.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-06-24T09:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444971",
    "user": "slabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_444972.json:
```json
{
    "body": "I just did two commits that I pushed on the branch u/slabbe/31378_on_9.4.beta0. I prefer to make sure it works on beta3 since we modify the references/index.rst file, it could be the case that there is a conflict. I am currently building beta3. I will update the branch later.",
    "created_at": "2021-06-24T09:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444972",
    "user": "slabbe"
}
```

I just did two commits that I pushed on the branch u/slabbe/31378_on_9.4.beta0. I prefer to make sure it works on beta3 since we modify the references/index.rst file, it could be the case that there is a conflict. I am currently building beta3. I will update the branch later.



---

archive/issue_comments_444973.json:
```json
{
    "body": "Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444973",
    "user": "mkoeppe"
}
```

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_444974.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-09-30T08:44:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444974",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_444975.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-09-30T08:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444975",
    "user": "slabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_444976.json:
```json
{
    "body": "I rebased everything on top of 9.5.beta0. We will see what the patchbot says now. Needs review.",
    "created_at": "2021-09-30T08:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444976",
    "user": "slabbe"
}
```

I rebased everything on top of 9.5.beta0. We will see what the patchbot says now. Needs review.



---

archive/issue_comments_444977.json:
```json
{
    "body": "`make` finishes with \"Sage build/upgrade complete!\", on my side. So no problems related to the changes in the references list.",
    "created_at": "2021-09-30T08:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444977",
    "user": "slabbe"
}
```

`make` finishes with "Sage build/upgrade complete!", on my side. So no problems related to the changes in the references list.



---

archive/issue_comments_444978.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-09-30T09:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444978",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_444979.json:
```json
{
    "body": "There are a lot of trailing whitespaces.",
    "created_at": "2021-09-30T09:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444979",
    "user": "vdelecroix"
}
```

There are a lot of trailing whitespaces.



---

archive/issue_comments_444980.json:
```json
{
    "body": "What is the purpose of this commented line\n\n```\n         # self._func = callable\n```\n\n\nWhy did you put\n\n```\n+.. [BR2010b] Val\u00e9rie Berth\u00e9 and Michel Rigo, editors. Combinatorics, automata,\n+             and number theory, volume 135. Cambridge: Cambridge University Press, 2010.\n```\n\nafter\n\n```\n \n+.. [Br1910] Bruckner, \"Uber die Ableitung der allgemeinen Polytope und\n+            die nach Isomorphismus verschiedenen Typen der allgemeinen\n+            Achtzelle (Oktatope)\", Verhand. Konik. Akad. Wetenschap,\n+            Erste Sectie, 10 (1910)\n```\n\nWith respect to the lexicographic ordering `Berthe < Bruckner`.",
    "created_at": "2021-09-30T09:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444980",
    "user": "vdelecroix"
}
```

What is the purpose of this commented line

```
         # self._func = callable
```


Why did you put

```
+.. [BR2010b] Valérie Berthé and Michel Rigo, editors. Combinatorics, automata,
+             and number theory, volume 135. Cambridge: Cambridge University Press, 2010.
```

after

```
 
+.. [Br1910] Bruckner, "Uber die Ableitung der allgemeinen Polytope und
+            die nach Isomorphismus verschiedenen Typen der allgemeinen
+            Achtzelle (Oktatope)", Verhand. Konik. Akad. Wetenschap,
+            Erste Sectie, 10 (1910)
```

With respect to the lexicographic ordering `Berthe < Bruckner`.



---

archive/issue_comments_444981.json:
```json
{
    "body": "Are you sure that `Computing the n-th letter of a fixed point is fast`? If the morphism is primitive then I agree but otherwise...",
    "created_at": "2021-09-30T09:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444981",
    "user": "vdelecroix"
}
```

Are you sure that `Computing the n-th letter of a fixed point is fast`? If the morphism is primitive then I agree but otherwise...



---

archive/issue_comments_444982.json:
```json
{
    "body": "Here is an example\n\n```\nsage: s = WordMorphism('0->011,1->1')\nsage: w = s.fixed_point('0')\nsage: w # very stupid word :-)\nword: 0111111111111111111111111111111111111111...\nsage: w.representation(1000000) # now you can wait !!\n```\n\n\nEDIT: Computing the representation is long (because the answer is long) but computing `w[1000000]` should be fast.",
    "created_at": "2021-09-30T09:20:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444982",
    "user": "vdelecroix"
}
```

Here is an example

```
sage: s = WordMorphism('0->011,1->1')
sage: w = s.fixed_point('0')
sage: w # very stupid word :-)
word: 0111111111111111111111111111111111111111...
sage: w.representation(1000000) # now you can wait !!
```


EDIT: Computing the representation is long (because the answer is long) but computing `w[1000000]` should be fast.



---

archive/issue_comments_444983.json:
```json
{
    "body": "More generally, when the growth of `|sigma^n(letter)|` is polynomial (and not exponential) then going via the representation is not a good idea.",
    "created_at": "2021-09-30T09:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444983",
    "user": "vdelecroix"
}
```

More generally, when the growth of `|sigma^n(letter)|` is polynomial (and not exponential) then going via the representation is not a good idea.



---

archive/issue_comments_444984.json:
```json
{
    "body": "Replying to [comment:32 vdelecroix]:\n> More generally, when the growth of `|sigma^n(letter)|` is polynomial (and not exponential) then going via the representation is not a good idea.\n\nWell if the growth rate of the `|sigma^n(letter)|` is quadratic this ticket does an improvement. Here is an example:\n\nOn 9.5.beta0:\n\n\n```\nsage: s = WordMorphism('a->abc,b->bc,c->c')                                     \nsage: w = s.fixed_point('a')                                                    \nsage: %time w[1000000]                                                          \nCPU times: user 6.45 s, sys: 11.5 ms, total: 6.46 s\nWall time: 6.46 s\n'c'\n```\n\n\nOn 9.5.beta0 + #31378:\n\n\n```\nsage: s = WordMorphism('a->abc,b->bc,c->c')                                     \nsage: w = s.fixed_point('a')                                                    \nsage: %time w[1000000]                                                          \nCPU times: user 28.5 ms, sys: 51 \u00b5s, total: 28.6 ms\nWall time: 28.4 ms\n'c'\n```\n\n\nHere it grows quadratically:\n\n\n```\nsage: for i in range(10): u = s('a', i); print(len(u), u)                       \n1 a\n3 abc\n6 abcbcc\n10 abcbccbccc\n15 abcbccbcccbcccc\n21 abcbccbcccbccccbccccc\n28 abcbccbcccbccccbcccccbcccccc\n36 abcbccbcccbccccbcccccbccccccbccccccc\n45 abcbccbcccbccccbcccccbccccccbcccccccbcccccccc\n55 abcbccbcccbccccbcccccbccccccbcccccccbccccccccbccccccccc\n```\n\n\nThe problem is when the images grow linearly. Question: can we detect that?",
    "created_at": "2021-09-30T09:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444984",
    "user": "slabbe"
}
```

Replying to [comment:32 vdelecroix]:
> More generally, when the growth of `|sigma^n(letter)|` is polynomial (and not exponential) then going via the representation is not a good idea.

Well if the growth rate of the `|sigma^n(letter)|` is quadratic this ticket does an improvement. Here is an example:

On 9.5.beta0:


```
sage: s = WordMorphism('a->abc,b->bc,c->c')                                     
sage: w = s.fixed_point('a')                                                    
sage: %time w[1000000]                                                          
CPU times: user 6.45 s, sys: 11.5 ms, total: 6.46 s
Wall time: 6.46 s
'c'
```


On 9.5.beta0 + #31378:


```
sage: s = WordMorphism('a->abc,b->bc,c->c')                                     
sage: w = s.fixed_point('a')                                                    
sage: %time w[1000000]                                                          
CPU times: user 28.5 ms, sys: 51 µs, total: 28.6 ms
Wall time: 28.4 ms
'c'
```


Here it grows quadratically:


```
sage: for i in range(10): u = s('a', i); print(len(u), u)                       
1 a
3 abc
6 abcbcc
10 abcbccbccc
15 abcbccbcccbcccc
21 abcbccbcccbccccbccccc
28 abcbccbcccbccccbcccccbcccccc
36 abcbccbcccbccccbcccccbccccccbccccccc
45 abcbccbcccbccccbcccccbccccccbcccccccbcccccccc
55 abcbccbcccbccccbcccccbccccccbcccccccbccccccccbccccccccc
```


The problem is when the images grow linearly. Question: can we detect that?



---

archive/issue_comments_444985.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-09-30T10:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444985",
    "user": "vdelecroix"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_444986.json:
```json
{
    "body": "The answer is yes, see #32594.\n\nWe can do that later on.",
    "created_at": "2021-09-30T10:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444986",
    "user": "vdelecroix"
}
```

The answer is yes, see #32594.

We can do that later on.



---

archive/issue_comments_444987.json:
```json
{
    "body": "Sorry : you should fix trailing whitespaces.",
    "created_at": "2021-09-30T10:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444987",
    "user": "vdelecroix"
}
```

Sorry : you should fix trailing whitespaces.



---

archive/issue_comments_444988.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-09-30T10:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444988",
    "user": "vdelecroix"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_444989.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-30T15:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444989",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444990.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-09-30T15:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444990",
    "user": "slabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_444991.json:
```json
{
    "body": "I think the issue with trailing whitespaces was mainly with file morphic.py. I removed those from that file.",
    "created_at": "2021-09-30T15:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444991",
    "user": "slabbe"
}
```

I think the issue with trailing whitespaces was mainly with file morphic.py. I removed those from that file.



---

archive/issue_comments_444992.json:
```json
{
    "body": "there are more in `morphism.py`.",
    "created_at": "2021-09-30T16:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444992",
    "user": "vdelecroix"
}
```

there are more in `morphism.py`.



---

archive/issue_comments_444993.json:
```json
{
    "body": "Do you want me to remove all of the trailing whitespaces in the file, or only those in lines that were changed?",
    "created_at": "2021-09-30T18:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444993",
    "user": "slabbe"
}
```

Do you want me to remove all of the trailing whitespaces in the file, or only those in lines that were changed?



---

archive/issue_comments_444994.json:
```json
{
    "body": "That is fine with me either way.",
    "created_at": "2021-09-30T20:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444994",
    "user": "vdelecroix"
}
```

That is fine with me either way.



---

archive/issue_comments_444995.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-07T08:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444995",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444996.json:
```json
{
    "body": "I fixed the 2 trailing whitespaces in the file morphism.py that were added in previous commit on this ticket.",
    "created_at": "2021-10-07T08:12:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444996",
    "user": "slabbe"
}
```

I fixed the 2 trailing whitespaces in the file morphism.py that were added in previous commit on this ticket.



---

archive/issue_comments_444997.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-07T19:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444997",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_444998.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-10T10:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31141#issuecomment-444998",
    "user": "vbraun"
}
```

Resolution: fixed
