# Issue 15090: More minor tableau and skew_tableau optimizations, and moving out attacking_pairs

Issue created by migration from Trac.

Original creator: darij

Original creation time: 2013-10-26 00:53:41

CC:  tscrim sage-combinat aschilling nthiery

Keywords: sage-combinat, tableau, partition, skew tableau

This patch brings some little speedups on tableaux and skew tableaux, in particular copying over the #15269 fixes to `skew_tableau.py`. It also modifies the semantics of the `to_chain` function so as to allow an optional `max_entry` parameter (which makes it return a chain of a given length -- useful if one is considering semistandard tableaux with ceiling higher than the highest entry). Furthermore it moves the `attacking_pairs` method from `tableau.py` to `partition.py`, and deprecates it in `tableau.py`. In the only place where this method is used, it is factored in for speed reasons.

Patch to come in 20 minutes.


---

Attachment


---

Comment by darij created at 2013-10-26 01:57:00

Ready for review.

The `restriction_shape` method has been introduced in `tableau.py` because it is at least twice faster than `restrict(i).shape()` (probably due to the hackery with exceptions in the latter) and the shape of the restriction seems to be used more often than the restriction itself. The `restriction_outer_shape` method in `skew_tableau.py` is arguably less useful (it is only about 20% faster than `restrict(i).outer_shape()` in the cases I checked) and I will remove it if you think it clutters up stuff.

Some of the doc bugs fixed here are due to me *oops*.


---

Comment by darij created at 2013-10-26 01:57:19

Changing status from new to needs_review.


---

Attachment

Hey Darij,

Here's a review patch which does:

- some docstring tweaks,
- adds a method `restriction_shape()` to `skew_tableau.py` (which how it's done is [much] faster than the direct implementation I tried),
- and does some minor speedup to the creation of `SkewPartition`.

Before:

```
sage: %timeit skp = SkewPartition([[3,2,1],[2,1]])
10000 loops, best of 3: 184 us per loop
sage: %timeit skp = SkewPartition([[3,2,1],[2,1]])
1000 loops, best of 3: 178 us per loop
```

With patch:

```
sage: %timeit skp = SkewPartition([[3,2,1],[2,1]])
10000 loops, best of 3: 115 us per loop
sage: %timeit skp = SkewPartition([[3,2,1],[2,1]])
1000 loops, best of 3: 112 us per loop
```


If you're happy with my changes, then you can go ahead and set this to positive review.

Best,

Travis


---

Attachment


---

Comment by darij created at 2013-10-27 17:08:31

Thanks a lot!! Pro forma, I'll let you set the positive_review mark since I added two chains...

for the *patchbot*:

apply trac_15327-tableaux-improvements-dg.patchâ€‹ trac_15327-review-ts.patch trac_15327-revrev-dg.patch


---

Comment by tscrim created at 2013-10-27 17:41:15

> two chains

XP

Positive review then. Could you fold the 3 patches together and re-upload?

Thanks,

Travis


---

Comment by tscrim created at 2013-10-27 17:41:15

Changing status from needs_review to positive_review.


---

Attachment

qfold of the patches in this ticket


---

Comment by darij created at 2013-10-27 21:13:52

Thank you again -- done. And yes, my ability to make typos while fixing them is uncontested.

for the *patchbot*:

apply trac_15327-qfold-dg.patch


---

Comment by darij created at 2013-10-30 00:59:36

Changing status from positive_review to needs_work.


---

Comment by darij created at 2013-10-30 01:25:58

Changing status from needs_work to needs_review.


---

Attachment

I wish it had been just typos. There were two major oopses in my version of the `inversions` method. Should be fixed now (speed improvement is still there). Now it probably needs review again, but at least that should be easy...

for the *patchbot*:

apply trac_15327-qfold-dg.patch trac_15327-fixes-dg.patch


---

Comment by tscrim created at 2013-10-31 05:32:10

I feel bad for not catching the errors on the first go-around. Back to positive review.


---

Comment by tscrim created at 2013-10-31 05:32:10

Changing status from needs_review to positive_review.


---

Comment by darij created at 2013-10-31 05:34:44

Thanks a lot for your patience, and no problem -- I should feel worse for making them in the first place!


---

Comment by jdemeyer created at 2013-11-06 12:50:37

Resolution: fixed
