# Issue 22757: Use permutation implementation of Weyl groups to compute LS path energy

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2017-05-13 21:17:25

CC:  sage-combinat aschilling bsalisbury1

Keywords: crystals, energy function

This is an implementation detail, so let's use the fastest version of the Weyl group to compute the parabolic quantum Bruhat graph.


---

Comment by tscrim created at 2017-05-13 21:32:35

With branch:

```
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 72 ms, sys: 4 ms, total: 76 ms
Wall time: 71.2 ms
[0]
sage: La = RootSystem(['E',6,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[3])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 288 ms, sys: 16 ms, total: 304 ms
Wall time: 281 ms
[0]
```

Before:

```
sage: La = RootSystem(['D',5,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[3])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 1.5 s, sys: 60 ms, total: 1.56 s
Wall time: 1.61 s
[0]
sage: La = RootSystem(['E',6,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[3])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 16.9 s, sys: 20 ms, total: 16.9 s
Wall time: 16.9 s
[0]
```

(Be warned, you might also have the GAP startup time in the initial computation.)
----
New commits:


---

Comment by tscrim created at 2017-05-13 21:32:35

Changing status from new to needs_review.


---

Comment by git created at 2017-05-13 22:05:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-05-13 22:07:04

I found some more speed by iterating over the weight orbit rather than building the full list:

```
sage: La = RootSystem(['E',7,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[4])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 10.3 s, sys: 52 ms, total: 10.3 s
Wall time: 10.4 s
[0]
```

vs old:

```
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 10.3 s, sys: 52 ms, total: 10.3 s
Wall time: 12.1 s
[0]
```



---

Comment by bsalisbury1 created at 2017-05-15 20:01:49

All documentation builds (both PDF and HTML) on my machine, but here is the output of `make ptestalllong`:


```
----------------------------------------------------------------------
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py  # 7 doctests failed
sage -t --long --warn-long 41.4 src/sage/plot/plot.py  # 1 doctest failed
sage -t --long --warn-long 41.4 src/sage/plot/graphics.py  # 2 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/root_lattice_realizations.py  # 13 doctests failed
sage -t --long --warn-long 41.4 src/sage/tests/book_schilling_zabrocki_kschur_primer.py  # 5 doctests failed
sage -t --long --warn-long 41.4 src/sage/tests/cmdline.py  # 9 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/sf/k_dual.py  # 22 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/pieri_factors.py  # 56 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/crystals/affine_factorization.py  # 58 doctests failed
sage -t --long --warn-long 41.4 src/sage/categories/weyl_groups.py  # 26 doctests failed
sage -t --long --warn-long 41.4 src/sage/algebras/nil_coxeter_algebra.py  # 4 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/sf/sf.py  # 1 doctest failed
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/weyl_characters.py  # 9 doctests failed
sage -t --long --warn-long 41.4 src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 6648.5 seconds
    cpu time: 11823.2 seconds
    cumulative wall time: 25930.4 seconds
```



---

Comment by git created at 2017-05-15 20:11:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-05-15 20:11:57

*facepalm* I need to actually call the iterator function. I also used it in two other places where I could.


---

Comment by bsalisbury1 created at 2017-05-16 19:14:37

Everything looks good now (at least on my machine).


---

Comment by bsalisbury1 created at 2017-05-16 19:14:37

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2017-05-16 20:32:27

"it as 6 elements" ?


---

Comment by git created at 2017-05-16 21:06:12

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2017-05-16 21:06:12

Changing status from positive_review to needs_review.


---

Comment by tscrim created at 2017-05-16 21:07:09

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-05-16 21:07:09

Didn't even notice it because I wasn't really reading it. Fixed, and I'm allowing myself to reset to positive review because it is a trivial change.


---

Comment by vbraun created at 2017-05-18 16:39:04

Resolution: fixed
