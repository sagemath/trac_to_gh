# Issue 22757: Use permutation implementation of Weyl groups to compute LS path energy

archive/issues_022757.json:
```json
{
    "body": "CC:  sage-combinat aschilling bsalisbury1\n\nKeywords: crystals, energy function\n\nThis is an implementation detail, so let's use the fastest version of the Weyl group to compute the parabolic quantum Bruhat graph.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22994\n\n",
    "created_at": "2017-05-13T21:17:25Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "title": "Use permutation implementation of Weyl groups to compute LS path energy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22757",
    "user": "tscrim"
}
```
CC:  sage-combinat aschilling bsalisbury1

Keywords: crystals, energy function

This is an implementation detail, so let's use the fastest version of the Weyl group to compute the parabolic quantum Bruhat graph.

Issue created by migration from https://trac.sagemath.org/ticket/22994





---

archive/issue_comments_317963.json:
```json
{
    "body": "With branch:\n\n```\nsage: %time [mg.energy_function() for mg in B.module_generators]\nCPU times: user 72 ms, sys: 4 ms, total: 76 ms\nWall time: 71.2 ms\n[0]\nsage: La = RootSystem(['E',6,1]).weight_space().fundamental_weights()\nsage: B = crystals.ProjectedLevelZeroLSPaths(La[3])\nsage: %time [mg.energy_function() for mg in B.module_generators]\nCPU times: user 288 ms, sys: 16 ms, total: 304 ms\nWall time: 281 ms\n[0]\n```\n\nBefore:\n\n```\nsage: La = RootSystem(['D',5,1]).weight_space().fundamental_weights()\nsage: B = crystals.ProjectedLevelZeroLSPaths(La[3])\nsage: %time [mg.energy_function() for mg in B.module_generators]\nCPU times: user 1.5 s, sys: 60 ms, total: 1.56 s\nWall time: 1.61 s\n[0]\nsage: La = RootSystem(['E',6,1]).weight_space().fundamental_weights()\nsage: B = crystals.ProjectedLevelZeroLSPaths(La[3])\nsage: %time [mg.energy_function() for mg in B.module_generators]\nCPU times: user 16.9 s, sys: 20 ms, total: 16.9 s\nWall time: 16.9 s\n[0]\n```\n\n(Be warned, you might also have the GAP startup time in the initial computation.)\n----\nNew commits:",
    "created_at": "2017-05-13T21:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317963",
    "user": "tscrim"
}
```

With branch:

```
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 72 ms, sys: 4 ms, total: 76 ms
Wall time: 71.2 ms
[0]
sage: La = RootSystem(['E',6,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[3])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 288 ms, sys: 16 ms, total: 304 ms
Wall time: 281 ms
[0]
```

Before:

```
sage: La = RootSystem(['D',5,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[3])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 1.5 s, sys: 60 ms, total: 1.56 s
Wall time: 1.61 s
[0]
sage: La = RootSystem(['E',6,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[3])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 16.9 s, sys: 20 ms, total: 16.9 s
Wall time: 16.9 s
[0]
```

(Be warned, you might also have the GAP startup time in the initial computation.)
----
New commits:



---

archive/issue_comments_317964.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-13T21:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317964",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_317965.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-13T22:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317965",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_317966.json:
```json
{
    "body": "I found some more speed by iterating over the weight orbit rather than building the full list:\n\n```\nsage: La = RootSystem(['E',7,1]).weight_space().fundamental_weights()\nsage: B = crystals.ProjectedLevelZeroLSPaths(La[4])\nsage: %time [mg.energy_function() for mg in B.module_generators]\nCPU times: user 10.3 s, sys: 52 ms, total: 10.3 s\nWall time: 10.4 s\n[0]\n```\n\nvs old:\n\n```\nsage: %time [mg.energy_function() for mg in B.module_generators]\nCPU times: user 10.3 s, sys: 52 ms, total: 10.3 s\nWall time: 12.1 s\n[0]\n```\n",
    "created_at": "2017-05-13T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317966",
    "user": "tscrim"
}
```

I found some more speed by iterating over the weight orbit rather than building the full list:

```
sage: La = RootSystem(['E',7,1]).weight_space().fundamental_weights()
sage: B = crystals.ProjectedLevelZeroLSPaths(La[4])
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 10.3 s, sys: 52 ms, total: 10.3 s
Wall time: 10.4 s
[0]
```

vs old:

```
sage: %time [mg.energy_function() for mg in B.module_generators]
CPU times: user 10.3 s, sys: 52 ms, total: 10.3 s
Wall time: 12.1 s
[0]
```




---

archive/issue_comments_317967.json:
```json
{
    "body": "All documentation builds (both PDF and HTML) on my machine, but here is the output of `make ptestalllong`:\n\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 41.4 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py  # 7 doctests failed\nsage -t --long --warn-long 41.4 src/sage/plot/plot.py  # 1 doctest failed\nsage -t --long --warn-long 41.4 src/sage/plot/graphics.py  # 2 doctests failed\nsage -t --long --warn-long 41.4 src/sage/combinat/root_system/root_lattice_realizations.py  # 13 doctests failed\nsage -t --long --warn-long 41.4 src/sage/tests/book_schilling_zabrocki_kschur_primer.py  # 5 doctests failed\nsage -t --long --warn-long 41.4 src/sage/tests/cmdline.py  # 9 doctests failed\nsage -t --long --warn-long 41.4 src/sage/combinat/sf/k_dual.py  # 22 doctests failed\nsage -t --long --warn-long 41.4 src/sage/combinat/root_system/pieri_factors.py  # 56 doctests failed\nsage -t --long --warn-long 41.4 src/sage/combinat/crystals/affine_factorization.py  # 58 doctests failed\nsage -t --long --warn-long 41.4 src/sage/categories/weyl_groups.py  # 26 doctests failed\nsage -t --long --warn-long 41.4 src/sage/algebras/nil_coxeter_algebra.py  # 4 doctests failed\nsage -t --long --warn-long 41.4 src/sage/combinat/sf/sf.py  # 1 doctest failed\nsage -t --long --warn-long 41.4 src/sage/combinat/root_system/weyl_characters.py  # 9 doctests failed\nsage -t --long --warn-long 41.4 src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 6648.5 seconds\n    cpu time: 11823.2 seconds\n    cumulative wall time: 25930.4 seconds\n```\n",
    "created_at": "2017-05-15T20:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317967",
    "user": "bsalisbury1"
}
```

All documentation builds (both PDF and HTML) on my machine, but here is the output of `make ptestalllong`:


```
----------------------------------------------------------------------
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py  # 7 doctests failed
sage -t --long --warn-long 41.4 src/sage/plot/plot.py  # 1 doctest failed
sage -t --long --warn-long 41.4 src/sage/plot/graphics.py  # 2 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/root_lattice_realizations.py  # 13 doctests failed
sage -t --long --warn-long 41.4 src/sage/tests/book_schilling_zabrocki_kschur_primer.py  # 5 doctests failed
sage -t --long --warn-long 41.4 src/sage/tests/cmdline.py  # 9 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/sf/k_dual.py  # 22 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/pieri_factors.py  # 56 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/crystals/affine_factorization.py  # 58 doctests failed
sage -t --long --warn-long 41.4 src/sage/categories/weyl_groups.py  # 26 doctests failed
sage -t --long --warn-long 41.4 src/sage/algebras/nil_coxeter_algebra.py  # 4 doctests failed
sage -t --long --warn-long 41.4 src/sage/combinat/sf/sf.py  # 1 doctest failed
sage -t --long --warn-long 41.4 src/sage/combinat/root_system/weyl_characters.py  # 9 doctests failed
sage -t --long --warn-long 41.4 src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 6648.5 seconds
    cpu time: 11823.2 seconds
    cumulative wall time: 25930.4 seconds
```




---

archive/issue_comments_317968.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-15T20:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317968",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_317969.json:
```json
{
    "body": "*facepalm* I need to actually call the iterator function. I also used it in two other places where I could.",
    "created_at": "2017-05-15T20:11:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317969",
    "user": "tscrim"
}
```

*facepalm* I need to actually call the iterator function. I also used it in two other places where I could.



---

archive/issue_comments_317970.json:
```json
{
    "body": "Everything looks good now (at least on my machine).",
    "created_at": "2017-05-16T19:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317970",
    "user": "bsalisbury1"
}
```

Everything looks good now (at least on my machine).



---

archive/issue_comments_317971.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-16T19:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317971",
    "user": "bsalisbury1"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_317972.json:
```json
{
    "body": "\"it as 6 elements\" ?",
    "created_at": "2017-05-16T20:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317972",
    "user": "chapoton"
}
```

"it as 6 elements" ?



---

archive/issue_comments_317973.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-05-16T21:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317973",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_317974.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-05-16T21:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317974",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_317975.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-16T21:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317975",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_317976.json:
```json
{
    "body": "Didn't even notice it because I wasn't really reading it. Fixed, and I'm allowing myself to reset to positive review because it is a trivial change.",
    "created_at": "2017-05-16T21:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317976",
    "user": "tscrim"
}
```

Didn't even notice it because I wasn't really reading it. Fixed, and I'm allowing myself to reset to positive review because it is a trivial change.



---

archive/issue_comments_317977.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-18T16:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22757#issuecomment-317977",
    "user": "vbraun"
}
```

Resolution: fixed
