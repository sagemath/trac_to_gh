# Issue 25166: Random regular bipartite graph generator

Issue created by migration from Trac.

Original creator: dcoudert

Original creation time: 2018-05-19 17:34:32

Add a generator of random regular bipartite graph.


---

Comment by dcoudert created at 2018-05-19 18:12:47

Changing status from new to needs_review.


---

Comment by dcoudert created at 2018-05-19 18:12:47

New commits:


---

Comment by @bryangingechen created at 2018-07-24 23:54:51

Hello, this is my first attempt to review a patch... feel free to let me know if any of these suggestions are inappropriate or out of scope!

First, am I correct that `RandomRegularBipartite` does not sample uniformly from the set of random regular bipartite graphs with the given sizes and degrees? If this is the case, then the documentation for this function should make it more clear what the sampled distribution is. 

Second, would you mind adding documentation (and possibly tests) for the position dictionaries generated by `RandomBipartite` and `RandomRegularBipartite`?

I also noticed that the only other random graph generator which assigns positions is `RandomTriangulation` and it only does so if the parameter `set_position` is explicitly set to `True`. Should these two functions thus also be given a `set_position` parameter for consistency?

Finally, the name given to the graph generated by `RandomRegularBipartite` could be made more informative, perhaps something like:

```python
name="Random regular bipartite graph of size {}+{} with degrees {} and {}".format(n1, n2, d1, d2)
```



---

Comment by git created at 2018-07-25 11:18:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 11:21:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 11:41:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-07-25 11:44:35

Thank you for reviewing this ticket. It helps a lot.

I have implemented all your comments. For `RandomTriangulation`, the time to compute the positions of vertices is non negligible (planar embedding). Here, it's quite cheap, but I agree that in many cases we don't need it.

Don't forget to put your real name in the field "Reviewers"


---

Comment by @bryangingechen created at 2018-07-25 14:51:23

Thanks for making the changes! It seems however there is some issue with the tests. After checking out your branch and building, `sage -t src/sage/graphs/generators/random.py` fails with a timeout. It seems the culprit is:



```python
sage: graphs.RandomRegularBipartite(2, 3, 3, set_position=True).get_pos() ## line 318 ##
```


This particular graph must be complete bipartite, so perhaps there is some issue when generating these. In the complete bipartite case (`d1 == n2`) maybe the edge generation should just be made deterministic.

Finally, it would probably be more helpful to users if the coordinates of the positions were included in the docstring in addition to the code comments.


---

Comment by @bryangingechen created at 2018-07-25 14:51:44

Changing status from needs_review to needs_work.


---

Comment by dcoudert created at 2018-07-25 15:10:51

It's more complicated than that. If found other situations like `graphs.RandomRegularBipartite(6, 6, 5, set_position=True)` that can loop endlessly :(
So we need another, more secured, algorithms...


---

Comment by git created at 2018-07-29 13:05:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-29 13:11:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-07-29 13:12:40

This new version should perform better.


---

Comment by dcoudert created at 2018-07-29 14:59:29

Changing status from needs_work to needs_review.


---

Comment by git created at 2018-07-31 12:05:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @bryangingechen created at 2018-07-31 12:23:14

Hi, I went ahead and pushed some changes to this branch:

- I had a look at the reference [MW1990]. Thanks for taking the time to implement much of their algorithm! However, I noticed that your implementation did not include the (indeed, rather complicated) probabilistic check to restart in their "NODOUBLES" function. For now, I have simply made a change to the docstring to point out that the generated graph is not uniformly random.
- I added a check on the maximum degree to the function (plus a note in the docstring and a doctest).
- I fixed a typo: `retart` instead of `restart`.
- I added information about the positions to the docstring. Also, I'm not sure if we need to do anything about this, but I figured I would point out here that the positions added by this ticket are inconsistent with the position generated by `sage.graphs.CompleteBipartiteGraph`. That function places the two parts horizontally and also uses differently scaled spacing.
- I fixed some other typos in the comments and docstrings and combined some imports into one line.

Everything else seemed OK, so you may set to positive_review if you're happy with my changes.
----
New commits:


---

Comment by dcoudert created at 2018-07-31 15:17:07

Thank you for all the corrections.

For the consistency of positions, what I can do is add a method in `graph_plot.py` for bipartite embedding, like `_bipartite_embedding(g, V1, V2, first=(0,1), last=(1,0))` in the flavor of `_line_embedding`, and then use it in all bipartite graphs generators.
It can proceed as the plotting of `CompleteBipartiteGraph`.
Would you agree on that ?


---

Comment by @bryangingechen created at 2018-07-31 15:24:42

Replying to [comment:16 dcoudert]:
> For the consistency of positions, what I can do is add a method in `graph_plot.py` for bipartite embedding, like `_bipartite_embedding(g, V1, V2, first=(0,1), last=(1,0))` in the flavor of `_line_embedding`, and then use it in all bipartite graphs generators.
> It can proceed as the plotting of `CompleteBipartiteGraph`.
> Would you agree on that ?

I wasn't familiar with those methods in `graph_plot`, but this sounds like a great solution! We should probably update the ticket title / description now though.


---

Comment by @bryangingechen created at 2018-07-31 15:30:11

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-07-31 16:58:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-07-31 17:07:45

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2018-07-31 17:07:45

I have chosen not to create a new method in `graph_plot.py` as the need for bipartite embedding is rather limited so far. I use 2 calls to `_line_embedding` instead.

I have corrected the method for `_line_embedding` to avoid errors with graphs on 0 or 1 vertex.


---

Comment by git created at 2018-07-31 19:11:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-31 20:56:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @bryangingechen created at 2018-07-31 20:58:03

I removed a trailing whitespace and fixed a doctest that was broken by the change to graph name inside `CompleteBipartiteGraph`. Feel free to set to positive_review after you see this.


---

Comment by dcoudert created at 2018-07-31 21:14:05

So then. Thanks.


---

Comment by dcoudert created at 2018-07-31 21:14:05

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-05 08:18:14

Resolution: fixed
