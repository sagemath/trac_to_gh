# Issue 26397: clean generic_graph.py (part 5)

Issue created by migration from https://trac.sagemath.org/ticket/26634

Original creator: dcoudert

Original creation time: 2018-11-04 16:44:07

CC:  tscrim

Keywords: py3, graph

Here, we improve methods `antisymmetric`, `transitive_closure`, `is_transitively_reduced` and `transitive_reduction`. In particular, we add parameter `loops` to `transitive_closure` to control the addition of loops to the resulting graph (e.g., add a loop to u if u belongs to a directed cycle).


---

Comment by dcoudert created at 2018-11-04 16:45:14

New commits:


---

Comment by dcoudert created at 2018-11-04 16:45:14

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-11-05 02:30:56

I do not understand why there should be a `loops` for `transitive_closure()`. It does not seem well-defined or useful.


---

Comment by dcoudert created at 2018-11-05 08:38:41

You are right and I should change that but I don't know what would be a good way to handle graphs with loops: remove loops ? put loops everywhere ? keep existing loops only ?


---

Comment by tscrim created at 2018-11-05 13:45:58

I would either just keep existing loops or raise an error. One could make the case for removing loops too, but I would rather just keep what is there.


---

Comment by git created at 2018-11-05 18:00:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-11-05 18:04:35

Would that be better ? Roughly: if the graph has loops, either we let them in the transitive closure (`loops=True`) or we remove them from the transitive closure (`loops=False`).

Before this patch, a loop was added to each vertex of the the transitive closure of a graph without loops but allowing loops.


---

Comment by dcoudert created at 2018-11-13 12:15:10

Tested over 8.5.beta3.


---

Comment by tscrim created at 2018-11-13 14:06:35

Sorry, I have been really busy and can only do a few quick things with Sage right now. I am keeping track of the larger changes you are doing and plan to review them all.

Thinking a little bit more, I think adding a loop to every vertex might be the most reasonable definition of the transitive closure of a graph that allows loops. I do not think removing loops is a good way to do it as the transitive closure should always contain the original graph as an induced subgraph. So perhaps there is some fringe benefit to having a `loops` option, but I am more inclined to keep the current behavior. If you wanted a graph with loops, you would have already created a graph allowing loops. However, this behavior should be well-documented.


---

Comment by git created at 2018-11-13 17:32:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-11-13 17:38:18

I have reverted `transitive_closure` to it's initial behavior but added a clear note about loops, plus examples. I have also added an example in `antisymmetric` to show the that loops in directed graphs are ignored.

PS: I really understand time constraints, busy schedule and heavy load :(


---

Comment by git created at 2018-12-04 20:50:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-12-04 20:52:42

I have rebased this ticket on 8.5.beta6. The patchbot was complaining so it may help it...


---

Comment by chapoton created at 2018-12-06 20:33:50

ok, let it be


---

Comment by chapoton created at 2018-12-06 20:33:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-12-08 02:54:29

Resolution: fixed
