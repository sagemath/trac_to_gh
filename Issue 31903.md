# Issue 31903: Fix some escape sequences in padics

Issue created by migration from https://trac.sagemath.org/ticket/32140

Original creator: tscrim

Original creation time: 2021-07-06 02:24:50

CC:  roed

Some latex stuff like `QQ_p` not being in `r"""` strings. Some other documentation cleanup.


---

Comment by tscrim created at 2021-07-06 02:25:23

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-07-06 02:25:23

New commits:


---

Comment by git created at 2021-07-06 02:34:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-07-06 02:38:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-06 18:33:12

Changing priority from major to critical.


---

Comment by mkoeppe created at 2021-07-06 18:33:12

Setting it to "critical" as these deprecation warnings have been quite annoying.



```
sage -t --random-seed=0 src/sage/rings/padics/padic_ext_element.pyx
**********************************************************************
File "src/sage/rings/padics/padic_ext_element.pyx", line 449, in sage.rings.padics.padic_ext_element.pAdicExtElement.residue
Failed example:
    a.residue(2)
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError: reduction modulo p^n with n>1
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.padics.padic_ext_element.pAdicExtElement.residue[4]>", line 1, in <module>
        a.residue(Integer(2))
      File "sage/rings/padics/padic_template_element.pxi", line 742, in sage.rings.padics.qadic_flint_CA.pAdicTemplateElement.residue
        raise NotImplementedError("reduction modulo p^n with n>1.")
    NotImplementedError: reduction modulo p^n with n>1.
**********************************************************************
File "src/sage/rings/padics/padic_ext_element.pyx", line 471, in sage.rings.padics.padic_ext_element.pAdicExtElement.residue
Failed example:
    (a/3).residue(0)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: element must have non-negative valuation in order to compute residue
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.padics.padic_ext_element.pAdicExtElement.residue[13]>", line 1, in <module>
        (a/Integer(3)).residue(Integer(0))
      File "sage/rings/padics/padic_template_element.pxi", line 725, in sage.rings.padics.qadic_flint_CR.pAdicTemplateElement.residue
        raise ValueError("element must have non-negative valuation in order to compute residue.")
    ValueError: element must have non-negative valuation in order to compute residue.
**********************************************************************
```



---

Comment by mkoeppe created at 2021-07-06 18:33:12

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-07-07 00:58:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-07-07 01:02:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2021-07-07 01:03:36

I found a few more issues and did some more documentation cleanup along the way. I went through and made all of the error messages use the Python format. Hopefully I have caught all of them.


---

Comment by tscrim created at 2021-07-07 01:03:36

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-07-07 02:48:40

I'm getting another

```
sage -t --random-seed=0 src/sage/rings/padics/padic_template_element.pxi
**********************************************************************
File "src/sage/rings/padics/padic_template_element.pxi", line 508, in sage.rings.padics.padic_template_element.pAdicTemplateElement.expansion
Failed example:
    E = EllipticCurve('37a')
Expected nothing
Got:
    doctest:warning
    DeprecationWarning: invalid escape sequence \G
```



---

Comment by git created at 2021-07-07 03:33:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2021-07-07 03:33:45

I fixed this by cleaning up the documentation of the corresponding elliptic curve class.


---

Comment by mkoeppe created at 2021-07-07 04:40:18

The backslash there looks like a typo

```
@@ -4022,7 +4011,7 @@ class EllipticCurve_rational_field(EllipticCurve_number_field):
             self.__torsion_order = self.torsion_subgroup().order()
             return self.__torsion_order
 
-    def _torsion_bound(self,number_of_places = 20):
+    def _torsion_bound(self, number_of_places\=20):
         r"""
         Compute an upper bound on the order of the torsion group of the
         elliptic curve by counting points modulo several primes of good
```



---

Comment by mkoeppe created at 2021-07-07 04:44:52

Also `./sage -tox -e codespell -- src/sage/rings/padics/` finds a bunch of misspellings


---

Comment by mkoeppe created at 2021-07-07 04:58:20

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-07-07 04:59:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2021-07-07 04:59:52

Fixed the errant `/` and I corrected the `tox` output that was reported to me (that was not a shortened variable name `hist`).


---

Comment by tscrim created at 2021-07-07 04:59:52

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-07-07 05:36:33

This now passes tests, the HTML documentation builds OK; and scrolling through the documentation I did not spot any obvious flaws.

Setting it to positive review, but an expert may want to take a look


---

Comment by mkoeppe created at 2021-07-07 05:36:33

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2021-07-07 05:39:19

Thank you!


---

Comment by vbraun created at 2021-07-09 23:29:05

test failures


---

Comment by vbraun created at 2021-07-09 23:29:05

Changing status from positive_review to needs_work.


---

Comment by git created at 2021-07-11 23:14:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2021-07-11 23:14:28

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2021-07-11 23:14:28

Trivial fix of output.


---

Comment by mkoeppe created at 2021-07-12 00:04:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-07-23 20:11:45

Resolution: fixed
