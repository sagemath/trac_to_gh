# Issue 14140: Fix packages test

archive/issues_014140.json:
```json
{
    "body": "Assignee: mvngu\n\nCC:  @kini @jhpalmieri\n\nHere is a request from a [sage-devel thread](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/cffoTAv0Zxo):\n\n```\n\nThe following test fails because I have some optional packages installed - \n\n$ sage -t  --long -force_lib devel/sage/sage/misc/package.py \nsage -t --long -force_lib \"devel/sage/sage/misc/package.py\" \n********************************************************************** \nFile \"/home/rajeev/software/general/sage/devel/sage/sage/misc/package.py\", \nline 119: \n    sage: install_package() \nExpected: \n    ['atlas...', 'blas...', ...] \nGot: \n    ['PyQt_x11-4.9.1.p0', 'atlas-3.8.4.p1', 'blas-20070724', \n'boehm_gc-7.2.alpha6.p2', 'boost-cropped-1.34.1', \n```\n\n\nThe consensus seemed to be simply adding more ellipses.\n\n\n```\n> Just add periods *before* 'atlas...' as well. \n\nAnd after it (between 'atlas...' and 'blas...'), just in case. Maybe something like\n\n        ['atlas...', ..., 'python...', ...]\n \nThis is a better idea, IMO. \n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/14344\n\n",
    "created_at": "2013-03-23T01:04:07Z",
    "labels": [
        "component: doctest coverage",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Fix packages test",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14140",
    "user": "https://github.com/kcrisman"
}
```
Assignee: mvngu

CC:  @kini @jhpalmieri

Here is a request from a [sage-devel thread](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/cffoTAv0Zxo):

```

The following test fails because I have some optional packages installed - 

$ sage -t  --long -force_lib devel/sage/sage/misc/package.py 
sage -t --long -force_lib "devel/sage/sage/misc/package.py" 
********************************************************************** 
File "/home/rajeev/software/general/sage/devel/sage/sage/misc/package.py", 
line 119: 
    sage: install_package() 
Expected: 
    ['atlas...', 'blas...', ...] 
Got: 
    ['PyQt_x11-4.9.1.p0', 'atlas-3.8.4.p1', 'blas-20070724', 
'boehm_gc-7.2.alpha6.p2', 'boost-cropped-1.34.1', 
```


The consensus seemed to be simply adding more ellipses.


```
> Just add periods *before* 'atlas...' as well. 

And after it (between 'atlas...' and 'blas...'), just in case. Maybe something like

        ['atlas...', ..., 'python...', ...]
 
This is a better idea, IMO. 
```


Issue created by migration from https://trac.sagemath.org/ticket/14344





---

archive/issue_comments_177191.json:
```json
{
    "body": "Here's a patch.",
    "created_at": "2013-03-23T01:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177191",
    "user": "https://github.com/kini"
}
```

Here's a patch.



---

archive/issue_comments_177192.json:
```json
{
    "body": "This patch isn't compatible with #10508, and goodness knows that ticket doesn't need any more dependencies... is it okay to ask to rebase to a \"needs work\" ticket?   Maybe the version with `python` as John suggested?   Or the filter version you mentioned in the relevant thread, if you think that one is better (though perhaps it's harder to understand what it's doing).",
    "created_at": "2013-03-23T02:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177192",
    "user": "https://github.com/kcrisman"
}
```

This patch isn't compatible with #10508, and goodness knows that ticket doesn't need any more dependencies... is it okay to ask to rebase to a "needs work" ticket?   Maybe the version with `python` as John suggested?   Or the filter version you mentioned in the relevant thread, if you think that one is better (though perhaps it's harder to understand what it's doing).



---

archive/issue_comments_177193.json:
```json
{
    "body": "apply to $SAGE_ROOT/devel/sage",
    "created_at": "2013-03-23T02:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177193",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_177194.json:
```json
{
    "body": "Attachment [trac_14344-installed-packages.patch](tarball://root/attachments/some-uuid/ticket14344/trac_14344-installed-packages.patch) by @kini created at 2013-03-23 02:35:13\n\nHow's this patch?\n\nThe filter thing I posted on sage-devel is semantically nicer, IMO, but I agree it looks pretty ugly and hard to read in Python, and this test isn't exactly run in a tight loop so performance is sort of irrelevant :)",
    "created_at": "2013-03-23T02:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177194",
    "user": "https://github.com/kini"
}
```

Attachment [trac_14344-installed-packages.patch](tarball://root/attachments/some-uuid/ticket14344/trac_14344-installed-packages.patch) by @kini created at 2013-03-23 02:35:13

How's this patch?

The filter thing I posted on sage-devel is semantically nicer, IMO, but I agree it looks pretty ugly and hard to read in Python, and this test isn't exactly run in a tight loop so performance is sort of irrelevant :)



---

archive/issue_comments_177195.json:
```json
{
    "body": "I just realized that probably they would still need to rebase at #10508, so I may have wasted your time... anyway, looks good.  I had some trouble finding an spkg that would actually compile on my box that was before atlas, though, to make sure the test worked!  The one in the thread needs qmake, and the ace package is pretty outdated, apparently, and seems to remove some stuff it maybe shouldn't.  Anyway, 4ti2 worked and the test still passes, so we're fine.",
    "created_at": "2013-03-23T03:13:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177195",
    "user": "https://github.com/kcrisman"
}
```

I just realized that probably they would still need to rebase at #10508, so I may have wasted your time... anyway, looks good.  I had some trouble finding an spkg that would actually compile on my box that was before atlas, though, to make sure the test worked!  The one in the thread needs qmake, and the ace package is pretty outdated, apparently, and seems to remove some stuff it maybe shouldn't.  Anyway, 4ti2 worked and the test still passes, so we're fine.



---

archive/issue_comments_177196.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-03-23T03:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177196",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_177197.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-23T03:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177197",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_177198.json:
```json
{
    "body": "This is such a tiny patch, I really couldn't complain about any time being wasted :) Since you've given this positive review, I'll go rebase the patch at #10508 on this.",
    "created_at": "2013-03-23T03:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177198",
    "user": "https://github.com/kini"
}
```

This is such a tiny patch, I really couldn't complain about any time being wasted :) Since you've given this positive review, I'll go rebase the patch at #10508 on this.



---

archive/issue_comments_177199.json:
```json
{
    "body": "Changing priority from minor to blocker.",
    "created_at": "2013-03-23T10:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177199",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from minor to blocker.



---

archive/issue_comments_177200.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-26T22:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14140#issuecomment-177200",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_013946.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-26T22:32:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14140",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14140#event-13946"
}
```
