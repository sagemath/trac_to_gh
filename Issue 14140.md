# Issue 14140: Fix packages test

Issue created by migration from https://trac.sagemath.org/ticket/14344

Original creator: kcrisman

Original creation time: 2013-03-23 01:04:07

Assignee: mvngu

CC:  kini jhpalmieri

Here is a request from a [sage-devel thread](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/cffoTAv0Zxo):

```

The following test fails because I have some optional packages installed - 

$ sage -t  --long -force_lib devel/sage/sage/misc/package.py 
sage -t --long -force_lib "devel/sage/sage/misc/package.py" 
********************************************************************** 
File "/home/rajeev/software/general/sage/devel/sage/sage/misc/package.py", 
line 119: 
    sage: install_package() 
Expected: 
    ['atlas...', 'blas...', ...] 
Got: 
    ['PyQt_x11-4.9.1.p0', 'atlas-3.8.4.p1', 'blas-20070724', 
'boehm_gc-7.2.alpha6.p2', 'boost-cropped-1.34.1', 
```


The consensus seemed to be simply adding more ellipses.


```
> Just add periods *before* 'atlas...' as well. 

And after it (between 'atlas...' and 'blas...'), just in case. Maybe something like

        ['atlas...', ..., 'python...', ...]
 
This is a better idea, IMO. 
```



---

Comment by kini created at 2013-03-23 01:31:13

Here's a patch.


---

Comment by kcrisman created at 2013-03-23 02:29:17

This patch isn't compatible with #10508, and goodness knows that ticket doesn't need any more dependencies... is it okay to ask to rebase to a "needs work" ticket?   Maybe the version with `python` as John suggested?   Or the filter version you mentioned in the relevant thread, if you think that one is better (though perhaps it's harder to understand what it's doing).


---

Comment by kini created at 2013-03-23 02:32:10

apply to $SAGE_ROOT/devel/sage


---

Attachment

How's this patch?

The filter thing I posted on sage-devel is semantically nicer, IMO, but I agree it looks pretty ugly and hard to read in Python, and this test isn't exactly run in a tight loop so performance is sort of irrelevant :)


---

Comment by kcrisman created at 2013-03-23 03:13:26

I just realized that probably they would still need to rebase at #10508, so I may have wasted your time... anyway, looks good.  I had some trouble finding an spkg that would actually compile on my box that was before atlas, though, to make sure the test worked!  The one in the thread needs qmake, and the ace package is pretty outdated, apparently, and seems to remove some stuff it maybe shouldn't.  Anyway, 4ti2 worked and the test still passes, so we're fine.


---

Comment by kcrisman created at 2013-03-23 03:13:40

Changing status from new to needs_review.


---

Comment by kcrisman created at 2013-03-23 03:13:48

Changing status from needs_review to positive_review.


---

Comment by kini created at 2013-03-23 03:35:39

This is such a tiny patch, I really couldn't complain about any time being wasted :) Since you've given this positive review, I'll go rebase the patch at #10508 on this.


---

Comment by jdemeyer created at 2013-03-23 10:29:47

Changing priority from minor to blocker.


---

Comment by jdemeyer created at 2013-03-26 22:32:08

Resolution: fixed
