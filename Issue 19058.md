# Issue 19058: Add some dependencies

archive/issues_019058.json:
```json
{
    "body": "CC:  tmonteil mkoeppe embray chapoton jdemeyer vbraun tscrim\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/19295\n\n",
    "created_at": "2015-09-25T21:05:31Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "title": "Add some dependencies",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19058",
    "user": "jdemeyer"
}
```
CC:  tmonteil mkoeppe embray chapoton jdemeyer vbraun tscrim



Issue created by migration from https://trac.sagemath.org/ticket/19295





---

archive/issue_comments_261381.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-09-25T21:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261381",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_261382.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-25T21:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261382",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_261383.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2015-09-25T21:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261383",
    "user": "jdemeyer"
}
```

Changing priority from major to minor.



---

archive/issue_comments_261384.json:
```json
{
    "body": "Changing component from packages: standard to packages: optional.",
    "created_at": "2015-09-25T21:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261384",
    "user": "jdemeyer"
}
```

Changing component from packages: standard to packages: optional.



---

archive/issue_comments_261385.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-27T16:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261385",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261386.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-28T18:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261386",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261387.json:
```json
{
    "body": "I am on it, but it takes time.",
    "created_at": "2015-09-30T22:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261387",
    "user": "tmonteil"
}
```

I am on it, but it takes time.



---

archive/issue_comments_261388.json:
```json
{
    "body": "Attachment",
    "created_at": "2015-10-01T17:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261388",
    "user": "tmonteil"
}
```

Attachment



---

archive/issue_comments_261389.json:
```json
{
    "body": "Attachment",
    "created_at": "2015-10-01T17:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261389",
    "user": "tmonteil"
}
```

Attachment



---

archive/issue_comments_261390.json:
```json
{
    "body": "Attachment",
    "created_at": "2015-10-01T17:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261390",
    "user": "tmonteil"
}
```

Attachment



---

archive/issue_comments_261391.json:
```json
{
    "body": "Attachment",
    "created_at": "2015-10-01T17:01:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261391",
    "user": "tmonteil"
}
```

Attachment



---

archive/issue_comments_261392.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-01T17:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261392",
    "user": "tmonteil"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_261393.json:
```json
{
    "body": "Here was my testing protocol:\n\nFor each package `pkg`, start from a Sage with only\n\n```\n    make distclean\n    make base\n```\n\n\nThen do `make $pkg` and see what happens.\n\nThe things that made me crazy is that if some package do not have a `dependencies` file, then the build system starts to build every standard package, i didn't underdtood that... Because of that \"feature\", we have to ensure that all dependencies of a package that is tested has a (possibly trivial) `dependency` file, recursively, or we are not testing much. So, to be tested well, this ticket should depend on #19261.\n\nNow about the packages involved in the ticket, i had problems with the following:\n\n- autotools still creates a bug, but i do not know what is missing, see the attached log.\n\n- database_gap: because of the last line in `spkg-install` script, `sage -c \"gap_reset_workspace()\"`, it should depend on a working Sage installation. So i added `SAGERUNTIME` as a dependency. It is overkill ?\n\n- `igraph` requires the `libxml2` (which we are not shipping), see the attached log. Perhaps we should package it, or perhaps move it to expermiental ? I added some hints on `SPKG.txt`. Moreover, from https://github.com/igraph/igraph/blob/master/debian/control it seems that `igraph` would be happy with blas/lapack and glpk, so perhaps should we also add `atlas` and `glpk` as dependencies ?\n\n- `libtheora` depends on `libogg`, see the attached log. I updated the dependency file.\n\n- `normaliz` depends on `boost_cropped`, see the attached log. I updated the dependency file. Also, Singular appears in the dependencies, but i am not sure it is the case, to my understanding of the documentation, i am not sure, but it seems that Singular can use Normaliz, but the converse. Shall we remove `singular` from `normaliz` dependencies ?\n\n- i added a `# no dependencies` for `configure`.\n\nAlso, only configure is a \"base\" package, while \"make base\" installs:\n\n\n```\nbase: $(INST)/$(BZIP2) $(INST)/$(PATCH) $(INST)/$(PKGCONF)\n```\n\n\nShall those 3 packages have \"base\" priority too ?\n----\nNew commits:",
    "created_at": "2015-10-01T17:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261393",
    "user": "tmonteil"
}
```

Here was my testing protocol:

For each package `pkg`, start from a Sage with only

```
    make distclean
    make base
```


Then do `make $pkg` and see what happens.

The things that made me crazy is that if some package do not have a `dependencies` file, then the build system starts to build every standard package, i didn't underdtood that... Because of that "feature", we have to ensure that all dependencies of a package that is tested has a (possibly trivial) `dependency` file, recursively, or we are not testing much. So, to be tested well, this ticket should depend on #19261.

Now about the packages involved in the ticket, i had problems with the following:

- autotools still creates a bug, but i do not know what is missing, see the attached log.

- database_gap: because of the last line in `spkg-install` script, `sage -c "gap_reset_workspace()"`, it should depend on a working Sage installation. So i added `SAGERUNTIME` as a dependency. It is overkill ?

- `igraph` requires the `libxml2` (which we are not shipping), see the attached log. Perhaps we should package it, or perhaps move it to expermiental ? I added some hints on `SPKG.txt`. Moreover, from https://github.com/igraph/igraph/blob/master/debian/control it seems that `igraph` would be happy with blas/lapack and glpk, so perhaps should we also add `atlas` and `glpk` as dependencies ?

- `libtheora` depends on `libogg`, see the attached log. I updated the dependency file.

- `normaliz` depends on `boost_cropped`, see the attached log. I updated the dependency file. Also, Singular appears in the dependencies, but i am not sure it is the case, to my understanding of the documentation, i am not sure, but it seems that Singular can use Normaliz, but the converse. Shall we remove `singular` from `normaliz` dependencies ?

- i added a `# no dependencies` for `configure`.

Also, only configure is a "base" package, while "make base" installs:


```
base: $(INST)/$(BZIP2) $(INST)/$(PATCH) $(INST)/$(PKGCONF)
```


Shall those 3 packages have "base" priority too ?
----
New commits:



---

archive/issue_comments_261394.json:
```json
{
    "body": "Replying to [comment:8 tmonteil]:\n> The things that made me crazy is that if some package do not have a `dependencies` file, then the build system starts to build every standard package, i didn't underdtood that...\nThat's the default for optional packages. It was chosen because it's reasonably safe. But after these tickets have been dealt with, we should probably make `dependencies` mandatory.\n\n> - autotools still creates a bug, but i do not know what is missing, see the attached log.\nAre you sure that you tested this correctly? Because it seems from the log that `ncurses` wasn't installed. Note that I added the autotools dependency in an additional commit.\n\n> - database_gap: because of the last line in `spkg-install` script, `sage -c \"gap_reset_workspace()\"`, it should depend on a working Sage installation. So i added `SAGERUNTIME` as a dependency. It is overkill ?\nNo overkill, it is correct.\n\n> - `igraph` requires the `libxml2` (which we are not shipping), see the attached log.\n> Perhaps we should package it, or perhaps move it to expermiental ?\nLet's leave this for now.\n\n> it seems that `igraph` would be happy with blas/lapack and glpk, so perhaps should we also add `atlas` and `glpk` as dependencies ?\nWell, `igraph` doesn't use them even if they are present. While `igraph` might be able to use those libraries, it doesn't do so by default. So no extra dependencies are needed.\n\n> - `libtheora` depends on `libogg`, see the attached log. I updated the dependency file.\nGood.\n\n> - `normaliz` depends on `boost_cropped`, see the attached log. I updated the dependency file.\nGood.\n\n> Shall we remove `singular` from `normaliz` dependencies ?\nThe `spkg-install` file for `normaliz` really installs things specifically for Singular, so I think we need the dependency.\n\n> - i added a `# no dependencies` for `configure`.\nWell, `configure` isn't really a package... If you really want a dependencies file, it should perhaps say something like `# not a real package`.\n\n> {{{\n> base: $(INST)/$(BZIP2) $(INST)/$(PATCH) $(INST)/$(PKGCONF)\n> }}}\n> \n> Shall those 3 packages have \"base\" priority too ?\nNo. Like I said, `configure` isn't a package, but these 3 are real packages.",
    "created_at": "2015-10-02T15:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261394",
    "user": "jdemeyer"
}
```

Replying to [comment:8 tmonteil]:
> The things that made me crazy is that if some package do not have a `dependencies` file, then the build system starts to build every standard package, i didn't underdtood that...
That's the default for optional packages. It was chosen because it's reasonably safe. But after these tickets have been dealt with, we should probably make `dependencies` mandatory.

> - autotools still creates a bug, but i do not know what is missing, see the attached log.
Are you sure that you tested this correctly? Because it seems from the log that `ncurses` wasn't installed. Note that I added the autotools dependency in an additional commit.

> - database_gap: because of the last line in `spkg-install` script, `sage -c "gap_reset_workspace()"`, it should depend on a working Sage installation. So i added `SAGERUNTIME` as a dependency. It is overkill ?
No overkill, it is correct.

> - `igraph` requires the `libxml2` (which we are not shipping), see the attached log.
> Perhaps we should package it, or perhaps move it to expermiental ?
Let's leave this for now.

> it seems that `igraph` would be happy with blas/lapack and glpk, so perhaps should we also add `atlas` and `glpk` as dependencies ?
Well, `igraph` doesn't use them even if they are present. While `igraph` might be able to use those libraries, it doesn't do so by default. So no extra dependencies are needed.

> - `libtheora` depends on `libogg`, see the attached log. I updated the dependency file.
Good.

> - `normaliz` depends on `boost_cropped`, see the attached log. I updated the dependency file.
Good.

> Shall we remove `singular` from `normaliz` dependencies ?
The `spkg-install` file for `normaliz` really installs things specifically for Singular, so I think we need the dependency.

> - i added a `# no dependencies` for `configure`.
Well, `configure` isn't really a package... If you really want a dependencies file, it should perhaps say something like `# not a real package`.

> {{{
> base: $(INST)/$(BZIP2) $(INST)/$(PATCH) $(INST)/$(PKGCONF)
> }}}
> 
> Shall those 3 packages have "base" priority too ?
No. Like I said, `configure` isn't a package, but these 3 are real packages.



---

archive/issue_comments_261395.json:
```json
{
    "body": "Does this still need work?",
    "created_at": "2015-10-28T10:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261395",
    "user": "jdemeyer"
}
```

Does this still need work?



---

archive/issue_comments_261396.json:
```json
{
    "body": "Part of this (for latte_int, 4ti2) was duplicated in #20748. \nWhat's up with this bigger patch?\n(And what's up with all these tickets without followup?)",
    "created_at": "2016-06-26T21:40:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261396",
    "user": "mkoeppe"
}
```

Part of this (for latte_int, 4ti2) was duplicated in #20748. 
What's up with this bigger patch?
(And what's up with all these tickets without followup?)



---

archive/issue_comments_261397.json:
```json
{
    "body": "Well, I guess it will have to be rebased anyhow.",
    "created_at": "2016-06-27T08:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261397",
    "user": "embray"
}
```

Well, I guess it will have to be rebased anyhow.



---

archive/issue_comments_261398.json:
```json
{
    "body": "This patch adds lines of the form:\n\n```\n $(INST)/$(SAGE_MP_LIBRARY) $(INST)/$(NTL) $(INST)/$(CDDLIB)\n```\n\nwhereas #20748 added:\n\n```\n $(MP_LIBRARY) ntl 4ti2 cddlib\n```\n\nWhat is the preferred way of writing these dependencies? \nIs this documented?",
    "created_at": "2016-06-27T16:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261398",
    "user": "mkoeppe"
}
```

This patch adds lines of the form:

```
 $(INST)/$(SAGE_MP_LIBRARY) $(INST)/$(NTL) $(INST)/$(CDDLIB)
```

whereas #20748 added:

```
 $(MP_LIBRARY) ntl 4ti2 cddlib
```

What is the preferred way of writing these dependencies? 
Is this documented?



---

archive/issue_comments_261399.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2016-06-27T16:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261399",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_261400.json:
```json
{
    "body": "This is a recent change, the new syntax is `$(MP_LIBRARY) ntl 4ti2 cddlib`",
    "created_at": "2016-06-29T08:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261400",
    "user": "vbraun"
}
```

This is a recent change, the new syntax is `$(MP_LIBRARY) ntl 4ti2 cddlib`



---

archive/issue_comments_261401.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2016-07-06T22:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261401",
    "user": "mkoeppe"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_261402.json:
```json
{
    "body": "Replying to [comment:13 mkoeppe]:\n> What is the preferred way of writing these dependencies? \n> Is this documented?\n\nhttp://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies",
    "created_at": "2016-07-13T19:25:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261402",
    "user": "jdemeyer"
}
```

Replying to [comment:13 mkoeppe]:
> What is the preferred way of writing these dependencies? 
> Is this documented?

http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies



---

archive/issue_comments_261403.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-14T16:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261403",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_261404.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-07-14T16:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261404",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_261405.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-15T11:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261405",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_261406.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-16T20:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19058",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19058#issuecomment-261406",
    "user": "vbraun"
}
```

Resolution: fixed
