# Issue 17092: sage-6.4.rc1 (and earlier) crashes when evaluating zeta(CDF(-151.386325246 + 992.34771962*I))

archive/issues_017092.json:
```json
{
    "body": "CC:  @pjbruin\n\n\n```\n/scratch/wstein/sage-6.4.rc1$ ./sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Sage Version 6.4.rc1, Release Date: 2014-11-01                     \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: zeta(CDF(-151.386325246 + 992.34771962*I))\nsig_error() without sig_on()\n------------------------------------------------------------------------\n/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(print_backtrace+0x31)[0x7f7cef1656de]\n/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(sigdie+0x1e)[0x7f7cef1658d3]\n/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(sage_signal_handler+0x192)[0x7f7cef1650d0]\n/lib/x86_64-linux-gnu/libpthread.so.0(+0x10340)[0x7f7cfb6a7340]\n/lib/x86_64-linux-gnu/libc.so.6(gsignal+0x39)[0x7f7cfb307bb9]\n/lib/x86_64-linux-gnu/libc.so.6(abort+0x148)[0x7f7cfb30afc8]\n/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/libs/pari/handle_error.so(+0x2046)[0x7f7ce780e046]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpari-gmp.so.4(pari_err+0x2e1)[0x7f7cee771161]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpari-gmp.so.4(rtodbl+0xb3)[0x7f7cee407553]\n/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/rings/complex_double.so(+0x1e3ae)[0x7f7ce9c4e3ae]\n/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/rings/complex_double.so(+0x1912e)[0x7f7ce9c4912e]\n/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x1a3c6)[0x7f7ccf51a3c6]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f7cfb907553]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1d51)[0x7f7cfb9ba761]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7f7cfb9bebd2]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56cb)[0x7f7cfb9be0db]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7f7cfb9bebd2]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x92)[0x7f7cfb9e81e2]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xd9)[0x7f7cfb9e9729]\n/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(Py_Main+0xc7f)[0x7f7cfb9ff61f]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf5)[0x7f7cfb2f2ec5]\npython[0x4006fe]\n------------------------------------------------------------------------\nAttaching gdb to process id 29509.\n \nSaved trace to /projects/4cff8798-41d0-4d9b-b516-ba106ba89c57/.sage/crash_logs/sage_crash_Nk1tB0.log\n------------------------------------------------------------------------\nUnhandled SIGABRT: An abort() occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nSage will now terminate.\n------------------------------------------------------------------------\n./sage: line 134: 29509 Aborted                 (core dumped) \"$SAGE_ROOT/src/bin/sage\" \"$@\"\n```\n\n\n\nObserved on both intel and opteron in both sage-6.3 and sage-6.4.rc1.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17329\n\n",
    "created_at": "2014-11-12T21:53:44Z",
    "labels": [
        "component: number theory",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "sage-6.4.rc1 (and earlier) crashes when evaluating zeta(CDF(-151.386325246 + 992.34771962*I))",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17092",
    "user": "https://github.com/williamstein"
}
```
CC:  @pjbruin


```
/scratch/wstein/sage-6.4.rc1$ ./sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 6.4.rc1, Release Date: 2014-11-01                     │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: zeta(CDF(-151.386325246 + 992.34771962*I))
sig_error() without sig_on()
------------------------------------------------------------------------
/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(print_backtrace+0x31)[0x7f7cef1656de]
/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(sigdie+0x1e)[0x7f7cef1658d3]
/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(sage_signal_handler+0x192)[0x7f7cef1650d0]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x10340)[0x7f7cfb6a7340]
/lib/x86_64-linux-gnu/libc.so.6(gsignal+0x39)[0x7f7cfb307bb9]
/lib/x86_64-linux-gnu/libc.so.6(abort+0x148)[0x7f7cfb30afc8]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/libs/pari/handle_error.so(+0x2046)[0x7f7ce780e046]
/scratch/wstein/sage-6.4.rc1/local/lib/libpari-gmp.so.4(pari_err+0x2e1)[0x7f7cee771161]
/scratch/wstein/sage-6.4.rc1/local/lib/libpari-gmp.so.4(rtodbl+0xb3)[0x7f7cee407553]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/rings/complex_double.so(+0x1e3ae)[0x7f7ce9c4e3ae]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/rings/complex_double.so(+0x1912e)[0x7f7ce9c4912e]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x1a3c6)[0x7f7ccf51a3c6]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f7cfb907553]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1d51)[0x7f7cfb9ba761]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7f7cfb9bebd2]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56cb)[0x7f7cfb9be0db]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7f7cfb9bebd2]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x92)[0x7f7cfb9e81e2]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xd9)[0x7f7cfb9e9729]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(Py_Main+0xc7f)[0x7f7cfb9ff61f]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf5)[0x7f7cfb2f2ec5]
python[0x4006fe]
------------------------------------------------------------------------
Attaching gdb to process id 29509.
 
Saved trace to /projects/4cff8798-41d0-4d9b-b516-ba106ba89c57/.sage/crash_logs/sage_crash_Nk1tB0.log
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Sage will now terminate.
------------------------------------------------------------------------
./sage: line 134: 29509 Aborted                 (core dumped) "$SAGE_ROOT/src/bin/sage" "$@"
```



Observed on both intel and opteron in both sage-6.3 and sage-6.4.rc1.

Issue created by migration from https://trac.sagemath.org/ticket/17329





---

archive/issue_comments_227019.json:
```json
{
    "body": "This was found by Austin Tran, who reported\n\n```\nf(z)=zeta(z^2)\ncomplex_plot(f,(-10,10),(-10,10),axes=False,figsize=[10,10],plot_points=1000)\n```\n\nwhich workes fine, but the same expression with zeta(z^3) instead returned the given error.  In particular,\n\n\n```\nf(z)=zeta(z^3)\ncomplex_plot(f,(-10,10),(-10,10),axes=False,figsize=[10,10],plot_points=1000)\n```\n\n\ngives an error.   I tried doing this:\n\n\n```\n\nm=0\ndef f(z):\n    global m\n    m = z\n    return zeta(z^3)\n\ncomplex_plot(f,(-10,10),(-10,10),axes=False,figsize=[3,3],plot_points=100)\n```\n\n\nand found that the problem was caused when z = 0.505050505051 - 10.0*I.   I then tried explicitly computing zeta(z^3) and got the core dump.\n\nWorksheet: https://cloud.sagemath.com/projects/4a5f0542-5873-4eed-a85c-a18c706e8bcd/files/support/2014-11-12-complex-plot.sagews",
    "created_at": "2014-11-12T21:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227019",
    "user": "https://github.com/williamstein"
}
```

This was found by Austin Tran, who reported

```
f(z)=zeta(z^2)
complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[10,10],plot_points=1000)
```

which workes fine, but the same expression with zeta(z^3) instead returned the given error.  In particular,


```
f(z)=zeta(z^3)
complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[10,10],plot_points=1000)
```


gives an error.   I tried doing this:


```

m=0
def f(z):
    global m
    m = z
    return zeta(z^3)

complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[3,3],plot_points=100)
```


and found that the problem was caused when z = 0.505050505051 - 10.0*I.   I then tried explicitly computing zeta(z^3) and got the core dump.

Worksheet: https://cloud.sagemath.com/projects/4a5f0542-5873-4eed-a85c-a18c706e8bcd/files/support/2014-11-12-complex-plot.sagews



---

archive/issue_comments_227020.json:
```json
{
    "body": "Workaround:\n\n```\ndef f(z):\n    return zeta(CC(z)^3)\n\ncomplex_plot(f,(-10,10),(-10,10),axes=False,figsize=[3,3],plot_points=100)\n```\n",
    "created_at": "2014-11-12T22:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227020",
    "user": "https://github.com/williamstein"
}
```

Workaround:

```
def f(z):
    return zeta(CC(z)^3)

complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[3,3],plot_points=100)
```




---

archive/issue_comments_227021.json:
```json
{
    "body": "Changing component from number theory to basic arithmetic.",
    "created_at": "2014-11-13T17:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227021",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from number theory to basic arithmetic.



---

archive/issue_comments_227022.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-13T17:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227022",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_227023.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-11-13T17:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227023",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_227024.json:
```json
{
    "body": "Looks like the right solution to me and passes doctests.",
    "created_at": "2014-11-14T19:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227024",
    "user": "https://github.com/pjbruin"
}
```

Looks like the right solution to me and passes doctests.



---

archive/issue_comments_227025.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-11-14T19:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227025",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_227026.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-15T16:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17092#issuecomment-227026",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
