# Issue 17092: sage-6.4.rc1 (and earlier) crashes when evaluating zeta(CDF(-151.386325246 + 992.34771962*I))

Issue created by migration from Trac.

Original creator: was

Original creation time: 2014-11-12 21:53:44

CC:  pbruin


```
/scratch/wstein/sage-6.4.rc1$ ./sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 6.4.rc1, Release Date: 2014-11-01                     │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: zeta(CDF(-151.386325246 + 992.34771962*I))
sig_error() without sig_on()
------------------------------------------------------------------------
/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(print_backtrace+0x31)[0x7f7cef1656de]
/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(sigdie+0x1e)[0x7f7cef1658d3]
/scratch/wstein/sage-6.4.rc1/local/lib/libcsage.so(sage_signal_handler+0x192)[0x7f7cef1650d0]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x10340)[0x7f7cfb6a7340]
/lib/x86_64-linux-gnu/libc.so.6(gsignal+0x39)[0x7f7cfb307bb9]
/lib/x86_64-linux-gnu/libc.so.6(abort+0x148)[0x7f7cfb30afc8]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/libs/pari/handle_error.so(+0x2046)[0x7f7ce780e046]
/scratch/wstein/sage-6.4.rc1/local/lib/libpari-gmp.so.4(pari_err+0x2e1)[0x7f7cee771161]
/scratch/wstein/sage-6.4.rc1/local/lib/libpari-gmp.so.4(rtodbl+0xb3)[0x7f7cee407553]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/rings/complex_double.so(+0x1e3ae)[0x7f7ce9c4e3ae]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/rings/complex_double.so(+0x1912e)[0x7f7ce9c4912e]
/scratch/wstein/sage-6.4.rc1/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x1a3c6)[0x7f7ccf51a3c6]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f7cfb907553]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x1d51)[0x7f7cfb9ba761]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7f7cfb9bebd2]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56cb)[0x7f7cfb9be0db]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x5585)[0x7f7cfb9bdf95]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x80d)[0x7f7cfb9bea9d]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x32)[0x7f7cfb9bebd2]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x92)[0x7f7cfb9e81e2]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xd9)[0x7f7cfb9e9729]
/scratch/wstein/sage-6.4.rc1/local/lib/libpython2.7.so.1.0(Py_Main+0xc7f)[0x7f7cfb9ff61f]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf5)[0x7f7cfb2f2ec5]
python[0x4006fe]
------------------------------------------------------------------------
Attaching gdb to process id 29509.
 
Saved trace to /projects/4cff8798-41d0-4d9b-b516-ba106ba89c57/.sage/crash_logs/sage_crash_Nk1tB0.log
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Sage will now terminate.
------------------------------------------------------------------------
./sage: line 134: 29509 Aborted                 (core dumped) "$SAGE_ROOT/src/bin/sage" "$`@`"
```



Observed on both intel and opteron in both sage-6.3 and sage-6.4.rc1.


---

Comment by was created at 2014-11-12 21:55:56

This was found by Austin Tran, who reported

```
f(z)=zeta(z^2)
complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[10,10],plot_points=1000)
```

which workes fine, but the same expression with zeta(z^3) instead returned the given error.  In particular,


```
f(z)=zeta(z^3)
complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[10,10],plot_points=1000)
```


gives an error.   I tried doing this:


```

m=0
def f(z):
    global m
    m = z
    return zeta(z^3)

complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[3,3],plot_points=100)
```


and found that the problem was caused when z = 0.505050505051 - 10.0*I.   I then tried explicitly computing zeta(z^3) and got the core dump.

Worksheet: https://cloud.sagemath.com/projects/4a5f0542-5873-4eed-a85c-a18c706e8bcd/files/support/2014-11-12-complex-plot.sagews


---

Comment by was created at 2014-11-12 22:01:05

Workaround:

```
def f(z):
    return zeta(CC(z)^3)

complex_plot(f,(-10,10),(-10,10),axes=False,figsize=[3,3],plot_points=100)
```



---

Comment by jdemeyer created at 2014-11-13 17:08:34

Changing component from number theory to basic arithmetic.


---

Comment by jdemeyer created at 2014-11-13 17:46:25

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-11-13 17:46:25

New commits:


---

Comment by pbruin created at 2014-11-14 19:50:55

Looks like the right solution to me and passes doctests.


---

Comment by pbruin created at 2014-11-14 19:50:55

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-11-15 16:22:42

Resolution: fixed
