# Issue 16751: Implement type D_4^{(3)} rigged configuration bijection

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2014-09-15 16:20:01

Assignee: sage-combinat

CC:  sage-combinat aschilling bsalisbury1

Keywords: rigged configurations, KR tableaux

Adds the type D<sub>4</sub><sup>(3)</sup> bijection between rigged configurations and tensor products of KR tableaux and the resulting KR tableaux crystal.


---

Comment by tscrim created at 2014-09-15 16:21:07

Changing status from new to needs_review.


---

Comment by tscrim created at 2014-09-15 16:21:07

Last 10 new commits:


---

Comment by git created at 2015-03-17 18:42:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-13 15:47:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-15 20:54:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-07-13 10:32:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-10-22 21:00:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2015-10-22 21:01:06

Changing status from needs_review to positive_review.


---

Comment by bsalisbury1 created at 2015-10-22 21:01:06

Thanks, Travis!


---

Comment by tscrim created at 2015-10-22 21:01:53

Thanks for doing the review!


---

Comment by vbraun created at 2015-10-23 17:28:06

Resolution: fixed


---

Comment by vbraun created at 2015-10-24 07:54:11

Resolution changed from fixed to 


---

Comment by vbraun created at 2015-10-24 07:54:11

Changing status from closed to new.


---

Comment by vbraun created at 2015-10-24 07:54:11

I'm getting random failures that point to this ticket:

```
sage -t --long src/sage/combinat/rigged_configurations/kr_tableaux.py
**********************************************************************
File "src/sage/combinat/rigged_configurations/kr_tableaux.py", line 1671, in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.e
Failed example:
    KRT.module_generators[0].e(0)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.e[1]>", line 1, in <module>
        KRT.module_generators[Integer(0)].e(Integer(0))
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1680, in e
        ret = ret.to_virtual_configuration().e(0)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/rigged_configuration_element.py", line 1327, in e
        ret = self.to_tensor_product_of_kirillov_reshetikhin_tableaux().e(a)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1258, in e
        position = self.positions_of_unmatched_plus(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1400, in positions_of_unmatched_plus
        l = self.positions_of_unmatched_minus(i, dual=True, reverse=True)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1380, in positions_of_unmatched_minus
        plus = self[j].epsilon(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1532, in epsilon
        return KirillovReshetikhinTableauxElement.epsilon(self, i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1373, in epsilon
        return self.to_kirillov_reshetikhin_crystal().epsilon0()
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1160, in to_kirillov_reshetikhin_crystal
        return self.parent().kirillov_reshetikhin_crystal()(self)
      File "sage/structure/parent.pyx", line 1098, in sage.structure.parent.Parent.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9821)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 109, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4543)
        raise
      File "sage/structure/coerce_maps.pyx", line 104, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4436)
        return C._element_constructor(x)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 3024, in _element_constructor_
        return self.module_generator().f_string(f_str)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 543, in module_generator
        return [ b for b in self.module_generators if b.weight() == weight][0]
    IndexError: list index out of range
**********************************************************************
File "src/sage/combinat/rigged_configurations/kr_tableaux.py", line 1699, in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.f
Failed example:
    KRT.module_generators[0].f(0)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.f[1]>", line 1, in <module>
        KRT.module_generators[Integer(0)].f(Integer(0))
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1709, in f
        ret = ret.to_virtual_configuration().f(0)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/rigged_configuration_element.py", line 1383, in f
        ret = self.to_tensor_product_of_kirillov_reshetikhin_tableaux().f(a)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1297, in f
        position = self.positions_of_unmatched_minus(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1371, in positions_of_unmatched_minus
        minus = self[j].phi(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1549, in phi
        return KirillovReshetikhinTableauxElement.phi(self, i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1391, in phi
        return self.to_kirillov_reshetikhin_crystal().phi0()
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1160, in to_kirillov_reshetikhin_crystal
        return self.parent().kirillov_reshetikhin_crystal()(self)
      File "sage/structure/parent.pyx", line 1098, in sage.structure.parent.Parent.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9821)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 109, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4543)
        raise
      File "sage/structure/coerce_maps.pyx", line 104, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4436)
        return C._element_constructor(x)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 3024, in _element_constructor_
        return self.module_generator().f_string(f_str)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 543, in module_generator
        return [ b for b in self.module_generators if b.weight() == weight][0]
    IndexError: list index out of range
**********************************************************************
File "src/sage/combinat/rigged_configurations/kr_tableaux.py", line 1700, in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.f
Failed example:
    KRT.module_generators[3].f(0)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.f[2]>", line 1, in <module>
        KRT.module_generators[Integer(3)].f(Integer(0))
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1709, in f
        ret = ret.to_virtual_configuration().f(0)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/rigged_configuration_element.py", line 1383, in f
        ret = self.to_tensor_product_of_kirillov_reshetikhin_tableaux().f(a)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1297, in f
        position = self.positions_of_unmatched_minus(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1371, in positions_of_unmatched_minus
        minus = self[j].phi(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1549, in phi
        return KirillovReshetikhinTableauxElement.phi(self, i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1391, in phi
        return self.to_kirillov_reshetikhin_crystal().phi0()
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1160, in to_kirillov_reshetikhin_crystal
        return self.parent().kirillov_reshetikhin_crystal()(self)
      File "sage/structure/parent.pyx", line 1098, in sage.structure.parent.Parent.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9821)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 109, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4543)
        raise
      File "sage/structure/coerce_maps.pyx", line 104, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4436)
        return C._element_constructor(x)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 3024, in _element_constructor_
        return self.module_generator().f_string(f_str)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 543, in module_generator
        return [ b for b in self.module_generators if b.weight() == weight][0]
    IndexError: list index out of range
**********************************************************************
File "src/sage/combinat/rigged_configurations/kr_tableaux.py", line 1778, in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2.__init__
Failed example:
    TestSuite(KRT).run() # long time
Expected nothing
Got:
      Failure in _test_stembridge_local_axioms:
      Traceback (most recent call last):
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
          test_method(tester = tester)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py", line 760, in _test_stembridge_local_axioms
          if self.e(i) is not None and self.e(j) is not None:
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1680, in e
          ret = ret.to_virtual_configuration().e(0)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/rigged_configuration_element.py", line 1327, in e
          ret = self.to_tensor_product_of_kirillov_reshetikhin_tableaux().e(a)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1258, in e
          position = self.positions_of_unmatched_plus(i)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1400, in positions_of_unmatched_plus
          l = self.positions_of_unmatched_minus(i, dual=True, reverse=True)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1380, in positions_of_unmatched_minus
          plus = self[j].epsilon(i)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1532, in epsilon
          return KirillovReshetikhinTableauxElement.epsilon(self, i)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1373, in epsilon
          return self.to_kirillov_reshetikhin_crystal().epsilon0()
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1160, in to_kirillov_reshetikhin_crystal
          return self.parent().kirillov_reshetikhin_crystal()(self)
        File "sage/structure/parent.pyx", line 1098, in sage.structure.parent.Parent.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9821)
          return mor._call_(x)
        File "sage/structure/coerce_maps.pyx", line 109, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4543)
          raise
        File "sage/structure/coerce_maps.pyx", line 104, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4436)
          return C._element_constructor(x)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 3024, in _element_constructor_
          return self.module_generator().f_string(f_str)
        File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 543, in module_generator
          return [ b for b in self.module_generators if b.weight() == weight][0]
      IndexError: list index out of range
      ------------------------------------------------------------
      The following tests failed: _test_stembridge_local_axioms
    Failure in _test_elements
    Failure in _test_stembridge_local_axioms:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py", line 310, in _test_stembridge_local_axioms
        goodness = x._test_stembridge_local_axioms(index_set, verbose)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py", line 760, in _test_stembridge_local_axioms
        if self.e(i) is not None and self.e(j) is not None:
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1680, in e
        ret = ret.to_virtual_configuration().e(0)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/rigged_configuration_element.py", line 1327, in e
        ret = self.to_tensor_product_of_kirillov_reshetikhin_tableaux().e(a)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1258, in e
        position = self.positions_of_unmatched_plus(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1400, in positions_of_unmatched_plus
        l = self.positions_of_unmatched_minus(i, dual=True, reverse=True)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1380, in positions_of_unmatched_minus
        plus = self[j].epsilon(i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1532, in epsilon
        return KirillovReshetikhinTableauxElement.epsilon(self, i)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1373, in epsilon
        return self.to_kirillov_reshetikhin_crystal().epsilon0()
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1160, in to_kirillov_reshetikhin_crystal
        return self.parent().kirillov_reshetikhin_crystal()(self)
      File "sage/structure/parent.pyx", line 1098, in sage.structure.parent.Parent.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9821)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 109, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4543)
        raise
      File "sage/structure/coerce_maps.pyx", line 104, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4436)
        return C._element_constructor(x)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 3024, in _element_constructor_
        return self.module_generator().f_string(f_str)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 543, in module_generator
        return [ b for b in self.module_generators if b.weight() == weight][0]
    IndexError: list index out of range
    ------------------------------------------------------------
    The following tests failed: _test_elements, _test_stembridge_local_axioms
**********************************************************************
3 items had failures:
   1 of   3 in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2.__init__
   1 of   3 in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.e
   2 of   4 in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.f
    [247 tests, 4 failures, 130.41 s]
```



---

Comment by vbraun created at 2015-10-24 07:54:44

Last 10 new commits:


---

Comment by git created at 2015-10-24 20:37:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-10-24 20:37:43

It's not a Heisenbug as I can regularly reproduce this when I run long tests on just `kr_tableaux.py`. I have traced this down to somewhere there is an `s` for a KR crystal that is being created as a python `int`:

```
sage: K = crystals.KirillovReshetikhin(['D',4,1], 4, int(1))
sage: K.classical_crystal
The crystal of tableaux of type ['D', 4] and shape(s) [This is the Trac macro *0, 0, 0, 0* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#0, 0, 0, 0-macro)
```

This patch just exposed this issue that `self.s()` needs to be explicitly converted to a rational number for the `s/2` part of the classical decomposition.


---

Comment by tscrim created at 2015-10-24 20:37:52

Changing status from new to needs_review.


---

Comment by bsalisbury1 created at 2015-10-28 19:24:06


```
$ sage -t --long src/sage/combinat/rigged_configurations/kr_tableaux.py
Running doctests with ID 2015-10-28-15-21-54-c356bd2b.
Git branch: t/16988/public/rigged_configurations/type_D_tri_bijection-16988
Using --optional=gcc,mpir,python2,sage
Doctesting 1 file.
sage -t --long --warn-long 83.6 src/sage/combinat/rigged_configurations/kr_tableaux.py
    [247 tests, 71.36 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 71.5 seconds
    cpu time: 71.1 seconds
    cumulative wall time: 71.4 seconds
```



---

Comment by bsalisbury1 created at 2015-10-28 19:24:06

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-10-29 16:35:04

Resolution: fixed
