# Issue 23661: gcc vs. Xcode 9.0

archive/issues_023661.json:
```json
{
    "body": "CC:  @kiwifb\n\nSage's gcc does not build with Xcode 9.0 (released 19 Sept 2017?). See [the log file](https://sites.math.washington.edu/~palmieri/Sage/gcc-5.4.0.log).\n\nIssue created by migration from https://trac.sagemath.org/ticket/23898\n\n",
    "created_at": "2017-09-19T23:56:00Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "gcc vs. Xcode 9.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23661",
    "user": "https://github.com/jhpalmieri"
}
```
CC:  @kiwifb

Sage's gcc does not build with Xcode 9.0 (released 19 Sept 2017?). See [the log file](https://sites.math.washington.edu/~palmieri/Sage/gcc-5.4.0.log).

Issue created by migration from https://trac.sagemath.org/ticket/23898





---

archive/issue_comments_331052.json:
```json
{
    "body": "I just upgraded Sage's gcc to 6.4.0 and it built successfully with Xcode 9.0. Is there a reason not to upgrade to this version? Or to 7.2.0 (which I haven't tried yet)?",
    "created_at": "2017-10-03T21:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331052",
    "user": "https://github.com/jhpalmieri"
}
```

I just upgraded Sage's gcc to 6.4.0 and it built successfully with Xcode 9.0. Is there a reason not to upgrade to this version? Or to 7.2.0 (which I haven't tried yet)?



---

archive/issue_comments_331053.json:
```json
{
    "body": "I did `make ptestlong` with gcc 6.4.0 and all tests passed. I did not have to make any changes to eclib (see #23922 \u2013 that problem must be specific to clang).",
    "created_at": "2017-10-04T04:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331053",
    "user": "https://github.com/jhpalmieri"
}
```

I did `make ptestlong` with gcc 6.4.0 and all tests passed. I did not have to make any changes to eclib (see #23922 â€“ that problem must be specific to clang).



---

archive/issue_comments_331054.json:
```json
{
    "body": "Same with gcc 7.2.0.",
    "created_at": "2017-10-04T17:04:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331054",
    "user": "https://github.com/jhpalmieri"
}
```

Same with gcc 7.2.0.



---

archive/issue_comments_331055.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-05T00:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331055",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_331056.json:
```json
{
    "body": "Okay, let's upgrade GCC to version 7.2.0.\n----\nNew commits:",
    "created_at": "2017-10-05T00:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331056",
    "user": "https://github.com/jhpalmieri"
}
```

Okay, let's upgrade GCC to version 7.2.0.
----
New commits:



---

archive/issue_comments_331057.json:
```json
{
    "body": "I have only tested this on OS X with Xcode 8 and Xcode 9. It needs testing on many other platforms.",
    "created_at": "2017-10-05T00:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331057",
    "user": "https://github.com/jhpalmieri"
}
```

I have only tested this on OS X with Xcode 8 and Xcode 9. It needs testing on many other platforms.



---

archive/issue_comments_331058.json:
```json
{
    "body": "I might test this on various platforms, but not very soon.",
    "created_at": "2017-10-05T12:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331058",
    "user": "https://github.com/jdemeyer"
}
```

I might test this on various platforms, but not very soon.



---

archive/issue_comments_331059.json:
```json
{
    "body": "Checking on Linux Fedora 26 now.",
    "created_at": "2017-10-05T18:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331059",
    "user": "https://github.com/dimpase"
}
```

Checking on Linux Fedora 26 now.



---

archive/issue_comments_331060.json:
```json
{
    "body": "Making the ticket summary more explicit.",
    "created_at": "2017-10-05T22:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331060",
    "user": "https://github.com/slel"
}
```

Making the ticket summary more explicit.



---

archive/issue_comments_331061.json:
```json
{
    "body": "Is this known? I have `SAGE_INSTALL_GCC=yes`, check out develop, check out this branch, then `make start` will NOT build gcc.",
    "created_at": "2017-10-06T06:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331061",
    "user": "https://github.com/rwst"
}
```

Is this known? I have `SAGE_INSTALL_GCC=yes`, check out develop, check out this branch, then `make start` will NOT build gcc.



---

archive/issue_comments_331062.json:
```json
{
    "body": "How did you get this to work? With this branch and downloading gcc-7.2.0.tar.gz, I still get an error when installing sage:\n\n```\n[ntl-10.3.0] libtool: install: cp -p .libs/libntl.33.dylib /Applications/sage/local/lib/libntl.33.dylib\n[ntl-10.3.0] libtool: install: (cd /Applications/sage/local/lib && { ln -s -f libntl.33.dylib libntl.dylib || { rm -f libntl.dylib && ln -s libntl.33.dylib libntl.dylib; }; })\n[ntl-10.3.0] libtool: install: cp -p .libs/libntl.lai /Applications/sage/local/lib/libntl.la\n[ntl-10.3.0] libtool: install: cp -p .libs/libntl.a /Applications/sage/local/lib/libntl.a\n[ntl-10.3.0] libtool: install: chmod 644 /Applications/sage/local/lib/libntl.a\n[ntl-10.3.0] libtool: install: ranlib /Applications/sage/local/lib/libntl.a\n[ntl-10.3.0] \n[ntl-10.3.0] real\t4m38.570s\n[ntl-10.3.0] user\t7m31.224s\n[ntl-10.3.0] sys\t0m15.756s\n[ntl-10.3.0] Successfully installed ntl-10.3.0\n[ntl-10.3.0] Deleting temporary build directory\n[ntl-10.3.0] /Applications/sage/local/var/tmp/sage/build/ntl-10.3.0\n[ntl-10.3.0] Finished installing ntl-10.3.0.spkg\nmake[1]: *** [all] Error 2\n\nreal\t4m39.614s\nuser\t8m55.690s\nsys\t0m42.746s\n***************************************************************\nError building Sage.\n\nThe following package(s) may have failed to build (not necessarily\nduring this run of 'make all'):\n\n* package: gcc-7.2.0\n  log file: /Applications/sage/logs/pkgs/gcc-7.2.0.log\n  build directory: /Applications/sage/local/var/tmp/sage/build/gcc-7.2.0\n\n* package: givaro-4.0.2.p0\n  log file: /Applications/sage/logs/pkgs/givaro-4.0.2.p0.log\n  build directory: /Applications/sage/local/var/tmp/sage/build/givaro-4.0.2.p0\n\nThe build directory may contain configuration files and other potentially\nhelpful information. WARNING: if you now run 'make' again, the build\ndirectory will, by default, be deleted. Set the environment variable\nSAGE_KEEP_BUILT_SPKGS to 'yes' to prevent this.\n\nmake: *** [all] Error 1\n```\n",
    "created_at": "2017-10-06T06:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331062",
    "user": "https://github.com/anneschilling"
}
```

How did you get this to work? With this branch and downloading gcc-7.2.0.tar.gz, I still get an error when installing sage:

```
[ntl-10.3.0] libtool: install: cp -p .libs/libntl.33.dylib /Applications/sage/local/lib/libntl.33.dylib
[ntl-10.3.0] libtool: install: (cd /Applications/sage/local/lib && { ln -s -f libntl.33.dylib libntl.dylib || { rm -f libntl.dylib && ln -s libntl.33.dylib libntl.dylib; }; })
[ntl-10.3.0] libtool: install: cp -p .libs/libntl.lai /Applications/sage/local/lib/libntl.la
[ntl-10.3.0] libtool: install: cp -p .libs/libntl.a /Applications/sage/local/lib/libntl.a
[ntl-10.3.0] libtool: install: chmod 644 /Applications/sage/local/lib/libntl.a
[ntl-10.3.0] libtool: install: ranlib /Applications/sage/local/lib/libntl.a
[ntl-10.3.0] 
[ntl-10.3.0] real	4m38.570s
[ntl-10.3.0] user	7m31.224s
[ntl-10.3.0] sys	0m15.756s
[ntl-10.3.0] Successfully installed ntl-10.3.0
[ntl-10.3.0] Deleting temporary build directory
[ntl-10.3.0] /Applications/sage/local/var/tmp/sage/build/ntl-10.3.0
[ntl-10.3.0] Finished installing ntl-10.3.0.spkg
make[1]: *** [all] Error 2

real	4m39.614s
user	8m55.690s
sys	0m42.746s
***************************************************************
Error building Sage.

The following package(s) may have failed to build (not necessarily
during this run of 'make all'):

* package: gcc-7.2.0
  log file: /Applications/sage/logs/pkgs/gcc-7.2.0.log
  build directory: /Applications/sage/local/var/tmp/sage/build/gcc-7.2.0

* package: givaro-4.0.2.p0
  log file: /Applications/sage/logs/pkgs/givaro-4.0.2.p0.log
  build directory: /Applications/sage/local/var/tmp/sage/build/givaro-4.0.2.p0

The build directory may contain configuration files and other potentially
helpful information. WARNING: if you now run 'make' again, the build
directory will, by default, be deleted. Set the environment variable
SAGE_KEEP_BUILT_SPKGS to 'yes' to prevent this.

make: *** [all] Error 1
```




---

archive/issue_comments_331063.json:
```json
{
    "body": "Replying to [comment:14 aschilling]:\n> How did you get this to work? With this branch and downloading gcc-7.2.0.tar.gz, I still get an error when installing sage:\n\nMore info from `/Applications/sage/logs/pkgs/gcc-7.2.0.log` please.",
    "created_at": "2017-10-06T06:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331063",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:14 aschilling]:
> How did you get this to work? With this branch and downloading gcc-7.2.0.tar.gz, I still get an error when installing sage:

More info from `/Applications/sage/logs/pkgs/gcc-7.2.0.log` please.



---

archive/issue_comments_331064.json:
```json
{
    "body": "Replying to [comment:15 fbissey]:\n> Replying to [comment:14 aschilling]:\n> > How did you get this to work? With this branch and downloading gcc-7.2.0.tar.gz, I still get an error when installing sage:\n> \n> More info from `/Applications/sage/logs/pkgs/gcc-7.2.0.log` please.\n\nWhere in the tree should I put gcc-7.2.0.tar.gz?",
    "created_at": "2017-10-06T06:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331064",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:15 fbissey]:
> Replying to [comment:14 aschilling]:
> > How did you get this to work? With this branch and downloading gcc-7.2.0.tar.gz, I still get an error when installing sage:
> 
> More info from `/Applications/sage/logs/pkgs/gcc-7.2.0.log` please.

Where in the tree should I put gcc-7.2.0.tar.gz?



---

archive/issue_comments_331065.json:
```json
{
    "body": "in `upstream/`.",
    "created_at": "2017-10-06T06:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331065",
    "user": "https://github.com/kiwifb"
}
```

in `upstream/`.



---

archive/issue_comments_331066.json:
```json
{
    "body": "Replying to [comment:17 fbissey]:\n> in `upstream/`.\n\nThat is where I put it. But somehow it tries to download it from mirrors\n\n```\nFound local metadata for gcc-7.2.0\nAttempting to download package gcc-7.2.0.tar.gz from mirrors\nhttp://mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nhttp://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nhttp://files.sagemath.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n....\nERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nTraceback (most recent call last):\n  File \"/Applications/sage/build/bin/sage-download-file\", line 28, in <module>\n    run_safe()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 118, in run_safe\n    run()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 100, in run\n    app.download_tarball(args.url_or_tarball, args.destination)\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/app.py\", line 43, in download_tarball\n    tarball.download()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/tarball.py\", line 161, in download\n    raise FileNotMirroredError('tarball does not exist on mirror network')\nsage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network\n************************************************************************\nError downloading gcc-7.2.0.tar.gz\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the log file\n  /Applications/sage/logs/pkgs/gcc-7.2.0.log\nDescribe your computer, operating system, etc.\n************************************************************************\nFound local metadata for gcc-7.2.0\nAttempting to download package gcc-7.2.0.tar.gz from mirrors\nhttp://mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nhttp://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nhttp://files.sagemath.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n...\nERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nTraceback (most recent call last):\n  File \"/Applications/sage/build/bin/sage-download-file\", line 28, in <module>\n    run_safe()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 118, in run_safe\n    run()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 100, in run\n    app.download_tarball(args.url_or_tarball, args.destination)\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/app.py\", line 43, in download_tarball\n    tarball.download()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/tarball.py\", line 161, in download\n    raise FileNotMirroredError('tarball does not exist on mirror network')\nsage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network\n************************************************************************\nError downloading gcc-7.2.0.tar.gz\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the log file\n  /Applications/sage/logs/pkgs/gcc-7.2.0.log\nDescribe your computer, operating system, etc.\n************************************************************************\nFound local metadata for gcc-7.2.0\nAttempting to download package gcc-7.2.0.tar.gz from mirrors\nhttp://mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nhttp://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nhttp://files.sagemath.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz\n...\n[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\nERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz'\nTraceback (most recent call last):\n  File \"/Applications/sage/build/bin/sage-download-file\", line 28, in <module>\n    run_safe()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 118, in run_safe\n    run()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 100, in run\n    app.download_tarball(args.url_or_tarball, args.destination)\n  File \"/Applications/sage/build/bin/../sage_bootstrap/download/app.py\", line 43, in download_tarball\n    tarball.download()\n  File \"/Applications/sage/build/bin/../sage_bootstrap/tarball.py\", line 161, in download\n    raise FileNotMirroredError('tarball does not exist on mirror network')\nsage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network\n************************************************************************\nError downloading gcc-7.2.0.tar.gz\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the log file\n  /Applications/sage/logs/pkgs/gcc-7.2.0.log\nDescribe your computer, operating system, etc.\n************************************************************************\n\n```\n",
    "created_at": "2017-10-06T06:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331066",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:17 fbissey]:
> in `upstream/`.

That is where I put it. But somehow it tries to download it from mirrors

```
Found local metadata for gcc-7.2.0
Attempting to download package gcc-7.2.0.tar.gz from mirrors
http://mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
http://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
http://files.sagemath.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz
....
ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
Traceback (most recent call last):
  File "/Applications/sage/build/bin/sage-download-file", line 28, in <module>
    run_safe()
  File "/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 118, in run_safe
    run()
  File "/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 100, in run
    app.download_tarball(args.url_or_tarball, args.destination)
  File "/Applications/sage/build/bin/../sage_bootstrap/download/app.py", line 43, in download_tarball
    tarball.download()
  File "/Applications/sage/build/bin/../sage_bootstrap/tarball.py", line 161, in download
    raise FileNotMirroredError('tarball does not exist on mirror network')
sage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network
************************************************************************
Error downloading gcc-7.2.0.tar.gz
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log file
  /Applications/sage/logs/pkgs/gcc-7.2.0.log
Describe your computer, operating system, etc.
************************************************************************
Found local metadata for gcc-7.2.0
Attempting to download package gcc-7.2.0.tar.gz from mirrors
http://mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
http://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
http://files.sagemath.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz
...
ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
Traceback (most recent call last):
  File "/Applications/sage/build/bin/sage-download-file", line 28, in <module>
    run_safe()
  File "/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 118, in run_safe
    run()
  File "/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 100, in run
    app.download_tarball(args.url_or_tarball, args.destination)
  File "/Applications/sage/build/bin/../sage_bootstrap/download/app.py", line 43, in download_tarball
    tarball.download()
  File "/Applications/sage/build/bin/../sage_bootstrap/tarball.py", line 161, in download
    raise FileNotMirroredError('tarball does not exist on mirror network')
sage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network
************************************************************************
Error downloading gcc-7.2.0.tar.gz
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log file
  /Applications/sage/logs/pkgs/gcc-7.2.0.log
Describe your computer, operating system, etc.
************************************************************************
Found local metadata for gcc-7.2.0
Attempting to download package gcc-7.2.0.tar.gz from mirrors
http://mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors.xmission.com/sage/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
http://mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//mirrors-usa.go-parts.com/sage/sagemath/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
http://files.sagemath.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz
...
[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
ERROR [transfer|run:135]: [Errno 404] Not Found: '//sagepad.org/spkg/upstream/gcc/gcc-7.2.0.tar.gz'
Traceback (most recent call last):
  File "/Applications/sage/build/bin/sage-download-file", line 28, in <module>
    run_safe()
  File "/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 118, in run_safe
    run()
  File "/Applications/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 100, in run
    app.download_tarball(args.url_or_tarball, args.destination)
  File "/Applications/sage/build/bin/../sage_bootstrap/download/app.py", line 43, in download_tarball
    tarball.download()
  File "/Applications/sage/build/bin/../sage_bootstrap/tarball.py", line 161, in download
    raise FileNotMirroredError('tarball does not exist on mirror network')
sage_bootstrap.tarball.FileNotMirroredError: tarball does not exist on mirror network
************************************************************************
Error downloading gcc-7.2.0.tar.gz
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log file
  /Applications/sage/logs/pkgs/gcc-7.2.0.log
Describe your computer, operating system, etc.
************************************************************************

```




---

archive/issue_comments_331067.json:
```json
{
    "body": "Works well on Fedora 26, all tests pass. I did the following:\n \n* get the tarfile in upstream/\n* get the branch via git\n* $ make distclean\n* $ SAGE_INSTALL_GCC=yes ./configure\n* $ SAGE_INSTALL_GCC=yes make ptestlong",
    "created_at": "2017-10-06T06:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331067",
    "user": "https://github.com/dimpase"
}
```

Works well on Fedora 26, all tests pass. I did the following:
 
* get the tarfile in upstream/
* get the branch via git
* $ make distclean
* $ SAGE_INSTALL_GCC=yes ./configure
* $ SAGE_INSTALL_GCC=yes make ptestlong



---

archive/issue_comments_331068.json:
```json
{
    "body": "Not all gcc mirror seem to carry the same tarball. When I did experiments last week, one mirror was carrying a >100MB tarball (with several other stuff included like go) compared to the one on the main mirror. So get the one linked here rather than the one on a closer mirror. Someone messed up big time upstream.",
    "created_at": "2017-10-06T06:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331068",
    "user": "https://github.com/kiwifb"
}
```

Not all gcc mirror seem to carry the same tarball. When I did experiments last week, one mirror was carrying a >100MB tarball (with several other stuff included like go) compared to the one on the main mirror. So get the one linked here rather than the one on a closer mirror. Someone messed up big time upstream.



---

archive/issue_comments_331069.json:
```json
{
    "body": "For Europeans the fu-berlin tarball seems fine.",
    "created_at": "2017-10-06T06:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331069",
    "user": "https://github.com/rwst"
}
```

For Europeans the fu-berlin tarball seems fine.



---

archive/issue_comments_331070.json:
```json
{
    "body": "Replying to [comment:18 aschilling]:\n> Replying to [comment:17 fbissey]:\n> > in `upstream/`.\n> \n> That is where I put it. But somehow it tries to download it from mirrors\n\nThis might indicate that the tarball you got didn't match - then it is silently deleted and an attempt to download one is made.\n\nThe tarball linked is huge, in fact, over 100Mb.",
    "created_at": "2017-10-06T06:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331070",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:18 aschilling]:
> Replying to [comment:17 fbissey]:
> > in `upstream/`.
> 
> That is where I put it. But somehow it tries to download it from mirrors

This might indicate that the tarball you got didn't match - then it is silently deleted and an attempt to download one is made.

The tarball linked is huge, in fact, over 100Mb.



---

archive/issue_comments_331071.json:
```json
{
    "body": "Checking my numbers. The tarball I got is 107MB, the one I first downloaded was actually several hundreds MB.",
    "created_at": "2017-10-06T06:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331071",
    "user": "https://github.com/kiwifb"
}
```

Checking my numbers. The tarball I got is 107MB, the one I first downloaded was actually several hundreds MB.



---

archive/issue_comments_331072.json:
```json
{
    "body": "Replying to [comment:22 dimpase]:\n> Replying to [comment:18 aschilling]:\n> > Replying to [comment:17 fbissey]:\n> > > in `upstream/`.\n> > \n> > That is where I put it. But somehow it tries to download it from mirrors\n> \n> This might indicate that the tarball you got didn't match - then it is silently deleted and an attempt to download one is made.\n\nI have opened #23972 to rectify the silent tarball deletion.",
    "created_at": "2017-10-06T06:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331072",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:22 dimpase]:
> Replying to [comment:18 aschilling]:
> > Replying to [comment:17 fbissey]:
> > > in `upstream/`.
> > 
> > That is where I put it. But somehow it tries to download it from mirrors
> 
> This might indicate that the tarball you got didn't match - then it is silently deleted and an attempt to download one is made.

I have opened #23972 to rectify the silent tarball deletion.



---

archive/issue_comments_331073.json:
```json
{
    "body": "Note that we can use a smaller tarball (maybe 60MB?) if we use a `.xz` file instead. No other Sage packages use `.xz` files, so I was reluctant to try here.",
    "created_at": "2017-10-06T14:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331073",
    "user": "https://github.com/jhpalmieri"
}
```

Note that we can use a smaller tarball (maybe 60MB?) if we use a `.xz` file instead. No other Sage packages use `.xz` files, so I was reluctant to try here.



---

archive/issue_comments_331074.json:
```json
{
    "body": "Sage comes with an `xz` standard package. So this would just be a matter of adding `.xz` support to the Sage build system. I think it would be good anyway to do that, but please create a new ticket for that.",
    "created_at": "2017-10-06T15:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331074",
    "user": "https://github.com/jdemeyer"
}
```

Sage comes with an `xz` standard package. So this would just be a matter of adding `.xz` support to the Sage build system. I think it would be good anyway to do that, but please create a new ticket for that.



---

archive/issue_comments_331075.json:
```json
{
    "body": "Thanks for your comments! I downloaded gcc-7.2.0.tar.gz again and followed Dima's instructions. Now Sage compiles!",
    "created_at": "2017-10-06T16:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331075",
    "user": "https://github.com/anneschilling"
}
```

Thanks for your comments! I downloaded gcc-7.2.0.tar.gz again and followed Dima's instructions. Now Sage compiles!



---

archive/issue_comments_331076.json:
```json
{
    "body": "Replying to [comment:26 jdemeyer]:\n> Sage comes with an `xz` standard package. So this would just be a matter of adding `.xz` support to the Sage build system. I think it would be good anyway to do that, but please create a new ticket for that.\n\nSince we rely on the system's pre-existing Python for package decompression and since `lzma` support is only available in Python 3, this won't be as simple as what we currently do for tar files. In particular, `tarfile.is_tarfile('gcc-7.2.0.tar.xz')` returns `True` in Python 3 but `False` in Python 2.",
    "created_at": "2017-10-06T18:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331076",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:26 jdemeyer]:
> Sage comes with an `xz` standard package. So this would just be a matter of adding `.xz` support to the Sage build system. I think it would be good anyway to do that, but please create a new ticket for that.

Since we rely on the system's pre-existing Python for package decompression and since `lzma` support is only available in Python 3, this won't be as simple as what we currently do for tar files. In particular, `tarfile.is_tarfile('gcc-7.2.0.tar.xz')` returns `True` in Python 3 but `False` in Python 2.



---

archive/issue_comments_331077.json:
```json
{
    "body": "Replying to [comment:26 jdemeyer]:\n> Sage comes with an `xz` standard package. So this would just be a matter of adding `.xz` support to the Sage build system. I think it would be good anyway to do that, but please create a new ticket for that.\n\nSee #18236.",
    "created_at": "2017-10-06T19:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331077",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:26 jdemeyer]:
> Sage comes with an `xz` standard package. So this would just be a matter of adding `.xz` support to the Sage build system. I think it would be good anyway to do that, but please create a new ticket for that.

See #18236.



---

archive/issue_comments_331078.json:
```json
{
    "body": "Replying to [comment:28 jhpalmieri]:\n> Since we rely on the system's pre-existing Python for package decompression and since `lzma` support is only available in Python 3, this won't be as simple as what we currently do for tar files. In particular, `tarfile.is_tarfile('gcc-7.2.0.tar.xz')` returns `True` in Python 3 but `False` in Python 2.\n\nRight. I forgot that we use Python these days to uncompress tarballs. For a long time, this was done by a shell script. Still, it doesn't mean that it won't work with Python, we can manually call the `xz` program.",
    "created_at": "2017-10-07T08:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331078",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:28 jhpalmieri]:
> Since we rely on the system's pre-existing Python for package decompression and since `lzma` support is only available in Python 3, this won't be as simple as what we currently do for tar files. In particular, `tarfile.is_tarfile('gcc-7.2.0.tar.xz')` returns `True` in Python 3 but `False` in Python 2.

Right. I forgot that we use Python these days to uncompress tarballs. For a long time, this was done by a shell script. Still, it doesn't mean that it won't work with Python, we can manually call the `xz` program.



---

archive/issue_comments_331079.json:
```json
{
    "body": "It appears there is a \"backport\": https://pypi.python.org/pypi/backports.lzma/",
    "created_at": "2017-10-07T09:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331079",
    "user": "https://github.com/kiwifb"
}
```

It appears there is a "backport": https://pypi.python.org/pypi/backports.lzma/



---

archive/issue_comments_331080.json:
```json
{
    "body": "Replying to [comment:31 fbissey]:\n> It appears there is a \"backport\": https://pypi.python.org/pypi/backports.lzma/\n\nThat is not relevant for Sage because we use the *system* Python to uncompress tarballs.",
    "created_at": "2017-10-07T10:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331080",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:31 fbissey]:
> It appears there is a "backport": https://pypi.python.org/pypi/backports.lzma/

That is not relevant for Sage because we use the *system* Python to uncompress tarballs.



---

archive/issue_comments_331081.json:
```json
{
    "body": "Anyway, the discussion about `.xz` tarballs should be continued on #18236.",
    "created_at": "2017-10-07T10:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331081",
    "user": "https://github.com/jdemeyer"
}
```

Anyway, the discussion about `.xz` tarballs should be continued on #18236.



---

archive/issue_comments_331082.json:
```json
{
    "body": "install.log",
    "created_at": "2017-10-07T13:18:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331082",
    "user": "https://github.com/rwst"
}
```

install.log



---

archive/issue_comments_331083.json:
```json
{
    "body": "Attachment [install.log](tarball://root/attachments/some-uuid/ticket23898/install.log) by @rwst created at 2017-10-07 13:19:17\n\nOn OpenSuSE 42.2 lcalc does not build, see above for log.",
    "created_at": "2017-10-07T13:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331083",
    "user": "https://github.com/rwst"
}
```

Attachment [install.log](tarball://root/attachments/some-uuid/ticket23898/install.log) by @rwst created at 2017-10-07 13:19:17

On OpenSuSE 42.2 lcalc does not build, see above for log.



---

archive/issue_comments_331084.json:
```json
{
    "body": "See https://sourceware.org/bugzilla/show_bug.cgi?id=19590",
    "created_at": "2017-10-07T13:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331084",
    "user": "https://github.com/rwst"
}
```

See https://sourceware.org/bugzilla/show_bug.cgi?id=19590



---

archive/issue_comments_331085.json:
```json
{
    "body": "Indeed both the OpenSuSE gcc-5.3.1 and the installed gcc-7.2.0 fail the test case given in that link, the system glibc is 2.22-4.9.1 which is older than the glibc in the above bug report.",
    "created_at": "2017-10-07T13:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331085",
    "user": "https://github.com/rwst"
}
```

Indeed both the OpenSuSE gcc-5.3.1 and the installed gcc-7.2.0 fail the test case given in that link, the system glibc is 2.22-4.9.1 which is older than the glibc in the above bug report.



---

archive/issue_comments_331086.json:
```json
{
    "body": "The test case passes if I remove `-ffast-math` from the compile options. How do I remove it when compiling lcalc?",
    "created_at": "2017-10-07T13:47:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331086",
    "user": "https://github.com/rwst"
}
```

The test case passes if I remove `-ffast-math` from the compile options. How do I remove it when compiling lcalc?



---

archive/issue_comments_331087.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-07T14:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331087",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_331088.json:
```json
{
    "body": "In our lcalc-1.23 the line `lcalc-1.23/src/Makefile:MACHINE_SPECIFIC_FLAGS = -ffast-math -fPIC` is no longer in the newer version at https://github.com/dimpase/lcalc which is enhanced from the last official version at https://code.google.com/archive/p/l-calc/, see #23341#comment:35\n\nSo, in order to enable building on systems with glibc < 2.23 at least the lcalc Makefile should be patched. Even better would be the upgrade to the version at https://github.com/dimpase/lcalc. I propose to hijack #23341 for this and make it a dependency of this ticket.",
    "created_at": "2017-10-07T14:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331088",
    "user": "https://github.com/rwst"
}
```

In our lcalc-1.23 the line `lcalc-1.23/src/Makefile:MACHINE_SPECIFIC_FLAGS = -ffast-math -fPIC` is no longer in the newer version at https://github.com/dimpase/lcalc which is enhanced from the last official version at https://code.google.com/archive/p/l-calc/, see #23341#comment:35

So, in order to enable building on systems with glibc < 2.23 at least the lcalc Makefile should be patched. Even better would be the upgrade to the version at https://github.com/dimpase/lcalc. I propose to hijack #23341 for this and make it a dependency of this ticket.



---

archive/issue_comments_331089.json:
```json
{
    "body": "If you don't want the dependency, the patch that makes lcalc compile and install here:\n\n```\n--- a/src/Makefile.old\t2017-10-07 16:51:18.112467539 +0200\n+++ a/src/Makefile\t2017-10-07 16:51:51.901214940 +0200\n@@ -41,7 +41,7 @@\n \n \n #MACHINE_SPECIFIC_FLAGS = -Wno-long-double\n-MACHINE_SPECIFIC_FLAGS = -ffast-math -fPIC\n+MACHINE_SPECIFIC_FLAGS = -fPIC\n \n #G4 = FALSE\n #ifeq ($(G4),TRUE)\n```\n",
    "created_at": "2017-10-07T14:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331089",
    "user": "https://github.com/rwst"
}
```

If you don't want the dependency, the patch that makes lcalc compile and install here:

```
--- a/src/Makefile.old	2017-10-07 16:51:18.112467539 +0200
+++ a/src/Makefile	2017-10-07 16:51:51.901214940 +0200
@@ -41,7 +41,7 @@
 
 
 #MACHINE_SPECIFIC_FLAGS = -Wno-long-double
-MACHINE_SPECIFIC_FLAGS = -ffast-math -fPIC
+MACHINE_SPECIFIC_FLAGS = -fPIC
 
 #G4 = FALSE
 #ifeq ($(G4),TRUE)
```




---

archive/issue_comments_331090.json:
```json
{
    "body": "Replying to [comment:36 rws]:\n> Indeed both the OpenSuSE gcc-5.3.1 and the installed gcc-7.2.0 fail the test case given in that link, the system glibc is 2.22-4.9.1 which is older than the glibc in the above bug report.\n\nSo it seems that the lcalc issue has nothing to do with this ticket.",
    "created_at": "2017-10-07T15:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331090",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:36 rws]:
> Indeed both the OpenSuSE gcc-5.3.1 and the installed gcc-7.2.0 fail the test case given in that link, the system glibc is 2.22-4.9.1 which is older than the glibc in the above bug report.

So it seems that the lcalc issue has nothing to do with this ticket.



---

archive/issue_comments_331091.json:
```json
{
    "body": "Replying to [comment:40 jdemeyer]:\n> Replying to [comment:36 rws]:\n> > Indeed both the OpenSuSE gcc-5.3.1 and the installed gcc-7.2.0 fail the test case given in that link, the system glibc is 2.22-4.9.1 which is older than the glibc in the above bug report.\n> \n> So it seems that the lcalc issue has nothing to do with this ticket.\n\nThere is the possibility the OpenSuSE gcc-5.3.1 has something our gcc-5.4.0 does not have. I'm compiling 5.4.0 right now.",
    "created_at": "2017-10-07T15:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331091",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:40 jdemeyer]:
> Replying to [comment:36 rws]:
> > Indeed both the OpenSuSE gcc-5.3.1 and the installed gcc-7.2.0 fail the test case given in that link, the system glibc is 2.22-4.9.1 which is older than the glibc in the above bug report.
> 
> So it seems that the lcalc issue has nothing to do with this ticket.

There is the possibility the OpenSuSE gcc-5.3.1 has something our gcc-5.4.0 does not have. I'm compiling 5.4.0 right now.



---

archive/issue_comments_331092.json:
```json
{
    "body": "The test file (EDITED: and lcalc) compiles with 5.4.0. That's why I didn't notice the problem earlier: because of #21811 I had the Sage-internal gcc installed. So, it all is relevant for this ticket.",
    "created_at": "2017-10-07T15:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331092",
    "user": "https://github.com/rwst"
}
```

The test file (EDITED: and lcalc) compiles with 5.4.0. That's why I didn't notice the problem earlier: because of #21811 I had the Sage-internal gcc installed. So, it all is relevant for this ticket.



---

archive/issue_comments_331093.json:
```json
{
    "body": "Replying to [comment:30 jdemeyer]:\n> Right. I forgot that we use Python these days to uncompress tarballs.\n\nDoes this mean that `bzip2` should just be a regular package, not part of the `base` Makefile target?",
    "created_at": "2017-10-07T23:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331093",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:30 jdemeyer]:
> Right. I forgot that we use Python these days to uncompress tarballs.

Does this mean that `bzip2` should just be a regular package, not part of the `base` Makefile target?



---

archive/issue_comments_331094.json:
```json
{
    "body": "Replying to [comment:43 jhpalmieri]:\n> Does this mean that `bzip2` should just be a regular package, not part of the `base` Makefile target?\n\nSee #24005",
    "created_at": "2017-10-10T10:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331094",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:43 jhpalmieri]:
> Does this mean that `bzip2` should just be a regular package, not part of the `base` Makefile target?

See #24005



---

archive/issue_comments_331095.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-10-10T12:10:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331095",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_331096.json:
```json
{
    "body": "This breaks the optional package `pysingular`:\n\n```\n[pysingular-0.9.1]     gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -DPYTHON_VERSION_OLDER_THREE_FIVE=1 -I/home/jdemeyer/sage/local/include/singular -I/home/jdemeyer/sage/local/include/python2.7 -c SingularModule.cpp -o build/temp.linux-x86_64-2.7/SingularModule.o\n[pysingular-0.9.1]     SingularModule.cpp: In function 'PyObject* GetSingularCompletion(PyObject*, PyObject*)':\n[pysingular-0.9.1]     SingularModule.cpp:140:47: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]\n[pysingular-0.9.1]          while( singular_complete_return[ pos ] != '\\0' ){\n[pysingular-0.9.1]                                                    ^~~~\n[pysingular-0.9.1]     error: command 'gcc' failed with exit status 1\n[pysingular-0.9.1]     Running setup.py install for PySingular: finished with status 'error'\n```\n",
    "created_at": "2017-10-11T09:53:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331096",
    "user": "https://github.com/jdemeyer"
}
```

This breaks the optional package `pysingular`:

```
[pysingular-0.9.1]     gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -DPYTHON_VERSION_OLDER_THREE_FIVE=1 -I/home/jdemeyer/sage/local/include/singular -I/home/jdemeyer/sage/local/include/python2.7 -c SingularModule.cpp -o build/temp.linux-x86_64-2.7/SingularModule.o
[pysingular-0.9.1]     SingularModule.cpp: In function 'PyObject* GetSingularCompletion(PyObject*, PyObject*)':
[pysingular-0.9.1]     SingularModule.cpp:140:47: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]
[pysingular-0.9.1]          while( singular_complete_return[ pos ] != '\0' ){
[pysingular-0.9.1]                                                    ^~~~
[pysingular-0.9.1]     error: command 'gcc' failed with exit status 1
[pysingular-0.9.1]     Running setup.py install for PySingular: finished with status 'error'
```




---

archive/issue_comments_331097.json:
```json
{
    "body": "Replying to [comment:48 jdemeyer]:\n> This breaks the optional package `pysingular`:\n> {{{\n> [pysingular-0.9.1]     gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -DPYTHON_VERSION_OLDER_THREE_FIVE=1 -I/home/jdemeyer/sage/local/include/singular -I/home/jdemeyer/sage/local/include/python2.7 -c SingularModule.cpp -o build/temp.linux-x86_64-2.7/SingularModule.o\n> [pysingular-0.9.1]     SingularModule.cpp: In function 'PyObject* GetSingularCompletion(PyObject*, PyObject*)':\n> [pysingular-0.9.1]     SingularModule.cpp:140:47: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]\n\nThat is, it's a bug there in pysingular.",
    "created_at": "2017-10-11T10:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331097",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:48 jdemeyer]:
> This breaks the optional package `pysingular`:
> {{{
> [pysingular-0.9.1]     gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -DPYTHON_VERSION_OLDER_THREE_FIVE=1 -I/home/jdemeyer/sage/local/include/singular -I/home/jdemeyer/sage/local/include/python2.7 -c SingularModule.cpp -o build/temp.linux-x86_64-2.7/SingularModule.o
> [pysingular-0.9.1]     SingularModule.cpp: In function 'PyObject* GetSingularCompletion(PyObject*, PyObject*)':
> [pysingular-0.9.1]     SingularModule.cpp:140:47: error: ISO C++ forbids comparison between pointer and integer [-fpermissive]

That is, it's a bug there in pysingular.



---

archive/issue_comments_331098.json:
```json
{
    "body": "Also gambit fails to build: https://github.com/gambitproject/gambit/issues/220",
    "created_at": "2017-10-11T10:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331098",
    "user": "https://github.com/jdemeyer"
}
```

Also gambit fails to build: https://github.com/gambitproject/gambit/issues/220



---

archive/issue_comments_331099.json:
```json
{
    "body": "All other optional packages build.",
    "created_at": "2017-10-11T10:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331099",
    "user": "https://github.com/jdemeyer"
}
```

All other optional packages build.



---

archive/issue_comments_331100.json:
```json
{
    "body": "...and all doctests pass.",
    "created_at": "2017-10-11T11:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331100",
    "user": "https://github.com/jdemeyer"
}
```

...and all doctests pass.



---

archive/issue_comments_331101.json:
```json
{
    "body": "So the only remaining issue now is that lcalc doesn't build with GCC-7.2.0 with old glibc versions...",
    "created_at": "2017-10-13T08:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331101",
    "user": "https://github.com/jdemeyer"
}
```

So the only remaining issue now is that lcalc doesn't build with GCC-7.2.0 with old glibc versions...



---

archive/issue_comments_331102.json:
```json
{
    "body": "Replying to [comment:54 jdemeyer]:\n> So the only remaining issue now is that lcalc doesn't build with GCC-7.2.0 with old glibc versions...\n\nI don't really have any suggestions for how to deal with that. Patch the makefile as in comment:39?",
    "created_at": "2017-10-13T16:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331102",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:54 jdemeyer]:
> So the only remaining issue now is that lcalc doesn't build with GCC-7.2.0 with old glibc versions...

I don't really have any suggestions for how to deal with that. Patch the makefile as in comment:39?



---

archive/issue_comments_331103.json:
```json
{
    "body": "Replying to [comment:54 jdemeyer]:\n> So the only remaining issue now is that lcalc doesn't build with GCC-7.2.0 with old glibc versions...\n\ndid you try one of these lcalc patches mentioned in #23919 ?",
    "created_at": "2017-10-19T08:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331103",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:54 jdemeyer]:
> So the only remaining issue now is that lcalc doesn't build with GCC-7.2.0 with old glibc versions...

did you try one of these lcalc patches mentioned in #23919 ?



---

archive/issue_comments_331104.json:
```json
{
    "body": "We need someone with an old glibc who can test out different patches. Would it be worth trying (on another ticket) upgrading to GCC 6.4.0? We need to get something into Sage so it will build with the most recent version of OS X and Xcode.",
    "created_at": "2017-10-20T18:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331104",
    "user": "https://github.com/jhpalmieri"
}
```

We need someone with an old glibc who can test out different patches. Would it be worth trying (on another ticket) upgrading to GCC 6.4.0? We need to get something into Sage so it will build with the most recent version of OS X and Xcode.



---

archive/issue_comments_331105.json:
```json
{
    "body": "Replying to [comment:57 jhpalmieri]:\n> We need someone with an old glibc who can test out different patches.\n\nI upgraded recently and now have glibc-2.22-8.4.",
    "created_at": "2017-10-21T06:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331105",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:57 jhpalmieri]:
> We need someone with an old glibc who can test out different patches.

I upgraded recently and now have glibc-2.22-8.4.



---

archive/issue_comments_331106.json:
```json
{
    "body": "Replying to [comment:58 rws]:\n> Replying to [comment:57 jhpalmieri]:\n> > We need someone with an old glibc who can test out different patches.\n> \n> I upgraded recently and now have glibc-2.22-8.4.\n\nDoes this now build for you?",
    "created_at": "2017-10-21T22:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331106",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:58 rws]:
> Replying to [comment:57 jhpalmieri]:
> > We need someone with an old glibc who can test out different patches.
> 
> I upgraded recently and now have glibc-2.22-8.4.

Does this now build for you?



---

archive/issue_comments_331107.json:
```json
{
    "body": "Replying to [comment:59 jhpalmieri]:\n> > I upgraded recently and now have glibc-2.22-8.4.\n> \n> Does this now build for you?\n\nThis branch merged with 8.1.beta9 builds from distclean, after two failures to build brial (`pkg_resources.DistributionNotFound: The 'pip' distribution was not found`). Just restarting the make succeeded. This was after upgrading OpenSuSE from 42.2 to 42.3.\n\nI'd suggest requiring the 42.3 upgrade as it is no pain and very easy to do.",
    "created_at": "2017-10-24T13:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331107",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:59 jhpalmieri]:
> > I upgraded recently and now have glibc-2.22-8.4.
> 
> Does this now build for you?

This branch merged with 8.1.beta9 builds from distclean, after two failures to build brial (`pkg_resources.DistributionNotFound: The 'pip' distribution was not found`). Just restarting the make succeeded. This was after upgrading OpenSuSE from 42.2 to 42.3.

I'd suggest requiring the 42.3 upgrade as it is no pain and very easy to do.



---

archive/issue_comments_331108.json:
```json
{
    "body": "I'm upgrading this to a blocker because we need to upgrade gcc to build on the most recent OS X. I am happy with Jeroen's changes (to use `.xz` instead of `.gz`).",
    "created_at": "2017-10-24T14:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331108",
    "user": "https://github.com/jhpalmieri"
}
```

I'm upgrading this to a blocker because we need to upgrade gcc to build on the most recent OS X. I am happy with Jeroen's changes (to use `.xz` instead of `.gz`).



---

archive/issue_comments_331109.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-24T14:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331109",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_331110.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2017-10-24T14:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331110",
    "user": "https://github.com/jhpalmieri"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_331111.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-24T15:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331111",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_331112.json:
```json
{
    "body": "So, the patch is trivially looking good, and it's tested on Xcode 8/9, Linux Fedora 26, and OpenSuSE Leap 42.3.",
    "created_at": "2017-10-24T15:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331112",
    "user": "https://github.com/rwst"
}
```

So, the patch is trivially looking good, and it's tested on Xcode 8/9, Linux Fedora 26, and OpenSuSE Leap 42.3.



---

archive/issue_comments_331113.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-29T10:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23661#issuecomment-331113",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_060850.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-29T10:32:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23661",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23661#event-60850"
}
```
