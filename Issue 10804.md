# Issue 10804: Bug in integer_mod powering non-invertible base and negative exponents

Issue created by migration from https://trac.sagemath.org/ticket/10873

Original creator: robertwb

Original creation time: 2011-03-04 08:34:08

Assignee: AlexGhitza

CC:  kcrisman


```
sage: mod(2, 990)^-1
------------------------------------------------------------
Traceback (most recent call last):
  File "<ipython console>", line 1, in <module>
RuntimeError
```



---

Attachment


---

Comment by robertwb created at 2011-03-04 08:35:41

Changing status from new to needs_review.


---

Comment by mariah created at 2011-05-17 13:55:04

Changing status from needs_review to needs_work.


---

Comment by mariah created at 2011-05-17 13:55:04

The patch fails to apply to sage-4.7.rc2:


```
sage: hg_sage.apply("/home/mariah/10873-mod-pow.patch")
cd "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-review-10873/devel/sage" && hg status
cd "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-review-10873/devel/sage" && hg status
cd "/home/mariah/sage/sage-4.7.rc2-x86_64-Linux-core2-fc-review-10873/devel/sage" && hg import   "/home/mariah/10873-mod-pow.patch"
applying /home/mariah/10873-mod-pow.patch
patching file sage/rings/finite_rings/integer_mod.pyx
Hunk #2 FAILED at 1637
Hunk #5 FAILED at 2131
Hunk #7 FAILED at 2933
3 out of 8 hunks FAILED -- saving rejects to file sage/rings/finite_rings/integer_mod.pyx.rej
abort: patch failed to apply
sage:
```



---

Comment by robertwb created at 2011-05-31 07:10:09

FIxed _sig_on -> sig_on() conflict.


---

Comment by robertwb created at 2011-05-31 07:10:09

Changing status from needs_work to needs_review.


---

Comment by robertwb created at 2011-06-01 04:37:19

apply only this patch


---

Comment by mariah created at 2011-06-01 13:39:38

Changing status from needs_review to needs_work.


---

Attachment

patch [attachment:10873-mod-pow-rebased.patch] applied to sage-4.7.1.alpha1, then did 'make testlong'.  Got the following error:


```
sage -t -long -force_lib "devel/sage/sage/rings/finite_rings/integer_mod.pyx"
ESC[?1034h**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha1-x86_64-Linux-core2-fc-review-10873/devel/sage/sage/rings/finite_rings/integer_mod.pyx", iled example:
    sig_on_count()
Expected:
    0
Got:
    1
**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha1-x86_64-Linux-core2-fc-review-10873/devel/sage/sage/rings/finite_rings/integer_mod.pyx", iled example:
    sig_on_count()
Expected:
    0
Got:
    1
**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha1-x86_64-Linux-core2-fc-review-10873/devel/sage/sage/rings/finite_rings/integer_mod.pyx", iled example:
    sig_on_count()
Expected:
    0
Got:
    1
**********************************************************************
```


etc.


---

Comment by robertwb created at 2011-06-01 16:35:22

How long ago was this? (I posted an updated version of the patch when I saw these errors on the patchbot, maybe you grabbed the old one?)


---

Comment by mariah created at 2011-06-01 19:57:29

Replying to [comment:6 robertwb]:
> How long ago was this? (I posted an updated version of the patch when I saw these errors on the patchbot, maybe you grabbed the old one?)

I now believe that what I am seeing is not due to your patch but to a relocation bug in sage-4.7.1-alpha1.  See #11419.  Apologies.


---

Comment by robertwb created at 2011-06-01 20:28:28

Changing status from needs_work to needs_review.


---

Comment by robertwb created at 2011-06-01 20:28:28

No problem, I'm just glad you're taking the time to look at my tickets :).


---

Comment by mariah created at 2011-06-02 17:31:30

Changing status from needs_review to positive_review.


---

Comment by mariah created at 2011-06-02 17:31:30

Applied patch, did 'sage -b', then 'make testlong'.  All tests passed.  Positive review!


---

Comment by jdemeyer created at 2011-06-14 19:23:14

Resolution: fixed
