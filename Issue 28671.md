# Issue 28671: spkg-configure for cbc

Issue created by migration from https://trac.sagemath.org/ticket/28908

Original creator: mkoeppe

Original creation time: 2019-12-25 15:39:18

CC:  dimpase

We add `spkg-configure` for the optional package `cbc`.


---

Comment by dimpase created at 2019-12-26 02:09:48

Sage's cbc lists quite a few dependencies (readline zlib bzip2 $(BLAS)) , but none are checked by spkg-configure, whereas they are really there, as may be seen on Debian by running

```
ldd /usr/lib/x86_64-linux-gnu/libCbc.so.3
```


It seems that cbc.pc file is lacking in this sense (along with its dependencies, it seems they don't bother with anything that is external to , they really should list them - should it be reported to upstream?

Anyhow, we should write these deps out, as it's done in e.g. gsl's ticket #28879


```m4
SAGE_SPKG_CONFIGURE([cbc], [
  SAGE_SPKG_DEPCHECK([atlas openblas zlib bzip2], [
    dnl  checking with pkg-config
    PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])
  ])
])
```


Perhaps we should update the copy of cbc.pc, to include all these deps
(more precisely, all but altlas) in the `Requires:` field. 





----
New commits:


---

Comment by mkoeppe created at 2019-12-27 04:22:37

Replying to [comment:3 dimpase]:
> Sage's cbc lists quite a few dependencies (readline zlib bzip2 $(BLAS)) , but none are checked by spkg-configure ...
> It seems that cbc.pc file is lacking in this sense (along with its dependencies, it seems they don't bother with anything that is external to , they really should list them - should it be reported to upstream?

I'm sure they'd like to know, please go ahead.

> Anyhow, we should write these deps out, as it's done in e.g. gsl's ticket #28879
> 
> {{{#!m4
> SAGE_SPKG_CONFIGURE([cbc], [
>   SAGE_SPKG_DEPCHECK([atlas openblas readline zlib bzip2], [
>     dnl  checking with pkg-config
>     PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])
>   ])
> ])
> }}}

Thanks, I'll wait with that until #27870 to be merged.


---

Comment by dimpase created at 2019-12-27 13:07:35

I guess their rationale for dependencies in *.pc files is that they don't assume that 
`blas lapack zlib bzip2` (I scratched `readline` out, it's actually not a dependence)
have *.pc files. Which is fair enough.

I've listed this ticket in #27330.

By the way, to move #27870  forward please review its dependence, #28883


---

Comment by git created at 2020-01-11 04:11:46

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2020-01-11 04:12:36

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-01-11 08:26:59

looks good to me


---

Comment by dimpase created at 2020-01-11 08:26:59

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-01-18 12:35:52

Resolution: fixed
