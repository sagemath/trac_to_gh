# Issue 28671: spkg-configure for cbc

archive/issues_028671.json:
```json
{
    "body": "CC:  @dimpase\n\nWe add `spkg-configure` for the optional package `cbc`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28908\n\n",
    "created_at": "2019-12-25T15:39:18Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "spkg-configure for cbc",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28671",
    "user": "@mkoeppe"
}
```
CC:  @dimpase

We add `spkg-configure` for the optional package `cbc`.

Issue created by migration from https://trac.sagemath.org/ticket/28908





---

archive/issue_comments_404979.json:
```json
{
    "body": "Sage's cbc lists quite a few dependencies (readline zlib bzip2 $(BLAS)) , but none are checked by spkg-configure, whereas they are really there, as may be seen on Debian by running\n\n```\nldd /usr/lib/x86_64-linux-gnu/libCbc.so.3\n```\n\n\nIt seems that cbc.pc file is lacking in this sense (along with its dependencies, it seems they don't bother with anything that is external to , they really should list them - should it be reported to upstream?\n\nAnyhow, we should write these deps out, as it's done in e.g. gsl's ticket #28879\n\n\n```m4\nSAGE_SPKG_CONFIGURE([cbc], [\n  SAGE_SPKG_DEPCHECK([atlas openblas zlib bzip2], [\n    dnl  checking with pkg-config\n    PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])\n  ])\n])\n```\n\n\nPerhaps we should update the copy of cbc.pc, to include all these deps\n(more precisely, all but altlas) in the `Requires:` field. \n\n\n\n\n\n----\nNew commits:",
    "created_at": "2019-12-26T02:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404979",
    "user": "@dimpase"
}
```

Sage's cbc lists quite a few dependencies (readline zlib bzip2 $(BLAS)) , but none are checked by spkg-configure, whereas they are really there, as may be seen on Debian by running

```
ldd /usr/lib/x86_64-linux-gnu/libCbc.so.3
```


It seems that cbc.pc file is lacking in this sense (along with its dependencies, it seems they don't bother with anything that is external to , they really should list them - should it be reported to upstream?

Anyhow, we should write these deps out, as it's done in e.g. gsl's ticket #28879


```m4
SAGE_SPKG_CONFIGURE([cbc], [
  SAGE_SPKG_DEPCHECK([atlas openblas zlib bzip2], [
    dnl  checking with pkg-config
    PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])
  ])
])
```


Perhaps we should update the copy of cbc.pc, to include all these deps
(more precisely, all but altlas) in the `Requires:` field. 





----
New commits:



---

archive/issue_comments_404980.json:
```json
{
    "body": "Replying to [comment:3 dimpase]:\n> Sage's cbc lists quite a few dependencies (readline zlib bzip2 $(BLAS)) , but none are checked by spkg-configure ...\n> It seems that cbc.pc file is lacking in this sense (along with its dependencies, it seems they don't bother with anything that is external to , they really should list them - should it be reported to upstream?\n\nI'm sure they'd like to know, please go ahead.\n\n> Anyhow, we should write these deps out, as it's done in e.g. gsl's ticket #28879\n> \n> {{{#!m4\n> SAGE_SPKG_CONFIGURE([cbc], [\n>   SAGE_SPKG_DEPCHECK([atlas openblas readline zlib bzip2], [\n>     dnl  checking with pkg-config\n>     PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])\n>   ])\n> ])\n> }}}\n\nThanks, I'll wait with that until #27870 to be merged.",
    "created_at": "2019-12-27T04:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404980",
    "user": "@mkoeppe"
}
```

Replying to [comment:3 dimpase]:
> Sage's cbc lists quite a few dependencies (readline zlib bzip2 $(BLAS)) , but none are checked by spkg-configure ...
> It seems that cbc.pc file is lacking in this sense (along with its dependencies, it seems they don't bother with anything that is external to , they really should list them - should it be reported to upstream?

I'm sure they'd like to know, please go ahead.

> Anyhow, we should write these deps out, as it's done in e.g. gsl's ticket #28879
> 
> {{{#!m4
> SAGE_SPKG_CONFIGURE([cbc], [
>   SAGE_SPKG_DEPCHECK([atlas openblas readline zlib bzip2], [
>     dnl  checking with pkg-config
>     PKG_CHECK_MODULES([CBC], [cbc >= 2.9.4], [], [sage_spkg_install_cbc=yes])
>   ])
> ])
> }}}

Thanks, I'll wait with that until #27870 to be merged.



---

archive/issue_comments_404981.json:
```json
{
    "body": "I guess their rationale for dependencies in *.pc files is that they don't assume that \n`blas lapack zlib bzip2` (I scratched `readline` out, it's actually not a dependence)\nhave *.pc files. Which is fair enough.\n\nI've listed this ticket in #27330.\n\nBy the way, to move #27870  forward please review its dependence, #28883",
    "created_at": "2019-12-27T13:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404981",
    "user": "@dimpase"
}
```

I guess their rationale for dependencies in *.pc files is that they don't assume that 
`blas lapack zlib bzip2` (I scratched `readline` out, it's actually not a dependence)
have *.pc files. Which is fair enough.

I've listed this ticket in #27330.

By the way, to move #27870  forward please review its dependence, #28883



---

archive/issue_comments_404982.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-01-11T04:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404982",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_404983.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-11T04:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404983",
    "user": "@mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_404984.json:
```json
{
    "body": "looks good to me",
    "created_at": "2020-01-11T08:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404984",
    "user": "@dimpase"
}
```

looks good to me



---

archive/issue_comments_404985.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-11T08:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404985",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_404986.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-18T12:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28671#issuecomment-404986",
    "user": "@vbraun"
}
```

Resolution: fixed
