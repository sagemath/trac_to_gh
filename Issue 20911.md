# Issue 20911: remove unused dendrog comparison of trees

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2016-08-02 09:34:47

CC:  tscrim darij kdilks vivianepons hivert

part of the effort to move towards py3, which does not support
sorting according to a comparison function.


---

Comment by chapoton created at 2016-08-02 09:35:31

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-08-02 09:35:31

New commits:


---

Comment by darij created at 2016-08-02 11:15:07

Fine with me (I'm not married to this code)... but something tells me that the constructed-on-the-fly comparison might be even harder to py3ize than this one. Did you try?


---

Comment by chapoton created at 2016-08-02 11:56:12

no, I have not checked the other comparison. At least it does not use cmp, but a key.

Do you agree to set this to positive review ?


---

Comment by darij created at 2016-08-02 12:03:03

Oh, I forgot that our `sort_key` is deterministic (we did get rid of the on-the-fly hack). Perfect then!

Yes, positive review.


---

Comment by darij created at 2016-08-02 12:03:03

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-08-02 15:39:36

It just looks like you are removing functionality to remove a use of the `cmp` keyword for `sort`. I agree that we should move to Python3, but this feels more like a scorched-Earth approach. Why not just use the `cmp_to_key`? There's also nothing that says we cannot have `cmp`-like functions in our own code either.

I don't use this personally, but I don't think we should just completely rip out something that might be useful to someone. I've cc-ing Kevin and Viviane to see if they do or know someone who does.


---

Comment by tscrim created at 2016-08-02 15:39:36

Changing status from positive_review to needs_info.


---

Comment by chapoton created at 2016-08-02 16:11:04

This has never been used in sage, and has very probably never been used by anybody out there.

IMHO, the job of changing it to a comparison key would be be essentially useless.

Given that python3 is still a **long** way ahead, please let us try not to spend too much time on futilities.


---

Comment by tscrim created at 2016-08-02 16:46:35

Someone thought it was worthwhile to add this to Sage. Plus there surely are a large number of methods that are never called in Sage itself (e.g., `newton_raphson` for (univariate) polynomials). So I don't find that to be a compelling argument. The functionality is not broken, it just needs a small tweak to be 2/3 compatible. So I really think we should not remove chunks like this.


---

Comment by darij created at 2016-08-02 23:34:13

I wrote this code, in order to solve a problem (totally ordering trees). Then, others came around and found a better solution (see the `sort_key` we currently have). I don't know if someone else has used or is using it; all I can really say is that I'm decrementing the reference count.


---

Comment by tscrim created at 2016-08-03 00:53:16

Changing status from needs_info to needs_work.


---

Comment by tscrim created at 2016-08-03 00:53:16

I still don't really agree with removing the functionality, but okay. Nevertheless, you need to deprecate these functions.


---

Comment by git created at 2016-08-03 07:15:15

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2016-08-03 07:17:25

Changing status from needs_work to needs_review.


---

Comment by darij created at 2016-08-03 12:35:14

Once again, I'm OK with this.


---

Comment by chapoton created at 2016-08-03 12:46:13

All tests pass. Travis, do you agree to set a positive review ?


---

Comment by tscrim created at 2016-08-04 20:49:40

Yep, positive review.


---

Comment by tscrim created at 2016-08-04 20:49:40

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-07 20:00:34

Resolution: fixed
