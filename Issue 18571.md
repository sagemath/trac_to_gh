# Issue 18571: Cliquer install fails to create intermediate directories

Issue created by migration from https://trac.sagemath.org/ticket/18808

Original creator: vbraun

Original creation time: 2015-06-29 09:18:10

CC:  jdemeyer ncohen

Probably triggered by #18710, but really this was a landmine waiting to go off: 
* No error handling, failure to install headers is ignored
* Once again we see that `cp` is not an appropriate way to install stuff, this is why everybody else uses a special `install` script/program to handle permissions and intermediate directories.

```
/mnt/disk/home/buildslave-sage/slave/sage_git/build/src/bin/sage-env: line 434: /mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/R/share/Makevars.site: No such file or directory
Found local metadata for cliquer-1.21.p2
Using cached file /mnt/disk/home/buildslave-sage/slave/sage_git/build/upstream/cliquer-1.21.tar.bz2
cliquer-1.21.p2
====================================================
Setting up build directory for cliquer-1.21.p2
Finished set up
****************************************************
Host system:
Linux volker-desktop 4.0.5-300.fc22.x86_64 #1 SMP Mon Jun 8 16:15:26 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/5.1.1/lto-wrapper
Target: x86_64-redhat-linux
Configured with: ../configure --enable-bootstrap --enable-languages=c,c++,objc,obj-c++,fortran,ada,go,lto --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-plugin --enable-initfini-array --disable-libgcj --with-default-libstdcxx-abi=c++98 --with-isl --enable-libmpx --enable-gnu-indirect-function --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux
Thread model: posix
gcc version 5.1.1 20150618 (Red Hat 5.1.1-4) (GCC) 
****************************************************
Applying ../patches/Makefile.patch
patching file Makefile
make[2]: Entering directory '/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/cliquer-1.21.p2/src'
gcc  -g -O3 -funroll-loops -fomit-frame-pointer -fPIC -Wall -DENABLE_LONG_OPTIONS -o cl.o -c cl.c
gcc  -g -O3 -funroll-loops -fomit-frame-pointer -fPIC -Wall  -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include  -c -o cliquer.o cliquer.c
gcc  -g -O3 -funroll-loops -fomit-frame-pointer -fPIC -Wall  -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include  -c -o graph.o graph.c
gcc  -g -O3 -funroll-loops -fomit-frame-pointer -fPIC -Wall  -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include  -c -o reorder.o reorder.c
gcc  -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -shared -Wl,-soname,libcliquer.so -o libcliquer.so cl.o cliquer.o graph.o reorder.o
make[2]: Leaving directory '/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/cliquer-1.21.p2/src'
mkdir: cannot create directory '/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include/cliquer/': No such file or directory
cp: target '/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include/cliquer/' is not a directory

real	0m2.027s
user	0m1.896s
sys	0m0.159s
Successfully installed cliquer-1.21.p2
```

IMHO we should just disallow new standard C-level packages that don't use autotools, or don't pass "make distcheck". Custom makefiles are *always* a recipe for failure.


---

Comment by vbraun created at 2015-07-05 08:12:39

Changing status from new to needs_review.


---

Comment by vbraun created at 2015-07-05 08:12:39

New commits:


---

Comment by fbissey created at 2015-07-05 09:21:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-07-07 10:28:59

Resolution: fixed
