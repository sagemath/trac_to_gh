# Issue 27756: NormalFan: issue with inner and outer normal vectors

archive/issues_027756.json:
```json
{
    "body": "CC:  jipilab\n\nKeywords: NormalFan, polytope\n\nAs an example, create the polytope on p.193 of Ziegler's \"Lectures on Polytopes\" with its normal fan:\n\n```\nsage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]\nsage: P=Polyhedron(V)\nsage: L=LatticePolytope(V)\nsage: FanP, FanL = NormalFan(P), NormalFan(L)\nsage: FanP == FanL\nTrue\n```\n\n\nThe two fans are equal, but they are not the same as the one presented in Ziegler's book.\nIn fact, following to the definition there, `FanP` and `FanL` give the normal fan of `-P`.\n\nThe construction of `NormalFan(polytope)` uses the normal vectors of the facets, given by `polytope.facet_normals()` for a `LatticePolytope` \nor given by `ieq.A() for ieq in polytope.inequalities()` for a `Polyhedron`.\nIn both cases, the normal vectors obtained are directed towards the interior of the polytope. \nTherefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.\n\nI propose to add to `NormalFan` an argument `direction` set to either `'outer'` or `'inner'` to determine which of the directions to use. \nIn line with the definition in Ziegler's book, I would prefer to make `'outer'` the default choice.\n\nAdditionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.\nThis allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27993\n\n",
    "created_at": "2019-06-14T14:46:58Z",
    "labels": [
        "geometry",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "NormalFan: issue with inner and outer normal vectors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27756",
    "user": "nailuj"
}
```
CC:  jipilab

Keywords: NormalFan, polytope

As an example, create the polytope on p.193 of Ziegler's "Lectures on Polytopes" with its normal fan:

```
sage: V=[(-8,-4),(-8,6),(-4,-8),(0,-9),(0,6),(4,-8)]
sage: P=Polyhedron(V)
sage: L=LatticePolytope(V)
sage: FanP, FanL = NormalFan(P), NormalFan(L)
sage: FanP == FanL
True
```


The two fans are equal, but they are not the same as the one presented in Ziegler's book.
In fact, following to the definition there, `FanP` and `FanL` give the normal fan of `-P`.

The construction of `NormalFan(polytope)` uses the normal vectors of the facets, given by `polytope.facet_normals()` for a `LatticePolytope` 
or given by `ieq.A() for ieq in polytope.inequalities()` for a `Polyhedron`.
In both cases, the normal vectors obtained are directed towards the interior of the polytope. 
Therefore, the resulting fan differs from what would be obtained when using the outer normal vectors instead.

I propose to add to `NormalFan` an argument `direction` set to either `'outer'` or `'inner'` to determine which of the directions to use. 
In line with the definition in Ziegler's book, I would prefer to make `'outer'` the default choice.

Additionally, I propose to add in `sage.geometry.polyhedron.representation` a method `Inequality.outer_normal`.
This allows to obtain the outer normal vector without having to think about the appropriate sign of `Inequality.A()` whenever dealing with the facet inequalities of a polyhedron.

Issue created by migration from https://trac.sagemath.org/ticket/27993





---

archive/issue_comments_392125.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-06-14T14:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392125",
    "user": "nailuj"
}
```

New commits:



---

archive/issue_comments_392126.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2019-06-14T14:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392126",
    "user": "nailuj"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_392127.json:
```json
{
    "body": "Sage 8.8 is to be released fairly soon so unless this is a blocker this should be moved to the next release.",
    "created_at": "2019-06-14T14:51:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392127",
    "user": "embray"
}
```

Sage 8.8 is to be released fairly soon so unless this is a blocker this should be moved to the next release.



---

archive/issue_comments_392128.json:
```json
{
    "body": "I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.",
    "created_at": "2019-06-14T16:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392128",
    "user": "novoselt"
}
```

I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.



---

archive/issue_comments_392129.json:
```json
{
    "body": "Replying to [comment:4 novoselt]:\n> I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.\n\n+1\n\nI would leave the default as it is and add the `direction` argument to allow to get the variant.",
    "created_at": "2019-06-15T09:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392129",
    "user": "jipilab"
}
```

Replying to [comment:4 novoselt]:
> I don't care much about adding `direction` argument, but I have **extremely strong objection** to making it the default. There was a reason why inner normals were used for many, many years (like since 2006) - it is consistent with the literature. I understand that some books/articles use the other way, but when neither way is exceptionally uncommon the default choice is pretty much random personal preference when you first create these classes and methods. Once they were created and used for a long time, there is absolutely no reason to change the default whatever it is.

+1

I would leave the default as it is and add the `direction` argument to allow to get the variant.



---

archive/issue_comments_392130.json:
```json
{
    "body": "Actually, I think now it would be better to allow quick \"direction flip\" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.",
    "created_at": "2019-06-15T20:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392130",
    "user": "novoselt"
}
```

Actually, I think now it would be better to allow quick "direction flip" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.



---

archive/issue_comments_392131.json:
```json
{
    "body": "Replying to [comment:6 novoselt]:\n> Actually, I think now it would be better to allow quick \"direction flip\" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.\n\nThis seems to already be possible for `Polyhedron` objects:\n\n\n```\nsage: p = polytopes.regular_polygon(5)\nsage: p.vertices()\n(A vertex at (0.5877852522924731?, -0.8090169943749474?),\n A vertex at (0.9510565162951536?, 0.3090169943749474?),\n A vertex at (0, 1),\n A vertex at (-0.5877852522924731?, -0.8090169943749474?),\n A vertex at (-0.9510565162951536?, 0.3090169943749474?))\nsage: (-p).vertices()\n(A vertex at (-0.5877852522924731?, 0.8090169943749474?),\n A vertex at (-0.9510565162951536?, -0.3090169943749474?),\n A vertex at (0, -1),\n A vertex at (0.587785252292474?, 0.8090169943749474?),\n A vertex at (0.9510565162951536?, -0.3090169943749474?))\n```\n\n\nOr you have something else in mind?\n\nYes, I would use `NormalFan(-P)`  or `NormalFan(P)` depending on whether one wants the inner or outer. This seems like the easiest thing to do. One does not need to go into the `Polyhedron` constructor...",
    "created_at": "2019-06-15T23:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392131",
    "user": "jipilab"
}
```

Replying to [comment:6 novoselt]:
> Actually, I think now it would be better to allow quick "direction flip" either on the polytope or the fan, i.e. make them support `-` operator, instead of making constructors more complicated.

This seems to already be possible for `Polyhedron` objects:


```
sage: p = polytopes.regular_polygon(5)
sage: p.vertices()
(A vertex at (0.5877852522924731?, -0.8090169943749474?),
 A vertex at (0.9510565162951536?, 0.3090169943749474?),
 A vertex at (0, 1),
 A vertex at (-0.5877852522924731?, -0.8090169943749474?),
 A vertex at (-0.9510565162951536?, 0.3090169943749474?))
sage: (-p).vertices()
(A vertex at (-0.5877852522924731?, 0.8090169943749474?),
 A vertex at (-0.9510565162951536?, -0.3090169943749474?),
 A vertex at (0, -1),
 A vertex at (0.587785252292474?, 0.8090169943749474?),
 A vertex at (0.9510565162951536?, -0.3090169943749474?))
```


Or you have something else in mind?

Yes, I would use `NormalFan(-P)`  or `NormalFan(P)` depending on whether one wants the inner or outer. This seems like the easiest thing to do. One does not need to go into the `Polyhedron` constructor...



---

archive/issue_comments_392132.json:
```json
{
    "body": "That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.",
    "created_at": "2019-06-15T23:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392132",
    "user": "novoselt"
}
```

That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.



---

archive/issue_comments_392133.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2019-07-17T11:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392133",
    "user": "jipilab"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_392134.json:
```json
{
    "body": "Replying to [comment:8 novoselt]:\n> That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.\n\nI believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.\n\nThat said, I would change the description of the ticket as follows:\n\n> I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.\n\nAbove I would keep the current default.\n\n> Additionally, I propose to add in sage.geometry.polyhedron.representation a method Inequality.outer_normal. This allows to obtain the outer normal vector without having to think about the appropriate sign of Inequality.A() whenever dealing with the facet inequalities of a polyhedron. \n\nThis is good to me.\n\nFurther, I would suggest to add \n\n> Use `NormalFan(-P)` to get the outer normal fan.\n\nin the documentation of `NormalFan`.",
    "created_at": "2019-07-17T11:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392134",
    "user": "jipilab"
}
```

Replying to [comment:8 novoselt]:
> That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.

I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.

That said, I would change the description of the ticket as follows:

> I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.

Above I would keep the current default.

> Additionally, I propose to add in sage.geometry.polyhedron.representation a method Inequality.outer_normal. This allows to obtain the outer normal vector without having to think about the appropriate sign of Inequality.A() whenever dealing with the facet inequalities of a polyhedron. 

This is good to me.

Further, I would suggest to add 

> Use `NormalFan(-P)` to get the outer normal fan.

in the documentation of `NormalFan`.



---

archive/issue_comments_392135.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-22T12:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392135",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_392136.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-22T12:53:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392136",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_392137.json:
```json
{
    "body": "Replying to [comment:9 jipilab]:\n> Replying to [comment:8 novoselt]:\n> > That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction=\"outer\")`.\n> \n> I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.\n\nYes. I stumbled upon this inner-outer issue through `Polyhedron.normal_fan()`. This is why I added jipilab in CC in the first place, and this is where I should have proposed to make `'outer'` the default \u2013 my bad. I'm fine with `'inner'` as default in both files. My main goal was easier access to outer normal fans, which is now available and explained in the docstrings.\n\n> That said, I would change the description of the ticket as follows:\n> \n> > I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.\n\nDone.\n \n> Further, I would suggest to add \n> \n> > Use `NormalFan(-P)` to get the outer normal fan.\n> \n> in the documentation of `NormalFan`.\n\nDone.",
    "created_at": "2019-07-22T13:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392137",
    "user": "nailuj"
}
```

Replying to [comment:9 jipilab]:
> Replying to [comment:8 novoselt]:
> > That's exactly what I meant. I think those who care about directions are likely to read the documentation and discover that these are inner normals. After that, if this is not the desired choice for the user, `NormalFan(-P)` seems easier and cleaner to use than `NormalFan(P, direction="outer")`.
> 
> I believe that the proposed change would be in the method `.normal_fan()` of `Polyhedron` objects, and not at the level of `NormalFan`, for the reason you mention.

Yes. I stumbled upon this inner-outer issue through `Polyhedron.normal_fan()`. This is why I added jipilab in CC in the first place, and this is where I should have proposed to make `'outer'` the default – my bad. I'm fine with `'inner'` as default in both files. My main goal was easier access to outer normal fans, which is now available and explained in the docstrings.

> That said, I would change the description of the ticket as follows:
> 
> > I propose to add to `normal_fan` an argument direction set to either `'outer'` or `'inner'` to determine which of the directions to use. The default will stay inner in order to match the default of `NormalFan`.

Done.
 
> Further, I would suggest to add 
> 
> > Use `NormalFan(-P)` to get the outer normal fan.
> 
> in the documentation of `NormalFan`.

Done.



---

archive/issue_comments_392138.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-22T13:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392138",
    "user": "nailuj"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_392139.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-07-22T15:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392139",
    "user": "jipilab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_392140.json:
```json
{
    "body": "Changing keywords from \"NormalFan, polytope\" to \"NormalFan, polytope, days100\".",
    "created_at": "2019-07-22T15:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392140",
    "user": "jipilab"
}
```

Changing keywords from "NormalFan, polytope" to "NormalFan, polytope, days100".



---

archive/issue_comments_392141.json:
```json
{
    "body": "- The optional parameters should receive an appropriate doctest. For example:\n\n   {{{\nsage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()\nsage: inner_nf = p.normal_fan()\nsage: inner_nf.rays()\nN( 1,  0,  0),\nN(-1,  1,  1),\nN(-1,  1, -1),\nN(-1, -1, -1),\nN(-1, -1,  1)\nin 3-d lattice N\n\nsage: outer_nf = p.normal_fan(direction='outer')\nsage: outer_nf.rays()\nN(-1,  0,  0),\nN( 1,  1, -1),\nN( 1,  1,  1),\nN( 1, -1,  1),\nN( 1, -1, -1)\nin 3-d lattice N\n}}}\n\n- Further, it would be nice to disallow such things:\n\n```\nsage: outer_nf = p.normal_fan(direction='blabla')\n```\n\n   by checking that direction is one of the two allowed things (see the volume function for a similar handling).\n\n- Remove the space before the semi-colon in the docstring of `normal_fan`.",
    "created_at": "2019-07-22T15:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392141",
    "user": "jipilab"
}
```

- The optional parameters should receive an appropriate doctest. For example:

   {{{
sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()
sage: inner_nf = p.normal_fan()
sage: inner_nf.rays()
N( 1,  0,  0),
N(-1,  1,  1),
N(-1,  1, -1),
N(-1, -1, -1),
N(-1, -1,  1)
in 3-d lattice N

sage: outer_nf = p.normal_fan(direction='outer')
sage: outer_nf.rays()
N(-1,  0,  0),
N( 1,  1, -1),
N( 1,  1,  1),
N( 1, -1,  1),
N( 1, -1, -1)
in 3-d lattice N
}}}

- Further, it would be nice to disallow such things:

```
sage: outer_nf = p.normal_fan(direction='blabla')
```

   by checking that direction is one of the two allowed things (see the volume function for a similar handling).

- Remove the space before the semi-colon in the docstring of `normal_fan`.



---

archive/issue_comments_392142.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-23T07:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392142",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_392143.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-23T08:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392143",
    "user": "nailuj"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_392144.json:
```json
{
    "body": "Replying to [comment:13 jipilab]:\n> The optional parameters should receive an appropriate doctest. For example:\n> \n>    {{{\n> sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()\n> sage: inner_nf = p.normal_fan()\n> sage: inner_nf.rays()\n> N( 1,  0,  0),\n> N(-1,  1,  1),\n> N(-1,  1, -1),\n> N(-1, -1, -1),\n> N(-1, -1,  1)\n> in 3-d lattice N\n> \n> sage: outer_nf = p.normal_fan(direction='outer')\n> sage: outer_nf.rays()\n> N(-1,  0,  0),\n> N( 1,  1, -1),\n> N( 1,  1,  1),\n> N( 1, -1,  1),\n> N( 1, -1, -1)\n> in 3-d lattice N\n> }}}\nI added a 2-d example testing inner, outer, and an invalid direction.\n\n> Further, it would be nice to disallow such things:\n> {{{\n> sage: outer_nf = p.normal_fan(direction='blabla')\n> }}}\n> by checking that direction is one of the two allowed things (see the volume function for a similar handling).\nDone.\n \n> Remove the space before the semi-colon in the docstring of `normal_fan`.\nDone.",
    "created_at": "2019-07-23T08:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392144",
    "user": "nailuj"
}
```

Replying to [comment:13 jipilab]:
> The optional parameters should receive an appropriate doctest. For example:
> 
>    {{{
> sage: p = polytopes.regular_polygon(4,base_ring=QQ).pyramid()
> sage: inner_nf = p.normal_fan()
> sage: inner_nf.rays()
> N( 1,  0,  0),
> N(-1,  1,  1),
> N(-1,  1, -1),
> N(-1, -1, -1),
> N(-1, -1,  1)
> in 3-d lattice N
> 
> sage: outer_nf = p.normal_fan(direction='outer')
> sage: outer_nf.rays()
> N(-1,  0,  0),
> N( 1,  1, -1),
> N( 1,  1,  1),
> N( 1, -1,  1),
> N( 1, -1, -1)
> in 3-d lattice N
> }}}
I added a 2-d example testing inner, outer, and an invalid direction.

> Further, it would be nice to disallow such things:
> {{{
> sage: outer_nf = p.normal_fan(direction='blabla')
> }}}
> by checking that direction is one of the two allowed things (see the volume function for a similar handling).
Done.
 
> Remove the space before the semi-colon in the docstring of `normal_fan`.
Done.



---

archive/issue_comments_392145.json:
```json
{
    "body": "Great!\n\nCould you do one change: the backtick in the error message should be a single quote.\n\nI would also fix the title of the ticket and the description to reflect the actual changes involved.",
    "created_at": "2019-07-23T08:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392145",
    "user": "jipilab"
}
```

Great!

Could you do one change: the backtick in the error message should be a single quote.

I would also fix the title of the ticket and the description to reflect the actual changes involved.



---

archive/issue_comments_392146.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-23T13:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392146",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_392147.json:
```json
{
    "body": "Replying to [comment:16 jipilab]:\n> Could you do one change: the backtick in the error message should be a single quote.\nDone.\n\n> I would also fix the title of the ticket and the description to reflect the actual changes involved.\nDone.",
    "created_at": "2019-07-23T13:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392147",
    "user": "nailuj"
}
```

Replying to [comment:16 jipilab]:
> Could you do one change: the backtick in the error message should be a single quote.
Done.

> I would also fix the title of the ticket and the description to reflect the actual changes involved.
Done.



---

archive/issue_comments_392148.json:
```json
{
    "body": "The doctest still has backticks.",
    "created_at": "2019-07-23T20:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392148",
    "user": "jipilab"
}
```

The doctest still has backticks.



---

archive/issue_comments_392149.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T06:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392149",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_392150.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-24T09:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392150",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_392151.json:
```json
{
    "body": "ok, c'est correct",
    "created_at": "2019-07-24T09:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392151",
    "user": "chapoton"
}
```

ok, c'est correct



---

archive/issue_comments_392152.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-29T21:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27756#issuecomment-392152",
    "user": "vbraun"
}
```

Resolution: fixed
