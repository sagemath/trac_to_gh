# Issue 32166: tweak tox.yml

archive/issues_032166.json:
```json
{
    "body": "CC:  @mkoeppe @slel @davewittemorris @kliem @dimpase\n\nso that it uses upstream_url\n\nIssue created by migration from https://trac.sagemath.org/ticket/32403\n\n",
    "created_at": "2021-08-21T18:20:15Z",
    "labels": [
        "scripts",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "tweak tox.yml",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32166",
    "user": "@fchapoton"
}
```
CC:  @mkoeppe @slel @davewittemorris @kliem @dimpase

so that it uses upstream_url

Issue created by migration from https://trac.sagemath.org/ticket/32403





---

archive/issue_comments_459423.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-21T18:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459423",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_459424.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-08-21T18:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459424",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_459425.json:
```json
{
    "body": "No, a major point of the \"make dist\" workflow is actually to check that the release manager has uploaded all files to the mirror!",
    "created_at": "2021-08-21T18:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459425",
    "user": "@mkoeppe"
}
```

No, a major point of the "make dist" workflow is actually to check that the release manager has uploaded all files to the mirror!



---

archive/issue_comments_459426.json:
```json
{
    "body": "so we are not able to use it for cases like #32372 ?",
    "created_at": "2021-08-21T18:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459426",
    "user": "@fchapoton"
}
```

so we are not able to use it for cases like #32372 ?



---

archive/issue_comments_459427.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-08-21T19:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459427",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_459428.json:
```json
{
    "body": "It was designed to fail on branches that add/upgrade packages - until the release manager uploads the package tarball.\n\nBut I concede that this is at least poorly documented and does not serve us well any more in this form. \n\nWe can use your change (so that the failure goes away). I would add here on the same ticket a new workflow that only runs on release tags, not other branches or tags, to run the old \"make dist\" without --enable-download-from-upstream-url.",
    "created_at": "2021-08-21T19:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459428",
    "user": "@mkoeppe"
}
```

It was designed to fail on branches that add/upgrade packages - until the release manager uploads the package tarball.

But I concede that this is at least poorly documented and does not serve us well any more in this form. 

We can use your change (so that the failure goes away). I would add here on the same ticket a new workflow that only runs on release tags, not other branches or tags, to run the old "make dist" without --enable-download-from-upstream-url.



---

archive/issue_comments_459429.json:
```json
{
    "body": "The new workflow that is launched on release tags only has successfully run here: https://github.com/mkoeppe/sage/runs/3390524672?check_suite_focus=true\n----\nNew commits:",
    "created_at": "2021-08-21T20:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459429",
    "user": "@mkoeppe"
}
```

The new workflow that is launched on release tags only has successfully run here: https://github.com/mkoeppe/sage/runs/3390524672?check_suite_focus=true
----
New commits:



---

archive/issue_comments_459430.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-21T20:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459430",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_459431.json:
```json
{
    "body": "(commented on wrong ticket)",
    "created_at": "2021-08-21T20:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459431",
    "user": "@mkoeppe"
}
```

(commented on wrong ticket)



---

archive/issue_comments_459432.json:
```json
{
    "body": "ok for me, but somebody more knowledgeable should be consulted",
    "created_at": "2021-08-22T06:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459432",
    "user": "@fchapoton"
}
```

ok for me, but somebody more knowledgeable should be consulted



---

archive/issue_comments_459433.json:
```json
{
    "body": "lgtm",
    "created_at": "2021-08-27T09:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459433",
    "user": "@dimpase"
}
```

lgtm



---

archive/issue_comments_459434.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-27T15:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459434",
    "user": "@fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_459435.json:
```json
{
    "body": "I will interpret that as a positive review",
    "created_at": "2021-08-27T15:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459435",
    "user": "@fchapoton"
}
```

I will interpret that as a positive review



---

archive/issue_comments_459436.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-13T22:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32166",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32166#issuecomment-459436",
    "user": "@vbraun"
}
```

Resolution: fixed
