# Issue 27266: add a method "tan" for power series

Issue created by migration from https://trac.sagemath.org/ticket/27503

Original creator: chapoton

Original creation time: 2019-03-16 17:06:26

CC:  tscrim

using the existing sin and cos


---

Comment by chapoton created at 2019-03-16 17:07:26

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-03-16 17:07:26

New commits:


---

Comment by chapoton created at 2019-03-17 08:09:32

green bot, please review


---

Comment by tscrim created at 2019-03-18 10:07:10

A few comments/questions:

- Are we sure that the result of the division has sufficient/correct precision? In other words, do we have to increase the precision of `sin` and/or `cos` to ensure that the `prec-1` term is computed correctly?
- It would be better to make this change:
  {{{#!diff
-        val = self.valuation()
-        assert(val >= 1)
+        assert(self.valuation() >= 1)
  }}}
  That way the valuation is not computed if the assert statement is not run (as it is not needed other than a sanity check).
- Could we change the error message to fit the formatting want for Sage (i.e., following Python with starting with a lower case and no full stop/period)? I know it is inconsistent, but I think it is better when adding code not to exacerbate the problem. (If you think uniformity is better, then feel free to ignore.)
- You do not need `R = self.parent()`.


---

Comment by git created at 2019-03-18 16:50:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-03-18 16:52:24

Fixes made, thx.

Concerning precision, I do not understand your concern. There is no reason to use more precision. Products and inverses of formal power series are well defined when truncated to a given precision.


---

Comment by tscrim created at 2019-03-18 23:12:35

Replying to [comment:5 chapoton]:
> Concerning precision, I do not understand your concern. There is no reason to use more precision. Products and inverses of formal power series are well defined when truncated to a given precision.

I agree that it is well-defined. What I am worried about is that the division could introduce some slight difference from the correct value (when done with higher precision). This would be similar to the effects when doing division in `RR`. Although I have played around with some FPS examples, and I cannot get this to occur. So I think my fears are unfounded.

Thanks. LGTM.


---

Comment by tscrim created at 2019-03-18 23:12:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-03-25 19:43:03

Resolution: fixed
