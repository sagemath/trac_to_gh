# Issue 10219: Unnecessary imports cause slower sage startup

Issue created by migration from Trac.

Original creator: jason

Original creation time: 2010-11-05 12:34:11

Assignee: tbd

CC:  robertwb mhansen

This ticket takes care of some unnecessary imports that were done at startup time instead of inside of functions.  It takes care of some of the worst offenders when sage -startuptime is run.


---

Attachment


---

Comment by jason created at 2010-11-05 12:37:57

Changing status from new to needs_work.


---

Comment by jason created at 2010-11-05 12:37:57

I haven't run full doctests yet, so I guess this is needs work right now.  I think it's good to go, though, modulo running doctests.


---

Comment by mhansen created at 2010-11-05 18:48:11

What is the actual speedup?


---

Comment by jdemeyer created at 2010-11-25 22:04:37

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2010-11-25 22:04:37

Works for me.


---

Comment by mhansen created at 2010-11-25 22:22:41

What is the actual speedup?


---

Comment by jdemeyer created at 2010-11-26 12:58:04

Replying to [comment:4 mhansen]:
> What is the actual speedup?

Statistically insignificant...


---

Comment by robertwb created at 2010-11-30 05:36:37

To really speed stuff up you have to eliminate all imports of a module. Easier said than done.


---

Comment by mhansen created at 2010-11-30 05:42:15

Replying to [comment:6 robertwb]:
> To really speed stuff up you have to eliminate all imports of a module. Easier said than done. 

For example, http://trac.sagemath.org/sage_trac/ticket/6494


---

Comment by jdemeyer created at 2010-12-02 13:10:10

Should this be merged if it doesn't change the startuptime?


---

Comment by jason created at 2010-12-02 16:32:49

I agree with both robertwb and jdemeyer.  When I test it, startup doesn't seem to go down significantly, though the top one or two entries from sage -startup are eliminated.

I think the patch is helpful, but maybe doesn't go far enough to eliminate all imports of a package.

This is interesting, since this patch eliminates the imports with a - next to them in my list of slowest imports in sage -startup.  However, the overall startup time does not seem to diminish appreciably.  I suppose other modules take the "-" places below so that startuptime doesn't really go down?  Or is it that the modules are loaded anyway somewhere else, and loading a module a second time (even in a different module) is insignificant?


```
sage.all: 1.608 (None)


1.608 sage.all (None)
0.387 sage.schemes.all (sage.all)
0.279 elliptic_curves.all (sage.schemes.all)
0.275 ell_rational_field (elliptic_curves.all)
0.245 ell_number_field (ell_rational_field)
0.244 sage.misc.all (sage.all)
0.243 ell_field (ell_number_field)
0.242 ell_curve_isogeny (ell_field)
0.190 sage.modular.all (sage.all)
0.151 twisted.persisted.styles (sage.all)
0.146 abvar.all (sage.modular.all)
0.145 abvar_newform (abvar.all)
0.141 abvar (abvar_newform)
0.135 sage.groups.all (abvar)
0.124 perm_gps.all (sage.groups.all)
-0.122 cubegroup (perm_gps.all)
0.117 sage.rings.all (sage.all)
-0.113 sage.plot.all (cubegroup)
0.111 sage.symbolic.pynac (sage.all)
0.106 hyperelliptic_curves.all (sage.schemes.all)
0.105 sage_input (sage.misc.all)
-0.104 sage.misc.functional (sage_input)
-0.098 complex_plot (sage.plot.all)
-0.097 numpy (complex_plot)
0.096 sage.schemes.generic.all (hyperelliptic_curves.all)
0.090 fano_toric_variety (sage.schemes.generic.all)
0.088 sage.geometry.all (fano_toric_variety)
0.084 cone (sage.geometry.all)
0.084 zope.interface (twisted.persisted.styles)
0.081 sage_timeit_class (sage.misc.all)
0.081 sage.rings.complex_double (sage.misc.functional)
-0.081 sage_timeit (sage_timeit_class)
0.080 add_newdocs (numpy)
-0.079 interpreter (sage_timeit)
-0.078 IPython.ipapi (interpreter)
0.076 pkg_resources (zope.interface)
0.073 lib (add_newdocs)
0.073 sage.combinat.all (sage.all)
0.063 type_check (lib)
0.063 numpy.core.numeric (type_check)
0.063 sage.algebras.all (sage.all)
0.046 numeric (numpy.core.numeric)
0.046 misc (sage.misc.all)
0.045 sage.combinat.posets.posets (cone)
0.042 sage.graphs.all (sage.combinat.posets.posets)
0.041 Shell (IPython.ipapi)
0.039 sage.server.all (sage.all)
0.037 notebook.all (sage.server.all)
0.037 sagenb.notebook.all (notebook.all)
0.037 notebook_object (sagenb.notebook.all)
```



---

Comment by robertwb created at 2010-12-02 18:00:20

I'm in favor of any patches that remove unnecessary imports, as it will make the import order (which is now a mess) easier to understand and actual speedups easier to achieve.


---

Comment by jdemeyer created at 2010-12-02 23:05:42

Changing keywords from "" to "import startuptime".


---

Comment by jdemeyer created at 2010-12-02 23:05:42

Replying to [comment:10 robertwb]:
> I'm in favor of any patches that remove unnecessary imports, as it will make the import order (which is now a mess) easier to understand and actual speedups easier to achieve. 

As you wish :-)


---

Comment by jdemeyer created at 2010-12-02 23:05:42

Resolution: fixed
