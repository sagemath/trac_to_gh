# Issue 28231: Bug with Polyhedron plot when too many plots

Issue created by migration from https://trac.sagemath.org/ticket/28468

Original creator: mercatp

Original creation time: 2019-09-09 16:12:12

CC:  jipilab @laisrast @kliem

The following code doesn't work on my computer. If we change the 45 to 40, then it works (it fails when I draw too much Polyedrons).


```
P = Polyhedron([(1,0,0),(0,1,0),(0,0,1),(0,0,0)])
g = Graphics()
for i in range(45):
    g += P.plot()
g
```


It raise the following error:

```
...
/home/mercatpaul/sage/local/lib/python2.7/zipfile.pyc in readline(self, limit)
    568 
    569         if not self._universal:
--> 570             return io.BufferedIOBase.readline(self, limit)
    571 
    572         line = ''

/home/mercatpaul/sage/local/lib/python2.7/zipfile.pyc in peek(self, n)
    606         """Returns buffered bytes without advancing the position."""
    607         if n > len(self._readbuffer) - self._offset:
--> 608             chunk = self.read(n)
    609             if len(chunk) > self._offset:
    610                 self._readbuffer = chunk + self._readbuffer[self._offset:]

/home/mercatpaul/sage/local/lib/python2.7/zipfile.pyc in read(self, n)
    630                 data = self.read1(n)
    631             elif n > len(buf):
--> 632                 data = self.read1(n - len(buf))
    633             else:
    634                 return buf

/home/mercatpaul/sage/local/lib/python2.7/zipfile.pyc in read1(self, n)
    690                 data += self._decompressor.flush()
    691 
--> 692             self._update_crc(data, eof=eof)
    693             self._readbuffer = self._readbuffer[self._offset:] + data
    694             self._offset = 0

/home/mercatpaul/sage/local/lib/python2.7/zipfile.pyc in _update_crc(self, newdata, eof)
    645         # Check the CRC if we're at the end of the file
    646         if eof and self._running_crc != self._expected_crc:
--> 647             raise BadZipfile("Bad CRC-32 for file %r" % self.name)
    648 
    649     def read1(self, n):

BadZipfile: Bad CRC-32 for file 'SCRIPT'
```


45 Polyedrons is not a lot ! Sage should be able to plot thousand of them.


---

Comment by chapoton created at 2019-09-10 09:03:15

Works for me in sage 8.9.beta9 under linux. Please be more precise about your sage version, os and how you installed.


---

Comment by mercatp created at 2019-09-10 09:09:35

Replying to [comment:1 chapoton]:
> Works for me in sage 8.9.beta9 under linux. Please be more precise about your sage version, os and how you installed.

And does it work if you replace 45 by 100 ? or by 1000 ?


---

Comment by chapoton created at 2019-09-10 09:14:55

Works with 1000, but jmol becomes extremely slow


---

Comment by chapoton created at 2019-09-10 09:16:33

are you working inside the console or inside sagenb or inside jupyter notebook ?


---

Comment by jipilab created at 2019-09-12 08:07:28

Changing keywords from "" to "polytopes, plot".


---

Comment by mercatp created at 2019-09-17 15:56:44

Replying to [comment:6 chapoton]:
> are you working inside the console or inside sagenb or inside jupyter notebook ?

I'm working in Jupyter. When I try in the old sage notebook, then it works.
And when I try from the console, then it does'nt work at all : Jmol starts, but is stuck (I waited for at least 10 min).


---

Comment by jipilab created at 2019-09-20 08:56:39

Replying to [comment:8 mercatp]:
> Replying to [comment:6 chapoton]:
> > are you working inside the console or inside sagenb or inside jupyter notebook ?
> 
> I'm working in Jupyter. When I try in the old sage notebook, then it works.
> And when I try from the console, then it does'nt work at all : Jmol starts, but is stuck (I waited for at least 10 min).

I can draw also with 500+ in a matter of seconds. There is perhaps something broken with the installation? The error comes from python 2.7...


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by chapoton created at 2021-08-01 07:53:31

can we close as invalid ?


---

Comment by chapoton created at 2021-08-01 07:53:31

Changing status from new to needs_review.


---

Comment by @kliem created at 2021-08-09 14:49:06

I think so.


---

Comment by @kliem created at 2021-08-09 14:49:06

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2021-08-09 16:22:59

Resolution: invalid
