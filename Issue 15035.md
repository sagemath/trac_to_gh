# Issue 15035: Bruhat posets and Bruhat graphs for parabolic subgroups

Issue created by migration from https://trac.sagemath.org/ticket/15272

Original creator: vittucek

Original creation time: 2013-10-12 21:52:36

CC:  nthiery bump tscrim aschilling

This patch extends the functionality of bruhat_poset and introduces new parabolic_bruhat_graph for finite Weyl groups. 

Let W be a finite Weyl group and let W_S be the subgroup of W generated by reflections associated with a subset S of simple roots. Then the cosets W / W_S have unique representatives of minimal length which are ordered by the Bruhat order of W. Similarly for W_S \ W. These poset structures appear in many places, e.g. intersection cohomology of generalized flag varieties or nilpotent Lie algebra cohomology.

This patch adds a parameters index_set (= S) and side (left / right).


----


Introducing parabolic_bruhat_graph is ugly. Ideally, one would just extend the existing bruhat_graph. However, this method is based upon bruhat_interval which belongs to categories/coxeter_groups.py 

I was unsure where to put the code, which I haven't written yet nor which I need  in the foreseeable future anyway. Since it seems that the best course of action would be to implement class (or category?) for parabolic subroot systems / groups I think that one more method for Weyl group is not much of an issue.


---

Attachment


---

Comment by vittucek created at 2013-12-03 11:12:23

Changing status from new to needs_review.


---

Comment by vittucek created at 2014-03-18 17:51:14

New commits:


---

Comment by git created at 2014-03-19 12:06:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2014-03-25 23:43:16

There is a merge conflict with develop:

```
        x = x.coset_representative(index_set,side)
        y = y.coset_representative(index_set,side)
        g = self.bruhat_poset(index_set, crossed_nodes, side, facade=True).interval(x,y)
        ref = self.reflections()
        d = {}
        for x in g:
<<<<<<< HEAD
            d[x] = [y for y in g if x.length() < y.length() and x*y.inverse() in ref]
=======
            d[x] = {}
            for y in g:
                if side == "right":
                    r = y*x.inverse()
                else:
                    r = x.inverse()*y
                if x.length() < y.length() and ref.has_key(r):
                    d[x][y] = r
>>>>>>> 92888b345acb3f6726c1d38ab16d4f1366fbb757
        return DiGraph(d)
```

I'm pushing a branch (warning: branch change!) in which I resolve this in favor of your patch's version (the longer one, with the "for y in g" loop and the dictionary rather than the list). If this is wrong, please let me know.
----
New commits:


---

Comment by darij created at 2014-03-25 23:45:04

That said, what do you think about pulling the `if side == "right"` check outside of the loop, so as to not repeat it over and over?


---

Comment by darij created at 2014-03-25 23:46:26

Oh, and also the conflict was because some other patch replaced `ref.has_key(...)` by `... in ref`. Maybe do the same in your code? (I don't know what the difference is; it just sounds like a logical thing to do.)


---

Comment by tscrim created at 2014-03-26 02:36:52

The `has_key` is being deprecated (removed?) in python3 in favor of the `in` syntax (which I believe is faster...?). Also I agree with Darij since this loop is so small, I'd pull the `side == "right"` statement outside as:

```
if side == "right":
    for y in g:
        r = y*x.inverse()
    if x.length() < y.length() and r in ref:
        d[x][y] = r
else:
    for y in g:
        r = x.inverse()*y
    if x.length() < y.length() and r in ref:
        d[x][y] = r
```



---

Comment by vittucek created at 2014-03-26 14:27:53

Replying to [comment:7 darij]:
> There is a merge conflict with develop:
> {{{
>         x = x.coset_representative(index_set,side)
>         y = y.coset_representative(index_set,side)
>         g = self.bruhat_poset(index_set, crossed_nodes, side, facade=True).interval(x,y)
>         ref = self.reflections()
>         d = {}
>         for x in g:
> <<<<<<< HEAD
>             d[x] = [y for y in g if x.length() < y.length() and x*y.inverse() in ref]
> =======
>             d[x] = {}
>             for y in g:
>                 if side == "right":
>                     r = y*x.inverse()
>                 else:
>                     r = x.inverse()*y
>                 if x.length() < y.length() and ref.has_key(r):
>                     d[x][y] = r
> >>>>>>> 92888b345acb3f6726c1d38ab16d4f1366fbb757
>         return DiGraph(d)
> }}}
> I'm pushing a branch (warning: branch change!) in which I resolve this in favor of your patch's version (the longer one, with the "for y in g" loop and the dictionary rather than the list). If this is wrong, please let me know.
> ----

Thanks!  I've made the change you've requested (and moreover I've switched the order of tests to benefit from short-circuiting. I didn't know how to add the patch on top of your branch (insufficient permissions?) so I just went with what `sage -dev push` suggested. I hope that's fine.
----
New commits:


---

Comment by git created at 2014-03-26 20:53:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vittucek created at 2014-03-26 20:54:41

Replying to [comment:9 darij]:
> Oh, and also the conflict was because some other patch replaced `ref.has_key(...)` by `... in ref`. Maybe do the same in your code? (I don't know what the difference is; it just sounds like a logical thing to do.)

Ehm. I have done this change too hastily. As it turns out `ref` is not a dictionary but a `FiniteFamily` which means that its `__contains__` method looks at the values. It's `__contains__` method was changed #15784 to use `in` in favor of `has_key`.


---

Comment by chapoton created at 2015-04-21 16:17:45

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-04-21 16:17:45

does not apply
