# Issue 31647: gcd(0, z) should not be abs(z) when z is a symbolic complex number

Issue created by migration from https://trac.sagemath.org/ticket/31884

Original creator: @DaveWitteMorris

Original creation time: 2021-05-31 03:09:36

CC:  slelievre

Keywords: gcd, complex number

Sage assumes that `gcd(0,z)` is `abs(z)` when `z` is a symbolic numeric. That seems ok for real numbers, but I don't think it makes sense when `z` is complex:

```
sage: gcd(0, SR(2 + 3*I))                                                       
sqrt(13)
```

PS Probably unrelated, but these seem backwards to me:

```
sage: gcd(sqrt(5), 5)                                                           
5
sage: lcm(sqrt(5), 5)                                                           
sqrt(5)
```



---

Comment by slelievre created at 2021-05-31 10:03:40

Setting `gcd(0, z)` to `abs(z)` when `z` is complex
with nonzero real and imaginary parts is indeed erroneous.
Using `max(z, -z)` could work around this problem,
even though there's no good order on complex numbers.

If, as often, we define the `gcd` up to a unit, then
for any pair of nonzero elements in the symbolic ring,
any nonzero element can be considered their gcd.

To compute `gcd(r, 5)` and `lcm(r, 5)` with `r = sqrt(5)`,
one would need to decide in what ring one is working.
The ring of integers of `QQ(r)` is `ZZ[a]`
where `a` is the golden ratio (the positive root
of `a^2 = a + 1`; the units are powers of `a`
and their negatives; `r` equals `2*a - 1`
so it is an integer, so `ZZ[a]` seems a good place
to compute the gcd. Then it seems natural to write:

```
gcd(r, 5) = gcd(r, 5 - r*r) = gcd(r, 0) = r
```

Or one could write:

```
gcd(2*a - 1, 5) = gcd(2*a - 1, 5 - a*(2*a - 1)
                = gcd(2*a - 1, 3 - a)
                = gcd((2*a - 1) - a*(3 - a), 3 - a)
                = gcd(0, 3 - a)
                = 3 - a
```

which is `r/a` (but remember `a` is a unit).
