# Issue 16064: bug in quotient() over integer coefficient ring

Issue created by migration from Trac.

Original creator: jakobkroeker

Original creation time: 2014-05-07 09:46:55

Keywords: bug quotient integer

Hello,

there is a bug in `quotient()` over integer coefficient ring.
Here is an example:

```
 R.<x,y,z>= ZZ[]
 I = Ideal( R(2), x*y, x*z + x)
 eD = Ideal( x, z^2-1)
 I.quotient(eD) //=0 , sage 6.2.rc1, Release Date: 2014-04-30
 // correct result: 2, x*z + x, x*y
```


This is caused by a bug in Singular. It's probably already fixed in the inofficial(?) release 
(https://github.com/Singular/Sources/releases). 

But there are other major bugs in Singular over integer coefficient ring (e.g. http://www.singular.uni-kl.de:8002/trac/ticket/540) which are only fixed in the recent development version.


---

Comment by chapoton created at 2014-05-10 09:33:55

Changing keywords from "bug quotient integer" to "bug quotient integer, singular".


---

Comment by tmonteil created at 2014-11-29 03:23:48

It seems that the fix went downstream !


```
sage: R.<x,y,z>= ZZ[]
sage: I = Ideal( R(2), x*y, x*z + x)
sage: eD = Ideal( x, z^2-1)
sage: I.quotient(eD)
Ideal (2, x*z + x, x*y) of Multivariate Polynomial Ring in x, y, z over Integer Ring
```


So let us add this as a test to ensure it will not reappear silently.

`@`jakobkroeker do you want to make a patch or should i write it ?


---

Comment by jakobkroeker created at 2014-12-09 19:35:38

> So let us add this as a test to ensure it will not reappear silently.
> It seems that the fix went downstream !

sage  updated to Singular 3.1.7 (recent version is 4.0.1) and it seems that this bug is fixed in 3.1.7. But there are many other bugs in functions for polynomial rings over integers, even in Singular 4.0.1.

>`@`jakobkroeker do you want to make a patch or should i write it ? 

`@`tmonteil

added a test;

In general if everything was done properly, there should be tests in Singular,
so sage could theoretically just run all Singular tests(how?) and see if something fails?


---

Comment by tmonteil created at 2014-12-09 22:05:17

This looks pretty good, i would add two coding convention advices:

- There is a space before and after `=`, so just write `R.<x,y,z> = ZZ[]`
- There is no space after `Ideal(`, so just write `I = Ideal(R(2), x*y, x*z + x)` and `eD = Ideal(x, z^2-1)`

Also, your patch should be based on the `develop` branch (currently `develop.6.5.beta2`, not `6.3`), so that we can see whether it works with the current code and so that the reviewer will not have to recompile a huge part of Sage twice to test the patch and go back to the `develop` branch ;)

Moreover, with this patch applied, the test does not pass (look at the `sage -t` command) since on `6.3` the version of singular was buggy with respect to this test.


---

Comment by tmonteil created at 2014-12-09 22:20:31

Replying to [comment:6 jakobkroeker]:
> In general if everything was done properly, there should be tests in Singular,
> so sage could theoretically just run all Singular tests(how?) and see if something fails?

There are two different things here.

This test is about Sage (which uses singular for that computation), and should remain valid if at some point another back end is used for that computation, so it is legitimate within Sage source code.

That said, Singular seems indeed to have its own tests, hence there should be a `spkg-check` script within `$SAGE_ROOT/build/pkgs/singular` directory that runs those tests (which seems currently not the case). See http://www.sagemath.org/doc/developer/packaging.html#self-tests for more details.


---

Comment by git created at 2014-12-10 11:13:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-12-10 11:19:53

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jakobkroeker created at 2014-12-10 11:23:39

`@`monteil

> Also, your patch should be based on the develop branch (currently develop.6.5.beta2, not 6.3)

Have no clue, why this happened  (initially I did a 'git checkout develop; git pull; make build;'
then i checked out the ticket using the dev scripts './sage --dev checkout --ticket=16301' and
./sage showed me at start 'Sage Version 6.5.beta2', but indeed 'git diff develop' shows a lot of diffs.

Fixed with a git rebase and a forced push.


---

Comment by tmonteil created at 2014-12-10 15:27:43

Changing status from new to needs_review.


---

Comment by tmonteil created at 2014-12-10 15:27:43

Everything looks good now, both tests and documentation display pass. I added what i guess is your full name on the "Authors" field (it is required to have the ticket merged), please change it if it not correct. You can also add yourself on the trac main page : http://trac.sagemath.org/


---

Comment by tmonteil created at 2014-12-10 15:27:53

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-12-12 12:29:43

Resolution: fixed
