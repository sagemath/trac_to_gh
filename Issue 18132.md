# Issue 18132: upgrade eclib to version 20150423

archive/issues_018132.json:
```json
{
    "body": "Keywords: eclib\n\neclib version 20150423 contains some efficiency enhancements and also now compiles OK with C++-11.\n\nNew upstream source at \nhttp://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/progs/eclib-20150423.tar.bz2\n\nIssue created by migration from https://trac.sagemath.org/ticket/18369\n\n",
    "created_at": "2015-05-05T20:15:58Z",
    "labels": [
        "packages: standard",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "upgrade eclib to version 20150423",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18132",
    "user": "@JohnCremona"
}
```
Keywords: eclib

eclib version 20150423 contains some efficiency enhancements and also now compiles OK with C++-11.

New upstream source at 
http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/progs/eclib-20150423.tar.bz2

Issue created by migration from https://trac.sagemath.org/ticket/18369





---

archive/issue_comments_244470.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-05-06T12:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244470",
    "user": "@JohnCremona"
}
```

New commits:



---

archive/issue_comments_244471.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-05-06T12:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244471",
    "user": "@JohnCremona"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_244472.json:
```json
{
    "body": "not working for me\n\n```\nchecking for boostlib >= 1.35.0... yes\nchecking whether the Boost::System library is available... yes\nchecking for exit in -lboost_system... no\nconfigure: error: Could not link against boost_system !\nError configuring eclib.\n\nreal\t0m9.419s\nuser\t0m1.373s\nsys\t0m1.608s\n************************************************************************\nError installing package eclib-20150423\n```\n",
    "created_at": "2015-05-07T19:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244472",
    "user": "@fchapoton"
}
```

not working for me

```
checking for boostlib >= 1.35.0... yes
checking whether the Boost::System library is available... yes
checking for exit in -lboost_system... no
configure: error: Could not link against boost_system !
Error configuring eclib.

real	0m9.419s
user	0m1.373s
sys	0m1.608s
************************************************************************
Error installing package eclib-20150423
```




---

archive/issue_comments_244473.json:
```json
{
    "body": "Frederic, I have had real trouble with the boost configuration since I upgraded the version of the libtool boost config scripts.  I thought I had solved it, but apparently not (except on my machine).  Any chance you could help me diagnose and fix that?  It is suppose to be that if you do not put --with-boost (or --with-boost=<path>) on the configure line, that no boost is used, but now it defaults the other way and whether or not it passes depends on the locally installed boost.  (boost is only needed for running with a multithreaded, i.e. parallel, option, which I do not think is appropriate for Sage).\n\nI have tried explicitly putting --with-boost=no on the command line but that does not work either, though I do not know why.\n\nThanks for testing.",
    "created_at": "2015-05-07T19:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244473",
    "user": "@JohnCremona"
}
```

Frederic, I have had real trouble with the boost configuration since I upgraded the version of the libtool boost config scripts.  I thought I had solved it, but apparently not (except on my machine).  Any chance you could help me diagnose and fix that?  It is suppose to be that if you do not put --with-boost (or --with-boost=<path>) on the configure line, that no boost is used, but now it defaults the other way and whether or not it passes depends on the locally installed boost.  (boost is only needed for running with a multithreaded, i.e. parallel, option, which I do not think is appropriate for Sage).

I have tried explicitly putting --with-boost=no on the command line but that does not work either, though I do not know why.

Thanks for testing.



---

archive/issue_comments_244474.json:
```json
{
    "body": "Did you try `--with-boost-system=no`?",
    "created_at": "2015-05-07T20:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244474",
    "user": "@jdemeyer"
}
```

Did you try `--with-boost-system=no`?



---

archive/issue_comments_244475.json:
```json
{
    "body": "It seems that every piece of boost has its own independent(?) `--with` flag:\n\n```\n  --with-boost[=ARG]      use Boost library from a standard location\n                          (ARG=yes), from the specified location (ARG=<path>),\n                          or disable it (ARG=no) [ARG=yes]\n  --with-boost-libdir=LIB_DIR\n                          Force given directory for boost libraries. Note that\n                          this will override library path detection, so use\n                          this parameter only if default library detection\n                          fails and you know exactly where your boost\n                          libraries are located.\n  --with-boost-system[=special-lib]\n                          use the System library from boost - it is possible\n                          to specify a certain library for the linker e.g.\n                          --with-boost-system=boost_system-gcc-mt\n  --with-boost-asio[=special-lib]\n                          use the ASIO library from boost - it is possible to\n                          specify a certain library for the linker e.g.\n                          --with-boost-asio=boost_system-gcc41-mt-1_34\n  --with-boost-thread[=special-lib]\n                          use the Thread library from boost - it is possible\n                          to specify a certain library for the linker e.g.\n                          --with-boost-thread=boost_thread-gcc-mt\n```\n",
    "created_at": "2015-05-07T20:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244475",
    "user": "@jdemeyer"
}
```

It seems that every piece of boost has its own independent(?) `--with` flag:

```
  --with-boost[=ARG]      use Boost library from a standard location
                          (ARG=yes), from the specified location (ARG=<path>),
                          or disable it (ARG=no) [ARG=yes]
  --with-boost-libdir=LIB_DIR
                          Force given directory for boost libraries. Note that
                          this will override library path detection, so use
                          this parameter only if default library detection
                          fails and you know exactly where your boost
                          libraries are located.
  --with-boost-system[=special-lib]
                          use the System library from boost - it is possible
                          to specify a certain library for the linker e.g.
                          --with-boost-system=boost_system-gcc-mt
  --with-boost-asio[=special-lib]
                          use the ASIO library from boost - it is possible to
                          specify a certain library for the linker e.g.
                          --with-boost-asio=boost_system-gcc41-mt-1_34
  --with-boost-thread[=special-lib]
                          use the Thread library from boost - it is possible
                          to specify a certain library for the linker e.g.
                          --with-boost-thread=boost_thread-gcc-mt
```




---

archive/issue_comments_244476.json:
```json
{
    "body": "I recommend this fix:\n\n```sh\n# Boost 1.35.0+ required for Asio (1.25.0 for Thread)\nAX_BOOST_BASE([1.35.0], [\nAX_BOOST_SYSTEM\nAX_BOOST_ASIO\nAX_BOOST_THREAD\n])\n```\n",
    "created_at": "2015-05-07T20:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244476",
    "user": "@jdemeyer"
}
```

I recommend this fix:

```sh
# Boost 1.35.0+ required for Asio (1.25.0 for Thread)
AX_BOOST_BASE([1.35.0], [
AX_BOOST_SYSTEM
AX_BOOST_ASIO
AX_BOOST_THREAD
])
```




---

archive/issue_comments_244477.json:
```json
{
    "body": "With this, the checks `AX_BOOST_SYSTEM`, `AX_BOOST_ASIO` and `AX_BOOST_THREAD` will only be done if `AX_BOOST_BASE` succeeded. Therefore, `--with-boost=no` will skip all 4.",
    "created_at": "2015-05-07T20:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244477",
    "user": "@jdemeyer"
}
```

With this, the checks `AX_BOOST_SYSTEM`, `AX_BOOST_ASIO` and `AX_BOOST_THREAD` will only be done if `AX_BOOST_BASE` succeeded. Therefore, `--with-boost=no` will skip all 4.



---

archive/issue_comments_244478.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-07T20:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244478",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_244479.json:
```json
{
    "body": "That all sounds very good, I will test soon.  Feel free to make a pull request at https://github.com/JohnCremona/eclib meanwhile",
    "created_at": "2015-05-07T21:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244479",
    "user": "@JohnCremona"
}
```

That all sounds very good, I will test soon.  Feel free to make a pull request at https://github.com/JohnCremona/eclib meanwhile



---

archive/issue_comments_244480.json:
```json
{
    "body": "Jeroen's solution sounds good. I am guessing the reason you are seeing this now is because the detection default has changed. All those `--with-xxx` switch usually comes with a default state and now it is set to yes. For example in https://github.com/JohnCremona/eclib/blob/master/m4/ax_boost_system.m4 at line 53 you have\n\n```\n        [want_boost=\"yes\"]\n```\n\nthis means that if you don't pass anything it will assume you want it. If you want the old behaviour of \"not on\" unless I say so, you want to change that line to\n\n```\n        [want_boost=\"no\"]\n```\n\nand similarly in all the other `ax_boost_*.m4` files.",
    "created_at": "2015-05-08T01:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244480",
    "user": "@kiwifb"
}
```

Jeroen's solution sounds good. I am guessing the reason you are seeing this now is because the detection default has changed. All those `--with-xxx` switch usually comes with a default state and now it is set to yes. For example in https://github.com/JohnCremona/eclib/blob/master/m4/ax_boost_system.m4 at line 53 you have

```
        [want_boost="yes"]
```

this means that if you don't pass anything it will assume you want it. If you want the old behaviour of "not on" unless I say so, you want to change that line to

```
        [want_boost="no"]
```

and similarly in all the other `ax_boost_*.m4` files.



---

archive/issue_comments_244481.json:
```json
{
    "body": "You are right, the default changed in those m4 files.  I think that the masters student who first put the boost support (for multithreading) into eclib manually edited the m4 files.  With this release I upgraded the m4 files to the most recent ones I found online (I cannot remember why, certainly not all was working well before I did that), and this is the effect.\n\nI think that Jeroen's solution is better than to edit the m4 files anyway.  I have not had time to try it out or test it yet.",
    "created_at": "2015-05-08T08:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244481",
    "user": "@JohnCremona"
}
```

You are right, the default changed in those m4 files.  I think that the masters student who first put the boost support (for multithreading) into eclib manually edited the m4 files.  With this release I upgraded the m4 files to the most recent ones I found online (I cannot remember why, certainly not all was working well before I did that), and this is the effect.

I think that Jeroen's solution is better than to edit the m4 files anyway.  I have not had time to try it out or test it yet.



---

archive/issue_comments_244482.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-10T16:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244482",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244483.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-10T17:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244483",
    "user": "@JohnCremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_244484.json:
```json
{
    "body": "Please try this.  Note that the upstream source is now 20150510 instead of 20150423.  The only change is in the boost detection where I use Jeroen's suggested change.  In the Sage commit I updated the package version and checksum and added a line to the install script saying --with-boost=\"no\".  It works for me...",
    "created_at": "2015-05-10T17:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244484",
    "user": "@JohnCremona"
}
```

Please try this.  Note that the upstream source is now 20150510 instead of 20150423.  The only change is in the boost detection where I use Jeroen's suggested change.  In the Sage commit I updated the package version and checksum and added a line to the install script saying --with-boost="no".  It works for me...



---

archive/issue_comments_244485.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-05-11T01:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244485",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_244486.json:
```json
{
    "body": "Works for me, without or with boost (in sage-on-gentoo). It all behaves as expected as far as I can see.",
    "created_at": "2015-05-11T01:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244486",
    "user": "@kiwifb"
}
```

Works for me, without or with boost (in sage-on-gentoo). It all behaves as expected as far as I can see.



---

archive/issue_comments_244487.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-14T22:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18132",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18132#issuecomment-244487",
    "user": "@vbraun"
}
```

Resolution: fixed
