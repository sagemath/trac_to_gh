# Issue 21131: Multigraph plot does not use vertex_shape-parameter

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2016-08-30 08:12:57

CC:  paulmasson

This shows how for example `vertex_colors` is used in both simple and multigprahs, but `vertex_shape` is not:


```
g = DiGraph({0: [1]})
g.show(vertex_shape='s', vertex_colors={'red': [0]})
g.allow_multiple_edges(True)
g.add_edge(0, 1)
g.show(vertex_shape='s', vertex_colors={'blue': [0]})
```


If I change `graph_plot.py` line 471 to be `if False:` it seems to work. So what is the reason to plot multigraph with `[circle(...) for ...]` and simple graph with `scatter_plot(...)`?



---

Comment by jmantysalo created at 2016-08-30 09:19:13

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2016-08-30 09:19:13

This code is painful to read. However, with this patch it should be a little bit shorter and one bug corrected.
----
New commits:


---

Comment by paulmasson created at 2016-09-02 01:50:00

If appears to me that the reason for using only circles on the multigraphs is to make the graph look better by having edges terminate close to the circle's radius. That looks like the entire point of the method `_polar_hack_for_multidigraph`.

Simply removing the code with `circle` invalidates a whole bunch of other code in this file. I wouldn't recommend doing so unless you're going to remove all of the other code dependent on the existence of the circles. At the very least this ticket should be discussed on `sage-devel` because it will change the appearance of multigraphs significantly.


---

Comment by jmantysalo created at 2016-09-02 06:58:18

Replying to [comment:3 paulmasson]:

> Simply removing the code with `circle` invalidates a whole bunch of other code in this file. I wouldn't recommend doing so unless you're going to remove all of the other code dependent on the existence of the circles.

Hmm... Can you give an example of a graph that changes with this patch?

In general: We need a quite large test set to see that all combinations of graph/digraph, graph/pseudograph and graph/multigraph works. Also there can be several combinations of vertex sizes and colors etc. Edge coloring should work with or without edge labels etc. Something like


```
G = DiGraph(3)
G.allow_multiple_edges(True)
G.add_edge(1, 2, 'a')
G.add_edge(1, 2, 'b')
G.add_edge(2, 1, 'a')
G.add_edge(1, 3, 'd')
G.add_edge(1, 3, 'e')
G.add_edge(0, 3)
G.show(edge_colors={'red': [(1, 2, 'a')], 'blue': [(1,3)]})
```


should work.


---

Comment by jmantysalo created at 2016-09-02 07:05:42

Btw, this fails too:


```
G = graphs.CubeGraph(3)
G.show()
sage.graphs.graph_plot.DEFAULT_SHOW_OPTIONS['figsize'] = [2,2]
sage.graphs.graph_plot.DEFAULT_PLOT_OPTIONS['vertex_color'] = 'green'
G.show()
sage.graphs.graph_plot.DEFAULT_SHOW_OPTIONS['vertex_color'] = 'red'
G.show()
```


That is, `DEFAULT_SHOW_OPTIONS` accepts only some values whereas `DEFAULT_PLOT_OPTIONS` accepts them all.


---

Comment by jmantysalo created at 2016-09-02 08:01:22

Changing status from needs_review to needs_work.
