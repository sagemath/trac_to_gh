# Issue 32014: Fix doctest in the "Y pentamino" example from Donald Knuth

Issue created by migration from https://trac.sagemath.org/ticket/32251

Original creator: saliola

Original creation time: 2021-07-20 13:08:31

CC:  slabbe

Keywords: tiling, tiling solver, dancing links


The following doctest for [Tiling Solver](https://doc.sagemath.org/html/en/reference/combinat/sage/combinat/tiling.html#donald-knuth-example-the-y-pentamino), which is not tested because it takes a long time, does not agree with the answer returned by Sage.

```
sage: from sage.combinat.tiling import Polyomino, TilingSolver
sage: y = Polyomino([(0,0),(1,0),(2,0),(3,0),(2,1)])
sage: T = TilingSolver([y], box=(15,15), reusable=True, reflection=True)
sage: T.number_of_solutions()                      # not tested
212  # sage returns 1696 instead
```


The discrepancy in the two answers stems from whether one counts solutions up to symmetry. More specifically, [Knuth's paper](https://arxiv.org/pdf/cs/0011047.pdf) says there are 212 solutions that "fall into four classes, depending on the behavior at the four corners" (last paragraph of page 12). Fixing the behaviour at the four corners means solutions are counted up to the symmetries of the square. If we do not count solutions up to symmetry, then we get Sage's response of 1696 = 8 * 212.

The 212 in the doctest should replaced with 1696, and a note should be added to explain the (superficial) discrepancy with the answer in Knuth's paper.




---

Comment by slabbe created at 2022-01-04 15:04:03

Sorry for taking so long. The ticket got burried in my emails from trac.
----
New commits:


---

Comment by slabbe created at 2022-01-04 15:04:03

Changing status from new to needs_review.


---

Comment by chapoton created at 2022-01-04 17:08:26

merci, et bonne ann√©e


---

Comment by chapoton created at 2022-01-04 17:08:26

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-03-03 22:19:17

Resolution: fixed
