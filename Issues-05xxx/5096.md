# Issue 5096: [with patch and spkg] pynac interface enhancements

archive/issues_005096.json:
```json
{
    "assignees": [],
    "body": "\n\nAssignee: **@burcin**\n\nCC:  @mwhansen\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5096_\n\n",
    "closed_at": "2009-02-02T17:20:02Z",
    "created_at": "2009-01-25T08:14:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20calculus",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "[with patch and spkg] pynac interface enhancements",
    "type": "issue",
    "updated_at": "2009-02-02T17:20:02Z",
    "url": "https://github.com/sagemath/sage/issues/5096",
    "user": "https://github.com/williamstein"
}
```


Assignee: **@burcin**

CC:  @mwhansen

_Issue created by migration from https://trac.sagemath.org/ticket/5096_





---

archive/issue_events_053089.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-01-25T08:14:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53089"
}
```



---

archive/issue_events_053090.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-01-25T08:14:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "component: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53090"
}
```



---

archive/issue_events_053091.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-01-25T08:14:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53091"
}
```



---

archive/issue_events_053092.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-01-25T08:14:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53092"
}
```



---

archive/issue_comments_032191.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nSee http://sage.math.washington.edu/home/burcin/pynac for the new spkg and patches to the core sage library.",
    "created_at": "2009-01-25T08:15:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32191",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:1" align="right">Comment 1</div>

See http://sage.math.washington.edu/home/burcin/pynac for the new spkg and patches to the core sage library.



---

archive/issue_comments_032192.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nREFEREE REPORT:\n\n* Add a short description at the top docstring for `x.operator?`.\n\n* Make sure the latex docstring actually passes.",
    "created_at": "2009-01-25T08:29:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32192",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:2" align="right">Comment 2</div>

REFEREE REPORT:

* Add a short description at the top docstring for `x.operator?`.

* Make sure the latex docstring actually passes.



---

archive/issue_comments_032193.json:
```json
{
    "body": "Attachment: **[trac_5096-01_pynac_operator.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-01_pynac_operator.patch.gz)**\n\nadd .operator() method",
    "created_at": "2009-01-30T13:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32193",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_5096-01_pynac_operator.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-01_pynac_operator.patch.gz)**

add .operator() method



---

archive/issue_comments_032194.json:
```json
{
    "body": "allow pynac expressions as arguments to binomial and factorial",
    "created_at": "2009-01-30T13:55:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32194",
    "user": "https://github.com/burcin"
}
```

allow pynac expressions as arguments to binomial and factorial



---

archive/issue_comments_032195.json:
```json
{
    "body": "Attachment: **[trac_5096-02_binomial_factorial.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-02_binomial_factorial.patch.gz)**\n\nAttachment: **[trac_5096-03_expression_iterator.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-03_expression_iterator.patch.gz)**\n\nadd iterator and `__getitem__` support to expressions",
    "created_at": "2009-01-30T13:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32195",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_5096-02_binomial_factorial.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-02_binomial_factorial.patch.gz)**

Attachment: **[trac_5096-03_expression_iterator.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-03_expression_iterator.patch.gz)**

add iterator and `__getitem__` support to expressions



---

archive/issue_comments_032196.json:
```json
{
    "body": ".subs() now works with multiple arguments",
    "created_at": "2009-01-30T13:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32196",
    "user": "https://github.com/burcin"
}
```

.subs() now works with multiple arguments



---

archive/issue_comments_032197.json:
```json
{
    "body": "Attachment: **[trac_5096-04_subs_mult.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-04_subs_mult.patch.gz)**\n\nAttachment: **[trac_5096-05_print_order.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-05_print_order.patch.gz)**\n\nfix doctests for printing changes",
    "created_at": "2009-01-30T13:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32197",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_5096-04_subs_mult.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-04_subs_mult.patch.gz)**

Attachment: **[trac_5096-05_print_order.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-05_print_order.patch.gz)**

fix doctests for printing changes



---

archive/issue_comments_032198.json:
```json
{
    "body": "add .collect_common_factors() method",
    "created_at": "2009-01-30T13:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32198",
    "user": "https://github.com/burcin"
}
```

add .collect_common_factors() method



---

archive/issue_comments_032199.json:
```json
{
    "body": "Attachment: **[trac_5096-06_collect_common_factors.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-06_collect_common_factors.patch.gz)**\n\nadd latex printing support, fix is_integer method",
    "created_at": "2009-01-30T13:58:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32199",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_5096-06_collect_common_factors.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-06_collect_common_factors.patch.gz)**

add latex printing support, fix is_integer method



---

archive/issue_comments_032200.json:
```json
{
    "body": "Attachment: **[trac_5096-07_print_latex.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-07_print_latex.patch.gz)**\n\nAttachment: **[trac_5096-08_constants.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-08_constants.patch.gz)**\n\ncorrect coercion of symbolic constants",
    "created_at": "2009-01-30T13:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32200",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_5096-07_print_latex.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-07_print_latex.patch.gz)**

Attachment: **[trac_5096-08_constants.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-08_constants.patch.gz)**

correct coercion of symbolic constants



---

archive/issue_comments_032201.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nA new version of pynac is available here:\n\nhttp://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.2.spkg\n\n\nThe attached patches implement various enhancements to the pynac interface.\n\nThis issue now depends on #5132.",
    "created_at": "2009-01-30T14:04:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32201",
    "user": "https://github.com/burcin"
}
```

<div id="comment:3" align="right">Comment 3</div>

A new version of pynac is available here:

http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.2.spkg


The attached patches implement various enhancements to the pynac interface.

This issue now depends on #5132.



---

archive/issue_events_053093.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-01-30T14:04:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "title_is": "[with patch and spkg] pynac interface enhancements",
    "title_was": "implement beautiful printing support for pynac",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53093"
}
```



---

archive/issue_events_053094.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-01-30T14:04:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53094"
}
```



---

archive/issue_comments_032202.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThe spkg looks good, but someone needs to review Burcin's nine patches to the Sage library :)\n\nCheers,\n\nMichael",
    "created_at": "2009-02-02T06:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32202",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:4" align="right">Comment 4</div>

The spkg looks good, but someone needs to review Burcin's nine patches to the Sage library :)

Cheers,

Michael



---

archive/issue_comments_032203.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nAssuming the patches apply and pass tests, I think these can go in.  All of the changes are pretty straightforward.",
    "created_at": "2009-02-02T07:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32203",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:5" align="right">Comment 5</div>

Assuming the patches apply and pass tests, I think these can go in.  All of the changes are pretty straightforward.



---

archive/issue_comments_032204.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nWith the new spkg and all nine patches applied I am seeing two doctest failures:\n\n```\n\tsage -t -long devel/sage/sage/calculus/calculus.py # 6 doctests failed\n\tsage -t -long devel/sage/sage/modules/free_module_element.pyx # 1 doctests failed\n```\nThey all seem to be of the kind\n\n```\nsage -t -long \"devel/sage/sage/modules/free_module_element.pyx\"\n**********************************************************************\nFile \"/scratch/mabshoff/sage-3.3.alpha4/devel/sage/sage/modules/free_module_element.pyx\", line 1637:\n    sage: g(x=3, y=2)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/sage-3.3.alpha4/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-3.3.alpha4/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-3.3.alpha4/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_52[11]>\", line 1, in <module>\n        g(x=Integer(3), y=Integer(2))###line 1637:\n    sage: g(x=3, y=2)\n      File \"free_module_element.pyx\", line 1640, in sage.modules.free_module_element.FreeModuleElement_generic_dense.__call__ (sage/modules/free_module_element.c:13259)\n      File \"/scratch/mabshoff/sage-3.3.alpha4/local/lib/python2.5/site-packages/sage/calculus/calculus.py\", line 6044, in __call__\n        raise ValueError, \"Expected %s arguments, got %s\"%(len(myvars),len(args))\n    ValueError: Expected 2 arguments, got 0\n**********************************************************************\n```\n\nCheers,\n\nMichael",
    "created_at": "2009-02-02T07:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32204",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:6" align="right">Comment 6</div>

With the new spkg and all nine patches applied I am seeing two doctest failures:

```
	sage -t -long devel/sage/sage/calculus/calculus.py # 6 doctests failed
	sage -t -long devel/sage/sage/modules/free_module_element.pyx # 1 doctests failed
```
They all seem to be of the kind

```
sage -t -long "devel/sage/sage/modules/free_module_element.pyx"
**********************************************************************
File "/scratch/mabshoff/sage-3.3.alpha4/devel/sage/sage/modules/free_module_element.pyx", line 1637:
    sage: g(x=3, y=2)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/sage-3.3.alpha4/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-3.3.alpha4/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-3.3.alpha4/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_52[11]>", line 1, in <module>
        g(x=Integer(3), y=Integer(2))###line 1637:
    sage: g(x=3, y=2)
      File "free_module_element.pyx", line 1640, in sage.modules.free_module_element.FreeModuleElement_generic_dense.__call__ (sage/modules/free_module_element.c:13259)
      File "/scratch/mabshoff/sage-3.3.alpha4/local/lib/python2.5/site-packages/sage/calculus/calculus.py", line 6044, in __call__
        raise ValueError, "Expected %s arguments, got %s"%(len(myvars),len(args))
    ValueError: Expected 2 arguments, got 0
**********************************************************************
```

Cheers,

Michael



---

archive/issue_events_053095.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-02T07:42:25Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "title_is": "[with patch and spkg, need doctest fixes] pynac interface enhancements",
    "title_was": "[with patch and spkg] pynac interface enhancements",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53095"
}
```



---

archive/issue_events_053096.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-02T07:42:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53096"
}
```



---

archive/issue_events_053097.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-02T07:42:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53097"
}
```



---

archive/issue_events_053098.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-02-02T14:25:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "title_is": "[with patch and spkg] pynac interface enhancements",
    "title_was": "[with patch and spkg, need doctest fixes] pynac interface enhancements",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53098"
}
```



---

archive/issue_comments_032205.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nI uploaded a new version of trac_5096-09_callable_expression.patch which reverts the check for the number of arguments of `CallableSymbolicExpression`s. The doctests pass now.",
    "created_at": "2009-02-02T14:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32205",
    "user": "https://github.com/burcin"
}
```

<div id="comment:7" align="right">Comment 7</div>

I uploaded a new version of trac_5096-09_callable_expression.patch which reverts the check for the number of arguments of `CallableSymbolicExpression`s. The doctests pass now.



---

archive/issue_comments_032206.json:
```json
{
    "body": "add .function() method to create `CallableSymbolicExpressions`",
    "created_at": "2009-02-02T16:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32206",
    "user": "https://github.com/burcin"
}
```

add .function() method to create `CallableSymbolicExpressions`



---

archive/issue_events_053099.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-02T17:20:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53099"
}
```



---

archive/issue_events_053100.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-02T17:20:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5096#event-53100"
}
```



---

archive/issue_comments_032207.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nAttachment: **[trac_5096-09_callable_expression.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-09_callable_expression.patch.gz)**\n\nMerged all nine patches as well as the spkg into Sage 3.3.alpha4.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-02T17:20:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5096#issuecomment-32207",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:8" align="right">Comment 8</div>

Attachment: **[trac_5096-09_callable_expression.patch.gz](https://github.com/sagemath/sage/files/ticket5096/trac_5096-09_callable_expression.patch.gz)**

Merged all nine patches as well as the spkg into Sage 3.3.alpha4.

Cheers,

Michael
