# Issue 5159: [with positive review] Add functionality to Galois groups

archive/issues_005159.json:
```json
{
    "body": "It would be nice to unify Sage's two ways of handling Galois groups: as abstract transitive groups, and as sets of explicit automorphisms with no group structure. This can be done by using Pari's galoisinit, galoispoltoperm and galoisapply functions.\n\n\n\n**Assignee:** @loefflerd\n\n**Keywords:** galois groups, number theory\n\n**Resolution:** fixed\n\n**Author:** David Loeffler\n\n**Reviewer:** John Cremona\n\n**Merged:** 3.4.1.rc0\n\nIssue created by migration from https://trac.sagemath.org/ticket/5159\n\n",
    "closed_at": "2009-03-31T09:35:38Z",
    "created_at": "2009-02-02T17:51:14Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.4.1",
    "title": "[with positive review] Add functionality to Galois groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5159",
    "user": "https://github.com/loefflerd"
}
```
It would be nice to unify Sage's two ways of handling Galois groups: as abstract transitive groups, and as sets of explicit automorphisms with no group structure. This can be done by using Pari's galoisinit, galoispoltoperm and galoisapply functions.



**Assignee:** @loefflerd

**Keywords:** galois groups, number theory

**Resolution:** fixed

**Author:** David Loeffler

**Reviewer:** John Cremona

**Merged:** 3.4.1.rc0

Issue created by migration from https://trac.sagemath.org/ticket/5159





---

archive/issue_comments_046983.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe above patch should do the job for absolute fields: it creates a new GaloisGroup class, which has very little resemblance to the old one, and derives from PermutationGroup_generic. The init script calls Pari's galoisinit. Elements are stored as GaloisGroupElement objects, which are basically permutations, but with the addition of a cached method that returns the image of a generator of that permutation under the corresponding automorphism. \n\nI've also added toy implementations of decomposition and ramification groups and the Artin symbol for prime ideals in number fields; I'm sure there are faster algorithms to calculate these rather than using the definitions directly as I've done, but I am a strong believer in toy implementations.\n\nAt present this is all only for absolute fields, because Pari has no direct support for Galois groups of relative extensions. Relative fields could also be implemented, at least when the corresponding absolute field is Galois over QQ, by calculating the Galois group of the absolute extension and checking which automorphisms fix the intermediate field; but I haven't done this.",
    "created_at": "2009-02-02T18:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46983",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:1'></a>
The above patch should do the job for absolute fields: it creates a new GaloisGroup class, which has very little resemblance to the old one, and derives from PermutationGroup_generic. The init script calls Pari's galoisinit. Elements are stored as GaloisGroupElement objects, which are basically permutations, but with the addition of a cached method that returns the image of a generator of that permutation under the corresponding automorphism. 

I've also added toy implementations of decomposition and ramification groups and the Artin symbol for prime ideals in number fields; I'm sure there are faster algorithms to calculate these rather than using the definitions directly as I've done, but I am a strong believer in toy implementations.

At present this is all only for absolute fields, because Pari has no direct support for Galois groups of relative extensions. Relative fields could also be implemented, at least when the corresponding absolute field is Galois over QQ, by calculating the Galois group of the absolute extension and checking which automorphisms fix the intermediate field; but I haven't done this.



---

archive/issue_comments_046984.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2009-02-02T18:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46984",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_046985.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-02-02T18:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46985",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_015537.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-06T23:04:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15537"
}
```



---

archive/issue_comments_046986.json:
```json
{
    "body": "<a id='comment:3'></a>\n3.4 is for ReST tickets only.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-06T23:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46986",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:3'></a>
3.4 is for ReST tickets only.

Cheers,

Michael



---

archive/issue_events_015538.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "Add functionality to Galois groups",
        "to": "[with patch, with review (partial), needs rebasing] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15538"
}
```



---

archive/issue_comments_046987.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis looks like great work which will be extremely useful, but needs to be rebased on 3.4  (i.e. change the docstrings in number_field.py into ReST style) before it can be tested.\n\nAt the same time, I think you can safely replace the old galois_group.py with the new one instead of leaving there and adding _new to your name.\n\nI'll do a proper review when rebased, as so far as have just read the patch.",
    "created_at": "2009-03-16T21:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46987",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>
This looks like great work which will be extremely useful, but needs to be rebased on 3.4  (i.e. change the docstrings in number_field.py into ReST style) before it can be tested.

At the same time, I think you can safely replace the old galois_group.py with the new one instead of leaving there and adding _new to your name.

I'll do a proper review when rebased, as so far as have just read the patch.



---

archive/issue_comments_046988.json:
```json
{
    "body": "patch against 3.4 with patch for #5508 applied",
    "created_at": "2009-03-17T18:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46988",
    "user": "https://github.com/loefflerd"
}
```

patch against 3.4 with patch for #5508 applied



---

archive/attachments_005806.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "galois.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5159/galois.patch",
    "created_at": "2009-03-17T18:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_046989.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've rebased it to a patch based on (3.4 + the patch for #5508).\n\nThis version actually adds quite a bit that wasn't in the previous version: based on the debate on sage-nt, I've made it return the Galois group of the splitting field when the given field isn't Galois, and also added a method fixed_field for subgroups of Galois groups based on Pari's \"galoisfixedfield\".\n\nIn an ideal world, when given a non-Galois field, it would return the Galois group of the Galois closure of the given field, but represented as permutations of the roots of the defining polynomial of the original field. I couldn't work out an easy way of doing this which wouldn't be horribly slow in general, so elements are represented as permutations of the Galois conjugates of some single element generating the Galois closure.\n\nI've also ReSTified class_group.py and number_field_ideal.py (the latter because I was editing it anyway, and the former because it was easy to do); and deprecated galois_group and is_galois for relative fields in favour of explicitly relative and absolute variants.",
    "created_at": "2009-03-17T18:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46989",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:5'></a>
I've rebased it to a patch based on (3.4 + the patch for #5508).

This version actually adds quite a bit that wasn't in the previous version: based on the debate on sage-nt, I've made it return the Galois group of the splitting field when the given field isn't Galois, and also added a method fixed_field for subgroups of Galois groups based on Pari's "galoisfixedfield".

In an ideal world, when given a non-Galois field, it would return the Galois group of the Galois closure of the given field, but represented as permutations of the roots of the defining polynomial of the original field. I couldn't work out an easy way of doing this which wouldn't be horribly slow in general, so elements are represented as permutations of the Galois conjugates of some single element generating the Galois closure.

I've also ReSTified class_group.py and number_field_ideal.py (the latter because I was editing it anyway, and the former because it was easy to do); and deprecated galois_group and is_galois for relative fields in favour of explicitly relative and absolute variants.



---

archive/issue_events_015539.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[with patch, with review (partial), needs rebasing] Add functionality to Galois groups",
        "to": "[with new patch] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15539"
}
```



---

archive/issue_comments_046990.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-03-17T18:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46990",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_046991.json:
```json
{
    "body": "<a id='comment:6'></a>\nI'm not sure whether I did something stupid here but in a fresh clone of 3.4 I applied sage-5508.2.patch from #5508 and then tried to apply the new galois.patch form here, but it does not apply properly:\n\n```\nsage: hg_sage.apply(\"galois.patch\")\ncd \"/home/john/sage-3.4/devel/sage\" && hg status\ncd \"/home/john/sage-3.4/devel/sage\" && hg status\ncd \"/home/john/sage-3.4/devel/sage\" && hg import   \"/home/john/galois.patch\"\napplying /home/john/galois.patch\npatching file sage/rings/number_field/number_field.py\nHunk #3 FAILED at 2536\nHunk #4 FAILED at 2555\nHunk #5 FAILED at 4147\nHunk #6 FAILED at 4160\n4 out of 6 hunks FAILED -- saving rejects to file sage/rings/number_field/number_field.py.rej\nabort: patch failed to apply\n```\n\nDid I misunderstand something?  John",
    "created_at": "2009-03-17T21:56:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46991",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'></a>
I'm not sure whether I did something stupid here but in a fresh clone of 3.4 I applied sage-5508.2.patch from #5508 and then tried to apply the new galois.patch form here, but it does not apply properly:

```
sage: hg_sage.apply("galois.patch")
cd "/home/john/sage-3.4/devel/sage" && hg status
cd "/home/john/sage-3.4/devel/sage" && hg status
cd "/home/john/sage-3.4/devel/sage" && hg import   "/home/john/galois.patch"
applying /home/john/galois.patch
patching file sage/rings/number_field/number_field.py
Hunk #3 FAILED at 2536
Hunk #4 FAILED at 2555
Hunk #5 FAILED at 4147
Hunk #6 FAILED at 4160
4 out of 6 hunks FAILED -- saving rejects to file sage/rings/number_field/number_field.py.rej
abort: patch failed to apply
```

Did I misunderstand something?  John



---

archive/issue_comments_046992.json:
```json
{
    "body": "<a id='comment:7'></a>\nWeird. I was using the first version of the #5508 patch, not the second, but that shouldn't make a huge difference. I will look at it in the morning.",
    "created_at": "2009-03-17T22:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46992",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:7'></a>
Weird. I was using the first version of the #5508 patch, not the second, but that shouldn't make a huge difference. I will look at it in the morning.



---

archive/issue_comments_046993.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [davidloeffler](#comment%3A7):\n> Weird. I was using the first version of the #5508 patch, not the second, but that shouldn't make a huge difference. I will look at it in the morning.\n\n\n\n```\njohn@ubuntu%diff /home/john/sage-5508.2.patch /home/john/sage-5508.patch \n1679c1679\n< +            a\n---\n> +            sage: a\n```",
    "created_at": "2009-03-18T08:37:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46993",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>
Replying to [davidloeffler](#comment%3A7):
> Weird. I was using the first version of the #5508 patch, not the second, but that shouldn't make a huge difference. I will look at it in the morning.



```
john@ubuntu%diff /home/john/sage-5508.2.patch /home/john/sage-5508.patch 
1679c1679
< +            a
---
> +            sage: a
```



---

archive/attachments_005807.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "galois_new.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5159/galois_new.patch",
    "created_at": "2009-03-18T09:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_046994.json:
```json
{
    "body": "replaces previous patch -- apply after sage-5508.2.patch",
    "created_at": "2009-03-18T09:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46994",
    "user": "https://github.com/loefflerd"
}
```

replaces previous patch -- apply after sage-5508.2.patch



---

archive/issue_comments_046995.json:
```json
{
    "body": "<a id='comment:9'></a>\nHere's a new patch. On my machine I've checked that it applies happily on a clean clone of 3.4 with sage-5508.2.patch on top. Let me know if this works for you too.",
    "created_at": "2009-03-18T09:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46995",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:9'></a>
Here's a new patch. On my machine I've checked that it applies happily on a clean clone of 3.4 with sage-5508.2.patch on top. Let me know if this works for you too.



---

archive/attachments_005808.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5159_extra.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5159/trac_5159_extra.patch",
    "created_at": "2009-03-18T10:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_046996.json:
```json
{
    "body": "",
    "created_at": "2009-03-18T10:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46996",
    "user": "https://github.com/JohnCremona"
}
```





---

archive/issue_events_015540.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[with new patch] Add functionality to Galois groups",
        "to": "[with new patch, positve review] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15540"
}
```



---

archive/issue_comments_046997.json:
```json
{
    "body": "<a id='comment:10'></a>\nGood news: this patch applies fine on top of sage-5508.2.patch.\n\nI am very happy with this patch which provides a significant new set of functions and capabilities.  I did have two trivial doctest failures, in two files, nothing serious:\n\n```\nsage -t  \"local/sage-3.4/devel/sage-5159/sage/rings/number_field//number_field.py\"\n**********************************************************************\nFile \"/home/masgaj/local/sage-3.4/devel/sage-5159/sage/rings/number_field/number_field.py\", line 3067:\n    sage: G = k.galois_group(names='c'); G\nExpected:\n    Galois group of Number Field in b with defining polynomial x^3 - x + 1\nGot:\n    Galois group of Galois closure in c of Number Field in b with defining polynomial x^3 - x + 1\n\n  ***   Warning: large Minkowski bound: certification will be VERY long.\n  ***   Warning: large Minkowski bound: certification will be VERY long.\n*********************************************************************\n```\n\nand\n\n```\nsage -t  \"local/sage-3.4/devel/sage-5159/sage/rings/number_field//galois_group.py\"\n**********************************************************************\nFile \"/home/masgaj/local/sage-3.4/devel/sage-5159/sage/rings/number_field/galois_group.py\", line 479:\n    sage: from sage.rings.number_field.galois_group_new import GaloisGroup_subgroup\nException raised:\n    Traceback (most recent call last):\n      File \"/home/masgaj/local/sage-3.4/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/masgaj/local/sage-3.4/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/masgaj/local/sage-3.4/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest `__main__`.example_24[2]>\", line 1, in <module>\n        from sage.rings.number_field.galois_group_new import GaloisGroup_subgroup###line 479:\n    sage: from sage.rings.number_field.galois_group_new import GaloisGroup_subgroup\n    ImportError: No module named galois_group_new\n*******************************************************************\n```\n\nI have put up a small patch which fixes these, so it can have a positive review.",
    "created_at": "2009-03-18T10:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46997",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:10'></a>
Good news: this patch applies fine on top of sage-5508.2.patch.

I am very happy with this patch which provides a significant new set of functions and capabilities.  I did have two trivial doctest failures, in two files, nothing serious:

```
sage -t  "local/sage-3.4/devel/sage-5159/sage/rings/number_field//number_field.py"
**********************************************************************
File "/home/masgaj/local/sage-3.4/devel/sage-5159/sage/rings/number_field/number_field.py", line 3067:
    sage: G = k.galois_group(names='c'); G
Expected:
    Galois group of Number Field in b with defining polynomial x^3 - x + 1
Got:
    Galois group of Galois closure in c of Number Field in b with defining polynomial x^3 - x + 1

  ***   Warning: large Minkowski bound: certification will be VERY long.
  ***   Warning: large Minkowski bound: certification will be VERY long.
*********************************************************************
```

and

```
sage -t  "local/sage-3.4/devel/sage-5159/sage/rings/number_field//galois_group.py"
**********************************************************************
File "/home/masgaj/local/sage-3.4/devel/sage-5159/sage/rings/number_field/galois_group.py", line 479:
    sage: from sage.rings.number_field.galois_group_new import GaloisGroup_subgroup
Exception raised:
    Traceback (most recent call last):
      File "/home/masgaj/local/sage-3.4/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/masgaj/local/sage-3.4/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/masgaj/local/sage-3.4/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest `__main__`.example_24[2]>", line 1, in <module>
        from sage.rings.number_field.galois_group_new import GaloisGroup_subgroup###line 479:
    sage: from sage.rings.number_field.galois_group_new import GaloisGroup_subgroup
    ImportError: No module named galois_group_new
*******************************************************************
```

I have put up a small patch which fixes these, so it can have a positive review.



---

archive/issue_events_015541.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[with new patch, positve review] Add functionality to Galois groups",
        "to": "[with new patch] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15541"
}
```



---

archive/issue_comments_046998.json:
```json
{
    "body": "**Changing status** from new to positive_review.",
    "created_at": "2009-03-18T10:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46998",
    "user": "https://github.com/aghitza"
}
```

**Changing status** from new to positive_review.



---

archive/issue_comments_046999.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2009-03-25T09:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-46999",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_047000.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe latest patch on top of #5508 causes a number of doctest failures:\n\n```\n\tsage -t -long devel/sage/doc/en/bordeaux_2008/nf_galois_groups.rst # 3 doctests failed\n\tsage -t -long devel/sage/sage/structure/sage_object.pyx # 1 doctests failed\n\tsage -t -long devel/sage/sage/rings/number_field/galois_group.py # 2 doctests failed\n\tsage -t -long devel/sage/doc/en/tutorial/tour_numtheory.rst # 1 doctests failed\n\tsage -t -long devel/sage/doc/fr/tutorial/tour_numtheory.rst # 1 doctests failed\n```\n\nCheers,\n\nMichael",
    "created_at": "2009-03-25T09:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47000",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:12'></a>
The latest patch on top of #5508 causes a number of doctest failures:

```
	sage -t -long devel/sage/doc/en/bordeaux_2008/nf_galois_groups.rst # 3 doctests failed
	sage -t -long devel/sage/sage/structure/sage_object.pyx # 1 doctests failed
	sage -t -long devel/sage/sage/rings/number_field/galois_group.py # 2 doctests failed
	sage -t -long devel/sage/doc/en/tutorial/tour_numtheory.rst # 1 doctests failed
	sage -t -long devel/sage/doc/fr/tutorial/tour_numtheory.rst # 1 doctests failed
```

Cheers,

Michael



---

archive/attachments_005809.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5159-unpickle-fix.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5159/5159-unpickle-fix.patch",
    "created_at": "2009-03-25T11:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_047001.json:
```json
{
    "body": "apply over 5508-3.patch and previous TWO patches.",
    "created_at": "2009-03-25T11:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47001",
    "user": "https://github.com/loefflerd"
}
```

apply over 5508-3.patch and previous TWO patches.



---

archive/issue_comments_047002.json:
```json
{
    "body": "<a id='comment:13'></a>\nI've done a new patch which fixes the above five doctest failures. The only difficulty was the pickle jar failure, which I've circumvented by renaming the classes GaloisGroup_v1 and GaloisGroup_v2, and aliasing GaloisGroup to GaloisGroup_v1; as the name GaloisGroup isn't imported into the global namespace anyway -- one constructs the objects using the galois_group method of number field objects -- this has no visible effect for the user, and unpickling now works fine.\n\nIn the process I spotted that the doctest failure that necessitated the final patch at #5508 seems to be machine-dependent, presumably a 32-bit / 64-bit thing. So the new patch adjusts that doctest to allow two different answers for 32-bit and 64-bit in the usual way; and I also put in a doctest in the `__call__` method of number field relative orders to confirm that #4193 is fixed. \n\nDavid",
    "created_at": "2009-03-25T11:16:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47002",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:13'></a>
I've done a new patch which fixes the above five doctest failures. The only difficulty was the pickle jar failure, which I've circumvented by renaming the classes GaloisGroup_v1 and GaloisGroup_v2, and aliasing GaloisGroup to GaloisGroup_v1; as the name GaloisGroup isn't imported into the global namespace anyway -- one constructs the objects using the galois_group method of number field objects -- this has no visible effect for the user, and unpickling now works fine.

In the process I spotted that the doctest failure that necessitated the final patch at #5508 seems to be machine-dependent, presumably a 32-bit / 64-bit thing. So the new patch adjusts that doctest to allow two different answers for 32-bit and 64-bit in the usual way; and I also put in a doctest in the `__call__` method of number field relative orders to confirm that #4193 is fixed. 

David



---

archive/issue_events_015542.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[with new patch] Add functionality to Galois groups",
        "to": "[partial review] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15542"
}
```



---

archive/issue_comments_047003.json:
```json
{
    "body": "<a id='comment:15'></a>\nMichael: what is the next step with this one? Given that the new patch changes nothing that the user sees, can it just be merged, or is a new review needed for the new patch? \n\nDavid",
    "created_at": "2009-03-27T11:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47003",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:15'></a>
Michael: what is the next step with this one? Given that the new patch changes nothing that the user sees, can it just be merged, or is a new review needed for the new patch? 

David



---

archive/issue_comments_047004.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [davidloeffler](#comment%3A15):\n> Michael: what is the next step with this one? Given that the new patch changes nothing that the user sees, can it just be merged, or is a new review needed for the new patch? \n> \n> David\n> \n\n\nIt would still be nice if someone did a quick re-review of the last two patches.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-27T16:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47004",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:16'></a>
Replying to [davidloeffler](#comment%3A15):
> Michael: what is the next step with this one? Given that the new patch changes nothing that the user sees, can it just be merged, or is a new review needed for the new patch? 
> 
> David
> 


It would still be nice if someone did a quick re-review of the last two patches.

Cheers,

Michael



---

archive/issue_events_015543.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[partial review] Add functionality to Galois groups",
        "to": "Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15543"
}
```



---

archive/issue_comments_047005.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-03-27T16:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47005",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_047006.json:
```json
{
    "body": "<a id='comment:17'></a>\nI can confirm that the patches apply ok as described, based on 3.4.  I have not yet tried on 3.4.1, or tested whether my rebased patch for #5513 will still work, but will do that.\n\nI have relabelled this \"positive review\" although on of the new patches -- the very trivial one -- was mine.",
    "created_at": "2009-03-29T17:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47006",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:17'></a>
I can confirm that the patches apply ok as described, based on 3.4.  I have not yet tried on 3.4.1, or tested whether my rebased patch for #5513 will still work, but will do that.

I have relabelled this "positive review" although on of the new patches -- the very trivial one -- was mine.



---

archive/issue_events_015544.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "Add functionality to Galois groups",
        "to": "[with positive  review] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15544"
}
```



---

archive/issue_comments_047007.json:
```json
{
    "body": "<a id='comment:18'></a>\nI have just checked that it applies cleanly to 3.4.1.alpha0, and sage -testall passes.",
    "created_at": "2009-03-29T17:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47007",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:18'></a>
I have just checked that it applies cleanly to 3.4.1.alpha0, and sage -testall passes.



---

archive/issue_comments_047008.json:
```json
{
    "body": "<a id='comment:19'></a>\nOops:  on a 64-bit machine I get this:\n\n```\njec@host-57-44:~/sage-3.4/devel/sage-5159$ sage -t sage/rings/number_field/galois_group.py\nsage -t  \"devel/sage-5159/sage/rings/number_field/galois_group.py\"\n**********************************************************************\nFile \"/home/jec/sage-3.4/devel/sage-5159/sage/rings/number_field/galois_group.py\", line 343:\n    sage: G.decomposition_group(P^2)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Fractional ideal (1/984*a^7 - 71/1968*a^5 + 29/984*a^3 + 527/328*a) is not prime\nGot:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-3.4/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-3.4/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-3.4/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest `__main__`.example_18[6]>\", line 1, in <module>\n        G.decomposition_group(P**Integer(2))###line 343:\n    sage: G.decomposition_group(P^2)\n      File \"/home/jec/sage-3.4/local/lib/python2.5/site-packages/sage/rings/number_field/galois_group.py\", line 357, in decomposition_group\n        raise ValueError, \"%s is not prime\" % P\n    ValueError: Fractional ideal (-1/492*a^7 + 101/1968*a^5 - 115/328*a^3 + 1717/984*a) is not prime\n**********************************************************************\nFile \"/home/jec/sage-3.4/devel/sage-5159/sage/rings/number_field/galois_group.py\", line 445:\n    sage: G.artin_symbol(K.primes_above(2)[0])\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Fractional ideal (-1/8364*b^7 + 1/492*b^6 - 11/16728*b^5 - 101/1968*b^4 + 209/2788*b^3 + 115/328*b^2 - 3139/8364*b + 251/984) is ramified\nGot:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-3.4/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-3.4/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-3.4/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest `__main__`.example_22[7]>\", line 1, in <module>\n        G.artin_symbol(K.primes_above(Integer(2))[Integer(0)])###line 445:\n    sage: G.artin_symbol(K.primes_above(2)[0])\n      File \"/home/jec/sage-3.4/local/lib/python2.5/site-packages/sage/rings/number_field/galois_group.py\", line 463, in artin_symbol\n        if len(t) > 1: raise ValueError, \"%s is ramified\" % P\n    ValueError: Fractional ideal (43/33456*b^7 + 7/1968*b^6 - 809/33456*b^5 - 35/656*b^4 + 367/2788*b^3 + 61/492*b^2 - 4651/16728*b + 757/984) is ramified\n**********************************************************************\n2 items had failures:\n   1 of   8 in `__main__`.example_18\n   1 of   8 in `__main__`.example_22\n```\n\nI think you cannot rely on pari giveing you the primes in a specific order:\n\n```\nsage: P = K.primes_above(17)[0]\nsage: P\nFractional ideal (1/492*a^7 - 101/1968*a^5 + 115/328*a^3 - 733/984*a)\nsage: P^2\nFractional ideal (-1/492*a^7 + 101/1968*a^5 - 115/328*a^3 + 1717/984*a)\nsage: Q = K.primes_above(17)[1]\nsage: Q^2\nFractional ideal (-5/2788*a^7 + 587/11152*a^5 - 2791/5576*a^3 + 13915/5576*a)\n```\nso the doctest needs to be designed to allow for that.  Perhaps define P via\n\n```\nsage: P=K.ideal(17,a^2)\nsage: P\nFractional ideal (1/492*a^7 - 101/1968*a^5 + 115/328*a^3 - 733/984*a)\nsage: P.is_prime()\nTrue\n```\n(which may or may not be the P i your doctest).",
    "created_at": "2009-03-30T11:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47008",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:19'></a>
Oops:  on a 64-bit machine I get this:

```
jec@host-57-44:~/sage-3.4/devel/sage-5159$ sage -t sage/rings/number_field/galois_group.py
sage -t  "devel/sage-5159/sage/rings/number_field/galois_group.py"
**********************************************************************
File "/home/jec/sage-3.4/devel/sage-5159/sage/rings/number_field/galois_group.py", line 343:
    sage: G.decomposition_group(P^2)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Fractional ideal (1/984*a^7 - 71/1968*a^5 + 29/984*a^3 + 527/328*a) is not prime
Got:
    Traceback (most recent call last):
      File "/home/jec/sage-3.4/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-3.4/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-3.4/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest `__main__`.example_18[6]>", line 1, in <module>
        G.decomposition_group(P**Integer(2))###line 343:
    sage: G.decomposition_group(P^2)
      File "/home/jec/sage-3.4/local/lib/python2.5/site-packages/sage/rings/number_field/galois_group.py", line 357, in decomposition_group
        raise ValueError, "%s is not prime" % P
    ValueError: Fractional ideal (-1/492*a^7 + 101/1968*a^5 - 115/328*a^3 + 1717/984*a) is not prime
**********************************************************************
File "/home/jec/sage-3.4/devel/sage-5159/sage/rings/number_field/galois_group.py", line 445:
    sage: G.artin_symbol(K.primes_above(2)[0])
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Fractional ideal (-1/8364*b^7 + 1/492*b^6 - 11/16728*b^5 - 101/1968*b^4 + 209/2788*b^3 + 115/328*b^2 - 3139/8364*b + 251/984) is ramified
Got:
    Traceback (most recent call last):
      File "/home/jec/sage-3.4/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-3.4/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-3.4/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest `__main__`.example_22[7]>", line 1, in <module>
        G.artin_symbol(K.primes_above(Integer(2))[Integer(0)])###line 445:
    sage: G.artin_symbol(K.primes_above(2)[0])
      File "/home/jec/sage-3.4/local/lib/python2.5/site-packages/sage/rings/number_field/galois_group.py", line 463, in artin_symbol
        if len(t) > 1: raise ValueError, "%s is ramified" % P
    ValueError: Fractional ideal (43/33456*b^7 + 7/1968*b^6 - 809/33456*b^5 - 35/656*b^4 + 367/2788*b^3 + 61/492*b^2 - 4651/16728*b + 757/984) is ramified
**********************************************************************
2 items had failures:
   1 of   8 in `__main__`.example_18
   1 of   8 in `__main__`.example_22
```

I think you cannot rely on pari giveing you the primes in a specific order:

```
sage: P = K.primes_above(17)[0]
sage: P
Fractional ideal (1/492*a^7 - 101/1968*a^5 + 115/328*a^3 - 733/984*a)
sage: P^2
Fractional ideal (-1/492*a^7 + 101/1968*a^5 - 115/328*a^3 + 1717/984*a)
sage: Q = K.primes_above(17)[1]
sage: Q^2
Fractional ideal (-5/2788*a^7 + 587/11152*a^5 - 2791/5576*a^3 + 13915/5576*a)
```
so the doctest needs to be designed to allow for that.  Perhaps define P via

```
sage: P=K.ideal(17,a^2)
sage: P
Fractional ideal (1/492*a^7 - 101/1968*a^5 + 115/328*a^3 - 733/984*a)
sage: P.is_prime()
True
```
(which may or may not be the P i your doctest).



---

archive/issue_events_015545.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[with positive  review] Add functionality to Galois groups",
        "to": "[with positive review but needs work] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15545"
}
```



---

archive/issue_comments_047009.json:
```json
{
    "body": "<a id='comment:20'></a>\nIt doesn't greatly matter which P is being used, since they are all Galois-conjugate. Thus I have put a \"...\" in the two doctests that failed above. I've tested it on a 64-bit machine with this fix and now all doctests in sage/rings/number_fields pass there too. Patch coming in a moment.\n\nDavid",
    "created_at": "2009-03-30T12:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47009",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:20'></a>
It doesn't greatly matter which P is being used, since they are all Galois-conjugate. Thus I have put a "..." in the two doctests that failed above. I've tested it on a 64-bit machine with this fix and now all doctests in sage/rings/number_fields pass there too. Patch coming in a moment.

David



---

archive/issue_comments_047010.json:
```json
{
    "body": "Apply over previous three patches",
    "created_at": "2009-03-30T12:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47010",
    "user": "https://github.com/loefflerd"
}
```

Apply over previous three patches



---

archive/issue_events_015546.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "[with positive review but needs work] Add functionality to Galois groups",
        "to": "Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15546"
}
```



---

archive/issue_comments_047011.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-03-31T03:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47011",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from new to needs_review.



---

archive/attachments_005810.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5159-64bit-doctest.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5159/5159-64bit-doctest.patch",
    "created_at": "2009-03-31T03:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```



---

archive/issue_comments_047012.json:
```json
{
    "body": "<a id='comment:21'></a>\n",
    "created_at": "2009-03-31T03:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47012",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:21'></a>




---

archive/issue_comments_047013.json:
```json
{
    "body": "<a id='comment:22'></a>\nWhen merging\n\n* trac_5159_galois_new.patch\n* trac_5159_extra.patch\n* trac_5159-unpickle-fix.patch\n* trac_5159-64bit-doctest.patch\n\nI am seeing the following doctest failure on sage.math, i.e. 64 bit Linux:\n\n```\nsage -t -long \"devel/sage/doc/en/bordeaux_2008/nf_galois_groups.rst\"\n**********************************************************************\nFile \"/scratch/mabshoff/sage-3.4.1.rc0/devel/sage/doc/en/bordeaux_2008/nf_galois_groups.rst\", line 44:\n    sage: [G.artin_symbol(Q) for Q in K.primes_above(5)]\nExpected:\n    [(1,5)(2,4)(3,6), (1,3)(2,6)(4,5), (1,2)(3,4)(5,6)]\nGot:\n    [(1,5)(2,4)(3,6), (1,2)(3,4)(5,6), (1,3)(2,6)(4,5)]\n**********************************************************************\n```\nI would guess that sorting the list might fix the issue.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-31T07:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47013",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:22'></a>
When merging

* trac_5159_galois_new.patch
* trac_5159_extra.patch
* trac_5159-unpickle-fix.patch
* trac_5159-64bit-doctest.patch

I am seeing the following doctest failure on sage.math, i.e. 64 bit Linux:

```
sage -t -long "devel/sage/doc/en/bordeaux_2008/nf_galois_groups.rst"
**********************************************************************
File "/scratch/mabshoff/sage-3.4.1.rc0/devel/sage/doc/en/bordeaux_2008/nf_galois_groups.rst", line 44:
    sage: [G.artin_symbol(Q) for Q in K.primes_above(5)]
Expected:
    [(1,5)(2,4)(3,6), (1,3)(2,6)(4,5), (1,2)(3,4)(5,6)]
Got:
    [(1,5)(2,4)(3,6), (1,2)(3,4)(5,6), (1,3)(2,6)(4,5)]
**********************************************************************
```
I would guess that sorting the list might fix the issue.

Cheers,

Michael



---

archive/issue_comments_047014.json:
```json
{
    "body": "<a id='comment:23'></a>\nSorting the list exposed another bug, which I refuse to accept any responsibility for whatsoever: there is something funny going on in the default `__cmp__` routine in sage.structure.element.Element, which meant that if x,y were GaloisGroupElements then cmp(x, y) worked but sorted([x, y]) didn't. \n\nI've worked around this by implementing `__cmp__` directly for GaloisGroupElements. This gets the doctests in doc/en/bordeaux_2008 to pass on 32bit and 64bit.\n\nApologies that these things didn't get spotted earlier, but I'm working from home on a clapped out old 32-bit laptop, on which running sage -testall takes over three hours, so when I was working on this I only ran the doctests in sage/rings/number_field. That's a mistake I won't make again.\n\nDavid",
    "created_at": "2009-03-31T08:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47014",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:23'></a>
Sorting the list exposed another bug, which I refuse to accept any responsibility for whatsoever: there is something funny going on in the default `__cmp__` routine in sage.structure.element.Element, which meant that if x,y were GaloisGroupElements then cmp(x, y) worked but sorted([x, y]) didn't. 

I've worked around this by implementing `__cmp__` directly for GaloisGroupElements. This gets the doctests in doc/en/bordeaux_2008 to pass on 32bit and 64bit.

Apologies that these things didn't get spotted earlier, but I'm working from home on a clapped out old 32-bit laptop, on which running sage -testall takes over three hours, so when I was working on this I only ran the doctests in sage/rings/number_field. That's a mistake I won't make again.

David



---

archive/issue_comments_047015.json:
```json
{
    "body": "apply over previous four patches (!)",
    "created_at": "2009-03-31T08:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47015",
    "user": "https://github.com/loefflerd"
}
```

apply over previous four patches (!)



---

archive/attachments_005811.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5159-sort-fix.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5159/5159-sort-fix.patch",
    "created_at": "2009-03-31T08:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_047016.json:
```json
{
    "body": "<a id='comment:24'></a>\nI'll test all these in a minute....",
    "created_at": "2009-03-31T08:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47016",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:24'></a>
I'll test all these in a minute....



---

archive/issue_comments_047017.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [cremona](#comment%3A24):\n> I'll test all these in a minute....\n\nunfortunately the total weirdness I came across just now in testing 5513 is still here.  It looks like I cannot test anything on 3.4.1.alpha0 without rebuilding from scratch, which unfortunately would not finish until after my free time for the day is over.  So unless mabshoff has any idea what was causing that, it will be hard for me to do anything useful for a while.",
    "created_at": "2009-03-31T08:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47017",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:25'></a>
Replying to [cremona](#comment%3A24):
> I'll test all these in a minute....

unfortunately the total weirdness I came across just now in testing 5513 is still here.  It looks like I cannot test anything on 3.4.1.alpha0 without rebuilding from scratch, which unfortunately would not finish until after my free time for the day is over.  So unless mabshoff has any idea what was causing that, it will be hard for me to do anything useful for a while.



---

archive/issue_comments_047018.json:
```json
{
    "body": "<a id='comment:26'></a>\nWell the good news is that on my 64-bit build (on Bill Hart's computer) I successfully applied all 5 patches to 3.4.1.alpha0, and all tests (in sage/rings/number_field) pass, so I will give this a positive review and hope that it works for Michael too.",
    "created_at": "2009-03-31T09:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47018",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:26'></a>
Well the good news is that on my 64-bit build (on Bill Hart's computer) I successfully applied all 5 patches to 3.4.1.alpha0, and all tests (in sage/rings/number_field) pass, so I will give this a positive review and hope that it works for Michael too.



---

archive/issue_events_015547.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "rename": {
        "from": "Add functionality to Galois groups",
        "to": "[with positive review] Add functionality to Galois groups"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15547"
}
```



---

archive/issue_events_015548.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-31T09:35:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15548"
}
```



---

archive/issue_events_015549.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-31T09:35:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15549"
}
```



---

archive/issue_comments_047019.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-03-31T09:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47019",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_events_015550.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-31T09:35:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5159#event-15550"
}
```



---

archive/issue_comments_047020.json:
```json
{
    "body": "<a id='comment:27'></a>\nMerged \n\n* trac_5159_part_1_galois_new.patch\n* trac_5159_part_2_extra.patch\n* trac_5159_part_3-unpickle-fix.patch\n* trac_5159_part_4-64bit-doctest.patch\n* trac_5159_part_5_sort-fix.patch\n\nin Sage 3.4.1.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-31T09:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47020",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:27'></a>
Merged 

* trac_5159_part_1_galois_new.patch
* trac_5159_part_2_extra.patch
* trac_5159_part_3-unpickle-fix.patch
* trac_5159_part_4-64bit-doctest.patch
* trac_5159_part_5_sort-fix.patch

in Sage 3.4.1.rc0.

Cheers,

Michael



---

archive/issue_comments_047021.json:
```json
{
    "body": "**Reviewer:** John Cremona",
    "created_at": "2009-06-07T08:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47021",
    "user": "https://github.com/loefflerd"
}
```

**Reviewer:** John Cremona



---

archive/issue_comments_047022.json:
```json
{
    "body": "**Merged:** 3.4.1.rc0",
    "created_at": "2009-06-07T08:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47022",
    "user": "https://github.com/loefflerd"
}
```

**Merged:** 3.4.1.rc0



---

archive/issue_comments_047023.json:
```json
{
    "body": "**Author:** David Loeffler",
    "created_at": "2009-06-07T08:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5159#issuecomment-47023",
    "user": "https://github.com/loefflerd"
}
```

**Author:** David Loeffler
