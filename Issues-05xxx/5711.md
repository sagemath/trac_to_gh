# Issue 5711: Enhanced Typesetting of Symbolic Functions

archive/issues_005711.json:
```json
{
    "assignees": [],
    "body": "Here is a patch that enhances current typesetting capability\nof symbolic functions within sage.\n\nThis issue has been under a long discussion in the thread\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/a51f269f057d8223/536b4ef2493bb20c\n\n**Note: Switch to new symbolics has caused some functions to be changed**\n\nMain enhancements are:\n\n(1) Symbolics functions with name in Greek letters (with possible\nsuffixes), are typeset nicely in LaTeX.\n\nEx:  psi(x)  =>  \\psi(x)\n     f0(x)  =>  f_0(x)\n\n\n(2) Functions such as \"diff\", \"integrate\", \"limit\", \"conjugate\",\n\"laplace\", \"inverse_laplace\" are now typeset within Sage itself.\n\nEx:  integrate(f(x),x)  =>    \\int f(x) dx\n\n(3) Default (fall-back) typesetting for unknown functions (as\nin Maxima).\n\nEx:  myfn(x)   =>  {\\it myfn}(x)\n\n(4) **[ This is diasbled in new symbolics. However, equivalent feature will be available in new symbolics ]**\nAllows users to define their own/custom LaTeX expression\nfor any symbolic functions via a new method \"set_latex()\" for\nthe class SymbolicFunctionEvaluation.\n\nEx: \n\n```\nvar('t');\nhubble(t) = function('hubble',t)\nhubble(t).set_latex('\\\\mathcal{H}')\n\n#To reset custom LaTeX expression\nhubble(t).set_latex()\n```\n\n(5) **[ This has been disabled in new Symbolics as SymbolicVariable class has changed ]**\nIf the arguments of a symbolic function are all symbolic\nvariables then typesetting will avoid using \\left(, \\right).\n\nEx:  Phi(x,y) => \\Phi(x, y)  (if x,y are symbolic vars)\n\n\n\n(6) **[New in the rebased patch]** New symbolics uses \"D\" \nformat for derivatives instead of old \"diff\" format. \nThe rebased patch typesets symbolic derivatives in old \"diff\" format by default as in this format typeset version looks similar to those found in text books, journals.\n\nHowever see this thread for known limitations of current conversion between these two formats\n http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2\n\nOne can switch between two typesetting format as follows\n\n```\nf(x) = function('f',x)\ng = diff(f(x),x)\nlatex(g) \n\\frac{d f\\left(x\\right)}{d x}\n# Switch to D format\nsage.symbolic.pynac.typeset_d_as_diff=False\nlatex(g)\nD[0]f\\left(x\\right)\n```\n\n\n(7) **[New in the rebased patch]**  The rebased patch resolves\nthe issue\n\nhttps://github.com/sagemath/sage/issues/6268\n\n\n**[Update: in v3 (4.0.2) ]**\n\nAs suggested by Burcin in his referee report, following changes are made in the patch:\n\n**(1)**  Typesetting of \"diff\" is moved to a new ticket #6344\n\n\n**(2)**  Four helper functions  _limit_latex_(), _integrate_latex_(), _laplace_latex_() and _inverse_laplace_latex_() have been moved to calculus/calculus.py. Then they are hooked to the instances of SFunction class by using dummy functions for better integration with the new symbolics.\n\n\n**(3)**  Four earlier functions latex_symbolic_function(), _symbolic_function_default_latex_(), _args_latex_(), _conjugate_latex() are removed.\n\n\n**(4)**  latex_function_name() is also replaced as the updated latex_variable_name() is augmented to take a new flag \"is_fname\". This will ensure that same typesetting convention is followed for both known functions such as \\sin (:= {\\rm sin}), \\cos (:= {\\rm cos}) and user defined function names such as \"mysin\" (=> {\\rm mysin}).\n\n\n\n\n\n\n**Assignee:** cwitty\n\n**CC:**  @burcin @jasongrout @jhpalmieri schymans\n\n**Keywords:** Enhance Typesetting, LaTeX, Symbolic Functions\n\n**Author:** Golam Mortuza Hossain\n\n**Reviewer:** Burcin Erocal\n\n**Merged:** sage-4.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/5711\n\n",
    "closed_at": "2009-06-24T09:52:03Z",
    "created_at": "2009-04-08T11:55:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Enhanced Typesetting of Symbolic Functions",
    "type": "issue",
    "updated_at": "2009-06-24T10:56:09Z",
    "url": "https://github.com/sagemath/sage/issues/5711",
    "user": "https://github.com/golam-m-hossain"
}
```
Here is a patch that enhances current typesetting capability
of symbolic functions within sage.

This issue has been under a long discussion in the thread

http://groups.google.com/group/sage-devel/browse_thread/thread/a51f269f057d8223/536b4ef2493bb20c

**Note: Switch to new symbolics has caused some functions to be changed**

Main enhancements are:

(1) Symbolics functions with name in Greek letters (with possible
suffixes), are typeset nicely in LaTeX.

Ex:  psi(x)  =>  \psi(x)
     f0(x)  =>  f_0(x)


(2) Functions such as "diff", "integrate", "limit", "conjugate",
"laplace", "inverse_laplace" are now typeset within Sage itself.

Ex:  integrate(f(x),x)  =>    \int f(x) dx

(3) Default (fall-back) typesetting for unknown functions (as
in Maxima).

Ex:  myfn(x)   =>  {\it myfn}(x)

(4) **[ This is diasbled in new symbolics. However, equivalent feature will be available in new symbolics ]**
Allows users to define their own/custom LaTeX expression
for any symbolic functions via a new method "set_latex()" for
the class SymbolicFunctionEvaluation.

Ex: 

```
var('t');
hubble(t) = function('hubble',t)
hubble(t).set_latex('\\mathcal{H}')

#To reset custom LaTeX expression
hubble(t).set_latex()
```

(5) **[ This has been disabled in new Symbolics as SymbolicVariable class has changed ]**
If the arguments of a symbolic function are all symbolic
variables then typesetting will avoid using \left(, \right).

Ex:  Phi(x,y) => \Phi(x, y)  (if x,y are symbolic vars)



(6) **[New in the rebased patch]** New symbolics uses "D" 
format for derivatives instead of old "diff" format. 
The rebased patch typesets symbolic derivatives in old "diff" format by default as in this format typeset version looks similar to those found in text books, journals.

However see this thread for known limitations of current conversion between these two formats
 http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2

One can switch between two typesetting format as follows

```
f(x) = function('f',x)
g = diff(f(x),x)
latex(g) 
\frac{d f\left(x\right)}{d x}
# Switch to D format
sage.symbolic.pynac.typeset_d_as_diff=False
latex(g)
D[0]f\left(x\right)
```


(7) **[New in the rebased patch]**  The rebased patch resolves
the issue

https://github.com/sagemath/sage/issues/6268


**[Update: in v3 (4.0.2) ]**

As suggested by Burcin in his referee report, following changes are made in the patch:

**(1)**  Typesetting of "diff" is moved to a new ticket #6344


**(2)**  Four helper functions  _limit_latex_(), _integrate_latex_(), _laplace_latex_() and _inverse_laplace_latex_() have been moved to calculus/calculus.py. Then they are hooked to the instances of SFunction class by using dummy functions for better integration with the new symbolics.


**(3)**  Four earlier functions latex_symbolic_function(), _symbolic_function_default_latex_(), _args_latex_(), _conjugate_latex() are removed.


**(4)**  latex_function_name() is also replaced as the updated latex_variable_name() is augmented to take a new flag "is_fname". This will ensure that same typesetting convention is followed for both known functions such as \sin (:= {\rm sin}), \cos (:= {\rm cos}) and user defined function names such as "mysin" (=> {\rm mysin}).






**Assignee:** cwitty

**CC:**  @burcin @jasongrout @jhpalmieri schymans

**Keywords:** Enhance Typesetting, LaTeX, Symbolic Functions

**Author:** Golam Mortuza Hossain

**Reviewer:** Burcin Erocal

**Merged:** sage-4.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/5711





---

archive/issue_events_055868.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-04-08T11:55:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "milestone_number": null,
    "milestone_title": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55868"
}
```



---

archive/issue_events_055869.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-04-08T11:55:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20misc",
    "label_color": "08517b",
    "label_name": "component: misc",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55869"
}
```



---

archive/issue_events_055870.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-04-08T11:55:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55870"
}
```



---

archive/issue_events_055871.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-04-08T11:55:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55871"
}
```



---

archive/issue_comments_037461.json:
```json
{
    "body": "**Attachment:** [enhanced-typesetting-of-symbolic-functions.patch.gz](https://github.com/sagemath/sage/files/ticket5711/enhanced-typesetting-of-symbolic-functions.patch.gz)",
    "created_at": "2009-04-08T11:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37461",
    "user": "https://github.com/golam-m-hossain"
}
```

**Attachment:** [enhanced-typesetting-of-symbolic-functions.patch.gz](https://github.com/sagemath/sage/files/ticket5711/enhanced-typesetting-of-symbolic-functions.patch.gz)



---

archive/issue_comments_037462.json:
```json
{
    "body": "<a id='comment:3'></a>\nburcin: do you want to review this?  Does the move to the new symbolics affect this patch?",
    "created_at": "2009-05-30T05:40:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37462",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
burcin: do you want to review this?  Does the move to the new symbolics affect this patch?



---

archive/issue_events_055872.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-09T21:59:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "rename": {
        "from": "Enhanced Typesetting of Symbolic Functions",
        "to": "[needs rebase] Enhanced Typesetting of Symbolic Functions"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55872"
}
```



---

archive/issue_comments_037463.json:
```json
{
    "body": "<a id='comment:4'></a>\nPatch doesn't apply cleanly against 4.0.1.",
    "created_at": "2009-06-09T21:59:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37463",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
Patch doesn't apply cleanly against 4.0.1.



---

archive/issue_comments_037464.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [@jhpalmieri](#comment%3A4):\n> Patch doesn't apply cleanly against 4.0.1.\n\nYes, recent switch to new symbolics has affected this patch quite a bit.\nIn fact, the class \"SymbolicFunctionEvaluation\" (whose enhancement was aimed\nthrough this patch) doesn't exist anymore. I am now looking into the \nnew symbolics code to properly rebase the patch.",
    "created_at": "2009-06-09T22:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37464",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:5'></a>
Replying to [@jhpalmieri](#comment%3A4):
> Patch doesn't apply cleanly against 4.0.1.

Yes, recent switch to new symbolics has affected this patch quite a bit.
In fact, the class "SymbolicFunctionEvaluation" (whose enhancement was aimed
through this patch) doesn't exist anymore. I am now looking into the 
new symbolics code to properly rebase the patch.



---

archive/issue_events_055873.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-06-12T16:01:00Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "rename": {
        "from": "[needs rebase] Enhanced Typesetting of Symbolic Functions",
        "to": "Enhanced Typesetting of Symbolic Functions"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55873"
}
```



---

archive/issue_events_055874.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-06-12T16:01:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55874"
}
```



---

archive/issue_comments_037465.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,24 +5,29 @@\n \n http://groups.google.com/group/sage-devel/browse_thread/thread/a51f269f057d8223/536b4ef2493bb20c\n \n+**Note: Switch to new symbolics has caused some functions to be changed**\n+\n Main enhancements are:\n \n (1) Symbolics functions with name in Greek letters (with possible\n suffixes), are typeset nicely in LaTeX.\n \n Ex:  psi(x)  =>  \\psi(x)\n+     f0(x)  =>  f_0(x)\n+\n \n (2) Functions such as \"diff\", \"integrate\", \"limit\", \"conjugate\",\n-\"laplace\", \"inverse_lapse\" are now typeset within Sage itself.\n+\"laplace\", \"inverse_laplace\" are now typeset within Sage itself.\n \n-Ex:  psi(x).conjugate()  =>    {\\psi}^*(x)\n+Ex:  integrate(f(x),x)  =>    \\int f(x) dx\n \n (3) Default (fall-back) typesetting for unknown functions (as\n in Maxima).\n \n Ex:  myfn(x)   =>  {\\it myfn}(x)\n \n-(4) Allows users to define their own/custom LaTeX expression\n+(4) **[ This is diasbled in new symbolics. However, equivalent feature will be available in new symbolics ]**\n+Allows users to define their own/custom LaTeX expression\n for any symbolic functions via a new method \"set_latex()\" for\n the class SymbolicFunctionEvaluation.\n \n@@ -37,17 +42,38 @@\n hubble(t).set_latex()\n ```\n \n-(5)  If the arguments of a symbolic function are all symbolic\n+(5) **[ This has been disabled in new Symbolics as SymbolicVariable class has changed ]**\n+If the arguments of a symbolic function are all symbolic\n variables then typesetting will avoid using \\left(, \\right).\n \n Ex:  Phi(x,y) => \\Phi(x, y)  (if x,y are symbolic vars)\n \n \n-Note: You need to apply a small patch\n \n-https://github.com/sagemath/sage/issues/5678\n+(6) **[New in the rebased patch]** New symbolics uses \"D\" \n+format for derivatives instead of old \"diff\" format. \n+The rebased patch typesets symbolic derivatives in old \"diff\" format by default as in this format typeset version looks similar to those found in text books, journals.\n \n-before you apply the attached patch. This patch is\n-created using sage-3.4.\n+However see this thread for known limitations of current conversion between these two formats\n+ http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2\n+\n+One can switch between two typesetting format as follows\n+\n+```\n+f(x) = function('f',x)\n+g = diff(f(x),x)\n+latex(g) \n+\\frac{d f\\left(x\\right)}{d x}\n+# Switch to D format\n+sage.symbolic.pynac.typeset_d_as_diff=False\n+latex(g)\n+D[0]f\\left(x\\right)\n+```\n \n \n+(7) **[New in the rebased patch]**  The rebased patch resolves\n+the issue\n+\n+https://github.com/sagemath/sage/issues/6268\n+\n+\n``````\n",
    "created_at": "2009-06-12T16:01:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37465",
    "user": "https://github.com/golam-m-hossain"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,24 +5,29 @@
 
 http://groups.google.com/group/sage-devel/browse_thread/thread/a51f269f057d8223/536b4ef2493bb20c
 
+**Note: Switch to new symbolics has caused some functions to be changed**
+
 Main enhancements are:
 
 (1) Symbolics functions with name in Greek letters (with possible
 suffixes), are typeset nicely in LaTeX.
 
 Ex:  psi(x)  =>  \psi(x)
+     f0(x)  =>  f_0(x)
+
 
 (2) Functions such as "diff", "integrate", "limit", "conjugate",
-"laplace", "inverse_lapse" are now typeset within Sage itself.
+"laplace", "inverse_laplace" are now typeset within Sage itself.
 
-Ex:  psi(x).conjugate()  =>    {\psi}^*(x)
+Ex:  integrate(f(x),x)  =>    \int f(x) dx
 
 (3) Default (fall-back) typesetting for unknown functions (as
 in Maxima).
 
 Ex:  myfn(x)   =>  {\it myfn}(x)
 
-(4) Allows users to define their own/custom LaTeX expression
+(4) **[ This is diasbled in new symbolics. However, equivalent feature will be available in new symbolics ]**
+Allows users to define their own/custom LaTeX expression
 for any symbolic functions via a new method "set_latex()" for
 the class SymbolicFunctionEvaluation.
 
@@ -37,17 +42,38 @@
 hubble(t).set_latex()
 ```
 
-(5)  If the arguments of a symbolic function are all symbolic
+(5) **[ This has been disabled in new Symbolics as SymbolicVariable class has changed ]**
+If the arguments of a symbolic function are all symbolic
 variables then typesetting will avoid using \left(, \right).
 
 Ex:  Phi(x,y) => \Phi(x, y)  (if x,y are symbolic vars)
 
 
-Note: You need to apply a small patch
 
-https://github.com/sagemath/sage/issues/5678
+(6) **[New in the rebased patch]** New symbolics uses "D" 
+format for derivatives instead of old "diff" format. 
+The rebased patch typesets symbolic derivatives in old "diff" format by default as in this format typeset version looks similar to those found in text books, journals.
 
-before you apply the attached patch. This patch is
-created using sage-3.4.
+However see this thread for known limitations of current conversion between these two formats
+ http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2
+
+One can switch between two typesetting format as follows
+
+```
+f(x) = function('f',x)
+g = diff(f(x),x)
+latex(g) 
+\frac{d f\left(x\right)}{d x}
+# Switch to D format
+sage.symbolic.pynac.typeset_d_as_diff=False
+latex(g)
+D[0]f\left(x\right)
+```
 
 
+(7) **[New in the rebased patch]**  The rebased patch resolves
+the issue
+
+https://github.com/sagemath/sage/issues/6268
+
+
``````




---

archive/issue_events_055875.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-06-12T19:46:58Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "rename": {
        "from": "Enhanced Typesetting of Symbolic Functions",
        "to": "[partial positive review] Enhanced Typesetting of Symbolic Functions"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55875"
}
```



---

archive/issue_comments_037466.json:
```json
{
    "body": "<a id='comment:7'></a>\nThis is really impressive.   I assume that stan s and the others will want to review this more since they would use it more intensely and understand LaTeX better than I do, but I threw it a lot of stuff and the only \"problems\" I found were additional cases one might want, which could easily be a separate ticket after this is merged.  The integrals, limits, Laplace, derivatives work out nice now, as does the option for D.  \n1. Only some underscore things do subscripts, and double subscripts don't work.  That's fine, but might as well search for them if possible, e.g. HH_sigma or WWW_xy_z or something could also typeset.\n2. The weird cases mentioned in various threads such as D[0](f)(sin(x)*cos(x)) look nice but have e.g. dcos(x)*sin(x) in the denominator, not giving Jason's suggestion of -(sin(x)<sup>2-cos(x)</sup>2)*\\frac{df}{dx}(sin(x)*cos(x)).  I assume that's okay but wanted to check.\n3. There is still the same typesetting for e.g. variables mu and mu_.  I think that sort of makes sense, since mu_1 and mu1 give the same thing, but it does seem strange.\n4. Some stuff still doesn't work, but I don't know if it did before.  For instance, sqrt(mu) is okay, but e^(sqrt(mu)) is not, or even e^(sqrt(x)).  So #6211 can't be closed, not that you claimed it could - but it would fit naturally here.  Check out show(e^function(f_mu,x)) for a real kick.\n5. Limit and integral syntax don't (yet) allow multiple things for multiple variables, but since they are nested by parentheses it would be nice for those to show up, which they currently don't (however, they do calculate properly).  This definitely is not within the purview of this ticket.\nGreat work from my view!  Except I almost always declare my function f(x)=x^2, not symbolic, so I will probably not use it much.  But it will be good for subscripts for sure!",
    "created_at": "2009-06-12T19:46:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37466",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>
This is really impressive.   I assume that stan s and the others will want to review this more since they would use it more intensely and understand LaTeX better than I do, but I threw it a lot of stuff and the only "problems" I found were additional cases one might want, which could easily be a separate ticket after this is merged.  The integrals, limits, Laplace, derivatives work out nice now, as does the option for D.  
1. Only some underscore things do subscripts, and double subscripts don't work.  That's fine, but might as well search for them if possible, e.g. HH_sigma or WWW_xy_z or something could also typeset.
2. The weird cases mentioned in various threads such as D[0](f)(sin(x)*cos(x)) look nice but have e.g. dcos(x)*sin(x) in the denominator, not giving Jason's suggestion of -(sin(x)<sup>2-cos(x)</sup>2)*\frac{df}{dx}(sin(x)*cos(x)).  I assume that's okay but wanted to check.
3. There is still the same typesetting for e.g. variables mu and mu_.  I think that sort of makes sense, since mu_1 and mu1 give the same thing, but it does seem strange.
4. Some stuff still doesn't work, but I don't know if it did before.  For instance, sqrt(mu) is okay, but e^(sqrt(mu)) is not, or even e^(sqrt(x)).  So #6211 can't be closed, not that you claimed it could - but it would fit naturally here.  Check out show(e^function(f_mu,x)) for a real kick.
5. Limit and integral syntax don't (yet) allow multiple things for multiple variables, but since they are nested by parentheses it would be nice for those to show up, which they currently don't (however, they do calculate properly).  This definitely is not within the purview of this ticket.
Great work from my view!  Except I almost always declare my function f(x)=x^2, not symbolic, so I will probably not use it much.  But it will be good for subscripts for sure!



---

archive/issue_comments_037467.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis patch does not pass doctests on sage.math:\n\n```\nsage -t  \"devel/sage/sage/symbolic/function.pyx\"            \n**********************************************************************\nFile \"/scratch/palmieri/sage-4.0.1/devel/sage/sage/symbolic/function.pyx\", line 121:\n    sage: latex(foo(x,y^z))\nExpected:\n    \\mbox{t}\\left(x, y^{z}\\right)\nGot:\n    t\\left(x, y^{z}\\right)\n**********************************************************************\nFile \"/scratch/palmieri/sage-4.0.1/devel/sage/sage/symbolic/function.pyx\", line 129:\n    sage: latex(foo(x,y^z))\nExpected:\n    \\mbox{foo}\\left(x, y^{z}\\right)\nGot:\n    foo\\left(x, y^{z}\\right)\n**********************************************************************\n1 items had failures:\n   2 of  45 in __main__.example_2\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /scratch/palmieri/sage-4.0.1/tmp/.doctest_function.py\n\t [1.2 s]\nexit code: 1024\n```\nShould be easy enough to fix.",
    "created_at": "2009-06-12T23:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37467",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
This patch does not pass doctests on sage.math:

```
sage -t  "devel/sage/sage/symbolic/function.pyx"            
**********************************************************************
File "/scratch/palmieri/sage-4.0.1/devel/sage/sage/symbolic/function.pyx", line 121:
    sage: latex(foo(x,y^z))
Expected:
    \mbox{t}\left(x, y^{z}\right)
Got:
    t\left(x, y^{z}\right)
**********************************************************************
File "/scratch/palmieri/sage-4.0.1/devel/sage/sage/symbolic/function.pyx", line 129:
    sage: latex(foo(x,y^z))
Expected:
    \mbox{foo}\left(x, y^{z}\right)
Got:
    foo\left(x, y^{z}\right)
**********************************************************************
1 items had failures:
   2 of  45 in __main__.example_2
***Test Failed*** 2 failures.
For whitespace errors, see the file /scratch/palmieri/sage-4.0.1/tmp/.doctest_function.py
	 [1.2 s]
exit code: 1024
```
Should be easy enough to fix.



---

archive/issue_events_055876.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-12T23:10:40Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "rename": {
        "from": "[partial positive review] Enhanced Typesetting of Symbolic Functions",
        "to": "Enhanced Typesetting of Symbolic Functions"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55876"
}
```



---

archive/issue_events_055877.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-12T23:10:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55877"
}
```



---

archive/issue_events_055878.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-12T23:10:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55878"
}
```



---

archive/issue_comments_037468.json:
```json
{
    "body": "**Attachment:** [enhanced-symbolic-typesetting-rebased_to_4.0.1.patch.gz](https://github.com/sagemath/sage/files/ticket5711/enhanced-symbolic-typesetting-rebased_to_4.0.1.patch.gz)",
    "created_at": "2009-06-13T00:14:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37468",
    "user": "https://github.com/golam-m-hossain"
}
```

**Attachment:** [enhanced-symbolic-typesetting-rebased_to_4.0.1.patch.gz](https://github.com/sagemath/sage/files/ticket5711/enhanced-symbolic-typesetting-rebased_to_4.0.1.patch.gz)



---

archive/issue_events_055879.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-06-13T00:21:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55879"
}
```



---

archive/issue_events_055880.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-06-13T00:21:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55880"
}
```



---

archive/issue_comments_037469.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks! I have fixed these two doctest failure and updated the rebased patch.",
    "created_at": "2009-06-13T00:21:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37469",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:9'></a>
Thanks! I have fixed these two doctest failure and updated the rebased patch.



---

archive/issue_comments_037470.json:
```json
{
    "body": "<a id='comment:10'></a>\nThanks kcrisman! As you have suggested, I would also prefer to fix only the blockers \nin this patch and leave other enhancements for follow-up patches. \n\n> 1. Some stuff still doesn't work, but I don't know if it did before.  For instance, sqrt(mu) is okay, but e^(sqrt(mu)) is not, or even e^(sqrt(x)).  So #6211 can't be closed, not that you claimed it could - but it would fit naturally here.  Check out show(e^function(f_mu,x)) for a real kick.\n\nThis seems to be a bug for \"exp\" function. Other functions such as \"abs\", \"sin\" etc work fine. I have posted\nmy comments there with a easy fix. It would be better to have a separate patch for that bug.",
    "created_at": "2009-06-13T12:17:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37470",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:10'></a>
Thanks kcrisman! As you have suggested, I would also prefer to fix only the blockers 
in this patch and leave other enhancements for follow-up patches. 

> 1. Some stuff still doesn't work, but I don't know if it did before.  For instance, sqrt(mu) is okay, but e^(sqrt(mu)) is not, or even e^(sqrt(x)).  So #6211 can't be closed, not that you claimed it could - but it would fit naturally here.  Check out show(e^function(f_mu,x)) for a real kick.

This seems to be a bug for "exp" function. Other functions such as "abs", "sin" etc work fine. I have posted
my comments there with a easy fix. It would be better to have a separate patch for that bug.



---

archive/issue_events_055881.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-14T14:40:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55881"
}
```



---

archive/issue_events_055882.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-14T14:40:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55882"
}
```



---

archive/issue_events_055883.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-14T14:40:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20misc",
    "label_color": "08517b",
    "label_name": "component: misc",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55883"
}
```



---

archive/issue_events_055884.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-14T14:40:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "08517b",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55884"
}
```



---

archive/issue_comments_037471.json:
```json
{
    "body": "Hi Golam,\n\nThanks for your continued work on this. I see that your patch improves the typesetting of symbolic functions dramatically. I believe with a few improvements it would fit better in the new symbolics framework.\n\nHere is my referee report:\n\nQuotes from the description:\n> \n> (2) Functions such as \"diff\", \"integrate\", \"limit\", \"conjugate\",\n> \"laplace\", \"inverse_laplace\" are now typeset within Sage itself.\n> \n> Ex:  integrate(f(x),x)  =>    \\int f(x) dx\n\nThese should be handled using the custom printing facilities of `sage.symbolic.function.SFunction`. Special casing them in the new `latex_symbolic_function()` function is not scalable. This approach would also make the checks for the number of arguments as well as the calls to `_symbolic_function_default_latex_()` in each of these functions redundant.\n\nI see that there is already a `_limit` function defined in `sage/calculus/calculus.py`. I think the best solution for the short term would be to put these printing functions there, and give them as an argument to the `SFunction` constructor.\n\nConjugates are already printed as:\n\n```\nsage: latex(x.conjugate())\n\\bar{x}\n```\n\nWhy is `\\overline` better?\n\n> (6) **[New in the rebased patch]** New symbolics uses \"D\" \n> format for derivatives instead of old \"diff\" format. \n> The rebased patch typesets symbolic derivatives in old \"diff\" format by default as in this format typeset version looks similar to those found in text books, journals.\n> \n> However see this thread for known limitations of current conversion between these two formats\n>  http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2\n> \n> One can switch between two typesetting format as follows\n> \n> ```\n> f(x) = function('f',x)\n> g = diff(f(x),x)\n> latex(g) \n> \\frac{d f\\left(x\\right)}{d x}\n> # Switch to D format\n> sage.symbolic.pynac.typeset_d_as_diff=False\n> latex(g)\n> D[0]f\\left(x\\right)\n> ```\n\nI believe this issue needs more debate, preferably with examples of how Maple and MMA handle this problem. I will post a new message about this to sage-devel soon. For now, I suggest we split this to a different ticket.\n\n> (1) Symbolics functions with name in Greek letters (with possible\n> suffixes), are typeset nicely in LaTeX.\n> \n> Ex:  psi(x)  =>  \\psi(x)\n>      f0(x)  =>  f_0(x)\n\nCan't this be handled by a call to the new `latex_function_name()` from `sage.symbolic.pynac.py_latex_function_pystring()`?\n\n> (3) Default (fall-back) typesetting for unknown functions (as\n> in Maxima).\n> \n> Ex:  myfn(x)   =>  {\\it myfn}(x)\n\nWe have the GiNaC convention of falling back to `\\mbox` at the moment. Previously, maxima didn't do anything for function names with one variable, and added an `\\it`:\n\n```\nsage: version()\n'Sage Version 3.4.2, Release Date: 2009-05-05'\nsage: var('a')\na\nsage: f = function('f')\nsage: latex(f(a))\nf\\left(a\\right)\n\n```\n\nAs you mention in the docstring for `latex_function_name()`, there is considerable code duplication between this function and `latex_variable_name()`. Your previous response to my question about the differences between these two functions is here:\n\nhttp://groups.google.com/group/sage-devel/msg/071207efa39c5356\n\nIt seems that your goal of returning a different response as default behavior can be achieved by passing a parameter to the `latex_varify()` calls at the end of `latex_variable_name()`. Is there a reason why the further recursions performed by `latex_variable_name()` are not relevant for function names? In any case, the string processing code in `latex_variable_name()` shouldn't be duplicated.\n\n> (7) **[New in the rebased patch]**  The rebased patch resolves\n> the issue\n> \n> https://github.com/sagemath/sage/issues/6268\n\nThis seems to be caused by a thinko on my part. It can be fixed by modifying lines 416-149 in `sage/symbolic/pynac.pyx`. You seem to do something similar at the end of `latex_symbolic_function()` and `_symbolic_function_default_latex_()` functions.\n\n\nOverall I think the patch looks very crowded and confusing. With the changes suggested above, \n* the new functions  `latex_symbolic_function()`, `_symbolic_function_default_latex_()`, `_args_latex_()`, can be eliminated.\n* derivative related functions `latex_d_derivative()` and `_derivative_latex_()` should be split to a new ticket.\n* specialized printing functions `_integrate_latex_()`, `_inverse_laplace_latex_()`, `_laplace_latex_()`, `_limit_latex_()` should be moved to `sage/calculus/calculus.py` and hooked up to the right `sage.symbolic.function.SFunction` instance.\n* `_conjugate_latex_()` doesn't seem necessary.",
    "created_at": "2009-06-14T14:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37471",
    "user": "https://github.com/burcin"
}
```

Hi Golam,

Thanks for your continued work on this. I see that your patch improves the typesetting of symbolic functions dramatically. I believe with a few improvements it would fit better in the new symbolics framework.

Here is my referee report:

Quotes from the description:
> 
> (2) Functions such as "diff", "integrate", "limit", "conjugate",
> "laplace", "inverse_laplace" are now typeset within Sage itself.
> 
> Ex:  integrate(f(x),x)  =>    \int f(x) dx

These should be handled using the custom printing facilities of `sage.symbolic.function.SFunction`. Special casing them in the new `latex_symbolic_function()` function is not scalable. This approach would also make the checks for the number of arguments as well as the calls to `_symbolic_function_default_latex_()` in each of these functions redundant.

I see that there is already a `_limit` function defined in `sage/calculus/calculus.py`. I think the best solution for the short term would be to put these printing functions there, and give them as an argument to the `SFunction` constructor.

Conjugates are already printed as:

```
sage: latex(x.conjugate())
\bar{x}
```

Why is `\overline` better?

> (6) **[New in the rebased patch]** New symbolics uses "D" 
> format for derivatives instead of old "diff" format. 
> The rebased patch typesets symbolic derivatives in old "diff" format by default as in this format typeset version looks similar to those found in text books, journals.
> 
> However see this thread for known limitations of current conversion between these two formats
>  http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2
> 
> One can switch between two typesetting format as follows
> 
> ```
> f(x) = function('f',x)
> g = diff(f(x),x)
> latex(g) 
> \frac{d f\left(x\right)}{d x}
> # Switch to D format
> sage.symbolic.pynac.typeset_d_as_diff=False
> latex(g)
> D[0]f\left(x\right)
> ```

I believe this issue needs more debate, preferably with examples of how Maple and MMA handle this problem. I will post a new message about this to sage-devel soon. For now, I suggest we split this to a different ticket.

> (1) Symbolics functions with name in Greek letters (with possible
> suffixes), are typeset nicely in LaTeX.
> 
> Ex:  psi(x)  =>  \psi(x)
>      f0(x)  =>  f_0(x)

Can't this be handled by a call to the new `latex_function_name()` from `sage.symbolic.pynac.py_latex_function_pystring()`?

> (3) Default (fall-back) typesetting for unknown functions (as
> in Maxima).
> 
> Ex:  myfn(x)   =>  {\it myfn}(x)

We have the GiNaC convention of falling back to `\mbox` at the moment. Previously, maxima didn't do anything for function names with one variable, and added an `\it`:

```
sage: version()
'Sage Version 3.4.2, Release Date: 2009-05-05'
sage: var('a')
a
sage: f = function('f')
sage: latex(f(a))
f\left(a\right)

```

As you mention in the docstring for `latex_function_name()`, there is considerable code duplication between this function and `latex_variable_name()`. Your previous response to my question about the differences between these two functions is here:

http://groups.google.com/group/sage-devel/msg/071207efa39c5356

It seems that your goal of returning a different response as default behavior can be achieved by passing a parameter to the `latex_varify()` calls at the end of `latex_variable_name()`. Is there a reason why the further recursions performed by `latex_variable_name()` are not relevant for function names? In any case, the string processing code in `latex_variable_name()` shouldn't be duplicated.

> (7) **[New in the rebased patch]**  The rebased patch resolves
> the issue
> 
> https://github.com/sagemath/sage/issues/6268

This seems to be caused by a thinko on my part. It can be fixed by modifying lines 416-149 in `sage/symbolic/pynac.pyx`. You seem to do something similar at the end of `latex_symbolic_function()` and `_symbolic_function_default_latex_()` functions.


Overall I think the patch looks very crowded and confusing. With the changes suggested above, 
* the new functions  `latex_symbolic_function()`, `_symbolic_function_default_latex_()`, `_args_latex_()`, can be eliminated.
* derivative related functions `latex_d_derivative()` and `_derivative_latex_()` should be split to a new ticket.
* specialized printing functions `_integrate_latex_()`, `_inverse_laplace_latex_()`, `_laplace_latex_()`, `_limit_latex_()` should be moved to `sage/calculus/calculus.py` and hooked up to the right `sage.symbolic.function.SFunction` instance.
* `_conjugate_latex_()` doesn't seem necessary.



---

archive/issue_comments_037472.json:
```json
{
    "body": "<a id='comment:12'></a>\nThanks Burcin for your detailed review. See below for my responses. I would be happy to\nhear you back before I start making some of the changes, you have suggested.\n\n\n\n> > (2) Functions such as \"diff\", \"integrate\", \"limit\", \"conjugate\",\n> > \"laplace\", \"inverse_laplace\" are now typeset within Sage itself.\n\n> These should be handled using the custom printing facilities of `sage.symbolic.function.SFunction`. \n\n\nI fully agree! However, does new symbolics has such framework ready for the mentioned functions?\n\n\n> I see that there is already a `_limit` function defined in `sage/calculus/calculus.py`. \n> I think the best solution for the short term would be to put these printing functions \n> there, and give them as an argument to the `SFunction` constructor.\n\nCould you please give an short example for such construction (my current understanding \nof new symbolics is limited)? \n\nWhat is your \"long-term\" solution? \n\nWhy is it better to put these functions in calculus/calculus.py \neven as a \"short term\" solution?  (I gather from William's note http://480.sagenb.org/home/pub/45/ that \n\"calculus\" direcotory is to be deleted. This conflicts with your suggestion.)\n\n\n> ```\n> sage: latex(x.conjugate())\n> \\bar{x}\n> ```\n> \n> Why is `\\overline` better?\n\n\n\"\\bar\" is ok for variable but is insufficient for symbolic functions. Please try the\nfollowings in the notebook: \n\n```\njsmath('\\\\bar{\\\\psi\\\\left(x, y\\\\right)}') \njsmath('\\\\overline{\\\\psi\\\\left(x, y\\\\right)}') \n```\nthen you will see the reason yourself.\n\n \n> > (6) **[New in the rebased patch]** New symbolics uses \"D\"  format \n\n> I believe this issue needs more debate, \n> I suggest we split this to a different ticket.\n\n\nSure, I will open a new ticket for this.\n\n\n> \n> > (1) Symbolics functions with name in Greek letters (with possible\n> > suffixes), are typeset nicely in LaTeX.\n> > \n> > Ex:  psi(x)  =>  \\psi(x)\n> >      f0(x)  =>  f_0(x)\n\n> \n> Can't this be handled by a call to the new `latex_function_name()` from `sage.symbolic.pynac.py_latex_function_pystring()`?\n\n\nProvided all other symbolic \"functions\" (\"integrate\",...) have been typeset \nsomewhere else which is not the case at present.\n\n\n> > (3) Default (fall-back) typesetting for unknown functions (as\n> > in Maxima).\n> > \n> > Ex:  myfn(x)   =>  {\\it myfn}(x)\n\n> \n> We have the GiNaC convention of falling back to `\\mbox` at the moment. \n\n\nFrankly, it is disappointing to see another inconsistent typesetting.\n \nWhy should a function named \"sin\" should be typseset as \"\\sin\" (=>\"\\rm sin\")\nwhere as another function named \"mysin\" is typeset as \"\\mbox{mysin}\"? Please compare \nthem side-by-side to see the contrast.\n\n\n> Previously, maxima didn't do anything for function names with one variable, and added an `\\it`:\n\n\nSo as in this patch!  Though, I wanted to use \"\\rm\" as {\\rm myfunc} but decided to\nstick to maxima usage.\n\n\n\n> As you mention in the docstring for `latex_function_name()`, there is \n> considerable code duplication between this function and `latex_variable_name()`. \n\n\nI agree that we should avoid duplication of code. \n\n\n> Is there a reason why the further recursions performed by `latex_variable_name()` \n> are not relevant for function names? \n\n\nIn physics, we often use functions such as \"f_{\\alpha\\beta}\". In sage, if I use\ncurrent latex_variable_name() to typeset \"f_alpha_beta\" then it would typeset \nas f_{{\\alpha}_{\\beta}} which is completely different. \n\nHowever I guees, thats my own preference and I shouldn't argue anymore on this.\nI guess #6290 will solve my problem altogether.\n\nI will remove latex_function_name() and use latex_variable_name() instead.",
    "created_at": "2009-06-15T01:30:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37472",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:12'></a>
Thanks Burcin for your detailed review. See below for my responses. I would be happy to
hear you back before I start making some of the changes, you have suggested.



> > (2) Functions such as "diff", "integrate", "limit", "conjugate",
> > "laplace", "inverse_laplace" are now typeset within Sage itself.

> These should be handled using the custom printing facilities of `sage.symbolic.function.SFunction`. 


I fully agree! However, does new symbolics has such framework ready for the mentioned functions?


> I see that there is already a `_limit` function defined in `sage/calculus/calculus.py`. 
> I think the best solution for the short term would be to put these printing functions 
> there, and give them as an argument to the `SFunction` constructor.

Could you please give an short example for such construction (my current understanding 
of new symbolics is limited)? 

What is your "long-term" solution? 

Why is it better to put these functions in calculus/calculus.py 
even as a "short term" solution?  (I gather from William's note http://480.sagenb.org/home/pub/45/ that 
"calculus" direcotory is to be deleted. This conflicts with your suggestion.)


> ```
> sage: latex(x.conjugate())
> \bar{x}
> ```
> 
> Why is `\overline` better?


"\bar" is ok for variable but is insufficient for symbolic functions. Please try the
followings in the notebook: 

```
jsmath('\\bar{\\psi\\left(x, y\\right)}') 
jsmath('\\overline{\\psi\\left(x, y\\right)}') 
```
then you will see the reason yourself.

 
> > (6) **[New in the rebased patch]** New symbolics uses "D"  format 

> I believe this issue needs more debate, 
> I suggest we split this to a different ticket.


Sure, I will open a new ticket for this.


> 
> > (1) Symbolics functions with name in Greek letters (with possible
> > suffixes), are typeset nicely in LaTeX.
> > 
> > Ex:  psi(x)  =>  \psi(x)
> >      f0(x)  =>  f_0(x)

> 
> Can't this be handled by a call to the new `latex_function_name()` from `sage.symbolic.pynac.py_latex_function_pystring()`?


Provided all other symbolic "functions" ("integrate",...) have been typeset 
somewhere else which is not the case at present.


> > (3) Default (fall-back) typesetting for unknown functions (as
> > in Maxima).
> > 
> > Ex:  myfn(x)   =>  {\it myfn}(x)

> 
> We have the GiNaC convention of falling back to `\mbox` at the moment. 


Frankly, it is disappointing to see another inconsistent typesetting.
 
Why should a function named "sin" should be typseset as "\sin" (=>"\rm sin")
where as another function named "mysin" is typeset as "\mbox{mysin}"? Please compare 
them side-by-side to see the contrast.


> Previously, maxima didn't do anything for function names with one variable, and added an `\it`:


So as in this patch!  Though, I wanted to use "\rm" as {\rm myfunc} but decided to
stick to maxima usage.



> As you mention in the docstring for `latex_function_name()`, there is 
> considerable code duplication between this function and `latex_variable_name()`. 


I agree that we should avoid duplication of code. 


> Is there a reason why the further recursions performed by `latex_variable_name()` 
> are not relevant for function names? 


In physics, we often use functions such as "f_{\alpha\beta}". In sage, if I use
current latex_variable_name() to typeset "f_alpha_beta" then it would typeset 
as f_{{\alpha}_{\beta}} which is completely different. 

However I guees, thats my own preference and I shouldn't argue anymore on this.
I guess #6290 will solve my problem altogether.

I will remove latex_function_name() and use latex_variable_name() instead.



---

archive/issue_comments_037473.json:
```json
{
    "body": "**Attachment:** [trac_5711-enhanced-symbolic-typesetting-rebased_to_4.0.2.patch.gz](https://github.com/sagemath/sage/files/ticket5711/trac_5711-enhanced-symbolic-typesetting-rebased_to_4.0.2.patch.gz)",
    "created_at": "2009-06-23T11:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37473",
    "user": "https://github.com/golam-m-hossain"
}
```

**Attachment:** [trac_5711-enhanced-symbolic-typesetting-rebased_to_4.0.2.patch.gz](https://github.com/sagemath/sage/files/ticket5711/trac_5711-enhanced-symbolic-typesetting-rebased_to_4.0.2.patch.gz)



---

archive/issue_comments_037474.json:
```json
{
    "body": "<a id='comment:13'></a>\nBurcin: I have updated the patch as you suggested. List of changes is given in the description.",
    "created_at": "2009-06-23T11:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37474",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:13'></a>
Burcin: I have updated the patch as you suggested. List of changes is given in the description.



---

archive/issue_comments_037475.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -77,3 +77,22 @@\n https://github.com/sagemath/sage/issues/6268\n \n \n+**[Update: in v3 (4.0.2) ]**\n+\n+As suggested by Burcin in his referee report, following changes are made in the patch:\n+\n+**(1)**  Typesetting of \"diff\" is moved to a new ticket #6344\n+\n+\n+**(2)**  Four helper functions  _limit_latex_(), _integrate_latex_(), _laplace_latex_() and _inverse_laplace_latex_() have been moved to calculus/calculus.py. Then they are hooked to the instances of SFunction class by using dummy functions for better integration with the new symbolics.\n+\n+\n+**(3)**  Four earlier functions latex_symbolic_function(), _symbolic_function_default_latex_(), _args_latex_(), _conjugate_latex() are removed.\n+\n+\n+**(4)**  latex_function_name() is also replaced as the updated latex_variable_name() is augmented to take a new flag \"is_fname\". This will ensure that same typesetting convention is followed for both known functions such as \\sin (:= {\\rm sin}), \\cos (:= {\\rm cos}) and user defined function names such as \"mysin\" (=> {\\rm mysin}).\n+\n+\n+\n+\n+\n``````\n",
    "created_at": "2009-06-23T11:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37475",
    "user": "https://github.com/golam-m-hossain"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -77,3 +77,22 @@
 https://github.com/sagemath/sage/issues/6268
 
 
+**[Update: in v3 (4.0.2) ]**
+
+As suggested by Burcin in his referee report, following changes are made in the patch:
+
+**(1)**  Typesetting of "diff" is moved to a new ticket #6344
+
+
+**(2)**  Four helper functions  _limit_latex_(), _integrate_latex_(), _laplace_latex_() and _inverse_laplace_latex_() have been moved to calculus/calculus.py. Then they are hooked to the instances of SFunction class by using dummy functions for better integration with the new symbolics.
+
+
+**(3)**  Four earlier functions latex_symbolic_function(), _symbolic_function_default_latex_(), _args_latex_(), _conjugate_latex() are removed.
+
+
+**(4)**  latex_function_name() is also replaced as the updated latex_variable_name() is augmented to take a new flag "is_fname". This will ensure that same typesetting convention is followed for both known functions such as \sin (:= {\rm sin}), \cos (:= {\rm cos}) and user defined function names such as "mysin" (=> {\rm mysin}).
+
+
+
+
+
``````




---

archive/issue_events_055885.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-06-23T11:59:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55885"
}
```



---

archive/issue_events_055886.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-06-23T11:59:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55886"
}
```



---

archive/issue_comments_037476.json:
```json
{
    "body": "**Attachment:** [trac_5711-doctest_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket5711/trac_5711-doctest_fixes.patch.gz)\n\ndoctest fixes",
    "created_at": "2009-06-23T13:28:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37476",
    "user": "https://github.com/burcin"
}
```

**Attachment:** [trac_5711-doctest_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket5711/trac_5711-doctest_fixes.patch.gz)

doctest fixes



---

archive/issue_comments_037477.json:
```json
{
    "body": "<a id='comment:14'></a>\nThanks Golam. The patch looks good to me. I added a small patch that fixes doctests in two places.\n\nOnly apply \n\n* trac_5711-enhanced-symbolic-typesetting-rebased_to_4.0.2.patch\n* trac_5711-doctest_fixes.patch",
    "created_at": "2009-06-23T13:35:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37477",
    "user": "https://github.com/burcin"
}
```

<a id='comment:14'></a>
Thanks Golam. The patch looks good to me. I added a small patch that fixes doctests in two places.

Only apply 

* trac_5711-enhanced-symbolic-typesetting-rebased_to_4.0.2.patch
* trac_5711-doctest_fixes.patch



---

archive/issue_events_055887.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-23T13:35:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55887"
}
```



---

archive/issue_events_055888.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-23T13:35:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55888"
}
```



---

archive/issue_comments_037478.json:
```json
{
    "body": "**Merged:** sage-4.1.alpha0",
    "created_at": "2009-06-24T09:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37478",
    "user": "https://github.com/rlmill"
}
```

**Merged:** sage-4.1.alpha0



---

archive/issue_comments_037479.json:
```json
{
    "body": "**Reviewer:** Burcin Erocal",
    "created_at": "2009-06-24T09:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37479",
    "user": "https://github.com/rlmill"
}
```

**Reviewer:** Burcin Erocal



---

archive/issue_events_055889.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-06-24T09:52:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55889"
}
```



---

archive/issue_events_055890.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-06-24T09:52:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5711#event-55890"
}
```



---

archive/issue_comments_037480.json:
```json
{
    "body": "**Author:** Golam Mortuza Hossain",
    "created_at": "2009-06-24T09:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37480",
    "user": "https://github.com/rlmill"
}
```

**Author:** Golam Mortuza Hossain



---

archive/issue_comments_037481.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [@kcrisman](#comment%3A7):\n> This is really impressive.   I assume that stan s and the others will want to review this more since they would use it more intensely and understand LaTeX better than I do, but I threw it a lot of stuff and the only \"problems\" I found were additional cases one might want, which could easily be a separate ticket after this is merged.  The integrals, limits, Laplace, derivatives work out nice now, as does the option for D.  \n> 1. Only some underscore things do subscripts, and double subscripts don't work.  That's fine, but might as well search for them if possible, e.g. HH_sigma or WWW_xy_z or something could also typeset.\n\n[Snip]\nI am very fond of the set_latex() method for defining custom latex representations, which would allow for multiple subscripts etc. Unfortunately, it has been disabled with the new symbolics. Is there a plan to re-enable it again? In general, I think that it would be nice to give as much control to the user as possible, rather than hard-coding certain latex representations. Sorry I haven't been of any help with reviewing/patching, but I only now got back to the typesetting issues and found that my previous ad-hoc latex definitions don't work in Sage 4.x any more. :(\n\nGreat work, anyway, and many thanks to those that invested time and effort into improving the typesetting in Sage!",
    "created_at": "2009-06-24T10:47:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37481",
    "user": "https://github.com/sagetrac-schymans"
}
```

<a id='comment:16'></a>
Replying to [@kcrisman](#comment%3A7):
> This is really impressive.   I assume that stan s and the others will want to review this more since they would use it more intensely and understand LaTeX better than I do, but I threw it a lot of stuff and the only "problems" I found were additional cases one might want, which could easily be a separate ticket after this is merged.  The integrals, limits, Laplace, derivatives work out nice now, as does the option for D.  
> 1. Only some underscore things do subscripts, and double subscripts don't work.  That's fine, but might as well search for them if possible, e.g. HH_sigma or WWW_xy_z or something could also typeset.

[Snip]
I am very fond of the set_latex() method for defining custom latex representations, which would allow for multiple subscripts etc. Unfortunately, it has been disabled with the new symbolics. Is there a plan to re-enable it again? In general, I think that it would be nice to give as much control to the user as possible, rather than hard-coding certain latex representations. Sorry I haven't been of any help with reviewing/patching, but I only now got back to the typesetting issues and found that my previous ad-hoc latex definitions don't work in Sage 4.x any more. :(

Great work, anyway, and many thanks to those that invested time and effort into improving the typesetting in Sage!



---

archive/issue_comments_037482.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [schymans](#comment%3A16):\n> I am very fond of the set_latex() method for defining custom latex representations, \n> which would allow for multiple subscripts etc. Unfortunately, it has been disabled \n> with the new symbolics. Is there a plan to re-enable it again? \n\nYes but in a new avatar! The new method would be more powerful. The patch is\nhere\n\nhttps://github.com/sagemath/sage/issues/6290",
    "created_at": "2009-06-24T10:56:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5711",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5711#issuecomment-37482",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:17'></a>
Replying to [schymans](#comment%3A16):
> I am very fond of the set_latex() method for defining custom latex representations, 
> which would allow for multiple subscripts etc. Unfortunately, it has been disabled 
> with the new symbolics. Is there a plan to re-enable it again? 

Yes but in a new avatar! The new method would be more powerful. The patch is
here

https://github.com/sagemath/sage/issues/6290
