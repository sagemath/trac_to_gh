# Issue 5411: QuadraticForm: implement clifford_invariant and replace hasse_conductor with clifford_conductor

archive/issues_005411.json:
```json
{
    "assignees": [],
    "body": "The `hasse_invariant` of a quadratic form doesn't match the standard invariant (brauer class) for quaternion algebras (e.g. for ternary quadratic forms, the ramification of the corresponding quaternion algebra).\n\nThe `clifford_invariant` can defined in terms of the clifford algebra of the quadratic form. See Lam (AMS GSM 67) p. 117 for the definition, and p. 119 for the formula relating it to the Hasse invariant.\n\nIt also has the property that hyperbolic spaces have `clifford_invariant == +1` at all primes.\n\nIt also makes more sense to define a `clifford_conductor` instead of a `hasse_conductor` as the product of all the primes with `clifford_invariant == -1`.\n\nAssignee: **@tornaria**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5411_\n\n",
    "closed_at": "2009-03-02T06:37:17Z",
    "created_at": "2009-03-01T15:30:07Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20quadratic%20forms",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "QuadraticForm: implement clifford_invariant and replace hasse_conductor with clifford_conductor",
    "type": "issue",
    "updated_at": "2009-03-02T06:37:17Z",
    "url": "https://github.com/sagemath/sage/issues/5411",
    "user": "https://github.com/tornaria"
}
```
The `hasse_invariant` of a quadratic form doesn't match the standard invariant (brauer class) for quaternion algebras (e.g. for ternary quadratic forms, the ramification of the corresponding quaternion algebra).

The `clifford_invariant` can defined in terms of the clifford algebra of the quadratic form. See Lam (AMS GSM 67) p. 117 for the definition, and p. 119 for the formula relating it to the Hasse invariant.

It also has the property that hyperbolic spaces have `clifford_invariant == +1` at all primes.

It also makes more sense to define a `clifford_conductor` instead of a `hasse_conductor` as the product of all the primes with `clifford_invariant == -1`.

Assignee: **@tornaria**

_Issue created by migration from https://trac.sagemath.org/ticket/5411_





---

archive/issue_events_057063.json:
```json
{
    "actor": "https://github.com/tornaria",
    "created_at": "2009-03-01T15:30:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "milestone_number": null,
    "milestone_title": "sage-3.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57063"
}
```



---

archive/issue_events_057064.json:
```json
{
    "actor": "https://github.com/tornaria",
    "created_at": "2009-03-01T15:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20quadratic%20forms",
    "label_color": "0000ff",
    "label_name": "component: quadratic forms",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57064"
}
```



---

archive/issue_events_057065.json:
```json
{
    "actor": "https://github.com/tornaria",
    "created_at": "2009-03-01T15:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57065"
}
```



---

archive/issue_events_057066.json:
```json
{
    "actor": "https://github.com/tornaria",
    "created_at": "2009-03-01T15:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57066"
}
```



---

archive/issue_events_057067.json:
```json
{
    "actor": "https://github.com/tornaria",
    "created_at": "2009-03-01T15:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57067"
}
```



---

archive/issue_comments_034805.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nAttachment: **[patch.5411.clifford_invariant.gz](https://github.com/sagemath/sage/files/ticket5411/patch.5411.clifford_invariant.gz)**",
    "created_at": "2009-03-01T15:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34805",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:1'>Comment 1:</a>
Attachment: **[patch.5411.clifford_invariant.gz](https://github.com/sagemath/sage/files/ticket5411/patch.5411.clifford_invariant.gz)**



---

archive/issue_comments_034806.json:
```json
{
    "body": "same file with correct name",
    "created_at": "2009-03-01T16:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34806",
    "user": "https://github.com/tornaria"
}
```

same file with correct name



---

archive/issue_comments_034807.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nAttachment: **[trac_5411.clifford_invariant.patch.gz](https://github.com/sagemath/sage/files/ticket5411/trac_5411.clifford_invariant.patch.gz)**",
    "created_at": "2009-03-01T16:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34807",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:2'>Comment 2:</a>
Attachment: **[trac_5411.clifford_invariant.patch.gz](https://github.com/sagemath/sage/files/ticket5411/trac_5411.clifford_invariant.patch.gz)**



---

archive/issue_comments_034808.json:
```json
{
    "body": "Changed assignee from **gonzalo** to **@tornaria**",
    "created_at": "2009-03-01T16:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34808",
    "user": "https://github.com/tornaria"
}
```

Changed assignee from **gonzalo** to **@tornaria**



---

archive/issue_events_057068.json:
```json
{
    "actor": "https://github.com/tornaria",
    "created_at": "2009-03-01T16:04:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57068"
}
```



---

archive/issue_events_057069.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-02T03:41:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57069"
}
```



---

archive/issue_comments_034809.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nPositive review.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-02T03:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34809",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:3'>Comment 3:</a>
Positive review.

Cheers,

Michael



---

archive/issue_comments_034810.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nJon expressed some further wishes, so \"needs review\" again for now :-)\n\nCheers,\n\nMichael",
    "created_at": "2009-03-02T03:50:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34810",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:4'>Comment 4:</a>
Jon expressed some further wishes, so "needs review" again for now :-)

Cheers,

Michael



---

archive/issue_events_057070.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-02T03:50:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57070"
}
```



---

archive/issue_events_057071.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-02T03:50:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57071"
}
```



---

archive/issue_comments_034811.json:
```json
{
    "body": "replaces previous patch --- this one doesn't remove hasse_conductor",
    "created_at": "2009-03-02T04:10:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34811",
    "user": "https://github.com/tornaria"
}
```

replaces previous patch --- this one doesn't remove hasse_conductor



---

archive/issue_comments_034812.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nAttachment: **[trac_5411.clifford_invariant.2nd.patch.gz](https://github.com/sagemath/sage/files/ticket5411/trac_5411.clifford_invariant.2nd.patch.gz)**\n\nThe new patch (2nd patch) preserves `hasse_conductor` as requested by Jon, and it also fixes the imports in `quadratic_form.py`, so it is meant to be applied on top of #5403.",
    "created_at": "2009-03-02T04:24:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34812",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:5'>Comment 5:</a>
Attachment: **[trac_5411.clifford_invariant.2nd.patch.gz](https://github.com/sagemath/sage/files/ticket5411/trac_5411.clifford_invariant.2nd.patch.gz)**

The new patch (2nd patch) preserves `hasse_conductor` as requested by Jon, and it also fixes the imports in `quadratic_form.py`, so it is meant to be applied on top of #5403.



---

archive/issue_comments_034813.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nLooks good.  Positive review.",
    "created_at": "2009-03-02T05:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34813",
    "user": "https://github.com/jonhanke"
}
```

<a id='comment:6'>Comment 6:</a>
Looks good.  Positive review.



---

archive/issue_events_057072.json:
```json
{
    "actor": "https://github.com/jonhanke",
    "created_at": "2009-03-02T05:13:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57072"
}
```



---

archive/issue_events_057073.json:
```json
{
    "actor": "https://github.com/jonhanke",
    "created_at": "2009-03-02T05:13:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57073"
}
```



---

archive/issue_events_057074.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-02T06:37:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57074"
}
```



---

archive/issue_events_057075.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-02T06:37:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5411#event-57075"
}
```



---

archive/issue_comments_034814.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nMerged trac_5411.clifford_invariant.2nd.patch in Sage 3.4.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-02T06:37:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5411#issuecomment-34814",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:7'>Comment 7:</a>
Merged trac_5411.clifford_invariant.2nd.patch in Sage 3.4.rc0.

Cheers,

Michael
