# Issue 5650: speed up gamma_inc

archive/issues_005650.json:
```json
{
    "body": "The following is from code for evaluating Riemann theta functions on sage.math:\n\n```\nsage: %prun siegel_theta(tau3p, 1/10*vector([1/2 + I, 2/3*I, 1.222*I]))\n         137700 function calls (136832 primitive calls) in 2.221 CPU seconds\n\n   Ordered by: internal time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n       23    1.668    0.073    1.674    0.073 {method 'gamma_inc' of 'sage.rings.complex_number.ComplexNumber' objects}\n    791/1    0.153    0.000    0.380    0.380 riemann_theta.py:313(find_integer_points)\n     1601    0.066    0.000    0.066    0.000 {method 'sin' of 'sage.rings.real_mpfr.RealNumber' objects}\n     5706    0.056    0.000    0.077    0.000 free_module.py:742(__call__)\n        1    0.029    0.029    0.137    0.137 riemann_theta.py:51(finite_sum_without_derivatives)\n     1602    0.026    0.000    0.026    0.000 {method 'exp' of 'sage.rings.real_mpfr.RealNumber' objects}\n```\n\nThe `finite_sum_without_derivatives` is the main loop, which calls sin, cos, and exp each iteration.  But the dominant part is computing an initial error approximation, which computes `gamma_inc` to very high precision a bunch of times, optimizing a parameter.  That takes longer than everything else!  Could a party interested in special functions please speed this up?\n\nKeywords: gamma_inc log performance speed\n\nReviewer: Jeroen Demeyer\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/5650\n\n",
    "closed_at": "2014-10-13T15:47:34Z",
    "created_at": "2009-03-31T17:02:35Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "speed up gamma_inc",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5650",
    "user": "https://github.com/ncalexan"
}
```
The following is from code for evaluating Riemann theta functions on sage.math:

```
sage: %prun siegel_theta(tau3p, 1/10*vector([1/2 + I, 2/3*I, 1.222*I]))
         137700 function calls (136832 primitive calls) in 2.221 CPU seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       23    1.668    0.073    1.674    0.073 {method 'gamma_inc' of 'sage.rings.complex_number.ComplexNumber' objects}
    791/1    0.153    0.000    0.380    0.380 riemann_theta.py:313(find_integer_points)
     1601    0.066    0.000    0.066    0.000 {method 'sin' of 'sage.rings.real_mpfr.RealNumber' objects}
     5706    0.056    0.000    0.077    0.000 free_module.py:742(__call__)
        1    0.029    0.029    0.137    0.137 riemann_theta.py:51(finite_sum_without_derivatives)
     1602    0.026    0.000    0.026    0.000 {method 'exp' of 'sage.rings.real_mpfr.RealNumber' objects}
```

The `finite_sum_without_derivatives` is the main loop, which calls sin, cos, and exp each iteration.  But the dominant part is computing an initial error approximation, which computes `gamma_inc` to very high precision a bunch of times, optimizing a parameter.  That takes longer than everything else!  Could a party interested in special functions please speed this up?

Keywords: gamma_inc log performance speed

Reviewer: Jeroen Demeyer

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/5650





---

archive/issue_comments_044033.json:
```json
{
    "body": "<a id='comment:1'></a>How high precision and for what values of the arguments is this?",
    "created_at": "2009-04-02T08:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5650#issuecomment-44033",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:1'></a>How high precision and for what values of the arguments is this?



---

archive/issue_comments_044034.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2012-06-01T18:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5650#issuecomment-44034",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_044035.json:
```json
{
    "body": "<a id='comment:2'></a>> How high precision and for what values of the arguments is this?\n\n\nYeah, this is really vague, and the code involved is custom and not in Sage at this time.  It would be helpful to know if #7748, which changed the approximation to mpmath, helped here.  Until such time as we get more details, 'needs info'.",
    "created_at": "2012-06-01T18:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5650#issuecomment-44035",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>> How high precision and for what values of the arguments is this?


Yeah, this is really vague, and the code involved is custom and not in Sage at this time.  It would be helpful to know if #7748, which changed the approximation to mpmath, helped here.  Until such time as we get more details, 'needs info'.



---

archive/issue_comments_044036.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2014-10-11T19:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5650#issuecomment-44036",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_events_013282.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-11T19:29:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5650#event-13282"
}
```



---

archive/issue_comments_044037.json:
```json
{
    "body": "<a id='comment:3'></a>No answer, close as \"invalid\".",
    "created_at": "2014-10-11T19:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5650#issuecomment-44037",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>No answer, close as "invalid".



---

archive/issue_events_013283.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-13T15:47:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5650#event-13283"
}
```



---

archive/issue_comments_044038.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2014-10-13T15:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5650#issuecomment-44038",
    "user": "https://github.com/vbraun"
}
```

Resolution: invalid
