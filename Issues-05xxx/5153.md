# Issue 5153: bug in simon_two_descent  for elliptic curves

archive/issues_005153.json:
```json
{
    "assignees": [],
    "body": "[See #15608 for a list of open simon_two_descent tickets]\n\nWe have\n\n```\nsage: E = EllipticCurve('65a1')\nsage: G = E.change_ring(QuadraticField(-56,'a'))\nsage: G.simon_two_descent()\n(3, 4, [(-9/4 : -3/8*a + 9/8 : 1), (-8/7 : -1/49*a + 4/7 : 1), (1 : 0 : 1), \n  (-6/25*a - 47/25 : 36/125*a - 368/125 : 1), (1/4 : 1/16*a - 1/8 : 1)])\n```\n\nThe documentation for simon_two_descent says that the output of Simon 2-descent is\n\n```\n        OUTPUT:\n            integer -- \"probably\" the rank of self\n            integer -- the 2-rank of the Selmer group\n            list    -- list of independent points on the curve.\n```\n\nOur curve does have rank 3, but the output list above contains *five* points, so they can't be independent!   \n\nOur curve has torsion of order 2, so E(K)/2 E(K) has rank four, so the 3 and four output by Simon descent are right.  The only problem is the list, which has too many points in it. \n\nMaybe this is simply a documentation issue, and the docs for simon_two_descent should be changed to say that list is a list of points that *generate* a subgroup of the MW group of rank r, where r is the first number output by simon_two_descent. \n\nDepends on #13593\n\nKeywords: **simon_two_descent**\n\nBranch/Commit: **[u/wuthrich/ticket/5153](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/5153) @ [`ad2ced2`](https://github.com/sagemath/sagetrac-mirror/commit/ad2ced2b14236b9881121c47eb6ee0f20144d5dd)**\n\nReviewer: **John Cremona**\n\nAuthor: **Chris Wuthrich**\n\nComponent: **elliptic curves**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5153_\n\n",
    "closed_at": "2014-01-05T02:56:51Z",
    "created_at": "2009-02-01T22:24:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "bug in simon_two_descent  for elliptic curves",
    "type": "issue",
    "updated_at": "2014-01-05T02:56:51Z",
    "url": "https://github.com/sagemath/sage/issues/5153",
    "user": "https://github.com/williamstein"
}
```
[See #15608 for a list of open simon_two_descent tickets]

We have

```
sage: E = EllipticCurve('65a1')
sage: G = E.change_ring(QuadraticField(-56,'a'))
sage: G.simon_two_descent()
(3, 4, [(-9/4 : -3/8*a + 9/8 : 1), (-8/7 : -1/49*a + 4/7 : 1), (1 : 0 : 1), 
  (-6/25*a - 47/25 : 36/125*a - 368/125 : 1), (1/4 : 1/16*a - 1/8 : 1)])
```

The documentation for simon_two_descent says that the output of Simon 2-descent is

```
        OUTPUT:
            integer -- "probably" the rank of self
            integer -- the 2-rank of the Selmer group
            list    -- list of independent points on the curve.
```

Our curve does have rank 3, but the output list above contains *five* points, so they can't be independent!   

Our curve has torsion of order 2, so E(K)/2 E(K) has rank four, so the 3 and four output by Simon descent are right.  The only problem is the list, which has too many points in it. 

Maybe this is simply a documentation issue, and the docs for simon_two_descent should be changed to say that list is a list of points that *generate* a subgroup of the MW group of rank r, where r is the first number output by simon_two_descent. 

Depends on #13593

Keywords: **simon_two_descent**

Branch/Commit: **[u/wuthrich/ticket/5153](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/5153) @ [`ad2ced2`](https://github.com/sagemath/sagetrac-mirror/commit/ad2ced2b14236b9881121c47eb6ee0f20144d5dd)**

Reviewer: **John Cremona**

Author: **Chris Wuthrich**

Component: **elliptic curves**

_Issue created by migration from https://trac.sagemath.org/ticket/5153_





---

archive/issue_events_060127.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-02-01T22:24:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60127"
}
```



---

archive/issue_events_060128.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-02-01T22:24:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60128"
}
```



---

archive/issue_events_060129.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-02-01T22:24:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60129"
}
```



---

archive/issue_events_060130.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-02-01T22:24:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60130"
}
```



---

archive/issue_events_060131.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-02-01T22:24:47Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "subject": "https://github.com/williamstein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60131"
}
```



---

archive/issue_comments_031498.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI will email Denis Simon about this, since he has just done another bug fix in ell.gp after I reported a bug to him.  Unfortunately the fix he sent works in the latest pari but not with the one Sage uses.",
    "created_at": "2009-06-09T11:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31498",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:1" align="right">comment:1</div>

I will email Denis Simon about this, since he has just done another bug fix in ell.gp after I reported a bug to him.  Unfortunately the fix he sent works in the latest pari but not with the one Sage uses.



---

archive/issue_comments_031499.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nLooking at the example in more detail, I see that the points returned do generate a rank 3 group (though I had to use Magma to check the independence), so there are two problems: (1) the points in the list are not independent (even in E(K)/2E(K)) and (2) the numbers 3,4 which are supposed to be lower and upper bounds on the rank are wrong and should be 3,3.\n\nI know how the first happens (since it is doing a descent via 2-isogeny).\n\nThis will be possible to fix once I (or someone) have eventually implemented heights of points over number fields, as I promised to do  in trac #360 !",
    "created_at": "2009-06-09T12:46:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31499",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:2" align="right">comment:2</div>

Looking at the example in more detail, I see that the points returned do generate a rank 3 group (though I had to use Magma to check the independence), so there are two problems: (1) the points in the list are not independent (even in E(K)/2E(K)) and (2) the numbers 3,4 which are supposed to be lower and upper bounds on the rank are wrong and should be 3,3.

I know how the first happens (since it is doing a descent via 2-isogeny).

This will be possible to fix once I (or someone) have eventually implemented heights of points over number fields, as I promised to do  in trac #360 !



---

archive/issue_events_060132.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-07-20T19:59:58Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "subject": "https://github.com/loefflerd",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60132"
}
```



---

archive/issue_events_060133.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-07-20T19:59:58Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "subject": "https://github.com/loefflerd",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60133"
}
```



---

archive/issue_events_060134.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-07-20T19:59:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60134"
}
```



---

archive/issue_events_060135.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-07-20T19:59:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60135"
}
```



---

archive/issue_events_060136.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-10-09T09:09:07Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "subject": "https://github.com/loefflerd",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60136"
}
```



---

archive/issue_comments_031500.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@JohnCremona](#comment:2):\n> This will be possible to fix once I (or someone) have eventually implemented heights of points over number fields, as I promised to do  in trac #360 !\n\nI am not sure that using heights is the best way to get independence if you are doing a 2-descent anyway. The easier thing to do would be to just report back a set of points that minimally generate the 2-selmer group (or at least minimally generate the part of the 2-selmer group generated by the found points)\nThe only thing you'd miss that way would be if one finds generators for an even index 2 subgroup of the full Mordell-Weil group. I think it's highly unlikely that that would happen.",
    "created_at": "2010-01-17T01:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31500",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@JohnCremona](#comment:2):
> This will be possible to fix once I (or someone) have eventually implemented heights of points over number fields, as I promised to do  in trac #360 !

I am not sure that using heights is the best way to get independence if you are doing a 2-descent anyway. The easier thing to do would be to just report back a set of points that minimally generate the 2-selmer group (or at least minimally generate the part of the 2-selmer group generated by the found points)
The only thing you'd miss that way would be if one finds generators for an even index 2 subgroup of the full Mordell-Weil group. I think it's highly unlikely that that would happen.



---

archive/issue_comments_031501.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n> I am not sure that using heights is the best way to get independence\n\nAnother excellent trick I learned from Cremona for getting independence is to use *homomorphic images*.  I.e., reduce to a direct sum of groups of points over a finite field (all tensored with F_p, with p coprime to torsion).  Then the rank of the group you have is a bounded below by the dimension of the image.",
    "created_at": "2010-01-17T05:32:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31501",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:6" align="right">comment:6</div>

> I am not sure that using heights is the best way to get independence

Another excellent trick I learned from Cremona for getting independence is to use *homomorphic images*.  I.e., reduce to a direct sum of groups of points over a finite field (all tensored with F_p, with p coprime to torsion).  Then the rank of the group you have is a bounded below by the dimension of the image.



---

archive/issue_comments_031502.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nGood point -- the reference is On the computation of Mordell-Weil and 2-Selmer Groups of Elliptic Curves. Rocky Mountain Journal of Mathematics (2002) vol. 32, no. 3, pp.953--967.   This is implemeneted over Q in eclib, and it would be possible to do an implementation over number fields.  As Mestre points out, this method for testing independence has the great advantage that it does not depend on precision of height computations, only on linear algebra over F_2.",
    "created_at": "2010-01-17T11:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31502",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

Good point -- the reference is On the computation of Mordell-Weil and 2-Selmer Groups of Elliptic Curves. Rocky Mountain Journal of Mathematics (2002) vol. 32, no. 3, pp.953--967.   This is implemeneted over Q in eclib, and it would be possible to do an implementation over number fields.  As Mestre points out, this method for testing independence has the great advantage that it does not depend on precision of height computations, only on linear algebra over F_2.



---

archive/issue_comments_031503.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@williamstein](#comment:6):\n> Another excellent trick I learned from Cremona for getting independence is to use *homomorphic images*.  I.e., reduce to a direct sum of groups of points over a finite field (all tensored with F_p, with p coprime to torsion).  Then the rank of the group you have is a bounded below by the dimension of the image. \n\nAnd those same images can also yield information on p-saturation of the group generated by the given points inside the Mordell-Weil group\n(just as an independence proof via 2-Selmer groups also gives 2-saturation)\nThis starts to sound like a nice student project.",
    "created_at": "2010-01-24T03:19:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31503",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@williamstein](#comment:6):
> Another excellent trick I learned from Cremona for getting independence is to use *homomorphic images*.  I.e., reduce to a direct sum of groups of points over a finite field (all tensored with F_p, with p coprime to torsion).  Then the rank of the group you have is a bounded below by the dimension of the image. 

And those same images can also yield information on p-saturation of the group generated by the given points inside the Mordell-Weil group
(just as an independence proof via 2-Selmer groups also gives 2-saturation)
This starts to sound like a nice student project.



---

archive/issue_comments_031504.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@nbruin](#comment:8):\n> Replying to [@williamstein](#comment:6):\n> > Another excellent trick I learned from Cremona for getting independence is to use *homomorphic images*.  I.e., reduce to a direct sum of groups of points over a finite field (all tensored with F_p, with p coprime to torsion).  Then the rank of the group you have is a bounded below by the dimension of the image. \n\n> \n> And those same images can also yield information on p-saturation of the group generated by the given points inside the Mordell-Weil group\n> (just as an independence proof via 2-Selmer groups also gives 2-saturation)\n> This starts to sound like a nice student project.\n\nIt was!  The thesis of my student Martin Prickett was about saturating Mordell-Weil groups this way, and he implemented it in Magma.  See http://www.warwick.ac.uk/staff/J.E.Cremona/theses/index.html .  I have Martin's magma code but it is not easy to use.  Hence the project still remains, namely to rewrite all that.",
    "created_at": "2010-01-24T12:46:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31504",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@nbruin](#comment:8):
> Replying to [@williamstein](#comment:6):
> > Another excellent trick I learned from Cremona for getting independence is to use *homomorphic images*.  I.e., reduce to a direct sum of groups of points over a finite field (all tensored with F_p, with p coprime to torsion).  Then the rank of the group you have is a bounded below by the dimension of the image. 

> 
> And those same images can also yield information on p-saturation of the group generated by the given points inside the Mordell-Weil group
> (just as an independence proof via 2-Selmer groups also gives 2-saturation)
> This starts to sound like a nice student project.

It was!  The thesis of my student Martin Prickett was about saturating Mordell-Weil groups this way, and he implemented it in Magma.  See http://www.warwick.ac.uk/staff/J.E.Cremona/theses/index.html .  I have Martin's magma code but it is not easy to use.  Hence the project still remains, namely to rewrite all that.



---

archive/issue_comments_031505.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n> the numbers 3,4 which are supposed to be lower and upper bounds on the rank are wrong and\n> should be 3,3.\n\nThe numbers 3,4, are correct. G has a point of order 2 over its base feild, so the 2-rank of the 2-Selmer group is 4. However, an error like the one you're describing does occur with 438e1 over Q.",
    "created_at": "2010-03-28T03:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31505",
    "user": "https://github.com/sagetrac-weigandt"
}
```

<div id="comment:10" align="right">comment:10</div>

> the numbers 3,4 which are supposed to be lower and upper bounds on the rank are wrong and
> should be 3,3.

The numbers 3,4, are correct. G has a point of order 2 over its base feild, so the 2-rank of the 2-Selmer group is 4. However, an error like the one you're describing does occur with 438e1 over Q.



---

archive/issue_comments_031506.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@sagetrac-weigandt](#comment:10):\n> > the numbers 3,4 which are supposed to be lower and upper bounds on the rank are wrong and\n> > should be 3,3.\n\n> \n> The numbers 3,4, are correct. G has a point of order 2 over its base feild, so the 2-rank of the 2-Selmer group is 4. However, an error like the one you're describing does occur with 438e1 over Q.\n\nDo you mean 438e1 over Q?    #torsion=2 and rank=0 but the first descent via 2-isogeny gives a rank upper bound of 2.  If the rank were 2 then the 2-selmer rank would be 3.  two_descent_simon() gives lower bound of 0 and 3 for the rank of the 2-Selmer group.  That last one is clearly wrong.  I think it is similar to the problem my 2-descent used to have:  Simon does not do a second descent, so het gets the uppoer bound of 3 on the rank (not wrong!) but incorrectly calls it the 2-Selmer rank.\n\nWe should correct the docstring of two_descent_simon, and I will tell Simon that his documentation is incorrect.",
    "created_at": "2010-03-31T12:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31506",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@sagetrac-weigandt](#comment:10):
> > the numbers 3,4 which are supposed to be lower and upper bounds on the rank are wrong and
> > should be 3,3.

> 
> The numbers 3,4, are correct. G has a point of order 2 over its base feild, so the 2-rank of the 2-Selmer group is 4. However, an error like the one you're describing does occur with 438e1 over Q.

Do you mean 438e1 over Q?    #torsion=2 and rank=0 but the first descent via 2-isogeny gives a rank upper bound of 2.  If the rank were 2 then the 2-selmer rank would be 3.  two_descent_simon() gives lower bound of 0 and 3 for the rank of the 2-Selmer group.  That last one is clearly wrong.  I think it is similar to the problem my 2-descent used to have:  Simon does not do a second descent, so het gets the uppoer bound of 3 on the rank (not wrong!) but incorrectly calls it the 2-Selmer rank.

We should correct the docstring of two_descent_simon, and I will tell Simon that his documentation is incorrect.



---

archive/issue_comments_031507.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSee #6955 for the updating of Simon's scripts, which I am now testing.",
    "created_at": "2010-04-03T16:10:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31507",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:12" align="right">comment:12</div>

See #6955 for the updating of Simon's scripts, which I am now testing.



---

archive/issue_comments_031508.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nUpdate 15/7/10:  I did tell Simon that his script's documentation is misleading, and he agreed.  But last time I checked he had not changed them.",
    "created_at": "2010-07-15T08:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31508",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:13" align="right">comment:13</div>

Update 15/7/10:  I did tell Simon that his script's documentation is misleading, and he agreed.  But last time I checked he had not changed them.



---

archive/issue_events_060137.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60137"
}
```



---

archive/issue_events_060138.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60138"
}
```



---

archive/issue_comments_031509.json:
```json
{
    "body": "Changed keywords from none to **simon_two_descent**",
    "created_at": "2013-09-21T12:27:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31509",
    "user": "https://github.com/fchapoton"
}
```

Changed keywords from none to **simon_two_descent**



---

archive/issue_comments_031510.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe actual issue reported to fix here, seemed first to me just a question of rewording the documentation. But then I realised that there is a bug, quite hidden, but unpleasant, linked to ticket #11372.\n\nSo we want simon_two_descent (over the rationals of number fields) to return three things\n\n* A proven lower bound for the rank\n* The rank of the 2-Selmer group (this is an upper bound but not sharp in general)\n* A list of points.\n\nI propose that the list of points is a list of points of infinite order. So I filter out the ones that are of order 2 in the list that the script returns. However they are not lin. indep. This was already done over number fields in #13593. So here I modify the function over rationals.\n\nOver Q, this function then also saturates these points and, if there are sufficiently many, sets them for `E.gens()`.\n\nThat is what my proposed changes in the forthcoming commit will do. \n\nNow, there are related issues, but they don't belong to this ticket really. The curve 438e1 gives the wrong 2-Selmer and that is #10735. The fact that we don't saturate over number field should not belong to this ticket. One should open a new one for this. Also the script is outdated (see #11005) and has plenty of other issues (#11041).\n\nThe bug introduced by #11372: In the example in the documentation, the only point found is of order 2, while the second descent concludes that the rank is 1. The result shown in the documentation were in fact from mwrank not from simon_two_descent.",
    "created_at": "2013-12-28T16:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31510",
    "user": "https://github.com/categorie"
}
```

<div id="comment:16" align="right">comment:16</div>

The actual issue reported to fix here, seemed first to me just a question of rewording the documentation. But then I realised that there is a bug, quite hidden, but unpleasant, linked to ticket #11372.

So we want simon_two_descent (over the rationals of number fields) to return three things

* A proven lower bound for the rank
* The rank of the 2-Selmer group (this is an upper bound but not sharp in general)
* A list of points.

I propose that the list of points is a list of points of infinite order. So I filter out the ones that are of order 2 in the list that the script returns. However they are not lin. indep. This was already done over number fields in #13593. So here I modify the function over rationals.

Over Q, this function then also saturates these points and, if there are sufficiently many, sets them for `E.gens()`.

That is what my proposed changes in the forthcoming commit will do. 

Now, there are related issues, but they don't belong to this ticket really. The curve 438e1 gives the wrong 2-Selmer and that is #10735. The fact that we don't saturate over number field should not belong to this ticket. One should open a new one for this. Also the script is outdated (see #11005) and has plenty of other issues (#11041).

The bug introduced by #11372: In the example in the documentation, the only point found is of order 2, while the second descent concludes that the rank is 1. The result shown in the documentation were in fact from mwrank not from simon_two_descent.



---

archive/issue_comments_031511.json:
```json
{
    "body": "Author: **Chris Wuthrich**",
    "created_at": "2013-12-28T16:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31511",
    "user": "https://github.com/categorie"
}
```

Author: **Chris Wuthrich**



---

archive/issue_comments_031512.json:
```json
{
    "body": "Dependencies: **#13593**",
    "created_at": "2013-12-28T16:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31512",
    "user": "https://github.com/categorie"
}
```

Dependencies: **#13593**



---

archive/issue_comments_031513.json:
```json
{
    "body": "Branch: **[u/wuthrich/ticket/5153](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/5153)**",
    "created_at": "2013-12-28T16:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31513",
    "user": "https://github.com/categorie"
}
```

Branch: **[u/wuthrich/ticket/5153](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/5153)**



---

archive/issue_comments_031514.json:
```json
{
    "body": "Commit: **[`c24c2b3`](https://github.com/sagemath/sagetrac-mirror/commit/c24c2b3b74260feb1d32c3ee2eaf0d7c2590ab57)**",
    "created_at": "2013-12-28T16:40:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31514",
    "user": "https://github.com/categorie"
}
```

Commit: **[`c24c2b3`](https://github.com/sagemath/sagetrac-mirror/commit/c24c2b3b74260feb1d32c3ee2eaf0d7c2590ab57)**



---

archive/issue_comments_031515.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c24c2b3\"><code>c24c2b3</code></a></td><td><code>Trac 5153: Furhter modifications to the documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dc87b8\"><code>5dc87b8</code></a></td><td><code>Merge branch 'u/wuthrich/ticket/13593' of git://trac.sagemath.org/sage into ticket/5153</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5e42b8\"><code>e5e42b8</code></a></td><td><code>Trac 5153: Filter out the 2-torsion from the points returned by Simon's 2-descent.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1550dc\"><code>b1550dc</code></a></td><td><code>Trac 13593: Do not put torsion points into gens.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a069c7\"><code>9a069c7</code></a></td><td><code>Trac #13593: ranks of elliptic curves over number fields</code></td></tr></table>\n",
    "created_at": "2013-12-28T16:40:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31515",
    "user": "https://github.com/categorie"
}
```

<div id="comment:18"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c24c2b3"><code>c24c2b3</code></a></td><td><code>Trac 5153: Furhter modifications to the documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dc87b8"><code>5dc87b8</code></a></td><td><code>Merge branch 'u/wuthrich/ticket/13593' of git://trac.sagemath.org/sage into ticket/5153</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5e42b8"><code>e5e42b8</code></a></td><td><code>Trac 5153: Filter out the 2-torsion from the points returned by Simon's 2-descent.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1550dc"><code>b1550dc</code></a></td><td><code>Trac 13593: Do not put torsion points into gens.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a069c7"><code>9a069c7</code></a></td><td><code>Trac #13593: ranks of elliptic curves over number fields</code></td></tr></table>




---

archive/issue_events_060139.json:
```json
{
    "actor": "https://github.com/categorie",
    "created_at": "2013-12-28T16:40:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60139"
}
```



---

archive/issue_comments_031516.json:
```json
{
    "body": "Changed commit from **[`c24c2b3`](https://github.com/sagemath/sagetrac-mirror/commit/c24c2b3b74260feb1d32c3ee2eaf0d7c2590ab57)** to **[`c3c480d`](https://github.com/sagemath/sagetrac-mirror/commit/c3c480d23c265ddb93f8f58ab79233dcfe8ea0fa)**",
    "created_at": "2013-12-28T17:56:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31516",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c24c2b3`](https://github.com/sagemath/sagetrac-mirror/commit/c24c2b3b74260feb1d32c3ee2eaf0d7c2590ab57)** to **[`c3c480d`](https://github.com/sagemath/sagetrac-mirror/commit/c3c480d23c265ddb93f8f58ab79233dcfe8ea0fa)**



---

archive/issue_comments_031517.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3c480d\"><code>c3c480d</code></a></td><td><code>Merge branch 'u/wuthrich/ticket/13593' of git://trac.sagemath.org/sage into ticket/5153</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf7617d\"><code>bf7617d</code></a></td><td><code>spelling error</code></td></tr></table>\n",
    "created_at": "2013-12-28T17:56:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31517",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3c480d"><code>c3c480d</code></a></td><td><code>Merge branch 'u/wuthrich/ticket/13593' of git://trac.sagemath.org/sage into ticket/5153</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf7617d"><code>bf7617d</code></a></td><td><code>spelling error</code></td></tr></table>




---

archive/issue_comments_031518.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+[See #15608 for a list of open simon_two_descent tickets]\n+\n We have\n \n ```\n``````\n",
    "created_at": "2013-12-30T16:03:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31518",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+[See #15608 for a list of open simon_two_descent tickets]
+
 We have
 
 ```
``````




---

archive/issue_comments_031519.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI am worried by the documentation sentence\n\n```\nTo obtain a list of generators, use E.gens() after this.\n```\nsince the only situation in which `E.gens()` with return points found by this function are when the lower and upper rank bounds agree *and* the list of points returned has that number of points in it.  Otherwise, gens are not cached and a call to E.gens() will use `mwrank`.  So it is a bit misleading?",
    "created_at": "2013-12-30T17:09:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31519",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:21" align="right">comment:21</div>

I am worried by the documentation sentence

```
To obtain a list of generators, use E.gens() after this.
```
since the only situation in which `E.gens()` with return points found by this function are when the lower and upper rank bounds agree *and* the list of points returned has that number of points in it.  Otherwise, gens are not cached and a call to E.gens() will use `mwrank`.  So it is a bit misleading?



---

archive/issue_comments_031520.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI meant this as an advice to the standard user that does not care how this is done, but wants the generators. \nMaybe the \"after this\" is confusing. Or we could add more about what happens at the back, but ?? would tell them that too.",
    "created_at": "2013-12-30T17:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31520",
    "user": "https://github.com/categorie"
}
```

<div id="comment:22" align="right">comment:22</div>

I meant this as an advice to the standard user that does not care how this is done, but wants the generators. 
Maybe the "after this" is confusing. Or we could add more about what happens at the back, but ?? would tell them that too.



---

archive/issue_comments_031521.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI suggest just deleting \"after this\".  We can revisit this once we have put in independence-checking over number fields (which is separate from and rather easier than saturating).  If you do that, I'll give it a positive review!",
    "created_at": "2013-12-30T17:28:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31521",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:23" align="right">comment:23</div>

I suggest just deleting "after this".  We can revisit this once we have put in independence-checking over number fields (which is separate from and rather easier than saturating).  If you do that, I'll give it a positive review!



---

archive/issue_comments_031522.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad2ced2\"><code>ad2ced2</code></a></td><td><code>Trac #5153: small change in documentation.</code></td></tr></table>\n",
    "created_at": "2013-12-30T19:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31522",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad2ced2"><code>ad2ced2</code></a></td><td><code>Trac #5153: small change in documentation.</code></td></tr></table>




---

archive/issue_comments_031523.json:
```json
{
    "body": "Changed commit from **[`c3c480d`](https://github.com/sagemath/sagetrac-mirror/commit/c3c480d23c265ddb93f8f58ab79233dcfe8ea0fa)** to **[`ad2ced2`](https://github.com/sagemath/sagetrac-mirror/commit/ad2ced2b14236b9881121c47eb6ee0f20144d5dd)**",
    "created_at": "2013-12-30T19:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31523",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c3c480d`](https://github.com/sagemath/sagetrac-mirror/commit/c3c480d23c265ddb93f8f58ab79233dcfe8ea0fa)** to **[`ad2ced2`](https://github.com/sagemath/sagetrac-mirror/commit/ad2ced2b14236b9881121c47eb6ee0f20144d5dd)**



---

archive/issue_comments_031524.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nDone.",
    "created_at": "2013-12-30T19:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31524",
    "user": "https://github.com/categorie"
}
```

<div id="comment:25" align="right">comment:25</div>

Done.



---

archive/issue_comments_031525.json:
```json
{
    "body": "Reviewer: **John Cremona**",
    "created_at": "2013-12-30T19:58:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5153#issuecomment-31525",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona**



---

archive/issue_events_060140.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2013-12-30T19:58:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60140"
}
```



---

archive/issue_events_060141.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2013-12-30T19:58:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60141"
}
```



---

archive/issue_events_060142.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-01-05T02:56:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60142"
}
```



---

archive/issue_events_060143.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "dd7165982651bbabef16157391bd00ae90260623",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-01-05T02:56:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5153",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5153#event-60143"
}
```
