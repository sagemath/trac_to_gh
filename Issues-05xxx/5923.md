# Issue 5923: [with patch, with positive review] Handling of magma and pari input in ModularForms

archive/issues_005923.json:
```json
{
    "body": "The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:\n\n```\nsage: ModularForms(gp(1),12)\n---------------------------------------------------------------------------\nTypeError     \n\n[much snipped error message]\n\nTypeError: Error executing code in GP/PARI:\nCODE:\n        sage[4]=level(sage[3]);\nGP/PARI ERROR:\n  ***   expected character: ',' instead of: sage[4]=level(sage[3]);\n                                                              ^-----\n```\n\nI realize that this is because the first element is supposed to be a group, although a (Sage) integer is allowed.\n\nWould there be any support for having an if statement in the function to catch magma or pari elements and transform them into their Sage equivalents?\n\nAssignee: @loefflerd\n\nResolution: fixed\n\nAuthor: David Loeffler\n\nReviewer: Craig Citro\n\nMerged: 4.0.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/5923\n\n",
    "closed_at": "2009-05-11T09:53:35Z",
    "created_at": "2009-04-28T22:41:04Z",
    "labels": [
        "component: modular forms",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.0",
    "title": "[with patch, with positive review] Handling of magma and pari input in ModularForms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5923",
    "user": "https://trac.sagemath.org/admin/accounts/users/ljpk"
}
```
The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:

```
sage: ModularForms(gp(1),12)
---------------------------------------------------------------------------
TypeError     

[much snipped error message]

TypeError: Error executing code in GP/PARI:
CODE:
        sage[4]=level(sage[3]);
GP/PARI ERROR:
  ***   expected character: ',' instead of: sage[4]=level(sage[3]);
                                                              ^-----
```

I realize that this is because the first element is supposed to be a group, although a (Sage) integer is allowed.

Would there be any support for having an if statement in the function to catch magma or pari elements and transform them into their Sage equivalents?

Assignee: @loefflerd

Resolution: fixed

Author: David Loeffler

Reviewer: Craig Citro

Merged: 4.0.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/5923





---

archive/issue_comments_051539.json:
```json
{
    "body": "Changing assignee from @craigcitro to @loefflerd.",
    "created_at": "2009-05-01T08:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51539",
    "user": "https://github.com/loefflerd"
}
```

Changing assignee from @craigcitro to @loefflerd.



---

archive/issue_comments_051540.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2009-05-01T08:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51540",
    "user": "https://github.com/loefflerd"
}
```

Changing status from new to assigned.



---

archive/issue_comments_051541.json:
```json
{
    "body": "<a id='comment:1'></a>Certainly this is a bug, but a very easy one to fix; I'll fix it lat",
    "created_at": "2009-05-01T08:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51541",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:1'></a>Certainly this is a bug, but a very easy one to fix; I'll fix it lat



---

archive/issue_comments_051542.json:
```json
{
    "body": "<a id='comment:2'></a>.. er. \n\nIt turns out that the problem is that if x is a gp object, then \"x.level\" always *exists*: it is a microscopic function wrapper which on being called, executes \"level(x)\" in gp. Which of course doesn't work. Anyway, I've fixed it by rearranging the ModularForms constructor function a bit, and added a doctest to check that it's fixed.",
    "created_at": "2009-05-01T11:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51542",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:2'></a>.. er. 

It turns out that the problem is that if x is a gp object, then "x.level" always *exists*: it is a microscopic function wrapper which on being called, executes "level(x)" in gp. Which of course doesn't work. Anyway, I've fixed it by rearranging the ModularForms constructor function a bit, and added a doctest to check that it's fixed.



---

archive/issue_comments_051543.json:
```json
{
    "body": "patch against 3.4.2.rc0",
    "created_at": "2009-05-01T11:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51543",
    "user": "https://github.com/loefflerd"
}
```

patch against 3.4.2.rc0



---

archive/issue_comments_051544.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The ModularForms command has some slightly counter-intuitive behaviour on some types of input:\n+The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:\n \n ```\n sage: ModularForms(gp(1),12)\n@@ -19,8 +19,6 @@\n \n Would there be any support for having an if statement in the function to catch magma or pari elements and transform them into their Sage equivalents?\n \n-Assignee: @craigcitro\n-\n Comment: 1\n \n Summary: Handling of magma and pari input in ModularForms\n``````\n",
    "created_at": "2009-05-07T08:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51544",
    "user": "https://github.com/craigcitro"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The ModularForms command has some slightly counter-intuitive behaviour on some types of input:
+The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:
 
 ```
 sage: ModularForms(gp(1),12)
@@ -19,8 +19,6 @@
 
 Would there be any support for having an if statement in the function to catch magma or pari elements and transform them into their Sage equivalents?
 
-Assignee: @craigcitro
-
 Comment: 1
 
 Summary: Handling of magma and pari input in ModularForms
``````




---

archive/issue_comments_051545.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [trac_5923.patch](tarball://root/attachments/some-uuid/ticket5923/trac_5923.patch) by @craigcitro created at 2009-05-07 08:45:22",
    "created_at": "2009-05-07T08:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51545",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:3'></a>Attachment [trac_5923.patch](tarball://root/attachments/some-uuid/ticket5923/trac_5923.patch) by @craigcitro created at 2009-05-07 08:45:22



---

archive/issue_comments_051546.json:
```json
{
    "body": "<a id='comment:4'></a>Attachment [trac_5923_pt2.patch](tarball://root/attachments/some-uuid/ticket5923/trac_5923_pt2.patch) by @craigcitro created at 2009-05-07 09:11:32\n\nLooks good -- I added one small patch that just slightly moved things around. (Mostly just removed cases where tests would end up getting run several times, even though this code isn't anywhere near performance-critical.)",
    "created_at": "2009-05-07T09:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51546",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:4'></a>Attachment [trac_5923_pt2.patch](tarball://root/attachments/some-uuid/ticket5923/trac_5923_pt2.patch) by @craigcitro created at 2009-05-07 09:11:32

Looks good -- I added one small patch that just slightly moved things around. (Mostly just removed cases where tests would end up getting run several times, even though this code isn't anywhere near performance-critical.)



---

archive/issue_comments_051547.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-05-11T09:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51547",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_013887.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-11T09:53:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5923#event-13887"
}
```



---

archive/issue_comments_051548.json:
```json
{
    "body": "<a id='comment:5'></a>Merged both patches in Sage 4.0.alpha0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-11T09:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51548",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>Merged both patches in Sage 4.0.alpha0.

Cheers,

Michael



---

archive/issue_comments_051549.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Craig Citro\"",
    "created_at": "2009-06-07T09:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51549",
    "user": "https://github.com/loefflerd"
}
```

Changing reviewer from "" to "Craig Citro"



---

archive/issue_comments_051550.json:
```json
{
    "body": "Changing author from \"\" to \"David Loeffler\"",
    "created_at": "2009-06-07T09:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51550",
    "user": "https://github.com/loefflerd"
}
```

Changing author from "" to "David Loeffler"



---

archive/issue_comments_051551.json:
```json
{
    "body": "Changing merged from \"\" to \"4.0.alpha0\"",
    "created_at": "2009-06-07T09:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-51551",
    "user": "https://github.com/loefflerd"
}
```

Changing merged from "" to "4.0.alpha0"
