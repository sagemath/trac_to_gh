# Issue 5923: [with positive review] Handling of magma and pari input in ModularForms

archive/issues_005923.json:
```json
{
    "body": "The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:\n\n```\nsage: ModularForms(gp(1),12)\n---------------------------------------------------------------------------\nTypeError     \n\n[much snipped error message]\n\nTypeError: Error executing code in GP/PARI:\nCODE:\n        sage[4]=level(sage[3]);\nGP/PARI ERROR:\n  ***   expected character: ',' instead of: sage[4]=level(sage[3]);\n                                                              ^-----\n```\n\nI realize that this is because the first element is supposed to be a group, although a (Sage) integer is allowed.\n\nWould there be any support for having an if statement in the function to catch magma or pari elements and transform them into their Sage equivalents?\n\n**Assignee:** @loefflerd\n\n**Author:** David Loeffler\n\n**Reviewer:** Craig Citro\n\n**Merged:** 4.0.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/5923\n\n",
    "closed_at": "2009-05-11T09:53:35Z",
    "created_at": "2009-04-28T22:41:04Z",
    "labels": [
        "component: modular forms",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.0",
    "title": "[with positive review] Handling of magma and pari input in ModularForms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5923",
    "user": "https://trac.sagemath.org/admin/accounts/users/ljpk"
}
```
The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:

```
sage: ModularForms(gp(1),12)
---------------------------------------------------------------------------
TypeError     

[much snipped error message]

TypeError: Error executing code in GP/PARI:
CODE:
        sage[4]=level(sage[3]);
GP/PARI ERROR:
  ***   expected character: ',' instead of: sage[4]=level(sage[3]);
                                                              ^-----
```

I realize that this is because the first element is supposed to be a group, although a (Sage) integer is allowed.

Would there be any support for having an if statement in the function to catch magma or pari elements and transform them into their Sage equivalents?

**Assignee:** @loefflerd

**Author:** David Loeffler

**Reviewer:** Craig Citro

**Merged:** 4.0.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/5923





---

archive/issue_comments_050499.json:
```json
{
    "body": "**Changing assignee** from @craigcitro to @loefflerd.",
    "created_at": "2009-05-01T08:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50499",
    "user": "https://github.com/loefflerd"
}
```

**Changing assignee** from @craigcitro to @loefflerd.



---

archive/issue_comments_050500.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2009-05-01T08:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50500",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_050501.json:
```json
{
    "body": "<a id='comment:1'></a>\nCertainly this is a bug, but a very easy one to fix; I'll fix it lat",
    "created_at": "2009-05-01T08:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50501",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:1'></a>
Certainly this is a bug, but a very easy one to fix; I'll fix it lat



---

archive/issue_comments_050502.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-05-01T11:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50502",
    "user": "https://github.com/loefflerd"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_050503.json:
```json
{
    "body": "<a id='comment:2'></a>\n.. er. \n\nIt turns out that the problem is that if x is a gp object, then \"x.level\" always *exists*: it is a microscopic function wrapper which on being called, executes \"level(x)\" in gp. Which of course doesn't work. Anyway, I've fixed it by rearranging the ModularForms constructor function a bit, and added a doctest to check that it's fixed.",
    "created_at": "2009-05-01T11:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50503",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:2'></a>
.. er. 

It turns out that the problem is that if x is a gp object, then "x.level" always *exists*: it is a microscopic function wrapper which on being called, executes "level(x)" in gp. Which of course doesn't work. Anyway, I've fixed it by rearranging the ModularForms constructor function a bit, and added a doctest to check that it's fixed.



---

archive/issue_comments_050504.json:
```json
{
    "body": "patch against 3.4.2.rc0",
    "created_at": "2009-05-01T11:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50504",
    "user": "https://github.com/loefflerd"
}
```

patch against 3.4.2.rc0



---

archive/issue_comments_050505.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n-The ModularForms command has some slightly counter-intuitive behaviour on some types of input:\n+The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:\n \n-{{{sage: ModularForms(gp(1),12)\n-\n----\n+```\n+sage: ModularForms(gp(1),12)\n+---------------------------------------------------------------------------\n TypeError     \n \n [much snipped error message]\n@@ -13,7 +13,7 @@\n GP/PARI ERROR:\n   ***   expected character: ',' instead of: sage[4]=level(sage[3]);\n                                                               ^-----\n-}}}\n+```\n \n I realize that this is because the first element is supposed to be a group, although a (Sage) integer is allowed.\n \n``````\n",
    "created_at": "2009-05-07T08:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50505",
    "user": "https://github.com/craigcitro"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
-The ModularForms command has some slightly counter-intuitive behaviour on some types of input:
+The `ModularForms` command has some slightly counter-intuitive behaviour on some types of input:
 
-{{{sage: ModularForms(gp(1),12)
-
----
+```
+sage: ModularForms(gp(1),12)
+---------------------------------------------------------------------------
 TypeError     
 
 [much snipped error message]
@@ -13,7 +13,7 @@
 GP/PARI ERROR:
   ***   expected character: ',' instead of: sage[4]=level(sage[3]);
                                                               ^-----
-}}}
+```
 
 I realize that this is because the first element is supposed to be a group, although a (Sage) integer is allowed.
 
``````




---

archive/attachments_006860.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5923.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5923/trac_5923.patch",
    "created_at": "2009-05-07T08:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/craigcitro"
}
```



---

archive/issue_comments_050506.json:
```json
{
    "body": "<a id='comment:3'></a>\n",
    "created_at": "2009-05-07T08:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50506",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:3'></a>




---

archive/issue_events_018088.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "rename": {
        "from": "Handling of magma and pari input in ModularForms",
        "to": "[with positive review] Handling of magma and pari input in ModularForms"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5923#event-18088"
}
```



---

archive/attachments_006861.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5923_pt2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5923/trac_5923_pt2.patch",
    "created_at": "2009-05-07T09:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/craigcitro"
}
```



---

archive/issue_comments_050507.json:
```json
{
    "body": "<a id='comment:4'></a>\nLooks good -- I added one small patch that just slightly moved things around. (Mostly just removed cases where tests would end up getting run several times, even though this code isn't anywhere near performance-critical.)",
    "created_at": "2009-05-07T09:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50507",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:4'></a>
Looks good -- I added one small patch that just slightly moved things around. (Mostly just removed cases where tests would end up getting run several times, even though this code isn't anywhere near performance-critical.)



---

archive/issue_events_018089.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-11T09:53:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5923#event-18089"
}
```



---

archive/issue_comments_050508.json:
```json
{
    "body": "<a id='comment:5'></a>\nMerged both patches in Sage 4.0.alpha0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-11T09:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50508",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>
Merged both patches in Sage 4.0.alpha0.

Cheers,

Michael



---

archive/issue_comments_050509.json:
```json
{
    "body": "**Reviewer:** Craig Citro",
    "created_at": "2009-06-07T09:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50509",
    "user": "https://github.com/loefflerd"
}
```

**Reviewer:** Craig Citro



---

archive/issue_comments_050510.json:
```json
{
    "body": "**Author:** David Loeffler",
    "created_at": "2009-06-07T09:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50510",
    "user": "https://github.com/loefflerd"
}
```

**Author:** David Loeffler



---

archive/issue_comments_050511.json:
```json
{
    "body": "**Merged:** 4.0.alpha0",
    "created_at": "2009-06-07T09:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5923#issuecomment-50511",
    "user": "https://github.com/loefflerd"
}
```

**Merged:** 4.0.alpha0
