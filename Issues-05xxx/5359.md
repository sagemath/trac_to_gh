# Issue 5359: Block matrix viewing is broken

archive/issues_005359.json:
```json
{
    "body": "From sage-support:\n\nViewing block matrices \"nicely\" seems to be difficult in Sage. \n\n```\nsage: A=matrix([[1]]) \nsage: B=matrix([[2]]) \nsage: C=matrix([[3]]) \nsage: D=matrix([[4]]) \nsage: BM=block_matrix([A,B,C,D]) \nsage: BM \n[1|2] \n[-+-] \n[3|4] \n```\nOkay, this is fine but a little clunky.  Let's try something nicer: \n\n```\nsage: show(BM) \n```\nUpon which a dvi viewer opens up, unfortunately not a very nice one... \nand shows the block matrix with only a vertical dividing line, not a \nhorizontal one! \nOkay, let's try the notebook: \n\n```\nA=matrix([[1]]) \nB=matrix([[2]]) \nC=matrix([[3]]) \nD=matrix([[4]]) \n\nBM=block_matrix([A,B,C,D]);BM \n\n[1|2] \n[-+-] \n[3|4] \n``` \n\nSo far so good, but when I click \"Typeset\" to get a LaTeXed matrix... \n\n```\nBM=block_matrix([A,B,C,D]);BM \n\n<html><span class=\"math\">\\left(\\begin{array}{r|r} \n1 & 2 \\\\ \n3 & 4 \n\\end{array}\\right)</span></html> \n``` \nWhich as you can see does NOT have any \"blockiness\" to it at all. \nVery pretty, but not a block matrix, at least not identifiably so. \n\n**Assignee:** @jhpalmieri\n\nIssue created by migration from https://trac.sagemath.org/ticket/5359\n\n",
    "closed_at": "2009-03-25T08:43:40Z",
    "created_at": "2009-02-24T17:55:14Z",
    "labels": [
        "component: misc",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.4.1",
    "title": "Block matrix viewing is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5359",
    "user": "https://github.com/kcrisman"
}
```
From sage-support:

Viewing block matrices "nicely" seems to be difficult in Sage. 

```
sage: A=matrix([[1]]) 
sage: B=matrix([[2]]) 
sage: C=matrix([[3]]) 
sage: D=matrix([[4]]) 
sage: BM=block_matrix([A,B,C,D]) 
sage: BM 
[1|2] 
[-+-] 
[3|4] 
```
Okay, this is fine but a little clunky.  Let's try something nicer: 

```
sage: show(BM) 
```
Upon which a dvi viewer opens up, unfortunately not a very nice one... 
and shows the block matrix with only a vertical dividing line, not a 
horizontal one! 
Okay, let's try the notebook: 

```
A=matrix([[1]]) 
B=matrix([[2]]) 
C=matrix([[3]]) 
D=matrix([[4]]) 

BM=block_matrix([A,B,C,D]);BM 

[1|2] 
[-+-] 
[3|4] 
``` 

So far so good, but when I click "Typeset" to get a LaTeXed matrix... 

```
BM=block_matrix([A,B,C,D]);BM 

<html><span class="math">\left(\begin{array}{r|r} 
1 & 2 \\ 
3 & 4 
\end{array}\right)</span></html> 
``` 
Which as you can see does NOT have any "blockiness" to it at all. 
Very pretty, but not a block matrix, at least not identifiably so. 

**Assignee:** @jhpalmieri

Issue created by migration from https://trac.sagemath.org/ticket/5359





---

archive/issue_events_016325.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "rename": {
        "from": "Block matrix viewing is broken",
        "to": "[needs work?] Block matrix viewing is broken"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5359#event-16325"
}
```



---

archive/issue_comments_043632.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think this is partly a bug and partly a defect in jsmath: the `_latex_` method for matrices completely ignores any subdivisions in the rows, and this is a bug. The right way to do this would be to add `\\hline` between the rows where you want lines, but jsmath doesn't seem to support this command.  It also seems to ignore the vertical line specifier in the array argument.\n\nSo I know how to fix this so that it works from the command line, but not from the notebook.  I'll attach a patch.\n\nAny ideas on what to do in the notebook?",
    "created_at": "2009-02-24T19:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43632",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
I think this is partly a bug and partly a defect in jsmath: the `_latex_` method for matrices completely ignores any subdivisions in the rows, and this is a bug. The right way to do this would be to add `\hline` between the rows where you want lines, but jsmath doesn't seem to support this command.  It also seems to ignore the vertical line specifier in the array argument.

So I know how to fix this so that it works from the command line, but not from the notebook.  I'll attach a patch.

Any ideas on what to do in the notebook?



---

archive/attachments_006025.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5359.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5359/5359.patch",
    "created_at": "2009-02-24T20:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_043633.json:
```json
{
    "body": "(will have to be rebased against sage 3.4)",
    "created_at": "2009-02-24T20:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43633",
    "user": "https://github.com/jhpalmieri"
}
```

(will have to be rebased against sage 3.4)



---

archive/issue_comments_043634.json:
```json
{
    "body": "<a id='comment:2'></a>\nI won't be able to review this in the near future but if it works this seems appropriate.  \n\nAccording to the jsmath future features page, [http://www.math.union.edu/~dpvc/jsMath/future.html](http://www.math.union.edu/~dpvc/jsMath/future.html), one of the future goals is \n\n```\nAdd more control over entries in arrays and matrices (something like the array option control provided by WebTeX)\n```\nso perhaps this ticket should be closed once the command line piece is given a positive review, and then a new ticket opened and/or a report sent to the jsmath author.  In any case we should at least have Sage as one of the sites using jsmath on his gallery!  \n\nThere *is* an example of a pseudo-block matrix in his examples section, [http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html](http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html) Exercise 18.42.  I don't know if that would be a satisfactory solution, though.",
    "created_at": "2009-02-25T01:41:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43634",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>
I won't be able to review this in the near future but if it works this seems appropriate.  

According to the jsmath future features page, [http://www.math.union.edu/~dpvc/jsMath/future.html](http://www.math.union.edu/~dpvc/jsMath/future.html), one of the future goals is 

```
Add more control over entries in arrays and matrices (something like the array option control provided by WebTeX)
```
so perhaps this ticket should be closed once the command line piece is given a positive review, and then a new ticket opened and/or a report sent to the jsmath author.  In any case we should at least have Sage as one of the sites using jsmath on his gallery!  

There *is* an example of a pseudo-block matrix in his examples section, [http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html](http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html) Exercise 18.42.  I don't know if that would be a satisfactory solution, though.



---

archive/issue_events_016326.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "rename": {
        "from": "[needs work?] Block matrix viewing is broken",
        "to": "Block matrix viewing is broken"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5359#event-16326"
}
```



---

archive/issue_comments_043635.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-02-25T20:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43635",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_043636.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [kcrisman](#comment%3A2):\n\n> There *is* an example of a pseudo-block matrix in his examples section, \n> [http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html](http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html) Exercise 18.42.  I \n> don't know if that would be a satisfactory solution, though.\n\n\nI don't know if it is satisfactory, either, but I couldn't come up with anything better, so I've implemented this for the notebook version.  This ignores repeated subdivisions, because I couldn't come up with a good way to display them: in the notebook, if you do\n\n```\nB = matrix(2,2)\nB.subdivide([1], [])\nC = matrix(2,2)\nC.subdivide([1,1], [])\n```\nthen B and C will be typeset identically.  The command-line versions look different, though.",
    "created_at": "2009-02-25T20:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43636",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
Replying to [kcrisman](#comment%3A2):

> There *is* an example of a pseudo-block matrix in his examples section, 
> [http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html](http://www.math.union.edu/~dpvc/jsMath/examples/TeXbook18x.html) Exercise 18.42.  I 
> don't know if that would be a satisfactory solution, though.


I don't know if it is satisfactory, either, but I couldn't come up with anything better, so I've implemented this for the notebook version.  This ignores repeated subdivisions, because I couldn't come up with a good way to display them: in the notebook, if you do

```
B = matrix(2,2)
B.subdivide([1], [])
C = matrix(2,2)
C.subdivide([1,1], [])
```
then B and C will be typeset identically.  The command-line versions look different, though.



---

archive/issue_comments_043637.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2009-03-05T20:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43637",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_043638.json:
```json
{
    "body": "**Changing assignee** from cwitty to @jhpalmieri.",
    "created_at": "2009-03-05T20:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43638",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing assignee** from cwitty to @jhpalmieri.



---

archive/issue_comments_043639.json:
```json
{
    "body": "rebased against 3.4; apply only this patch",
    "created_at": "2009-03-12T21:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43639",
    "user": "https://github.com/jhpalmieri"
}
```

rebased against 3.4; apply only this patch



---

archive/attachments_006026.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "5359-new.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5359/5359-new.patch",
    "created_at": "2009-03-16T23:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/robertwb"
}
```



---

archive/issue_comments_043640.json:
```json
{
    "body": "<a id='comment:5'></a>\nI think your solution for block matrices in the notebook is a good idea, at least until jsmath supports the standard way.",
    "created_at": "2009-03-16T23:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43640",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:5'></a>
I think your solution for block matrices in the notebook is a good idea, at least until jsmath supports the standard way.



---

archive/issue_comments_043641.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-03-16T23:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43641",
    "user": "https://github.com/robertwb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_016327.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-25T08:43:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5359#event-16327"
}
```



---

archive/issue_events_016328.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-03-25T08:43:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5359#event-16328"
}
```



---

archive/issue_comments_043642.json:
```json
{
    "body": "<a id='comment:6'></a>\nMerged in Sage 3.4.1.alpha0.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-25T08:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5359",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5359#issuecomment-43642",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
Merged in Sage 3.4.1.alpha0.

Cheers,

Michael
