# Issue 5267: bug in changing a constant multivariate polynomial into a univariate one

archive/issues_005267.json:
```json
{
    "assignees": [],
    "body": "I just ran into this (on 3.3.rc0):\n\n```\nsage: S.<u, v> = QQ[]\nsage: I = Ideal(-u^2*v+1)\nsage: I.plot()\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n\n/home/ghitza/.sage/temp/artin/23695/_home_ghitza__sage_init_sage_0.py in <module>()\n\n/opt/sage/local/lib/python2.5/site-packages/sage/rings/polynomial/multi_polynomial_ideal.pyc in plot(self, *args, **kwds)\n   2387                     v, mi, ma = variables[var_index], -10, 10\n   2388                     for i in range(mi, ma):\n-> 2389                         roots = f.subs({v:i}).univariate_polynomial().change_ring(RR).roots()\n   2390                         if len(roots) > 0:\n   2391                             mi = i - 1\n\n/opt/sage/local/lib/python2.5/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.univariate_polynomial (sage/rings/polynomial/multi_polynomial_libsingular.cpp:21299)()\n\nIndexError: list index out of range\n```\n\n\nAssignee: **@aghitza**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5267_\n\n",
    "closed_at": "2009-02-14T16:09:35Z",
    "created_at": "2009-02-14T10:46:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20commutative%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "bug in changing a constant multivariate polynomial into a univariate one",
    "type": "issue",
    "updated_at": "2009-02-14T16:09:35Z",
    "url": "https://github.com/sagemath/sage/issues/5267",
    "user": "https://github.com/aghitza"
}
```
I just ran into this (on 3.3.rc0):

```
sage: S.<u, v> = QQ[]
sage: I = Ideal(-u^2*v+1)
sage: I.plot()
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)

/home/ghitza/.sage/temp/artin/23695/_home_ghitza__sage_init_sage_0.py in <module>()

/opt/sage/local/lib/python2.5/site-packages/sage/rings/polynomial/multi_polynomial_ideal.pyc in plot(self, *args, **kwds)
   2387                     v, mi, ma = variables[var_index], -10, 10
   2388                     for i in range(mi, ma):
-> 2389                         roots = f.subs({v:i}).univariate_polynomial().change_ring(RR).roots()
   2390                         if len(roots) > 0:
   2391                             mi = i - 1

/opt/sage/local/lib/python2.5/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.univariate_polynomial (sage/rings/polynomial/multi_polynomial_libsingular.cpp:21299)()

IndexError: list index out of range
```


Assignee: **@aghitza**

_Issue created by migration from https://trac.sagemath.org/ticket/5267_





---

archive/issue_events_053886.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T10:46:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53886"
}
```



---

archive/issue_events_053887.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T10:46:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20commutative%20algebra",
    "label_color": "0000ff",
    "label_name": "component: commutative algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53887"
}
```



---

archive/issue_events_053888.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T10:46:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53888"
}
```



---

archive/issue_events_053889.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T10:46:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53889"
}
```



---

archive/issue_comments_033585.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nTracked it down to a bug in turning a constant multivariate polynomial into a univariate one, as in the following example:\n\n```\nsage: S.<u, v> = QQ[]\nsage: f = S(1)\nsage: f.univariate_polynomial()\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n\n/home/ghitza/.sage/temp/artin/769/_home_ghitza__sage_init_sage_0.py in <module>()\n\n/opt/sage/local/lib/python2.5/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.univariate_polynomial (sage/rings/polynomial/multi_polynomial_libsingular.cpp:21299)()\n\nIndexError: list index out of range\n```\n\nIn light of this, I'm changing the summary of the ticket.  I'll have a patch up soon.",
    "created_at": "2009-02-14T11:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5267#issuecomment-33585",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:1'>Comment 1:</a>
Tracked it down to a bug in turning a constant multivariate polynomial into a univariate one, as in the following example:

```
sage: S.<u, v> = QQ[]
sage: f = S(1)
sage: f.univariate_polynomial()
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)

/home/ghitza/.sage/temp/artin/769/_home_ghitza__sage_init_sage_0.py in <module>()

/opt/sage/local/lib/python2.5/site-packages/sage/rings/polynomial/multi_polynomial_libsingular.so in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.univariate_polynomial (sage/rings/polynomial/multi_polynomial_libsingular.cpp:21299)()

IndexError: list index out of range
```

In light of this, I'm changing the summary of the ticket.  I'll have a patch up soon.



---

archive/issue_events_053890.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T11:04:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "title_is": "bug in changing a constant multivariate polynomial into a univariate one",
    "title_was": "bug in plotting the zero locus of an ideal in an mpoly ring",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53890"
}
```



---

archive/issue_comments_033586.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThe attached patch fixes the bug causing all this, and adds doctests for both the bug and the initial (plotting) issue.\n\nThe fix is quite trivial, so should be easy to review.",
    "created_at": "2009-02-14T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5267#issuecomment-33586",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:2'>Comment 2:</a>
The attached patch fixes the bug causing all this, and adds doctests for both the bug and the initial (plotting) issue.

The fix is quite trivial, so should be easy to review.



---

archive/issue_events_053891.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T11:21:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53891"
}
```



---

archive/issue_events_053892.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T11:21:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53892"
}
```



---

archive/issue_events_053893.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T11:21:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53893"
}
```



---

archive/issue_comments_033587.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nAttachment: **[trac_5267-const_mpoly.patch.gz](https://github.com/sagemath/sage/files/ticket5267/trac_5267-const_mpoly.patch.gz)**",
    "created_at": "2009-02-14T11:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5267#issuecomment-33587",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:3'>Comment 3:</a>
Attachment: **[trac_5267-const_mpoly.patch.gz](https://github.com/sagemath/sage/files/ticket5267/trac_5267-const_mpoly.patch.gz)**



---

archive/issue_comments_033588.json:
```json
{
    "body": "Changed assignee from **@malb** to **@aghitza**",
    "created_at": "2009-02-14T11:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5267#issuecomment-33588",
    "user": "https://github.com/aghitza"
}
```

Changed assignee from **@malb** to **@aghitza**



---

archive/issue_events_053894.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-02-14T11:53:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53894"
}
```



---

archive/issue_events_053895.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-02-14T15:35:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53895"
}
```



---

archive/issue_comments_033589.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nLooks good.",
    "created_at": "2009-02-14T15:35:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5267#issuecomment-33589",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'>Comment 5:</a>
Looks good.



---

archive/issue_events_053896.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-14T16:09:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53896"
}
```



---

archive/issue_events_053897.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-14T16:09:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5267#event-53897"
}
```



---

archive/issue_comments_033590.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nMerged in Sage 3.3.rc1.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-14T16:09:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5267",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5267#issuecomment-33590",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:6'>Comment 6:</a>
Merged in Sage 3.3.rc1.

Cheers,

Michael
