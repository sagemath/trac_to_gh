# Issue 5194: [with patch; positive review] add option to turn off automatic updates for an interact

archive/issues_005194.json:
```json
{
    "body": "Whenever the user of an interact tabs from one input_box to another, the function is called, which sets off all the computations associated with the interact. Even when the computations are not very time-consuming, it can be a hassle if, for example, the user wishes to change several input boxes at once, before getting an update.\n\nThis enhancement, discussed [here](http://groups.google.com/group/sage-devel/browse_thread/thread/9ff935e0d6a729b3/554c6c448e6a75e5?lnk=gst&q=interact+update#554c6c448e6a75e5) on sage-devel, would allow an interact to turn off automatic update, adding a user interface element that will prompt the interact to re-run.\n\nAssignee: @mwhansen\n\nCC:  @jasongrout\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/5194\n\n",
    "closed_at": "2009-02-09T11:16:00Z",
    "created_at": "2009-02-06T03:38:45Z",
    "labels": [
        "component: notebook",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.3",
    "title": "[with patch; positive review] add option to turn off automatic updates for an interact",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5194",
    "user": "https://github.com/johnperry-math"
}
```
Whenever the user of an interact tabs from one input_box to another, the function is called, which sets off all the computations associated with the interact. Even when the computations are not very time-consuming, it can be a hassle if, for example, the user wishes to change several input boxes at once, before getting an update.

This enhancement, discussed [here](http://groups.google.com/group/sage-devel/browse_thread/thread/9ff935e0d6a729b3/554c6c448e6a75e5?lnk=gst&q=interact+update#554c6c448e6a75e5) on sage-devel, would allow an interact to turn off automatic update, adding a user interface element that will prompt the interact to re-run.

Assignee: @mwhansen

CC:  @jasongrout

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/5194





---

archive/issue_comments_042325.json:
```json
{
    "body": "Attachment [update_interact.patch](tarball://root/attachments/some-uuid/ticket5194/update_interact.patch) by @johnperry-math created at 2009-02-06 03:39:33\n\na patch that adds a checkbox to control automatic updating",
    "created_at": "2009-02-06T03:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42325",
    "user": "https://github.com/johnperry-math"
}
```

Attachment [update_interact.patch](tarball://root/attachments/some-uuid/ticket5194/update_interact.patch) by @johnperry-math created at 2009-02-06 03:39:33

a patch that adds a checkbox to control automatic updating



---

archive/issue_events_020260.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "rename": {
        "from": "add option to turn off automatic updates for an interact",
        "to": "[with patch; needs review] add option to turn off automatic updates for an interact"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20260"
}
```



---

archive/issue_comments_042326.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe patch I've attached is **not** the one described in the final version of the discussion. Mike Hansen recommended that we provide a button that, when pressed, updates the interact, and when not pressed, does not.\n\nI don't know how to create a button (Sage doesn't have them yet), but I do know how to create a checkbox. After looking at the code tonight, I also suspect that it will take a more serious rewrite of interact to make that version work. The submitted patch can serve as a stopgap.",
    "created_at": "2009-02-06T03:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42326",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:1'></a>
The patch I've attached is **not** the one described in the final version of the discussion. Mike Hansen recommended that we provide a button that, when pressed, updates the interact, and when not pressed, does not.

I don't know how to create a button (Sage doesn't have them yet), but I do know how to create a checkbox. After looking at the code tonight, I also suspect that it will take a more serious rewrite of interact to make that version work. The submitted patch can serve as a stopgap.



---

archive/issue_comments_042327.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis stopgap patch: \n* still causes a roundtrip to the server\n* //deletes// the output when unchecked, and you can't see the output again until you check it.  This could be considered a good thing.\n\nHowever, it's still a nice stopgap approach.  The documentation is missing, though.  Positive review when the documentation to the interact function mentions this parameter and tells what it does.",
    "created_at": "2009-02-06T20:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42327",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
This stopgap patch: 
* still causes a roundtrip to the server
* //deletes// the output when unchecked, and you can't see the output again until you check it.  This could be considered a good thing.

However, it's still a nice stopgap approach.  The documentation is missing, though.  Positive review when the documentation to the interact function mentions this parameter and tells what it does.



---

archive/issue_events_020261.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "rename": {
        "from": "[with patch; needs review] add option to turn off automatic updates for an interact",
        "to": "[with patch; needs work] add option to turn off automatic updates for an interact"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20261"
}
```



---

archive/issue_events_020262.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-06T23:03:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20262"
}
```



---

archive/issue_comments_042328.json:
```json
{
    "body": "<a id='comment:4'></a>\n3.4 is for ReST tickets only.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-06T23:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42328",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
3.4 is for ReST tickets only.

Cheers,

Michael



---

archive/issue_comments_042329.json:
```json
{
    "body": "Attachment [trac_5194.patch](tarball://root/attachments/some-uuid/ticket5194/trac_5194.patch) by @mwhansen created at 2009-02-07 05:35:29",
    "created_at": "2009-02-07T05:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42329",
    "user": "https://github.com/mwhansen"
}
```

Attachment [trac_5194.patch](tarball://root/attachments/some-uuid/ticket5194/trac_5194.patch) by @mwhansen created at 2009-02-07 05:35:29



---

archive/issue_comments_042330.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've posted a patch which implements what was discussed on sage-devel.  A lot of it is mostly general infrastructure stuff such as separating the updating of values from the running of the interact function.\n\nCurrently, when the values are changed, the output is deleted.  One could get around this, but the implementation is a bit messy since the update button would have to go through all of the controls and update the values in the Sage process for each of them.",
    "created_at": "2009-02-07T05:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42330",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:5'></a>
I've posted a patch which implements what was discussed on sage-devel.  A lot of it is mostly general infrastructure stuff such as separating the updating of values from the running of the interact function.

Currently, when the values are changed, the output is deleted.  One could get around this, but the implementation is a bit messy since the update button would have to go through all of the controls and update the values in the Sage process for each of them.



---

archive/issue_events_020263.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "rename": {
        "from": "[with patch; needs work] add option to turn off automatic updates for an interact",
        "to": "[with patch; needs review] add option to turn off automatic updates for an interact"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20263"
}
```



---

archive/issue_comments_042331.json:
```json
{
    "body": "Changing assignee from boothby to @mwhansen.",
    "created_at": "2009-02-07T05:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42331",
    "user": "https://github.com/mwhansen"
}
```

Changing assignee from boothby to @mwhansen.



---

archive/issue_comments_042332.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2009-02-07T05:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42332",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to assigned.



---

archive/issue_events_020264.json:
```json
{
    "actor": "https://github.com/johnperry-math",
    "created_at": "2009-02-08T17:43:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20264"
}
```



---

archive/issue_comments_042333.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe second patch does exactly what I would have liked. It is unfortunate that the output is deleted, but the current situation is much better than the previous one. In addition, it adds some infrastructure for a button object to interact, although anything beyond the Update button is non-trivial to get working.\n\nThe only caution I would issue is that when I ran `sage -t` I initially encountered the following failure:\n\n**********************************************************************\nFile \"/home/software/sage-3.2.1/devel/sage-main/sage/server/notebook/interact.py\", line 677:\n    sage: sage.server.notebook.interact.InputBox('theta', 1).render()\nExpected:\n    '<input type=\\'text\\' value=\"1\" size=80 onchange=\\'interact(0, \"sage.server.notebook.interact.update(0, \\\\\"theta\\\\\", ..., sage.server.notebook.interact.standard_b64decode(\\\\\"\"+encode64(this.value)+\"\\\\\"), globals());sage.server.notebook.interact.recompute(0)\")\\'></input>'\nGot:\n    '<input type=\\'text\\' value=\\'1\\' size=80 onchange=\\'interact(0, \"sage.server.notebook.interact.update(0, \\\\\"theta\\\\\", 27, sage.server.notebook.interact.standard_b64decode(\\\\\"\"+encode64(this.value)+\"\\\\\"), globals());sage.server.notebook.interact.recompute(0)\")\\'></input>'\n**********************************************************************\n\nThis appears to be due to a difference in code that your patch did not update: once I changed the relevant line to return `value=\"%r\"` and `value=\"%s\"` instead of `value='%r'` and `value='%s'` this worked. Maybe I was missing some intermediate patch?",
    "created_at": "2009-02-08T17:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42333",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:6'></a>
The second patch does exactly what I would have liked. It is unfortunate that the output is deleted, but the current situation is much better than the previous one. In addition, it adds some infrastructure for a button object to interact, although anything beyond the Update button is non-trivial to get working.

The only caution I would issue is that when I ran `sage -t` I initially encountered the following failure:

**********************************************************************
File "/home/software/sage-3.2.1/devel/sage-main/sage/server/notebook/interact.py", line 677:
    sage: sage.server.notebook.interact.InputBox('theta', 1).render()
Expected:
    '<input type=\'text\' value="1" size=80 onchange=\'interact(0, "sage.server.notebook.interact.update(0, \\"theta\\", ..., sage.server.notebook.interact.standard_b64decode(\\""+encode64(this.value)+"\\"), globals());sage.server.notebook.interact.recompute(0)")\'></input>'
Got:
    '<input type=\'text\' value=\'1\' size=80 onchange=\'interact(0, "sage.server.notebook.interact.update(0, \\"theta\\", 27, sage.server.notebook.interact.standard_b64decode(\\""+encode64(this.value)+"\\"), globals());sage.server.notebook.interact.recompute(0)")\'></input>'
**********************************************************************

This appears to be due to a difference in code that your patch did not update: once I changed the relevant line to return `value="%r"` and `value="%s"` instead of `value='%r'` and `value='%s'` this worked. Maybe I was missing some intermediate patch?



---

archive/issue_comments_042334.json:
```json
{
    "body": "Resolution: worksforme",
    "created_at": "2009-02-08T17:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42334",
    "user": "https://github.com/johnperry-math"
}
```

Resolution: worksforme



---

archive/issue_events_020265.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "rename": {
        "from": "[with patch; needs review] add option to turn off automatic updates for an interact",
        "to": "[with patch; with positive review] add option to turn off automatic updates for an interact"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20265"
}
```



---

archive/issue_comments_042335.json:
```json
{
    "body": "Resolution changed from worksforme to ",
    "created_at": "2009-02-08T18:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42335",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution changed from worksforme to 



---

archive/issue_comments_042336.json:
```json
{
    "body": "<a id='comment:7'></a>\nJohn,\n\n* do not close tickets, the release manager does that once the patch has been merged.\n* do not give an unconditional positive review to ticket that have doctest failures\n\nCheers,\n\nMichael",
    "created_at": "2009-02-08T18:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42336",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>
John,

* do not close tickets, the release manager does that once the patch has been merged.
* do not give an unconditional positive review to ticket that have doctest failures

Cheers,

Michael



---

archive/issue_comments_042337.json:
```json
{
    "body": "Changing status from closed to reopened.",
    "created_at": "2009-02-08T18:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42337",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Changing status from closed to reopened.



---

archive/issue_events_020266.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-08T18:35:29Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20266"
}
```



---

archive/issue_events_020267.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "rename": {
        "from": "[with patch; with positive review] add option to turn off automatic updates for an interact",
        "to": "[with patch; positive review, needs doctest fix] add option to turn off automatic updates for an interact"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20267"
}
```



---

archive/issue_comments_042338.json:
```json
{
    "body": "<a id='comment:8'></a>\nOk, according to the doctesting this is the problem:\n\n```\n    '<input type=\\'text\\' value=\"1\" size=80 \n    '<input type=\\'text\\' value=\\'1\\' size=80 \n```\ni.e. a change in escaping. This looks fine to me, but I will apply the patches and see if the doctest issue is still even there.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-09T11:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42338",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:8'></a>
Ok, according to the doctesting this is the problem:

```
    '<input type=\'text\' value="1" size=80 
    '<input type=\'text\' value=\'1\' size=80 
```
i.e. a change in escaping. This looks fine to me, but I will apply the patches and see if the doctest issue is still even there.

Cheers,

Michael



---

archive/issue_events_020268.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-09T11:15:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20268"
}
```



---

archive/issue_events_020269.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-09T11:15:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "milestone": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20269"
}
```



---

archive/issue_comments_042339.json:
```json
{
    "body": "<a id='comment:9'></a>\nWith my merge tree and mhansen's patch only:\n\n```\nAll tests passed!\nTimings have been updated.\nTotal time for all tests: 266.2 seconds\n```\nSo back to positive review.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-09T11:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42339",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:9'></a>
With my merge tree and mhansen's patch only:

```
All tests passed!
Timings have been updated.
Total time for all tests: 266.2 seconds
```
So back to positive review.

Cheers,

Michael



---

archive/issue_events_020270.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "rename": {
        "from": "[with patch; positive review, needs doctest fix] add option to turn off automatic updates for an interact",
        "to": "[with patch; positive review] add option to turn off automatic updates for an interact"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20270"
}
```



---

archive/issue_comments_042340.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-02-09T11:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42340",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_020271.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-09T11:16:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5194#event-20271"
}
```



---

archive/issue_comments_042341.json:
```json
{
    "body": "<a id='comment:10'></a>\nMerged in Sage 3.3.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-09T11:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5194#issuecomment-42341",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:10'></a>
Merged in Sage 3.3.rc0.

Cheers,

Michael
