# Issue 5799: jsMath, favicon, and logo for live, static, and offline docs

archive/issues_005799.json:
```json
{
    "assignees": [],
    "body": "A few changes to\n\n* Enable jsMath in static and offline docs.\n\n* Display a Sage favicon in static and offline docs.\n\n* Display a Sage logo in live, static, and offline docs.\n\n\"Offline\" docs are just those accessed via file:///.\n\nI'm not sure whether/how Mercurial handles binary files, so I've attached two patches.  One mentions the added favicon and logo files; the other doesn't.  To get the png files themselves in the right place, I first created doc/common/static.  Then, in this directory I did\n\nwget http://www.sagemath.org/pix/sageicon.png\n\nand\n\nln -s ../../../../../data/extcode/notebook/images/sagelogo.png .\n\nI've attached these, too.\n\nNote: There's a favicon.ico in the same extcode directory, but it's not transparent.  There is another sagelogo.png in SAGE_ROOT/data/extcode/images, but its dimensions are larger.\n\nThe jsMath issue was mentioned on sage-devel:\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/40eab3f9610e061d/eb93a3930e79ea3a?#eb93a3930e79ea3a\n\nThe favicon and logo were mentioned in connection with a doc sidebar toggle:\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/8c8fe7c5d0c0f725/4807f5553bdbd6b0?#4807f5553bdbd6b0\n\nI'll make a separate ticket for the toggle.\n\n**Author:** Mitesh Patel, John Palmieri\n\n**Reviewer:** John Palmieri, Robert Miller\n\n**Merged:** sage-4.1.rc0\n\nIssue created by migration from https://trac.sagemath.org/ticket/5799\n\n",
    "closed_at": "2009-07-07T21:22:17Z",
    "created_at": "2009-04-16T04:35:32Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20documentation",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "jsMath, favicon, and logo for live, static, and offline docs",
    "type": "issue",
    "updated_at": "2009-07-24T15:17:51Z",
    "url": "https://github.com/sagemath/sage/issues/5799",
    "user": "https://github.com/qed777"
}
```
A few changes to

* Enable jsMath in static and offline docs.

* Display a Sage favicon in static and offline docs.

* Display a Sage logo in live, static, and offline docs.

"Offline" docs are just those accessed via file:///.

I'm not sure whether/how Mercurial handles binary files, so I've attached two patches.  One mentions the added favicon and logo files; the other doesn't.  To get the png files themselves in the right place, I first created doc/common/static.  Then, in this directory I did

wget http://www.sagemath.org/pix/sageicon.png

and

ln -s ../../../../../data/extcode/notebook/images/sagelogo.png .

I've attached these, too.

Note: There's a favicon.ico in the same extcode directory, but it's not transparent.  There is another sagelogo.png in SAGE_ROOT/data/extcode/images, but its dimensions are larger.

The jsMath issue was mentioned on sage-devel:

http://groups.google.com/group/sage-devel/browse_thread/thread/40eab3f9610e061d/eb93a3930e79ea3a?#eb93a3930e79ea3a

The favicon and logo were mentioned in connection with a doc sidebar toggle:

http://groups.google.com/group/sage-devel/browse_thread/thread/8c8fe7c5d0c0f725/4807f5553bdbd6b0?#4807f5553bdbd6b0

I'll make a separate ticket for the toggle.

**Author:** Mitesh Patel, John Palmieri

**Reviewer:** John Palmieri, Robert Miller

**Merged:** sage-4.1.rc0

Issue created by migration from https://trac.sagemath.org/ticket/5799





---

archive/issue_events_056977.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-04-16T04:35:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "milestone_number": null,
    "milestone_title": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56977"
}
```



---

archive/issue_events_056978.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-04-16T04:35:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20documentation",
    "label_color": "08517b",
    "label_name": "component: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56978"
}
```



---

archive/issue_events_056979.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-04-16T04:35:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56979"
}
```



---

archive/issue_events_056980.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-04-16T04:35:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56980"
}
```



---

archive/issue_events_056981.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-04-16T04:35:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56981"
}
```



---

archive/issue_comments_038311.json:
```json
{
    "body": "<a id='comment:1'></a>\nTo create a patch that contains a png you need to export a git style patch. Then export two patches, one for the Sage library and one for the ext repo. The names should be \n\n* trac_5799_sage_$FOO\n* trac_5799_ext_$BAR\n \nrespectively. It is generally a good idea to split tickets into independent tasks, i.e. this is a borderline case and can be done via one ticket.\n\nThis also strikes me as kind of odd:\n\n```\n<script type=\"text/javascript\" src=\"../../../../../../../local/notebook/javascript/jsmath/easy/load.js\"></script> \n```\ngiven that everywhere else we use \n\n```\n<script type=\"text/javascript\" src=\"/javascript_local/$FOO\"></script>\n```\nbut that might be unavoidable. \n\n\nCheers,\n\nMichael",
    "created_at": "2009-04-16T05:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38311",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:1'></a>
To create a patch that contains a png you need to export a git style patch. Then export two patches, one for the Sage library and one for the ext repo. The names should be 

* trac_5799_sage_$FOO
* trac_5799_ext_$BAR
 
respectively. It is generally a good idea to split tickets into independent tasks, i.e. this is a borderline case and can be done via one ticket.

This also strikes me as kind of odd:

```
<script type="text/javascript" src="../../../../../../../local/notebook/javascript/jsmath/easy/load.js"></script> 
```
given that everywhere else we use 

```
<script type="text/javascript" src="/javascript_local/$FOO"></script>
```
but that might be unavoidable. 


Cheers,

Michael



---

archive/issue_events_056982.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-04-16T05:56:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56982"
}
```



---

archive/issue_comments_038312.json:
```json
{
    "body": "**Attachment:** [trac_5799_sage_jsmath_doc.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_sage_jsmath_doc.patch.gz)\n\n**Attachment:** [trac_5799_ext_sageicon.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_ext_sageicon.patch.gz)",
    "created_at": "2009-04-16T07:50:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38312",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_5799_sage_jsmath_doc.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_sage_jsmath_doc.patch.gz)

**Attachment:** [trac_5799_ext_sageicon.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_ext_sageicon.patch.gz)



---

archive/issue_comments_038313.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [mabshoff](#comment%3A1):\n> To create a patch [...]\n\nThanks for the tips!  Take two attached.\n\n> This also strikes me as kind of odd:\n\nI'm about to attach an alternative to trac_5799_sage_jsmath_doc.patch.",
    "created_at": "2009-04-16T08:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38313",
    "user": "https://github.com/qed777"
}
```

<a id='comment:2'></a>
Replying to [mabshoff](#comment%3A1):
> To create a patch [...]

Thanks for the tips!  Take two attached.

> This also strikes me as kind of odd:

I'm about to attach an alternative to trac_5799_sage_jsmath_doc.patch.



---

archive/issue_comments_038314.json:
```json
{
    "body": "**Attachment:** [trac_5799_sage_jsmath_doc_alt.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_sage_jsmath_doc_alt.patch.gz)\n\nSomewhat less efficient alternative to trac_5799_sage_jsmath_doc.patch.",
    "created_at": "2009-04-16T08:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38314",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_5799_sage_jsmath_doc_alt.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_sage_jsmath_doc_alt.patch.gz)

Somewhat less efficient alternative to trac_5799_sage_jsmath_doc.patch.



---

archive/issue_comments_038315.json:
```json
{
    "body": "<a id='comment:3'></a>\nCool, I deleted the old patches to make the history cleaner. If you post updated patches you should also change back the summary to \"needs review\". I did that in this case already.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-16T08:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38315",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:3'></a>
Cool, I deleted the old patches to make the history cleaner. If you post updated patches you should also change back the summary to "needs review". I did that in this case already.

Cheers,

Michael



---

archive/issue_events_056983.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-04-16T08:57:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56983"
}
```



---

archive/issue_events_056984.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-04-16T08:57:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56984"
}
```



---

archive/issue_comments_038316.json:
```json
{
    "body": "<a id='comment:4'></a>\nI applied the 'ext' and 'alt sage' patches, and tested \"en/tutorial html\".  It all looks good.",
    "created_at": "2009-04-17T15:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38316",
    "user": "https://github.com/sagetrac-justin"
}
```

<a id='comment:4'></a>
I applied the 'ext' and 'alt sage' patches, and tested "en/tutorial html".  It all looks good.



---

archive/issue_events_056985.json:
```json
{
    "actor": "https://github.com/sagetrac-justin",
    "created_at": "2009-04-17T15:49:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "rename": {
        "from": "jsMath, favicon, and logo for live, static, and offline docs",
        "to": "[postive review] jsMath, favicon, and logo for live, static, and offline docs"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56985"
}
```



---

archive/issue_events_056986.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-08T17:51:32Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "rename": {
        "from": "[postive review] jsMath, favicon, and logo for live, static, and offline docs",
        "to": "jsMath, favicon, and logo for live, static, and offline docs"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56986"
}
```



---

archive/issue_events_056987.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-08T17:51:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56987"
}
```



---

archive/issue_events_056988.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-08T17:51:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56988"
}
```



---

archive/issue_comments_038317.json:
```json
{
    "body": "Better cross-browser favicon support. Goes with trac_5799_sage_jsmath_doc_v2.patch.",
    "created_at": "2009-06-10T09:23:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38317",
    "user": "https://github.com/qed777"
}
```

Better cross-browser favicon support. Goes with trac_5799_sage_jsmath_doc_v2.patch.



---

archive/issue_comments_038318.json:
```json
{
    "body": "**Attachment:** [trac_5799_ext_icons_v2.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_ext_icons_v2.patch.gz)\n\n**Attachment:** [trac_5799_sage_jsmath_doc_v2.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_sage_jsmath_doc_v2.patch.gz)\n\nBetter cross-browser favicon support, auto relative paths. Apply trac_5799_ext_icons_v2.patch first.",
    "created_at": "2009-06-10T09:26:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38318",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_5799_ext_icons_v2.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_ext_icons_v2.patch.gz)

**Attachment:** [trac_5799_sage_jsmath_doc_v2.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_sage_jsmath_doc_v2.patch.gz)

Better cross-browser favicon support, auto relative paths. Apply trac_5799_ext_icons_v2.patch first.



---

archive/issue_comments_038319.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe `*_v2` pair replaces the earlier versions.\n\n* Same [sageicon.png](http://www.sagemath.org/pix/sageicon.png) as in the first patch.\n* ImageMagick gives a \"true\" ico file: `convert sageicon.png favicon.ico`.\n* Tested in FF3, O9 on Linux, and in Cr2, FF3, IE8, O9, S3 on Windows XP. Whether the icon is transparent and visible for live, static, and offline docs is browser-dependent.\n* Automatic relative paths for the favicon, logo, and jsMath.  This is important, e.g., in the reference manual.\n* #4714 should take care of the unknown jsMath macros.",
    "created_at": "2009-06-10T10:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38319",
    "user": "https://github.com/qed777"
}
```

<a id='comment:6'></a>
The `*_v2` pair replaces the earlier versions.

* Same [sageicon.png](http://www.sagemath.org/pix/sageicon.png) as in the first patch.
* ImageMagick gives a "true" ico file: `convert sageicon.png favicon.ico`.
* Tested in FF3, O9 on Linux, and in Cr2, FF3, IE8, O9, S3 on Windows XP. Whether the icon is transparent and visible for live, static, and offline docs is browser-dependent.
* Automatic relative paths for the favicon, logo, and jsMath.  This is important, e.g., in the reference manual.
* #4714 should take care of the unknown jsMath macros.



---

archive/issue_events_056989.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-06-10T10:24:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56989"
}
```



---

archive/issue_events_056990.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-06-10T10:24:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56990"
}
```



---

archive/issue_comments_038320.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2009-06-27T17:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38320",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_events_056991.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-27T17:06:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56991"
}
```



---

archive/issue_events_056992.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-27T17:06:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56992"
}
```



---

archive/issue_comments_038321.json:
```json
{
    "body": "**Author:** Mitesh Patel",
    "created_at": "2009-06-27T17:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38321",
    "user": "https://github.com/jhpalmieri"
}
```

**Author:** Mitesh Patel



---

archive/issue_comments_038322.json:
```json
{
    "body": "<a id='comment:7'></a>\nLooks good.  Positive review.\n\nDoes this mean that we should make `--jsmath` the default for building html docs?  It's much faster than building without using jsmath.",
    "created_at": "2009-06-27T17:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38322",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
Looks good.  Positive review.

Does this mean that we should make `--jsmath` the default for building html docs?  It's much faster than building without using jsmath.



---

archive/issue_comments_038323.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@jhpalmieri](#comment%3A7):\n> Does this mean that we should make `--jsmath` the default for building html docs?  It's much faster than building without using jsmath.\n\nI think `\\QQ` and friends generate an unsightly error message.  I'll try to learn how to make an spkg, for #4714 and #5447.",
    "created_at": "2009-06-27T22:39:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38323",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'></a>
Replying to [@jhpalmieri](#comment%3A7):
> Does this mean that we should make `--jsmath` the default for building html docs?  It's much faster than building without using jsmath.

I think `\QQ` and friends generate an unsightly error message.  I'll try to learn how to make an spkg, for #4714 and #5447.



---

archive/issue_comments_038324.json:
```json
{
    "body": "**Merged:** sage-4.1.rc0",
    "created_at": "2009-07-04T01:40:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38324",
    "user": "https://github.com/rlmill"
}
```

**Merged:** sage-4.1.rc0



---

archive/issue_events_056993.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-04T01:40:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56993"
}
```



---

archive/issue_events_056994.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-04T01:40:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56994"
}
```



---

archive/issue_comments_038325.json:
```json
{
    "body": "<a id='comment:10'></a>\nIn order to get the `sage -sdist` command to work after applying this patch, I had to copy all of the files over to `doc/common/static` as actual files, since something in the build system could not find the files as links. I will post the extra patch on this ticket, which was necessary to roll `sage-4.1.rc0`.",
    "created_at": "2009-07-04T21:10:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38325",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:10'></a>
In order to get the `sage -sdist` command to work after applying this patch, I had to copy all of the files over to `doc/common/static` as actual files, since something in the build system could not find the files as links. I will post the extra patch on this ticket, which was necessary to roll `sage-4.1.rc0`.



---

archive/issue_comments_038326.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis is what happened:\n\n```\n[geom sage-4.1.alpha3]$ ./sage -sdist 4.1.rc0\nUpdating Cython code....\nTime to execute 0 commands: 1.50203704834e-05 seconds\nFinished compiling Cython code (time = 0.324697971344 seconds)\nrunning install\nrunning build\nrunning build_py\ncopying sage/version.py -> build/lib.linux-x86_64-2.6/sage\nrunning build_ext\nTotal time spent compiling C/C++ extensions:  0.00903582572937 seconds.\nrunning install_lib\ncopying build/lib.linux-x86_64-2.6/sage/version.py -> /space/rlm/sage-4.1.alpha3/local/lib/python2.6/site-packages/sage\nbyte-compiling /space/rlm/sage-4.1.alpha3/local/lib/python2.6/site-packages/sage/version.py to version.pyc\nrunning install_egg_info\nWriting /space/rlm/sage-4.1.alpha3/local/lib/python2.6/site-packages/sage-4.1.rc0-py2.6.egg-info\ncp: cannot stat `*.sage': No such file or directory\ncp: cannot stat `ipythonrc': No such file or directory\ncp: cannot stat `spkg/update': No such file or directory\nrm: cannot remove `doc-*.spkg': No such file or directory\ndiff -r f307132d9d7c sage/version.py\n--- a/sage/version.py   Thu Jul 02 11:52:36 2009 +0200\n+++ b/sage/version.py   Sat Jul 04 12:58:13 2009 -0700\n@@ -1,2 +1,2 @@\n \"\"\"nodoctests\"\"\"\n-version='4.1.alpha3'; date='2009-07-02'\n+version='4.1.rc0'; date='2009-07-04'\nM sage/version.py\ncp: cannot stat `build.py': No such file or directory\ncp: cannot stat `clib.py': No such file or directory\ncp: cannot stat `sagebuild.py': No such file or directory\ncp: warning: source file `spkg-delauto' specified more than once\ncp: cannot stat `debian': No such file or directory\nrm: cannot remove `c_lib/*.so': No such file or directory\nrm: cannot remove `c_lib/*.os': No such file or directory\nDeleting autogenerated file ./matrix/matrix_rational_dense.c\n\n...<SNIP>...\n\nDeleting autogenerated file ./algebras/quatalg/quaternion_algebra_cython.cpp\nrunning sdist\nerror: doc/common/static/sageicon.png: No such file or directory\n./spkg-dist: line 54: cd: dist: No such file or directory\ngzip: sage-4.1.rc0.tar.gz: No such file or directory\nbzip2: Can't open input file sage-4.1.rc0.tar: No such file or directory.\nmv: cannot stat `sage-4.1.rc0.tar.bz2': No such file or directory\nmv: cannot stat `dist/sage-4.1.rc0.spkg': No such file or directory\nThe package sage-4.1.rc0.spkg wasn't created.\nError building the Sage packages.\n```\n\nNo point in posting a huge patch, so here is a link:\n\nhttp://sage.math.washington.edu/home/rlmill/trac_5799-unlink.patch",
    "created_at": "2009-07-04T21:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38326",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:11'></a>
This is what happened:

```
[geom sage-4.1.alpha3]$ ./sage -sdist 4.1.rc0
Updating Cython code....
Time to execute 0 commands: 1.50203704834e-05 seconds
Finished compiling Cython code (time = 0.324697971344 seconds)
running install
running build
running build_py
copying sage/version.py -> build/lib.linux-x86_64-2.6/sage
running build_ext
Total time spent compiling C/C++ extensions:  0.00903582572937 seconds.
running install_lib
copying build/lib.linux-x86_64-2.6/sage/version.py -> /space/rlm/sage-4.1.alpha3/local/lib/python2.6/site-packages/sage
byte-compiling /space/rlm/sage-4.1.alpha3/local/lib/python2.6/site-packages/sage/version.py to version.pyc
running install_egg_info
Writing /space/rlm/sage-4.1.alpha3/local/lib/python2.6/site-packages/sage-4.1.rc0-py2.6.egg-info
cp: cannot stat `*.sage': No such file or directory
cp: cannot stat `ipythonrc': No such file or directory
cp: cannot stat `spkg/update': No such file or directory
rm: cannot remove `doc-*.spkg': No such file or directory
diff -r f307132d9d7c sage/version.py
--- a/sage/version.py   Thu Jul 02 11:52:36 2009 +0200
+++ b/sage/version.py   Sat Jul 04 12:58:13 2009 -0700
@@ -1,2 +1,2 @@
 """nodoctests"""
-version='4.1.alpha3'; date='2009-07-02'
+version='4.1.rc0'; date='2009-07-04'
M sage/version.py
cp: cannot stat `build.py': No such file or directory
cp: cannot stat `clib.py': No such file or directory
cp: cannot stat `sagebuild.py': No such file or directory
cp: warning: source file `spkg-delauto' specified more than once
cp: cannot stat `debian': No such file or directory
rm: cannot remove `c_lib/*.so': No such file or directory
rm: cannot remove `c_lib/*.os': No such file or directory
Deleting autogenerated file ./matrix/matrix_rational_dense.c

...<SNIP>...

Deleting autogenerated file ./algebras/quatalg/quaternion_algebra_cython.cpp
running sdist
error: doc/common/static/sageicon.png: No such file or directory
./spkg-dist: line 54: cd: dist: No such file or directory
gzip: sage-4.1.rc0.tar.gz: No such file or directory
bzip2: Can't open input file sage-4.1.rc0.tar: No such file or directory.
mv: cannot stat `sage-4.1.rc0.tar.bz2': No such file or directory
mv: cannot stat `dist/sage-4.1.rc0.spkg': No such file or directory
The package sage-4.1.rc0.spkg wasn't created.
Error building the Sage packages.
```

No point in posting a huge patch, so here is a link:

http://sage.math.washington.edu/home/rlmill/trac_5799-unlink.patch



---

archive/issue_comments_038327.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe new patch seems to have the same observable effect as the previous set in the usual browsers on Linux and Windows XP.  But the AMS symbol font `msbm10` won't be available in the static and offline docs.\n\nI'll venture that having extra copies of the favicons and logo in the Sage tree is not a big deal.  Ideally, jsMath should have a single home, e.g., so that planned changes (cf. #4714) to `easy/load.js` affect the live, static, and offline docs equally.\n\nPerhaps we can make the symbolic link itself in jsMath's `spkg-install`.  Does this mean we should remove the link from version control?  If so, we're [almost] done.",
    "created_at": "2009-07-05T23:26:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38327",
    "user": "https://github.com/qed777"
}
```

<a id='comment:12'></a>
The new patch seems to have the same observable effect as the previous set in the usual browsers on Linux and Windows XP.  But the AMS symbol font `msbm10` won't be available in the static and offline docs.

I'll venture that having extra copies of the favicons and logo in the Sage tree is not a big deal.  Ideally, jsMath should have a single home, e.g., so that planned changes (cf. #4714) to `easy/load.js` affect the live, static, and offline docs equally.

Perhaps we can make the symbolic link itself in jsMath's `spkg-install`.  Does this mean we should remove the link from version control?  If so, we're [almost] done.



---

archive/issue_comments_038328.json:
```json
{
    "body": "<a id='comment:13'></a>\nI'm worried, since a fresh install of sage-4.1.rc0 is missing most of these files in `doc/common/static`:\n\n```\n[geom sage-main]$ cd doc/common/static/\n[geom static]$ ls\ntotal 4.0K\ndrwxr-xr-x 3 rlmill rlmill 4.0K 2009-07-04 14:18 jsmath\n[geom static]$ ls jsmath\ntotal 16K\n-rw-r--r-- 1 rlmill rlmill  12K 2009-07-04 14:13 COPYING.txt\ndrwxr-xr-x 3 rlmill rlmill 4.0K 2009-07-04 14:18 fonts\n```\n\nHas anyone tested a fresh build of sage-4.1.rc0 to see if things related to this ticket work?",
    "created_at": "2009-07-07T18:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38328",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:13'></a>
I'm worried, since a fresh install of sage-4.1.rc0 is missing most of these files in `doc/common/static`:

```
[geom sage-main]$ cd doc/common/static/
[geom static]$ ls
total 4.0K
drwxr-xr-x 3 rlmill rlmill 4.0K 2009-07-04 14:18 jsmath
[geom static]$ ls jsmath
total 16K
-rw-r--r-- 1 rlmill rlmill  12K 2009-07-04 14:13 COPYING.txt
drwxr-xr-x 3 rlmill rlmill 4.0K 2009-07-04 14:18 fonts
```

Has anyone tested a fresh build of sage-4.1.rc0 to see if things related to this ticket work?



---

archive/issue_comments_038329.json:
```json
{
    "body": "<a id='comment:14'></a>\nI'm seriously thinking about reverting this ticket, since there are obviously some assumptions the sdist script is making, which are conflicting with the solutions used for this patch. For now, I'm reopening the ticket, until I can get this resolved one way or another.",
    "created_at": "2009-07-07T18:58:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38329",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:14'></a>
I'm seriously thinking about reverting this ticket, since there are obviously some assumptions the sdist script is making, which are conflicting with the solutions used for this patch. For now, I'm reopening the ticket, until I can get this resolved one way or another.



---

archive/issue_comments_038330.json:
```json
{
    "body": "**Attachment:** [trac_5799_manifest.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_manifest.patch.gz)",
    "created_at": "2009-07-07T19:40:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38330",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_5799_manifest.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799_manifest.patch.gz)



---

archive/issue_comments_038331.json:
```json
{
    "body": "<a id='comment:15'></a>\nThis is a bit of a shot in the dark, but does trac_5799_manifest.patch help?",
    "created_at": "2009-07-07T19:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38331",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
This is a bit of a shot in the dark, but does trac_5799_manifest.patch help?



---

archive/issue_comments_038332.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [@jhpalmieri](#comment%3A15):\n> This is a bit of a shot in the dark, but does trac_5799_manifest.patch help?\n\nI think this is what I was looking for. Thank you!",
    "created_at": "2009-07-07T19:55:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38332",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:16'></a>
Replying to [@jhpalmieri](#comment%3A15):
> This is a bit of a shot in the dark, but does trac_5799_manifest.patch help?

I think this is what I was looking for. Thank you!



---

archive/issue_events_056995.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-07T21:22:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5799#event-56995"
}
```



---

archive/issue_comments_038333.json:
```json
{
    "body": "<a id='comment:17'></a>\n`trac_5799_manifest.patch` merged in sage-4.1.rc1",
    "created_at": "2009-07-07T21:22:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38333",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:17'></a>
`trac_5799_manifest.patch` merged in sage-4.1.rc1



---

archive/issue_comments_038334.json:
```json
{
    "body": "<a id='comment:18'></a>\nAs suggested by William, the `MANIFEST.in` changes were reverted to just adding the line `recursive-include doc/common/static *`.\n\nhttp://docs.python.org/distutils/commandref.html#sdist-cmd",
    "created_at": "2009-07-08T01:55:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38334",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:18'></a>
As suggested by William, the `MANIFEST.in` changes were reverted to just adding the line `recursive-include doc/common/static *`.

http://docs.python.org/distutils/commandref.html#sdist-cmd



---

archive/issue_comments_038335.json:
```json
{
    "body": "**Changing author** from \"Mitesh Patel\" to \"Mitesh Patel, John Palmieri\".",
    "created_at": "2009-07-08T06:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38335",
    "user": "https://github.com/sagetrac-mvngu"
}
```

**Changing author** from "Mitesh Patel" to "Mitesh Patel, John Palmieri".



---

archive/issue_comments_038336.json:
```json
{
    "body": "**Changing reviewer** from \"John Palmieri\" to \"John Palmieri, Robert Miller\".",
    "created_at": "2009-07-08T06:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38336",
    "user": "https://github.com/sagetrac-mvngu"
}
```

**Changing reviewer** from "John Palmieri" to "John Palmieri, Robert Miller".



---

archive/issue_comments_038337.json:
```json
{
    "body": "<a id='comment:20'></a>\nIs it possible to include symbolic links in `MANIFEST.in`?  Unless I'm wrong, we now have jsMath installed in `doc/common/static` **and** `javascript_local`.  Do we really want this?  Besides putting upstream code under version control in the Sage library, this complicates, e.g., the resolution of #4714.",
    "created_at": "2009-07-19T06:51:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38337",
    "user": "https://github.com/qed777"
}
```

<a id='comment:20'></a>
Is it possible to include symbolic links in `MANIFEST.in`?  Unless I'm wrong, we now have jsMath installed in `doc/common/static` **and** `javascript_local`.  Do we really want this?  Besides putting upstream code under version control in the Sage library, this complicates, e.g., the resolution of #4714.



---

archive/issue_comments_038338.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [@qed777](#comment%3A20):\n> Is it possible to include symbolic links in `MANIFEST.in`?\n\nI had wondered this myself. The only way to know for sure is to try it, roll a new source tarball (via `sage -sdist`), install the \"new version,\" and see whether the notebook still works...",
    "created_at": "2009-07-20T14:44:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38338",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:21'></a>
Replying to [@qed777](#comment%3A20):
> Is it possible to include symbolic links in `MANIFEST.in`?

I had wondered this myself. The only way to know for sure is to try it, roll a new source tarball (via `sage -sdist`), install the "new version," and see whether the notebook still works...



---

archive/issue_comments_038339.json:
```json
{
    "body": "Attempt to get distutils to preserve symbolic links.",
    "created_at": "2009-07-21T10:52:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38339",
    "user": "https://github.com/qed777"
}
```

Attempt to get distutils to preserve symbolic links.



---

archive/issue_comments_038340.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Attachment:** [trac_5799-redux_setup_py.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799-redux_setup_py.patch.gz)\n\nReplying to [@rlmill](#comment%3A21):\n> Replying to [@qed777](#comment%3A20):\n> > Is it possible to include symbolic links in `MANIFEST.in`?\n\n> I had wondered this myself. The only way to know for sure is to try it, roll a new source tarball (via `sage -sdist`), install the \"new version,\" and see whether the notebook still works...\n\nThis [patch](https://github.com/sagemath/sage/files/ticket5799/trac_5799-redux_setup_py.patch) alters `setup.py` so that it preserves symlinks.  However, I'm far from convinced that it's the right approach.  Is it possible to identify and copy broken links in Python?  In particular:\n\n* In `sage_findall()`, can we refine or avoid using the exception handler?  Perhaps it's better to use [os.walk()](http://markmail.org/message/dcv4g5b2b4exw64u), but the `os.path.is*()` family actually follows symlinks.\n* Is there a Pythonic analogue of `cp --preserve=links --no-dereference`?\n\nPossible alternatives:\n\n* Make a symlink in some `spkg-install`.\n* Have Mercurial reconstitute the link.",
    "created_at": "2009-07-21T11:28:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38340",
    "user": "https://github.com/qed777"
}
```

<a id='comment:22'></a>
**Attachment:** [trac_5799-redux_setup_py.patch.gz](https://github.com/sagemath/sage/files/ticket5799/trac_5799-redux_setup_py.patch.gz)

Replying to [@rlmill](#comment%3A21):
> Replying to [@qed777](#comment%3A20):
> > Is it possible to include symbolic links in `MANIFEST.in`?

> I had wondered this myself. The only way to know for sure is to try it, roll a new source tarball (via `sage -sdist`), install the "new version," and see whether the notebook still works...

This [patch](https://github.com/sagemath/sage/files/ticket5799/trac_5799-redux_setup_py.patch) alters `setup.py` so that it preserves symlinks.  However, I'm far from convinced that it's the right approach.  Is it possible to identify and copy broken links in Python?  In particular:

* In `sage_findall()`, can we refine or avoid using the exception handler?  Perhaps it's better to use [os.walk()](http://markmail.org/message/dcv4g5b2b4exw64u), but the `os.path.is*()` family actually follows symlinks.
* Is there a Pythonic analogue of `cp --preserve=links --no-dereference`?

Possible alternatives:

* Make a symlink in some `spkg-install`.
* Have Mercurial reconstitute the link.



---

archive/issue_comments_038341.json:
```json
{
    "body": "<a id='comment:23'></a>\nWe really need to create a new ticket for this issue and continue there. I would also suggest taking this up on sage-devel.",
    "created_at": "2009-07-21T14:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38341",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:23'></a>
We really need to create a new ticket for this issue and continue there. I would also suggest taking this up on sage-devel.



---

archive/issue_comments_038342.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [@rlmill](#comment%3A23):\n> We really need to create a new ticket for this issue and continue there. I would also suggest taking this up on sage-devel.\n\nI've opened #6614.",
    "created_at": "2009-07-24T15:17:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5799#issuecomment-38342",
    "user": "https://github.com/qed777"
}
```

<a id='comment:24'></a>
Replying to [@rlmill](#comment%3A23):
> We really need to create a new ticket for this issue and continue there. I would also suggest taking this up on sage-devel.

I've opened #6614.
