# Issue 5211: add charset header to worksheet html header

archive/issues_005211.json:
```json
{
    "assignees": [
        "https://github.com/boothby"
    ],
    "body": "Right now, the html generated for a worksheet does not include a header specifying the encoding, which confuses browsers: http://groups.google.com/group/sage-support/t/3d4b400f5afe66fb\n\nAs suggested by the OP of that thread, we should add\n\n```\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n```\nto the worksheet html.\n\nCC:  @mwhansen\n\nComponent: **notebook**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5211_\n\n",
    "closed_at": "2009-03-23T21:36:33Z",
    "created_at": "2009-02-09T04:04:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.4.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "add charset header to worksheet html header",
    "type": "issue",
    "updated_at": "2009-03-23T21:36:33Z",
    "url": "https://github.com/sagemath/sage/issues/5211",
    "user": "https://github.com/dandrake"
}
```
Right now, the html generated for a worksheet does not include a header specifying the encoding, which confuses browsers: http://groups.google.com/group/sage-support/t/3d4b400f5afe66fb

As suggested by the OP of that thread, we should add

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
```
to the worksheet html.

CC:  @mwhansen

Component: **notebook**

_Issue created by migration from https://trac.sagemath.org/ticket/5211_





---

archive/issue_events_060397.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2009-02-09T04:04:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60397"
}
```



---

archive/issue_events_060398.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2009-02-09T04:04:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60398"
}
```



---

archive/issue_events_060399.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2009-02-09T04:04:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60399"
}
```



---

archive/issue_events_060400.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2009-02-09T04:04:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60400"
}
```



---

archive/issue_events_060401.json:
```json
{
    "actor": "https://github.com/boothby",
    "created_at": "2009-02-09T04:04:50Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "subject": "https://github.com/dandrake",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60401"
}
```



---

archive/issue_comments_031911.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe attached patch (trac_5211.patch) adds Content-Type headers to (I think) all of the pages generated by the notebook server...but it seems like to be sure, we should also get Twisted to add Content-Type headers to its HTTP response. I poked around trying to figure out how to do that, but I don't know enough about that side of things to change it appropriately.\n\nAlso, this ticket is closely related to #1477 and #2896.\n\nAnd here's a W3C page on character encodings: http://www.w3.org/International/O-charset",
    "created_at": "2009-02-09T07:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31911",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:1" align="right">comment:1</div>

The attached patch (trac_5211.patch) adds Content-Type headers to (I think) all of the pages generated by the notebook server...but it seems like to be sure, we should also get Twisted to add Content-Type headers to its HTTP response. I poked around trying to figure out how to do that, but I don't know enough about that side of things to change it appropriately.

Also, this ticket is closely related to #1477 and #2896.

And here's a W3C page on character encodings: http://www.w3.org/International/O-charset



---

archive/issue_events_060402.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T06:48:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60402"
}
```



---

archive/issue_events_060403.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T06:48:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60403"
}
```



---

archive/issue_events_060404.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T06:48:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60404"
}
```



---

archive/issue_comments_031912.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis would be nice to get into 3.3 since it causes trouble for IE users.\n\nDan: Please make sure to mark tickets with patches appropriately so that they get picked up by the right reports.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-10T06:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31912",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:2" align="right">comment:2</div>

This would be nice to get into 3.3 since it causes trouble for IE users.

Dan: Please make sure to mark tickets with patches appropriately so that they get picked up by the right reports.

Cheers,

Michael



---

archive/issue_events_060405.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T06:48:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60405"
}
```



---

archive/issue_events_060406.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T06:48:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60406"
}
```



---

archive/issue_comments_031913.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nMike, \n\nit would be nice if you could review this.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-10T06:49:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31913",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:3" align="right">comment:3</div>

Mike, 

it would be nice if you could review this.

Cheers,

Michael



---

archive/issue_comments_031914.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@sagetrac-mabshoff](#comment%3A2):\n> This would be nice to get into 3.3 since it causes trouble for IE users.\n> \n> Dan: Please make sure to mark tickets with patches appropriately so that they get picked up by the right reports.\n\nOkay. I set the milestone to 3.4.1 because I wasn't sure if you were still considering these kinds of tickets for 3.3, and I didn't add a \"[with patch, needs review]\" because it's not quite done -- we also need to get Twisted to add the correct header, and I don't know how to do that. I was going to ping some of the usual notebook suspects and ask for some help. I see you've already done that. :)\n\nAlso, before we charge ahead and merge this, perhaps we should try and find out if anyone uses notebooks *not* encoded in UTF-8...it seems like we already should be encoding everything UTF-8, but as our continuing problems with accents show, there is some potential for problems to crop up.",
    "created_at": "2009-02-10T06:56:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31914",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@sagetrac-mabshoff](#comment%3A2):
> This would be nice to get into 3.3 since it causes trouble for IE users.
> 
> Dan: Please make sure to mark tickets with patches appropriately so that they get picked up by the right reports.

Okay. I set the milestone to 3.4.1 because I wasn't sure if you were still considering these kinds of tickets for 3.3, and I didn't add a "[with patch, needs review]" because it's not quite done -- we also need to get Twisted to add the correct header, and I don't know how to do that. I was going to ping some of the usual notebook suspects and ask for some help. I see you've already done that. :)

Also, before we charge ahead and merge this, perhaps we should try and find out if anyone uses notebooks *not* encoded in UTF-8...it seems like we already should be encoding everything UTF-8, but as our continuing problems with accents show, there is some potential for problems to crop up.



---

archive/issue_comments_031915.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOk, if it isn't ready it should be marked as such. Any ticket with a patch should have the \"with patch\" marker since there is no way to find tickets with patch otherwise that I am aware of.\n\nIt sounds like this ticket will miss the boat in 3.3, but there is another, closely related ticket with patch that needs work at #4547 by Mike, so it seems likely that this will come up again in 3.4 or later. Fixing this once and for all would be nice since it otherwise impedes adopting of Sage in countries where they have funny accents or even dare not to use English at all :) \n\nCheers,\n\nMichael",
    "created_at": "2009-02-10T07:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31915",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:5" align="right">comment:5</div>

Ok, if it isn't ready it should be marked as such. Any ticket with a patch should have the "with patch" marker since there is no way to find tickets with patch otherwise that I am aware of.

It sounds like this ticket will miss the boat in 3.3, but there is another, closely related ticket with patch that needs work at #4547 by Mike, so it seems likely that this will come up again in 3.4 or later. Fixing this once and for all would be nice since it otherwise impedes adopting of Sage in countries where they have funny accents or even dare not to use English at all :) 

Cheers,

Michael



---

archive/issue_events_060407.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T07:00:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60407"
}
```



---

archive/issue_events_060408.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T07:00:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60408"
}
```



---

archive/issue_events_060409.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-02-10T07:00:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "title_is": "[not ready review] add charset header to worksheet html header",
    "title_was": "add charset header to worksheet html header",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60409"
}
```



---

archive/issue_comments_031916.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAh, #4547 is exactly what I was looking for.",
    "created_at": "2009-02-10T09:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31916",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:6" align="right">comment:6</div>

Ah, #4547 is exactly what I was looking for.



---

archive/issue_comments_031917.json:
```json
{
    "body": "Attachment: **[trac_5211.patch.gz](https://github.com/sagemath/sage/files/ticket5211/trac_5211.patch.gz)**",
    "created_at": "2009-03-02T06:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31917",
    "user": "https://github.com/dandrake"
}
```

Attachment: **[trac_5211.patch.gz](https://github.com/sagemath/sage/files/ticket5211/trac_5211.patch.gz)**



---

archive/issue_comments_031918.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI've attached a new version of the patch, rebased against 3.4.alpha0.",
    "created_at": "2009-03-02T06:52:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31918",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:7" align="right">comment:7</div>

I've attached a new version of the patch, rebased against 3.4.alpha0.



---

archive/issue_events_060410.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-03-19T12:02:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "title_is": "add charset header to worksheet html header",
    "title_was": "[not ready review] add charset header to worksheet html header",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60410"
}
```



---

archive/issue_events_060411.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-03-19T12:02:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60411"
}
```



---

archive/issue_events_060412.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-03-19T12:02:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60412"
}
```



---

archive/issue_comments_031919.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSince #4547 was what Dan needed, I can give this a positive review.",
    "created_at": "2009-03-19T12:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31919",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:8" align="right">comment:8</div>

Since #4547 was what Dan needed, I can give this a positive review.



---

archive/issue_events_060413.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-23T21:36:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60413"
}
```



---

archive/issue_events_060414.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-23T21:36:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60414"
}
```



---

archive/issue_comments_031920.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nMerged in Sage 3.4.1.alpha0.\n\nCheers,\n\nMichael",
    "created_at": "2009-03-23T21:36:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5211#issuecomment-31920",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:9" align="right">comment:9</div>

Merged in Sage 3.4.1.alpha0.

Cheers,

Michael



---

archive/issue_events_060415.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-23T21:36:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60415"
}
```



---

archive/issue_events_060416.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-03-23T21:36:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5211",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5211#event-60416"
}
```
