# Issue 5967: [with patch, positive review] ElementWrapper: A class for wrapping Sage or Python objects as Sage elements

archive/issues_005967.json:
```json
{
    "body": "This patch implements a simple class ElementWrapper for wrapping Sage\nor Python objects as Sage elements, with reasonable default\nimplementations of repr, cmp, hash, etc. The typical use case is for\ntrivially constructing new element classes from preexisting Sage or\nPython classes, with a containment relation.\n\nThis class is used extensively in the examples of the upcoming category framework patch #5891.\n\n\nAssignee: @nthiery\n\nCC:  sage-combinat\n\nReviewer: Anne Schilling, Robert Bradshaw\n\nAuthor: Nicolas M. Thi\u00e9ry\n\nMerged: 4.0.1.alpha0\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/5967\n\n",
    "closed_at": "2009-05-31T23:40:42Z",
    "created_at": "2009-05-03T01:26:19Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.0.1",
    "title": "[with patch, positive review] ElementWrapper: A class for wrapping Sage or Python objects as Sage elements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5967",
    "user": "https://github.com/nthiery"
}
```
This patch implements a simple class ElementWrapper for wrapping Sage
or Python objects as Sage elements, with reasonable default
implementations of repr, cmp, hash, etc. The typical use case is for
trivially constructing new element classes from preexisting Sage or
Python classes, with a containment relation.

This class is used extensively in the examples of the upcoming category framework patch #5891.


Assignee: @nthiery

CC:  sage-combinat

Reviewer: Anne Schilling, Robert Bradshaw

Author: Nicolas M. Thi√©ry

Merged: 4.0.1.alpha0

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/5967





---

archive/issue_comments_052101.json:
```json
{
    "body": "<a id='comment:1'></a>This is broken:\n\n```\n \t129\t            sage: cmp(l11, l12), cmp(l12, l11)   # values differ \n \t130\t            (-1, 1) \n \t131\t            sage: cmp(l11, l21), cmp(l21, l11)   # parents differ \n \t132\t            (-1, 1) \n```\n**Never** check the return value of `cmp` to be -1 or 1, but always write\n\n```\nsage: cmp(l11, l21) in [-1,1]\nTrue\n```\nsince the value depends on memory location. I have had to fix this literally dozens of times in doctests.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-03T01:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52101",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:1'></a>This is broken:

```
 	129	            sage: cmp(l11, l12), cmp(l12, l11)   # values differ 
 	130	            (-1, 1) 
 	131	            sage: cmp(l11, l21), cmp(l21, l11)   # parents differ 
 	132	            (-1, 1) 
```
**Never** check the return value of `cmp` to be -1 or 1, but always write

```
sage: cmp(l11, l21) in [-1,1]
True
```
since the value depends on memory location. I have had to fix this literally dozens of times in doctests.

Cheers,

Michael



---

archive/issue_comments_052102.json:
```json
{
    "body": "<a id='comment:2'></a>This ticket also needs to be properly market with a marker so it is picked up for review.\n\nAnother thing to fix is to get this file into the documentation. Unless it is in the documentation the vast majority of people will never know of its existence. Current policy is that every file that is well documented and 100% doctested belongs in the documentation. \n\nCheers,\n\nMichael",
    "created_at": "2009-05-03T01:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52102",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>This ticket also needs to be properly market with a marker so it is picked up for review.

Another thing to fix is to get this file into the documentation. Unless it is in the documentation the vast majority of people will never know of its existence. Current policy is that every file that is well documented and 100% doctested belongs in the documentation. 

Cheers,

Michael



---

archive/issue_comments_052103.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:1 mabshoff]:\n> This is broken:\n> \n> ```\n>  \t129\t            sage: cmp(l11, l12), cmp(l12, l11)   # values differ \n>  \t130\t            (-1, 1) \n>  \t131\t            sage: cmp(l11, l21), cmp(l21, l11)   # parents differ \n>  \t132\t            (-1, 1) \n> ```\n> **Never** check the return value of `cmp` to be -1 or 1, but always write\n> \n> ```\n> sage: cmp(l11, l21) in [-1,1]\n> True\n> ```\n> since the value depends on memory location. I have had to fix this literally dozens of times in doctests.\n\n\nOk, will do.",
    "created_at": "2009-05-03T02:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52103",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:3'></a>Replying to [comment:1 mabshoff]:
> This is broken:
> 
> ```
>  	129	            sage: cmp(l11, l12), cmp(l12, l11)   # values differ 
>  	130	            (-1, 1) 
>  	131	            sage: cmp(l11, l21), cmp(l21, l11)   # parents differ 
>  	132	            (-1, 1) 
> ```
> **Never** check the return value of `cmp` to be -1 or 1, but always write
> 
> ```
> sage: cmp(l11, l21) in [-1,1]
> True
> ```
> since the value depends on memory location. I have had to fix this literally dozens of times in doctests.


Ok, will do.



---

archive/issue_comments_052104.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:2 mabshoff]:\n> This ticket also needs to be properly market with a marker so it is picked up for review.\n\n\nAny suggestion for that marker?\n\n> Another thing to fix is to get this file into the documentation. Unless it is in the documentation the vast majority of people will never know of its existence. Current policy is that every file that is well documented and 100% doctested belongs in the documentation. \n\n\nOk, will do.",
    "created_at": "2009-05-03T02:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52104",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:4'></a>Replying to [comment:2 mabshoff]:
> This ticket also needs to be properly market with a marker so it is picked up for review.


Any suggestion for that marker?

> Another thing to fix is to get this file into the documentation. Unless it is in the documentation the vast majority of people will never know of its existence. Current policy is that every file that is well documented and 100% doctested belongs in the documentation. 


Ok, will do.



---

archive/issue_comments_052105.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 nthiery]:\n> Replying to [comment:2 mabshoff]:\n> > This ticket also needs to be properly market with a marker so it is picked up for review.\n\n> \n> Any suggestion for that marker?\n\n\nI meant the standard \"[with patch, needs review]\" :)\n\nCheers,\n\nMichael",
    "created_at": "2009-05-03T02:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52105",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>Replying to [comment:4 nthiery]:
> Replying to [comment:2 mabshoff]:
> > This ticket also needs to be properly market with a marker so it is picked up for review.

> 
> Any suggestion for that marker?


I meant the standard "[with patch, needs review]" :)

Cheers,

Michael



---

archive/issue_comments_052106.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 mabshoff]:\n> I meant the standard \"[with patch, needs review]\" :)\n\n\nOops, I was sure I had done this!",
    "created_at": "2009-05-03T02:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52106",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:6'></a>Replying to [comment:5 mabshoff]:
> I meant the standard "[with patch, needs review]" :)


Oops, I was sure I had done this!



---

archive/issue_comments_052107.json:
```json
{
    "body": "<a id='comment:7'></a>Done, and patch updated. Thanks Michael for your suggestions.",
    "created_at": "2009-05-03T03:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52107",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:7'></a>Done, and patch updated. Thanks Michael for your suggestions.



---

archive/issue_comments_052108.json:
```json
{
    "body": "<a id='comment:8'></a>The tests of the patch pass when applied to sage-3.4.2.\n\nBesides the application to the category framework #5891,\nthis patch will be useful for crystals. For example the\nclass Letter(Element):\nin /combinat/crystals/letters.py\ncan be shortened by inheriting from ElementWrapper.\n\nI give this patch a positive review!",
    "created_at": "2009-05-07T03:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52108",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:8'></a>The tests of the patch pass when applied to sage-3.4.2.

Besides the application to the category framework #5891,
this patch will be useful for crystals. For example the
class Letter(Element):
in /combinat/crystals/letters.py
can be shortened by inheriting from ElementWrapper.

I give this patch a positive review!



---

archive/issue_comments_052109.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2009-05-19T06:25:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52109",
    "user": "https://github.com/nthiery"
}
```

Changing status from new to assigned.



---

archive/issue_comments_052110.json:
```json
{
    "body": "<a id='comment:10'></a>Has anybody non-combinat signed off on this? Not that I don't trust Anne, but ... ;)\n\nCheers,\n\nMichael",
    "created_at": "2009-05-22T14:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52110",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:10'></a>Has anybody non-combinat signed off on this? Not that I don't trust Anne, but ... ;)

Cheers,

Michael



---

archive/issue_comments_052111.json:
```json
{
    "body": "<a id='comment:11'></a>The uploaded patch adds a warning about the probable little change of interface in the near future (but after integration of the category patch).\nRobert promised to have a look at this shortly.",
    "created_at": "2009-05-23T07:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52111",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:11'></a>The uploaded patch adds a warning about the probable little change of interface in the near future (but after integration of the category patch).
Robert promised to have a look at this shortly.



---

archive/issue_comments_052112.json:
```json
{
    "body": "<a id='comment:12'></a>I agree this looks good. The only caveat is that the docstring reads \n\n```\nTherefore, ``o`` does inherit the string\n```\n\nwhere it probably should be \"does not.\"",
    "created_at": "2009-05-23T08:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52112",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:12'></a>I agree this looks good. The only caveat is that the docstring reads 

```
Therefore, ``o`` does inherit the string
```

where it probably should be "does not."



---

archive/issue_comments_052113.json:
```json
{
    "body": "Attachment [element_wrapper-5967-submitted.patch](tarball://root/attachments/some-uuid/ticket5967/element_wrapper-5967-submitted.patch) by @nthiery created at 2009-05-23 15:40:38",
    "created_at": "2009-05-23T15:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52113",
    "user": "https://github.com/nthiery"
}
```

Attachment [element_wrapper-5967-submitted.patch](tarball://root/attachments/some-uuid/ticket5967/element_wrapper-5967-submitted.patch) by @nthiery created at 2009-05-23 15:40:38



---

archive/issue_comments_052114.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 robertwb]:\n> I agree this looks good. The only caveat is that the docstring reads \n> \n> \n> ```\n> Therefore, ``o`` does inherit the string\n> ```\n> \n> where it probably should be \"does not.\"\n\n\nOops, indeed! Thanks. Patch updated.",
    "created_at": "2009-05-23T15:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52114",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:13'></a>Replying to [comment:12 robertwb]:
> I agree this looks good. The only caveat is that the docstring reads 
> 
> 
> ```
> Therefore, ``o`` does inherit the string
> ```
> 
> where it probably should be "does not."


Oops, indeed! Thanks. Patch updated.



---

archive/issue_comments_052115.json:
```json
{
    "body": "<a id='comment:14'></a>Merged in 4.0.1.alpha0.",
    "created_at": "2009-05-31T23:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52115",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:14'></a>Merged in 4.0.1.alpha0.



---

archive/issue_comments_052116.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-05-31T23:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52116",
    "user": "https://github.com/mwhansen"
}
```

Resolution: fixed



---

archive/issue_events_014008.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-05-31T23:40:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5967#event-14008"
}
```



---

archive/issue_comments_052117.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Anne Schilling, Robert Bradshaw\"",
    "created_at": "2009-06-06T22:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52117",
    "user": "https://github.com/mwhansen"
}
```

Changing reviewer from "" to "Anne Schilling, Robert Bradshaw"



---

archive/issue_comments_052118.json:
```json
{
    "body": "Changing author from \"\" to \"Nicolas Thiery\"",
    "created_at": "2009-06-06T22:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52118",
    "user": "https://github.com/mwhansen"
}
```

Changing author from "" to "Nicolas Thiery"



---

archive/issue_comments_052119.json:
```json
{
    "body": "Changing merged from \"\" to \"4.0.1.alpha0\"",
    "created_at": "2009-06-06T22:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52119",
    "user": "https://github.com/mwhansen"
}
```

Changing merged from "" to "4.0.1.alpha0"



---

archive/issue_comments_052120.json:
```json
{
    "body": "Changing author from \"Nicolas Thiery\" to \"Nicolas M. Thi\u00e9ry\"",
    "created_at": "2016-08-07T19:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52120",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "Nicolas Thiery" to "Nicolas M. Thi√©ry"



---

archive/issue_comments_052121.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2016-08-07T19:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5967#issuecomment-52121",
    "user": "https://github.com/fchapoton"
}
```

Changing upstream from "" to "N/A"
