# Issue 5958: MPolynomial_polydict.factor() should accept proof parameter

archive/issues_005958.json:
```json
{
    "assignees": [
        "https://github.com/malb"
    ],
    "body": "The parameter should be ignored, but for compatibility it is necessary.\n\nE.g. this should work:\n\n```\nsage: R.<x,y> = CC[]\nsage: I = R.ideal(x^2+y^2-1,x*y-1)\nsage: I.variety()\n```\n\nbut it raises an except in 3.4.1.\n\nCC:  @johnperry-math\n\nKeywords: **singular, factor**\n\nComponent: **commutative algebra**\n\nAuthor: **John Perry**\n\nReviewer: **Martin Albrecht**\n\nMerged: **Sage 4.1.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/5958_\n\n",
    "closed_at": "2009-08-30T12:09:06Z",
    "created_at": "2009-05-01T15:09:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20commutative%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.1.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "MPolynomial_polydict.factor() should accept proof parameter",
    "type": "issue",
    "updated_at": "2009-08-30T12:09:06Z",
    "url": "https://github.com/sagemath/sage/issues/5958",
    "user": "https://github.com/malb"
}
```
The parameter should be ignored, but for compatibility it is necessary.

E.g. this should work:

```
sage: R.<x,y> = CC[]
sage: I = R.ideal(x^2+y^2-1,x*y-1)
sage: I.variety()
```

but it raises an except in 3.4.1.

CC:  @johnperry-math

Keywords: **singular, factor**

Component: **commutative algebra**

Author: **John Perry**

Reviewer: **Martin Albrecht**

Merged: **Sage 4.1.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/5958_





---

archive/issue_events_071217.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:09:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "milestone_number": null,
    "milestone_title": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71217"
}
```



---

archive/issue_events_071218.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20commutative%20algebra",
    "label_color": "0000ff",
    "label_name": "c: commutative algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71218"
}
```



---

archive/issue_events_071219.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71219"
}
```



---

archive/issue_events_071220.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71220"
}
```



---

archive/issue_events_071221.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:09:53Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "subject": "https://github.com/malb",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71221"
}
```



---

archive/issue_events_071222.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71222"
}
```



---

archive/issue_comments_038625.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe patch fixes the exception, however:\n\n```\nsage: sage: R.<x,y> = CC[]\nsage: sage: I = R.ideal(x^2+y^2-1,x*y-1)\nsage: sage: I.variety()\nverbose 0 (1735: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.\n[{y: -1.00000000000000}, {y: 0}, {y: 1.00000000000000}]\n```\n\nwhich is certainly the wrong answer (`x` is missing), thus there seems to be another bug.",
    "created_at": "2009-05-01T15:11:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38625",
    "user": "https://github.com/malb"
}
```

<div id="comment:1" align="right">comment:1</div>

The patch fixes the exception, however:

```
sage: sage: R.<x,y> = CC[]
sage: sage: I = R.ideal(x^2+y^2-1,x*y-1)
sage: sage: I.variety()
verbose 0 (1735: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.
[{y: -1.00000000000000}, {y: 0}, {y: 1.00000000000000}]
```

which is certainly the wrong answer (`x` is missing), thus there seems to be another bug.



---

archive/issue_comments_038626.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIt seems `toy_variety` does not switch to 'lex' when it should?",
    "created_at": "2009-05-01T15:15:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38626",
    "user": "https://github.com/malb"
}
```

<div id="comment:2" align="right">comment:2</div>

It seems `toy_variety` does not switch to 'lex' when it should?



---

archive/issue_comments_038627.json:
```json
{
    "body": "Attachment: **[toy_variety_fix.patch.gz](https://github.com/sagemath/sage/files/ticket5958/toy_variety_fix.patch.gz)**",
    "created_at": "2009-05-01T15:29:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38627",
    "user": "https://github.com/malb"
}
```

Attachment: **[toy_variety_fix.patch.gz](https://github.com/sagemath/sage/files/ticket5958/toy_variety_fix.patch.gz)**



---

archive/issue_events_071223.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-05-01T15:30:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71223"
}
```



---

archive/issue_comments_038628.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe attached patch switches to lex before calling `toy_variety.triangular_factorization`",
    "created_at": "2009-05-01T15:30:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38628",
    "user": "https://github.com/malb"
}
```

<div id="comment:3" align="right">comment:3</div>

The attached patch switches to lex before calling `toy_variety.triangular_factorization`



---

archive/issue_comments_038629.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nTwo issues:\n\n* in the first patch, \"proofably\" should be \"provably\"\n \n* I'm getting some slight numerical noise in the doctests from the second patch:\n\n```\nsage -t  \"devel/sage-main/sage/rings/polynomial/multi_polynomial_ideal.py\"\n**********************************************************************\nFile \"/opt/sage-devel/devel/sage-main/sage/rings/polynomial/multi_polynomial_ideal.py\", line 1908:\n    sage: for v in I.variety():\n       print v\nExpected:\n    verbose 0 (...: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.\n    {y: -0.866025403784439 - 0.500000000000000*I, x: -0.866025403784438 + 0.500000000000000*I}\n    {y: -0.866025403784438 + 0.500000000000000*I, x: -0.866025403784438 - 0.499999999999999*I}\n    {y: 0.866025403784438 + 0.500000000000001*I, x: 0.866025403784440 - 0.499999999999999*I}\n    {y: 0.866025403784439 - 0.500000000000000*I, x: 0.866025403784439 + 0.500000000000000*I}\nGot:\n    verbose 0 (1735: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.\n    {y: -0.866025403784439 - 0.500000000000000*I, x: -0.866025403784439 + 0.500000000000001*I}\n    {y: -0.866025403784439 + 0.500000000000000*I, x: -0.866025403784439 - 0.500000000000000*I}\n    {y: 0.866025403784438 + 0.500000000000000*I, x: 0.866025403784438 - 0.499999999999999*I}\n    {y: 0.866025403784439 - 0.500000000000000*I, x: 0.866025403784438 + 0.500000000000001*I}\n**********************************************************************\n1 items had failures:\n   1 of  36 in __main__.example_34\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /opt/sage-devel/tmp/.doctest_multi_polynomial_ideal.py\n\t [12.8 s]\nexit code: 1024\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t  \"devel/sage-main/sage/rings/polynomial/multi_polynomial_ideal.py\"\nTotal time for all tests: 12.8 seconds\n```",
    "created_at": "2009-05-02T11:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38629",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:4" align="right">comment:4</div>

Two issues:

* in the first patch, "proofably" should be "provably"
 
* I'm getting some slight numerical noise in the doctests from the second patch:

```
sage -t  "devel/sage-main/sage/rings/polynomial/multi_polynomial_ideal.py"
**********************************************************************
File "/opt/sage-devel/devel/sage-main/sage/rings/polynomial/multi_polynomial_ideal.py", line 1908:
    sage: for v in I.variety():
       print v
Expected:
    verbose 0 (...: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.
    {y: -0.866025403784439 - 0.500000000000000*I, x: -0.866025403784438 + 0.500000000000000*I}
    {y: -0.866025403784438 + 0.500000000000000*I, x: -0.866025403784438 - 0.499999999999999*I}
    {y: 0.866025403784438 + 0.500000000000001*I, x: 0.866025403784440 - 0.499999999999999*I}
    {y: 0.866025403784439 - 0.500000000000000*I, x: 0.866025403784439 + 0.500000000000000*I}
Got:
    verbose 0 (1735: multi_polynomial_ideal.py, variety) Warning: falling back to very slow toy implementation.
    {y: -0.866025403784439 - 0.500000000000000*I, x: -0.866025403784439 + 0.500000000000001*I}
    {y: -0.866025403784439 + 0.500000000000000*I, x: -0.866025403784439 - 0.500000000000000*I}
    {y: 0.866025403784438 + 0.500000000000000*I, x: 0.866025403784438 - 0.499999999999999*I}
    {y: 0.866025403784439 - 0.500000000000000*I, x: 0.866025403784438 + 0.500000000000001*I}
**********************************************************************
1 items had failures:
   1 of  36 in __main__.example_34
***Test Failed*** 1 failures.
For whitespace errors, see the file /opt/sage-devel/tmp/.doctest_multi_polynomial_ideal.py
	 [12.8 s]
exit code: 1024
 
----------------------------------------------------------------------
The following tests failed:


	sage -t  "devel/sage-main/sage/rings/polynomial/multi_polynomial_ideal.py"
Total time for all tests: 12.8 seconds
```



---

archive/issue_events_071224.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-05-02T11:26:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71224"
}
```



---

archive/issue_events_071225.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-05-02T11:26:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71225"
}
```



---

archive/issue_comments_038630.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWrong milestone - better luck in Sage 4.0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-03T00:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38630",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:5" align="right">comment:5</div>

Wrong milestone - better luck in Sage 4.0.

Cheers,

Michael



---

archive/issue_events_071226.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-03T00:18:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "milestone_number": null,
    "milestone_title": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71226"
}
```



---

archive/issue_events_071227.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-03T00:18:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "milestone_number": null,
    "milestone_title": "sage-4.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71227"
}
```



---

archive/issue_comments_038631.json:
```json
{
    "body": "fix typo",
    "created_at": "2009-05-07T13:49:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38631",
    "user": "https://github.com/malb"
}
```

fix typo



---

archive/issue_comments_038632.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[mpoly_factor_proof.patch.gz](https://github.com/sagemath/sage/files/ticket5958/mpoly_factor_proof.patch.gz)**\n\nI fixed the \"proofable\" vs. \"provable\" typo. However, I am a bit clueless how to deal with the numerical noise. The `...` works for most of it but not for `0.49999999999` vs. {{{0.500000000}}. Ideas?",
    "created_at": "2009-05-07T13:50:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38632",
    "user": "https://github.com/malb"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[mpoly_factor_proof.patch.gz](https://github.com/sagemath/sage/files/ticket5958/mpoly_factor_proof.patch.gz)**

I fixed the "proofable" vs. "provable" typo. However, I am a bit clueless how to deal with the numerical noise. The `...` works for most of it but not for `0.49999999999` vs. {{{0.500000000}}. Ideas?



---

archive/issue_comments_038633.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nMartin,\n\nSorry for the late reply, but according to Lazard's paper, the algorithm I used (\"Triangular\") does NOT need a lexicographic term ordering. On p. 124, beginning of Section 6:\n\n*These algorithms do not depend explicitly on the ordering; however, they are mainly designed for degree orderings for which the base is more easily obtained; they work also for lexicographic ordering, but, for them, we dispose of a structure theorem which permit us to provide a better algorithm (section 8).*\n\nThe algorithm I implemented was Triangular (line 6). So the switch the lexicographic is unnecessary.\n\nI don't know how to fix the problem with complex coefficients, though.",
    "created_at": "2009-08-21T17:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38633",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:7" align="right">comment:7</div>

Martin,

Sorry for the late reply, but according to Lazard's paper, the algorithm I used ("Triangular") does NOT need a lexicographic term ordering. On p. 124, beginning of Section 6:

*These algorithms do not depend explicitly on the ordering; however, they are mainly designed for degree orderings for which the base is more easily obtained; they work also for lexicographic ordering, but, for them, we dispose of a structure theorem which permit us to provide a better algorithm (section 8).*

The algorithm I implemented was Triangular (line 6). So the switch the lexicographic is unnecessary.

I don't know how to fix the problem with complex coefficients, though.



---

archive/issue_comments_038634.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nIncidentally, I'll look at the problem with the missing x as soon as I finish downloading & compiling the latest Sage. (4.1.1?)",
    "created_at": "2009-08-21T17:45:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38634",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:8" align="right">comment:8</div>

Incidentally, I'll look at the problem with the missing x as soon as I finish downloading & compiling the latest Sage. (4.1.1?)



---

archive/issue_comments_038635.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI have found two bugs. One of them is not solvable from my end, and possibly not at all (others who know more should comment).\n\nThe first one: elim_pol is not always computing the correct polynomial. After removing the switch to lexicographic order, change line 358 (?) of toy_variety.py from\n\n```\n  for each in xrange(len(coeffs)-1):\n```\nto\n\n```\n  for each in xrange(len(coeffs)):\n```\n\nI have no idea why I had it count until the next-to-last element of coeffs; all of them are necessary. I can submit a patch if you like.\n\nHowever: even after this fix, a problem remains: line 292 (?) triangular_factorization tries to compute a Groebner basis of an ideal whose generators **should** have a common solution. This is the source of the 1.0 appearing in the triangular variety. Unfortunately, the computed basis is 1.0, suggesting that the ideal has no common solution! I have an idea why this is happening, but I can't yet say for sure.",
    "created_at": "2009-08-21T21:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38635",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:9" align="right">comment:9</div>

I have found two bugs. One of them is not solvable from my end, and possibly not at all (others who know more should comment).

The first one: elim_pol is not always computing the correct polynomial. After removing the switch to lexicographic order, change line 358 (?) of toy_variety.py from

```
  for each in xrange(len(coeffs)-1):
```
to

```
  for each in xrange(len(coeffs)):
```

I have no idea why I had it count until the next-to-last element of coeffs; all of them are necessary. I can submit a patch if you like.

However: even after this fix, a problem remains: line 292 (?) triangular_factorization tries to compute a Groebner basis of an ideal whose generators **should** have a common solution. This is the source of the 1.0 appearing in the triangular variety. Unfortunately, the computed basis is 1.0, suggesting that the ideal has no common solution! I have an idea why this is happening, but I can't yet say for sure.



---

archive/issue_comments_038636.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nTo follow up, the problem occurs when computing the Groebner basis over CC.\n\nI'll use the example given:\n\nThe Groebner basis computed is [y^3 + x - y, x^2 + y^2 - 1.00000000000000, x*y - 1.00000000000000].\n\nThe result p from elim_pol is y^4 - y^2 + 1.0. (This reflects the bugfix I identified above; it used to return y<sup>4-y</sup>2.)\n\nThe first factor q of p is y - 0.866025403784439 - 0.500000000000000*I.\n\nThe reduction of B modulo q gives us\n\n[x - 0.866025403784438 + 0.500000000000001*I,\n x^2 - 0.499999999999999 + 0.866025403784439*I,\n (0.866025403784439 + 0.500000000000000*I)*x - 1.00000000000000]\n\n**This should be a consistent system:** the first polynomial is a factor of the second, and the solution to the third is *nearly* the same as the solution to the first: 0.866025403784438 - 0.500000000000001*I vs. 0.866025403784438 - 0.500000000000000*I. This appears to be a roundoff/floating point error.\n\nThe system above should produce a Groebner basis with one polynomial, but it returns [1.00000000000000] instead. This is why nothing is coming back for x. Anyone know how to fix it?",
    "created_at": "2009-08-21T22:41:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38636",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:10" align="right">comment:10</div>

To follow up, the problem occurs when computing the Groebner basis over CC.

I'll use the example given:

The Groebner basis computed is [y^3 + x - y, x^2 + y^2 - 1.00000000000000, x*y - 1.00000000000000].

The result p from elim_pol is y^4 - y^2 + 1.0. (This reflects the bugfix I identified above; it used to return y<sup>4-y</sup>2.)

The first factor q of p is y - 0.866025403784439 - 0.500000000000000*I.

The reduction of B modulo q gives us

[x - 0.866025403784438 + 0.500000000000001*I,
 x^2 - 0.499999999999999 + 0.866025403784439*I,
 (0.866025403784439 + 0.500000000000000*I)*x - 1.00000000000000]

**This should be a consistent system:** the first polynomial is a factor of the second, and the solution to the third is *nearly* the same as the solution to the first: 0.866025403784438 - 0.500000000000001*I vs. 0.866025403784438 - 0.500000000000000*I. This appears to be a roundoff/floating point error.

The system above should produce a Groebner basis with one polynomial, but it returns [1.00000000000000] instead. This is why nothing is coming back for x. Anyone know how to fix it?



---

archive/issue_comments_038637.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSorry for the repost, but I had some superscript typos in the previou.\n\nTo follow up, the problem occurs when computing the Groebner basis over CC.\n\nI'll use the example given:\n\nThe Groebner basis computed is [y**3 + x - y, x**2 + y**2 - 1.00000000000000, x*y - 1.00000000000000].\n\nThe result p from elim_pol is y**4 - y**2 + 1.0. (This reflects the bugfix I identified above; it used to return y**4-y**2.)\n\nThe first factor q of p is y - 0.866025403784439 - 0.500000000000000*I.\n\nThe reduction of B modulo q gives us\n\n[x - 0.866025403784438 + 0.500000000000001*I,\n x**2 - 0.499999999999999 + 0.866025403784439*I,\n (0.866025403784439 + 0.500000000000000*I)*x - 1.00000000000000]\n\n**This should be a consistent system:** the first polynomial is a factor of the second, and the solution to the third is *nearly* the same as the solution to the first: 0.866025403784438 - 0.500000000000001*I vs. 0.866025403784438 - 0.500000000000000*I. This appears to be a roundoff/floating point error.\n\nThe system above should produce a Groebner basis with one polynomial, but it returns [1.00000000000000] instead. This is why nothing is coming back for x. Anyone know how to fix it?",
    "created_at": "2009-08-21T22:43:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38637",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:11" align="right">comment:11</div>

Sorry for the repost, but I had some superscript typos in the previou.

To follow up, the problem occurs when computing the Groebner basis over CC.

I'll use the example given:

The Groebner basis computed is [y**3 + x - y, x**2 + y**2 - 1.00000000000000, x*y - 1.00000000000000].

The result p from elim_pol is y**4 - y**2 + 1.0. (This reflects the bugfix I identified above; it used to return y**4-y**2.)

The first factor q of p is y - 0.866025403784439 - 0.500000000000000*I.

The reduction of B modulo q gives us

[x - 0.866025403784438 + 0.500000000000001*I,
 x**2 - 0.499999999999999 + 0.866025403784439*I,
 (0.866025403784439 + 0.500000000000000*I)*x - 1.00000000000000]

**This should be a consistent system:** the first polynomial is a factor of the second, and the solution to the third is *nearly* the same as the solution to the first: 0.866025403784438 - 0.500000000000001*I vs. 0.866025403784438 - 0.500000000000000*I. This appears to be a roundoff/floating point error.

The system above should produce a Groebner basis with one polynomial, but it returns [1.00000000000000] instead. This is why nothing is coming back for x. Anyone know how to fix it?



---

archive/issue_comments_038638.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWell, we should probably just disallow computing a GB over CC anyway, it doesn't really make sense because CC is not realy a field.",
    "created_at": "2009-08-24T11:54:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38638",
    "user": "https://github.com/malb"
}
```

<div id="comment:12" align="right">comment:12</div>

Well, we should probably just disallow computing a GB over CC anyway, it doesn't really make sense because CC is not realy a field.



---

archive/issue_comments_038639.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYou mean CC as implemented, not CC in theory?\n\nI could insert a test for whether the field is CC, and if so raise an exception. That said, the roots we're looking for are algebraic, and so can be described symbolically; i.e., without floating point. So if the polynomial starts from QQ, one could in theory construct the roots. Should the exception just reject the user's input, advise the user to try an extension field, or try to construct one itself?\n\nIs this something I should ask about on sage-devel?",
    "created_at": "2009-08-24T17:49:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38639",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:13" align="right">comment:13</div>

You mean CC as implemented, not CC in theory?

I could insert a test for whether the field is CC, and if so raise an exception. That said, the roots we're looking for are algebraic, and so can be described symbolically; i.e., without floating point. So if the polynomial starts from QQ, one could in theory construct the roots. Should the exception just reject the user's input, advise the user to try an extension field, or try to construct one itself?

Is this something I should ask about on sage-devel?



---

archive/issue_comments_038640.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYes, I mean fixed precision floating point numbers. We could just print a warning? Even if the solutions are algebraic the rounding errors can cause a zero to look like a one.",
    "created_at": "2009-08-24T17:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38640",
    "user": "https://github.com/malb"
}
```

<div id="comment:14" align="right">comment:14</div>

Yes, I mean fixed precision floating point numbers. We could just print a warning? Even if the solutions are algebraic the rounding errors can cause a zero to look like a one.



---

archive/issue_comments_038641.json:
```json
{
    "body": "Attachment: **[variety_CC.patch.gz](https://github.com/sagemath/sage/files/ticket5958/variety_CC.patch.gz)**",
    "created_at": "2009-08-26T17:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38641",
    "user": "https://github.com/johnperry-math"
}
```

Attachment: **[variety_CC.patch.gz](https://github.com/sagemath/sage/files/ticket5958/variety_CC.patch.gz)**



---

archive/issue_comments_038642.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe uploaded patch should incorporate Martin's changes *and* should also provide a warning if the field is CC. I'd still like to find a way to make it work in CC, though.",
    "created_at": "2009-08-26T17:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38642",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:15" align="right">comment:15</div>

The uploaded patch should incorporate Martin's changes *and* should also provide a warning if the field is CC. I'd still like to find a way to make it work in CC, though.



---

archive/issue_comments_038643.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe patch looks good, applies cleanly against 4.1.1 and doctests pass on 64-bit Linux (sage.math). There might be a numerical noise issue (see above) which needs to be addressed.",
    "created_at": "2009-08-26T17:57:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38643",
    "user": "https://github.com/malb"
}
```

<div id="comment:16" align="right">comment:16</div>

The patch looks good, applies cleanly against 4.1.1 and doctests pass on 64-bit Linux (sage.math). There might be a numerical noise issue (see above) which needs to be addressed.



---

archive/issue_comments_038644.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAh, the doctest needs a `::` prepended otherwise, it won't be run.",
    "created_at": "2009-08-26T18:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38644",
    "user": "https://github.com/malb"
}
```

<div id="comment:17" align="right">comment:17</div>

Ah, the doctest needs a `::` prepended otherwise, it won't be run.



---

archive/issue_comments_038645.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nwhich doctest? are you talking about line 1848 of multi_polynomial_ideal.py?",
    "created_at": "2009-08-26T18:48:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38645",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:18" align="right">comment:18</div>

which doctest? are you talking about line 1848 of multi_polynomial_ideal.py?



---

archive/issue_comments_038646.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nYes, the doctest starting at 1851.",
    "created_at": "2009-08-26T19:15:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38646",
    "user": "https://github.com/malb"
}
```

<div id="comment:19" align="right">comment:19</div>

Yes, the doctest starting at 1851.



---

archive/issue_comments_038647.json:
```json
{
    "body": "apply over variety_CC.patch",
    "created_at": "2009-08-26T20:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38647",
    "user": "https://github.com/johnperry-math"
}
```

apply over variety_CC.patch



---

archive/issue_comments_038648.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAttachment: **[variety_CC2.patch.gz](https://github.com/sagemath/sage/files/ticket5958/variety_CC2.patch.gz)**\n\nOkay, double colons on that file. They aren't prepended to the example, though; they appear at the end of line 1849 in the same way as at the end of 1831.\n\nPLEASE tell me this is okay now. Fixing this drove me crazy with hg...",
    "created_at": "2009-08-26T20:50:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38648",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:20" align="right">comment:20</div>

Attachment: **[variety_CC2.patch.gz](https://github.com/sagemath/sage/files/ticket5958/variety_CC2.patch.gz)**

Okay, double colons on that file. They aren't prepended to the example, though; they appear at the end of line 1849 in the same way as at the end of 1831.

PLEASE tell me this is okay now. Fixing this drove me crazy with hg...



---

archive/issue_comments_038649.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nYes, thats correct this way. However, I expect the doctest will now fail on 32-bit systems (it wasn't run before).",
    "created_at": "2009-08-26T21:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38649",
    "user": "https://github.com/malb"
}
```

<div id="comment:21" align="right">comment:21</div>

Yes, thats correct this way. However, I expect the doctest will now fail on 32-bit systems (it wasn't run before).



---

archive/issue_comments_038650.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI believe that my system is running as a 32-bit system. I know that Linux is running as 32-bit; does sage run differently?",
    "created_at": "2009-08-26T22:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38650",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:22" align="right">comment:22</div>

I believe that my system is running as a 32-bit system. I know that Linux is running as 32-bit; does sage run differently?



---

archive/issue_comments_038651.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nNo, if your Linux is 32-bit then your Sage is 32-bit :)",
    "created_at": "2009-08-26T23:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38651",
    "user": "https://github.com/malb"
}
```

<div id="comment:23" align="right">comment:23</div>

No, if your Linux is 32-bit then your Sage is 32-bit :)



---

archive/issue_comments_038652.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nstill no positive review then? :-( what's still needed?",
    "created_at": "2009-08-27T00:28:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38652",
    "user": "https://github.com/johnperry-math"
}
```

<div id="comment:24" align="right">comment:24</div>

still no positive review then? :-( what's still needed?



---

archive/issue_events_071228.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-08-27T09:33:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71228"
}
```



---

archive/issue_events_071229.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-08-27T09:33:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71229"
}
```



---

archive/issue_comments_038653.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSorry, here we go.",
    "created_at": "2009-08-27T09:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38653",
    "user": "https://github.com/malb"
}
```

<div id="comment:25" align="right">comment:25</div>

Sorry, here we go.



---

archive/issue_comments_038654.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nWhich patches should be applied and in what order? The patch `variety_CC.patch` contains all changes made in `mpoly_factor_proof.patch`. Does that mean `mpoly_factor_proof.patch` can be left out?",
    "created_at": "2009-08-30T10:40:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38654",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:26" align="right">comment:26</div>

Which patches should be applied and in what order? The patch `variety_CC.patch` contains all changes made in `mpoly_factor_proof.patch`. Does that mean `mpoly_factor_proof.patch` can be left out?



---

archive/issue_comments_038655.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nIndeed, only `variety_CC.patch` and `variety_CC2.patch` should be applied.",
    "created_at": "2009-08-30T11:43:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38655",
    "user": "https://github.com/malb"
}
```

<div id="comment:27" align="right">comment:27</div>

Indeed, only `variety_CC.patch` and `variety_CC2.patch` should be applied.



---

archive/issue_comments_038656.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nJohn -- Please remember to put a sensible commit message in your patch. It's recommended that you reference the ticket number in the commit message. Merged patches in this order:\n\n1. `variety_CC.patch`\n2. `variety_CC2.patch`",
    "created_at": "2009-08-30T12:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38656",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:28" align="right">comment:28</div>

John -- Please remember to put a sensible commit message in your patch. It's recommended that you reference the ticket number in the commit message. Merged patches in this order:

1. `variety_CC.patch`
2. `variety_CC2.patch`



---

archive/issue_events_071230.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-08-30T12:09:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71230"
}
```



---

archive/issue_events_071231.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-08-30T12:09:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/5958#event-71231"
}
```



---

archive/issue_comments_038657.json:
```json
{
    "body": "Reviewer: **Martin Albrecht**",
    "created_at": "2009-08-30T12:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38657",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Reviewer: **Martin Albrecht**



---

archive/issue_comments_038658.json:
```json
{
    "body": "Merged: **Sage 4.1.2.alpha0**",
    "created_at": "2009-08-30T12:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38658",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Merged: **Sage 4.1.2.alpha0**



---

archive/issue_comments_038659.json:
```json
{
    "body": "Author: **John Perry**",
    "created_at": "2009-08-30T12:09:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/5958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/5958#issuecomment-38659",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Author: **John Perry**
