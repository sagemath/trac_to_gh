# Issue 5280: problem with a subposet coming from an order_filter

archive/issues_005280.json:
```json
{
    "body": "With sage-3.3.rc0:\n\n```\nsage: B = BooleanLattice(3)\nsage: 4 in B\nTrue\nsage: B.principal_order_filter(4)  # all elements >= 4\n[4, 5, 6, 7]\nsage: B.subposet(B.principal_order_filter(4))\nFinite poset containing 4 elements\nsage: show(B.subposet(B.principal_order_filter(4)))\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n...\nNotImplementedError: BUG: sort algorithm for elements of 'Finite lattice containing 8 elements' not implemented\n```\n\nI get the same problem with 'order_filter' instead of 'principal_order_filter', and also for 'order_ideal' (e.g., `show(B.subposet(B.order_ideal([2, 4])))` produces a similar message).  Note, though, that `show(B.subposet(B.principal_order_ideal(4)))` works just fine.\n\n\n\n**CC:**  sage-combinat\n\n**Author:** Franco Saliola\n\n**Reviewer:** Mike Hansen, Robert Miller\n\n**Merged:** sage-4.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/5280\n\n",
    "closed_at": "2009-06-24T10:14:11Z",
    "created_at": "2009-02-15T23:44:24Z",
    "labels": [
        "component: combinatorics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1",
    "title": "problem with a subposet coming from an order_filter",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5280",
    "user": "https://github.com/jhpalmieri"
}
```
With sage-3.3.rc0:

```
sage: B = BooleanLattice(3)
sage: 4 in B
True
sage: B.principal_order_filter(4)  # all elements >= 4
[4, 5, 6, 7]
sage: B.subposet(B.principal_order_filter(4))
Finite poset containing 4 elements
sage: show(B.subposet(B.principal_order_filter(4)))
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
...
NotImplementedError: BUG: sort algorithm for elements of 'Finite lattice containing 8 elements' not implemented
```

I get the same problem with 'order_filter' instead of 'principal_order_filter', and also for 'order_ideal' (e.g., `show(B.subposet(B.order_ideal([2, 4])))` produces a similar message).  Note, though, that `show(B.subposet(B.principal_order_ideal(4)))` works just fine.



**CC:**  sage-combinat

**Author:** Franco Saliola

**Reviewer:** Mike Hansen, Robert Miller

**Merged:** sage-4.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/5280





---

archive/attachments_005936.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5280.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5280/trac_5280.patch",
    "created_at": "2009-04-30T09:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/saliola"
}
```



---

archive/issue_comments_043351.json:
```json
{
    "body": "<a id='comment:2'></a>\nI implemented `__cmp__` for poset elements, which deals with these problems.\n\nThe patch depends on #5918.",
    "created_at": "2009-04-30T09:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43351",
    "user": "https://github.com/saliola"
}
```

<a id='comment:2'></a>
I implemented `__cmp__` for poset elements, which deals with these problems.

The patch depends on #5918.



---

archive/issue_comments_043352.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-04-30T09:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43352",
    "user": "https://github.com/saliola"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_043353.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis fixes the problem, and all tests pass.  I'd like to give this a positive review since I reported the original problem, but I'm not familiar enough with the posets code to evaluate all of the changes here.  Can anyone else help out?",
    "created_at": "2009-05-03T04:36:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43353",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
This fixes the problem, and all tests pass.  I'd like to give this a positive review since I reported the original problem, but I'm not familiar enough with the posets code to evaluate all of the changes here.  Can anyone else help out?



---

archive/issue_comments_043354.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-06-19T22:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43354",
    "user": "https://github.com/rlmill"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_043355.json:
```json
{
    "body": "<a id='comment:5'></a>\nI'd also give this a positive review, but I have to ask: why is `__cmp__` returning 1 (`cmp(a,b)==1` indicates `a < b`) when elements are incomparable? Shouldn't it be raising an error instead?",
    "created_at": "2009-06-19T22:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43355",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:5'></a>
I'd also give this a positive review, but I have to ask: why is `__cmp__` returning 1 (`cmp(a,b)==1` indicates `a < b`) when elements are incomparable? Shouldn't it be raising an error instead?



---

archive/issue_comments_043356.json:
```json
{
    "body": "**Changing status** from needs_work to positive_review.",
    "created_at": "2009-06-20T01:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43356",
    "user": "https://github.com/mwhansen"
}
```

**Changing status** from needs_work to positive_review.



---

archive/attachments_005937.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5280-review.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5280/trac_5280-review.patch",
    "created_at": "2009-06-20T01:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_043357.json:
```json
{
    "body": "<a id='comment:6'></a>\nI've added a patch which fixes some doc formatting.",
    "created_at": "2009-06-20T01:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43357",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:6'></a>
I've added a patch which fixes some doc formatting.



---

archive/issue_comments_043358.json:
```json
{
    "body": "**Author:** Franco Saliola",
    "created_at": "2009-06-20T01:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43358",
    "user": "https://github.com/mwhansen"
}
```

**Author:** Franco Saliola



---

archive/issue_comments_043359.json:
```json
{
    "body": "<a id='comment:8'></a>\nmhansen, care to at least comment why this doesn't concern you?:\n\nReplying to [rlm](#comment%3A5):\n> Why is `__cmp__` returning 1 when elements are incomparable? Shouldn't it be raising an error instead?\n",
    "created_at": "2009-06-20T01:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43359",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:8'></a>
mhansen, care to at least comment why this doesn't concern you?:

Replying to [rlm](#comment%3A5):
> Why is `__cmp__` returning 1 when elements are incomparable? Shouldn't it be raising an error instead?




---

archive/issue_comments_043360.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to rlm:\n\n> Why is `__cmp__` returning 1 when elements are incomparable? Shouldn't it be raising an error instead?\n\n\nHere are a couple of reasons why it shouldn't.\n\n(1) `__cmp__` should never raise an error, otherwise you won't be able to\nsort a list of elements:\n\n```\nsage: class C(object):\n...       def __cmp__(self, other):\n...           raise ValueError, 'elements are incomparable'\n\nsage: sorted([C(), C()])\n------------------------------------------------------------\nTraceback (most recent call last):\n  File \"<ipython console>\", line 1, in <module>\n  File \"<ipython console>\", line 3, in __cmp__\nValueError: elements are incomparable\n```\n\n(2) All the rich comparisons have been implemented for `PosetElement`, so\n`x<y` is handled by `x.__lt__(y)`. That is, the answer will be correct.\n\n\nSo you might wonder why `__cmp__` even needs to be implemented. Shouldn't\n`cmp` just use the rich comparison methods to determine its value? \n\nIn theory, yes. But `PosetElement` inherits from `Element`, which\ndefines `__cmp__`. It seems to be that since `__cmp__` is not the\ndefault implementation (`object.__cmp__`), the `cmp` function ignores\nall the rich comparison operations and calls `__cmp__` directly. See the\nfollowing example, which was adapted from\n[http://docs.sympy.org/_sources/python-comparisons.txt](http://docs.sympy.org/_sources/python-comparisons.txt).\n\n```\nsage: class C_without_cmp(SageObject):\n...       def __init__(self, a):\n...           self.a = a\n...       def __repr__(self):\n...           return str(self.a)\n...       def __eq__(self, o):\n...           print \"%s.__eq__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n...       def __ne__(self, o):\n...           print \"%s.__ne__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n...       def __lt__(self, o):\n...           print \"%s.__lt__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n...       def __le__(self, o):\n...           print \"%s.__le__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n...       def __gt__(self, o):\n...           print \"%s.__gt__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n...       def __ge__(self, o):\n...           print \"%s.__ge__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n\n# cmp uses the rich comparison methods if no __cmp__ is found\nsage: a = C_without_cmp(\"a\"); b = C_without_cmp(\"b\")\nsage: cmp(a,b)\na.__eq__(b)\nb.__eq__(a)\nb.__eq__(a)\na.__eq__(b)\na.__lt__(b)\nb.__gt__(a)\nb.__gt__(a)\na.__lt__(b)\na.__gt__(b)\nb.__lt__(a)\nb.__lt__(a)\na.__gt__(b)\n1\n\nsage: class C_with_cmp(C_without_cmp):\n...       def __cmp__(self, o):\n...           print \"%s.__cmp__(%s)\" % (self.a, o.a)\n...           return NotImplemented\n\n# cmp uses __cmp__, ignoring the rich comparison methods if it is defined\nsage: a = C_with_cmp(\"a\"); b = C_with_cmp(\"b\")\nsage: cmp(a,b)\na.__cmp__(b)\nb.__cmp__(a)\n-1\n```\n\nThis leads to the following error for posets, which is what this ticket is about.\n\n```\nsage: P = Poset([[1,2],[3],[3],[]])\nsage: sorted(P)\n[0, 1, 2, 3]\nsage: sorted(P, cmp)\n------------------------------------------------------------\nTraceback (most recent call last):\n  File \"<ipython console>\", line 1, in <module>\n  File \"element.pyx\", line 648, in sage.structure.element.Element.__cmp__ (sage/structure/element.c:6062)\n  File \"element.pyx\", line 561, in sage.structure.element.Element._cmp (sage/structure/element.c:5133)\n  File \"element.pyx\", line 663, in sage.structure.element.Element._cmp_c_impl (sage/structure/element.c:6237)\nNotImplementedError: BUG: sort algorithm for elements of 'Finite poset containing 4 elements' not implemented\n\n> /home/saliola/Applications/sage-4.0.2-busted/local/bin/element.pyx(663)sage.structure.element.Element._cmp_c_impl (sage/structure/element.c:6237)()\n```\n\nSo I implemented `__cmp__` for `PosetElement`.\n\nAre these satisfactory reasons?",
    "created_at": "2009-06-21T12:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43360",
    "user": "https://github.com/saliola"
}
```

<a id='comment:9'></a>
Replying to rlm:

> Why is `__cmp__` returning 1 when elements are incomparable? Shouldn't it be raising an error instead?


Here are a couple of reasons why it shouldn't.

(1) `__cmp__` should never raise an error, otherwise you won't be able to
sort a list of elements:

```
sage: class C(object):
...       def __cmp__(self, other):
...           raise ValueError, 'elements are incomparable'

sage: sorted([C(), C()])
------------------------------------------------------------
Traceback (most recent call last):
  File "<ipython console>", line 1, in <module>
  File "<ipython console>", line 3, in __cmp__
ValueError: elements are incomparable
```

(2) All the rich comparisons have been implemented for `PosetElement`, so
`x<y` is handled by `x.__lt__(y)`. That is, the answer will be correct.


So you might wonder why `__cmp__` even needs to be implemented. Shouldn't
`cmp` just use the rich comparison methods to determine its value? 

In theory, yes. But `PosetElement` inherits from `Element`, which
defines `__cmp__`. It seems to be that since `__cmp__` is not the
default implementation (`object.__cmp__`), the `cmp` function ignores
all the rich comparison operations and calls `__cmp__` directly. See the
following example, which was adapted from
[http://docs.sympy.org/_sources/python-comparisons.txt](http://docs.sympy.org/_sources/python-comparisons.txt).

```
sage: class C_without_cmp(SageObject):
...       def __init__(self, a):
...           self.a = a
...       def __repr__(self):
...           return str(self.a)
...       def __eq__(self, o):
...           print "%s.__eq__(%s)" % (self.a, o.a)
...           return NotImplemented
...       def __ne__(self, o):
...           print "%s.__ne__(%s)" % (self.a, o.a)
...           return NotImplemented
...       def __lt__(self, o):
...           print "%s.__lt__(%s)" % (self.a, o.a)
...           return NotImplemented
...       def __le__(self, o):
...           print "%s.__le__(%s)" % (self.a, o.a)
...           return NotImplemented
...       def __gt__(self, o):
...           print "%s.__gt__(%s)" % (self.a, o.a)
...           return NotImplemented
...       def __ge__(self, o):
...           print "%s.__ge__(%s)" % (self.a, o.a)
...           return NotImplemented

# cmp uses the rich comparison methods if no __cmp__ is found
sage: a = C_without_cmp("a"); b = C_without_cmp("b")
sage: cmp(a,b)
a.__eq__(b)
b.__eq__(a)
b.__eq__(a)
a.__eq__(b)
a.__lt__(b)
b.__gt__(a)
b.__gt__(a)
a.__lt__(b)
a.__gt__(b)
b.__lt__(a)
b.__lt__(a)
a.__gt__(b)
1

sage: class C_with_cmp(C_without_cmp):
...       def __cmp__(self, o):
...           print "%s.__cmp__(%s)" % (self.a, o.a)
...           return NotImplemented

# cmp uses __cmp__, ignoring the rich comparison methods if it is defined
sage: a = C_with_cmp("a"); b = C_with_cmp("b")
sage: cmp(a,b)
a.__cmp__(b)
b.__cmp__(a)
-1
```

This leads to the following error for posets, which is what this ticket is about.

```
sage: P = Poset([[1,2],[3],[3],[]])
sage: sorted(P)
[0, 1, 2, 3]
sage: sorted(P, cmp)
------------------------------------------------------------
Traceback (most recent call last):
  File "<ipython console>", line 1, in <module>
  File "element.pyx", line 648, in sage.structure.element.Element.__cmp__ (sage/structure/element.c:6062)
  File "element.pyx", line 561, in sage.structure.element.Element._cmp (sage/structure/element.c:5133)
  File "element.pyx", line 663, in sage.structure.element.Element._cmp_c_impl (sage/structure/element.c:6237)
NotImplementedError: BUG: sort algorithm for elements of 'Finite poset containing 4 elements' not implemented

> /home/saliola/Applications/sage-4.0.2-busted/local/bin/element.pyx(663)sage.structure.element.Element._cmp_c_impl (sage/structure/element.c:6237)()
```

So I implemented `__cmp__` for `PosetElement`.

Are these satisfactory reasons?



---

archive/issue_comments_043361.json:
```json
{
    "body": "<a id='comment:10'></a>\nFranco,\n\nThanks for the incredibly detailed explanation! The main reason I was asking is that there is no indication why this is okay in the code itself. Could you put a sentence or two, maybe just in a comment, explaining why this is done? Maybe something like \"When the user asks for `a<b`, rich comparison is used, and this is implemented only to enable sorting.\" Also, if the result of sorting isn't consistent (e.g. cmp(a,b) == cmp(b,a)), this should be mentioned too, I think.",
    "created_at": "2009-06-21T12:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43361",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:10'></a>
Franco,

Thanks for the incredibly detailed explanation! The main reason I was asking is that there is no indication why this is okay in the code itself. Could you put a sentence or two, maybe just in a comment, explaining why this is done? Maybe something like "When the user asks for `a<b`, rich comparison is used, and this is implemented only to enable sorting." Also, if the result of sorting isn't consistent (e.g. cmp(a,b) == cmp(b,a)), this should be mentioned too, I think.



---

archive/issue_comments_043362.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [rlm](#comment%3A10):\n> Franco,\n> \n> Thanks for the incredibly detailed explanation! The main reason I was asking is that there is no indication why this is okay in the code itself. Could you put a sentence or two, maybe just in a comment, explaining why this is done? Maybe something like \"When the user asks for `a<b`, rich comparison is used, and this is implemented only to enable sorting.\" Also, if the result of sorting isn't consistent (e.g. cmp(a,b) == cmp(b,a)), this should be mentioned too, I think.\n\n\nI'm attaching a patch with the docfixes, and that also implements the\n`__ne__` method, which I must have forgot to define. (Unfortunately, in\nPython `__ne__` does not default to `!__eq__`.)",
    "created_at": "2009-06-21T18:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43362",
    "user": "https://github.com/saliola"
}
```

<a id='comment:11'></a>
Replying to [rlm](#comment%3A10):
> Franco,
> 
> Thanks for the incredibly detailed explanation! The main reason I was asking is that there is no indication why this is okay in the code itself. Could you put a sentence or two, maybe just in a comment, explaining why this is done? Maybe something like "When the user asks for `a<b`, rich comparison is used, and this is implemented only to enable sorting." Also, if the result of sorting isn't consistent (e.g. cmp(a,b) == cmp(b,a)), this should be mentioned too, I think.


I'm attaching a patch with the docfixes, and that also implements the
`__ne__` method, which I must have forgot to define. (Unfortunately, in
Python `__ne__` does not default to `!__eq__`.)



---

archive/attachments_005938.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5280-ne-docfixes.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5280/trac_5280-ne-docfixes.patch",
    "created_at": "2009-06-21T18:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/saliola"
}
```



---

archive/issue_comments_043363.json:
```json
{
    "body": "Apply on top of the previous two.",
    "created_at": "2009-06-21T18:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43363",
    "user": "https://github.com/saliola"
}
```

Apply on top of the previous two.



---

archive/issue_comments_043364.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2009-06-21T18:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43364",
    "user": "https://github.com/saliola"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_043365.json:
```json
{
    "body": "**Reviewer:** Mike Hansen, Robert Miller",
    "created_at": "2009-06-21T22:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43365",
    "user": "https://github.com/rlmill"
}
```

**Reviewer:** Mike Hansen, Robert Miller



---

archive/issue_comments_043366.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-06-21T22:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43366",
    "user": "https://github.com/rlmill"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_043367.json:
```json
{
    "body": "<a id='comment:13'></a>\nLooks good, applies and passes tests.",
    "created_at": "2009-06-21T22:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43367",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:13'></a>
Looks good, applies and passes tests.



---

archive/issue_comments_043368.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [rlm](#comment%3A10):\n> Franco,\n> \n> Thanks for the incredibly detailed explanation! The main reason I was asking is that there is no indication why this is okay in the code itself. Could you put a sentence or two, maybe just in a comment, explaining why this is done? Maybe something like \"When the user asks for `a<b`, rich comparison is used, and this is implemented only to enable sorting.\" Also, if the result of sorting isn't consistent (e.g. cmp(a,b) == cmp(b,a)), this should be mentioned too, I think.\n\n\nThanks also! I am having similar problems in several other places. This really should be though of once for all, and a systematic policy should be set up for\nall occurences of this issue. Actually, it would be best if this could be solved once for all at a higher level (in Element)?\n\nOne fine point (which certainly does not jeopardize this patch): I would feel better returning 0 for incomparable elements rather than +1.\n\nWould you mind starting a discussion about this on sage-devel?",
    "created_at": "2009-06-22T06:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43368",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'></a>
Replying to [rlm](#comment%3A10):
> Franco,
> 
> Thanks for the incredibly detailed explanation! The main reason I was asking is that there is no indication why this is okay in the code itself. Could you put a sentence or two, maybe just in a comment, explaining why this is done? Maybe something like "When the user asks for `a<b`, rich comparison is used, and this is implemented only to enable sorting." Also, if the result of sorting isn't consistent (e.g. cmp(a,b) == cmp(b,a)), this should be mentioned too, I think.


Thanks also! I am having similar problems in several other places. This really should be though of once for all, and a systematic policy should be set up for
all occurences of this issue. Actually, it would be best if this could be solved once for all at a higher level (in Element)?

One fine point (which certainly does not jeopardize this patch): I would feel better returning 0 for incomparable elements rather than +1.

Would you mind starting a discussion about this on sage-devel?



---

archive/issue_comments_043369.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [nthiery](#comment%3A14):\n\n> One fine point (which certainly does not jeopardize this patch): I would feel better returning 0 for incomparable elements rather than +1.\n\n\nThat's fine with me. I just picked one randomly, but 0 is better. I will make the change.\n\n> Would you mind starting a discussion about this on sage-devel?\n\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/44dbe252426c3831",
    "created_at": "2009-06-22T10:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43369",
    "user": "https://github.com/saliola"
}
```

<a id='comment:15'></a>
Replying to [nthiery](#comment%3A14):

> One fine point (which certainly does not jeopardize this patch): I would feel better returning 0 for incomparable elements rather than +1.


That's fine with me. I just picked one randomly, but 0 is better. I will make the change.

> Would you mind starting a discussion about this on sage-devel?


http://groups.google.com/group/sage-devel/browse_thread/thread/44dbe252426c3831



---

archive/attachments_005939.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5280-switch-to-zero.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5280/trac_5280-switch-to-zero.patch",
    "created_at": "2009-06-22T10:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/saliola"
}
```



---

archive/issue_comments_043370.json:
```json
{
    "body": "Apply on top of the previous three",
    "created_at": "2009-06-22T10:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43370",
    "user": "https://github.com/saliola"
}
```

Apply on top of the previous three



---

archive/issue_comments_043371.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe last change that switches to returning 0 instead of 1 for incomparable elements needs reviewing.",
    "created_at": "2009-06-22T10:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43371",
    "user": "https://github.com/saliola"
}
```

<a id='comment:16'></a>
The last change that switches to returning 0 instead of 1 for incomparable elements needs reviewing.



---

archive/issue_comments_043372.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2009-06-22T10:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43372",
    "user": "https://github.com/saliola"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_043373.json:
```json
{
    "body": "<a id='comment:17'></a>\nLooks good.",
    "created_at": "2009-06-22T10:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43373",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:17'></a>
Looks good.



---

archive/issue_comments_043374.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-06-22T10:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43374",
    "user": "https://github.com/rlmill"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_015533.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-06-24T10:14:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5280#event-15533"
}
```



---

archive/issue_comments_043375.json:
```json
{
    "body": "**Merged:** sage-4.1.alpha0",
    "created_at": "2009-06-24T10:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5280#issuecomment-43375",
    "user": "https://github.com/rlmill"
}
```

**Merged:** sage-4.1.alpha0



---

archive/issue_events_015534.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-08T20:28:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5280",
    "milestone": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5280#event-15534"
}
```
