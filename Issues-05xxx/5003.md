# Issue 5003: equality testing in graphs should check "weighted" property

archive/issues_005003.json:
```json
{
    "body": "See:\n\nhttp://groups.google.com/group/sage-support/browse_thread/thread/d01dd8082da28d52?hl=en\n\n**Assignee:** @rlmill\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/5003\n\n",
    "closed_at": "2009-01-24T23:00:55Z",
    "created_at": "2009-01-17T19:53:07Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.3",
    "title": "equality testing in graphs should check \"weighted\" property",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5003",
    "user": "https://github.com/rlmill"
}
```
See:

http://groups.google.com/group/sage-support/browse_thread/thread/d01dd8082da28d52?hl=en

**Assignee:** @rlmill

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/5003





---

archive/attachments_005620.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-5003_weighted_eq_graphs.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5003/trac-5003_weighted_eq_graphs.patch",
    "created_at": "2009-01-17T19:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/rlmill"
}
```



---

archive/issue_comments_045206.json:
```json
{
    "body": "",
    "created_at": "2009-01-17T19:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45206",
    "user": "https://github.com/rlmill"
}
```





---

archive/issue_comments_045207.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-01-24T11:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45207",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_045208.json:
```json
{
    "body": "<a id='comment:1'></a>\nHey, I ran into some doctest failures w/ your new change.\n\nSpecifically, around line 839 (in the docstring for weighted_ajacency_matrix(...)):\n\n\n```\n        EXAMPLES:\n            sage: G = Graph(sparse=True)\n            sage: G.add_edges([(0,1,1),(1,2,2),(0,2,3),(0,3,4)])\n            sage: M = G.weighted_adjacency_matrix(); M\n            [0 1 3 4]\n            [1 0 2 0]\n            [3 2 0 0]\n            [4 0 0 0]\n            sage: H = Graph(data=M, format='weighted_adjacency_matrix', sparse=True)\n            sage: H == G\n            True\n```\n\nThis fails.  Specifically, G.weighted() returns false (which seems like its own bug.)\n\nAnd Also, the example starting at line 1180 (in the docstring for weighted(...):\n\n```\n        EXAMPLE:\n        Here we have two graphs with different labels, but weighted is False\n        for both, so we just check for the presence of edges:\n            sage: G = Graph({0:{1:'a'}}, implementation='networkx')\n            sage: H = Graph({0:{1:'b'}}, implementation='networkx')\n            sage: G == H\n            True\n\n        Now one is weighted and the other is not, so the comparison is done as\n        if neither is weighted:\n            sage: G.weighted(True)\n            sage: H.weighted()\n            False\n            sage: G == H\n            True\n\n```\n\nFails.  Because of the change.\n\nThe first of these issues, is a bug and should be fixed IMHO.  The second issue is more subtle and disturbing.  Particularly because it indicates that a valid example used to work, you will be breaking compatibility with code that works this way, and you should think about what the previous assumptions were, and if you can work around them with a fix.",
    "created_at": "2009-01-24T11:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45208",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

<a id='comment:1'></a>
Hey, I ran into some doctest failures w/ your new change.

Specifically, around line 839 (in the docstring for weighted_ajacency_matrix(...)):


```
        EXAMPLES:
            sage: G = Graph(sparse=True)
            sage: G.add_edges([(0,1,1),(1,2,2),(0,2,3),(0,3,4)])
            sage: M = G.weighted_adjacency_matrix(); M
            [0 1 3 4]
            [1 0 2 0]
            [3 2 0 0]
            [4 0 0 0]
            sage: H = Graph(data=M, format='weighted_adjacency_matrix', sparse=True)
            sage: H == G
            True
```

This fails.  Specifically, G.weighted() returns false (which seems like its own bug.)

And Also, the example starting at line 1180 (in the docstring for weighted(...):

```
        EXAMPLE:
        Here we have two graphs with different labels, but weighted is False
        for both, so we just check for the presence of edges:
            sage: G = Graph({0:{1:'a'}}, implementation='networkx')
            sage: H = Graph({0:{1:'b'}}, implementation='networkx')
            sage: G == H
            True

        Now one is weighted and the other is not, so the comparison is done as
        if neither is weighted:
            sage: G.weighted(True)
            sage: H.weighted()
            False
            sage: G == H
            True

```

Fails.  Because of the change.

The first of these issues, is a bug and should be fixed IMHO.  The second issue is more subtle and disturbing.  Particularly because it indicates that a valid example used to work, you will be breaking compatibility with code that works this way, and you should think about what the previous assumptions were, and if you can work around them with a fix.



---

archive/issue_comments_045209.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2009-01-24T12:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45209",
    "user": "https://github.com/rlmill"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_045210.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [shumow](#comment%3A1):\n> This fails.  Specifically, G.weighted() returns false (which seems like its own bug.)\n\n\nNot so much a bug, as a typo in the doctest. If you don't say G is weighted, then just adding edges with weights shouldn't change that. In fact, that's the point of the other doctest.\n\n> And Also, the example starting at line 1180 (in the docstring for weighted(...):\n> \n\n...\n> \n> Fails.  Because of the change.\n> \n> The second issue is more subtle and disturbing.  Particularly because it indicates that a valid example used to work, you will be breaking compatibility with code that works this way, and you should think about what the previous assumptions were, and if you can work around them with a fix.\n\n\nWell, it's more like we're updating things to actually do it correctly. Before, weighted wasn't a property of graphs, and that test was kind of a warning about that. I don't know of any code that would be affected by this, but I think this is the right way to do things.",
    "created_at": "2009-01-24T12:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45210",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:2'></a>
Replying to [shumow](#comment%3A1):
> This fails.  Specifically, G.weighted() returns false (which seems like its own bug.)


Not so much a bug, as a typo in the doctest. If you don't say G is weighted, then just adding edges with weights shouldn't change that. In fact, that's the point of the other doctest.

> And Also, the example starting at line 1180 (in the docstring for weighted(...):
> 

...
> 
> Fails.  Because of the change.
> 
> The second issue is more subtle and disturbing.  Particularly because it indicates that a valid example used to work, you will be breaking compatibility with code that works this way, and you should think about what the previous assumptions were, and if you can work around them with a fix.


Well, it's more like we're updating things to actually do it correctly. Before, weighted wasn't a property of graphs, and that test was kind of a warning about that. I don't know of any code that would be affected by this, but I think this is the right way to do things.



---

archive/issue_comments_045211.json:
```json
{
    "body": "Apply this patch second.",
    "created_at": "2009-01-24T12:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45211",
    "user": "https://github.com/rlmill"
}
```

Apply this patch second.



---

archive/issue_comments_045212.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-01-24T15:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45212",
    "user": "https://github.com/mwhansen"
}
```

**Changing status** from needs_review to positive_review.



---

archive/attachments_005621.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-5003-followup.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5003/trac-5003-followup.patch",
    "created_at": "2009-01-24T15:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_045213.json:
```json
{
    "body": "<a id='comment:3'></a>\nLooks good to me.",
    "created_at": "2009-01-24T15:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45213",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:3'></a>
Looks good to me.



---

archive/issue_comments_045214.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-01-24T23:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45214",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_comments_045215.json:
```json
{
    "body": "<a id='comment:4'></a>\nMerged in Sage 3.3.alpha2.\n\nCheers,\n\nMichael",
    "created_at": "2009-01-24T23:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5003#issuecomment-45215",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
Merged in Sage 3.3.alpha2.

Cheers,

Michael



---

archive/issue_events_015037.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-01-24T23:00:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5003",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5003#event-15037"
}
```
