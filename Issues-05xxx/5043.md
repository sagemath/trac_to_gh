# Issue 5043: gap_console help broken

archive/issues_005043.json:
```json
{
    "body": "\n```\n\n\nOn Tue, Jan 20, 2009 at 8:03 PM, davidp <davidp@reed.edu> wrote:\n>\n> I will be teaching abstract algebra this semester and want to\n> introduce my students to Sage and GAP.  I have installed\n> gap_packages-4.4.10_6, but I am still having trouble with\n> documentation:\n>\n> ----------------------------------------------------------------------\n> | Sage Version 3.2.3, Release Date: 2009-01-05                       |\n> | Type notebook() for the GUI, and license() for information.        |\n> ----------------------------------------------------------------------\n> sage: gap_console()\n> GAP4, Version: 4.4.10 of 02-Oct-2007, i686-pc-linux-gnu-gcc\n> gap> ?SymmetricGroup\n> Help: Showing `Reference: SymmetricGroup'\n> Record: '<rec>.tempfile' must have an assigned value at\n> str := OutputTextFile( $SAGE.tempfile, false );\n>  called from\n> HELP_VIEWER_INFO.(viewer).show( data ); called from\n> HELP_PRINT_MATCH( i ); called from\n> HELP_SHOW_MATCHES( books, str, true ) called from\n> <function>( <arguments> ) called from read-eval-loop\n> Entering break read-eval-print loop ...\n> you can 'quit;' to quit to outer loop, or\n> you can 'return;' after assigning a value to continue\n> brk>\n>\n>\n> I am running Sage on a thinkpad with Fedora 10.\n>\n> Any suggestions would be appreciated.\n\nThe above happens because the default GAP workspace evidently that messes up the help system.  I think this is a bug (?), probably in GAP. \n\nYou can do the following instead:\n\nsage: gap_console(False)\n...\n\nOr\n\nsage: gap.SymmetricGroup?            # <--- i like this\n\n\nWilliam\n```\n\n\n---\n\n\nApply [attachment:trac_5043-extcode-gap-console-help.patch] to the extcode repository and [attachment:trac_5043-gap-console-help.patch] to the Sage library.\n\n**Assignee:** @williamstein\n\n**Reviewer:** Karl-Dieter Crisman\n\n**Author:** Ivan Andrus\n\n**Merged:** sage-5.2.beta1\n\nIssue created by migration from https://trac.sagemath.org/ticket/5043\n\n",
    "closed_at": "2012-07-07T22:29:10Z",
    "created_at": "2009-01-21T05:42:07Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.2",
    "title": "gap_console help broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5043",
    "user": "https://github.com/williamstein"
}
```

```


On Tue, Jan 20, 2009 at 8:03 PM, davidp <davidp@reed.edu> wrote:
>
> I will be teaching abstract algebra this semester and want to
> introduce my students to Sage and GAP.  I have installed
> gap_packages-4.4.10_6, but I am still having trouble with
> documentation:
>
> ----------------------------------------------------------------------
> | Sage Version 3.2.3, Release Date: 2009-01-05                       |
> | Type notebook() for the GUI, and license() for information.        |
> ----------------------------------------------------------------------
> sage: gap_console()
> GAP4, Version: 4.4.10 of 02-Oct-2007, i686-pc-linux-gnu-gcc
> gap> ?SymmetricGroup
> Help: Showing `Reference: SymmetricGroup'
> Record: '<rec>.tempfile' must have an assigned value at
> str := OutputTextFile( $SAGE.tempfile, false );
>  called from
> HELP_VIEWER_INFO.(viewer).show( data ); called from
> HELP_PRINT_MATCH( i ); called from
> HELP_SHOW_MATCHES( books, str, true ) called from
> <function>( <arguments> ) called from read-eval-loop
> Entering break read-eval-print loop ...
> you can 'quit;' to quit to outer loop, or
> you can 'return;' after assigning a value to continue
> brk>
>
>
> I am running Sage on a thinkpad with Fedora 10.
>
> Any suggestions would be appreciated.

The above happens because the default GAP workspace evidently that messes up the help system.  I think this is a bug (?), probably in GAP. 

You can do the following instead:

sage: gap_console(False)
...

Or

sage: gap.SymmetricGroup?            # <--- i like this


William
```


---


Apply [attachment:trac_5043-extcode-gap-console-help.patch] to the extcode repository and [attachment:trac_5043-gap-console-help.patch] to the Sage library.

**Assignee:** @williamstein

**Reviewer:** Karl-Dieter Crisman

**Author:** Ivan Andrus

**Merged:** sage-5.2.beta1

Issue created by migration from https://trac.sagemath.org/ticket/5043





---

archive/issue_comments_040247.json:
```json
{
    "body": "<a id='comment:1'></a>\n\n```\n#\n# SAGE support utilities to read into the GAP session.\n#\n$SAGE := rec();\n\n$SAGE.OldPager := Pager;\n\n\n$SAGE.NewPager :=\n         function( data )\n   local   str,  lines,  line, fn, start;\n\n   str := OutputTextFile($SAGE.tempfile,false);\n   start := 1;\n\nbut never sets $SAGE.tempfile anywhere.\n\nSteve\n- Show quoted text -\n\n\nOn 21 Jan 2009, at 06:39, William Stein wrote:\n\n    On Tue, Jan 20, 2009 at 8:03 PM, davidp <davidp@reed.edu> wrote:\n\n\n        I will be teaching abstract algebra this semester and want to\n        introduce my students to Sage and GAP.  I have installed\n        gap_packages-4.4.10_6, but I am still having trouble with\n        documentation:\n\n        ----------------------------------------------------------------------\n        | Sage Version 3.2.3, Release Date: 2009-01-05                       |\n        | Type notebook() for the GUI, and license() for information.        |\n        ----------------------------------------------------------------------\n        sage: gap_console()\n        GAP4, Version: 4.4.10 of 02-Oct-2007, i686-pc-linux-gnu-gcc\n        gap> ?SymmetricGroup\n        Help: Showing `Reference: SymmetricGroup'\n        Record: '<rec>.tempfile' must have an assigned value at\n        str := OutputTextFile( $SAGE.tempfile, false );\n        called from\n        HELP_VIEWER_INFO.(viewer).show( data ); called from\n        HELP_PRINT_MATCH( i ); called from\n        HELP_SHOW_MATCHES( books, str, true ) called from\n        <function>( <arguments> ) called from read-eval-loop\n        Entering break read-eval-print loop ...\n        you can 'quit;' to quit to outer loop, or\n        you can 'return;' after assigning a value to continue\n        brk>\n\n\n        I am running Sage on a thinkpad with Fedora 10.\n\n        Any suggestions would be appreciated.\n\n\n    The above happens because the default GAP workspace evidently that\n    messes up the help system.  I think this is a bug (?), probably in\n    GAP.\n\n    You can do the following instead:\n\n    sage: gap_console(False)\n\n    which will give you a gap session that by default has less\n    functionality loaded than otherwise.\n\n    ...\n\n    Or\n\n    sage: gap.SymmetricGroup?            # <--- i like this\n\n    I've made this bug trac #5043:\n\n             http://trac.sagemath.org/sage_trac/ticket/5043\n\n    I've also cc'd Steve Linton in case he has any remarks.\n\n    -- William\n\n\nSteve Linton    School of Computer Science  &\n```",
    "created_at": "2009-01-21T10:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40247",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>

```
#
# SAGE support utilities to read into the GAP session.
#
$SAGE := rec();

$SAGE.OldPager := Pager;


$SAGE.NewPager :=
         function( data )
   local   str,  lines,  line, fn, start;

   str := OutputTextFile($SAGE.tempfile,false);
   start := 1;

but never sets $SAGE.tempfile anywhere.

Steve
- Show quoted text -


On 21 Jan 2009, at 06:39, William Stein wrote:

    On Tue, Jan 20, 2009 at 8:03 PM, davidp <davidp@reed.edu> wrote:


        I will be teaching abstract algebra this semester and want to
        introduce my students to Sage and GAP.  I have installed
        gap_packages-4.4.10_6, but I am still having trouble with
        documentation:

        ----------------------------------------------------------------------
        | Sage Version 3.2.3, Release Date: 2009-01-05                       |
        | Type notebook() for the GUI, and license() for information.        |
        ----------------------------------------------------------------------
        sage: gap_console()
        GAP4, Version: 4.4.10 of 02-Oct-2007, i686-pc-linux-gnu-gcc
        gap> ?SymmetricGroup
        Help: Showing `Reference: SymmetricGroup'
        Record: '<rec>.tempfile' must have an assigned value at
        str := OutputTextFile( $SAGE.tempfile, false );
        called from
        HELP_VIEWER_INFO.(viewer).show( data ); called from
        HELP_PRINT_MATCH( i ); called from
        HELP_SHOW_MATCHES( books, str, true ) called from
        <function>( <arguments> ) called from read-eval-loop
        Entering break read-eval-print loop ...
        you can 'quit;' to quit to outer loop, or
        you can 'return;' after assigning a value to continue
        brk>


        I am running Sage on a thinkpad with Fedora 10.

        Any suggestions would be appreciated.


    The above happens because the default GAP workspace evidently that
    messes up the help system.  I think this is a bug (?), probably in
    GAP.

    You can do the following instead:

    sage: gap_console(False)

    which will give you a gap session that by default has less
    functionality loaded than otherwise.

    ...

    Or

    sage: gap.SymmetricGroup?            # <--- i like this

    I've made this bug trac #5043:

             http://trac.sagemath.org/sage_trac/ticket/5043

    I've also cc'd Steve Linton in case he has any remarks.

    -- William


Steve Linton    School of Computer Science  &
```



---

archive/attachments_005654.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5043-extcode-gap-console-help.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5043/trac_5043-extcode-gap-console-help.patch",
    "created_at": "2012-06-05T17:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/gvol"
}
```



---

archive/issue_comments_040248.json:
```json
{
    "body": "",
    "created_at": "2012-06-05T17:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40248",
    "user": "https://github.com/gvol"
}
```





---

archive/attachments_005655.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5043-gap-console-help.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5043/trac_5043-gap-console-help.patch",
    "created_at": "2012-06-05T17:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/gvol"
}
```



---

archive/issue_comments_040249.json:
```json
{
    "body": "",
    "created_at": "2012-06-05T17:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40249",
    "user": "https://github.com/gvol"
}
```





---

archive/issue_comments_040250.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2012-06-05T18:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40250",
    "user": "https://github.com/gvol"
}
```

**Upstream:** N/A



---

archive/issue_comments_040251.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-06-05T18:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40251",
    "user": "https://github.com/gvol"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_040252.json:
```json
{
    "body": "<a id='comment:2'></a>\nSince a console session and a session driven through expect are somewhat different, I think it makes sense to source a different file.  I could have made it so that `console.g` reads in `sage.g` if it wasn't already loaded, but I didn't see much use for the stuff in `sage.g` when interacting directly with GAP.  \n\nThis means there could be problems (I haven't tested) if someone calls `SaveWorkspace` and overwrites Sage's workspace with one in which `$SAGE` is not set.  However, it is currently possible to do that anyway though perhaps not quite as easily.  A much simpler way to mess things up is calling `$SAGE.StartInteract()` which screws with the expect interaction.",
    "created_at": "2012-06-05T18:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40252",
    "user": "https://github.com/gvol"
}
```

<a id='comment:2'></a>
Since a console session and a session driven through expect are somewhat different, I think it makes sense to source a different file.  I could have made it so that `console.g` reads in `sage.g` if it wasn't already loaded, but I didn't see much use for the stuff in `sage.g` when interacting directly with GAP.  

This means there could be problems (I haven't tested) if someone calls `SaveWorkspace` and overwrites Sage's workspace with one in which `$SAGE` is not set.  However, it is currently possible to do that anyway though perhaps not quite as easily.  A much simpler way to mess things up is calling `$SAGE.StartInteract()` which screws with the expect interaction.



---

archive/issue_comments_040253.json:
```json
{
    "body": "**Author:** Ivan Andrus",
    "created_at": "2012-06-05T18:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40253",
    "user": "https://github.com/gvol"
}
```

**Author:** Ivan Andrus



---

archive/issue_comments_040254.json:
```json
{
    "body": "<a id='comment:3'></a>\nIvan, do you think this might help #3152 as well?",
    "created_at": "2012-06-29T02:30:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40254",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
Ivan, do you think this might help #3152 as well?



---

archive/issue_comments_040255.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [kcrisman](#comment%3A3):\n> Ivan, do you think this might help #3152 as well?\n\n\nI just tested and sadly it doesn't.",
    "created_at": "2012-06-29T07:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40255",
    "user": "https://github.com/gvol"
}
```

<a id='comment:4'></a>
Replying to [kcrisman](#comment%3A3):
> Ivan, do you think this might help #3152 as well?


I just tested and sadly it doesn't.



---

archive/issue_comments_040256.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis does fix the problem as stated, and of course the behavior with `False` remains the same.  The code makes sense, though I had to learn a little bit about how GAP does these things and our interface.\n\nThe issue with saving... I mean, when this is called, `$SAGE` is set, right?  So I'm not sure that this is really causing any new problems.  What use case are you worried about?  The `-L` isn't even called if we do `gap_console(False)`, and if one does `True` (default) then everything is the same as it was... I'm missing something here.  Unless you think of what the case was where this is really different from the previous behavior, positive review.\n\nPatchbot, apply [attachment:trac_5043-extcode-gap-console-help.patch] to the extcode repository and [attachment:trac_5043-gap-console-help.patch] to the Sage library.",
    "created_at": "2012-07-05T15:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40256",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
This does fix the problem as stated, and of course the behavior with `False` remains the same.  The code makes sense, though I had to learn a little bit about how GAP does these things and our interface.

The issue with saving... I mean, when this is called, `$SAGE` is set, right?  So I'm not sure that this is really causing any new problems.  What use case are you worried about?  The `-L` isn't even called if we do `gap_console(False)`, and if one does `True` (default) then everything is the same as it was... I'm missing something here.  Unless you think of what the case was where this is really different from the previous behavior, positive review.

Patchbot, apply [attachment:trac_5043-extcode-gap-console-help.patch] to the extcode repository and [attachment:trac_5043-gap-console-help.patch] to the Sage library.



---

archive/issue_comments_040257.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2012-07-05T15:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40257",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_comments_040258.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -48,3 +48,9 @@\n \n William\n ```\n+\n+\n+---\n+\n+\n+Apply [attachment:trac_5043-extcode-gap-console-help.patch] to the extcode repository and [attachment:trac_5043-gap-console-help.patch] to the Sage library.\n``````\n",
    "created_at": "2012-07-05T15:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40258",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -48,3 +48,9 @@
 
 William
 ```
+
+
+---
+
+
+Apply [attachment:trac_5043-extcode-gap-console-help.patch] to the extcode repository and [attachment:trac_5043-gap-console-help.patch] to the Sage library.
``````




---

archive/issue_comments_040259.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-07-05T15:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40259",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_015234.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-06T08:21:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5043#event-15234"
}
```



---

archive/issue_events_015235.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-07T22:29:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5043#event-15235"
}
```



---

archive/issue_comments_040260.json:
```json
{
    "body": "**Merged:** sage-5.2.beta1",
    "created_at": "2012-07-07T22:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5043",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5043#issuecomment-40260",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.2.beta1
