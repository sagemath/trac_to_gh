# Issue 5554: implement cholesky_decomposition for matrices other than RDF

archive/issues_005554.json:
```json
{
    "body": "The attached patch\n\n* renames cholesky() to cholesky_decomposition()\n* improves the documentation\n* adds a helper function _cholesky_decomposition_() for specialization;\n* moves the GSL/scipy cholesky function to matrix_real_double_dense, where it belongs;\n* implements a generic Cholesky decomposition that works for arbitrary precision real and complex fields, where we generalize symmetric to Hermitian.\n\n\n**Assignee:** @williamstein\n\n**CC:**  jkantor wstein\n\n**Keywords:** cholesky decomposition RDF real\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/5554\n\n",
    "closed_at": "2009-05-19T19:43:21Z",
    "created_at": "2009-03-17T21:38:35Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.0",
    "title": "implement cholesky_decomposition for matrices other than RDF",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/5554",
    "user": "https://github.com/ncalexan"
}
```
The attached patch

* renames cholesky() to cholesky_decomposition()
* improves the documentation
* adds a helper function _cholesky_decomposition_() for specialization;
* moves the GSL/scipy cholesky function to matrix_real_double_dense, where it belongs;
* implements a generic Cholesky decomposition that works for arbitrary precision real and complex fields, where we generalize symmetric to Hermitian.


**Assignee:** @williamstein

**CC:**  jkantor wstein

**Keywords:** cholesky decomposition RDF real

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/5554





---

archive/issue_comments_051763.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-03-17T22:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51763",
    "user": "https://github.com/ncalexan"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_016893.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-13T16:58:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "milestone": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5554#event-16893"
}
```



---

archive/issue_comments_051764.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-04-18T23:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51764",
    "user": "https://github.com/rbeezer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_051765.json:
```json
{
    "body": "<a id='comment:3'></a>\nNicely done, great documentation, passes all tests.  Suggestions for improvements, in order of perceived importance.\n\n1.  Inputting a matrix over ZZ or QQ fails with the `ValueError` message about not being symmetric or positive definite, which is not an accurate error message in this case.  Should there be an attempt to coerce the matrix to RDF or CDF?  Inputting (trivial) symbolic matrices proceeds successfully (eg. [[x,y],[y,x]]).  Perhaps a coercion attempt above will cause a failure in this case, and this might be the right result?  Another interesting input is `matrix(2, [2, 2+i,2-i,4])` which is considered to be defined over SR, yet is handled properly by the routines here, or can be convrted to CDF for an accurate numerical result.\n\n2.  I think it would be safer to force the user to me more aware of the positive definite requirement.  I'd prefer to see a keyword argument like \"positive_definite=False\" added.  In other words, the default operation is to perform a check for positive-definiteness, but when the user knows the matrices at hand are positive-definite, the keyword can be invoked to bypass the check.  I think there are other examples like this in Sage (but I can't locate a good one at the moment).\n\n3.  A couple of places in the documentation could benefit from including the greater generality of matrices over the complex numbers, which this enhancement now allows.  Specifically:\n(a) docstring in matrix2.pyx could make it clear that `L^t` is the adjoint when the matrix has complex entries (rather than looking like just the transpose).\n(b) two error messages state that the matrix is \"not symmetric.\"  Could they say instead \"not symmetric (or not Hermitian)\"?\n\n4. Computing eigenvalues for matrices over a `RealField()` gives the warning message\n\n`UserWarning: Using generic algorithm for an inexact ring, which will probably give incorrect results due to numerical precision issues.`\n\nWould something similar be a good idea here for the generic algorithm?",
    "created_at": "2009-04-18T23:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51765",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:3'></a>
Nicely done, great documentation, passes all tests.  Suggestions for improvements, in order of perceived importance.

1.  Inputting a matrix over ZZ or QQ fails with the `ValueError` message about not being symmetric or positive definite, which is not an accurate error message in this case.  Should there be an attempt to coerce the matrix to RDF or CDF?  Inputting (trivial) symbolic matrices proceeds successfully (eg. [[x,y],[y,x]]).  Perhaps a coercion attempt above will cause a failure in this case, and this might be the right result?  Another interesting input is `matrix(2, [2, 2+i,2-i,4])` which is considered to be defined over SR, yet is handled properly by the routines here, or can be convrted to CDF for an accurate numerical result.

2.  I think it would be safer to force the user to me more aware of the positive definite requirement.  I'd prefer to see a keyword argument like "positive_definite=False" added.  In other words, the default operation is to perform a check for positive-definiteness, but when the user knows the matrices at hand are positive-definite, the keyword can be invoked to bypass the check.  I think there are other examples like this in Sage (but I can't locate a good one at the moment).

3.  A couple of places in the documentation could benefit from including the greater generality of matrices over the complex numbers, which this enhancement now allows.  Specifically:
(a) docstring in matrix2.pyx could make it clear that `L^t` is the adjoint when the matrix has complex entries (rather than looking like just the transpose).
(b) two error messages state that the matrix is "not symmetric."  Could they say instead "not symmetric (or not Hermitian)"?

4. Computing eigenvalues for matrices over a `RealField()` gives the warning message

`UserWarning: Using generic algorithm for an inexact ring, which will probably give incorrect results due to numerical precision issues.`

Would something similar be a good idea here for the generic algorithm?



---

archive/issue_comments_051766.json:
```json
{
    "body": "<a id='comment:4'></a>\nRe (1): ncalexan says:  I think they should fail if you can't extract a square root.  And I *don't* think we should coerce anything.  Ever.\n\nImprovements 2, 3, and 4 have been moved to #6003.  So this now has a positive review.",
    "created_at": "2009-05-07T19:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51766",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:4'></a>
Re (1): ncalexan says:  I think they should fail if you can't extract a square root.  And I *don't* think we should coerce anything.  Ever.

Improvements 2, 3, and 4 have been moved to #6003.  So this now has a positive review.



---

archive/issue_comments_051767.json:
```json
{
    "body": "**Changing status** from needs_work to positive_review.",
    "created_at": "2009-05-07T19:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51767",
    "user": "https://github.com/rbeezer"
}
```

**Changing status** from needs_work to positive_review.



---

archive/issue_comments_051768.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis needs work: cholesky() cannot just be deleted, it needs to be deprecated first.\n\nThe code looks very nice otherwise :)\n\nCheers,\n\nMichael",
    "created_at": "2009-05-14T05:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51768",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>
This needs work: cholesky() cannot just be deleted, it needs to be deprecated first.

The code looks very nice otherwise :)

Cheers,

Michael



---

archive/issue_comments_051769.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2009-05-14T05:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51769",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from positive_review to needs_work.



---

archive/attachments_006309.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_5554-cholesky-decomposition-2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket5554/trac_5554-cholesky-decomposition-2.patch",
    "created_at": "2009-05-19T16:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/ncalexan"
}
```



---

archive/issue_comments_051770.json:
```json
{
    "body": "<a id='comment:6'></a>\nOkay, this adds back cholesky, with a deprecation warning.  I'm returning this to positive review, since nothing else has changed.",
    "created_at": "2009-05-19T16:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51770",
    "user": "https://github.com/ncalexan"
}
```

<a id='comment:6'></a>
Okay, this adds back cholesky, with a deprecation warning.  I'm returning this to positive review, since nothing else has changed.



---

archive/issue_comments_051771.json:
```json
{
    "body": "**Changing status** from needs_work to positive_review.",
    "created_at": "2009-05-19T16:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51771",
    "user": "https://github.com/ncalexan"
}
```

**Changing status** from needs_work to positive_review.



---

archive/issue_comments_051772.json:
```json
{
    "body": "<a id='comment:7'></a>\nMerged trac_5554-cholesky-decomposition-2.patch in Sage 4.0.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-19T19:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51772",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>
Merged trac_5554-cholesky-decomposition-2.patch in Sage 4.0.rc0.

Cheers,

Michael



---

archive/issue_comments_051773.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-05-19T19:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/5554#issuecomment-51773",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_events_016894.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-19T19:43:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "milestone": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5554#event-16894"
}
```



---

archive/issue_events_016895.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-19T19:43:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "milestone": "sage-4.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5554#event-16895"
}
```



---

archive/issue_events_016896.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-19T19:43:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/5554",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/5554#event-16896"
}
```
